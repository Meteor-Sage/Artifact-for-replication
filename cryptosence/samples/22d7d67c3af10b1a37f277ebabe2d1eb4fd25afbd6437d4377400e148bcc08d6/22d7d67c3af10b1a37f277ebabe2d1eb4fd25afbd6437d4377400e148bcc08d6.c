/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_401014();
unsigned int __stdcall sub_401061(unsigned int a1, unsigned int a2);
int __stdcall sub_401096(_BYTE *a1, int a2);
int __stdcall sub_4010BB(_WORD *a1, int a2);
int __stdcall sub_4010F1(__int16 *a1, _BYTE *a2);
int __stdcall sub_401116(unsigned __int8 *a1, unsigned int a2, unsigned int a3);
_BYTE *__stdcall sub_40117B(char *a1, _BYTE *a2);
int __stdcall sub_4012CE(char *a1, _BYTE *a2);
// char *__userpurge sub_4013EE@<eax>(int a1@<ebx>, _BYTE *a2, int a3, int *a4);
unsigned int __stdcall sub_4014F2(int a1);
int sub_40153E();
int sub_40155E();
wchar_t *sub_40163A();
wchar_t *sub_401647();
__int16 __stdcall sub_401654(_WORD *a1);
void __stdcall sub_4016B4(int a1);
void __stdcall sub_4016E3(int a1);
unsigned int __stdcall sub_401713(_BYTE *a1, int a2);
int __stdcall sub_401769(unsigned int a1, int *a2);
__m128i *__stdcall sub_401787(int a1, _DWORD *a2);
const __m128i *__stdcall sub_40190A(__m128i *a1, int a2, _DWORD *a3, int a4);
const __m128i *__stdcall sub_401A6C(__m128i *a1, int a2, _DWORD *a3);
// int __usercall sub_40207C@<eax>(int result@<eax>, unsigned int a2, __m128i *a3, unsigned int a4);
unsigned int __stdcall sub_404CD8(unsigned int *a1, unsigned int a2);
unsigned __int32 __stdcall sub_4051E8(unsigned int *a1, _DWORD *a2);
unsigned int __stdcall sub_40565D(unsigned int *a1, unsigned int a2, unsigned int *a3, int a4);
int __stdcall sub_4056AB(int *a1);
int __stdcall sub_40570D(unsigned __int8 a1);
char __stdcall sub_405755(_BYTE *a1);
// int __userpurge sub_4057A7@<eax>(char *a1@<ebx>, char *a2);
char *__stdcall sub_40581D(int a1);
int __stdcall sub_405928(int a1);
int __stdcall sub_405A86(int a1, _DWORD *a2, int a3, int (__stdcall *a4)(int, _DWORD, int));
char *sub_405E5C();
int __stdcall sub_405F98(int a1);
int __stdcall sub_405FB3(int a1);
int __stdcall sub_405FCE(int a1, int a2);
unsigned int __stdcall sub_405FEC(int a1);
int __stdcall sub_406022(int a1);
int __stdcall sub_406035(int a1, int a2);
_DWORD *__stdcall sub_406083(int a1);
_DWORD *__stdcall sub_4060DF(_DWORD *a1, int a2);
_DWORD *__stdcall sub_406173(_DWORD *a1);
int sub_4061E7();
int __stdcall sub_406245(int a1);
int __stdcall sub_406393(int a1, int a2);
int sub_406438();
_BYTE *__stdcall sub_4064CC(_DWORD *a1);
unsigned int *__stdcall sub_4064FA(const void *a1, unsigned int a2);
int __stdcall sub_406531(int a1, _DWORD *a2);
char *sub_406568();
int __stdcall sub_4067F0(int a1);
int sub_406812();
int sub_406983();
unsigned int sub_4069C4();
int __stdcall sub_406A11(int a1);
int __stdcall sub_406AE4(int a1, int a2);
int __stdcall sub_406BBF(int a1);
int sub_406D7E();
int sub_40724F();
int __stdcall sub_407365(int a1);
int sub_4073C1();
int __stdcall sub_4074AF(int a1);
// unsigned int __usercall sub_40750F@<eax>(unsigned int a1@<ebx>);
_BYTE *__stdcall sub_407612(int a1);
_WORD *__stdcall sub_407D22(_WORD *a1, __int16 *a2);
char *__stdcall sub_407DBA(char *a1);
int __stdcall sub_407EA7(int a1);
// int __userpurge sub_407F4C@<eax>(int a1@<eax>, int a2, int a3, int a4);
int sub_408058();
int sub_40807E();
int __stdcall sub_408208(int a1, int a2, int a3);
int sub_4082BF();
int sub_4085C8();
int sub_408731();
int __stdcall sub_408766(int a1, int a2);
int __stdcall sub_4087E7(int a1, _DWORD *a2);
int __stdcall sub_408841(_DWORD *a1);
int __stdcall sub_408856(int a1, int a2, int a3);
int __stdcall sub_4088FB(int a1);
int __stdcall sub_40890B(int a1, int a2);
int __stdcall sub_4089A3(_DWORD *a1);
int __stdcall sub_4089CA(int a1, int a2);
int __stdcall sub_408A72(int a1);
int __stdcall sub_408A82(int a1, int a2);
int __stdcall sub_408B13(int a1);
int __stdcall sub_408B23(int a1, int a2);
int __stdcall sub_408BB4(_DWORD *a1);
int __stdcall sub_408BC9(int a1, int a2, int a3);
int __stdcall sub_408C6E(_DWORD *a1);
int __stdcall sub_408C89(int a1, int a2, int a3, int a4, int a5);
unsigned int __stdcall sub_408D3A(int a1, int a2);
int sub_408DC6();
int __stdcall sub_409019(int a1);
int __stdcall sub_4090E7(int a1);
int __stdcall sub_409249(int a1, int a2);
int __stdcall sub_4092E1(int a1);
int sub_40930C();
int __stdcall sub_40931A(int a1);
int __stdcall sub_4093D7(int a1);
BOOL sub_409494();
int sub_409524();
_DWORD *sub_409554();
_BYTE *__stdcall sub_409591(int a1, int a2, _BYTE *a3);
int sub_4095D6();
int __stdcall sub_409750(int a1);
int sub_4098D9();
_WORD *__stdcall sub_40998D(int a1);
BOOL __stdcall sub_409A17(int a1, int a2, _WORD *a3);
void __stdcall sub_409A57(int a1, int *a2);
int __stdcall sub_409B34(int a1);
int sub_409C58();
int sub_409E58();
int sub_409EC2();
int sub_409F23();
int sub_40A110();
int sub_40A134();
_DWORD *sub_40A2DA();
__int16 *sub_40A32A();
int sub_40A502();
// int __userpurge sub_40A5FB@<eax>(int result@<eax>, unsigned int *a2, int a3);
_WORD *sub_40AAE7();
_BYTE *sub_40AC81();
_BYTE *__stdcall sub_40ACC5(unsigned int *a1, char *a2);
// unsigned int *__usercall sub_40AEEE@<eax>(int a1@<edi>, int a2@<esi>);
// unsigned int *__userpurge sub_40B06A@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6);
int __stdcall sub_40B203(int a1);
int __stdcall sub_40B297(int a1);
int __stdcall sub_40B319(char a1);
int __stdcall sub_40B46A(char a1);
int sub_40B497();
int sub_40B790();
int __stdcall sub_40B80E(int a1);
// _DWORD *__userpurge sub_40B84A@<eax>(_DWORD *a1@<ebx>, unsigned __int8 *a2, unsigned int a3);
int __stdcall sub_40B8AE(int a1, int a2);
int __stdcall sub_40B9B6(int a1);
// int __userpurge sub_40BA64@<eax>(_DWORD *a1@<ebx>, int a2);
int __stdcall sub_40BB23(unsigned __int64 a1);
// int __userpurge sub_40BC06@<eax>(_DWORD *a1@<ebx>, int a2, unsigned __int64 a3);
int __stdcall sub_40BD96(int a1);
int __stdcall sub_40BDF8(int a1, int a2);
int __stdcall sub_40BE4A(_WORD *a1);
int __stdcall sub_40BEE0(_WORD *a1);
// int __userpurge sub_40BF33@<eax>(_DWORD *a1@<ebx>, int a2);
int __stdcall sub_40C190(_DWORD *a1);
int __stdcall sub_40C1B4(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9);
int __stdcall sub_40C286(_WORD *a1);
int __stdcall sub_40C2B4(int a1);
int __stdcall sub_40C2E9(int a1, int a2);
// int __userpurge sub_40C43B@<eax>(char *a1@<edx>, int *a2@<ecx>, int a3@<edi>, int a4@<esi>, int *a5);
// int *__usercall sub_40C8C1@<eax>(int a1@<edi>, int a2@<esi>);
int __stdcall sub_40CC27(_DWORD *a1);
int __stdcall sub_40CF4C(int a1, int a2);
unsigned int sub_40D009();
char *sub_40D244();
int __stdcall sub_40D34B(int a1, int a2, int a3, int a4);
int sub_40D591();
int sub_40D634();
_BYTE *__stdcall sub_40D701(_DWORD *a1, _DWORD *a2, _DWORD *a3);
int sub_40D8BF();
// int __usercall sub_40DAD0@<eax>(int a1@<ebp>);
int __stdcall sub_40DAE6(int a1, int a2);
_BYTE *__stdcall sub_40DB69(int a1);
int sub_40DC1D();
_WORD *sub_40DCF6();
int sub_40DD6F();
int __stdcall sub_40DE9F(int a1);
int sub_40DF10();
int sub_40DFA6();
_BYTE *sub_40DFEF();
_DWORD *__stdcall sub_40E032(int a1);
int __stdcall sub_40E414(int a1);
// _BYTE *__usercall sub_40E677@<eax>(unsigned int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// _WORD **__usercall sub_40E815@<eax>(int a1@<edi>, int a2@<esi>);
// void __usercall __noreturn start(int a1@<edi>, int a2@<esi>);
// HFONT __stdcall CreateFontW(int cHeight, int cWidth, int cEscapement, int cOrientation, int cWeight, DWORD bItalic, DWORD bUnderline, DWORD bStrikeOut, DWORD iCharSet, DWORD iOutPrecision, DWORD iClipPrecision, DWORD iQuality, DWORD iPitchAndFamily, LPCWSTR pszFaceName);
// HBRUSH __stdcall CreateSolidBrush(COLORREF color);
// int __stdcall GetDeviceCaps(HDC hdc, int index);
// int __stdcall GetTextCharset(HDC hdc);
// HPALETTE __stdcall SelectPalette(HDC hdc, HPALETTE hPal, BOOL bForceBkgd);
// HWND __stdcall CreateDialogParamW(HINSTANCE hInstance, LPCWSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);
// HMENU __stdcall CreateMenu();
// LRESULT __stdcall DefWindowProcW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// BOOL __stdcall EndDialog(HWND hDlg, INT_PTR nResult);
// int __stdcall GetClassNameW(HWND hWnd, LPWSTR lpClassName, int nMaxCount);
// HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem);
// UINT __stdcall GetDlgItemTextW(HWND hDlg, int nIDDlgItem, LPWSTR lpString, int cchMax);
// UINT __stdcall IsDlgButtonChecked(HWND hDlg, int nIDButton);
// HANDLE __stdcall LoadImageW(HINSTANCE hInst, LPCWSTR name, UINT type, int cx, int cy, UINT fuLoad);
// HMENU __stdcall LoadMenuW(HINSTANCE hInstance, LPCWSTR lpMenuName);
// DWORD __stdcall FormatMessageW(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPWSTR lpBuffer, DWORD nSize, va_list *Arguments);
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// UINT __stdcall GetAtomNameW(ATOM nAtom, LPWSTR lpBuffer, int nSize);
// LPSTR __stdcall GetCommandLineA();
// LPWSTR __stdcall GetCommandLineW();
// DWORD __stdcall GetFileAttributesW(LPCWSTR lpFileName);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// void __stdcall SetLastError(DWORD dwErrCode);

//-------------------------------------------------------------------------
// Data declarations

int RijnDael_AES_Base_4024B0[] = { -966564955 }; // weak
int dword_4028B0[] = { -1513725085 }; // weak
int dword_402CB0[] = { 1671808611 }; // weak
int dword_4030B0[] = { 1667474886 }; // weak
int dword_4034B0[] = { 1667457891 }; // weak
int dword_4038B0[] = { 1374988112 }; // weak
int dword_403CB0[] = { 1347548327 }; // weak
int dword_4040B0[] = { -1487908364 }; // weak
int dword_4044B0[] = { -190361519 }; // weak
int dword_404CB0[] = { 16777216 }; // weak
int dword_405AFC[48] =
{
  1662003290,
  -2098237902,
  1911811863,
  -2061378135,
  1280818422,
  -1406156874,
  939675170,
  571764622,
  -865309489,
  741632974,
  -1574690889,
  1280598199,
  1283202295,
  -1404822537,
  1279532791,
  543293567,
  2144742286,
  917647271,
  632433102,
  -1171157508,
  -580158615,
  -1501715677,
  484457652,
  1651464995,
  -1946439828,
  1728867,
  -1243767211,
  851019041,
  2109540137,
  733872799,
  1506352750,
  634271596,
  1525441786,
  -2085634174,
  2060070720,
  1314918130,
  -2067494372,
  871603095,
  -1624539692,
  2083460851,
  781019197,
  1217687540,
  943301367,
  -1797040680,
  -2080925982,
  58072436,
  1853959895,
  -858993460
}; // weak
int dword_405BBC[49] =
{
  -1812324213,
  -418915600,
  -536356112,
  1197840731,
  1970050616,
  1514562961,
  -635064112,
  -238140784,
  347148403,
  -34849603,
  -1919176836,
  -5928570,
  1467498432,
  783147662,
  2037657402,
  1764228785,
  -828924053,
  445147080,
  -1208942325,
  -401066634,
  1725424127,
  -352108148,
  2128962808,
  -1418524943,
  1780313023,
  1102755513,
  1581879714,
  -2086645371,
  -522828253,
  1405226981,
  -1808455031,
  -1601700689,
  -1192818472,
  2028407003,
  -1367415518,
  -2028539973,
  -263767032,
  755834441,
  1414863770,
  -1553394683,
  -1753572325,
  730189691,
  752679177,
  -246044949,
  -1431042144,
  653126272,
  -775569273,
  -1044526484,
  -858993460
}; // weak
int dword_405C80[23] =
{
  -1627633270,
  1786245628,
  -607842625,
  -537939674,
  971745888,
  1857701836,
  -314641316,
  -1209612545,
  782526430,
  -290326651,
  -1443665426,
  -2054633191,
  -1337002019,
  -792129842,
  -1526818982,
  -1659510070,
  -1068756097,
  -1539899315,
  -1069879180,
  -1456975075,
  -1386025008,
  1566602951,
  -858993460
}; // weak
int dword_405CDC[14] =
{
  1395981978,
  -839222781,
  -1392191262,
  1626283588,
  -2083881845,
  1106352202,
  -216255322,
  -2128533283,
  1823036922,
  -1166274051,
  -127011053,
  -354102331,
  -1884475854,
  -858993460
}; // weak
int dword_405D14[15] =
{
  305405911,
  -419030898,
  -2003685480,
  754007446,
  868008817,
  -1170693059,
  365818903,
  1842238000,
  -1373105042,
  30896312,
  1120818400,
  -1035106654,
  1900167208,
  1066524148,
  -858993460
}; // weak
int dword_405D50[5] = { 454979417, -1799524232, 849408409, 192363900, -858993460 }; // weak
int dword_405D64[8] =
{
  439623767,
  -2742946,
  1564467582,
  1435804892,
  2084521403,
  663826661,
  1010513533,
  -858993460
}; // weak
int dword_405D84[11] =
{
  -418760574,
  1526736390,
  -520248344,
  -444461868,
  -319334236,
  -752396310,
  -88708367,
  -1581644680,
  996080115,
  -194148361,
  -858993460
}; // weak
int dword_405DB0[4] = { -1609808050, -1985245434, -1595185338, -858993460 }; // weak
int dword_405DC0[3] = { -551794645, 968625711, -858993460 }; // weak
int dword_405DCC[6] = { 1676607482, 145954891, -127144901, 917750284, 630186033, -858993460 }; // weak
int dword_405DE4[12] =
{
  519719130,
  864615087,
  1201261425,
  1684525194,
  265863602,
  265863986,
  1514201340,
  -1932033112,
  1020563819,
  -422281240,
  -1564490247,
  -858993460
}; // weak
int dword_405E14[6] = { -507901462, 614610424, -2100246026, -519968136, -1674844470, -858993460 }; // weak
int dword_405E2C[12] =
{
  1424893688,
  -505853200,
  -631053081,
  -266893945,
  -1569904994,
  -2019032191,
  -43862159,
  1324734578,
  -1898223604,
  -1827085601,
  832084011,
  -858993460
}; // weak
int dword_4067C0[3] = { 257, 16777216, 0 }; // weak
int dword_4067CC[7] = { 1835010, 1, 1310720, 268435456, 257, 16777216, 0 }; // weak
int dword_4094E8[15] = { 17, 20, 36, 29, 14, 5, 33, 28, 13, 18, 8, 11, 9, 19, 0 }; // weak
_DWORD dword_410004[77] =
{
  -638030808,
  1430000763,
  -13392562,
  1787262184,
  2007724535,
  693504115,
  1968825125,
  1743934910,
  1507096075,
  -698784792,
  -1175383368,
  244792179,
  -1984923961,
  120221017,
  909984442,
  -2025173162,
  -89414246,
  1025941056,
  46314804,
  -488645469,
  -718362266,
  33573575,
  1411781883,
  2106133073,
  991181377,
  1890399470,
  -1835786355,
  -1784427857,
  822160432,
  1790954476,
  -545892293,
  421050490,
  -1772946169,
  504992643,
  373755982,
  -425801468,
  1393383270,
  -1319263231,
  -1683403757,
  -75421470,
  945614396,
  841638571,
  2143791842,
  1330257696,
  643449333,
  665921298,
  -1096821762,
  1301278665,
  2113056634,
  1586937506,
  -1292375684,
  1049950715,
  -188135841,
  -834779404,
  -61858831,
  17892760,
  1174519381,
  -1293269792,
  1945065009,
  -404105604,
  1672909501,
  900656159,
  -451296680,
  -1503706490,
  371589227,
  1136453100,
  -1304195986,
  -1730818486,
  985436779,
  1812602122,
  -1805932110,
  -822608586,
  111640961,
  -503281573,
  456688957,
  -1439365341,
  24912488
}; // weak
_DWORD dword_41013A[96] =
{
  -644583038,
  1432294426,
  -8477403,
  1794339977,
  2010018179,
  1510113025,
  1179751190,
  199588834,
  836924936,
  -236438227,
  -1181434078,
  515487315,
  -519861768,
  485047529,
  910810914,
  171820083,
  -1466192399,
  -1138602285,
  -367900444,
  -492118970,
  1577247385,
  213746,
  1411978493,
  2044458355,
  -991866850,
  -1915200406,
  -115669614,
  517458634,
  889967584,
  422911356,
  1417717569,
  1287304285,
  -1067380232,
  1274041232,
  508664611,
  1708680201,
  1494292223,
  -343595261,
  413812751,
  1030817871,
  1506504317,
  827500549,
  170340160,
  301634703,
  787356870,
  -883330445,
  2123138517,
  -958219727,
  -46422167,
  -1340350648,
  -1086052329,
  -26990185,
  909096458,
  202382559,
  1998920589,
  -172194286,
  272101224,
  1317700503,
  1942967874,
  -407865474,
  593007313,
  972841246,
  1853590194,
  -436970821,
  -1651899599,
  -1856660016,
  -877014411,
  1738646598,
  1378981492,
  -442703147,
  1194024345,
  1268629449,
  -1879444172,
  -1864208278,
  1059851890,
  1360524371,
  38674885,
  -398331694,
  1442021875,
  -1975424195,
  -1077269358,
  -417144342,
  -212381624,
  1905970118,
  1522184027,
  -193903601,
  -532893151,
  -426869153,
  -168198101,
  -9802021,
  1428505287,
  -1434766036,
  340626216,
  -1286520045,
  1478328345,
  513
}; // weak
_DWORD dword_4102BA[129] =
{
  -1854345438,
  1432305138,
  -8477659,
  1794339977,
  2010018179,
  695601153,
  1966662519,
  1736529360,
  1505326692,
  -1521740641,
  -1963105621,
  1654003041,
  814249669,
  545469337,
  910798626,
  -861731021,
  1125800614,
  653316078,
  45836540,
  -1432266804,
  704838297,
  -219614351,
  -1616134806,
  833096226,
  1930064321,
  953050929,
  1829559914,
  513488181,
  -164616109,
  1793781703,
  -1755948983,
  828243161,
  -1774977677,
  977229035,
  371462687,
  1601058415,
  1230809629,
  -1317194355,
  1665597560,
  -4545585,
  1894912349,
  1934829903,
  -189825681,
  -865072365,
  1861159256,
  804678650,
  -1365539058,
  465418994,
  1316693076,
  1992701262,
  -1829019074,
  -1115204366,
  -19527801,
  -1800026649,
  2132156402,
  -956816074,
  663371354,
  -1312649471,
  101700506,
  604741317,
  1026955673,
  2103947593,
  -313291088,
  -1235544469,
  1075467589,
  1883008712,
  -1704392767,
  -1194048222,
  1528697519,
  -1392315734,
  1277928471,
  1055931847,
  1309084348,
  -1187549788,
  1474250255,
  -10743948,
  -1428459206,
  1364219110,
  -1696531006,
  -618290354,
  -843420751,
  -467662893,
  -1961088710,
  -130421393,
  -585542882,
  -2042913844,
  385047092,
  -1112379673,
  -1232155152,
  981607571,
  76988424,
  -1427064743,
  560405841,
  245536003,
  1347864844,
  -832655323,
  2045333165,
  355956458,
  142907130,
  1550972695,
  -1559947219,
  -1490152724,
  97201145,
  1193193289,
  -777195859,
  -476375803,
  87605141,
  1864692191,
  1726784457,
  -380375682,
  -491776767,
  -1726650339,
  566487915,
  702059417,
  1101602257,
  -295197611,
  -1464977542,
  137152776,
  645185464,
  -721130900,
  -102354691,
  -207386802,
  542128460,
  445462264,
  1219875517,
  1072857344,
  -703328640,
  1129775890,
  184149
}; // weak
_DWORD dword_4104BF[180] =
{
  -646160640,
  -698412006,
  880509217,
  1017127361,
  1067200724,
  700900480,
  -126819465,
  1728147836,
  -1628342684,
  700947548,
  2136169013,
  -250755924,
  1981067745,
  -1095986476,
  1513034709,
  -2026899237,
  -1089606214,
  1028300508,
  1463221524,
  -1625058244,
  -1736186372,
  -907935159,
  478357458,
  1569476325,
  991824460,
  1418130418,
  -1829544059,
  738670026,
  -1870011105,
  1791734891,
  350031945,
  -382979242,
  -621447617,
  -650945496,
  369374315,
  431933807,
  1976233687,
  -325730253,
  -741585799,
  -1224121078,
  1893055383,
  -845111293,
  1285728911,
  -2068622448,
  41470160,
  1662349139,
  -1094714461,
  -1968771142,
  2108132184,
  379305614,
  -1968525903,
  1054996884,
  -790593225,
  -833796415,
  -1195945083,
  24661466,
  -2127708613,
  -1298177916,
  -1932569022,
  -1466732598,
  1648067390,
  2107960339,
  -695234638,
  1716258608,
  1777389810,
  -1413589702,
  -1305178899,
  -1729871066,
  -1030481589,
  -1423257831,
  -1809278691,
  -1975339710,
  113549776,
  848726063,
  615227371,
  -1429016758,
  1992630888,
  -789644054,
  -632363213,
  -14809,
  87368577,
  594081662,
  5547135,
  1964361835,
  -585516197,
  -894121401,
  -1648375188,
  1936764504,
  -180324696,
  -907746841,
  -767487731,
  -283581182,
  -1995189036,
  1977498638,
  -619101628,
  901465618,
  -1130366575,
  1123192459,
  474466069,
  -1543953316,
  -595549560,
  202879472,
  -1932230451,
  1310011239,
  442965980,
  1822723326,
  -710559941,
  280654007,
  -311887399,
  -612042490,
  -1467375114,
  237807831,
  -781470010,
  764598290,
  -19378052,
  2091711612,
  -676618709,
  -2095544473,
  779378576,
  564703844,
  1533721144,
  -987674972,
  -1890521449,
  -650495630,
  -439951371,
  -1112555565,
  -2123889840,
  1298074884,
  -1091848000,
  1751397319,
  -294372284,
  -354554273,
  -984481465,
  -1762778772,
  -26620587,
  345582868,
  1854057058,
  -613229349,
  484757064,
  1760419921,
  1663983272,
  -568635625,
  -1642129741,
  -1541342344,
  -1609079727,
  -411443985,
  1373715346,
  -1362531876,
  -1345104554,
  -1740912334,
  -780197105,
  1863624755,
  741215775,
  -1572746035,
  -975359211,
  1861103927,
  1027914483,
  698430327,
  1498941855,
  -1739595149,
  132859298,
  -631328718,
  -1629168903,
  1957311069,
  -1809263394,
  574805192,
  1698150490,
  -1436650823,
  -1495388738,
  1539830530,
  174634748,
  -774946474,
  161430003,
  883330925,
  -1939887408,
  -1406041854,
  568470922,
  -516443322,
  673243234,
  -234684620
}; // weak
_DWORD dword_410792[61] =
{
  -637768632,
  1428952181,
  -14572207,
  1788638433,
  2008707568,
  689375343,
  1969087258,
  1740330482,
  1503426118,
  -702913556,
  -1181150490,
  248527705,
  -1984137535,
  120024408,
  909918869,
  -2025107648,
  -85416504,
  1030266390,
  46708017,
  -494478098,
  -721114855,
  33639043,
  1412437240,
  2113342038,
  997014051,
  1895314584,
  -1831460977,
  -1779053895,
  829762620,
  1793641353,
  -549890015,
  420329581,
  -1772618452,
  504796108,
  374149198,
  -425932543,
  1396791101,
  -1324440512,
  -1679799206,
  -67426166,
  944631358,
  841769643,
  2142808804,
  1330257713,
  642007551,
  669525841,
  -1097149531,
  1305276361,
  2107289392,
  1589231236,
  -1293817570,
  1050016231,
  -188201440,
  -836548896,
  -61727774,
  22676932,
  1175895582,
  -1293728542,
  1942312527,
  -403450305,
  8032977
}; // weak
_DWORD dword_410888[31] =
{
  -644256751,
  1434260496,
  -15227583,
  1788376314,
  2007003612,
  689637472,
  1964696338,
  1738757610,
  1506440769,
  -703306819,
  -1180822841,
  244726641,
  -1985972544,
  118254912,
  908083897,
  -2025107639,
  -84892264,
  1030725134,
  43627873,
  -492315424,
  -718493410,
  35343047,
  1411781874,
  2111507069,
  996424229,
  1893741791,
  -1831788649,
  -1784493329,
  829762610,
  1790430089,
  2906185
}; // weak
_DWORD dword_410906[12] =
{
  -638555064,
  1428952179,
  -15882930,
  1788507350,
  2007527917,
  693373038,
  1969480525,
  1737184733,
  1506440769,
  -701340782,
  -1181478249,
  58
}; // weak
_UNKNOWN unk_410936; // weak
_DWORD dword_410A78[51] =
{
  -643928985,
  1430000731,
  -14965434,
  1787262201,
  2012115385,
  693700651,
  1966465885,
  1740789210,
  1507292683,
  -698522639,
  -1176497495,
  245185338,
  -1981188409,
  121138443,
  908870319,
  -2029826237,
  -89741861,
  1027382853,
  45528433,
  -487859002,
  -714233481,
  35211972,
  1416500451,
  2110130791,
  997276207,
  1890268382,
  -1835786301,
  -1778922768,
  822226039,
  1790626794,
  -545892251,
  421312634,
  -1772094187,
  504337346,
  369627210,
  -421738161,
  1399740277,
  -1321294737,
  -1683862505,
  -74176269,
  944893554,
  839607017,
  2140646121,
  1325539125,
  643318204,
  665462550,
  -1097804813,
  1300426698,
  2113843069,
  1587265248,
  82
}; // weak
_DWORD dword_410B44[21] =
{
  -73506543,
  170621816,
  -1945321389,
  1218255840,
  82531257,
  595272739,
  22511957,
  1172651151,
  714888286,
  -600485955,
  -839159576,
  1671256076,
  -256043047,
  577853193,
  322009828,
  -1571391715,
  -541942380,
  405972482,
  146184502,
  -391663639,
  13871465
}; // weak
_DWORD dword_410B9A[53] =
{
  -73506543,
  170621816,
  -1945321389,
  1218255840,
  82531257,
  595272739,
  22511957,
  1172651151,
  714888286,
  -600485955,
  -839159576,
  1671256076,
  -256043047,
  577853193,
  322009828,
  -1571391715,
  -541942380,
  405972482,
  146184502,
  -2082557970,
  -1183844768,
  1796150733,
  1982886395,
  143468568,
  823334510,
  297158552,
  -40025895,
  -72182338,
  1090608755,
  1219407607,
  -1435272589,
  326407228,
  -146305455,
  1997065431,
  738620757,
  -993137587,
  1902729771,
  -770122752,
  -190498803,
  -1836746775,
  34048881,
  271206374,
  1575856060,
  1029270307,
  1331175144,
  502284830,
  -1664420187,
  1877271190,
  234412911,
  871549649,
  -1867199725,
  868453553,
  1386494837
}; // weak
_DWORD dword_410C71[21] =
{
  -639931335,
  1426789468,
  -12606094,
  1790342363,
  2006872543,
  689571950,
  1968956190,
  1743017401,
  1508210199,
  -699309102,
  -1176104279,
  243350332,
  -1984596282,
  118451551,
  908083869,
  -2025173155,
  -88234539,
  1024892511,
  49591643,
  -487596914,
  3320084
}; // weak
_DWORD dword_410CC7[13] =
{
  -637703122,
  1430131817,
  -15555257,
  1789097196,
  2007462385,
  689375351,
  1967252244,
  1744393621,
  1507620372,
  -699309075,
  -1174793553,
  244792112,
  7108265
}; // weak
_DWORD dword_410CFD[28] =
{
  -639931335,
  1426789468,
  -12606094,
  1790342363,
  2005103071,
  689244264,
  1968694021,
  1743672739,
  1506637314,
  -697343037,
  -1174793565,
  245185335,
  -1985972514,
  119368971,
  907362974,
  -2024059024,
  -88562232,
  1025809993,
  49132896,
  -489104215,
  -714626713,
  34032334,
  1410602187,
  2110130763,
  997276192,
  1890399453,
  -1829560381,
  30
}; // weak
_DWORD dword_410D6D[8] =
{
  -639538133,
  1429214318,
  -15030940,
  1788507364,
  2005037549,
  688982126,
  1968628504,
  2119120
}; // weak
_DWORD dword_410D8F[9] =
{
  -638489554,
  1430131836,
  -15555248,
  1789293821,
  2007724528,
  691538035,
  1968562966,
  1736529333,
  36
}; // weak
_DWORD dword_410DB3[10] =
{
  -638489554,
  1430131836,
  -15555248,
  1790407933,
  2007200236,
  689899616,
  1970725657,
  1743541681,
  1505326593,
  32
}; // weak
_DWORD dword_410DDB[9] =
{
  -638489554,
  1430131836,
  -15555248,
  1789097213,
  2008904162,
  687933554,
  1967842072,
  1736529332,
  40
}; // weak
_UNKNOWN unk_410DFF; // weak
_UNKNOWN unk_410E2B; // weak
_UNKNOWN unk_410E57; // weak
_UNKNOWN unk_410E83; // weak
_DWORD dword_410EA6[26] =
{
  -639931335,
  1426789468,
  -12606094,
  1790342363,
  2005103071,
  689244264,
  1968694021,
  1743672739,
  1506637314,
  -697343037,
  -1174793565,
  245185335,
  -1985972514,
  118517111,
  909853375,
  -2025107647,
  -88169004,
  1026530938,
  46708070,
  -490349403,
  -716002950,
  35408627,
  1410077945,
  2110458444,
  991836713,
  -570843118
}; // weak
_DWORD dword_410F10[32] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // weak
unsigned int dword_410F90[4] = { 0u, 0u, 0u, 0u }; // weak
unsigned int dword_410FA0[4] = { 0u, 0u, 0u, 0u }; // weak
char byte_410FB0 = '\0'; // weak
char byte_410FB1 = '\0'; // weak
char byte_410FB2 = '\0'; // weak
char byte_410FB3 = '\0'; // weak
char byte_410FB4 = '\0'; // weak
char byte_410FB5 = '\0'; // weak
char byte_410FB6 = '\0'; // weak
char byte_410FB7 = '\0'; // weak
int dword_410FB8 = 0; // weak
int dword_410FBC = 0; // weak
int dword_410FC0 = 0; // weak
int dword_410FC4 = 0; // weak
int dword_410FC8 = 0; // weak
int dword_410FCC = 0; // weak
int dword_410FD0 = 0; // weak
int dword_410FD4 = 0; // weak
int dword_410FD8 = 0; // weak
int dword_410FDC = 0; // weak
int dword_410FE0 = 0; // weak
int dword_410FE4 = 0; // weak
int dword_410FE8 = 0; // weak
int dword_410FEC = 0; // weak
int dword_410FF0 = 0; // weak
int dword_410FF4 = 0; // weak
int dword_410FF8 = 0; // weak
int dword_410FFC = 0; // weak
int dword_411000; // weak
int dword_411004; // weak
int dword_411008; // weak
int dword_41100C; // weak
_DWORD dword_411010[64]; // weak
_DWORD dword_411110[64]; // weak
int dword_411210; // weak
int (__stdcall *dword_411214)(_DWORD); // weak
int (__stdcall *dword_411218)(_DWORD, _DWORD); // weak
int (__stdcall *dword_41121C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411220)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411224)(_DWORD); // weak
int (__stdcall *dword_411228)(_DWORD); // weak
_WORD word_41122C[64]; // weak
_UNKNOWN unk_4112AC; // weak
int (__stdcall *dword_4112B0)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4112B4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4112B8)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_4112C4)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_4112C8)(_DWORD); // weak
int (__cdecl *dword_4112CC)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112D4)(_DWORD); // weak
int (__cdecl *dword_4112D8)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112DC)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112E0)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112E4)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112E8)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112EC)(_DWORD, _DWORD); // weak
int (__cdecl *dword_4112F0)(_DWORD); // weak
int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_4112F8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_4112FC)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
__int64 (__stdcall *dword_411300)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41130C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411310)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411314)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411318)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41131C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411320)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411324)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411328)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411330)(_DWORD); // weak
int (__stdcall *dword_411334)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411338)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41133C)(_DWORD); // weak
int (__stdcall *dword_411340)(_DWORD); // weak
int (__stdcall *dword_411344)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411348)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41134C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411350)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411354)(_DWORD); // weak
int (__stdcall *dword_411358)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41135C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411360)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411364)(_DWORD, _DWORD); // weak
_UNKNOWN unk_411368; // weak
int (__stdcall *dword_41136C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411370)(_DWORD); // weak
int (__stdcall *dword_411374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411378)(_DWORD, _DWORD); // weak
int (__stdcall *dword_41137C)(_DWORD); // weak
int (__stdcall *dword_411380)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411384)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41138C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411390)(_DWORD); // weak
int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411398)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41139C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113A0)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4113A4)(_DWORD); // weak
int (__stdcall *dword_4113A8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113AC)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4113B0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113B4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113B8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113BC)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113C0)(_DWORD); // weak
int (__stdcall *dword_4113C4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4113C8)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4113CC)(_DWORD); // weak
int (__stdcall *dword_4113D0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113D4)(_DWORD); // weak
int (__stdcall *dword_4113D8)(_DWORD); // weak
int (__stdcall *dword_4113DC)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113E0)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4113E4)(_DWORD); // weak
int (__stdcall *dword_4113E8)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4113EC)(_DWORD); // weak
int (*dword_4113F0)(void); // weak
int (__stdcall *dword_4113F4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4113F8)(_DWORD, _DWORD); // weak
int (*dword_4113FC)(void); // weak
int (__stdcall *dword_411400)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411408)(_DWORD, _DWORD); // weak
int (__stdcall *dword_41140C)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411410)(_DWORD); // weak
int (__stdcall *dword_411414)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411418)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41141C)(_DWORD); // weak
int (__stdcall *dword_411420)(_DWORD, _DWORD); // weak
int dword_411424; // weak
_UNKNOWN unk_411428; // weak
int (__stdcall *dword_41142C)(_DWORD); // weak
int (__stdcall *dword_411430)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411434)(_DWORD); // weak
int (__stdcall *dword_411438)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411444)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411448)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41144C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411450)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411454)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411458)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41145C)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411460)(_DWORD); // weak
int (__stdcall *dword_411464)(_DWORD); // weak
int (__stdcall *dword_411468)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41146C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411470)(_DWORD, _DWORD); // weak
int (__stdcall *dword_411474)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411478)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41147C)(_DWORD); // weak
_UNKNOWN unk_411480; // weak
int (__stdcall *dword_411484)(_DWORD); // weak
int (__stdcall *dword_411488)(_DWORD, _DWORD); // weak
int (__stdcall *dword_41148C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411490)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411494)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411498)(_DWORD); // weak
int (__stdcall *dword_41149C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4114A0)(_DWORD); // weak
int (__stdcall *dword_4114A4)(_DWORD); // weak
int dword_4114A8; // weak
int dword_4114AC; // weak
int (__stdcall *dword_4114B0)(_DWORD); // weak
_UNKNOWN unk_4114B4; // weak
int (__stdcall *dword_4114B8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4114BC)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114C0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4114C4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114C8)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4114CC)(_DWORD); // weak
int (__stdcall *dword_4114D0)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114D4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4114D8)(_DWORD); // weak
int (__stdcall *dword_4114DC)(_DWORD); // weak
int (__stdcall *dword_4114E0)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114E4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114E8)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
_UNKNOWN unk_4114EC; // weak
int (__stdcall *dword_4114F0)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114F4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4114F8)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
_UNKNOWN unk_4114FC; // weak
int (__stdcall *dword_411500)(_DWORD); // weak
int (__cdecl *dword_411504)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411508)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411510)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411514)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
_UNKNOWN unk_411518; // weak
int (__stdcall *dword_41151C)(_DWORD); // weak
int (__stdcall *dword_411520)(_DWORD); // weak
int (__stdcall *dword_411528)(_DWORD); // weak
int (__stdcall *dword_41152C)(_DWORD); // weak
int (__stdcall *dword_411534)(_DWORD); // weak
int (__stdcall *dword_411538)(_DWORD); // weak
int (__stdcall *dword_41153C)(_DWORD); // weak
_UNKNOWN unk_411540; // weak
int (__stdcall *dword_411544)(_DWORD); // weak
int (__stdcall *dword_411548)(_DWORD); // weak
_UNKNOWN unk_41154C; // weak
int (__stdcall *dword_411550)(_DWORD, _DWORD); // weak
_UNKNOWN unk_411554; // weak
int (__stdcall *dword_411558)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41155C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411560)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411564)(_DWORD); // weak
_UNKNOWN unk_411568; // weak
int (__stdcall *dword_41156C)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411570)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411574)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411578)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411580)(_DWORD); // weak
int (__stdcall *dword_411584)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411588)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_41158C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_411590)(_DWORD); // weak
_UNKNOWN unk_411594; // weak
int (__stdcall *dword_411598)(_DWORD, _DWORD); // weak
int (__stdcall *dword_41159C)(_DWORD, _DWORD); // weak
int (__stdcall *dword_4115A0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115A4)(_DWORD); // weak
_UNKNOWN unk_4115A8; // weak
int (__stdcall *dword_4115AC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115B0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115B4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115B8)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115BC)(_DWORD); // weak
int (__stdcall *dword_4115C0)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115C4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115C8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115CC)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4115D0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_4115D4; // weak
int dword_4115D8; // weak
int dword_4115DC; // weak
int dword_4115E0; // weak
int dword_4115E4; // weak
int dword_4115E8; // weak


//----- (00401014) --------------------------------------------------------
int sub_401014()
{
  int result; // eax
  unsigned __int64 v14; // rax
  int v15; // ecx

  _EAX = 1;
  __asm { cpuid }
  if ( (_ECX & 0x40000000) != 0 )
  {
    __asm
    {
      rdrand  eax
      rdrand  edx
    }
  }
  else
  {
    _EAX = 7;
    __asm { cpuid }
    if ( (_EBX & 0x40000) != 0 )
    {
      __asm
      {
        rdseed  eax
        rdseed  edx
      }
    }
    else
    {
      v14 = __rdtsc();
      v15 = __ROR4__(v14, 13);
      __rdtsc();
      return v15;
    }
  }
  return result;
}

//----- (00401061) --------------------------------------------------------
unsigned int __stdcall sub_401061(unsigned int a1, unsigned int a2)
{
  unsigned int result; // eax

  do
  {
    do
      result = ((1103515245 * sub_401014() + 12345) & 0x7FFFFFFu) % a2;
    while ( result < a1 );
  }
  while ( result > a2 );
  return result;
}

//----- (00401096) --------------------------------------------------------
int __stdcall sub_401096(_BYTE *a1, int a2)
{
  int v2; // eax

  v2 = 0;
  do
  {
    LOBYTE(v2) = *a1++;
    a2 = v2 + __ROR4__(a2, 13);
  }
  while ( v2 );
  return a2;
}

//----- (004010BB) --------------------------------------------------------
int __stdcall sub_4010BB(_WORD *a1, int a2)
{
  int v2; // eax

  HIWORD(v2) = 0;
  do
  {
    LOWORD(v2) = *a1++;
    if ( (unsigned __int16)v2 >= 0x41u && (unsigned __int16)v2 <= 0x5Au )
      LOWORD(v2) = v2 | 0x20;
    a2 = v2 + __ROR4__(a2, 13);
  }
  while ( v2 );
  return a2;
}

//----- (004010F1) --------------------------------------------------------
int __stdcall sub_4010F1(__int16 *a1, _BYTE *a2)
{
  int i; // ebx
  __int16 v5; // ax

  for ( i = 0; ; ++i )
  {
    v5 = *a1++;
    if ( !v5 )
      break;
    *a2++ = v5;
  }
  *a2 = 0;
  return i;
}

//----- (00401116) --------------------------------------------------------
int __stdcall sub_401116(unsigned __int8 *a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // eax
  unsigned int v5; // ebx
  bool i; // zf
  int v8; // edi

  v3 = a2;
  v4 = (unsigned __int16)a3;
  v5 = HIWORD(a3);
  for ( i = a2 == 0; !i; i = v3 == 0 )
  {
    v8 = 4001;
    if ( v3 < 0xFA1 )
      v8 = v3;
    v3 -= v8;
    do
    {
      v4 += *a1++;
      v5 += v4;
      --v8;
    }
    while ( v8 );
    v5 %= 0x1000Fu;
    v4 %= 0x1000Fu;
  }
  return (v5 << 16) + v4;
}

//----- (0040117B) --------------------------------------------------------
_BYTE *__stdcall sub_40117B(char *a1, _BYTE *a2)
{
  _BYTE *v3; // edi
  char v4; // dl
  char v5; // al
  int i; // ebx
  bool v7; // cf
  char v8; // dl
  char v9; // tt
  bool v10; // cf
  char v11; // dl
  char v12; // tt
  int v13; // eax
  bool v14; // cf
  char v15; // dl
  char v16; // tt
  bool v17; // cf
  char v18; // dl
  char v19; // dl
  char v20; // tt
  BOOL v21; // eax
  bool v22; // cf
  char v23; // dl
  char v24; // dl
  char v25; // tt
  int v26; // eax
  bool v27; // cf
  char v28; // dl
  char v29; // dl
  char v30; // tt
  int v31; // eax
  bool v32; // cf
  char v33; // dl
  char v34; // tt
  int v35; // eax
  int v36; // eax
  bool v37; // cf
  char v38; // dl
  char v39; // dl
  char v40; // tt
  bool v41; // cf
  char v42; // dl
  char v43; // tt
  int v44; // eax
  unsigned int v45; // ecx
  bool v46; // cf
  char v47; // dl
  char v48; // dl
  char v49; // tt
  bool v50; // cf
  char v51; // dl
  char v52; // tt
  unsigned int v53; // eax
  int v54; // ecx
  bool v55; // cf
  char v56; // dl
  char v57; // dl
  char v58; // tt
  bool v59; // cf
  char v60; // dl
  char v61; // tt
  unsigned int v62; // ecx
  unsigned __int8 v63; // al
  char v64; // cf
  unsigned int v65; // ecx
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v3 = a2;
  v4 = 0x80;
LABEL_2:
  v5 = *a1++;
  *v3++ = v5;
  for ( i = 2; ; i = 1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v7 = __CFADD__(v4, v4);
        v4 *= 2;
        if ( !v4 )
        {
          v8 = *a1++;
          v9 = v7 + v8;
          v7 = __CFADD__(v7, v8) | __CFADD__(v8, v7 + v8);
          v4 = v8 + v9;
        }
        if ( !v7 )
          goto LABEL_2;
        v10 = __CFADD__(v4, v4);
        v4 *= 2;
        if ( !v4 )
        {
          v11 = *a1++;
          v12 = v10 + v11;
          v10 = __CFADD__(v10, v11) | __CFADD__(v11, v10 + v11);
          v4 = v11 + v12;
        }
        if ( v10 )
          break;
        v36 = 1;
        do
        {
          v37 = __CFADD__(v4, v4);
          v38 = 2 * v4;
          if ( !v38 )
          {
            v39 = *a1++;
            v40 = v37 + v39;
            v37 = __CFADD__(v37, v39) | __CFADD__(v39, v37 + v39);
            v38 = v39 + v40;
          }
          v36 += v37 + v36;
          v41 = __CFADD__(v38, v38);
          v4 = 2 * v38;
          if ( !v4 )
          {
            v42 = *a1++;
            v43 = v41 + v42;
            v41 = __CFADD__(v41, v42) | __CFADD__(v42, v41 + v42);
            v4 = v42 + v43;
          }
        }
        while ( v41 );
        v44 = v36 - i;
        i = 1;
        if ( v44 )
        {
          v53 = (v44 - 1) << 8;
          LOBYTE(v53) = *a1++;
          v54 = 1;
          do
          {
            v55 = __CFADD__(v4, v4);
            v56 = 2 * v4;
            if ( !v56 )
            {
              v57 = *a1++;
              v58 = v55 + v57;
              v55 = __CFADD__(v55, v57) | __CFADD__(v57, v55 + v57);
              v56 = v57 + v58;
            }
            v54 += v55 + v54;
            v59 = __CFADD__(v56, v56);
            v4 = 2 * v56;
            if ( !v4 )
            {
              v60 = *a1++;
              v61 = v59 + v60;
              v59 = __CFADD__(v59, v60) | __CFADD__(v60, v59 + v60);
              v4 = v60 + v61;
            }
          }
          while ( v59 );
          v62 = (v53 < 0x80) + (v53 < 0x80) + v54 - ((v53 < 0x7D00) - 1) - ((v53 < 0x500) - 1);
          qmemcpy(v3, &v3[-v53], v62);
          v3 += v62;
        }
        else
        {
          v45 = 1;
          do
          {
            v46 = __CFADD__(v4, v4);
            v47 = 2 * v4;
            if ( !v47 )
            {
              v48 = *a1++;
              v49 = v46 + v48;
              v46 = __CFADD__(v46, v48) | __CFADD__(v48, v46 + v48);
              v47 = v48 + v49;
            }
            v45 += v46 + v45;
            v50 = __CFADD__(v47, v47);
            v4 = 2 * v47;
            if ( !v4 )
            {
              v51 = *a1++;
              v52 = v50 + v51;
              v50 = __CFADD__(v50, v51) | __CFADD__(v51, v50 + v51);
              v4 = v51 + v52;
            }
          }
          while ( v50 );
          qmemcpy(v3, (const void *)(v3 - (_BYTE *)&savedregs), v45);
          v3 += v45;
        }
      }
      v13 = 0;
      v14 = __CFADD__(v4, v4);
      v4 *= 2;
      if ( !v4 )
      {
        v15 = *a1++;
        v16 = v14 + v15;
        v14 = __CFADD__(v14, v15) | __CFADD__(v15, v14 + v15);
        v4 = v15 + v16;
      }
      if ( !v14 )
        break;
      v17 = __CFADD__(v4, v4);
      v18 = 2 * v4;
      if ( !v18 )
      {
        v19 = *a1++;
        v20 = v17 + v19;
        v17 = __CFADD__(v17, v19) | __CFADD__(v19, v17 + v19);
        v18 = v19 + v20;
      }
      v21 = v17;
      v22 = __CFADD__(v18, v18);
      v23 = 2 * v18;
      if ( !v23 )
      {
        v24 = *a1++;
        v25 = v22 + v24;
        v22 = __CFADD__(v22, v24) | __CFADD__(v24, v22 + v24);
        v23 = v24 + v25;
      }
      v26 = v21 + v22 + v21;
      v27 = __CFADD__(v23, v23);
      v28 = 2 * v23;
      if ( !v28 )
      {
        v29 = *a1++;
        v30 = v27 + v29;
        v27 = __CFADD__(v27, v29) | __CFADD__(v29, v27 + v29);
        v28 = v29 + v30;
      }
      v31 = v26 + v27 + v26;
      v32 = __CFADD__(v28, v28);
      v4 = 2 * v28;
      if ( !v4 )
      {
        v33 = *a1++;
        v34 = v32 + v33;
        v32 = __CFADD__(v32, v33) | __CFADD__(v33, v32 + v33);
        v4 = v33 + v34;
      }
      v35 = v31 + v32 + v31;
      if ( v35 )
        LOBYTE(v35) = v3[-v35];
      *v3++ = v35;
      i = 2;
    }
    v63 = *a1++;
    v64 = v63 & 1;
    LOBYTE(v13) = v63 >> 1;
    if ( !(_BYTE)v13 )
      break;
    v65 = v64 + 2;
    qmemcpy(v3, &v3[-v13], v65);
    v3 += v65;
  }
  return (_BYTE *)(v3 - a2);
}

//----- (004012CE) --------------------------------------------------------
int __stdcall sub_4012CE(char *a1, _BYTE *a2)
{
  int *v2; // edi
  int v3; // ecx
  char v4; // al
  _BYTE *v5; // edi
  _BYTE *v6; // edi
  int v7; // ecx
  char v8; // al
  _BYTE *v9; // edi
  int v10; // ecx
  char *v11; // edi
  char *v12; // esi
  char v13; // al
  int result; // eax
  unsigned int v15; // ebx
  bool v16; // dl
  bool v17; // zf
  int v19; // ebx
  char v20; // al
  unsigned __int8 v21; // ah
  int v22; // ecx
  __int16 v23; // kr00_2
  char v24; // bh
  int v25; // [esp-14h] [ebp-11Ch]
  char v26[48]; // [esp+4h] [ebp-104h] BYREF
  int v27; // [esp+34h] [ebp-D4h] BYREF
  int v28; // [esp+104h] [ebp-4h]

  v26[0] = 0;
  memset(&v26[1], 255, 0x2Au);
  v26[43] = 62;
  memset(&v26[44], 255, 3u);
  v26[47] = 63;
  v2 = &v27;
  v3 = 10;
  v4 = 52;
  do
  {
    *(_BYTE *)v2 = v4;
    v2 = (int *)((char *)v2 + 1);
    ++v4;
    --v3;
  }
  while ( v3 );
  memset(v2, 255, 3u);
  v5 = (char *)v2 + 3;
  *v5++ = 0;
  memset(v5, 255, 3u);
  v6 = v5 + 3;
  v7 = 26;
  v8 = 0;
  do
  {
    *v6++ = v8++;
    --v7;
  }
  while ( v7 );
  memset(v6, 255, 6u);
  v9 = v6 + 6;
  v10 = 26;
  do
  {
    *v9++ = v8++;
    --v10;
  }
  while ( v10 );
  memset(v9, 255, 0x85u);
  v11 = a1;
  v12 = a1;
  do
  {
    v13 = *v11;
    v11 += 4;
  }
  while ( v13 );
  result = 61;
  v15 = v11 - 4 - a1;
  if ( v11 - 4 != a1 )
  {
    v16 = *(v11 - 5) == 61;
    if ( *(v11 - 5) == 61 )
      *(v11 - 5) = 0;
    v17 = *(v11 - 6) == 61;
    if ( *(v11 - 6) == 61 )
      *(v11 - 6) = 0;
    LOBYTE(result) = v16 + v17;
    v19 = v15 >> 2;
    v25 = 3 * v19 - result;
    v28 = v19;
    do
    {
      v20 = v26[(unsigned __int8)*(_DWORD *)v12];
      v21 = v26[BYTE1(*(_DWORD *)v12)];
      v22 = HIWORD(*(_DWORD *)v12);
      v12 += 4;
      v23 = (unsigned __int8)v26[(unsigned __int8)v22] << 6;
      v24 = v23 | v26[BYTE1(v22)];
      *a2 = (v21 >> 4) | (4 * v20);
      a2[2] = v24;
      a2[1] = HIBYTE(v23) | (16 * v21);
      v17 = v28-- == 1;
      a2 += 3;
    }
    while ( !v17 );
    return v25;
  }
  return result;
}
// 4012CE: using guessed type char var_104[48];

//----- (004013EE) --------------------------------------------------------
char *__userpurge sub_4013EE@<eax>(int a1@<ebx>, _BYTE *a2, int a3, int *a4)
{
  int *v5; // edi
  unsigned __int16 v6; // ax
  char v8[64]; // [esp+4h] [ebp-44h] BYREF
  int v9; // [esp+44h] [ebp-4h]

  qmemcpy(v8, "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", sizeof(v8));
  v9 = a3;
  v5 = a4;
  do
  {
    if ( !v9 )
      break;
    LOBYTE(v6) = v8[*a2 >> 2];
    HIBYTE(v6) = v8[(unsigned __int8)((a2[1] >> 4) | (16 * (*a2 & 3)))];
    LOBYTE(a1) = v8[(unsigned __int8)((4 * (a2[1] & 0xF)) | (a2[2] >> 6))];
    BYTE1(a1) = v8[a2[2] & 0x3F];
    a1 <<= 16;
    a2 += 3;
    *v5++ = a1 | v6;
    v9 -= 3;
  }
  while ( v9 > 0 );
  if ( v9 )
  {
    v5 = (int *)((char *)v5 + v9);
    do
    {
      *(_BYTE *)v5 = 61;
      v5 = (int *)((char *)v5 + 1);
      ++v9;
    }
    while ( v9 );
  }
  *(_WORD *)v5 = 0;
  return (char *)((char *)v5 - (char *)a4);
}
// 4013EE: using guessed type char var_44[64];

//----- (004014F2) --------------------------------------------------------
unsigned int __stdcall sub_4014F2(int a1)
{
  int v1; // edi
  int i; // ebx

  v1 = 0;
  for ( i = 0; *(_BYTE *)(a1 + i); ++i )
    ;
  if ( i )
  {
    if ( *(_BYTE *)(a1 + i - 1) == 61 && *(_BYTE *)(a1 + i - 2) == 61 )
    {
      v1 = 2;
    }
    else if ( *(_BYTE *)(a1 + i - 1) == 61 )
    {
      v1 = 1;
    }
  }
  return ((unsigned int)(3 * i) >> 2) - v1;
}

//----- (0040153E) --------------------------------------------------------
int sub_40153E()
{
  int v0; // ebx
  unsigned int NumberOfProcessors; // eax

  v0 = 0;
  NumberOfProcessors = NtCurrentPeb()->NumberOfProcessors;
  while ( 1 )
  {
    NumberOfProcessors >>= 1;
    if ( !NumberOfProcessors )
      break;
    ++v0;
  }
  if ( !v0 )
    return 1;
  return v0;
}

//----- (0040155E) --------------------------------------------------------
int sub_40155E()
{
  struct _PEB *v0; // eax
  unsigned int OSMajorVersion; // esi
  unsigned int OSMinorVersion; // edi

  v0 = NtCurrentPeb();
  OSMajorVersion = v0->OSMajorVersion;
  OSMinorVersion = v0->OSMinorVersion;
  if ( OSMajorVersion == 5 && !OSMinorVersion || OSMajorVersion < 5 )
    return 0;
  if ( OSMajorVersion == 5 && OSMinorVersion == 1 )
    return 51;
  if ( OSMajorVersion == 5 && OSMinorVersion == 2 )
    return 52;
  if ( OSMajorVersion == 6 && !OSMinorVersion )
    return 60;
  if ( OSMajorVersion == 6 && OSMinorVersion == 1 )
    return 61;
  if ( OSMajorVersion == 6 && OSMinorVersion == 2 )
    return 62;
  if ( OSMajorVersion == 6 && OSMinorVersion == 3 )
    return 63;
  if ( OSMajorVersion == 10 && !OSMinorVersion )
    return 100;
  if ( OSMajorVersion == 10 && OSMinorVersion || OSMajorVersion > 0xA )
    return 0x7FFFFFFF;
  return -1;
}

//----- (0040163A) --------------------------------------------------------
wchar_t *sub_40163A()
{
  return NtCurrentPeb()->ProcessParameters->CommandLine.Buffer;
}

//----- (00401647) --------------------------------------------------------
wchar_t *sub_401647()
{
  return NtCurrentPeb()->ProcessParameters->ImagePathName.Buffer;
}

//----- (00401654) --------------------------------------------------------
__int16 __stdcall sub_401654(_WORD *a1)
{
  int v1; // esi
  __int16 v3; // ax
  _WORD *v4; // edi
  __int16 result; // ax

  v1 = 2147352624;
  while ( 1 )
  {
    v3 = *(_WORD *)v1;
    v1 += 2;
    if ( !v3 )
      break;
    *a1++ = v3;
  }
  *a1 = 92;
  v4 = a1 + 1;
  *(_DWORD *)v4 = 7929939;
  v4 += 2;
  *(_DWORD *)v4 = 7602291;
  v4 += 2;
  *(_DWORD *)v4 = 7143525;
  v4 += 2;
  *(_DWORD *)v4 = 3276851;
  result = 0;
  v4[2] = 0;
  return result;
}

//----- (004016B4) --------------------------------------------------------
void __stdcall sub_4016B4(int a1)
{
  int i; // eax

  if ( a1 )
  {
    for ( i = 0; *(_WORD *)(a1 + 2 * i); ++i )
      ;
    if ( *(_WORD *)(a1 + 2 * i - 2) != 92 )
      *(_DWORD *)(a1 + 2 * i) = 92;
  }
}

//----- (004016E3) --------------------------------------------------------
void __stdcall sub_4016E3(int a1)
{
  int i; // eax

  if ( a1 )
  {
    for ( i = 0; *(_WORD *)(a1 + 2 * i); ++i )
      ;
    if ( *(_WORD *)(a1 + 2 * i - 2) == 92 )
      *(_DWORD *)(a1 + 2 * i - 2) = 0;
  }
}

//----- (00401713) --------------------------------------------------------
unsigned int __stdcall sub_401713(_BYTE *a1, int a2)
{
  unsigned int result; // eax
  _BYTE *v5; // esi
  int v6; // ebx
  _BYTE *v7; // esi
  int v8; // ebx
  _BYTE *v9; // esi
  int v10; // ebx
  int v11; // [esp+8h] [ebp-4h] BYREF

  v11 = MEMORY[0x412000];
  do
  {
    result = sub_401769(MEMORY[0x412000], &v11);
    *a1 ^= result;
    v5 = a1 + 1;
    v6 = a2 - 1;
    if ( !v6 )
      break;
    *v5 ^= BYTE1(result);
    v7 = v5 + 1;
    v8 = v6 - 1;
    if ( !v8 )
      break;
    result >>= 16;
    *v7 ^= result;
    v9 = v7 + 1;
    v10 = v8 - 1;
    if ( !v10 )
      break;
    *v9 ^= BYTE1(result);
    a1 = v9 + 1;
    a2 = v10 - 1;
  }
  while ( a2 );
  return result;
}

//----- (00401769) --------------------------------------------------------
int __stdcall sub_401769(unsigned int a1, int *a2)
{
  int v2; // edx

  v2 = 134775813 * *a2 + 1;
  *a2 = v2;
  return ((unsigned int)v2 * (unsigned __int64)a1) >> 32;
}

//----- (00401787) --------------------------------------------------------
__m128i *__stdcall sub_401787(int a1, _DWORD *a2)
{
  __m128i *result; // eax
  _OWORD *v3; // edx
  int v4; // ecx
  _BYTE v5[132]; // [esp+20h] [ebp-114h] BYREF
  __m128i v6; // [esp+B0h] [ebp-84h] BYREF
  int v7; // [esp+C0h] [ebp-74h]
  int v8; // [esp+C4h] [ebp-70h]
  int v9; // [esp+C8h] [ebp-6Ch]
  int v10; // [esp+CCh] [ebp-68h]
  int v11; // [esp+D0h] [ebp-64h]
  int v12; // [esp+D4h] [ebp-60h]
  int v13; // [esp+D8h] [ebp-5Ch]
  int v14; // [esp+DCh] [ebp-58h]
  int v15; // [esp+E0h] [ebp-54h]
  int v16; // [esp+E4h] [ebp-50h]
  int v17; // [esp+E8h] [ebp-4Ch]
  int v18; // [esp+ECh] [ebp-48h]
  int v19; // [esp+F0h] [ebp-44h]
  int v20; // [esp+F4h] [ebp-40h]
  int v21; // [esp+F8h] [ebp-3Ch]
  int v22; // [esp+FCh] [ebp-38h]
  int v23; // [esp+100h] [ebp-34h]
  int v24; // [esp+104h] [ebp-30h]
  int v25; // [esp+108h] [ebp-2Ch]
  int v26; // [esp+10Ch] [ebp-28h]
  int v27; // [esp+110h] [ebp-24h]
  int v28; // [esp+114h] [ebp-20h]
  int v29; // [esp+118h] [ebp-1Ch]
  int v30; // [esp+11Ch] [ebp-18h]
  int v31; // [esp+120h] [ebp-14h]
  int v32; // [esp+124h] [ebp-10h]
  int v33; // [esp+128h] [ebp-Ch]
  int v34; // [esp+12Ch] [ebp-8h]

  v6.m128i_i64[1] = 0i64;
  v7 = 0;
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  v22 = 0;
  v23 = 0;
  v24 = 0;
  v25 = 0;
  v26 = 0;
  v27 = 0;
  v28 = 0;
  v29 = 0;
  v30 = 0;
  v31 = 0;
  v32 = 0;
  v33 = 0;
  v34 = 0;
  v6.m128i_i64[0] = 1i64;
  sub_40190A(&v6, (int)v5, a2, a1);
  sub_40190A(&v6, (int)v5, a2, 0);
  sub_40190A(&v6, (int)v5, a2, a1);
  result = &v6;
  v3 = (_OWORD *)a1;
  v4 = 8;
  do
  {
    *v3++ = *result++;
    --v4;
  }
  while ( v4 );
  return result;
}

//----- (0040190A) --------------------------------------------------------
const __m128i *__stdcall sub_40190A(__m128i *a1, int a2, _DWORD *a3, int a4)
{
  const __m128i *v4; // esi
  __m128i *v5; // edi
  int v6; // ecx
  __m128i *v7; // edi
  const __m128i *v8; // esi
  int v9; // ecx
  __m128i *v10; // edi
  const __m128i *v11; // esi
  int v12; // ecx
  __m128i *v13; // edi
  const __m128i *v14; // esi
  int v15; // ecx
  __m128i *v16; // edi
  const __m128i *v17; // esi
  int v18; // ecx
  __m128i *v19; // edi
  const __m128i *v20; // esi
  int v21; // ecx
  __m128i *v22; // edi
  const __m128i *v23; // esi
  int v24; // ecx
  __m128i *v25; // edi
  const __m128i *v26; // esi
  int v27; // ecx
  __m128i *v28; // edi
  const __m128i *v29; // esi
  const __m128i *result; // eax
  int v31; // ecx

  v4 = a1;
  v5 = (__m128i *)a2;
  v6 = 8;
  do
  {
    *v5++ = _mm_load_si128(v4++);
    --v6;
  }
  while ( v6 );
  v7 = (__m128i *)a2;
  v8 = a1;
  sub_401A6C(a1, a2, a3);
  v9 = 8;
  do
  {
    *v7++ = _mm_load_si128(v8++);
    --v9;
  }
  while ( v9 );
  v10 = (__m128i *)a2;
  v11 = a1;
  sub_401A6C(a1, a2, a3);
  v12 = 8;
  do
  {
    *v10++ = _mm_load_si128(v11++);
    --v12;
  }
  while ( v12 );
  v13 = (__m128i *)a2;
  v14 = a1;
  sub_401A6C(a1, a2, a3);
  v15 = 8;
  do
  {
    *v13++ = _mm_load_si128(v14++);
    --v15;
  }
  while ( v15 );
  v16 = (__m128i *)a2;
  v17 = a1;
  sub_401A6C(a1, a2, a3);
  v18 = 8;
  do
  {
    *v16++ = _mm_load_si128(v17++);
    --v18;
  }
  while ( v18 );
  v19 = (__m128i *)a2;
  v20 = a1;
  sub_401A6C(a1, a2, a3);
  v21 = 8;
  do
  {
    *v19++ = _mm_load_si128(v20++);
    --v21;
  }
  while ( v21 );
  v22 = (__m128i *)a2;
  v23 = a1;
  sub_401A6C(a1, a2, a3);
  v24 = 8;
  do
  {
    *v22++ = _mm_load_si128(v23++);
    --v24;
  }
  while ( v24 );
  v25 = (__m128i *)a2;
  v26 = a1;
  sub_401A6C(a1, a2, a3);
  v27 = 8;
  do
  {
    *v25++ = _mm_load_si128(v26++);
    --v27;
  }
  while ( v27 );
  v28 = (__m128i *)a2;
  v29 = a1;
  result = sub_401A6C(a1, a2, a3);
  if ( a4 )
  {
    v31 = 8;
    do
    {
      *v28++ = _mm_load_si128(v29++);
      --v31;
    }
    while ( v31 );
    return sub_401A6C(a1, a4, a3);
  }
  return result;
}

//----- (00401A6C) --------------------------------------------------------
const __m128i *__stdcall sub_401A6C(__m128i *a1, int a2, _DWORD *a3)
{
  int v4; // esi
  int v5; // edi
  char v6; // cf
  unsigned int v7; // ett
  unsigned int v8; // ett
  int v9; // ebx
  int v10; // esi
  int v11; // edi
  unsigned int v12; // ett
  unsigned int v13; // ett
  unsigned int v14; // ett
  unsigned int v15; // ett
  int v16; // ebx
  int v17; // esi
  int v18; // edi
  unsigned int v19; // ett
  unsigned int v20; // ett
  unsigned int v21; // ett
  unsigned int v22; // ett
  int v23; // ebx
  int v24; // esi
  int v25; // edi
  unsigned int v26; // ett
  unsigned int v27; // ett
  unsigned int v28; // ett
  unsigned int v29; // ett
  int v30; // ebx
  int v31; // esi
  int v32; // edi
  unsigned int v33; // ett
  unsigned int v34; // ett
  unsigned int v35; // ett
  unsigned int v36; // ett
  int v37; // ebx
  int v38; // esi
  int v39; // edi
  unsigned int v40; // ett
  unsigned int v41; // ett
  unsigned int v42; // ett
  unsigned int v43; // ett
  int v44; // ebx
  int v45; // esi
  int v46; // edi
  unsigned int v47; // ett
  unsigned int v48; // ett
  unsigned int v49; // ett
  unsigned int v50; // ett
  int v51; // ebx
  int v52; // esi
  int v53; // edi
  unsigned int v54; // ett
  unsigned int v55; // ett
  unsigned int v56; // ett
  unsigned int v57; // ett
  int v58; // esi
  int v59; // edi
  int v60; // ett
  int v61; // ett
  int v62; // edx
  int v63; // ebx
  int v64; // esi
  int v65; // edi
  int v66; // ett
  int v67; // ett
  int v68; // ett
  int v69; // ett
  int v70; // edx
  int v71; // ebx
  int v72; // esi
  int v73; // edi
  int v74; // ett
  int v75; // ett
  int v76; // ett
  int v77; // ett
  int v78; // edx
  int v79; // ebx
  int v80; // esi
  int v81; // edi
  int v82; // ett
  int v83; // ett
  int v84; // ett
  int v85; // ett
  int v86; // edx
  int v87; // ebx
  int v88; // esi
  int v89; // edi
  int v90; // ett
  int v91; // ett
  int v92; // ett
  int v93; // ett
  int v94; // edx
  int v95; // ebx
  int v96; // esi
  int v97; // edi
  int v98; // ett
  int v99; // ett
  int v100; // ett
  int v101; // ett
  int v102; // edx
  int v103; // ebx
  int v104; // esi
  int v105; // edi
  int v106; // ett
  int v107; // ett
  int v108; // ett
  int v109; // ett
  int v110; // edx
  int v111; // ebx
  int v112; // esi
  int v113; // edi
  int v114; // ett
  int v115; // ett
  int v116; // ett
  int v118; // esi
  int v119; // edi
  unsigned int v120; // ett
  unsigned int v121; // ett
  int v122; // ebx
  int v123; // esi
  int v124; // edi
  unsigned int v125; // ett
  unsigned int v126; // ett
  unsigned int v127; // ett
  unsigned int v128; // ett
  int v129; // ebx
  int v130; // esi
  int v131; // edi
  unsigned int v132; // ett
  unsigned int v133; // ett
  unsigned int v134; // ett
  unsigned int v135; // ett
  int v136; // ebx
  int v137; // esi
  int v138; // edi
  unsigned int v139; // ett
  unsigned int v140; // ett
  unsigned int v141; // ett
  unsigned int v142; // ett
  int v143; // ebx
  int v144; // esi
  int v145; // edi
  unsigned int v146; // ett
  unsigned int v147; // ett
  unsigned int v148; // ett
  unsigned int v149; // ett
  int v150; // ebx
  int v151; // esi
  int v152; // edi
  unsigned int v153; // ett
  unsigned int v154; // ett
  unsigned int v155; // ett
  unsigned int v156; // ett
  int v157; // ebx
  int v158; // esi
  int v159; // edi
  unsigned int v160; // ett
  unsigned int v161; // ett
  unsigned int v162; // ett
  unsigned int v163; // ett
  int v164; // ebx
  int v165; // esi
  int v166; // edi
  unsigned int v167; // ett
  unsigned int v168; // ett
  unsigned int v169; // ett
  unsigned int v170; // ett
  int v171; // esi
  int v172; // edi
  int v173; // ett
  int v174; // ett
  int v175; // edx
  int v176; // ebx
  int v177; // esi
  int v178; // edi
  int v179; // ett
  int v180; // ett
  int v181; // ett
  int v182; // ett
  int v183; // edx
  int v184; // ebx
  int v185; // esi
  int v186; // edi
  int v187; // ett
  int v188; // ett
  int v189; // ett
  int v190; // ett
  int v191; // edx
  int v192; // ebx
  int v193; // esi
  int v194; // edi
  int v195; // ett
  int v196; // ett
  int v197; // ett
  int v198; // ett
  int v199; // edx
  int v200; // ebx
  int v201; // esi
  int v202; // edi
  int v203; // ett
  int v204; // ett
  int v205; // ett
  int v206; // ett
  int v207; // edx
  int v208; // ebx
  int v209; // esi
  int v210; // edi
  int v211; // ett
  int v212; // ett
  int v213; // ett
  int v214; // ett
  int v215; // edx
  int v216; // ebx
  int v217; // esi
  int v218; // edi
  int v219; // ett
  int v220; // ett
  int v221; // ett
  int v222; // ett
  int v223; // edx
  int v224; // ebx
  int v225; // esi
  int v226; // edi
  int v227; // ett
  int v228; // ett
  int v229; // ett
  const __m128i *result; // eax
  __m128i *v231; // edx
  int v232; // ecx
  int v233; // [esp+Ch] [ebp-98h]
  unsigned __int64 v234; // [esp+20h] [ebp-84h] BYREF
  unsigned int v235; // [esp+28h] [ebp-7Ch]
  unsigned int v236; // [esp+2Ch] [ebp-78h]
  unsigned int v237; // [esp+30h] [ebp-74h]
  unsigned int v238; // [esp+34h] [ebp-70h]
  unsigned int v239; // [esp+38h] [ebp-6Ch]
  unsigned int v240; // [esp+3Ch] [ebp-68h]
  unsigned int v241; // [esp+40h] [ebp-64h]
  unsigned int v242; // [esp+44h] [ebp-60h]
  unsigned int v243; // [esp+48h] [ebp-5Ch]
  unsigned int v244; // [esp+4Ch] [ebp-58h]
  unsigned int v245; // [esp+50h] [ebp-54h]
  unsigned int v246; // [esp+54h] [ebp-50h]
  unsigned int v247; // [esp+58h] [ebp-4Ch]
  unsigned int v248; // [esp+5Ch] [ebp-48h]
  unsigned int v249; // [esp+60h] [ebp-44h]
  unsigned int v250; // [esp+64h] [ebp-40h]
  unsigned int v251; // [esp+68h] [ebp-3Ch]
  unsigned int v252; // [esp+6Ch] [ebp-38h]
  unsigned int v253; // [esp+70h] [ebp-34h]
  unsigned int v254; // [esp+74h] [ebp-30h]
  unsigned int v255; // [esp+78h] [ebp-2Ch]
  unsigned int v256; // [esp+7Ch] [ebp-28h]
  unsigned int v257; // [esp+80h] [ebp-24h]
  unsigned int v258; // [esp+84h] [ebp-20h]
  unsigned int v259; // [esp+88h] [ebp-1Ch]
  unsigned int v260; // [esp+8Ch] [ebp-18h]
  unsigned int v261; // [esp+90h] [ebp-14h]
  unsigned int v262; // [esp+94h] [ebp-10h]
  unsigned int v263; // [esp+98h] [ebp-Ch]
  unsigned int v264; // [esp+9Ch] [ebp-8h]

  v234 = 0i64;
  v235 = 0;
  v236 = 0;
  v237 = 0;
  v238 = 0;
  v239 = 0;
  v240 = 0;
  v241 = 0;
  v242 = 0;
  v243 = 0;
  v244 = 0;
  v245 = 0;
  v246 = 0;
  v247 = 0;
  v248 = 0;
  v249 = 0;
  v250 = 0;
  v251 = 0;
  v252 = 0;
  v253 = 0;
  v254 = 0;
  v255 = 0;
  v256 = 0;
  v257 = 0;
  v258 = 0;
  v259 = 0;
  v260 = 0;
  v261 = 0;
  v262 = 0;
  v263 = 0;
  v264 = 0;
  v233 = 1024;
  do
  {
    _EAX = &v234;
    __asm
    {
      rcl     dword ptr [eax], 1
      rcl     dword ptr [eax+4], 1
      rcl     dword ptr [eax+8], 1
      rcl     dword ptr [eax+0Ch], 1
      rcl     dword ptr [eax+10h], 1
      rcl     dword ptr [eax+14h], 1
      rcl     dword ptr [eax+18h], 1
      rcl     dword ptr [eax+1Ch], 1
      rcl     dword ptr [eax+20h], 1
      rcl     dword ptr [eax+24h], 1
      rcl     dword ptr [eax+28h], 1
      rcl     dword ptr [eax+2Ch], 1
      rcl     dword ptr [eax+30h], 1
      rcl     dword ptr [eax+34h], 1
      rcl     dword ptr [eax+38h], 1
      rcl     dword ptr [eax+3Ch], 1
      rcl     dword ptr [eax+40h], 1
      rcl     dword ptr [eax+44h], 1
      rcl     dword ptr [eax+48h], 1
      rcl     dword ptr [eax+4Ch], 1
      rcl     dword ptr [eax+50h], 1
      rcl     dword ptr [eax+54h], 1
      rcl     dword ptr [eax+58h], 1
      rcl     dword ptr [eax+5Ch], 1
      rcl     dword ptr [eax+60h], 1
      rcl     dword ptr [eax+64h], 1
      rcl     dword ptr [eax+68h], 1
      rcl     dword ptr [eax+6Ch], 1
      rcl     dword ptr [eax+70h], 1
      rcl     dword ptr [eax+74h], 1
      rcl     dword ptr [eax+78h], 1
      rcl     dword ptr [eax+7Ch], 1
    }
    v4 = a3[2];
    v5 = a3[3];
    v6 = v234 < *(_QWORD *)a3;
    v234 -= *(_QWORD *)a3;
    v7 = v6 + v4;
    v6 = v235 < v7;
    v235 -= v7;
    v8 = v6 + v5;
    v6 = v236 < v8;
    v236 -= v8;
    v9 = a3[5];
    v10 = a3[6];
    v11 = a3[7];
    v12 = v6 + a3[4];
    v6 = v237 < v12;
    v237 -= v12;
    v13 = v6 + v9;
    v6 = v238 < v13;
    v238 -= v13;
    v14 = v6 + v10;
    v6 = v239 < v14;
    v239 -= v14;
    v15 = v6 + v11;
    v6 = v240 < v15;
    v240 -= v15;
    v16 = a3[9];
    v17 = a3[10];
    v18 = a3[11];
    v19 = v6 + a3[8];
    v6 = v241 < v19;
    v241 -= v19;
    v20 = v6 + v16;
    v6 = v242 < v20;
    v242 -= v20;
    v21 = v6 + v17;
    v6 = v243 < v21;
    v243 -= v21;
    v22 = v6 + v18;
    v6 = v244 < v22;
    v244 -= v22;
    v23 = a3[13];
    v24 = a3[14];
    v25 = a3[15];
    v26 = v6 + a3[12];
    v6 = v245 < v26;
    v245 -= v26;
    v27 = v6 + v23;
    v6 = v246 < v27;
    v246 -= v27;
    v28 = v6 + v24;
    v6 = v247 < v28;
    v247 -= v28;
    v29 = v6 + v25;
    v6 = v248 < v29;
    v248 -= v29;
    v30 = a3[17];
    v31 = a3[18];
    v32 = a3[19];
    v33 = v6 + a3[16];
    v6 = v249 < v33;
    v249 -= v33;
    v34 = v6 + v30;
    v6 = v250 < v34;
    v250 -= v34;
    v35 = v6 + v31;
    v6 = v251 < v35;
    v251 -= v35;
    v36 = v6 + v32;
    v6 = v252 < v36;
    v252 -= v36;
    v37 = a3[21];
    v38 = a3[22];
    v39 = a3[23];
    v40 = v6 + a3[20];
    v6 = v253 < v40;
    v253 -= v40;
    v41 = v6 + v37;
    v6 = v254 < v41;
    v254 -= v41;
    v42 = v6 + v38;
    v6 = v255 < v42;
    v255 -= v42;
    v43 = v6 + v39;
    v6 = v256 < v43;
    v256 -= v43;
    v44 = a3[25];
    v45 = a3[26];
    v46 = a3[27];
    v47 = v6 + a3[24];
    v6 = v257 < v47;
    v257 -= v47;
    v48 = v6 + v44;
    v6 = v258 < v48;
    v258 -= v48;
    v49 = v6 + v45;
    v6 = v259 < v49;
    v259 -= v49;
    v50 = v6 + v46;
    v6 = v260 < v50;
    v260 -= v50;
    v51 = a3[29];
    v52 = a3[30];
    v53 = a3[31];
    v54 = v6 + a3[28];
    v6 = v261 < v54;
    v261 -= v54;
    v55 = v6 + v51;
    v6 = v262 < v55;
    v262 -= v55;
    v56 = v6 + v52;
    v6 = v263 < v56;
    v263 -= v56;
    v57 = v6 + v53;
    v6 = v264 < v57;
    v264 -= v57;
    if ( v6 )
    {
      v58 = a3[2];
      v59 = a3[3];
      v6 = __CFADD__(__CFADD__(*a3, (_DWORD)v234), HIDWORD(v234)) | __CFADD__(
                                                                      a3[1],
                                                                      __CFADD__(*a3, (_DWORD)v234) + HIDWORD(v234));
      v234 += *(_QWORD *)a3;
      v60 = v6;
      v6 = __CFADD__(v6, v235) | __CFADD__(v58, v6 + v235);
      v235 += v58 + v60;
      v61 = v6;
      v6 = __CFADD__(v6, v236) | __CFADD__(v59, v6 + v236);
      v236 += v59 + v61;
      v62 = a3[4];
      v63 = a3[5];
      v64 = a3[6];
      v65 = a3[7];
      v66 = v6;
      v6 = __CFADD__(v6, v237) | __CFADD__(v62, v6 + v237);
      v237 += v62 + v66;
      v67 = v6;
      v6 = __CFADD__(v6, v238) | __CFADD__(v63, v6 + v238);
      v238 += v63 + v67;
      v68 = v6;
      v6 = __CFADD__(v6, v239) | __CFADD__(v64, v6 + v239);
      v239 += v64 + v68;
      v69 = v6;
      v6 = __CFADD__(v6, v240) | __CFADD__(v65, v6 + v240);
      v240 += v65 + v69;
      v70 = a3[8];
      v71 = a3[9];
      v72 = a3[10];
      v73 = a3[11];
      v74 = v6;
      v6 = __CFADD__(v6, v241) | __CFADD__(v70, v6 + v241);
      v241 += v70 + v74;
      v75 = v6;
      v6 = __CFADD__(v6, v242) | __CFADD__(v71, v6 + v242);
      v242 += v71 + v75;
      v76 = v6;
      v6 = __CFADD__(v6, v243) | __CFADD__(v72, v6 + v243);
      v243 += v72 + v76;
      v77 = v6;
      v6 = __CFADD__(v6, v244) | __CFADD__(v73, v6 + v244);
      v244 += v73 + v77;
      v78 = a3[12];
      v79 = a3[13];
      v80 = a3[14];
      v81 = a3[15];
      v82 = v6;
      v6 = __CFADD__(v6, v245) | __CFADD__(v78, v6 + v245);
      v245 += v78 + v82;
      v83 = v6;
      v6 = __CFADD__(v6, v246) | __CFADD__(v79, v6 + v246);
      v246 += v79 + v83;
      v84 = v6;
      v6 = __CFADD__(v6, v247) | __CFADD__(v80, v6 + v247);
      v247 += v80 + v84;
      v85 = v6;
      v6 = __CFADD__(v6, v248) | __CFADD__(v81, v6 + v248);
      v248 += v81 + v85;
      v86 = a3[16];
      v87 = a3[17];
      v88 = a3[18];
      v89 = a3[19];
      v90 = v6;
      v6 = __CFADD__(v6, v249) | __CFADD__(v86, v6 + v249);
      v249 += v86 + v90;
      v91 = v6;
      v6 = __CFADD__(v6, v250) | __CFADD__(v87, v6 + v250);
      v250 += v87 + v91;
      v92 = v6;
      v6 = __CFADD__(v6, v251) | __CFADD__(v88, v6 + v251);
      v251 += v88 + v92;
      v93 = v6;
      v6 = __CFADD__(v6, v252) | __CFADD__(v89, v6 + v252);
      v252 += v89 + v93;
      v94 = a3[20];
      v95 = a3[21];
      v96 = a3[22];
      v97 = a3[23];
      v98 = v6;
      v6 = __CFADD__(v6, v253) | __CFADD__(v94, v6 + v253);
      v253 += v94 + v98;
      v99 = v6;
      v6 = __CFADD__(v6, v254) | __CFADD__(v95, v6 + v254);
      v254 += v95 + v99;
      v100 = v6;
      v6 = __CFADD__(v6, v255) | __CFADD__(v96, v6 + v255);
      v255 += v96 + v100;
      v101 = v6;
      v6 = __CFADD__(v6, v256) | __CFADD__(v97, v6 + v256);
      v256 += v97 + v101;
      v102 = a3[24];
      v103 = a3[25];
      v104 = a3[26];
      v105 = a3[27];
      v106 = v6;
      v6 = __CFADD__(v6, v257) | __CFADD__(v102, v6 + v257);
      v257 += v102 + v106;
      v107 = v6;
      v6 = __CFADD__(v6, v258) | __CFADD__(v103, v6 + v258);
      v258 += v103 + v107;
      v108 = v6;
      v6 = __CFADD__(v6, v259) | __CFADD__(v104, v6 + v259);
      v259 += v104 + v108;
      v109 = v6;
      v6 = __CFADD__(v6, v260) | __CFADD__(v105, v6 + v260);
      v260 += v105 + v109;
      v110 = a3[28];
      v111 = a3[29];
      v112 = a3[30];
      v113 = a3[31];
      v114 = v6;
      v6 = __CFADD__(v6, v261) | __CFADD__(v110, v6 + v261);
      v261 += v110 + v114;
      v115 = v6;
      v6 = __CFADD__(v6, v262) | __CFADD__(v111, v6 + v262);
      v262 += v111 + v115;
      v116 = v6;
      v6 = __CFADD__(v6, v263) | __CFADD__(v112, v6 + v263);
      v263 += v112 + v116;
      v264 += v113 + v6;
    }
    _EAX = a1;
    __asm
    {
      rcl     dword ptr [eax], 1
      rcl     dword ptr [eax+4], 1
      rcl     dword ptr [eax+8], 1
      rcl     dword ptr [eax+0Ch], 1
      rcl     dword ptr [eax+10h], 1
      rcl     dword ptr [eax+14h], 1
      rcl     dword ptr [eax+18h], 1
      rcl     dword ptr [eax+1Ch], 1
      rcl     dword ptr [eax+20h], 1
      rcl     dword ptr [eax+24h], 1
      rcl     dword ptr [eax+28h], 1
      rcl     dword ptr [eax+2Ch], 1
      rcl     dword ptr [eax+30h], 1
      rcl     dword ptr [eax+34h], 1
      rcl     dword ptr [eax+38h], 1
      rcl     dword ptr [eax+3Ch], 1
      rcl     dword ptr [eax+40h], 1
      rcl     dword ptr [eax+44h], 1
      rcl     dword ptr [eax+48h], 1
      rcl     dword ptr [eax+4Ch], 1
      rcl     dword ptr [eax+50h], 1
      rcl     dword ptr [eax+54h], 1
      rcl     dword ptr [eax+58h], 1
      rcl     dword ptr [eax+5Ch], 1
      rcl     dword ptr [eax+60h], 1
      rcl     dword ptr [eax+64h], 1
      rcl     dword ptr [eax+68h], 1
      rcl     dword ptr [eax+6Ch], 1
      rcl     dword ptr [eax+70h], 1
      rcl     dword ptr [eax+74h], 1
      rcl     dword ptr [eax+78h], 1
      rcl     dword ptr [eax+7Ch], 1
    }
    v118 = a3[2];
    v119 = a3[3];
    v6 = v234 < *(_QWORD *)a3;
    v234 -= *(_QWORD *)a3;
    v120 = v6 + v118;
    v6 = v235 < v120;
    v235 -= v120;
    v121 = v6 + v119;
    v6 = v236 < v121;
    v236 -= v121;
    v122 = a3[5];
    v123 = a3[6];
    v124 = a3[7];
    v125 = v6 + a3[4];
    v6 = v237 < v125;
    v237 -= v125;
    v126 = v6 + v122;
    v6 = v238 < v126;
    v238 -= v126;
    v127 = v6 + v123;
    v6 = v239 < v127;
    v239 -= v127;
    v128 = v6 + v124;
    v6 = v240 < v128;
    v240 -= v128;
    v129 = a3[9];
    v130 = a3[10];
    v131 = a3[11];
    v132 = v6 + a3[8];
    v6 = v241 < v132;
    v241 -= v132;
    v133 = v6 + v129;
    v6 = v242 < v133;
    v242 -= v133;
    v134 = v6 + v130;
    v6 = v243 < v134;
    v243 -= v134;
    v135 = v6 + v131;
    v6 = v244 < v135;
    v244 -= v135;
    v136 = a3[13];
    v137 = a3[14];
    v138 = a3[15];
    v139 = v6 + a3[12];
    v6 = v245 < v139;
    v245 -= v139;
    v140 = v6 + v136;
    v6 = v246 < v140;
    v246 -= v140;
    v141 = v6 + v137;
    v6 = v247 < v141;
    v247 -= v141;
    v142 = v6 + v138;
    v6 = v248 < v142;
    v248 -= v142;
    v143 = a3[17];
    v144 = a3[18];
    v145 = a3[19];
    v146 = v6 + a3[16];
    v6 = v249 < v146;
    v249 -= v146;
    v147 = v6 + v143;
    v6 = v250 < v147;
    v250 -= v147;
    v148 = v6 + v144;
    v6 = v251 < v148;
    v251 -= v148;
    v149 = v6 + v145;
    v6 = v252 < v149;
    v252 -= v149;
    v150 = a3[21];
    v151 = a3[22];
    v152 = a3[23];
    v153 = v6 + a3[20];
    v6 = v253 < v153;
    v253 -= v153;
    v154 = v6 + v150;
    v6 = v254 < v154;
    v254 -= v154;
    v155 = v6 + v151;
    v6 = v255 < v155;
    v255 -= v155;
    v156 = v6 + v152;
    v6 = v256 < v156;
    v256 -= v156;
    v157 = a3[25];
    v158 = a3[26];
    v159 = a3[27];
    v160 = v6 + a3[24];
    v6 = v257 < v160;
    v257 -= v160;
    v161 = v6 + v157;
    v6 = v258 < v161;
    v258 -= v161;
    v162 = v6 + v158;
    v6 = v259 < v162;
    v259 -= v162;
    v163 = v6 + v159;
    v6 = v260 < v163;
    v260 -= v163;
    v164 = a3[29];
    v165 = a3[30];
    v166 = a3[31];
    v167 = v6 + a3[28];
    v6 = v261 < v167;
    v261 -= v167;
    v168 = v6 + v164;
    v6 = v262 < v168;
    v262 -= v168;
    v169 = v6 + v165;
    v6 = v263 < v169;
    v263 -= v169;
    v170 = v6 + v166;
    v6 = v264 < v170;
    v264 -= v170;
    if ( v6 )
    {
      v171 = a3[2];
      v172 = a3[3];
      v6 = __CFADD__(__CFADD__(*a3, (_DWORD)v234), HIDWORD(v234)) | __CFADD__(
                                                                      a3[1],
                                                                      __CFADD__(*a3, (_DWORD)v234) + HIDWORD(v234));
      v234 += *(_QWORD *)a3;
      v173 = v6;
      v6 = __CFADD__(v6, v235) | __CFADD__(v171, v6 + v235);
      v235 += v171 + v173;
      v174 = v6;
      v6 = __CFADD__(v6, v236) | __CFADD__(v172, v6 + v236);
      v236 += v172 + v174;
      v175 = a3[4];
      v176 = a3[5];
      v177 = a3[6];
      v178 = a3[7];
      v179 = v6;
      v6 = __CFADD__(v6, v237) | __CFADD__(v175, v6 + v237);
      v237 += v175 + v179;
      v180 = v6;
      v6 = __CFADD__(v6, v238) | __CFADD__(v176, v6 + v238);
      v238 += v176 + v180;
      v181 = v6;
      v6 = __CFADD__(v6, v239) | __CFADD__(v177, v6 + v239);
      v239 += v177 + v181;
      v182 = v6;
      v6 = __CFADD__(v6, v240) | __CFADD__(v178, v6 + v240);
      v240 += v178 + v182;
      v183 = a3[8];
      v184 = a3[9];
      v185 = a3[10];
      v186 = a3[11];
      v187 = v6;
      v6 = __CFADD__(v6, v241) | __CFADD__(v183, v6 + v241);
      v241 += v183 + v187;
      v188 = v6;
      v6 = __CFADD__(v6, v242) | __CFADD__(v184, v6 + v242);
      v242 += v184 + v188;
      v189 = v6;
      v6 = __CFADD__(v6, v243) | __CFADD__(v185, v6 + v243);
      v243 += v185 + v189;
      v190 = v6;
      v6 = __CFADD__(v6, v244) | __CFADD__(v186, v6 + v244);
      v244 += v186 + v190;
      v191 = a3[12];
      v192 = a3[13];
      v193 = a3[14];
      v194 = a3[15];
      v195 = v6;
      v6 = __CFADD__(v6, v245) | __CFADD__(v191, v6 + v245);
      v245 += v191 + v195;
      v196 = v6;
      v6 = __CFADD__(v6, v246) | __CFADD__(v192, v6 + v246);
      v246 += v192 + v196;
      v197 = v6;
      v6 = __CFADD__(v6, v247) | __CFADD__(v193, v6 + v247);
      v247 += v193 + v197;
      v198 = v6;
      v6 = __CFADD__(v6, v248) | __CFADD__(v194, v6 + v248);
      v248 += v194 + v198;
      v199 = a3[16];
      v200 = a3[17];
      v201 = a3[18];
      v202 = a3[19];
      v203 = v6;
      v6 = __CFADD__(v6, v249) | __CFADD__(v199, v6 + v249);
      v249 += v199 + v203;
      v204 = v6;
      v6 = __CFADD__(v6, v250) | __CFADD__(v200, v6 + v250);
      v250 += v200 + v204;
      v205 = v6;
      v6 = __CFADD__(v6, v251) | __CFADD__(v201, v6 + v251);
      v251 += v201 + v205;
      v206 = v6;
      v6 = __CFADD__(v6, v252) | __CFADD__(v202, v6 + v252);
      v252 += v202 + v206;
      v207 = a3[20];
      v208 = a3[21];
      v209 = a3[22];
      v210 = a3[23];
      v211 = v6;
      v6 = __CFADD__(v6, v253) | __CFADD__(v207, v6 + v253);
      v253 += v207 + v211;
      v212 = v6;
      v6 = __CFADD__(v6, v254) | __CFADD__(v208, v6 + v254);
      v254 += v208 + v212;
      v213 = v6;
      v6 = __CFADD__(v6, v255) | __CFADD__(v209, v6 + v255);
      v255 += v209 + v213;
      v214 = v6;
      v6 = __CFADD__(v6, v256) | __CFADD__(v210, v6 + v256);
      v256 += v210 + v214;
      v215 = a3[24];
      v216 = a3[25];
      v217 = a3[26];
      v218 = a3[27];
      v219 = v6;
      v6 = __CFADD__(v6, v257) | __CFADD__(v215, v6 + v257);
      v257 += v215 + v219;
      v220 = v6;
      v6 = __CFADD__(v6, v258) | __CFADD__(v216, v6 + v258);
      v258 += v216 + v220;
      v221 = v6;
      v6 = __CFADD__(v6, v259) | __CFADD__(v217, v6 + v259);
      v259 += v217 + v221;
      v222 = v6;
      v6 = __CFADD__(v6, v260) | __CFADD__(v218, v6 + v260);
      v260 += v218 + v222;
      v223 = a3[28];
      v224 = a3[29];
      v225 = a3[30];
      v226 = a3[31];
      v227 = v6;
      v6 = __CFADD__(v6, v261) | __CFADD__(v223, v6 + v261);
      v261 += v223 + v227;
      v228 = v6;
      v6 = __CFADD__(v6, v262) | __CFADD__(v224, v6 + v262);
      v262 += v224 + v228;
      v229 = v6;
      v6 = __CFADD__(v6, v263) | __CFADD__(v225, v6 + v263);
      v263 += v225 + v229;
      v264 += v226 + v6;
    }
    --v233;
  }
  while ( v233 );
  result = (const __m128i *)&v234;
  v231 = a1;
  v232 = 8;
  do
  {
    *v231++ = _mm_load_si128(result++);
    --v232;
  }
  while ( v232 );
  return result;
}

//----- (0040207C) --------------------------------------------------------
int __usercall sub_40207C@<eax>(int result@<eax>, unsigned int a2, __m128i *a3, unsigned int a4)
{
  __int128 *v4; // esi
  __int128 v5; // xmm0
  int v6; // edx
  int v7; // esi
  int v8; // ecx
  int v9; // ebx
  int v10; // ebp
  int v11; // edi
  int v12; // eax
  int v13; // ebp
  int v14; // ebx
  int v15; // edx
  int v16; // ecx
  bool v17; // zf
  int v18; // eax
  __m128i *v19; // edi
  bool v20; // cf
  unsigned int v21; // ebx
  unsigned int v22; // edx
  __m128i *v23; // ecx
  __m128i v24; // xmm0
  __m128i *v25; // ecx
  char *v26; // ebp
  unsigned int v27; // edi
  int v28; // [esp+8h] [ebp-84h]
  int v29; // [esp+8h] [ebp-84h]
  __int64 v30; // [esp+Ch] [ebp-80h]
  int v31; // [esp+14h] [ebp-78h]
  int v32; // [esp+14h] [ebp-78h]
  int v33; // [esp+18h] [ebp-74h]
  int v34; // [esp+18h] [ebp-74h]
  int v35; // [esp+1Ch] [ebp-70h]
  int v36; // [esp+1Ch] [ebp-70h]
  int v37; // [esp+20h] [ebp-6Ch]
  int v38; // [esp+20h] [ebp-6Ch]
  int v39; // [esp+24h] [ebp-68h]
  int v40; // [esp+24h] [ebp-68h]
  int v41; // [esp+28h] [ebp-64h]
  int v42; // [esp+28h] [ebp-64h]
  int v43; // [esp+2Ch] [ebp-60h]
  int v44; // [esp+2Ch] [ebp-60h]
  int v45; // [esp+30h] [ebp-5Ch]
  int v46; // [esp+30h] [ebp-5Ch]
  int v48; // [esp+38h] [ebp-54h]
  int v49; // [esp+3Ch] [ebp-50h]
  unsigned int v50; // [esp+44h] [ebp-48h] BYREF
  __int128 v51; // [esp+48h] [ebp-44h] BYREF
  __int128 v52; // [esp+58h] [ebp-34h] BYREF
  __int128 v53; // [esp+68h] [ebp-24h]
  __int128 v54; // [esp+78h] [ebp-14h] BYREF

  v4 = (__int128 *)a4;
  if ( a2 )
  {
    v50 = a4 + 60;
    do
    {
      v48 = 10;
      v51 = *v4;
      v52 = v4[1];
      v53 = v4[2];
      v5 = v4[3];
      v6 = HIDWORD(v53);
      v7 = v52;
      v41 = DWORD2(v53);
      v31 = DWORD1(v53);
      v33 = v53;
      v30 = *((_QWORD *)&v52 + 1);
      v39 = DWORD1(v52);
      v28 = HIDWORD(v51);
      v35 = DWORD2(v51);
      v54 = v5;
      v8 = HIDWORD(v5);
      v9 = DWORD2(v5);
      v10 = DWORD1(v5);
      v11 = v5;
      v43 = DWORD1(v51);
      v12 = v51;
      v37 = v51;
      while ( 1 )
      {
        v45 = __ROL4__(v11 + v12, 7) ^ v7;
        v34 = __ROL4__(v45 + v37, 9) ^ v33;
        v49 = __ROL4__(v45 + v34, 13) ^ v11;
        v38 = __ROR4__(v49 + v34, 14) ^ v37;
        v32 = __ROL4__(v43 + v39, 7) ^ v31;
        v13 = __ROL4__(v39 + v32, 9) ^ v10;
        v44 = __ROL4__(v13 + v32, 13) ^ v43;
        v40 = __ROR4__(v44 + v13, 14) ^ v39;
        v14 = __ROL4__(v41 + v30, 7) ^ v9;
        v36 = __ROL4__(v14 + v41, 9) ^ v35;
        LODWORD(v30) = __ROL4__(v14 + v36, 13) ^ v30;
        v29 = __ROL4__(v6 + v8, 7) ^ v28;
        v42 = __ROR4__(v36 + v30, 14) ^ v41;
        HIDWORD(v30) ^= __ROL4__(v8 + v29, 9);
        v15 = __ROL4__(v29 + HIDWORD(v30), 13) ^ v6;
        v16 = __ROR4__(v15 + HIDWORD(v30), 14) ^ v8;
        v43 = __ROL4__(v38 + v29, 7) ^ v44;
        v35 = __ROL4__(v43 + v38, 9) ^ v36;
        DWORD2(v51) = v35;
        v28 = __ROL4__(v35 + v43, 13) ^ v29;
        HIDWORD(v51) = v28;
        LODWORD(v30) = __ROL4__(v40 + v45, 7) ^ v30;
        HIDWORD(v30) ^= __ROL4__(v40 + v30, 9);
        HIDWORD(v52) = HIDWORD(v30);
        v37 = __ROR4__(v35 + v28, 14) ^ v38;
        v46 = __ROL4__(v30 + HIDWORD(v30), 13) ^ v45;
        LODWORD(v52) = v46;
        *(_QWORD *)&v51 = __PAIR64__(v43, v37);
        v39 = __ROR4__(v46 + HIDWORD(v30), 14) ^ v40;
        v6 = __ROL4__(v42 + v32, 7) ^ v15;
        *(_QWORD *)((char *)&v52 + 4) = __PAIR64__(v30, v39);
        v33 = __ROL4__(v6 + v42, 9) ^ v34;
        LODWORD(v53) = v33;
        v31 = __ROL4__(v6 + v33, 13) ^ v32;
        DWORD1(v53) = v31;
        v11 = __ROL4__(v14 + v16, 7) ^ v49;
        v41 = __ROR4__(v33 + v31, 14) ^ v42;
        DWORD2(v53) = v41;
        LODWORD(v54) = v11;
        v10 = __ROL4__(v11 + v16, 9) ^ v13;
        v9 = __ROL4__(v11 + v10, 13) ^ v14;
        v8 = __ROR4__(v9 + v10, 14) ^ v16;
        v17 = v48-- == 1;
        v12 = v37;
        if ( v17 )
          break;
        v7 = v46;
      }
      v4 = (__int128 *)a4;
      v18 = 0;
      v19 = a3;
      HIDWORD(v53) = v6;
      *((_QWORD *)&v54 + 1) = __PAIR64__(v8, v9);
      DWORD1(v54) = v10;
      if ( (unsigned int)&v51 > v50 || (unsigned int)&v54 + 12 < a4 )
      {
        do
        {
          *(__int128 *)((char *)&v51 + 4 * v18) = (__int128)_mm_add_epi32(
                                                              *(__m128i *)((char *)&v51 + 4 * v18),
                                                              *(__m128i *)(a4 + 4 * v18));
          *(__int128 *)((char *)&v52 + 4 * v18) = (__int128)_mm_add_epi32(
                                                              *(__m128i *)(a4 + 4 * v18 + 16),
                                                              *(__m128i *)((char *)&v52 + 4 * v18));
          v18 += 8;
        }
        while ( v18 < 16 );
      }
      else
      {
        do
        {
          *((_DWORD *)&v51 + v18) += *(_DWORD *)(a4 + 4 * v18);
          ++v18;
        }
        while ( v18 < 16 );
      }
      v20 = __CFADD__((*(_DWORD *)(a4 + 32))++, 1);
      v21 = a2;
      result = 64;
      *(_DWORD *)(a4 + 36) += v20;
      if ( a2 > 0x40 )
        v21 = 64;
      v22 = 0;
      if ( v21 >= 0x20 )
      {
        if ( a3 > (__m128i *)((char *)&v50 + v21 + 3)
          || (result = (int)&v51, (char *)&a3[-1].m128i_u64[1] + v21 + 7 < (char *)&v51) )
        {
          v23 = a3;
          v19 = a3;
          result = (char *)&v51 - (char *)a3;
          do
          {
            v24 = *v23;
            v22 += 32;
            v23 += 2;
            v23[-2] = _mm_xor_si128(*(__m128i *)((char *)&v23[-2] + (char *)&v51 - (char *)a3), v24);
            v23[-1] = _mm_xor_si128(*(__m128i *)((char *)&v23[-2] + (char *)&v52 - (char *)a3), v23[-1]);
          }
          while ( v22 < (v21 & 0xFFFFFFE0) );
          v4 = (__int128 *)a4;
        }
      }
      if ( v22 < v21 )
      {
        v25 = &v19[v22 / 0x10];
        v26 = (char *)((char *)&v51 - (char *)v19);
        v27 = v21 - v22;
        do
        {
          LOBYTE(result) = v26[(_DWORD)v25];
          v25 = (__m128i *)((char *)v25 + 1);
          v25[-1].m128i_i8[15] ^= result;
          --v27;
        }
        while ( v27 );
        v19 = a3;
      }
      a3 = (__m128i *)((char *)v19 + v21);
      a2 -= v21;
    }
    while ( a2 );
  }
  return result;
}
// 4023E7: conditional instruction was optimized away because ebx.4!=0

//----- (00404CD8) --------------------------------------------------------
unsigned int __stdcall sub_404CD8(unsigned int *a1, unsigned int a2)
{
  _DWORD *v2; // edi
  unsigned __int32 v3; // ebx
  unsigned __int32 v4; // ecx
  unsigned __int32 v5; // edx
  unsigned __int32 v6; // ebx
  unsigned __int32 v7; // edx
  unsigned int result; // eax
  int v9; // esi
  unsigned int v10; // eax
  int v11; // eax
  int v12; // eax
  unsigned int v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // eax
  unsigned int v17; // eax
  int v18; // eax
  int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  int v22; // eax
  unsigned int v23; // ecx
  unsigned int v24; // ebx
  int *v25; // edi
  int v26; // edx
  int v27; // edx
  int v28; // edx
  int v29; // edx
  int i; // esi

  v2 = dword_411010;
  v3 = _byteswap_ulong(a1[1]);
  v4 = _byteswap_ulong(a1[2]);
  v5 = _byteswap_ulong(a1[3]);
  dword_411010[0] = _byteswap_ulong(*a1);
  dword_411010[1] = v3;
  dword_411010[2] = v4;
  dword_411010[3] = v5;
  if ( a2 >= 0x18 )
  {
    v6 = _byteswap_ulong(a1[5]);
    dword_411010[4] = _byteswap_ulong(a1[4]);
    dword_411010[5] = v6;
    if ( a2 >= 0x20 )
    {
      v7 = _byteswap_ulong(a1[7]);
      dword_411010[6] = _byteswap_ulong(a1[6]);
      dword_411010[7] = v7;
    }
  }
  result = a2;
  v9 = 0;
  switch ( a2 )
  {
    case 0x10u:
      while ( 1 )
      {
        v10 = *v2 ^ dword_404CB0[v9] ^ (unsigned __int8)dword_4034B0[HIBYTE(v2[3])] ^ dword_4034B0[(unsigned __int8)v2[3]] & 0xFF00 ^ dword_4034B0[(unsigned __int8)BYTE1(v2[3])] & 0xFF0000 ^ dword_4034B0[(unsigned __int8)BYTE2(v2[3])] & 0xFF000000;
        v2[4] = v10;
        v11 = v2[1] ^ v10;
        v2[5] = v11;
        v12 = v2[2] ^ v11;
        v2[6] = v12;
        result = v2[3] ^ v12;
        v2[7] = result;
        if ( ++v9 == 10 )
          break;
        v2 += 4;
      }
      break;
    case 0x18u:
      while ( 1 )
      {
        v13 = *v2 ^ dword_404CB0[v9] ^ (unsigned __int8)dword_4034B0[HIBYTE(v2[5])] ^ dword_4034B0[(unsigned __int8)v2[5]] & 0xFF00 ^ dword_4034B0[(unsigned __int8)BYTE1(v2[5])] & 0xFF0000 ^ dword_4034B0[(unsigned __int8)BYTE2(v2[5])] & 0xFF000000;
        v2[6] = v13;
        v14 = v2[1] ^ v13;
        v2[7] = v14;
        v15 = v2[2] ^ v14;
        v2[8] = v15;
        result = v2[3] ^ v15;
        v2[9] = result;
        if ( ++v9 == 8 )
          break;
        v16 = v2[4] ^ result;
        v2[10] = v16;
        v2[11] = v2[5] ^ v16;
        v2 += 6;
      }
      v9 = 12;
      break;
    case 0x20u:
      while ( 1 )
      {
        v17 = *v2 ^ dword_404CB0[v9] ^ (unsigned __int8)dword_4034B0[HIBYTE(v2[7])] ^ dword_4034B0[(unsigned __int8)v2[7]] & 0xFF00 ^ dword_4034B0[(unsigned __int8)BYTE1(v2[7])] & 0xFF0000 ^ dword_4034B0[(unsigned __int8)BYTE2(v2[7])] & 0xFF000000;
        v2[8] = v17;
        v18 = v2[1] ^ v17;
        v2[9] = v18;
        v19 = v2[2] ^ v18;
        v2[10] = v19;
        result = v2[3] ^ v19;
        v2[11] = result;
        if ( ++v9 == 7 )
          break;
        v20 = v2[4] ^ (unsigned __int8)dword_4034B0[(unsigned __int8)result] ^ dword_4034B0[BYTE1(result)] & 0xFF00 ^ dword_4034B0[BYTE2(result)] & 0xFF0000 ^ dword_4034B0[HIBYTE(result)] & 0xFF000000;
        v2[12] = v20;
        v21 = v2[5] ^ v20;
        v2[13] = v21;
        v22 = v2[6] ^ v21;
        v2[14] = v22;
        v2[15] = v2[7] ^ v22;
        v2 += 8;
      }
      v9 = 14;
      break;
  }
  dword_411210 = v9;
  v23 = 0;
  v24 = 4 * v9;
  v25 = dword_411110;
  while ( v23 <= v24 )
  {
    v26 = dword_411010[v23 + 1];
    dword_411110[v24] = dword_411010[v23];
    dword_411110[v24 + 1] = v26;
    v27 = dword_411010[v23 + 3];
    dword_411110[v24 + 2] = dword_411010[v23 + 2];
    dword_411110[v24 + 3] = v27;
    v28 = dword_411010[v24 + 1];
    dword_411110[v23] = dword_411010[v24];
    dword_411110[v23 + 1] = v28;
    result = dword_411010[v24 + 2];
    v29 = dword_411010[v24 + 3];
    dword_411110[v23 + 2] = result;
    dword_411110[v23 + 3] = v29;
    v23 += 4;
    v24 -= 4;
  }
  for ( i = dword_411210 - 1; i; --i )
  {
    v25 += 4;
    *v25 = dword_4044B0[(unsigned __int8)dword_4034B0[(unsigned __int8)*v25]] ^ dword_4040B0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE1(*v25)]] ^ dword_403CB0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE2(*v25)]] ^ dword_4038B0[(unsigned __int8)dword_4034B0[HIBYTE(*v25)]];
    v25[1] = dword_4044B0[(unsigned __int8)dword_4034B0[(unsigned __int8)v25[1]]] ^ dword_4040B0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE1(v25[1])]] ^ dword_403CB0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE2(v25[1])]] ^ dword_4038B0[(unsigned __int8)dword_4034B0[HIBYTE(v25[1])]];
    v25[2] = dword_4044B0[(unsigned __int8)dword_4034B0[(unsigned __int8)v25[2]]] ^ dword_4040B0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE1(v25[2])]] ^ dword_403CB0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE2(v25[2])]] ^ dword_4038B0[(unsigned __int8)dword_4034B0[HIBYTE(v25[2])]];
    result = dword_4044B0[(unsigned __int8)dword_4034B0[(unsigned __int8)v25[3]]] ^ dword_4040B0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE1(v25[3])]] ^ dword_403CB0[(unsigned __int8)dword_4034B0[(unsigned __int8)BYTE2(v25[3])]] ^ dword_4038B0[(unsigned __int8)dword_4034B0[HIBYTE(v25[3])]];
    v25[3] = result;
  }
  return result;
}
// 4034B0: using guessed type int dword_4034B0[];
// 4038B0: using guessed type int dword_4038B0[];
// 403CB0: using guessed type int dword_403CB0[];
// 4040B0: using guessed type int dword_4040B0[];
// 4044B0: using guessed type int dword_4044B0[];
// 404CB0: using guessed type int dword_404CB0[];
// 411010: using guessed type _DWORD dword_411010[64];
// 411110: using guessed type _DWORD dword_411110[64];
// 411210: using guessed type int dword_411210;

//----- (004051E8) --------------------------------------------------------
unsigned __int32 __stdcall sub_4051E8(unsigned int *a1, _DWORD *a2)
{
  _DWORD *v2; // edi
  unsigned int v3; // esi
  unsigned __int32 result; // eax
  unsigned int v5; // [esp+Ch] [ebp-20h]
  unsigned int v6; // [esp+10h] [ebp-1Ch]
  unsigned int v7; // [esp+14h] [ebp-18h]
  unsigned int v8; // [esp+18h] [ebp-14h]
  unsigned __int32 v9; // [esp+1Ch] [ebp-10h]
  unsigned __int32 v10; // [esp+20h] [ebp-Ch]
  unsigned __int32 v11; // [esp+24h] [ebp-8h]
  unsigned __int32 v12; // [esp+28h] [ebp-4h]

  v2 = dword_411010;
  v12 = dword_411010[0] ^ _byteswap_ulong(*a1);
  v11 = dword_411010[1] ^ _byteswap_ulong(a1[1]);
  v10 = dword_411010[2] ^ _byteswap_ulong(a1[2]);
  v9 = dword_411010[3] ^ _byteswap_ulong(a1[3]);
  v3 = (unsigned int)dword_411210 >> 1;
  while ( 1 )
  {
    v8 = v2[4] ^ dword_4030B0[(unsigned __int8)v9] ^ dword_402CB0[BYTE1(v10)] ^ dword_4028B0[BYTE2(v11)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v12)];
    v7 = v2[5] ^ dword_4030B0[(unsigned __int8)v12] ^ dword_402CB0[BYTE1(v9)] ^ dword_4028B0[BYTE2(v10)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v11)];
    v6 = v2[6] ^ dword_4030B0[(unsigned __int8)v11] ^ dword_402CB0[BYTE1(v12)] ^ dword_4028B0[BYTE2(v9)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v10)];
    v5 = v2[7] ^ dword_4030B0[(unsigned __int8)v10] ^ dword_402CB0[BYTE1(v11)] ^ dword_4028B0[BYTE2(v12)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v9)];
    v2 += 8;
    if ( !--v3 )
      break;
    v12 = *v2 ^ dword_4030B0[(unsigned __int8)v5] ^ dword_402CB0[BYTE1(v6)] ^ dword_4028B0[BYTE2(v7)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v8)];
    v11 = v2[1] ^ dword_4030B0[(unsigned __int8)v8] ^ dword_402CB0[BYTE1(v5)] ^ dword_4028B0[BYTE2(v6)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v7)];
    v10 = v2[2] ^ dword_4030B0[(unsigned __int8)v7] ^ dword_402CB0[BYTE1(v8)] ^ dword_4028B0[BYTE2(v5)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v6)];
    v9 = v2[3] ^ dword_4030B0[(unsigned __int8)v6] ^ dword_402CB0[BYTE1(v7)] ^ dword_4028B0[BYTE2(v8)] ^ RijnDael_AES_Base_4024B0[HIBYTE(v5)];
  }
  *a2 = _byteswap_ulong(*v2 ^ (unsigned __int8)dword_4034B0[(unsigned __int8)v5] ^ dword_4034B0[BYTE1(v6)] & 0xFF00 ^ dword_4034B0[BYTE2(v7)] & 0xFF0000 ^ dword_4034B0[HIBYTE(v8)] & 0xFF000000);
  a2[1] = _byteswap_ulong(v2[1] ^ (unsigned __int8)dword_4034B0[(unsigned __int8)v8] ^ dword_4034B0[BYTE1(v5)] & 0xFF00 ^ dword_4034B0[BYTE2(v6)] & 0xFF0000 ^ dword_4034B0[HIBYTE(v7)] & 0xFF000000);
  a2[2] = _byteswap_ulong(v2[2] ^ (unsigned __int8)dword_4034B0[(unsigned __int8)v7] ^ dword_4034B0[BYTE1(v8)] & 0xFF00 ^ dword_4034B0[BYTE2(v5)] & 0xFF0000 ^ dword_4034B0[HIBYTE(v6)] & 0xFF000000);
  result = _byteswap_ulong(v2[3] ^ (unsigned __int8)dword_4034B0[(unsigned __int8)v6] ^ dword_4034B0[BYTE1(v7)] & 0xFF00 ^ dword_4034B0[BYTE2(v8)] & 0xFF0000 ^ dword_4034B0[HIBYTE(v5)] & 0xFF000000);
  a2[3] = result;
  return result;
}
// 4024B0: using guessed type int RijnDael_AES_Base_4024B0[];
// 4028B0: using guessed type int dword_4028B0[];
// 402CB0: using guessed type int dword_402CB0[];
// 4030B0: using guessed type int dword_4030B0[];
// 4034B0: using guessed type int dword_4034B0[];
// 411010: using guessed type _DWORD dword_411010[64];
// 411210: using guessed type int dword_411210;

//----- (0040565D) --------------------------------------------------------
unsigned int __stdcall sub_40565D(unsigned int *a1, unsigned int a2, unsigned int *a3, int a4)
{
  unsigned int v4; // ebx
  unsigned int *v5; // edi

  sub_404CD8(a1, a2);
  memset((char *)a3 + a4, ((a4 + 15) & 0xF0) + 16 - a4, ((a4 + 15) & 0xFFFFFFF0) + 16 - a4);
  v4 = (((a4 + 15) & 0xFFFFFFF0) + 16) >> 4;
  v5 = a3;
  do
  {
    sub_4051E8(v5, v5);
    v5 += 4;
    --v4;
  }
  while ( v4 );
  return ((a4 + 15) & 0xFFFFFFF0) + 16;
}

//----- (004056AB) --------------------------------------------------------
int __stdcall sub_4056AB(int *a1)
{
  int v1; // edx
  int v2; // edx
  int v3; // edx
  int v4; // edx
  int v5; // edx
  int v6; // edx
  int result; // eax
  int v8; // edx

  *a1 = sub_401014();
  a1[1] = v1;
  a1[2] = sub_401014();
  a1[3] = v2;
  a1[4] = sub_401014();
  a1[5] = v3;
  a1[6] = sub_401014();
  a1[7] = v4;
  a1[8] = 0;
  a1[9] = 0;
  a1[10] = sub_401014();
  a1[11] = v5;
  a1[12] = sub_401014();
  a1[13] = v6;
  result = sub_401014();
  a1[14] = result;
  a1[15] = v8;
  return result;
}
// 4056B9: variable 'v1' is possibly undefined
// 4056C4: variable 'v2' is possibly undefined
// 4056CF: variable 'v3' is possibly undefined
// 4056DA: variable 'v4' is possibly undefined
// 4056EF: variable 'v5' is possibly undefined
// 4056FA: variable 'v6' is possibly undefined
// 405705: variable 'v8' is possibly undefined

//----- (0040570D) --------------------------------------------------------
int __stdcall sub_40570D(unsigned __int8 a1)
{
  if ( a1 < 0x30u )
    return 0;
  if ( a1 <= 0x39u )
    return 1;
  if ( a1 < 0x41u )
    return 0;
  if ( a1 > 0x5Au )
  {
    if ( a1 >= 0x61u && a1 <= 0x7Au )
      return 3;
    return 0;
  }
  return 2;
}

//----- (00405755) --------------------------------------------------------
char __stdcall sub_405755(_BYTE *a1)
{
  int v1; // eax
  unsigned int v2; // ecx
  _BYTE *v3; // esi
  int v4; // ecx

  LOBYTE(v1) = 0;
  v2 = 0;
  v3 = a1;
  do
  {
    if ( !a1[v2] )
      break;
    ++v2;
  }
  while ( v2 <= 0x40 );
  if ( v2 >= 5 )
  {
    do
    {
      LOBYTE(v1) = *v3++;
      if ( !(_BYTE)v1 )
        break;
      v1 = sub_40570D(v1);
      if ( !v1 && *(v3 - 1) != 45 && *(v3 - 1) != 46 )
        break;
    }
    while ( v4 != 1 );
  }
  return v1;
}
// 4057A0: variable 'v4' is possibly undefined

//----- (004057A7) --------------------------------------------------------
int __userpurge sub_4057A7@<eax>(char *a1@<ebx>, char *a2)
{
  char *v3; // edi
  char v4; // al
  int v5; // eax
  int v6; // eax
  char v8[260]; // [esp+Ch] [ebp-108h] BYREF
  int v9; // [esp+110h] [ebp-4h]

  v9 = 0;
  v3 = v8;
  while ( *(_WORD *)a2 )
  {
    v4 = *a2++;
    if ( !v4 )
    {
      *v3 = 0;
      break;
    }
    if ( v4 == 46 )
    {
      *v3++ = 0;
      a1 = v3;
    }
    else
    {
      *v3++ = v4;
    }
  }
  if ( dword_411214 )
  {
    v5 = dword_411214(v8);
    if ( v5 )
    {
      if ( dword_411218 )
      {
        v6 = dword_411218(v5, a1);
        if ( v6 )
          return v6;
      }
    }
  }
  return v9;
}
// 411214: using guessed type int (__stdcall *dword_411214)(_DWORD);
// 411218: using guessed type int (__stdcall *dword_411218)(_DWORD, _DWORD);

//----- (0040581D) --------------------------------------------------------
char *__stdcall sub_40581D(int a1)
{
  struct _LIST_ENTRY *Flink; // ecx
  struct _LIST_ENTRY *v2; // ebx
  int v3; // edx
  _DWORD *v4; // edx
  int *v5; // esi
  unsigned __int16 *v6; // edi
  int v7; // eax
  int v8; // edx
  int v9; // eax
  struct _LIST_ENTRY *p_InLoadOrderModuleList; // [esp+Ch] [ebp-10h]
  int v12; // [esp+10h] [ebp-Ch]
  int v13; // [esp+14h] [ebp-8h]
  char *v14; // [esp+18h] [ebp-4h]

  if ( !dword_411214 )
  {
    dword_411214 = (int (__stdcall *)(_DWORD))667967154;
    dword_411214 = (int (__stdcall *)(_DWORD))sub_40581D(667967154);
  }
  if ( !dword_411218 )
  {
    dword_411218 = (int (__stdcall *)(_DWORD, _DWORD))-1147965348;
    dword_411218 = (int (__stdcall *)(_DWORD, _DWORD))sub_40581D(-1147965348);
  }
  v14 = 0;
  p_InLoadOrderModuleList = &NtCurrentPeb()->Ldr->InLoadOrderModuleList;
  Flink = p_InLoadOrderModuleList->Flink;
  do
  {
    v2 = Flink[3].Flink;
    if ( *(struct _LIST_ENTRY **)((char *)&v2[15].Flink + (unsigned int)v2[7].Blink) )
    {
      v12 = sub_4010BB(Flink[6].Flink, 0);
      v4 = (struct _LIST_ENTRY **)((char *)&v2->Flink + v3);
      if ( v4[6] )
      {
        v13 = v4[6];
        v5 = (int *)((char *)v2 + v4[8]);
        v6 = (unsigned __int16 *)((char *)v2 + v4[9]);
        while ( 1 )
        {
          v7 = *v5++;
          if ( sub_401096((_BYTE *)v2 + v7, v12) == a1 )
            break;
          ++v6;
          if ( !--v13 )
            goto LABEL_14;
        }
        v14 = (char *)v2 + *(unsigned int *)((char *)&v2->Flink + 4 * *v6 + *(_DWORD *)(v8 + 28));
        LOBYTE(v9) = sub_405755(v14);
        if ( v9 )
          v14 = (char *)sub_4057A7((char *)v2, v14);
      }
LABEL_14:
      if ( v14 )
        break;
    }
    Flink = Flink->Flink;
  }
  while ( p_InLoadOrderModuleList != Flink );
  return v14;
}
// 4058AE: variable 'v3' is possibly undefined
// 4058DB: variable 'v8' is possibly undefined
// 4058EE: variable 'v9' is possibly undefined
// 405911: variable 'Flink' is possibly undefined
// 411214: using guessed type int (__stdcall *dword_411214)(_DWORD);
// 411218: using guessed type int (__stdcall *dword_411218)(_DWORD, _DWORD);

//----- (00405928) --------------------------------------------------------
int __stdcall sub_405928(int a1)
{
  _DWORD *v1; // ebx
  char v3[44]; // [esp+4h] [ebp-258h] BYREF
  _WORD v4[274]; // [esp+30h] [ebp-22Ch] BYREF
  int v5; // [esp+254h] [ebp-8h]
  int v6; // [esp+258h] [ebp-4h]

  v6 = 0;
  if ( !dword_41121C )
  {
    dword_41121C = (int (__stdcall *)(_DWORD, _DWORD))-635785566;
    dword_41121C = (int (__stdcall *)(_DWORD, _DWORD))sub_40581D(-635785566);
  }
  if ( !dword_411220 )
  {
    dword_411220 = (int (__stdcall *)(_DWORD, _DWORD))1466616277;
    dword_411220 = (int (__stdcall *)(_DWORD, _DWORD))sub_40581D(1466616277);
  }
  if ( !dword_411224 )
  {
    dword_411224 = (int (__stdcall *)(_DWORD))2017475196;
    dword_411224 = (int (__stdcall *)(_DWORD))sub_40581D(2017475196);
  }
  if ( !dword_411228 )
  {
    dword_411228 = (int (__stdcall *)(_DWORD))679501490;
    dword_411228 = (int (__stdcall *)(_DWORD))sub_40581D(679501490);
  }
  v1 = word_41122C;
  if ( !LOBYTE(word_41122C[0]) )
  {
    sub_401654(word_41122C);
    while ( *(_WORD *)v1 )
      v1 = (_DWORD *)((char *)v1 + 2);
    *v1 = 573333425;
    v1[1] = 576872387;
    v1[2] = 577396609;
    *v1 ^= 0x22065FEDu;
    v1[1] ^= 0x22065FEDu;
    v1[2] ^= 0x22065FEDu;
  }
  v5 = dword_41121C(word_41122C, v3);
  if ( v5 != -1 )
  {
    while ( sub_4010BB(v4, 0) != a1 )
    {
      if ( !dword_411220(v5, v3) )
        goto LABEL_18;
    }
    v6 = dword_411228(v4);
LABEL_18:
    dword_411224(v5);
  }
  return v6;
}
// 41121C: using guessed type int (__stdcall *dword_41121C)(_DWORD, _DWORD);
// 411220: using guessed type int (__stdcall *dword_411220)(_DWORD, _DWORD);
// 411224: using guessed type int (__stdcall *dword_411224)(_DWORD);
// 411228: using guessed type int (__stdcall *dword_411228)(_DWORD);
// 41122C: using guessed type _WORD word_41122C[64];
// 405928: using guessed type _WORD var_22C[274];

//----- (00405A86) --------------------------------------------------------
int __stdcall sub_405A86(int a1, _DWORD *a2, int a3, int (__stdcall *a4)(int, _DWORD, int))
{
  int *v4; // esi
  int result; // eax
  int *v6; // edi
  char *v7; // ebx
  int v8; // eax

  v4 = a2 + 1;
  result = sub_405928(*a2 ^ 0x22065FED);
  if ( result )
  {
    v6 = (int *)(a1 + 4);
    while ( 1 )
    {
      result = *v4++;
      if ( result == -858993460 )
        break;
      v7 = sub_40581D(result ^ 0x22065FED);
      v8 = a4(a3, 0, 12);
      if ( *(_DWORD *)(v8 + 12) != -1414812757 )
        *v6++ = v8;
      *(_BYTE *)v8 = -72;
      *(_DWORD *)(v8 + 1) = (unsigned int)v7 ^ 0x22065FED;
      *(_BYTE *)(v8 + 5) = 53;
      *(_DWORD *)(v8 + 6) = 570843117;
      *(_WORD *)(v8 + 10) = -7937;
    }
  }
  return result;
}

//----- (00405E5C) --------------------------------------------------------
char *sub_405E5C()
{
  char *result; // eax
  int v1; // esi
  char *v2; // edi

  result = sub_40581D(638256965);
  if ( result )
  {
    result = (char *)((int (__stdcall *)(int, _DWORD, _DWORD))result)(0x40000, 0, 0);
    v1 = (int)result;
    if ( result )
    {
      result = sub_40581D(1851803611);
      v2 = result;
      if ( result )
      {
        sub_405A86((int)&unk_4112AC, dword_405AFC, v1, (int (__stdcall *)(int, _DWORD, int))result);
        sub_405A86((int)&unk_411368, dword_405BBC, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411428, dword_405C80, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411480, dword_405CDC, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_4114B4, dword_405D14, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_4114EC, dword_405D50, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_4114FC, dword_405D64, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411518, dword_405D84, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411540, dword_405DB0, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_41154C, dword_405DC0, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411554, dword_405DCC, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411568, dword_405DE4, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        sub_405A86((int)&unk_411594, dword_405E14, v1, (int (__stdcall *)(int, _DWORD, int))v2);
        return (char *)sub_405A86((int)&unk_4115A8, dword_405E2C, v1, (int (__stdcall *)(int, _DWORD, int))v2);
      }
    }
  }
  return result;
}
// 405AFC: using guessed type int dword_405AFC[48];
// 405BBC: using guessed type int dword_405BBC[49];
// 405C80: using guessed type int dword_405C80[23];
// 405CDC: using guessed type int dword_405CDC[14];
// 405D14: using guessed type int dword_405D14[15];
// 405D50: using guessed type int dword_405D50[5];
// 405D64: using guessed type int dword_405D64[8];
// 405D84: using guessed type int dword_405D84[11];
// 405DB0: using guessed type int dword_405DB0[4];
// 405DC0: using guessed type int dword_405DC0[3];
// 405DCC: using guessed type int dword_405DCC[6];
// 405DE4: using guessed type int dword_405DE4[12];
// 405E14: using guessed type int dword_405E14[6];
// 405E2C: using guessed type int dword_405E2C[12];

//----- (00405F98) --------------------------------------------------------
int __stdcall sub_405F98(int a1)
{
  return dword_4112B0(NtCurrentPeb()->ProcessHeap, 8, a1);
}
// 4112B0: using guessed type int (__stdcall *dword_4112B0)(_DWORD, _DWORD, _DWORD);

//----- (00405FB3) --------------------------------------------------------
int __stdcall sub_405FB3(int a1)
{
  return dword_4112B8(NtCurrentPeb()->ProcessHeap, 0, a1);
}
// 4112B8: using guessed type int (__stdcall *dword_4112B8)(_DWORD, _DWORD, _DWORD);

//----- (00405FCE) --------------------------------------------------------
int __stdcall sub_405FCE(int a1, int a2)
{
  return dword_4112B4(NtCurrentPeb()->ProcessHeap, 8, a1, a2);
}
// 4112B4: using guessed type int (__stdcall *dword_4112B4)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00405FEC) --------------------------------------------------------
unsigned int __stdcall sub_405FEC(int a1)
{
  unsigned int result; // eax
  unsigned int v2; // ecx

  result = sub_405F98(a1 + 19);
  v2 = result;
  if ( result )
  {
    result = (result + 19) & 0xFFFFFFF0;
    *(_DWORD *)(result - 4) = v2;
  }
  return result;
}

//----- (00406022) --------------------------------------------------------
int __stdcall sub_406022(int a1)
{
  return sub_405FB3(*(_DWORD *)(a1 - 4));
}

//----- (00406035) --------------------------------------------------------
int __stdcall sub_406035(int a1, int a2)
{
  int v2; // eax
  int v4; // [esp+0h] [ebp-4h]

  v4 = 0;
  v2 = dword_4112D4(a1);
  if ( v2 )
  {
    v4 = sub_405F98(2 * (a2 + v2) + 2);
    if ( v4 )
      dword_4112DC(v4, a1);
  }
  return v4;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);

//----- (00406083) --------------------------------------------------------
_DWORD *__stdcall sub_406083(int a1)
{
  int v1; // ebx
  _DWORD *v2; // eax
  _DWORD *v3; // esi
  int v5; // [esp+8h] [ebp-4h]

  v5 = 0;
  v1 = dword_4112D4(a1);
  if ( v1 )
  {
    v2 = (_DWORD *)sub_405F98(2 * v1 + 10);
    v3 = v2;
    if ( v2 )
    {
      *v2 = 6029404;
      v2[1] = 6029375;
      dword_4112D8(v2, a1);
      return v3;
    }
  }
  return (_DWORD *)v5;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);

//----- (004060DF) --------------------------------------------------------
_DWORD *__stdcall sub_4060DF(_DWORD *a1, int a2)
{
  _DWORD *v2; // esi
  int v3; // ebx
  int v4; // eax
  _DWORD *v6; // [esp+8h] [ebp-4h]

  v2 = a1;
  v3 = dword_4112D4(a1);
  v4 = dword_4112D4(a2);
  v6 = (_DWORD *)sub_405F98(2 * (v4 + v3) + 22);
  if ( v6 )
  {
    *v6 = 6029404;
    v6[1] = 6029375;
    v6[2] = 5111893;
    v6[3] = 6029379;
    if ( *a1 == 6029404 )
      v2 = a1 + 1;
    dword_4112D8(v6, v2);
    sub_4016B4((int)v6);
    dword_4112D8(v6, a2);
  }
  return v6;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);

//----- (00406173) --------------------------------------------------------
_DWORD *__stdcall sub_406173(_DWORD *a1)
{
  _DWORD *v1; // esi
  int v2; // ebx
  _DWORD *v3; // eax
  _DWORD *v4; // ebx
  int v6; // [esp+8h] [ebp-4h]

  v6 = 0;
  v1 = a1;
  v2 = dword_4112D4(a1);
  if ( v2 )
  {
    v3 = (_DWORD *)sub_405F98(2 * v2 + 22);
    v4 = v3;
    if ( v3 )
    {
      *v3 = 6029404;
      v3[1] = 6029375;
      v3[2] = 5111893;
      v3[3] = 6029379;
      if ( *a1 == 6029404 )
        v1 = a1 + 1;
      dword_4112D8(v3, v1);
      return v4;
    }
  }
  return (_DWORD *)v6;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);

//----- (004061E7) --------------------------------------------------------
int sub_4061E7()
{
  __int64 v1; // [esp+Ch] [ebp-10h] BYREF
  char v2[8]; // [esp+14h] [ebp-8h] BYREF

  dword_41141C(v2);
  dword_411420(v2, &v1);
  return dword_411300(v1 + 717324288, (unsigned __int64)(v1 - 116444736000000000i64) >> 32, 10000000, 0);
}
// 411300: using guessed type int (__stdcall *dword_411300)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41141C: using guessed type int (__stdcall *dword_41141C)(_DWORD);
// 411420: using guessed type int (__stdcall *dword_411420)(_DWORD, _DWORD);

//----- (00406245) --------------------------------------------------------
int __stdcall sub_406245(int a1)
{
  _DWORD *v1; // eax
  int v2; // ecx
  _DWORD *v3; // eax
  int v4; // ecx
  char v6[128]; // [esp+0h] [ebp-E4h] BYREF
  _DWORD v7[16]; // [esp+80h] [ebp-64h] BYREF
  _DWORD v8[6]; // [esp+C0h] [ebp-24h] BYREF
  int v9; // [esp+D8h] [ebp-Ch] BYREF
  int v10; // [esp+DCh] [ebp-8h] BYREF
  int v11; // [esp+E0h] [ebp-4h] BYREF

  v9 = 0;
  v1 = v7;
  v7[0] = 575233982;
  v7[1] = 575823787;
  v7[2] = 575102906;
  v7[3] = 574840767;
  v7[4] = 575365041;
  v7[5] = 577068932;
  v7[6] = 577331103;
  v7[7] = 577331102;
  v7[8] = 577920907;
  v7[9] = 574971825;
  v7[10] = 578772895;
  v7[11] = 577920925;
  v7[12] = 576806786;
  v7[13] = 577200031;
  v7[14] = 577658781;
  v7[15] = 570843028;
  v2 = 16;
  do
  {
    *v1++ ^= 0x22065FEDu;
    --v2;
  }
  while ( v2 );
  v3 = v8;
  v8[0] = 577200032;
  v8[1] = 577658766;
  v8[2] = 577265540;
  v8[3] = 574709640;
  v8[4] = 577724312;
  v8[5] = 570843017;
  v4 = 6;
  do
  {
    *v3++ ^= 0x22065FEDu;
    --v4;
  }
  while ( v4 );
  if ( !dword_41143C(-2147483646, v7, 0, 0, 0, 131353, 0, &v11, 0) )
  {
    v10 = 1;
    v9 = 128;
    if ( !dword_411444(v11, v8, 0, &v10, v6, &v9) )
      dword_4112BC(a1, v6, v9);
    dword_411354(v11);
  }
  return v9;
}
// 4112BC: using guessed type int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411444: using guessed type int (__stdcall *dword_411444)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 406245: using guessed type _DWORD var_64[16];
// 406245: using guessed type _DWORD var_24[6];

//----- (00406393) --------------------------------------------------------
int __stdcall sub_406393(int a1, int a2)
{
  int v2; // ebx
  int v4[10]; // [esp+4h] [ebp-38h] BYREF
  int v5; // [esp+2Ch] [ebp-10h] BYREF
  char v6[4]; // [esp+30h] [ebp-Ch] BYREF
  int v7; // [esp+34h] [ebp-8h] BYREF
  int v8; // [esp+38h] [ebp-4h]

  v8 = 0;
  v7 = 0;
  v5 = 0;
  v2 = a1;
  if ( !a1 )
  {
    if ( dword_41132C(-1, 8, &v7) )
      goto LABEL_7;
    v2 = v7;
  }
  if ( !dword_411320(v2, 1, v4, 40, v6) && dword_411470(v4[0], &v5) )
  {
    dword_4112DC(a2, v5);
    v8 = 1;
  }
LABEL_7:
  if ( v5 )
    sub_405FB3(v5);
  if ( v7 )
    dword_411354(v7);
  return v8;
}
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 411320: using guessed type int (__stdcall *dword_411320)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41132C: using guessed type int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411470: using guessed type int (__stdcall *dword_411470)(_DWORD, _DWORD);
// 406393: using guessed type char var_C[4];
// 406393: using guessed type int var_38[10];

//----- (00406438) --------------------------------------------------------
int sub_406438()
{
  int v0; // ebx
  _WORD *v1; // eax
  _WORD *v2; // edi
  int v3; // eax
  int v4; // eax
  int *v5; // esi
  __int16 v6; // ax
  int v8[2]; // [esp+Eh] [ebp-62h] BYREF
  char v9; // [esp+17h] [ebp-59h]
  _WORD v10[37]; // [esp+1Eh] [ebp-52h] BYREF
  unsigned int v11[2]; // [esp+68h] [ebp-8h] BYREF

  v0 = 0;
  if ( sub_406245((int)v10) )
  {
    v1 = (_WORD *)sub_405F98(20);
    v0 = (int)v1;
    if ( v1 )
    {
      *v1 = 46;
      v2 = v1 + 1;
      v3 = sub_4010BB(v10, -1);
      v4 = sub_4010BB(v10, v3);
      v11[0] = sub_4010BB(v10, v4);
      v11[1] = _byteswap_ulong(v11[0]);
      v5 = v8;
      sub_4013EE(v0, v11, 8, v8);
      v9 = 0;
      HIBYTE(v6) = 0;
      while ( 1 )
      {
        LOBYTE(v6) = *(_BYTE *)v5;
        v5 = (int *)((char *)v5 + 1);
        if ( !(_BYTE)v6 )
          break;
        switch ( (_BYTE)v6 )
        {
          case '+':
            LOBYTE(v6) = 120;
            break;
          case '/':
            LOBYTE(v6) = 105;
            break;
          case '=':
            LOBYTE(v6) = 122;
            break;
        }
        *v2++ = v6;
      }
      *v2 = v6;
    }
  }
  return v0;
}
// 406438: using guessed type _WORD var_52[37];

//----- (004064CC) --------------------------------------------------------
_BYTE *__stdcall sub_4064CC(_DWORD *a1)
{
  _BYTE *v1; // eax
  _BYTE *v2; // ebx
  unsigned int v3; // edx

  v1 = (_BYTE *)sub_405F98(*(a1 - 1));
  v2 = v1;
  if ( v1 )
  {
    v3 = *(a1 - 1);
    qmemcpy(v1, a1, v3);
    sub_401713(v1, v3);
  }
  return v2;
}

//----- (004064FA) --------------------------------------------------------
unsigned int *__stdcall sub_4064FA(const void *a1, unsigned int a2)
{
  unsigned int *v2; // eax
  unsigned int *v3; // ebx

  v2 = (unsigned int *)sub_405F98(a2 + 4);
  v3 = v2;
  if ( v2 )
  {
    *v2 = a2;
    qmemcpy(v2 + 1, a1, a2);
    sub_401713((_BYTE *)v2 + 4, a2);
  }
  return v3;
}

//----- (00406531) --------------------------------------------------------
int __stdcall sub_406531(int a1, _DWORD *a2)
{
  int v2; // ebx
  int v4; // [esp+4h] [ebp-4h] BYREF

  v2 = 0;
  if ( !dword_41131C(a1, 26, &v4, 4, 0) )
  {
    *a2 = v4 != 0;
    return 1;
  }
  return v2;
}
// 41131C: using guessed type int (__stdcall *dword_41131C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00406568) --------------------------------------------------------
char *sub_406568()
{
  char *result; // eax
  int v1; // edi
  int v2; // eax
  char *v3; // ebx
  unsigned int v4; // eax
  int v5; // eax
  char *v6; // ebx
  unsigned int v7; // eax
  int v8; // eax
  char *v9; // ebx
  unsigned int v10; // eax
  int v11; // eax
  char *v12; // ebx
  unsigned int v13; // eax
  int v14; // eax
  char *v15; // ebx
  unsigned int v16; // eax
  int v17; // eax
  char *v18; // ebx
  unsigned int v19; // eax
  int v20; // eax
  int v21; // ebx
  int v22; // eax
  int v23; // eax
  char *v24; // ebx
  unsigned int v25; // eax
  int v26; // [esp+Ch] [ebp-8h]
  char *v27; // [esp+10h] [ebp-4h]

  result = sub_4064CC((_DWORD *)0x412008);
  v27 = result;
  if ( result )
  {
    v26 = sub_405F98(4 * MEMORY[0x412004]);
    if ( v26 )
    {
      if ( sub_40117B(v27, (_BYTE *)v26) != (_BYTE *)-1 )
      {
        dword_4112BC(&unk_410F10, v26, 128);
        dword_4112BC(&unk_410F90, v26 + 128, 32);
        dword_4112BC(&byte_410FB0, v26 + 160, 8);
        v1 = v26 + 168;
        v2 = *(_DWORD *)(v26 + 168);
        if ( v2 )
        {
          v3 = (char *)(v2 + v1);
          v4 = sub_4014F2(v2 + v1);
          dword_410FB8 = sub_405F98(v4 + 2);
          if ( dword_410FB8 )
            sub_4012CE(v3, (_BYTE *)dword_410FB8);
        }
        v5 = *(_DWORD *)(v26 + 172);
        if ( v5 )
        {
          v6 = (char *)(v5 + v1);
          v7 = sub_4014F2(v5 + v1);
          dword_410FBC = sub_405F98(v7 + 2);
          if ( dword_410FBC )
            sub_4012CE(v6, (_BYTE *)dword_410FBC);
        }
        v8 = *(_DWORD *)(v26 + 176);
        if ( v8 )
        {
          v9 = (char *)(v8 + v1);
          v10 = sub_4014F2(v8 + v1);
          dword_410FC0 = sub_405F98(v10 + 2);
          if ( dword_410FC0 )
            sub_4012CE(v9, (_BYTE *)dword_410FC0);
        }
        v11 = *(_DWORD *)(v26 + 184);
        if ( v11 )
        {
          v12 = (char *)(v11 + v1);
          v13 = sub_4014F2(v11 + v1);
          dword_410FC4 = sub_405F98(v13 + 2);
          if ( dword_410FC4 )
            sub_4012CE(v12, (_BYTE *)dword_410FC4);
        }
        v14 = *(_DWORD *)(v26 + 188);
        if ( v14 )
        {
          v15 = (char *)(v14 + v1);
          v16 = sub_4014F2(v14 + v1);
          dword_410FC8 = sub_405F98(v16 + 2);
          if ( dword_410FC8 )
            sub_4012CE(v15, (_BYTE *)dword_410FC8);
        }
        v17 = *(_DWORD *)(v26 + 192);
        if ( v17 )
        {
          v18 = (char *)(v17 + v1);
          v19 = sub_4014F2(v17 + v1);
          dword_410FCC = sub_405F98(v19 + 2);
          if ( dword_410FCC )
            sub_4012CE(v18, (_BYTE *)dword_410FCC);
        }
        v20 = *(_DWORD *)(v26 + 196);
        if ( v20 )
        {
          v21 = v20 + v1;
          v22 = dword_4112C8(v20 + v1);
          dword_410FD0 = sub_405F98(v22 + 2);
          if ( dword_410FD0 )
            dword_4112CC(dword_410FD0, v21);
        }
        v23 = *(_DWORD *)(v26 + 200);
        if ( v23 )
        {
          v24 = (char *)(v23 + v1);
          v25 = sub_4014F2(v23 + v1);
          dword_410FD4 = sub_405F98(v25 + 2);
          if ( dword_410FD4 )
            dword_410FF0 = sub_4012CE(v24, (_BYTE *)dword_410FD4);
        }
      }
      sub_405FB3(v26);
    }
    return (char *)sub_405FB3((int)v27);
  }
  return result;
}
// 410FB0: using guessed type char byte_410FB0;
// 410FB8: using guessed type int dword_410FB8;
// 410FBC: using guessed type int dword_410FBC;
// 410FC0: using guessed type int dword_410FC0;
// 410FC4: using guessed type int dword_410FC4;
// 410FC8: using guessed type int dword_410FC8;
// 410FCC: using guessed type int dword_410FCC;
// 410FD0: using guessed type int dword_410FD0;
// 410FD4: using guessed type int dword_410FD4;
// 410FF0: using guessed type int dword_410FF0;
// 4112BC: using guessed type int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD);
// 4112C8: using guessed type int (__cdecl *dword_4112C8)(_DWORD);
// 4112CC: using guessed type int (__cdecl *dword_4112CC)(_DWORD, _DWORD);

//----- (004067F0) --------------------------------------------------------
int __stdcall sub_4067F0(int a1)
{
  return dword_411438(a1, 1, 5, dword_4067C0, 0, dword_4067CC, 0);
}
// 4067C0: using guessed type int dword_4067C0[3];
// 4067CC: using guessed type int dword_4067CC[7];
// 411438: using guessed type int (__stdcall *dword_411438)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00406812) --------------------------------------------------------
int sub_406812()
{
  _DWORD v1[10]; // [esp+4h] [ebp-90h] BYREF
  int v2; // [esp+2Ch] [ebp-68h] BYREF
  int v3; // [esp+30h] [ebp-64h]
  int v4; // [esp+34h] [ebp-60h]
  int v5; // [esp+38h] [ebp-5Ch]
  int v6; // [esp+3Ch] [ebp-58h]
  int v7; // [esp+40h] [ebp-54h]
  int v8; // [esp+48h] [ebp-4Ch]
  int v9; // [esp+4Ch] [ebp-48h]
  int v10; // [esp+50h] [ebp-44h]
  int v11; // [esp+54h] [ebp-40h]
  int v12; // [esp+58h] [ebp-3Ch]
  int v13; // [esp+5Ch] [ebp-38h]
  _DWORD v14[4]; // [esp+68h] [ebp-2Ch] BYREF
  _DWORD v15[4]; // [esp+78h] [ebp-1Ch] BYREF
  int v16; // [esp+88h] [ebp-Ch]
  int v17; // [esp+8Ch] [ebp-8h]
  int v18; // [esp+90h] [ebp-4h]

  v15[0] = 6881367;
  v15[1] = 5439598;
  v15[2] = 6357108;
  v15[3] = 48;
  v14[0] = 6619204;
  v14[1] = 6357094;
  v14[2] = 7078005;
  v14[3] = 116;
  dword_4112C0(v1, 0, 100);
  v1[0] = 1;
  v2 = 3932162;
  v3 = 1;
  v4 = 1310720;
  v5 = 0x10000000;
  v6 = 257;
  v7 = 0x1000000;
  if ( (unsigned int)sub_40155E() >= 0x3E )
  {
    v3 = 2;
    v8 = 1572864;
    v9 = 0x10000000;
    v10 = 513;
    v11 = 251658240;
    v12 = 2;
    v13 = 1;
  }
  HIWORD(v1[0]) = 4;
  v1[4] = &v2;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v17 = dword_411494(v15, 0, 0x40000);
  if ( v17 )
  {
    if ( !dword_411328(v17, 4, v1) )
    {
      v16 = dword_41149C(v14, 0, 0, 262273);
      if ( v16 )
      {
        if ( !dword_411328(v16, 4, v1) )
          v18 = 1;
      }
    }
  }
  if ( v16 )
    dword_4114A0(v16);
  if ( v17 )
    dword_411498(v17);
  return v18;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 411328: using guessed type int (__stdcall *dword_411328)(_DWORD, _DWORD, _DWORD);
// 411494: using guessed type int (__stdcall *dword_411494)(_DWORD, _DWORD, _DWORD);
// 411498: using guessed type int (__stdcall *dword_411498)(_DWORD);
// 41149C: using guessed type int (__stdcall *dword_41149C)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4114A0: using guessed type int (__stdcall *dword_4114A0)(_DWORD);
// 406812: using guessed type _DWORD var_1C[4];
// 406812: using guessed type _DWORD var_2C[4];

//----- (00406983) --------------------------------------------------------
int sub_406983()
{
  int result; // eax
  int v1; // [esp+0h] [ebp-4h]

  result = sub_406035((int)NtCurrentPeb()->ProcessParameters->ImagePathName.Buffer, 0);
  v1 = result;
  if ( result )
  {
    dword_411534(result);
    dword_4113EC(v1);
    return sub_405FB3(v1);
  }
  return result;
}
// 4113EC: using guessed type int (__stdcall *dword_4113EC)(_DWORD);
// 411534: using guessed type int (__stdcall *dword_411534)(_DWORD);

//----- (004069C4) --------------------------------------------------------
unsigned int sub_4069C4()
{
  unsigned int result; // eax
  unsigned int v1; // ebx
  char *v2; // esi
  char v3[520]; // [esp+0h] [ebp-208h] BYREF

  result = dword_4113C8(260, v3);
  if ( result )
  {
    v1 = result >> 2;
    v2 = v3;
    do
    {
      result = dword_4113CC(v2);
      if ( result == 3 || result == 2 )
        result = sub_406A11((int)v2);
      v2 += 8;
      --v1;
    }
    while ( v1 );
  }
  return result;
}
// 4113C8: using guessed type int (__stdcall *dword_4113C8)(_DWORD, _DWORD);
// 4113CC: using guessed type int (__stdcall *dword_4113CC)(_DWORD);

//----- (00406A11) --------------------------------------------------------
int __stdcall sub_406A11(int a1)
{
  int result; // eax
  int v2; // eax
  _BYTE v3[44]; // [esp+0h] [ebp-460h] BYREF
  char v4[548]; // [esp+2Ch] [ebp-434h] BYREF
  char v5[520]; // [esp+250h] [ebp-210h] BYREF
  int v6; // [esp+458h] [ebp-8h] BYREF
  int v7; // [esp+45Ch] [ebp-4h]

  result = sub_406AE4(a1, (int)v5);
  if ( result )
  {
    sub_4016B4((int)v5);
    v6 = 2949203;
    v7 = 42;
    dword_4112D8(v5, &v6);
    result = dword_411374(v5, 0, v3, 0, 0, 0);
    v7 = result;
    if ( result != -1 )
    {
      do
      {
        if ( (v3[0] & 0x10) != 0 )
        {
          v2 = dword_4112E8(v5, 92);
          dword_4112DC(v2 + 2, v4);
          sub_406BBF((int)v5);
        }
      }
      while ( dword_411378(v7, v3) );
      return dword_41137C(v7);
    }
  }
  return result;
}
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 4112E8: using guessed type int (__cdecl *dword_4112E8)(_DWORD, _DWORD);
// 411374: using guessed type int (__stdcall *dword_411374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411378: using guessed type int (__stdcall *dword_411378)(_DWORD, _DWORD);
// 41137C: using guessed type int (__stdcall *dword_41137C)(_DWORD);
// 406A11: using guessed type _BYTE var_460[44];
// 406A11: using guessed type char var_434[548];

//----- (00406AE4) --------------------------------------------------------
int __stdcall sub_406AE4(int a1, int a2)
{
  _BYTE v3[44]; // [esp+0h] [ebp-474h] BYREF
  char v4[548]; // [esp+2Ch] [ebp-448h] BYREF
  char v5[520]; // [esp+250h] [ebp-224h] BYREF
  _DWORD v6[5]; // [esp+458h] [ebp-1Ch] BYREF
  int v7; // [esp+46Ch] [ebp-8h]
  int v8; // [esp+470h] [ebp-4h]

  v8 = 0;
  dword_4112DC(v5, a1);
  v6[0] = 7471146;
  v6[1] = 6488165;
  v6[2] = 6488185;
  v6[3] = 6619244;
  v6[4] = 42;
  dword_4112D8(v5, v6);
  v7 = dword_411374(v5, 0, v3, 0, 0, 0);
  if ( v7 != -1 )
  {
    while ( (v3[0] & 0x10) == 0 )
    {
      if ( !dword_411378(v7, v3) )
        goto LABEL_5;
    }
    dword_4112DC(a2, a1);
    dword_4112D8(a2, v4);
    v8 = 1;
LABEL_5:
    dword_41137C(v7);
  }
  return v8;
}
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 411374: using guessed type int (__stdcall *dword_411374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411378: using guessed type int (__stdcall *dword_411378)(_DWORD, _DWORD);
// 41137C: using guessed type int (__stdcall *dword_41137C)(_DWORD);
// 406AE4: using guessed type _DWORD var_1C[5];
// 406AE4: using guessed type _BYTE var_474[44];
// 406AE4: using guessed type char var_448[548];

//----- (00406BBF) --------------------------------------------------------
int __stdcall sub_406BBF(int a1)
{
  int result; // eax
  int v2; // esi
  int v3; // eax
  int v4; // eax
  char v5[44]; // [esp+8h] [ebp-260h] BYREF
  _DWORD v6[137]; // [esp+34h] [ebp-234h] BYREF
  int v7; // [esp+258h] [ebp-10h]
  int v8; // [esp+25Ch] [ebp-Ch]
  int v9; // [esp+260h] [ebp-8h] BYREF
  int v10; // [esp+264h] [ebp-4h]

  v8 = 0;
  v7 = 0;
  result = dword_4112D4(a1);
  if ( result )
  {
    result = sub_405F98(2 * result + 6);
    v8 = result;
    if ( result )
    {
      dword_4112DC(v8, a1);
      sub_4016B4(v8);
      v9 = 42;
      dword_4112D8(v8, &v9);
      result = dword_411374(v8, 0, v5, 0, 0, 0);
      v10 = result;
      if ( result != -1 )
      {
        do
        {
          if ( v6[0] != 46 && v6[0] != 3014702 )
          {
            v2 = dword_4112D4(v6);
            v3 = dword_4112D4(v8);
            v7 = sub_405F98(2 * (v3 + v2) + 2);
            if ( v7 )
            {
              dword_4112DC(v7, v8);
              v4 = dword_4112E8(v7, 42);
              dword_4112DC(v4, v6);
              if ( (dword_411370(v7) & 0x10) != 0 )
              {
                while ( !dword_4113D8(v7) && __readfsdword(0x34u) == 145 )
                  sub_406BBF(v7);
                sub_405FB3(v7);
                v7 = 0;
              }
              else
              {
                dword_4113D4(v7);
                sub_405FB3(v7);
                v7 = 0;
              }
            }
          }
        }
        while ( dword_411378(v10, v5) );
        result = dword_41137C(v10);
      }
    }
    if ( v8 )
      result = sub_405FB3(v8);
    if ( v7 )
      return sub_405FB3(v7);
  }
  return result;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 4112E8: using guessed type int (__cdecl *dword_4112E8)(_DWORD, _DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);
// 411374: using guessed type int (__stdcall *dword_411374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411378: using guessed type int (__stdcall *dword_411378)(_DWORD, _DWORD);
// 41137C: using guessed type int (__stdcall *dword_41137C)(_DWORD);
// 4113D4: using guessed type int (__stdcall *dword_4113D4)(_DWORD);
// 4113D8: using guessed type int (__stdcall *dword_4113D8)(_DWORD);
// 406BBF: using guessed type _DWORD var_234[137];

//----- (00406D7E) --------------------------------------------------------
int sub_406D7E()
{
  int result; // eax
  _DWORD *v1; // eax
  int v2; // ecx
  _DWORD *v3; // eax
  int v4; // ecx
  _DWORD *v5; // eax
  int v6; // ecx
  _DWORD *v7; // eax
  int v8; // ecx
  _DWORD *v9; // eax
  int v10; // ecx
  _DWORD *v11; // eax
  int v12; // ecx
  _DWORD *v13; // eax
  int v14; // ecx
  _DWORD *v15; // eax
  int v16; // ecx
  _DWORD *v17; // eax
  int v18; // ecx
  _DWORD *v19; // eax
  int v20; // ecx
  _DWORD v21[32]; // [esp+0h] [ebp-1C8h] BYREF
  _DWORD v22[12]; // [esp+80h] [ebp-148h] BYREF
  _DWORD v23[16]; // [esp+B0h] [ebp-118h] BYREF
  _DWORD v24[13]; // [esp+F0h] [ebp-D8h] BYREF
  _DWORD v25[2]; // [esp+124h] [ebp-A4h] BYREF
  _DWORD v26[2]; // [esp+12Ch] [ebp-9Ch] BYREF
  _DWORD v27[6]; // [esp+134h] [ebp-94h] BYREF
  _DWORD v28[4]; // [esp+14Ch] [ebp-7Ch] BYREF
  _DWORD v29[4]; // [esp+15Ch] [ebp-6Ch] BYREF
  _DWORD v30[4]; // [esp+16Ch] [ebp-5Ch] BYREF
  _DWORD v31[4]; // [esp+17Ch] [ebp-4Ch] BYREF
  int v32[4]; // [esp+18Ch] [ebp-3Ch] BYREF
  char v33[8]; // [esp+19Ch] [ebp-2Ch] BYREF
  int v34; // [esp+1A4h] [ebp-24h]
  int v35; // [esp+1ACh] [ebp-1Ch] BYREF
  int v36; // [esp+1B0h] [ebp-18h] BYREF
  int v37; // [esp+1B4h] [ebp-14h] BYREF
  int v38; // [esp+1B8h] [ebp-10h] BYREF
  int v39; // [esp+1BCh] [ebp-Ch] BYREF
  int v40; // [esp+1C0h] [ebp-8h] BYREF
  int v41; // [esp+1C4h] [ebp-4h] BYREF

  v40 = 0;
  v38 = 0;
  v39 = 0;
  v37 = 0;
  result = dword_411500(0);
  if ( result )
    return result;
  v1 = v31;
  v31[0] = -377288159;
  v31[1] = 869781189;
  v31[2] = -502873024;
  v31[3] = -570718302;
  v2 = 4;
  do
  {
    *v1++ ^= 0x22065FEDu;
    --v2;
  }
  while ( v2 );
  v3 = v30;
  v30[0] = -32179862;
  v30[1] = 868822162;
  v30[2] = -2012867995;
  v30[3] = 103290093;
  v4 = 4;
  do
  {
    *v3++ ^= 0x22065FEDu;
    --v4;
  }
  while ( v4 );
  v5 = v29;
  v29[0] = 1162688885;
  v29[1] = 869708159;
  v29[2] = -502911424;
  v29[3] = -570718302;
  v6 = 4;
  do
  {
    *v5++ ^= 0x22065FEDu;
    --v6;
  }
  while ( v6 );
  v7 = v28;
  v28[0] = 1722481049;
  v28[1] = 869709585;
  v28[2] = -502914227;
  v28[3] = 42920354;
  v8 = 4;
  do
  {
    *v7++ ^= 0x22065FEDu;
    --v8;
  }
  while ( v8 );
  v9 = v22;
  v22[0] = 576282546;
  v22[1] = 578052029;
  v22[2] = 577789826;
  v22[3] = 576872324;
  v22[4] = 578051976;
  v22[5] = 578052012;
  v22[6] = 577658766;
  v22[7] = 577920900;
  v22[8] = 577068936;
  v22[9] = 577986457;
  v22[10] = 576937887;
  v22[11] = 570843117;
  v10 = 12;
  do
  {
    *v9++ ^= 0x22065FEDu;
    --v10;
  }
  while ( v10 );
  v11 = v27;
  v27[0] = 575233983;
  v27[1] = 575823778;
  v27[2] = 574971825;
  v27[3] = 575365028;
  v27[4] = 573857723;
  v27[5] = 570843117;
  v12 = 6;
  do
  {
    *v11++ ^= 0x22065FEDu;
    --v12;
  }
  while ( v12 );
  v13 = v25;
  v25[0] = 574775204;
  v25[1] = 570843117;
  v14 = 2;
  do
  {
    *v13++ ^= 0x22065FEDu;
    --v14;
  }
  while ( v14 );
  v15 = v23;
  v23[0] = 574840766;
  v23[1] = 574840737;
  v23[2] = 575823790;
  v23[3] = 573333453;
  v23[4] = 574644173;
  v23[5] = 575233983;
  v23[6] = 572940192;
  v23[7] = 577724346;
  v23[8] = 573923203;
  v23[9] = 576282591;
  v23[10] = 577658814;
  v23[11] = 576872332;
  v23[12] = 577855362;
  v23[13] = 577331118;
  v23[14] = 578772893;
  v23[15] = 570843117;
  v16 = 16;
  do
  {
    *v15++ ^= 0x22065FEDu;
    --v16;
  }
  while ( v16 );
  v17 = v26;
  v26[0] = 576151482;
  v26[1] = 570843041;
  v18 = 2;
  do
  {
    *v17++ ^= 0x22065FEDu;
    --v18;
  }
  while ( v18 );
  v19 = v24;
  v24[0] = 577724346;
  v24[1] = 573923203;
  v24[2] = 576282591;
  v24[3] = 577658814;
  v24[4] = 576872332;
  v24[5] = 577855362;
  v24[6] = 577331118;
  v24[7] = 578772893;
  v24[8] = 575627203;
  v24[9] = 574316457;
  v24[10] = 572743626;
  v24[11] = 572612510;
  v24[12] = 570843117;
  v20 = 13;
  do
  {
    *v19++ ^= 0x22065FEDu;
    --v20;
  }
  while ( v20 );
  if ( !dword_411510(v31, 0, 1, v30, &v40) && !dword_411510(v29, 0, 1, v28, &v39) )
  {
    sub_406531(-1, &v41);
    if ( !v41 )
    {
LABEL_27:
      if ( !(*(int (__stdcall **)(int, _DWORD *, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, int, int *))(*(_DWORD *)v40 + 12))(
              v40,
              v27,
              0,
              0,
              0,
              0,
              0,
              v39,
              &v38)
        && !dword_411514(v38, 10, 0, 0, 3, 3, 0, 0)
        && !(*(int (__stdcall **)(int, _DWORD *, _DWORD *, int, _DWORD, int *))(*(_DWORD *)v38 + 80))(
              v38,
              v26,
              v23,
              48,
              0,
              &v37) )
      {
        while ( 1 )
        {
          v36 = 0;
          v35 = 0;
          if ( (*(int (__stdcall **)(int, int, int, int *, int *))(*(_DWORD *)v37 + 16))(v37, -1, 1, &v36, &v35) )
            break;
          dword_411544(v33);
          if ( !(*(int (__stdcall **)(int, _DWORD *, _DWORD, char *, _DWORD, _DWORD))(*(_DWORD *)v36 + 16))(
                  v36,
                  v25,
                  0,
                  v33,
                  0,
                  0) )
          {
            dword_4112F4(v21, v24, v34);
            (*(void (__stdcall **)(int, _DWORD *, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v38 + 64))(v38, v21, 0, 0, 0);
            dword_411548(v33);
          }
          (*(void (__stdcall **)(int))(*(_DWORD *)v36 + 8))(v36);
        }
      }
      goto LABEL_34;
    }
    dword_411544(v32);
    v32[0] = 3;
    v32[2] = 64;
    if ( !(*(int (__stdcall **)(int, _DWORD *, _DWORD, int *))(*(_DWORD *)v39 + 32))(v39, v22, 0, v32) )
    {
      dword_411548(v32);
      goto LABEL_27;
    }
  }
LABEL_34:
  if ( v37 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v37 + 8))(v37);
  if ( v38 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v38 + 8))(v38);
  if ( v39 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v39 + 8))(v39);
  if ( v40 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v40 + 8))(v40);
  return dword_411504(v21[0], v21[1], v21[2], v21[3], v21[4], v21[5], v21[6], v21[7], v21[8], v21[9], v21[10], v21[11]);
}
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 411500: using guessed type int (__stdcall *dword_411500)(_DWORD);
// 411504: using guessed type int (__cdecl *dword_411504)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411510: using guessed type int (__stdcall *dword_411510)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411514: using guessed type int (__stdcall *dword_411514)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411544: using guessed type int (__stdcall *dword_411544)(_DWORD);
// 411548: using guessed type int (__stdcall *dword_411548)(_DWORD);
// 406D7E: using guessed type _DWORD var_4C[4];
// 406D7E: using guessed type _DWORD var_5C[4];
// 406D7E: using guessed type _DWORD var_6C[4];
// 406D7E: using guessed type _DWORD var_7C[4];
// 406D7E: using guessed type _DWORD var_148[12];
// 406D7E: using guessed type _DWORD var_94[6];
// 406D7E: using guessed type _DWORD var_A4[2];
// 406D7E: using guessed type _DWORD var_118[16];
// 406D7E: using guessed type _DWORD var_9C[2];
// 406D7E: using guessed type _DWORD var_D8[13];
// 406D7E: using guessed type _DWORD var_1C8[32];

//----- (0040724F) --------------------------------------------------------
int sub_40724F()
{
  int result; // eax
  int *v1; // edi
  char v2[28]; // [esp+4h] [ebp-30h] BYREF
  int v3; // [esp+20h] [ebp-14h] BYREF
  int v4; // [esp+24h] [ebp-10h] BYREF
  int *v5; // [esp+28h] [ebp-Ch]
  int v6; // [esp+2Ch] [ebp-8h]
  int v7; // [esp+30h] [ebp-4h]

  v5 = 0;
  result = dword_411450(0, 0, 4);
  v7 = result;
  if ( result )
  {
    v4 = 0;
    dword_411454(v7, 0, 48, 3, 0, 0, &v4, &v3, 0, 0);
    result = sub_405F98(v4);
    v5 = (int *)result;
    if ( result )
    {
      result = dword_411454(v7, 0, 48, 3, v5, v4, &v4, &v3, 0, 0);
      if ( result )
      {
        v1 = v5;
        do
        {
          result = sub_407365(*v1);
          if ( result )
          {
            result = dword_411458(v7, *v1, 65568);
            v6 = result;
            if ( result )
            {
              dword_4112C0(v2, 0, 28);
              dword_41145C(v6, 1, v2);
              dword_411460(v6);
              result = dword_411464(v6);
            }
          }
          v1 += 11;
          --v3;
        }
        while ( v3 );
      }
    }
  }
  if ( v7 )
    result = dword_411464(v7);
  if ( v5 )
    return sub_405FB3((int)v5);
  return result;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 411450: using guessed type int (__stdcall *dword_411450)(_DWORD, _DWORD, _DWORD);
// 411454: using guessed type int (__stdcall *dword_411454)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411458: using guessed type int (__stdcall *dword_411458)(_DWORD, _DWORD, _DWORD);
// 41145C: using guessed type int (__stdcall *dword_41145C)(_DWORD, _DWORD, _DWORD);
// 411460: using guessed type int (__stdcall *dword_411460)(_DWORD);
// 411464: using guessed type int (__stdcall *dword_411464)(_DWORD);

//----- (00407365) --------------------------------------------------------
int __stdcall sub_407365(int a1)
{
  _WORD *v1; // esi
  int v3; // [esp+4h] [ebp-4h]

  v3 = 0;
  v1 = (_WORD *)dword_410FC8;
  dword_4112F0(a1);
  while ( !dword_4112E0(a1, v1) )
  {
    v1 += dword_4112D4(v1) + 1;
    if ( !*v1 )
      return v3;
  }
  return 1;
}
// 410FC8: using guessed type int dword_410FC8;
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112E0: using guessed type int (__cdecl *dword_4112E0)(_DWORD, _DWORD);
// 4112F0: using guessed type int (__cdecl *dword_4112F0)(_DWORD);

//----- (004073C1) --------------------------------------------------------
int sub_4073C1()
{
  int v0; // eax
  int *v2; // ebx
  int v3; // esi
  _DWORD v4[6]; // [esp+8h] [ebp-2Ch] BYREF
  int v5[2]; // [esp+20h] [ebp-14h] BYREF
  int *i; // [esp+28h] [ebp-Ch]
  int v7; // [esp+2Ch] [ebp-8h] BYREF
  int v8; // [esp+30h] [ebp-4h] BYREF

  v7 = 1024;
  for ( i = (int *)sub_405F98(1024); ; i = (int *)sub_405FCE((int)i, v7) )
  {
    v0 = dword_411318(5, i, v7, &v7);
    if ( !v0 )
      break;
    if ( v0 != -1073741820 )
      return sub_405FB3((int)i);
  }
  v2 = i;
  do
  {
    v3 = *v2;
    if ( v2[15] && sub_4074AF(v2[15]) )
    {
      v5[0] = v2[17];
      v5[1] = 0;
      v4[0] = 24;
      memset(&v4[1], 0, 20);
      if ( !dword_411304(&v8, 1, v4, v5) )
      {
        dword_41134C(v8, 0);
        dword_411354(v8);
      }
    }
    v2 = (int *)((char *)v2 + v3);
  }
  while ( v3 );
  return sub_405FB3((int)i);
}
// 411304: using guessed type int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411318: using guessed type int (__stdcall *dword_411318)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41134C: using guessed type int (__stdcall *dword_41134C)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 4073C1: using guessed type _DWORD var_2C[6];

//----- (004074AF) --------------------------------------------------------
int __stdcall sub_4074AF(int a1)
{
  _WORD *v1; // esi
  int v3; // [esp+8h] [ebp-4h]

  v3 = 0;
  v1 = (_WORD *)dword_410FC4;
  dword_4112F0(a1);
  while ( !dword_4112E0(a1, v1) )
  {
    v1 += dword_4112D4(v1) + 1;
    if ( !*v1 )
      return v3;
  }
  return 1;
}
// 410FC4: using guessed type int dword_410FC4;
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112E0: using guessed type int (__cdecl *dword_4112E0)(_DWORD, _DWORD);
// 4112F0: using guessed type int (__cdecl *dword_4112F0)(_DWORD);

//----- (0040750F) --------------------------------------------------------
unsigned int __usercall sub_40750F@<eax>(unsigned int a1@<ebx>)
{
  _DWORD *v1; // eax
  int v2; // ecx
  _WORD v4[37]; // [esp+Ah] [ebp-E6h] BYREF
  _DWORD v5[12]; // [esp+54h] [ebp-9Ch] BYREF
  char v6[88]; // [esp+84h] [ebp-6Ch] BYREF
  int v7; // [esp+DCh] [ebp-14h]
  int v8; // [esp+ECh] [ebp-4h] BYREF

  if ( sub_406245((int)v4) )
  {
    v8 = sub_4010BB(v4, 0);
    dword_4112C0(v6, 0, 104);
    dword_41142C(v6);
    dword_411430(v6, &v8, 4);
    dword_411434(v6);
    v1 = v5;
    v5[0] = 577396650;
    v5[1] = 577003394;
    v5[2] = 577396620;
    v5[3] = 572743601;
    v5[4] = 574513091;
    v5[5] = 572743573;
    v5[6] = 574513091;
    v5[7] = 572743573;
    v5[8] = 574513091;
    v5[9] = 572743573;
    v5[10] = 574513091;
    v5[11] = 570843029;
    v2 = 12;
    do
    {
      *v1++ ^= 0x22065FEDu;
      --v2;
    }
    while ( v2 );
    a1 = sub_405FEC(80);
    if ( a1 )
      dword_4112F4(a1, v5, v7);
  }
  return a1;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 41142C: using guessed type int (__stdcall *dword_41142C)(_DWORD);
// 411430: using guessed type int (__stdcall *dword_411430)(_DWORD, _DWORD, _DWORD);
// 411434: using guessed type int (__stdcall *dword_411434)(_DWORD);
// 40750F: using guessed type _WORD var_E6[37];
// 40750F: using guessed type _DWORD var_9C[12];

//----- (00407612) --------------------------------------------------------
_BYTE *__stdcall sub_407612(int a1)
{
  _BYTE *result; // eax
  int *v2; // eax
  int v3; // ecx
  int v4; // eax
  int v5; // ebx
  int v6; // eax
  int v7; // eax
  int v8; // ebx
  _DWORD *v9; // eax
  int v10; // ecx
  int *v11; // eax
  int v12; // ecx
  int *v13; // eax
  int v14; // ecx
  int v15; // eax
  int *v16; // eax
  int v17; // ecx
  int v18; // eax
  char v19[520]; // [esp+Ch] [ebp-2E0h] BYREF
  int v20; // [esp+214h] [ebp-D8h] BYREF
  int v21; // [esp+218h] [ebp-D4h]
  int v22; // [esp+21Ch] [ebp-D0h]
  int v23; // [esp+220h] [ebp-CCh]
  int v24; // [esp+224h] [ebp-C8h]
  int v25; // [esp+228h] [ebp-C4h]
  int v26; // [esp+22Ch] [ebp-C0h]
  int v27; // [esp+230h] [ebp-BCh]
  int v28; // [esp+234h] [ebp-B8h]
  int v29; // [esp+238h] [ebp-B4h]
  int v30; // [esp+23Ch] [ebp-B0h]
  int v31; // [esp+240h] [ebp-ACh] BYREF
  int v32; // [esp+244h] [ebp-A8h]
  int v33; // [esp+248h] [ebp-A4h]
  int v34; // [esp+24Ch] [ebp-A0h]
  int v35; // [esp+250h] [ebp-9Ch]
  int v36; // [esp+254h] [ebp-98h]
  int v37; // [esp+258h] [ebp-94h]
  int v38; // [esp+25Ch] [ebp-90h]
  __int16 v39; // [esp+260h] [ebp-8Ch] BYREF
  unsigned int v40; // [esp+262h] [ebp-8Ah]
  __int16 v41; // [esp+266h] [ebp-86h]
  __int16 v42; // [esp+268h] [ebp-84h]
  int v43; // [esp+26Ah] [ebp-82h]
  int v44; // [esp+270h] [ebp-7Ch] BYREF
  unsigned int v45; // [esp+274h] [ebp-78h]
  unsigned int v46; // [esp+278h] [ebp-74h]
  __int16 v47; // [esp+27Ch] [ebp-70h]
  __int16 v48; // [esp+27Eh] [ebp-6Eh]
  int v49; // [esp+280h] [ebp-6Ch]
  unsigned int v50; // [esp+284h] [ebp-68h]
  int v51[4]; // [esp+29Ch] [ebp-50h] BYREF
  int v52; // [esp+2ACh] [ebp-40h] BYREF
  _BYTE *v53; // [esp+2B0h] [ebp-3Ch]
  _BYTE *v54; // [esp+2B4h] [ebp-38h]
  char v55[4]; // [esp+2B8h] [ebp-34h] BYREF
  int v56; // [esp+2BCh] [ebp-30h]
  _BYTE *v57; // [esp+2C0h] [ebp-2Ch]
  _BYTE *v58; // [esp+2C4h] [ebp-28h]
  _BYTE *v59; // [esp+2C8h] [ebp-24h]
  unsigned int v60; // [esp+2CCh] [ebp-20h] BYREF
  unsigned int v61; // [esp+2D0h] [ebp-1Ch] BYREF
  _BYTE *v62; // [esp+2D4h] [ebp-18h]
  _BYTE *v63; // [esp+2D8h] [ebp-14h]
  _BYTE *v64; // [esp+2DCh] [ebp-10h]
  char v65[4]; // [esp+2E0h] [ebp-Ch] BYREF
  int v66; // [esp+2E4h] [ebp-8h] BYREF
  _BYTE *v67; // [esp+2E8h] [ebp-4h]

  v63 = 0;
  v62 = 0;
  v59 = 0;
  v58 = 0;
  v54 = 0;
  v53 = 0;
  v67 = 0;
  v66 = 0;
  v57 = 0;
  result = (_BYTE *)dword_411484(0);
  v64 = result;
  if ( result )
  {
    result = (_BYTE *)dword_4114CC(v64);
    v63 = result;
    if ( result )
    {
      result = (_BYTE *)dword_4114CC(v64);
      v62 = result;
      if ( result )
      {
        if ( !sub_40D34B(0, dword_410FF4 + 2, (int)&v60, (int)&v61) )
        {
          v60 = (dword_4114BC(v64, 8) + 1) & 0xFFFFFFFE;
          v61 = (dword_4114BC(v64, 10) + 1) & 0xFFFFFFFE;
        }
        v2 = &v31;
        v31 = 577724345;
        v32 = 576937856;
        v33 = 572940190;
        v34 = 576937891;
        v35 = 572940186;
        v36 = 577331135;
        v37 = 577200000;
        v38 = 570843011;
        v3 = 8;
        do
        {
          *v2++ ^= 0x22065FEDu;
          --v3;
        }
        while ( v3 );
        v4 = dword_4114BC(v64, 88);
        result = (_BYTE *)dword_4114B8(7 * (v61 / (__int64)v4), 0, 0, 0, 700, 0, 0, 0, 1, 7, 0, 2, 0, &v31);
        v59 = result;
        if ( result )
        {
          result = (_BYTE *)dword_4114D0(v63, v59);
          if ( result )
          {
            result = (_BYTE *)sub_405F98(1024);
            v58 = result;
            if ( result )
            {
              result = sub_4064CC(dword_410004);
              v57 = result;
              if ( result )
              {
                v5 = dword_4112F4(v58, v57, dword_410FF8);
                if ( v5 )
                {
                  result = (_BYTE *)dword_4114E8(v63, v58, v5, v55);
                  if ( result )
                  {
                    result = (_BYTE *)dword_4114C8(v63, v60, v61);
                    v54 = result;
                    if ( result )
                    {
                      result = (_BYTE *)dword_4114D0(v63, v54);
                      if ( result )
                      {
                        v6 = __ROL4__(0xFFFF, 8);
                        LOBYTE(v6) = -1;
                        dword_4114E0(v63, v6);
                        dword_4114E4(v63, 2);
                        v7 = __ROL4__(0, 8);
                        LOBYTE(v7) = 0;
                        dword_4114C4(v63, v7);
                        v51[0] = 0;
                        v51[1] = (v61 >> 1) - 2 * v56;
                        v51[2] = v60;
                        v51[3] = v61;
                        result = (_BYTE *)dword_41148C(v63, v58, v5, v51, 529);
                        if ( result )
                        {
                          dword_4112C0(v58, 0, 1024);
                          dword_4112C0(&v44, 0, 44);
                          v44 = 40;
                          v48 = 16;
                          v49 = 0;
                          v45 = v60;
                          v46 = v61;
                          v47 = 1;
                          v50 = 2 * v61 * v60;
                          v39 = 19778;
                          v43 = 54;
                          v40 = v50 + 54;
                          v41 = 0;
                          v42 = 0;
                          result = (_BYTE *)dword_4114D4(v63, &v44, 0, &v52, 0, 0);
                          v53 = result;
                          if ( result )
                          {
                            dword_4114D0(v62, v53);
                            result = (_BYTE *)dword_4114C0(v62, 0, 0, v45, v46, v63, 0, 0, 13369376);
                            if ( result )
                            {
                              dword_4114F8(0, v58, 35, 0);
                              sub_4016B4((int)v58);
                              v8 = (int)v58;
                              dword_4112D8(v58, dword_410FF4 + 2);
                              v9 = (_DWORD *)(v8 + 2 * dword_4112D4(v8));
                              *v9 = 577003459;
                              v9[1] = 578183040;
                              v9[2] = 570843117;
                              v10 = 3;
                              do
                              {
                                *v9++ ^= 0x22065FEDu;
                                --v10;
                              }
                              while ( v10 );
                              result = (_BYTE *)dword_411394(v58, 0x40000000, 0, 0, 4, 128, 0);
                              v67 = result;
                              if ( result != (_BYTE *)-1 )
                              {
                                result = (_BYTE *)dword_411398(v67, &v39, 14, v65, 0);
                                if ( result )
                                {
                                  result = (_BYTE *)dword_411398(v67, &v44, 40, v65, 0);
                                  if ( result )
                                  {
                                    result = (_BYTE *)dword_411398(v67, v52, v50, v65, 0);
                                    if ( result )
                                    {
                                      dword_411354(v67);
                                      v67 = 0;
                                      result = (_BYTE *)sub_406393(dword_410FE8, (int)v19);
                                      if ( result )
                                      {
                                        sub_4016B4((int)v19);
                                        v11 = &v20;
                                        v20 = 577331118;
                                        v21 = 577920899;
                                        v22 = 577331103;
                                        v23 = 572940161;
                                        v24 = 577200061;
                                        v25 = 576937859;
                                        v26 = 576348033;
                                        v27 = 576937897;
                                        v28 = 577593246;
                                        v29 = 577331097;
                                        v30 = 570843037;
                                        v12 = 11;
                                        do
                                        {
                                          *v11++ ^= 0x22065FEDu;
                                          --v12;
                                        }
                                        while ( v12 );
                                        dword_4112D8(v19, &v20);
                                        result = (_BYTE *)dword_41143C(-2147483645, v19, 0, 0, 0, 131334, 0, &v66, 0);
                                        if ( !result )
                                        {
                                          v13 = &v20;
                                          v20 = 577200058;
                                          v21 = 577396609;
                                          v22 = 577200061;
                                          v23 = 576937885;
                                          v24 = 570843039;
                                          v14 = 5;
                                          do
                                          {
                                            *v13++ ^= 0x22065FEDu;
                                            --v14;
                                          }
                                          while ( v14 );
                                          v15 = dword_4112D4(v58);
                                          result = (_BYTE *)dword_411440(v66, &v20, 0, 1, v58, 2 * v15 + 2);
                                          if ( !result )
                                          {
                                            v16 = &v20;
                                            v20 = 577200058;
                                            v21 = 577396609;
                                            v22 = 577200029;
                                            v23 = 576937885;
                                            v24 = 576020383;
                                            v25 = 578772889;
                                            v26 = 576937857;
                                            v27 = 570843117;
                                            v17 = 8;
                                            do
                                            {
                                              *v16++ ^= 0x22065FEDu;
                                              --v17;
                                            }
                                            while ( v17 );
                                            v31 = 3145777;
                                            v32 = 0;
                                            v18 = dword_4112D4(&v31);
                                            result = (_BYTE *)dword_411440(v66, &v20, 0, 1, &v31, 2 * v18 + 2);
                                            if ( !result )
                                            {
                                              if ( a1 )
                                                result = (_BYTE *)dword_411490(20, 0, v58, 3);
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
                else
                {
                  result = (_BYTE *)sub_405FB3((int)v57);
                  v57 = 0;
                }
              }
            }
          }
        }
      }
    }
  }
  if ( v66 )
    result = (_BYTE *)dword_411354(v66);
  if ( v67 && v67 != (_BYTE *)-1 )
    result = (_BYTE *)dword_411354(v67);
  if ( v53 )
    result = (_BYTE *)dword_4114DC(v53);
  if ( v54 )
    result = (_BYTE *)dword_4114DC(v54);
  if ( v57 )
    result = (_BYTE *)sub_405FB3((int)v57);
  if ( v58 )
    result = (_BYTE *)sub_405FB3((int)v58);
  if ( v59 )
    result = (_BYTE *)dword_4114DC(v59);
  if ( v62 )
    result = (_BYTE *)dword_4114D8(v62);
  if ( v63 )
    result = (_BYTE *)dword_4114D8(v63);
  if ( v64 )
    return (_BYTE *)dword_411488(0, v64);
  return result;
}
// 410004: using guessed type _DWORD dword_410004[77];
// 410FE8: using guessed type int dword_410FE8;
// 410FF4: using guessed type int dword_410FF4;
// 410FF8: using guessed type int dword_410FF8;
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411394: using guessed type int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411398: using guessed type int (__stdcall *dword_411398)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411440: using guessed type int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411484: using guessed type int (__stdcall *dword_411484)(_DWORD);
// 411488: using guessed type int (__stdcall *dword_411488)(_DWORD, _DWORD);
// 41148C: using guessed type int (__stdcall *dword_41148C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411490: using guessed type int (__stdcall *dword_411490)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4114B8: using guessed type int (__stdcall *dword_4114B8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4114BC: using guessed type int (__stdcall *dword_4114BC)(_DWORD, _DWORD);
// 4114C0: using guessed type int (__stdcall *dword_4114C0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4114C4: using guessed type int (__stdcall *dword_4114C4)(_DWORD, _DWORD);
// 4114C8: using guessed type int (__stdcall *dword_4114C8)(_DWORD, _DWORD, _DWORD);
// 4114CC: using guessed type int (__stdcall *dword_4114CC)(_DWORD);
// 4114D0: using guessed type int (__stdcall *dword_4114D0)(_DWORD, _DWORD);
// 4114D4: using guessed type int (__stdcall *dword_4114D4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4114D8: using guessed type int (__stdcall *dword_4114D8)(_DWORD);
// 4114DC: using guessed type int (__stdcall *dword_4114DC)(_DWORD);
// 4114E0: using guessed type int (__stdcall *dword_4114E0)(_DWORD, _DWORD);
// 4114E4: using guessed type int (__stdcall *dword_4114E4)(_DWORD, _DWORD);
// 4114E8: using guessed type int (__stdcall *dword_4114E8)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4114F8: using guessed type int (__stdcall *dword_4114F8)(_DWORD, _DWORD, _DWORD, _DWORD);
// 407612: using guessed type char var_34[4];
// 407612: using guessed type char var_C[4];

//----- (00407D22) --------------------------------------------------------
_WORD *__stdcall sub_407D22(_WORD *a1, __int16 *a2)
{
  _WORD *v2; // edi
  __int16 *v3; // esi
  int v4; // ebx
  int v5; // eax
  _WORD *i; // edi
  __int16 v7; // ax
  _WORD *v8; // edi
  _WORD *v9; // edi
  __int16 *v10; // esi
  __int16 v11; // ax
  _WORD *v13; // [esp+Ch] [ebp-4h]

  v2 = a1;
  if ( *a1 != 34 )
  {
    v3 = a2;
    v4 = dword_4112D4(a1);
    v5 = dword_4112D4(a2);
    v13 = (_WORD *)sub_405F98(2 * (v5 + v4) + 2);
    if ( v13 )
    {
      *v13 = 34;
      for ( i = v13 + 1; ; ++i )
      {
        v7 = *v3++;
        if ( !v7 )
          break;
        *i = v7;
      }
      *i = 34;
      v8 = i + 1;
      *v8 = 32;
      v9 = v8 + 1;
      v10 = a1;
      do
      {
        v11 = *v10++;
        if ( v11 == 32 )
        {
          ++v10;
          while ( 1 )
          {
            v11 = *v10++;
            if ( !v11 )
              break;
            *v9++ = v11;
          }
        }
      }
      while ( v11 );
      return v13;
    }
  }
  return v2;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);

//----- (00407DBA) --------------------------------------------------------
char *__stdcall sub_407DBA(char *a1)
{
  char *v1; // esi
  int v2; // eax
  int v3; // eax
  int v4; // edi
  int v5; // eax
  char *v6; // edi
  int v7; // edi
  int v8; // eax
  _WORD v10[6]; // [esp+Ch] [ebp-Ch] BYREF

  v1 = a1;
  if ( *(_WORD *)a1 == 34 )
  {
    v2 = dword_4112E4(a1 + 2, 34);
    if ( v2 )
    {
      v3 = dword_4112E4(v2 + 2, 45);
      if ( v3 )
      {
        v4 = v3;
        dword_4112C0(v10, 0, 12);
        dword_4112BC(v10, v4, 10);
        v5 = sub_4010BB(v10, 0);
        if ( v5 == 1162288407 || v5 == 1160726935 )
        {
          v6 = (char *)(v4 + 10);
          if ( *(_WORD *)v6 )
          {
            while ( *(_WORD *)v6 == 32 )
              v6 += 2;
            if ( *(_WORD *)v6 )
            {
              if ( *(_WORD *)v6 != 34 )
              {
                if ( dword_4112E4(v6, 32) )
                {
                  v7 = v6 - a1;
                  v8 = sub_406035((int)a1, 2);
                  if ( v8 )
                  {
                    v1 = (char *)v8;
                    dword_41152C(v8 + v7);
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return v1;
}
// 4112BC: using guessed type int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD);
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 4112E4: using guessed type int (__cdecl *dword_4112E4)(_DWORD, _DWORD);
// 41152C: using guessed type int (__stdcall *dword_41152C)(_DWORD);
// 407DBA: using guessed type _WORD var_C[6];

//----- (00407EA7) --------------------------------------------------------
int __stdcall sub_407EA7(int a1)
{
  int i; // eax
  int v2; // ebx
  int v3; // esi
  int v5; // [esp+8h] [ebp-Ch]
  int v6; // [esp+Ch] [ebp-8h] BYREF
  int v7; // [esp+10h] [ebp-4h]

  v7 = 0;
  v6 = 1024;
  v5 = sub_405F98(1024);
  for ( i = dword_411318(5, v5, 1024, &v6); i; i = dword_411318(5, v5, v6, &v6) )
  {
    if ( i != -1073741820 )
      goto LABEL_11;
    v5 = sub_405FCE(v5, v6);
  }
  v2 = v5;
  while ( 1 )
  {
    v3 = *(_DWORD *)v2;
    if ( *(_DWORD *)(v2 + 60) )
    {
      if ( sub_4010BB(*(_WORD **)(v2 + 60), 0) == a1 )
        break;
    }
    v2 += v3;
    if ( !v3 )
      goto LABEL_11;
  }
  v7 = *(_DWORD *)(v2 + 68);
LABEL_11:
  sub_405FB3(v5);
  return v7;
}
// 411318: using guessed type int (__stdcall *dword_411318)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00407F4C) --------------------------------------------------------
int __userpurge sub_407F4C@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int v5[2]; // [esp+0h] [ebp-38h] BYREF
  char v6; // [esp+8h] [ebp-30h]
  char v7; // [esp+9h] [ebp-2Fh]
  int v8; // [esp+Ch] [ebp-2Ch] BYREF
  int v9; // [esp+10h] [ebp-28h]
  int v10; // [esp+14h] [ebp-24h]
  int v11; // [esp+18h] [ebp-20h]
  int v12; // [esp+1Ch] [ebp-1Ch]
  int *v13; // [esp+20h] [ebp-18h]
  int v14[2]; // [esp+24h] [ebp-14h] BYREF
  int v15; // [esp+2Ch] [ebp-Ch] BYREF
  int v16; // [esp+30h] [ebp-8h] BYREF
  int v17; // [esp+34h] [ebp-4h] BYREF

  v17 = 0;
  v16 = 0;
  v15 = 0;
  if ( a2 )
  {
    v14[0] = a1;
    v14[1] = 0;
    v8 = 24;
    v9 = 0;
    v10 = 0;
    v11 = 0;
    v12 = 0;
    v13 = 0;
    if ( !dword_411304(&v15, 0x2000000, &v8, v14) && !dword_41132C(v15, 0x2000000, &v17) )
    {
      v5[0] = 12;
      v5[1] = a3;
      v6 = 0;
      v7 = 0;
      v8 = 24;
      v9 = 0;
      v10 = 0;
      v11 = 0;
      v12 = 0;
      v13 = v5;
      dword_411308(v17, 0x2000000, &v8, 0, a4, &v16);
    }
  }
  if ( v17 )
    dword_411354(v17);
  if ( v15 )
    dword_411354(v15);
  return v16;
}
// 411304: using guessed type int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411308: using guessed type int (__stdcall *dword_411308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41132C: using guessed type int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);

//----- (00408058) --------------------------------------------------------
int sub_408058()
{
  int v1; // [esp+0h] [ebp-4h] BYREF

  v1 = 0;
  dword_411550(MEMORY[0x7FFE02D8], &v1);
  return v1;
}
// 411550: using guessed type int (__stdcall *dword_411550)(_DWORD, _DWORD);

//----- (0040807E) --------------------------------------------------------
int sub_40807E()
{
  int v0; // eax
  int *v2; // ebx
  int v3; // esi
  int v4[5]; // [esp+8h] [ebp-4Ch] BYREF
  _DWORD v5[6]; // [esp+1Ch] [ebp-38h] BYREF
  int v6[2]; // [esp+34h] [ebp-20h] BYREF
  int *i; // [esp+3Ch] [ebp-18h]
  int v8; // [esp+40h] [ebp-14h] BYREF
  int v9; // [esp+44h] [ebp-10h] BYREF
  int v10; // [esp+48h] [ebp-Ch] BYREF
  int v11; // [esp+4Ch] [ebp-8h] BYREF
  int v12; // [esp+50h] [ebp-4h]

  v12 = 0;
  v8 = 1024;
  for ( i = (int *)sub_405F98(1024); ; i = (int *)sub_405FCE((int)i, v8) )
  {
    v0 = dword_411318(5, i, v8, &v8);
    if ( !v0 )
      break;
    if ( v0 != -1073741820 )
    {
      sub_405FB3((int)i);
      return v11;
    }
  }
  v2 = i;
  while ( 1 )
  {
    v3 = *v2;
    if ( !v2[15] )
      goto LABEL_16;
    if ( sub_4010BB((_WORD *)v2[15], 0) != -1210047432 )
      goto LABEL_16;
    v6[0] = v2[17];
    v6[1] = 0;
    v5[0] = 24;
    memset(&v5[1], 0, 20);
    v9 = 0;
    if ( dword_411304(&v9, 0x1FFFFF, v5, v6) )
      goto LABEL_16;
    if ( !dword_41132C(v9, 8, &v10) )
      break;
LABEL_15:
    dword_411354(v9);
LABEL_16:
    v2 = (int *)((char *)v2 + v3);
    if ( !v3 )
      goto LABEL_17;
  }
  v4[0] = 1;
  v4[1] = 1;
  v4[2] = 7;
  v4[3] = 0;
  v4[4] = 2;
  v11 = 0;
  if ( dword_411358(v10, v4, &v11) || !v11 )
  {
    dword_411354(v10);
    goto LABEL_15;
  }
  dword_411354(v10);
  dword_411354(v9);
  v12 = v2[17];
LABEL_17:
  sub_405FB3((int)i);
  return v12;
}
// 411304: using guessed type int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411318: using guessed type int (__stdcall *dword_411318)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41132C: using guessed type int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411358: using guessed type int (__stdcall *dword_411358)(_DWORD, _DWORD, _DWORD);
// 40807E: using guessed type _DWORD var_38[6];

//----- (00408208) --------------------------------------------------------
int __stdcall sub_408208(int a1, int a2, int a3)
{
  int v4; // [esp+0h] [ebp-10h] BYREF
  int v5; // [esp+4h] [ebp-Ch] BYREF
  int v6; // [esp+8h] [ebp-8h]
  int v7; // [esp+Ch] [ebp-4h] BYREF

  v7 = 0;
  v5 = 0;
  v4 = 719;
  if ( !dword_411338(a1, &v5, 0, &v4, 12288, 64) )
  {
    if ( !dword_41135C(a1, v5, a2, a3, 0) )
    {
      v6 = dword_41138C(a1, 0, 0, v5, 0, 0, 0);
      if ( v6 )
      {
        dword_4113AC(v6, -1);
        dword_4113C4(v6, &v7);
        dword_411354(v6);
      }
    }
    v4 = 0;
    dword_411360(a1, &v5, &v4, 0x8000);
  }
  return v7;
}
// 411338: using guessed type int (__stdcall *dword_411338)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41135C: using guessed type int (__stdcall *dword_41135C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411360: using guessed type int (__stdcall *dword_411360)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41138C: using guessed type int (__stdcall *dword_41138C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (004082BF) --------------------------------------------------------
int sub_4082BF()
{
  HANDLE v0; // eax
  _BYTE *v1; // eax
  int v2; // esi
  int v3; // esi
  _BYTE *v4; // eax
  int v5; // esi
  int v6; // esi
  _BYTE *v7; // eax
  int v8; // esi
  int v9; // esi
  int v11; // [esp+4h] [ebp-48h] BYREF
  int v12; // [esp+8h] [ebp-44h]
  int v13; // [esp+Ch] [ebp-40h]
  int v14; // [esp+10h] [ebp-3Ch]
  int v15; // [esp+14h] [ebp-38h]
  int v16; // [esp+18h] [ebp-34h]
  HANDLE UniqueProcess; // [esp+1Ch] [ebp-30h] BYREF
  int v18; // [esp+20h] [ebp-2Ch]
  int v19; // [esp+24h] [ebp-28h] BYREF
  int v20; // [esp+28h] [ebp-24h] BYREF
  int v21[2]; // [esp+2Ch] [ebp-20h] BYREF
  int v22; // [esp+34h] [ebp-18h] BYREF
  int v23; // [esp+38h] [ebp-14h] BYREF
  int v24; // [esp+3Ch] [ebp-10h] BYREF
  int v25; // [esp+40h] [ebp-Ch]
  int v26; // [esp+44h] [ebp-8h] BYREF
  int v27; // [esp+48h] [ebp-4h] BYREF

  v25 = 0;
  v24 = 0;
  v22 = 0;
  v21[1] = 0;
  v21[0] = 0;
  v20 = 0;
  v27 = 0;
  v26 = 0;
  v19 = 0;
  if ( (unsigned int)sub_40155E() >= 0x3C )
  {
    v0 = (HANDLE)sub_40807E();
    if ( v0 )
    {
      UniqueProcess = v0;
      v18 = 0;
      v11 = 24;
      v12 = 0;
      v13 = 0;
      v14 = 0;
      v15 = 0;
      v16 = 0;
      if ( !dword_411304(&v27, 0x1FFFFF, &v11, &UniqueProcess) )
      {
        UniqueProcess = NtCurrentTeb()->ClientId.UniqueProcess;
        v18 = 0;
        v11 = 24;
        v12 = 0;
        v13 = 0;
        v14 = 0;
        v15 = 0;
        v16 = 0;
        if ( !dword_411304(&v26, 0x1FFFFF, &v11, &UniqueProcess) )
        {
          if ( !dword_41130C(v26, v26, v27, &v19, 0, 0, 2) )
          {
            sub_406531(-1, &v24);
            if ( v24 )
            {
              v23 = 513;
              if ( !dword_411338(v26, v21, 0, &v23, 12288, 4) )
              {
                v1 = sub_4064CC(dword_4102BA);
                v2 = (int)v1;
                if ( v1 )
                {
                  dword_4112BC(v21[0], v1, 513);
                  sub_405FB3(v2);
                  v3 = v21[0];
                  *(_DWORD *)(v21[0] + 9) = NtCurrentPeb()->SessionId;
                  *(_DWORD *)(v3 + 13) = v19;
                  v23 = 719;
                  if ( !dword_411338(v26, &v20, 0, &v23, 12288, 64) )
                  {
                    v4 = sub_4064CC(dword_4104BF);
                    v5 = (int)v4;
                    if ( v4 )
                    {
                      dword_4112BC(v20, v4, 719);
                      sub_405FB3(v5);
                      v6 = v20;
                      *(_DWORD *)(v20 + 37) = v27;
                      *(_DWORD *)(v6 + 44) = v21[0];
                      *(_DWORD *)(v6 + 51) = 513;
                      v25 = ((int (*)(void))v6)();
                      v23 = 0;
                      dword_411360(v26, &v20, &v23, 0x8000);
                    }
                  }
                  v23 = 0;
                  dword_411360(v26, v21, &v23, 0x8000);
                }
              }
            }
            else
            {
              v23 = 380;
              if ( !dword_411338(v26, &v22, 0, &v23, 12288, 4) )
              {
                v7 = sub_4064CC(dword_41013A);
                v8 = (int)v7;
                if ( v7 )
                {
                  dword_4112BC(v22, v7, 380);
                  sub_405FB3(v8);
                  v9 = v22;
                  *(_DWORD *)(v22 + 5) = NtCurrentPeb()->SessionId;
                  *(_DWORD *)(v9 + 9) = v19;
                  v25 = sub_408208(v27, v9, 380);
                  v23 = 0;
                  dword_411360(v26, &v22, &v23, 0x8000);
                }
              }
            }
          }
          dword_411354(v26);
        }
        dword_411354(v27);
      }
    }
  }
  return v25;
}
// 41013A: using guessed type _DWORD dword_41013A[96];
// 4102BA: using guessed type _DWORD dword_4102BA[129];
// 4104BF: using guessed type _DWORD dword_4104BF[180];
// 4112BC: using guessed type int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD);
// 411304: using guessed type int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41130C: using guessed type int (__stdcall *dword_41130C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411338: using guessed type int (__stdcall *dword_411338)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411360: using guessed type int (__stdcall *dword_411360)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004085C8) --------------------------------------------------------
int sub_4085C8()
{
  int v0; // edi
  _BYTE *v1; // eax
  _BYTE *v2; // esi
  _WORD *v3; // eax
  _WORD *v4; // ebx
  int v5; // edi
  _WORD *v6; // eax
  const void *v7; // ebx
  int v8; // eax
  int v9; // eax
  char v11[256]; // [esp+Ch] [ebp-104h] BYREF
  int v12; // [esp+10Ch] [ebp-4h] BYREF

  v12 = 0;
  v0 = sub_4014F2(dword_410FD0);
  v1 = (_BYTE *)sub_405F98(v0 + 2);
  v2 = v1;
  if ( v1 )
  {
    sub_4012CE((char *)dword_410FD0, v1);
    sub_405FB3(dword_410FD0);
    sub_401713(v2, v0);
    dword_410FD0 = (int)v2;
    while ( 1 )
    {
      dword_4112DC(v11, v2);
      v3 = (_WORD *)dword_4112E4(v11, 58);
      v4 = v3;
      if ( v3 )
      {
        *v3 = 0;
        if ( dword_411468(v11, 0, v3 + 1, 4, 0, &v12) )
          break;
      }
      v2 += 2 * dword_4112D4(v2) + 2;
      if ( !*(_WORD *)v2 )
        goto LABEL_7;
    }
    v5 = dword_4112D4(v4 + 1);
    dword_410FE0 = (int)sub_4064FA(v4 + 1, 2 * v5 + 2);
    v6 = (_WORD *)dword_4112E4(v11, 64);
    *v6 = 0;
    v7 = v6 + 1;
    v8 = dword_4112D4(v11);
    dword_410FD8 = (int)sub_4064FA(v11, 2 * v8 + 2);
    v9 = dword_4112D4(v7);
    dword_410FDC = (int)sub_4064FA(v7, 2 * v9 + 2);
LABEL_7:
    sub_405FB3(dword_410FD0);
  }
  return v12;
}
// 410FD0: using guessed type int dword_410FD0;
// 410FD8: using guessed type int dword_410FD8;
// 410FDC: using guessed type int dword_410FDC;
// 410FE0: using guessed type int dword_410FE0;
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 4112E4: using guessed type int (__cdecl *dword_4112E4)(_DWORD, _DWORD);
// 411468: using guessed type int (__stdcall *dword_411468)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00408731) --------------------------------------------------------
int sub_408731()
{
  int v0; // eax
  int v2; // [esp+0h] [ebp-4h]

  v2 = 0;
  v0 = sub_407EA7(1051882214);
  if ( v0 )
    return sub_407F4C(v0, v0, 3, 1);
  return v2;
}

//----- (00408766) --------------------------------------------------------
int __stdcall sub_408766(int a1, int a2)
{
  BOOL v2; // ebx
  _DWORD v4[6]; // [esp+4h] [ebp-1Ch] BYREF
  int v5; // [esp+1Ch] [ebp-4h] BYREF

  v2 = 0;
  if ( !a1 )
    return 1;
  v4[0] = 24;
  memset(&v4[1], 0, 20);
  if ( !dword_411308(a1, 12, v4, 0, 2, &v5) )
  {
    v2 = dword_411324(a2, 5, &v5, 4) == 0;
    dword_411354(v5);
  }
  return v2;
}
// 411308: using guessed type int (__stdcall *dword_411308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411324: using guessed type int (__stdcall *dword_411324)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 408766: using guessed type _DWORD var_1C[6];

//----- (004087E7) --------------------------------------------------------
int __stdcall sub_4087E7(int a1, _DWORD *a2)
{
  int v2; // edx
  char v4[28]; // [esp+0h] [ebp-258h] BYREF
  int v5; // [esp+1Ch] [ebp-23Ch]
  int v6; // [esp+20h] [ebp-238h]
  int v7; // [esp+250h] [ebp-8h]
  int v8; // [esp+254h] [ebp-4h]

  v8 = 0;
  v7 = dword_411374(a1, 0, v4, 0, 0, 0);
  if ( v7 != -1 )
  {
    v2 = v5;
    *a2 = v6;
    a2[1] = v2;
    return dword_41137C(v7);
  }
  return v8;
}
// 411374: using guessed type int (__stdcall *dword_411374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41137C: using guessed type int (__stdcall *dword_41137C)(_DWORD);
// 4087E7: using guessed type char var_258[28];

//----- (00408841) --------------------------------------------------------
int __stdcall sub_408841(_DWORD *a1)
{
  return dword_41146C(*a1, a1[1]);
}
// 41146C: using guessed type int (__stdcall *dword_41146C)(_DWORD, _DWORD);

//----- (00408856) --------------------------------------------------------
int __stdcall sub_408856(int a1, int a2, int a3)
{
  int v4[2]; // [esp+0h] [ebp-10h] BYREF
  int v5; // [esp+8h] [ebp-8h] BYREF
  int v6; // [esp+Ch] [ebp-4h]

  v5 = 0;
  v6 = 0;
  v4[0] = a2;
  v4[1] = a3;
  v6 = dword_411388(0, 0, sub_408841, v4, 4, 0);
  if ( v6 )
  {
    if ( a1 && !sub_408766(a1, v6) )
    {
      dword_411350(v6, 0);
      dword_411354(v6);
      return v5;
    }
    dword_411390(v6);
    dword_4113AC(v6, -1);
    dword_4113C4(v6, &v5);
    dword_411354(v6);
  }
  return v5;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (004088FB) --------------------------------------------------------
int __stdcall sub_4088FB(int a1)
{
  return dword_4113CC(a1);
}
// 4113CC: using guessed type int (__stdcall *dword_4113CC)(_DWORD);

//----- (0040890B) --------------------------------------------------------
int __stdcall sub_40890B(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-8h] BYREF
  int v4; // [esp+4h] [ebp-4h]

  v3 = 0;
  v4 = dword_411388(0, 0, sub_4088FB, a2, 4, 0);
  if ( v4 )
  {
    if ( a1 && !sub_408766(a1, v4) )
    {
      dword_411350(v4, 0);
      dword_411354(v4);
      return v3;
    }
    dword_411390(v4);
    dword_4113AC(v4, -1);
    dword_4113C4(v4, &v3);
    dword_411354(v4);
  }
  return v3;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (004089A3) --------------------------------------------------------
int __stdcall sub_4089A3(_DWORD *a1)
{
  int result; // eax

  __writefsdword(0x34u, 0);
  result = dword_411520(*a1);
  a1[1] = NtCurrentTeb()->LastErrorValue;
  return result;
}
// 411520: using guessed type int (__stdcall *dword_411520)(_DWORD);

//----- (004089CA) --------------------------------------------------------
int __stdcall sub_4089CA(int a1, int a2)
{
  int v3[2]; // [esp+0h] [ebp-10h] BYREF
  int v4; // [esp+8h] [ebp-8h] BYREF
  int v5; // [esp+Ch] [ebp-4h]

  v4 = 0;
  v5 = 0;
  v3[0] = a2;
  v5 = dword_411388(0, 0, sub_4089A3, v3, 4, 0);
  if ( v5 )
  {
    if ( a1 && !sub_408766(a1, v5) )
    {
      dword_411350(v5, 0);
      dword_411354(v5);
      return v4;
    }
    dword_411390(v5);
    dword_4113AC(v5, -1);
    dword_4113C4(v5, &v4);
    dword_411354(v5);
    __writefsdword(0x34u, v3[1]);
  }
  return v4;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (00408A72) --------------------------------------------------------
int __stdcall sub_408A72(int a1)
{
  return dword_411370(a1);
}
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);

//----- (00408A82) --------------------------------------------------------
int __stdcall sub_408A82(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-8h]
  int v4; // [esp+4h] [ebp-4h] BYREF

  v4 = 0;
  v3 = dword_411388(0, 0, sub_408A72, a2, 4, 0);
  if ( v3 )
  {
    if ( a1 && !sub_408766(a1, v3) )
    {
      dword_411350(v3, 0);
      dword_411354(v3);
      return v4;
    }
    dword_411390(v3);
    dword_4113AC(v3, -1);
    dword_4113C4(v3, &v4);
    dword_411354(v3);
  }
  return v4;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (00408B13) --------------------------------------------------------
int __stdcall sub_408B13(int a1)
{
  return dword_41153C(a1);
}
// 41153C: using guessed type int (__stdcall *dword_41153C)(_DWORD);

//----- (00408B23) --------------------------------------------------------
int __stdcall sub_408B23(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-8h] BYREF
  int v4; // [esp+4h] [ebp-4h]

  v3 = 0;
  v4 = dword_411388(0, 0, sub_408B13, a2, 4, 0);
  if ( v4 )
  {
    if ( a1 && !sub_408766(a1, v4) )
    {
      dword_411350(v4, 0);
      dword_411354(v4);
      return v3;
    }
    dword_411390(v4);
    dword_4113AC(v4, -1);
    dword_4113C4(v4, &v3);
    dword_411354(v4);
  }
  return v3;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (00408BB4) --------------------------------------------------------
int __stdcall sub_408BB4(_DWORD *a1)
{
  return dword_4113C8(*a1, a1[1]);
}
// 4113C8: using guessed type int (__stdcall *dword_4113C8)(_DWORD, _DWORD);

//----- (00408BC9) --------------------------------------------------------
int __stdcall sub_408BC9(int a1, int a2, int a3)
{
  int v4[2]; // [esp+0h] [ebp-10h] BYREF
  int v5; // [esp+8h] [ebp-8h] BYREF
  int v6; // [esp+Ch] [ebp-4h]

  v4[0] = a2;
  v4[1] = a3;
  v5 = 0;
  v6 = 0;
  v6 = dword_411388(0, 0, sub_408BB4, v4, 4, 0);
  if ( v6 )
  {
    if ( a1 && !sub_408766(a1, v6) )
    {
      dword_411350(v6, 0);
      dword_411354(v6);
      return v5;
    }
    dword_411390(v6);
    dword_4113AC(v6, -1);
    dword_4113C4(v6, &v5);
    dword_411354(v6);
  }
  return v5;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (00408C6E) --------------------------------------------------------
int __stdcall sub_408C6E(_DWORD *a1)
{
  return dword_4113D0(*a1, a1[1], a1[2], a1[3]);
}
// 4113D0: using guessed type int (__stdcall *dword_4113D0)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00408C89) --------------------------------------------------------
int __stdcall sub_408C89(int a1, int a2, int a3, int a4, int a5)
{
  int v6[4]; // [esp+0h] [ebp-18h] BYREF
  int v7; // [esp+10h] [ebp-8h] BYREF
  int v8; // [esp+14h] [ebp-4h]

  v7 = 0;
  v8 = 0;
  v6[0] = a2;
  v6[1] = a3;
  v6[2] = a4;
  v6[3] = a5;
  v8 = dword_411388(0, 0, sub_408C6E, v6, 4, 0);
  if ( v8 )
  {
    if ( a1 && !sub_408766(a1, v8) )
    {
      dword_411350(v8, 0);
      dword_411354(v8);
      return v7;
    }
    dword_411390(v8);
    dword_4113AC(v8, -1);
    dword_4113C4(v8, &v7);
    dword_411354(v8);
  }
  return v7;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (00408D3A) --------------------------------------------------------
unsigned int __stdcall sub_408D3A(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int v3; // ebx
  unsigned int v4; // edi
  char *v5; // esi
  char v6[520]; // [esp+Ch] [ebp-210h] BYREF
  _DWORD v7[2]; // [esp+214h] [ebp-8h] BYREF

  v7[0] = 3801178;
  v7[1] = 92;
  result = sub_408BC9(a1, 260, (int)v6);
  if ( result )
  {
    v3 = result >> 2;
LABEL_3:
    v4 = v3;
    v5 = v6;
    do
    {
      if ( !dword_4112EC(v5, v7) )
      {
        result = (unsigned int)v7;
        if ( --LOWORD(v7[0]) == 64 )
          return result;
        goto LABEL_3;
      }
      v5 += 8;
      --v4;
    }
    while ( v4 );
    return dword_4113F8(v7, a2);
  }
  return result;
}
// 4112EC: using guessed type int (__cdecl *dword_4112EC)(_DWORD, _DWORD);
// 4113F8: using guessed type int (__stdcall *dword_4113F8)(_DWORD, _DWORD);
// 408D3A: using guessed type _DWORD var_8[2];

//----- (00408DC6) --------------------------------------------------------
int sub_408DC6()
{
  int result; // eax
  int v1; // eax
  _DWORD *v2; // eax
  int v3[8]; // [esp+8h] [ebp-324h] BYREF
  int v4; // [esp+28h] [ebp-304h]
  int v5; // [esp+2Ch] [ebp-300h]
  int v6; // [esp+30h] [ebp-2FCh]
  int v7; // [esp+34h] [ebp-2F8h]
  _DWORD v8[130]; // [esp+98h] [ebp-294h] BYREF
  __int16 v9[64]; // [esp+2A0h] [ebp-8Ch] BYREF
  int v10; // [esp+320h] [ebp-Ch] BYREF
  int v11; // [esp+324h] [ebp-8h]
  int v12; // [esp+328h] [ebp-4h]

  dword_4112C0(v8, 0, 520);
  result = dword_411408(v8, 260);
  v12 = result;
  if ( result )
  {
    do
    {
      if ( v8[0] == 6029404 && v8[1] == 6029375 )
      {
        v10 = 0;
        if ( dword_411418(v8, v9, 64, &v10) )
        {
          if ( !v9[0] && v10 == 1 )
          {
            v1 = dword_4113CC(v8);
            if ( v1 == 3 || v1 == 2 )
            {
              if ( (unsigned int)sub_40155E() >= 0x3D )
              {
                sub_4016E3((int)v8);
                v11 = dword_411394(v8, 0x80000000, 3, 0, 3, 128, 0);
                if ( v11 != -1 && dword_411414(v11, 458824, 0, 0, v3, 144, &v10, 0) )
                {
                  if ( v3[0] == 1 )
                  {
                    if ( (v4 != -1054182616 || v5 != 299038751 || v6 != -1610593350 || v7 != 1003044553)
                      && (v4 != -560677980 || v5 != 1296041681 || v6 != -708875615 || v7 != -1395230463) )
                    {
                      sub_4016B4((int)v8);
                      sub_408D3A(dword_410FE8, (int)v8);
                    }
                  }
                  else if ( !v3[0] && !BYTE1(v4) )
                  {
                    sub_4016B4((int)v8);
                    sub_408D3A(dword_410FE8, (int)v8);
                  }
                }
                dword_411354(v11);
              }
              else
              {
                v2 = (_DWORD *)((char *)v8 + 2 * dword_4112D4(v8));
                *v2 = 7274594;
                v2[1] = 7602287;
                v2[2] = 6750317;
                v2[3] = 114;
                v11 = dword_411394(v8, 0x80000000, 3, 0, 3, 128, 0);
                if ( v11 == -1 )
                {
                  *(_WORD *)(dword_4112E8(v8, 92) + 2) = 0;
                  sub_408D3A(dword_410FE8, (int)v8);
                }
                if ( v11 != -1 )
                  dword_411354(v11);
              }
            }
          }
        }
      }
      dword_4112C0(v8, 0, 520);
    }
    while ( dword_41140C(v12, v8, 260) );
    return dword_411410(v12);
  }
  return result;
}
// 410FE8: using guessed type int dword_410FE8;
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112E8: using guessed type int (__cdecl *dword_4112E8)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411394: using guessed type int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113CC: using guessed type int (__stdcall *dword_4113CC)(_DWORD);
// 411408: using guessed type int (__stdcall *dword_411408)(_DWORD, _DWORD);
// 41140C: using guessed type int (__stdcall *dword_41140C)(_DWORD, _DWORD, _DWORD);
// 411410: using guessed type int (__stdcall *dword_411410)(_DWORD);
// 411414: using guessed type int (__stdcall *dword_411414)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411418: using guessed type int (__stdcall *dword_411418)(_DWORD, _DWORD, _DWORD, _DWORD);
// 408DC6: using guessed type _DWORD var_294[130];
// 408DC6: using guessed type __int16 var_8C[64];
// 408DC6: using guessed type int var_324[8];

//----- (00409019) --------------------------------------------------------
int __stdcall sub_409019(int a1)
{
  int *v1; // eax
  int v2; // ecx
  unsigned int v3; // eax
  unsigned int v4; // ebx
  unsigned int v5; // edi
  char *i; // esi
  _DWORD *v8; // eax
  char v9[520]; // [esp+Ch] [ebp-214h] BYREF
  int v10; // [esp+214h] [ebp-Ch] BYREF
  int v11; // [esp+218h] [ebp-8h]
  int v12; // [esp+21Ch] [ebp-4h]

  v12 = 0;
  v1 = &v10;
  v10 = 574382007;
  v11 = 570843057;
  v2 = 2;
  do
  {
    *v1++ ^= 0x22065FEDu;
    --v2;
  }
  while ( v2 );
  v3 = sub_408BC9(dword_410FE8, 260, (int)v9);
  if ( !v3 )
    return v12;
  v4 = v3 >> 2;
  while ( 2 )
  {
    v5 = v4;
    for ( i = v9; dword_4112EC(i, &v10); i += 8 )
    {
      if ( !--v5 )
      {
        if ( dword_4113F8(&v10, a1) )
        {
          v8 = (_DWORD *)sub_405F98(8);
          if ( v8 )
          {
            *v8 = v10;
            v8[1] = v11;
            return (int)v8;
          }
        }
        return v12;
      }
    }
    LOWORD(v10) = v10 - 1;
    if ( (_WORD)v10 != 64 )
      continue;
    break;
  }
  return v12;
}
// 410FE8: using guessed type int dword_410FE8;
// 4112EC: using guessed type int (__cdecl *dword_4112EC)(_DWORD, _DWORD);
// 4113F8: using guessed type int (__stdcall *dword_4113F8)(_DWORD, _DWORD);

//----- (004090E7) --------------------------------------------------------
int __stdcall sub_4090E7(int a1)
{
  int *v1; // eax
  int v2; // ecx
  int *v3; // eax
  int v4; // ecx
  int *v5; // eax
  int v6; // ecx
  int v8; // [esp+0h] [ebp-3Ch] BYREF
  int v9; // [esp+4h] [ebp-38h]
  int v10; // [esp+8h] [ebp-34h]
  int v11; // [esp+Ch] [ebp-30h]
  int v12; // [esp+10h] [ebp-2Ch] BYREF
  int v13; // [esp+14h] [ebp-28h]
  int v14; // [esp+18h] [ebp-24h]
  int v15; // [esp+1Ch] [ebp-20h]
  int v16; // [esp+20h] [ebp-1Ch] BYREF
  int v17; // [esp+24h] [ebp-18h]
  int v18; // [esp+28h] [ebp-14h]
  int v19; // [esp+2Ch] [ebp-10h]
  int v20; // [esp+30h] [ebp-Ch] BYREF
  int v21; // [esp+34h] [ebp-8h] BYREF
  int v22; // [esp+38h] [ebp-4h]

  v22 = 0;
  v21 = 0;
  v20 = 0;
  dword_411500(0);
  v1 = &v16;
  v16 = 570706924;
  v17 = 570843117;
  v18 = 570842925;
  v19 = 1678139373;
  v2 = 4;
  do
  {
    *v1++ ^= 0x22065FEDu;
    --v2;
  }
  while ( v2 );
  v3 = &v12;
  v12 = 570706708;
  v13 = 570843117;
  v14 = 570842925;
  v15 = 1678139373;
  v4 = 4;
  do
  {
    *v3++ ^= 0x22065FEDu;
    --v4;
  }
  while ( v4 );
  v5 = &v8;
  v8 = 570842854;
  v9 = 570843117;
  v10 = 570842925;
  v11 = 1678139373;
  v6 = 4;
  do
  {
    *v5++ ^= 0x22065FEDu;
    --v6;
  }
  while ( v6 );
  if ( !dword_411510(&v16, 0, 1, &v12, &v21)
    && !(**(int (__stdcall ***)(int, int *, int *))v21)(v21, &v8, &v20)
    && !(*(int (__stdcall **)(int, int, _DWORD))(*(_DWORD *)v20 + 20))(v20, a1, 0) )
  {
    v22 = sub_405F98(0x4000);
    if ( v22 )
    {
      if ( (*(int (__stdcall **)(int, int, int, _DWORD, _DWORD))(*(_DWORD *)v21 + 12))(v21, v22, 0x4000, 0, 0) )
      {
        sub_405FB3(v22);
        v22 = 0;
      }
    }
  }
  if ( v20 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v20 + 8))(v20);
  if ( v21 )
    (*(void (__stdcall **)(int))(*(_DWORD *)v21 + 8))(v21);
  dword_411504(v8, v9, v10, v11, v12, v13, v14, v15, v16, v17, v18, v19);
  return v22;
}
// 411500: using guessed type int (__stdcall *dword_411500)(_DWORD);
// 411504: using guessed type int (__cdecl *dword_411504)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411510: using guessed type int (__stdcall *dword_411510)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00409249) --------------------------------------------------------
int __stdcall sub_409249(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-8h] BYREF
  int v4; // [esp+4h] [ebp-4h]

  v3 = 0;
  v4 = dword_411388(0, 0, sub_4090E7, a2, 4, 0);
  if ( v4 )
  {
    if ( a1 && !sub_408766(a1, v4) )
    {
      dword_411350(v4, 0);
      dword_411354(v4);
      return v3;
    }
    dword_411390(v4);
    dword_4113AC(v4, -1);
    dword_4113C4(v4, &v3);
    dword_411354(v4);
  }
  return v3;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (004092E1) --------------------------------------------------------
int __stdcall sub_4092E1(int a1)
{
  int v1; // eax

  if ( a1 )
    v1 = a1;
  else
    v1 = -2;
  return dword_411324(v1, 17, 0, 0);
}
// 411324: using guessed type int (__stdcall *dword_411324)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040930C) --------------------------------------------------------
int sub_40930C()
{
  return dword_4114F0(0, 544);
}
// 4114F0: using guessed type int (__stdcall *dword_4114F0)(_DWORD, _DWORD);

//----- (0040931A) --------------------------------------------------------
int __stdcall sub_40931A(int a1)
{
  int v1; // eax
  int *v2; // esi
  int v3; // ebx
  int v4; // eax
  _DWORD *v5; // esi
  int *v7; // [esp+8h] [ebp-10h] BYREF
  int v8; // [esp+Ch] [ebp-Ch] BYREF
  int v9; // [esp+10h] [ebp-8h] BYREF
  int v10; // [esp+14h] [ebp-4h]

  v10 = 0;
  if ( a1 )
  {
    v9 = a1;
    v1 = 0;
  }
  else
  {
    v1 = dword_41132C(-1, 8, &v9);
  }
  if ( !v1 )
  {
    dword_411320(v9, 2, &v7, 4, &v8);
    v7 = (int *)sub_405F98(v8);
    if ( v7 )
    {
      if ( !dword_411320(v9, 2, v7, v8, &v8) )
      {
        v2 = v7 + 1;
        v3 = *v7;
        while ( 1 )
        {
          v4 = *v2;
          v5 = v2 + 1;
          if ( *(_DWORD *)(v4 + 8) == 32 && *(_DWORD *)(v4 + 12) == 544 )
            break;
          v2 = v5 + 1;
          if ( !--v3 )
            goto LABEL_12;
        }
        v10 = 1;
      }
LABEL_12:
      sub_405FB3((int)v7);
    }
    if ( !a1 )
      dword_411354(v9);
  }
  return v10;
}
// 411320: using guessed type int (__stdcall *dword_411320)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41132C: using guessed type int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);

//----- (004093D7) --------------------------------------------------------
int __stdcall sub_4093D7(int a1)
{
  int v1; // eax
  int *v2; // esi
  int v3; // ebx
  int v4; // eax
  _DWORD *v5; // esi
  int *v7; // [esp+8h] [ebp-10h] BYREF
  int v8; // [esp+Ch] [ebp-Ch] BYREF
  int v9; // [esp+10h] [ebp-8h] BYREF
  int v10; // [esp+14h] [ebp-4h]

  v10 = 0;
  if ( a1 )
  {
    v9 = a1;
    v1 = 0;
  }
  else
  {
    v1 = dword_41132C(-1, 8, &v9);
  }
  if ( !v1 )
  {
    dword_411320(v9, 2, &v7, 4, &v8);
    v7 = (int *)sub_405F98(v8);
    if ( v7 )
    {
      if ( !dword_411320(v9, 2, v7, v8, &v8) )
      {
        v2 = v7 + 1;
        v3 = *v7;
        while ( 1 )
        {
          v4 = *v2;
          v5 = v2 + 1;
          if ( *(_DWORD *)(v4 + 8) == 21 && *(_DWORD *)(v4 + 24) == 512 )
            break;
          v2 = v5 + 1;
          if ( !--v3 )
            goto LABEL_12;
        }
        v10 = 1;
      }
LABEL_12:
      sub_405FB3((int)v7);
    }
    if ( !a1 )
      dword_411354(v9);
  }
  return v10;
}
// 411320: using guessed type int (__stdcall *dword_411320)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41132C: using guessed type int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);

//----- (00409494) --------------------------------------------------------
BOOL sub_409494()
{
  BOOL v0; // ebx
  int v2[11]; // [esp+4h] [ebp-34h] BYREF
  char v3[4]; // [esp+30h] [ebp-8h] BYREF
  int v4; // [esp+34h] [ebp-4h] BYREF

  v0 = 0;
  if ( !dword_41132C(-1, 8, &v4) )
  {
    if ( !dword_411320(v4, 1, v2, 44, v3) )
      v0 = *(_DWORD *)(v2[0] + 8) == 18;
    dword_411354(v4);
  }
  return v0;
}
// 411320: using guessed type int (__stdcall *dword_411320)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41132C: using guessed type int (__stdcall *dword_41132C)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 409494: using guessed type char var_8[4];
// 409494: using guessed type int var_34[11];

//----- (00409524) --------------------------------------------------------
int sub_409524()
{
  int *v0; // esi
  int result; // eax
  char v2; // [esp+7h] [ebp-1h] BYREF

  v2 = 0;
  v0 = dword_4094E8;
  while ( 1 )
  {
    result = *v0++;
    if ( !result )
      break;
    dword_411334(result, 1, 0, &v2);
  }
  return result;
}
// 4094E8: using guessed type int dword_4094E8[15];
// 411334: using guessed type int (__stdcall *dword_411334)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00409554) --------------------------------------------------------
_DWORD *sub_409554()
{
  _DWORD *result; // eax
  _DWORD *v1; // ebx

  result = (_DWORD *)sub_405FEC(4);
  v1 = result;
  if ( result )
  {
    *result = 3;
    dword_411314(-1, 33, result, 4);
    *v1 <<= 9;
    dword_411314(-1, 18, v1, 2);
    return (_DWORD *)sub_406022((int)v1);
  }
  return result;
}
// 411314: using guessed type int (__stdcall *dword_411314)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00409591) --------------------------------------------------------
_BYTE *__stdcall sub_409591(int a1, int a2, _BYTE *a3)
{
  _BYTE *result; // eax

  if ( *(_DWORD *)(a2 + 8) == *(_DWORD *)(a1 + 24) )
  {
    dword_411344(a1 + 36, dword_4115D4);
    dword_411344(a1 + 44, dword_4115DC);
    result = a3;
    *a3 = 1;
  }
  else
  {
    result = a3;
    *a3 = 0;
  }
  return result;
}
// 411344: using guessed type int (__stdcall *dword_411344)(_DWORD, _DWORD);
// 4115D4: using guessed type int dword_4115D4;
// 4115DC: using guessed type int dword_4115DC;

//----- (004095D6) --------------------------------------------------------
int sub_4095D6()
{
  int result; // eax
  _DWORD *v1; // eax
  int v2; // ecx
  _WORD *v3; // esi
  int v4; // edi
  _WORD *v5; // edi
  int i; // ecx
  struct _PEB *v7; // ebx
  struct _RTL_USER_PROCESS_PARAMETERS *ProcessParameters; // esi
  _DWORD v9[6]; // [esp+4h] [ebp-1Ch] BYREF
  int v10; // [esp+1Ch] [ebp-4h] BYREF

  v10 = 4096;
  result = dword_411338(-1, &dword_4115DC, 0, &v10, 12288, 4);
  if ( dword_4115DC )
  {
    result = dword_411338(-1, &dword_4115D8, 0, &v10, 12288, 4);
    if ( dword_4115D8 )
    {
      result = dword_411338(-1, &dword_4115D4, 0, &v10, 12288, 4);
      if ( dword_4115D4 )
      {
        sub_401654((_WORD *)dword_4115D4);
        sub_4016B4(dword_4115D4);
        v1 = v9;
        v9[0] = 577396617;
        v9[1] = 577658753;
        v9[2] = 578117506;
        v9[3] = 573071257;
        v9[4] = 578707336;
        v9[5] = 570843016;
        v2 = 6;
        do
        {
          *v1++ ^= 0x22065FEDu;
          --v2;
        }
        while ( v2 );
        dword_4112DC(dword_4115DC, v9);
        dword_4112D8(dword_4115D4, v9);
        v3 = (_WORD *)dword_4115D4;
        v4 = dword_4115D8;
        *(_WORD *)dword_4115D8 = 34;
        v5 = (_WORD *)(v4 + 2);
        for ( i = dword_4112D4(v3); i; --i )
          *v5++ = *v3++;
        *v5 = 34;
        v7 = NtCurrentPeb();
        dword_41133C(v7->FastPebLock);
        ProcessParameters = v7->ProcessParameters;
        dword_411344(&ProcessParameters->ImagePathName, dword_4115D4);
        dword_411344(&ProcessParameters->CommandLine, dword_4115D8);
        dword_411340(v7->FastPebLock);
        return dword_411348(0, sub_409591, v7);
      }
    }
  }
  return result;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 411338: using guessed type int (__stdcall *dword_411338)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41133C: using guessed type int (__stdcall *dword_41133C)(_DWORD);
// 411340: using guessed type int (__stdcall *dword_411340)(_DWORD);
// 411344: using guessed type int (__stdcall *dword_411344)(_DWORD, _DWORD);
// 411348: using guessed type int (__stdcall *dword_411348)(_DWORD, _DWORD, _DWORD);
// 4115D4: using guessed type int dword_4115D4;
// 4115D8: using guessed type int dword_4115D8;
// 4115DC: using guessed type int dword_4115DC;
// 4095D6: using guessed type _DWORD var_1C[6];

//----- (00409750) --------------------------------------------------------
int __stdcall sub_409750(int a1)
{
  _DWORD *v1; // eax
  int v2; // ecx
  _DWORD *v3; // eax
  int v4; // ecx
  _DWORD v6[34]; // [esp+4h] [ebp-BCh] BYREF
  _DWORD v7[4]; // [esp+8Ch] [ebp-34h] BYREF
  int v8[9]; // [esp+9Ch] [ebp-24h] BYREF

  v1 = v7;
  v7[0] = 1289433753;
  v7[1] = 1819516906;
  v7[2] = 1457730906;
  v7[3] = 1860487908;
  v2 = 4;
  do
  {
    *v1++ ^= 0x22065FEDu;
    --v2;
  }
  while ( v2 );
  v3 = v6;
  v6[0] = 577396648;
  v6[1] = 577789832;
  v6[2] = 577920908;
  v6[3] = 577331076;
  v6[4] = 574381955;
  v6[5] = 576872364;
  v6[6] = 577724288;
  v6[7] = 577724291;
  v6[8] = 577920926;
  v6[9] = 577200031;
  v6[10] = 577331097;
  v6[11] = 573005727;
  v6[12] = 576937859;
  v6[13] = 574381978;
  v6[14] = 573923222;
  v6[15] = 573792168;
  v6[16] = 574971819;
  v6[17] = 574644186;
  v6[18] = 573267924;
  v6[19] = 575102932;
  v6[20] = 574054360;
  v6[21] = 573726656;
  v6[22] = 573595614;
  v6[23] = 573267930;
  v6[24] = 573988820;
  v6[25] = 573923291;
  v6[26] = 575102912;
  v6[27] = 573857756;
  v6[28] = 573857757;
  v6[29] = 573726681;
  v6[30] = 574906283;
  v6[31] = 574971816;
  v6[32] = 578510810;
  v6[33] = 570843117;
  v4 = 34;
  do
  {
    *v3++ ^= 0x22065FEDu;
    --v4;
  }
  while ( v4 );
  dword_4112C0(v8, 0, 36);
  v8[0] = 36;
  v8[5] = 4;
  return dword_411508(v6, v8, v7, a1);
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 411508: using guessed type int (__stdcall *dword_411508)(_DWORD, _DWORD, _DWORD, _DWORD);
// 409750: using guessed type _DWORD var_34[4];
// 409750: using guessed type _DWORD var_BC[34];

//----- (004098D9) --------------------------------------------------------
int sub_4098D9()
{
  int result; // eax
  _WORD *v1; // esi
  int v2; // eax
  _DWORD *v3; // ebx
  int v4; // esi
  int v5; // eax
  __int16 *v6; // [esp+0h] [ebp-10h]
  wchar_t *v7; // [esp+4h] [ebp-Ch]
  int v8; // [esp+8h] [ebp-8h] BYREF
  int v9; // [esp+Ch] [ebp-4h] BYREF

  v8 = 0;
  result = dword_411500(0);
  if ( result != 1359 )
  {
    v6 = (__int16 *)sub_401647();
    v7 = sub_40163A();
    sub_4095D6();
    sub_409750((int)&v8);
    if ( v8 )
    {
      v1 = sub_407D22(v7, v6);
      v2 = dword_4114F4(v1, &v9);
      v3 = (_DWORD *)v2;
      if ( v9 == 1 )
      {
        v4 = 0;
      }
      else
      {
        v5 = dword_4112E0(v1, *(_DWORD *)(v2 + 4));
        v4 = v5;
        if ( *(_WORD *)(v5 - 2) != 32 )
          v4 = v5 - 2;
      }
      if ( !(*(int (__stdcall **)(int, _DWORD, int, _DWORD, _DWORD, _DWORD))(*(_DWORD *)v8 + 36))(v8, *v3, v4, 0, 0, 0) )
        (*(void (__stdcall **)(int))(*(_DWORD *)v8 + 8))(v8);
      sub_405FB3((int)v3);
    }
    return dword_411504();
  }
  return result;
}
// 4112E0: using guessed type int (__cdecl *dword_4112E0)(_DWORD, _DWORD);
// 4114F4: using guessed type int (__stdcall *dword_4114F4)(_DWORD, _DWORD);
// 411500: using guessed type int (__stdcall *dword_411500)(_DWORD);
// 411504: using guessed type int (*dword_411504)(void);

//----- (0040998D) --------------------------------------------------------
_WORD *__stdcall sub_40998D(int a1)
{
  _WORD *v1; // ebx
  _DWORD *v2; // eax
  int v3; // ecx
  _DWORD v5[7]; // [esp+4h] [ebp-1Ch] BYREF

  v1 = (_WORD *)sub_405F98(42);
  if ( v1 )
  {
    v2 = v5;
    v5[0] = 578117576;
    v5[1] = 575954883;
    v5[2] = 575102888;
    v5[3] = 575365033;
    v5[4] = 573071272;
    v5[5] = 578707353;
    v5[6] = 570843033;
    v3 = 7;
    do
    {
      *v2++ ^= 0x22065FEDu;
      --v3;
    }
    while ( v3 );
    dword_4112F4(v1, v5, dword_410FF4 + 2);
    dword_410FEC = sub_4010BB(v1, -1);
  }
  return v1;
}
// 410FEC: using guessed type int dword_410FEC;
// 410FF4: using guessed type int dword_410FF4;
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 40998D: using guessed type _DWORD var_1C[7];

//----- (00409A17) --------------------------------------------------------
BOOL __stdcall sub_409A17(int a1, int a2, _WORD *a3)
{
  int v4; // [esp+0h] [ebp-4h]

  v4 = 0;
  if ( !a2 && dword_410FF0 == a1 )
    return sub_4010BB(a3, -1) == dword_410FEC;
  return v4;
}
// 410FEC: using guessed type int dword_410FEC;
// 410FF0: using guessed type int dword_410FF0;

//----- (00409A57) --------------------------------------------------------
void __stdcall sub_409A57(int a1, int *a2)
{
  int v2; // [esp+4h] [ebp-4h]

  if ( dword_410FD4 )
  {
    v2 = sub_406035(a1, 22);
    if ( v2 )
    {
      if ( (dword_411370(v2) & 0x10) == 0 )
        dword_411534(v2);
      sub_4016B4(v2);
      dword_4112D8(v2, dword_410FF8);
      if ( !a2 )
      {
        sub_409B34(v2);
        sub_405FB3(v2);
        return;
      }
      if ( !*(_BYTE *)a2 )
        goto LABEL_8;
      if ( dword_411370(*a2) == -1 )
      {
        sub_405FB3(*a2);
LABEL_8:
        sub_409B34(v2);
        *a2 = v2;
        return;
      }
      dword_411380(*a2, v2, 0);
      sub_405FB3(v2);
    }
  }
}
// 410FD4: using guessed type int dword_410FD4;
// 410FF8: using guessed type int dword_410FF8;
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);
// 411380: using guessed type int (__stdcall *dword_411380)(_DWORD, _DWORD, _DWORD);
// 411534: using guessed type int (__stdcall *dword_411534)(_DWORD);

//----- (00409B34) --------------------------------------------------------
int __stdcall sub_409B34(int a1)
{
  int v1; // edi
  char *v2; // esi
  unsigned int v3; // ebx
  char v4; // al
  char *v5; // esi
  int v6; // edi
  char v7; // al
  char *v8; // esi
  int v9; // edi
  unsigned int v10; // ebx
  char v11; // al
  char *v12; // esi
  int v13; // edi
  char v14; // al
  int v16; // [esp+Ch] [ebp-14h] BYREF
  char v17; // [esp+13h] [ebp-Dh] BYREF
  char v18[4]; // [esp+14h] [ebp-Ch] BYREF
  int v19; // [esp+18h] [ebp-8h]
  int v20; // [esp+1Ch] [ebp-4h]

  v20 = 0;
  v19 = dword_411394(a1, 0x40000000, 0, 0, 2, 128, 0);
  if ( v19 != -1 )
  {
    v1 = dword_410FF0;
    v2 = (char *)dword_410FD4;
    v16 = MEMORY[0x412000];
    do
    {
      v3 = sub_401769(MEMORY[0x412000], &v16);
      v4 = *v2;
      v5 = v2 + 1;
      v17 = v3 ^ v4;
      if ( !dword_411398(v19, &v17, 1, v18, 0) )
        break;
      v6 = v1 - 1;
      if ( !v6 )
        break;
      v7 = *v5;
      v8 = v5 + 1;
      v17 = BYTE1(v3) ^ v7;
      if ( !dword_411398(v19, &v17, 1, v18, 0) )
        break;
      v9 = v6 - 1;
      if ( !v9 )
        break;
      v10 = HIWORD(v3);
      v11 = *v8;
      v12 = v8 + 1;
      v17 = v10 ^ v11;
      if ( !dword_411398(v19, &v17, 1, v18, 0) )
        break;
      v13 = v9 - 1;
      if ( !v13 )
        break;
      v14 = *v12;
      v2 = v12 + 1;
      v17 = BYTE1(v10) ^ v14;
      if ( !dword_411398(v19, &v17, 1, v18, 0) )
        break;
      v1 = v13 - 1;
    }
    while ( v1 );
    dword_411354(v19);
    return 1;
  }
  return v20;
}
// 410FD4: using guessed type int dword_410FD4;
// 410FF0: using guessed type int dword_410FF0;
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411394: using guessed type int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411398: using guessed type int (__stdcall *dword_411398)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 409B34: using guessed type int var_14;
// 409B34: using guessed type char var_C[4];

//----- (00409C58) --------------------------------------------------------
int sub_409C58()
{
  int v0; // ebx
  unsigned int v1; // ebx
  int v2; // esi
  int v3; // eax
  int v4; // ebx
  int v5; // esi
  _DWORD *v6; // edi
  int v7; // eax
  _WORD *v8; // edi
  int v9; // eax
  _BYTE *v11; // [esp+Ch] [ebp-28h]
  _BYTE *v12; // [esp+10h] [ebp-24h]
  int v13; // [esp+14h] [ebp-20h]
  unsigned int v14; // [esp+18h] [ebp-1Ch]
  int v15; // [esp+1Ch] [ebp-18h]
  int v16; // [esp+20h] [ebp-14h]
  int v17[2]; // [esp+24h] [ebp-10h] BYREF
  int v18[2]; // [esp+2Ch] [ebp-8h] BYREF

  v16 = 0;
  v12 = 0;
  v11 = 0;
  v15 = 0;
  v0 = sub_408BC9(dword_410FE8, 0, 0);
  if ( v0 )
  {
    v13 = sub_405F98(2 * v0);
    if ( v13 )
    {
      v1 = sub_408BC9(dword_410FE8, v0, v13);
      if ( v1 )
      {
        v12 = sub_4064CC(dword_410888);
        if ( v12 )
        {
          v11 = sub_4064CC(dword_410906);
          if ( v11 )
          {
            v14 = v1 >> 2;
            v2 = (v1 >> 2) * dword_4112D4(v12);
            v15 = sub_405F98(4 * v2);
            if ( v15 )
            {
              v3 = dword_4112D4(v11);
              v16 = sub_405F98(4 * (v3 + v2));
              if ( v16 )
              {
                v4 = 0;
                v5 = v13;
                v6 = (_DWORD *)v15;
                do
                {
                  v7 = sub_40890B(dword_410FE8, v5);
                  if ( v7 == 3 || v7 == 2 || v7 == 4 )
                  {
                    if ( sub_408C89(dword_410FE8, v5, 0, (int)v18, (int)v17) )
                    {
                      if ( v4 )
                      {
                        *v6 = 852012;
                        v8 = v6 + 1;
                        *v8 = 10;
                        v6 = v8 + 1;
                      }
                      else
                      {
                        v4 = 1;
                      }
                      v11 = (_BYTE *)dword_411300(v17[0], v17[1], 0x100000, 0);
                      dword_411300(v18[0], v18[1], 0x100000, 0);
                      *(_WORD *)(v5 + 2) = 0;
                      v6 = (_DWORD *)((char *)v6 + 2 * dword_4112F4(v6, v12, v5));
                      v5 += 8;
                    }
                    else
                    {
                      v5 += 8;
                    }
                  }
                  else
                  {
                    v5 += 8;
                  }
                  --v14;
                }
                while ( v14 );
                v9 = dword_4112F4(v16, v11, v15);
                v16 = sub_405FCE(v16, 2 * v9 + 2);
              }
            }
          }
        }
      }
    }
  }
  if ( v12 )
    sub_405FB3((int)v12);
  if ( v11 )
    sub_405FB3((int)v11);
  if ( v15 )
    sub_405FB3(v15);
  return v16;
}
// 410888: using guessed type _DWORD dword_410888[31];
// 410906: using guessed type _DWORD dword_410906[12];
// 410FE8: using guessed type int dword_410FE8;
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 411300: using guessed type int (__stdcall *dword_411300)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00409E58) --------------------------------------------------------
int sub_409E58()
{
  int v1; // [esp+0h] [ebp-8h]
  int v2; // [esp+4h] [ebp-4h] BYREF

  v2 = 0;
  sub_408856(dword_410FE8, 0, (int)&v2);
  v1 = sub_405F98(2 * v2 + 4);
  if ( v1 && !sub_408856(dword_410FE8, v1, (int)&v2) )
  {
    sub_405FB3(v1);
    return 0;
  }
  return v1;
}
// 410FE8: using guessed type int dword_410FE8;

//----- (00409EC2) --------------------------------------------------------
int sub_409EC2()
{
  int v1; // [esp+0h] [ebp-8h]
  int v2; // [esp+4h] [ebp-4h] BYREF

  v2 = 0;
  dword_4113F4(0, &v2);
  v1 = sub_405F98(2 * v2);
  if ( v1 && !dword_4113F4(v1, &v2) )
  {
    sub_405FB3(v1);
    return 0;
  }
  return v1;
}
// 4113F4: using guessed type int (__stdcall *dword_4113F4)(_DWORD, _DWORD);

//----- (00409F23) --------------------------------------------------------
int sub_409F23()
{
  int *v0; // eax
  int v1; // ecx
  int *v2; // eax
  int v3; // ecx
  int *v4; // eax
  int v5; // ecx
  char v7[520]; // [esp+0h] [ebp-260h] BYREF
  int v8; // [esp+208h] [ebp-58h] BYREF
  int v9; // [esp+20Ch] [ebp-54h]
  int v10; // [esp+210h] [ebp-50h]
  int v11; // [esp+214h] [ebp-4Ch]
  int v12; // [esp+218h] [ebp-48h]
  int v13; // [esp+21Ch] [ebp-44h]
  int v14; // [esp+220h] [ebp-40h]
  int v15; // [esp+224h] [ebp-3Ch]
  int v16; // [esp+228h] [ebp-38h]
  int v17; // [esp+22Ch] [ebp-34h]
  int v18; // [esp+230h] [ebp-30h]
  int v19; // [esp+234h] [ebp-2Ch]
  int v20; // [esp+238h] [ebp-28h]
  int v21; // [esp+23Ch] [ebp-24h]
  char v22[16]; // [esp+240h] [ebp-20h] BYREF
  int v23; // [esp+250h] [ebp-10h] BYREF
  int v24; // [esp+254h] [ebp-Ch] BYREF
  int v25; // [esp+258h] [ebp-8h] BYREF
  int v26; // [esp+25Ch] [ebp-4h]

  v26 = 0;
  v25 = 0;
  if ( sub_406393(dword_410FE8, (int)v7) )
  {
    sub_4016B4((int)v7);
    v0 = &v8;
    v8 = 577331118;
    v9 = 577920899;
    v10 = 577331103;
    v11 = 572940161;
    v12 = 577200061;
    v13 = 576937859;
    v14 = 576348033;
    v15 = 577265572;
    v16 = 576937881;
    v17 = 577265567;
    v18 = 577920908;
    v19 = 577331076;
    v20 = 577200003;
    v21 = 570843009;
    v1 = 14;
    do
    {
      *v0++ ^= 0x22065FEDu;
      --v1;
    }
    while ( v1 );
    dword_4112D8(v7, &v8);
    if ( !dword_41143C(-2147483645, v7, 0, 0, 0, 131353, 0, &v25, 0) )
    {
      v2 = &v8;
      v8 = 577331105;
      v9 = 577200014;
      v10 = 576937857;
      v11 = 577200035;
      v12 = 576937856;
      v13 = 570843117;
      v3 = 6;
      do
      {
        *v2++ ^= 0x22065FEDu;
        --v3;
      }
      while ( v3 );
      v24 = 1;
      v23 = 16;
      if ( !dword_411444(v25, &v8, 0, &v24, v22, &v23) )
        goto LABEL_11;
      v4 = &v8;
      v8 = 575299486;
      v9 = 577265548;
      v10 = 577986442;
      v11 = 576806796;
      v12 = 570843016;
      v5 = 5;
      do
      {
        *v4++ ^= 0x22065FEDu;
        --v5;
      }
      while ( v5 );
      if ( !dword_411444(v25, &v8, 0, &v24, v22, &v23) )
      {
LABEL_11:
        v26 = sub_405F98(v23);
        if ( v26 )
          dword_4112DC(v26, v22);
      }
    }
  }
  if ( v25 )
    dword_411354(v25);
  return v26;
}
// 410FE8: using guessed type int dword_410FE8;
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411444: using guessed type int (__stdcall *dword_411444)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040A110) --------------------------------------------------------
int sub_40A110()
{
  char v1[4]; // [esp+0h] [ebp-8h] BYREF
  int v2; // [esp+4h] [ebp-4h] BYREF

  v2 = 0;
  dword_41156C(0, &v2, v1);
  return v2;
}
// 41156C: using guessed type int (__stdcall *dword_41156C)(_DWORD, _DWORD, _DWORD);
// 40A110: using guessed type char var_8[4];

//----- (0040A134) --------------------------------------------------------
int sub_40A134()
{
  int *v0; // eax
  int v1; // ecx
  int *v2; // eax
  int v3; // ecx
  char v5[128]; // [esp+0h] [ebp-ECh] BYREF
  int v6; // [esp+80h] [ebp-6Ch] BYREF
  int v7; // [esp+84h] [ebp-68h]
  int v8; // [esp+88h] [ebp-64h]
  int v9; // [esp+8Ch] [ebp-60h]
  int v10; // [esp+90h] [ebp-5Ch]
  int v11; // [esp+94h] [ebp-58h]
  int v12; // [esp+98h] [ebp-54h]
  int v13; // [esp+9Ch] [ebp-50h]
  int v14; // [esp+A0h] [ebp-4Ch]
  int v15; // [esp+A4h] [ebp-48h]
  int v16; // [esp+A8h] [ebp-44h]
  int v17; // [esp+ACh] [ebp-40h]
  int v18; // [esp+B0h] [ebp-3Ch]
  int v19; // [esp+B4h] [ebp-38h]
  int v20; // [esp+B8h] [ebp-34h]
  int v21; // [esp+BCh] [ebp-30h]
  int v22; // [esp+C0h] [ebp-2Ch]
  int v23; // [esp+C4h] [ebp-28h]
  int v24; // [esp+C8h] [ebp-24h]
  int v25; // [esp+CCh] [ebp-20h]
  int v26; // [esp+D0h] [ebp-1Ch]
  int v27; // [esp+D4h] [ebp-18h]
  int v28; // [esp+D8h] [ebp-14h]
  int v29; // [esp+DCh] [ebp-10h] BYREF
  int v30; // [esp+E0h] [ebp-Ch] BYREF
  int v31; // [esp+E4h] [ebp-8h] BYREF
  int v32; // [esp+E8h] [ebp-4h]

  v32 = 0;
  v0 = &v6;
  v6 = 575233982;
  v7 = 575823787;
  v8 = 575102906;
  v9 = 574840767;
  v10 = 575365041;
  v11 = 577068932;
  v12 = 577331103;
  v13 = 577331102;
  v14 = 577920907;
  v15 = 575758257;
  v16 = 577265540;
  v17 = 577331081;
  v18 = 578117530;
  v19 = 575168461;
  v20 = 576348089;
  v21 = 577986478;
  v22 = 578051999;
  v23 = 577265544;
  v24 = 575692697;
  v25 = 578051976;
  v26 = 577724318;
  v27 = 577265538;
  v28 = 570843117;
  v1 = 23;
  do
  {
    *v0++ ^= 0x22065FEDu;
    --v1;
  }
  while ( v1 );
  if ( !dword_41143C(-2147483646, &v6, 0, 0, 0, 131353, 0, &v31, 0) )
  {
    v2 = &v6;
    v6 = 578052029;
    v7 = 576872322;
    v8 = 577068952;
    v9 = 575168409;
    v10 = 577462156;
    v11 = 570843016;
    v3 = 6;
    do
    {
      *v2++ ^= 0x22065FEDu;
      --v3;
    }
    while ( v3 );
    dword_4112C0(v5, 0, 128);
    v30 = 1;
    v29 = 128;
    if ( !dword_411444(v31, &v6, 0, &v30, v5, &v29) )
    {
      v32 = sub_405F98(v29);
      if ( v32 )
        dword_4112DC(v32, v5);
    }
    dword_411354(v31);
  }
  return v32;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411444: using guessed type int (__stdcall *dword_411444)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040A2DA) --------------------------------------------------------
_DWORD *sub_40A2DA()
{
  _DWORD *v0; // ebx
  int v2; // [esp+4h] [ebp-4h] BYREF

  v0 = (_DWORD *)sub_405F98(8);
  if ( v0 )
  {
    sub_406531(-1, &v2);
    if ( v2 )
    {
      *v0 = 3539064;
      v0[1] = 52;
    }
    else
    {
      *v0 = 3670136;
      v0[1] = 54;
    }
  }
  return v0;
}

//----- (0040A32A) --------------------------------------------------------
__int16 *sub_40A32A()
{
  int v0; // ebx
  int v1; // ebx
  int v2; // ebx
  int v3; // ebx
  int v4; // ebx
  int v5; // ebx
  int v6; // ebx
  int v7; // eax
  int v8; // ebx
  __int16 *v10; // [esp+Ch] [ebp-24h]
  _BYTE *v11; // [esp+10h] [ebp-20h]
  _DWORD *v12; // [esp+14h] [ebp-1Ch]
  int v13; // [esp+18h] [ebp-18h]
  int v14; // [esp+1Ch] [ebp-14h]
  int v15; // [esp+20h] [ebp-10h]
  int v16; // [esp+24h] [ebp-Ch]
  int v17; // [esp+28h] [ebp-8h]
  int v18; // [esp+2Ch] [ebp-4h]

  v10 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = sub_4064CC(dword_410792);
  if ( v11 )
  {
    v18 = sub_409C58();
    v17 = sub_409E58();
    v16 = sub_409EC2();
    v15 = sub_409F23();
    v14 = sub_40A110();
    v13 = sub_40A134();
    v12 = sub_40A2DA();
    v0 = dword_4112D4(v18);
    v1 = dword_4112D4(v17) + v0;
    v2 = dword_4112D4(v16) + v1;
    v3 = dword_4112D4(v15) + v2;
    v4 = dword_4112D4(v14) + v3;
    v5 = dword_4112D4(v13) + v4;
    v6 = dword_4112D4(v12) + v5;
    v7 = dword_4112D4(v11);
    v10 = (__int16 *)sub_405F98(2 * (v7 + v6) + 2);
    if ( v10 )
    {
      v8 = dword_4112F4(v10, v11, v16);
      sub_4010F1(v10, v10);
      v10 = (__int16 *)sub_405FCE((int)v10, v8 + 1);
    }
  }
  if ( v11 )
    sub_405FB3((int)v11);
  if ( v18 )
    sub_405FB3(v18);
  if ( v17 )
    sub_405FB3(v17);
  if ( v16 )
    sub_405FB3(v16);
  if ( v15 )
    sub_405FB3(v15);
  if ( v14 )
    sub_405FB3(v14);
  if ( v13 )
    sub_405FB3(v13);
  if ( v12 )
    sub_405FB3((int)v12);
  return v10;
}
// 410792: using guessed type _DWORD dword_410792[61];
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);

//----- (0040A502) --------------------------------------------------------
int sub_40A502()
{
  _DWORD *v0; // eax
  int v1; // ecx
  _WORD v3[37]; // [esp+2h] [ebp-CEh] BYREF
  _DWORD v4[5]; // [esp+4Ch] [ebp-84h] BYREF
  char v5[88]; // [esp+60h] [ebp-70h] BYREF
  unsigned int v6; // [esp+B8h] [ebp-18h]
  unsigned int v7; // [esp+BCh] [ebp-14h]
  unsigned int v8; // [esp+C0h] [ebp-10h]
  unsigned int v9; // [esp+C4h] [ebp-Ch]
  int v10; // [esp+C8h] [ebp-8h] BYREF
  int v11; // [esp+CCh] [ebp-4h]

  v11 = 0;
  if ( sub_406245((int)v3) )
  {
    v10 = sub_4010BB(v3, 0);
    dword_4112C0(v5, 0, 104);
    dword_41142C(v5);
    dword_411430(v5, &v10, 4);
    dword_411434(v5);
    v0 = v4;
    v4[0] = 1514041800;
    v4[1] = 1514041800;
    v4[2] = 1514041800;
    v4[3] = 1514041800;
    v4[4] = 570843080;
    v1 = 5;
    do
    {
      *v0++ ^= 0x22065FEDu;
      --v1;
    }
    while ( v1 );
    v11 = sub_405F98(33);
    if ( v11 )
    {
      v6 = _byteswap_ulong(v6);
      v7 = _byteswap_ulong(v7);
      v8 = _byteswap_ulong(v8);
      v9 = _byteswap_ulong(v9);
      dword_4112F8(v11, v4, v6, v7, v8, v9);
    }
  }
  return v11;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 4112F8: using guessed type int (__cdecl *dword_4112F8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41142C: using guessed type int (__stdcall *dword_41142C)(_DWORD);
// 411430: using guessed type int (__stdcall *dword_411430)(_DWORD, _DWORD, _DWORD);
// 411434: using guessed type int (__stdcall *dword_411434)(_DWORD);
// 40A502: using guessed type _WORD var_CE[37];
// 40A502: using guessed type _DWORD var_84[5];

//----- (0040A5FB) --------------------------------------------------------
int __userpurge sub_40A5FB@<eax>(int result@<eax>, unsigned int *a2, int a3)
{
  _WORD *v3; // esi
  int v4; // ebx
  _DWORD *v5; // eax
  int v6; // ecx
  int v7; // eax
  unsigned int v8; // eax
  int v9; // eax
  int v10; // ebx
  int v11; // edi
  _WORD *v12; // eax
  int v13; // ebx
  int v14; // eax
  _WORD v15[128]; // [esp+4h] [ebp-150h] BYREF
  _WORD v16[8]; // [esp+104h] [ebp-50h] BYREF
  _DWORD v17[3]; // [esp+114h] [ebp-40h] BYREF
  _WORD v18[4]; // [esp+120h] [ebp-34h] BYREF
  int v19; // [esp+128h] [ebp-2Ch] BYREF
  int v20; // [esp+12Ch] [ebp-28h] BYREF
  int *v21; // [esp+130h] [ebp-24h]
  int v22; // [esp+134h] [ebp-20h]
  _BYTE *v23; // [esp+138h] [ebp-1Ch]
  int v24; // [esp+13Ch] [ebp-18h]
  int v25; // [esp+140h] [ebp-14h]
  int v26; // [esp+144h] [ebp-10h]
  int v27; // [esp+148h] [ebp-Ch]
  int v28; // [esp+14Ch] [ebp-8h]
  int v29; // [esp+150h] [ebp-4h]

  v25 = 0;
  v21 = 0;
  v22 = 0;
  v24 = 0;
  v23 = 0;
  v26 = 0;
  v29 = 0;
  v28 = 0;
  v27 = 0;
  if ( a2 )
  {
    v3 = (_WORD *)dword_410FCC;
    if ( dword_410FCC )
    {
      result = sub_40565D(dword_410FA0, 0x10u, a2, (a3 + 16) & 0xFFFFFFF0);
      v4 = result;
      if ( result )
      {
        result = sub_405F98(4 * result);
        v21 = (int *)result;
        if ( result )
        {
          sub_4013EE(v4, a2, v4, v21);
          result = (int)sub_40ACC5(dword_410F90, (char *)v21);
          v24 = result;
          if ( result )
          {
            result = (int)sub_40AAE7();
            v22 = result;
            if ( result )
            {
              result = (int)sub_40AC81();
              v25 = result;
              if ( result )
              {
                result = (int)sub_4064CC(dword_410A78);
                v26 = result;
                if ( result )
                {
                  result = dword_4115AC(v25, 0, 0, 0, 0);
                  v29 = result;
                  if ( result )
                  {
                    v5 = v17;
                    v17[0] = 575233981;
                    v17[1] = 575823806;
                    v17[2] = 570843117;
                    v6 = 3;
                    do
                    {
                      *v5++ ^= 0x22065FEDu;
                      --v6;
                    }
                    while ( v6 );
                    result = (int)v18;
                    v18[0] = 58;
                    v18[1] = 47;
                    v18[2] = 47;
                    v18[3] = 0;
                    while ( 1 )
                    {
                      while ( 1 )
                      {
                        while ( 1 )
                        {
                          while ( 1 )
                          {
                            if ( !*v3 )
                              goto LABEL_42;
                            v7 = dword_4112E0(v3, v18);
                            if ( v7 )
                            {
                              v8 = v7 - (_DWORD)v3;
                              qmemcpy(v15, v3, v8);
                              v3 = (_WORD *)((char *)v3 + v8);
                              *(_WORD *)((char *)v15 + v8) = 0;
                              v9 = sub_4010BB(v15, 0);
                              if ( v9 == -341877708 )
                              {
                                v10 = 443;
                                v11 = 0x800000;
                              }
                              else
                              {
                                if ( v9 != -343499520 )
                                  goto LABEL_23;
                                v10 = 80;
                                v11 = 0x400000;
                              }
                              v3 += 3;
                              dword_4112DC(v15, v3);
                              v12 = (_WORD *)dword_4112E8(v15, 47);
                              if ( v12 )
                                *v12 = 0;
                              v28 = dword_4115B0(v29, v15, v10, 0);
                              if ( v28 )
                                break;
                            }
LABEL_23:
                            result = dword_4112D4(v3);
                            v3 += result + 1;
                          }
                          v27 = dword_4115C4(v28, v17, v22, 0, 0, 0, v11, 0);
                          if ( v27 )
                            break;
                          dword_4115BC(v28);
                          v28 = 0;
                          result = dword_4112D4(v3);
                          v3 += result + 1;
                        }
                        if ( v10 != 443 )
                          break;
                        v20 = 0;
                        v19 = 4;
                        if ( dword_4115B8(v27, 31, &v20, &v19) )
                        {
                          v20 |= 0x84603300;
                          if ( dword_4115B4(v27, 31, &v20, 4) )
                            break;
                        }
LABEL_41:
                        dword_4115BC(v28);
                        dword_4115BC(v27);
                        v28 = 0;
                        v27 = 0;
                        result = dword_4112D4(v3);
                        v3 += result + 1;
                      }
                      v13 = dword_4112C8(v24);
                      v14 = dword_4112D4(v26);
                      if ( dword_4115C8(v27, v26, v14, v24, v13, 0, 3) )
                      {
                        v19 = 16;
                        v20 = 0;
                        if ( dword_4115C0(v27, 19, v16) )
                        {
                          if ( v16[0] == 50 && v16[1] == 48 && v16[2] == 48 )
                          {
                            v19 = 0;
                            if ( dword_4115CC(v27, &v19, 0, 0) )
                            {
                              result = sub_405F98(v19 + 1);
                              v23 = (_BYTE *)result;
                              if ( !result )
                                break;
                              if ( dword_4115D0(v27, v23, v19, &v19) )
                              {
                                result = (int)v23;
                                if ( *v23 == 123 && v23[v19 - 1] == 125 )
                                  break;
                              }
                              sub_405FB3((int)v23);
                              v23 = 0;
                            }
                          }
                        }
                        goto LABEL_41;
                      }
                      dword_4115BC(v28);
                      dword_4115BC(v27);
                      v28 = 0;
                      v27 = 0;
                      result = dword_4112D4(v3);
                      v3 += result + 1;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LABEL_42:
  if ( v27 )
    result = dword_4115BC(v27);
  if ( v28 )
    result = dword_4115BC(v28);
  if ( v29 )
    result = dword_4115BC(v29);
  if ( v22 )
    result = sub_405FB3(v22);
  if ( v26 )
    result = sub_405FB3(v26);
  if ( v25 )
    result = sub_405FB3(v25);
  if ( v23 )
    result = sub_405FB3((int)v23);
  if ( v24 )
    result = sub_405FB3(v24);
  if ( v21 )
    return sub_405FB3((int)v21);
  return result;
}
// 40A5FB: could not find valid save-restore pair for edi
// 40A5FB: could not find valid save-restore pair for esi
// 410A78: using guessed type _DWORD dword_410A78[51];
// 410F90: using guessed type unsigned int dword_410F90[4];
// 410FA0: using guessed type unsigned int dword_410FA0[4];
// 410FCC: using guessed type int dword_410FCC;
// 4112C8: using guessed type int (__cdecl *dword_4112C8)(_DWORD);
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 4112E0: using guessed type int (__cdecl *dword_4112E0)(_DWORD, _DWORD);
// 4112E8: using guessed type int (__cdecl *dword_4112E8)(_DWORD, _DWORD);
// 4115AC: using guessed type int (__stdcall *dword_4115AC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4115B0: using guessed type int (__stdcall *dword_4115B0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115B4: using guessed type int (__stdcall *dword_4115B4)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115B8: using guessed type int (__stdcall *dword_4115B8)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115BC: using guessed type int (__stdcall *dword_4115BC)(_DWORD);
// 4115C0: using guessed type int (__stdcall *dword_4115C0)(_DWORD, _DWORD, _DWORD);
// 4115C4: using guessed type int (__stdcall *dword_4115C4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4115C8: using guessed type int (__stdcall *dword_4115C8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4115CC: using guessed type int (__stdcall *dword_4115CC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115D0: using guessed type int (__stdcall *dword_4115D0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 40A5FB: using guessed type _DWORD var_40[3];
// 40A5FB: using guessed type _WORD var_34[4];
// 40A5FB: using guessed type _WORD var_150[128];
// 40A5FB: using guessed type _WORD var_50[8];

//----- (0040AAE7) --------------------------------------------------------
_WORD *sub_40AAE7()
{
  _DWORD *v0; // eax
  int v1; // ecx
  _DWORD *v2; // eax
  int v3; // ecx
  _WORD *v4; // edi
  unsigned int v5; // ebx
  char *v6; // edi
  unsigned int v7; // ebx
  char *v8; // edi
  int v9; // eax
  _WORD *v10; // edi
  _DWORD v12[16]; // [esp+Ch] [ebp-B0h] BYREF
  _DWORD v13[3]; // [esp+4Ch] [ebp-70h] BYREF
  char v14; // [esp+58h] [ebp-64h] BYREF
  char v15[22]; // [esp+9Ah] [ebp-22h] BYREF
  _WORD *v16; // [esp+B0h] [ebp-Ch]
  unsigned int v17; // [esp+B4h] [ebp-8h]
  _WORD *v18; // [esp+B8h] [ebp-4h]

  v18 = 0;
  v0 = v12;
  v12[0] = 1715805612;
  v12[1] = 1782651304;
  v12[2] = 1850545572;
  v12[3] = 1917391264;
  v12[4] = 1985285564;
  v12[5] = 2052131256;
  v12[6] = 1080493492;
  v12[7] = 1147353998;
  v12[8] = 1215248266;
  v12[9] = 1282093958;
  v12[10] = 1349988226;
  v12[11] = 1416833950;
  v12[12] = 1484728218;
  v12[13] = 288648925;
  v12[14] = 355494617;
  v12[15] = 570844885;
  v1 = 16;
  do
  {
    *v0++ ^= 0x22065FEDu;
    --v1;
  }
  while ( v1 );
  v2 = v13;
  v13[0] = 578117576;
  v13[1] = 572743632;
  v13[2] = 570843038;
  v3 = 3;
  do
  {
    *v2++ ^= 0x22065FEDu;
    --v3;
  }
  while ( v3 );
  v17 = sub_401061(1u, 0x14u);
  v18 = (_WORD *)sub_405F98(72 * v17);
  if ( v18 )
  {
    v4 = v18;
    *v18 = 47;
    *++v4 = 63;
    v16 = v4 + 1;
    do
    {
      v5 = sub_401061(3u, 0xAu);
      v6 = v15;
      do
      {
        *(_WORD *)v6 = *((unsigned __int8 *)v12 + sub_401061(0, 0x3Eu));
        v6 += 2;
        --v5;
      }
      while ( v5 );
      *(_WORD *)v6 = 0;
      v7 = sub_401061(3u, 0x14u);
      v8 = &v14;
      do
      {
        *(_WORD *)v8 = *((unsigned __int8 *)v12 + sub_401061(0, 0x3Eu));
        v8 += 2;
        --v7;
      }
      while ( v7 );
      *(_WORD *)v8 = 0;
      v9 = dword_4112F4(v16, v13, v15);
      v16 += v9;
      if ( v17 != 1 )
      {
        v10 = v16;
        *v16 = 38;
        v16 = v10 + 1;
      }
      --v17;
    }
    while ( v17 );
  }
  return v18;
}
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 40AAE7: using guessed type _DWORD var_70[3];

//----- (0040AC81) --------------------------------------------------------
_BYTE *sub_40AC81()
{
  _DWORD *v0; // ebx
  unsigned int v1; // eax
  int i; // ecx

  v0 = &unk_410936;
  v1 = sub_401061(0, 6u);
  for ( i = 0; i != v1; ++i )
    v0 = (_DWORD *)((char *)v0 + *(v0 - 1) + 4);
  return sub_4064CC(v0);
}

//----- (0040ACC5) --------------------------------------------------------
_BYTE *__stdcall sub_40ACC5(unsigned int *a1, char *a2)
{
  _DWORD *v2; // eax
  int v3; // ecx
  _DWORD *v4; // eax
  int v5; // ecx
  _DWORD *v6; // eax
  int v7; // ecx
  unsigned int v8; // eax
  unsigned int v9; // ebx
  int v10; // eax
  int v11; // eax
  unsigned int v12; // ebx
  char *v13; // edi
  char *v14; // edi
  unsigned int v15; // ebx
  char *v16; // edi
  int v17; // eax
  _BYTE *v18; // edi
  int v20; // [esp+0h] [ebp-C0h]
  int v21; // [esp+4h] [ebp-BCh]
  _DWORD v22[16]; // [esp+Ch] [ebp-B4h] BYREF
  _DWORD v23[5]; // [esp+4Ch] [ebp-74h] BYREF
  _DWORD v24[2]; // [esp+60h] [ebp-60h] BYREF
  char v25[33]; // [esp+6Bh] [ebp-55h] BYREF
  char v26[32]; // [esp+8Ch] [ebp-34h] BYREF
  _BYTE *v27; // [esp+ACh] [ebp-14h]
  unsigned int v28; // [esp+B0h] [ebp-10h]
  unsigned int v29; // [esp+B4h] [ebp-Ch]
  unsigned int v30; // [esp+B8h] [ebp-8h]
  _BYTE *v31; // [esp+BCh] [ebp-4h]

  v31 = 0;
  v2 = v24;
  v24[0] = 121318600;
  v24[1] = 570843038;
  v3 = 2;
  do
  {
    *v2++ ^= 0x22065FEDu;
    --v3;
  }
  while ( v3 );
  v4 = v23;
  v23[0] = 1514041800;
  v23[1] = 1514041800;
  v23[2] = 1514041800;
  v23[3] = 1514041800;
  v23[4] = 570843080;
  v5 = 5;
  do
  {
    *v4++ ^= 0x22065FEDu;
    --v5;
  }
  while ( v5 );
  v6 = v22;
  v22[0] = 1715805612;
  v22[1] = 1782651304;
  v22[2] = 1850545572;
  v22[3] = 1917391264;
  v22[4] = 1985285564;
  v22[5] = 2052131256;
  v22[6] = 1080493492;
  v22[7] = 1147353998;
  v22[8] = 1215248266;
  v22[9] = 1282093958;
  v22[10] = 1349988226;
  v22[11] = 1416833950;
  v22[12] = 1484728218;
  v22[13] = 288648925;
  v22[14] = 355494617;
  v22[15] = 570844885;
  v7 = 16;
  do
  {
    *v6++ ^= 0x22065FEDu;
    --v7;
  }
  while ( v7 );
  v30 = sub_401061(5u, 0x14u);
  do
  {
    v29 = sub_401061(1u, v30);
    v8 = sub_401061(1u, v30);
  }
  while ( v29 == v8 );
  v28 = v8;
  v9 = 35 * v30;
  v10 = dword_4112C8(a2);
  v11 = sub_405F98(v10 + v9 + 34);
  v31 = (_BYTE *)v11;
  if ( v11 )
  {
    v27 = v31;
    do
    {
      v12 = sub_401061(3u, 0xAu);
      v13 = v26;
      do
      {
        *v13++ = *((_BYTE *)v22 + sub_401061(0, 0x3Eu));
        --v12;
      }
      while ( v12 );
      *v13 = 0;
      if ( v29 == v30 )
      {
        v14 = v25;
        dword_4112F8(
          v25,
          v23,
          _byteswap_ulong(*a1),
          _byteswap_ulong(a1[1]),
          _byteswap_ulong(a1[2]),
          _byteswap_ulong(a1[3]));
      }
      else if ( v28 == v30 )
      {
        v14 = a2;
      }
      else
      {
        v15 = sub_401061(3u, 0x14u);
        v16 = v25;
        do
        {
          *v16++ = *((_BYTE *)v22 + sub_401061(0, 0x3Eu));
          --v15;
        }
        while ( v15 );
        *v16 = 0;
        v14 = v25;
      }
      v17 = dword_4112F8(v27, v24, v26, v14, v20, v21);
      v27 += v17;
      if ( v30 != 1 )
      {
        v18 = v27;
        *v27 = 38;
        v27 = v18 + 1;
      }
      --v30;
    }
    while ( v30 );
  }
  return v31;
}
// 40AEBA: variable 'v20' is possibly undefined
// 40AEBA: variable 'v21' is possibly undefined
// 4112C8: using guessed type int (__cdecl *dword_4112C8)(_DWORD);
// 4112F8: using guessed type int (__cdecl *dword_4112F8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 40ACC5: using guessed type _DWORD var_60[2];
// 40ACC5: using guessed type _DWORD var_74[5];

//----- (0040AEEE) --------------------------------------------------------
unsigned int *__usercall sub_40AEEE@<eax>(int a1@<edi>, int a2@<esi>)
{
  unsigned int *result; // eax
  _DWORD *v3; // eax
  int v4; // ecx
  int v5; // ebx
  int v6; // ebx
  int v7; // ebx
  int v8; // eax
  int v9; // eax
  char v10[16]; // [esp+4h] [ebp-28h] BYREF
  _DWORD v11[2]; // [esp+14h] [ebp-18h] BYREF
  unsigned int *v12; // [esp+1Ch] [ebp-10h]
  unsigned int *v13; // [esp+20h] [ebp-Ch]
  unsigned int *v14; // [esp+24h] [ebp-8h]
  unsigned int *v15; // [esp+28h] [ebp-4h]

  v14 = 0;
  v13 = 0;
  v12 = 0;
  result = (unsigned int *)sub_40A32A();
  v15 = result;
  if ( result )
  {
    result = (unsigned int *)sub_40A502();
    v14 = result;
    if ( result )
    {
      v3 = v11;
      v11[0] = 120072904;
      v11[1] = 570843032;
      v4 = 2;
      do
      {
        *v3++ ^= 0x22065FEDu;
        --v4;
      }
      while ( v4 );
      dword_4112F8(v10, v11, 1, 2, a1, a2);
      result = (unsigned int *)sub_4064CC(dword_410B44);
      v13 = result;
      if ( result )
      {
        v5 = dword_4112C8(v13);
        v6 = dword_4112C8(v10) + v5;
        v7 = dword_4112C8(v15) + v6;
        v8 = dword_4112C8(v14);
        result = (unsigned int *)sub_405F98(v8 + v7 + 260);
        v12 = result;
        if ( result )
        {
          v9 = dword_4112F8(v12, v13, v10, v14, _byteswap_ulong(dword_410F90[0]), _byteswap_ulong(dword_410F90[1]));
          result = (unsigned int *)sub_40A5FB(v9, v12, v9);
        }
      }
    }
  }
  if ( v14 )
    result = (unsigned int *)sub_405FB3((int)v14);
  if ( v15 )
    result = (unsigned int *)sub_405FB3((int)v15);
  if ( v13 )
    result = (unsigned int *)sub_405FB3((int)v13);
  if ( v12 )
    return (unsigned int *)sub_405FB3((int)v12);
  return result;
}
// 40AEEE: could not find valid save-restore pair for edi
// 40AEEE: could not find valid save-restore pair for esi
// 410B44: using guessed type _DWORD dword_410B44[21];
// 410F90: using guessed type unsigned int dword_410F90[4];
// 4112C8: using guessed type int (__cdecl *dword_4112C8)(_DWORD);
// 4112F8: using guessed type int (__cdecl *dword_4112F8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 40AEEE: using guessed type _DWORD var_18[2];

//----- (0040B06A) --------------------------------------------------------
unsigned int *__userpurge sub_40B06A@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  unsigned int *result; // eax
  _DWORD *v7; // eax
  int v8; // ecx
  int v9; // ebx
  int v10; // eax
  __int64 v11; // rax
  int v12; // eax
  char v13[32]; // [esp+4h] [ebp-44h] BYREF
  char v14[16]; // [esp+24h] [ebp-24h] BYREF
  _DWORD v15[2]; // [esp+34h] [ebp-14h] BYREF
  unsigned int *v16; // [esp+3Ch] [ebp-Ch]
  unsigned int *v17; // [esp+40h] [ebp-8h]
  unsigned int *v18; // [esp+44h] [ebp-4h]

  v17 = 0;
  v16 = 0;
  result = (unsigned int *)sub_40A502();
  v18 = result;
  if ( result )
  {
    v7 = v15;
    v15[0] = 120072904;
    v15[1] = 570843032;
    v8 = 2;
    do
    {
      *v7++ ^= 0x22065FEDu;
      --v8;
    }
    while ( v8 );
    dword_4112F8(v14, v15, 1, 2, a2, a3);
    result = (unsigned int *)sub_4064CC(dword_410B9A);
    v17 = result;
    if ( result )
    {
      v9 = dword_4112C8(v17) + a1;
      v10 = dword_4112C8(v18);
      result = (unsigned int *)sub_405F98(v10 + v9 + 260);
      v16 = result;
      if ( result )
      {
        v11 = dword_411300(dword_411004, dword_411008, 0x100000, 0);
        dword_4112FC(v11, HIDWORD(v11), v13, 10);
        v12 = dword_4112F8(v16, v17, v14, v18, _byteswap_ulong(dword_410F90[0]), _byteswap_ulong(dword_410F90[1]));
        result = (unsigned int *)sub_40A5FB(v12, v16, v12);
      }
    }
  }
  if ( v18 )
    result = (unsigned int *)sub_405FB3((int)v18);
  if ( v17 )
    result = (unsigned int *)sub_405FB3((int)v17);
  if ( v16 )
    return (unsigned int *)sub_405FB3((int)v16);
  return result;
}
// 40B06A: could not find valid save-restore pair for edi
// 40B06A: could not find valid save-restore pair for esi
// 410B9A: using guessed type _DWORD dword_410B9A[53];
// 410F90: using guessed type unsigned int dword_410F90[4];
// 411000: using guessed type int dword_411000;
// 411004: using guessed type int dword_411004;
// 411008: using guessed type int dword_411008;
// 41100C: using guessed type int dword_41100C;
// 4112C8: using guessed type int (__cdecl *dword_4112C8)(_DWORD);
// 4112F8: using guessed type int (__cdecl *dword_4112F8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4112FC: using guessed type int (__cdecl *dword_4112FC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411300: using guessed type __int64 (__stdcall *dword_411300)(_DWORD, _DWORD, _DWORD, _DWORD);
// 40B06A: using guessed type _DWORD var_14[2];
// 40B06A: using guessed type char var_44[32];

//----- (0040B203) --------------------------------------------------------
int __stdcall sub_40B203(int a1)
{
  char v2[28]; // [esp+0h] [ebp-28h] BYREF
  int v3; // [esp+1Ch] [ebp-Ch]
  int v4; // [esp+20h] [ebp-8h]
  int v5; // [esp+24h] [ebp-4h]

  v5 = 0;
  v4 = dword_411450(0, 0, 4);
  if ( v4 )
  {
    v3 = dword_411458(v4, a1, 65568);
    if ( v3 )
    {
      dword_4112C0(v2, 0, 28);
      dword_41145C(v3, 1, v2);
      dword_411460(v3);
      dword_411464(v3);
      v5 = 1;
    }
  }
  if ( v4 )
    dword_411464(v4);
  return v5;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 411450: using guessed type int (__stdcall *dword_411450)(_DWORD, _DWORD, _DWORD);
// 411458: using guessed type int (__stdcall *dword_411458)(_DWORD, _DWORD, _DWORD);
// 41145C: using guessed type int (__stdcall *dword_41145C)(_DWORD, _DWORD, _DWORD);
// 411460: using guessed type int (__stdcall *dword_411460)(_DWORD);
// 411464: using guessed type int (__stdcall *dword_411464)(_DWORD);

//----- (0040B297) --------------------------------------------------------
int __stdcall sub_40B297(int a1)
{
  _DWORD v2[6]; // [esp+0h] [ebp-28h] BYREF
  int v3[2]; // [esp+18h] [ebp-10h] BYREF
  int v4; // [esp+20h] [ebp-8h] BYREF
  int v5; // [esp+24h] [ebp-4h]

  v5 = 0;
  v3[0] = a1;
  v3[1] = 0;
  v2[0] = 24;
  memset(&v2[1], 0, 20);
  if ( !dword_411304(&v4, 1, v2, v3) )
  {
    dword_41134C(v4, 0);
    dword_411354(v4);
    return 1;
  }
  return v5;
}
// 411304: using guessed type int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41134C: using guessed type int (__stdcall *dword_41134C)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 40B297: using guessed type _DWORD var_28[6];

//----- (0040B319) --------------------------------------------------------
int __stdcall sub_40B319(char a1)
{
  int v1; // eax
  int v2; // ebx
  int *v3; // esi
  int v4; // eax
  int v5; // eax
  char v7[80]; // [esp+8h] [ebp-68h] BYREF
  int v8; // [esp+58h] [ebp-18h] BYREF
  int v9; // [esp+5Ch] [ebp-14h] BYREF
  int v10; // [esp+60h] [ebp-10h] BYREF
  int *v11; // [esp+64h] [ebp-Ch]
  int v12; // [esp+68h] [ebp-8h] BYREF
  int v13; // [esp+6Ch] [ebp-4h]

  v13 = 0;
  v11 = 0;
  v12 = 570843117;
  dword_4112C0(v7, 0, 80);
  if ( !dword_411558(&v12, 0, v7) )
  {
    if ( !dword_41155C(v12, 1, &a1, 0, 0, 0, 0) )
    {
      v9 = 0;
      v8 = 0;
      v10 = 1;
      v11 = (int *)sub_405F98(668);
      if ( v11 )
      {
        do
        {
          v1 = dword_411560(v12, &v9, &v10, v11, &v8);
          if ( v1 != 234 )
            break;
          v10 = v9;
          v1 = sub_405FCE((int)v11, 668 * v9);
          v11 = (int *)v1;
        }
        while ( v1 );
        if ( !v1 )
        {
          v2 = v9;
          if ( v9 )
          {
            v3 = v11;
            do
            {
              v4 = v3[163];
              if ( v4 == 1000 || v4 == 4 )
                break;
              v5 = v4 == 3 ? sub_40B203((int)(v3 + 131)) : sub_40B297(*v3);
              v13 += v5;
              v3 += 167;
              --v2;
            }
            while ( v2 );
          }
        }
      }
    }
    dword_411564(v12);
  }
  if ( v11 )
    sub_405FB3((int)v11);
  return v13;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 411558: using guessed type int (__stdcall *dword_411558)(_DWORD, _DWORD, _DWORD);
// 41155C: using guessed type int (__stdcall *dword_41155C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411560: using guessed type int (__stdcall *dword_411560)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411564: using guessed type int (__stdcall *dword_411564)(_DWORD);

//----- (0040B46A) --------------------------------------------------------
int __stdcall sub_40B46A(char a1)
{
  int v1; // ebx

  v1 = 0;
  if ( (unsigned int)sub_40155E() > 0x3C )
    v1 = sub_40B319(a1);
  if ( v1 )
    dword_4113A4(100);
  return v1;
}
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);

//----- (0040B497) --------------------------------------------------------
int sub_40B497()
{
  int v0; // eax
  int result; // eax
  int v2; // ebx
  int v3; // eax
  int v4; // edx
  __int64 v5; // rax
  char v6[4]; // [esp+0h] [ebp-Ch] BYREF
  unsigned int v7; // [esp+4h] [ebp-8h] BYREF
  int v8; // [esp+8h] [ebp-4h] BYREF

  v0 = dword_4113FC();
  dword_411400(v0, 2);
  while ( 1 )
  {
    while ( 1 )
    {
      result = dword_4113B8(dword_4115E0, &v7, v6, &v8, -1);
      v2 = v8;
      if ( result || __readfsdword(0x34u) != 38 )
        break;
      *(_DWORD *)(v8 + 40) = 2;
      while ( !dword_4113BC(dword_4115E0, 0, 0, v2) )
        ;
    }
    if ( !v8 )
      return result;
    while ( 1 )
    {
      v3 = *(_DWORD *)(v2 + 40);
      switch ( v3 )
      {
        case 0:
          v4 = *(_DWORD *)(v2 + 24);
          *(_DWORD *)(v2 + 8) = *(_DWORD *)(v2 + 20);
          *(_DWORD *)(v2 + 12) = v4;
          *(_DWORD *)(v2 + 40) = 1;
          if ( !dword_41139C(*(_DWORD *)(v2 + 36), v2 + 244, *(_DWORD *)(v2 + 240), &v7, v2)
            && __readfsdword(0x34u) != 997 )
          {
            if ( __readfsdword(0x34u) == 38 )
            {
              *(_DWORD *)(v2 + 40) = 2;
              dword_4113BC(dword_4115E0, 0, 0, v2);
            }
            else
            {
              do
                dword_4113A4(100);
              while ( !dword_41139C(*(_DWORD *)(v2 + 36), v2 + 244, *(_DWORD *)(v2 + 240), &v7, v2)
                   && __readfsdword(0x34u) != 997 );
            }
          }
          goto LABEL_35;
        case 1:
          sub_40207C(v2 + 244, v7, (__m128i *)(v2 + 244), v2 + 44);
          v5 = *(_QWORD *)(v2 + 28);
          if ( v5 )
          {
            *(_QWORD *)(v2 + 20) += v5;
            *(_DWORD *)(v2 + 40) = 0;
          }
          else
          {
            *(_DWORD *)(v2 + 40) = 2;
          }
          while ( !dword_411398(*(_DWORD *)(v2 + 36), v2 + 244, v7, &v7, v2) && __readfsdword(0x34u) != 997 )
            dword_4113A4(100);
          goto LABEL_35;
        case 2:
          *(_DWORD *)(v2 + 8) = -1;
          *(_DWORD *)(v2 + 12) = -1;
          *(_DWORD *)(v2 + 40) = 3;
          while ( !dword_411398(*(_DWORD *)(v2 + 36), v2 + 108, 132, &v7, v2) && __readfsdword(0x34u) != 997 )
            dword_4113A4(100);
          goto LABEL_35;
      }
      if ( v3 == 3 )
        break;
LABEL_35:
      while ( 1 )
      {
        result = dword_4113B8(dword_4115E0, &v7, v6, &v8, -1);
        v2 = v8;
        if ( result )
          break;
        if ( __readfsdword(0x34u) == 38 )
        {
          *(_DWORD *)(v8 + 40) = 2;
          while ( !dword_4113BC(dword_4115E0, 0, 0, v2) )
            ;
        }
      }
      if ( !v8 )
        return result;
    }
    while ( *(_DWORD *)v2 == 259 )
      dword_4113A4(1);
    dword_411354(*(_DWORD *)(v2 + 36));
    sub_405FB3(v2);
    dword_4113C0(&dword_4115E8);
  }
}
// 40B497: could not find valid save-restore pair for ebx
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411398: using guessed type int (__stdcall *dword_411398)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41139C: using guessed type int (__stdcall *dword_41139C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);
// 4113B8: using guessed type int (__stdcall *dword_4113B8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113BC: using guessed type int (__stdcall *dword_4113BC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4113C0: using guessed type int (__stdcall *dword_4113C0)(_DWORD);
// 4113FC: using guessed type int (*dword_4113FC)(void);
// 411400: using guessed type int (__stdcall *dword_411400)(_DWORD, _DWORD);
// 4115E0: using guessed type int dword_4115E0;
// 4115E8: using guessed type int dword_4115E8;
// 40B497: using guessed type char var_C[4];

//----- (0040B790) --------------------------------------------------------
int sub_40B790()
{
  unsigned int NumberOfProcessors; // ebx
  int v1; // ebx
  int v2; // eax
  int v3; // esi
  int v5; // [esp+8h] [ebp-4h]

  NumberOfProcessors = NtCurrentPeb()->NumberOfProcessors;
  if ( (NumberOfProcessors & 0x20) != 0 )
    NumberOfProcessors = 32;
  v1 = 2 * NumberOfProcessors + 1;
  v5 = 0;
  dword_4115E0 = dword_4113B4(-1, 0, 0, v1);
  if ( dword_4115E0 )
  {
    do
    {
      v2 = dword_411388(0, 0, sub_40B497, 0, 0, 0);
      v3 = v2;
      if ( v2 )
      {
        sub_4092E1(v2);
        dword_411354(v3);
        ++v5;
      }
      --v1;
    }
    while ( v1 );
  }
  return v5;
}
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113B4: using guessed type int (__stdcall *dword_4113B4)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115E0: using guessed type int dword_4115E0;

//----- (0040B80E) --------------------------------------------------------
int __stdcall sub_40B80E(int a1)
{
  int v1; // ebx
  int result; // eax

  v1 = a1;
  if ( a1 )
  {
    do
    {
      result = dword_4113BC(dword_4115E0, 0, 0, 0);
      --v1;
    }
    while ( v1 );
    if ( dword_4115E0 )
      return dword_411354(dword_4115E0);
  }
  return result;
}
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 4113BC: using guessed type int (__stdcall *dword_4113BC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115E0: using guessed type int dword_4115E0;

//----- (0040B84A) --------------------------------------------------------
_DWORD *__userpurge sub_40B84A@<eax>(_DWORD *a1@<ebx>, unsigned __int8 *a2, unsigned int a3)
{
  int v3; // eax
  int v4; // eax

  if ( a3 )
  {
    if ( a2 )
    {
      a1 = (_DWORD *)sub_405F98(4);
      if ( a1 )
      {
        v3 = sub_401116(a2, a3, 0xD6917Au);
        v4 = sub_401116(a2, a3, _byteswap_ulong(v3));
        *a1 = _byteswap_ulong(sub_401116(a2, a3, _byteswap_ulong(v4)));
      }
    }
  }
  return a1;
}

//----- (0040B8AE) --------------------------------------------------------
int __stdcall sub_40B8AE(int a1, int a2)
{
  int v2; // esi
  _WORD *v3; // eax
  _WORD *v4; // edi
  int v5; // ebx
  char v7[22]; // [esp+Eh] [ebp-26h] BYREF
  _DWORD v8[2]; // [esp+24h] [ebp-10h] BYREF
  int v9; // [esp+2Ch] [ebp-8h]
  int v10; // [esp+30h] [ebp-4h]

  v10 = 0;
  v9 = 0;
  v8[0] = 2424877;
  v8[1] = 117;
  do
  {
    if ( v9 )
    {
      sub_405FB3(v9);
      v9 = 0;
    }
    v2 = dword_4112F4(v7, v8, v10);
    v9 = sub_406035(a1, 2 * v2 + 22);
    if ( !v9 )
      break;
    v3 = (_WORD *)dword_41151C(v9);
    v4 = v3;
    if ( *v3 )
    {
      v5 = dword_4112D4(v3);
      dword_4112C4(&v4[v2], v4, 2 * v5 + 2);
      dword_4112BC(v4, v7, 2 * v2);
    }
    else
    {
      dword_4112D8(v9, v7);
    }
    dword_4112D8(v9, a2);
    ++v10;
  }
  while ( dword_411370(v9) != -1 );
  return v9;
}
// 4112BC: using guessed type int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD);
// 4112C4: using guessed type int (__cdecl *dword_4112C4)(_DWORD, _DWORD, _DWORD);
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);
// 41151C: using guessed type int (__stdcall *dword_41151C)(_DWORD);
// 40B8AE: using guessed type _DWORD var_10[2];

//----- (0040B9B6) --------------------------------------------------------
int __stdcall sub_40B9B6(int a1)
{
  int v2; // [esp+4h] [ebp-Ch]
  int v3; // [esp+8h] [ebp-8h]
  int v4; // [esp+Ch] [ebp-4h]

  v3 = 0;
  v4 = 0;
  while ( 1 )
  {
    dword_41136C(a1, 128);
    v2 = dword_411394(a1, 0x40000000, 0, 0, 3, 0, 0);
    if ( v2 != -1 )
      break;
    if ( __readfsdword(0x34u) == 32 )
    {
      if ( !sub_40B46A(a1) )
        goto LABEL_12;
    }
    else
    {
      if ( __readfsdword(0x34u) != 5 || v4 )
        goto LABEL_12;
      sub_4067F0(a1);
      v4 = 1;
    }
  }
  v3 = 1;
LABEL_12:
  if ( v2 != -1 )
    dword_411354(v2);
  return v3;
}
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41136C: using guessed type int (__stdcall *dword_41136C)(_DWORD, _DWORD);
// 411394: using guessed type int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040BA64) --------------------------------------------------------
int __userpurge sub_40BA64@<eax>(_DWORD *a1@<ebx>, int a2)
{
  _DWORD *v2; // ebx
  int v4; // [esp+4h] [ebp-90h] BYREF
  unsigned __int8 v5[128]; // [esp+8h] [ebp-8Ch] BYREF
  char v6[4]; // [esp+88h] [ebp-Ch] BYREF
  int v7; // [esp+8Ch] [ebp-8h]
  int v8; // [esp+90h] [ebp-4h]

  v8 = 0;
  dword_41136C(a2, 128);
  v7 = dword_411394(a2, 0x80000000, 0, 0, 3, 0, 0);
  if ( v7 != -1 )
  {
    if ( dword_4113A8(v7, -132, -1, 0, 2) )
    {
      if ( dword_41139C(v7, &v4, 132, v6, 0) )
      {
        v2 = sub_40B84A(a1, v5, 0x80u);
        if ( v2 )
        {
          if ( *v2 == v4 )
            v8 = 1;
          sub_405FB3((int)v2);
        }
      }
    }
    dword_411354(v7);
  }
  return v8;
}
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41136C: using guessed type int (__stdcall *dword_41136C)(_DWORD, _DWORD);
// 411394: using guessed type int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41139C: using guessed type int (__stdcall *dword_41139C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113A8: using guessed type int (__stdcall *dword_4113A8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 40BA64: using guessed type char var_C[4];
// 40BA64: using guessed type unsigned __int8 var_8C[128];

//----- (0040BB23) --------------------------------------------------------
int __stdcall sub_40BB23(unsigned __int64 a1)
{
  int v1; // ebx
  int v2; // edx
  _DWORD *v3; // ebx
  int v5; // [esp+8h] [ebp-4h]

  if ( a1 >= 0x100000 )
    v1 = 0x100000;
  else
    v1 = a1;
  v5 = sub_405F98(v1 + 244);
  if ( v5 )
  {
    *(_DWORD *)(v5 + 240) = v1;
    if ( byte_410FB0 )
      *(_DWORD *)(v5 + 28) = 2 * v1;
    else
      *(_DWORD *)(v5 + 28) = 0;
    *(_DWORD *)(v5 + 32) = 0;
    v2 = *(_DWORD *)(v5 + 32);
    *(_DWORD *)(v5 + 120) = *(_DWORD *)(v5 + 28);
    *(_DWORD *)(v5 + 124) = v2;
    *(_QWORD *)(v5 + 112) = a1;
    sub_4056AB((int *)(v5 + 44));
    dword_4112BC(v5 + 128, v5 + 44, 64);
    sub_401787(v5 + 112, dword_410F10);
    v3 = sub_40B84A((_DWORD *)v1, (unsigned __int8 *)(v5 + 112), 0x80u);
    if ( v3 )
    {
      *(_DWORD *)(v5 + 108) = *v3;
      sub_405FB3((int)v3);
    }
  }
  return v5;
}
// 410F10: using guessed type _DWORD dword_410F10[32];
// 410FB0: using guessed type char byte_410FB0;
// 4112BC: using guessed type int (__cdecl *dword_4112BC)(_DWORD, _DWORD, _DWORD);

//----- (0040BC06) --------------------------------------------------------
int __userpurge sub_40BC06@<eax>(_DWORD *a1@<ebx>, int a2, unsigned __int64 a3)
{
  int v3; // ebx
  int v5; // [esp+4h] [ebp-Ch]
  int v6; // [esp+8h] [ebp-8h]
  int v7; // [esp+Ch] [ebp-4h]

  v7 = 0;
  if ( a2 )
  {
    if ( sub_40B9B6(a2) )
    {
      if ( !sub_40BA64(a1, a2) )
      {
        v5 = sub_406035(a2, 20);
        if ( v5 )
        {
          dword_4112D8(v5, dword_410FF4);
          while ( !dword_411384(a2, v5, 8) )
          {
            if ( __readfsdword(0x34u) == 183 )
            {
              sub_405FB3(v5);
              v5 = sub_40B8AE(a2, dword_410FF4);
              if ( v5 )
                continue;
            }
            goto LABEL_18;
          }
          v6 = dword_411394(v5, -1073741824, 0, 0, 3, 1207959552, 0);
          if ( v6 != -1 )
          {
            v3 = sub_40BB23(a3);
            if ( v3 )
            {
              if ( dword_4113B4(v6, dword_4115E0, 0, 0)
                && (*(_DWORD *)(v3 + 36) = v6, *(_DWORD *)(v3 + 40) = 0, dword_4113BC(dword_4115E0, 0, 0, v3)) )
              {
                dword_4113C0(&dword_4115E4);
                v7 = 1;
              }
              else
              {
                sub_405FB3(v3);
                dword_411354(v6);
              }
            }
            else
            {
              sub_405FB3(0);
              dword_411354(v6);
            }
          }
LABEL_18:
          sub_405FB3(v5);
        }
      }
    }
    sub_405FB3(a2);
  }
  return v7;
}
// 410FF4: using guessed type int dword_410FF4;
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411384: using guessed type int (__stdcall *dword_411384)(_DWORD, _DWORD, _DWORD);
// 411394: using guessed type int (__stdcall *dword_411394)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113B4: using guessed type int (__stdcall *dword_4113B4)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4113BC: using guessed type int (__stdcall *dword_4113BC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4113C0: using guessed type int (__stdcall *dword_4113C0)(_DWORD);
// 4115E0: using guessed type int dword_4115E0;
// 4115E4: using guessed type int dword_4115E4;

//----- (0040BD96) --------------------------------------------------------
int __stdcall sub_40BD96(int a1)
{
  int v1; // ebx
  int v2; // eax
  int v3; // esi
  _DWORD *v4; // eax
  int v6; // [esp+8h] [ebp-4h]

  v6 = 0;
  v1 = dword_4112D4(a1);
  if ( v1 )
  {
    v2 = sub_405F98(2 * v1 + 8);
    v3 = v2;
    if ( v2 )
    {
      dword_4112DC(v2, a1);
      v4 = (_DWORD *)(v3 + 2 * v1);
      if ( *((_WORD *)v4 - 1) == 92 )
        v4 = (_DWORD *)((char *)v4 - 2);
      *v4 = 2752604;
      return v3;
    }
  }
  return v6;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);

//----- (0040BDF8) --------------------------------------------------------
int __stdcall sub_40BDF8(int a1, int a2)
{
  int v2; // ebx
  int v3; // eax
  int v4; // esi

  v2 = dword_4112D4(a1);
  v3 = dword_4112D4(a2);
  v4 = sub_405F98(2 * (v3 + v2) + 2);
  dword_4112DC(v4, a1);
  dword_4112D8(v4, a2);
  return v4;
}
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);

//----- (0040BE4A) --------------------------------------------------------
int __stdcall sub_40BE4A(_WORD *a1)
{
  int v1; // ebx
  int *v2; // esi
  int v3; // eax
  _WORD *v4; // eax
  int v5; // ebx
  int *v6; // esi
  int v7; // eax
  int v9; // [esp+8h] [ebp-4h]

  v9 = 0;
  if ( dword_410FBC )
  {
    v1 = sub_4010BB(a1, 0);
    v2 = (int *)dword_410FBC;
    while ( 1 )
    {
      v3 = *v2++;
      if ( !v3 )
        break;
      if ( v1 == v3 )
      {
        v9 = 1;
        break;
      }
    }
  }
  if ( !v9 )
  {
    if ( dword_410FC0 )
    {
      v4 = (_WORD *)dword_41151C(a1);
      if ( *v4 )
      {
        v5 = sub_4010BB(v4 + 1, 0);
        v6 = (int *)dword_410FC0;
        while ( 1 )
        {
          v7 = *v6++;
          if ( !v7 )
            break;
          if ( v5 == v7 )
            return 1;
        }
      }
    }
  }
  return v9;
}
// 410FBC: using guessed type int dword_410FBC;
// 410FC0: using guessed type int dword_410FC0;
// 41151C: using guessed type int (__stdcall *dword_41151C)(_DWORD);

//----- (0040BEE0) --------------------------------------------------------
int __stdcall sub_40BEE0(_WORD *a1)
{
  int v1; // ebx
  int *v2; // esi
  int v3; // eax
  int v5; // [esp+8h] [ebp-4h]

  v5 = 0;
  if ( dword_410FB8 )
  {
    v1 = sub_4010BB(a1, 0);
    v2 = (int *)dword_410FB8;
    while ( 1 )
    {
      v3 = *v2++;
      if ( !v3 )
        break;
      if ( v1 == v3 || v1 == -482186025 )
        return 1;
    }
  }
  return v5;
}
// 410FB8: using guessed type int dword_410FB8;

//----- (0040BF33) --------------------------------------------------------
int __userpurge sub_40BF33@<eax>(_DWORD *a1@<ebx>, int a2)
{
  int v3; // eax
  int v4; // esi
  int v5; // esi
  int v6; // eax
  int *v13; // eax
  int v14; // ecx
  _WORD v15[14]; // [esp+0h] [ebp-270h] BYREF
  unsigned int v16; // [esp+1Ch] [ebp-254h]
  unsigned int v17; // [esp+20h] [ebp-250h]
  _DWORD v18[137]; // [esp+2Ch] [ebp-244h] BYREF
  unsigned __int64 v19; // [esp+250h] [ebp-20h] BYREF
  int v20; // [esp+258h] [ebp-18h]
  int v21; // [esp+25Ch] [ebp-14h]
  int v22; // [esp+260h] [ebp-10h]
  int i; // [esp+264h] [ebp-Ch]
  int v24; // [esp+268h] [ebp-8h]
  int v25; // [esp+26Ch] [ebp-4h]

  if ( (dword_411370(a2) & 0x10) != 0 )
  {
    v3 = dword_4113FC();
    dword_411400(v3, 2);
    if ( (unsigned int)sub_40155E() <= 0x3C )
      v24 = 0;
    else
      v24 = 2;
    v20 = sub_405F98(4000000);
    v21 = a2;
    for ( i = -1; ; --i )
    {
      sub_409A57(v21, &dword_410FFC);
      v22 = sub_40BD96(v21);
      sub_405FB3(v21);
      v25 = dword_411374(v22, 0, v15, 0, 0, v24);
      if ( v25 != -1 )
      {
        *(_WORD *)dword_4112E8(v22, 42) = 0;
        do
        {
          if ( v18[0] != 46 && v18[0] != 3014702 && (v15[0] & 0x400) == 0 && (v15[0] & 4) == 0 )
          {
            if ( (v15[0] & 0x10) != 0 )
            {
              if ( !sub_40BEE0(v18) )
              {
                v4 = sub_40BDF8(v22, (int)v18);
                ++i;
                *(_DWORD *)(v20 + 4 * i) = v4;
              }
            }
            else if ( !sub_40BE4A(v18) && (v16 || v17) && !sub_409A17(v17, v16, v18) )
            {
              v5 = sub_40BDF8(v22, (int)v18);
              sub_4067F0(v5);
              v6 = sub_40BC06(v18, v5, __PAIR64__(v16, v17));
              if ( byte_410FB7 )
              {
                if ( v6 )
                {
                  dword_4113C0(&dword_411000);
                  _EDX = v16;
                  _InterlockedAdd(&dword_411004, v17);
                  __asm { lock adc dword_411008, edx }
                }
                else
                {
                  dword_4113C0(&dword_41100C);
                }
              }
            }
          }
        }
        while ( dword_411378(v25, v15) );
        dword_41137C(v25);
      }
      sub_405FB3(v22);
      v22 = 0;
      if ( i == -1 )
        break;
      v13 = (int *)(v20 + 4 * i);
      v14 = *v13;
      *v13 = 0;
      v21 = v14;
    }
    return sub_405FB3(v20);
  }
  else
  {
    sub_4067F0(a2);
    if ( sub_4087E7(a2, &v19) )
    {
      if ( v19 )
      {
        sub_409A57(a2, 0);
        sub_40BC06(a1, a2, v19);
      }
    }
    return sub_405FB3(a2);
  }
}
// 410FB7: using guessed type char byte_410FB7;
// 410FFC: using guessed type int dword_410FFC;
// 411000: using guessed type int dword_411000;
// 411004: using guessed type int dword_411004;
// 41100C: using guessed type int dword_41100C;
// 4112E8: using guessed type int (__cdecl *dword_4112E8)(_DWORD, _DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);
// 411374: using guessed type int (__stdcall *dword_411374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411378: using guessed type int (__stdcall *dword_411378)(_DWORD, _DWORD);
// 41137C: using guessed type int (__stdcall *dword_41137C)(_DWORD);
// 4113C0: using guessed type int (__stdcall *dword_4113C0)(_DWORD);
// 4113FC: using guessed type int (*dword_4113FC)(void);
// 411400: using guessed type int (__stdcall *dword_411400)(_DWORD, _DWORD);
// 40BF33: using guessed type _WORD var_270[14];
// 40BF33: using guessed type _DWORD var_244[137];

//----- (0040C190) --------------------------------------------------------
int __stdcall sub_40C190(_DWORD *a1)
{
  return dword_411570(*a1, a1[1], a1[2], a1[3], a1[4], a1[5], a1[6]);
}
// 411570: using guessed type int (__stdcall *dword_411570)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040C1B4) --------------------------------------------------------
int __stdcall sub_40C1B4(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9)
{
  int v10[7]; // [esp+4h] [ebp-24h] BYREF
  int v11; // [esp+20h] [ebp-8h] BYREF
  int v12; // [esp+24h] [ebp-4h]

  v11 = -1;
  v12 = 0;
  v10[0] = a2;
  v10[1] = a3;
  v10[2] = a4;
  v10[3] = a5;
  v10[4] = a6;
  v10[5] = a7;
  v10[6] = a8;
  v12 = dword_411388(0, 0, sub_40C190, v10, 4, 0);
  if ( v12 )
  {
    if ( a1 && !sub_408766(a1, v12) )
    {
      dword_411350(v12, 0);
      dword_411354(v12);
      return v11;
    }
    dword_411390(v12);
    dword_4113AC(v12, -1);
    dword_4113C4(v12, &v11);
    dword_411354(v12);
  }
  return v11;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (0040C286) --------------------------------------------------------
int __stdcall sub_40C286(_WORD *a1)
{
  int v1; // ebx
  int v2; // eax

  v1 = 0;
  v2 = sub_4010BB(a1, 0);
  if ( v2 == -726996046 || v2 == 18880704 )
    return 1;
  return v1;
}

//----- (0040C2B4) --------------------------------------------------------
int __stdcall sub_40C2B4(int a1)
{
  int v1; // eax
  int v2; // eax
  int v4; // [esp+0h] [ebp-4h]

  v4 = 0;
  v1 = dword_411370(a1);
  if ( v1 != -1 )
  {
    v2 = dword_41136C(a1, v1);
    if ( v2 )
      return v2;
  }
  return v4;
}
// 41136C: using guessed type int (__stdcall *dword_41136C)(_DWORD, _DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);

//----- (0040C2E9) --------------------------------------------------------
int __stdcall sub_40C2E9(int a1, int a2)
{
  int v3; // [esp+4h] [ebp-8h] BYREF
  int v4; // [esp+8h] [ebp-4h]

  v3 = 0;
  v4 = dword_411388(0, 0, sub_40C2B4, a2, 4, 0);
  if ( v4 )
  {
    if ( a1 && !sub_408766(a1, v4) )
    {
      dword_411350(v4, 0);
      dword_411354(v4);
      return v3;
    }
    dword_411390(v4);
    dword_4113AC(v4, -1);
    dword_4113C4(v4, &v3);
    dword_411354(v4);
  }
  return v3;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113C4: using guessed type int (__stdcall *dword_4113C4)(_DWORD, _DWORD);

//----- (0040C43B) --------------------------------------------------------
int __userpurge sub_40C43B@<eax>(char *a1@<edx>, int *a2@<ecx>, int a3@<edi>, int a4@<esi>, int *a5)
{
  int *v5; // eax
  int v6; // ecx
  int v8; // eax
  int v9; // ebx
  int v10; // eax
  int v11; // esi
  _DWORD *v12; // eax
  int v13; // ecx
  _DWORD *v14; // eax
  int v15; // ecx
  int *v16; // eax
  int v17; // ecx
  int *v18; // eax
  int v19; // ecx
  int *v20; // eax
  int v21; // ecx
  int *v22; // eax
  int v23; // ecx
  int *v24; // eax
  int v25; // ecx
  int v26; // eax
  int v27; // esi
  int v30; // [esp-Ch] [ebp-2BCh]
  char v33[520]; // [esp+4h] [ebp-2ACh] BYREF
  _DWORD v34[4]; // [esp+20Ch] [ebp-A4h] BYREF
  _DWORD v35[4]; // [esp+21Ch] [ebp-94h] BYREF
  int v36; // [esp+22Ch] [ebp-84h] BYREF
  int v37; // [esp+230h] [ebp-80h]
  int v38; // [esp+234h] [ebp-7Ch]
  int v39; // [esp+238h] [ebp-78h] BYREF
  int v40; // [esp+23Ch] [ebp-74h]
  int v41; // [esp+240h] [ebp-70h]
  int v42; // [esp+244h] [ebp-6Ch]
  int v43; // [esp+248h] [ebp-68h]
  int v44; // [esp+24Ch] [ebp-64h]
  int v45; // [esp+250h] [ebp-60h]
  int v46; // [esp+254h] [ebp-5Ch]
  int v47; // [esp+258h] [ebp-58h]
  int v48; // [esp+25Ch] [ebp-54h]
  int v49; // [esp+260h] [ebp-50h]
  char v50[8]; // [esp+264h] [ebp-4Ch] BYREF
  int v51; // [esp+26Ch] [ebp-44h]
  char v52[8]; // [esp+274h] [ebp-3Ch] BYREF
  int v53; // [esp+27Ch] [ebp-34h]
  int v54; // [esp+284h] [ebp-2Ch] BYREF
  int v55; // [esp+28Ch] [ebp-24h] BYREF
  int v56; // [esp+294h] [ebp-1Ch] BYREF
  int v57; // [esp+29Ch] [ebp-14h]
  int v58; // [esp+2A0h] [ebp-10h] BYREF
  int v59; // [esp+2A4h] [ebp-Ch] BYREF
  int v60; // [esp+2A8h] [ebp-8h] BYREF
  int v61; // [esp+2ACh] [ebp-4h]

  v30 = a4;
  v61 = 0;
  v59 = 0;
  v58 = 0;
  v57 = 0;
  if ( !dword_411500(0) )
  {
    if ( !dword_411584(0, 0, 0, 0, 0, &v54) )
    {
      v5 = &v36;
      v36 = 576348081;
      v37 = 578117576;
      v38 = 570843057;
      v6 = 3;
      do
      {
        *v5++ ^= 0x22065FEDu;
        --v6;
      }
      while ( v6 );
      if ( !dword_411588(*(_DWORD *)(v54 + 28), 2, 0, 0, 0, 0, &v60, a3, a4, a1, a2) )
      {
        do
        {
          while ( 1 )
          {
            v8 = dword_41158C(v60, 0, 0, &v55);
            if ( v8 )
              break;
            v9 = v55;
            v10 = dword_4112D4(v55);
            v11 = sub_405F98(2 * v10 + 8);
            if ( v11 )
            {
              dword_4112F4(v11, &v36, v9);
              *a5++ = v11;
              sub_405FB3(v9);
              ++v61;
            }
          }
        }
        while ( v8 == 1101 );
      }
      dword_411590(v60);
      dword_411580(v54);
      v12 = v35;
      v35[0] = -544995011;
      v35[1] = 868786936;
      v35[2] = 1107598150;
      v35[3] = 1903411553;
      v13 = 4;
      do
      {
        *v12++ ^= 0x22065FEDu;
        --v13;
      }
      while ( v13 );
      v14 = v34;
      v34[0] = 571484221;
      v34[1] = 868786939;
      v34[2] = 1107598150;
      v34[3] = 1903411553;
      v15 = 4;
      do
      {
        *v14++ ^= 0x22065FEDu;
        --v15;
      }
      while ( v15 );
      v16 = &v39;
      v39 = 574775201;
      v40 = 576085932;
      v41 = 573136855;
      v42 = 578052034;
      v43 = 577331074;
      v44 = 574775193;
      v45 = 574840766;
      v46 = 570843117;
      v17 = 8;
      do
      {
        *v16++ ^= 0x22065FEDu;
        --v17;
      }
      while ( v17 );
      a2 = &v59;
      a1 = (char *)v35;
      v30 = 1;
      a3 = 0;
      if ( !dword_411598(&v39, 0) )
      {
        dword_411544(v52);
        dword_411544(v50);
        v18 = &v39;
        v39 = 576937865;
        v40 = 577200011;
        v41 = 577396632;
        v42 = 575168409;
        v43 = 577462156;
        v44 = 577265540;
        v45 = 574971786;
        v46 = 577265538;
        v47 = 576937881;
        v48 = 577920917;
        v49 = 570843117;
        v19 = 11;
        do
        {
          *v18++ ^= 0x22065FEDu;
          --v19;
        }
        while ( v19 );
        a1 = v52;
        v30 = (int)&v39;
        a3 = v59;
        if ( !(*(int (**)(void))(*(_DWORD *)v59 + 60))() )
        {
          v20 = &v39;
          v39 = 574775201;
          v40 = 576085932;
          v41 = 573136855;
          v42 = 574971842;
          v43 = 574316451;
          v44 = 577331118;
          v45 = 578183040;
          v46 = 577920920;
          v47 = 578051976;
          v48 = 573202334;
          v49 = 570843117;
          v21 = 11;
          do
          {
            *v20++ ^= 0x22065FEDu;
            --v21;
          }
          while ( v21 );
          dword_4112DC(v33, &v39);
          dword_4112D8(v33, v53);
          if ( !dword_411598(v33, 0) && !dword_41159C(v57, &v58) )
          {
            v22 = &v39;
            v39 = 575168393;
            v40 = 575561662;
            v41 = 578117506;
            v42 = 575168409;
            v43 = 577462156;
            v44 = 570843016;
            v23 = 6;
            do
            {
              *v22++ ^= 0x22065FEDu;
              --v23;
            }
            while ( v23 );
            v24 = &v36;
            v36 = 576348081;
            v37 = 578117576;
            v38 = 570843057;
            v25 = 3;
            do
            {
              *v24++ ^= 0x22065FEDu;
              --v25;
            }
            while ( v25 );
            while ( 1 )
            {
              v56 = 0;
              dword_411548(v52);
              dword_411548(v50);
              if ( dword_4115A0(v58, 1, v52, &v56)
                || !v56
                || (*(int (__stdcall **)(int, int *, char *))(*(_DWORD *)v53 + 60))(v53, &v39, v50) )
              {
                break;
              }
              v26 = dword_4112D4(v51);
              v27 = sub_405F98(2 * v26 + 8);
              if ( v27 )
              {
                dword_4112F4(v27, &v36, v51);
                *a5++ = v27;
                ++v61;
              }
            }
          }
        }
      }
      if ( v58 )
        dword_4115A4(v58);
      if ( v57 )
        (*(void (__stdcall **)(int))(*(_DWORD *)v57 + 8))(v57);
      if ( v59 )
        (*(void (__stdcall **)(int))(*(_DWORD *)v59 + 8))(v59);
    }
    ((void (__cdecl *)(int, int, char *, int *))dword_411504)(a3, v30, a1, a2);
  }
  return v61;
}
// 40C43B: could not find valid save-restore pair for edi
// 40C43B: could not find valid save-restore pair for esi
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112DC: using guessed type int (__cdecl *dword_4112DC)(_DWORD, _DWORD);
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 411500: using guessed type int (__stdcall *dword_411500)(_DWORD);
// 411504: using guessed type int (__cdecl *dword_411504)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411544: using guessed type int (__stdcall *dword_411544)(_DWORD);
// 411548: using guessed type int (__stdcall *dword_411548)(_DWORD);
// 411580: using guessed type int (__stdcall *dword_411580)(_DWORD);
// 411584: using guessed type int (__stdcall *dword_411584)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411588: using guessed type int (__stdcall *dword_411588)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41158C: using guessed type int (__stdcall *dword_41158C)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411590: using guessed type int (__stdcall *dword_411590)(_DWORD);
// 411598: using guessed type int (__stdcall *dword_411598)(_DWORD, _DWORD);
// 41159C: using guessed type int (__stdcall *dword_41159C)(_DWORD, _DWORD);
// 4115A0: using guessed type int (__stdcall *dword_4115A0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115A4: using guessed type int (__stdcall *dword_4115A4)(_DWORD);
// 40C43B: using guessed type _DWORD var_94[4];
// 40C43B: using guessed type _DWORD var_A4[4];

//----- (0040C8C1) --------------------------------------------------------
int *__usercall sub_40C8C1@<eax>(int a1@<edi>, int a2@<esi>)
{
  int *result; // eax
  char *v3; // edx
  int *v4; // ecx
  _DWORD **v5; // esi
  _DWORD *v6; // eax
  int v7; // eax
  int *v8; // ebx
  int v9; // eax
  int v10; // ecx
  int v11; // ebx
  int *v12; // esi
  _DWORD *v13; // edi
  int v14; // eax
  int v15; // ebx
  int *v16; // esi
  int v17; // eax
  int *v18; // [esp+4h] [ebp-3Ch]
  int v19; // [esp+8h] [ebp-38h]
  int v20; // [esp+Ch] [ebp-34h]
  int v21; // [esp+10h] [ebp-30h]
  int v22; // [esp+14h] [ebp-2Ch]
  int v23; // [esp+18h] [ebp-28h] BYREF
  char v24[4]; // [esp+1Ch] [ebp-24h] BYREF
  int v25; // [esp+20h] [ebp-20h] BYREF
  _DWORD *v26; // [esp+24h] [ebp-1Ch]
  _DWORD *v27; // [esp+28h] [ebp-18h]
  int *v28; // [esp+2Ch] [ebp-14h] BYREF
  int v29; // [esp+30h] [ebp-10h]
  int v30; // [esp+34h] [ebp-Ch]
  int v31; // [esp+38h] [ebp-8h]
  int v32; // [esp+3Ch] [ebp-4h]

  v26 = 0;
  v21 = 0;
  v20 = 0;
  v22 = sub_40153E();
  result = (int *)sub_405F98(4096);
  v19 = (int)result;
  if ( !result )
    goto LABEL_49;
  result = (int *)sub_40C43B(v3, v4, a1, a2, result);
  v18 = result;
  if ( !result )
    goto LABEL_49;
  result = (int *)sub_405F98(4 * v22);
  v21 = (int)result;
  if ( !result )
    goto LABEL_49;
  result = (int *)sub_405F98(4 * v22);
  v20 = (int)result;
  if ( !result )
    goto LABEL_49;
  dword_4115E4 = 0;
  dword_4115E8 = 0;
  v32 = 0;
  v31 = 0;
  v5 = (_DWORD **)v19;
  do
  {
    v6 = *v5++;
    v27 = v6;
    v23 = 0;
    v7 = sub_40C1B4(0, (int)v6, 1, (int)&v28, -1, (int)&v25, (int)v24, (int)&v23, 100);
    if ( v7 )
    {
      v7 = sub_40C1B4(dword_410FE8, (int)v27, 1, (int)&v28, -1, (int)&v25, (int)v24, (int)&v23, 100);
      if ( v7 )
        v7 = sub_40C1B4(dword_410FE4, (int)v27, 1, (int)&v28, -1, (int)&v25, (int)v24, (int)&v23, 100);
    }
    if ( !v7 )
    {
      v8 = v28;
      while ( 1 )
      {
        if ( v8[1] && v8[1] != 0x80000000 )
          goto LABEL_33;
        if ( v8[1] == 0x80000000 && sub_40C286((_WORD *)*v8) )
        {
          v8 += 3;
          --v25;
        }
        else
        {
          v26 = sub_4060DF(v27, *v8);
          if ( !v26 )
            goto LABEL_33;
          if ( sub_40C2E9(0, (int)v26) )
          {
            v30 = 0;
          }
          else if ( sub_40C2E9(dword_410FE8, (int)v26) )
          {
            v30 = dword_410FE8;
          }
          else
          {
            if ( !sub_40C2E9(dword_410FE4, (int)v26) )
              goto LABEL_23;
            v30 = dword_410FE4;
          }
          v9 = dword_411388(0, 0, sub_40BF33, v26, 4, 0);
          v29 = v9;
          if ( !v9 )
          {
LABEL_23:
            sub_405FB3((int)v26);
            v8 += 3;
            --v25;
            goto LABEL_34;
          }
          if ( v30 )
            v9 = sub_408766(v30, v29);
          if ( v9 )
          {
            dword_411390(v29);
            *(_DWORD *)(v21 + 4 * v32++) = v29;
            if ( ++v31 == v22 )
            {
              v32 = dword_4113B0(v31, v21, 0, -1);
              v10 = *(_DWORD *)(v21 + 4 * v32);
              *(_DWORD *)(v21 + 4 * v32) = 0;
              dword_411354(v10);
              --v31;
            }
LABEL_33:
            v8 += 3;
            --v25;
            goto LABEL_34;
          }
          dword_411350(v29, 0);
          dword_411354(v29);
          sub_405FB3((int)v26);
          v8 += 3;
          --v25;
        }
LABEL_34:
        if ( !v25 )
        {
          if ( v28 )
            sub_405FB3((int)v28);
          if ( v27 )
            sub_405FB3((int)v27);
          break;
        }
      }
    }
    v18 = (int *)((char *)v18 - 1);
  }
  while ( v18 );
  if ( v31 )
  {
    v11 = v31;
    v12 = (int *)v21;
    v13 = (_DWORD *)v20;
    do
    {
      v14 = *v12++;
      if ( v14 )
      {
        *v13++ = v14;
        --v11;
      }
    }
    while ( v11 );
    dword_4113B0(v31, v20, 1, -1);
    v15 = v31;
    v16 = (int *)v20;
    do
    {
      v17 = *v16++;
      dword_411354(v17);
      --v15;
    }
    while ( v15 );
  }
  while ( 1 )
  {
    result = (int *)dword_4115E4;
    if ( dword_4115E4 == dword_4115E8 )
      break;
    dword_4113A4(100);
  }
LABEL_49:
  if ( v19 )
    result = (int *)sub_405FB3(v19);
  if ( v21 )
    result = (int *)sub_405FB3(v21);
  if ( v20 )
    return (int *)sub_405FB3(v20);
  return result;
}
// 40C90B: variable 'v3' is possibly undefined
// 40C90B: variable 'v4' is possibly undefined
// 410FE4: using guessed type int dword_410FE4;
// 410FE8: using guessed type int dword_410FE8;
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);
// 4113B0: using guessed type int (__stdcall *dword_4113B0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115E4: using guessed type int dword_4115E4;
// 4115E8: using guessed type int dword_4115E8;
// 40C8C1: using guessed type char var_24[4];

//----- (0040CC27) --------------------------------------------------------
int __stdcall sub_40CC27(_DWORD *a1)
{
  int result; // eax
  int *v2; // ebx
  int v3; // eax
  int v4; // ecx
  int v5; // ebx
  int *v6; // esi
  _DWORD *v7; // edi
  int v8; // eax
  int v9; // ebx
  int *v10; // esi
  int v11; // eax
  int v12; // [esp+0h] [ebp-34h]
  int v13; // [esp+4h] [ebp-30h]
  int v14; // [esp+8h] [ebp-2Ch]
  int v15; // [esp+Ch] [ebp-28h]
  int v16; // [esp+10h] [ebp-24h] BYREF
  char v17[4]; // [esp+14h] [ebp-20h] BYREF
  int v18; // [esp+18h] [ebp-1Ch] BYREF
  _DWORD *v19; // [esp+1Ch] [ebp-18h]
  int *v20; // [esp+20h] [ebp-14h] BYREF
  int v21; // [esp+24h] [ebp-10h]
  int v22; // [esp+28h] [ebp-Ch]
  int v23; // [esp+2Ch] [ebp-8h]
  int v24; // [esp+30h] [ebp-4h]

  v19 = 0;
  v13 = 0;
  v12 = 0;
  v24 = 0;
  v23 = 0;
  v16 = 0;
  v22 = 0;
  result = sub_40C1B4(0, (int)a1, 1, (int)&v20, -1, (int)&v18, (int)v17, (int)&v16, 100);
  if ( result )
  {
    result = sub_40C1B4(dword_410FE8, (int)a1, 1, (int)&v20, -1, (int)&v18, (int)v17, (int)&v16, 100);
    if ( result )
      result = sub_40C1B4(dword_410FE4, (int)a1, 1, (int)&v20, -1, (int)&v18, (int)v17, (int)&v16, 100);
  }
  if ( !result )
  {
    v15 = sub_40153E();
    result = sub_405F98(4 * v15);
    v13 = result;
    if ( result )
    {
      result = sub_405F98(4 * v15);
      v12 = result;
      if ( result )
      {
        v14 = sub_40B790();
        dword_4115E4 = 0;
        dword_4115E8 = 0;
        v2 = v20;
        while ( 1 )
        {
          if ( v2[1] && v2[1] != 0x80000000 )
            goto LABEL_30;
          if ( v2[1] == 0x80000000 && sub_40C286((_WORD *)*v2) )
          {
            v2 += 3;
            --v18;
          }
          else
          {
            v19 = sub_4060DF(a1, *v2);
            if ( !v19 )
              goto LABEL_30;
            if ( sub_40C2E9(0, (int)v19) )
            {
              v22 = 0;
            }
            else if ( sub_40C2E9(dword_410FE8, (int)v19) )
            {
              v22 = dword_410FE8;
            }
            else
            {
              if ( !sub_40C2E9(dword_410FE4, (int)v19) )
                goto LABEL_20;
              v22 = dword_410FE4;
            }
            v3 = dword_411388(0, 0, sub_40BF33, v19, 4, 0);
            v21 = v3;
            if ( !v3 )
            {
LABEL_20:
              sub_405FB3((int)v19);
              v2 += 3;
              --v18;
              goto LABEL_31;
            }
            if ( v22 )
              v3 = sub_408766(v22, v21);
            if ( v3 )
            {
              dword_411390(v21);
              *(_DWORD *)(v13 + 4 * v24++) = v21;
              if ( ++v23 == v15 )
              {
                v24 = dword_4113B0(v23, v13, 0, -1);
                v4 = *(_DWORD *)(v13 + 4 * v24);
                *(_DWORD *)(v13 + 4 * v24) = 0;
                dword_411354(v4);
                --v23;
              }
LABEL_30:
              v2 += 3;
              --v18;
              goto LABEL_31;
            }
            dword_411350(v21, 0);
            dword_411354(v21);
            sub_405FB3((int)v19);
            v2 += 3;
            --v18;
          }
LABEL_31:
          if ( !v18 )
          {
            if ( v20 )
              sub_405FB3((int)v20);
            if ( v23 )
            {
              v5 = v23;
              v6 = (int *)v13;
              v7 = (_DWORD *)v12;
              do
              {
                v8 = *v6++;
                if ( v8 )
                {
                  *v7++ = v8;
                  --v5;
                }
              }
              while ( v5 );
              dword_4113B0(v23, v12, 1, -1);
              v9 = v23;
              v10 = (int *)v12;
              do
              {
                v11 = *v10++;
                dword_411354(v11);
                --v9;
              }
              while ( v9 );
            }
            while ( 1 )
            {
              result = dword_4115E4;
              if ( dword_4115E4 == dword_4115E8 )
                break;
              dword_4113A4(100);
            }
            if ( v14 )
              result = sub_40B80E(v14);
            break;
          }
        }
      }
    }
  }
  if ( a1 )
    result = sub_405FB3((int)a1);
  if ( v13 )
    result = sub_405FB3(v13);
  if ( v12 )
    return sub_405FB3(v12);
  return result;
}
// 410FE4: using guessed type int dword_410FE4;
// 410FE8: using guessed type int dword_410FE8;
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);
// 4113B0: using guessed type int (__stdcall *dword_4113B0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115E4: using guessed type int dword_4115E4;
// 4115E8: using guessed type int dword_4115E8;
// 40CC27: using guessed type char var_20[4];

//----- (0040CF4C) --------------------------------------------------------
int __stdcall sub_40CF4C(int a1, int a2)
{
  int result; // eax
  int v3; // [esp+4h] [ebp-8h]
  int v4; // [esp+8h] [ebp-4h]

  v3 = sub_40B790();
  dword_4115E4 = 0;
  dword_4115E8 = 0;
  result = dword_411388(0, 0, sub_40BF33, a2, 4, 0);
  v4 = result;
  if ( result )
  {
    if ( a1 && !sub_408766(a1, result) )
    {
      dword_411350(v4, 0);
      return dword_411354(v4);
    }
    dword_411390(v4);
    dword_4113AC(v4, -1);
    while ( dword_4115E4 != dword_4115E8 )
      dword_4113A4(100);
    result = dword_411354(v4);
  }
  if ( v3 )
    return sub_40B80E(v3);
  return result;
}
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4115E4: using guessed type int dword_4115E4;
// 4115E8: using guessed type int dword_4115E8;

//----- (0040D009) --------------------------------------------------------
unsigned int sub_40D009()
{
  unsigned int result; // eax
  int v1; // ebx
  unsigned int v2; // ebx
  int v3; // esi
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  int v7; // ebx
  int *v8; // esi
  _DWORD *v9; // edi
  int v10; // eax
  int v11; // ebx
  int *v12; // esi
  int v13; // eax
  int v14; // [esp+4h] [ebp-20h]
  int v15; // [esp+8h] [ebp-1Ch]
  int v16; // [esp+Ch] [ebp-18h]
  int v17; // [esp+10h] [ebp-14h]
  _DWORD *v18; // [esp+14h] [ebp-10h]
  _DWORD *v19; // [esp+14h] [ebp-10h]
  int v20; // [esp+18h] [ebp-Ch]
  int v21; // [esp+1Ch] [ebp-8h]
  int v22; // [esp+20h] [ebp-4h]

  v17 = 0;
  v14 = sub_40153E();
  result = sub_408BC9(dword_410FE8, 0, 0);
  v1 = result;
  if ( !result )
    goto LABEL_28;
  result = sub_405F98(2 * result);
  v17 = result;
  if ( !result )
    goto LABEL_28;
  result = sub_408BC9(dword_410FE8, v1, result);
  if ( !result )
    goto LABEL_28;
  v2 = result >> 2;
  result = sub_405F98(4 * (result >> 2));
  v16 = result;
  if ( !result )
    goto LABEL_28;
  result = sub_405F98(4 * v2);
  v15 = result;
  if ( !result )
    goto LABEL_28;
  dword_4115E4 = 0;
  dword_4115E8 = 0;
  v21 = 0;
  v20 = 0;
  v3 = v17;
  do
  {
    v4 = sub_40890B(dword_410FE8, v3);
    if ( v4 == 3 || v4 == 2 )
    {
      v18 = sub_406083(v3);
      v5 = dword_411388(0, 0, sub_40BF33, v18, 0, 0);
      if ( !v5 )
        goto LABEL_18;
    }
    else
    {
      if ( v4 != 4 )
        goto LABEL_18;
      v19 = sub_406083(v3);
      v22 = dword_411388(0, 0, sub_40BF33, v19, 4, 0);
      if ( !v22 )
        goto LABEL_18;
      if ( !sub_408766(dword_410FE8, v22) )
      {
        dword_411350(v22, 0);
        dword_411354(v22);
        goto LABEL_18;
      }
      dword_411390(v22);
      v5 = v22;
    }
    *(_DWORD *)(v16 + 4 * v21++) = v5;
    if ( ++v20 == v14 )
    {
      v21 = dword_4113B0(v20, v16, 0, -1);
      v6 = *(_DWORD *)(v16 + 4 * v21);
      *(_DWORD *)(v16 + 4 * v21) = 0;
      dword_411354(v6);
      --v20;
    }
LABEL_18:
    v3 += 8;
    --v2;
  }
  while ( v2 );
  if ( v20 )
  {
    v7 = v20;
    v8 = (int *)v16;
    v9 = (_DWORD *)v15;
    do
    {
      v10 = *v8++;
      if ( v10 )
      {
        *v9++ = v10;
        --v7;
      }
    }
    while ( v7 );
    dword_4113B0(v20, v15, 1, -1);
    v11 = v20;
    v12 = (int *)v15;
    do
    {
      v13 = *v12++;
      dword_411354(v13);
      --v11;
    }
    while ( v11 );
  }
  while ( 1 )
  {
    result = dword_4115E4;
    if ( dword_4115E4 == dword_4115E8 )
      break;
    dword_4113A4(100);
  }
LABEL_28:
  if ( v15 )
    result = sub_405FB3(v15);
  if ( v16 )
    result = sub_405FB3(v16);
  if ( v17 )
    return sub_405FB3(v17);
  return result;
}
// 40D215: variable 'v15' is possibly undefined
// 40D223: variable 'v16' is possibly undefined
// 410FE8: using guessed type int dword_410FE8;
// 411350: using guessed type int (__stdcall *dword_411350)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411390: using guessed type int (__stdcall *dword_411390)(_DWORD);
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);
// 4113B0: using guessed type int (__stdcall *dword_4113B0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4115E4: using guessed type int dword_4115E4;
// 4115E8: using guessed type int dword_4115E8;

//----- (0040D244) --------------------------------------------------------
char *sub_40D244()
{
  char *result; // eax

  if ( !sub_40930C() && (unsigned int)sub_40155E() > 0x3C && sub_40931A(0) )
  {
    sub_4098D9();
    dword_41134C(-1, 0);
  }
  result = (char *)sub_406438();
  dword_410FF4 = (int)result;
  if ( result )
  {
    dword_410FF8 = (int)sub_40998D(dword_410FF4);
    sub_409524();
    if ( sub_409494() )
    {
      dword_410FE8 = sub_408058();
      sub_406812();
    }
    else
    {
      dword_410FE8 = sub_408731();
      if ( !dword_410FE8 && sub_40930C() )
        dword_410FE8 = sub_4082BF();
    }
    result = sub_406568();
    if ( byte_410FB1 )
    {
      result = (char *)sub_4085C8();
      dword_410FE4 = (int)result;
      if ( result )
      {
        result = (char *)sub_4093D7(dword_410FE4);
        if ( result )
        {
          result = (char *)sub_40930C();
          if ( !result )
          {
            sub_405FB3(dword_410FD8);
            sub_405FB3(dword_410FDC);
            sub_405FB3(dword_410FE0);
            result = (char *)dword_411354(dword_410FE4);
            dword_410FE4 = 0;
          }
        }
      }
    }
  }
  return result;
}
// 410FB1: using guessed type char byte_410FB1;
// 410FD8: using guessed type int dword_410FD8;
// 410FDC: using guessed type int dword_410FDC;
// 410FE0: using guessed type int dword_410FE0;
// 410FE4: using guessed type int dword_410FE4;
// 410FE8: using guessed type int dword_410FE8;
// 410FF4: using guessed type int dword_410FF4;
// 410FF8: using guessed type int dword_410FF8;
// 41134C: using guessed type int (__stdcall *dword_41134C)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);

//----- (0040D34B) --------------------------------------------------------
int __stdcall sub_40D34B(int a1, int a2, int a3, int a4)
{
  _DWORD *v4; // eax
  int v5; // ecx
  _DWORD *v6; // eax
  int v7; // ecx
  _DWORD v9[6]; // [esp+0h] [ebp-148h] BYREF
  _DWORD v10[4]; // [esp+18h] [ebp-130h] BYREF
  char v11[256]; // [esp+28h] [ebp-120h] BYREF
  unsigned int v12; // [esp+128h] [ebp-20h] BYREF
  unsigned int v13; // [esp+12Ch] [ebp-1Ch] BYREF
  int v14; // [esp+130h] [ebp-18h] BYREF
  int v15; // [esp+134h] [ebp-14h] BYREF
  int v16; // [esp+138h] [ebp-10h] BYREF
  int v17; // [esp+13Ch] [ebp-Ch]
  int v18; // [esp+140h] [ebp-8h] BYREF
  int v19; // [esp+144h] [ebp-4h]

  v19 = 0;
  v4 = v9;
  v9[0] = 575233982;
  v9[1] = 575823787;
  v9[2] = 575102906;
  v9[3] = 574840767;
  v9[4] = 572743601;
  v9[5] = 570843038;
  v5 = 6;
  do
  {
    *v4++ ^= 0x22065FEDu;
    --v5;
  }
  while ( v5 );
  v6 = v10;
  v10[0] = 576020357;
  v10[1] = 578051982;
  v10[2] = 576937864;
  v10[3] = 570843011;
  v7 = 4;
  do
  {
    *v6++ ^= 0x22065FEDu;
    --v7;
  }
  while ( v7 );
  dword_4112F4(v11, v9, a2);
  if ( a1 )
  {
    v17 = dword_411484(0);
    v13 = (dword_4114BC(v17, 8) + 1) & 0xFFFFFFFE;
    v12 = (dword_4114BC(v17, 10) + 1) & 0xFFFFFFFE;
    dword_411488(0, v17);
    if ( !dword_41143C(-2147483646, v11, 0, 0, 0, 983359, 0, &v16, 0) )
    {
      if ( !dword_411440(v16, v10, 0, 4, &v12, 4) )
      {
        LOWORD(v10[0]) += 15;
        if ( !dword_411440(v16, v10, 0, 4, &v13, 4) )
          v19 = 1;
      }
      dword_411354(v16);
    }
  }
  else if ( !dword_41143C(-2147483646, v11, 0, 0, 0, 131353, 0, &v16, 0) )
  {
    v15 = 4;
    v14 = 4;
    if ( !dword_411444(v16, v10, 0, &v15, a4, &v14) )
    {
      LOWORD(v10[0]) += 15;
      if ( !dword_411444(v16, v10, 0, &v15, a3, &v14) )
        v19 = 1;
    }
    dword_411354(v16);
    sub_406531(-1, &v18);
    if ( v18 )
      dword_411448(-2147483646, v11, 256, 0);
    else
      dword_41144C(-2147483646, v11);
  }
  return v19;
}
// 4112F4: using guessed type int (__cdecl *dword_4112F4)(_DWORD, _DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411440: using guessed type int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411444: using guessed type int (__stdcall *dword_411444)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411448: using guessed type int (__stdcall *dword_411448)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41144C: using guessed type int (__stdcall *dword_41144C)(_DWORD, _DWORD);
// 411484: using guessed type int (__stdcall *dword_411484)(_DWORD);
// 411488: using guessed type int (__stdcall *dword_411488)(_DWORD, _DWORD);
// 4114BC: using guessed type int (__stdcall *dword_4114BC)(_DWORD, _DWORD);
// 40D34B: using guessed type _DWORD var_148[6];
// 40D34B: using guessed type _DWORD var_130[4];

//----- (0040D591) --------------------------------------------------------
int sub_40D591()
{
  _WORD *v0; // edi
  int v1; // ebx
  int v2; // ebx
  int v3; // ebx
  int v4; // ebx
  int v5; // ebx
  int v7; // [esp+8h] [ebp-4h]

  v7 = sub_405F98(26);
  if ( v7 )
  {
    v0 = (_WORD *)v7;
    v1 = 3;
    do
    {
      *v0++ = sub_401061(0x41u, 0x5Au);
      --v1;
    }
    while ( v1 );
    v2 = 1;
    do
    {
      *v0++ = sub_401061(0x23u, 0x26u);
      --v2;
    }
    while ( v2 );
    v3 = 3;
    do
    {
      *v0++ = sub_401061(0x30u, 0x39u);
      --v3;
    }
    while ( v3 );
    v4 = 1;
    do
    {
      *v0++ = sub_401061(0x23u, 0x26u);
      --v4;
    }
    while ( v4 );
    v5 = 4;
    do
    {
      *v0++ = sub_401061(0x61u, 0x7Au);
      --v5;
    }
    while ( v5 );
  }
  return v7;
}

//----- (0040D634) --------------------------------------------------------
int sub_40D634()
{
  _BYTE *v1; // [esp+0h] [ebp-14h]
  _BYTE *v2; // [esp+4h] [ebp-10h]
  int v3; // [esp+8h] [ebp-Ch] BYREF
  int v4[2]; // [esp+Ch] [ebp-8h] BYREF

  v4[0] = 0;
  v2 = 0;
  v1 = 0;
  if ( (unsigned int)sub_40155E() >= 0x64 )
  {
    v2 = sub_4064CC(dword_410C71);
    if ( v2 )
    {
      if ( !dword_41143C(-2147483646, v2, 0, 0, 0, 131334, 0, v4, 0) )
      {
        v1 = sub_4064CC(dword_410CC7);
        if ( v1 )
        {
          v3 = 1;
          dword_411440(v4[0], v1, 0, 4, &v3, 4);
        }
      }
    }
  }
  if ( v1 )
    sub_405FB3((int)v1);
  if ( v2 )
    sub_405FB3((int)v2);
  if ( v4[0] )
    dword_411354(v4[0]);
  return v4[1];
}
// 410C71: using guessed type _DWORD dword_410C71[21];
// 410CC7: using guessed type _DWORD dword_410CC7[13];
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411440: using guessed type int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040D701) --------------------------------------------------------
_BYTE *__stdcall sub_40D701(_DWORD *a1, _DWORD *a2, _DWORD *a3)
{
  _BYTE *result; // eax
  int *v4; // ebx
  char v5[256]; // [esp+4h] [ebp-124h] BYREF
  int v6; // [esp+104h] [ebp-24h] BYREF
  char v7[4]; // [esp+108h] [ebp-20h] BYREF
  int v8; // [esp+10Ch] [ebp-1Ch] BYREF
  int *v9; // [esp+110h] [ebp-18h] BYREF
  _BYTE *v10; // [esp+114h] [ebp-14h]
  _BYTE *v11; // [esp+118h] [ebp-10h]
  _BYTE *v12; // [esp+11Ch] [ebp-Ch]
  int v13; // [esp+120h] [ebp-8h] BYREF
  int v14; // [esp+124h] [ebp-4h]

  v14 = 0;
  v12 = 0;
  v11 = 0;
  v10 = 0;
  if ( byte_410FB1
    && dword_410FE4
    && dword_410FD8
    && (v12 = sub_4064CC((_DWORD *)(dword_410FD8 + 4)), dword_410FDC)
    && (v11 = sub_4064CC((_DWORD *)(dword_410FDC + 4)), dword_410FE0) )
  {
    v10 = sub_4064CC((_DWORD *)(dword_410FE0 + 4));
    *a1 = v12;
    *a2 = v11;
    result = v10;
    *a3 = v10;
    v14 = 1;
  }
  else
  {
    v6 = 0;
    if ( !dword_411574(0, 3, 2, &v9, -1, &v8, v7, &v6) )
    {
      v4 = v9;
      while ( v4[24] != 500 )
      {
        v4 += 29;
        if ( !--v8 )
          goto LABEL_23;
      }
      if ( (v4[6] & 2) != 0 )
        v4[6] ^= 2u;
      v10 = (_BYTE *)sub_40D591();
      v4[1] = (int)v10;
      v12 = (_BYTE *)sub_406035(*v4, 0);
      v13 = 128;
      if ( dword_4113F4(v5, &v13) )
      {
        v11 = (_BYTE *)sub_406035((int)v5, 0);
        if ( dword_411578(0, v12, 1, v4, 0) )
        {
          if ( v11 )
            sub_405FB3((int)v11);
          if ( v12 )
            sub_405FB3((int)v12);
          if ( v10 )
            sub_405FB3((int)v10);
        }
        else
        {
          *a1 = v12;
          *a2 = v11;
          *a3 = v10;
          v14 = 1;
        }
      }
LABEL_23:
      dword_411580(v9);
    }
    return (_BYTE *)v14;
  }
  return result;
}
// 410FB1: using guessed type char byte_410FB1;
// 410FD8: using guessed type int dword_410FD8;
// 410FDC: using guessed type int dword_410FDC;
// 410FE0: using guessed type int dword_410FE0;
// 410FE4: using guessed type int dword_410FE4;
// 4113F4: using guessed type int (__stdcall *dword_4113F4)(_DWORD, _DWORD);
// 411574: using guessed type int (__stdcall *dword_411574)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411578: using guessed type int (__stdcall *dword_411578)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411580: using guessed type int (__stdcall *dword_411580)(_DWORD);
// 40D701: using guessed type char var_20[4];

//----- (0040D8BF) --------------------------------------------------------
int sub_40D8BF()
{
  int v0; // eax
  int v1; // eax
  int v2; // eax
  int v4; // [esp+0h] [ebp-1Ch] BYREF
  int v5; // [esp+4h] [ebp-18h] BYREF
  int v6; // [esp+8h] [ebp-14h] BYREF
  _BYTE *v7; // [esp+Ch] [ebp-10h]
  int v8; // [esp+10h] [ebp-Ch] BYREF
  int v9; // [esp+14h] [ebp-8h] BYREF
  int v10; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v6 = 0;
  v5 = 0;
  v4 = 0;
  v7 = 0;
  if ( sub_40D701(&v6, &v5, &v4) )
  {
    v7 = sub_4064CC(dword_410CFD);
    if ( v7 )
    {
      if ( !dword_41143C(-2147483646, v7, 0, 0, 0, 131334, 0, &v9, 0) )
      {
        sub_40DAD0((int)&savedregs);
        v7 = sub_4064CC(dword_410D6D);
        if ( v7 )
        {
          v8 = 49;
          if ( !dword_411440(v9, v7, 0, 1, &v8, 4) )
          {
            sub_40DAD0((int)&savedregs);
            v7 = sub_4064CC(dword_410D8F);
            if ( v7 )
            {
              v0 = dword_4112D4(v6);
              if ( !dword_411440(v9, v7, 0, 1, v6, 2 * v0 + 2) )
              {
                sub_40DAD0((int)&savedregs);
                v7 = sub_4064CC(dword_410DB3);
                if ( v7 )
                {
                  v1 = dword_4112D4(v5);
                  if ( !dword_411440(v9, v7, 0, 1, v5, 2 * v1 + 2) )
                  {
                    sub_40DAD0((int)&savedregs);
                    v7 = sub_4064CC(dword_410DDB);
                    if ( v7 )
                    {
                      if ( sub_40DAE6((int)v7, v4)
                        || (v2 = dword_4112D4(v4), !dword_411440(v9, v7, 0, 1, v4, 2 * v2 + 2)) )
                      {
                        v10 = 1;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  if ( v9 )
    dword_411354(v9);
  if ( v7 )
    sub_405FB3((int)v7);
  if ( v5 )
    sub_405FB3(v5);
  if ( v6 )
    sub_405FB3(v6);
  if ( v4 )
    sub_405FB3(v4);
  return v10;
}
// 410CFD: using guessed type _DWORD dword_410CFD[28];
// 410D6D: using guessed type _DWORD dword_410D6D[8];
// 410D8F: using guessed type _DWORD dword_410D8F[9];
// 410DB3: using guessed type _DWORD dword_410DB3[10];
// 410DDB: using guessed type _DWORD dword_410DDB[9];
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411440: using guessed type int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040DAD0) --------------------------------------------------------
int __usercall sub_40DAD0@<eax>(int a1@<ebp>)
{
  int result; // eax

  if ( *(_DWORD *)(a1 - 16) )
  {
    result = sub_405FB3(*(_DWORD *)(a1 - 16));
    *(_DWORD *)(a1 - 16) = 0;
  }
  return result;
}

//----- (0040DAE6) --------------------------------------------------------
int __stdcall sub_40DAE6(int a1, int a2)
{
  int v3[6]; // [esp+0h] [ebp-30h] BYREF
  char v4[8]; // [esp+18h] [ebp-18h] BYREF
  char v5[8]; // [esp+20h] [ebp-10h] BYREF
  int v6; // [esp+28h] [ebp-8h] BYREF
  int v7; // [esp+2Ch] [ebp-4h]

  v7 = 0;
  dword_4112C0(v3, 0, 24);
  v3[0] = 24;
  if ( !dword_411474(0, v3, 32, &v6) )
  {
    dword_411344(v5, a1);
    dword_411344(v4, a2);
    if ( !dword_411478(v6, v5, v4) )
      v7 = 1;
    dword_41147C(v6);
  }
  return v7;
}
// 4112C0: using guessed type int (__cdecl *dword_4112C0)(_DWORD, _DWORD, _DWORD);
// 411344: using guessed type int (__stdcall *dword_411344)(_DWORD, _DWORD);
// 411474: using guessed type int (__stdcall *dword_411474)(_DWORD, _DWORD, _DWORD, _DWORD);
// 411478: using guessed type int (__stdcall *dword_411478)(_DWORD, _DWORD, _DWORD);
// 41147C: using guessed type int (__stdcall *dword_41147C)(_DWORD);

//----- (0040DB69) --------------------------------------------------------
_BYTE *__stdcall sub_40DB69(int a1)
{
  _DWORD *v1; // eax
  _BYTE *result; // eax
  int v3; // [esp+0h] [ebp-Ch] BYREF
  _BYTE *v4; // [esp+4h] [ebp-8h]
  int v5; // [esp+8h] [ebp-4h] BYREF

  v4 = 0;
  sub_406531(-1, &v5);
  if ( (unsigned int)sub_40155E() < 0x3C )
  {
    if ( a1 )
      v1 = &unk_410E57;
    else
      v1 = &unk_410E83;
  }
  else if ( a1 )
  {
    v1 = &unk_410DFF;
  }
  else
  {
    v1 = &unk_410E2B;
  }
  result = sub_4064CC(v1);
  v4 = result;
  if ( result )
  {
    if ( v5 )
      dword_411364(1, &v3);
    dword_4113A0(v4, 0);
    dword_4113A4(300);
    if ( v4 )
      sub_405FB3((int)v4);
    if ( v5 )
      dword_411364(v3, &v3);
    return (_BYTE *)dword_411330(1);
  }
  return result;
}
// 411330: using guessed type int (__stdcall *dword_411330)(_DWORD);
// 411364: using guessed type int (__stdcall *dword_411364)(_DWORD, _DWORD);
// 4113A0: using guessed type int (__stdcall *dword_4113A0)(_DWORD, _DWORD);
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);

//----- (0040DC1D) --------------------------------------------------------
int sub_40DC1D()
{
  wchar_t *v0; // ebx
  int v1; // eax
  _WORD *v3; // [esp+4h] [ebp-10h]
  _BYTE *v4; // [esp+8h] [ebp-Ch]
  int v5; // [esp+Ch] [ebp-8h] BYREF
  int v6; // [esp+10h] [ebp-4h]

  v6 = 0;
  v5 = 0;
  v3 = 0;
  v4 = sub_4064CC(dword_410EA6);
  if ( v4 )
  {
    if ( !dword_41143C(-2147483646, v4, 0, 0, 0, 131078, 0, &v5, 0) )
    {
      v3 = sub_40DCF6();
      if ( v3 )
      {
        v0 = sub_401647();
        v1 = dword_4112D4(v0);
        if ( !dword_411440(v5, v3, 0, 1, v0, 2 * v1 + 2) )
          v6 = 1;
      }
    }
  }
  if ( v3 )
    sub_405FB3((int)v3);
  if ( v4 )
    sub_405FB3((int)v4);
  if ( v5 )
    dword_411354(v5);
  return v6;
}
// 410EA6: using guessed type _DWORD dword_410EA6[26];
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411440: using guessed type int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040DCF6) --------------------------------------------------------
_WORD *sub_40DCF6()
{
  _WORD *v0; // edi
  int v1; // ebx
  int v2; // ebx
  int v3; // ebx
  _WORD *v5; // [esp+8h] [ebp-4h]

  v5 = (_WORD *)sub_405F98(22);
  if ( v5 )
  {
    *v5 = 42;
    v0 = v5 + 1;
    v1 = 3;
    do
    {
      *v0++ = sub_401061(0x41u, 0x5Au);
      --v1;
    }
    while ( v1 );
    v2 = 3;
    do
    {
      *v0++ = sub_401061(0x30u, 0x39u);
      --v2;
    }
    while ( v2 );
    v3 = 3;
    do
    {
      *v0++ = sub_401061(0x61u, 0x7Au);
      --v3;
    }
    while ( v3 );
  }
  return v5;
}

//----- (0040DD6F) --------------------------------------------------------
int sub_40DD6F()
{
  int v0; // ebx
  wchar_t *v1; // eax
  int v2; // eax
  _DWORD *v3; // esi
  int v4; // eax
  _WORD *v6; // [esp+8h] [ebp-10h]
  _BYTE *v7; // [esp+Ch] [ebp-Ch]
  int v8; // [esp+10h] [ebp-8h] BYREF
  int v9; // [esp+14h] [ebp-4h]

  v9 = 0;
  v8 = 0;
  v6 = 0;
  v0 = 0;
  v7 = sub_4064CC(dword_410EA6);
  if ( v7 )
  {
    if ( !dword_41143C(-2147483646, v7, 0, 0, 0, 131078, 0, &v8, 0) )
    {
      v6 = sub_40DCF6();
      if ( v6 )
      {
        v1 = sub_401647();
        v2 = sub_406035((int)v1, 6);
        v0 = v2;
        if ( v2 )
        {
          v3 = (_DWORD *)(v2 + 2 * dword_4112D4(v2));
          *v3 = 573267917;
          v3[1] = 577200026;
          v3[2] = 577396609;
          *v3 ^= 0x22065FEDu;
          v3[1] ^= 0x22065FEDu;
          v3[2] ^= 0x22065FEDu;
          v4 = dword_4112D4(v0);
          if ( !dword_411440(v8, v6, 0, 1, v0, 2 * v4 + 2) )
            v9 = 1;
        }
      }
    }
  }
  if ( v0 )
    sub_405FB3(v0);
  if ( v6 )
    sub_405FB3((int)v6);
  if ( v7 )
    sub_405FB3((int)v7);
  if ( v8 )
    dword_411354(v8);
  return v9;
}
// 410EA6: using guessed type _DWORD dword_410EA6[26];
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 41143C: using guessed type int (__stdcall *dword_41143C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411440: using guessed type int (__stdcall *dword_411440)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040DE9F) --------------------------------------------------------
int __stdcall sub_40DE9F(int a1)
{
  int result; // eax
  _DWORD v2[6]; // [esp+0h] [ebp-24h] BYREF
  int v3[2]; // [esp+18h] [ebp-Ch] BYREF
  int v4; // [esp+20h] [ebp-4h] BYREF

  v3[0] = a1;
  v3[1] = 0;
  v2[0] = 24;
  memset(&v2[1], 0, 20);
  result = dword_411304(&v4, 1, v2, v3);
  if ( !result )
  {
    dword_41134C(v4, 0);
    return dword_411354(v4);
  }
  return result;
}
// 411304: using guessed type int (__stdcall *dword_411304)(_DWORD, _DWORD, _DWORD, _DWORD);
// 41134C: using guessed type int (__stdcall *dword_41134C)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 40DE9F: using guessed type _DWORD var_24[6];

//----- (0040DF10) --------------------------------------------------------
int sub_40DF10()
{
  int i; // eax
  int *v1; // ebx
  int v2; // esi
  int v4; // [esp+8h] [ebp-8h]
  int v5; // [esp+Ch] [ebp-4h] BYREF

  v5 = 1024;
  v4 = sub_405F98(1024);
  for ( i = dword_411318(5, v4, 1024, &v5); i; i = dword_411318(5, v4, v5, &v5) )
  {
    if ( i != -1073741820 )
      return sub_405FB3(v4);
    v4 = sub_405FCE(v4, v5);
  }
  v1 = (int *)v4;
  do
  {
    v2 = *v1;
    if ( v1[15] && sub_4010BB((_WORD *)v1[15], 0) == -23167984 )
      sub_40DE9F(v1[17]);
    v1 = (int *)((char *)v1 + v2);
  }
  while ( v2 );
  return sub_405FB3(v4);
}
// 411318: using guessed type int (__stdcall *dword_411318)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040DFA6) --------------------------------------------------------
int sub_40DFA6()
{
  int (*v0)(void); // esi
  int v1; // ebx
  int result; // eax

  if ( (unsigned int)sub_40155E() > 0x34 )
    v0 = (int (*)(void))dword_4114A8;
  else
    v0 = (int (*)(void))dword_4114AC;
  sub_40DF10();
  while ( 1 )
  {
    v1 = v0();
    if ( v1 )
      break;
    dword_4113A4(100);
  }
  while ( 1 )
  {
    result = dword_4114B0(v1);
    if ( result )
      break;
    dword_4113A4(100);
  }
  return result;
}
// 4113A4: using guessed type int (__stdcall *dword_4113A4)(_DWORD);
// 4114A8: using guessed type int dword_4114A8;
// 4114AC: using guessed type int dword_4114AC;
// 4114B0: using guessed type int (__stdcall *dword_4114B0)(_DWORD);

//----- (0040DFEF) --------------------------------------------------------
_BYTE *sub_40DFEF()
{
  _BYTE *result; // eax

  result = (_BYTE *)sub_40930C();
  if ( result )
  {
    result = (_BYTE *)sub_40D8BF();
    if ( result )
    {
      result = (_BYTE *)sub_40DC1D();
      if ( result )
      {
        sub_40D34B(1, dword_410FF4 + 2, 0, 0);
        sub_40D634();
        sub_407612(0);
        return sub_40DB69(1);
      }
    }
  }
  return result;
}
// 410FF4: using guessed type int dword_410FF4;

//----- (0040E032) --------------------------------------------------------
_DWORD *__stdcall sub_40E032(int a1)
{
  _DWORD *result; // eax
  int v2; // eax
  _DWORD *v3; // ebx
  int v4; // eax
  int v5; // ebx
  int v6; // eax
  _DWORD *v7; // eax
  int v8; // eax
  _WORD *v9; // eax
  _WORD *v10; // ebx
  _DWORD *v11; // eax
  int v12; // eax
  _WORD *v13; // eax
  _WORD *v14; // ebx
  _DWORD *v15; // [esp-4h] [ebp-24h]
  _DWORD *v16; // [esp-4h] [ebp-24h]
  _DWORD *v17; // [esp-4h] [ebp-24h]
  _DWORD *v18; // [esp-4h] [ebp-24h]
  _DWORD v19[4]; // [esp+4h] [ebp-1Ch] BYREF
  _DWORD *v20; // [esp+14h] [ebp-Ch]
  int v21; // [esp+18h] [ebp-8h]
  _DWORD *v22; // [esp+1Ch] [ebp-4h]

  result = (_DWORD *)sub_406035(a1, 0);
  v20 = result;
  if ( result )
  {
    sub_4016E3((int)v20);
    if ( dword_411528(v20) )
    {
      return (_DWORD *)sub_40CC27(v20);
    }
    else
    {
      v21 = 0;
      v19[0] = 7274582;
      v19[1] = 7667820;
      v19[2] = 6619245;
      v19[3] = 123;
      sub_406983();
      while ( 1 )
      {
        while ( 1 )
        {
          while ( 1 )
          {
            while ( dword_411538(v20) )
            {
              if ( dword_411370(v20) == -1 )
                return (_DWORD *)sub_405FB3((int)v20);
              v2 = sub_405F98(520);
              v3 = (_DWORD *)v2;
              if ( !v2 )
                return (_DWORD *)sub_405FB3((int)v20);
              dword_4113E8(260, v2);
              sub_4016B4((int)v3);
              dword_4112D8(v3, v20);
              sub_405FB3((int)v20);
              v20 = v3;
            }
            v4 = dword_4112E0(v20, v19);
            v5 = v4;
            if ( !v4 )
              break;
            v6 = dword_4112D4(v4);
            v22 = (_DWORD *)sub_405F98(2 * v6 + 10);
            if ( !v22 )
              return (_DWORD *)sub_405FB3((int)v20);
            v7 = v22;
            *v22 = 576348081;
            v7[1] = 576348114;
            *v7 ^= 0x22065FEDu;
            v7[1] ^= 0x22065FEDu;
            dword_4112D8(v22, v5);
            sub_405FB3((int)v20);
            v20 = 0;
            sub_4016B4((int)v22);
            v20 = (_DWORD *)sub_409019((int)v22);
            result = (_DWORD *)sub_405FB3((int)v22);
            if ( !v20 )
              return result;
          }
          if ( sub_4089CA(v21, (int)v20) )
            break;
          v12 = dword_411370(v20);
          if ( v12 == -1 )
            return (_DWORD *)sub_405FB3((int)v20);
          if ( (v12 & 0x10) != 0 )
          {
            sub_4016B4((int)v20);
            if ( dword_41153C(v20) )
              return (_DWORD *)sub_405FB3((int)v20);
LABEL_45:
            v18 = sub_406083((int)v20);
            result = (_DWORD *)sub_405FB3((int)v20);
            v20 = v18;
            if ( v18 )
              return (_DWORD *)sub_40CF4C(v21, (int)v20);
            return result;
          }
          v13 = (_WORD *)dword_41151C(v20);
          if ( !*v13 )
            goto LABEL_45;
          v14 = v13 + 1;
          dword_4112F0(v13 + 1);
          if ( sub_4010BB(v14, 0) != -614982784 )
            goto LABEL_45;
          v17 = (_DWORD *)sub_409249(v21, (int)v20);
          result = (_DWORD *)sub_405FB3((int)v20);
          v20 = v17;
          if ( !v17 )
            return result;
        }
        if ( __readfsdword(0x34u) == 1201 )
        {
          v21 = dword_410FE8;
          if ( !sub_4089CA(dword_410FE8, (int)v20) || __readfsdword(0x34u) == 1201 )
          {
            v21 = dword_410FE4;
            if ( !sub_4089CA(dword_410FE4, (int)v20) || __readfsdword(0x34u) == 1201 )
              return (_DWORD *)sub_405FB3((int)v20);
          }
        }
        v8 = sub_408A82(v21, (int)v20);
        if ( v8 == -1 )
          return (_DWORD *)sub_405FB3((int)v20);
        if ( (v8 & 0x10) != 0 )
          break;
        v9 = (_WORD *)dword_41151C(v20);
        if ( !*v9 )
          goto LABEL_30;
        v10 = v9 + 1;
        dword_4112F0(v9 + 1);
        if ( sub_4010BB(v10, 0) != -614982784 )
          goto LABEL_30;
        v15 = (_DWORD *)sub_409249(v21, (int)v20);
        result = (_DWORD *)sub_405FB3((int)v20);
        v20 = v15;
        if ( !v15 )
          return result;
      }
      sub_4016B4((int)v20);
      if ( sub_408B23(v21, (int)v20) )
        return (_DWORD *)sub_405FB3((int)v20);
LABEL_30:
      if ( *((_WORD *)v20 + 1) == 58 )
        v11 = sub_406083((int)v20);
      else
        v11 = sub_406173(v20);
      v16 = v11;
      result = (_DWORD *)sub_405FB3((int)v20);
      v20 = v16;
      if ( v16 )
        return (_DWORD *)sub_40CF4C(v21, (int)v20);
    }
  }
  return result;
}
// 410FE4: using guessed type int dword_410FE4;
// 410FE8: using guessed type int dword_410FE8;
// 4112D4: using guessed type int (__cdecl *dword_4112D4)(_DWORD);
// 4112D8: using guessed type int (__cdecl *dword_4112D8)(_DWORD, _DWORD);
// 4112E0: using guessed type int (__cdecl *dword_4112E0)(_DWORD, _DWORD);
// 4112F0: using guessed type int (__cdecl *dword_4112F0)(_DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);
// 4113E8: using guessed type int (__stdcall *dword_4113E8)(_DWORD, _DWORD);
// 41151C: using guessed type int (__stdcall *dword_41151C)(_DWORD);
// 411528: using guessed type int (__stdcall *dword_411528)(_DWORD);
// 411538: using guessed type int (__stdcall *dword_411538)(_DWORD);
// 41153C: using guessed type int (__stdcall *dword_41153C)(_DWORD);
// 40E032: using guessed type _DWORD var_1C[4];

//----- (0040E414) --------------------------------------------------------
int __stdcall sub_40E414(int a1)
{
  int result; // eax
  int v2; // eax
  _WORD *v3; // eax
  _WORD *v4; // ebx
  _DWORD *v5; // eax
  int v6; // eax
  _WORD *v7; // eax
  _WORD *v8; // ebx
  int v9; // [esp-4h] [ebp-10h]
  _DWORD *v10; // [esp-4h] [ebp-10h]
  int v11; // [esp-4h] [ebp-10h]
  _DWORD *v12; // [esp-4h] [ebp-10h]
  int v13; // [esp+4h] [ebp-8h]
  int v14; // [esp+4h] [ebp-8h]
  int v15; // [esp+8h] [ebp-4h]

  result = sub_406035(a1, 2);
  v13 = result;
  if ( result )
  {
    v15 = 0;
    while ( 1 )
    {
      while ( !sub_4089CA(v15, v13) )
      {
        v6 = dword_411370(v13);
        if ( v6 == -1 )
          return sub_405FB3(v13);
        if ( (v6 & 0x10) != 0 )
        {
          sub_4016B4(v13);
          if ( dword_41153C(v13) )
            return sub_405FB3(v13);
LABEL_33:
          v12 = sub_406083(v13);
          result = sub_405FB3(v13);
          v14 = (int)v12;
          if ( v12 )
            return sub_40CF4C(v15, v14);
          return result;
        }
        v7 = (_WORD *)dword_41151C(v13);
        if ( !*v7 )
          goto LABEL_33;
        v8 = v7 + 1;
        dword_4112F0(v7 + 1);
        if ( sub_4010BB(v8, 0) != -614982784 )
          goto LABEL_33;
        v11 = sub_409249(v15, v13);
        result = sub_405FB3(v13);
        v13 = v11;
        if ( !v11 )
          return result;
      }
      if ( __readfsdword(0x34u) == 1201 )
      {
        v15 = dword_410FE8;
        if ( !sub_4089CA(dword_410FE8, v13) || __readfsdword(0x34u) == 1201 )
        {
          v15 = dword_410FE4;
          if ( !sub_4089CA(dword_410FE4, v13) || __readfsdword(0x34u) == 1201 )
            return sub_405FB3(v13);
        }
      }
      v2 = sub_408A82(v15, v13);
      if ( v2 == -1 )
        return sub_405FB3(v13);
      if ( (v2 & 0x10) != 0 )
        break;
      v3 = (_WORD *)dword_41151C(v13);
      if ( !*v3 )
        goto LABEL_19;
      v4 = v3 + 1;
      dword_4112F0(v3 + 1);
      if ( sub_4010BB(v4, 0) != -614982784 )
        goto LABEL_19;
      v9 = sub_409249(v15, v13);
      result = sub_405FB3(v13);
      v13 = v9;
      if ( !v9 )
        return result;
    }
    sub_4016B4(v13);
    if ( sub_408B23(v15, v13) )
      return sub_405FB3(v13);
LABEL_19:
    if ( *(_WORD *)(v13 + 2) == 58 )
      v5 = sub_406083(v13);
    else
      v5 = sub_406173((_DWORD *)v13);
    v10 = v5;
    result = sub_405FB3(v13);
    v14 = (int)v10;
    if ( v10 )
      return sub_40CF4C(v15, v14);
  }
  return result;
}
// 410FE4: using guessed type int dword_410FE4;
// 410FE8: using guessed type int dword_410FE8;
// 4112F0: using guessed type int (__cdecl *dword_4112F0)(_DWORD);
// 411370: using guessed type int (__stdcall *dword_411370)(_DWORD);
// 41151C: using guessed type int (__stdcall *dword_41151C)(_DWORD);
// 41153C: using guessed type int (__stdcall *dword_41153C)(_DWORD);

//----- (0040E677) --------------------------------------------------------
_BYTE *__usercall sub_40E677@<eax>(unsigned int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v4; // ebx
  int v5; // [esp+4h] [ebp-20h]
  int v6; // [esp+8h] [ebp-1Ch]
  int v7; // [esp+Ch] [ebp-18h]
  int v8; // [esp+10h] [ebp-14h]
  int v9; // [esp+14h] [ebp-10h]
  int v10; // [esp+14h] [ebp-10h]
  int v11; // [esp+18h] [ebp-Ch]
  int v12; // [esp+1Ch] [ebp-8h]
  int v13; // [esp+20h] [ebp-4h] BYREF

  if ( byte_410FB6 )
  {
    v11 = sub_40750F(a1);
    v10 = dword_4113DC(0x100000, 0, v11);
    if ( v10 )
      return (_BYTE *)dword_411354(v10);
    v9 = dword_4113E0(0, 1, v11);
    sub_406022(v11);
  }
  if ( byte_410FB7 )
  {
    v12 = dword_411388(0, 0, sub_40AEEE, 0, 0, 0);
    v5 = dword_4113F0();
    v8 = sub_4061E7();
  }
  sub_4069C4();
  sub_406D7E();
  if ( byte_410FB5 )
    sub_40724F();
  if ( byte_410FB4 )
    sub_4073C1();
  sub_409554();
  dword_411310(-2147483647, &v13);
  v6 = sub_40B790();
  if ( v6 )
  {
    if ( byte_410FB2 )
    {
      sub_408DC6();
      sub_40D009();
    }
    if ( byte_410FB3 )
      sub_40C8C1(a2, a3);
    sub_40B80E(v6);
  }
  dword_411310(v13, &v13);
  if ( byte_410FB7 )
  {
    if ( v12 )
    {
      dword_4113AC(v12, -1);
      dword_411354(v12);
    }
    v4 = dword_4113F0() - v5;
    v7 = sub_4061E7();
    sub_40B06A(v4, a2, a3, v8, v7, v4);
  }
  if ( byte_410FB6 && v9 )
  {
    dword_4113E4(v9);
    dword_411354(v9);
  }
  if ( !dword_4114A4(67) )
    return sub_407612(1);
  sub_40DD6F();
  return sub_40DB69(0);
}
// 40E792: variable 'v12' is possibly undefined
// 40E7B7: variable 'v5' is possibly undefined
// 40E7C9: variable 'v8' is possibly undefined
// 40E7DB: variable 'v9' is possibly undefined
// 410FB2: using guessed type char byte_410FB2;
// 410FB3: using guessed type char byte_410FB3;
// 410FB4: using guessed type char byte_410FB4;
// 410FB5: using guessed type char byte_410FB5;
// 410FB6: using guessed type char byte_410FB6;
// 410FB7: using guessed type char byte_410FB7;
// 411310: using guessed type int (__stdcall *dword_411310)(_DWORD, _DWORD);
// 411354: using guessed type int (__stdcall *dword_411354)(_DWORD);
// 411388: using guessed type int (__stdcall *dword_411388)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4113AC: using guessed type int (__stdcall *dword_4113AC)(_DWORD, _DWORD);
// 4113DC: using guessed type int (__stdcall *dword_4113DC)(_DWORD, _DWORD, _DWORD);
// 4113E0: using guessed type int (__stdcall *dword_4113E0)(_DWORD, _DWORD, _DWORD);
// 4113E4: using guessed type int (__stdcall *dword_4113E4)(_DWORD);
// 4113F0: using guessed type int (*dword_4113F0)(void);
// 4114A4: using guessed type int (__stdcall *dword_4114A4)(_DWORD);

//----- (0040E815) --------------------------------------------------------
_WORD **__usercall sub_40E815@<eax>(int a1@<edi>, int a2@<esi>)
{
  char *v2; // eax
  char *v3; // eax
  _WORD **result; // eax
  int v5; // ebx
  int v6; // eax
  int v7; // [esp+0h] [ebp-4h] BYREF

  v2 = (char *)sub_40163A();
  v3 = sub_407DBA(v2);
  result = (_WORD **)dword_4114F4(v3, &v7);
  v5 = (int)result;
  if ( result )
  {
    if ( v7 == 3 )
    {
      result = (_WORD **)sub_4010BB(result[1], 0);
      if ( result == (_WORD **)1162288407 )
        result = (_WORD **)sub_40E032(*(_DWORD *)(v5 + 8));
    }
    else if ( v7 == 2 )
    {
      v6 = sub_4010BB(result[1], 0);
      if ( v6 == 1160726935 )
      {
        result = (_WORD **)sub_40DFEF();
      }
      else if ( v6 == 1164413719 )
      {
        sub_40DFA6();
        result = (_WORD **)sub_407612(1);
      }
      else
      {
        result = (_WORD **)sub_40E414(*(_DWORD *)(v5 + 4));
      }
    }
    else
    {
      result = (_WORD **)sub_40E677((unsigned int)result, a1, a2);
    }
  }
  if ( v5 )
    return (_WORD **)sub_405FB3(v5);
  return result;
}
// 4114F4: using guessed type int (__stdcall *dword_4114F4)(_DWORD, _DWORD);

//----- (0040E8D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn start(int a1@<edi>, int a2@<esi>)
{
  ATOM v2; // [esp-150h] [ebp-150h]
  WCHAR *v3; // [esp-14Ch] [ebp-14Ch]
  int v4; // [esp-148h] [ebp-148h]
  DWORD v5; // [esp-144h] [ebp-144h]
  HMODULE v6; // [esp-140h] [ebp-140h]
  const WCHAR *v7; // [esp-13Ch] [ebp-13Ch]
  DWORD v8; // [esp-138h] [ebp-138h]
  const void *v9; // [esp-134h] [ebp-134h]
  DWORD v10; // [esp-130h] [ebp-130h]
  DWORD v11; // [esp-12Ch] [ebp-12Ch]
  WCHAR *v12; // [esp-128h] [ebp-128h]
  DWORD v13; // [esp-124h] [ebp-124h]
  va_list *v14; // [esp-120h] [ebp-120h]
  HWND v15; // [esp-11Ch] [ebp-11Ch]
  int v16; // [esp-118h] [ebp-118h]
  WCHAR *v17; // [esp-114h] [ebp-114h]
  int v18; // [esp-110h] [ebp-110h]
  HINSTANCE v19; // [esp-10Ch] [ebp-10Ch]
  const WCHAR *v20; // [esp-108h] [ebp-108h]
  UINT v21; // [esp-104h] [ebp-104h]
  int v22; // [esp-100h] [ebp-100h]
  int v23; // [esp-FCh] [ebp-FCh]
  UINT v24; // [esp-F8h] [ebp-F8h]
  HWND v25; // [esp-F4h] [ebp-F4h]
  INT_PTR v26; // [esp-F0h] [ebp-F0h]
  HWND v27; // [esp-ECh] [ebp-ECh]
  UINT v28; // [esp-E8h] [ebp-E8h]
  WPARAM v29; // [esp-E4h] [ebp-E4h]
  LPARAM v30; // [esp-E0h] [ebp-E0h]
  HINSTANCE v31; // [esp-DCh] [ebp-DCh]
  const WCHAR *v32; // [esp-D8h] [ebp-D8h]
  HWND v33; // [esp-D4h] [ebp-D4h]
  int v34; // [esp-D0h] [ebp-D0h]
  WCHAR *v35; // [esp-CCh] [ebp-CCh]
  int v36; // [esp-C8h] [ebp-C8h]
  HINSTANCE v37; // [esp-C4h] [ebp-C4h]
  const WCHAR *v38; // [esp-C0h] [ebp-C0h]
  UINT v39; // [esp-BCh] [ebp-BCh]
  int v40; // [esp-B8h] [ebp-B8h]
  int v41; // [esp-B4h] [ebp-B4h]
  UINT v42; // [esp-B0h] [ebp-B0h]
  HWND v43; // [esp-ACh] [ebp-ACh]
  int v44; // [esp-A8h] [ebp-A8h]
  HWND v45; // [esp-A4h] [ebp-A4h]
  WCHAR *v46; // [esp-A0h] [ebp-A0h]
  int v47; // [esp-9Ch] [ebp-9Ch]
  HINSTANCE v48; // [esp-98h] [ebp-98h]
  const WCHAR *v49; // [esp-94h] [ebp-94h]
  HWND v50; // [esp-90h] [ebp-90h]
  INT_PTR (__stdcall *v51)(HWND, UINT, WPARAM, LPARAM); // [esp-8Ch] [ebp-8Ch]
  LPARAM v52; // [esp-88h] [ebp-88h]
  HINSTANCE v53; // [esp-84h] [ebp-84h]
  const WCHAR *v54; // [esp-80h] [ebp-80h]
  HWND v55; // [esp-7Ch] [ebp-7Ch]
  int v56; // [esp-78h] [ebp-78h]
  HWND v57; // [esp-74h] [ebp-74h]
  UINT v58; // [esp-70h] [ebp-70h]
  WPARAM v59; // [esp-6Ch] [ebp-6Ch]
  LPARAM v60; // [esp-68h] [ebp-68h]
  HWND v61; // [esp-64h] [ebp-64h]
  UINT v62; // [esp-60h] [ebp-60h]
  WPARAM v63; // [esp-5Ch] [ebp-5Ch]
  LPARAM v64; // [esp-58h] [ebp-58h]
  HDC v65; // [esp-54h] [ebp-54h]
  int v66; // [esp-50h] [ebp-50h]
  int v67; // [esp-4Ch] [ebp-4Ch]
  int v68; // [esp-48h] [ebp-48h]
  int v69; // [esp-44h] [ebp-44h]
  int v70; // [esp-40h] [ebp-40h]
  DWORD v71; // [esp-3Ch] [ebp-3Ch]
  DWORD v72; // [esp-38h] [ebp-38h]
  DWORD v73; // [esp-34h] [ebp-34h]
  DWORD v74; // [esp-30h] [ebp-30h]
  DWORD v75; // [esp-2Ch] [ebp-2Ch]
  DWORD v76; // [esp-28h] [ebp-28h]
  DWORD v77; // [esp-24h] [ebp-24h]
  DWORD v78; // [esp-20h] [ebp-20h]
  const WCHAR *v79; // [esp-1Ch] [ebp-1Ch]
  HDC v80; // [esp-18h] [ebp-18h]
  int v81; // [esp-14h] [ebp-14h]
  COLORREF v82; // [esp-10h] [ebp-10h]
  HDC v83; // [esp-Ch] [ebp-Ch]
  HPALETTE v84; // [esp-8h] [ebp-8h]
  BOOL v85; // [esp-4h] [ebp-4h]

  sub_405E5C();
  sub_4092E1(0);
  sub_40D244();
  sub_40E815(a1, a2);
  ((void (*)(void))dword_411424)();
  GetCommandLineA();
  GetModuleHandleA(0);
  GetCommandLineA();
  GetAtomNameW(v2, v3, v4);
  SetLastError(v5);
  GetCommandLineW();
  FreeLibrary(v6);
  GetCommandLineW();
  GetFileAttributesW(v7);
  FormatMessageW(v8, v9, v10, v11, v12, v13, v14);
  GetDlgItemTextW(v15, v16, v17, v18);
  LoadImageW(v19, v20, v21, v22, v23, v24);
  EndDialog(v25, v26);
  DefWindowProcW(v27, v28, v29, v30);
  LoadMenuW(v31, v32);
  GetDlgItemTextW(v33, v34, v35, v36);
  LoadImageW(v37, v38, v39, v40, v41, v42);
  IsDlgButtonChecked(v43, v44);
  GetClassNameW(v45, v46, v47);
  CreateDialogParamW(v48, v49, v50, v51, v52);
  LoadMenuW(v53, v54);
  GetDlgItem(v55, v56);
  CreateMenu();
  DefWindowProcW(v57, v58, v59, v60);
  DefWindowProcW(v61, v62, v63, v64);
  GetTextCharset(v65);
  CreateFontW(v66, v67, v68, v69, v70, v71, v72, v73, v74, v75, v76, v77, v78, v79);
  GetDeviceCaps(v80, v81);
  CreateSolidBrush(v82);
  SelectPalette(v83, v84, v85);
  __debugbreak();
}
// 40E989: positive sp value 150 has been found
// 40E902: variable 'v2' is possibly undefined
// 40E902: variable 'v3' is possibly undefined
// 40E902: variable 'v4' is possibly undefined
// 40E907: variable 'v5' is possibly undefined
// 40E911: variable 'v6' is possibly undefined
// 40E91B: variable 'v7' is possibly undefined
// 40E920: variable 'v8' is possibly undefined
// 40E920: variable 'v9' is possibly undefined
// 40E920: variable 'v10' is possibly undefined
// 40E920: variable 'v11' is possibly undefined
// 40E920: variable 'v12' is possibly undefined
// 40E920: variable 'v13' is possibly undefined
// 40E920: variable 'v14' is possibly undefined
// 40E925: variable 'v15' is possibly undefined
// 40E925: variable 'v16' is possibly undefined
// 40E925: variable 'v17' is possibly undefined
// 40E925: variable 'v18' is possibly undefined
// 40E92A: variable 'v19' is possibly undefined
// 40E92A: variable 'v20' is possibly undefined
// 40E92A: variable 'v21' is possibly undefined
// 40E92A: variable 'v22' is possibly undefined
// 40E92A: variable 'v23' is possibly undefined
// 40E92A: variable 'v24' is possibly undefined
// 40E92F: variable 'v25' is possibly undefined
// 40E92F: variable 'v26' is possibly undefined
// 40E934: variable 'v27' is possibly undefined
// 40E934: variable 'v28' is possibly undefined
// 40E934: variable 'v29' is possibly undefined
// 40E934: variable 'v30' is possibly undefined
// 40E939: variable 'v31' is possibly undefined
// 40E939: variable 'v32' is possibly undefined
// 40E93E: variable 'v33' is possibly undefined
// 40E93E: variable 'v34' is possibly undefined
// 40E93E: variable 'v35' is possibly undefined
// 40E93E: variable 'v36' is possibly undefined
// 40E943: variable 'v37' is possibly undefined
// 40E943: variable 'v38' is possibly undefined
// 40E943: variable 'v39' is possibly undefined
// 40E943: variable 'v40' is possibly undefined
// 40E943: variable 'v41' is possibly undefined
// 40E943: variable 'v42' is possibly undefined
// 40E948: variable 'v43' is possibly undefined
// 40E948: variable 'v44' is possibly undefined
// 40E94D: variable 'v45' is possibly undefined
// 40E94D: variable 'v46' is possibly undefined
// 40E94D: variable 'v47' is possibly undefined
// 40E952: variable 'v48' is possibly undefined
// 40E952: variable 'v49' is possibly undefined
// 40E952: variable 'v50' is possibly undefined
// 40E952: variable 'v51' is possibly undefined
// 40E952: variable 'v52' is possibly undefined
// 40E957: variable 'v53' is possibly undefined
// 40E957: variable 'v54' is possibly undefined
// 40E95C: variable 'v55' is possibly undefined
// 40E95C: variable 'v56' is possibly undefined
// 40E966: variable 'v57' is possibly undefined
// 40E966: variable 'v58' is possibly undefined
// 40E966: variable 'v59' is possibly undefined
// 40E966: variable 'v60' is possibly undefined
// 40E96B: variable 'v61' is possibly undefined
// 40E96B: variable 'v62' is possibly undefined
// 40E96B: variable 'v63' is possibly undefined
// 40E96B: variable 'v64' is possibly undefined
// 40E970: variable 'v65' is possibly undefined
// 40E975: variable 'v66' is possibly undefined
// 40E975: variable 'v67' is possibly undefined
// 40E975: variable 'v68' is possibly undefined
// 40E975: variable 'v69' is possibly undefined
// 40E975: variable 'v70' is possibly undefined
// 40E975: variable 'v71' is possibly undefined
// 40E975: variable 'v72' is possibly undefined
// 40E975: variable 'v73' is possibly undefined
// 40E975: variable 'v74' is possibly undefined
// 40E975: variable 'v75' is possibly undefined
// 40E975: variable 'v76' is possibly undefined
// 40E975: variable 'v77' is possibly undefined
// 40E975: variable 'v78' is possibly undefined
// 40E975: variable 'v79' is possibly undefined
// 40E97A: variable 'v80' is possibly undefined
// 40E97A: variable 'v81' is possibly undefined
// 40E97F: variable 'v82' is possibly undefined
// 40E984: variable 'v83' is possibly undefined
// 40E984: variable 'v84' is possibly undefined
// 40E984: variable 'v85' is possibly undefined
// 411424: using guessed type int dword_411424;

// nfuncs=198 queued=175 decompiled=175 lumina nreq=0 worse=0 better=0
// ALL OK, 175 function(s) have been successfully decompiled
